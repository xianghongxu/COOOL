all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.113337, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425565| train set 2.255x speedup, test set 1.006x speedup, val set 0.796x speedup, step: 1, train time 17.94 s
Epoch 1/50 |loss: 0.345465| train set 2.312x speedup, test set 0.999x speedup, val set 0.880x speedup, step: 2, train time 16.30 s
Epoch 2/50 |loss: 0.315544| train set 2.371x speedup, test set 1.040x speedup, val set 1.015x speedup, step: 3, train time 16.38 s
Epoch 3/50 |loss: 0.293198| train set 2.608x speedup, test set 0.960x speedup, val set 1.691x speedup, step: 4, train time 16.28 s
Epoch 4/50 |loss: 0.273671| train set 2.889x speedup, test set 1.388x speedup, val set 1.030x speedup, step: 1, train time 16.32 s
Epoch 5/50 |loss: 0.258355| train set 2.681x speedup, test set 1.167x speedup, val set 1.015x speedup, step: 2, train time 16.28 s
Epoch 6/50 |loss: 0.241673| train set 2.681x speedup, test set 1.185x speedup, val set 1.015x speedup, step: 3, train time 16.20 s
Epoch 7/50 |loss: 0.237739| train set 3.342x speedup, test set 1.690x speedup, val set 0.956x speedup, step: 4, train time 16.29 s
Epoch 8/50 |loss: 0.224417| train set 3.245x speedup, test set 1.326x speedup, val set 1.016x speedup, step: 5, train time 16.21 s
Epoch 9/50 |loss: 0.223748| train set 3.089x speedup, test set 1.428x speedup, val set 0.876x speedup, step: 6, train time 16.22 s
Epoch 10/50 |loss: 0.212218| train set 2.778x speedup, test set 1.490x speedup, val set 0.983x speedup, step: 7, train time 16.59 s
Epoch 11/50 |loss: 0.203383| train set 3.166x speedup, test set 1.780x speedup, val set 1.142x speedup, step: 8, train time 16.37 s
Epoch 12/50 |loss: 0.203426| train set 3.048x speedup, test set 1.417x speedup, val set 1.014x speedup, step: 9, train time 16.40 s
Epoch 13/50 |loss: 0.195453| train set 3.121x speedup, test set 1.334x speedup, val set 0.800x speedup, step: 10, train time 16.01 s
Epoch 14/50 |loss: 0.190252| train set 3.326x speedup, test set 1.499x speedup, val set 0.877x speedup, step: 11, train time 16.41 s
Epoch 15/50 |loss: 0.184959| train set 3.200x speedup, test set 1.400x speedup, val set 1.091x speedup, step: 12, train time 16.28 s
Epoch 16/50 |loss: 0.178860| train set 3.356x speedup, test set 1.659x speedup, val set 0.872x speedup, step: 13, train time 16.19 s
Epoch 17/50 |loss: 0.179747| train set 3.225x speedup, test set 1.666x speedup, val set 0.810x speedup, step: 14, train time 16.30 s
Epoch 18/50 |loss: 0.173597| train set 3.232x speedup, test set 1.696x speedup, val set 0.985x speedup, step: 15, train time 16.20 s
Epoch 19/50 |loss: 0.171485| train set 3.266x speedup, test set 1.338x speedup, val set 0.710x speedup, step: 16, train time 16.20 s
Epoch 20/50 |loss: 0.164925| train set 3.209x speedup, test set 1.529x speedup, val set 0.743x speedup, step: 17, train time 16.20 s
Epoch 21/50 |loss: 0.158769| train set 3.239x speedup, test set 1.444x speedup, val set 0.801x speedup, step: 18, train time 16.39 s
Epoch 22/50 |loss: 0.162954| train set 3.135x speedup, test set 1.478x speedup, val set 0.936x speedup, step: 19, train time 16.30 s
Epoch 23/50 |loss: 0.153560| train set 3.225x speedup, test set 1.715x speedup, val set 0.799x speedup, step: 20, train time 16.20 s
Epoch 24/50 |loss: 0.147514| train set 3.092x speedup, test set 1.670x speedup, val set 0.794x speedup, step: 21, train time 16.24 s
Epoch 25/50 |loss: 0.152850| train set 3.184x speedup, test set 1.449x speedup, val set 0.742x speedup, step: 22, train time 16.03 s
Epoch 26/50 |loss: 0.149832| train set 2.997x speedup, test set 1.205x speedup, val set 0.743x speedup, step: 23, train time 16.11 s
Epoch 27/50 |loss: 0.147882| train set 3.341x speedup, test set 1.524x speedup, val set 0.794x speedup, step: 24, train time 16.32 s
Epoch 28/50 |loss: 0.139958| train set 3.183x speedup, test set 1.674x speedup, val set 0.726x speedup, step: 25, train time 16.21 s
Epoch 29/50 |loss: 0.143709| train set 3.133x speedup, test set 1.434x speedup, val set 0.743x speedup, step: 26, train time 16.40 s
Epoch 30/50 |loss: 0.138854| train set 3.375x speedup, test set 1.600x speedup, val set 0.750x speedup, step: 27, train time 16.12 s
Epoch 31/50 |loss: 0.138949| train set 3.206x speedup, test set 1.645x speedup, val set 0.794x speedup, step: 28, train time 16.30 s
Epoch 32/50 |loss: 0.130588| train set 3.303x speedup, test set 1.525x speedup, val set 0.727x speedup, step: 29, train time 16.49 s
Epoch 33/50 |loss: 0.133551| train set 3.269x speedup, test set 1.695x speedup, val set 0.776x speedup, step: 30, train time 16.20 s
Epoch 34/50 |loss: 0.129848| train set 3.339x speedup, test set 1.489x speedup, val set 0.899x speedup, step: 31, train time 16.14 s
Epoch 35/50 |loss: 0.127691| train set 3.241x speedup, test set 1.633x speedup, val set 0.743x speedup, step: 32, train time 16.39 s
Epoch 36/50 |loss: 0.130272| train set 3.356x speedup, test set 1.504x speedup, val set 0.743x speedup, step: 33, train time 16.23 s
Epoch 37/50 |loss: 0.124949| train set 3.264x speedup, test set 1.677x speedup, val set 0.794x speedup, step: 34, train time 16.01 s
Epoch 38/50 |loss: 0.121166| train set 3.223x speedup, test set 1.683x speedup, val set 0.802x speedup, step: 35, train time 16.30 s
Epoch 39/50 |loss: 0.122722| train set 3.211x speedup, test set 1.695x speedup, val set 0.801x speedup, step: 36, train time 16.30 s
Epoch 40/50 |loss: 0.123945| train set 3.430x speedup, test set 1.691x speedup, val set 0.794x speedup, step: 37, train time 16.12 s
Epoch 41/50 |loss: 0.119513| train set 3.168x speedup, test set 1.713x speedup, val set 0.802x speedup, step: 38, train time 16.22 s
Epoch 42/50 |loss: 0.119789| train set 3.458x speedup, test set 1.656x speedup, val set 0.872x speedup, step: 39, train time 16.29 s
Epoch 43/50 |loss: 0.117579| train set 3.395x speedup, test set 1.613x speedup, val set 0.794x speedup, step: 40, train time 16.20 s
Epoch 44/50 |loss: 0.115504| train set 3.337x speedup, test set 1.429x speedup, val set 0.750x speedup, step: 41, train time 16.19 s
Epoch 45/50 |loss: 0.109912| train set 3.234x speedup, test set 1.663x speedup, val set 0.743x speedup, step: 42, train time 16.21 s
Epoch 46/50 |loss: 0.111707| train set 3.465x speedup, test set 1.604x speedup, val set 0.794x speedup, step: 43, train time 16.34 s
Epoch 47/50 |loss: 0.111619| train set 3.260x speedup, test set 1.583x speedup, val set 0.794x speedup, step: 44, train time 16.31 s
Epoch 48/50 |loss: 0.115891| train set 3.430x speedup, test set 1.675x speedup, val set 0.794x speedup, step: 45, train time 16.21 s
Epoch 49/50 |loss: 0.107017| train set 3.411x speedup, test set 1.712x speedup, val set 0.793x speedup, step: 46, train time 16.29 s
Training per epoch cost 16.293 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.961x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 46, train speedup 3.465, test speedup 1.604, val speedup 0.794
best test speedup epoch: 11, train speedup 3.166, test speedup 1.780, val speedup 1.142
best validation speedup epoch: 4, train speedup 2.889, test speedup 1.388, val speedup 1.030
last model at epoch 49, train speedup 3.411, test speedup 1.712, val speedup 0.793
execution cost 0:14:46.738187
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.830316, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427448| train set 1.465x speedup, test set 1.005x speedup, val set 0.793x speedup, step: 1, train time 19.12 s
Epoch 1/50 |loss: 0.348631| train set 2.142x speedup, test set 0.982x speedup, val set 1.017x speedup, step: 2, train time 16.39 s
Epoch 2/50 |loss: 0.316176| train set 2.421x speedup, test set 0.978x speedup, val set 1.034x speedup, step: 3, train time 16.49 s
Epoch 3/50 |loss: 0.293535| train set 2.590x speedup, test set 1.719x speedup, val set 0.926x speedup, step: 4, train time 16.40 s
Epoch 4/50 |loss: 0.272643| train set 2.691x speedup, test set 1.686x speedup, val set 1.768x speedup, step: 1, train time 16.50 s
Epoch 5/50 |loss: 0.255164| train set 2.623x speedup, test set 1.512x speedup, val set 0.937x speedup, step: 2, train time 16.31 s
Epoch 6/50 |loss: 0.237203| train set 2.770x speedup, test set 1.595x speedup, val set 0.936x speedup, step: 3, train time 16.31 s
Epoch 7/50 |loss: 0.234690| train set 3.074x speedup, test set 1.526x speedup, val set 0.876x speedup, step: 4, train time 16.29 s
Epoch 8/50 |loss: 0.223743| train set 3.077x speedup, test set 1.532x speedup, val set 0.884x speedup, step: 5, train time 16.30 s
Epoch 9/50 |loss: 0.223860| train set 2.990x speedup, test set 1.396x speedup, val set 0.885x speedup, step: 6, train time 16.50 s
Epoch 10/50 |loss: 0.208841| train set 2.783x speedup, test set 1.360x speedup, val set 0.955x speedup, step: 7, train time 16.48 s
Epoch 11/50 |loss: 0.202170| train set 3.138x speedup, test set 1.813x speedup, val set 0.987x speedup, step: 8, train time 16.42 s
Epoch 12/50 |loss: 0.200063| train set 3.005x speedup, test set 1.280x speedup, val set 0.886x speedup, step: 9, train time 16.19 s
Epoch 13/50 |loss: 0.197830| train set 2.871x speedup, test set 1.155x speedup, val set 0.852x speedup, step: 10, train time 16.41 s
Epoch 14/50 |loss: 0.190427| train set 3.331x speedup, test set 1.660x speedup, val set 0.901x speedup, step: 11, train time 16.62 s
Epoch 15/50 |loss: 0.189477| train set 3.323x speedup, test set 1.786x speedup, val set 0.946x speedup, step: 12, train time 16.57 s
Epoch 16/50 |loss: 0.173636| train set 3.270x speedup, test set 1.850x speedup, val set 0.947x speedup, step: 13, train time 16.61 s
Epoch 17/50 |loss: 0.178896| train set 3.177x speedup, test set 1.454x speedup, val set 0.886x speedup, step: 14, train time 16.59 s
Epoch 18/50 |loss: 0.171745| train set 3.202x speedup, test set 1.537x speedup, val set 0.909x speedup, step: 15, train time 16.43 s
Epoch 19/50 |loss: 0.167935| train set 3.247x speedup, test set 1.250x speedup, val set 0.661x speedup, step: 16, train time 16.51 s
Epoch 20/50 |loss: 0.164818| train set 3.168x speedup, test set 1.537x speedup, val set 0.877x speedup, step: 17, train time 16.60 s
Epoch 21/50 |loss: 0.156739| train set 3.208x speedup, test set 0.971x speedup, val set 0.910x speedup, step: 18, train time 16.68 s
Epoch 22/50 |loss: 0.161149| train set 3.310x speedup, test set 1.486x speedup, val set 0.901x speedup, step: 19, train time 16.60 s
Epoch 23/50 |loss: 0.151828| train set 3.424x speedup, test set 1.539x speedup, val set 0.955x speedup, step: 20, train time 16.33 s
Epoch 24/50 |loss: 0.145092| train set 3.110x speedup, test set 1.525x speedup, val set 0.701x speedup, step: 21, train time 16.71 s
Epoch 25/50 |loss: 0.150905| train set 3.235x speedup, test set 1.171x speedup, val set 0.774x speedup, step: 22, train time 16.31 s
Epoch 26/50 |loss: 0.145120| train set 2.984x speedup, test set 0.963x speedup, val set 0.901x speedup, step: 23, train time 16.31 s
Epoch 27/50 |loss: 0.144980| train set 3.344x speedup, test set 1.545x speedup, val set 0.921x speedup, step: 24, train time 16.32 s
Epoch 28/50 |loss: 0.138492| train set 3.252x speedup, test set 1.544x speedup, val set 0.877x speedup, step: 25, train time 16.30 s
Epoch 29/50 |loss: 0.141877| train set 3.315x speedup, test set 1.485x speedup, val set 0.661x speedup, step: 26, train time 16.23 s
Epoch 30/50 |loss: 0.139253| train set 3.219x speedup, test set 1.019x speedup, val set 0.988x speedup, step: 27, train time 16.41 s
Epoch 31/50 |loss: 0.136945| train set 3.202x speedup, test set 1.543x speedup, val set 0.977x speedup, step: 28, train time 16.40 s
Epoch 32/50 |loss: 0.130378| train set 3.239x speedup, test set 1.379x speedup, val set 0.947x speedup, step: 29, train time 16.71 s
Epoch 33/50 |loss: 0.129673| train set 3.281x speedup, test set 1.541x speedup, val set 0.948x speedup, step: 30, train time 16.41 s
Epoch 34/50 |loss: 0.130063| train set 3.334x speedup, test set 1.275x speedup, val set 0.948x speedup, step: 31, train time 16.31 s
Epoch 35/50 |loss: 0.123043| train set 3.241x speedup, test set 1.543x speedup, val set 1.007x speedup, step: 32, train time 16.30 s
Epoch 36/50 |loss: 0.128933| train set 3.349x speedup, test set 1.149x speedup, val set 0.899x speedup, step: 33, train time 16.42 s
Epoch 37/50 |loss: 0.129227| train set 3.292x speedup, test set 1.250x speedup, val set 1.007x speedup, step: 34, train time 16.30 s
Epoch 38/50 |loss: 0.124386| train set 3.190x speedup, test set 1.342x speedup, val set 0.926x speedup, step: 35, train time 16.41 s
Epoch 39/50 |loss: 0.123638| train set 3.283x speedup, test set 1.541x speedup, val set 1.007x speedup, step: 36, train time 16.29 s
Epoch 40/50 |loss: 0.122030| train set 3.462x speedup, test set 1.452x speedup, val set 0.957x speedup, step: 37, train time 16.13 s
Epoch 41/50 |loss: 0.118477| train set 3.218x speedup, test set 1.114x speedup, val set 0.937x speedup, step: 38, train time 16.41 s
Epoch 42/50 |loss: 0.117329| train set 3.336x speedup, test set 1.524x speedup, val set 1.075x speedup, step: 39, train time 16.29 s
Epoch 43/50 |loss: 0.117516| train set 3.360x speedup, test set 1.541x speedup, val set 1.007x speedup, step: 40, train time 16.31 s
Epoch 44/50 |loss: 0.115172| train set 3.209x speedup, test set 1.249x speedup, val set 1.007x speedup, step: 41, train time 16.42 s
Epoch 45/50 |loss: 0.111225| train set 3.264x speedup, test set 1.543x speedup, val set 1.007x speedup, step: 42, train time 16.30 s
Epoch 46/50 |loss: 0.109693| train set 3.306x speedup, test set 1.477x speedup, val set 0.974x speedup, step: 43, train time 16.50 s
Epoch 47/50 |loss: 0.110939| train set 3.144x speedup, test set 1.479x speedup, val set 0.877x speedup, step: 44, train time 16.42 s
Epoch 48/50 |loss: 0.112368| train set 3.408x speedup, test set 1.543x speedup, val set 0.975x speedup, step: 45, train time 16.40 s
Epoch 49/50 |loss: 0.105800| train set 3.486x speedup, test set 1.391x speedup, val set 1.017x speedup, step: 46, train time 16.38 s
Training per epoch cost 16.467 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 49, train speedup 3.486, test speedup 1.391, val speedup 1.017
best test speedup epoch: 16, train speedup 3.270, test speedup 1.850, val speedup 0.947
best validation speedup epoch: 4, train speedup 2.691, test speedup 1.686, val speedup 1.768
last model at epoch 49, train speedup 3.486, test speedup 1.391, val speedup 1.017
execution cost 0:14:58.273177
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.781412, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427288| train set 2.206x speedup, test set 1.004x speedup, val set 0.782x speedup, step: 1, train time 19.39 s
Epoch 1/50 |loss: 0.345046| train set 2.338x speedup, test set 1.001x speedup, val set 0.799x speedup, step: 2, train time 17.11 s
Epoch 2/50 |loss: 0.314963| train set 2.305x speedup, test set 1.040x speedup, val set 0.900x speedup, step: 3, train time 16.71 s
Epoch 3/50 |loss: 0.293773| train set 2.585x speedup, test set 1.009x speedup, val set 0.926x speedup, step: 4, train time 16.90 s
Epoch 4/50 |loss: 0.275771| train set 2.894x speedup, test set 1.668x speedup, val set 1.768x speedup, step: 1, train time 17.02 s
Epoch 5/50 |loss: 0.257143| train set 2.727x speedup, test set 1.607x speedup, val set 0.899x speedup, step: 2, train time 17.17 s
Epoch 6/50 |loss: 0.238865| train set 2.746x speedup, test set 1.310x speedup, val set 0.973x speedup, step: 3, train time 17.21 s
Epoch 7/50 |loss: 0.234258| train set 2.877x speedup, test set 1.314x speedup, val set 1.002x speedup, step: 4, train time 17.27 s
Epoch 8/50 |loss: 0.222510| train set 3.257x speedup, test set 1.646x speedup, val set 1.015x speedup, step: 5, train time 17.40 s
Epoch 9/50 |loss: 0.222628| train set 3.110x speedup, test set 1.207x speedup, val set 0.867x speedup, step: 6, train time 17.29 s
Epoch 10/50 |loss: 0.206707| train set 2.683x speedup, test set 1.074x speedup, val set 1.041x speedup, step: 7, train time 17.52 s
Epoch 11/50 |loss: 0.201170| train set 3.229x speedup, test set 1.726x speedup, val set 0.967x speedup, step: 8, train time 17.41 s
Epoch 12/50 |loss: 0.198963| train set 2.712x speedup, test set 1.637x speedup, val set 0.923x speedup, step: 9, train time 17.24 s
Epoch 13/50 |loss: 0.192988| train set 3.133x speedup, test set 1.109x speedup, val set 0.727x speedup, step: 10, train time 17.28 s
Epoch 14/50 |loss: 0.188203| train set 3.156x speedup, test set 1.751x speedup, val set 1.014x speedup, step: 11, train time 16.71 s
Epoch 15/50 |loss: 0.183353| train set 3.121x speedup, test set 1.602x speedup, val set 1.026x speedup, step: 12, train time 16.80 s
Epoch 16/50 |loss: 0.174728| train set 3.141x speedup, test set 1.702x speedup, val set 0.975x speedup, step: 13, train time 16.32 s
Epoch 17/50 |loss: 0.175347| train set 3.180x speedup, test set 1.765x speedup, val set 0.925x speedup, step: 14, train time 16.40 s
Epoch 18/50 |loss: 0.170736| train set 3.349x speedup, test set 1.715x speedup, val set 0.925x speedup, step: 15, train time 16.40 s
Epoch 19/50 |loss: 0.165664| train set 3.316x speedup, test set 1.093x speedup, val set 0.781x speedup, step: 16, train time 16.42 s
Epoch 20/50 |loss: 0.161433| train set 3.167x speedup, test set 1.569x speedup, val set 0.799x speedup, step: 17, train time 16.43 s
Epoch 21/50 |loss: 0.156548| train set 2.937x speedup, test set 1.092x speedup, val set 0.705x speedup, step: 18, train time 16.40 s
Epoch 22/50 |loss: 0.158656| train set 3.158x speedup, test set 1.201x speedup, val set 0.925x speedup, step: 19, train time 16.40 s
Epoch 23/50 |loss: 0.148208| train set 3.399x speedup, test set 1.628x speedup, val set 1.312x speedup, step: 20, train time 16.42 s
Epoch 24/50 |loss: 0.142819| train set 2.874x speedup, test set 1.717x speedup, val set 0.858x speedup, step: 21, train time 16.40 s
Epoch 25/50 |loss: 0.146661| train set 3.262x speedup, test set 1.585x speedup, val set 0.983x speedup, step: 22, train time 16.33 s
Epoch 26/50 |loss: 0.148007| train set 2.736x speedup, test set 1.028x speedup, val set 1.010x speedup, step: 23, train time 16.50 s
Epoch 27/50 |loss: 0.144465| train set 3.223x speedup, test set 1.152x speedup, val set 0.926x speedup, step: 24, train time 16.31 s
Epoch 28/50 |loss: 0.134481| train set 3.473x speedup, test set 1.717x speedup, val set 2.000x speedup, step: 25, train time 16.40 s
Epoch 29/50 |loss: 0.140580| train set 3.133x speedup, test set 1.640x speedup, val set 0.705x speedup, step: 26, train time 16.31 s
Epoch 30/50 |loss: 0.134513| train set 3.220x speedup, test set 1.717x speedup, val set 0.799x speedup, step: 27, train time 16.28 s
Epoch 31/50 |loss: 0.136941| train set 3.333x speedup, test set 1.640x speedup, val set 1.109x speedup, step: 28, train time 16.41 s
Epoch 32/50 |loss: 0.130528| train set 3.361x speedup, test set 1.361x speedup, val set 1.041x speedup, step: 29, train time 16.59 s
Epoch 33/50 |loss: 0.130113| train set 3.179x speedup, test set 1.051x speedup, val set 0.983x speedup, step: 30, train time 16.22 s
Epoch 34/50 |loss: 0.126906| train set 3.409x speedup, test set 2.013x speedup, val set 0.750x speedup, step: 31, train time 16.28 s
Epoch 35/50 |loss: 0.124695| train set 3.339x speedup, test set 1.051x speedup, val set 0.705x speedup, step: 32, train time 16.41 s
Epoch 36/50 |loss: 0.127531| train set 3.405x speedup, test set 1.028x speedup, val set 0.705x speedup, step: 33, train time 16.31 s
Epoch 37/50 |loss: 0.124251| train set 3.205x speedup, test set 1.548x speedup, val set 1.151x speedup, step: 34, train time 16.22 s
Epoch 38/50 |loss: 0.122532| train set 3.178x speedup, test set 1.051x speedup, val set 0.778x speedup, step: 35, train time 16.31 s
Epoch 39/50 |loss: 0.117499| train set 3.189x speedup, test set 1.093x speedup, val set 0.768x speedup, step: 36, train time 16.31 s
Epoch 40/50 |loss: 0.120648| train set 3.451x speedup, test set 1.717x speedup, val set 0.857x speedup, step: 37, train time 16.49 s
Epoch 41/50 |loss: 0.117512| train set 3.360x speedup, test set 1.223x speedup, val set 0.799x speedup, step: 38, train time 16.38 s
Epoch 42/50 |loss: 0.116165| train set 3.468x speedup, test set 1.585x speedup, val set 0.858x speedup, step: 39, train time 16.38 s
Epoch 43/50 |loss: 0.116605| train set 3.409x speedup, test set 1.640x speedup, val set 0.837x speedup, step: 40, train time 16.30 s
Epoch 44/50 |loss: 0.113103| train set 3.175x speedup, test set 1.202x speedup, val set 1.077x speedup, step: 41, train time 16.41 s
Epoch 45/50 |loss: 0.108914| train set 3.379x speedup, test set 1.471x speedup, val set 0.786x speedup, step: 42, train time 16.31 s
Epoch 46/50 |loss: 0.108547| train set 3.490x speedup, test set 1.638x speedup, val set 0.786x speedup, step: 43, train time 16.30 s
Epoch 47/50 |loss: 0.109951| train set 3.299x speedup, test set 1.152x speedup, val set 0.800x speedup, step: 44, train time 16.32 s
Epoch 48/50 |loss: 0.109829| train set 3.434x speedup, test set 1.640x speedup, val set 0.837x speedup, step: 45, train time 16.30 s
Epoch 49/50 |loss: 0.108084| train set 3.408x speedup, test set 1.640x speedup, val set 0.793x speedup, step: 46, train time 16.32 s
Training per epoch cost 16.654 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.487s, pg runtime 0.404s, speedup 0.830x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 46, train speedup 3.490, test speedup 1.638, val speedup 0.786
best test speedup epoch: 34, train speedup 3.409, test speedup 2.013, val speedup 0.750
best validation speedup epoch: 4, train speedup 2.894, test speedup 1.668, val speedup 1.768
last model at epoch 49, train speedup 3.408, test speedup 1.640, val speedup 0.793
execution cost 0:15:10.846451
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.724808, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.428359| train set 2.285x speedup, test set 1.016x speedup, val set 0.801x speedup, step: 1, train time 19.47 s
Epoch 1/50 |loss: 0.347275| train set 2.294x speedup, test set 0.987x speedup, val set 0.801x speedup, step: 2, train time 17.21 s
Epoch 2/50 |loss: 0.317648| train set 2.491x speedup, test set 0.998x speedup, val set 0.900x speedup, step: 3, train time 17.20 s
Epoch 3/50 |loss: 0.295700| train set 2.808x speedup, test set 0.998x speedup, val set 1.691x speedup, step: 4, train time 17.21 s
Epoch 4/50 |loss: 0.275718| train set 2.680x speedup, test set 1.071x speedup, val set 1.691x speedup, step: 1, train time 17.31 s
Epoch 5/50 |loss: 0.257683| train set 2.704x speedup, test set 1.023x speedup, val set 0.891x speedup, step: 2, train time 17.18 s
Epoch 6/50 |loss: 0.243453| train set 2.636x speedup, test set 1.060x speedup, val set 1.015x speedup, step: 3, train time 17.32 s
Epoch 7/50 |loss: 0.239982| train set 2.951x speedup, test set 1.211x speedup, val set 0.956x speedup, step: 4, train time 17.11 s
Epoch 8/50 |loss: 0.227069| train set 3.291x speedup, test set 1.871x speedup, val set 1.009x speedup, step: 5, train time 17.31 s
Epoch 9/50 |loss: 0.224616| train set 2.937x speedup, test set 1.279x speedup, val set 0.962x speedup, step: 6, train time 17.29 s
Epoch 10/50 |loss: 0.211191| train set 3.094x speedup, test set 1.597x speedup, val set 1.010x speedup, step: 7, train time 17.60 s
Epoch 11/50 |loss: 0.204951| train set 3.173x speedup, test set 1.623x speedup, val set 1.146x speedup, step: 8, train time 17.21 s
Epoch 12/50 |loss: 0.203574| train set 3.078x speedup, test set 1.482x speedup, val set 0.909x speedup, step: 9, train time 16.83 s
Epoch 13/50 |loss: 0.198040| train set 2.850x speedup, test set 1.361x speedup, val set 0.886x speedup, step: 10, train time 16.70 s
Epoch 14/50 |loss: 0.193305| train set 3.272x speedup, test set 1.525x speedup, val set 0.987x speedup, step: 11, train time 16.91 s
Epoch 15/50 |loss: 0.190653| train set 2.995x speedup, test set 1.987x speedup, val set 1.146x speedup, step: 12, train time 16.89 s
Epoch 16/50 |loss: 0.179029| train set 3.160x speedup, test set 1.606x speedup, val set 1.013x speedup, step: 13, train time 16.40 s
Epoch 17/50 |loss: 0.182289| train set 3.001x speedup, test set 1.191x speedup, val set 0.783x speedup, step: 14, train time 16.30 s
Epoch 18/50 |loss: 0.174850| train set 3.166x speedup, test set 1.441x speedup, val set 0.783x speedup, step: 15, train time 16.29 s
Epoch 19/50 |loss: 0.173643| train set 3.239x speedup, test set 1.299x speedup, val set 0.733x speedup, step: 16, train time 16.40 s
Epoch 20/50 |loss: 0.168416| train set 3.223x speedup, test set 1.499x speedup, val set 0.773x speedup, step: 17, train time 16.41 s
Epoch 21/50 |loss: 0.161113| train set 3.104x speedup, test set 1.104x speedup, val set 0.801x speedup, step: 18, train time 16.39 s
Epoch 22/50 |loss: 0.164077| train set 3.191x speedup, test set 1.458x speedup, val set 0.801x speedup, step: 19, train time 16.31 s
Epoch 23/50 |loss: 0.154603| train set 3.326x speedup, test set 1.389x speedup, val set 0.791x speedup, step: 20, train time 16.30 s
Epoch 24/50 |loss: 0.148199| train set 3.032x speedup, test set 1.457x speedup, val set 0.776x speedup, step: 21, train time 16.37 s
Epoch 25/50 |loss: 0.151950| train set 3.221x speedup, test set 1.558x speedup, val set 0.802x speedup, step: 22, train time 16.29 s
Epoch 26/50 |loss: 0.148856| train set 2.875x speedup, test set 0.978x speedup, val set 0.783x speedup, step: 23, train time 16.21 s
Epoch 27/50 |loss: 0.145416| train set 3.229x speedup, test set 1.013x speedup, val set 1.019x speedup, step: 24, train time 16.41 s
Epoch 28/50 |loss: 0.140469| train set 3.214x speedup, test set 1.566x speedup, val set 0.773x speedup, step: 25, train time 16.40 s
Epoch 29/50 |loss: 0.142706| train set 3.289x speedup, test set 1.463x speedup, val set 0.714x speedup, step: 26, train time 16.41 s
Epoch 30/50 |loss: 0.137829| train set 3.216x speedup, test set 1.458x speedup, val set 0.791x speedup, step: 27, train time 16.37 s
Epoch 31/50 |loss: 0.139481| train set 3.292x speedup, test set 1.458x speedup, val set 0.714x speedup, step: 28, train time 16.31 s
Epoch 32/50 |loss: 0.130798| train set 3.331x speedup, test set 1.246x speedup, val set 0.955x speedup, step: 29, train time 16.79 s
Epoch 33/50 |loss: 0.130530| train set 3.264x speedup, test set 1.445x speedup, val set 0.959x speedup, step: 30, train time 16.47 s
Epoch 34/50 |loss: 0.129979| train set 3.294x speedup, test set 1.382x speedup, val set 0.783x speedup, step: 31, train time 16.31 s
Epoch 35/50 |loss: 0.127478| train set 3.287x speedup, test set 1.192x speedup, val set 0.714x speedup, step: 32, train time 16.39 s
Epoch 36/50 |loss: 0.128695| train set 3.351x speedup, test set 1.195x speedup, val set 0.773x speedup, step: 33, train time 16.48 s
Epoch 37/50 |loss: 0.126275| train set 3.383x speedup, test set 1.666x speedup, val set 0.988x speedup, step: 34, train time 16.32 s
Epoch 38/50 |loss: 0.126724| train set 2.925x speedup, test set 1.472x speedup, val set 0.802x speedup, step: 35, train time 16.39 s
Epoch 39/50 |loss: 0.118192| train set 3.168x speedup, test set 1.660x speedup, val set 0.790x speedup, step: 36, train time 16.41 s
Epoch 40/50 |loss: 0.124821| train set 3.384x speedup, test set 1.658x speedup, val set 0.771x speedup, step: 37, train time 16.10 s
Epoch 41/50 |loss: 0.117706| train set 3.234x speedup, test set 1.310x speedup, val set 0.773x speedup, step: 38, train time 16.30 s
Epoch 42/50 |loss: 0.115885| train set 3.322x speedup, test set 1.551x speedup, val set 0.801x speedup, step: 39, train time 16.22 s
Epoch 43/50 |loss: 0.118622| train set 3.358x speedup, test set 1.667x speedup, val set 0.791x speedup, step: 40, train time 16.27 s
Epoch 44/50 |loss: 0.113143| train set 3.372x speedup, test set 1.559x speedup, val set 0.773x speedup, step: 41, train time 16.32 s
Epoch 45/50 |loss: 0.111834| train set 3.283x speedup, test set 1.561x speedup, val set 0.790x speedup, step: 42, train time 16.30 s
Epoch 46/50 |loss: 0.109057| train set 3.500x speedup, test set 1.629x speedup, val set 0.692x speedup, step: 43, train time 16.21 s
Epoch 47/50 |loss: 0.108703| train set 3.321x speedup, test set 1.572x speedup, val set 0.773x speedup, step: 44, train time 16.42 s
Epoch 48/50 |loss: 0.110103| train set 3.453x speedup, test set 1.572x speedup, val set 0.771x speedup, step: 45, train time 16.28 s
Epoch 49/50 |loss: 0.103842| train set 3.513x speedup, test set 1.653x speedup, val set 0.783x speedup, step: 46, train time 16.48 s
Training per epoch cost 16.656 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 4.181s, pg runtime 0.391s, speedup 0.094x
25, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 49, train speedup 3.513, test speedup 1.653, val speedup 0.783
best test speedup epoch: 15, train speedup 2.995, test speedup 1.987, val speedup 1.146
best validation speedup epoch: 4, train speedup 2.680, test speedup 1.071, val speedup 1.691
last model at epoch 49, train speedup 3.513, test speedup 1.653, val speedup 0.783
execution cost 0:15:10.673501
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.792262, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426260| train set 1.498x speedup, test set 0.996x speedup, val set 0.793x speedup, step: 1, train time 19.17 s
Epoch 1/50 |loss: 0.348912| train set 2.422x speedup, test set 0.988x speedup, val set 1.017x speedup, step: 2, train time 16.62 s
Epoch 2/50 |loss: 0.317159| train set 2.313x speedup, test set 0.984x speedup, val set 0.936x speedup, step: 3, train time 16.81 s
Epoch 3/50 |loss: 0.293512| train set 2.470x speedup, test set 1.577x speedup, val set 1.691x speedup, step: 4, train time 16.79 s
Epoch 4/50 |loss: 0.276572| train set 2.960x speedup, test set 1.521x speedup, val set 1.768x speedup, step: 1, train time 16.80 s
Epoch 5/50 |loss: 0.255355| train set 2.868x speedup, test set 1.505x speedup, val set 0.936x speedup, step: 2, train time 16.66 s
Epoch 6/50 |loss: 0.240487| train set 2.644x speedup, test set 1.569x speedup, val set 0.936x speedup, step: 3, train time 16.81 s
Epoch 7/50 |loss: 0.233913| train set 3.069x speedup, test set 1.442x speedup, val set 1.639x speedup, step: 4, train time 16.19 s
Epoch 8/50 |loss: 0.222535| train set 3.235x speedup, test set 1.437x speedup, val set 1.960x speedup, step: 5, train time 16.51 s
Epoch 9/50 |loss: 0.218535| train set 3.173x speedup, test set 1.402x speedup, val set 0.886x speedup, step: 6, train time 16.40 s
Epoch 10/50 |loss: 0.202748| train set 2.777x speedup, test set 1.563x speedup, val set 1.017x speedup, step: 7, train time 16.59 s
Epoch 11/50 |loss: 0.197354| train set 3.131x speedup, test set 1.746x speedup, val set 1.001x speedup, step: 8, train time 16.23 s
Epoch 12/50 |loss: 0.193777| train set 2.771x speedup, test set 1.423x speedup, val set 0.899x speedup, step: 9, train time 16.30 s
Epoch 13/50 |loss: 0.194297| train set 3.123x speedup, test set 1.378x speedup, val set 0.885x speedup, step: 10, train time 16.28 s
Epoch 14/50 |loss: 0.188017| train set 3.282x speedup, test set 1.536x speedup, val set 1.017x speedup, step: 11, train time 16.30 s
Epoch 15/50 |loss: 0.182388| train set 3.149x speedup, test set 1.806x speedup, val set 0.973x speedup, step: 12, train time 16.29 s
Epoch 16/50 |loss: 0.172590| train set 3.366x speedup, test set 1.503x speedup, val set 0.948x speedup, step: 13, train time 16.31 s
Epoch 17/50 |loss: 0.175893| train set 3.179x speedup, test set 1.389x speedup, val set 0.706x speedup, step: 14, train time 16.12 s
Epoch 18/50 |loss: 0.169793| train set 3.277x speedup, test set 1.340x speedup, val set 0.909x speedup, step: 15, train time 16.37 s
Epoch 19/50 |loss: 0.167842| train set 3.277x speedup, test set 1.213x speedup, val set 0.701x speedup, step: 16, train time 16.30 s
Epoch 20/50 |loss: 0.163997| train set 3.247x speedup, test set 1.435x speedup, val set 0.948x speedup, step: 17, train time 16.21 s
Epoch 21/50 |loss: 0.157232| train set 3.067x speedup, test set 1.661x speedup, val set 0.910x speedup, step: 18, train time 16.19 s
Epoch 22/50 |loss: 0.160470| train set 3.204x speedup, test set 1.738x speedup, val set 0.976x speedup, step: 19, train time 16.31 s
Epoch 23/50 |loss: 0.151517| train set 3.245x speedup, test set 1.430x speedup, val set 0.721x speedup, step: 20, train time 16.19 s
Epoch 24/50 |loss: 0.144314| train set 3.045x speedup, test set 1.503x speedup, val set 0.701x speedup, step: 21, train time 16.39 s
Epoch 25/50 |loss: 0.150077| train set 3.303x speedup, test set 1.403x speedup, val set 0.700x speedup, step: 22, train time 16.30 s
Epoch 26/50 |loss: 0.147609| train set 3.038x speedup, test set 1.434x speedup, val set 0.661x speedup, step: 23, train time 16.31 s
Epoch 27/50 |loss: 0.145075| train set 3.301x speedup, test set 1.498x speedup, val set 0.699x speedup, step: 24, train time 16.30 s
Epoch 28/50 |loss: 0.139308| train set 3.250x speedup, test set 1.442x speedup, val set 0.701x speedup, step: 25, train time 16.20 s
Epoch 29/50 |loss: 0.142106| train set 3.196x speedup, test set 1.383x speedup, val set 0.715x speedup, step: 26, train time 16.32 s
Epoch 30/50 |loss: 0.138491| train set 3.214x speedup, test set 1.191x speedup, val set 0.721x speedup, step: 27, train time 16.22 s
Epoch 31/50 |loss: 0.137621| train set 3.290x speedup, test set 1.590x speedup, val set 0.715x speedup, step: 28, train time 16.28 s
Epoch 32/50 |loss: 0.128433| train set 3.391x speedup, test set 1.853x speedup, val set 0.701x speedup, step: 29, train time 16.63 s
Epoch 33/50 |loss: 0.128667| train set 3.296x speedup, test set 1.421x speedup, val set 0.948x speedup, step: 30, train time 16.11 s
Epoch 34/50 |loss: 0.134024| train set 3.392x speedup, test set 1.454x speedup, val set 0.701x speedup, step: 31, train time 16.20 s
Epoch 35/50 |loss: 0.126804| train set 3.365x speedup, test set 1.583x speedup, val set 0.716x speedup, step: 32, train time 16.20 s
Epoch 36/50 |loss: 0.129750| train set 3.343x speedup, test set 1.404x speedup, val set 0.701x speedup, step: 33, train time 16.27 s
Epoch 37/50 |loss: 0.128424| train set 3.120x speedup, test set 1.476x speedup, val set 0.731x speedup, step: 34, train time 16.24 s
Epoch 38/50 |loss: 0.127125| train set 3.155x speedup, test set 1.303x speedup, val set 0.699x speedup, step: 35, train time 16.33 s
Epoch 39/50 |loss: 0.121999| train set 3.380x speedup, test set 1.480x speedup, val set 0.699x speedup, step: 36, train time 16.30 s
Epoch 40/50 |loss: 0.126637| train set 3.467x speedup, test set 1.546x speedup, val set 0.975x speedup, step: 37, train time 16.21 s
Epoch 41/50 |loss: 0.121209| train set 3.222x speedup, test set 1.518x speedup, val set 0.715x speedup, step: 38, train time 16.22 s
Epoch 42/50 |loss: 0.120705| train set 3.157x speedup, test set 1.497x speedup, val set 0.700x speedup, step: 39, train time 16.50 s
Epoch 43/50 |loss: 0.119680| train set 3.394x speedup, test set 1.531x speedup, val set 0.701x speedup, step: 40, train time 16.48 s
Epoch 44/50 |loss: 0.114986| train set 3.293x speedup, test set 1.231x speedup, val set 0.701x speedup, step: 41, train time 16.49 s
Epoch 45/50 |loss: 0.114518| train set 3.248x speedup, test set 1.545x speedup, val set 0.701x speedup, step: 42, train time 16.41 s
Epoch 46/50 |loss: 0.111832| train set 3.503x speedup, test set 1.546x speedup, val set 0.715x speedup, step: 43, train time 16.38 s
Epoch 47/50 |loss: 0.113504| train set 3.157x speedup, test set 1.584x speedup, val set 0.701x speedup, step: 44, train time 16.20 s
Epoch 48/50 |loss: 0.112192| train set 3.450x speedup, test set 1.480x speedup, val set 0.701x speedup, step: 45, train time 16.12 s
Epoch 49/50 |loss: 0.111458| train set 3.485x speedup, test set 1.992x speedup, val set 0.721x speedup, step: 46, train time 16.50 s
Training per epoch cost 16.417 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.245s, pg runtime 0.189s, speedup 0.774x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
15, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 4.181s, pg runtime 0.391s, speedup 0.094x
25, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 46, train speedup 3.503, test speedup 1.546, val speedup 0.715
best test speedup epoch: 49, train speedup 3.485, test speedup 1.992, val speedup 0.721
best validation speedup epoch: 4, train speedup 2.960, test speedup 1.521, val speedup 1.768
last model at epoch 49, train speedup 3.485, test speedup 1.992, val speedup 0.721
execution cost 0:14:55.945254
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.387671, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426772| train set 2.199x speedup, test set 1.004x speedup, val set 0.793x speedup, step: 1, train time 18.46 s
Epoch 1/50 |loss: 0.348591| train set 2.240x speedup, test set 0.991x speedup, val set 0.880x speedup, step: 2, train time 16.49 s
Epoch 2/50 |loss: 0.316720| train set 2.413x speedup, test set 1.263x speedup, val set 0.926x speedup, step: 3, train time 16.31 s
Epoch 3/50 |loss: 0.294108| train set 2.492x speedup, test set 1.074x speedup, val set 1.003x speedup, step: 4, train time 16.22 s
Epoch 4/50 |loss: 0.276274| train set 3.040x speedup, test set 1.750x speedup, val set 1.768x speedup, step: 1, train time 16.28 s
Epoch 5/50 |loss: 0.257376| train set 2.867x speedup, test set 1.597x speedup, val set 1.398x speedup, step: 2, train time 16.19 s
Epoch 6/50 |loss: 0.242968| train set 2.622x speedup, test set 1.138x speedup, val set 0.936x speedup, step: 3, train time 16.42 s
Epoch 7/50 |loss: 0.237550| train set 2.952x speedup, test set 1.595x speedup, val set 0.945x speedup, step: 4, train time 16.59 s
Epoch 8/50 |loss: 0.224067| train set 3.301x speedup, test set 1.644x speedup, val set 0.956x speedup, step: 5, train time 16.41 s
Epoch 9/50 |loss: 0.224786| train set 2.964x speedup, test set 1.577x speedup, val set 0.909x speedup, step: 6, train time 16.18 s
Epoch 10/50 |loss: 0.207636| train set 2.700x speedup, test set 1.433x speedup, val set 0.779x speedup, step: 7, train time 16.52 s
Epoch 11/50 |loss: 0.204407| train set 3.101x speedup, test set 1.979x speedup, val set 0.946x speedup, step: 8, train time 16.40 s
Epoch 12/50 |loss: 0.200050| train set 2.752x speedup, test set 1.473x speedup, val set 0.983x speedup, step: 9, train time 16.39 s
Epoch 13/50 |loss: 0.193030| train set 2.877x speedup, test set 1.479x speedup, val set 0.661x speedup, step: 10, train time 16.30 s
Epoch 14/50 |loss: 0.189754| train set 3.157x speedup, test set 1.456x speedup, val set 0.876x speedup, step: 11, train time 16.42 s
Epoch 15/50 |loss: 0.186105| train set 3.088x speedup, test set 1.679x speedup, val set 1.001x speedup, step: 12, train time 16.39 s
Epoch 16/50 |loss: 0.173965| train set 3.350x speedup, test set 1.469x speedup, val set 0.660x speedup, step: 13, train time 16.40 s
Epoch 17/50 |loss: 0.176651| train set 3.181x speedup, test set 1.462x speedup, val set 0.977x speedup, step: 14, train time 16.31 s
Epoch 18/50 |loss: 0.174053| train set 3.184x speedup, test set 1.311x speedup, val set 0.876x speedup, step: 15, train time 16.31 s
Epoch 19/50 |loss: 0.168740| train set 3.327x speedup, test set 1.675x speedup, val set 0.921x speedup, step: 16, train time 16.20 s
Epoch 20/50 |loss: 0.164255| train set 3.234x speedup, test set 1.430x speedup, val set 0.793x speedup, step: 17, train time 16.24 s
Epoch 21/50 |loss: 0.157490| train set 3.185x speedup, test set 1.642x speedup, val set 0.900x speedup, step: 18, train time 16.23 s
Epoch 22/50 |loss: 0.161160| train set 3.306x speedup, test set 1.455x speedup, val set 0.726x speedup, step: 19, train time 16.39 s
Epoch 23/50 |loss: 0.155689| train set 3.192x speedup, test set 1.321x speedup, val set 0.699x speedup, step: 20, train time 16.40 s
Epoch 24/50 |loss: 0.146106| train set 3.122x speedup, test set 1.528x speedup, val set 0.700x speedup, step: 21, train time 16.31 s
Epoch 25/50 |loss: 0.152649| train set 3.251x speedup, test set 1.441x speedup, val set 0.774x speedup, step: 22, train time 16.49 s
Epoch 26/50 |loss: 0.148960| train set 3.131x speedup, test set 1.207x speedup, val set 0.674x speedup, step: 23, train time 16.49 s
Epoch 27/50 |loss: 0.144990| train set 3.335x speedup, test set 1.477x speedup, val set 0.701x speedup, step: 24, train time 16.31 s
Epoch 28/50 |loss: 0.140162| train set 3.179x speedup, test set 1.430x speedup, val set 0.701x speedup, step: 25, train time 16.28 s
Epoch 29/50 |loss: 0.140400| train set 3.113x speedup, test set 1.466x speedup, val set 0.674x speedup, step: 26, train time 16.40 s
Epoch 30/50 |loss: 0.139462| train set 3.382x speedup, test set 1.464x speedup, val set 1.034x speedup, step: 27, train time 16.29 s
Epoch 31/50 |loss: 0.139658| train set 3.416x speedup, test set 1.464x speedup, val set 0.699x speedup, step: 28, train time 16.49 s
Epoch 32/50 |loss: 0.131124| train set 3.318x speedup, test set 1.286x speedup, val set 0.701x speedup, step: 29, train time 17.03 s
Epoch 33/50 |loss: 0.133051| train set 3.295x speedup, test set 1.468x speedup, val set 0.947x speedup, step: 30, train time 16.53 s
Epoch 34/50 |loss: 0.131368| train set 3.321x speedup, test set 1.816x speedup, val set 0.700x speedup, step: 31, train time 16.57 s
Epoch 35/50 |loss: 0.129389| train set 3.233x speedup, test set 1.338x speedup, val set 0.716x speedup, step: 32, train time 16.51 s
Epoch 36/50 |loss: 0.128145| train set 3.386x speedup, test set 1.675x speedup, val set 0.700x speedup, step: 33, train time 16.41 s
Epoch 37/50 |loss: 0.127176| train set 3.336x speedup, test set 1.509x speedup, val set 0.977x speedup, step: 34, train time 16.59 s
Epoch 38/50 |loss: 0.122183| train set 3.143x speedup, test set 1.469x speedup, val set 0.716x speedup, step: 35, train time 16.50 s
Epoch 39/50 |loss: 0.121705| train set 3.244x speedup, test set 1.455x speedup, val set 0.715x speedup, step: 36, train time 16.58 s
Epoch 40/50 |loss: 0.126092| train set 3.383x speedup, test set 1.455x speedup, val set 0.700x speedup, step: 37, train time 16.49 s
Epoch 41/50 |loss: 0.122876| train set 3.345x speedup, test set 1.468x speedup, val set 0.715x speedup, step: 38, train time 16.68 s
Epoch 42/50 |loss: 0.118422| train set 3.420x speedup, test set 1.453x speedup, val set 0.793x speedup, step: 39, train time 16.60 s
Epoch 43/50 |loss: 0.121268| train set 3.249x speedup, test set 1.330x speedup, val set 0.716x speedup, step: 40, train time 16.49 s
Epoch 44/50 |loss: 0.115534| train set 3.313x speedup, test set 1.466x speedup, val set 0.716x speedup, step: 41, train time 16.38 s
Epoch 45/50 |loss: 0.111742| train set 3.373x speedup, test set 1.466x speedup, val set 0.716x speedup, step: 42, train time 16.42 s
Epoch 46/50 |loss: 0.107780| train set 3.477x speedup, test set 1.618x speedup, val set 0.716x speedup, step: 43, train time 16.28 s
Epoch 47/50 |loss: 0.115143| train set 3.405x speedup, test set 1.689x speedup, val set 0.794x speedup, step: 44, train time 16.39 s
Epoch 48/50 |loss: 0.113494| train set 3.437x speedup, test set 1.504x speedup, val set 0.794x speedup, step: 45, train time 16.41 s
Epoch 49/50 |loss: 0.107291| train set 3.386x speedup, test set 1.461x speedup, val set 0.731x speedup, step: 46, train time 16.39 s
Training per epoch cost 16.455 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 46, train speedup 3.477, test speedup 1.618, val speedup 0.716
best test speedup epoch: 11, train speedup 3.101, test speedup 1.979, val speedup 0.946
best validation speedup epoch: 4, train speedup 3.040, test speedup 1.750, val speedup 1.768
last model at epoch 49, train speedup 3.386, test speedup 1.461, val speedup 0.731
execution cost 0:14:57.347476
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.527014, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427294| train set 2.275x speedup, test set 0.968x speedup, val set 0.996x speedup, step: 1, train time 18.01 s
Epoch 1/50 |loss: 0.341911| train set 2.346x speedup, test set 0.991x speedup, val set 0.801x speedup, step: 2, train time 16.41 s
Epoch 2/50 |loss: 0.315279| train set 2.489x speedup, test set 0.946x speedup, val set 0.973x speedup, step: 3, train time 16.48 s
Epoch 3/50 |loss: 0.291065| train set 2.649x speedup, test set 1.010x speedup, val set 1.003x speedup, step: 4, train time 16.49 s
Epoch 4/50 |loss: 0.275143| train set 2.627x speedup, test set 1.332x speedup, val set 1.030x speedup, step: 1, train time 16.38 s
Epoch 5/50 |loss: 0.254507| train set 2.753x speedup, test set 1.596x speedup, val set 1.015x speedup, step: 2, train time 16.28 s
Epoch 6/50 |loss: 0.238473| train set 2.668x speedup, test set 1.548x speedup, val set 1.016x speedup, step: 3, train time 16.40 s
Epoch 7/50 |loss: 0.235751| train set 3.203x speedup, test set 1.553x speedup, val set 0.984x speedup, step: 4, train time 16.31 s
Epoch 8/50 |loss: 0.223424| train set 3.177x speedup, test set 1.516x speedup, val set 0.704x speedup, step: 5, train time 16.42 s
Epoch 9/50 |loss: 0.222037| train set 2.926x speedup, test set 1.079x speedup, val set 0.955x speedup, step: 6, train time 16.21 s
Epoch 10/50 |loss: 0.208298| train set 2.736x speedup, test set 1.072x speedup, val set 1.010x speedup, step: 7, train time 16.40 s
Epoch 11/50 |loss: 0.202770| train set 3.172x speedup, test set 1.657x speedup, val set 1.077x speedup, step: 8, train time 16.40 s
Epoch 12/50 |loss: 0.199876| train set 2.596x speedup, test set 1.405x speedup, val set 0.985x speedup, step: 9, train time 16.31 s
Epoch 13/50 |loss: 0.195667| train set 3.114x speedup, test set 1.034x speedup, val set 0.705x speedup, step: 10, train time 16.40 s
Epoch 14/50 |loss: 0.192057| train set 3.175x speedup, test set 1.704x speedup, val set 1.014x speedup, step: 11, train time 16.30 s
Epoch 15/50 |loss: 0.186156| train set 3.259x speedup, test set 1.476x speedup, val set 1.111x speedup, step: 12, train time 16.49 s
Epoch 16/50 |loss: 0.177807| train set 3.182x speedup, test set 1.503x speedup, val set 0.837x speedup, step: 13, train time 16.58 s
Epoch 17/50 |loss: 0.177046| train set 2.855x speedup, test set 1.576x speedup, val set 0.781x speedup, step: 14, train time 16.32 s
Epoch 18/50 |loss: 0.174823| train set 3.293x speedup, test set 1.266x speedup, val set 1.014x speedup, step: 15, train time 16.47 s
Epoch 19/50 |loss: 0.172218| train set 3.297x speedup, test set 1.034x speedup, val set 0.705x speedup, step: 16, train time 16.29 s
Epoch 20/50 |loss: 0.166874| train set 3.239x speedup, test set 1.034x speedup, val set 0.799x speedup, step: 17, train time 16.32 s
Epoch 21/50 |loss: 0.160437| train set 3.229x speedup, test set 0.985x speedup, val set 1.014x speedup, step: 18, train time 16.51 s
Epoch 22/50 |loss: 0.162831| train set 3.296x speedup, test set 1.046x speedup, val set 1.014x speedup, step: 19, train time 16.40 s
Epoch 23/50 |loss: 0.156695| train set 3.372x speedup, test set 1.025x speedup, val set 0.768x speedup, step: 20, train time 16.40 s
Epoch 24/50 |loss: 0.147042| train set 3.116x speedup, test set 1.396x speedup, val set 0.768x speedup, step: 21, train time 16.22 s
Epoch 25/50 |loss: 0.152354| train set 3.284x speedup, test set 1.140x speedup, val set 0.704x speedup, step: 22, train time 16.41 s
Epoch 26/50 |loss: 0.149197| train set 3.152x speedup, test set 0.930x speedup, val set 0.705x speedup, step: 23, train time 16.40 s
Epoch 27/50 |loss: 0.145932| train set 3.347x speedup, test set 0.984x speedup, val set 1.077x speedup, step: 24, train time 16.30 s
Epoch 28/50 |loss: 0.142566| train set 3.439x speedup, test set 1.381x speedup, val set 0.768x speedup, step: 25, train time 16.58 s
Epoch 29/50 |loss: 0.145703| train set 2.985x speedup, test set 0.974x speedup, val set 1.014x speedup, step: 26, train time 16.49 s
Epoch 30/50 |loss: 0.138158| train set 3.440x speedup, test set 1.320x speedup, val set 1.111x speedup, step: 27, train time 16.49 s
Epoch 31/50 |loss: 0.142731| train set 3.313x speedup, test set 1.300x speedup, val set 1.112x speedup, step: 28, train time 16.33 s
Epoch 32/50 |loss: 0.130052| train set 3.360x speedup, test set 0.969x speedup, val set 1.112x speedup, step: 29, train time 16.40 s
Epoch 33/50 |loss: 0.132838| train set 3.337x speedup, test set 0.993x speedup, val set 0.985x speedup, step: 30, train time 16.22 s
Epoch 34/50 |loss: 0.131150| train set 3.411x speedup, test set 1.035x speedup, val set 1.112x speedup, step: 1, train time 16.30 s
Epoch 35/50 |loss: 0.127569| train set 3.296x speedup, test set 0.969x speedup, val set 0.751x speedup, step: 2, train time 16.32 s
Epoch 36/50 |loss: 0.131734| train set 3.403x speedup, test set 0.969x speedup, val set 0.705x speedup, step: 3, train time 16.41 s
Epoch 37/50 |loss: 0.130212| train set 3.379x speedup, test set 1.492x speedup, val set 1.077x speedup, step: 4, train time 16.41 s
Epoch 38/50 |loss: 0.126728| train set 3.055x speedup, test set 0.982x speedup, val set 0.705x speedup, step: 5, train time 16.62 s
Epoch 39/50 |loss: 0.120851| train set 3.285x speedup, test set 1.430x speedup, val set 0.705x speedup, step: 6, train time 16.31 s
Epoch 40/50 |loss: 0.122767| train set 3.485x speedup, test set 1.457x speedup, val set 0.767x speedup, step: 7, train time 16.22 s
Epoch 41/50 |loss: 0.124050| train set 3.019x speedup, test set 1.011x speedup, val set 1.014x speedup, step: 8, train time 16.51 s
Epoch 42/50 |loss: 0.123338| train set 3.321x speedup, test set 1.174x speedup, val set 0.751x speedup, step: 9, train time 16.23 s
Epoch 43/50 |loss: 0.118097| train set 3.393x speedup, test set 1.339x speedup, val set 1.077x speedup, step: 10, train time 16.30 s
Epoch 44/50 |loss: 0.117525| train set 3.246x speedup, test set 0.984x speedup, val set 1.077x speedup, step: 11, train time 16.34 s
Epoch 45/50 |loss: 0.111545| train set 3.239x speedup, test set 1.068x speedup, val set 0.720x speedup, step: 12, train time 16.51 s
Epoch 46/50 |loss: 0.112804| train set 3.322x speedup, test set 1.025x speedup, val set 0.768x speedup, step: 13, train time 16.29 s
Epoch 47/50 |loss: 0.117214| train set 3.358x speedup, test set 1.101x speedup, val set 1.077x speedup, step: 14, train time 16.41 s
Epoch 48/50 |loss: 0.113000| train set 3.480x speedup, test set 0.902x speedup, val set 0.751x speedup, step: 15, train time 16.50 s
Epoch 49/50 |loss: 0.108764| train set 3.393x speedup, test set 0.971x speedup, val set 1.111x speedup, step: 16, train time 16.50 s
Training per epoch cost 16.420 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.186s, pg runtime 0.189s, speedup 1.017x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.487s, pg runtime 0.404s, speedup 0.830x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 1.281s, pg runtime 1.357s, speedup 1.059x
19, opt runtime 0.189s, model runtime 0.667s, pg runtime 0.189s, speedup 0.284x
20, opt runtime 2.719s, model runtime 4.251s, pg runtime 3.112s, speedup 0.732x
21, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.961x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 40, train speedup 3.485, test speedup 1.457, val speedup 0.767
best test speedup epoch: 14, train speedup 3.175, test speedup 1.704, val speedup 1.014
best validation speedup epoch: 34, train speedup 3.411, test speedup 1.035, val speedup 1.112
last model at epoch 49, train speedup 3.393, test speedup 0.971, val speedup 1.111
execution cost 0:14:54.149519
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.282269, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426817| train set 2.301x speedup, test set 1.005x speedup, val set 0.793x speedup, step: 1, train time 19.11 s
Epoch 1/50 |loss: 0.346977| train set 2.509x speedup, test set 0.989x speedup, val set 0.890x speedup, step: 2, train time 16.62 s
Epoch 2/50 |loss: 0.316691| train set 2.419x speedup, test set 0.953x speedup, val set 1.691x speedup, step: 3, train time 16.42 s
Epoch 3/50 |loss: 0.296153| train set 2.657x speedup, test set 0.962x speedup, val set 1.691x speedup, step: 4, train time 16.44 s
Epoch 4/50 |loss: 0.276924| train set 2.684x speedup, test set 1.071x speedup, val set 1.770x speedup, step: 1, train time 16.48 s
Epoch 5/50 |loss: 0.259749| train set 2.681x speedup, test set 1.004x speedup, val set 1.609x speedup, step: 2, train time 16.39 s
Epoch 6/50 |loss: 0.241868| train set 2.771x speedup, test set 1.611x speedup, val set 1.016x speedup, step: 3, train time 16.40 s
Epoch 7/50 |loss: 0.236987| train set 3.065x speedup, test set 1.117x speedup, val set 1.638x speedup, step: 4, train time 16.49 s
Epoch 8/50 |loss: 0.225401| train set 3.009x speedup, test set 1.251x speedup, val set 1.009x speedup, step: 5, train time 16.31 s
Epoch 9/50 |loss: 0.221366| train set 2.937x speedup, test set 1.191x speedup, val set 1.003x speedup, step: 6, train time 16.41 s
Epoch 10/50 |loss: 0.208418| train set 2.624x speedup, test set 1.077x speedup, val set 0.956x speedup, step: 7, train time 16.83 s
Epoch 11/50 |loss: 0.199736| train set 3.238x speedup, test set 1.650x speedup, val set 2.085x speedup, step: 8, train time 16.50 s
Epoch 12/50 |loss: 0.198853| train set 2.709x speedup, test set 1.165x speedup, val set 0.985x speedup, step: 9, train time 16.41 s
Epoch 13/50 |loss: 0.193603| train set 2.952x speedup, test set 0.949x speedup, val set 0.661x speedup, step: 10, train time 16.41 s
Epoch 14/50 |loss: 0.187608| train set 3.271x speedup, test set 1.423x speedup, val set 0.985x speedup, step: 11, train time 16.41 s
Epoch 15/50 |loss: 0.182812| train set 3.271x speedup, test set 1.532x speedup, val set 1.077x speedup, step: 12, train time 16.18 s
Epoch 16/50 |loss: 0.173146| train set 3.309x speedup, test set 1.450x speedup, val set 0.977x speedup, step: 13, train time 16.20 s
Epoch 17/50 |loss: 0.179230| train set 3.308x speedup, test set 1.605x speedup, val set 0.721x speedup, step: 14, train time 16.41 s
Epoch 18/50 |loss: 0.168599| train set 3.374x speedup, test set 1.710x speedup, val set 0.674x speedup, step: 15, train time 16.49 s
Epoch 19/50 |loss: 0.167697| train set 3.290x speedup, test set 1.099x speedup, val set 0.661x speedup, step: 16, train time 16.40 s
Epoch 20/50 |loss: 0.162594| train set 3.240x speedup, test set 1.620x speedup, val set 0.901x speedup, step: 17, train time 16.31 s
Epoch 21/50 |loss: 0.157240| train set 2.944x speedup, test set 1.206x speedup, val set 0.661x speedup, step: 18, train time 16.39 s
Epoch 22/50 |loss: 0.156816| train set 3.177x speedup, test set 1.098x speedup, val set 0.877x speedup, step: 19, train time 16.39 s
Epoch 23/50 |loss: 0.149907| train set 2.872x speedup, test set 1.474x speedup, val set 0.674x speedup, step: 20, train time 16.38 s
Epoch 24/50 |loss: 0.142928| train set 3.017x speedup, test set 1.503x speedup, val set 0.716x speedup, step: 21, train time 16.31 s
Epoch 25/50 |loss: 0.150148| train set 3.287x speedup, test set 1.222x speedup, val set 0.715x speedup, step: 22, train time 16.40 s
Epoch 26/50 |loss: 0.143714| train set 3.153x speedup, test set 1.154x speedup, val set 0.674x speedup, step: 23, train time 16.22 s
Epoch 27/50 |loss: 0.143131| train set 3.382x speedup, test set 1.216x speedup, val set 1.007x speedup, step: 24, train time 16.42 s
Epoch 28/50 |loss: 0.133284| train set 3.334x speedup, test set 1.483x speedup, val set 0.716x speedup, step: 25, train time 16.40 s
Epoch 29/50 |loss: 0.138250| train set 3.278x speedup, test set 1.544x speedup, val set 0.716x speedup, step: 26, train time 16.41 s
Epoch 30/50 |loss: 0.133515| train set 3.385x speedup, test set 1.549x speedup, val set 0.716x speedup, step: 27, train time 16.29 s
Epoch 31/50 |loss: 0.136256| train set 3.213x speedup, test set 1.250x speedup, val set 1.007x speedup, step: 28, train time 16.42 s
Epoch 32/50 |loss: 0.126798| train set 3.341x speedup, test set 1.295x speedup, val set 0.716x speedup, step: 29, train time 16.50 s
Epoch 33/50 |loss: 0.126389| train set 3.225x speedup, test set 1.218x speedup, val set 0.701x speedup, step: 30, train time 16.42 s
Epoch 34/50 |loss: 0.127974| train set 3.356x speedup, test set 1.250x speedup, val set 0.701x speedup, step: 31, train time 16.42 s
Epoch 35/50 |loss: 0.124901| train set 3.296x speedup, test set 1.027x speedup, val set 0.716x speedup, step: 32, train time 16.30 s
Epoch 36/50 |loss: 0.128569| train set 3.338x speedup, test set 1.219x speedup, val set 0.716x speedup, step: 33, train time 16.31 s
Epoch 37/50 |loss: 0.122067| train set 3.350x speedup, test set 1.177x speedup, val set 0.716x speedup, step: 34, train time 16.48 s
Epoch 38/50 |loss: 0.120189| train set 3.224x speedup, test set 1.133x speedup, val set 0.716x speedup, step: 35, train time 16.42 s
Epoch 39/50 |loss: 0.117185| train set 3.195x speedup, test set 1.177x speedup, val set 0.977x speedup, step: 36, train time 16.39 s
Epoch 40/50 |loss: 0.121260| train set 3.414x speedup, test set 1.217x speedup, val set 0.701x speedup, step: 37, train time 16.42 s
Epoch 41/50 |loss: 0.117701| train set 3.401x speedup, test set 1.293x speedup, val set 0.716x speedup, step: 38, train time 16.31 s
Epoch 42/50 |loss: 0.112933| train set 3.466x speedup, test set 1.402x speedup, val set 0.715x speedup, step: 39, train time 16.50 s
Epoch 43/50 |loss: 0.117691| train set 3.392x speedup, test set 1.275x speedup, val set 1.007x speedup, step: 40, train time 16.50 s
Epoch 44/50 |loss: 0.111348| train set 3.320x speedup, test set 1.242x speedup, val set 0.716x speedup, step: 41, train time 16.37 s
Epoch 45/50 |loss: 0.107459| train set 3.251x speedup, test set 1.584x speedup, val set 0.716x speedup, step: 42, train time 16.50 s
Epoch 46/50 |loss: 0.104362| train set 3.497x speedup, test set 1.250x speedup, val set 0.731x speedup, step: 43, train time 16.23 s
Epoch 47/50 |loss: 0.107209| train set 3.274x speedup, test set 1.217x speedup, val set 0.701x speedup, step: 44, train time 16.50 s
Epoch 48/50 |loss: 0.109673| train set 3.298x speedup, test set 1.225x speedup, val set 0.701x speedup, step: 45, train time 16.50 s
Epoch 49/50 |loss: 0.105652| train set 3.453x speedup, test set 1.543x speedup, val set 0.701x speedup, step: 46, train time 16.59 s
Training per epoch cost 16.466 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.667s, pg runtime 0.189s, speedup 0.284x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 46, train speedup 3.497, test speedup 1.250, val speedup 0.731
best test speedup epoch: 18, train speedup 3.374, test speedup 1.710, val speedup 0.674
best validation speedup epoch: 4, train speedup 2.684, test speedup 1.071, val speedup 1.770
last model at epoch 49, train speedup 3.453, test speedup 1.543, val speedup 0.701
execution cost 0:14:58.490685
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.772533, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425764| train set 1.430x speedup, test set 1.005x speedup, val set 1.002x speedup, step: 1, train time 19.04 s
Epoch 1/50 |loss: 0.345918| train set 2.312x speedup, test set 0.990x speedup, val set 0.801x speedup, step: 2, train time 16.39 s
Epoch 2/50 |loss: 0.316288| train set 2.356x speedup, test set 1.057x speedup, val set 0.898x speedup, step: 3, train time 16.40 s
Epoch 3/50 |loss: 0.294437| train set 2.456x speedup, test set 1.000x speedup, val set 0.926x speedup, step: 4, train time 16.32 s
Epoch 4/50 |loss: 0.276175| train set 2.751x speedup, test set 1.040x speedup, val set 1.003x speedup, step: 1, train time 16.38 s
Epoch 5/50 |loss: 0.255281| train set 2.554x speedup, test set 0.963x speedup, val set 0.900x speedup, step: 2, train time 16.20 s
Epoch 6/50 |loss: 0.240557| train set 2.799x speedup, test set 1.092x speedup, val set 0.926x speedup, step: 3, train time 16.30 s
Epoch 7/50 |loss: 0.237536| train set 3.066x speedup, test set 1.094x speedup, val set 0.900x speedup, step: 4, train time 16.49 s
Epoch 8/50 |loss: 0.223399| train set 3.233x speedup, test set 1.491x speedup, val set 0.900x speedup, step: 5, train time 16.40 s
Epoch 9/50 |loss: 0.222474| train set 2.975x speedup, test set 1.176x speedup, val set 0.876x speedup, step: 6, train time 16.39 s
Epoch 10/50 |loss: 0.205417| train set 2.786x speedup, test set 1.530x speedup, val set 0.908x speedup, step: 7, train time 16.98 s
Epoch 11/50 |loss: 0.201862| train set 3.172x speedup, test set 1.579x speedup, val set 0.910x speedup, step: 8, train time 16.30 s
Epoch 12/50 |loss: 0.200335| train set 2.639x speedup, test set 1.176x speedup, val set 0.908x speedup, step: 9, train time 16.32 s
Epoch 13/50 |loss: 0.196836| train set 2.834x speedup, test set 1.022x speedup, val set 0.877x speedup, step: 10, train time 16.31 s
Epoch 14/50 |loss: 0.190028| train set 3.150x speedup, test set 1.637x speedup, val set 0.933x speedup, step: 11, train time 16.39 s
Epoch 15/50 |loss: 0.185601| train set 3.217x speedup, test set 1.569x speedup, val set 1.015x speedup, step: 12, train time 16.30 s
Epoch 16/50 |loss: 0.175043| train set 3.356x speedup, test set 1.651x speedup, val set 0.986x speedup, step: 13, train time 16.39 s
Epoch 17/50 |loss: 0.174877| train set 2.936x speedup, test set 1.632x speedup, val set 1.015x speedup, step: 14, train time 16.44 s
Epoch 18/50 |loss: 0.171303| train set 3.243x speedup, test set 1.279x speedup, val set 0.925x speedup, step: 15, train time 16.52 s
Epoch 19/50 |loss: 0.170192| train set 3.202x speedup, test set 1.026x speedup, val set 0.910x speedup, step: 16, train time 16.49 s
Epoch 20/50 |loss: 0.169413| train set 3.220x speedup, test set 1.197x speedup, val set 0.935x speedup, step: 17, train time 16.42 s
Epoch 21/50 |loss: 0.161437| train set 3.076x speedup, test set 1.204x speedup, val set 0.909x speedup, step: 18, train time 16.22 s
Epoch 22/50 |loss: 0.159824| train set 3.145x speedup, test set 1.092x speedup, val set 0.910x speedup, step: 19, train time 16.20 s
Epoch 23/50 |loss: 0.154044| train set 3.312x speedup, test set 1.639x speedup, val set 0.748x speedup, step: 20, train time 16.39 s
Epoch 24/50 |loss: 0.145242| train set 3.074x speedup, test set 1.574x speedup, val set 1.017x speedup, step: 1, train time 16.33 s
Epoch 25/50 |loss: 0.153273| train set 3.188x speedup, test set 1.200x speedup, val set 1.015x speedup, step: 2, train time 16.32 s
Epoch 26/50 |loss: 0.148577| train set 2.997x speedup, test set 0.993x speedup, val set 0.910x speedup, step: 3, train time 16.31 s
Epoch 27/50 |loss: 0.143305| train set 3.228x speedup, test set 1.078x speedup, val set 0.901x speedup, step: 4, train time 16.39 s
Epoch 28/50 |loss: 0.142248| train set 3.311x speedup, test set 1.705x speedup, val set 0.801x speedup, step: 5, train time 16.38 s
Epoch 29/50 |loss: 0.140584| train set 3.110x speedup, test set 1.062x speedup, val set 0.910x speedup, step: 6, train time 16.32 s
Epoch 30/50 |loss: 0.137939| train set 3.188x speedup, test set 1.448x speedup, val set 1.017x speedup, step: 7, train time 16.39 s
Epoch 31/50 |loss: 0.139698| train set 3.421x speedup, test set 1.641x speedup, val set 0.977x speedup, step: 8, train time 16.32 s
Epoch 32/50 |loss: 0.130305| train set 3.326x speedup, test set 1.146x speedup, val set 0.974x speedup, step: 9, train time 16.60 s
Epoch 33/50 |loss: 0.131322| train set 3.345x speedup, test set 1.640x speedup, val set 1.017x speedup, step: 10, train time 16.29 s
Epoch 34/50 |loss: 0.133048| train set 3.420x speedup, test set 1.090x speedup, val set 0.910x speedup, step: 11, train time 16.30 s
Epoch 35/50 |loss: 0.127583| train set 3.225x speedup, test set 1.310x speedup, val set 0.987x speedup, step: 12, train time 16.20 s
Epoch 36/50 |loss: 0.131453| train set 3.046x speedup, test set 1.093x speedup, val set 0.910x speedup, step: 13, train time 16.32 s
Epoch 37/50 |loss: 0.128002| train set 3.221x speedup, test set 1.716x speedup, val set 1.018x speedup, step: 14, train time 16.30 s
Epoch 38/50 |loss: 0.122516| train set 3.201x speedup, test set 1.028x speedup, val set 0.783x speedup, step: 15, train time 16.50 s
Epoch 39/50 |loss: 0.121264| train set 3.198x speedup, test set 1.431x speedup, val set 0.986x speedup, step: 16, train time 16.32 s
Epoch 40/50 |loss: 0.123147| train set 3.392x speedup, test set 1.719x speedup, val set 0.801x speedup, step: 17, train time 16.42 s
Epoch 41/50 |loss: 0.116745| train set 3.165x speedup, test set 1.092x speedup, val set 1.019x speedup, step: 18, train time 16.51 s
Epoch 42/50 |loss: 0.117030| train set 3.469x speedup, test set 1.716x speedup, val set 0.986x speedup, step: 19, train time 16.31 s
Epoch 43/50 |loss: 0.117521| train set 3.359x speedup, test set 1.655x speedup, val set 0.988x speedup, step: 20, train time 16.43 s
Epoch 44/50 |loss: 0.112880| train set 3.188x speedup, test set 1.290x speedup, val set 1.050x speedup, step: 1, train time 16.32 s
Epoch 45/50 |loss: 0.112586| train set 3.226x speedup, test set 1.309x speedup, val set 1.017x speedup, step: 2, train time 16.29 s
Epoch 46/50 |loss: 0.109405| train set 3.396x speedup, test set 1.644x speedup, val set 1.017x speedup, step: 3, train time 16.29 s
Epoch 47/50 |loss: 0.113694| train set 3.146x speedup, test set 1.292x speedup, val set 0.988x speedup, step: 4, train time 16.20 s
Epoch 48/50 |loss: 0.110273| train set 3.440x speedup, test set 1.096x speedup, val set 0.782x speedup, step: 5, train time 16.40 s
Epoch 49/50 |loss: 0.109070| train set 3.492x speedup, test set 1.070x speedup, val set 0.988x speedup, step: 6, train time 16.40 s
Training per epoch cost 16.423 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.242s, pg runtime 0.189s, speedup 0.783x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
15, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 1.281s, pg runtime 1.357s, speedup 1.059x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 4.251s, pg runtime 3.112s, speedup 0.732x
21, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
22, opt runtime 0.158s, model runtime 0.256s, pg runtime 0.158s, speedup 0.620x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.961x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 49, train speedup 3.492, test speedup 1.070, val speedup 0.988
best test speedup epoch: 40, train speedup 3.392, test speedup 1.719, val speedup 0.801
best validation speedup epoch: 44, train speedup 3.188, test speedup 1.290, val speedup 1.050
last model at epoch 49, train speedup 3.492, test speedup 1.070, val speedup 0.988
execution cost 0:14:55.544528
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.784653, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426729| train set 2.318x speedup, test set 1.006x speedup, val set 0.795x speedup, step: 1, train time 19.05 s
Epoch 1/50 |loss: 0.348054| train set 2.250x speedup, test set 0.977x speedup, val set 1.016x speedup, step: 2, train time 16.80 s
Epoch 2/50 |loss: 0.315233| train set 2.379x speedup, test set 1.039x speedup, val set 1.015x speedup, step: 3, train time 16.79 s
Epoch 3/50 |loss: 0.294287| train set 2.667x speedup, test set 0.996x speedup, val set 1.398x speedup, step: 4, train time 16.77 s
Epoch 4/50 |loss: 0.275803| train set 2.657x speedup, test set 1.059x speedup, val set 1.031x speedup, step: 1, train time 16.98 s
Epoch 5/50 |loss: 0.255535| train set 2.747x speedup, test set 1.339x speedup, val set 0.910x speedup, step: 2, train time 17.12 s
Epoch 6/50 |loss: 0.242966| train set 2.743x speedup, test set 1.264x speedup, val set 0.985x speedup, step: 3, train time 17.04 s
Epoch 7/50 |loss: 0.238539| train set 3.129x speedup, test set 1.203x speedup, val set 0.845x speedup, step: 4, train time 17.05 s
Epoch 8/50 |loss: 0.228468| train set 3.162x speedup, test set 1.614x speedup, val set 0.843x speedup, step: 5, train time 16.99 s
Epoch 9/50 |loss: 0.226766| train set 2.973x speedup, test set 1.368x speedup, val set 0.984x speedup, step: 6, train time 17.20 s
Epoch 10/50 |loss: 0.211472| train set 2.797x speedup, test set 1.336x speedup, val set 0.983x speedup, step: 7, train time 17.38 s
Epoch 11/50 |loss: 0.204892| train set 3.170x speedup, test set 1.733x speedup, val set 1.077x speedup, step: 8, train time 17.01 s
Epoch 12/50 |loss: 0.203303| train set 2.635x speedup, test set 1.478x speedup, val set 0.985x speedup, step: 9, train time 17.01 s
Epoch 13/50 |loss: 0.197389| train set 2.924x speedup, test set 1.210x speedup, val set 0.877x speedup, step: 10, train time 17.01 s
Epoch 14/50 |loss: 0.193329| train set 3.253x speedup, test set 1.514x speedup, val set 0.956x speedup, step: 11, train time 16.81 s
Epoch 15/50 |loss: 0.190089| train set 3.392x speedup, test set 1.698x speedup, val set 1.076x speedup, step: 12, train time 16.60 s
Epoch 16/50 |loss: 0.178856| train set 3.310x speedup, test set 1.446x speedup, val set 1.040x speedup, step: 13, train time 16.81 s
Epoch 17/50 |loss: 0.180800| train set 2.708x speedup, test set 1.459x speedup, val set 1.063x speedup, step: 14, train time 16.51 s
Epoch 18/50 |loss: 0.177961| train set 3.104x speedup, test set 1.519x speedup, val set 0.956x speedup, step: 15, train time 16.41 s
Epoch 19/50 |loss: 0.171733| train set 3.166x speedup, test set 1.168x speedup, val set 0.714x speedup, step: 16, train time 16.12 s
Epoch 20/50 |loss: 0.167984| train set 3.220x speedup, test set 1.644x speedup, val set 0.877x speedup, step: 17, train time 16.31 s
Epoch 21/50 |loss: 0.159214| train set 2.960x speedup, test set 1.148x speedup, val set 0.952x speedup, step: 18, train time 16.12 s
Epoch 22/50 |loss: 0.163660| train set 3.271x speedup, test set 1.189x speedup, val set 0.886x speedup, step: 19, train time 16.10 s
Epoch 23/50 |loss: 0.155035| train set 3.161x speedup, test set 1.794x speedup, val set 0.761x speedup, step: 20, train time 16.20 s
Epoch 24/50 |loss: 0.149153| train set 3.248x speedup, test set 1.736x speedup, val set 0.761x speedup, step: 21, train time 16.21 s
Epoch 25/50 |loss: 0.153906| train set 3.231x speedup, test set 1.789x speedup, val set 0.761x speedup, step: 22, train time 16.29 s
Epoch 26/50 |loss: 0.149671| train set 2.977x speedup, test set 0.981x speedup, val set 0.886x speedup, step: 23, train time 16.40 s
Epoch 27/50 |loss: 0.146813| train set 3.364x speedup, test set 1.442x speedup, val set 0.910x speedup, step: 24, train time 16.39 s
Epoch 28/50 |loss: 0.140766| train set 3.215x speedup, test set 2.019x speedup, val set 1.063x speedup, step: 25, train time 16.19 s
Epoch 29/50 |loss: 0.142310| train set 3.243x speedup, test set 1.436x speedup, val set 0.949x speedup, step: 26, train time 16.20 s
Epoch 30/50 |loss: 0.139796| train set 3.210x speedup, test set 1.187x speedup, val set 0.873x speedup, step: 27, train time 16.20 s
Epoch 31/50 |loss: 0.138534| train set 3.329x speedup, test set 1.496x speedup, val set 1.057x speedup, step: 28, train time 16.01 s
Epoch 32/50 |loss: 0.134266| train set 3.340x speedup, test set 1.326x speedup, val set 0.957x speedup, step: 29, train time 16.69 s
Epoch 33/50 |loss: 0.131366| train set 3.126x speedup, test set 1.051x speedup, val set 0.886x speedup, step: 30, train time 16.13 s
Epoch 34/50 |loss: 0.130802| train set 3.385x speedup, test set 1.459x speedup, val set 0.704x speedup, step: 31, train time 16.28 s
Epoch 35/50 |loss: 0.127850| train set 3.287x speedup, test set 1.320x speedup, val set 0.707x speedup, step: 32, train time 16.20 s
Epoch 36/50 |loss: 0.132145| train set 3.354x speedup, test set 1.106x speedup, val set 0.714x speedup, step: 33, train time 16.20 s
Epoch 37/50 |loss: 0.124584| train set 3.344x speedup, test set 1.458x speedup, val set 1.038x speedup, step: 34, train time 16.20 s
Epoch 38/50 |loss: 0.124916| train set 3.227x speedup, test set 1.461x speedup, val set 0.664x speedup, step: 35, train time 16.30 s
Epoch 39/50 |loss: 0.121917| train set 3.338x speedup, test set 1.450x speedup, val set 0.705x speedup, step: 36, train time 16.21 s
Epoch 40/50 |loss: 0.122741| train set 3.386x speedup, test set 1.747x speedup, val set 1.056x speedup, step: 37, train time 16.31 s
Epoch 41/50 |loss: 0.123403| train set 3.380x speedup, test set 1.613x speedup, val set 1.063x speedup, step: 38, train time 16.40 s
Epoch 42/50 |loss: 0.118030| train set 3.330x speedup, test set 1.673x speedup, val set 0.760x speedup, step: 39, train time 16.41 s
Epoch 43/50 |loss: 0.120481| train set 3.380x speedup, test set 1.665x speedup, val set 0.777x speedup, step: 40, train time 16.31 s
Epoch 44/50 |loss: 0.114212| train set 3.300x speedup, test set 1.103x speedup, val set 0.779x speedup, step: 41, train time 16.29 s
Epoch 45/50 |loss: 0.112196| train set 3.330x speedup, test set 1.248x speedup, val set 0.760x speedup, step: 42, train time 16.49 s
Epoch 46/50 |loss: 0.110021| train set 3.258x speedup, test set 1.461x speedup, val set 0.721x speedup, step: 43, train time 16.49 s
Epoch 47/50 |loss: 0.112611| train set 3.317x speedup, test set 1.612x speedup, val set 0.759x speedup, step: 44, train time 16.60 s
Epoch 48/50 |loss: 0.108877| train set 3.402x speedup, test set 1.458x speedup, val set 0.850x speedup, step: 45, train time 16.51 s
Epoch 49/50 |loss: 0.110777| train set 3.505x speedup, test set 1.149x speedup, val set 0.720x speedup, step: 46, train time 16.58 s
Training per epoch cost 16.574 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 49, train speedup 3.505, test speedup 1.149, val speedup 0.720
best test speedup epoch: 28, train speedup 3.215, test speedup 2.019, val speedup 1.063
best validation speedup epoch: 4, train speedup 2.657, test speedup 1.059, val speedup 1.031
last model at epoch 49, train speedup 3.505, test speedup 1.149, val speedup 0.720
execution cost 0:15:06.554550
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.187699, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425529| train set 1.428x speedup, test set 0.997x speedup, val set 0.800x speedup, step: 1, train time 10.18 s
Epoch 1/50 |loss: 0.344474| train set 2.516x speedup, test set 0.968x speedup, val set 0.730x speedup, step: 2, train time 8.70 s
Epoch 2/50 |loss: 0.316058| train set 2.360x speedup, test set 1.041x speedup, val set 0.973x speedup, step: 3, train time 8.90 s
Epoch 3/50 |loss: 0.297548| train set 2.848x speedup, test set 0.971x speedup, val set 1.691x speedup, step: 4, train time 8.90 s
Epoch 4/50 |loss: 0.276707| train set 2.757x speedup, test set 0.993x speedup, val set 1.030x speedup, step: 1, train time 8.80 s
Epoch 5/50 |loss: 0.258107| train set 2.547x speedup, test set 1.329x speedup, val set 0.936x speedup, step: 2, train time 8.89 s
Epoch 6/50 |loss: 0.241362| train set 2.681x speedup, test set 1.009x speedup, val set 1.015x speedup, step: 3, train time 8.90 s
Epoch 7/50 |loss: 0.238834| train set 3.073x speedup, test set 1.710x speedup, val set 0.935x speedup, step: 4, train time 8.90 s
Epoch 8/50 |loss: 0.226827| train set 2.938x speedup, test set 1.318x speedup, val set 0.956x speedup, step: 5, train time 8.89 s
Epoch 9/50 |loss: 0.227902| train set 2.925x speedup, test set 1.554x speedup, val set 0.885x speedup, step: 6, train time 8.80 s
Epoch 10/50 |loss: 0.211542| train set 2.701x speedup, test set 1.281x speedup, val set 0.930x speedup, step: 7, train time 8.90 s
Epoch 11/50 |loss: 0.207217| train set 3.099x speedup, test set 2.084x speedup, val set 0.910x speedup, step: 8, train time 9.01 s
Epoch 12/50 |loss: 0.202365| train set 2.617x speedup, test set 1.616x speedup, val set 0.884x speedup, step: 9, train time 8.71 s
Epoch 13/50 |loss: 0.198052| train set 2.964x speedup, test set 1.127x speedup, val set 0.884x speedup, step: 10, train time 8.70 s
Epoch 14/50 |loss: 0.196063| train set 3.311x speedup, test set 1.730x speedup, val set 0.909x speedup, step: 11, train time 9.20 s
Epoch 15/50 |loss: 0.188643| train set 3.112x speedup, test set 1.823x speedup, val set 0.935x speedup, step: 12, train time 8.90 s
Epoch 16/50 |loss: 0.179812| train set 3.066x speedup, test set 1.936x speedup, val set 0.706x speedup, step: 13, train time 8.81 s
Epoch 17/50 |loss: 0.180746| train set 2.997x speedup, test set 1.659x speedup, val set 0.694x speedup, step: 14, train time 8.79 s
Epoch 18/50 |loss: 0.175075| train set 3.112x speedup, test set 1.691x speedup, val set 0.666x speedup, step: 15, train time 8.90 s
Epoch 19/50 |loss: 0.171513| train set 3.279x speedup, test set 1.160x speedup, val set 0.705x speedup, step: 16, train time 8.80 s
Epoch 20/50 |loss: 0.167531| train set 3.086x speedup, test set 1.739x speedup, val set 0.724x speedup, step: 17, train time 8.88 s
Epoch 21/50 |loss: 0.160619| train set 2.936x speedup, test set 1.721x speedup, val set 0.910x speedup, step: 18, train time 8.82 s
Epoch 22/50 |loss: 0.161407| train set 3.302x speedup, test set 1.986x speedup, val set 0.910x speedup, step: 19, train time 8.78 s
Epoch 23/50 |loss: 0.153028| train set 3.021x speedup, test set 1.865x speedup, val set 0.770x speedup, step: 20, train time 8.90 s
Epoch 24/50 |loss: 0.148735| train set 3.024x speedup, test set 1.522x speedup, val set 0.826x speedup, step: 21, train time 8.80 s
Epoch 25/50 |loss: 0.154232| train set 3.111x speedup, test set 1.690x speedup, val set 0.733x speedup, step: 22, train time 8.68 s
Epoch 26/50 |loss: 0.149717| train set 2.863x speedup, test set 1.028x speedup, val set 0.956x speedup, step: 23, train time 8.80 s
Epoch 27/50 |loss: 0.147560| train set 3.275x speedup, test set 1.600x speedup, val set 0.910x speedup, step: 24, train time 8.70 s
Epoch 28/50 |loss: 0.141930| train set 3.374x speedup, test set 2.100x speedup, val set 0.707x speedup, step: 25, train time 8.81 s
Epoch 29/50 |loss: 0.144723| train set 3.004x speedup, test set 1.520x speedup, val set 0.659x speedup, step: 26, train time 8.80 s
Epoch 30/50 |loss: 0.139263| train set 3.214x speedup, test set 1.717x speedup, val set 0.724x speedup, step: 27, train time 8.70 s
Epoch 31/50 |loss: 0.139567| train set 3.000x speedup, test set 1.785x speedup, val set 0.971x speedup, step: 28, train time 8.89 s
Epoch 32/50 |loss: 0.134010| train set 3.426x speedup, test set 1.980x speedup, val set 0.723x speedup, step: 29, train time 8.82 s
Epoch 33/50 |loss: 0.132257| train set 3.299x speedup, test set 1.218x speedup, val set 0.909x speedup, step: 30, train time 8.72 s
Epoch 34/50 |loss: 0.132060| train set 3.416x speedup, test set 2.003x speedup, val set 0.707x speedup, step: 31, train time 8.71 s
Epoch 35/50 |loss: 0.129528| train set 3.266x speedup, test set 1.634x speedup, val set 0.659x speedup, step: 32, train time 8.79 s
Epoch 36/50 |loss: 0.129491| train set 3.382x speedup, test set 1.640x speedup, val set 0.659x speedup, step: 33, train time 8.79 s
Epoch 37/50 |loss: 0.128571| train set 3.183x speedup, test set 1.689x speedup, val set 0.791x speedup, step: 34, train time 9.00 s
Epoch 38/50 |loss: 0.124430| train set 3.201x speedup, test set 1.808x speedup, val set 0.724x speedup, step: 35, train time 8.82 s
Epoch 39/50 |loss: 0.120001| train set 3.341x speedup, test set 1.693x speedup, val set 0.773x speedup, step: 36, train time 8.80 s
Epoch 40/50 |loss: 0.123934| train set 3.414x speedup, test set 1.698x speedup, val set 0.773x speedup, step: 37, train time 8.79 s
Epoch 41/50 |loss: 0.117505| train set 3.213x speedup, test set 2.129x speedup, val set 0.793x speedup, step: 38, train time 8.79 s
Epoch 42/50 |loss: 0.119083| train set 3.324x speedup, test set 1.693x speedup, val set 0.824x speedup, step: 39, train time 8.80 s
Epoch 43/50 |loss: 0.121146| train set 3.430x speedup, test set 1.782x speedup, val set 0.773x speedup, step: 40, train time 8.90 s
Epoch 44/50 |loss: 0.115776| train set 3.187x speedup, test set 1.616x speedup, val set 0.821x speedup, step: 41, train time 8.89 s
Epoch 45/50 |loss: 0.112511| train set 3.310x speedup, test set 1.714x speedup, val set 0.801x speedup, step: 42, train time 8.82 s
Epoch 46/50 |loss: 0.110993| train set 3.487x speedup, test set 1.617x speedup, val set 0.801x speedup, step: 43, train time 8.80 s
Epoch 47/50 |loss: 0.112846| train set 3.201x speedup, test set 1.600x speedup, val set 0.766x speedup, step: 44, train time 8.91 s
Epoch 48/50 |loss: 0.115411| train set 3.453x speedup, test set 1.701x speedup, val set 0.792x speedup, step: 45, train time 9.00 s
Epoch 49/50 |loss: 0.107851| train set 3.405x speedup, test set 1.599x speedup, val set 0.800x speedup, step: 46, train time 8.82 s
Training per epoch cost 8.862 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
15, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 4.181s, pg runtime 0.391s, speedup 0.094x
25, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 46, train speedup 3.487, test speedup 1.617, val speedup 0.801
best test speedup epoch: 41, train speedup 3.213, test speedup 2.129, val speedup 0.793
best validation speedup epoch: 4, train speedup 2.757, test speedup 0.993, val speedup 1.030
last model at epoch 49, train speedup 3.405, test speedup 1.599, val speedup 0.800
execution cost 0:07:55.195943
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.356416, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426522| train set 2.186x speedup, test set 0.996x speedup, val set 0.793x speedup, step: 1, train time 10.27 s
Epoch 1/50 |loss: 0.343542| train set 2.516x speedup, test set 0.990x speedup, val set 0.730x speedup, step: 2, train time 8.90 s
Epoch 2/50 |loss: 0.312224| train set 2.268x speedup, test set 1.084x speedup, val set 1.015x speedup, step: 3, train time 9.37 s
Epoch 3/50 |loss: 0.287860| train set 2.803x speedup, test set 1.009x speedup, val set 0.936x speedup, step: 4, train time 8.98 s
Epoch 4/50 |loss: 0.269780| train set 2.923x speedup, test set 1.544x speedup, val set 1.030x speedup, step: 1, train time 9.00 s
Epoch 5/50 |loss: 0.251362| train set 2.723x speedup, test set 0.962x speedup, val set 0.936x speedup, step: 2, train time 9.00 s
Epoch 6/50 |loss: 0.234455| train set 3.079x speedup, test set 1.641x speedup, val set 1.016x speedup, step: 3, train time 8.90 s
Epoch 7/50 |loss: 0.229477| train set 3.198x speedup, test set 1.720x speedup, val set 1.003x speedup, step: 4, train time 8.99 s
Epoch 8/50 |loss: 0.219549| train set 3.257x speedup, test set 1.427x speedup, val set 0.714x speedup, step: 5, train time 9.18 s
Epoch 9/50 |loss: 0.217446| train set 2.929x speedup, test set 1.420x speedup, val set 0.910x speedup, step: 6, train time 8.98 s
Epoch 10/50 |loss: 0.206353| train set 2.830x speedup, test set 1.739x speedup, val set 0.954x speedup, step: 7, train time 8.93 s
Epoch 11/50 |loss: 0.200222| train set 3.245x speedup, test set 1.579x speedup, val set 1.128x speedup, step: 8, train time 9.08 s
Epoch 12/50 |loss: 0.198461| train set 2.787x speedup, test set 1.440x speedup, val set 0.983x speedup, step: 9, train time 9.00 s
Epoch 13/50 |loss: 0.192698| train set 2.697x speedup, test set 1.006x speedup, val set 0.955x speedup, step: 10, train time 8.98 s
Epoch 14/50 |loss: 0.191421| train set 3.309x speedup, test set 1.534x speedup, val set 0.987x speedup, step: 11, train time 9.40 s
Epoch 15/50 |loss: 0.185124| train set 3.139x speedup, test set 1.510x speedup, val set 1.186x speedup, step: 12, train time 9.18 s
Epoch 16/50 |loss: 0.176499| train set 3.251x speedup, test set 1.518x speedup, val set 0.988x speedup, step: 13, train time 9.18 s
Epoch 17/50 |loss: 0.177915| train set 2.826x speedup, test set 1.498x speedup, val set 0.800x speedup, step: 14, train time 8.98 s
Epoch 18/50 |loss: 0.173899| train set 3.037x speedup, test set 1.513x speedup, val set 1.075x speedup, step: 15, train time 9.12 s
Epoch 19/50 |loss: 0.172349| train set 3.296x speedup, test set 1.204x speedup, val set 0.714x speedup, step: 16, train time 9.01 s
Epoch 20/50 |loss: 0.166441| train set 3.263x speedup, test set 1.509x speedup, val set 0.801x speedup, step: 17, train time 9.02 s
Epoch 21/50 |loss: 0.159738| train set 3.142x speedup, test set 1.170x speedup, val set 0.934x speedup, step: 18, train time 9.20 s
Epoch 22/50 |loss: 0.164257| train set 3.359x speedup, test set 1.479x speedup, val set 0.792x speedup, step: 19, train time 9.21 s
Epoch 23/50 |loss: 0.153554| train set 3.350x speedup, test set 1.475x speedup, val set 0.767x speedup, step: 20, train time 9.20 s
Epoch 24/50 |loss: 0.150639| train set 3.135x speedup, test set 1.525x speedup, val set 0.785x speedup, step: 21, train time 9.21 s
Epoch 25/50 |loss: 0.154554| train set 3.048x speedup, test set 1.460x speedup, val set 0.974x speedup, step: 22, train time 9.11 s
Epoch 26/50 |loss: 0.151569| train set 2.956x speedup, test set 0.962x speedup, val set 0.727x speedup, step: 23, train time 9.20 s
Epoch 27/50 |loss: 0.147781| train set 3.374x speedup, test set 1.494x speedup, val set 0.926x speedup, step: 24, train time 9.20 s
Epoch 28/50 |loss: 0.141869| train set 3.222x speedup, test set 1.595x speedup, val set 0.749x speedup, step: 25, train time 9.20 s
Epoch 29/50 |loss: 0.145889| train set 3.279x speedup, test set 1.627x speedup, val set 0.722x speedup, step: 26, train time 9.09 s
Epoch 30/50 |loss: 0.140049| train set 3.284x speedup, test set 1.216x speedup, val set 0.820x speedup, step: 27, train time 9.00 s
Epoch 31/50 |loss: 0.141951| train set 3.195x speedup, test set 1.638x speedup, val set 0.701x speedup, step: 28, train time 9.00 s
Epoch 32/50 |loss: 0.135764| train set 3.437x speedup, test set 1.548x speedup, val set 0.896x speedup, step: 29, train time 9.10 s
Epoch 33/50 |loss: 0.135321| train set 3.284x speedup, test set 1.100x speedup, val set 1.019x speedup, step: 30, train time 9.11 s
Epoch 34/50 |loss: 0.138851| train set 3.346x speedup, test set 1.130x speedup, val set 0.858x speedup, step: 31, train time 9.30 s
Epoch 35/50 |loss: 0.131510| train set 3.349x speedup, test set 1.026x speedup, val set 0.680x speedup, step: 32, train time 9.12 s
Epoch 36/50 |loss: 0.137105| train set 3.326x speedup, test set 1.104x speedup, val set 0.779x speedup, step: 33, train time 9.20 s
Epoch 37/50 |loss: 0.131410| train set 3.286x speedup, test set 1.473x speedup, val set 1.007x speedup, step: 34, train time 9.10 s
Epoch 38/50 |loss: 0.128727| train set 3.147x speedup, test set 1.102x speedup, val set 0.800x speedup, step: 35, train time 9.09 s
Epoch 39/50 |loss: 0.124113| train set 3.197x speedup, test set 1.486x speedup, val set 0.778x speedup, step: 36, train time 9.10 s
Epoch 40/50 |loss: 0.125014| train set 3.476x speedup, test set 1.606x speedup, val set 0.896x speedup, step: 37, train time 9.10 s
Epoch 41/50 |loss: 0.125053| train set 3.329x speedup, test set 1.202x speedup, val set 0.859x speedup, step: 38, train time 9.18 s
Epoch 42/50 |loss: 0.120598| train set 3.145x speedup, test set 1.548x speedup, val set 0.836x speedup, step: 39, train time 9.28 s
Epoch 43/50 |loss: 0.121995| train set 3.392x speedup, test set 1.466x speedup, val set 0.794x speedup, step: 40, train time 9.19 s
Epoch 44/50 |loss: 0.121190| train set 3.317x speedup, test set 1.006x speedup, val set 0.674x speedup, step: 41, train time 9.20 s
Epoch 45/50 |loss: 0.114580| train set 3.246x speedup, test set 1.210x speedup, val set 0.769x speedup, step: 42, train time 9.11 s
Epoch 46/50 |loss: 0.112094| train set 3.504x speedup, test set 1.481x speedup, val set 0.769x speedup, step: 43, train time 9.01 s
Epoch 47/50 |loss: 0.113373| train set 3.301x speedup, test set 1.464x speedup, val set 0.873x speedup, step: 44, train time 9.22 s
Epoch 48/50 |loss: 0.115609| train set 3.297x speedup, test set 1.104x speedup, val set 0.850x speedup, step: 45, train time 9.18 s
Epoch 49/50 |loss: 0.110154| train set 3.460x speedup, test set 1.543x speedup, val set 0.977x speedup, step: 46, train time 9.00 s
Training per epoch cost 9.133 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.487s, pg runtime 0.404s, speedup 0.830x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.667s, pg runtime 0.189s, speedup 0.284x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.256s, pg runtime 0.158s, speedup 0.620x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 4.181s, pg runtime 0.391s, speedup 0.094x
25, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 46, train speedup 3.504, test speedup 1.481, val speedup 0.769
best test speedup epoch: 10, train speedup 2.830, test speedup 1.739, val speedup 0.954
best validation speedup epoch: 4, train speedup 2.923, test speedup 1.544, val speedup 1.030
last model at epoch 49, train speedup 3.460, test speedup 1.543, val speedup 0.977
execution cost 0:08:07.624698
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.285470, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427211| train set 1.442x speedup, test set 0.969x speedup, val set 0.997x speedup, step: 1, train time 10.31 s
Epoch 1/50 |loss: 0.346194| train set 2.342x speedup, test set 0.989x speedup, val set 0.812x speedup, step: 2, train time 8.91 s
Epoch 2/50 |loss: 0.317570| train set 2.361x speedup, test set 1.198x speedup, val set 1.034x speedup, step: 3, train time 9.00 s
Epoch 3/50 |loss: 0.294942| train set 2.938x speedup, test set 1.008x speedup, val set 0.898x speedup, step: 4, train time 9.27 s
Epoch 4/50 |loss: 0.276861| train set 2.626x speedup, test set 1.021x speedup, val set 1.767x speedup, step: 1, train time 8.91 s
Epoch 5/50 |loss: 0.256438| train set 2.857x speedup, test set 1.005x speedup, val set 1.002x speedup, step: 2, train time 8.91 s
Epoch 6/50 |loss: 0.240466| train set 2.771x speedup, test set 1.013x speedup, val set 0.985x speedup, step: 3, train time 9.08 s
Epoch 7/50 |loss: 0.238626| train set 3.289x speedup, test set 1.752x speedup, val set 0.989x speedup, step: 4, train time 8.88 s
Epoch 8/50 |loss: 0.224839| train set 3.274x speedup, test set 1.551x speedup, val set 1.029x speedup, step: 5, train time 8.90 s
Epoch 9/50 |loss: 0.223990| train set 3.097x speedup, test set 1.660x speedup, val set 0.886x speedup, step: 6, train time 8.98 s
Epoch 10/50 |loss: 0.208679| train set 2.688x speedup, test set 1.129x speedup, val set 0.792x speedup, step: 7, train time 8.92 s
Epoch 11/50 |loss: 0.200817| train set 3.149x speedup, test set 1.668x speedup, val set 0.959x speedup, step: 8, train time 9.00 s
Epoch 12/50 |loss: 0.198608| train set 3.043x speedup, test set 1.460x speedup, val set 0.922x speedup, step: 9, train time 9.02 s
Epoch 13/50 |loss: 0.196694| train set 2.930x speedup, test set 1.487x speedup, val set 0.886x speedup, step: 10, train time 9.00 s
Epoch 14/50 |loss: 0.191262| train set 3.317x speedup, test set 1.560x speedup, val set 0.877x speedup, step: 11, train time 9.29 s
Epoch 15/50 |loss: 0.189441| train set 3.195x speedup, test set 1.741x speedup, val set 1.031x speedup, step: 12, train time 9.00 s
Epoch 16/50 |loss: 0.176939| train set 3.349x speedup, test set 1.594x speedup, val set 1.130x speedup, step: 13, train time 9.01 s
Epoch 17/50 |loss: 0.179132| train set 2.720x speedup, test set 1.573x speedup, val set 0.768x speedup, step: 14, train time 9.19 s
Epoch 18/50 |loss: 0.173545| train set 3.148x speedup, test set 1.554x speedup, val set 0.992x speedup, step: 15, train time 9.20 s
Epoch 19/50 |loss: 0.170494| train set 3.087x speedup, test set 0.959x speedup, val set 1.019x speedup, step: 16, train time 9.10 s
Epoch 20/50 |loss: 0.168982| train set 3.176x speedup, test set 1.536x speedup, val set 0.922x speedup, step: 17, train time 9.18 s
Epoch 21/50 |loss: 0.160441| train set 3.088x speedup, test set 1.019x speedup, val set 0.925x speedup, step: 18, train time 9.27 s
Epoch 22/50 |loss: 0.161754| train set 3.191x speedup, test set 1.697x speedup, val set 1.118x speedup, step: 19, train time 9.20 s
Epoch 23/50 |loss: 0.156162| train set 3.376x speedup, test set 1.565x speedup, val set 0.756x speedup, step: 20, train time 9.01 s
Epoch 24/50 |loss: 0.149544| train set 3.288x speedup, test set 1.523x speedup, val set 0.756x speedup, step: 21, train time 9.18 s
Epoch 25/50 |loss: 0.152752| train set 3.238x speedup, test set 1.634x speedup, val set 0.661x speedup, step: 22, train time 9.03 s
Epoch 26/50 |loss: 0.150277| train set 3.154x speedup, test set 0.968x speedup, val set 0.994x speedup, step: 23, train time 9.29 s
Epoch 27/50 |loss: 0.148590| train set 3.244x speedup, test set 1.477x speedup, val set 1.032x speedup, step: 24, train time 9.01 s
Epoch 28/50 |loss: 0.141961| train set 3.372x speedup, test set 1.525x speedup, val set 2.133x speedup, step: 25, train time 9.28 s
Epoch 29/50 |loss: 0.145638| train set 3.231x speedup, test set 1.205x speedup, val set 0.674x speedup, step: 26, train time 9.38 s
Epoch 30/50 |loss: 0.138324| train set 3.217x speedup, test set 1.204x speedup, val set 1.032x speedup, step: 27, train time 9.21 s
Epoch 31/50 |loss: 0.141073| train set 3.202x speedup, test set 1.710x speedup, val set 0.715x speedup, step: 28, train time 9.03 s
Epoch 32/50 |loss: 0.133775| train set 3.384x speedup, test set 1.474x speedup, val set 1.051x speedup, step: 29, train time 9.10 s
Epoch 33/50 |loss: 0.133776| train set 3.339x speedup, test set 1.019x speedup, val set 1.051x speedup, step: 30, train time 9.30 s
Epoch 34/50 |loss: 0.132444| train set 3.324x speedup, test set 1.208x speedup, val set 0.975x speedup, step: 31, train time 9.11 s
Epoch 35/50 |loss: 0.129826| train set 3.289x speedup, test set 1.246x speedup, val set 1.034x speedup, step: 32, train time 9.09 s
Epoch 36/50 |loss: 0.130510| train set 3.345x speedup, test set 1.048x speedup, val set 0.773x speedup, step: 33, train time 9.18 s
Epoch 37/50 |loss: 0.130462| train set 3.378x speedup, test set 1.246x speedup, val set 0.731x speedup, step: 34, train time 9.28 s
Epoch 38/50 |loss: 0.126619| train set 3.249x speedup, test set 0.962x speedup, val set 0.701x speedup, step: 35, train time 8.99 s
Epoch 39/50 |loss: 0.123712| train set 3.363x speedup, test set 1.204x speedup, val set 0.701x speedup, step: 36, train time 9.00 s
Epoch 40/50 |loss: 0.128202| train set 3.453x speedup, test set 1.228x speedup, val set 1.032x speedup, step: 37, train time 9.09 s
Epoch 41/50 |loss: 0.122444| train set 3.273x speedup, test set 1.018x speedup, val set 1.033x speedup, step: 38, train time 9.09 s
Epoch 42/50 |loss: 0.122175| train set 3.454x speedup, test set 1.202x speedup, val set 0.700x speedup, step: 39, train time 9.18 s
Epoch 43/50 |loss: 0.125835| train set 3.399x speedup, test set 1.248x speedup, val set 0.701x speedup, step: 40, train time 9.18 s
Epoch 44/50 |loss: 0.118361| train set 3.297x speedup, test set 1.145x speedup, val set 0.731x speedup, step: 41, train time 9.21 s
Epoch 45/50 |loss: 0.116528| train set 3.305x speedup, test set 1.205x speedup, val set 1.032x speedup, step: 42, train time 9.29 s
Epoch 46/50 |loss: 0.114369| train set 3.472x speedup, test set 1.294x speedup, val set 0.715x speedup, step: 43, train time 9.20 s
Epoch 47/50 |loss: 0.116673| train set 3.173x speedup, test set 1.321x speedup, val set 0.701x speedup, step: 44, train time 8.92 s
Epoch 48/50 |loss: 0.115445| train set 3.222x speedup, test set 0.961x speedup, val set 1.608x speedup, step: 45, train time 9.21 s
Epoch 49/50 |loss: 0.113721| train set 3.492x speedup, test set 1.319x speedup, val set 0.768x speedup, step: 46, train time 9.20 s
Training per epoch cost 9.132 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 4.477s, pg runtime 1.357s, speedup 0.303x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 49, train speedup 3.492, test speedup 1.319, val speedup 0.768
best test speedup epoch: 7, train speedup 3.289, test speedup 1.752, val speedup 0.989
best validation speedup epoch: 4, train speedup 2.626, test speedup 1.021, val speedup 1.767
last model at epoch 49, train speedup 3.492, test speedup 1.319, val speedup 0.768
execution cost 0:08:07.348035
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.075446, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426827| train set 2.335x speedup, test set 1.006x speedup, val set 0.796x speedup, step: 1, train time 10.29 s
Epoch 1/50 |loss: 0.344302| train set 2.180x speedup, test set 0.945x speedup, val set 0.729x speedup, step: 2, train time 8.90 s
Epoch 2/50 |loss: 0.315184| train set 2.370x speedup, test set 1.068x speedup, val set 1.015x speedup, step: 3, train time 9.21 s
Epoch 3/50 |loss: 0.292962| train set 2.502x speedup, test set 1.018x speedup, val set 1.003x speedup, step: 4, train time 9.08 s
Epoch 4/50 |loss: 0.274497| train set 2.975x speedup, test set 1.607x speedup, val set 1.030x speedup, step: 1, train time 8.90 s
Epoch 5/50 |loss: 0.257411| train set 2.600x speedup, test set 1.133x speedup, val set 1.016x speedup, step: 2, train time 8.91 s
Epoch 6/50 |loss: 0.240802| train set 2.958x speedup, test set 1.159x speedup, val set 1.015x speedup, step: 3, train time 8.90 s
Epoch 7/50 |loss: 0.235390| train set 3.070x speedup, test set 1.144x speedup, val set 0.877x speedup, step: 4, train time 8.91 s
Epoch 8/50 |loss: 0.227593| train set 3.155x speedup, test set 1.076x speedup, val set 1.008x speedup, step: 5, train time 8.97 s
Epoch 9/50 |loss: 0.221885| train set 3.096x speedup, test set 1.245x speedup, val set 1.016x speedup, step: 6, train time 8.90 s
Epoch 10/50 |loss: 0.209967| train set 2.771x speedup, test set 1.065x speedup, val set 1.016x speedup, step: 7, train time 8.92 s
Epoch 11/50 |loss: 0.205017| train set 3.238x speedup, test set 1.636x speedup, val set 1.107x speedup, step: 8, train time 8.92 s
Epoch 12/50 |loss: 0.199709| train set 2.606x speedup, test set 1.097x speedup, val set 0.799x speedup, step: 9, train time 8.98 s
Epoch 13/50 |loss: 0.195557| train set 2.856x speedup, test set 1.393x speedup, val set 0.854x speedup, step: 10, train time 9.10 s
Epoch 14/50 |loss: 0.191281| train set 3.323x speedup, test set 1.639x speedup, val set 0.757x speedup, step: 11, train time 9.39 s
Epoch 15/50 |loss: 0.185943| train set 3.270x speedup, test set 1.437x speedup, val set 1.040x speedup, step: 12, train time 9.18 s
Epoch 16/50 |loss: 0.176561| train set 3.276x speedup, test set 1.437x speedup, val set 0.859x speedup, step: 13, train time 9.00 s
Epoch 17/50 |loss: 0.180264| train set 3.086x speedup, test set 1.362x speedup, val set 0.748x speedup, step: 14, train time 9.08 s
Epoch 18/50 |loss: 0.173861| train set 2.966x speedup, test set 1.473x speedup, val set 0.786x speedup, step: 15, train time 9.09 s
Epoch 19/50 |loss: 0.170961| train set 3.219x speedup, test set 1.091x speedup, val set 0.800x speedup, step: 16, train time 9.10 s
Epoch 20/50 |loss: 0.161703| train set 3.208x speedup, test set 1.476x speedup, val set 0.801x speedup, step: 17, train time 9.20 s
Epoch 21/50 |loss: 0.160014| train set 3.068x speedup, test set 1.281x speedup, val set 0.781x speedup, step: 18, train time 9.10 s
Epoch 22/50 |loss: 0.162042| train set 3.301x speedup, test set 1.310x speedup, val set 0.985x speedup, step: 19, train time 9.17 s
Epoch 23/50 |loss: 0.151876| train set 3.259x speedup, test set 1.396x speedup, val set 0.812x speedup, step: 20, train time 9.20 s
Epoch 24/50 |loss: 0.146521| train set 3.072x speedup, test set 1.438x speedup, val set 0.859x speedup, step: 21, train time 9.19 s
Epoch 25/50 |loss: 0.152028| train set 3.293x speedup, test set 1.459x speedup, val set 0.780x speedup, step: 22, train time 9.29 s
Epoch 26/50 |loss: 0.148295| train set 2.871x speedup, test set 1.050x speedup, val set 0.800x speedup, step: 23, train time 9.19 s
Epoch 27/50 |loss: 0.145959| train set 3.284x speedup, test set 1.230x speedup, val set 0.985x speedup, step: 24, train time 9.39 s
Epoch 28/50 |loss: 0.138846| train set 3.203x speedup, test set 1.389x speedup, val set 0.837x speedup, step: 25, train time 9.39 s
Epoch 29/50 |loss: 0.143942| train set 3.126x speedup, test set 1.391x speedup, val set 0.697x speedup, step: 26, train time 9.39 s
Epoch 30/50 |loss: 0.141537| train set 3.250x speedup, test set 1.357x speedup, val set 0.771x speedup, step: 27, train time 9.30 s
Epoch 31/50 |loss: 0.137604| train set 3.157x speedup, test set 1.504x speedup, val set 1.077x speedup, step: 28, train time 9.48 s
Epoch 32/50 |loss: 0.128964| train set 3.343x speedup, test set 1.410x speedup, val set 0.771x speedup, step: 29, train time 9.20 s
Epoch 33/50 |loss: 0.128339| train set 3.281x speedup, test set 1.404x speedup, val set 0.956x speedup, step: 30, train time 9.39 s
Epoch 34/50 |loss: 0.131671| train set 3.295x speedup, test set 1.442x speedup, val set 0.781x speedup, step: 31, train time 9.40 s
Epoch 35/50 |loss: 0.125116| train set 3.229x speedup, test set 1.534x speedup, val set 0.859x speedup, step: 32, train time 9.11 s
Epoch 36/50 |loss: 0.128882| train set 3.207x speedup, test set 1.278x speedup, val set 0.786x speedup, step: 33, train time 9.30 s
Epoch 37/50 |loss: 0.122000| train set 3.377x speedup, test set 1.653x speedup, val set 1.076x speedup, step: 34, train time 9.07 s
Epoch 38/50 |loss: 0.124192| train set 2.843x speedup, test set 1.285x speedup, val set 0.781x speedup, step: 35, train time 9.28 s
Epoch 39/50 |loss: 0.120396| train set 3.375x speedup, test set 1.513x speedup, val set 1.113x speedup, step: 1, train time 9.32 s
Epoch 40/50 |loss: 0.121414| train set 3.414x speedup, test set 1.477x speedup, val set 1.058x speedup, step: 2, train time 9.09 s
Epoch 41/50 |loss: 0.118566| train set 3.161x speedup, test set 1.608x speedup, val set 0.800x speedup, step: 3, train time 9.20 s
Epoch 42/50 |loss: 0.120880| train set 3.455x speedup, test set 1.513x speedup, val set 0.836x speedup, step: 4, train time 9.20 s
Epoch 43/50 |loss: 0.118172| train set 3.392x speedup, test set 1.617x speedup, val set 0.859x speedup, step: 5, train time 9.20 s
Epoch 44/50 |loss: 0.111664| train set 3.321x speedup, test set 1.399x speedup, val set 0.969x speedup, step: 6, train time 9.38 s
Epoch 45/50 |loss: 0.108155| train set 3.307x speedup, test set 1.609x speedup, val set 0.757x speedup, step: 7, train time 9.30 s
Epoch 46/50 |loss: 0.107984| train set 3.331x speedup, test set 1.647x speedup, val set 0.948x speedup, step: 8, train time 9.30 s
Epoch 47/50 |loss: 0.111892| train set 3.408x speedup, test set 1.568x speedup, val set 0.866x speedup, step: 9, train time 9.12 s
Epoch 48/50 |loss: 0.112521| train set 3.434x speedup, test set 1.513x speedup, val set 0.844x speedup, step: 10, train time 9.20 s
Epoch 49/50 |loss: 0.105911| train set 3.392x speedup, test set 1.580x speedup, val set 1.039x speedup, step: 11, train time 9.10 s
Training per epoch cost 9.184 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.430s, pg runtime 1.437s, speedup 0.419x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.281s, pg runtime 1.357s, speedup 1.059x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 42, train speedup 3.455, test speedup 1.513, val speedup 0.836
best test speedup epoch: 37, train speedup 3.377, test speedup 1.653, val speedup 1.076
best validation speedup epoch: 39, train speedup 3.375, test speedup 1.513, val speedup 1.113
last model at epoch 49, train speedup 3.392, test speedup 1.580, val speedup 1.039
execution cost 0:08:10.336189
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.142070, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.426973| train set 1.441x speedup, test set 0.995x speedup, val set 0.796x speedup, step: 1, train time 10.21 s
Epoch 1/50 |loss: 0.347332| train set 2.455x speedup, test set 0.989x speedup, val set 0.727x speedup, step: 2, train time 8.89 s
Epoch 2/50 |loss: 0.316097| train set 2.416x speedup, test set 1.002x speedup, val set 0.984x speedup, step: 3, train time 8.80 s
Epoch 3/50 |loss: 0.294086| train set 2.564x speedup, test set 1.008x speedup, val set 0.936x speedup, step: 4, train time 8.72 s
Epoch 4/50 |loss: 0.274750| train set 2.572x speedup, test set 1.084x speedup, val set 1.768x speedup, step: 1, train time 8.80 s
Epoch 5/50 |loss: 0.257634| train set 2.815x speedup, test set 0.922x speedup, val set 1.641x speedup, step: 2, train time 8.59 s
Epoch 6/50 |loss: 0.241242| train set 2.676x speedup, test set 1.105x speedup, val set 0.937x speedup, step: 3, train time 8.80 s
Epoch 7/50 |loss: 0.239614| train set 2.659x speedup, test set 0.986x speedup, val set 0.985x speedup, step: 4, train time 8.92 s
Epoch 8/50 |loss: 0.226143| train set 3.122x speedup, test set 0.895x speedup, val set 1.641x speedup, step: 5, train time 8.89 s
Epoch 9/50 |loss: 0.223435| train set 2.924x speedup, test set 1.001x speedup, val set 0.910x speedup, step: 6, train time 8.73 s
Epoch 10/50 |loss: 0.211799| train set 2.585x speedup, test set 0.915x speedup, val set 1.042x speedup, step: 7, train time 8.81 s
Epoch 11/50 |loss: 0.204033| train set 3.058x speedup, test set 1.770x speedup, val set 1.046x speedup, step: 8, train time 8.89 s
Epoch 12/50 |loss: 0.205209| train set 2.876x speedup, test set 1.415x speedup, val set 0.911x speedup, step: 9, train time 8.88 s
Epoch 13/50 |loss: 0.196684| train set 2.899x speedup, test set 1.268x speedup, val set 0.886x speedup, step: 10, train time 8.79 s
Epoch 14/50 |loss: 0.194249| train set 3.280x speedup, test set 1.673x speedup, val set 0.886x speedup, step: 11, train time 9.20 s
Epoch 15/50 |loss: 0.187879| train set 3.067x speedup, test set 1.741x speedup, val set 0.875x speedup, step: 12, train time 8.79 s
Epoch 16/50 |loss: 0.180482| train set 3.262x speedup, test set 1.425x speedup, val set 1.043x speedup, step: 13, train time 8.71 s
Epoch 17/50 |loss: 0.179976| train set 3.142x speedup, test set 1.418x speedup, val set 0.901x speedup, step: 14, train time 8.88 s
Epoch 18/50 |loss: 0.175493| train set 3.190x speedup, test set 1.276x speedup, val set 0.901x speedup, step: 15, train time 8.70 s
Epoch 19/50 |loss: 0.172456| train set 3.285x speedup, test set 0.922x speedup, val set 0.948x speedup, step: 16, train time 8.79 s
Epoch 20/50 |loss: 0.169177| train set 3.232x speedup, test set 1.356x speedup, val set 0.901x speedup, step: 17, train time 8.81 s
Epoch 21/50 |loss: 0.162043| train set 3.229x speedup, test set 1.399x speedup, val set 0.873x speedup, step: 18, train time 8.79 s
Epoch 22/50 |loss: 0.160766| train set 3.305x speedup, test set 1.259x speedup, val set 0.743x speedup, step: 19, train time 8.80 s
Epoch 23/50 |loss: 0.155742| train set 3.432x speedup, test set 1.425x speedup, val set 0.799x speedup, step: 20, train time 8.70 s
Epoch 24/50 |loss: 0.148852| train set 3.121x speedup, test set 1.433x speedup, val set 0.794x speedup, step: 21, train time 8.70 s
Epoch 25/50 |loss: 0.154919| train set 3.257x speedup, test set 1.108x speedup, val set 0.741x speedup, step: 22, train time 8.83 s
Epoch 26/50 |loss: 0.150072| train set 2.960x speedup, test set 0.916x speedup, val set 0.743x speedup, step: 23, train time 8.79 s
Epoch 27/50 |loss: 0.145992| train set 3.376x speedup, test set 1.435x speedup, val set 0.743x speedup, step: 24, train time 8.81 s
Epoch 28/50 |loss: 0.139882| train set 3.186x speedup, test set 1.374x speedup, val set 0.743x speedup, step: 25, train time 8.80 s
Epoch 29/50 |loss: 0.145607| train set 3.302x speedup, test set 1.190x speedup, val set 0.897x speedup, step: 26, train time 8.90 s
Epoch 30/50 |loss: 0.141457| train set 3.249x speedup, test set 1.196x speedup, val set 0.945x speedup, step: 27, train time 8.80 s
Epoch 31/50 |loss: 0.142004| train set 3.319x speedup, test set 1.277x speedup, val set 0.886x speedup, step: 28, train time 8.78 s
Epoch 32/50 |loss: 0.130589| train set 3.315x speedup, test set 1.423x speedup, val set 0.973x speedup, step: 29, train time 8.90 s
Epoch 33/50 |loss: 0.131104| train set 3.273x speedup, test set 1.187x speedup, val set 0.876x speedup, step: 30, train time 8.79 s
Epoch 34/50 |loss: 0.133650| train set 3.407x speedup, test set 1.618x speedup, val set 0.699x speedup, step: 31, train time 8.72 s
Epoch 35/50 |loss: 0.127354| train set 3.295x speedup, test set 1.003x speedup, val set 0.741x speedup, step: 32, train time 8.80 s
Epoch 36/50 |loss: 0.129799| train set 3.363x speedup, test set 1.213x speedup, val set 0.743x speedup, step: 33, train time 8.69 s
Epoch 37/50 |loss: 0.130854| train set 3.124x speedup, test set 1.461x speedup, val set 0.972x speedup, step: 34, train time 8.79 s
Epoch 38/50 |loss: 0.126013| train set 3.144x speedup, test set 1.013x speedup, val set 0.741x speedup, step: 35, train time 8.82 s
Epoch 39/50 |loss: 0.118795| train set 3.399x speedup, test set 1.475x speedup, val set 0.794x speedup, step: 36, train time 8.80 s
Epoch 40/50 |loss: 0.124786| train set 3.421x speedup, test set 1.461x speedup, val set 0.973x speedup, step: 37, train time 8.90 s
Epoch 41/50 |loss: 0.121036| train set 3.290x speedup, test set 1.438x speedup, val set 0.727x speedup, step: 38, train time 8.81 s
Epoch 42/50 |loss: 0.120543| train set 3.468x speedup, test set 1.510x speedup, val set 0.794x speedup, step: 39, train time 8.80 s
Epoch 43/50 |loss: 0.118969| train set 3.438x speedup, test set 1.427x speedup, val set 0.741x speedup, step: 40, train time 8.79 s
Epoch 44/50 |loss: 0.118365| train set 3.200x speedup, test set 1.356x speedup, val set 0.748x speedup, step: 41, train time 8.89 s
Epoch 45/50 |loss: 0.112345| train set 3.429x speedup, test set 1.541x speedup, val set 0.708x speedup, step: 42, train time 8.81 s
Epoch 46/50 |loss: 0.109624| train set 3.311x speedup, test set 1.593x speedup, val set 0.716x speedup, step: 43, train time 8.79 s
Epoch 47/50 |loss: 0.109784| train set 3.466x speedup, test set 1.543x speedup, val set 0.743x speedup, step: 44, train time 8.72 s
Epoch 48/50 |loss: 0.116392| train set 3.436x speedup, test set 1.455x speedup, val set 0.726x speedup, step: 45, train time 8.82 s
Epoch 49/50 |loss: 0.109769| train set 3.398x speedup, test set 1.367x speedup, val set 0.974x speedup, step: 46, train time 8.72 s
Training per epoch cost 8.833 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.245s, pg runtime 0.189s, speedup 0.774x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 42, train speedup 3.468, test speedup 1.510, val speedup 0.794
best test speedup epoch: 11, train speedup 3.058, test speedup 1.770, val speedup 1.046
best validation speedup epoch: 4, train speedup 2.572, test speedup 1.084, val speedup 1.768
last model at epoch 49, train speedup 3.398, test speedup 1.367, val speedup 0.974
execution cost 0:07:54.047826
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.102619, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427613| train set 1.496x speedup, test set 0.987x speedup, val set 0.801x speedup, step: 1, train time 10.36 s
Epoch 1/50 |loss: 0.347009| train set 2.335x speedup, test set 0.989x speedup, val set 0.800x speedup, step: 2, train time 8.80 s
Epoch 2/50 |loss: 0.319714| train set 2.279x speedup, test set 1.065x speedup, val set 0.900x speedup, step: 3, train time 9.08 s
Epoch 3/50 |loss: 0.296244| train set 2.442x speedup, test set 1.028x speedup, val set 0.889x speedup, step: 4, train time 8.78 s
Epoch 4/50 |loss: 0.277178| train set 2.671x speedup, test set 1.028x speedup, val set 1.030x speedup, step: 1, train time 8.98 s
Epoch 5/50 |loss: 0.256661| train set 2.691x speedup, test set 1.621x speedup, val set 0.901x speedup, step: 2, train time 8.82 s
Epoch 6/50 |loss: 0.241972| train set 2.576x speedup, test set 1.074x speedup, val set 1.016x speedup, step: 3, train time 9.07 s
Epoch 7/50 |loss: 0.238042| train set 2.906x speedup, test set 1.139x speedup, val set 0.957x speedup, step: 4, train time 9.00 s
Epoch 8/50 |loss: 0.226162| train set 3.355x speedup, test set 1.573x speedup, val set 0.998x speedup, step: 5, train time 8.89 s
Epoch 9/50 |loss: 0.223775| train set 2.923x speedup, test set 1.115x speedup, val set 1.002x speedup, step: 6, train time 8.90 s
Epoch 10/50 |loss: 0.209352| train set 2.627x speedup, test set 1.115x speedup, val set 1.008x speedup, step: 7, train time 9.08 s
Epoch 11/50 |loss: 0.204091| train set 3.169x speedup, test set 2.093x speedup, val set 1.146x speedup, step: 8, train time 8.81 s
Epoch 12/50 |loss: 0.202396| train set 2.617x speedup, test set 1.348x speedup, val set 0.983x speedup, step: 9, train time 8.92 s
Epoch 13/50 |loss: 0.199396| train set 2.952x speedup, test set 1.390x speedup, val set 0.954x speedup, step: 10, train time 8.98 s
Epoch 14/50 |loss: 0.196309| train set 3.269x speedup, test set 1.626x speedup, val set 1.002x speedup, step: 11, train time 9.22 s
Epoch 15/50 |loss: 0.191878| train set 3.156x speedup, test set 1.785x speedup, val set 1.104x speedup, step: 12, train time 8.90 s
Epoch 16/50 |loss: 0.179587| train set 3.181x speedup, test set 1.507x speedup, val set 0.970x speedup, step: 13, train time 8.89 s
Epoch 17/50 |loss: 0.180710| train set 3.191x speedup, test set 1.502x speedup, val set 0.710x speedup, step: 14, train time 8.98 s
Epoch 18/50 |loss: 0.175718| train set 3.165x speedup, test set 1.535x speedup, val set 0.781x speedup, step: 15, train time 9.00 s
Epoch 19/50 |loss: 0.173458| train set 3.303x speedup, test set 1.117x speedup, val set 1.010x speedup, step: 16, train time 8.82 s
Epoch 20/50 |loss: 0.169209| train set 3.223x speedup, test set 1.509x speedup, val set 0.776x speedup, step: 17, train time 9.00 s
Epoch 21/50 |loss: 0.160044| train set 3.083x speedup, test set 1.576x speedup, val set 0.910x speedup, step: 18, train time 8.72 s
Epoch 22/50 |loss: 0.164844| train set 3.196x speedup, test set 1.630x speedup, val set 0.757x speedup, step: 19, train time 9.00 s
Epoch 23/50 |loss: 0.156863| train set 3.230x speedup, test set 1.520x speedup, val set 0.750x speedup, step: 20, train time 8.91 s
Epoch 24/50 |loss: 0.151807| train set 2.812x speedup, test set 1.624x speedup, val set 0.751x speedup, step: 21, train time 9.01 s
Epoch 25/50 |loss: 0.152838| train set 3.240x speedup, test set 1.740x speedup, val set 0.836x speedup, step: 22, train time 8.91 s
Epoch 26/50 |loss: 0.150630| train set 2.866x speedup, test set 1.032x speedup, val set 0.781x speedup, step: 23, train time 8.91 s
Epoch 27/50 |loss: 0.149116| train set 3.343x speedup, test set 1.479x speedup, val set 0.751x speedup, step: 24, train time 9.08 s
Epoch 28/50 |loss: 0.141777| train set 3.357x speedup, test set 1.646x speedup, val set 0.751x speedup, step: 25, train time 8.98 s
Epoch 29/50 |loss: 0.141785| train set 3.240x speedup, test set 1.503x speedup, val set 0.701x speedup, step: 26, train time 8.99 s
Epoch 30/50 |loss: 0.142041| train set 3.241x speedup, test set 1.476x speedup, val set 2.000x speedup, step: 27, train time 9.10 s
Epoch 31/50 |loss: 0.140111| train set 3.323x speedup, test set 1.650x speedup, val set 1.000x speedup, step: 28, train time 9.00 s
Epoch 32/50 |loss: 0.132594| train set 3.417x speedup, test set 1.772x speedup, val set 1.105x speedup, step: 29, train time 9.08 s
Epoch 33/50 |loss: 0.131346| train set 3.251x speedup, test set 1.500x speedup, val set 1.002x speedup, step: 30, train time 8.92 s
Epoch 34/50 |loss: 0.131540| train set 3.397x speedup, test set 1.970x speedup, val set 1.107x speedup, step: 1, train time 9.08 s
Epoch 35/50 |loss: 0.128783| train set 3.216x speedup, test set 1.563x speedup, val set 0.707x speedup, step: 2, train time 8.83 s
Epoch 36/50 |loss: 0.128321| train set 3.343x speedup, test set 1.206x speedup, val set 0.701x speedup, step: 3, train time 8.88 s
Epoch 37/50 |loss: 0.125811| train set 3.177x speedup, test set 1.610x speedup, val set 0.764x speedup, step: 4, train time 9.08 s
Epoch 38/50 |loss: 0.126576| train set 3.215x speedup, test set 1.223x speedup, val set 0.794x speedup, step: 5, train time 8.90 s
Epoch 39/50 |loss: 0.119858| train set 3.386x speedup, test set 1.456x speedup, val set 1.001x speedup, step: 6, train time 9.02 s
Epoch 40/50 |loss: 0.126376| train set 3.427x speedup, test set 1.766x speedup, val set 2.000x speedup, step: 7, train time 8.90 s
Epoch 41/50 |loss: 0.118768| train set 3.154x speedup, test set 1.327x speedup, val set 0.776x speedup, step: 8, train time 8.88 s
Epoch 42/50 |loss: 0.118544| train set 3.465x speedup, test set 1.665x speedup, val set 0.700x speedup, step: 9, train time 8.98 s
Epoch 43/50 |loss: 0.119365| train set 3.302x speedup, test set 1.663x speedup, val set 0.701x speedup, step: 10, train time 9.08 s
Epoch 44/50 |loss: 0.114527| train set 3.287x speedup, test set 1.663x speedup, val set 0.977x speedup, step: 11, train time 9.08 s
Epoch 45/50 |loss: 0.114428| train set 3.233x speedup, test set 1.748x speedup, val set 0.701x speedup, step: 12, train time 8.98 s
Epoch 46/50 |loss: 0.111679| train set 3.455x speedup, test set 1.660x speedup, val set 0.700x speedup, step: 13, train time 8.92 s
Epoch 47/50 |loss: 0.110096| train set 3.251x speedup, test set 1.665x speedup, val set 0.775x speedup, step: 14, train time 9.08 s
Epoch 48/50 |loss: 0.114274| train set 3.462x speedup, test set 1.512x speedup, val set 0.774x speedup, step: 15, train time 8.81 s
Epoch 49/50 |loss: 0.110123| train set 3.389x speedup, test set 2.047x speedup, val set 0.975x speedup, step: 16, train time 9.01 s
Training per epoch cost 8.987 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.186s, pg runtime 0.189s, speedup 1.017x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 2.274s, pg runtime 0.404s, speedup 0.178x
04, opt runtime 0.637s, model runtime 0.912s, pg runtime 0.637s, speedup 0.699x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.087s, pg runtime 0.661s, speedup 0.608x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.281s, pg runtime 1.357s, speedup 1.059x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 4.251s, pg runtime 3.112s, speedup 0.732x
21, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.961x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 42, train speedup 3.465, test speedup 1.665, val speedup 0.700
best test speedup epoch: 11, train speedup 3.169, test speedup 2.093, val speedup 1.146
best validation speedup epoch: 34, train speedup 3.397, test speedup 1.970, val speedup 1.107
last model at epoch 49, train speedup 3.389, test speedup 2.047, val speedup 0.975
execution cost 0:07:59.154974
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.087434, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.425477| train set 2.097x speedup, test set 0.997x speedup, val set 0.796x speedup, step: 1, train time 10.17 s
Epoch 1/50 |loss: 0.345289| train set 2.532x speedup, test set 0.987x speedup, val set 0.801x speedup, step: 2, train time 8.99 s
Epoch 2/50 |loss: 0.316883| train set 2.354x speedup, test set 1.006x speedup, val set 1.691x speedup, step: 3, train time 8.87 s
Epoch 3/50 |loss: 0.291475| train set 2.417x speedup, test set 1.009x speedup, val set 0.926x speedup, step: 4, train time 8.70 s
Epoch 4/50 |loss: 0.277229| train set 2.880x speedup, test set 0.998x speedup, val set 1.770x speedup, step: 1, train time 8.78 s
Epoch 5/50 |loss: 0.252967| train set 2.748x speedup, test set 1.491x speedup, val set 0.936x speedup, step: 2, train time 8.72 s
Epoch 6/50 |loss: 0.240494| train set 2.811x speedup, test set 1.637x speedup, val set 0.936x speedup, step: 3, train time 8.80 s
Epoch 7/50 |loss: 0.235467| train set 3.192x speedup, test set 1.206x speedup, val set 0.910x speedup, step: 4, train time 8.70 s
Epoch 8/50 |loss: 0.225743| train set 3.311x speedup, test set 1.113x speedup, val set 0.947x speedup, step: 5, train time 8.98 s
Epoch 9/50 |loss: 0.220247| train set 3.240x speedup, test set 1.489x speedup, val set 0.910x speedup, step: 6, train time 9.13 s
Epoch 10/50 |loss: 0.205634| train set 2.666x speedup, test set 1.094x speedup, val set 0.930x speedup, step: 7, train time 10.00 s
Epoch 11/50 |loss: 0.200940| train set 3.201x speedup, test set 1.700x speedup, val set 0.688x speedup, step: 8, train time 9.71 s
Epoch 12/50 |loss: 0.201028| train set 2.681x speedup, test set 1.386x speedup, val set 0.936x speedup, step: 9, train time 9.71 s
Epoch 13/50 |loss: 0.192442| train set 2.923x speedup, test set 1.210x speedup, val set 0.901x speedup, step: 10, train time 9.09 s
Epoch 14/50 |loss: 0.187533| train set 3.308x speedup, test set 1.696x speedup, val set 0.911x speedup, step: 11, train time 9.39 s
Epoch 15/50 |loss: 0.184379| train set 3.129x speedup, test set 1.696x speedup, val set 0.911x speedup, step: 12, train time 9.10 s
Epoch 16/50 |loss: 0.173571| train set 3.152x speedup, test set 1.530x speedup, val set 0.977x speedup, step: 13, train time 8.91 s
Epoch 17/50 |loss: 0.174535| train set 3.021x speedup, test set 1.565x speedup, val set 0.935x speedup, step: 14, train time 8.90 s
Epoch 18/50 |loss: 0.171198| train set 3.134x speedup, test set 1.316x speedup, val set 0.900x speedup, step: 15, train time 8.90 s
Epoch 19/50 |loss: 0.167938| train set 3.179x speedup, test set 1.023x speedup, val set 0.680x speedup, step: 16, train time 8.90 s
Epoch 20/50 |loss: 0.159996| train set 3.037x speedup, test set 1.452x speedup, val set 0.925x speedup, step: 17, train time 8.80 s
Epoch 21/50 |loss: 0.154401| train set 3.046x speedup, test set 1.096x speedup, val set 0.678x speedup, step: 18, train time 8.90 s
Epoch 22/50 |loss: 0.159023| train set 3.174x speedup, test set 1.097x speedup, val set 0.909x speedup, step: 19, train time 8.80 s
Epoch 23/50 |loss: 0.149961| train set 3.366x speedup, test set 1.435x speedup, val set 0.680x speedup, step: 20, train time 8.90 s
Epoch 24/50 |loss: 0.146310| train set 2.835x speedup, test set 1.689x speedup, val set 0.716x speedup, step: 21, train time 8.90 s
Epoch 25/50 |loss: 0.149316| train set 3.244x speedup, test set 1.093x speedup, val set 0.931x speedup, step: 22, train time 8.90 s
Epoch 26/50 |loss: 0.147569| train set 2.874x speedup, test set 0.962x speedup, val set 0.900x speedup, step: 23, train time 8.90 s
Epoch 27/50 |loss: 0.142988| train set 3.382x speedup, test set 1.230x speedup, val set 0.884x speedup, step: 24, train time 8.61 s
Epoch 28/50 |loss: 0.135475| train set 3.275x speedup, test set 1.623x speedup, val set 0.678x speedup, step: 25, train time 8.80 s
Epoch 29/50 |loss: 0.139195| train set 3.294x speedup, test set 1.502x speedup, val set 0.674x speedup, step: 26, train time 8.90 s
Epoch 30/50 |loss: 0.136827| train set 3.209x speedup, test set 1.232x speedup, val set 0.911x speedup, step: 27, train time 8.80 s
Epoch 31/50 |loss: 0.136876| train set 3.330x speedup, test set 1.609x speedup, val set 0.957x speedup, step: 28, train time 8.80 s
Epoch 32/50 |loss: 0.126545| train set 3.391x speedup, test set 1.358x speedup, val set 0.934x speedup, step: 29, train time 8.82 s
Epoch 33/50 |loss: 0.128731| train set 3.151x speedup, test set 1.318x speedup, val set 0.886x speedup, step: 30, train time 8.90 s
Epoch 34/50 |loss: 0.130057| train set 3.398x speedup, test set 1.190x speedup, val set 0.951x speedup, step: 31, train time 8.79 s
Epoch 35/50 |loss: 0.124430| train set 3.381x speedup, test set 1.207x speedup, val set 0.988x speedup, step: 32, train time 8.90 s
Epoch 36/50 |loss: 0.128583| train set 3.440x speedup, test set 1.206x speedup, val set 0.911x speedup, step: 33, train time 9.00 s
Epoch 37/50 |loss: 0.125826| train set 3.347x speedup, test set 1.639x speedup, val set 0.988x speedup, step: 34, train time 8.90 s
Epoch 38/50 |loss: 0.119960| train set 3.042x speedup, test set 1.037x speedup, val set 0.911x speedup, step: 35, train time 8.89 s
Epoch 39/50 |loss: 0.118598| train set 3.331x speedup, test set 1.058x speedup, val set 0.933x speedup, step: 36, train time 9.00 s
Epoch 40/50 |loss: 0.119634| train set 3.486x speedup, test set 1.475x speedup, val set 0.988x speedup, step: 37, train time 8.80 s
Epoch 41/50 |loss: 0.115402| train set 3.286x speedup, test set 1.091x speedup, val set 0.910x speedup, step: 38, train time 9.01 s
Epoch 42/50 |loss: 0.116452| train set 3.468x speedup, test set 1.515x speedup, val set 0.986x speedup, step: 39, train time 8.90 s
Epoch 43/50 |loss: 0.116522| train set 3.424x speedup, test set 1.616x speedup, val set 0.680x speedup, step: 40, train time 8.91 s
Epoch 44/50 |loss: 0.111265| train set 3.191x speedup, test set 1.028x speedup, val set 0.935x speedup, step: 41, train time 8.90 s
Epoch 45/50 |loss: 0.107202| train set 3.339x speedup, test set 1.626x speedup, val set 0.722x speedup, step: 42, train time 8.90 s
Epoch 46/50 |loss: 0.109137| train set 3.279x speedup, test set 1.207x speedup, val set 0.721x speedup, step: 43, train time 8.91 s
Epoch 47/50 |loss: 0.108292| train set 3.368x speedup, test set 1.282x speedup, val set 0.693x speedup, step: 44, train time 9.00 s
Epoch 48/50 |loss: 0.110229| train set 3.484x speedup, test set 1.332x speedup, val set 0.714x speedup, step: 45, train time 9.00 s
Epoch 49/50 |loss: 0.108047| train set 3.390x speedup, test set 1.043x speedup, val set 0.934x speedup, step: 46, train time 8.93 s
Training per epoch cost 8.979 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 40, train speedup 3.486, test speedup 1.475, val speedup 0.988
best test speedup epoch: 11, train speedup 3.201, test speedup 1.700, val speedup 0.688
best validation speedup epoch: 4, train speedup 2.880, test speedup 0.998, val speedup 1.770
last model at epoch 49, train speedup 3.390, test speedup 1.043, val speedup 0.934
execution cost 0:08:01.109544
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.151083, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427644| train set 1.400x speedup, test set 0.997x speedup, val set 0.788x speedup, step: 1, train time 10.22 s
Epoch 1/50 |loss: 0.347023| train set 2.296x speedup, test set 0.999x speedup, val set 0.669x speedup, step: 2, train time 8.80 s
Epoch 2/50 |loss: 0.318195| train set 2.350x speedup, test set 1.022x speedup, val set 1.015x speedup, step: 3, train time 8.80 s
Epoch 3/50 |loss: 0.294338| train set 2.443x speedup, test set 0.970x speedup, val set 1.691x speedup, step: 4, train time 8.80 s
Epoch 4/50 |loss: 0.277684| train set 2.571x speedup, test set 0.992x speedup, val set 1.004x speedup, step: 1, train time 8.80 s
Epoch 5/50 |loss: 0.255335| train set 2.716x speedup, test set 1.752x speedup, val set 0.985x speedup, step: 2, train time 8.90 s
Epoch 6/50 |loss: 0.239990| train set 2.760x speedup, test set 1.553x speedup, val set 1.016x speedup, step: 3, train time 8.90 s
Epoch 7/50 |loss: 0.233998| train set 3.215x speedup, test set 1.138x speedup, val set 0.945x speedup, step: 4, train time 8.81 s
Epoch 8/50 |loss: 0.226894| train set 3.321x speedup, test set 1.399x speedup, val set 1.010x speedup, step: 5, train time 8.78 s
Epoch 9/50 |loss: 0.219328| train set 3.087x speedup, test set 1.489x speedup, val set 0.910x speedup, step: 6, train time 8.68 s
Epoch 10/50 |loss: 0.207435| train set 2.934x speedup, test set 1.426x speedup, val set 1.009x speedup, step: 7, train time 8.78 s
Epoch 11/50 |loss: 0.201753| train set 3.172x speedup, test set 1.966x speedup, val set 1.046x speedup, step: 8, train time 8.73 s
Epoch 12/50 |loss: 0.200013| train set 2.952x speedup, test set 1.569x speedup, val set 0.985x speedup, step: 9, train time 8.88 s
Epoch 13/50 |loss: 0.193054| train set 2.921x speedup, test set 1.158x speedup, val set 0.956x speedup, step: 10, train time 8.71 s
Epoch 14/50 |loss: 0.188327| train set 3.132x speedup, test set 1.562x speedup, val set 1.107x speedup, step: 1, train time 9.08 s
Epoch 15/50 |loss: 0.182781| train set 3.240x speedup, test set 1.534x speedup, val set 1.144x speedup, step: 2, train time 8.70 s
Epoch 16/50 |loss: 0.173519| train set 3.342x speedup, test set 1.618x speedup, val set 0.837x speedup, step: 3, train time 8.78 s
Epoch 17/50 |loss: 0.174983| train set 3.235x speedup, test set 1.698x speedup, val set 0.751x speedup, step: 4, train time 8.88 s
Epoch 18/50 |loss: 0.171600| train set 3.203x speedup, test set 1.358x speedup, val set 0.799x speedup, step: 5, train time 8.88 s
Epoch 19/50 |loss: 0.165631| train set 3.288x speedup, test set 1.327x speedup, val set 1.010x speedup, step: 6, train time 8.78 s
Epoch 20/50 |loss: 0.160963| train set 3.238x speedup, test set 1.549x speedup, val set 0.799x speedup, step: 7, train time 8.80 s
Epoch 21/50 |loss: 0.156536| train set 3.085x speedup, test set 1.194x speedup, val set 0.909x speedup, step: 8, train time 8.78 s
Epoch 22/50 |loss: 0.156211| train set 3.390x speedup, test set 1.559x speedup, val set 0.837x speedup, step: 9, train time 8.82 s
Epoch 23/50 |loss: 0.149403| train set 3.383x speedup, test set 1.670x speedup, val set 0.768x speedup, step: 10, train time 8.63 s
Epoch 24/50 |loss: 0.141936| train set 3.124x speedup, test set 1.685x speedup, val set 1.075x speedup, step: 11, train time 8.93 s
Epoch 25/50 |loss: 0.149425| train set 3.284x speedup, test set 1.641x speedup, val set 0.858x speedup, step: 12, train time 8.87 s
Epoch 26/50 |loss: 0.142431| train set 3.006x speedup, test set 1.193x speedup, val set 0.853x speedup, step: 13, train time 8.88 s
Epoch 27/50 |loss: 0.141298| train set 3.387x speedup, test set 1.530x speedup, val set 0.776x speedup, step: 14, train time 8.78 s
Epoch 28/50 |loss: 0.136714| train set 3.435x speedup, test set 1.699x speedup, val set 0.858x speedup, step: 15, train time 8.88 s
Epoch 29/50 |loss: 0.140232| train set 3.285x speedup, test set 1.547x speedup, val set 0.858x speedup, step: 16, train time 8.78 s
Epoch 30/50 |loss: 0.133523| train set 3.300x speedup, test set 1.546x speedup, val set 0.801x speedup, step: 17, train time 8.88 s
Epoch 31/50 |loss: 0.138351| train set 3.206x speedup, test set 1.531x speedup, val set 0.801x speedup, step: 18, train time 9.02 s
Epoch 32/50 |loss: 0.126090| train set 3.376x speedup, test set 1.615x speedup, val set 0.987x speedup, step: 19, train time 8.80 s
Epoch 33/50 |loss: 0.128332| train set 3.293x speedup, test set 1.599x speedup, val set 1.075x speedup, step: 20, train time 8.81 s
Epoch 34/50 |loss: 0.126851| train set 3.365x speedup, test set 1.629x speedup, val set 0.858x speedup, step: 21, train time 8.80 s
Epoch 35/50 |loss: 0.124250| train set 3.385x speedup, test set 1.545x speedup, val set 0.858x speedup, step: 22, train time 8.90 s
Epoch 36/50 |loss: 0.127722| train set 3.378x speedup, test set 1.627x speedup, val set 0.837x speedup, step: 23, train time 8.91 s
Epoch 37/50 |loss: 0.121812| train set 3.274x speedup, test set 1.629x speedup, val set 0.858x speedup, step: 24, train time 8.87 s
Epoch 38/50 |loss: 0.119861| train set 3.227x speedup, test set 1.557x speedup, val set 0.858x speedup, step: 25, train time 8.98 s
Epoch 39/50 |loss: 0.115968| train set 3.182x speedup, test set 1.559x speedup, val set 0.801x speedup, step: 26, train time 8.78 s
Epoch 40/50 |loss: 0.121090| train set 3.488x speedup, test set 1.573x speedup, val set 0.858x speedup, step: 27, train time 8.81 s
Epoch 41/50 |loss: 0.117203| train set 3.131x speedup, test set 1.559x speedup, val set 0.801x speedup, step: 28, train time 8.80 s
Epoch 42/50 |loss: 0.117352| train set 3.322x speedup, test set 1.556x speedup, val set 0.800x speedup, step: 29, train time 8.80 s
Epoch 43/50 |loss: 0.116047| train set 3.357x speedup, test set 1.554x speedup, val set 0.858x speedup, step: 30, train time 8.70 s
Epoch 44/50 |loss: 0.115380| train set 3.323x speedup, test set 1.257x speedup, val set 0.858x speedup, step: 31, train time 8.80 s
Epoch 45/50 |loss: 0.107252| train set 3.348x speedup, test set 1.559x speedup, val set 0.801x speedup, step: 32, train time 8.81 s
Epoch 46/50 |loss: 0.106058| train set 3.492x speedup, test set 1.558x speedup, val set 1.075x speedup, step: 33, train time 8.83 s
Epoch 47/50 |loss: 0.108633| train set 3.302x speedup, test set 1.258x speedup, val set 0.801x speedup, step: 34, train time 8.80 s
Epoch 48/50 |loss: 0.112117| train set 3.482x speedup, test set 1.630x speedup, val set 1.316x speedup, step: 35, train time 8.87 s
Epoch 49/50 |loss: 0.105560| train set 3.391x speedup, test set 1.302x speedup, val set 0.801x speedup, step: 36, train time 8.90 s
Training per epoch cost 8.854 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.242s, pg runtime 0.189s, speedup 0.783x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 4.477s, pg runtime 1.357s, speedup 0.303x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 4.251s, pg runtime 3.112s, speedup 0.732x
21, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.961x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 46, train speedup 3.492, test speedup 1.558, val speedup 1.075
best test speedup epoch: 11, train speedup 3.172, test speedup 1.966, val speedup 1.046
best validation speedup epoch: 14, train speedup 3.132, test speedup 1.562, val speedup 1.107
last model at epoch 49, train speedup 3.391, test speedup 1.302, val speedup 0.801
execution cost 0:07:53.289783
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.293553, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427203| train set 2.327x speedup, test set 1.013x speedup, val set 0.996x speedup, step: 1, train time 10.34 s
Epoch 1/50 |loss: 0.345221| train set 2.555x speedup, test set 1.011x speedup, val set 1.187x speedup, step: 2, train time 8.88 s
Epoch 2/50 |loss: 0.314577| train set 2.375x speedup, test set 1.012x speedup, val set 0.936x speedup, step: 3, train time 8.90 s
Epoch 3/50 |loss: 0.295825| train set 2.558x speedup, test set 1.012x speedup, val set 0.936x speedup, step: 4, train time 9.00 s
Epoch 4/50 |loss: 0.276211| train set 2.989x speedup, test set 1.667x speedup, val set 1.768x speedup, step: 1, train time 8.79 s
Epoch 5/50 |loss: 0.258376| train set 2.810x speedup, test set 1.080x speedup, val set 0.926x speedup, step: 2, train time 8.89 s
Epoch 6/50 |loss: 0.242565| train set 2.743x speedup, test set 1.202x speedup, val set 0.936x speedup, step: 3, train time 8.83 s
Epoch 7/50 |loss: 0.238141| train set 3.145x speedup, test set 1.179x speedup, val set 0.900x speedup, step: 4, train time 8.81 s
Epoch 8/50 |loss: 0.225365| train set 3.223x speedup, test set 1.679x speedup, val set 0.922x speedup, step: 5, train time 8.90 s
Epoch 9/50 |loss: 0.223551| train set 2.919x speedup, test set 1.091x speedup, val set 0.937x speedup, step: 6, train time 8.99 s
Epoch 10/50 |loss: 0.208634| train set 2.718x speedup, test set 1.019x speedup, val set 0.910x speedup, step: 7, train time 8.98 s
Epoch 11/50 |loss: 0.204615| train set 3.169x speedup, test set 1.801x speedup, val set 1.014x speedup, step: 8, train time 8.90 s
Epoch 12/50 |loss: 0.201927| train set 2.537x speedup, test set 1.310x speedup, val set 0.910x speedup, step: 9, train time 8.90 s
Epoch 13/50 |loss: 0.196155| train set 3.052x speedup, test set 1.129x speedup, val set 0.885x speedup, step: 10, train time 9.19 s
Epoch 14/50 |loss: 0.193828| train set 3.161x speedup, test set 1.507x speedup, val set 0.986x speedup, step: 11, train time 9.41 s
Epoch 15/50 |loss: 0.188290| train set 3.319x speedup, test set 1.948x speedup, val set 0.970x speedup, step: 12, train time 8.98 s
Epoch 16/50 |loss: 0.177278| train set 3.350x speedup, test set 1.436x speedup, val set 1.012x speedup, step: 13, train time 9.10 s
Epoch 17/50 |loss: 0.178549| train set 2.994x speedup, test set 1.577x speedup, val set 0.977x speedup, step: 14, train time 9.09 s
Epoch 18/50 |loss: 0.173991| train set 2.993x speedup, test set 1.473x speedup, val set 0.783x speedup, step: 15, train time 9.11 s
Epoch 19/50 |loss: 0.172919| train set 3.215x speedup, test set 1.583x speedup, val set 0.707x speedup, step: 16, train time 9.11 s
Epoch 20/50 |loss: 0.165987| train set 3.201x speedup, test set 1.479x speedup, val set 0.948x speedup, step: 17, train time 9.21 s
Epoch 21/50 |loss: 0.160817| train set 2.933x speedup, test set 1.125x speedup, val set 0.910x speedup, step: 18, train time 9.11 s
Epoch 22/50 |loss: 0.165107| train set 3.156x speedup, test set 1.134x speedup, val set 0.910x speedup, step: 19, train time 9.21 s
Epoch 23/50 |loss: 0.154210| train set 3.269x speedup, test set 1.395x speedup, val set 0.707x speedup, step: 20, train time 9.02 s
Epoch 24/50 |loss: 0.150178| train set 3.190x speedup, test set 1.501x speedup, val set 0.707x speedup, step: 21, train time 9.30 s
Epoch 25/50 |loss: 0.151734| train set 3.237x speedup, test set 1.340x speedup, val set 0.986x speedup, step: 22, train time 9.11 s
Epoch 26/50 |loss: 0.150972| train set 2.993x speedup, test set 0.984x speedup, val set 0.877x speedup, step: 23, train time 9.29 s
Epoch 27/50 |loss: 0.146447| train set 3.343x speedup, test set 1.160x speedup, val set 0.701x speedup, step: 24, train time 9.20 s
Epoch 28/50 |loss: 0.142455| train set 3.214x speedup, test set 1.503x speedup, val set 0.783x speedup, step: 25, train time 9.08 s
Epoch 29/50 |loss: 0.146624| train set 3.274x speedup, test set 1.582x speedup, val set 0.959x speedup, step: 26, train time 9.11 s
Epoch 30/50 |loss: 0.140962| train set 3.090x speedup, test set 1.051x speedup, val set 0.666x speedup, step: 27, train time 9.02 s
Epoch 31/50 |loss: 0.139281| train set 3.321x speedup, test set 1.477x speedup, val set 0.705x speedup, step: 28, train time 9.20 s
Epoch 32/50 |loss: 0.133183| train set 3.382x speedup, test set 1.538x speedup, val set 0.947x speedup, step: 29, train time 9.00 s
Epoch 33/50 |loss: 0.134314| train set 3.292x speedup, test set 1.319x speedup, val set 0.957x speedup, step: 30, train time 8.93 s
Epoch 34/50 |loss: 0.132838| train set 3.322x speedup, test set 1.635x speedup, val set 0.705x speedup, step: 31, train time 9.01 s
Epoch 35/50 |loss: 0.130608| train set 3.344x speedup, test set 1.112x speedup, val set 0.701x speedup, step: 32, train time 9.00 s
Epoch 36/50 |loss: 0.132076| train set 3.363x speedup, test set 1.019x speedup, val set 0.707x speedup, step: 33, train time 9.29 s
Epoch 37/50 |loss: 0.127293| train set 3.062x speedup, test set 1.538x speedup, val set 0.949x speedup, step: 34, train time 9.30 s
Epoch 38/50 |loss: 0.127565| train set 3.201x speedup, test set 1.026x speedup, val set 0.701x speedup, step: 35, train time 9.27 s
Epoch 39/50 |loss: 0.122875| train set 3.214x speedup, test set 1.049x speedup, val set 0.700x speedup, step: 36, train time 9.18 s
Epoch 40/50 |loss: 0.125855| train set 3.416x speedup, test set 1.544x speedup, val set 0.957x speedup, step: 37, train time 9.18 s
Epoch 41/50 |loss: 0.122244| train set 3.156x speedup, test set 1.029x speedup, val set 0.783x speedup, step: 38, train time 9.08 s
Epoch 42/50 |loss: 0.127336| train set 3.335x speedup, test set 1.466x speedup, val set 0.781x speedup, step: 39, train time 9.19 s
Epoch 43/50 |loss: 0.120232| train set 3.361x speedup, test set 1.464x speedup, val set 0.977x speedup, step: 40, train time 9.10 s
Epoch 44/50 |loss: 0.118508| train set 2.924x speedup, test set 1.019x speedup, val set 1.005x speedup, step: 41, train time 9.12 s
Epoch 45/50 |loss: 0.112378| train set 3.229x speedup, test set 1.591x speedup, val set 0.714x speedup, step: 42, train time 9.22 s
Epoch 46/50 |loss: 0.114029| train set 3.399x speedup, test set 1.492x speedup, val set 0.987x speedup, step: 43, train time 9.09 s
Epoch 47/50 |loss: 0.113187| train set 3.270x speedup, test set 1.530x speedup, val set 0.701x speedup, step: 44, train time 9.12 s
Epoch 48/50 |loss: 0.113660| train set 3.421x speedup, test set 1.026x speedup, val set 0.774x speedup, step: 45, train time 9.08 s
Epoch 49/50 |loss: 0.111461| train set 3.389x speedup, test set 1.402x speedup, val set 0.974x speedup, step: 46, train time 9.21 s
Training per epoch cost 9.107 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.667s, pg runtime 0.189s, speedup 0.284x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 48, train speedup 3.421, test speedup 1.026, val speedup 0.774
best test speedup epoch: 15, train speedup 3.319, test speedup 1.948, val speedup 0.970
best validation speedup epoch: 4, train speedup 2.989, test speedup 1.667, val speedup 1.768
last model at epoch 49, train speedup 3.389, test speedup 1.402, val speedup 0.974
execution cost 0:08:06.970147
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (78, 49) (27, 49) (8, 49)
(78, 49, 3)
(78, 49)
construct training samples cost 0:00:01.073395, and there are 13646 training samples
in channel 9
Epoch 0/50 |loss: 0.427415| train set 2.287x speedup, test set 0.969x speedup, val set 0.996x speedup, step: 1, train time 10.29 s
Epoch 1/50 |loss: 0.343523| train set 2.553x speedup, test set 0.987x speedup, val set 0.890x speedup, step: 2, train time 9.01 s
Epoch 2/50 |loss: 0.316012| train set 2.404x speedup, test set 1.481x speedup, val set 0.916x speedup, step: 3, train time 8.98 s
Epoch 3/50 |loss: 0.290935| train set 2.616x speedup, test set 1.014x speedup, val set 0.926x speedup, step: 4, train time 8.98 s
Epoch 4/50 |loss: 0.276998| train set 2.628x speedup, test set 1.009x speedup, val set 1.687x speedup, step: 1, train time 9.10 s
Epoch 5/50 |loss: 0.255861| train set 2.740x speedup, test set 1.445x speedup, val set 0.910x speedup, step: 2, train time 8.90 s
Epoch 6/50 |loss: 0.241643| train set 2.847x speedup, test set 1.608x speedup, val set 0.900x speedup, step: 3, train time 8.91 s
Epoch 7/50 |loss: 0.235522| train set 3.214x speedup, test set 1.437x speedup, val set 0.924x speedup, step: 4, train time 9.01 s
Epoch 8/50 |loss: 0.224529| train set 3.391x speedup, test set 1.645x speedup, val set 0.910x speedup, step: 5, train time 8.88 s
Epoch 9/50 |loss: 0.223143| train set 3.251x speedup, test set 1.619x speedup, val set 0.665x speedup, step: 6, train time 9.01 s
Epoch 10/50 |loss: 0.207966| train set 2.767x speedup, test set 1.355x speedup, val set 0.666x speedup, step: 7, train time 9.08 s
Epoch 11/50 |loss: 0.201499| train set 3.101x speedup, test set 1.963x speedup, val set 1.044x speedup, step: 8, train time 9.08 s
Epoch 12/50 |loss: 0.201841| train set 3.078x speedup, test set 1.338x speedup, val set 0.910x speedup, step: 9, train time 9.00 s
Epoch 13/50 |loss: 0.197582| train set 2.904x speedup, test set 0.935x speedup, val set 0.666x speedup, step: 10, train time 8.90 s
Epoch 14/50 |loss: 0.191936| train set 3.194x speedup, test set 1.749x speedup, val set 0.935x speedup, step: 11, train time 9.40 s
Epoch 15/50 |loss: 0.185864| train set 3.085x speedup, test set 1.776x speedup, val set 0.721x speedup, step: 12, train time 9.11 s
Epoch 16/50 |loss: 0.178013| train set 3.129x speedup, test set 1.872x speedup, val set 0.707x speedup, step: 13, train time 8.98 s
Epoch 17/50 |loss: 0.178609| train set 2.972x speedup, test set 1.715x speedup, val set 0.705x speedup, step: 14, train time 9.00 s
Epoch 18/50 |loss: 0.175273| train set 3.178x speedup, test set 1.710x speedup, val set 0.909x speedup, step: 15, train time 9.08 s
Epoch 19/50 |loss: 0.172194| train set 3.113x speedup, test set 1.076x speedup, val set 0.666x speedup, step: 16, train time 9.07 s
Epoch 20/50 |loss: 0.168566| train set 3.050x speedup, test set 1.349x speedup, val set 0.679x speedup, step: 17, train time 9.08 s
Epoch 21/50 |loss: 0.161434| train set 3.043x speedup, test set 1.325x speedup, val set 0.665x speedup, step: 18, train time 9.18 s
Epoch 22/50 |loss: 0.161166| train set 3.164x speedup, test set 1.293x speedup, val set 0.925x speedup, step: 19, train time 8.90 s
Epoch 23/50 |loss: 0.157796| train set 3.406x speedup, test set 1.711x speedup, val set 0.677x speedup, step: 20, train time 9.00 s
Epoch 24/50 |loss: 0.147180| train set 3.226x speedup, test set 1.678x speedup, val set 0.721x speedup, step: 21, train time 9.01 s
Epoch 25/50 |loss: 0.151952| train set 3.283x speedup, test set 1.468x speedup, val set 0.720x speedup, step: 22, train time 9.18 s
Epoch 26/50 |loss: 0.150067| train set 3.022x speedup, test set 0.961x speedup, val set 0.661x speedup, step: 23, train time 9.19 s
Epoch 27/50 |loss: 0.146430| train set 3.228x speedup, test set 1.691x speedup, val set 0.716x speedup, step: 24, train time 9.17 s
Epoch 28/50 |loss: 0.139263| train set 3.384x speedup, test set 2.106x speedup, val set 0.715x speedup, step: 25, train time 9.01 s
Epoch 29/50 |loss: 0.144166| train set 3.318x speedup, test set 1.779x speedup, val set 0.715x speedup, step: 26, train time 8.91 s
Epoch 30/50 |loss: 0.139786| train set 3.221x speedup, test set 1.042x speedup, val set 0.661x speedup, step: 27, train time 9.08 s
Epoch 31/50 |loss: 0.140566| train set 3.218x speedup, test set 1.691x speedup, val set 0.713x speedup, step: 28, train time 9.11 s
Epoch 32/50 |loss: 0.129800| train set 3.381x speedup, test set 1.692x speedup, val set 0.714x speedup, step: 29, train time 9.19 s
Epoch 33/50 |loss: 0.133729| train set 3.381x speedup, test set 1.102x speedup, val set 0.898x speedup, step: 30, train time 9.03 s
Epoch 34/50 |loss: 0.127242| train set 3.431x speedup, test set 1.761x speedup, val set 0.720x speedup, step: 31, train time 9.19 s
Epoch 35/50 |loss: 0.128174| train set 3.234x speedup, test set 1.127x speedup, val set 0.731x speedup, step: 32, train time 9.13 s
Epoch 36/50 |loss: 0.127493| train set 3.359x speedup, test set 1.543x speedup, val set 0.738x speedup, step: 33, train time 9.11 s
Epoch 37/50 |loss: 0.121742| train set 3.275x speedup, test set 2.004x speedup, val set 0.727x speedup, step: 34, train time 9.20 s
Epoch 38/50 |loss: 0.124491| train set 3.027x speedup, test set 1.127x speedup, val set 0.688x speedup, step: 35, train time 9.19 s
Epoch 39/50 |loss: 0.121025| train set 3.388x speedup, test set 1.715x speedup, val set 0.714x speedup, step: 36, train time 9.03 s
Epoch 40/50 |loss: 0.124714| train set 3.457x speedup, test set 1.715x speedup, val set 0.714x speedup, step: 37, train time 9.08 s
Epoch 41/50 |loss: 0.121560| train set 3.287x speedup, test set 1.361x speedup, val set 0.701x speedup, step: 38, train time 9.22 s
Epoch 42/50 |loss: 0.118617| train set 3.329x speedup, test set 1.653x speedup, val set 0.706x speedup, step: 39, train time 9.02 s
Epoch 43/50 |loss: 0.114581| train set 3.394x speedup, test set 2.010x speedup, val set 0.731x speedup, step: 40, train time 9.18 s
Epoch 44/50 |loss: 0.115830| train set 3.300x speedup, test set 1.361x speedup, val set 0.714x speedup, step: 41, train time 8.99 s
Epoch 45/50 |loss: 0.111058| train set 3.261x speedup, test set 1.808x speedup, val set 0.714x speedup, step: 42, train time 9.20 s
Epoch 46/50 |loss: 0.109491| train set 3.275x speedup, test set 1.717x speedup, val set 0.715x speedup, step: 43, train time 9.18 s
Epoch 47/50 |loss: 0.111789| train set 3.388x speedup, test set 1.638x speedup, val set 0.714x speedup, step: 44, train time 9.08 s
Epoch 48/50 |loss: 0.112116| train set 3.484x speedup, test set 2.048x speedup, val set 0.714x speedup, step: 45, train time 9.11 s
Epoch 49/50 |loss: 0.106183| train set 3.503x speedup, test set 1.357x speedup, val set 0.713x speedup, step: 46, train time 9.08 s
Training per epoch cost 9.096 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.418s, pg runtime 0.637s, speedup 0.449x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.445s, pg runtime 0.661s, speedup 0.457x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.135s, pg runtime 0.129s, speedup 0.962x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 0.278s, pg runtime 0.948s, speedup 3.415x
====================
best train speedup epoch: 49, train speedup 3.503, test speedup 1.357, val speedup 0.713
best test speedup epoch: 28, train speedup 3.384, test speedup 2.106, val speedup 0.715
best validation speedup epoch: 4, train speedup 2.628, test speedup 1.009, val speedup 1.687
last model at epoch 49, train speedup 3.503, test speedup 1.357, val speedup 0.713
execution cost 0:08:04.647265
==================================================
