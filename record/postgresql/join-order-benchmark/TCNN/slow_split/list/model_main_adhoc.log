all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:02.122566, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159269| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786839| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083914| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698137| train set 1.100x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383434| train set 1.117x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.092390| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.811123| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.535709| train set 1.131x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.278475| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.014128| train set 1.154x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.776127| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.540781| train set 1.197x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.359039| train set 1.238x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.218973| train set 1.218x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 27.025528| train set 1.207x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.658018| train set 1.207x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.510239| train set 1.204x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.415552| train set 1.223x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.046175| train set 1.204x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.852449| train set 1.177x speedup, test set 1.025x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.817724| train set 1.191x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.501450| train set 1.205x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.210350| train set 1.178x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 28
Epoch 28/200 |loss: 25.112352| train set 1.167x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 25.025331| train set 1.162x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.030365| train set 1.161x speedup, test set 1.057x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.813353| train set 1.163x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 32
Epoch 32/200 |loss: 24.847317| train set 1.205x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.850920| train set 1.228x speedup, test set 1.068x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.128004| train set 1.199x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 24.572727| train set 1.247x speedup, test set 1.068x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.055552| train set 1.213x speedup, test set 1.043x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.855848| train set 1.229x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.923111| train set 1.280x speedup, test set 1.043x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.378712| train set 1.278x speedup, test set 1.062x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.455240| train set 1.230x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.226364| train set 1.245x speedup, test set 1.886x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.001968| train set 1.249x speedup, test set 1.066x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.780069| train set 1.232x speedup, test set 1.025x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.811674| train set 1.306x speedup, test set 1.811x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.299805| train set 1.266x speedup, test set 1.895x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.568865| train set 1.305x speedup, test set 1.817x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.260128| train set 1.235x speedup, test set 1.043x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.112452| train set 1.288x speedup, test set 2.242x speedup, val set 0.930x speedup, step: 49
Epoch 49/200 |loss: 21.997826| train set 1.237x speedup, test set 1.043x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.216869| train set 1.321x speedup, test set 2.199x speedup, val set 0.930x speedup, step: 51
Epoch 51/200 |loss: 22.344860| train set 1.310x speedup, test set 1.043x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.649530| train set 1.329x speedup, test set 1.987x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 21.289917| train set 1.362x speedup, test set 2.449x speedup, val set 0.931x speedup, step: 54
Epoch 54/200 |loss: 21.377172| train set 1.236x speedup, test set 1.020x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.539793| train set 1.330x speedup, test set 1.876x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 20.849421| train set 1.391x speedup, test set 2.307x speedup, val set 0.931x speedup, step: 57
Epoch 57/200 |loss: 20.700994| train set 1.325x speedup, test set 1.038x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 21.035120| train set 1.330x speedup, test set 1.956x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 20.349060| train set 1.378x speedup, test set 1.970x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.361353| train set 1.312x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.264965| train set 1.374x speedup, test set 1.900x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.351591| train set 1.329x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 21.634876| train set 1.322x speedup, test set 1.807x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 22.457954| train set 1.364x speedup, test set 1.073x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 22.680853| train set 1.324x speedup, test set 1.051x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 21.067478| train set 1.266x speedup, test set 1.882x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 22.412746| train set 1.331x speedup, test set 1.803x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 20.254433| train set 1.393x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 21.187052| train set 1.399x speedup, test set 1.126x speedup, val set 0.738x speedup, step: 70
Epoch 70/200 |loss: 20.536945| train set 1.384x speedup, test set 1.866x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 20.104839| train set 1.383x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 20.252390| train set 1.398x speedup, test set 1.900x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.714622| train set 1.321x speedup, test set 1.030x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.954638| train set 1.307x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.355621| train set 1.330x speedup, test set 1.870x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.421616| train set 1.386x speedup, test set 2.226x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.055801| train set 1.385x speedup, test set 1.944x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.951305| train set 1.385x speedup, test set 1.800x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.816904| train set 1.399x speedup, test set 2.263x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.561165| train set 1.389x speedup, test set 1.876x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.493715| train set 1.380x speedup, test set 1.876x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.259306| train set 1.399x speedup, test set 1.985x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.110273| train set 1.399x speedup, test set 2.230x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 17.973614| train set 1.399x speedup, test set 1.985x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.794527| train set 1.394x speedup, test set 1.876x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.608381| train set 1.398x speedup, test set 1.985x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.471716| train set 1.429x speedup, test set 1.907x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.532866| train set 1.504x speedup, test set 2.442x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.261469| train set 1.276x speedup, test set 0.905x speedup, val set 1.008x speedup, step: 90
Epoch 90/200 |loss: 20.024313| train set 1.470x speedup, test set 1.292x speedup, val set 0.738x speedup, step: 91
Epoch 91/200 |loss: 18.480373| train set 1.364x speedup, test set 1.900x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 18.858793| train set 1.409x speedup, test set 1.073x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 19.424482| train set 1.388x speedup, test set 2.552x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.924223| train set 1.378x speedup, test set 1.492x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 18.914549| train set 1.400x speedup, test set 1.473x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 18.502579| train set 1.399x speedup, test set 1.473x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.935471| train set 1.429x speedup, test set 1.705x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 18.495132| train set 1.511x speedup, test set 2.735x speedup, val set 0.738x speedup, step: 99
Epoch 99/200 |loss: 17.645161| train set 1.389x speedup, test set 0.920x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 17.507366| train set 1.334x speedup, test set 1.714x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.262442| train set 1.467x speedup, test set 1.908x speedup, val set 0.738x speedup, step: 2
Epoch 102/200 |loss: 16.996065| train set 1.382x speedup, test set 0.923x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 17.122791| train set 1.415x speedup, test set 0.920x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.571911| train set 1.401x speedup, test set 1.683x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.579979| train set 1.447x speedup, test set 1.540x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.192556| train set 1.387x speedup, test set 1.683x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.278728| train set 1.494x speedup, test set 1.683x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.980705| train set 1.493x speedup, test set 1.683x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.857912| train set 1.410x speedup, test set 1.558x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.917218| train set 1.490x speedup, test set 1.683x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.611714| train set 1.494x speedup, test set 1.683x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.424561| train set 1.416x speedup, test set 1.683x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.516972| train set 1.436x speedup, test set 1.473x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.576933| train set 1.519x speedup, test set 1.750x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 15.800123| train set 1.365x speedup, test set 1.498x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 16.974657| train set 1.518x speedup, test set 1.956x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 16.919334| train set 1.397x speedup, test set 1.487x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 15.254476| train set 1.506x speedup, test set 1.617x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 14.995238| train set 1.472x speedup, test set 1.905x speedup, val set 0.738x speedup, step: 2
Epoch 120/200 |loss: 16.037643| train set 1.394x speedup, test set 1.500x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 15.721521| train set 1.492x speedup, test set 1.603x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 14.797701| train set 1.520x speedup, test set 1.991x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 15.301423| train set 1.431x speedup, test set 0.905x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 15.652208| train set 1.502x speedup, test set 1.620x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 14.650300| train set 1.505x speedup, test set 1.730x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 14.873670| train set 1.397x speedup, test set 0.905x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 15.150122| train set 1.501x speedup, test set 0.920x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 14.760505| train set 1.507x speedup, test set 1.936x speedup, val set 0.996x speedup, step: 2
Epoch 129/200 |loss: 15.142119| train set 1.381x speedup, test set 0.921x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 14.979420| train set 1.513x speedup, test set 1.632x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 15.194901| train set 1.485x speedup, test set 1.333x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 15.813230| train set 1.411x speedup, test set 1.492x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 14.588184| train set 1.419x speedup, test set 0.928x speedup, val set 0.997x speedup, step: 1
Epoch 134/200 |loss: 14.918453| train set 1.505x speedup, test set 1.653x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 14.230129| train set 1.497x speedup, test set 1.632x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 14.156494| train set 1.490x speedup, test set 0.927x speedup, val set 0.997x speedup, step: 1
Epoch 137/200 |loss: 14.023096| train set 1.508x speedup, test set 1.733x speedup, val set 0.997x speedup, step: 1
Epoch 138/200 |loss: 13.987947| train set 1.519x speedup, test set 0.975x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 14.192026| train set 1.427x speedup, test set 1.492x speedup, val set 0.997x speedup, step: 1
Epoch 140/200 |loss: 14.186065| train set 1.525x speedup, test set 1.072x speedup, val set 0.997x speedup, step: 1
Epoch 141/200 |loss: 14.110242| train set 1.471x speedup, test set 1.653x speedup, val set 0.997x speedup, step: 1
Epoch 142/200 |loss: 13.717947| train set 1.488x speedup, test set 1.486x speedup, val set 0.997x speedup, step: 1
Epoch 143/200 |loss: 13.381816| train set 1.502x speedup, test set 1.623x speedup, val set 0.997x speedup, step: 1
Epoch 144/200 |loss: 13.528108| train set 1.500x speedup, test set 1.628x speedup, val set 0.997x speedup, step: 1
Epoch 145/200 |loss: 13.365284| train set 1.519x speedup, test set 0.977x speedup, val set 0.997x speedup, step: 1
Epoch 146/200 |loss: 13.801558| train set 1.521x speedup, test set 1.489x speedup, val set 0.996x speedup, step: 2
Epoch 147/200 |loss: 13.867608| train set 1.538x speedup, test set 0.976x speedup, val set 0.997x speedup, step: 1
Epoch 148/200 |loss: 14.408227| train set 1.493x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 149/200 |loss: 13.994348| train set 1.530x speedup, test set 0.925x speedup, val set 0.997x speedup, step: 1
Epoch 150/200 |loss: 13.994282| train set 1.501x speedup, test set 1.626x speedup, val set 0.997x speedup, step: 1
Epoch 151/200 |loss: 13.656584| train set 1.508x speedup, test set 1.489x speedup, val set 0.996x speedup, step: 2
Epoch 152/200 |loss: 13.109093| train set 1.520x speedup, test set 1.484x speedup, val set 0.997x speedup, step: 1
Epoch 153/200 |loss: 13.249830| train set 1.472x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 154/200 |loss: 13.646339| train set 1.452x speedup, test set 1.500x speedup, val set 0.997x speedup, step: 1
Epoch 155/200 |loss: 13.305726| train set 1.532x speedup, test set 1.489x speedup, val set 0.997x speedup, step: 1
Epoch 156/200 |loss: 12.945671| train set 1.542x speedup, test set 1.717x speedup, val set 0.997x speedup, step: 1
Epoch 157/200 |loss: 13.449650| train set 1.515x speedup, test set 0.928x speedup, val set 0.997x speedup, step: 1
Epoch 158/200 |loss: 13.561048| train set 1.507x speedup, test set 1.707x speedup, val set 0.997x speedup, step: 1
Epoch 159/200 |loss: 12.735042| train set 1.481x speedup, test set 1.711x speedup, val set 0.997x speedup, step: 1
Epoch 160/200 |loss: 12.753444| train set 1.497x speedup, test set 0.929x speedup, val set 0.997x speedup, step: 1
Epoch 161/200 |loss: 13.470316| train set 1.519x speedup, test set 1.632x speedup, val set 0.997x speedup, step: 1
Epoch 162/200 |loss: 12.818144| train set 1.501x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 163/200 |loss: 13.270206| train set 1.467x speedup, test set 1.496x speedup, val set 0.997x speedup, step: 1
Epoch 164/200 |loss: 13.353086| train set 1.501x speedup, test set 1.492x speedup, val set 0.997x speedup, step: 1
Epoch 165/200 |loss: 12.767733| train set 1.550x speedup, test set 1.733x speedup, val set 0.997x speedup, step: 1
Epoch 166/200 |loss: 12.488666| train set 1.526x speedup, test set 1.489x speedup, val set 0.997x speedup, step: 1
Epoch 167/200 |loss: 12.563925| train set 1.564x speedup, test set 1.629x speedup, val set 0.997x speedup, step: 1
Epoch 168/200 |loss: 12.229321| train set 1.545x speedup, test set 1.648x speedup, val set 0.997x speedup, step: 1
Epoch 169/200 |loss: 12.534918| train set 1.501x speedup, test set 0.931x speedup, val set 0.997x speedup, step: 1
Epoch 170/200 |loss: 12.703546| train set 1.524x speedup, test set 1.489x speedup, val set 0.997x speedup, step: 1
Epoch 171/200 |loss: 12.286153| train set 1.543x speedup, test set 1.730x speedup, val set 0.997x speedup, step: 1
Epoch 172/200 |loss: 12.905830| train set 1.512x speedup, test set 1.500x speedup, val set 0.996x speedup, step: 2
Epoch 173/200 |loss: 13.225433| train set 1.538x speedup, test set 0.926x speedup, val set 0.997x speedup, step: 1
Epoch 174/200 |loss: 12.885203| train set 1.512x speedup, test set 1.626x speedup, val set 0.997x speedup, step: 1
Epoch 175/200 |loss: 12.367184| train set 1.495x speedup, test set 1.500x speedup, val set 0.997x speedup, step: 1
Epoch 176/200 |loss: 12.145987| train set 1.508x speedup, test set 1.489x speedup, val set 0.997x speedup, step: 1
Epoch 177/200 |loss: 12.037930| train set 1.494x speedup, test set 1.623x speedup, val set 0.997x speedup, step: 1
Epoch 178/200 |loss: 12.579125| train set 1.540x speedup, test set 0.930x speedup, val set 0.997x speedup, step: 1
Epoch 179/200 |loss: 12.434724| train set 1.559x speedup, test set 1.494x speedup, val set 0.997x speedup, step: 1
Epoch 180/200 |loss: 11.774240| train set 1.525x speedup, test set 1.730x speedup, val set 0.997x speedup, step: 1
Epoch 181/200 |loss: 11.997341| train set 1.538x speedup, test set 1.486x speedup, val set 0.997x speedup, step: 1
Epoch 182/200 |loss: 11.802814| train set 1.520x speedup, test set 1.500x speedup, val set 0.997x speedup, step: 1
Epoch 183/200 |loss: 12.017587| train set 1.558x speedup, test set 1.646x speedup, val set 0.997x speedup, step: 1
Epoch 184/200 |loss: 12.226712| train set 1.557x speedup, test set 1.486x speedup, val set 0.997x speedup, step: 1
Epoch 185/200 |loss: 11.910978| train set 1.487x speedup, test set 0.922x speedup, val set 0.997x speedup, step: 1
Epoch 186/200 |loss: 12.323291| train set 1.557x speedup, test set 1.619x speedup, val set 0.997x speedup, step: 1
Epoch 187/200 |loss: 11.959968| train set 1.508x speedup, test set 1.631x speedup, val set 0.997x speedup, step: 1
Epoch 188/200 |loss: 11.674254| train set 1.519x speedup, test set 1.499x speedup, val set 0.997x speedup, step: 1
Epoch 189/200 |loss: 11.625786| train set 1.567x speedup, test set 1.625x speedup, val set 0.997x speedup, step: 1
Epoch 190/200 |loss: 11.324657| train set 1.578x speedup, test set 1.622x speedup, val set 0.997x speedup, step: 1
Epoch 191/200 |loss: 11.400887| train set 1.563x speedup, test set 1.486x speedup, val set 0.997x speedup, step: 1
Epoch 192/200 |loss: 11.691658| train set 1.477x speedup, test set 1.632x speedup, val set 0.997x speedup, step: 1
Epoch 193/200 |loss: 11.868193| train set 1.558x speedup, test set 1.625x speedup, val set 0.997x speedup, step: 1
Epoch 194/200 |loss: 11.565841| train set 1.520x speedup, test set 0.922x speedup, val set 0.997x speedup, step: 1
Epoch 195/200 |loss: 11.505178| train set 1.525x speedup, test set 1.486x speedup, val set 0.997x speedup, step: 1
Epoch 196/200 |loss: 11.149194| train set 1.529x speedup, test set 1.625x speedup, val set 0.997x speedup, step: 1
Epoch 197/200 |loss: 11.195132| train set 1.538x speedup, test set 1.489x speedup, val set 0.997x speedup, step: 1
Epoch 198/200 |loss: 11.306323| train set 1.539x speedup, test set 0.920x speedup, val set 0.997x speedup, step: 1
Epoch 199/200 |loss: 11.362469| train set 1.523x speedup, test set 1.626x speedup, val set 0.997x speedup, step: 1
Training per epoch cost 0.731 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.317s, pg runtime 2.352s, speedup 7.417x
12, opt runtime 4.443s, model runtime 50.837s, pg runtime 13.945s, speedup 0.274x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 190, train speedup 1.578, test speedup 1.622, val speedup 0.997
best test speedup epoch: 98, train speedup 1.511, test speedup 2.735, val speedup 0.738
best validation speedup epoch: 199, train speedup 1.523, test speedup 1.626, val speedup 0.997
last model at epoch 199, train speedup 1.523, test speedup 1.626, val speedup 0.997
execution cost 0:07:20.898438
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.633536, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787601| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695999| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379642| train set 1.115x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083750| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.799917| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.531355| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.290113| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.018244| train set 1.173x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.760578| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.501966| train set 1.211x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.269619| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.043451| train set 1.236x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.866255| train set 1.216x speedup, test set 1.028x speedup, val set 0.932x speedup, step: 20
Epoch 20/200 |loss: 26.968899| train set 1.226x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.810242| train set 1.224x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.247738| train set 1.205x speedup, test set 1.028x speedup, val set 0.932x speedup, step: 23
Epoch 23/200 |loss: 26.225918| train set 1.227x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.937887| train set 1.225x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 25
Epoch 25/200 |loss: 25.678371| train set 1.198x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 26
Epoch 26/200 |loss: 25.679955| train set 1.225x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.348665| train set 1.195x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.207663| train set 1.186x speedup, test set 1.015x speedup, val set 0.932x speedup, step: 29
Epoch 29/200 |loss: 25.149380| train set 1.227x speedup, test set 1.015x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 24.739994| train set 1.228x speedup, test set 1.017x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.665438| train set 1.221x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.656467| train set 1.232x speedup, test set 1.017x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.286648| train set 1.228x speedup, test set 1.015x speedup, val set 0.999x speedup, step: 34
Epoch 34/200 |loss: 24.316545| train set 1.238x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.350594| train set 1.231x speedup, test set 1.015x speedup, val set 0.999x speedup, step: 36
Epoch 36/200 |loss: 23.884853| train set 1.231x speedup, test set 1.017x speedup, val set 0.999x speedup, step: 37
Epoch 37/200 |loss: 23.706860| train set 1.244x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.854116| train set 1.231x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 39
Epoch 39/200 |loss: 23.226387| train set 1.232x speedup, test set 1.739x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.360569| train set 1.311x speedup, test set 1.035x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.500835| train set 1.300x speedup, test set 1.778x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 22.886883| train set 1.231x speedup, test set 1.727x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.065136| train set 1.271x speedup, test set 1.778x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.681374| train set 1.266x speedup, test set 1.778x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.534130| train set 1.230x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.822487| train set 1.305x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 47
Epoch 47/200 |loss: 22.152563| train set 1.289x speedup, test set 1.778x speedup, val set 0.931x speedup, step: 48
Epoch 48/200 |loss: 22.511017| train set 1.311x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 49
Epoch 49/200 |loss: 21.894531| train set 1.311x speedup, test set 1.778x speedup, val set 0.931x speedup, step: 50
Epoch 50/200 |loss: 21.984953| train set 1.278x speedup, test set 1.778x speedup, val set 0.931x speedup, step: 51
Epoch 51/200 |loss: 21.628805| train set 1.311x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 52
Epoch 52/200 |loss: 21.440851| train set 1.328x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 21.466194| train set 1.311x speedup, test set 1.030x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 21.213120| train set 1.351x speedup, test set 2.683x speedup, val set 0.931x speedup, step: 55
Epoch 55/200 |loss: 21.254398| train set 1.236x speedup, test set 1.818x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 21.394894| train set 1.330x speedup, test set 1.775x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.204763| train set 1.327x speedup, test set 1.031x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 22.052320| train set 1.303x speedup, test set 1.775x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 21.090721| train set 1.377x speedup, test set 1.952x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.979347| train set 1.330x speedup, test set 1.929x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.344822| train set 1.328x speedup, test set 1.743x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.548018| train set 1.344x speedup, test set 1.815x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.218815| train set 1.315x speedup, test set 1.800x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 19.926464| train set 1.334x speedup, test set 1.800x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.026285| train set 1.345x speedup, test set 1.058x speedup, val set 0.931x speedup, step: 66
Epoch 66/200 |loss: 20.356276| train set 1.330x speedup, test set 1.812x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 19.423941| train set 1.323x speedup, test set 1.800x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.775709| train set 1.329x speedup, test set 2.017x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.974983| train set 1.345x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.706413| train set 1.330x speedup, test set 1.807x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 19.350126| train set 1.393x speedup, test set 2.509x speedup, val set 0.739x speedup, step: 72
Epoch 72/200 |loss: 19.884390| train set 1.306x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 18.971344| train set 1.308x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 18.795767| train set 1.408x speedup, test set 2.317x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 19.140167| train set 1.396x speedup, test set 1.771x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 18.590689| train set 1.390x speedup, test set 1.862x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.583780| train set 1.348x speedup, test set 1.032x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 18.878510| train set 1.400x speedup, test set 2.140x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 18.536594| train set 1.346x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.364761| train set 1.399x speedup, test set 1.766x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 17.805336| train set 1.395x speedup, test set 1.770x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 17.808609| train set 1.475x speedup, test set 2.502x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 17.669495| train set 1.395x speedup, test set 1.758x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 17.833197| train set 1.400x speedup, test set 1.144x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 17.916199| train set 1.401x speedup, test set 1.767x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 17.395372| train set 1.398x speedup, test set 1.049x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 17.015392| train set 1.413x speedup, test set 2.222x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 16.983347| train set 1.396x speedup, test set 1.796x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 16.997158| train set 1.448x speedup, test set 2.867x speedup, val set 0.739x speedup, step: 90
Epoch 90/200 |loss: 17.938440| train set 1.296x speedup, test set 1.038x speedup, val set 1.008x speedup, step: 91
Epoch 91/200 |loss: 19.893911| train set 1.505x speedup, test set 2.481x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 17.819611| train set 1.478x speedup, test set 2.435x speedup, val set 0.998x speedup, step: 93
Epoch 93/200 |loss: 16.690365| train set 1.409x speedup, test set 1.025x speedup, val set 1.008x speedup, step: 94
Epoch 94/200 |loss: 18.051981| train set 1.401x speedup, test set 1.121x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 16.560699| train set 1.415x speedup, test set 2.551x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 16.982447| train set 1.347x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.667400| train set 1.399x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 19.350147| train set 1.321x speedup, test set 2.083x speedup, val set 0.993x speedup, step: 99
Epoch 99/200 |loss: 18.632010| train set 1.410x speedup, test set 2.085x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.464245| train set 1.444x speedup, test set 1.122x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.253088| train set 1.400x speedup, test set 2.191x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.699957| train set 1.431x speedup, test set 2.051x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.305176| train set 1.392x speedup, test set 1.058x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.469013| train set 1.444x speedup, test set 1.926x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.059738| train set 1.501x speedup, test set 1.264x speedup, val set 0.738x speedup, step: 2
Epoch 106/200 |loss: 16.456842| train set 1.391x speedup, test set 1.774x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.338762| train set 1.421x speedup, test set 1.831x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.603867| train set 1.483x speedup, test set 2.546x speedup, val set 0.738x speedup, step: 2
Epoch 109/200 |loss: 16.051653| train set 1.396x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.945569| train set 1.416x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 16.060953| train set 1.524x speedup, test set 2.475x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.477777| train set 1.498x speedup, test set 1.814x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.423897| train set 1.415x speedup, test set 1.066x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.244710| train set 1.415x speedup, test set 2.065x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 14.912597| train set 1.496x speedup, test set 1.154x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 15.328224| train set 1.499x speedup, test set 1.909x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 15.603635| train set 1.519x speedup, test set 1.075x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 16.521769| train set 1.420x speedup, test set 1.845x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 15.299670| train set 1.516x speedup, test set 2.042x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 15.500996| train set 1.516x speedup, test set 1.151x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 16.451202| train set 1.405x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 15.838081| train set 1.459x speedup, test set 2.065x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 15.519560| train set 1.559x speedup, test set 2.263x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 16.700554| train set 1.400x speedup, test set 1.770x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 15.846696| train set 1.416x speedup, test set 1.782x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 15.890196| train set 1.537x speedup, test set 1.163x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 17.451654| train set 1.449x speedup, test set 1.841x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 14.591871| train set 1.404x speedup, test set 1.845x speedup, val set 0.996x speedup, step: 2
Epoch 129/200 |loss: 16.944473| train set 1.416x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 14.630640| train set 1.501x speedup, test set 1.148x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 15.683287| train set 1.435x speedup, test set 2.059x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 14.704475| train set 1.389x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 14.788627| train set 1.502x speedup, test set 1.136x speedup, val set 0.997x speedup, step: 1
Epoch 134/200 |loss: 14.431520| train set 1.544x speedup, test set 2.159x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 14.320040| train set 1.435x speedup, test set 1.771x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 14.340882| train set 1.414x speedup, test set 1.039x speedup, val set 0.997x speedup, step: 1
Epoch 137/200 |loss: 14.266476| train set 1.558x speedup, test set 2.231x speedup, val set 0.997x speedup, step: 1
Epoch 138/200 |loss: 13.919749| train set 1.539x speedup, test set 2.055x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 14.000094| train set 1.416x speedup, test set 1.021x speedup, val set 0.997x speedup, step: 1
Epoch 140/200 |loss: 14.340361| train set 1.394x speedup, test set 1.031x speedup, val set 0.997x speedup, step: 1
Epoch 141/200 |loss: 13.401074| train set 1.506x speedup, test set 2.180x speedup, val set 0.997x speedup, step: 1
Epoch 142/200 |loss: 14.051369| train set 1.501x speedup, test set 1.154x speedup, val set 0.997x speedup, step: 1
Epoch 143/200 |loss: 14.118470| train set 1.416x speedup, test set 1.783x speedup, val set 0.997x speedup, step: 1
Epoch 144/200 |loss: 13.469368| train set 1.501x speedup, test set 2.179x speedup, val set 0.997x speedup, step: 1
Epoch 145/200 |loss: 14.212133| train set 1.539x speedup, test set 1.153x speedup, val set 0.997x speedup, step: 1
Epoch 146/200 |loss: 14.547833| train set 1.416x speedup, test set 1.046x speedup, val set 0.997x speedup, step: 1
Epoch 147/200 |loss: 13.284866| train set 1.405x speedup, test set 2.064x speedup, val set 0.997x speedup, step: 1
Epoch 148/200 |loss: 14.716278| train set 1.538x speedup, test set 1.153x speedup, val set 0.997x speedup, step: 1
Epoch 149/200 |loss: 14.322226| train set 1.519x speedup, test set 1.144x speedup, val set 0.997x speedup, step: 1
Epoch 150/200 |loss: 14.073727| train set 1.460x speedup, test set 1.779x speedup, val set 0.997x speedup, step: 1
Epoch 151/200 |loss: 14.763147| train set 1.524x speedup, test set 2.064x speedup, val set 0.997x speedup, step: 1
Epoch 152/200 |loss: 13.054679| train set 1.519x speedup, test set 1.151x speedup, val set 0.997x speedup, step: 1
Epoch 153/200 |loss: 14.004777| train set 1.541x speedup, test set 1.031x speedup, val set 0.997x speedup, step: 1
Epoch 154/200 |loss: 13.206123| train set 1.500x speedup, test set 2.174x speedup, val set 0.997x speedup, step: 1
Epoch 155/200 |loss: 14.354499| train set 1.524x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 1
Epoch 156/200 |loss: 13.850656| train set 1.520x speedup, test set 2.179x speedup, val set 0.997x speedup, step: 1
Epoch 157/200 |loss: 13.441104| train set 1.538x speedup, test set 1.840x speedup, val set 0.997x speedup, step: 1
Epoch 158/200 |loss: 13.310770| train set 1.507x speedup, test set 1.779x speedup, val set 0.997x speedup, step: 1
Epoch 159/200 |loss: 12.745378| train set 1.520x speedup, test set 1.152x speedup, val set 0.997x speedup, step: 1
Epoch 160/200 |loss: 13.375490| train set 1.549x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 1
Epoch 161/200 |loss: 12.724380| train set 1.486x speedup, test set 2.191x speedup, val set 0.997x speedup, step: 1
Epoch 162/200 |loss: 13.240752| train set 1.483x speedup, test set 2.185x speedup, val set 0.997x speedup, step: 1
Epoch 163/200 |loss: 12.669962| train set 1.579x speedup, test set 1.146x speedup, val set 0.997x speedup, step: 1
Epoch 164/200 |loss: 12.567621| train set 1.513x speedup, test set 1.867x speedup, val set 0.997x speedup, step: 1
Epoch 165/200 |loss: 12.675596| train set 1.538x speedup, test set 1.950x speedup, val set 0.997x speedup, step: 1
Epoch 166/200 |loss: 12.280842| train set 1.525x speedup, test set 2.168x speedup, val set 0.997x speedup, step: 1
Epoch 167/200 |loss: 12.593724| train set 1.565x speedup, test set 1.779x speedup, val set 0.997x speedup, step: 1
Epoch 168/200 |loss: 12.243497| train set 1.513x speedup, test set 2.203x speedup, val set 0.997x speedup, step: 1
Epoch 169/200 |loss: 12.273903| train set 1.528x speedup, test set 1.154x speedup, val set 0.997x speedup, step: 1
Epoch 170/200 |loss: 12.239584| train set 1.488x speedup, test set 2.179x speedup, val set 0.997x speedup, step: 1
Epoch 171/200 |loss: 11.895412| train set 1.524x speedup, test set 2.179x speedup, val set 0.997x speedup, step: 1
Epoch 172/200 |loss: 12.211991| train set 1.557x speedup, test set 1.154x speedup, val set 0.997x speedup, step: 1
Epoch 173/200 |loss: 12.322001| train set 1.524x speedup, test set 2.168x speedup, val set 0.997x speedup, step: 1
Epoch 174/200 |loss: 12.072635| train set 1.560x speedup, test set 1.779x speedup, val set 0.997x speedup, step: 1
Epoch 175/200 |loss: 12.873307| train set 1.520x speedup, test set 2.174x speedup, val set 0.997x speedup, step: 1
Epoch 176/200 |loss: 12.960115| train set 1.543x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 1
Epoch 177/200 |loss: 12.782410| train set 1.519x speedup, test set 2.185x speedup, val set 0.997x speedup, step: 1
Epoch 178/200 |loss: 13.148821| train set 1.502x speedup, test set 1.156x speedup, val set 0.997x speedup, step: 1
Epoch 179/200 |loss: 12.897851| train set 1.550x speedup, test set 2.055x speedup, val set 0.997x speedup, step: 1
Epoch 180/200 |loss: 12.441747| train set 1.497x speedup, test set 2.181x speedup, val set 0.997x speedup, step: 1
Epoch 181/200 |loss: 14.056730| train set 1.503x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 1
Epoch 182/200 |loss: 13.602266| train set 1.479x speedup, test set 2.164x speedup, val set 0.997x speedup, step: 1
Epoch 183/200 |loss: 13.427838| train set 1.508x speedup, test set 2.200x speedup, val set 0.997x speedup, step: 1
Epoch 184/200 |loss: 13.693404| train set 1.465x speedup, test set 1.074x speedup, val set 0.997x speedup, step: 1
Epoch 185/200 |loss: 13.444657| train set 1.530x speedup, test set 2.164x speedup, val set 0.997x speedup, step: 1
Epoch 186/200 |loss: 13.075606| train set 1.520x speedup, test set 2.168x speedup, val set 0.997x speedup, step: 1
Epoch 187/200 |loss: 12.468992| train set 1.512x speedup, test set 1.783x speedup, val set 0.997x speedup, step: 1
Epoch 188/200 |loss: 12.783247| train set 1.525x speedup, test set 1.076x speedup, val set 0.997x speedup, step: 1
Epoch 189/200 |loss: 12.151496| train set 1.557x speedup, test set 2.179x speedup, val set 0.997x speedup, step: 1
Epoch 190/200 |loss: 12.498008| train set 1.520x speedup, test set 1.077x speedup, val set 0.997x speedup, step: 1
Epoch 191/200 |loss: 12.049105| train set 1.521x speedup, test set 2.185x speedup, val set 0.997x speedup, step: 1
Epoch 192/200 |loss: 12.112694| train set 1.496x speedup, test set 2.179x speedup, val set 0.997x speedup, step: 1
Epoch 193/200 |loss: 11.970387| train set 1.507x speedup, test set 2.179x speedup, val set 0.997x speedup, step: 1
Epoch 194/200 |loss: 11.711553| train set 1.526x speedup, test set 2.098x speedup, val set 0.997x speedup, step: 1
Epoch 195/200 |loss: 11.904683| train set 1.527x speedup, test set 2.098x speedup, val set 0.997x speedup, step: 1
Epoch 196/200 |loss: 11.500277| train set 1.551x speedup, test set 2.185x speedup, val set 0.997x speedup, step: 1
Epoch 197/200 |loss: 11.670674| train set 1.543x speedup, test set 1.151x speedup, val set 0.997x speedup, step: 1
Epoch 198/200 |loss: 11.387758| train set 1.521x speedup, test set 2.082x speedup, val set 0.997x speedup, step: 1
Epoch 199/200 |loss: 11.542025| train set 1.561x speedup, test set 2.082x speedup, val set 0.997x speedup, step: 1
Training per epoch cost 0.722 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 9.387s, pg runtime 8.283s, speedup 0.882x
07, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
08, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 5.179s, pg runtime 10.685s, speedup 2.063x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 163, train speedup 1.579, test speedup 1.146, val speedup 0.997
best test speedup epoch: 89, train speedup 1.448, test speedup 2.867, val speedup 0.739
best validation speedup epoch: 199, train speedup 1.561, test speedup 2.082, val speedup 0.997
last model at epoch 199, train speedup 1.561, test speedup 2.082, val speedup 0.997
execution cost 0:07:16.718346
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.566458, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079838| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695999| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379646| train set 1.115x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083639| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800268| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.530731| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.288414| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.017815| train set 1.178x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.762800| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.501335| train set 1.226x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.272839| train set 1.217x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.042274| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.836145| train set 1.204x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.800676| train set 1.216x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 27.053764| train set 1.226x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.259497| train set 1.214x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.472509| train set 1.182x speedup, test set 1.027x speedup, val set 0.932x speedup, step: 24
Epoch 24/200 |loss: 26.084362| train set 1.198x speedup, test set 1.023x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.928825| train set 1.214x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.726749| train set 1.227x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.429996| train set 1.181x speedup, test set 1.014x speedup, val set 0.930x speedup, step: 28
Epoch 28/200 |loss: 25.426334| train set 1.227x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 29
Epoch 29/200 |loss: 25.002550| train set 1.214x speedup, test set 1.014x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.146015| train set 1.224x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.698900| train set 1.200x speedup, test set 1.014x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.722580| train set 1.228x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 33
Epoch 33/200 |loss: 24.578644| train set 1.232x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.267782| train set 1.221x speedup, test set 1.017x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.215771| train set 1.230x speedup, test set 1.017x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.768665| train set 1.232x speedup, test set 1.733x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.823519| train set 1.231x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.834562| train set 1.207x speedup, test set 1.784x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.457829| train set 1.231x speedup, test set 1.017x speedup, val set 0.999x speedup, step: 40
Epoch 40/200 |loss: 23.687180| train set 1.278x speedup, test set 1.032x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.329618| train set 1.298x speedup, test set 1.784x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 22.865028| train set 1.232x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.130638| train set 1.301x speedup, test set 1.032x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.805988| train set 1.305x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.479969| train set 1.229x speedup, test set 1.791x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.599707| train set 1.306x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.344101| train set 1.307x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 21.920832| train set 1.232x speedup, test set 1.792x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.178696| train set 1.327x speedup, test set 1.035x speedup, val set 0.930x speedup, step: 50
Epoch 50/200 |loss: 21.926310| train set 1.325x speedup, test set 1.786x speedup, val set 0.931x speedup, step: 51
Epoch 51/200 |loss: 21.553188| train set 1.237x speedup, test set 1.031x speedup, val set 0.998x speedup, step: 52
Epoch 52/200 |loss: 22.839981| train set 1.325x speedup, test set 1.974x speedup, val set 0.931x speedup, step: 53
Epoch 53/200 |loss: 21.873178| train set 1.328x speedup, test set 1.030x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 21.356384| train set 1.326x speedup, test set 1.030x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 21.464174| train set 1.325x speedup, test set 1.846x speedup, val set 0.931x speedup, step: 56
Epoch 56/200 |loss: 20.826097| train set 1.325x speedup, test set 1.030x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 20.881704| train set 1.329x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 20.613132| train set 1.344x speedup, test set 1.778x speedup, val set 0.931x speedup, step: 59
Epoch 59/200 |loss: 20.277567| train set 1.325x speedup, test set 1.772x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.338882| train set 1.331x speedup, test set 1.772x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.055967| train set 1.330x speedup, test set 1.028x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 19.921774| train set 1.373x speedup, test set 1.846x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.026070| train set 1.330x speedup, test set 1.028x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.480167| train set 1.299x speedup, test set 1.897x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.522629| train set 1.343x speedup, test set 1.029x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 20.063629| train set 1.331x speedup, test set 1.769x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 19.626068| train set 1.378x speedup, test set 2.374x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.284628| train set 1.343x speedup, test set 1.027x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.682775| train set 1.349x speedup, test set 1.767x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.163651| train set 1.393x speedup, test set 2.194x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 18.885000| train set 1.331x speedup, test set 1.814x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 18.839338| train set 1.409x speedup, test set 2.328x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 19.002363| train set 1.332x speedup, test set 1.006x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 18.836561| train set 1.393x speedup, test set 1.149x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 19.576277| train set 1.333x speedup, test set 1.768x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 20.407722| train set 1.403x speedup, test set 1.068x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 20.628931| train set 1.343x speedup, test set 1.768x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 19.039934| train set 1.309x speedup, test set 1.791x speedup, val set 0.993x speedup, step: 79
Epoch 79/200 |loss: 20.576843| train set 1.430x speedup, test set 1.159x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.946198| train set 1.438x speedup, test set 1.174x speedup, val set 0.739x speedup, step: 81
Epoch 81/200 |loss: 18.928068| train set 1.358x speedup, test set 1.791x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 18.794897| train set 1.369x speedup, test set 1.907x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 18.282495| train set 1.398x speedup, test set 1.721x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.670370| train set 1.345x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.917624| train set 1.381x speedup, test set 1.806x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 18.201733| train set 1.488x speedup, test set 2.251x speedup, val set 0.739x speedup, step: 87
Epoch 87/200 |loss: 17.816788| train set 1.431x speedup, test set 2.273x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 17.687792| train set 1.383x speedup, test set 2.220x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 17.610748| train set 1.345x speedup, test set 1.027x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.631218| train set 1.399x speedup, test set 1.158x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.314569| train set 1.401x speedup, test set 1.081x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.152094| train set 1.416x speedup, test set 1.219x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.175406| train set 1.400x speedup, test set 1.723x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.175911| train set 1.400x speedup, test set 2.276x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 16.530752| train set 1.430x speedup, test set 1.234x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.063744| train set 1.374x speedup, test set 1.870x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.787546| train set 1.416x speedup, test set 1.829x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.074747| train set 1.454x speedup, test set 2.479x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.558943| train set 1.397x speedup, test set 1.841x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.518057| train set 1.388x speedup, test set 1.078x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.894470| train set 1.432x speedup, test set 1.841x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.799999| train set 1.421x speedup, test set 3.087x speedup, val set 0.738x speedup, step: 2
Epoch 103/200 |loss: 17.912348| train set 1.354x speedup, test set 1.025x speedup, val set 1.008x speedup, step: 1
Epoch 104/200 |loss: 19.981199| train set 1.393x speedup, test set 1.070x speedup, val set 0.997x speedup, step: 2
Epoch 105/200 |loss: 16.561632| train set 1.414x speedup, test set 1.357x speedup, val set 0.738x speedup, step: 3
Epoch 106/200 |loss: 18.405508| train set 1.373x speedup, test set 1.046x speedup, val set 0.997x speedup, step: 4
Epoch 107/200 |loss: 16.966063| train set 1.335x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 5
Epoch 108/200 |loss: 17.172447| train set 1.372x speedup, test set 1.981x speedup, val set 0.997x speedup, step: 6
Epoch 109/200 |loss: 16.800907| train set 1.425x speedup, test set 2.467x speedup, val set 0.739x speedup, step: 7
Epoch 110/200 |loss: 16.356146| train set 1.427x speedup, test set 1.777x speedup, val set 0.998x speedup, step: 8
Epoch 111/200 |loss: 16.820791| train set 1.399x speedup, test set 1.042x speedup, val set 0.997x speedup, step: 9
Epoch 112/200 |loss: 16.063303| train set 1.512x speedup, test set 2.313x speedup, val set 0.997x speedup, step: 10
Epoch 113/200 |loss: 16.270826| train set 1.385x speedup, test set 2.361x speedup, val set 0.997x speedup, step: 11
Epoch 114/200 |loss: 15.462671| train set 1.417x speedup, test set 1.885x speedup, val set 0.997x speedup, step: 12
Epoch 115/200 |loss: 16.063848| train set 1.391x speedup, test set 1.852x speedup, val set 0.997x speedup, step: 13
Epoch 116/200 |loss: 15.238078| train set 1.472x speedup, test set 2.313x speedup, val set 0.997x speedup, step: 14
Epoch 117/200 |loss: 15.958583| train set 1.433x speedup, test set 1.852x speedup, val set 0.997x speedup, step: 15
Epoch 118/200 |loss: 15.663794| train set 1.416x speedup, test set 1.542x speedup, val set 0.997x speedup, step: 16
Epoch 119/200 |loss: 16.864826| train set 1.408x speedup, test set 1.910x speedup, val set 0.997x speedup, step: 17
Epoch 120/200 |loss: 14.998046| train set 1.384x speedup, test set 1.870x speedup, val set 0.997x speedup, step: 18
Epoch 121/200 |loss: 15.761603| train set 1.520x speedup, test set 1.186x speedup, val set 0.997x speedup, step: 19
Epoch 122/200 |loss: 16.873053| train set 1.431x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 20
Epoch 123/200 |loss: 15.754845| train set 1.367x speedup, test set 1.847x speedup, val set 0.997x speedup, step: 21
Epoch 124/200 |loss: 16.123753| train set 1.511x speedup, test set 1.219x speedup, val set 0.997x speedup, step: 22
Epoch 125/200 |loss: 17.284683| train set 1.382x speedup, test set 1.052x speedup, val set 0.997x speedup, step: 23
Epoch 126/200 |loss: 15.774658| train set 1.392x speedup, test set 1.913x speedup, val set 0.997x speedup, step: 24
Epoch 127/200 |loss: 15.923875| train set 1.501x speedup, test set 2.249x speedup, val set 0.997x speedup, step: 25
Epoch 128/200 |loss: 16.362219| train set 1.501x speedup, test set 1.073x speedup, val set 0.997x speedup, step: 26
Epoch 129/200 |loss: 14.735172| train set 1.385x speedup, test set 1.862x speedup, val set 0.997x speedup, step: 27
Epoch 130/200 |loss: 16.077665| train set 1.422x speedup, test set 1.083x speedup, val set 0.997x speedup, step: 28
Epoch 131/200 |loss: 14.432978| train set 1.421x speedup, test set 2.201x speedup, val set 0.997x speedup, step: 29
Epoch 132/200 |loss: 15.255657| train set 1.412x speedup, test set 1.900x speedup, val set 0.997x speedup, step: 30
Epoch 133/200 |loss: 14.590991| train set 1.419x speedup, test set 1.068x speedup, val set 0.997x speedup, step: 31
Epoch 134/200 |loss: 14.467513| train set 1.518x speedup, test set 1.159x speedup, val set 0.997x speedup, step: 32
Epoch 135/200 |loss: 14.535439| train set 1.463x speedup, test set 2.212x speedup, val set 0.997x speedup, step: 33
Epoch 136/200 |loss: 14.111427| train set 1.413x speedup, test set 1.910x speedup, val set 0.997x speedup, step: 34
Epoch 137/200 |loss: 14.185143| train set 1.415x speedup, test set 1.074x speedup, val set 0.997x speedup, step: 35
Epoch 138/200 |loss: 14.054126| train set 1.518x speedup, test set 2.258x speedup, val set 0.997x speedup, step: 36
Epoch 139/200 |loss: 13.835974| train set 1.538x speedup, test set 1.899x speedup, val set 0.997x speedup, step: 37
Epoch 140/200 |loss: 13.852357| train set 1.424x speedup, test set 1.071x speedup, val set 0.997x speedup, step: 38
Epoch 141/200 |loss: 14.064752| train set 1.443x speedup, test set 1.059x speedup, val set 0.997x speedup, step: 39
Epoch 142/200 |loss: 13.331959| train set 1.505x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 40
Epoch 143/200 |loss: 13.949278| train set 1.526x speedup, test set 1.088x speedup, val set 0.997x speedup, step: 41
Epoch 144/200 |loss: 14.040865| train set 1.448x speedup, test set 1.057x speedup, val set 0.997x speedup, step: 42
Epoch 145/200 |loss: 13.342798| train set 1.471x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 43
Epoch 146/200 |loss: 13.973099| train set 1.518x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 44
Epoch 147/200 |loss: 14.611582| train set 1.413x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 45
Epoch 148/200 |loss: 13.420609| train set 1.444x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 46
Epoch 149/200 |loss: 14.352757| train set 1.544x speedup, test set 1.162x speedup, val set 0.997x speedup, step: 47
Epoch 150/200 |loss: 15.057751| train set 1.421x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 48
Epoch 151/200 |loss: 14.009352| train set 1.438x speedup, test set 1.859x speedup, val set 0.997x speedup, step: 49
Epoch 152/200 |loss: 14.934243| train set 1.539x speedup, test set 1.158x speedup, val set 0.997x speedup, step: 50
Epoch 153/200 |loss: 14.227468| train set 1.415x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 51
Epoch 154/200 |loss: 13.971869| train set 1.451x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 52
Epoch 155/200 |loss: 13.757221| train set 1.507x speedup, test set 2.200x speedup, val set 0.997x speedup, step: 53
Epoch 156/200 |loss: 13.607516| train set 1.501x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 54
Epoch 157/200 |loss: 13.804283| train set 1.415x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 55
Epoch 158/200 |loss: 13.408830| train set 1.508x speedup, test set 1.861x speedup, val set 1.008x speedup, step: 1
Epoch 159/200 |loss: 13.555943| train set 1.543x speedup, test set 2.262x speedup, val set 0.997x speedup, step: 2
Epoch 160/200 |loss: 12.964265| train set 1.501x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 3
Epoch 161/200 |loss: 13.042311| train set 1.438x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 4
Epoch 162/200 |loss: 12.791788| train set 1.490x speedup, test set 2.212x speedup, val set 0.997x speedup, step: 5
Epoch 163/200 |loss: 12.815006| train set 1.500x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 6
Epoch 164/200 |loss: 12.683628| train set 1.501x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 7
Epoch 165/200 |loss: 12.620568| train set 1.508x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 8
Epoch 166/200 |loss: 12.573635| train set 1.501x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 9
Epoch 167/200 |loss: 12.470851| train set 1.437x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 10
Epoch 168/200 |loss: 12.467653| train set 1.512x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 11
Epoch 169/200 |loss: 12.165034| train set 1.560x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 12
Epoch 170/200 |loss: 12.425776| train set 1.519x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 13
Epoch 171/200 |loss: 12.173420| train set 1.505x speedup, test set 1.056x speedup, val set 0.997x speedup, step: 14
Epoch 172/200 |loss: 12.282091| train set 1.492x speedup, test set 2.200x speedup, val set 0.997x speedup, step: 15
Epoch 173/200 |loss: 12.423152| train set 1.536x speedup, test set 1.063x speedup, val set 1.008x speedup, step: 1
Epoch 174/200 |loss: 12.919669| train set 1.507x speedup, test set 1.961x speedup, val set 0.997x speedup, step: 2
Epoch 175/200 |loss: 13.213881| train set 1.538x speedup, test set 1.877x speedup, val set 1.008x speedup, step: 1
Epoch 176/200 |loss: 12.752216| train set 1.501x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 2
Epoch 177/200 |loss: 11.901143| train set 1.519x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 3
Epoch 178/200 |loss: 11.983811| train set 1.536x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 4
Epoch 179/200 |loss: 12.339554| train set 1.542x speedup, test set 2.200x speedup, val set 0.997x speedup, step: 5
Epoch 180/200 |loss: 11.998328| train set 1.519x speedup, test set 1.887x speedup, val set 0.997x speedup, step: 6
Epoch 181/200 |loss: 11.802320| train set 1.562x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 7
Epoch 182/200 |loss: 11.557425| train set 1.542x speedup, test set 2.212x speedup, val set 0.997x speedup, step: 8
Epoch 183/200 |loss: 11.799947| train set 1.527x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 9
Epoch 184/200 |loss: 11.714931| train set 1.558x speedup, test set 2.212x speedup, val set 0.997x speedup, step: 10
Epoch 185/200 |loss: 11.493407| train set 1.558x speedup, test set 2.200x speedup, val set 0.997x speedup, step: 11
Epoch 186/200 |loss: 11.424597| train set 1.544x speedup, test set 1.087x speedup, val set 0.997x speedup, step: 12
Epoch 187/200 |loss: 11.475019| train set 1.487x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 13
Epoch 188/200 |loss: 11.631505| train set 1.537x speedup, test set 1.087x speedup, val set 0.997x speedup, step: 14
Epoch 189/200 |loss: 12.653558| train set 1.493x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 15
Epoch 190/200 |loss: 13.712708| train set 1.526x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 16
Epoch 191/200 |loss: 16.385601| train set 1.415x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 17
Epoch 192/200 |loss: 12.219630| train set 1.484x speedup, test set 2.086x speedup, val set 0.992x speedup, step: 18
Epoch 193/200 |loss: 18.582489| train set 1.509x speedup, test set 1.095x speedup, val set 0.997x speedup, step: 19
Epoch 194/200 |loss: 18.324993| train set 1.421x speedup, test set 1.068x speedup, val set 0.997x speedup, step: 20
Epoch 195/200 |loss: 16.802465| train set 1.475x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 21
Epoch 196/200 |loss: 16.181915| train set 1.496x speedup, test set 1.880x speedup, val set 0.997x speedup, step: 22
Epoch 197/200 |loss: 15.707437| train set 1.452x speedup, test set 1.460x speedup, val set 0.997x speedup, step: 23
Epoch 198/200 |loss: 15.503072| train set 1.414x speedup, test set 1.331x speedup, val set 0.997x speedup, step: 24
Epoch 199/200 |loss: 15.587125| train set 1.422x speedup, test set 1.074x speedup, val set 0.997x speedup, step: 25
Training per epoch cost 0.742 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
08, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 181, train speedup 1.562, test speedup 1.962, val speedup 0.997
best test speedup epoch: 102, train speedup 1.421, test speedup 3.087, val speedup 0.738
best validation speedup epoch: 175, train speedup 1.538, test speedup 1.877, val speedup 1.008
last model at epoch 199, train speedup 1.422, test speedup 1.074, val speedup 0.997
execution cost 0:07:19.418158
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:02.117691, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159269| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787601| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442108| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079720| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.696548| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.380054| train set 1.119x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.085123| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.802179| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.532080| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.288534| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.025404| train set 1.169x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.767063| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.510675| train set 1.239x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.273781| train set 1.219x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.052376| train set 1.219x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.899971| train set 1.206x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 27.018513| train set 1.216x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.944548| train set 1.191x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.288012| train set 1.186x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.592131| train set 1.225x speedup, test set 1.025x speedup, val set 0.932x speedup, step: 24
Epoch 24/200 |loss: 25.890465| train set 1.196x speedup, test set 1.026x speedup, val set 0.930x speedup, step: 25
Epoch 25/200 |loss: 26.090834| train set 1.214x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.541433| train set 1.215x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.661638| train set 1.202x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 28
Epoch 28/200 |loss: 25.276173| train set 1.202x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.201412| train set 1.228x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.054287| train set 1.216x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.810465| train set 1.202x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.850952| train set 1.207x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.375158| train set 1.231x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.490479| train set 1.208x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.067734| train set 1.205x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.017399| train set 1.229x speedup, test set 1.017x speedup, val set 0.999x speedup, step: 37
Epoch 37/200 |loss: 24.154440| train set 1.213x speedup, test set 1.785x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.672852| train set 1.234x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.724022| train set 1.229x speedup, test set 1.035x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.225355| train set 1.232x speedup, test set 1.785x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.014433| train set 1.315x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.202078| train set 1.300x speedup, test set 1.785x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.784088| train set 1.232x speedup, test set 1.018x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.774927| train set 1.254x speedup, test set 1.786x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.719770| train set 1.232x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.191351| train set 1.305x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 21.934900| train set 1.322x speedup, test set 1.786x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.007090| train set 1.237x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.014158| train set 1.337x speedup, test set 1.786x speedup, val set 0.930x speedup, step: 50
Epoch 50/200 |loss: 21.572668| train set 1.324x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 51
Epoch 51/200 |loss: 21.758085| train set 1.331x speedup, test set 1.786x speedup, val set 0.930x speedup, step: 52
Epoch 52/200 |loss: 21.850811| train set 1.328x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 22.226999| train set 1.312x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.174885| train set 1.330x speedup, test set 1.772x speedup, val set 0.930x speedup, step: 55
Epoch 55/200 |loss: 21.316639| train set 1.337x speedup, test set 1.416x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.577490| train set 1.330x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.594107| train set 1.321x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.986542| train set 1.331x speedup, test set 1.481x speedup, val set 0.930x speedup, step: 59
Epoch 59/200 |loss: 20.951187| train set 1.327x speedup, test set 1.765x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.970896| train set 1.308x speedup, test set 1.886x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.990976| train set 1.302x speedup, test set 1.029x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.762589| train set 1.330x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.333727| train set 1.377x speedup, test set 2.369x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.426577| train set 1.330x speedup, test set 1.774x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.064436| train set 1.330x speedup, test set 1.025x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.080442| train set 1.343x speedup, test set 1.979x speedup, val set 0.930x speedup, step: 67
Epoch 67/200 |loss: 19.549082| train set 1.344x speedup, test set 1.880x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.710171| train set 1.332x speedup, test set 1.808x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.742188| train set 1.345x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 19.213629| train set 1.399x speedup, test set 1.965x speedup, val set 0.930x speedup, step: 71
Epoch 71/200 |loss: 19.274290| train set 1.380x speedup, test set 1.849x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 18.697674| train set 1.330x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.041157| train set 1.332x speedup, test set 1.897x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 18.909254| train set 1.354x speedup, test set 1.481x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.819616| train set 1.329x speedup, test set 1.762x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.921679| train set 1.377x speedup, test set 2.092x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 20.156933| train set 1.345x speedup, test set 1.028x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 19.473711| train set 1.360x speedup, test set 1.916x speedup, val set 0.701x speedup, step: 79
Epoch 79/200 |loss: 19.498480| train set 1.465x speedup, test set 2.438x speedup, val set 0.701x speedup, step: 80
Epoch 80/200 |loss: 19.321358| train set 1.342x speedup, test set 1.834x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 19.309048| train set 1.329x speedup, test set 1.834x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 19.046221| train set 1.399x speedup, test set 2.170x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.561522| train set 1.341x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.669285| train set 1.399x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.208160| train set 1.409x speedup, test set 2.366x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 18.342438| train set 1.332x speedup, test set 1.759x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 18.189646| train set 1.400x speedup, test set 1.910x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 17.626762| train set 1.476x speedup, test set 1.681x speedup, val set 0.701x speedup, step: 89
Epoch 89/200 |loss: 18.434610| train set 1.341x speedup, test set 1.043x speedup, val set 0.998x speedup, step: 90
Epoch 90/200 |loss: 17.905655| train set 1.331x speedup, test set 1.834x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 17.355482| train set 1.429x speedup, test set 2.084x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 17.633152| train set 1.396x speedup, test set 1.914x speedup, val set 0.998x speedup, step: 93
Epoch 93/200 |loss: 17.359365| train set 1.373x speedup, test set 1.069x speedup, val set 0.998x speedup, step: 94
Epoch 94/200 |loss: 17.175713| train set 1.388x speedup, test set 2.017x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 16.832460| train set 1.400x speedup, test set 1.896x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 16.870493| train set 1.400x speedup, test set 1.023x speedup, val set 0.998x speedup, step: 97
Epoch 97/200 |loss: 16.715481| train set 1.410x speedup, test set 1.913x speedup, val set 0.998x speedup, step: 98
Epoch 98/200 |loss: 16.495287| train set 1.445x speedup, test set 1.119x speedup, val set 0.998x speedup, step: 99
Epoch 99/200 |loss: 16.690529| train set 1.411x speedup, test set 1.955x speedup, val set 0.998x speedup, step: 100
Epoch 100/200 |loss: 16.662384| train set 1.399x speedup, test set 1.040x speedup, val set 0.998x speedup, step: 1
Epoch 101/200 |loss: 17.113850| train set 1.374x speedup, test set 1.883x speedup, val set 0.998x speedup, step: 1
Epoch 102/200 |loss: 16.626087| train set 1.388x speedup, test set 2.048x speedup, val set 0.998x speedup, step: 1
Epoch 103/200 |loss: 16.526512| train set 1.390x speedup, test set 1.806x speedup, val set 0.998x speedup, step: 1
Epoch 104/200 |loss: 16.326704| train set 1.414x speedup, test set 1.944x speedup, val set 0.998x speedup, step: 1
Epoch 105/200 |loss: 15.797291| train set 1.420x speedup, test set 1.113x speedup, val set 0.998x speedup, step: 1
Epoch 106/200 |loss: 16.369541| train set 1.391x speedup, test set 1.874x speedup, val set 0.998x speedup, step: 1
Epoch 107/200 |loss: 16.686821| train set 1.415x speedup, test set 1.062x speedup, val set 0.998x speedup, step: 1
Epoch 108/200 |loss: 16.124363| train set 1.419x speedup, test set 1.997x speedup, val set 0.998x speedup, step: 1
Epoch 109/200 |loss: 15.572407| train set 1.410x speedup, test set 1.865x speedup, val set 0.998x speedup, step: 1
Epoch 110/200 |loss: 16.006063| train set 1.416x speedup, test set 1.054x speedup, val set 0.998x speedup, step: 1
Epoch 111/200 |loss: 16.971405| train set 1.416x speedup, test set 1.874x speedup, val set 0.998x speedup, step: 1
Epoch 112/200 |loss: 15.270408| train set 1.425x speedup, test set 1.865x speedup, val set 0.998x speedup, step: 1
Epoch 113/200 |loss: 16.833046| train set 1.437x speedup, test set 1.085x speedup, val set 0.997x speedup, step: 2
Epoch 114/200 |loss: 18.638773| train set 1.411x speedup, test set 1.031x speedup, val set 0.998x speedup, step: 1
Epoch 115/200 |loss: 16.376635| train set 1.347x speedup, test set 1.857x speedup, val set 0.988x speedup, step: 2
Epoch 116/200 |loss: 19.147917| train set 1.444x speedup, test set 1.044x speedup, val set 1.008x speedup, step: 1
Epoch 117/200 |loss: 17.807810| train set 1.463x speedup, test set 1.135x speedup, val set 0.998x speedup, step: 2
Epoch 118/200 |loss: 18.618338| train set 1.336x speedup, test set 1.023x speedup, val set 0.998x speedup, step: 3
Epoch 119/200 |loss: 16.805544| train set 1.408x speedup, test set 1.869x speedup, val set 0.998x speedup, step: 4
Epoch 120/200 |loss: 17.581675| train set 1.366x speedup, test set 2.241x speedup, val set 0.997x speedup, step: 5
Epoch 121/200 |loss: 16.371399| train set 1.410x speedup, test set 1.868x speedup, val set 0.997x speedup, step: 6
Epoch 122/200 |loss: 16.537199| train set 1.396x speedup, test set 1.777x speedup, val set 0.998x speedup, step: 7
Epoch 123/200 |loss: 16.183243| train set 1.411x speedup, test set 1.878x speedup, val set 0.998x speedup, step: 8
Epoch 124/200 |loss: 15.798489| train set 1.384x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 9
Epoch 125/200 |loss: 16.109045| train set 1.396x speedup, test set 1.758x speedup, val set 0.998x speedup, step: 10
Epoch 126/200 |loss: 15.465349| train set 1.396x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 11
Epoch 127/200 |loss: 15.512445| train set 1.511x speedup, test set 2.013x speedup, val set 0.997x speedup, step: 12
Epoch 128/200 |loss: 15.136883| train set 1.460x speedup, test set 1.878x speedup, val set 0.998x speedup, step: 13
Epoch 129/200 |loss: 15.148543| train set 1.416x speedup, test set 1.039x speedup, val set 0.998x speedup, step: 14
Epoch 130/200 |loss: 14.754472| train set 1.502x speedup, test set 1.039x speedup, val set 0.998x speedup, step: 15
Epoch 131/200 |loss: 15.003811| train set 1.416x speedup, test set 1.055x speedup, val set 0.998x speedup, step: 16
Epoch 132/200 |loss: 14.388677| train set 1.450x speedup, test set 1.855x speedup, val set 0.998x speedup, step: 17
Epoch 133/200 |loss: 14.626243| train set 1.383x speedup, test set 1.961x speedup, val set 0.998x speedup, step: 18
Epoch 134/200 |loss: 14.324335| train set 1.415x speedup, test set 1.064x speedup, val set 0.998x speedup, step: 19
Epoch 135/200 |loss: 14.260848| train set 1.420x speedup, test set 1.058x speedup, val set 0.998x speedup, step: 20
Epoch 136/200 |loss: 14.026803| train set 1.425x speedup, test set 1.859x speedup, val set 0.998x speedup, step: 21
Epoch 137/200 |loss: 14.014037| train set 1.422x speedup, test set 1.873x speedup, val set 0.998x speedup, step: 22
Epoch 138/200 |loss: 13.932114| train set 1.422x speedup, test set 1.873x speedup, val set 0.998x speedup, step: 23
Epoch 139/200 |loss: 13.680805| train set 1.520x speedup, test set 1.086x speedup, val set 0.998x speedup, step: 24
Epoch 140/200 |loss: 13.726444| train set 1.391x speedup, test set 1.877x speedup, val set 0.998x speedup, step: 25
Epoch 141/200 |loss: 13.700464| train set 1.389x speedup, test set 1.063x speedup, val set 0.998x speedup, step: 26
Epoch 142/200 |loss: 14.368614| train set 1.412x speedup, test set 1.878x speedup, val set 0.998x speedup, step: 27
Epoch 143/200 |loss: 14.139054| train set 1.536x speedup, test set 1.111x speedup, val set 0.998x speedup, step: 28
Epoch 144/200 |loss: 14.623617| train set 1.432x speedup, test set 1.877x speedup, val set 0.998x speedup, step: 29
Epoch 145/200 |loss: 14.236975| train set 1.449x speedup, test set 1.059x speedup, val set 0.998x speedup, step: 30
Epoch 146/200 |loss: 13.654016| train set 1.511x speedup, test set 2.483x speedup, val set 0.739x speedup, step: 31
Epoch 147/200 |loss: 14.021835| train set 1.417x speedup, test set 1.029x speedup, val set 0.998x speedup, step: 32
Epoch 148/200 |loss: 14.393044| train set 1.502x speedup, test set 1.092x speedup, val set 0.998x speedup, step: 33
Epoch 149/200 |loss: 13.885176| train set 1.502x speedup, test set 1.990x speedup, val set 0.998x speedup, step: 34
Epoch 150/200 |loss: 13.186632| train set 1.424x speedup, test set 1.865x speedup, val set 0.998x speedup, step: 35
Epoch 151/200 |loss: 13.832604| train set 1.502x speedup, test set 1.094x speedup, val set 0.998x speedup, step: 36
Epoch 152/200 |loss: 14.133587| train set 1.456x speedup, test set 1.873x speedup, val set 0.998x speedup, step: 37
Epoch 153/200 |loss: 13.023076| train set 1.515x speedup, test set 1.856x speedup, val set 0.998x speedup, step: 38
Epoch 154/200 |loss: 13.582462| train set 1.520x speedup, test set 1.088x speedup, val set 0.998x speedup, step: 39
Epoch 155/200 |loss: 15.041254| train set 1.416x speedup, test set 1.038x speedup, val set 0.998x speedup, step: 40
Epoch 156/200 |loss: 13.219457| train set 1.436x speedup, test set 1.868x speedup, val set 0.998x speedup, step: 41
Epoch 157/200 |loss: 14.881083| train set 1.525x speedup, test set 1.103x speedup, val set 0.998x speedup, step: 42
Epoch 158/200 |loss: 15.819440| train set 1.438x speedup, test set 1.063x speedup, val set 0.998x speedup, step: 43
Epoch 159/200 |loss: 15.164978| train set 1.450x speedup, test set 1.868x speedup, val set 0.998x speedup, step: 44
Epoch 160/200 |loss: 15.046387| train set 1.525x speedup, test set 2.232x speedup, val set 0.998x speedup, step: 45
Epoch 161/200 |loss: 14.748934| train set 1.499x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 46
Epoch 162/200 |loss: 14.208351| train set 1.415x speedup, test set 1.038x speedup, val set 0.998x speedup, step: 47
Epoch 163/200 |loss: 14.215625| train set 1.523x speedup, test set 1.868x speedup, val set 0.998x speedup, step: 48
Epoch 164/200 |loss: 13.580899| train set 1.537x speedup, test set 1.852x speedup, val set 0.998x speedup, step: 49
Epoch 165/200 |loss: 13.905086| train set 1.502x speedup, test set 1.032x speedup, val set 0.997x speedup, step: 50
Epoch 166/200 |loss: 13.022062| train set 1.518x speedup, test set 1.038x speedup, val set 0.997x speedup, step: 51
Epoch 167/200 |loss: 13.512017| train set 1.504x speedup, test set 1.872x speedup, val set 0.998x speedup, step: 52
Epoch 168/200 |loss: 12.796010| train set 1.522x speedup, test set 1.855x speedup, val set 0.998x speedup, step: 53
Epoch 169/200 |loss: 13.252341| train set 1.551x speedup, test set 1.872x speedup, val set 0.997x speedup, step: 54
Epoch 170/200 |loss: 12.496711| train set 1.520x speedup, test set 1.038x speedup, val set 0.997x speedup, step: 55
Epoch 171/200 |loss: 12.977286| train set 1.546x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 56
Epoch 172/200 |loss: 12.382665| train set 1.562x speedup, test set 1.059x speedup, val set 0.997x speedup, step: 57
Epoch 173/200 |loss: 12.638433| train set 1.538x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 58
Epoch 174/200 |loss: 12.326991| train set 1.508x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 59
Epoch 175/200 |loss: 12.527226| train set 1.492x speedup, test set 1.872x speedup, val set 0.997x speedup, step: 60
Epoch 176/200 |loss: 12.436453| train set 1.509x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 61
Epoch 177/200 |loss: 12.762908| train set 1.501x speedup, test set 1.877x speedup, val set 0.996x speedup, step: 62
Epoch 178/200 |loss: 12.928926| train set 1.448x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 63
Epoch 179/200 |loss: 13.312086| train set 1.508x speedup, test set 1.872x speedup, val set 0.998x speedup, step: 64
Epoch 180/200 |loss: 12.326440| train set 1.544x speedup, test set 1.868x speedup, val set 0.998x speedup, step: 65
Epoch 181/200 |loss: 11.975294| train set 1.540x speedup, test set 1.060x speedup, val set 0.998x speedup, step: 66
Epoch 182/200 |loss: 11.949018| train set 1.537x speedup, test set 1.966x speedup, val set 0.998x speedup, step: 67
Epoch 183/200 |loss: 12.055456| train set 1.536x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 68
Epoch 184/200 |loss: 12.019606| train set 1.525x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 69
Epoch 185/200 |loss: 11.905278| train set 1.519x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 70
Epoch 186/200 |loss: 11.805989| train set 1.556x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 71
Epoch 187/200 |loss: 11.871321| train set 1.519x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 72
Epoch 188/200 |loss: 11.991723| train set 1.563x speedup, test set 1.038x speedup, val set 0.997x speedup, step: 73
Epoch 189/200 |loss: 12.016669| train set 1.501x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 74
Epoch 190/200 |loss: 11.828429| train set 1.560x speedup, test set 1.868x speedup, val set 0.997x speedup, step: 75
Epoch 191/200 |loss: 11.655544| train set 1.559x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 76
Epoch 192/200 |loss: 11.335526| train set 1.539x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 77
Epoch 193/200 |loss: 11.305755| train set 1.545x speedup, test set 1.055x speedup, val set 0.997x speedup, step: 78
Epoch 194/200 |loss: 11.280178| train set 1.540x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 79
Epoch 195/200 |loss: 11.374128| train set 1.557x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 80
Epoch 196/200 |loss: 11.512876| train set 1.545x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 81
Epoch 197/200 |loss: 12.422595| train set 1.539x speedup, test set 1.872x speedup, val set 0.997x speedup, step: 82
Epoch 198/200 |loss: 12.120836| train set 1.540x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 83
Epoch 199/200 |loss: 12.288651| train set 1.512x speedup, test set 1.872x speedup, val set 0.997x speedup, step: 84
Training per epoch cost 0.724 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 9.387s, pg runtime 8.283s, speedup 0.882x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
16, opt runtime 1.876s, model runtime 6.015s, pg runtime 6.089s, speedup 1.012x
17, opt runtime 2.413s, model runtime 58.779s, pg runtime 57.198s, speedup 0.973x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.388s, pg runtime 3.645s, speedup 9.388x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 1.311s, pg runtime 0.965s, speedup 0.736x
====================
best train speedup epoch: 188, train speedup 1.563, test speedup 1.038, val speedup 0.997
best test speedup epoch: 146, train speedup 1.511, test speedup 2.483, val speedup 0.739
best validation speedup epoch: 116, train speedup 1.444, test speedup 1.044, val speedup 1.008
last model at epoch 199, train speedup 1.512, test speedup 1.872, val speedup 0.997
execution cost 0:07:14.566107
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.575938, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442108| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079720| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.696507| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379791| train set 1.119x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.084198| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.799793| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.527985| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.284592| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.022232| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.765469| train set 1.192x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.509182| train set 1.194x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.281467| train set 1.207x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.093355| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 27.059700| train set 1.219x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.887306| train set 1.216x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.480188| train set 1.218x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.283710| train set 1.199x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.177391| train set 1.204x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.814882| train set 1.200x speedup, test set 1.025x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.671598| train set 1.227x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.584370| train set 1.202x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.297131| train set 1.204x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.097858| train set 1.190x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.168676| train set 1.202x speedup, test set 1.023x speedup, val set 0.932x speedup, step: 30
Epoch 30/200 |loss: 25.134312| train set 1.203x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.565046| train set 1.228x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.628317| train set 1.224x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.641552| train set 1.229x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 23.997128| train set 1.226x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.227333| train set 1.298x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.086893| train set 1.231x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.580524| train set 1.271x speedup, test set 1.757x speedup, val set 0.931x speedup, step: 38
Epoch 38/200 |loss: 23.909115| train set 1.231x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.406536| train set 1.231x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.119135| train set 1.270x speedup, test set 1.785x speedup, val set 0.931x speedup, step: 41
Epoch 41/200 |loss: 23.282274| train set 1.305x speedup, test set 1.033x speedup, val set 0.998x speedup, step: 42
Epoch 42/200 |loss: 22.692455| train set 1.232x speedup, test set 1.033x speedup, val set 0.998x speedup, step: 43
Epoch 43/200 |loss: 22.804827| train set 1.256x speedup, test set 1.990x speedup, val set 0.931x speedup, step: 44
Epoch 44/200 |loss: 22.765949| train set 1.232x speedup, test set 1.735x speedup, val set 0.998x speedup, step: 45
Epoch 45/200 |loss: 22.934799| train set 1.296x speedup, test set 1.033x speedup, val set 0.931x speedup, step: 46
Epoch 46/200 |loss: 23.485123| train set 1.305x speedup, test set 1.028x speedup, val set 0.998x speedup, step: 47
Epoch 47/200 |loss: 22.140339| train set 1.320x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 48
Epoch 48/200 |loss: 22.997608| train set 1.259x speedup, test set 1.064x speedup, val set 0.931x speedup, step: 49
Epoch 49/200 |loss: 22.793732| train set 1.305x speedup, test set 1.030x speedup, val set 0.998x speedup, step: 50
Epoch 50/200 |loss: 22.386126| train set 1.305x speedup, test set 1.778x speedup, val set 0.993x speedup, step: 51
Epoch 51/200 |loss: 22.666327| train set 1.324x speedup, test set 1.778x speedup, val set 0.931x speedup, step: 52
Epoch 52/200 |loss: 21.708830| train set 1.325x speedup, test set 1.028x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 22.281580| train set 1.315x speedup, test set 1.028x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 21.283552| train set 1.303x speedup, test set 1.743x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 21.752850| train set 1.307x speedup, test set 1.018x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 21.089035| train set 1.305x speedup, test set 1.029x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.242146| train set 1.324x speedup, test set 1.867x speedup, val set 0.931x speedup, step: 58
Epoch 58/200 |loss: 20.864206| train set 1.329x speedup, test set 1.975x speedup, val set 0.931x speedup, step: 59
Epoch 59/200 |loss: 20.916059| train set 1.315x speedup, test set 1.028x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.583658| train set 1.314x speedup, test set 1.019x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.497875| train set 1.330x speedup, test set 1.812x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.277050| train set 1.330x speedup, test set 1.977x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.042336| train set 1.315x speedup, test set 1.027x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.160954| train set 1.343x speedup, test set 1.943x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 19.902344| train set 1.331x speedup, test set 1.769x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 19.991285| train set 1.393x speedup, test set 1.083x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.513393| train set 1.335x speedup, test set 1.029x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 20.097759| train set 1.394x speedup, test set 2.037x speedup, val set 0.993x speedup, step: 69
Epoch 69/200 |loss: 19.875328| train set 1.329x speedup, test set 1.769x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.177683| train set 1.334x speedup, test set 1.769x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 19.055426| train set 1.377x speedup, test set 2.448x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.216457| train set 1.330x speedup, test set 1.768x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 19.049545| train set 1.399x speedup, test set 1.833x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 18.776352| train set 1.337x speedup, test set 1.887x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 19.052624| train set 1.334x speedup, test set 1.063x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 19.062544| train set 1.307x speedup, test set 1.831x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.735794| train set 1.399x speedup, test set 2.373x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 18.343441| train set 1.378x speedup, test set 1.845x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 18.495195| train set 1.336x speedup, test set 1.874x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.537857| train set 1.350x speedup, test set 1.075x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 18.150942| train set 1.398x speedup, test set 2.093x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 18.233755| train set 1.369x speedup, test set 1.858x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 18.770382| train set 1.409x speedup, test set 1.128x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 19.261236| train set 1.338x speedup, test set 1.831x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 18.319126| train set 1.365x speedup, test set 2.118x speedup, val set 0.993x speedup, step: 86
Epoch 86/200 |loss: 18.580784| train set 1.415x speedup, test set 1.208x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 18.307711| train set 1.330x speedup, test set 1.041x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 18.182823| train set 1.381x speedup, test set 2.073x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.236935| train set 1.424x speedup, test set 1.197x speedup, val set 0.998x speedup, step: 90
Epoch 90/200 |loss: 17.402147| train set 1.351x speedup, test set 1.074x speedup, val set 1.008x speedup, step: 91
Epoch 91/200 |loss: 18.905592| train set 1.415x speedup, test set 1.958x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 16.962362| train set 1.402x speedup, test set 2.120x speedup, val set 0.998x speedup, step: 93
Epoch 93/200 |loss: 17.490881| train set 1.414x speedup, test set 1.848x speedup, val set 0.998x speedup, step: 94
Epoch 94/200 |loss: 17.410395| train set 1.415x speedup, test set 1.128x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 17.296549| train set 1.519x speedup, test set 2.541x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 16.818243| train set 1.396x speedup, test set 1.861x speedup, val set 0.998x speedup, step: 97
Epoch 97/200 |loss: 17.265503| train set 1.399x speedup, test set 1.089x speedup, val set 0.998x speedup, step: 98
Epoch 98/200 |loss: 17.940046| train set 1.413x speedup, test set 1.997x speedup, val set 0.998x speedup, step: 99
Epoch 99/200 |loss: 16.305428| train set 1.413x speedup, test set 1.955x speedup, val set 0.998x speedup, step: 100
Epoch 100/200 |loss: 18.701412| train set 1.425x speedup, test set 1.117x speedup, val set 0.998x speedup, step: 1
Epoch 101/200 |loss: 17.703085| train set 1.395x speedup, test set 1.055x speedup, val set 0.998x speedup, step: 1
Epoch 102/200 |loss: 17.454733| train set 1.394x speedup, test set 1.873x speedup, val set 0.998x speedup, step: 1
Epoch 103/200 |loss: 17.044634| train set 1.432x speedup, test set 2.398x speedup, val set 0.997x speedup, step: 2
Epoch 104/200 |loss: 17.017015| train set 1.415x speedup, test set 1.089x speedup, val set 0.998x speedup, step: 1
Epoch 105/200 |loss: 16.181381| train set 1.399x speedup, test set 1.037x speedup, val set 0.998x speedup, step: 1
Epoch 106/200 |loss: 16.570063| train set 1.421x speedup, test set 2.415x speedup, val set 0.998x speedup, step: 1
Epoch 107/200 |loss: 15.863729| train set 1.500x speedup, test set 2.395x speedup, val set 0.998x speedup, step: 1
Epoch 108/200 |loss: 16.129442| train set 1.429x speedup, test set 1.862x speedup, val set 0.998x speedup, step: 1
Epoch 109/200 |loss: 15.826132| train set 1.410x speedup, test set 1.888x speedup, val set 0.998x speedup, step: 1
Epoch 110/200 |loss: 15.646066| train set 1.421x speedup, test set 2.121x speedup, val set 0.998x speedup, step: 1
Epoch 111/200 |loss: 15.463356| train set 1.450x speedup, test set 1.963x speedup, val set 0.998x speedup, step: 1
Epoch 112/200 |loss: 15.537697| train set 1.426x speedup, test set 1.958x speedup, val set 0.998x speedup, step: 1
Epoch 113/200 |loss: 15.262936| train set 1.416x speedup, test set 1.957x speedup, val set 0.998x speedup, step: 1
Epoch 114/200 |loss: 15.170163| train set 1.424x speedup, test set 1.997x speedup, val set 0.998x speedup, step: 1
Epoch 115/200 |loss: 15.234302| train set 1.386x speedup, test set 1.093x speedup, val set 0.998x speedup, step: 1
Epoch 116/200 |loss: 15.200202| train set 1.415x speedup, test set 1.958x speedup, val set 0.998x speedup, step: 1
Epoch 117/200 |loss: 14.787084| train set 1.414x speedup, test set 1.957x speedup, val set 0.998x speedup, step: 1
Epoch 118/200 |loss: 14.584850| train set 1.540x speedup, test set 2.257x speedup, val set 0.998x speedup, step: 1
Epoch 119/200 |loss: 14.641942| train set 1.423x speedup, test set 1.958x speedup, val set 0.998x speedup, step: 1
Epoch 120/200 |loss: 14.486971| train set 1.415x speedup, test set 2.212x speedup, val set 0.997x speedup, step: 2
Epoch 121/200 |loss: 14.732222| train set 1.451x speedup, test set 1.953x speedup, val set 0.998x speedup, step: 1
Epoch 122/200 |loss: 14.690063| train set 1.465x speedup, test set 2.422x speedup, val set 0.738x speedup, step: 2
Epoch 123/200 |loss: 14.708124| train set 1.432x speedup, test set 1.800x speedup, val set 0.998x speedup, step: 1
Epoch 124/200 |loss: 15.357389| train set 1.538x speedup, test set 1.162x speedup, val set 0.997x speedup, step: 2
Epoch 125/200 |loss: 15.229178| train set 1.411x speedup, test set 1.961x speedup, val set 0.997x speedup, step: 3
Epoch 126/200 |loss: 14.622005| train set 1.454x speedup, test set 1.081x speedup, val set 0.997x speedup, step: 4
Epoch 127/200 |loss: 14.028182| train set 1.421x speedup, test set 2.211x speedup, val set 0.997x speedup, step: 5
Epoch 128/200 |loss: 13.836007| train set 1.435x speedup, test set 1.956x speedup, val set 0.997x speedup, step: 6
Epoch 129/200 |loss: 14.203286| train set 1.501x speedup, test set 1.175x speedup, val set 0.997x speedup, step: 7
Epoch 130/200 |loss: 14.954123| train set 1.439x speedup, test set 1.876x speedup, val set 0.994x speedup, step: 8
Epoch 131/200 |loss: 14.572998| train set 1.499x speedup, test set 1.961x speedup, val set 0.997x speedup, step: 9
Epoch 132/200 |loss: 14.029745| train set 1.537x speedup, test set 1.090x speedup, val set 0.997x speedup, step: 10
Epoch 133/200 |loss: 14.324136| train set 1.403x speedup, test set 1.961x speedup, val set 0.994x speedup, step: 11
Epoch 134/200 |loss: 14.789258| train set 1.500x speedup, test set 1.086x speedup, val set 0.997x speedup, step: 12
Epoch 135/200 |loss: 14.331791| train set 1.523x speedup, test set 2.249x speedup, val set 0.997x speedup, step: 13
Epoch 136/200 |loss: 13.797781| train set 1.425x speedup, test set 1.877x speedup, val set 0.994x speedup, step: 14
Epoch 137/200 |loss: 14.044453| train set 1.538x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 15
Epoch 138/200 |loss: 14.408556| train set 1.501x speedup, test set 2.000x speedup, val set 0.997x speedup, step: 16
Epoch 139/200 |loss: 13.355715| train set 1.472x speedup, test set 1.960x speedup, val set 0.997x speedup, step: 17
Epoch 140/200 |loss: 13.669588| train set 1.452x speedup, test set 1.078x speedup, val set 0.997x speedup, step: 18
Epoch 141/200 |loss: 13.636235| train set 1.537x speedup, test set 2.200x speedup, val set 0.994x speedup, step: 19
Epoch 142/200 |loss: 13.486375| train set 1.483x speedup, test set 1.078x speedup, val set 0.997x speedup, step: 20
Epoch 143/200 |loss: 13.958780| train set 1.518x speedup, test set 2.243x speedup, val set 0.997x speedup, step: 21
Epoch 144/200 |loss: 14.216955| train set 1.462x speedup, test set 1.867x speedup, val set 1.007x speedup, step: 1
Epoch 145/200 |loss: 14.386003| train set 1.437x speedup, test set 1.090x speedup, val set 0.997x speedup, step: 2
Epoch 146/200 |loss: 13.677629| train set 1.503x speedup, test set 2.229x speedup, val set 0.997x speedup, step: 3
Epoch 147/200 |loss: 13.073663| train set 1.441x speedup, test set 1.951x speedup, val set 0.997x speedup, step: 4
Epoch 148/200 |loss: 13.620971| train set 1.518x speedup, test set 1.090x speedup, val set 0.997x speedup, step: 5
Epoch 149/200 |loss: 14.648459| train set 1.488x speedup, test set 1.985x speedup, val set 0.997x speedup, step: 6
Epoch 150/200 |loss: 13.118084| train set 1.472x speedup, test set 1.997x speedup, val set 0.997x speedup, step: 7
Epoch 151/200 |loss: 15.028531| train set 1.494x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 8
Epoch 152/200 |loss: 15.926356| train set 1.448x speedup, test set 1.090x speedup, val set 0.997x speedup, step: 9
Epoch 153/200 |loss: 13.998453| train set 1.487x speedup, test set 2.245x speedup, val set 0.988x speedup, step: 10
Epoch 154/200 |loss: 15.765326| train set 1.521x speedup, test set 1.172x speedup, val set 0.997x speedup, step: 11
Epoch 155/200 |loss: 13.701302| train set 1.469x speedup, test set 1.064x speedup, val set 0.997x speedup, step: 12
Epoch 156/200 |loss: 14.202656| train set 1.409x speedup, test set 1.961x speedup, val set 0.997x speedup, step: 13
Epoch 157/200 |loss: 13.499823| train set 1.495x speedup, test set 2.250x speedup, val set 0.997x speedup, step: 14
Epoch 158/200 |loss: 13.609693| train set 1.458x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 15
Epoch 159/200 |loss: 13.478782| train set 1.505x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 16
Epoch 160/200 |loss: 13.255632| train set 1.558x speedup, test set 1.872x speedup, val set 0.997x speedup, step: 17
Epoch 161/200 |loss: 13.068757| train set 1.542x speedup, test set 2.254x speedup, val set 0.997x speedup, step: 18
Epoch 162/200 |loss: 12.839746| train set 1.536x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 19
Epoch 163/200 |loss: 12.903928| train set 1.507x speedup, test set 1.955x speedup, val set 0.993x speedup, step: 20
Epoch 164/200 |loss: 12.810721| train set 1.531x speedup, test set 1.081x speedup, val set 0.994x speedup, step: 21
Epoch 165/200 |loss: 12.555254| train set 1.519x speedup, test set 1.175x speedup, val set 0.997x speedup, step: 22
Epoch 166/200 |loss: 12.719490| train set 1.502x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 23
Epoch 167/200 |loss: 12.330738| train set 1.519x speedup, test set 1.994x speedup, val set 0.997x speedup, step: 24
Epoch 168/200 |loss: 12.378927| train set 1.538x speedup, test set 1.956x speedup, val set 0.997x speedup, step: 25
Epoch 169/200 |loss: 12.138221| train set 1.507x speedup, test set 1.995x speedup, val set 0.997x speedup, step: 26
Epoch 170/200 |loss: 12.114371| train set 1.519x speedup, test set 1.951x speedup, val set 0.997x speedup, step: 27
Epoch 171/200 |loss: 11.972859| train set 1.488x speedup, test set 1.081x speedup, val set 0.997x speedup, step: 28
Epoch 172/200 |loss: 11.925004| train set 1.530x speedup, test set 1.955x speedup, val set 0.997x speedup, step: 29
Epoch 173/200 |loss: 11.823248| train set 1.493x speedup, test set 1.956x speedup, val set 0.997x speedup, step: 30
Epoch 174/200 |loss: 11.721645| train set 1.488x speedup, test set 1.956x speedup, val set 0.997x speedup, step: 31
Epoch 175/200 |loss: 11.714742| train set 1.559x speedup, test set 1.951x speedup, val set 0.997x speedup, step: 32
Epoch 176/200 |loss: 11.612339| train set 1.555x speedup, test set 1.946x speedup, val set 0.997x speedup, step: 33
Epoch 177/200 |loss: 11.604946| train set 1.519x speedup, test set 1.961x speedup, val set 0.997x speedup, step: 34
Epoch 178/200 |loss: 11.694494| train set 1.561x speedup, test set 1.082x speedup, val set 0.997x speedup, step: 35
Epoch 179/200 |loss: 12.131804| train set 1.525x speedup, test set 2.261x speedup, val set 0.997x speedup, step: 36
Epoch 180/200 |loss: 13.420898| train set 1.437x speedup, test set 1.058x speedup, val set 1.008x speedup, step: 1
Epoch 181/200 |loss: 15.520647| train set 1.477x speedup, test set 1.211x speedup, val set 0.997x speedup, step: 2
Epoch 182/200 |loss: 15.278604| train set 1.390x speedup, test set 1.881x speedup, val set 0.994x speedup, step: 3
Epoch 183/200 |loss: 13.628800| train set 1.513x speedup, test set 1.988x speedup, val set 1.007x speedup, step: 4
Epoch 184/200 |loss: 15.272923| train set 1.472x speedup, test set 1.211x speedup, val set 0.997x speedup, step: 5
Epoch 185/200 |loss: 14.103445| train set 1.394x speedup, test set 1.891x speedup, val set 0.989x speedup, step: 6
Epoch 186/200 |loss: 15.158534| train set 1.511x speedup, test set 1.989x speedup, val set 0.994x speedup, step: 7
Epoch 187/200 |loss: 13.454970| train set 1.578x speedup, test set 2.419x speedup, val set 0.994x speedup, step: 8
Epoch 188/200 |loss: 13.589215| train set 1.520x speedup, test set 1.057x speedup, val set 0.994x speedup, step: 9
Epoch 189/200 |loss: 13.935043| train set 1.523x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 10
Epoch 190/200 |loss: 13.109549| train set 1.547x speedup, test set 1.989x speedup, val set 0.997x speedup, step: 11
Epoch 191/200 |loss: 13.003761| train set 1.545x speedup, test set 2.000x speedup, val set 0.997x speedup, step: 12
Epoch 192/200 |loss: 12.895585| train set 1.558x speedup, test set 1.056x speedup, val set 0.997x speedup, step: 13
Epoch 193/200 |loss: 12.750082| train set 1.526x speedup, test set 1.951x speedup, val set 0.997x speedup, step: 14
Epoch 194/200 |loss: 12.432889| train set 1.507x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 15
Epoch 195/200 |loss: 12.367746| train set 1.562x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 16
Epoch 196/200 |loss: 12.241414| train set 1.518x speedup, test set 1.955x speedup, val set 0.997x speedup, step: 17
Epoch 197/200 |loss: 12.040278| train set 1.471x speedup, test set 1.961x speedup, val set 0.997x speedup, step: 18
Epoch 198/200 |loss: 11.953475| train set 1.520x speedup, test set 1.878x speedup, val set 0.997x speedup, step: 19
Epoch 199/200 |loss: 11.817598| train set 1.560x speedup, test set 1.955x speedup, val set 0.997x speedup, step: 20
Training per epoch cost 0.618 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
16, opt runtime 1.876s, model runtime 6.015s, pg runtime 6.089s, speedup 1.012x
17, opt runtime 2.413s, model runtime 58.779s, pg runtime 57.198s, speedup 0.973x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.544s, pg runtime 2.558s, speedup 1.657x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.434s, pg runtime 0.332s, speedup 0.765x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 1.311s, pg runtime 0.965s, speedup 0.736x
====================
best train speedup epoch: 187, train speedup 1.578, test speedup 2.419, val speedup 0.994
best test speedup epoch: 95, train speedup 1.519, test speedup 2.541, val speedup 0.998
best validation speedup epoch: 180, train speedup 1.437, test speedup 1.058, val speedup 1.008
last model at epoch 199, train speedup 1.560, test speedup 1.955, val speedup 0.997
execution cost 0:06:15.136075
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.867989, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695999| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379646| train set 1.115x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083645| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800293| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.530991| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.289431| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.017004| train set 1.173x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.761354| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.498055| train set 1.231x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.266954| train set 1.217x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.033342| train set 1.229x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.796053| train set 1.216x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.553307| train set 1.216x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.348900| train set 1.204x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.441196| train set 1.211x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.792290| train set 1.177x speedup, test set 1.026x speedup, val set 0.932x speedup, step: 24
Epoch 24/200 |loss: 26.101431| train set 1.184x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 25
Epoch 25/200 |loss: 25.935127| train set 1.195x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.791746| train set 1.208x speedup, test set 1.015x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.424091| train set 1.178x speedup, test set 1.014x speedup, val set 0.930x speedup, step: 28
Epoch 28/200 |loss: 25.453083| train set 1.208x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 25.037365| train set 1.215x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.153852| train set 1.205x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.649340| train set 1.199x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.729292| train set 1.197x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.358027| train set 1.230x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.276186| train set 1.220x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.203466| train set 1.224x speedup, test set 1.032x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.838465| train set 1.231x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.940538| train set 1.182x speedup, test set 1.032x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.652014| train set 1.230x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 39
Epoch 39/200 |loss: 23.462193| train set 1.200x speedup, test set 1.784x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.558544| train set 1.232x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.287611| train set 1.299x speedup, test set 1.057x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 22.806192| train set 1.232x speedup, test set 1.785x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.952555| train set 1.317x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.715158| train set 1.232x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.276390| train set 1.232x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.511860| train set 1.315x speedup, test set 1.372x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.505697| train set 1.231x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.127077| train set 1.282x speedup, test set 2.050x speedup, val set 0.930x speedup, step: 49
Epoch 49/200 |loss: 22.829350| train set 1.213x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.480099| train set 1.313x speedup, test set 1.028x speedup, val set 0.930x speedup, step: 51
Epoch 51/200 |loss: 21.960363| train set 1.320x speedup, test set 2.270x speedup, val set 0.930x speedup, step: 52
Epoch 52/200 |loss: 22.239286| train set 1.305x speedup, test set 1.868x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.454760| train set 1.305x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.657274| train set 1.317x speedup, test set 1.946x speedup, val set 0.930x speedup, step: 55
Epoch 55/200 |loss: 21.247711| train set 1.328x speedup, test set 1.846x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.124605| train set 1.330x speedup, test set 1.818x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 21.159252| train set 1.334x speedup, test set 1.918x speedup, val set 0.930x speedup, step: 58
Epoch 58/200 |loss: 20.592424| train set 1.398x speedup, test set 2.042x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.574203| train set 1.329x speedup, test set 1.846x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.504810| train set 1.330x speedup, test set 1.860x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.042818| train set 1.330x speedup, test set 1.832x speedup, val set 0.930x speedup, step: 62
Epoch 62/200 |loss: 20.214380| train set 1.338x speedup, test set 1.096x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.023129| train set 1.327x speedup, test set 1.769x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.650331| train set 1.342x speedup, test set 2.915x speedup, val set 0.739x speedup, step: 65
Epoch 65/200 |loss: 22.749815| train set 1.233x speedup, test set 1.011x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 22.125185| train set 1.327x speedup, test set 1.739x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.384905| train set 1.430x speedup, test set 2.904x speedup, val set 0.701x speedup, step: 68
Epoch 68/200 |loss: 21.906145| train set 1.393x speedup, test set 1.037x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.584198| train set 1.303x speedup, test set 1.768x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 21.208939| train set 1.344x speedup, test set 1.017x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 20.012100| train set 1.367x speedup, test set 2.096x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.938114| train set 1.344x speedup, test set 1.737x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 19.736099| train set 1.304x speedup, test set 1.769x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.493246| train set 1.345x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.332672| train set 1.399x speedup, test set 2.254x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.140570| train set 1.400x speedup, test set 2.133x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.016802| train set 1.345x speedup, test set 1.011x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.922508| train set 1.345x speedup, test set 1.774x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.674934| train set 1.340x speedup, test set 1.737x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.634054| train set 1.399x speedup, test set 1.907x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.238228| train set 1.386x speedup, test set 1.762x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.123274| train set 1.350x speedup, test set 1.025x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.063749| train set 1.415x speedup, test set 2.303x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 17.988148| train set 1.400x speedup, test set 1.323x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.756899| train set 1.396x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.903105| train set 1.346x speedup, test set 1.018x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.418171| train set 1.383x speedup, test set 2.502x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 18.868437| train set 1.378x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 19.095537| train set 1.373x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.396852| train set 1.400x speedup, test set 2.184x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 18.386856| train set 1.400x speedup, test set 1.682x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 18.842627| train set 1.346x speedup, test set 1.321x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.449503| train set 1.388x speedup, test set 1.874x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 18.805174| train set 1.432x speedup, test set 1.116x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.220409| train set 1.431x speedup, test set 1.432x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.492147| train set 1.397x speedup, test set 1.861x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.192753| train set 1.401x speedup, test set 1.874x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.776503| train set 1.415x speedup, test set 1.488x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.273033| train set 1.401x speedup, test set 1.350x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.310499| train set 1.387x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.133392| train set 1.400x speedup, test set 1.356x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.152248| train set 1.416x speedup, test set 1.499x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.436670| train set 1.401x speedup, test set 1.860x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.238199| train set 1.401x speedup, test set 1.973x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 15.875069| train set 1.416x speedup, test set 2.077x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 15.872261| train set 1.410x speedup, test set 2.077x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 15.663879| train set 1.416x speedup, test set 1.321x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.531157| train set 1.416x speedup, test set 1.394x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.296616| train set 1.410x speedup, test set 2.121x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.343491| train set 1.416x speedup, test set 1.067x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.433070| train set 1.429x speedup, test set 1.861x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.274170| train set 1.452x speedup, test set 2.787x speedup, val set 0.738x speedup, step: 2
Epoch 113/200 |loss: 15.726275| train set 1.344x speedup, test set 1.023x speedup, val set 1.008x speedup, step: 1
Epoch 114/200 |loss: 18.423670| train set 1.516x speedup, test set 1.472x speedup, val set 0.994x speedup, step: 2
Epoch 115/200 |loss: 18.180475| train set 1.387x speedup, test set 1.406x speedup, val set 0.997x speedup, step: 3
Epoch 116/200 |loss: 16.441038| train set 1.374x speedup, test set 1.411x speedup, val set 0.997x speedup, step: 4
Epoch 117/200 |loss: 16.268559| train set 1.447x speedup, test set 1.958x speedup, val set 0.998x speedup, step: 5
Epoch 118/200 |loss: 16.737923| train set 1.394x speedup, test set 1.973x speedup, val set 0.997x speedup, step: 6
Epoch 119/200 |loss: 15.756910| train set 1.415x speedup, test set 1.401x speedup, val set 0.997x speedup, step: 7
Epoch 120/200 |loss: 15.941416| train set 1.380x speedup, test set 1.942x speedup, val set 0.997x speedup, step: 8
Epoch 121/200 |loss: 15.723565| train set 1.519x speedup, test set 2.043x speedup, val set 0.997x speedup, step: 9
Epoch 122/200 |loss: 15.234267| train set 1.415x speedup, test set 1.852x speedup, val set 0.997x speedup, step: 10
Epoch 123/200 |loss: 15.355510| train set 1.355x speedup, test set 1.962x speedup, val set 0.994x speedup, step: 11
Epoch 124/200 |loss: 14.936511| train set 1.471x speedup, test set 1.086x speedup, val set 0.997x speedup, step: 12
Epoch 125/200 |loss: 14.788349| train set 1.447x speedup, test set 1.385x speedup, val set 0.997x speedup, step: 13
Epoch 126/200 |loss: 14.711390| train set 1.410x speedup, test set 2.077x speedup, val set 0.997x speedup, step: 14
Epoch 127/200 |loss: 14.501347| train set 1.432x speedup, test set 2.081x speedup, val set 0.997x speedup, step: 15
Epoch 128/200 |loss: 14.290215| train set 1.435x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 16
Epoch 129/200 |loss: 14.303573| train set 1.504x speedup, test set 1.997x speedup, val set 0.997x speedup, step: 17
Epoch 130/200 |loss: 14.301733| train set 1.416x speedup, test set 1.401x speedup, val set 0.997x speedup, step: 18
Epoch 131/200 |loss: 15.088852| train set 1.384x speedup, test set 1.874x speedup, val set 0.997x speedup, step: 19
Epoch 132/200 |loss: 16.793179| train set 1.520x speedup, test set 1.487x speedup, val set 0.997x speedup, step: 20
Epoch 133/200 |loss: 20.774044| train set 1.389x speedup, test set 1.067x speedup, val set 0.997x speedup, step: 21
Epoch 134/200 |loss: 16.226980| train set 1.310x speedup, test set 1.873x speedup, val set 0.977x speedup, step: 22
Epoch 135/200 |loss: 19.770523| train set 1.534x speedup, test set 1.388x speedup, val set 0.738x speedup, step: 23
Epoch 136/200 |loss: 16.684494| train set 1.462x speedup, test set 1.525x speedup, val set 0.738x speedup, step: 24
Epoch 137/200 |loss: 17.277473| train set 1.409x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 25
Epoch 138/200 |loss: 15.916047| train set 1.399x speedup, test set 1.794x speedup, val set 0.997x speedup, step: 26
Epoch 139/200 |loss: 16.643829| train set 1.491x speedup, test set 2.090x speedup, val set 0.997x speedup, step: 27
Epoch 140/200 |loss: 15.363674| train set 1.426x speedup, test set 1.923x speedup, val set 0.997x speedup, step: 28
Epoch 141/200 |loss: 16.220091| train set 1.416x speedup, test set 1.068x speedup, val set 0.997x speedup, step: 29
Epoch 142/200 |loss: 15.197598| train set 1.493x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 30
Epoch 143/200 |loss: 15.555215| train set 1.518x speedup, test set 1.993x speedup, val set 0.997x speedup, step: 31
Epoch 144/200 |loss: 14.814368| train set 1.443x speedup, test set 1.409x speedup, val set 0.997x speedup, step: 32
Epoch 145/200 |loss: 15.190501| train set 1.416x speedup, test set 1.100x speedup, val set 0.997x speedup, step: 33
Epoch 146/200 |loss: 14.532413| train set 1.422x speedup, test set 1.976x speedup, val set 0.997x speedup, step: 34
Epoch 147/200 |loss: 14.600755| train set 1.509x speedup, test set 1.975x speedup, val set 0.997x speedup, step: 35
Epoch 148/200 |loss: 14.275640| train set 1.471x speedup, test set 1.961x speedup, val set 0.997x speedup, step: 36
Epoch 149/200 |loss: 14.176884| train set 1.520x speedup, test set 1.976x speedup, val set 0.997x speedup, step: 37
Epoch 150/200 |loss: 13.896749| train set 1.448x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 38
Epoch 151/200 |loss: 13.946152| train set 1.538x speedup, test set 1.953x speedup, val set 0.997x speedup, step: 39
Epoch 152/200 |loss: 13.611126| train set 1.502x speedup, test set 1.957x speedup, val set 0.997x speedup, step: 40
Epoch 153/200 |loss: 13.648965| train set 1.502x speedup, test set 1.967x speedup, val set 0.997x speedup, step: 41
Epoch 154/200 |loss: 13.460820| train set 1.506x speedup, test set 1.973x speedup, val set 0.997x speedup, step: 42
Epoch 155/200 |loss: 13.339238| train set 1.542x speedup, test set 1.087x speedup, val set 0.997x speedup, step: 43
Epoch 156/200 |loss: 13.126960| train set 1.404x speedup, test set 1.403x speedup, val set 0.997x speedup, step: 44
Epoch 157/200 |loss: 13.160166| train set 1.489x speedup, test set 1.976x speedup, val set 0.997x speedup, step: 45
Epoch 158/200 |loss: 12.918872| train set 1.501x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 46
Epoch 159/200 |loss: 12.986291| train set 1.553x speedup, test set 1.970x speedup, val set 0.997x speedup, step: 47
Epoch 160/200 |loss: 12.697435| train set 1.515x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 48
Epoch 161/200 |loss: 12.728816| train set 1.507x speedup, test set 1.963x speedup, val set 0.997x speedup, step: 49
Epoch 162/200 |loss: 12.620567| train set 1.507x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 50
Epoch 163/200 |loss: 12.476794| train set 1.521x speedup, test set 1.083x speedup, val set 0.997x speedup, step: 51
Epoch 164/200 |loss: 12.554164| train set 1.513x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 52
Epoch 165/200 |loss: 12.555123| train set 1.537x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 53
Epoch 166/200 |loss: 13.133231| train set 1.483x speedup, test set 2.082x speedup, val set 0.996x speedup, step: 54
Epoch 167/200 |loss: 14.085752| train set 1.448x speedup, test set 1.064x speedup, val set 0.997x speedup, step: 55
Epoch 168/200 |loss: 15.338037| train set 1.520x speedup, test set 1.967x speedup, val set 0.997x speedup, step: 56
Epoch 169/200 |loss: 12.935367| train set 1.513x speedup, test set 2.116x speedup, val set 0.996x speedup, step: 57
Epoch 170/200 |loss: 13.039613| train set 1.448x speedup, test set 1.057x speedup, val set 0.997x speedup, step: 58
Epoch 171/200 |loss: 13.929317| train set 1.502x speedup, test set 1.982x speedup, val set 0.997x speedup, step: 59
Epoch 172/200 |loss: 12.625402| train set 1.531x speedup, test set 2.076x speedup, val set 0.997x speedup, step: 60
Epoch 173/200 |loss: 12.698856| train set 1.517x speedup, test set 1.090x speedup, val set 0.997x speedup, step: 61
Epoch 174/200 |loss: 13.345518| train set 1.531x speedup, test set 1.967x speedup, val set 0.997x speedup, step: 62
Epoch 175/200 |loss: 12.119617| train set 1.531x speedup, test set 2.072x speedup, val set 0.997x speedup, step: 63
Epoch 176/200 |loss: 12.846782| train set 1.502x speedup, test set 1.083x speedup, val set 0.997x speedup, step: 64
Epoch 177/200 |loss: 12.639491| train set 1.496x speedup, test set 1.967x speedup, val set 0.997x speedup, step: 65
Epoch 178/200 |loss: 12.098161| train set 1.478x speedup, test set 2.140x speedup, val set 0.997x speedup, step: 66
Epoch 179/200 |loss: 12.755589| train set 1.535x speedup, test set 1.966x speedup, val set 0.997x speedup, step: 67
Epoch 180/200 |loss: 12.185233| train set 1.540x speedup, test set 1.966x speedup, val set 0.997x speedup, step: 68
Epoch 181/200 |loss: 12.014771| train set 1.513x speedup, test set 1.996x speedup, val set 0.996x speedup, step: 69
Epoch 182/200 |loss: 12.363892| train set 1.520x speedup, test set 1.091x speedup, val set 0.997x speedup, step: 70
Epoch 183/200 |loss: 12.012512| train set 1.563x speedup, test set 1.963x speedup, val set 0.997x speedup, step: 71
Epoch 184/200 |loss: 12.101274| train set 1.520x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 72
Epoch 185/200 |loss: 12.418591| train set 1.507x speedup, test set 1.963x speedup, val set 0.997x speedup, step: 73
Epoch 186/200 |loss: 12.685843| train set 1.541x speedup, test set 1.102x speedup, val set 0.997x speedup, step: 74
Epoch 187/200 |loss: 14.032967| train set 1.553x speedup, test set 1.963x speedup, val set 0.997x speedup, step: 75
Epoch 188/200 |loss: 11.787115| train set 1.504x speedup, test set 1.963x speedup, val set 0.997x speedup, step: 76
Epoch 189/200 |loss: 12.467690| train set 1.472x speedup, test set 1.089x speedup, val set 0.997x speedup, step: 77
Epoch 190/200 |loss: 14.188359| train set 1.436x speedup, test set 1.946x speedup, val set 0.997x speedup, step: 78
Epoch 191/200 |loss: 13.241301| train set 1.527x speedup, test set 2.002x speedup, val set 0.997x speedup, step: 79
Epoch 192/200 |loss: 13.846467| train set 1.522x speedup, test set 1.146x speedup, val set 0.997x speedup, step: 80
Epoch 193/200 |loss: 15.420163| train set 1.381x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 81
Epoch 194/200 |loss: 15.232855| train set 1.461x speedup, test set 1.850x speedup, val set 0.997x speedup, step: 82
Epoch 195/200 |loss: 14.340631| train set 1.461x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 83
Epoch 196/200 |loss: 14.230488| train set 1.531x speedup, test set 1.091x speedup, val set 0.997x speedup, step: 84
Epoch 197/200 |loss: 13.257277| train set 1.476x speedup, test set 1.946x speedup, val set 0.997x speedup, step: 85
Epoch 198/200 |loss: 13.698127| train set 1.480x speedup, test set 1.946x speedup, val set 0.997x speedup, step: 86
Epoch 199/200 |loss: 12.928756| train set 1.504x speedup, test set 1.969x speedup, val set 0.997x speedup, step: 87
Training per epoch cost 0.653 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 3.645s, pg runtime 3.645s, speedup 1.000x
20, opt runtime 0.626s, model runtime 1.404s, pg runtime 2.558s, speedup 1.822x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 183, train speedup 1.563, test speedup 1.963, val speedup 0.997
best test speedup epoch: 64, train speedup 1.342, test speedup 2.915, val speedup 0.739
best validation speedup epoch: 113, train speedup 1.344, test speedup 1.023, val speedup 1.008
last model at epoch 199, train speedup 1.504, test speedup 1.969, val speedup 0.997
execution cost 0:06:33.094765
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:02.158292, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079832| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695995| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379646| train set 1.115x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083643| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800293| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.530991| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.289434| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.016975| train set 1.173x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.761539| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.498514| train set 1.211x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.269112| train set 1.236x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.037516| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.817038| train set 1.204x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.690796| train set 1.216x speedup, test set 1.026x speedup, val set 0.932x speedup, step: 21
Epoch 21/200 |loss: 26.981678| train set 1.226x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.408173| train set 1.227x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.062866| train set 1.177x speedup, test set 1.026x speedup, val set 0.932x speedup, step: 24
Epoch 24/200 |loss: 26.155704| train set 1.196x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 25
Epoch 25/200 |loss: 25.617811| train set 1.195x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.765444| train set 1.183x speedup, test set 1.025x speedup, val set 0.932x speedup, step: 27
Epoch 27/200 |loss: 25.512684| train set 1.202x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 28
Epoch 28/200 |loss: 25.212326| train set 1.208x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 29
Epoch 29/200 |loss: 25.321856| train set 1.208x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 24.819824| train set 1.203x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.749779| train set 1.200x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.591358| train set 1.230x speedup, test set 1.017x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.239258| train set 1.224x speedup, test set 1.016x speedup, val set 0.932x speedup, step: 34
Epoch 34/200 |loss: 24.281439| train set 1.207x speedup, test set 1.784x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.241430| train set 1.229x speedup, test set 1.018x speedup, val set 0.999x speedup, step: 36
Epoch 36/200 |loss: 24.297281| train set 1.277x speedup, test set 1.784x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.990078| train set 1.231x speedup, test set 1.787x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.576546| train set 1.228x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 39
Epoch 39/200 |loss: 23.453003| train set 1.245x speedup, test set 1.860x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.386412| train set 1.231x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 22.969913| train set 1.231x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.954550| train set 1.284x speedup, test set 1.786x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.766712| train set 1.305x speedup, test set 1.035x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.469481| train set 1.277x speedup, test set 1.862x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.301601| train set 1.312x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.131706| train set 1.318x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 21.937658| train set 1.321x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 21.808918| train set 1.323x speedup, test set 1.862x speedup, val set 0.930x speedup, step: 49
Epoch 49/200 |loss: 22.433695| train set 1.311x speedup, test set 1.772x speedup, val set 0.998x speedup, step: 50
Epoch 50/200 |loss: 23.016108| train set 1.315x speedup, test set 1.090x speedup, val set 0.930x speedup, step: 51
Epoch 51/200 |loss: 23.224787| train set 1.245x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 22.016199| train set 1.278x speedup, test set 1.884x speedup, val set 0.992x speedup, step: 53
Epoch 53/200 |loss: 23.252514| train set 1.320x speedup, test set 1.053x speedup, val set 0.930x speedup, step: 54
Epoch 54/200 |loss: 21.936718| train set 1.422x speedup, test set 1.147x speedup, val set 0.701x speedup, step: 55
Epoch 55/200 |loss: 22.353613| train set 1.252x speedup, test set 1.745x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.370399| train set 1.232x speedup, test set 1.775x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.596321| train set 1.326x speedup, test set 1.937x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 21.302176| train set 1.340x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 21.250086| train set 1.327x speedup, test set 1.745x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.889351| train set 1.330x speedup, test set 1.772x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.719837| train set 1.330x speedup, test set 1.772x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.545996| train set 1.335x speedup, test set 1.948x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.338987| train set 1.335x speedup, test set 1.937x speedup, val set 0.931x speedup, step: 64
Epoch 64/200 |loss: 20.186613| train set 1.348x speedup, test set 1.868x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 19.980808| train set 1.330x speedup, test set 1.868x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 19.888659| train set 1.330x speedup, test set 1.786x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 19.509466| train set 1.344x speedup, test set 1.064x speedup, val set 0.931x speedup, step: 68
Epoch 68/200 |loss: 19.644995| train set 1.331x speedup, test set 1.772x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.236164| train set 1.330x speedup, test set 1.875x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.156040| train set 1.349x speedup, test set 1.920x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 18.920561| train set 1.345x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 18.890598| train set 1.393x speedup, test set 2.100x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 18.992472| train set 1.321x speedup, test set 1.038x speedup, val set 1.008x speedup, step: 74
Epoch 74/200 |loss: 20.766659| train set 1.383x speedup, test set 3.000x speedup, val set 0.701x speedup, step: 75
Epoch 75/200 |loss: 21.984568| train set 1.305x speedup, test set 1.029x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.613878| train set 1.317x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.829784| train set 1.378x speedup, test set 3.178x speedup, val set 0.701x speedup, step: 78
Epoch 78/200 |loss: 19.620920| train set 1.315x speedup, test set 1.899x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.819998| train set 1.329x speedup, test set 1.027x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 19.597729| train set 1.350x speedup, test set 1.017x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 18.563490| train set 1.408x speedup, test set 1.280x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 19.462004| train set 1.333x speedup, test set 1.800x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.325981| train set 1.333x speedup, test set 1.802x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.515511| train set 1.400x speedup, test set 2.046x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.913271| train set 1.400x speedup, test set 2.380x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.037384| train set 1.399x speedup, test set 1.051x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.822876| train set 1.318x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.514936| train set 1.415x speedup, test set 1.108x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 17.574898| train set 1.419x speedup, test set 2.044x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.282450| train set 1.398x speedup, test set 1.113x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.376698| train set 1.346x speedup, test set 1.885x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.675413| train set 1.415x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 18.252180| train set 1.393x speedup, test set 1.773x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.622860| train set 1.400x speedup, test set 1.994x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 16.768381| train set 1.400x speedup, test set 1.960x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 16.603653| train set 1.373x speedup, test set 1.875x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.698143| train set 1.415x speedup, test set 1.106x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.890221| train set 1.396x speedup, test set 1.884x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.945633| train set 1.401x speedup, test set 1.044x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.389189| train set 1.420x speedup, test set 2.079x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 15.966627| train set 1.372x speedup, test set 1.954x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 15.919289| train set 1.414x speedup, test set 1.100x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.092537| train set 1.414x speedup, test set 1.886x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.052980| train set 1.416x speedup, test set 1.406x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.234102| train set 1.401x speedup, test set 1.849x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.120764| train set 1.416x speedup, test set 1.901x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 15.628777| train set 1.418x speedup, test set 2.027x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.137750| train set 1.401x speedup, test set 1.880x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.150134| train set 1.415x speedup, test set 1.448x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.289440| train set 1.421x speedup, test set 1.902x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.681478| train set 1.520x speedup, test set 1.114x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 17.234375| train set 1.361x speedup, test set 1.820x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 16.276415| train set 1.483x speedup, test set 2.226x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.983858| train set 1.501x speedup, test set 1.053x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 15.931349| train set 1.413x speedup, test set 1.888x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 15.430399| train set 1.445x speedup, test set 2.015x speedup, val set 1.008x speedup, step: 1
Epoch 117/200 |loss: 15.980831| train set 1.518x speedup, test set 2.354x speedup, val set 0.997x speedup, step: 2
Epoch 118/200 |loss: 15.348896| train set 1.400x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 3
Epoch 119/200 |loss: 15.706893| train set 1.503x speedup, test set 1.949x speedup, val set 0.997x speedup, step: 4
Epoch 120/200 |loss: 15.230057| train set 1.444x speedup, test set 1.413x speedup, val set 1.008x speedup, step: 1
Epoch 121/200 |loss: 15.248433| train set 1.405x speedup, test set 1.949x speedup, val set 0.997x speedup, step: 2
Epoch 122/200 |loss: 15.336043| train set 1.421x speedup, test set 1.090x speedup, val set 0.997x speedup, step: 3
Epoch 123/200 |loss: 14.770667| train set 1.387x speedup, test set 1.935x speedup, val set 0.997x speedup, step: 4
Epoch 124/200 |loss: 14.484612| train set 1.414x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 5
Epoch 125/200 |loss: 14.136499| train set 1.421x speedup, test set 1.083x speedup, val set 0.997x speedup, step: 6
Epoch 126/200 |loss: 14.323981| train set 1.397x speedup, test set 1.932x speedup, val set 0.997x speedup, step: 7
Epoch 127/200 |loss: 14.293476| train set 1.419x speedup, test set 1.074x speedup, val set 1.008x speedup, step: 1
Epoch 128/200 |loss: 14.552604| train set 1.415x speedup, test set 1.966x speedup, val set 0.997x speedup, step: 2
Epoch 129/200 |loss: 14.539445| train set 1.501x speedup, test set 1.949x speedup, val set 0.997x speedup, step: 3
Epoch 130/200 |loss: 13.977867| train set 1.505x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 4
Epoch 131/200 |loss: 13.722805| train set 1.501x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 5
Epoch 132/200 |loss: 13.587048| train set 1.421x speedup, test set 1.087x speedup, val set 0.997x speedup, step: 6
Epoch 133/200 |loss: 13.549500| train set 1.426x speedup, test set 1.951x speedup, val set 0.997x speedup, step: 7
Epoch 134/200 |loss: 13.724768| train set 1.518x speedup, test set 1.089x speedup, val set 0.997x speedup, step: 8
Epoch 135/200 |loss: 14.256945| train set 1.448x speedup, test set 1.793x speedup, val set 0.997x speedup, step: 9
Epoch 136/200 |loss: 15.111696| train set 1.461x speedup, test set 2.239x speedup, val set 0.997x speedup, step: 10
Epoch 137/200 |loss: 14.710685| train set 1.351x speedup, test set 1.035x speedup, val set 1.008x speedup, step: 1
Epoch 138/200 |loss: 16.270645| train set 1.498x speedup, test set 1.954x speedup, val set 0.993x speedup, step: 2
Epoch 139/200 |loss: 15.926976| train set 1.538x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 3
Epoch 140/200 |loss: 16.296659| train set 1.388x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 4
Epoch 141/200 |loss: 15.613149| train set 1.393x speedup, test set 1.973x speedup, val set 0.997x speedup, step: 5
Epoch 142/200 |loss: 15.098874| train set 1.475x speedup, test set 1.987x speedup, val set 0.997x speedup, step: 6
Epoch 143/200 |loss: 14.186528| train set 1.423x speedup, test set 1.850x speedup, val set 0.997x speedup, step: 7
Epoch 144/200 |loss: 14.882057| train set 1.499x speedup, test set 1.932x speedup, val set 0.997x speedup, step: 8
Epoch 145/200 |loss: 13.467227| train set 1.508x speedup, test set 1.953x speedup, val set 0.997x speedup, step: 9
Epoch 146/200 |loss: 14.252834| train set 1.417x speedup, test set 1.793x speedup, val set 0.997x speedup, step: 10
Epoch 147/200 |loss: 13.726143| train set 1.413x speedup, test set 1.058x speedup, val set 0.997x speedup, step: 11
Epoch 148/200 |loss: 13.463769| train set 1.518x speedup, test set 1.992x speedup, val set 0.997x speedup, step: 12
Epoch 149/200 |loss: 13.588637| train set 1.415x speedup, test set 1.882x speedup, val set 0.997x speedup, step: 13
Epoch 150/200 |loss: 13.366972| train set 1.430x speedup, test set 1.883x speedup, val set 0.997x speedup, step: 14
Epoch 151/200 |loss: 13.172886| train set 1.523x speedup, test set 2.005x speedup, val set 0.997x speedup, step: 15
Epoch 152/200 |loss: 13.256935| train set 1.392x speedup, test set 1.059x speedup, val set 0.997x speedup, step: 16
Epoch 153/200 |loss: 13.208907| train set 1.538x speedup, test set 1.883x speedup, val set 0.997x speedup, step: 17
Epoch 154/200 |loss: 12.915415| train set 1.505x speedup, test set 1.951x speedup, val set 0.997x speedup, step: 18
Epoch 155/200 |loss: 12.768461| train set 1.501x speedup, test set 1.971x speedup, val set 0.997x speedup, step: 19
Epoch 156/200 |loss: 12.798148| train set 1.503x speedup, test set 1.086x speedup, val set 0.997x speedup, step: 20
Epoch 157/200 |loss: 12.620684| train set 1.499x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 21
Epoch 158/200 |loss: 12.732825| train set 1.523x speedup, test set 1.971x speedup, val set 0.997x speedup, step: 22
Epoch 159/200 |loss: 12.958746| train set 1.540x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 23
Epoch 160/200 |loss: 13.948357| train set 1.514x speedup, test set 1.956x speedup, val set 0.997x speedup, step: 24
Epoch 161/200 |loss: 13.272623| train set 1.471x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 25
Epoch 162/200 |loss: 13.338064| train set 1.501x speedup, test set 1.967x speedup, val set 0.997x speedup, step: 26
Epoch 163/200 |loss: 12.413299| train set 1.522x speedup, test set 1.966x speedup, val set 0.997x speedup, step: 27
Epoch 164/200 |loss: 13.246459| train set 1.495x speedup, test set 1.090x speedup, val set 0.997x speedup, step: 28
Epoch 165/200 |loss: 14.524780| train set 1.488x speedup, test set 1.966x speedup, val set 0.997x speedup, step: 29
Epoch 166/200 |loss: 12.422145| train set 1.495x speedup, test set 1.834x speedup, val set 1.008x speedup, step: 1
Epoch 167/200 |loss: 14.905943| train set 1.501x speedup, test set 1.090x speedup, val set 0.997x speedup, step: 2
Epoch 168/200 |loss: 15.536999| train set 1.414x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 3
Epoch 169/200 |loss: 14.137217| train set 1.536x speedup, test set 1.965x speedup, val set 0.997x speedup, step: 4
Epoch 170/200 |loss: 15.087614| train set 1.538x speedup, test set 1.961x speedup, val set 1.008x speedup, step: 1
Epoch 171/200 |loss: 14.143429| train set 1.502x speedup, test set 1.884x speedup, val set 0.997x speedup, step: 2
Epoch 172/200 |loss: 14.298279| train set 1.413x speedup, test set 1.797x speedup, val set 0.997x speedup, step: 3
Epoch 173/200 |loss: 13.662764| train set 1.505x speedup, test set 1.963x speedup, val set 1.008x speedup, step: 1
Epoch 174/200 |loss: 13.582288| train set 1.478x speedup, test set 1.995x speedup, val set 0.997x speedup, step: 2
Epoch 175/200 |loss: 13.332192| train set 1.471x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 3
Epoch 176/200 |loss: 13.285929| train set 1.470x speedup, test set 1.065x speedup, val set 0.997x speedup, step: 4
Epoch 177/200 |loss: 13.033857| train set 1.528x speedup, test set 1.969x speedup, val set 0.997x speedup, step: 5
Epoch 178/200 |loss: 12.745774| train set 1.471x speedup, test set 1.967x speedup, val set 0.997x speedup, step: 6
Epoch 179/200 |loss: 12.751216| train set 1.502x speedup, test set 1.970x speedup, val set 0.997x speedup, step: 7
Epoch 180/200 |loss: 12.629337| train set 1.519x speedup, test set 1.795x speedup, val set 0.997x speedup, step: 8
Epoch 181/200 |loss: 12.332810| train set 1.536x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 9
Epoch 182/200 |loss: 12.389286| train set 1.470x speedup, test set 1.965x speedup, val set 0.997x speedup, step: 10
Epoch 183/200 |loss: 12.234091| train set 1.488x speedup, test set 1.871x speedup, val set 0.997x speedup, step: 11
Epoch 184/200 |loss: 12.181905| train set 1.533x speedup, test set 2.008x speedup, val set 0.997x speedup, step: 12
Epoch 185/200 |loss: 12.024400| train set 1.562x speedup, test set 1.967x speedup, val set 0.997x speedup, step: 13
Epoch 186/200 |loss: 11.912425| train set 1.519x speedup, test set 1.965x speedup, val set 0.997x speedup, step: 14
Epoch 187/200 |loss: 11.866024| train set 1.519x speedup, test set 1.965x speedup, val set 0.997x speedup, step: 15
Epoch 188/200 |loss: 11.866247| train set 1.556x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 16
Epoch 189/200 |loss: 11.818970| train set 1.507x speedup, test set 1.963x speedup, val set 0.997x speedup, step: 17
Epoch 190/200 |loss: 11.609330| train set 1.501x speedup, test set 1.082x speedup, val set 0.997x speedup, step: 18
Epoch 191/200 |loss: 11.646916| train set 1.524x speedup, test set 1.968x speedup, val set 0.997x speedup, step: 19
Epoch 192/200 |loss: 11.446733| train set 1.558x speedup, test set 2.008x speedup, val set 0.997x speedup, step: 20
Epoch 193/200 |loss: 11.484708| train set 1.547x speedup, test set 1.968x speedup, val set 0.997x speedup, step: 21
Epoch 194/200 |loss: 11.370733| train set 1.558x speedup, test set 1.084x speedup, val set 0.997x speedup, step: 22
Epoch 195/200 |loss: 11.267371| train set 1.537x speedup, test set 1.965x speedup, val set 0.997x speedup, step: 23
Epoch 196/200 |loss: 11.201847| train set 1.538x speedup, test set 1.965x speedup, val set 0.997x speedup, step: 24
Epoch 197/200 |loss: 11.122367| train set 1.564x speedup, test set 1.968x speedup, val set 0.997x speedup, step: 25
Epoch 198/200 |loss: 11.071959| train set 1.524x speedup, test set 1.968x speedup, val set 0.997x speedup, step: 26
Epoch 199/200 |loss: 11.069731| train set 1.559x speedup, test set 1.965x speedup, val set 0.997x speedup, step: 27
Training per epoch cost 0.628 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 5.179s, pg runtime 10.685s, speedup 2.063x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 197, train speedup 1.564, test speedup 1.968, val speedup 0.997
best test speedup epoch: 77, train speedup 1.378, test speedup 3.178, val speedup 0.701
best validation speedup epoch: 173, train speedup 1.505, test speedup 1.963, val speedup 1.008
last model at epoch 199, train speedup 1.559, test speedup 1.965, val speedup 0.997
execution cost 0:06:20.758141
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.202445, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443678| train set 0.789x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083920| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698151| train set 1.100x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091862| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.810066| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.532558| train set 1.143x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.276108| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.015095| train set 1.153x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.780806| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.557999| train set 1.173x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.387121| train set 1.207x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.192171| train set 1.218x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.947140| train set 1.200x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.657927| train set 1.226x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.485102| train set 1.204x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.368994| train set 1.223x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.100105| train set 1.182x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.824137| train set 1.198x speedup, test set 1.051x speedup, val set 0.930x speedup, step: 25
Epoch 25/200 |loss: 25.682007| train set 1.200x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.626169| train set 1.188x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.354391| train set 1.206x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.040672| train set 1.180x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 24.842760| train set 1.155x speedup, test set 1.039x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.768892| train set 1.197x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.718847| train set 1.169x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.347530| train set 1.181x speedup, test set 1.042x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.257439| train set 1.199x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 25.053492| train set 1.219x speedup, test set 1.050x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 25.448372| train set 1.185x speedup, test set 1.008x speedup, val set 0.997x speedup, step: 36
Epoch 36/200 |loss: 24.037523| train set 1.189x speedup, test set 1.019x speedup, val set 0.999x speedup, step: 37
Epoch 37/200 |loss: 25.073494| train set 1.231x speedup, test set 1.017x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.858841| train set 1.246x speedup, test set 1.050x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 24.368782| train set 1.210x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.327097| train set 1.229x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.871115| train set 1.229x speedup, test set 1.785x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.189816| train set 1.275x speedup, test set 1.026x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 23.295427| train set 1.231x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.959148| train set 1.233x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 23.020496| train set 1.284x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.645910| train set 1.284x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.470928| train set 1.306x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.317087| train set 1.305x speedup, test set 1.799x speedup, val set 0.930x speedup, step: 49
Epoch 49/200 |loss: 22.161316| train set 1.325x speedup, test set 1.864x speedup, val set 0.930x speedup, step: 50
Epoch 50/200 |loss: 22.032665| train set 1.235x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.931330| train set 1.306x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.666845| train set 1.326x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.670137| train set 1.330x speedup, test set 1.832x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.334991| train set 1.328x speedup, test set 1.745x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.246496| train set 1.318x speedup, test set 1.850x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.147783| train set 1.237x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 21.080711| train set 1.374x speedup, test set 2.101x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.908337| train set 1.316x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.514654| train set 1.331x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.433006| train set 1.345x speedup, test set 1.020x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.554230| train set 1.331x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.478971| train set 1.329x speedup, test set 1.044x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.985685| train set 1.331x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.579355| train set 1.345x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 19.587749| train set 1.353x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.043156| train set 1.296x speedup, test set 1.804x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 20.305811| train set 1.339x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 20.072241| train set 1.345x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 20.077351| train set 1.407x speedup, test set 2.522x speedup, val set 0.738x speedup, step: 70
Epoch 70/200 |loss: 19.797676| train set 1.258x speedup, test set 1.031x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 21.501204| train set 1.406x speedup, test set 2.303x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.554502| train set 1.388x speedup, test set 2.221x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 20.204659| train set 1.345x speedup, test set 1.074x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.530573| train set 1.320x speedup, test set 1.804x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.483826| train set 1.358x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.338240| train set 1.393x speedup, test set 2.284x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.581280| train set 1.380x speedup, test set 1.878x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.445515| train set 1.385x speedup, test set 1.878x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 19.151859| train set 1.350x speedup, test set 1.068x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.417351| train set 1.399x speedup, test set 2.270x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.366285| train set 1.367x speedup, test set 2.274x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.467121| train set 1.334x speedup, test set 1.071x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.289240| train set 1.369x speedup, test set 1.070x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 17.814957| train set 1.396x speedup, test set 2.421x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.063536| train set 1.394x speedup, test set 1.884x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.690884| train set 1.342x speedup, test set 2.023x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.607534| train set 1.512x speedup, test set 2.420x speedup, val set 0.738x speedup, step: 88
Epoch 88/200 |loss: 17.656174| train set 1.370x speedup, test set 1.800x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.045017| train set 1.394x speedup, test set 2.409x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.720604| train set 1.396x speedup, test set 1.794x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 18.373974| train set 1.471x speedup, test set 1.250x speedup, val set 0.738x speedup, step: 92
Epoch 92/200 |loss: 20.099802| train set 1.338x speedup, test set 1.803x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.974346| train set 1.330x speedup, test set 1.887x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 19.824989| train set 1.494x speedup, test set 1.250x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 19.487738| train set 1.407x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 19.034830| train set 1.390x speedup, test set 1.888x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 18.454906| train set 1.394x speedup, test set 2.421x speedup, val set 0.994x speedup, step: 98
Epoch 98/200 |loss: 17.838295| train set 1.447x speedup, test set 1.147x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 18.231926| train set 1.374x speedup, test set 1.152x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 17.406233| train set 1.396x speedup, test set 2.264x speedup, val set 0.994x speedup, step: 101
Epoch 101/200 |loss: 17.611408| train set 1.412x speedup, test set 2.180x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 17.024876| train set 1.430x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 17.147589| train set 1.406x speedup, test set 1.176x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.812668| train set 1.409x speedup, test set 2.270x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.753925| train set 1.495x speedup, test set 2.259x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.467777| train set 1.478x speedup, test set 1.146x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.336206| train set 1.401x speedup, test set 2.108x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.135189| train set 1.431x speedup, test set 2.144x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 16.092987| train set 1.389x speedup, test set 2.259x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.997627| train set 1.383x speedup, test set 1.938x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.821806| train set 1.387x speedup, test set 2.164x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.648412| train set 1.500x speedup, test set 2.252x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.620022| train set 1.433x speedup, test set 1.825x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.494187| train set 1.484x speedup, test set 2.264x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 15.584291| train set 1.500x speedup, test set 2.003x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 15.226518| train set 1.502x speedup, test set 1.167x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 15.088109| train set 1.416x speedup, test set 2.225x speedup, val set 0.994x speedup, step: 2
Epoch 118/200 |loss: 15.131240| train set 1.502x speedup, test set 2.259x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 14.722057| train set 1.541x speedup, test set 2.122x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 14.716871| train set 1.502x speedup, test set 2.264x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 14.762232| train set 1.432x speedup, test set 1.793x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 14.744442| train set 1.502x speedup, test set 2.264x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 15.371564| train set 1.368x speedup, test set 1.796x speedup, val set 1.008x speedup, step: 1
Epoch 124/200 |loss: 17.954836| train set 1.466x speedup, test set 1.215x speedup, val set 0.997x speedup, step: 2
Epoch 125/200 |loss: 20.281574| train set 1.428x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 3
Epoch 126/200 |loss: 15.837174| train set 1.376x speedup, test set 2.118x speedup, val set 0.994x speedup, step: 4
Epoch 127/200 |loss: 20.814898| train set 1.457x speedup, test set 1.166x speedup, val set 0.738x speedup, step: 5
Epoch 128/200 |loss: 17.913874| train set 1.355x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 6
Epoch 129/200 |loss: 18.033073| train set 1.409x speedup, test set 1.801x speedup, val set 0.989x speedup, step: 7
Epoch 130/200 |loss: 17.392736| train set 1.417x speedup, test set 2.248x speedup, val set 0.992x speedup, step: 8
Epoch 131/200 |loss: 17.177286| train set 1.554x speedup, test set 1.210x speedup, val set 0.997x speedup, step: 9
Epoch 132/200 |loss: 16.602106| train set 1.431x speedup, test set 1.070x speedup, val set 0.997x speedup, step: 10
Epoch 133/200 |loss: 16.337473| train set 1.389x speedup, test set 1.884x speedup, val set 0.994x speedup, step: 11
Epoch 134/200 |loss: 16.425840| train set 1.469x speedup, test set 2.226x speedup, val set 0.994x speedup, step: 12
Epoch 135/200 |loss: 15.856445| train set 1.478x speedup, test set 2.230x speedup, val set 0.997x speedup, step: 13
Epoch 136/200 |loss: 15.752543| train set 1.416x speedup, test set 1.794x speedup, val set 0.997x speedup, step: 14
Epoch 137/200 |loss: 15.717118| train set 1.416x speedup, test set 1.797x speedup, val set 0.997x speedup, step: 15
Epoch 138/200 |loss: 15.217142| train set 1.540x speedup, test set 2.265x speedup, val set 0.997x speedup, step: 16
Epoch 139/200 |loss: 15.340796| train set 1.516x speedup, test set 2.265x speedup, val set 0.997x speedup, step: 17
Epoch 140/200 |loss: 14.830852| train set 1.391x speedup, test set 1.987x speedup, val set 0.997x speedup, step: 18
Epoch 141/200 |loss: 14.831846| train set 1.445x speedup, test set 1.097x speedup, val set 0.997x speedup, step: 19
Epoch 142/200 |loss: 14.588391| train set 1.491x speedup, test set 2.027x speedup, val set 0.997x speedup, step: 20
Epoch 143/200 |loss: 14.506150| train set 1.508x speedup, test set 1.983x speedup, val set 0.997x speedup, step: 21
Epoch 144/200 |loss: 14.288257| train set 1.519x speedup, test set 1.987x speedup, val set 0.997x speedup, step: 22
Epoch 145/200 |loss: 14.254524| train set 1.502x speedup, test set 1.987x speedup, val set 0.997x speedup, step: 23
Epoch 146/200 |loss: 14.013790| train set 1.502x speedup, test set 1.987x speedup, val set 0.997x speedup, step: 24
Epoch 147/200 |loss: 13.995232| train set 1.502x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 25
Epoch 148/200 |loss: 13.842726| train set 1.538x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 26
Epoch 149/200 |loss: 13.673581| train set 1.495x speedup, test set 2.027x speedup, val set 0.997x speedup, step: 27
Epoch 150/200 |loss: 13.607088| train set 1.506x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 28
Epoch 151/200 |loss: 13.509794| train set 1.487x speedup, test set 1.987x speedup, val set 0.997x speedup, step: 29
Epoch 152/200 |loss: 13.480197| train set 1.504x speedup, test set 1.869x speedup, val set 1.008x speedup, step: 1
Epoch 153/200 |loss: 13.611594| train set 1.518x speedup, test set 2.262x speedup, val set 0.994x speedup, step: 2
Epoch 154/200 |loss: 14.022440| train set 1.427x speedup, test set 1.036x speedup, val set 1.008x speedup, step: 1
Epoch 155/200 |loss: 15.193009| train set 1.520x speedup, test set 2.408x speedup, val set 0.994x speedup, step: 2
Epoch 156/200 |loss: 15.272906| train set 1.499x speedup, test set 1.059x speedup, val set 0.997x speedup, step: 3
Epoch 157/200 |loss: 13.720533| train set 1.515x speedup, test set 1.059x speedup, val set 0.997x speedup, step: 4
Epoch 158/200 |loss: 13.822529| train set 1.501x speedup, test set 2.255x speedup, val set 0.994x speedup, step: 5
Epoch 159/200 |loss: 14.533853| train set 1.500x speedup, test set 1.052x speedup, val set 0.997x speedup, step: 6
Epoch 160/200 |loss: 13.335533| train set 1.415x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 7
Epoch 161/200 |loss: 13.378584| train set 1.538x speedup, test set 2.008x speedup, val set 0.994x speedup, step: 8
Epoch 162/200 |loss: 13.527761| train set 1.537x speedup, test set 2.113x speedup, val set 0.997x speedup, step: 9
Epoch 163/200 |loss: 13.005084| train set 1.531x speedup, test set 1.846x speedup, val set 0.997x speedup, step: 10
Epoch 164/200 |loss: 13.171969| train set 1.519x speedup, test set 2.008x speedup, val set 0.994x speedup, step: 11
Epoch 165/200 |loss: 13.223361| train set 1.507x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 12
Epoch 166/200 |loss: 13.081066| train set 1.541x speedup, test set 1.052x speedup, val set 0.997x speedup, step: 13
Epoch 167/200 |loss: 13.722060| train set 1.513x speedup, test set 1.864x speedup, val set 0.994x speedup, step: 14
Epoch 168/200 |loss: 13.667005| train set 1.546x speedup, test set 2.102x speedup, val set 0.997x speedup, step: 15
Epoch 169/200 |loss: 13.452081| train set 1.445x speedup, test set 1.790x speedup, val set 0.997x speedup, step: 16
Epoch 170/200 |loss: 13.505078| train set 1.538x speedup, test set 1.886x speedup, val set 0.996x speedup, step: 17
Epoch 171/200 |loss: 12.914886| train set 1.546x speedup, test set 2.102x speedup, val set 0.997x speedup, step: 18
Epoch 172/200 |loss: 12.537098| train set 1.544x speedup, test set 1.846x speedup, val set 0.997x speedup, step: 19
Epoch 173/200 |loss: 13.026006| train set 1.527x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 20
Epoch 174/200 |loss: 13.015022| train set 1.526x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 21
Epoch 175/200 |loss: 12.531320| train set 1.539x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 22
Epoch 176/200 |loss: 12.472354| train set 1.509x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 23
Epoch 177/200 |loss: 12.385112| train set 1.534x speedup, test set 1.861x speedup, val set 0.997x speedup, step: 24
Epoch 178/200 |loss: 12.287607| train set 1.541x speedup, test set 1.900x speedup, val set 0.997x speedup, step: 25
Epoch 179/200 |loss: 12.672113| train set 1.525x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 26
Epoch 180/200 |loss: 12.357186| train set 1.521x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 27
Epoch 181/200 |loss: 11.991948| train set 1.527x speedup, test set 1.861x speedup, val set 0.997x speedup, step: 28
Epoch 182/200 |loss: 11.964054| train set 1.513x speedup, test set 1.900x speedup, val set 0.994x speedup, step: 29
Epoch 183/200 |loss: 12.048203| train set 1.541x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 30
Epoch 184/200 |loss: 12.104716| train set 1.560x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 31
Epoch 185/200 |loss: 12.082097| train set 1.527x speedup, test set 1.900x speedup, val set 0.997x speedup, step: 32
Epoch 186/200 |loss: 12.546123| train set 1.557x speedup, test set 1.846x speedup, val set 1.008x speedup, step: 1
Epoch 187/200 |loss: 12.874371| train set 1.539x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 2
Epoch 188/200 |loss: 13.027974| train set 1.472x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 3
Epoch 189/200 |loss: 12.240075| train set 1.564x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 4
Epoch 190/200 |loss: 11.774793| train set 1.527x speedup, test set 1.900x speedup, val set 0.997x speedup, step: 5
Epoch 191/200 |loss: 12.183979| train set 1.563x speedup, test set 1.480x speedup, val set 0.997x speedup, step: 6
Epoch 192/200 |loss: 12.447865| train set 1.521x speedup, test set 1.900x speedup, val set 0.997x speedup, step: 7
Epoch 193/200 |loss: 12.082979| train set 1.541x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 8
Epoch 194/200 |loss: 11.623083| train set 1.558x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 9
Epoch 195/200 |loss: 11.760247| train set 1.521x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 10
Epoch 196/200 |loss: 12.184288| train set 1.566x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 11
Epoch 197/200 |loss: 11.653179| train set 1.566x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 12
Epoch 198/200 |loss: 11.375340| train set 1.489x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 13
Epoch 199/200 |loss: 11.479624| train set 1.558x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 14
Training per epoch cost 0.606 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 9.387s, pg runtime 8.283s, speedup 0.882x
07, opt runtime 2.046s, model runtime 6.220s, pg runtime 5.879s, speedup 0.945x
08, opt runtime 1.737s, model runtime 6.267s, pg runtime 5.994s, speedup 0.957x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 196, train speedup 1.566, test speedup 1.864, val speedup 0.997
best test speedup epoch: 69, train speedup 1.407, test speedup 2.522, val speedup 0.738
best validation speedup epoch: 186, train speedup 1.557, test speedup 1.846, val speedup 1.008
last model at epoch 199, train speedup 1.558, test speedup 1.864, val speedup 0.997
execution cost 0:06:09.637944
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:02.021252, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383249| train set 1.117x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091825| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.810331| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.534100| train set 1.160x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.280073| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.016331| train set 1.154x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.779743| train set 1.192x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.545912| train set 1.173x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.366886| train set 1.207x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.182037| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.953842| train set 1.200x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.652033| train set 1.204x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.449507| train set 1.205x speedup, test set 1.026x speedup, val set 0.932x speedup, step: 22
Epoch 22/200 |loss: 26.319284| train set 1.224x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.110031| train set 1.182x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.844398| train set 1.203x speedup, test set 1.025x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.621471| train set 1.201x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.562157| train set 1.183x speedup, test set 1.039x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.484480| train set 1.224x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.198532| train set 1.206x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 24.869364| train set 1.162x speedup, test set 1.039x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.946085| train set 1.162x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.817867| train set 1.197x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.303148| train set 1.226x speedup, test set 1.058x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.519609| train set 1.199x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 34
Epoch 34/200 |loss: 24.294939| train set 1.206x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 24.238035| train set 1.274x speedup, test set 1.763x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.438984| train set 1.203x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.650553| train set 1.228x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.749519| train set 1.228x speedup, test set 1.759x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.338741| train set 1.249x speedup, test set 1.048x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.559834| train set 1.229x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.478716| train set 1.229x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.897329| train set 1.238x speedup, test set 1.762x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 23.029270| train set 1.229x speedup, test set 1.757x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.553890| train set 1.302x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.869106| train set 1.306x speedup, test set 1.757x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.265261| train set 1.243x speedup, test set 1.830x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.129742| train set 1.229x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.006531| train set 1.302x speedup, test set 1.757x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 21.593262| train set 1.254x speedup, test set 2.028x speedup, val set 0.930x speedup, step: 50
Epoch 50/200 |loss: 21.805305| train set 1.229x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.635517| train set 1.321x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 22.012487| train set 1.315x speedup, test set 1.795x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 22.104849| train set 1.323x speedup, test set 1.440x speedup, val set 0.930x speedup, step: 54
Epoch 54/200 |loss: 21.637659| train set 1.310x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.153744| train set 1.316x speedup, test set 1.855x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.156479| train set 1.347x speedup, test set 2.668x speedup, val set 0.701x speedup, step: 57
Epoch 57/200 |loss: 21.122467| train set 1.236x speedup, test set 1.032x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 21.313301| train set 1.313x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.305285| train set 1.460x speedup, test set 2.516x speedup, val set 0.738x speedup, step: 60
Epoch 60/200 |loss: 20.807714| train set 1.310x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.609499| train set 1.313x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 19.932018| train set 1.479x speedup, test set 2.208x speedup, val set 0.701x speedup, step: 63
Epoch 63/200 |loss: 20.433445| train set 1.327x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 19.854223| train set 1.314x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 19.917580| train set 1.388x speedup, test set 1.959x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 19.681128| train set 1.377x speedup, test set 1.954x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 19.317507| train set 1.312x speedup, test set 1.799x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.835110| train set 1.332x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.172670| train set 1.453x speedup, test set 2.333x speedup, val set 0.739x speedup, step: 70
Epoch 70/200 |loss: 19.114075| train set 1.341x speedup, test set 1.046x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.134003| train set 1.339x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.422041| train set 1.487x speedup, test set 1.245x speedup, val set 0.738x speedup, step: 73
Epoch 73/200 |loss: 21.631607| train set 1.322x speedup, test set 1.795x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.502150| train set 1.361x speedup, test set 1.855x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 18.772688| train set 1.470x speedup, test set 2.516x speedup, val set 0.738x speedup, step: 76
Epoch 76/200 |loss: 19.206818| train set 1.342x speedup, test set 1.795x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.451506| train set 1.342x speedup, test set 1.795x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.457815| train set 1.488x speedup, test set 2.356x speedup, val set 0.738x speedup, step: 79
Epoch 79/200 |loss: 18.319815| train set 1.394x speedup, test set 1.854x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 17.804552| train set 1.332x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 17.968819| train set 1.400x speedup, test set 2.201x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 17.660200| train set 1.391x speedup, test set 1.939x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 17.288811| train set 1.364x speedup, test set 1.871x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 17.467388| train set 1.390x speedup, test set 1.057x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.213985| train set 1.396x speedup, test set 2.238x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.252579| train set 1.346x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.263836| train set 1.388x speedup, test set 1.864x speedup, val set 0.996x speedup, step: 88
Epoch 88/200 |loss: 19.740419| train set 1.454x speedup, test set 1.189x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 21.922615| train set 1.341x speedup, test set 1.039x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 18.402552| train set 1.324x speedup, test set 1.861x speedup, val set 0.992x speedup, step: 91
Epoch 91/200 |loss: 22.759550| train set 1.511x speedup, test set 2.745x speedup, val set 0.738x speedup, step: 92
Epoch 92/200 |loss: 18.258101| train set 1.372x speedup, test set 1.029x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 20.298761| train set 1.367x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.613129| train set 1.367x speedup, test set 2.171x speedup, val set 0.989x speedup, step: 95
Epoch 95/200 |loss: 19.447626| train set 1.471x speedup, test set 2.226x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.618601| train set 1.398x speedup, test set 1.049x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 18.536983| train set 1.405x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 17.433977| train set 1.403x speedup, test set 1.953x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.711042| train set 1.480x speedup, test set 2.173x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 17.292192| train set 1.413x speedup, test set 1.831x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.246679| train set 1.396x speedup, test set 1.851x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 17.009541| train set 1.414x speedup, test set 1.883x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.612879| train set 1.413x speedup, test set 1.971x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.706678| train set 1.431x speedup, test set 1.828x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.453808| train set 1.411x speedup, test set 1.827x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.304615| train set 1.406x speedup, test set 1.836x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.146902| train set 1.502x speedup, test set 1.836x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.987411| train set 1.495x speedup, test set 1.051x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.898875| train set 1.400x speedup, test set 1.838x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.662295| train set 1.490x speedup, test set 2.189x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.507356| train set 1.539x speedup, test set 2.039x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.468770| train set 1.501x speedup, test set 2.052x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.176270| train set 1.411x speedup, test set 1.839x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.218991| train set 1.417x speedup, test set 1.049x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 14.959751| train set 1.500x speedup, test set 2.142x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 14.920866| train set 1.410x speedup, test set 2.084x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 14.782861| train set 1.415x speedup, test set 2.087x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 14.792960| train set 1.504x speedup, test set 2.087x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 15.152358| train set 1.502x speedup, test set 1.192x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 16.104904| train set 1.385x speedup, test set 1.872x speedup, val set 0.996x speedup, step: 2
Epoch 121/200 |loss: 17.765392| train set 1.502x speedup, test set 1.132x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 15.492521| train set 1.536x speedup, test set 1.177x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 16.482279| train set 1.385x speedup, test set 1.864x speedup, val set 0.996x speedup, step: 2
Epoch 124/200 |loss: 17.684132| train set 1.425x speedup, test set 1.058x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 16.328253| train set 1.404x speedup, test set 3.081x speedup, val set 0.738x speedup, step: 2
Epoch 126/200 |loss: 16.959316| train set 1.426x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 16.531649| train set 1.321x speedup, test set 1.029x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 18.054039| train set 1.517x speedup, test set 2.024x speedup, val set 0.997x speedup, step: 1
Epoch 129/200 |loss: 15.129850| train set 1.482x speedup, test set 2.184x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 17.407864| train set 1.502x speedup, test set 2.225x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 15.917827| train set 1.375x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 16.134129| train set 1.455x speedup, test set 1.116x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 14.906250| train set 1.377x speedup, test set 2.468x speedup, val set 0.737x speedup, step: 2
Epoch 134/200 |loss: 16.021643| train set 1.453x speedup, test set 1.049x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 14.644476| train set 1.373x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 15.296586| train set 1.501x speedup, test set 1.860x speedup, val set 0.994x speedup, step: 2
Epoch 137/200 |loss: 14.443697| train set 1.482x speedup, test set 2.269x speedup, val set 0.997x speedup, step: 1
Epoch 138/200 |loss: 14.781641| train set 1.512x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 14.209652| train set 1.394x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 1
Epoch 140/200 |loss: 14.410285| train set 1.491x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 1
Epoch 141/200 |loss: 13.929019| train set 1.483x speedup, test set 2.199x speedup, val set 0.997x speedup, step: 1
Epoch 142/200 |loss: 14.139046| train set 1.483x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 1
Epoch 143/200 |loss: 13.699983| train set 1.389x speedup, test set 1.055x speedup, val set 0.997x speedup, step: 1
Epoch 144/200 |loss: 13.785833| train set 1.531x speedup, test set 2.078x speedup, val set 0.997x speedup, step: 1
Epoch 145/200 |loss: 13.554515| train set 1.535x speedup, test set 2.068x speedup, val set 0.997x speedup, step: 1
Epoch 146/200 |loss: 13.528340| train set 1.508x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 1
Epoch 147/200 |loss: 13.308444| train set 1.502x speedup, test set 1.878x speedup, val set 0.997x speedup, step: 1
Epoch 148/200 |loss: 13.335990| train set 1.544x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 1
Epoch 149/200 |loss: 13.189746| train set 1.501x speedup, test set 2.082x speedup, val set 0.997x speedup, step: 1
Epoch 150/200 |loss: 13.085384| train set 1.494x speedup, test set 1.876x speedup, val set 0.997x speedup, step: 1
Epoch 151/200 |loss: 13.033322| train set 1.505x speedup, test set 1.863x speedup, val set 0.994x speedup, step: 2
Epoch 152/200 |loss: 12.884398| train set 1.542x speedup, test set 2.078x speedup, val set 0.997x speedup, step: 1
Epoch 153/200 |loss: 12.872977| train set 1.501x speedup, test set 1.051x speedup, val set 0.997x speedup, step: 1
Epoch 154/200 |loss: 12.792407| train set 1.538x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 1
Epoch 155/200 |loss: 12.741776| train set 1.523x speedup, test set 2.078x speedup, val set 0.997x speedup, step: 1
Epoch 156/200 |loss: 12.949365| train set 1.540x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 1
Epoch 157/200 |loss: 13.469855| train set 1.519x speedup, test set 1.195x speedup, val set 0.997x speedup, step: 1
Epoch 158/200 |loss: 15.511182| train set 1.436x speedup, test set 1.053x speedup, val set 1.008x speedup, step: 1
Epoch 159/200 |loss: 15.557036| train set 1.510x speedup, test set 2.078x speedup, val set 0.994x speedup, step: 2
Epoch 160/200 |loss: 13.488037| train set 1.518x speedup, test set 1.157x speedup, val set 0.997x speedup, step: 3
Epoch 161/200 |loss: 14.387829| train set 1.450x speedup, test set 1.850x speedup, val set 0.997x speedup, step: 4
Epoch 162/200 |loss: 14.676044| train set 1.518x speedup, test set 2.215x speedup, val set 0.994x speedup, step: 5
Epoch 163/200 |loss: 13.521446| train set 1.518x speedup, test set 1.152x speedup, val set 0.997x speedup, step: 6
Epoch 164/200 |loss: 14.346642| train set 1.536x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 7
Epoch 165/200 |loss: 14.877812| train set 1.501x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 8
Epoch 166/200 |loss: 13.804425| train set 1.498x speedup, test set 2.078x speedup, val set 0.997x speedup, step: 9
Epoch 167/200 |loss: 13.925000| train set 1.482x speedup, test set 2.078x speedup, val set 0.997x speedup, step: 10
Epoch 168/200 |loss: 13.567480| train set 1.510x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 11
Epoch 169/200 |loss: 13.604165| train set 1.492x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 12
Epoch 170/200 |loss: 12.802320| train set 1.548x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 13
Epoch 171/200 |loss: 13.430950| train set 1.539x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 14
Epoch 172/200 |loss: 12.557556| train set 1.500x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 15
Epoch 173/200 |loss: 13.153719| train set 1.549x speedup, test set 1.865x speedup, val set 0.997x speedup, step: 16
Epoch 174/200 |loss: 12.461121| train set 1.551x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 17
Epoch 175/200 |loss: 12.707378| train set 1.501x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 18
Epoch 176/200 |loss: 12.258430| train set 1.532x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 19
Epoch 177/200 |loss: 12.553709| train set 1.519x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 20
Epoch 178/200 |loss: 12.221576| train set 1.549x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 21
Epoch 179/200 |loss: 12.118628| train set 1.523x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 22
Epoch 180/200 |loss: 12.075217| train set 1.470x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 23
Epoch 181/200 |loss: 12.022324| train set 1.528x speedup, test set 1.850x speedup, val set 0.997x speedup, step: 24
Epoch 182/200 |loss: 12.012602| train set 1.519x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 25
Epoch 183/200 |loss: 11.825051| train set 1.539x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 26
Epoch 184/200 |loss: 11.779835| train set 1.532x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 27
Epoch 185/200 |loss: 11.746038| train set 1.558x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 28
Epoch 186/200 |loss: 11.980906| train set 1.487x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 29
Epoch 187/200 |loss: 12.074799| train set 1.537x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 30
Epoch 188/200 |loss: 12.558382| train set 1.476x speedup, test set 1.856x speedup, val set 0.994x speedup, step: 31
Epoch 189/200 |loss: 12.503413| train set 1.536x speedup, test set 1.054x speedup, val set 1.008x speedup, step: 1
Epoch 190/200 |loss: 12.644298| train set 1.519x speedup, test set 1.894x speedup, val set 0.997x speedup, step: 2
Epoch 191/200 |loss: 12.062968| train set 1.540x speedup, test set 1.853x speedup, val set 0.997x speedup, step: 3
Epoch 192/200 |loss: 11.617134| train set 1.538x speedup, test set 1.853x speedup, val set 0.997x speedup, step: 4
Epoch 193/200 |loss: 12.022143| train set 1.507x speedup, test set 1.869x speedup, val set 0.994x speedup, step: 5
Epoch 194/200 |loss: 12.259593| train set 1.539x speedup, test set 1.055x speedup, val set 0.997x speedup, step: 6
Epoch 195/200 |loss: 12.063304| train set 1.493x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 7
Epoch 196/200 |loss: 11.286428| train set 1.492x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 8
Epoch 197/200 |loss: 11.519767| train set 1.538x speedup, test set 1.055x speedup, val set 0.997x speedup, step: 9
Epoch 198/200 |loss: 11.972831| train set 1.524x speedup, test set 1.967x speedup, val set 0.997x speedup, step: 10
Epoch 199/200 |loss: 11.774092| train set 1.540x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 11
Training per epoch cost 0.732 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 9.387s, pg runtime 8.283s, speedup 0.882x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 185, train speedup 1.558, test speedup 1.054, val speedup 0.997
best test speedup epoch: 125, train speedup 1.404, test speedup 3.081, val speedup 0.738
best validation speedup epoch: 189, train speedup 1.536, test speedup 1.054, val speedup 1.008
last model at epoch 199, train speedup 1.540, test speedup 1.054, val speedup 0.997
execution cost 0:07:21.295827
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.990594, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159269| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787601| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079838| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695999| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379663| train set 1.115x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083614| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800463| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533003| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.290527| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.020372| train set 1.173x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.763098| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.505934| train set 1.211x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.274527| train set 1.236x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.044781| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.887913| train set 1.219x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.991280| train set 1.216x speedup, test set 1.028x speedup, val set 0.932x speedup, step: 21
Epoch 21/200 |loss: 26.908930| train set 1.207x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.254045| train set 1.224x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.586653| train set 1.182x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.893614| train set 1.176x speedup, test set 1.027x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 26.069176| train set 1.227x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.543005| train set 1.215x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.648199| train set 1.207x speedup, test set 1.025x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.257156| train set 1.203x speedup, test set 1.017x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.206457| train set 1.227x speedup, test set 1.017x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.018255| train set 1.228x speedup, test set 1.017x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.738874| train set 1.202x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.706820| train set 1.229x speedup, test set 1.017x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.314463| train set 1.230x speedup, test set 1.017x speedup, val set 0.999x speedup, step: 34
Epoch 34/200 |loss: 24.382896| train set 1.225x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.022987| train set 1.224x speedup, test set 1.035x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.868999| train set 1.232x speedup, test set 1.018x speedup, val set 0.999x speedup, step: 37
Epoch 37/200 |loss: 23.805672| train set 1.226x speedup, test set 1.776x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.449427| train set 1.298x speedup, test set 1.810x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.373440| train set 1.240x speedup, test set 1.775x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.624516| train set 1.173x speedup, test set 1.030x speedup, val set 0.999x speedup, step: 41
Epoch 41/200 |loss: 25.047468| train set 1.312x speedup, test set 1.795x speedup, val set 0.931x speedup, step: 42
Epoch 42/200 |loss: 23.288866| train set 1.301x speedup, test set 1.776x speedup, val set 0.931x speedup, step: 43
Epoch 43/200 |loss: 23.914289| train set 1.232x speedup, test set 1.018x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 23.370617| train set 1.232x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 23.114702| train set 1.294x speedup, test set 1.852x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.985834| train set 1.314x speedup, test set 1.778x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.621954| train set 1.233x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.684664| train set 1.305x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 49
Epoch 49/200 |loss: 22.175161| train set 1.301x speedup, test set 1.778x speedup, val set 0.931x speedup, step: 50
Epoch 50/200 |loss: 22.263187| train set 1.308x speedup, test set 1.778x speedup, val set 0.931x speedup, step: 51
Epoch 51/200 |loss: 21.862061| train set 1.305x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 52
Epoch 52/200 |loss: 21.820572| train set 1.306x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 21.536722| train set 1.324x speedup, test set 1.778x speedup, val set 0.931x speedup, step: 54
Epoch 54/200 |loss: 21.447252| train set 1.307x speedup, test set 1.778x speedup, val set 0.931x speedup, step: 55
Epoch 55/200 |loss: 21.265152| train set 1.312x speedup, test set 1.778x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 21.009674| train set 1.378x speedup, test set 1.942x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.043711| train set 1.330x speedup, test set 1.776x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 20.722712| train set 1.309x speedup, test set 1.059x speedup, val set 0.701x speedup, step: 59
Epoch 59/200 |loss: 21.227390| train set 1.236x speedup, test set 1.775x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 21.928343| train set 1.367x speedup, test set 2.522x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 22.358200| train set 1.326x speedup, test set 1.775x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.679195| train set 1.327x speedup, test set 1.775x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 21.502522| train set 1.388x speedup, test set 2.679x speedup, val set 0.701x speedup, step: 64
Epoch 64/200 |loss: 21.019741| train set 1.315x speedup, test set 1.029x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.751221| train set 1.312x speedup, test set 1.774x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 20.422113| train set 1.397x speedup, test set 2.184x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.137913| train set 1.348x speedup, test set 1.918x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 20.099421| train set 1.332x speedup, test set 1.774x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.733383| train set 1.383x speedup, test set 1.759x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.981510| train set 1.348x speedup, test set 1.764x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 19.240477| train set 1.347x speedup, test set 1.037x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.521997| train set 1.400x speedup, test set 1.979x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 19.141296| train set 1.398x speedup, test set 1.766x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 18.984015| train set 1.331x speedup, test set 1.762x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 18.985243| train set 1.398x speedup, test set 1.041x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 18.574446| train set 1.398x speedup, test set 1.843x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.472063| train set 1.313x speedup, test set 1.812x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 18.477783| train set 1.373x speedup, test set 2.141x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 18.169481| train set 1.348x speedup, test set 1.774x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.150396| train set 1.349x speedup, test set 1.058x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 18.565496| train set 1.367x speedup, test set 1.858x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 18.929262| train set 1.393x speedup, test set 1.110x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 20.136774| train set 1.350x speedup, test set 1.774x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 18.977774| train set 1.341x speedup, test set 1.779x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 19.495201| train set 1.426x speedup, test set 3.480x speedup, val set 0.739x speedup, step: 86
Epoch 86/200 |loss: 20.782230| train set 1.314x speedup, test set 1.042x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 19.795942| train set 1.313x speedup, test set 1.795x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 20.022989| train set 1.415x speedup, test set 2.098x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 18.359991| train set 1.414x speedup, test set 2.560x speedup, val set 0.998x speedup, step: 90
Epoch 90/200 |loss: 19.104849| train set 1.394x speedup, test set 1.042x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 18.162430| train set 1.390x speedup, test set 1.828x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 18.768892| train set 1.410x speedup, test set 1.031x speedup, val set 0.998x speedup, step: 93
Epoch 93/200 |loss: 17.902170| train set 1.472x speedup, test set 2.571x speedup, val set 0.739x speedup, step: 94
Epoch 94/200 |loss: 18.540297| train set 1.347x speedup, test set 1.022x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 17.431679| train set 1.346x speedup, test set 1.774x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 17.938040| train set 1.350x speedup, test set 1.862x speedup, val set 0.998x speedup, step: 97
Epoch 97/200 |loss: 17.107128| train set 1.385x speedup, test set 1.097x speedup, val set 1.008x speedup, step: 98
Epoch 98/200 |loss: 17.579899| train set 1.369x speedup, test set 1.849x speedup, val set 0.998x speedup, step: 99
Epoch 99/200 |loss: 16.978613| train set 1.396x speedup, test set 1.023x speedup, val set 0.998x speedup, step: 100
Epoch 100/200 |loss: 16.952198| train set 1.400x speedup, test set 1.046x speedup, val set 0.998x speedup, step: 1
Epoch 101/200 |loss: 16.670973| train set 1.461x speedup, test set 2.349x speedup, val set 0.739x speedup, step: 2
Epoch 102/200 |loss: 16.578802| train set 1.431x speedup, test set 1.757x speedup, val set 0.998x speedup, step: 1
Epoch 103/200 |loss: 16.850574| train set 1.415x speedup, test set 2.109x speedup, val set 0.998x speedup, step: 1
Epoch 104/200 |loss: 16.491144| train set 1.433x speedup, test set 1.052x speedup, val set 0.998x speedup, step: 1
Epoch 105/200 |loss: 16.447420| train set 1.398x speedup, test set 2.065x speedup, val set 0.998x speedup, step: 1
Epoch 106/200 |loss: 16.121040| train set 1.415x speedup, test set 1.871x speedup, val set 0.998x speedup, step: 1
Epoch 107/200 |loss: 15.857056| train set 1.415x speedup, test set 1.954x speedup, val set 0.998x speedup, step: 1
Epoch 108/200 |loss: 15.732650| train set 1.391x speedup, test set 2.207x speedup, val set 0.998x speedup, step: 1
Epoch 109/200 |loss: 15.851748| train set 1.410x speedup, test set 1.057x speedup, val set 0.998x speedup, step: 1
Epoch 110/200 |loss: 15.896454| train set 1.462x speedup, test set 2.203x speedup, val set 0.739x speedup, step: 2
Epoch 111/200 |loss: 15.762465| train set 1.412x speedup, test set 1.811x speedup, val set 1.008x speedup, step: 1
Epoch 112/200 |loss: 15.762236| train set 1.416x speedup, test set 1.150x speedup, val set 0.998x speedup, step: 2
Epoch 113/200 |loss: 16.116650| train set 1.450x speedup, test set 1.048x speedup, val set 1.008x speedup, step: 3
Epoch 114/200 |loss: 15.617271| train set 1.471x speedup, test set 1.139x speedup, val set 0.997x speedup, step: 4
Epoch 115/200 |loss: 15.118535| train set 1.414x speedup, test set 1.884x speedup, val set 0.998x speedup, step: 5
Epoch 116/200 |loss: 14.952019| train set 1.496x speedup, test set 2.171x speedup, val set 0.998x speedup, step: 6
Epoch 117/200 |loss: 14.857078| train set 1.502x speedup, test set 2.162x speedup, val set 0.998x speedup, step: 7
Epoch 118/200 |loss: 14.999596| train set 1.416x speedup, test set 1.845x speedup, val set 0.998x speedup, step: 8
Epoch 119/200 |loss: 15.087586| train set 1.502x speedup, test set 1.511x speedup, val set 0.998x speedup, step: 9
Epoch 120/200 |loss: 15.764856| train set 1.416x speedup, test set 1.770x speedup, val set 0.997x speedup, step: 10
Epoch 121/200 |loss: 15.092862| train set 1.538x speedup, test set 1.159x speedup, val set 0.997x speedup, step: 11
Epoch 122/200 |loss: 14.676386| train set 1.502x speedup, test set 2.336x speedup, val set 0.998x speedup, step: 12
Epoch 123/200 |loss: 14.743854| train set 1.423x speedup, test set 1.036x speedup, val set 1.008x speedup, step: 1
Epoch 124/200 |loss: 15.817828| train set 1.501x speedup, test set 3.156x speedup, val set 0.993x speedup, step: 2
Epoch 125/200 |loss: 17.975855| train set 1.365x speedup, test set 1.028x speedup, val set 1.008x speedup, step: 1
Epoch 126/200 |loss: 17.339293| train set 1.408x speedup, test set 1.057x speedup, val set 0.998x speedup, step: 2
Epoch 127/200 |loss: 14.633016| train set 1.428x speedup, test set 1.643x speedup, val set 0.738x speedup, step: 3
Epoch 128/200 |loss: 17.093090| train set 1.452x speedup, test set 1.782x speedup, val set 0.998x speedup, step: 4
Epoch 129/200 |loss: 15.699287| train set 1.433x speedup, test set 1.028x speedup, val set 0.998x speedup, step: 5
Epoch 130/200 |loss: 15.804228| train set 1.488x speedup, test set 2.258x speedup, val set 0.993x speedup, step: 6
Epoch 131/200 |loss: 15.495570| train set 1.455x speedup, test set 2.258x speedup, val set 0.998x speedup, step: 7
Epoch 132/200 |loss: 14.777304| train set 1.421x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 8
Epoch 133/200 |loss: 15.580052| train set 1.416x speedup, test set 1.888x speedup, val set 0.997x speedup, step: 9
Epoch 134/200 |loss: 14.379299| train set 1.438x speedup, test set 2.244x speedup, val set 0.737x speedup, step: 10
Epoch 135/200 |loss: 14.965558| train set 1.471x speedup, test set 1.926x speedup, val set 0.998x speedup, step: 11
Epoch 136/200 |loss: 14.397381| train set 1.404x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 12
Epoch 137/200 |loss: 14.564614| train set 1.422x speedup, test set 1.957x speedup, val set 0.998x speedup, step: 13
Epoch 138/200 |loss: 13.945554| train set 1.465x speedup, test set 1.996x speedup, val set 0.996x speedup, step: 14
Epoch 139/200 |loss: 14.142261| train set 1.498x speedup, test set 1.085x speedup, val set 0.998x speedup, step: 15
Epoch 140/200 |loss: 13.888741| train set 1.416x speedup, test set 1.067x speedup, val set 0.998x speedup, step: 16
Epoch 141/200 |loss: 13.706821| train set 1.515x speedup, test set 1.954x speedup, val set 0.998x speedup, step: 17
Epoch 142/200 |loss: 13.773068| train set 1.515x speedup, test set 2.202x speedup, val set 0.997x speedup, step: 18
Epoch 143/200 |loss: 13.766324| train set 1.449x speedup, test set 1.794x speedup, val set 0.997x speedup, step: 19
Epoch 144/200 |loss: 14.473665| train set 1.509x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 20
Epoch 145/200 |loss: 15.876295| train set 1.527x speedup, test set 1.957x speedup, val set 0.998x speedup, step: 21
Epoch 146/200 |loss: 13.598063| train set 1.518x speedup, test set 1.954x speedup, val set 0.998x speedup, step: 22
Epoch 147/200 |loss: 14.544209| train set 1.501x speedup, test set 1.092x speedup, val set 0.998x speedup, step: 23
Epoch 148/200 |loss: 16.145109| train set 1.415x speedup, test set 1.860x speedup, val set 0.998x speedup, step: 24
Epoch 149/200 |loss: 14.273104| train set 1.506x speedup, test set 2.226x speedup, val set 1.004x speedup, step: 25
Epoch 150/200 |loss: 16.636074| train set 1.532x speedup, test set 1.087x speedup, val set 0.998x speedup, step: 26
Epoch 151/200 |loss: 14.956866| train set 1.416x speedup, test set 1.067x speedup, val set 0.998x speedup, step: 27
Epoch 152/200 |loss: 15.921421| train set 1.508x speedup, test set 1.954x speedup, val set 0.998x speedup, step: 28
Epoch 153/200 |loss: 14.140948| train set 1.505x speedup, test set 2.255x speedup, val set 0.998x speedup, step: 29
Epoch 154/200 |loss: 15.256105| train set 1.502x speedup, test set 1.093x speedup, val set 0.998x speedup, step: 30
Epoch 155/200 |loss: 14.176080| train set 1.502x speedup, test set 1.068x speedup, val set 0.998x speedup, step: 31
Epoch 156/200 |loss: 14.657625| train set 1.509x speedup, test set 1.957x speedup, val set 0.998x speedup, step: 32
Epoch 157/200 |loss: 13.565310| train set 1.505x speedup, test set 2.016x speedup, val set 0.998x speedup, step: 33
Epoch 158/200 |loss: 14.471859| train set 1.539x speedup, test set 1.076x speedup, val set 0.997x speedup, step: 34
Epoch 159/200 |loss: 13.711488| train set 1.502x speedup, test set 1.068x speedup, val set 0.997x speedup, step: 35
Epoch 160/200 |loss: 13.894316| train set 1.516x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 36
Epoch 161/200 |loss: 13.301635| train set 1.529x speedup, test set 1.875x speedup, val set 1.008x speedup, step: 1
Epoch 162/200 |loss: 13.541195| train set 1.484x speedup, test set 1.957x speedup, val set 0.998x speedup, step: 2
Epoch 163/200 |loss: 13.084278| train set 1.470x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 3
Epoch 164/200 |loss: 13.166528| train set 1.539x speedup, test set 1.797x speedup, val set 0.997x speedup, step: 4
Epoch 165/200 |loss: 12.783117| train set 1.521x speedup, test set 2.011x speedup, val set 0.997x speedup, step: 5
Epoch 166/200 |loss: 12.962770| train set 1.515x speedup, test set 1.875x speedup, val set 0.998x speedup, step: 6
Epoch 167/200 |loss: 12.637051| train set 1.515x speedup, test set 1.873x speedup, val set 0.998x speedup, step: 7
Epoch 168/200 |loss: 12.671099| train set 1.534x speedup, test set 2.016x speedup, val set 0.997x speedup, step: 8
Epoch 169/200 |loss: 12.559461| train set 1.558x speedup, test set 1.974x speedup, val set 1.008x speedup, step: 9
Epoch 170/200 |loss: 12.374922| train set 1.528x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 10
Epoch 171/200 |loss: 12.438044| train set 1.501x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 11
Epoch 172/200 |loss: 12.149406| train set 1.537x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 12
Epoch 173/200 |loss: 12.276660| train set 1.532x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 13
Epoch 174/200 |loss: 12.111884| train set 1.545x speedup, test set 1.974x speedup, val set 0.997x speedup, step: 14
Epoch 175/200 |loss: 12.083357| train set 1.536x speedup, test set 2.011x speedup, val set 0.997x speedup, step: 15
Epoch 176/200 |loss: 12.020222| train set 1.559x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 16
Epoch 177/200 |loss: 11.829681| train set 1.532x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 17
Epoch 178/200 |loss: 11.929008| train set 1.558x speedup, test set 2.011x speedup, val set 0.997x speedup, step: 18
Epoch 179/200 |loss: 11.862112| train set 1.496x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 19
Epoch 180/200 |loss: 12.084195| train set 1.538x speedup, test set 1.974x speedup, val set 1.008x speedup, step: 20
Epoch 181/200 |loss: 12.928774| train set 1.515x speedup, test set 2.256x speedup, val set 0.993x speedup, step: 21
Epoch 182/200 |loss: 13.781195| train set 1.539x speedup, test set 1.106x speedup, val set 1.008x speedup, step: 22
Epoch 183/200 |loss: 13.735600| train set 1.519x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 23
Epoch 184/200 |loss: 12.134927| train set 1.537x speedup, test set 2.256x speedup, val set 0.994x speedup, step: 24
Epoch 185/200 |loss: 12.488918| train set 1.543x speedup, test set 1.978x speedup, val set 1.008x speedup, step: 25
Epoch 186/200 |loss: 13.346470| train set 1.520x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 26
Epoch 187/200 |loss: 12.048629| train set 1.512x speedup, test set 2.256x speedup, val set 0.994x speedup, step: 27
Epoch 188/200 |loss: 12.401163| train set 1.449x speedup, test set 1.974x speedup, val set 1.008x speedup, step: 28
Epoch 189/200 |loss: 12.751167| train set 1.502x speedup, test set 2.016x speedup, val set 0.997x speedup, step: 29
Epoch 190/200 |loss: 12.008270| train set 1.485x speedup, test set 2.256x speedup, val set 0.997x speedup, step: 30
Epoch 191/200 |loss: 12.727249| train set 1.539x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 31
Epoch 192/200 |loss: 12.362611| train set 1.564x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 32
Epoch 193/200 |loss: 12.170044| train set 1.494x speedup, test set 2.256x speedup, val set 0.997x speedup, step: 33
Epoch 194/200 |loss: 12.171708| train set 1.514x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 34
Epoch 195/200 |loss: 11.818189| train set 1.541x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 35
Epoch 196/200 |loss: 11.619913| train set 1.532x speedup, test set 1.996x speedup, val set 0.997x speedup, step: 36
Epoch 197/200 |loss: 11.621077| train set 1.520x speedup, test set 1.873x speedup, val set 0.994x speedup, step: 37
Epoch 198/200 |loss: 11.766810| train set 1.541x speedup, test set 2.011x speedup, val set 0.997x speedup, step: 38
Epoch 199/200 |loss: 11.747067| train set 1.531x speedup, test set 2.011x speedup, val set 0.997x speedup, step: 39
Training per epoch cost 0.747 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 192, train speedup 1.564, test speedup 1.873, val speedup 0.997
best test speedup epoch: 85, train speedup 1.426, test speedup 3.480, val speedup 0.739
best validation speedup epoch: 161, train speedup 1.529, test speedup 1.875, val speedup 1.008
last model at epoch 199, train speedup 1.531, test speedup 2.011, val speedup 0.997
execution cost 0:07:24.052229
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.490086, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787601| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695999| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379642| train set 1.115x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083750| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.799913| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.531359| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.290113| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.018255| train set 1.173x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.760685| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.503277| train set 1.211x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.271280| train set 1.217x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.047729| train set 1.249x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.901587| train set 1.216x speedup, test set 1.028x speedup, val set 0.932x speedup, step: 20
Epoch 20/200 |loss: 27.045361| train set 1.207x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.661800| train set 1.224x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.208439| train set 1.205x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.217663| train set 1.225x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.846575| train set 1.225x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 25
Epoch 25/200 |loss: 25.680796| train set 1.201x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 26
Epoch 26/200 |loss: 25.610306| train set 1.225x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.274399| train set 1.195x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.170359| train set 1.205x speedup, test set 1.015x speedup, val set 0.932x speedup, step: 29
Epoch 29/200 |loss: 25.208582| train set 1.203x speedup, test set 1.017x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.858431| train set 1.200x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.753590| train set 1.199x speedup, test set 1.017x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.654346| train set 1.231x speedup, test set 1.017x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.219194| train set 1.231x speedup, test set 1.017x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.286142| train set 1.242x speedup, test set 1.034x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.182590| train set 1.232x speedup, test set 1.017x speedup, val set 0.997x speedup, step: 36
Epoch 36/200 |loss: 23.685204| train set 1.232x speedup, test set 1.018x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.641550| train set 1.275x speedup, test set 1.035x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.701239| train set 1.231x speedup, test set 1.727x speedup, val set 0.997x speedup, step: 39
Epoch 39/200 |loss: 23.164591| train set 1.232x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 22.968405| train set 1.244x speedup, test set 1.778x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.052349| train set 1.232x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.821466| train set 1.266x speedup, test set 1.778x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.649532| train set 1.174x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 23.561340| train set 1.317x speedup, test set 1.778x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 23.513577| train set 1.320x speedup, test set 1.778x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.185816| train set 1.237x speedup, test set 1.018x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.682877| train set 1.287x speedup, test set 1.778x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.226772| train set 1.289x speedup, test set 1.932x speedup, val set 0.930x speedup, step: 49
Epoch 49/200 |loss: 22.031565| train set 1.232x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.285883| train set 1.307x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.420738| train set 1.314x speedup, test set 2.381x speedup, val set 0.701x speedup, step: 52
Epoch 52/200 |loss: 21.922297| train set 1.305x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.654337| train set 1.311x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.515989| train set 1.363x speedup, test set 1.802x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.206696| train set 1.330x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 20.905424| train set 1.327x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 21.289093| train set 1.330x speedup, test set 1.776x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.421772| train set 1.376x speedup, test set 1.869x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 20.704149| train set 1.316x speedup, test set 1.764x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.421616| train set 1.313x speedup, test set 1.741x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.632015| train set 1.375x speedup, test set 2.651x speedup, val set 0.701x speedup, step: 62
Epoch 62/200 |loss: 20.498287| train set 1.328x speedup, test set 1.741x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.219421| train set 1.328x speedup, test set 1.743x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.490860| train set 1.344x speedup, test set 1.833x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.089195| train set 1.310x speedup, test set 1.730x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 19.714056| train set 1.328x speedup, test set 1.860x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.250776| train set 1.329x speedup, test set 1.743x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.644888| train set 1.397x speedup, test set 1.847x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.257233| train set 1.398x speedup, test set 1.906x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.370768| train set 1.400x speedup, test set 1.756x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 18.983610| train set 1.350x speedup, test set 1.813x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.215046| train set 1.344x speedup, test set 1.737x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 18.935001| train set 1.397x speedup, test set 2.367x speedup, val set 0.701x speedup, step: 74
Epoch 74/200 |loss: 18.760218| train set 1.363x speedup, test set 1.762x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 18.793211| train set 1.345x speedup, test set 1.058x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 19.615564| train set 1.373x speedup, test set 1.726x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.435715| train set 1.401x speedup, test set 2.374x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 18.125591| train set 1.400x speedup, test set 1.844x speedup, val set 0.998x speedup, step: 79
Epoch 79/200 |loss: 18.429802| train set 1.337x speedup, test set 1.762x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.433081| train set 1.400x speedup, test set 2.296x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 17.838959| train set 1.432x speedup, test set 1.767x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 17.976051| train set 1.409x speedup, test set 2.496x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 17.792505| train set 1.345x speedup, test set 1.017x speedup, val set 0.998x speedup, step: 84
Epoch 84/200 |loss: 18.094152| train set 1.415x speedup, test set 2.374x speedup, val set 0.998x speedup, step: 85
Epoch 85/200 |loss: 18.042101| train set 1.431x speedup, test set 1.969x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 18.237871| train set 1.430x speedup, test set 1.180x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 19.297955| train set 1.315x speedup, test set 1.798x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 18.890337| train set 1.404x speedup, test set 2.053x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 18.054373| train set 1.393x speedup, test set 2.903x speedup, val set 0.701x speedup, step: 90
Epoch 90/200 |loss: 20.024820| train set 1.364x speedup, test set 1.012x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 18.506889| train set 1.371x speedup, test set 1.788x speedup, val set 0.998x speedup, step: 92
Epoch 92/200 |loss: 19.896399| train set 1.411x speedup, test set 1.052x speedup, val set 0.998x speedup, step: 93
Epoch 93/200 |loss: 19.048420| train set 1.416x speedup, test set 1.589x speedup, val set 0.998x speedup, step: 94
Epoch 94/200 |loss: 18.503428| train set 1.405x speedup, test set 1.871x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 18.188839| train set 1.397x speedup, test set 1.760x speedup, val set 0.998x speedup, step: 96
Epoch 96/200 |loss: 17.875910| train set 1.400x speedup, test set 1.075x speedup, val set 0.998x speedup, step: 97
Epoch 97/200 |loss: 17.815712| train set 1.454x speedup, test set 1.171x speedup, val set 0.739x speedup, step: 98
Epoch 98/200 |loss: 17.760742| train set 1.396x speedup, test set 1.993x speedup, val set 0.998x speedup, step: 99
Epoch 99/200 |loss: 17.055628| train set 1.399x speedup, test set 1.788x speedup, val set 0.998x speedup, step: 100
Epoch 100/200 |loss: 17.181768| train set 1.401x speedup, test set 1.115x speedup, val set 0.998x speedup, step: 1
Epoch 101/200 |loss: 17.007772| train set 1.401x speedup, test set 1.054x speedup, val set 0.998x speedup, step: 1
Epoch 102/200 |loss: 16.900146| train set 1.414x speedup, test set 1.762x speedup, val set 0.998x speedup, step: 1
Epoch 103/200 |loss: 16.542122| train set 1.415x speedup, test set 1.986x speedup, val set 0.998x speedup, step: 1
Epoch 104/200 |loss: 16.435751| train set 1.388x speedup, test set 1.163x speedup, val set 0.998x speedup, step: 1
Epoch 105/200 |loss: 16.346947| train set 1.431x speedup, test set 2.242x speedup, val set 0.998x speedup, step: 1
Epoch 106/200 |loss: 16.068840| train set 1.399x speedup, test set 1.762x speedup, val set 0.998x speedup, step: 1
Epoch 107/200 |loss: 16.137709| train set 1.389x speedup, test set 1.050x speedup, val set 0.998x speedup, step: 1
Epoch 108/200 |loss: 15.820272| train set 1.502x speedup, test set 1.162x speedup, val set 0.998x speedup, step: 1
Epoch 109/200 |loss: 15.747092| train set 1.404x speedup, test set 1.760x speedup, val set 0.998x speedup, step: 1
Epoch 110/200 |loss: 15.620530| train set 1.416x speedup, test set 2.103x speedup, val set 0.998x speedup, step: 1
Epoch 111/200 |loss: 15.462908| train set 1.414x speedup, test set 1.991x speedup, val set 0.998x speedup, step: 1
Epoch 112/200 |loss: 15.556046| train set 1.502x speedup, test set 2.196x speedup, val set 0.998x speedup, step: 1
Epoch 113/200 |loss: 15.729650| train set 1.394x speedup, test set 1.039x speedup, val set 0.998x speedup, step: 1
Epoch 114/200 |loss: 16.500109| train set 1.453x speedup, test set 2.302x speedup, val set 0.998x speedup, step: 1
Epoch 115/200 |loss: 16.361204| train set 1.427x speedup, test set 1.019x speedup, val set 1.008x speedup, step: 1
Epoch 116/200 |loss: 15.843637| train set 1.416x speedup, test set 1.080x speedup, val set 0.998x speedup, step: 2
Epoch 117/200 |loss: 15.261950| train set 1.420x speedup, test set 1.959x speedup, val set 0.998x speedup, step: 3
Epoch 118/200 |loss: 15.239484| train set 1.416x speedup, test set 1.394x speedup, val set 0.998x speedup, step: 4
Epoch 119/200 |loss: 15.562387| train set 1.416x speedup, test set 1.875x speedup, val set 0.998x speedup, step: 5
Epoch 120/200 |loss: 14.951147| train set 1.502x speedup, test set 2.103x speedup, val set 0.998x speedup, step: 6
Epoch 121/200 |loss: 14.585443| train set 1.534x speedup, test set 1.056x speedup, val set 0.998x speedup, step: 7
Epoch 122/200 |loss: 14.939006| train set 1.380x speedup, test set 1.879x speedup, val set 0.998x speedup, step: 8
Epoch 123/200 |loss: 14.751020| train set 1.432x speedup, test set 1.860x speedup, val set 0.998x speedup, step: 9
Epoch 124/200 |loss: 14.476335| train set 1.453x speedup, test set 1.855x speedup, val set 0.998x speedup, step: 10
Epoch 125/200 |loss: 14.559861| train set 1.502x speedup, test set 2.107x speedup, val set 0.997x speedup, step: 11
Epoch 126/200 |loss: 14.735471| train set 1.418x speedup, test set 1.855x speedup, val set 0.997x speedup, step: 12
Epoch 127/200 |loss: 14.470568| train set 1.503x speedup, test set 2.217x speedup, val set 0.998x speedup, step: 13
Epoch 128/200 |loss: 14.302348| train set 1.420x speedup, test set 1.858x speedup, val set 0.998x speedup, step: 14
Epoch 129/200 |loss: 14.228059| train set 1.417x speedup, test set 1.058x speedup, val set 0.998x speedup, step: 15
Epoch 130/200 |loss: 14.260315| train set 1.483x speedup, test set 2.115x speedup, val set 0.998x speedup, step: 16
Epoch 131/200 |loss: 14.057749| train set 1.389x speedup, test set 1.056x speedup, val set 0.998x speedup, step: 17
Epoch 132/200 |loss: 14.353822| train set 1.505x speedup, test set 2.106x speedup, val set 0.998x speedup, step: 18
Epoch 133/200 |loss: 14.135030| train set 1.527x speedup, test set 2.073x speedup, val set 0.998x speedup, step: 19
Epoch 134/200 |loss: 13.778337| train set 1.500x speedup, test set 1.879x speedup, val set 0.998x speedup, step: 20
Epoch 135/200 |loss: 13.499444| train set 1.501x speedup, test set 1.862x speedup, val set 0.997x speedup, step: 21
Epoch 136/200 |loss: 13.529543| train set 1.451x speedup, test set 1.854x speedup, val set 0.997x speedup, step: 22
Epoch 137/200 |loss: 13.723491| train set 1.501x speedup, test set 1.122x speedup, val set 0.998x speedup, step: 23
Epoch 138/200 |loss: 13.791473| train set 1.426x speedup, test set 1.745x speedup, val set 0.998x speedup, step: 24
Epoch 139/200 |loss: 14.832962| train set 1.488x speedup, test set 1.165x speedup, val set 0.997x speedup, step: 25
Epoch 140/200 |loss: 16.633528| train set 1.402x speedup, test set 1.783x speedup, val set 0.998x speedup, step: 26
Epoch 141/200 |loss: 14.719721| train set 1.503x speedup, test set 2.076x speedup, val set 0.998x speedup, step: 27
Epoch 142/200 |loss: 13.615306| train set 1.461x speedup, test set 1.117x speedup, val set 0.998x speedup, step: 28
Epoch 143/200 |loss: 15.215396| train set 1.416x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 29
Epoch 144/200 |loss: 13.801758| train set 1.484x speedup, test set 1.848x speedup, val set 0.998x speedup, step: 30
Epoch 145/200 |loss: 14.217366| train set 1.519x speedup, test set 1.122x speedup, val set 0.998x speedup, step: 31
Epoch 146/200 |loss: 16.439873| train set 1.415x speedup, test set 1.782x speedup, val set 0.998x speedup, step: 32
Epoch 147/200 |loss: 14.035957| train set 1.436x speedup, test set 1.766x speedup, val set 0.997x speedup, step: 33
Epoch 148/200 |loss: 16.274851| train set 1.540x speedup, test set 1.047x speedup, val set 0.998x speedup, step: 34
Epoch 149/200 |loss: 15.641332| train set 1.470x speedup, test set 2.102x speedup, val set 0.998x speedup, step: 35
Epoch 150/200 |loss: 16.570436| train set 1.523x speedup, test set 1.852x speedup, val set 0.998x speedup, step: 36
Epoch 151/200 |loss: 14.189141| train set 1.405x speedup, test set 1.859x speedup, val set 0.998x speedup, step: 37
Epoch 152/200 |loss: 15.692497| train set 1.519x speedup, test set 1.063x speedup, val set 0.998x speedup, step: 38
Epoch 153/200 |loss: 13.975996| train set 1.501x speedup, test set 2.126x speedup, val set 0.997x speedup, step: 39
Epoch 154/200 |loss: 14.812577| train set 1.536x speedup, test set 1.855x speedup, val set 0.998x speedup, step: 40
Epoch 155/200 |loss: 13.545463| train set 1.414x speedup, test set 1.055x speedup, val set 0.994x speedup, step: 41
Epoch 156/200 |loss: 14.609150| train set 1.501x speedup, test set 1.057x speedup, val set 0.997x speedup, step: 42
Epoch 157/200 |loss: 13.255415| train set 1.471x speedup, test set 2.077x speedup, val set 0.998x speedup, step: 43
Epoch 158/200 |loss: 14.072220| train set 1.471x speedup, test set 1.859x speedup, val set 0.998x speedup, step: 44
Epoch 159/200 |loss: 13.016085| train set 1.426x speedup, test set 1.859x speedup, val set 0.997x speedup, step: 45
Epoch 160/200 |loss: 13.702897| train set 1.536x speedup, test set 1.852x speedup, val set 0.997x speedup, step: 46
Epoch 161/200 |loss: 12.895364| train set 1.492x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 47
Epoch 162/200 |loss: 13.244110| train set 1.488x speedup, test set 1.057x speedup, val set 0.997x speedup, step: 48
Epoch 163/200 |loss: 12.754907| train set 1.519x speedup, test set 1.859x speedup, val set 0.997x speedup, step: 49
Epoch 164/200 |loss: 13.007705| train set 1.558x speedup, test set 1.872x speedup, val set 0.997x speedup, step: 50
Epoch 165/200 |loss: 12.710209| train set 1.519x speedup, test set 1.859x speedup, val set 0.997x speedup, step: 51
Epoch 166/200 |loss: 12.558993| train set 1.524x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 52
Epoch 167/200 |loss: 12.526735| train set 1.519x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 53
Epoch 168/200 |loss: 12.393375| train set 1.518x speedup, test set 1.858x speedup, val set 0.997x speedup, step: 54
Epoch 169/200 |loss: 12.339237| train set 1.518x speedup, test set 1.854x speedup, val set 0.997x speedup, step: 55
Epoch 170/200 |loss: 12.264388| train set 1.489x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 56
Epoch 171/200 |loss: 12.206299| train set 1.557x speedup, test set 1.851x speedup, val set 0.997x speedup, step: 57
Epoch 172/200 |loss: 12.086040| train set 1.524x speedup, test set 1.851x speedup, val set 0.994x speedup, step: 58
Epoch 173/200 |loss: 12.113918| train set 1.502x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 59
Epoch 174/200 |loss: 12.218371| train set 1.519x speedup, test set 1.937x speedup, val set 0.997x speedup, step: 60
Epoch 175/200 |loss: 12.447928| train set 1.506x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 61
Epoch 176/200 |loss: 13.768501| train set 1.472x speedup, test set 2.078x speedup, val set 0.994x speedup, step: 62
Epoch 177/200 |loss: 13.316496| train set 1.543x speedup, test set 1.050x speedup, val set 1.000x speedup, step: 63
Epoch 178/200 |loss: 13.222425| train set 1.519x speedup, test set 1.055x speedup, val set 0.997x speedup, step: 64
Epoch 179/200 |loss: 12.388825| train set 1.492x speedup, test set 1.970x speedup, val set 0.994x speedup, step: 65
Epoch 180/200 |loss: 12.441048| train set 1.537x speedup, test set 1.889x speedup, val set 1.000x speedup, step: 66
Epoch 181/200 |loss: 12.830202| train set 1.502x speedup, test set 1.856x speedup, val set 0.994x speedup, step: 67
Epoch 182/200 |loss: 12.829181| train set 1.508x speedup, test set 1.858x speedup, val set 0.997x speedup, step: 68
Epoch 183/200 |loss: 11.868022| train set 1.515x speedup, test set 1.051x speedup, val set 0.990x speedup, step: 69
Epoch 184/200 |loss: 12.253345| train set 1.531x speedup, test set 2.122x speedup, val set 0.994x speedup, step: 70
Epoch 185/200 |loss: 12.434356| train set 1.502x speedup, test set 1.055x speedup, val set 0.997x speedup, step: 71
Epoch 186/200 |loss: 11.934710| train set 1.559x speedup, test set 1.886x speedup, val set 0.997x speedup, step: 72
Epoch 187/200 |loss: 11.861422| train set 1.519x speedup, test set 1.904x speedup, val set 0.994x speedup, step: 73
Epoch 188/200 |loss: 11.779188| train set 1.556x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 74
Epoch 189/200 |loss: 11.705979| train set 1.559x speedup, test set 2.223x speedup, val set 0.994x speedup, step: 75
Epoch 190/200 |loss: 11.776267| train set 1.520x speedup, test set 1.869x speedup, val set 0.994x speedup, step: 76
Epoch 191/200 |loss: 11.924721| train set 1.527x speedup, test set 1.159x speedup, val set 0.997x speedup, step: 77
Epoch 192/200 |loss: 11.693547| train set 1.506x speedup, test set 1.851x speedup, val set 0.994x speedup, step: 78
Epoch 193/200 |loss: 12.111384| train set 1.519x speedup, test set 1.057x speedup, val set 0.997x speedup, step: 79
Epoch 194/200 |loss: 14.125543| train set 1.546x speedup, test set 2.073x speedup, val set 0.994x speedup, step: 80
Epoch 195/200 |loss: 11.529548| train set 1.529x speedup, test set 2.222x speedup, val set 0.994x speedup, step: 81
Epoch 196/200 |loss: 12.942975| train set 1.502x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 82
Epoch 197/200 |loss: 15.108398| train set 1.469x speedup, test set 1.851x speedup, val set 0.994x speedup, step: 83
Epoch 198/200 |loss: 13.799184| train set 1.536x speedup, test set 2.221x speedup, val set 0.997x speedup, step: 84
Epoch 199/200 |loss: 13.904944| train set 1.520x speedup, test set 1.139x speedup, val set 0.997x speedup, step: 85
Training per epoch cost 0.321 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 9.387s, pg runtime 8.283s, speedup 0.882x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.379s, pg runtime 3.645s, speedup 9.614x
20, opt runtime 0.626s, model runtime 1.404s, pg runtime 2.558s, speedup 1.822x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 186, train speedup 1.559, test speedup 1.886, val speedup 0.997
best test speedup epoch: 89, train speedup 1.393, test speedup 2.903, val speedup 0.701
best validation speedup epoch: 115, train speedup 1.427, test speedup 1.019, val speedup 1.008
last model at epoch 199, train speedup 1.520, test speedup 1.139, val speedup 0.997
execution cost 0:02:46.348340
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.529253, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443676| train set 0.789x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698147| train set 1.100x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091860| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.810455| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533854| train set 1.143x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.279305| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.016516| train set 1.137x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.789255| train set 1.192x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.566643| train set 1.173x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.384262| train set 1.207x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.163773| train set 1.219x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.934057| train set 1.200x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.664585| train set 1.226x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.445988| train set 1.205x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.291727| train set 1.224x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.117228| train set 1.182x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.935556| train set 1.191x speedup, test set 1.015x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.645868| train set 1.200x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.432146| train set 1.200x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.378141| train set 1.196x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.355820| train set 1.174x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.073612| train set 1.179x speedup, test set 1.014x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.631889| train set 1.197x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.719988| train set 1.167x speedup, test set 1.067x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.670195| train set 1.198x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 33
Epoch 33/200 |loss: 24.228479| train set 1.199x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.074892| train set 1.248x speedup, test set 1.041x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.231680| train set 1.229x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 36
Epoch 36/200 |loss: 23.875269| train set 1.226x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.635603| train set 1.239x speedup, test set 1.837x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.926842| train set 1.227x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 39
Epoch 39/200 |loss: 23.682634| train set 1.227x speedup, test set 1.041x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.022690| train set 1.256x speedup, test set 1.925x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.468901| train set 1.229x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.872545| train set 1.232x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 22.724722| train set 1.267x speedup, test set 1.925x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.729969| train set 1.305x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.139498| train set 1.231x speedup, test set 1.007x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.317924| train set 1.297x speedup, test set 1.759x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 21.955591| train set 1.285x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.222593| train set 1.231x speedup, test set 1.710x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 23.343990| train set 1.324x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 23.663031| train set 1.279x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 22.217573| train set 1.232x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 23.391333| train set 1.324x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 22.366405| train set 1.306x speedup, test set 1.817x speedup, val set 0.701x speedup, step: 54
Epoch 54/200 |loss: 22.380991| train set 1.321x speedup, test set 1.745x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.696445| train set 1.245x speedup, test set 1.745x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.859060| train set 1.312x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 21.530622| train set 1.386x speedup, test set 2.010x speedup, val set 0.930x speedup, step: 58
Epoch 58/200 |loss: 21.297651| train set 1.328x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 21.199022| train set 1.312x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.926014| train set 1.326x speedup, test set 1.052x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.820229| train set 1.392x speedup, test set 1.954x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.521523| train set 1.329x speedup, test set 1.799x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.490330| train set 1.343x speedup, test set 1.757x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.129175| train set 1.343x speedup, test set 1.878x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.163950| train set 1.328x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 19.915665| train set 1.341x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 19.716055| train set 1.391x speedup, test set 1.983x speedup, val set 0.930x speedup, step: 68
Epoch 68/200 |loss: 19.767532| train set 1.330x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.364067| train set 1.331x speedup, test set 1.865x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 19.275505| train set 1.399x speedup, test set 1.826x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.143389| train set 1.343x speedup, test set 1.839x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.061995| train set 1.399x speedup, test set 1.944x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 18.778393| train set 1.341x speedup, test set 1.862x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 18.677011| train set 1.399x speedup, test set 2.094x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 18.610336| train set 1.344x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 18.790297| train set 1.398x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.901415| train set 1.345x speedup, test set 1.040x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 19.037092| train set 1.445x speedup, test set 2.563x speedup, val set 0.738x speedup, step: 79
Epoch 79/200 |loss: 19.065159| train set 1.406x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 20.157192| train set 1.339x speedup, test set 1.802x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 21.236425| train set 1.408x speedup, test set 2.298x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 19.305361| train set 1.405x speedup, test set 1.827x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 20.299864| train set 1.395x speedup, test set 2.016x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.258883| train set 1.368x speedup, test set 1.944x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 19.937832| train set 1.390x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.586655| train set 1.399x speedup, test set 2.368x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.613499| train set 1.400x speedup, test set 2.016x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.895847| train set 1.339x speedup, test set 1.891x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.111078| train set 1.371x speedup, test set 1.105x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.537966| train set 1.415x speedup, test set 2.516x speedup, val set 0.738x speedup, step: 91
Epoch 91/200 |loss: 17.760115| train set 1.399x speedup, test set 1.862x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.263252| train set 1.400x speedup, test set 1.895x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.324478| train set 1.414x speedup, test set 2.016x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.049759| train set 1.444x speedup, test set 1.105x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.205036| train set 1.368x speedup, test set 1.892x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.306971| train set 1.399x speedup, test set 1.067x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 18.911924| train set 1.397x speedup, test set 1.793x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 17.210972| train set 1.530x speedup, test set 2.013x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.653324| train set 1.414x speedup, test set 1.928x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.437906| train set 1.400x speedup, test set 1.895x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.601284| train set 1.400x speedup, test set 1.067x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.478004| train set 1.430x speedup, test set 2.013x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.056723| train set 1.400x speedup, test set 1.973x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 15.862935| train set 1.416x speedup, test set 1.892x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 15.678634| train set 1.418x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 15.835762| train set 1.448x speedup, test set 1.067x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.140053| train set 1.416x speedup, test set 1.889x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.281399| train set 1.428x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 16.780113| train set 1.475x speedup, test set 2.282x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 15.929044| train set 1.433x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.555521| train set 1.462x speedup, test set 2.411x speedup, val set 0.738x speedup, step: 2
Epoch 112/200 |loss: 16.189327| train set 1.351x speedup, test set 1.787x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 17.507725| train set 1.416x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 17.122644| train set 1.416x speedup, test set 1.878x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 15.344572| train set 1.421x speedup, test set 1.771x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 17.589333| train set 1.502x speedup, test set 2.116x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 17.042385| train set 1.415x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 16.031637| train set 1.400x speedup, test set 1.768x speedup, val set 0.996x speedup, step: 2
Epoch 119/200 |loss: 16.916897| train set 1.430x speedup, test set 1.021x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 15.084161| train set 1.478x speedup, test set 1.175x speedup, val set 0.738x speedup, step: 2
Epoch 121/200 |loss: 16.292580| train set 1.355x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 15.627251| train set 1.413x speedup, test set 2.098x speedup, val set 0.994x speedup, step: 2
Epoch 123/200 |loss: 15.845408| train set 1.540x speedup, test set 1.132x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 15.838167| train set 1.422x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 15.308112| train set 1.412x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 15.306994| train set 1.525x speedup, test set 2.093x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 15.358315| train set 1.394x speedup, test set 2.166x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 15.182285| train set 1.403x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 1
Epoch 129/200 |loss: 14.946750| train set 1.504x speedup, test set 2.247x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 14.888447| train set 1.540x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 14.203895| train set 1.377x speedup, test set 1.032x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 14.468889| train set 1.520x speedup, test set 1.821x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 14.208565| train set 1.498x speedup, test set 1.821x speedup, val set 0.997x speedup, step: 1
Epoch 134/200 |loss: 14.256260| train set 1.432x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 13.912679| train set 1.518x speedup, test set 1.995x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 13.753981| train set 1.537x speedup, test set 2.061x speedup, val set 0.997x speedup, step: 1
Epoch 137/200 |loss: 13.742407| train set 1.493x speedup, test set 2.212x speedup, val set 0.996x speedup, step: 2
Epoch 138/200 |loss: 13.749962| train set 1.495x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 13.913049| train set 1.524x speedup, test set 2.201x speedup, val set 0.997x speedup, step: 1
Epoch 140/200 |loss: 13.780252| train set 1.447x speedup, test set 1.022x speedup, val set 0.997x speedup, step: 1
Epoch 141/200 |loss: 13.732944| train set 1.524x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 142/200 |loss: 13.398930| train set 1.502x speedup, test set 2.262x speedup, val set 0.997x speedup, step: 1
Epoch 143/200 |loss: 13.241186| train set 1.535x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 144/200 |loss: 13.139852| train set 1.521x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 1
Epoch 145/200 |loss: 13.057046| train set 1.509x speedup, test set 1.845x speedup, val set 0.997x speedup, step: 1
Epoch 146/200 |loss: 13.144018| train set 1.488x speedup, test set 2.201x speedup, val set 0.997x speedup, step: 1
Epoch 147/200 |loss: 13.286068| train set 1.448x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 1
Epoch 148/200 |loss: 13.841129| train set 1.479x speedup, test set 2.250x speedup, val set 0.738x speedup, step: 2
Epoch 149/200 |loss: 13.818314| train set 1.433x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 150/200 |loss: 13.422484| train set 1.520x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 1
Epoch 151/200 |loss: 12.956879| train set 1.507x speedup, test set 2.194x speedup, val set 0.994x speedup, step: 2
Epoch 152/200 |loss: 13.858064| train set 1.451x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 1
Epoch 153/200 |loss: 16.580858| train set 1.404x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 154/200 |loss: 13.466068| train set 1.432x speedup, test set 2.217x speedup, val set 0.738x speedup, step: 2
Epoch 155/200 |loss: 14.031057| train set 1.540x speedup, test set 1.027x speedup, val set 0.997x speedup, step: 1
Epoch 156/200 |loss: 15.310059| train set 1.417x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 1
Epoch 157/200 |loss: 14.243594| train set 1.500x speedup, test set 2.217x speedup, val set 0.992x speedup, step: 2
Epoch 158/200 |loss: 14.673628| train set 1.544x speedup, test set 2.222x speedup, val set 0.997x speedup, step: 1
Epoch 159/200 |loss: 14.840132| train set 1.317x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 1
Epoch 160/200 |loss: 15.776748| train set 1.488x speedup, test set 1.770x speedup, val set 0.996x speedup, step: 2
Epoch 161/200 |loss: 14.151262| train set 1.357x speedup, test set 2.396x speedup, val set 0.744x speedup, step: 3
Epoch 162/200 |loss: 15.878036| train set 1.507x speedup, test set 1.767x speedup, val set 0.997x speedup, step: 1
Epoch 163/200 |loss: 13.855030| train set 1.397x speedup, test set 1.792x speedup, val set 0.996x speedup, step: 2
Epoch 164/200 |loss: 14.633853| train set 1.557x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 165/200 |loss: 13.788579| train set 1.479x speedup, test set 2.217x speedup, val set 0.997x speedup, step: 1
Epoch 166/200 |loss: 13.913108| train set 1.488x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 167/200 |loss: 13.286092| train set 1.388x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 168/200 |loss: 13.514544| train set 1.473x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 169/200 |loss: 13.028704| train set 1.521x speedup, test set 2.093x speedup, val set 0.997x speedup, step: 1
Epoch 170/200 |loss: 13.251193| train set 1.519x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 171/200 |loss: 12.724222| train set 1.519x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 172/200 |loss: 12.893198| train set 1.537x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 173/200 |loss: 12.593327| train set 1.577x speedup, test set 2.083x speedup, val set 0.997x speedup, step: 1
Epoch 174/200 |loss: 12.499372| train set 1.562x speedup, test set 1.990x speedup, val set 0.997x speedup, step: 1
Epoch 175/200 |loss: 12.459340| train set 1.519x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 176/200 |loss: 12.339268| train set 1.557x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 177/200 |loss: 12.357836| train set 1.558x speedup, test set 2.256x speedup, val set 0.997x speedup, step: 1
Epoch 178/200 |loss: 12.090462| train set 1.537x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 179/200 |loss: 12.064776| train set 1.519x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 1
Epoch 180/200 |loss: 12.029612| train set 1.492x speedup, test set 1.860x speedup, val set 0.997x speedup, step: 1
Epoch 181/200 |loss: 11.967813| train set 1.526x speedup, test set 1.860x speedup, val set 0.997x speedup, step: 1
Epoch 182/200 |loss: 12.012782| train set 1.561x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 183/200 |loss: 12.175614| train set 1.501x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 184/200 |loss: 12.989439| train set 1.535x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 185/200 |loss: 13.140398| train set 1.542x speedup, test set 2.434x speedup, val set 0.996x speedup, step: 2
Epoch 186/200 |loss: 14.102447| train set 1.447x speedup, test set 1.794x speedup, val set 1.008x speedup, step: 1
Epoch 187/200 |loss: 13.233142| train set 1.519x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 2
Epoch 188/200 |loss: 12.157263| train set 1.519x speedup, test set 2.257x speedup, val set 0.997x speedup, step: 3
Epoch 189/200 |loss: 13.083697| train set 1.469x speedup, test set 1.782x speedup, val set 0.997x speedup, step: 4
Epoch 190/200 |loss: 12.897481| train set 1.512x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 5
Epoch 191/200 |loss: 12.046528| train set 1.538x speedup, test set 2.244x speedup, val set 0.997x speedup, step: 6
Epoch 192/200 |loss: 13.055977| train set 1.463x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 7
Epoch 193/200 |loss: 12.434733| train set 1.488x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 8
Epoch 194/200 |loss: 11.828559| train set 1.537x speedup, test set 2.262x speedup, val set 0.997x speedup, step: 9
Epoch 195/200 |loss: 12.272357| train set 1.528x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 10
Epoch 196/200 |loss: 12.060996| train set 1.519x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 11
Epoch 197/200 |loss: 11.457192| train set 1.508x speedup, test set 2.000x speedup, val set 0.997x speedup, step: 12
Epoch 198/200 |loss: 11.868269| train set 1.557x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 13
Epoch 199/200 |loss: 11.660620| train set 1.560x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 14
Training per epoch cost 0.325 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.131s, pg runtime 13.945s, speedup 0.814x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 173, train speedup 1.577, test speedup 2.083, val speedup 0.997
best test speedup epoch: 78, train speedup 1.445, test speedup 2.563, val speedup 0.738
best validation speedup epoch: 186, train speedup 1.447, test speedup 1.794, val speedup 1.008
last model at epoch 199, train speedup 1.560, test speedup 1.785, val speedup 0.997
execution cost 0:02:47.435066
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.471028, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787601| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695999| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379646| train set 1.115x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083639| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800262| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.530777| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.288639| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.018433| train set 1.178x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.764059| train set 1.169x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.508369| train set 1.206x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.297747| train set 1.236x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.157196| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 27.187784| train set 1.252x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.770746| train set 1.235x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.457230| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.418610| train set 1.224x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.056021| train set 1.226x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.857424| train set 1.180x speedup, test set 1.023x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.781372| train set 1.227x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.461840| train set 1.195x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.271463| train set 1.183x speedup, test set 1.023x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.245962| train set 1.190x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.126320| train set 1.205x speedup, test set 1.016x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.061995| train set 1.174x speedup, test set 1.016x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.830664| train set 1.217x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.681458| train set 1.228x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.360874| train set 1.175x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.105309| train set 1.230x speedup, test set 1.735x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 24.308918| train set 1.229x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 24.037971| train set 1.231x speedup, test set 1.016x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.536840| train set 1.231x speedup, test set 1.735x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.816349| train set 1.310x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.555630| train set 1.231x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.007803| train set 1.232x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 41
Epoch 41/200 |loss: 23.346912| train set 1.310x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.097902| train set 1.305x speedup, test set 1.028x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.664780| train set 1.231x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 23.048771| train set 1.277x speedup, test set 1.396x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.652905| train set 1.237x speedup, test set 1.011x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 23.012707| train set 1.305x speedup, test set 1.846x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.820257| train set 1.317x speedup, test set 1.030x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.423965| train set 1.313x speedup, test set 1.030x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.170530| train set 1.324x speedup, test set 1.918x speedup, val set 0.930x speedup, step: 50
Epoch 50/200 |loss: 21.980516| train set 1.326x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.792521| train set 1.325x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.399529| train set 1.327x speedup, test set 1.745x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 21.611927| train set 1.313x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.069254| train set 1.285x speedup, test set 2.201x speedup, val set 0.701x speedup, step: 55
Epoch 55/200 |loss: 21.341764| train set 1.312x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.261515| train set 1.343x speedup, test set 1.018x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 21.516338| train set 1.324x speedup, test set 1.031x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.810984| train set 1.387x speedup, test set 1.982x speedup, val set 0.931x speedup, step: 59
Epoch 59/200 |loss: 20.890829| train set 1.329x speedup, test set 1.022x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.798254| train set 1.330x speedup, test set 1.769x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.202435| train set 1.343x speedup, test set 1.768x speedup, val set 0.998x speedup, step: 62
Epoch 62/200 |loss: 20.239737| train set 1.344x speedup, test set 1.770x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.338074| train set 1.310x speedup, test set 1.944x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 20.037792| train set 1.345x speedup, test set 1.018x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 19.653410| train set 1.345x speedup, test set 1.059x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 19.573202| train set 1.341x speedup, test set 1.794x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.383615| train set 1.393x speedup, test set 1.489x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 21.138634| train set 1.328x speedup, test set 1.768x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 19.918653| train set 1.367x speedup, test set 2.050x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 21.079634| train set 1.399x speedup, test set 1.081x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 19.975161| train set 1.320x speedup, test set 1.027x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.653669| train set 1.365x speedup, test set 2.010x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 20.136763| train set 1.325x speedup, test set 1.774x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 18.823620| train set 1.341x speedup, test set 1.027x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.742928| train set 1.394x speedup, test set 2.453x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 18.618219| train set 1.378x speedup, test set 1.856x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 19.633549| train set 1.409x speedup, test set 1.520x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 19.235086| train set 1.362x speedup, test set 1.765x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 19.281061| train set 1.400x speedup, test set 1.943x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.829832| train set 1.487x speedup, test set 2.672x speedup, val set 0.738x speedup, step: 81
Epoch 81/200 |loss: 18.597313| train set 1.304x speedup, test set 1.040x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 19.215111| train set 1.372x speedup, test set 1.083x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 18.050243| train set 1.383x speedup, test set 2.508x speedup, val set 0.931x speedup, step: 84
Epoch 84/200 |loss: 18.522327| train set 1.342x speedup, test set 1.770x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.494780| train set 1.400x speedup, test set 1.081x speedup, val set 0.998x speedup, step: 86
Epoch 86/200 |loss: 18.892502| train set 1.400x speedup, test set 1.940x speedup, val set 0.998x speedup, step: 87
Epoch 87/200 |loss: 17.640987| train set 1.359x speedup, test set 1.940x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 19.354971| train set 1.465x speedup, test set 1.293x speedup, val set 0.701x speedup, step: 89
Epoch 89/200 |loss: 19.386759| train set 1.342x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 18.808014| train set 1.329x speedup, test set 1.771x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 18.679956| train set 1.381x speedup, test set 2.708x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 18.054779| train set 1.409x speedup, test set 2.204x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 18.158592| train set 1.398x speedup, test set 1.082x speedup, val set 0.998x speedup, step: 94
Epoch 94/200 |loss: 17.478874| train set 1.408x speedup, test set 1.083x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 17.765575| train set 1.415x speedup, test set 1.115x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.093056| train set 1.368x speedup, test set 1.354x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.467548| train set 1.415x speedup, test set 1.901x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.854042| train set 1.415x speedup, test set 1.940x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.861513| train set 1.399x speedup, test set 1.076x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.706972| train set 1.411x speedup, test set 1.082x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.522236| train set 1.418x speedup, test set 2.084x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.368076| train set 1.416x speedup, test set 2.084x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.191988| train set 1.400x speedup, test set 1.048x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.189394| train set 1.414x speedup, test set 1.077x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 15.844427| train set 1.479x speedup, test set 2.495x speedup, val set 0.738x speedup, step: 2
Epoch 106/200 |loss: 16.091991| train set 1.429x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.327980| train set 1.416x speedup, test set 1.114x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 17.008713| train set 1.380x speedup, test set 1.852x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 16.715425| train set 1.468x speedup, test set 1.553x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 16.552658| train set 1.399x speedup, test set 1.042x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 15.705140| train set 1.406x speedup, test set 2.074x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.898746| train set 1.413x speedup, test set 1.142x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.938810| train set 1.415x speedup, test set 1.065x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.349586| train set 1.422x speedup, test set 1.116x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 15.274491| train set 1.413x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 15.700436| train set 1.416x speedup, test set 1.909x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 15.448381| train set 1.506x speedup, test set 2.277x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 15.075356| train set 1.415x speedup, test set 1.052x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 15.077490| train set 1.414x speedup, test set 1.080x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 14.897258| train set 1.504x speedup, test set 1.084x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 14.746694| train set 1.414x speedup, test set 1.044x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 14.554954| train set 1.502x speedup, test set 2.348x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 15.348009| train set 1.451x speedup, test set 1.043x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 16.316242| train set 1.473x speedup, test set 1.309x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 19.627779| train set 1.334x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 16.428507| train set 1.352x speedup, test set 1.837x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 17.612597| train set 1.400x speedup, test set 3.001x speedup, val set 0.738x speedup, step: 2
Epoch 128/200 |loss: 19.104088| train set 1.370x speedup, test set 1.017x speedup, val set 0.997x speedup, step: 1
Epoch 129/200 |loss: 18.405182| train set 1.390x speedup, test set 1.021x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 17.954147| train set 1.424x speedup, test set 1.072x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 17.013865| train set 1.465x speedup, test set 1.065x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 15.848304| train set 1.389x speedup, test set 1.932x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 16.660349| train set 1.450x speedup, test set 1.932x speedup, val set 0.997x speedup, step: 1
Epoch 134/200 |loss: 15.605284| train set 1.447x speedup, test set 1.932x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 15.920512| train set 1.500x speedup, test set 1.992x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 15.280843| train set 1.417x speedup, test set 1.837x speedup, val set 0.997x speedup, step: 1
Epoch 137/200 |loss: 15.318982| train set 1.446x speedup, test set 1.044x speedup, val set 0.997x speedup, step: 1
Epoch 138/200 |loss: 14.935701| train set 1.502x speedup, test set 1.949x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 14.813336| train set 1.449x speedup, test set 1.086x speedup, val set 0.997x speedup, step: 1
Epoch 140/200 |loss: 14.553620| train set 1.426x speedup, test set 1.049x speedup, val set 0.997x speedup, step: 1
Epoch 141/200 |loss: 14.332878| train set 1.390x speedup, test set 1.949x speedup, val set 0.997x speedup, step: 1
Epoch 142/200 |loss: 14.438566| train set 1.472x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 1
Epoch 143/200 |loss: 13.993594| train set 1.472x speedup, test set 1.084x speedup, val set 0.997x speedup, step: 1
Epoch 144/200 |loss: 14.087780| train set 1.421x speedup, test set 1.078x speedup, val set 0.997x speedup, step: 1
Epoch 145/200 |loss: 13.845802| train set 1.414x speedup, test set 1.049x speedup, val set 0.997x speedup, step: 1
Epoch 146/200 |loss: 13.837158| train set 1.453x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 1
Epoch 147/200 |loss: 13.568177| train set 1.501x speedup, test set 1.085x speedup, val set 0.997x speedup, step: 1
Epoch 148/200 |loss: 13.533137| train set 1.422x speedup, test set 1.055x speedup, val set 0.997x speedup, step: 1
Epoch 149/200 |loss: 13.374058| train set 1.474x speedup, test set 1.073x speedup, val set 0.997x speedup, step: 1
Epoch 150/200 |loss: 13.358068| train set 1.472x speedup, test set 1.078x speedup, val set 0.997x speedup, step: 1
Epoch 151/200 |loss: 13.115538| train set 1.502x speedup, test set 1.085x speedup, val set 0.997x speedup, step: 1
Epoch 152/200 |loss: 13.085518| train set 1.507x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 1
Epoch 153/200 |loss: 13.002772| train set 1.544x speedup, test set 1.078x speedup, val set 0.997x speedup, step: 1
Epoch 154/200 |loss: 13.034288| train set 1.506x speedup, test set 1.948x speedup, val set 0.997x speedup, step: 1
Epoch 155/200 |loss: 13.070248| train set 1.534x speedup, test set 1.058x speedup, val set 0.997x speedup, step: 1
Epoch 156/200 |loss: 13.422620| train set 1.482x speedup, test set 2.195x speedup, val set 0.997x speedup, step: 1
Epoch 157/200 |loss: 13.484883| train set 1.531x speedup, test set 1.059x speedup, val set 0.997x speedup, step: 1
Epoch 158/200 |loss: 13.733791| train set 1.493x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 1
Epoch 159/200 |loss: 12.778678| train set 1.488x speedup, test set 1.080x speedup, val set 0.997x speedup, step: 1
Epoch 160/200 |loss: 12.481616| train set 1.496x speedup, test set 1.090x speedup, val set 0.997x speedup, step: 1
Epoch 161/200 |loss: 12.680794| train set 1.524x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 1
Epoch 162/200 |loss: 12.846337| train set 1.449x speedup, test set 1.060x speedup, val set 1.008x speedup, step: 1
Epoch 163/200 |loss: 12.877807| train set 1.513x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 2
Epoch 164/200 |loss: 12.452564| train set 1.541x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 3
Epoch 165/200 |loss: 12.221459| train set 1.534x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 4
Epoch 166/200 |loss: 12.179804| train set 1.493x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 5
Epoch 167/200 |loss: 12.440674| train set 1.537x speedup, test set 1.059x speedup, val set 1.008x speedup, step: 1
Epoch 168/200 |loss: 13.037221| train set 1.538x speedup, test set 1.200x speedup, val set 0.997x speedup, step: 2
Epoch 169/200 |loss: 14.237064| train set 1.406x speedup, test set 1.793x speedup, val set 0.997x speedup, step: 3
Epoch 170/200 |loss: 16.528353| train set 1.497x speedup, test set 1.087x speedup, val set 0.997x speedup, step: 4
Epoch 171/200 |loss: 19.088701| train set 1.389x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 5
Epoch 172/200 |loss: 14.805571| train set 1.409x speedup, test set 1.833x speedup, val set 0.997x speedup, step: 6
Epoch 173/200 |loss: 17.724232| train set 1.502x speedup, test set 1.932x speedup, val set 0.997x speedup, step: 7
Epoch 174/200 |loss: 14.037911| train set 1.520x speedup, test set 1.087x speedup, val set 0.997x speedup, step: 8
Epoch 175/200 |loss: 15.471315| train set 1.381x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 9
Epoch 176/200 |loss: 14.705456| train set 1.513x speedup, test set 1.932x speedup, val set 0.992x speedup, step: 10
Epoch 177/200 |loss: 14.469136| train set 1.523x speedup, test set 1.929x speedup, val set 0.997x speedup, step: 11
Epoch 178/200 |loss: 14.033175| train set 1.506x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 12
Epoch 179/200 |loss: 14.254723| train set 1.498x speedup, test set 1.067x speedup, val set 0.997x speedup, step: 13
Epoch 180/200 |loss: 13.748316| train set 1.499x speedup, test set 1.909x speedup, val set 0.997x speedup, step: 14
Epoch 181/200 |loss: 13.480942| train set 1.520x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 15
Epoch 182/200 |loss: 13.505523| train set 1.502x speedup, test set 1.081x speedup, val set 0.997x speedup, step: 16
Epoch 183/200 |loss: 13.182108| train set 1.502x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 17
Epoch 184/200 |loss: 13.160074| train set 1.539x speedup, test set 1.029x speedup, val set 0.997x speedup, step: 18
Epoch 185/200 |loss: 12.877625| train set 1.558x speedup, test set 1.991x speedup, val set 0.997x speedup, step: 19
Epoch 186/200 |loss: 12.955408| train set 1.561x speedup, test set 1.071x speedup, val set 0.997x speedup, step: 20
Epoch 187/200 |loss: 12.689563| train set 1.499x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 21
Epoch 188/200 |loss: 12.483174| train set 1.494x speedup, test set 1.055x speedup, val set 0.997x speedup, step: 22
Epoch 189/200 |loss: 12.446893| train set 1.537x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 23
Epoch 190/200 |loss: 12.307732| train set 1.525x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 24
Epoch 191/200 |loss: 12.246984| train set 1.520x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 25
Epoch 192/200 |loss: 12.005838| train set 1.527x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 26
Epoch 193/200 |loss: 12.078070| train set 1.525x speedup, test set 1.952x speedup, val set 0.997x speedup, step: 27
Epoch 194/200 |loss: 11.934019| train set 1.503x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 28
Epoch 195/200 |loss: 11.942791| train set 1.525x speedup, test set 1.855x speedup, val set 0.997x speedup, step: 29
Epoch 196/200 |loss: 11.775635| train set 1.533x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 30
Epoch 197/200 |loss: 11.706104| train set 1.502x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 31
Epoch 198/200 |loss: 11.597342| train set 1.525x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 32
Epoch 199/200 |loss: 11.507892| train set 1.563x speedup, test set 1.054x speedup, val set 0.997x speedup, step: 33
Training per epoch cost 0.324 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 199, train speedup 1.563, test speedup 1.054, val speedup 0.997
best test speedup epoch: 127, train speedup 1.400, test speedup 3.001, val speedup 0.738
best validation speedup epoch: 167, train speedup 1.537, test speedup 1.059, val speedup 1.008
last model at epoch 199, train speedup 1.563, test speedup 1.054, val speedup 0.997
execution cost 0:02:47.408530
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.435611, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091705| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809982| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.533436| train set 1.131x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.277758| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.015848| train set 1.153x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.785669| train set 1.192x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.561661| train set 1.173x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.386831| train set 1.238x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.174200| train set 1.218x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.921131| train set 1.206x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.652721| train set 1.207x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.461216| train set 1.204x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.326130| train set 1.223x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.122568| train set 1.182x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.889509| train set 1.186x speedup, test set 1.026x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.667456| train set 1.201x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.575048| train set 1.195x speedup, test set 1.051x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.466209| train set 1.167x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.204910| train set 1.179x speedup, test set 1.027x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 24.929167| train set 1.163x speedup, test set 1.039x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.806116| train set 1.197x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.772289| train set 1.180x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.468958| train set 1.169x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.303417| train set 1.226x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.265907| train set 1.205x speedup, test set 1.048x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 23.798553| train set 1.183x speedup, test set 1.056x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.629498| train set 1.227x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.694300| train set 1.296x speedup, test set 1.031x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.454321| train set 1.242x speedup, test set 1.066x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.175634| train set 1.201x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.439348| train set 1.252x speedup, test set 2.104x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.643887| train set 1.232x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 23.216909| train set 1.232x speedup, test set 1.041x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 22.804167| train set 1.256x speedup, test set 1.963x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.857834| train set 1.232x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.294220| train set 1.232x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.378637| train set 1.274x speedup, test set 1.923x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.406448| train set 1.320x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 21.911865| train set 1.232x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.272287| train set 1.322x speedup, test set 1.832x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 21.479671| train set 1.267x speedup, test set 1.912x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.488834| train set 1.311x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.370779| train set 1.328x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 20.992243| train set 1.323x speedup, test set 1.969x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.225988| train set 1.328x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.474249| train set 1.320x speedup, test set 1.757x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.932453| train set 1.322x speedup, test set 1.817x speedup, val set 0.930x speedup, step: 57
Epoch 57/200 |loss: 22.525616| train set 1.238x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.945856| train set 1.222x speedup, test set 1.772x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 21.670715| train set 1.343x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 21.234449| train set 1.343x speedup, test set 1.845x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.630136| train set 1.325x speedup, test set 1.885x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 21.381176| train set 1.313x speedup, test set 1.841x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.515118| train set 1.374x speedup, test set 1.800x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.524385| train set 1.344x speedup, test set 1.954x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.132641| train set 1.306x speedup, test set 1.799x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.007437| train set 1.378x speedup, test set 1.954x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 19.815290| train set 1.392x speedup, test set 1.954x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.552311| train set 1.332x speedup, test set 1.799x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.582991| train set 1.384x speedup, test set 1.922x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 19.302740| train set 1.379x speedup, test set 1.954x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.601072| train set 1.379x speedup, test set 1.875x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.394350| train set 1.345x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.445587| train set 1.477x speedup, test set 2.250x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 18.709549| train set 1.385x speedup, test set 2.298x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 18.661705| train set 1.332x speedup, test set 1.071x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 18.699259| train set 1.399x speedup, test set 2.339x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.344688| train set 1.399x speedup, test set 2.275x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.261051| train set 1.389x speedup, test set 1.975x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 17.998850| train set 1.380x speedup, test set 1.880x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 17.780518| train set 1.476x speedup, test set 2.778x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 17.904165| train set 1.395x speedup, test set 1.975x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.315041| train set 1.415x speedup, test set 1.197x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 20.160469| train set 1.339x speedup, test set 1.803x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.369871| train set 1.342x speedup, test set 2.550x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.453295| train set 1.312x speedup, test set 1.061x speedup, val set 1.008x speedup, step: 86
Epoch 86/200 |loss: 20.746191| train set 1.461x speedup, test set 1.220x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.777647| train set 1.354x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 19.512880| train set 1.401x speedup, test set 1.194x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 19.896654| train set 1.463x speedup, test set 2.713x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 18.480179| train set 1.360x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 19.755087| train set 1.407x speedup, test set 1.875x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.765142| train set 1.414x speedup, test set 1.083x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 18.719660| train set 1.400x speedup, test set 1.884x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.172554| train set 1.359x speedup, test set 2.225x speedup, val set 0.992x speedup, step: 95
Epoch 95/200 |loss: 18.366762| train set 1.495x speedup, test set 2.529x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.467422| train set 1.373x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.540253| train set 1.389x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.949068| train set 1.475x speedup, test set 1.229x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.111128| train set 1.441x speedup, test set 1.089x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.771105| train set 1.417x speedup, test set 1.084x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.547638| train set 1.414x speedup, test set 2.325x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.528385| train set 1.414x speedup, test set 1.186x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.219452| train set 1.414x speedup, test set 1.195x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.280542| train set 1.410x speedup, test set 2.325x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 15.869796| train set 1.418x speedup, test set 2.332x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 15.879559| train set 1.431x speedup, test set 2.084x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 15.830363| train set 1.508x speedup, test set 2.331x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 15.644174| train set 1.416x speedup, test set 1.860x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 15.904946| train set 1.471x speedup, test set 2.486x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 16.237865| train set 1.371x speedup, test set 1.035x speedup, val set 1.008x speedup, step: 1
Epoch 111/200 |loss: 16.763803| train set 1.462x speedup, test set 2.720x speedup, val set 0.994x speedup, step: 2
Epoch 112/200 |loss: 16.300776| train set 1.397x speedup, test set 1.039x speedup, val set 0.997x speedup, step: 3
Epoch 113/200 |loss: 15.702730| train set 1.417x speedup, test set 1.127x speedup, val set 0.997x speedup, step: 4
Epoch 114/200 |loss: 15.318468| train set 1.426x speedup, test set 2.541x speedup, val set 0.738x speedup, step: 5
Epoch 115/200 |loss: 15.863093| train set 1.448x speedup, test set 1.855x speedup, val set 0.997x speedup, step: 6
Epoch 116/200 |loss: 15.410096| train set 1.416x speedup, test set 1.128x speedup, val set 0.997x speedup, step: 7
Epoch 117/200 |loss: 15.175425| train set 1.506x speedup, test set 2.346x speedup, val set 0.997x speedup, step: 8
Epoch 118/200 |loss: 15.455140| train set 1.515x speedup, test set 1.155x speedup, val set 0.997x speedup, step: 9
Epoch 119/200 |loss: 15.908108| train set 1.393x speedup, test set 1.797x speedup, val set 0.997x speedup, step: 10
Epoch 120/200 |loss: 15.941756| train set 1.502x speedup, test set 2.541x speedup, val set 0.997x speedup, step: 11
Epoch 121/200 |loss: 14.910364| train set 1.511x speedup, test set 2.074x speedup, val set 0.997x speedup, step: 12
Epoch 122/200 |loss: 14.699368| train set 1.465x speedup, test set 2.089x speedup, val set 0.997x speedup, step: 13
Epoch 123/200 |loss: 14.819739| train set 1.502x speedup, test set 2.195x speedup, val set 0.997x speedup, step: 14
Epoch 124/200 |loss: 14.582855| train set 1.542x speedup, test set 2.080x speedup, val set 0.997x speedup, step: 15
Epoch 125/200 |loss: 14.280286| train set 1.502x speedup, test set 2.346x speedup, val set 0.997x speedup, step: 16
Epoch 126/200 |loss: 14.418071| train set 1.455x speedup, test set 1.057x speedup, val set 0.997x speedup, step: 17
Epoch 127/200 |loss: 14.930244| train set 1.502x speedup, test set 1.163x speedup, val set 0.997x speedup, step: 18
Epoch 128/200 |loss: 14.989963| train set 1.428x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 19
Epoch 129/200 |loss: 14.557019| train set 1.497x speedup, test set 1.171x speedup, val set 0.997x speedup, step: 20
Epoch 130/200 |loss: 14.688733| train set 1.444x speedup, test set 1.782x speedup, val set 0.997x speedup, step: 21
Epoch 131/200 |loss: 14.471525| train set 1.538x speedup, test set 2.191x speedup, val set 0.997x speedup, step: 22
Epoch 132/200 |loss: 13.806628| train set 1.506x speedup, test set 2.118x speedup, val set 0.997x speedup, step: 23
Epoch 133/200 |loss: 13.720299| train set 1.447x speedup, test set 1.794x speedup, val set 0.997x speedup, step: 24
Epoch 134/200 |loss: 13.847611| train set 1.520x speedup, test set 2.397x speedup, val set 0.997x speedup, step: 25
Epoch 135/200 |loss: 13.926712| train set 1.537x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 26
Epoch 136/200 |loss: 14.442026| train set 1.520x speedup, test set 1.127x speedup, val set 0.997x speedup, step: 27
Epoch 137/200 |loss: 14.948030| train set 1.520x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 28
Epoch 138/200 |loss: 14.248443| train set 1.502x speedup, test set 2.084x speedup, val set 0.997x speedup, step: 29
Epoch 139/200 |loss: 13.260682| train set 1.501x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 30
Epoch 140/200 |loss: 13.552275| train set 1.534x speedup, test set 2.080x speedup, val set 0.997x speedup, step: 31
Epoch 141/200 |loss: 13.631681| train set 1.519x speedup, test set 2.191x speedup, val set 0.997x speedup, step: 32
Epoch 142/200 |loss: 13.466382| train set 1.398x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 33
Epoch 143/200 |loss: 13.914557| train set 1.537x speedup, test set 2.113x speedup, val set 0.997x speedup, step: 34
Epoch 144/200 |loss: 13.559070| train set 1.466x speedup, test set 2.080x speedup, val set 0.997x speedup, step: 35
Epoch 145/200 |loss: 13.727589| train set 1.447x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 36
Epoch 146/200 |loss: 15.651200| train set 1.505x speedup, test set 2.346x speedup, val set 0.997x speedup, step: 37
Epoch 147/200 |loss: 14.342468| train set 1.538x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 38
Epoch 148/200 |loss: 13.654256| train set 1.502x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 39
Epoch 149/200 |loss: 13.010639| train set 1.478x speedup, test set 2.079x speedup, val set 0.997x speedup, step: 40
Epoch 150/200 |loss: 13.547274| train set 1.542x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 41
Epoch 151/200 |loss: 13.781788| train set 1.506x speedup, test set 1.860x speedup, val set 0.997x speedup, step: 42
Epoch 152/200 |loss: 12.790869| train set 1.519x speedup, test set 2.207x speedup, val set 0.997x speedup, step: 43
Epoch 153/200 |loss: 12.890889| train set 1.536x speedup, test set 1.857x speedup, val set 1.008x speedup, step: 1
Epoch 154/200 |loss: 13.160589| train set 1.497x speedup, test set 2.080x speedup, val set 0.997x speedup, step: 2
Epoch 155/200 |loss: 12.844244| train set 1.471x speedup, test set 1.125x speedup, val set 0.997x speedup, step: 3
Epoch 156/200 |loss: 12.935319| train set 1.447x speedup, test set 1.794x speedup, val set 0.997x speedup, step: 4
Epoch 157/200 |loss: 13.333769| train set 1.507x speedup, test set 2.240x speedup, val set 0.997x speedup, step: 5
Epoch 158/200 |loss: 13.781847| train set 1.450x speedup, test set 1.794x speedup, val set 0.997x speedup, step: 6
Epoch 159/200 |loss: 13.586769| train set 1.538x speedup, test set 2.080x speedup, val set 0.997x speedup, step: 7
Epoch 160/200 |loss: 12.742143| train set 1.512x speedup, test set 2.191x speedup, val set 0.997x speedup, step: 8
Epoch 161/200 |loss: 12.681437| train set 1.536x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 9
Epoch 162/200 |loss: 12.843187| train set 1.501x speedup, test set 1.152x speedup, val set 0.997x speedup, step: 10
Epoch 163/200 |loss: 12.984791| train set 1.546x speedup, test set 2.080x speedup, val set 0.997x speedup, step: 11
Epoch 164/200 |loss: 12.598685| train set 1.538x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 12
Epoch 165/200 |loss: 12.487077| train set 1.492x speedup, test set 2.202x speedup, val set 0.997x speedup, step: 13
Epoch 166/200 |loss: 12.392936| train set 1.547x speedup, test set 2.080x speedup, val set 0.997x speedup, step: 14
Epoch 167/200 |loss: 12.348575| train set 1.558x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 15
Epoch 168/200 |loss: 12.535404| train set 1.524x speedup, test set 2.079x speedup, val set 0.997x speedup, step: 16
Epoch 169/200 |loss: 12.345453| train set 1.519x speedup, test set 2.252x speedup, val set 0.997x speedup, step: 17
Epoch 170/200 |loss: 12.530798| train set 1.492x speedup, test set 1.860x speedup, val set 0.997x speedup, step: 18
Epoch 171/200 |loss: 12.262550| train set 1.538x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 19
Epoch 172/200 |loss: 12.000742| train set 1.563x speedup, test set 2.080x speedup, val set 0.997x speedup, step: 20
Epoch 173/200 |loss: 11.848416| train set 1.557x speedup, test set 2.080x speedup, val set 0.997x speedup, step: 21
Epoch 174/200 |loss: 11.713997| train set 1.552x speedup, test set 1.118x speedup, val set 0.997x speedup, step: 22
Epoch 175/200 |loss: 11.723063| train set 1.557x speedup, test set 2.079x speedup, val set 0.997x speedup, step: 23
Epoch 176/200 |loss: 12.010746| train set 1.540x speedup, test set 1.118x speedup, val set 0.997x speedup, step: 24
Epoch 177/200 |loss: 12.690924| train set 1.547x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 25
Epoch 178/200 |loss: 12.859509| train set 1.537x speedup, test set 1.173x speedup, val set 0.997x speedup, step: 26
Epoch 179/200 |loss: 13.342035| train set 1.519x speedup, test set 2.079x speedup, val set 0.997x speedup, step: 27
Epoch 180/200 |loss: 11.821955| train set 1.563x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 28
Epoch 181/200 |loss: 11.809587| train set 1.545x speedup, test set 1.152x speedup, val set 0.997x speedup, step: 29
Epoch 182/200 |loss: 12.979098| train set 1.545x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 30
Epoch 183/200 |loss: 11.843800| train set 1.524x speedup, test set 2.079x speedup, val set 0.997x speedup, step: 31
Epoch 184/200 |loss: 12.199361| train set 1.536x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 32
Epoch 185/200 |loss: 13.369776| train set 1.471x speedup, test set 2.083x speedup, val set 0.997x speedup, step: 33
Epoch 186/200 |loss: 12.020034| train set 1.560x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 34
Epoch 187/200 |loss: 12.398431| train set 1.501x speedup, test set 1.125x speedup, val set 0.997x speedup, step: 35
Epoch 188/200 |loss: 13.977909| train set 1.562x speedup, test set 2.123x speedup, val set 0.997x speedup, step: 36
Epoch 189/200 |loss: 11.601473| train set 1.541x speedup, test set 1.856x speedup, val set 0.997x speedup, step: 37
Epoch 190/200 |loss: 15.314510| train set 1.519x speedup, test set 1.162x speedup, val set 0.997x speedup, step: 38
Epoch 191/200 |loss: 16.041157| train set 1.410x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 39
Epoch 192/200 |loss: 14.671028| train set 1.486x speedup, test set 2.120x speedup, val set 0.996x speedup, step: 40
Epoch 193/200 |loss: 15.227283| train set 1.518x speedup, test set 1.993x speedup, val set 0.997x speedup, step: 41
Epoch 194/200 |loss: 14.045068| train set 1.501x speedup, test set 1.052x speedup, val set 0.997x speedup, step: 42
Epoch 195/200 |loss: 14.550414| train set 1.472x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 43
Epoch 196/200 |loss: 13.361115| train set 1.407x speedup, test set 1.907x speedup, val set 1.008x speedup, step: 1
Epoch 197/200 |loss: 13.892648| train set 1.472x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 2
Epoch 198/200 |loss: 13.283362| train set 1.558x speedup, test set 1.067x speedup, val set 0.997x speedup, step: 3
Epoch 199/200 |loss: 13.363642| train set 1.538x speedup, test set 1.062x speedup, val set 0.997x speedup, step: 4
Training per epoch cost 0.317 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 3.136s, pg runtime 5.620s, speedup 1.792x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 172, train speedup 1.563, test speedup 2.080, val speedup 0.997
best test speedup epoch: 80, train speedup 1.476, test speedup 2.778, val speedup 0.997
best validation speedup epoch: 196, train speedup 1.407, test speedup 1.907, val speedup 1.008
last model at epoch 199, train speedup 1.538, test speedup 1.062, val speedup 0.997
execution cost 0:02:47.229098
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.441046, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474543| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443678| train set 0.789x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083920| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698151| train set 1.100x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091860| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.810118| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.532669| train set 1.143x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.275583| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.015404| train set 1.153x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.787109| train set 1.192x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.559275| train set 1.192x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.380260| train set 1.238x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.172312| train set 1.218x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.925013| train set 1.200x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.655796| train set 1.227x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.460407| train set 1.203x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.316339| train set 1.223x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.121685| train set 1.182x speedup, test set 1.028x speedup, val set 0.932x speedup, step: 24
Epoch 24/200 |loss: 25.881550| train set 1.186x speedup, test set 1.027x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.670460| train set 1.200x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.600414| train set 1.188x speedup, test set 1.050x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.416796| train set 1.166x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.187540| train set 1.179x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 29
Epoch 29/200 |loss: 25.140799| train set 1.165x speedup, test set 1.016x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.975449| train set 1.199x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.630884| train set 1.179x speedup, test set 1.026x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.455614| train set 1.189x speedup, test set 1.025x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.550461| train set 1.200x speedup, test set 1.041x speedup, val set 0.930x speedup, step: 34
Epoch 34/200 |loss: 24.276974| train set 1.226x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 35
Epoch 35/200 |loss: 24.021704| train set 1.228x speedup, test set 1.857x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.950865| train set 1.229x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.554373| train set 1.229x speedup, test set 1.007x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.447493| train set 1.241x speedup, test set 1.048x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.373857| train set 1.231x speedup, test set 1.041x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.200937| train set 1.277x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.218042| train set 1.305x speedup, test set 1.757x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.477690| train set 1.262x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 23.030102| train set 1.232x speedup, test set 1.734x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.900309| train set 1.307x speedup, test set 1.791x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.738306| train set 1.315x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.714075| train set 1.231x speedup, test set 1.018x speedup, val set 0.999x speedup, step: 47
Epoch 47/200 |loss: 22.805338| train set 1.292x speedup, test set 1.745x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.164923| train set 1.308x speedup, test set 1.860x speedup, val set 0.930x speedup, step: 49
Epoch 49/200 |loss: 22.681124| train set 1.312x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 21.951822| train set 1.327x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 22.120779| train set 1.328x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.407707| train set 1.378x speedup, test set 1.903x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.721733| train set 1.330x speedup, test set 1.837x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.048414| train set 1.250x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.304121| train set 1.331x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 20.757229| train set 1.379x speedup, test set 1.939x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.848509| train set 1.328x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.556362| train set 1.343x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.977942| train set 1.328x speedup, test set 1.741x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 21.573061| train set 1.404x speedup, test set 2.435x speedup, val set 0.739x speedup, step: 61
Epoch 61/200 |loss: 22.483208| train set 1.251x speedup, test set 1.003x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.584652| train set 1.294x speedup, test set 1.741x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 22.094400| train set 1.344x speedup, test set 1.029x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 21.528557| train set 1.392x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.697241| train set 1.327x speedup, test set 1.777x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 21.273970| train set 1.328x speedup, test set 1.741x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 20.064121| train set 1.414x speedup, test set 1.191x speedup, val set 0.701x speedup, step: 68
Epoch 68/200 |loss: 21.059013| train set 1.331x speedup, test set 1.012x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.562664| train set 1.386x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 20.282215| train set 1.378x speedup, test set 1.726x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.501785| train set 1.399x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.566845| train set 1.385x speedup, test set 1.726x speedup, val set 0.998x speedup, step: 73
Epoch 73/200 |loss: 19.228668| train set 1.395x speedup, test set 1.726x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 19.184540| train set 1.399x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 19.187637| train set 1.385x speedup, test set 1.800x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 18.661633| train set 1.332x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.965319| train set 1.400x speedup, test set 1.896x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.542633| train set 1.394x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.642803| train set 1.369x speedup, test set 2.221x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.785025| train set 1.412x speedup, test set 1.046x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.504932| train set 1.477x speedup, test set 2.258x speedup, val set 0.738x speedup, step: 82
Epoch 82/200 |loss: 18.094894| train set 1.397x speedup, test set 1.825x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 17.883648| train set 1.395x speedup, test set 1.022x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 17.838812| train set 1.416x speedup, test set 2.404x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.961683| train set 1.406x speedup, test set 1.884x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.255201| train set 1.385x speedup, test set 2.173x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.954296| train set 1.395x speedup, test set 1.821x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.369560| train set 1.369x speedup, test set 1.821x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 17.103401| train set 1.519x speedup, test set 2.360x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.275682| train set 1.427x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.437695| train set 1.401x speedup, test set 1.861x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 16.897013| train set 1.416x speedup, test set 2.124x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 16.718775| train set 1.414x speedup, test set 1.045x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 16.895327| train set 1.416x speedup, test set 2.214x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 16.699486| train set 1.448x speedup, test set 1.045x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 16.646395| train set 1.397x speedup, test set 1.861x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.256712| train set 1.430x speedup, test set 1.145x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 20.218494| train set 1.420x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.682671| train set 1.401x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.765373| train set 1.461x speedup, test set 1.182x speedup, val set 0.738x speedup, step: 101
Epoch 101/200 |loss: 18.885439| train set 1.373x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.326027| train set 1.343x speedup, test set 1.860x speedup, val set 0.996x speedup, step: 2
Epoch 103/200 |loss: 18.442158| train set 1.434x speedup, test set 1.031x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 18.570934| train set 1.512x speedup, test set 1.161x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 17.812414| train set 1.399x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 17.977015| train set 1.396x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 17.241882| train set 1.495x speedup, test set 1.948x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.722118| train set 1.448x speedup, test set 1.745x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 16.706272| train set 1.431x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 16.400766| train set 1.415x speedup, test set 1.900x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 16.142742| train set 1.495x speedup, test set 2.251x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 16.098055| train set 1.449x speedup, test set 2.118x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.735500| train set 1.451x speedup, test set 1.859x speedup, val set 1.008x speedup, step: 1
Epoch 114/200 |loss: 15.882560| train set 1.389x speedup, test set 1.059x speedup, val set 0.997x speedup, step: 2
Epoch 115/200 |loss: 15.390409| train set 1.472x speedup, test set 1.056x speedup, val set 0.997x speedup, step: 3
Epoch 116/200 |loss: 15.779293| train set 1.502x speedup, test set 2.074x speedup, val set 0.997x speedup, step: 4
Epoch 117/200 |loss: 15.078119| train set 1.436x speedup, test set 1.859x speedup, val set 0.997x speedup, step: 5
Epoch 118/200 |loss: 15.384619| train set 1.416x speedup, test set 2.089x speedup, val set 0.997x speedup, step: 6
Epoch 119/200 |loss: 14.821196| train set 1.416x speedup, test set 1.089x speedup, val set 0.997x speedup, step: 7
Epoch 120/200 |loss: 15.053177| train set 1.495x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 8
Epoch 121/200 |loss: 14.720830| train set 1.420x speedup, test set 1.860x speedup, val set 1.008x speedup, step: 1
Epoch 122/200 |loss: 14.679031| train set 1.502x speedup, test set 2.074x speedup, val set 0.997x speedup, step: 2
Epoch 123/200 |loss: 14.627439| train set 1.450x speedup, test set 1.860x speedup, val set 0.997x speedup, step: 3
Epoch 124/200 |loss: 14.464198| train set 1.506x speedup, test set 2.195x speedup, val set 0.997x speedup, step: 4
Epoch 125/200 |loss: 14.739404| train set 1.451x speedup, test set 1.051x speedup, val set 1.008x speedup, step: 1
Epoch 126/200 |loss: 14.784436| train set 1.502x speedup, test set 2.195x speedup, val set 0.997x speedup, step: 2
Epoch 127/200 |loss: 15.489856| train set 1.441x speedup, test set 1.870x speedup, val set 0.997x speedup, step: 3
Epoch 128/200 |loss: 15.388601| train set 1.470x speedup, test set 1.083x speedup, val set 0.997x speedup, step: 4
Epoch 129/200 |loss: 15.200386| train set 1.471x speedup, test set 2.251x speedup, val set 0.997x speedup, step: 5
Epoch 130/200 |loss: 14.620358| train set 1.447x speedup, test set 1.857x speedup, val set 1.008x speedup, step: 1
Epoch 131/200 |loss: 14.867518| train set 1.501x speedup, test set 2.195x speedup, val set 0.997x speedup, step: 2
Epoch 132/200 |loss: 14.956677| train set 1.388x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 3
Epoch 133/200 |loss: 14.229277| train set 1.448x speedup, test set 1.860x speedup, val set 0.997x speedup, step: 4
Epoch 134/200 |loss: 14.130265| train set 1.518x speedup, test set 2.195x speedup, val set 0.997x speedup, step: 5
Epoch 135/200 |loss: 14.814415| train set 1.449x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 6
Epoch 136/200 |loss: 13.993412| train set 1.503x speedup, test set 2.256x speedup, val set 0.997x speedup, step: 7
Epoch 137/200 |loss: 13.885143| train set 1.431x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 8
Epoch 138/200 |loss: 13.919369| train set 1.457x speedup, test set 1.055x speedup, val set 0.997x speedup, step: 9
Epoch 139/200 |loss: 13.920537| train set 1.478x speedup, test set 2.244x speedup, val set 0.997x speedup, step: 10
Epoch 140/200 |loss: 13.570733| train set 1.425x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 11
Epoch 141/200 |loss: 13.558787| train set 1.555x speedup, test set 2.126x speedup, val set 0.997x speedup, step: 12
Epoch 142/200 |loss: 13.494813| train set 1.518x speedup, test set 2.201x speedup, val set 0.997x speedup, step: 13
Epoch 143/200 |loss: 13.351204| train set 1.415x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 14
Epoch 144/200 |loss: 13.313635| train set 1.466x speedup, test set 2.242x speedup, val set 0.997x speedup, step: 15
Epoch 145/200 |loss: 13.791112| train set 1.489x speedup, test set 2.001x speedup, val set 0.996x speedup, step: 16
Epoch 146/200 |loss: 13.890270| train set 1.532x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 17
Epoch 147/200 |loss: 16.282742| train set 1.461x speedup, test set 2.240x speedup, val set 0.996x speedup, step: 18
Epoch 148/200 |loss: 14.080334| train set 1.535x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 19
Epoch 149/200 |loss: 13.231258| train set 1.557x speedup, test set 1.087x speedup, val set 0.997x speedup, step: 20
Epoch 150/200 |loss: 14.014556| train set 1.536x speedup, test set 2.240x speedup, val set 0.997x speedup, step: 21
Epoch 151/200 |loss: 12.968057| train set 1.536x speedup, test set 1.857x speedup, val set 0.997x speedup, step: 22
Epoch 152/200 |loss: 13.138953| train set 1.389x speedup, test set 1.086x speedup, val set 0.997x speedup, step: 23
Epoch 153/200 |loss: 13.524600| train set 1.527x speedup, test set 2.252x speedup, val set 0.997x speedup, step: 24
Epoch 154/200 |loss: 12.743664| train set 1.538x speedup, test set 1.857x speedup, val set 1.008x speedup, step: 1
Epoch 155/200 |loss: 13.329791| train set 1.501x speedup, test set 1.962x speedup, val set 0.997x speedup, step: 2
Epoch 156/200 |loss: 14.201114| train set 1.539x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 3
Epoch 157/200 |loss: 12.701969| train set 1.538x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 4
Epoch 158/200 |loss: 13.574723| train set 1.514x speedup, test set 1.161x speedup, val set 0.997x speedup, step: 5
Epoch 159/200 |loss: 14.410909| train set 1.501x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 6
Epoch 160/200 |loss: 12.976368| train set 1.516x speedup, test set 1.957x speedup, val set 0.996x speedup, step: 7
Epoch 161/200 |loss: 15.099015| train set 1.556x speedup, test set 2.207x speedup, val set 0.997x speedup, step: 8
Epoch 162/200 |loss: 14.917249| train set 1.388x speedup, test set 1.882x speedup, val set 0.997x speedup, step: 9
Epoch 163/200 |loss: 14.369960| train set 1.504x speedup, test set 1.957x speedup, val set 0.997x speedup, step: 10
Epoch 164/200 |loss: 14.306413| train set 1.534x speedup, test set 2.252x speedup, val set 0.997x speedup, step: 11
Epoch 165/200 |loss: 13.661173| train set 1.471x speedup, test set 1.089x speedup, val set 0.997x speedup, step: 12
Epoch 166/200 |loss: 14.223946| train set 1.429x speedup, test set 1.063x speedup, val set 0.997x speedup, step: 13
Epoch 167/200 |loss: 13.480625| train set 1.545x speedup, test set 1.996x speedup, val set 0.997x speedup, step: 14
Epoch 168/200 |loss: 13.398609| train set 1.561x speedup, test set 1.996x speedup, val set 0.997x speedup, step: 15
Epoch 169/200 |loss: 13.016716| train set 1.487x speedup, test set 1.087x speedup, val set 0.997x speedup, step: 16
Epoch 170/200 |loss: 13.015564| train set 1.519x speedup, test set 1.957x speedup, val set 0.997x speedup, step: 17
Epoch 171/200 |loss: 12.721752| train set 1.556x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 18
Epoch 172/200 |loss: 12.751900| train set 1.559x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 19
Epoch 173/200 |loss: 12.686043| train set 1.519x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 20
Epoch 174/200 |loss: 12.284824| train set 1.564x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 21
Epoch 175/200 |loss: 12.573067| train set 1.523x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 22
Epoch 176/200 |loss: 12.180297| train set 1.575x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 23
Epoch 177/200 |loss: 12.167676| train set 1.555x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 24
Epoch 178/200 |loss: 12.059980| train set 1.513x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 25
Epoch 179/200 |loss: 11.906177| train set 1.526x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 26
Epoch 180/200 |loss: 11.913803| train set 1.556x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 27
Epoch 181/200 |loss: 11.744201| train set 1.537x speedup, test set 1.957x speedup, val set 0.997x speedup, step: 28
Epoch 182/200 |loss: 11.749807| train set 1.527x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 29
Epoch 183/200 |loss: 11.904016| train set 1.477x speedup, test set 2.207x speedup, val set 0.997x speedup, step: 30
Epoch 184/200 |loss: 12.225099| train set 1.539x speedup, test set 1.059x speedup, val set 1.008x speedup, step: 1
Epoch 185/200 |loss: 13.122176| train set 1.489x speedup, test set 1.962x speedup, val set 0.996x speedup, step: 2
Epoch 186/200 |loss: 13.439104| train set 1.541x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 3
Epoch 187/200 |loss: 12.096828| train set 1.556x speedup, test set 1.870x speedup, val set 0.997x speedup, step: 4
Epoch 188/200 |loss: 11.887700| train set 1.525x speedup, test set 2.011x speedup, val set 0.996x speedup, step: 5
Epoch 189/200 |loss: 12.718554| train set 1.541x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 6
Epoch 190/200 |loss: 12.106360| train set 1.540x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 7
Epoch 191/200 |loss: 11.788614| train set 1.537x speedup, test set 2.011x speedup, val set 0.997x speedup, step: 8
Epoch 192/200 |loss: 12.341133| train set 1.430x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 9
Epoch 193/200 |loss: 12.130143| train set 1.501x speedup, test set 2.011x speedup, val set 0.997x speedup, step: 10
Epoch 194/200 |loss: 11.837193| train set 1.519x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 11
Epoch 195/200 |loss: 12.032515| train set 1.515x speedup, test set 1.968x speedup, val set 0.997x speedup, step: 12
Epoch 196/200 |loss: 11.799177| train set 1.489x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 13
Epoch 197/200 |loss: 11.582906| train set 1.488x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 14
Epoch 198/200 |loss: 11.695344| train set 1.512x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 15
Epoch 199/200 |loss: 11.383305| train set 1.557x speedup, test set 2.011x speedup, val set 0.997x speedup, step: 16
Training per epoch cost 0.324 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 58.779s, pg runtime 57.198s, speedup 0.973x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 176, train speedup 1.575, test speedup 1.972, val speedup 0.997
best test speedup epoch: 60, train speedup 1.404, test speedup 2.435, val speedup 0.739
best validation speedup epoch: 184, train speedup 1.539, test speedup 1.059, val speedup 1.008
last model at epoch 199, train speedup 1.557, test speedup 2.011, val speedup 0.997
execution cost 0:02:47.520222
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.521467, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159264| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786829| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443676| train set 0.789x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083914| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383274| train set 1.117x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091431| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809589| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.532434| train set 1.131x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.274458| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.010870| train set 1.153x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.775280| train set 1.192x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.547525| train set 1.173x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.381472| train set 1.207x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.228470| train set 1.218x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.992237| train set 1.188x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.646578| train set 1.205x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.513306| train set 1.205x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.390316| train set 1.204x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.046968| train set 1.223x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.862633| train set 1.196x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 25
Epoch 25/200 |loss: 25.811956| train set 1.223x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.588087| train set 1.195x speedup, test set 1.024x speedup, val set 0.932x speedup, step: 27
Epoch 27/200 |loss: 25.286236| train set 1.183x speedup, test set 1.023x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.250053| train set 1.190x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.237183| train set 1.183x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.972277| train set 1.178x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.506687| train set 1.171x speedup, test set 1.014x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.601969| train set 1.205x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.598225| train set 1.201x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 23.981136| train set 1.173x speedup, test set 1.758x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.191357| train set 1.228x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 36
Epoch 36/200 |loss: 23.991568| train set 1.224x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.488857| train set 1.226x speedup, test set 1.785x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.785259| train set 1.256x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.509439| train set 1.232x speedup, test set 1.015x speedup, val set 0.999x speedup, step: 40
Epoch 40/200 |loss: 23.641924| train set 1.256x speedup, test set 1.924x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.494080| train set 1.232x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 22.881687| train set 1.231x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.033278| train set 1.266x speedup, test set 1.757x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 22.503262| train set 1.270x speedup, test set 1.757x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.468889| train set 1.305x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.358339| train set 1.305x speedup, test set 1.770x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 21.967169| train set 1.275x speedup, test set 2.061x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.138737| train set 1.232x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 21.980995| train set 1.326x speedup, test set 1.837x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.070255| train set 1.326x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 22.005428| train set 1.345x speedup, test set 2.327x speedup, val set 0.930x speedup, step: 52
Epoch 52/200 |loss: 21.560884| train set 1.238x speedup, test set 1.695x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.675222| train set 1.328x speedup, test set 1.837x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 20.990273| train set 1.384x speedup, test set 2.327x speedup, val set 0.930x speedup, step: 55
Epoch 55/200 |loss: 21.081430| train set 1.312x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.280371| train set 1.347x speedup, test set 2.212x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 21.527596| train set 1.328x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.610813| train set 1.343x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.789913| train set 1.391x speedup, test set 2.270x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.410097| train set 1.328x speedup, test set 1.815x speedup, val set 0.998x speedup, step: 61
Epoch 61/200 |loss: 20.500862| train set 1.330x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.288296| train set 1.392x speedup, test set 2.010x speedup, val set 0.997x speedup, step: 63
Epoch 63/200 |loss: 20.115534| train set 1.329x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.199308| train set 1.392x speedup, test set 1.903x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.475298| train set 1.307x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 19.898106| train set 1.372x speedup, test set 2.010x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 19.439339| train set 1.397x speedup, test set 1.908x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.521091| train set 1.314x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.439058| train set 1.399x speedup, test set 1.918x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.242281| train set 1.386x speedup, test set 1.900x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 18.928482| train set 1.471x speedup, test set 2.442x speedup, val set 0.739x speedup, step: 72
Epoch 72/200 |loss: 19.070148| train set 1.328x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.186188| train set 1.394x speedup, test set 1.092x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.541168| train set 1.342x speedup, test set 1.969x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 19.405167| train set 1.411x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 20.174894| train set 1.447x speedup, test set 2.516x speedup, val set 0.739x speedup, step: 77
Epoch 77/200 |loss: 20.048069| train set 1.327x speedup, test set 1.012x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 19.843765| train set 1.400x speedup, test set 1.143x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 19.454548| train set 1.404x speedup, test set 2.653x speedup, val set 0.738x speedup, step: 80
Epoch 80/200 |loss: 19.695721| train set 1.338x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 20.059381| train set 1.345x speedup, test set 1.052x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 20.148933| train set 1.400x speedup, test set 1.915x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 19.018324| train set 1.370x speedup, test set 1.944x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 19.292057| train set 1.429x speedup, test set 1.181x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.565022| train set 1.399x speedup, test set 1.191x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.491983| train set 1.391x speedup, test set 1.766x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.577272| train set 1.388x speedup, test set 1.972x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.929688| train set 1.530x speedup, test set 2.371x speedup, val set 1.008x speedup, step: 89
Epoch 89/200 |loss: 18.327047| train set 1.432x speedup, test set 1.932x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.377661| train set 1.396x speedup, test set 1.861x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.906507| train set 1.396x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.242903| train set 1.501x speedup, test set 1.141x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.381716| train set 1.490x speedup, test set 2.211x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 17.069448| train set 1.369x speedup, test set 1.926x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.065907| train set 1.346x speedup, test set 1.763x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 16.719990| train set 1.494x speedup, test set 2.211x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.740070| train set 1.495x speedup, test set 2.296x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.684275| train set 1.401x speedup, test set 1.726x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.335464| train set 1.415x speedup, test set 2.214x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.463240| train set 1.434x speedup, test set 1.745x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.182974| train set 1.501x speedup, test set 2.337x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.195328| train set 1.401x speedup, test set 1.726x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 15.850880| train set 1.400x speedup, test set 1.968x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 15.725505| train set 1.374x speedup, test set 1.892x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 15.628325| train set 1.506x speedup, test set 2.264x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 15.448271| train set 1.416x speedup, test set 1.045x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 15.589384| train set 1.406x speedup, test set 1.967x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.356251| train set 1.472x speedup, test set 1.752x speedup, val set 0.738x speedup, step: 2
Epoch 109/200 |loss: 20.004890| train set 1.313x speedup, test set 1.032x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 17.296972| train set 1.345x speedup, test set 2.259x speedup, val set 0.994x speedup, step: 2
Epoch 111/200 |loss: 19.639624| train set 1.407x speedup, test set 1.073x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 20.733204| train set 1.373x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 18.674950| train set 1.384x speedup, test set 2.114x speedup, val set 0.996x speedup, step: 2
Epoch 114/200 |loss: 19.763372| train set 1.463x speedup, test set 2.416x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 18.073744| train set 1.421x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 17.430370| train set 1.382x speedup, test set 1.018x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 17.590841| train set 1.495x speedup, test set 1.976x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 17.254385| train set 1.485x speedup, test set 2.248x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 16.796844| train set 1.402x speedup, test set 1.890x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 16.849390| train set 1.431x speedup, test set 1.058x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 16.181002| train set 1.558x speedup, test set 1.160x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 16.499929| train set 1.548x speedup, test set 2.173x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 15.830505| train set 1.409x speedup, test set 1.883x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 15.900756| train set 1.411x speedup, test set 1.883x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 15.652702| train set 1.400x speedup, test set 1.853x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 15.374833| train set 1.506x speedup, test set 2.060x speedup, val set 0.997x speedup, step: 1
Epoch 127/200 |loss: 15.293280| train set 1.471x speedup, test set 2.275x speedup, val set 0.997x speedup, step: 1
Epoch 128/200 |loss: 14.988544| train set 1.389x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 129/200 |loss: 15.003696| train set 1.502x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 1
Epoch 130/200 |loss: 14.715438| train set 1.491x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 1
Epoch 131/200 |loss: 14.617007| train set 1.527x speedup, test set 1.820x speedup, val set 0.997x speedup, step: 1
Epoch 132/200 |loss: 14.429198| train set 1.491x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 1
Epoch 133/200 |loss: 14.462770| train set 1.420x speedup, test set 1.039x speedup, val set 0.997x speedup, step: 1
Epoch 134/200 |loss: 14.261300| train set 1.520x speedup, test set 1.115x speedup, val set 0.997x speedup, step: 1
Epoch 135/200 |loss: 14.441816| train set 1.447x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 1
Epoch 136/200 |loss: 14.570310| train set 1.502x speedup, test set 2.263x speedup, val set 0.997x speedup, step: 1
Epoch 137/200 |loss: 15.353173| train set 1.445x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 1
Epoch 138/200 |loss: 14.964298| train set 1.502x speedup, test set 1.173x speedup, val set 0.997x speedup, step: 1
Epoch 139/200 |loss: 14.279423| train set 1.496x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 1
Epoch 140/200 |loss: 13.743472| train set 1.545x speedup, test set 2.078x speedup, val set 0.997x speedup, step: 1
Epoch 141/200 |loss: 13.729177| train set 1.501x speedup, test set 2.257x speedup, val set 0.997x speedup, step: 1
Epoch 142/200 |loss: 13.772860| train set 1.534x speedup, test set 1.027x speedup, val set 0.997x speedup, step: 1
Epoch 143/200 |loss: 13.878616| train set 1.525x speedup, test set 2.208x speedup, val set 0.997x speedup, step: 1
Epoch 144/200 |loss: 13.796675| train set 1.534x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 145/200 |loss: 13.391561| train set 1.502x speedup, test set 2.128x speedup, val set 0.997x speedup, step: 1
Epoch 146/200 |loss: 13.191326| train set 1.530x speedup, test set 2.118x speedup, val set 0.997x speedup, step: 1
Epoch 147/200 |loss: 13.073991| train set 1.535x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 1
Epoch 148/200 |loss: 13.094592| train set 1.520x speedup, test set 2.118x speedup, val set 0.997x speedup, step: 1
Epoch 149/200 |loss: 13.320461| train set 1.530x speedup, test set 1.877x speedup, val set 1.008x speedup, step: 1
Epoch 150/200 |loss: 13.828959| train set 1.520x speedup, test set 1.169x speedup, val set 0.997x speedup, step: 2
Epoch 151/200 |loss: 14.888626| train set 1.440x speedup, test set 1.801x speedup, val set 1.008x speedup, step: 1
Epoch 152/200 |loss: 14.440327| train set 1.502x speedup, test set 2.118x speedup, val set 0.997x speedup, step: 2
Epoch 153/200 |loss: 13.319735| train set 1.502x speedup, test set 2.118x speedup, val set 0.997x speedup, step: 3
Epoch 154/200 |loss: 12.828548| train set 1.537x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 4
Epoch 155/200 |loss: 13.876156| train set 1.502x speedup, test set 1.116x speedup, val set 0.997x speedup, step: 5
Epoch 156/200 |loss: 14.542774| train set 1.504x speedup, test set 1.797x speedup, val set 0.997x speedup, step: 6
Epoch 157/200 |loss: 12.937710| train set 1.506x speedup, test set 2.110x speedup, val set 0.997x speedup, step: 7
Epoch 158/200 |loss: 14.665993| train set 1.502x speedup, test set 1.105x speedup, val set 0.997x speedup, step: 8
Epoch 159/200 |loss: 15.687671| train set 1.519x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 9
Epoch 160/200 |loss: 14.014371| train set 1.505x speedup, test set 2.110x speedup, val set 1.008x speedup, step: 1
Epoch 161/200 |loss: 15.633141| train set 1.501x speedup, test set 1.127x speedup, val set 0.997x speedup, step: 2
Epoch 162/200 |loss: 13.256535| train set 1.470x speedup, test set 1.093x speedup, val set 0.997x speedup, step: 3
Epoch 163/200 |loss: 14.283366| train set 1.537x speedup, test set 1.990x speedup, val set 0.997x speedup, step: 4
Epoch 164/200 |loss: 13.353678| train set 1.502x speedup, test set 1.859x speedup, val set 0.996x speedup, step: 5
Epoch 165/200 |loss: 14.446971| train set 1.534x speedup, test set 1.046x speedup, val set 0.997x speedup, step: 6
Epoch 166/200 |loss: 14.450075| train set 1.501x speedup, test set 1.100x speedup, val set 0.997x speedup, step: 7
Epoch 167/200 |loss: 14.092947| train set 1.554x speedup, test set 1.031x speedup, val set 0.997x speedup, step: 8
Epoch 168/200 |loss: 13.550940| train set 1.534x speedup, test set 2.111x speedup, val set 0.997x speedup, step: 9
Epoch 169/200 |loss: 13.316654| train set 1.432x speedup, test set 2.250x speedup, val set 0.997x speedup, step: 10
Epoch 170/200 |loss: 13.671551| train set 1.414x speedup, test set 1.025x speedup, val set 0.997x speedup, step: 11
Epoch 171/200 |loss: 13.115562| train set 1.499x speedup, test set 1.987x speedup, val set 0.997x speedup, step: 12
Epoch 172/200 |loss: 13.212589| train set 1.551x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 13
Epoch 173/200 |loss: 12.960097| train set 1.538x speedup, test set 1.124x speedup, val set 0.997x speedup, step: 14
Epoch 174/200 |loss: 13.608567| train set 1.520x speedup, test set 2.077x speedup, val set 0.997x speedup, step: 15
Epoch 175/200 |loss: 12.566088| train set 1.551x speedup, test set 1.783x speedup, val set 0.997x speedup, step: 16
Epoch 176/200 |loss: 13.105432| train set 1.537x speedup, test set 1.040x speedup, val set 0.997x speedup, step: 17
Epoch 177/200 |loss: 13.411056| train set 1.539x speedup, test set 1.894x speedup, val set 0.997x speedup, step: 18
Epoch 178/200 |loss: 13.173234| train set 1.555x speedup, test set 1.887x speedup, val set 0.997x speedup, step: 19
Epoch 179/200 |loss: 12.788744| train set 1.544x speedup, test set 1.117x speedup, val set 0.997x speedup, step: 20
Epoch 180/200 |loss: 12.783736| train set 1.520x speedup, test set 1.813x speedup, val set 0.997x speedup, step: 21
Epoch 181/200 |loss: 13.056650| train set 1.538x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 22
Epoch 182/200 |loss: 12.167051| train set 1.540x speedup, test set 1.162x speedup, val set 0.997x speedup, step: 23
Epoch 183/200 |loss: 12.666090| train set 1.488x speedup, test set 1.799x speedup, val set 0.997x speedup, step: 24
Epoch 184/200 |loss: 12.351754| train set 1.558x speedup, test set 1.782x speedup, val set 0.997x speedup, step: 25
Epoch 185/200 |loss: 12.342675| train set 1.543x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 26
Epoch 186/200 |loss: 11.972208| train set 1.518x speedup, test set 1.796x speedup, val set 0.997x speedup, step: 27
Epoch 187/200 |loss: 12.373542| train set 1.525x speedup, test set 2.102x speedup, val set 0.997x speedup, step: 28
Epoch 188/200 |loss: 12.346147| train set 1.524x speedup, test set 1.839x speedup, val set 0.997x speedup, step: 29
Epoch 189/200 |loss: 11.849078| train set 1.526x speedup, test set 1.991x speedup, val set 0.997x speedup, step: 30
Epoch 190/200 |loss: 12.382355| train set 1.540x speedup, test set 1.126x speedup, val set 0.997x speedup, step: 31
Epoch 191/200 |loss: 12.536553| train set 1.563x speedup, test set 1.855x speedup, val set 0.997x speedup, step: 32
Epoch 192/200 |loss: 12.197619| train set 1.558x speedup, test set 1.854x speedup, val set 0.997x speedup, step: 33
Epoch 193/200 |loss: 12.068884| train set 1.539x speedup, test set 1.039x speedup, val set 0.997x speedup, step: 34
Epoch 194/200 |loss: 12.851480| train set 1.519x speedup, test set 2.110x speedup, val set 0.997x speedup, step: 35
Epoch 195/200 |loss: 12.447255| train set 1.528x speedup, test set 1.794x speedup, val set 0.997x speedup, step: 36
Epoch 196/200 |loss: 11.848804| train set 1.526x speedup, test set 2.237x speedup, val set 0.997x speedup, step: 37
Epoch 197/200 |loss: 12.637446| train set 1.532x speedup, test set 1.793x speedup, val set 0.997x speedup, step: 38
Epoch 198/200 |loss: 11.659424| train set 1.563x speedup, test set 1.782x speedup, val set 0.997x speedup, step: 39
Epoch 199/200 |loss: 11.840242| train set 1.502x speedup, test set 1.101x speedup, val set 0.997x speedup, step: 40
Training per epoch cost 0.319 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.317s, pg runtime 2.352s, speedup 7.417x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.544s, pg runtime 2.558s, speedup 1.657x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 3.136s, pg runtime 5.620s, speedup 1.792x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 198, train speedup 1.563, test speedup 1.782, val speedup 0.997
best test speedup epoch: 79, train speedup 1.404, test speedup 2.653, val speedup 0.738
best validation speedup epoch: 160, train speedup 1.505, test speedup 2.110, val speedup 1.008
last model at epoch 199, train speedup 1.502, test speedup 1.101, val speedup 0.997
execution cost 0:02:46.999264
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.577286, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695993| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379671| train set 1.115x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083719| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800701| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.532593| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.290596| train set 1.170x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.020020| train set 1.178x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.762371| train set 1.173x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.511084| train set 1.191x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.301035| train set 1.239x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.185825| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 27.203075| train set 1.238x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.694769| train set 1.238x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.522017| train set 1.216x speedup, test set 1.027x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.457483| train set 1.223x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.028574| train set 1.194x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 26.058399| train set 1.177x speedup, test set 1.024x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.874315| train set 1.227x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.476358| train set 1.195x speedup, test set 1.025x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.579926| train set 1.202x speedup, test set 1.024x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.214586| train set 1.203x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.027836| train set 1.200x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.079874| train set 1.181x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 31
Epoch 31/200 |loss: 24.637461| train set 1.165x speedup, test set 1.016x speedup, val set 0.999x speedup, step: 32
Epoch 32/200 |loss: 24.589891| train set 1.230x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.445112| train set 1.228x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.070715| train set 1.204x speedup, test set 1.041x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.050894| train set 1.230x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 36
Epoch 36/200 |loss: 23.944502| train set 1.244x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.648029| train set 1.231x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.600719| train set 1.254x speedup, test set 1.785x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.673786| train set 1.231x speedup, test set 1.017x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.258444| train set 1.230x speedup, test set 1.032x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 22.863401| train set 1.270x speedup, test set 1.785x speedup, val set 0.930x speedup, step: 42
Epoch 42/200 |loss: 23.050179| train set 1.281x speedup, test set 1.372x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 23.069921| train set 1.232x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.853460| train set 1.310x speedup, test set 2.196x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 23.114094| train set 1.231x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.731661| train set 1.305x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.157251| train set 1.334x speedup, test set 2.089x speedup, val set 0.931x speedup, step: 48
Epoch 48/200 |loss: 22.719284| train set 1.305x speedup, test set 1.782x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.035578| train set 1.305x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 22.453339| train set 1.321x speedup, test set 1.844x speedup, val set 0.931x speedup, step: 51
Epoch 51/200 |loss: 21.736063| train set 1.329x speedup, test set 1.878x speedup, val set 0.931x speedup, step: 52
Epoch 52/200 |loss: 21.649563| train set 1.319x speedup, test set 1.028x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 21.483936| train set 1.322x speedup, test set 1.770x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 21.279402| train set 1.380x speedup, test set 1.949x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 21.049425| train set 1.343x speedup, test set 1.792x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 21.139175| train set 1.379x speedup, test set 2.018x speedup, val set 0.931x speedup, step: 57
Epoch 57/200 |loss: 20.825663| train set 1.328x speedup, test set 1.776x speedup, val set 0.998x speedup, step: 58
Epoch 58/200 |loss: 21.117813| train set 1.326x speedup, test set 1.323x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 22.152870| train set 1.329x speedup, test set 1.743x speedup, val set 0.998x speedup, step: 60
Epoch 60/200 |loss: 20.565876| train set 1.330x speedup, test set 1.930x speedup, val set 0.931x speedup, step: 61
Epoch 61/200 |loss: 21.136223| train set 1.338x speedup, test set 1.532x speedup, val set 0.931x speedup, step: 62
Epoch 62/200 |loss: 21.437735| train set 1.327x speedup, test set 1.776x speedup, val set 0.998x speedup, step: 63
Epoch 63/200 |loss: 20.263885| train set 1.314x speedup, test set 1.739x speedup, val set 0.998x speedup, step: 64
Epoch 64/200 |loss: 21.049229| train set 1.338x speedup, test set 1.411x speedup, val set 0.998x speedup, step: 65
Epoch 65/200 |loss: 20.594151| train set 1.325x speedup, test set 1.791x speedup, val set 0.998x speedup, step: 66
Epoch 66/200 |loss: 20.428211| train set 1.360x speedup, test set 2.005x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.796953| train set 1.330x speedup, test set 1.824x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 19.574471| train set 1.328x speedup, test set 1.017x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 20.108099| train set 1.391x speedup, test set 2.305x speedup, val set 0.931x speedup, step: 70
Epoch 70/200 |loss: 19.529196| train set 1.357x speedup, test set 2.195x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 19.718716| train set 1.344x speedup, test set 1.820x speedup, val set 0.998x speedup, step: 72
Epoch 72/200 |loss: 19.486835| train set 1.327x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.228085| train set 1.379x speedup, test set 2.051x speedup, val set 0.998x speedup, step: 74
Epoch 74/200 |loss: 19.094870| train set 1.392x speedup, test set 2.314x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 18.742479| train set 1.330x speedup, test set 1.754x speedup, val set 0.998x speedup, step: 76
Epoch 76/200 |loss: 19.037268| train set 1.415x speedup, test set 2.140x speedup, val set 0.998x speedup, step: 77
Epoch 77/200 |loss: 18.827358| train set 1.354x speedup, test set 1.820x speedup, val set 0.998x speedup, step: 78
Epoch 78/200 |loss: 18.738255| train set 1.372x speedup, test set 1.618x speedup, val set 0.931x speedup, step: 79
Epoch 79/200 |loss: 19.184971| train set 1.327x speedup, test set 1.754x speedup, val set 0.998x speedup, step: 80
Epoch 80/200 |loss: 18.851973| train set 1.399x speedup, test set 2.140x speedup, val set 0.998x speedup, step: 81
Epoch 81/200 |loss: 18.618359| train set 1.399x speedup, test set 2.121x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 17.829605| train set 1.399x speedup, test set 2.083x speedup, val set 0.998x speedup, step: 83
Epoch 83/200 |loss: 18.228481| train set 1.421x speedup, test set 1.811x speedup, val set 0.739x speedup, step: 84
Epoch 84/200 |loss: 18.618498| train set 1.328x speedup, test set 1.776x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 19.113758| train set 1.343x speedup, test set 1.042x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.799475| train set 1.408x speedup, test set 2.441x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.313604| train set 1.395x speedup, test set 1.949x speedup, val set 0.998x speedup, step: 88
Epoch 88/200 |loss: 19.063740| train set 1.415x speedup, test set 1.161x speedup, val set 0.998x speedup, step: 89
Epoch 89/200 |loss: 19.140287| train set 1.415x speedup, test set 1.231x speedup, val set 0.998x speedup, step: 90
Epoch 90/200 |loss: 18.904066| train set 1.360x speedup, test set 1.975x speedup, val set 0.994x speedup, step: 91
Epoch 91/200 |loss: 19.229958| train set 1.373x speedup, test set 2.313x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 19.405737| train set 1.413x speedup, test set 2.201x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 18.282534| train set 1.407x speedup, test set 2.089x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 18.671047| train set 1.400x speedup, test set 1.894x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.487213| train set 1.410x speedup, test set 1.038x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 18.157999| train set 1.507x speedup, test set 2.557x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.133860| train set 1.382x speedup, test set 2.014x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 17.643160| train set 1.320x speedup, test set 1.043x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.218000| train set 1.398x speedup, test set 1.043x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.940231| train set 1.417x speedup, test set 2.504x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.009212| train set 1.412x speedup, test set 2.141x speedup, val set 0.998x speedup, step: 1
Epoch 102/200 |loss: 16.476402| train set 1.412x speedup, test set 1.050x speedup, val set 0.998x speedup, step: 1
Epoch 103/200 |loss: 16.642942| train set 1.410x speedup, test set 1.108x speedup, val set 0.998x speedup, step: 1
Epoch 104/200 |loss: 16.168570| train set 1.418x speedup, test set 2.921x speedup, val set 0.997x speedup, step: 2
Epoch 105/200 |loss: 16.301113| train set 1.399x speedup, test set 1.116x speedup, val set 0.997x speedup, step: 3
Epoch 106/200 |loss: 16.077209| train set 1.415x speedup, test set 2.077x speedup, val set 0.997x speedup, step: 4
Epoch 107/200 |loss: 15.949604| train set 1.415x speedup, test set 2.088x speedup, val set 0.998x speedup, step: 1
Epoch 108/200 |loss: 15.786551| train set 1.494x speedup, test set 2.650x speedup, val set 0.998x speedup, step: 1
Epoch 109/200 |loss: 15.646082| train set 1.414x speedup, test set 1.112x speedup, val set 0.997x speedup, step: 2
Epoch 110/200 |loss: 15.688786| train set 1.430x speedup, test set 1.280x speedup, val set 0.997x speedup, step: 3
Epoch 111/200 |loss: 15.582372| train set 1.449x speedup, test set 1.970x speedup, val set 0.997x speedup, step: 4
Epoch 112/200 |loss: 15.798828| train set 1.472x speedup, test set 3.084x speedup, val set 0.997x speedup, step: 5
Epoch 113/200 |loss: 17.429916| train set 1.354x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 6
Epoch 114/200 |loss: 18.451033| train set 1.518x speedup, test set 1.278x speedup, val set 0.997x speedup, step: 7
Epoch 115/200 |loss: 16.514574| train set 1.388x speedup, test set 2.716x speedup, val set 0.997x speedup, step: 8
Epoch 116/200 |loss: 15.584492| train set 1.449x speedup, test set 1.050x speedup, val set 0.997x speedup, step: 9
Epoch 117/200 |loss: 16.949675| train set 1.465x speedup, test set 1.286x speedup, val set 0.997x speedup, step: 10
Epoch 118/200 |loss: 15.618945| train set 1.368x speedup, test set 2.702x speedup, val set 0.994x speedup, step: 11
Epoch 119/200 |loss: 16.171366| train set 1.446x speedup, test set 1.086x speedup, val set 0.997x speedup, step: 12
Epoch 120/200 |loss: 15.519912| train set 1.490x speedup, test set 1.276x speedup, val set 0.997x speedup, step: 13
Epoch 121/200 |loss: 15.273775| train set 1.454x speedup, test set 2.702x speedup, val set 0.994x speedup, step: 14
Epoch 122/200 |loss: 15.526302| train set 1.420x speedup, test set 2.489x speedup, val set 0.997x speedup, step: 15
Epoch 123/200 |loss: 14.936308| train set 1.416x speedup, test set 1.143x speedup, val set 0.997x speedup, step: 16
Epoch 124/200 |loss: 14.715919| train set 1.416x speedup, test set 2.719x speedup, val set 0.997x speedup, step: 17
Epoch 125/200 |loss: 14.810242| train set 1.427x speedup, test set 2.114x speedup, val set 0.997x speedup, step: 18
Epoch 126/200 |loss: 14.547976| train set 1.416x speedup, test set 2.088x speedup, val set 0.997x speedup, step: 19
Epoch 127/200 |loss: 14.494521| train set 1.519x speedup, test set 1.239x speedup, val set 0.997x speedup, step: 20
Epoch 128/200 |loss: 14.822606| train set 1.442x speedup, test set 2.076x speedup, val set 0.997x speedup, step: 21
Epoch 129/200 |loss: 14.759401| train set 1.502x speedup, test set 1.633x speedup, val set 0.997x speedup, step: 22
Epoch 130/200 |loss: 15.289729| train set 1.402x speedup, test set 1.978x speedup, val set 0.997x speedup, step: 23
Epoch 131/200 |loss: 15.237215| train set 1.539x speedup, test set 1.811x speedup, val set 0.997x speedup, step: 24
Epoch 132/200 |loss: 14.551568| train set 1.419x speedup, test set 1.120x speedup, val set 0.997x speedup, step: 25
Epoch 133/200 |loss: 13.957458| train set 1.389x speedup, test set 1.057x speedup, val set 0.997x speedup, step: 26
Epoch 134/200 |loss: 14.003939| train set 1.496x speedup, test set 1.695x speedup, val set 0.997x speedup, step: 27
Epoch 135/200 |loss: 13.952053| train set 1.495x speedup, test set 2.084x speedup, val set 0.997x speedup, step: 28
Epoch 136/200 |loss: 13.968921| train set 1.411x speedup, test set 1.128x speedup, val set 0.997x speedup, step: 29
Epoch 137/200 |loss: 14.510600| train set 1.502x speedup, test set 2.089x speedup, val set 0.997x speedup, step: 30
Epoch 138/200 |loss: 13.656533| train set 1.530x speedup, test set 2.276x speedup, val set 0.997x speedup, step: 31
Epoch 139/200 |loss: 13.384269| train set 1.486x speedup, test set 1.088x speedup, val set 0.997x speedup, step: 32
Epoch 140/200 |loss: 13.403206| train set 1.507x speedup, test set 2.089x speedup, val set 0.997x speedup, step: 33
Epoch 141/200 |loss: 13.343846| train set 1.541x speedup, test set 1.128x speedup, val set 0.997x speedup, step: 34
Epoch 142/200 |loss: 13.407913| train set 1.512x speedup, test set 2.087x speedup, val set 0.997x speedup, step: 35
Epoch 143/200 |loss: 13.710292| train set 1.515x speedup, test set 1.423x speedup, val set 0.997x speedup, step: 36
Epoch 144/200 |loss: 14.479611| train set 1.508x speedup, test set 2.088x speedup, val set 0.994x speedup, step: 37
Epoch 145/200 |loss: 14.367455| train set 1.539x speedup, test set 1.095x speedup, val set 0.997x speedup, step: 38
Epoch 146/200 |loss: 14.500993| train set 1.494x speedup, test set 1.865x speedup, val set 0.997x speedup, step: 39
Epoch 147/200 |loss: 12.984300| train set 1.512x speedup, test set 2.380x speedup, val set 0.997x speedup, step: 40
Epoch 148/200 |loss: 13.353851| train set 1.509x speedup, test set 1.069x speedup, val set 0.997x speedup, step: 41
Epoch 149/200 |loss: 14.014915| train set 1.541x speedup, test set 1.246x speedup, val set 0.997x speedup, step: 42
Epoch 150/200 |loss: 13.043476| train set 1.369x speedup, test set 1.883x speedup, val set 0.997x speedup, step: 43
Epoch 151/200 |loss: 13.212442| train set 1.539x speedup, test set 1.088x speedup, val set 0.997x speedup, step: 44
Epoch 152/200 |loss: 13.426375| train set 1.507x speedup, test set 1.089x speedup, val set 0.997x speedup, step: 45
Epoch 153/200 |loss: 12.995856| train set 1.482x speedup, test set 2.721x speedup, val set 0.997x speedup, step: 46
Epoch 154/200 |loss: 13.366958| train set 1.436x speedup, test set 1.061x speedup, val set 0.997x speedup, step: 47
Epoch 155/200 |loss: 14.077527| train set 1.519x speedup, test set 1.757x speedup, val set 0.997x speedup, step: 48
Epoch 156/200 |loss: 16.073935| train set 1.395x speedup, test set 1.775x speedup, val set 1.000x speedup, step: 1
Epoch 157/200 |loss: 15.400587| train set 1.519x speedup, test set 1.245x speedup, val set 0.997x speedup, step: 2
Epoch 158/200 |loss: 14.101452| train set 1.501x speedup, test set 1.128x speedup, val set 0.997x speedup, step: 3
Epoch 159/200 |loss: 13.878137| train set 1.450x speedup, test set 1.875x speedup, val set 0.997x speedup, step: 4
Epoch 160/200 |loss: 13.678030| train set 1.530x speedup, test set 2.437x speedup, val set 0.997x speedup, step: 5
Epoch 161/200 |loss: 13.828983| train set 1.488x speedup, test set 1.100x speedup, val set 0.997x speedup, step: 6
Epoch 162/200 |loss: 13.558795| train set 1.530x speedup, test set 2.089x speedup, val set 0.997x speedup, step: 7
Epoch 163/200 |loss: 12.788121| train set 1.483x speedup, test set 2.640x speedup, val set 0.997x speedup, step: 8
Epoch 164/200 |loss: 13.440869| train set 1.384x speedup, test set 1.096x speedup, val set 0.997x speedup, step: 9
Epoch 165/200 |loss: 13.757912| train set 1.421x speedup, test set 1.097x speedup, val set 0.997x speedup, step: 10
Epoch 166/200 |loss: 12.715598| train set 1.526x speedup, test set 2.630x speedup, val set 0.997x speedup, step: 11
Epoch 167/200 |loss: 14.185975| train set 1.501x speedup, test set 1.100x speedup, val set 0.997x speedup, step: 12
Epoch 168/200 |loss: 14.019912| train set 1.415x speedup, test set 1.070x speedup, val set 0.997x speedup, step: 13
Epoch 169/200 |loss: 13.640076| train set 1.526x speedup, test set 2.412x speedup, val set 0.992x speedup, step: 14
Epoch 170/200 |loss: 13.912323| train set 1.537x speedup, test set 2.940x speedup, val set 0.997x speedup, step: 15
Epoch 171/200 |loss: 14.317141| train set 1.364x speedup, test set 1.039x speedup, val set 0.997x speedup, step: 16
Epoch 172/200 |loss: 15.172809| train set 1.507x speedup, test set 1.974x speedup, val set 0.997x speedup, step: 17
Epoch 173/200 |loss: 13.506564| train set 1.293x speedup, test set 3.151x speedup, val set 0.692x speedup, step: 18
Epoch 174/200 |loss: 15.131654| train set 1.447x speedup, test set 1.048x speedup, val set 0.997x speedup, step: 19
Epoch 175/200 |loss: 14.012484| train set 1.379x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 20
Epoch 176/200 |loss: 14.273925| train set 1.519x speedup, test set 1.121x speedup, val set 0.997x speedup, step: 21
Epoch 177/200 |loss: 13.428235| train set 1.490x speedup, test set 2.351x speedup, val set 0.997x speedup, step: 22
Epoch 178/200 |loss: 13.496814| train set 1.481x speedup, test set 1.977x speedup, val set 0.997x speedup, step: 23
Epoch 179/200 |loss: 13.233373| train set 1.519x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 24
Epoch 180/200 |loss: 12.998706| train set 1.557x speedup, test set 1.088x speedup, val set 0.997x speedup, step: 25
Epoch 181/200 |loss: 12.982645| train set 1.496x speedup, test set 2.578x speedup, val set 0.997x speedup, step: 26
Epoch 182/200 |loss: 12.746876| train set 1.470x speedup, test set 1.089x speedup, val set 0.997x speedup, step: 27
Epoch 183/200 |loss: 12.733301| train set 1.501x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 28
Epoch 184/200 |loss: 12.321601| train set 1.519x speedup, test set 1.983x speedup, val set 0.997x speedup, step: 29
Epoch 185/200 |loss: 12.459887| train set 1.529x speedup, test set 1.978x speedup, val set 0.997x speedup, step: 30
Epoch 186/200 |loss: 12.159348| train set 1.514x speedup, test set 1.134x speedup, val set 0.997x speedup, step: 31
Epoch 187/200 |loss: 12.163967| train set 1.520x speedup, test set 1.134x speedup, val set 0.997x speedup, step: 32
Epoch 188/200 |loss: 11.950030| train set 1.559x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 33
Epoch 189/200 |loss: 11.978177| train set 1.564x speedup, test set 1.983x speedup, val set 0.997x speedup, step: 34
Epoch 190/200 |loss: 11.792181| train set 1.537x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 35
Epoch 191/200 |loss: 11.790578| train set 1.577x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 36
Epoch 192/200 |loss: 11.619548| train set 1.492x speedup, test set 2.119x speedup, val set 0.997x speedup, step: 37
Epoch 193/200 |loss: 11.661344| train set 1.518x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 38
Epoch 194/200 |loss: 11.478572| train set 1.514x speedup, test set 1.134x speedup, val set 0.997x speedup, step: 39
Epoch 195/200 |loss: 11.483253| train set 1.558x speedup, test set 2.140x speedup, val set 0.997x speedup, step: 40
Epoch 196/200 |loss: 11.397715| train set 1.513x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 41
Epoch 197/200 |loss: 11.544210| train set 1.502x speedup, test set 1.997x speedup, val set 0.997x speedup, step: 42
Epoch 198/200 |loss: 11.809157| train set 1.537x speedup, test set 1.142x speedup, val set 0.997x speedup, step: 43
Epoch 199/200 |loss: 13.392665| train set 1.537x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 44
Training per epoch cost 0.332 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 9.387s, pg runtime 8.283s, speedup 0.882x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.544s, pg runtime 2.558s, speedup 1.657x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 191, train speedup 1.577, test speedup 1.998, val speedup 0.997
best test speedup epoch: 173, train speedup 1.293, test speedup 3.151, val speedup 0.692
best validation speedup epoch: 156, train speedup 1.395, test speedup 1.775, val speedup 1.000
last model at epoch 199, train speedup 1.537, test speedup 1.998, val speedup 0.997
execution cost 0:02:47.326034
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.443781, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159264| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786833| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443678| train set 0.789x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698145| train set 1.100x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383289| train set 1.117x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091825| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.809954| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.532789| train set 1.131x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.278572| train set 1.151x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.017616| train set 1.153x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.788069| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.565722| train set 1.197x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.404400| train set 1.238x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.207434| train set 1.218x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.946463| train set 1.207x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.672770| train set 1.207x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.522331| train set 1.204x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.383268| train set 1.225x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.070353| train set 1.182x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 24
Epoch 24/200 |loss: 25.812668| train set 1.198x speedup, test set 1.025x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.675005| train set 1.222x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.540905| train set 1.187x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.386312| train set 1.160x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.285818| train set 1.168x speedup, test set 1.016x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 25.172218| train set 1.143x speedup, test set 1.025x speedup, val set 0.997x speedup, step: 30
Epoch 30/200 |loss: 25.126074| train set 1.197x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.795195| train set 1.161x speedup, test set 1.057x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.520132| train set 1.179x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.313416| train set 1.199x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.160042| train set 1.241x speedup, test set 1.056x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.056416| train set 1.229x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 36
Epoch 36/200 |loss: 23.734459| train set 1.229x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.523514| train set 1.241x speedup, test set 1.031x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 23.490582| train set 1.231x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 39
Epoch 39/200 |loss: 23.407059| train set 1.275x speedup, test set 1.041x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.101925| train set 1.306x speedup, test set 1.781x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 22.974510| train set 1.229x speedup, test set 1.041x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 23.134291| train set 1.286x speedup, test set 1.758x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 22.845734| train set 1.316x speedup, test set 1.041x speedup, val set 0.997x speedup, step: 44
Epoch 44/200 |loss: 22.621647| train set 1.232x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.650591| train set 1.259x speedup, test set 2.211x speedup, val set 0.930x speedup, step: 46
Epoch 46/200 |loss: 22.339220| train set 1.305x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.091530| train set 1.322x speedup, test set 1.757x speedup, val set 0.930x speedup, step: 48
Epoch 48/200 |loss: 22.091471| train set 1.305x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.189217| train set 1.341x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 21.464943| train set 1.327x speedup, test set 1.699x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.760185| train set 1.323x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.428925| train set 1.306x speedup, test set 1.745x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.486828| train set 1.327x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.962687| train set 1.327x speedup, test set 1.816x speedup, val set 0.997x speedup, step: 55
Epoch 55/200 |loss: 21.090784| train set 1.386x speedup, test set 2.350x speedup, val set 0.930x speedup, step: 56
Epoch 56/200 |loss: 20.782539| train set 1.238x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.670689| train set 1.343x speedup, test set 1.914x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.408405| train set 1.370x speedup, test set 1.058x speedup, val set 0.997x speedup, step: 59
Epoch 59/200 |loss: 20.811668| train set 1.452x speedup, test set 2.448x speedup, val set 0.701x speedup, step: 60
Epoch 60/200 |loss: 21.502167| train set 1.201x speedup, test set 1.002x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 21.926571| train set 1.324x speedup, test set 1.019x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.230259| train set 1.346x speedup, test set 2.522x speedup, val set 0.930x speedup, step: 63
Epoch 63/200 |loss: 21.026392| train set 1.342x speedup, test set 1.848x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 20.752611| train set 1.332x speedup, test set 1.769x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 19.817503| train set 1.393x speedup, test set 2.363x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.540506| train set 1.372x speedup, test set 1.936x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 19.495466| train set 1.420x speedup, test set 1.097x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.957005| train set 1.332x speedup, test set 1.846x speedup, val set 0.997x speedup, step: 69
Epoch 69/200 |loss: 19.611162| train set 1.487x speedup, test set 2.384x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 20.441595| train set 1.251x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 21.438023| train set 1.392x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.807062| train set 1.488x speedup, test set 2.379x speedup, val set 0.738x speedup, step: 73
Epoch 73/200 |loss: 19.942259| train set 1.326x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 21.223396| train set 1.394x speedup, test set 1.045x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 20.084114| train set 1.400x speedup, test set 1.136x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.926130| train set 1.361x speedup, test set 1.793x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.630165| train set 1.358x speedup, test set 1.837x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 19.212938| train set 1.400x speedup, test set 2.381x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 19.435766| train set 1.389x speedup, test set 1.828x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.765961| train set 1.389x speedup, test set 1.805x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 19.136898| train set 1.393x speedup, test set 2.107x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 18.474266| train set 1.430x speedup, test set 2.032x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.431402| train set 1.409x speedup, test set 2.040x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.286137| train set 1.396x speedup, test set 1.762x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 18.002022| train set 1.394x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 18.010710| train set 1.381x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.692593| train set 1.403x speedup, test set 2.204x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.632988| train set 1.436x speedup, test set 1.161x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 17.542891| train set 1.369x speedup, test set 1.014x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.408499| train set 1.472x speedup, test set 1.949x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 17.112089| train set 1.479x speedup, test set 2.070x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.208788| train set 1.397x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 17.110075| train set 1.400x speedup, test set 1.949x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 16.644197| train set 1.492x speedup, test set 1.082x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 16.708481| train set 1.397x speedup, test set 1.995x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 16.900749| train set 1.432x speedup, test set 1.081x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.709047| train set 1.519x speedup, test set 2.264x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 17.044998| train set 1.374x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.386141| train set 1.518x speedup, test set 1.155x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.702829| train set 1.429x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.457558| train set 1.513x speedup, test set 1.097x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 19.171108| train set 1.366x speedup, test set 1.443x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.783527| train set 1.383x speedup, test set 1.599x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 18.472408| train set 1.390x speedup, test set 1.127x speedup, val set 0.738x speedup, step: 2
Epoch 105/200 |loss: 18.262285| train set 1.243x speedup, test set 1.005x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 18.915091| train set 1.299x speedup, test set 2.010x speedup, val set 0.844x speedup, step: 2
Epoch 107/200 |loss: 17.854588| train set 1.438x speedup, test set 2.250x speedup, val set 1.008x speedup, step: 1
Epoch 108/200 |loss: 18.472561| train set 1.469x speedup, test set 1.982x speedup, val set 0.997x speedup, step: 2
Epoch 109/200 |loss: 16.526108| train set 1.363x speedup, test set 1.038x speedup, val set 0.997x speedup, step: 3
Epoch 110/200 |loss: 17.695950| train set 1.400x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 4
Epoch 111/200 |loss: 16.186663| train set 1.450x speedup, test set 2.119x speedup, val set 0.997x speedup, step: 5
Epoch 112/200 |loss: 17.011053| train set 1.433x speedup, test set 1.983x speedup, val set 0.997x speedup, step: 6
Epoch 113/200 |loss: 16.212963| train set 1.374x speedup, test set 1.038x speedup, val set 0.997x speedup, step: 7
Epoch 114/200 |loss: 16.272057| train set 1.395x speedup, test set 1.099x speedup, val set 0.997x speedup, step: 8
Epoch 115/200 |loss: 15.909176| train set 1.501x speedup, test set 2.026x speedup, val set 0.997x speedup, step: 9
Epoch 116/200 |loss: 15.753797| train set 1.459x speedup, test set 1.980x speedup, val set 0.997x speedup, step: 10
Epoch 117/200 |loss: 15.486795| train set 1.411x speedup, test set 1.088x speedup, val set 1.008x speedup, step: 1
Epoch 118/200 |loss: 15.755492| train set 1.416x speedup, test set 1.981x speedup, val set 0.997x speedup, step: 2
Epoch 119/200 |loss: 15.101127| train set 1.425x speedup, test set 1.986x speedup, val set 0.997x speedup, step: 3
Epoch 120/200 |loss: 15.268677| train set 1.519x speedup, test set 1.124x speedup, val set 0.997x speedup, step: 4
Epoch 121/200 |loss: 15.169069| train set 1.405x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 5
Epoch 122/200 |loss: 15.191799| train set 1.471x speedup, test set 2.074x speedup, val set 0.997x speedup, step: 6
Epoch 123/200 |loss: 15.089424| train set 1.502x speedup, test set 2.030x speedup, val set 1.008x speedup, step: 1
Epoch 124/200 |loss: 14.908608| train set 1.466x speedup, test set 2.079x speedup, val set 0.997x speedup, step: 2
Epoch 125/200 |loss: 15.573865| train set 1.425x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 3
Epoch 126/200 |loss: 16.178577| train set 1.502x speedup, test set 1.088x speedup, val set 0.997x speedup, step: 4
Epoch 127/200 |loss: 14.695628| train set 1.506x speedup, test set 2.074x speedup, val set 0.997x speedup, step: 5
Epoch 128/200 |loss: 14.619444| train set 1.509x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 6
Epoch 129/200 |loss: 15.730630| train set 1.502x speedup, test set 1.995x speedup, val set 0.997x speedup, step: 7
Epoch 130/200 |loss: 14.447450| train set 1.506x speedup, test set 1.995x speedup, val set 0.997x speedup, step: 8
Epoch 131/200 |loss: 14.596452| train set 1.503x speedup, test set 1.099x speedup, val set 0.997x speedup, step: 9
Epoch 132/200 |loss: 15.647941| train set 1.395x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 10
Epoch 133/200 |loss: 14.560402| train set 1.461x speedup, test set 1.995x speedup, val set 0.997x speedup, step: 11
Epoch 134/200 |loss: 14.585202| train set 1.558x speedup, test set 1.096x speedup, val set 0.997x speedup, step: 12
Epoch 135/200 |loss: 16.021328| train set 1.369x speedup, test set 1.797x speedup, val set 0.997x speedup, step: 13
Epoch 136/200 |loss: 14.443789| train set 1.442x speedup, test set 1.995x speedup, val set 0.996x speedup, step: 14
Epoch 137/200 |loss: 15.141636| train set 1.539x speedup, test set 1.095x speedup, val set 0.997x speedup, step: 15
Epoch 138/200 |loss: 15.659406| train set 1.540x speedup, test set 1.091x speedup, val set 0.997x speedup, step: 16
Epoch 139/200 |loss: 13.686629| train set 1.508x speedup, test set 1.989x speedup, val set 0.997x speedup, step: 17
Epoch 140/200 |loss: 15.695427| train set 1.503x speedup, test set 1.032x speedup, val set 0.997x speedup, step: 18
Epoch 141/200 |loss: 14.303149| train set 1.541x speedup, test set 1.989x speedup, val set 0.997x speedup, step: 19
Epoch 142/200 |loss: 14.293780| train set 1.502x speedup, test set 1.980x speedup, val set 0.997x speedup, step: 20
Epoch 143/200 |loss: 14.834647| train set 1.496x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 21
Epoch 144/200 |loss: 14.027941| train set 1.505x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 22
Epoch 145/200 |loss: 14.007872| train set 1.501x speedup, test set 2.117x speedup, val set 0.997x speedup, step: 23
Epoch 146/200 |loss: 14.028153| train set 1.496x speedup, test set 1.796x speedup, val set 0.997x speedup, step: 24
Epoch 147/200 |loss: 13.579988| train set 1.508x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 25
Epoch 148/200 |loss: 13.749830| train set 1.563x speedup, test set 2.083x speedup, val set 0.997x speedup, step: 26
Epoch 149/200 |loss: 13.237145| train set 1.518x speedup, test set 1.989x speedup, val set 0.997x speedup, step: 27
Epoch 150/200 |loss: 13.585054| train set 1.472x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 28
Epoch 151/200 |loss: 13.899745| train set 1.499x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 29
Epoch 152/200 |loss: 13.180649| train set 1.507x speedup, test set 2.117x speedup, val set 0.997x speedup, step: 30
Epoch 153/200 |loss: 14.155204| train set 1.502x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 31
Epoch 154/200 |loss: 13.030814| train set 1.537x speedup, test set 1.032x speedup, val set 0.997x speedup, step: 32
Epoch 155/200 |loss: 13.257473| train set 1.484x speedup, test set 2.073x speedup, val set 0.997x speedup, step: 33
Epoch 156/200 |loss: 13.413380| train set 1.545x speedup, test set 1.989x speedup, val set 0.997x speedup, step: 34
Epoch 157/200 |loss: 12.794106| train set 1.502x speedup, test set 1.030x speedup, val set 0.997x speedup, step: 35
Epoch 158/200 |loss: 13.052834| train set 1.476x speedup, test set 1.989x speedup, val set 0.997x speedup, step: 36
Epoch 159/200 |loss: 12.629394| train set 1.537x speedup, test set 2.073x speedup, val set 0.997x speedup, step: 37
Epoch 160/200 |loss: 12.625955| train set 1.501x speedup, test set 1.989x speedup, val set 0.997x speedup, step: 38
Epoch 161/200 |loss: 12.559752| train set 1.504x speedup, test set 1.796x speedup, val set 0.997x speedup, step: 39
Epoch 162/200 |loss: 12.415222| train set 1.542x speedup, test set 2.073x speedup, val set 0.997x speedup, step: 40
Epoch 163/200 |loss: 12.511110| train set 1.542x speedup, test set 1.782x speedup, val set 0.997x speedup, step: 41
Epoch 164/200 |loss: 12.693298| train set 1.488x speedup, test set 2.073x speedup, val set 0.997x speedup, step: 42
Epoch 165/200 |loss: 13.726300| train set 1.421x speedup, test set 1.025x speedup, val set 1.008x speedup, step: 1
Epoch 166/200 |loss: 15.219458| train set 1.520x speedup, test set 1.138x speedup, val set 0.997x speedup, step: 2
Epoch 167/200 |loss: 17.399250| train set 1.425x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 3
Epoch 168/200 |loss: 14.442223| train set 1.444x speedup, test set 1.770x speedup, val set 0.997x speedup, step: 4
Epoch 169/200 |loss: 15.687850| train set 1.355x speedup, test set 2.370x speedup, val set 0.738x speedup, step: 5
Epoch 170/200 |loss: 17.004780| train set 1.391x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 6
Epoch 171/200 |loss: 15.020388| train set 1.303x speedup, test set 1.439x speedup, val set 0.996x speedup, step: 7
Epoch 172/200 |loss: 15.331632| train set 1.421x speedup, test set 1.963x speedup, val set 0.996x speedup, step: 8
Epoch 173/200 |loss: 13.702980| train set 1.405x speedup, test set 2.456x speedup, val set 0.738x speedup, step: 9
Epoch 174/200 |loss: 15.401364| train set 1.404x speedup, test set 1.771x speedup, val set 0.997x speedup, step: 10
Epoch 175/200 |loss: 13.491134| train set 1.386x speedup, test set 1.439x speedup, val set 0.996x speedup, step: 11
Epoch 176/200 |loss: 14.748568| train set 1.427x speedup, test set 1.770x speedup, val set 0.997x speedup, step: 12
Epoch 177/200 |loss: 13.153076| train set 1.513x speedup, test set 1.123x speedup, val set 0.997x speedup, step: 13
Epoch 178/200 |loss: 13.774076| train set 1.514x speedup, test set 1.086x speedup, val set 0.997x speedup, step: 14
Epoch 179/200 |loss: 13.171358| train set 1.450x speedup, test set 1.783x speedup, val set 0.997x speedup, step: 15
Epoch 180/200 |loss: 13.169450| train set 1.410x speedup, test set 1.796x speedup, val set 0.997x speedup, step: 16
Epoch 181/200 |loss: 13.021605| train set 1.476x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 17
Epoch 182/200 |loss: 12.695503| train set 1.515x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 18
Epoch 183/200 |loss: 12.740136| train set 1.541x speedup, test set 1.796x speedup, val set 0.997x speedup, step: 19
Epoch 184/200 |loss: 12.492860| train set 1.560x speedup, test set 1.796x speedup, val set 0.997x speedup, step: 20
Epoch 185/200 |loss: 12.337976| train set 1.553x speedup, test set 1.796x speedup, val set 0.997x speedup, step: 21
Epoch 186/200 |loss: 12.274804| train set 1.526x speedup, test set 1.796x speedup, val set 0.997x speedup, step: 22
Epoch 187/200 |loss: 12.144580| train set 1.520x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 23
Epoch 188/200 |loss: 11.997769| train set 1.534x speedup, test set 1.026x speedup, val set 0.997x speedup, step: 24
Epoch 189/200 |loss: 12.037605| train set 1.502x speedup, test set 1.770x speedup, val set 0.997x speedup, step: 25
Epoch 190/200 |loss: 11.756342| train set 1.506x speedup, test set 1.844x speedup, val set 0.997x speedup, step: 26
Epoch 191/200 |loss: 11.879485| train set 1.566x speedup, test set 1.770x speedup, val set 0.997x speedup, step: 27
Epoch 192/200 |loss: 11.655961| train set 1.521x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 28
Epoch 193/200 |loss: 11.637902| train set 1.565x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 29
Epoch 194/200 |loss: 11.524367| train set 1.531x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 30
Epoch 195/200 |loss: 11.468995| train set 1.565x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 31
Epoch 196/200 |loss: 11.415287| train set 1.534x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 32
Epoch 197/200 |loss: 11.314806| train set 1.534x speedup, test set 1.091x speedup, val set 0.997x speedup, step: 33
Epoch 198/200 |loss: 11.263363| train set 1.538x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 34
Epoch 199/200 |loss: 11.214632| train set 1.521x speedup, test set 1.784x speedup, val set 0.997x speedup, step: 35
Training per epoch cost 0.331 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 9.387s, pg runtime 8.283s, speedup 0.882x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 11.835s, pg runtime 10.685s, speedup 0.903x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 58.779s, pg runtime 57.198s, speedup 0.973x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 191, train speedup 1.566, test speedup 1.770, val speedup 0.997
best test speedup epoch: 62, train speedup 1.346, test speedup 2.522, val speedup 0.930
best validation speedup epoch: 165, train speedup 1.421, test speedup 1.025, val speedup 1.008
last model at epoch 199, train speedup 1.521, test speedup 1.784, val speedup 0.997
execution cost 0:02:47.180428
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.588739, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486778| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.786835| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.443682| train set 0.789x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.083918| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.698141| train set 1.100x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.383268| train set 1.117x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.091692| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.810257| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.534521| train set 1.131x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.277252| train set 1.152x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.015280| train set 1.154x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.783699| train set 1.192x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.554926| train set 1.173x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.366230| train set 1.206x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.171965| train set 1.218x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.948763| train set 1.200x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.661575| train set 1.224x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 21
Epoch 21/200 |loss: 26.437229| train set 1.205x speedup, test set 1.017x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.274817| train set 1.223x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.097216| train set 1.206x speedup, test set 1.028x speedup, val set 0.932x speedup, step: 24
Epoch 24/200 |loss: 25.871475| train set 1.193x speedup, test set 1.016x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 25.618179| train set 1.184x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.444040| train set 1.184x speedup, test set 1.039x speedup, val set 0.930x speedup, step: 27
Epoch 27/200 |loss: 25.392096| train set 1.162x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 28
Epoch 28/200 |loss: 25.433025| train set 1.179x speedup, test set 1.016x speedup, val set 0.930x speedup, step: 29
Epoch 29/200 |loss: 24.957108| train set 1.168x speedup, test set 1.016x speedup, val set 0.930x speedup, step: 30
Epoch 30/200 |loss: 24.973997| train set 1.197x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 31
Epoch 31/200 |loss: 24.891031| train set 1.180x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 32
Epoch 32/200 |loss: 24.322895| train set 1.226x speedup, test set 1.057x speedup, val set 0.930x speedup, step: 33
Epoch 33/200 |loss: 24.464733| train set 1.199x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.082420| train set 1.199x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 23.904285| train set 1.239x speedup, test set 1.050x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.881908| train set 1.227x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 37
Epoch 37/200 |loss: 23.403484| train set 1.229x speedup, test set 1.016x speedup, val set 0.997x speedup, step: 38
Epoch 38/200 |loss: 23.442556| train set 1.242x speedup, test set 1.025x speedup, val set 0.930x speedup, step: 39
Epoch 39/200 |loss: 23.289127| train set 1.229x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 40
Epoch 40/200 |loss: 23.419977| train set 1.226x speedup, test set 1.034x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 24.734818| train set 1.231x speedup, test set 1.008x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 23.004440| train set 1.232x speedup, test set 1.712x speedup, val set 0.997x speedup, step: 43
Epoch 43/200 |loss: 23.219294| train set 1.256x speedup, test set 1.024x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 23.388453| train set 1.305x speedup, test set 1.033x speedup, val set 0.930x speedup, step: 45
Epoch 45/200 |loss: 22.566496| train set 1.225x speedup, test set 1.757x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 23.195169| train set 1.306x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 47
Epoch 47/200 |loss: 22.625389| train set 1.318x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 22.519386| train set 1.305x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.190027| train set 1.328x speedup, test set 1.757x speedup, val set 0.997x speedup, step: 50
Epoch 50/200 |loss: 21.980030| train set 1.324x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 51
Epoch 51/200 |loss: 21.764643| train set 1.319x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.635994| train set 1.321x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 53
Epoch 53/200 |loss: 21.464579| train set 1.325x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 54
Epoch 54/200 |loss: 21.301910| train set 1.327x speedup, test set 1.759x speedup, val set 0.930x speedup, step: 55
Epoch 55/200 |loss: 21.082241| train set 1.308x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 56
Epoch 56/200 |loss: 20.951096| train set 1.313x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 57
Epoch 57/200 |loss: 20.813307| train set 1.329x speedup, test set 1.759x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 20.497639| train set 1.384x speedup, test set 1.946x speedup, val set 0.930x speedup, step: 59
Epoch 59/200 |loss: 20.603739| train set 1.313x speedup, test set 1.024x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 20.343077| train set 1.392x speedup, test set 1.885x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 20.537571| train set 1.326x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 62
Epoch 62/200 |loss: 20.684488| train set 1.441x speedup, test set 2.534x speedup, val set 0.701x speedup, step: 63
Epoch 63/200 |loss: 20.956837| train set 1.303x speedup, test set 1.823x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 21.218609| train set 1.312x speedup, test set 1.022x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.186327| train set 1.372x speedup, test set 2.531x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 20.641088| train set 1.340x speedup, test set 1.035x speedup, val set 0.997x speedup, step: 67
Epoch 67/200 |loss: 20.992649| train set 1.393x speedup, test set 1.756x speedup, val set 0.997x speedup, step: 68
Epoch 68/200 |loss: 19.705116| train set 1.392x speedup, test set 2.450x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 20.343210| train set 1.304x speedup, test set 1.013x speedup, val set 0.997x speedup, step: 70
Epoch 70/200 |loss: 19.750284| train set 1.319x speedup, test set 1.743x speedup, val set 0.997x speedup, step: 71
Epoch 71/200 |loss: 19.516827| train set 1.360x speedup, test set 2.516x speedup, val set 0.739x speedup, step: 72
Epoch 72/200 |loss: 19.753336| train set 1.393x speedup, test set 1.878x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 18.989481| train set 1.327x speedup, test set 1.031x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.283894| train set 1.399x speedup, test set 1.898x speedup, val set 0.997x speedup, step: 75
Epoch 75/200 |loss: 18.734209| train set 1.389x speedup, test set 2.185x speedup, val set 0.738x speedup, step: 76
Epoch 76/200 |loss: 18.732510| train set 1.331x speedup, test set 1.780x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 18.684998| train set 1.332x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.275099| train set 1.399x speedup, test set 1.833x speedup, val set 0.997x speedup, step: 79
Epoch 79/200 |loss: 18.319759| train set 1.395x speedup, test set 1.818x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.399111| train set 1.400x speedup, test set 1.052x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.926609| train set 1.390x speedup, test set 1.778x speedup, val set 0.997x speedup, step: 82
Epoch 82/200 |loss: 19.555914| train set 1.394x speedup, test set 1.017x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 19.522001| train set 1.334x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 18.517511| train set 1.387x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 19.337034| train set 1.477x speedup, test set 1.163x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 19.949408| train set 1.365x speedup, test set 1.030x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 18.950008| train set 1.395x speedup, test set 1.821x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 18.979406| train set 1.368x speedup, test set 2.462x speedup, val set 0.997x speedup, step: 89
Epoch 89/200 |loss: 18.566364| train set 1.415x speedup, test set 1.126x speedup, val set 0.997x speedup, step: 90
Epoch 90/200 |loss: 17.898188| train set 1.314x speedup, test set 1.802x speedup, val set 0.997x speedup, step: 91
Epoch 91/200 |loss: 18.286510| train set 1.396x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 92
Epoch 92/200 |loss: 17.295189| train set 1.417x speedup, test set 2.443x speedup, val set 0.738x speedup, step: 93
Epoch 93/200 |loss: 18.204435| train set 1.399x speedup, test set 1.991x speedup, val set 0.997x speedup, step: 94
Epoch 94/200 |loss: 16.967802| train set 1.341x speedup, test set 1.798x speedup, val set 0.997x speedup, step: 95
Epoch 95/200 |loss: 17.499805| train set 1.415x speedup, test set 1.991x speedup, val set 0.997x speedup, step: 96
Epoch 96/200 |loss: 17.044430| train set 1.431x speedup, test set 2.381x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 16.918163| train set 1.387x speedup, test set 2.077x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 16.829218| train set 1.383x speedup, test set 1.037x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 16.779158| train set 1.397x speedup, test set 2.120x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 16.276075| train set 1.483x speedup, test set 2.155x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 16.610546| train set 1.427x speedup, test set 1.096x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 16.362156| train set 1.368x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.222878| train set 1.383x speedup, test set 1.818x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 15.903120| train set 1.434x speedup, test set 2.778x speedup, val set 0.738x speedup, step: 2
Epoch 105/200 |loss: 16.430384| train set 1.368x speedup, test set 1.048x speedup, val set 1.008x speedup, step: 1
Epoch 106/200 |loss: 17.103729| train set 1.394x speedup, test set 2.352x speedup, val set 0.997x speedup, step: 2
Epoch 107/200 |loss: 16.859154| train set 1.447x speedup, test set 1.069x speedup, val set 0.997x speedup, step: 3
Epoch 108/200 |loss: 16.207626| train set 1.506x speedup, test set 2.164x speedup, val set 0.997x speedup, step: 4
Epoch 109/200 |loss: 16.048233| train set 1.502x speedup, test set 2.367x speedup, val set 0.997x speedup, step: 5
Epoch 110/200 |loss: 17.265760| train set 1.392x speedup, test set 1.834x speedup, val set 0.997x speedup, step: 6
Epoch 111/200 |loss: 15.881793| train set 1.373x speedup, test set 2.134x speedup, val set 0.997x speedup, step: 7
Epoch 112/200 |loss: 16.179169| train set 1.518x speedup, test set 1.249x speedup, val set 0.997x speedup, step: 8
Epoch 113/200 |loss: 17.709824| train set 1.369x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 9
Epoch 114/200 |loss: 15.594965| train set 1.399x speedup, test set 1.788x speedup, val set 0.996x speedup, step: 10
Epoch 115/200 |loss: 17.391006| train set 1.538x speedup, test set 1.186x speedup, val set 1.008x speedup, step: 1
Epoch 116/200 |loss: 17.903973| train set 1.439x speedup, test set 2.549x speedup, val set 0.997x speedup, step: 2
Epoch 117/200 |loss: 17.548655| train set 1.341x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 3
Epoch 118/200 |loss: 17.298388| train set 1.396x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 4
Epoch 119/200 |loss: 16.531034| train set 1.461x speedup, test set 2.785x speedup, val set 0.738x speedup, step: 5
Epoch 120/200 |loss: 16.930815| train set 1.415x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 6
Epoch 121/200 |loss: 15.917388| train set 1.383x speedup, test set 1.048x speedup, val set 0.997x speedup, step: 7
Epoch 122/200 |loss: 16.134212| train set 1.519x speedup, test set 1.141x speedup, val set 0.997x speedup, step: 8
Epoch 123/200 |loss: 15.813281| train set 1.415x speedup, test set 1.982x speedup, val set 0.997x speedup, step: 9
Epoch 124/200 |loss: 15.335436| train set 1.414x speedup, test set 1.781x speedup, val set 0.997x speedup, step: 10
Epoch 125/200 |loss: 15.346335| train set 1.395x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 11
Epoch 126/200 |loss: 14.912883| train set 1.470x speedup, test set 2.366x speedup, val set 0.997x speedup, step: 12
Epoch 127/200 |loss: 15.065853| train set 1.470x speedup, test set 1.777x speedup, val set 0.997x speedup, step: 13
Epoch 128/200 |loss: 14.672148| train set 1.363x speedup, test set 1.789x speedup, val set 0.997x speedup, step: 14
Epoch 129/200 |loss: 14.562570| train set 1.388x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 15
Epoch 130/200 |loss: 14.468047| train set 1.498x speedup, test set 2.344x speedup, val set 0.997x speedup, step: 16
Epoch 131/200 |loss: 14.298832| train set 1.500x speedup, test set 1.032x speedup, val set 0.997x speedup, step: 17
Epoch 132/200 |loss: 14.176921| train set 1.490x speedup, test set 1.133x speedup, val set 0.997x speedup, step: 18
Epoch 133/200 |loss: 14.161818| train set 1.541x speedup, test set 1.117x speedup, val set 0.997x speedup, step: 19
Epoch 134/200 |loss: 13.949298| train set 1.506x speedup, test set 2.318x speedup, val set 0.997x speedup, step: 20
Epoch 135/200 |loss: 13.861455| train set 1.417x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 21
Epoch 136/200 |loss: 13.973184| train set 1.501x speedup, test set 2.230x speedup, val set 0.997x speedup, step: 22
Epoch 137/200 |loss: 13.940698| train set 1.539x speedup, test set 1.060x speedup, val set 1.008x speedup, step: 1
Epoch 138/200 |loss: 14.438610| train set 1.506x speedup, test set 2.079x speedup, val set 0.997x speedup, step: 2
Epoch 139/200 |loss: 14.517453| train set 1.413x speedup, test set 1.036x speedup, val set 0.997x speedup, step: 3
Epoch 140/200 |loss: 14.387072| train set 1.489x speedup, test set 2.230x speedup, val set 0.997x speedup, step: 4
Epoch 141/200 |loss: 13.522563| train set 1.459x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 5
Epoch 142/200 |loss: 13.310962| train set 1.507x speedup, test set 1.029x speedup, val set 0.997x speedup, step: 6
Epoch 143/200 |loss: 13.749075| train set 1.519x speedup, test set 2.766x speedup, val set 0.997x speedup, step: 7
Epoch 144/200 |loss: 13.812138| train set 1.536x speedup, test set 1.854x speedup, val set 0.997x speedup, step: 8
Epoch 145/200 |loss: 13.585112| train set 1.551x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 9
Epoch 146/200 |loss: 13.411379| train set 1.537x speedup, test set 2.359x speedup, val set 0.997x speedup, step: 10
Epoch 147/200 |loss: 14.016168| train set 1.445x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 11
Epoch 148/200 |loss: 13.598169| train set 1.513x speedup, test set 2.089x speedup, val set 0.997x speedup, step: 12
Epoch 149/200 |loss: 12.961437| train set 1.519x speedup, test set 2.231x speedup, val set 0.997x speedup, step: 13
Epoch 150/200 |loss: 12.861638| train set 1.549x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 14
Epoch 151/200 |loss: 13.321932| train set 1.501x speedup, test set 2.212x speedup, val set 0.997x speedup, step: 15
Epoch 152/200 |loss: 13.617957| train set 1.501x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 16
Epoch 153/200 |loss: 12.882373| train set 1.499x speedup, test set 1.867x speedup, val set 0.997x speedup, step: 17
Epoch 154/200 |loss: 12.581351| train set 1.519x speedup, test set 2.134x speedup, val set 0.997x speedup, step: 18
Epoch 155/200 |loss: 12.829044| train set 1.540x speedup, test set 1.060x speedup, val set 1.008x speedup, step: 1
Epoch 156/200 |loss: 13.218750| train set 1.488x speedup, test set 2.194x speedup, val set 0.997x speedup, step: 2
Epoch 157/200 |loss: 12.917537| train set 1.471x speedup, test set 1.867x speedup, val set 0.997x speedup, step: 3
Epoch 158/200 |loss: 12.439176| train set 1.538x speedup, test set 1.900x speedup, val set 0.997x speedup, step: 4
Epoch 159/200 |loss: 12.614493| train set 1.537x speedup, test set 1.145x speedup, val set 0.997x speedup, step: 5
Epoch 160/200 |loss: 13.591513| train set 1.501x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 6
Epoch 161/200 |loss: 13.333516| train set 1.539x speedup, test set 1.137x speedup, val set 0.997x speedup, step: 7
Epoch 162/200 |loss: 13.607912| train set 1.484x speedup, test set 2.106x speedup, val set 0.997x speedup, step: 8
Epoch 163/200 |loss: 13.418222| train set 1.541x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 9
Epoch 164/200 |loss: 13.717255| train set 1.519x speedup, test set 2.409x speedup, val set 0.997x speedup, step: 10
Epoch 165/200 |loss: 12.898407| train set 1.499x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 11
Epoch 166/200 |loss: 12.904960| train set 1.517x speedup, test set 1.920x speedup, val set 1.008x speedup, step: 1
Epoch 167/200 |loss: 13.143150| train set 1.472x speedup, test set 2.256x speedup, val set 0.997x speedup, step: 2
Epoch 168/200 |loss: 12.697854| train set 1.414x speedup, test set 1.043x speedup, val set 0.997x speedup, step: 3
Epoch 169/200 |loss: 12.911044| train set 1.556x speedup, test set 1.884x speedup, val set 1.008x speedup, step: 1
Epoch 170/200 |loss: 12.509662| train set 1.561x speedup, test set 2.117x speedup, val set 0.997x speedup, step: 2
Epoch 171/200 |loss: 12.230835| train set 1.472x speedup, test set 1.066x speedup, val set 0.997x speedup, step: 3
Epoch 172/200 |loss: 12.413757| train set 1.471x speedup, test set 1.116x speedup, val set 0.997x speedup, step: 4
Epoch 173/200 |loss: 12.278461| train set 1.545x speedup, test set 1.853x speedup, val set 0.997x speedup, step: 5
Epoch 174/200 |loss: 12.157097| train set 1.520x speedup, test set 1.864x speedup, val set 0.997x speedup, step: 6
Epoch 175/200 |loss: 12.602044| train set 1.496x speedup, test set 1.890x speedup, val set 0.997x speedup, step: 7
Epoch 176/200 |loss: 12.976933| train set 1.514x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 8
Epoch 177/200 |loss: 14.381340| train set 1.519x speedup, test set 1.873x speedup, val set 0.997x speedup, step: 9
Epoch 178/200 |loss: 12.447033| train set 1.496x speedup, test set 1.871x speedup, val set 0.997x speedup, step: 10
Epoch 179/200 |loss: 12.591764| train set 1.471x speedup, test set 1.066x speedup, val set 0.997x speedup, step: 11
Epoch 180/200 |loss: 14.047535| train set 1.520x speedup, test set 1.884x speedup, val set 0.997x speedup, step: 12
Epoch 181/200 |loss: 12.422434| train set 1.527x speedup, test set 1.888x speedup, val set 1.008x speedup, step: 1
Epoch 182/200 |loss: 14.637523| train set 1.501x speedup, test set 1.066x speedup, val set 0.997x speedup, step: 2
Epoch 183/200 |loss: 15.855481| train set 1.418x speedup, test set 1.807x speedup, val set 0.997x speedup, step: 3
Epoch 184/200 |loss: 15.155118| train set 1.482x speedup, test set 1.797x speedup, val set 0.997x speedup, step: 4
Epoch 185/200 |loss: 15.105309| train set 1.503x speedup, test set 1.162x speedup, val set 1.008x speedup, step: 1
Epoch 186/200 |loss: 15.157026| train set 1.412x speedup, test set 1.797x speedup, val set 0.997x speedup, step: 2
Epoch 187/200 |loss: 14.584581| train set 1.392x speedup, test set 1.816x speedup, val set 0.997x speedup, step: 3
Epoch 188/200 |loss: 13.833268| train set 1.543x speedup, test set 1.907x speedup, val set 0.997x speedup, step: 4
Epoch 189/200 |loss: 14.127625| train set 1.434x speedup, test set 2.273x speedup, val set 0.997x speedup, step: 5
Epoch 190/200 |loss: 13.422858| train set 1.519x speedup, test set 1.869x speedup, val set 0.997x speedup, step: 6
Epoch 191/200 |loss: 13.272363| train set 1.415x speedup, test set 1.810x speedup, val set 0.997x speedup, step: 7
Epoch 192/200 |loss: 13.190969| train set 1.527x speedup, test set 2.089x speedup, val set 0.997x speedup, step: 8
Epoch 193/200 |loss: 12.767859| train set 1.538x speedup, test set 1.904x speedup, val set 0.997x speedup, step: 9
Epoch 194/200 |loss: 12.901933| train set 1.475x speedup, test set 1.060x speedup, val set 0.997x speedup, step: 10
Epoch 195/200 |loss: 12.394439| train set 1.489x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 11
Epoch 196/200 |loss: 12.517649| train set 1.524x speedup, test set 1.793x speedup, val set 0.997x speedup, step: 12
Epoch 197/200 |loss: 12.250498| train set 1.556x speedup, test set 2.128x speedup, val set 0.997x speedup, step: 13
Epoch 198/200 |loss: 12.064356| train set 1.513x speedup, test set 1.877x speedup, val set 0.997x speedup, step: 14
Epoch 199/200 |loss: 12.002295| train set 1.514x speedup, test set 1.801x speedup, val set 0.997x speedup, step: 15
Training per epoch cost 0.324 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 9.387s, pg runtime 8.283s, speedup 0.882x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 17.436s, pg runtime 13.945s, speedup 0.800x
13, opt runtime 5.179s, model runtime 5.179s, pg runtime 10.685s, speedup 2.063x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.501s, pg runtime 2.558s, speedup 1.705x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 3.136s, pg runtime 5.620s, speedup 1.792x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 170, train speedup 1.561, test speedup 2.117, val speedup 0.997
best test speedup epoch: 119, train speedup 1.461, test speedup 2.785, val speedup 0.738
best validation speedup epoch: 185, train speedup 1.503, test speedup 1.162, val speedup 1.008
last model at epoch 199, train speedup 1.514, test speedup 1.801, val speedup 0.997
execution cost 0:02:47.051224
==================================================
all print will write to path record/postgresql/join-order-benchmark/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/join-order-benchmark/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (79, 49) (26, 49) (8, 49)
146.13281304438715
-1.0
construct training samples cost 0:00:01.452346, and there are 79 training samples
in channel 9
Epoch 0/200 |loss: 38.142441| train set 0.720x speedup, test set 0.905x speedup, val set 1.013x speedup, step: 1
Epoch 1/200 |loss: 34.467842| train set 0.723x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 2
Epoch 2/200 |loss: 32.486782| train set 0.724x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 3
Epoch 3/200 |loss: 31.474545| train set 0.726x speedup, test set 0.908x speedup, val set 0.485x speedup, step: 4
Epoch 4/200 |loss: 31.159267| train set 0.785x speedup, test set 0.908x speedup, val set 1.029x speedup, step: 5
Epoch 5/200 |loss: 30.787598| train set 0.785x speedup, test set 0.909x speedup, val set 0.999x speedup, step: 6
Epoch 6/200 |loss: 30.442112| train set 0.790x speedup, test set 0.904x speedup, val set 0.999x speedup, step: 7
Epoch 7/200 |loss: 30.079834| train set 0.788x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 8
Epoch 8/200 |loss: 29.695995| train set 1.089x speedup, test set 0.908x speedup, val set 0.999x speedup, step: 9
Epoch 9/200 |loss: 29.379642| train set 1.115x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 10
Epoch 10/200 |loss: 29.083645| train set 1.161x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 11
Epoch 11/200 |loss: 28.800293| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 12
Epoch 12/200 |loss: 28.530998| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 13
Epoch 13/200 |loss: 28.289465| train set 1.148x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 14
Epoch 14/200 |loss: 28.017263| train set 1.178x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 15
Epoch 15/200 |loss: 27.762295| train set 1.155x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 16
Epoch 16/200 |loss: 27.497992| train set 1.231x speedup, test set 1.038x speedup, val set 0.999x speedup, step: 17
Epoch 17/200 |loss: 27.265730| train set 1.236x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 18
Epoch 18/200 |loss: 27.037077| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 19
Epoch 19/200 |loss: 26.847923| train set 1.216x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 20
Epoch 20/200 |loss: 26.891617| train set 1.216x speedup, test set 1.027x speedup, val set 0.932x speedup, step: 21
Epoch 21/200 |loss: 27.065245| train set 1.207x speedup, test set 1.029x speedup, val set 0.999x speedup, step: 22
Epoch 22/200 |loss: 26.226393| train set 1.193x speedup, test set 1.028x speedup, val set 0.999x speedup, step: 23
Epoch 23/200 |loss: 26.616156| train set 1.205x speedup, test set 1.027x speedup, val set 0.932x speedup, step: 24
Epoch 24/200 |loss: 25.978394| train set 1.182x speedup, test set 1.025x speedup, val set 0.932x speedup, step: 25
Epoch 25/200 |loss: 26.066710| train set 1.195x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 26
Epoch 26/200 |loss: 25.613449| train set 1.195x speedup, test set 1.024x speedup, val set 0.999x speedup, step: 27
Epoch 27/200 |loss: 25.578606| train set 1.178x speedup, test set 1.023x speedup, val set 0.932x speedup, step: 28
Epoch 28/200 |loss: 25.357563| train set 1.183x speedup, test set 1.023x speedup, val set 0.932x speedup, step: 29
Epoch 29/200 |loss: 25.134342| train set 1.195x speedup, test set 1.026x speedup, val set 0.999x speedup, step: 30
Epoch 30/200 |loss: 25.054340| train set 1.227x speedup, test set 1.023x speedup, val set 0.999x speedup, step: 31
Epoch 31/200 |loss: 24.671061| train set 1.173x speedup, test set 1.023x speedup, val set 0.930x speedup, step: 32
Epoch 32/200 |loss: 24.717566| train set 1.200x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 33
Epoch 33/200 |loss: 24.305819| train set 1.202x speedup, test set 1.023x speedup, val set 0.997x speedup, step: 34
Epoch 34/200 |loss: 24.268948| train set 1.227x speedup, test set 1.015x speedup, val set 0.930x speedup, step: 35
Epoch 35/200 |loss: 24.160664| train set 1.204x speedup, test set 1.032x speedup, val set 0.930x speedup, step: 36
Epoch 36/200 |loss: 23.781881| train set 1.229x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 37
Epoch 37/200 |loss: 23.971069| train set 1.256x speedup, test set 1.032x speedup, val set 0.930x speedup, step: 38
Epoch 38/200 |loss: 24.065523| train set 1.193x speedup, test set 1.015x speedup, val set 0.999x speedup, step: 39
Epoch 39/200 |loss: 24.045664| train set 1.225x speedup, test set 1.784x speedup, val set 0.930x speedup, step: 40
Epoch 40/200 |loss: 23.728193| train set 1.291x speedup, test set 1.784x speedup, val set 0.930x speedup, step: 41
Epoch 41/200 |loss: 23.336903| train set 1.231x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 42
Epoch 42/200 |loss: 23.312643| train set 1.305x speedup, test set 1.785x speedup, val set 0.930x speedup, step: 43
Epoch 43/200 |loss: 23.007133| train set 1.254x speedup, test set 1.957x speedup, val set 0.930x speedup, step: 44
Epoch 44/200 |loss: 23.061285| train set 1.231x speedup, test set 1.015x speedup, val set 0.997x speedup, step: 45
Epoch 45/200 |loss: 22.866165| train set 1.231x speedup, test set 1.785x speedup, val set 0.997x speedup, step: 46
Epoch 46/200 |loss: 22.440729| train set 1.272x speedup, test set 1.996x speedup, val set 0.930x speedup, step: 47
Epoch 47/200 |loss: 22.671362| train set 1.305x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 48
Epoch 48/200 |loss: 21.996782| train set 1.232x speedup, test set 1.033x speedup, val set 0.997x speedup, step: 49
Epoch 49/200 |loss: 22.156338| train set 1.286x speedup, test set 1.786x speedup, val set 0.998x speedup, step: 50
Epoch 50/200 |loss: 21.750721| train set 1.336x speedup, test set 1.786x speedup, val set 0.930x speedup, step: 51
Epoch 51/200 |loss: 21.595482| train set 1.236x speedup, test set 1.786x speedup, val set 0.997x speedup, step: 52
Epoch 52/200 |loss: 21.547335| train set 1.330x speedup, test set 1.862x speedup, val set 0.998x speedup, step: 53
Epoch 53/200 |loss: 21.293066| train set 1.343x speedup, test set 1.846x speedup, val set 0.998x speedup, step: 54
Epoch 54/200 |loss: 20.974657| train set 1.314x speedup, test set 1.772x speedup, val set 0.998x speedup, step: 55
Epoch 55/200 |loss: 21.066338| train set 1.343x speedup, test set 1.772x speedup, val set 0.998x speedup, step: 56
Epoch 56/200 |loss: 20.721928| train set 1.330x speedup, test set 1.772x speedup, val set 0.998x speedup, step: 57
Epoch 57/200 |loss: 20.694633| train set 1.327x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 58
Epoch 58/200 |loss: 21.200991| train set 1.330x speedup, test set 1.769x speedup, val set 0.998x speedup, step: 59
Epoch 59/200 |loss: 22.019314| train set 1.337x speedup, test set 1.069x speedup, val set 0.997x speedup, step: 60
Epoch 60/200 |loss: 22.877371| train set 1.269x speedup, test set 1.027x speedup, val set 0.997x speedup, step: 61
Epoch 61/200 |loss: 22.012646| train set 1.263x speedup, test set 1.805x speedup, val set 0.993x speedup, step: 62
Epoch 62/200 |loss: 23.350534| train set 1.358x speedup, test set 2.022x speedup, val set 0.701x speedup, step: 63
Epoch 63/200 |loss: 21.362230| train set 1.300x speedup, test set 1.042x speedup, val set 0.997x speedup, step: 64
Epoch 64/200 |loss: 22.388376| train set 1.326x speedup, test set 1.028x speedup, val set 0.997x speedup, step: 65
Epoch 65/200 |loss: 20.661860| train set 1.339x speedup, test set 1.765x speedup, val set 0.997x speedup, step: 66
Epoch 66/200 |loss: 21.688421| train set 1.357x speedup, test set 1.923x speedup, val set 0.998x speedup, step: 67
Epoch 67/200 |loss: 20.812603| train set 1.317x speedup, test set 1.011x speedup, val set 0.998x speedup, step: 68
Epoch 68/200 |loss: 20.654331| train set 1.346x speedup, test set 1.020x speedup, val set 0.998x speedup, step: 69
Epoch 69/200 |loss: 20.707087| train set 1.398x speedup, test set 1.997x speedup, val set 0.998x speedup, step: 70
Epoch 70/200 |loss: 19.919680| train set 1.385x speedup, test set 1.849x speedup, val set 0.998x speedup, step: 71
Epoch 71/200 |loss: 20.397127| train set 1.330x speedup, test set 1.739x speedup, val set 0.997x speedup, step: 72
Epoch 72/200 |loss: 19.710180| train set 1.332x speedup, test set 1.018x speedup, val set 0.997x speedup, step: 73
Epoch 73/200 |loss: 19.862389| train set 1.343x speedup, test set 1.927x speedup, val set 0.997x speedup, step: 74
Epoch 74/200 |loss: 19.377375| train set 1.392x speedup, test set 2.100x speedup, val set 0.998x speedup, step: 75
Epoch 75/200 |loss: 19.512995| train set 1.335x speedup, test set 1.765x speedup, val set 0.997x speedup, step: 76
Epoch 76/200 |loss: 19.018021| train set 1.330x speedup, test set 1.041x speedup, val set 0.997x speedup, step: 77
Epoch 77/200 |loss: 19.173977| train set 1.373x speedup, test set 1.066x speedup, val set 0.997x speedup, step: 78
Epoch 78/200 |loss: 18.681082| train set 1.374x speedup, test set 2.141x speedup, val set 0.931x speedup, step: 79
Epoch 79/200 |loss: 18.815989| train set 1.374x speedup, test set 1.884x speedup, val set 0.997x speedup, step: 80
Epoch 80/200 |loss: 18.462790| train set 1.321x speedup, test set 1.027x speedup, val set 0.997x speedup, step: 81
Epoch 81/200 |loss: 18.378763| train set 1.350x speedup, test set 1.822x speedup, val set 0.998x speedup, step: 82
Epoch 82/200 |loss: 18.165670| train set 1.399x speedup, test set 1.911x speedup, val set 0.997x speedup, step: 83
Epoch 83/200 |loss: 18.014835| train set 1.399x speedup, test set 1.842x speedup, val set 0.997x speedup, step: 84
Epoch 84/200 |loss: 17.951391| train set 1.400x speedup, test set 2.088x speedup, val set 0.997x speedup, step: 85
Epoch 85/200 |loss: 17.661331| train set 1.400x speedup, test set 2.088x speedup, val set 0.997x speedup, step: 86
Epoch 86/200 |loss: 17.577293| train set 1.415x speedup, test set 1.078x speedup, val set 0.997x speedup, step: 87
Epoch 87/200 |loss: 17.591881| train set 1.396x speedup, test set 1.756x speedup, val set 0.997x speedup, step: 88
Epoch 88/200 |loss: 17.967501| train set 1.427x speedup, test set 1.811x speedup, val set 0.738x speedup, step: 89
Epoch 89/200 |loss: 20.403530| train set 1.250x speedup, test set 1.020x speedup, val set 0.537x speedup, step: 90
Epoch 90/200 |loss: 22.108482| train set 1.326x speedup, test set 1.803x speedup, val set 0.998x speedup, step: 91
Epoch 91/200 |loss: 18.216234| train set 1.420x speedup, test set 2.904x speedup, val set 0.701x speedup, step: 92
Epoch 92/200 |loss: 21.185114| train set 1.325x speedup, test set 1.027x speedup, val set 0.997x speedup, step: 93
Epoch 93/200 |loss: 18.390556| train set 1.320x speedup, test set 1.719x speedup, val set 0.998x speedup, step: 94
Epoch 94/200 |loss: 19.624649| train set 1.374x speedup, test set 1.988x speedup, val set 0.998x speedup, step: 95
Epoch 95/200 |loss: 17.770254| train set 1.427x speedup, test set 2.562x speedup, val set 0.738x speedup, step: 96
Epoch 96/200 |loss: 19.187370| train set 1.400x speedup, test set 1.884x speedup, val set 0.997x speedup, step: 97
Epoch 97/200 |loss: 17.687584| train set 1.338x speedup, test set 1.768x speedup, val set 0.997x speedup, step: 98
Epoch 98/200 |loss: 18.351471| train set 1.385x speedup, test set 1.052x speedup, val set 0.997x speedup, step: 99
Epoch 99/200 |loss: 17.522818| train set 1.400x speedup, test set 2.132x speedup, val set 0.997x speedup, step: 100
Epoch 100/200 |loss: 17.732864| train set 1.380x speedup, test set 2.127x speedup, val set 0.997x speedup, step: 1
Epoch 101/200 |loss: 17.065371| train set 1.395x speedup, test set 1.826x speedup, val set 0.997x speedup, step: 1
Epoch 102/200 |loss: 17.324129| train set 1.396x speedup, test set 1.034x speedup, val set 0.997x speedup, step: 1
Epoch 103/200 |loss: 16.784517| train set 1.400x speedup, test set 2.024x speedup, val set 0.997x speedup, step: 1
Epoch 104/200 |loss: 16.774231| train set 1.417x speedup, test set 1.431x speedup, val set 0.997x speedup, step: 1
Epoch 105/200 |loss: 16.511383| train set 1.388x speedup, test set 1.067x speedup, val set 0.997x speedup, step: 1
Epoch 106/200 |loss: 16.564886| train set 1.414x speedup, test set 1.074x speedup, val set 0.997x speedup, step: 1
Epoch 107/200 |loss: 16.275644| train set 1.416x speedup, test set 1.426x speedup, val set 0.997x speedup, step: 1
Epoch 108/200 |loss: 16.461660| train set 1.400x speedup, test set 1.989x speedup, val set 0.997x speedup, step: 1
Epoch 109/200 |loss: 16.337566| train set 1.401x speedup, test set 1.089x speedup, val set 0.997x speedup, step: 1
Epoch 110/200 |loss: 16.910261| train set 1.414x speedup, test set 1.913x speedup, val set 0.997x speedup, step: 1
Epoch 111/200 |loss: 16.350637| train set 1.413x speedup, test set 1.102x speedup, val set 0.997x speedup, step: 1
Epoch 112/200 |loss: 15.999614| train set 1.414x speedup, test set 1.044x speedup, val set 0.997x speedup, step: 1
Epoch 113/200 |loss: 15.522217| train set 1.416x speedup, test set 1.988x speedup, val set 0.997x speedup, step: 1
Epoch 114/200 |loss: 15.590456| train set 1.416x speedup, test set 1.118x speedup, val set 0.997x speedup, step: 1
Epoch 115/200 |loss: 16.023108| train set 1.420x speedup, test set 2.119x speedup, val set 0.997x speedup, step: 1
Epoch 116/200 |loss: 15.398350| train set 1.416x speedup, test set 1.085x speedup, val set 0.997x speedup, step: 1
Epoch 117/200 |loss: 15.060344| train set 1.520x speedup, test set 1.455x speedup, val set 0.997x speedup, step: 1
Epoch 118/200 |loss: 15.007810| train set 1.392x speedup, test set 1.894x speedup, val set 0.997x speedup, step: 1
Epoch 119/200 |loss: 15.160388| train set 1.389x speedup, test set 1.487x speedup, val set 0.997x speedup, step: 1
Epoch 120/200 |loss: 15.554833| train set 1.504x speedup, test set 2.112x speedup, val set 0.997x speedup, step: 1
Epoch 121/200 |loss: 14.900517| train set 1.502x speedup, test set 1.129x speedup, val set 0.997x speedup, step: 1
Epoch 122/200 |loss: 14.586014| train set 1.411x speedup, test set 2.006x speedup, val set 0.997x speedup, step: 1
Epoch 123/200 |loss: 14.449670| train set 1.420x speedup, test set 2.116x speedup, val set 0.997x speedup, step: 1
Epoch 124/200 |loss: 14.292380| train set 1.502x speedup, test set 1.135x speedup, val set 0.997x speedup, step: 1
Epoch 125/200 |loss: 14.487452| train set 1.412x speedup, test set 2.122x speedup, val set 0.997x speedup, step: 1
Epoch 126/200 |loss: 15.107463| train set 1.428x speedup, test set 1.063x speedup, val set 1.008x speedup, step: 1
Epoch 127/200 |loss: 17.725706| train set 1.512x speedup, test set 2.608x speedup, val set 0.993x speedup, step: 2
Epoch 128/200 |loss: 17.736946| train set 1.421x speedup, test set 1.039x speedup, val set 1.008x speedup, step: 1
Epoch 129/200 |loss: 19.116991| train set 1.501x speedup, test set 1.091x speedup, val set 0.997x speedup, step: 2
Epoch 130/200 |loss: 18.916155| train set 1.387x speedup, test set 1.091x speedup, val set 0.997x speedup, step: 3
Epoch 131/200 |loss: 17.358618| train set 1.394x speedup, test set 1.894x speedup, val set 0.999x speedup, step: 4
Epoch 132/200 |loss: 19.001463| train set 1.450x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 5
Epoch 133/200 |loss: 16.320740| train set 1.501x speedup, test set 1.409x speedup, val set 0.997x speedup, step: 6
Epoch 134/200 |loss: 17.207933| train set 1.409x speedup, test set 1.898x speedup, val set 0.997x speedup, step: 7
Epoch 135/200 |loss: 15.788445| train set 1.338x speedup, test set 1.895x speedup, val set 0.997x speedup, step: 8
Epoch 136/200 |loss: 16.395140| train set 1.427x speedup, test set 1.960x speedup, val set 0.997x speedup, step: 9
Epoch 137/200 |loss: 15.704927| train set 1.520x speedup, test set 1.885x speedup, val set 0.997x speedup, step: 10
Epoch 138/200 |loss: 15.551062| train set 1.502x speedup, test set 1.884x speedup, val set 0.997x speedup, step: 11
Epoch 139/200 |loss: 15.347207| train set 1.416x speedup, test set 1.898x speedup, val set 0.997x speedup, step: 12
Epoch 140/200 |loss: 15.248133| train set 1.455x speedup, test set 2.000x speedup, val set 0.997x speedup, step: 13
Epoch 141/200 |loss: 14.781105| train set 1.425x speedup, test set 2.000x speedup, val set 0.997x speedup, step: 14
Epoch 142/200 |loss: 14.847422| train set 1.519x speedup, test set 1.101x speedup, val set 0.997x speedup, step: 15
Epoch 143/200 |loss: 14.455755| train set 1.502x speedup, test set 1.067x speedup, val set 0.997x speedup, step: 16
Epoch 144/200 |loss: 14.451645| train set 1.426x speedup, test set 2.019x speedup, val set 0.997x speedup, step: 17
Epoch 145/200 |loss: 14.399266| train set 1.456x speedup, test set 1.100x speedup, val set 0.997x speedup, step: 18
Epoch 146/200 |loss: 14.044598| train set 1.453x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 19
Epoch 147/200 |loss: 14.036999| train set 1.507x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 20
Epoch 148/200 |loss: 13.848040| train set 1.502x speedup, test set 1.992x speedup, val set 0.997x speedup, step: 21
Epoch 149/200 |loss: 13.800618| train set 1.501x speedup, test set 1.106x speedup, val set 0.997x speedup, step: 22
Epoch 150/200 |loss: 13.530061| train set 1.468x speedup, test set 2.015x speedup, val set 0.997x speedup, step: 23
Epoch 151/200 |loss: 13.533701| train set 1.510x speedup, test set 1.094x speedup, val set 0.997x speedup, step: 24
Epoch 152/200 |loss: 13.347919| train set 1.419x speedup, test set 1.927x speedup, val set 0.997x speedup, step: 25
Epoch 153/200 |loss: 13.370003| train set 1.505x speedup, test set 1.927x speedup, val set 0.997x speedup, step: 26
Epoch 154/200 |loss: 13.079105| train set 1.539x speedup, test set 1.072x speedup, val set 0.997x speedup, step: 27
Epoch 155/200 |loss: 13.089648| train set 1.529x speedup, test set 1.990x speedup, val set 0.997x speedup, step: 28
Epoch 156/200 |loss: 13.021260| train set 1.518x speedup, test set 2.015x speedup, val set 0.997x speedup, step: 29
Epoch 157/200 |loss: 12.840675| train set 1.505x speedup, test set 1.927x speedup, val set 0.997x speedup, step: 30
Epoch 158/200 |loss: 12.804523| train set 1.523x speedup, test set 1.910x speedup, val set 0.997x speedup, step: 31
Epoch 159/200 |loss: 12.617723| train set 1.518x speedup, test set 1.924x speedup, val set 0.997x speedup, step: 32
Epoch 160/200 |loss: 12.564684| train set 1.562x speedup, test set 1.925x speedup, val set 0.997x speedup, step: 33
Epoch 161/200 |loss: 12.530920| train set 1.518x speedup, test set 1.927x speedup, val set 0.997x speedup, step: 34
Epoch 162/200 |loss: 12.498213| train set 1.491x speedup, test set 1.997x speedup, val set 0.997x speedup, step: 35
Epoch 163/200 |loss: 12.511322| train set 1.519x speedup, test set 1.079x speedup, val set 0.997x speedup, step: 36
Epoch 164/200 |loss: 12.918859| train set 1.490x speedup, test set 1.998x speedup, val set 0.997x speedup, step: 37
Epoch 165/200 |loss: 13.619026| train set 1.535x speedup, test set 1.080x speedup, val set 0.997x speedup, step: 38
Epoch 166/200 |loss: 15.503071| train set 1.507x speedup, test set 2.033x speedup, val set 0.997x speedup, step: 39
Epoch 167/200 |loss: 12.881351| train set 1.524x speedup, test set 1.902x speedup, val set 1.008x speedup, step: 1
Epoch 168/200 |loss: 13.960372| train set 1.500x speedup, test set 1.087x speedup, val set 0.997x speedup, step: 2
Epoch 169/200 |loss: 15.845187| train set 1.427x speedup, test set 1.826x speedup, val set 0.997x speedup, step: 3
Epoch 170/200 |loss: 14.691552| train set 1.488x speedup, test set 2.010x speedup, val set 0.997x speedup, step: 4
Epoch 171/200 |loss: 15.305233| train set 1.459x speedup, test set 1.117x speedup, val set 0.997x speedup, step: 5
Epoch 172/200 |loss: 15.003211| train set 1.413x speedup, test set 1.048x speedup, val set 0.997x speedup, step: 6
Epoch 173/200 |loss: 14.387430| train set 1.456x speedup, test set 1.916x speedup, val set 0.997x speedup, step: 7
Epoch 174/200 |loss: 13.808334| train set 1.533x speedup, test set 2.181x speedup, val set 1.008x speedup, step: 1
Epoch 175/200 |loss: 13.848673| train set 1.520x speedup, test set 1.072x speedup, val set 0.997x speedup, step: 2
Epoch 176/200 |loss: 13.567397| train set 1.470x speedup, test set 1.928x speedup, val set 0.997x speedup, step: 3
Epoch 177/200 |loss: 13.405575| train set 1.512x speedup, test set 1.920x speedup, val set 1.008x speedup, step: 1
Epoch 178/200 |loss: 13.087813| train set 1.515x speedup, test set 1.919x speedup, val set 1.008x speedup, step: 1
Epoch 179/200 |loss: 13.049286| train set 1.548x speedup, test set 1.925x speedup, val set 0.997x speedup, step: 2
Epoch 180/200 |loss: 12.854134| train set 1.519x speedup, test set 1.926x speedup, val set 0.997x speedup, step: 3
Epoch 181/200 |loss: 12.689278| train set 1.519x speedup, test set 1.927x speedup, val set 0.997x speedup, step: 4
Epoch 182/200 |loss: 12.545219| train set 1.520x speedup, test set 1.066x speedup, val set 0.997x speedup, step: 5
Epoch 183/200 |loss: 12.445351| train set 1.584x speedup, test set 1.078x speedup, val set 0.997x speedup, step: 6
Epoch 184/200 |loss: 12.408252| train set 1.563x speedup, test set 1.917x speedup, val set 0.997x speedup, step: 7
Epoch 185/200 |loss: 12.229785| train set 1.519x speedup, test set 1.920x speedup, val set 0.997x speedup, step: 8
Epoch 186/200 |loss: 12.175378| train set 1.559x speedup, test set 1.917x speedup, val set 0.997x speedup, step: 9
Epoch 187/200 |loss: 12.001764| train set 1.546x speedup, test set 1.920x speedup, val set 0.997x speedup, step: 10
Epoch 188/200 |loss: 12.032312| train set 1.563x speedup, test set 1.070x speedup, val set 0.997x speedup, step: 11
Epoch 189/200 |loss: 11.800987| train set 1.488x speedup, test set 1.920x speedup, val set 0.997x speedup, step: 12
Epoch 190/200 |loss: 11.868589| train set 1.523x speedup, test set 1.069x speedup, val set 0.997x speedup, step: 13
Epoch 191/200 |loss: 11.782583| train set 1.545x speedup, test set 1.906x speedup, val set 0.997x speedup, step: 14
Epoch 192/200 |loss: 11.817533| train set 1.524x speedup, test set 1.076x speedup, val set 0.997x speedup, step: 15
Epoch 193/200 |loss: 11.922490| train set 1.477x speedup, test set 1.906x speedup, val set 0.997x speedup, step: 16
Epoch 194/200 |loss: 11.999872| train set 1.537x speedup, test set 1.076x speedup, val set 0.997x speedup, step: 17
Epoch 195/200 |loss: 11.934772| train set 1.524x speedup, test set 1.920x speedup, val set 0.997x speedup, step: 18
Epoch 196/200 |loss: 11.642697| train set 1.564x speedup, test set 1.917x speedup, val set 0.997x speedup, step: 19
Epoch 197/200 |loss: 11.385121| train set 1.526x speedup, test set 1.917x speedup, val set 0.997x speedup, step: 20
Epoch 198/200 |loss: 11.329463| train set 1.488x speedup, test set 1.920x speedup, val set 0.997x speedup, step: 21
Epoch 199/200 |loss: 11.377615| train set 1.542x speedup, test set 1.069x speedup, val set 0.997x speedup, step: 22
Training per epoch cost 0.324 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
08, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.317s, pg runtime 2.352s, speedup 7.417x
12, opt runtime 4.443s, model runtime 14.967s, pg runtime 13.945s, speedup 0.932x
13, opt runtime 5.179s, model runtime 5.179s, pg runtime 10.685s, speedup 2.063x
14, opt runtime 0.157s, model runtime 0.164s, pg runtime 0.393s, speedup 2.396x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
19, opt runtime 0.379s, model runtime 0.669s, pg runtime 3.645s, speedup 5.451x
20, opt runtime 0.626s, model runtime 1.404s, pg runtime 2.558s, speedup 1.822x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 1.311s, pg runtime 0.965s, speedup 0.736x
====================
best train speedup epoch: 183, train speedup 1.584, test speedup 1.078, val speedup 0.997
best test speedup epoch: 91, train speedup 1.420, test speedup 2.904, val speedup 0.701
best validation speedup epoch: 178, train speedup 1.515, test speedup 1.919, val speedup 1.008
last model at epoch 199, train speedup 1.542, test speedup 1.069, val speedup 0.997
execution cost 0:02:47.653185
==================================================
