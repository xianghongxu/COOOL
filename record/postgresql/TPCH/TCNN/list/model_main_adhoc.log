all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.894794, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641937| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934926| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014945| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205910| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655495| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.537994| train set 7.359x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.532386| train set 6.716x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.780485| train set 7.629x speedup, test set 0.863x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.534173| train set 7.691x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.743602| train set 7.083x speedup, test set 0.961x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.621724| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.710897| train set 8.138x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 14.038986| train set 8.137x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.625719| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 12.766168| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 17
Epoch 17/200 |loss: 12.942962| train set 8.275x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 18
Epoch 18/200 |loss: 13.534698| train set 8.275x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 13.788445| train set 8.338x speedup, test set 0.642x speedup, val set 1.013x speedup, step: 20
Epoch 20/200 |loss: 13.112765| train set 8.275x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 21
Epoch 21/200 |loss: 12.726889| train set 8.275x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 22
Epoch 22/200 |loss: 12.762541| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.245675| train set 8.138x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 24
Epoch 24/200 |loss: 12.489500| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 25
Epoch 25/200 |loss: 12.087124| train set 7.744x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 26
Epoch 26/200 |loss: 11.402078| train set 8.274x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 27
Epoch 27/200 |loss: 10.946761| train set 8.275x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 28
Epoch 28/200 |loss: 11.889830| train set 8.276x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 29
Epoch 29/200 |loss: 12.248159| train set 7.747x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 30
Epoch 30/200 |loss: 11.251270| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 31
Epoch 31/200 |loss: 11.600803| train set 8.339x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 32
Epoch 32/200 |loss: 9.925129| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33
Epoch 33/200 |loss: 10.790546| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 10.642207| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 35
Epoch 35/200 |loss: 10.596401| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 36
Epoch 36/200 |loss: 10.413888| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 37
Epoch 37/200 |loss: 10.047544| train set 8.138x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 38
Epoch 38/200 |loss: 10.603532| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 39
Epoch 39/200 |loss: 10.428123| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 40
Epoch 40/200 |loss: 10.141996| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 41
Epoch 41/200 |loss: 10.201827| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 42
Epoch 42/200 |loss: 9.896929| train set 8.084x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 43
Epoch 43/200 |loss: 13.815588| train set 7.745x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 44
Epoch 44/200 |loss: 11.786485| train set 8.339x speedup, test set 0.838x speedup, val set 0.720x speedup, step: 45
Epoch 45/200 |loss: 10.402164| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 46
Epoch 46/200 |loss: 11.218084| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 47
Epoch 47/200 |loss: 10.244309| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 48
Epoch 48/200 |loss: 10.900132| train set 8.340x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 10.592872| train set 8.340x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 50
Epoch 50/200 |loss: 9.817345| train set 8.339x speedup, test set 1.214x speedup, val set 0.714x speedup, step: 51
Epoch 51/200 |loss: 11.657132| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 52
Epoch 52/200 |loss: 9.508141| train set 8.340x speedup, test set 0.722x speedup, val set 1.013x speedup, step: 53
Epoch 53/200 |loss: 10.061222| train set 8.340x speedup, test set 0.722x speedup, val set 0.720x speedup, step: 54
Epoch 54/200 |loss: 9.658667| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 55
Epoch 55/200 |loss: 9.164003| train set 8.339x speedup, test set 0.892x speedup, val set 0.720x speedup, step: 56
Epoch 56/200 |loss: 10.150358| train set 8.185x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 57
Epoch 57/200 |loss: 9.969971| train set 8.339x speedup, test set 0.925x speedup, val set 0.720x speedup, step: 58
Epoch 58/200 |loss: 9.082321| train set 7.747x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 59
Epoch 59/200 |loss: 10.342960| train set 8.184x speedup, test set 0.714x speedup, val set 0.714x speedup, step: 60
Epoch 60/200 |loss: 8.034211| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 61
Epoch 61/200 |loss: 10.091982| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 11.276723| train set 8.338x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 63
Epoch 63/200 |loss: 10.012538| train set 8.339x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 64
Epoch 64/200 |loss: 9.623801| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 65
Epoch 65/200 |loss: 10.504620| train set 8.332x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 66
Epoch 66/200 |loss: 9.919498| train set 8.332x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 9.675467| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 68
Epoch 68/200 |loss: 7.746351| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 69
Epoch 69/200 |loss: 10.462762| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 70
Epoch 70/200 |loss: 10.691493| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 71
Epoch 71/200 |loss: 8.858688| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 72
Epoch 72/200 |loss: 10.020604| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 8.867149| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 74
Epoch 74/200 |loss: 8.799572| train set 8.340x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 75
Epoch 75/200 |loss: 10.618081| train set 8.340x speedup, test set 1.194x speedup, val set 0.720x speedup, step: 76
Epoch 76/200 |loss: 9.332188| train set 8.339x speedup, test set 1.214x speedup, val set 0.824x speedup, step: 77
Epoch 77/200 |loss: 10.273144| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 78
Epoch 78/200 |loss: 9.150776| train set 8.340x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 79
Epoch 79/200 |loss: 9.651268| train set 8.340x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 80
Epoch 80/200 |loss: 9.686116| train set 8.339x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 81
Epoch 81/200 |loss: 7.275224| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 82
Epoch 82/200 |loss: 9.472009| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 83
Epoch 83/200 |loss: 9.616486| train set 8.185x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 84
Epoch 84/200 |loss: 7.992521| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 85
Epoch 85/200 |loss: 9.848448| train set 8.339x speedup, test set 0.892x speedup, val set 1.013x speedup, step: 86
Epoch 86/200 |loss: 8.405229| train set 8.339x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 87
Epoch 87/200 |loss: 10.000221| train set 8.339x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 88
Epoch 88/200 |loss: 10.223137| train set 8.339x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 89
Epoch 89/200 |loss: 9.508012| train set 8.184x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 9.555933| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 91
Epoch 91/200 |loss: 8.609800| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 92
Epoch 92/200 |loss: 9.590388| train set 8.340x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 93
Epoch 93/200 |loss: 8.910099| train set 8.340x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 8.520901| train set 8.339x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 95
Epoch 95/200 |loss: 10.286580| train set 8.339x speedup, test set 1.108x speedup, val set 0.720x speedup, step: 96
Epoch 96/200 |loss: 9.489995| train set 8.185x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 97
Epoch 97/200 |loss: 8.668753| train set 8.185x speedup, test set 1.214x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 8.548331| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 99
Epoch 99/200 |loss: 9.708798| train set 8.171x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 100
Epoch 100/200 |loss: 8.542937| train set 8.333x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 1
Epoch 101/200 |loss: 10.254607| train set 8.333x speedup, test set 0.714x speedup, val set 0.714x speedup, step: 1
Epoch 102/200 |loss: 8.919430| train set 8.333x speedup, test set 0.914x speedup, val set 0.720x speedup, step: 1
Epoch 103/200 |loss: 8.479440| train set 8.334x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 104/200 |loss: 9.163941| train set 8.339x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 105/200 |loss: 9.857476| train set 8.185x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 2
Epoch 106/200 |loss: 9.770049| train set 8.185x speedup, test set 0.738x speedup, val set 0.721x speedup, step: 3
Epoch 107/200 |loss: 8.988461| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 108/200 |loss: 9.132808| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 109/200 |loss: 8.007060| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 3
Epoch 110/200 |loss: 9.496700| train set 8.339x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 4
Epoch 111/200 |loss: 9.379282| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 5
Epoch 112/200 |loss: 7.604154| train set 7.819x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 6
Epoch 113/200 |loss: 9.093827| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 7
Epoch 114/200 |loss: 7.996405| train set 8.339x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 115/200 |loss: 8.578108| train set 7.747x speedup, test set 0.747x speedup, val set 0.974x speedup, step: 2
Epoch 116/200 |loss: 8.153844| train set 8.340x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 3
Epoch 117/200 |loss: 9.518926| train set 8.340x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 118/200 |loss: 9.161304| train set 8.340x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 119/200 |loss: 9.328526| train set 8.340x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 120/200 |loss: 8.027550| train set 8.185x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 121/200 |loss: 8.272484| train set 8.185x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 3
Epoch 122/200 |loss: 8.263188| train set 8.339x speedup, test set 1.108x speedup, val set 1.013x speedup, step: 1
Epoch 123/200 |loss: 8.638216| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 124/200 |loss: 8.345118| train set 8.339x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 2
Epoch 125/200 |loss: 7.094879| train set 8.338x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 3
Epoch 126/200 |loss: 8.415751| train set 8.338x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 4
Epoch 127/200 |loss: 9.395389| train set 8.338x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 128/200 |loss: 8.047937| train set 8.339x speedup, test set 0.903x speedup, val set 1.000x speedup, step: 2
Epoch 129/200 |loss: 7.925262| train set 8.339x speedup, test set 1.143x speedup, val set 1.000x speedup, step: 3
Epoch 130/200 |loss: 9.201479| train set 7.818x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 4
Epoch 131/200 |loss: 8.808639| train set 8.339x speedup, test set 1.143x speedup, val set 0.716x speedup, step: 5
Epoch 132/200 |loss: 9.130587| train set 8.185x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 6
Epoch 133/200 |loss: 7.999063| train set 8.185x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 7
Epoch 134/200 |loss: 9.442954| train set 8.185x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 8
Epoch 135/200 |loss: 9.040886| train set 8.185x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 9
Epoch 136/200 |loss: 7.652017| train set 8.185x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 10
Epoch 137/200 |loss: 8.872881| train set 8.185x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 138/200 |loss: 8.894136| train set 8.185x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 139/200 |loss: 9.205037| train set 8.184x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 140/200 |loss: 9.194919| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 3
Epoch 141/200 |loss: 10.810874| train set 8.339x speedup, test set 0.822x speedup, val set 0.714x speedup, step: 4
Epoch 142/200 |loss: 7.177536| train set 8.339x speedup, test set 0.952x speedup, val set 0.714x speedup, step: 5
Epoch 143/200 |loss: 9.122485| train set 8.339x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 6
Epoch 144/200 |loss: 8.962523| train set 8.339x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 145/200 |loss: 8.896360| train set 8.339x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 146/200 |loss: 9.162417| train set 8.332x speedup, test set 0.903x speedup, val set 1.013x speedup, step: 1
Epoch 147/200 |loss: 8.464720| train set 8.332x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 148/200 |loss: 8.674650| train set 8.339x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 149/200 |loss: 10.039127| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2
Epoch 150/200 |loss: 8.217047| train set 8.184x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 151/200 |loss: 9.048996| train set 8.183x speedup, test set 0.722x speedup, val set 1.013x speedup, step: 1
Epoch 152/200 |loss: 8.873206| train set 8.337x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 153/200 |loss: 7.775257| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 154/200 |loss: 9.919974| train set 8.185x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 155/200 |loss: 8.911139| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 156/200 |loss: 10.187234| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 157/200 |loss: 9.119689| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 158/200 |loss: 8.476273| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 159/200 |loss: 9.229801| train set 7.683x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 160/200 |loss: 9.873105| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 161/200 |loss: 8.301945| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 162/200 |loss: 9.168156| train set 8.340x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 163/200 |loss: 8.186843| train set 8.185x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 164/200 |loss: 7.295304| train set 8.339x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 165/200 |loss: 7.188727| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 166/200 |loss: 8.206727| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 167/200 |loss: 8.385875| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 168/200 |loss: 7.484209| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 169/200 |loss: 8.564658| train set 8.337x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 170/200 |loss: 9.130593| train set 8.338x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 171/200 |loss: 8.472664| train set 8.338x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2
Epoch 172/200 |loss: 9.151203| train set 8.338x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 173/200 |loss: 9.048318| train set 8.185x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 174/200 |loss: 8.732074| train set 8.332x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 175/200 |loss: 8.118067| train set 8.332x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 3
Epoch 176/200 |loss: 8.116753| train set 8.332x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 4
Epoch 177/200 |loss: 8.652756| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 5
Epoch 178/200 |loss: 8.233570| train set 8.339x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 179/200 |loss: 8.620530| train set 8.338x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 2
Epoch 180/200 |loss: 8.377942| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 3
Epoch 181/200 |loss: 8.788852| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 4
Epoch 182/200 |loss: 8.603210| train set 8.184x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 5
Epoch 183/200 |loss: 9.229411| train set 8.184x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 6
Epoch 184/200 |loss: 8.009014| train set 8.185x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 185/200 |loss: 6.474599| train set 8.184x speedup, test set 0.722x speedup, val set 0.720x speedup, step: 2
Epoch 186/200 |loss: 9.472681| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 3
Epoch 187/200 |loss: 7.812226| train set 8.332x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 188/200 |loss: 8.787595| train set 8.339x speedup, test set 0.722x speedup, val set 1.013x speedup, step: 1
Epoch 189/200 |loss: 8.606105| train set 8.339x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 190/200 |loss: 9.109057| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 191/200 |loss: 8.783832| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 192/200 |loss: 8.425391| train set 8.339x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 193/200 |loss: 8.017088| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2
Epoch 194/200 |loss: 8.132025| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 3
Epoch 195/200 |loss: 8.728812| train set 8.183x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 4
Epoch 196/200 |loss: 8.755039| train set 8.183x speedup, test set 0.747x speedup, val set 1.011x speedup, step: 5
Epoch 197/200 |loss: 8.347707| train set 8.337x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 198/200 |loss: 7.763285| train set 8.338x speedup, test set 0.766x speedup, val set 0.720x speedup, step: 2
Epoch 199/200 |loss: 8.982514| train set 8.338x speedup, test set 0.757x speedup, val set 0.781x speedup, step: 3
Training per epoch cost 0.987 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
23, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
24, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
25, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
26, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
27, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
28, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
29, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
30, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 41, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 43, train speedup 7.745, test speedup 1.299, val speedup 0.720
best validation speedup epoch: 197, train speedup 8.337, test speedup 1.143, val speedup 1.013
last model at epoch 199, train speedup 8.338, test speedup 0.757, val speedup 0.781
execution cost 0:08:14.069908
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.914535, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641940| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934926| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014946| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205909| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655497| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.537998| train set 7.359x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.532398| train set 6.716x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.780462| train set 7.629x speedup, test set 0.863x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.534472| train set 7.691x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.741853| train set 7.083x speedup, test set 0.961x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.627442| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.714662| train set 8.077x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 14.028495| train set 8.137x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.605297| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 12.716295| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 17
Epoch 17/200 |loss: 13.058122| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 18
Epoch 18/200 |loss: 13.432127| train set 8.275x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 13.840525| train set 8.338x speedup, test set 0.642x speedup, val set 1.013x speedup, step: 20
Epoch 20/200 |loss: 12.913313| train set 8.275x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 21
Epoch 21/200 |loss: 12.861333| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 22
Epoch 22/200 |loss: 12.597028| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.314208| train set 8.077x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 24
Epoch 24/200 |loss: 12.626339| train set 8.275x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 25
Epoch 25/200 |loss: 11.716460| train set 7.762x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 26
Epoch 26/200 |loss: 11.323435| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 27
Epoch 27/200 |loss: 10.582351| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 28
Epoch 28/200 |loss: 11.831714| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 29
Epoch 29/200 |loss: 11.990348| train set 8.338x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 30
Epoch 30/200 |loss: 11.188187| train set 7.747x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 31
Epoch 31/200 |loss: 11.462599| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 32
Epoch 32/200 |loss: 9.943759| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33
Epoch 33/200 |loss: 10.682423| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 10.791292| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 35
Epoch 35/200 |loss: 10.365708| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 36
Epoch 36/200 |loss: 10.421830| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 37
Epoch 37/200 |loss: 9.786287| train set 8.138x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 38
Epoch 38/200 |loss: 10.491963| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 39
Epoch 39/200 |loss: 10.456164| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 40
Epoch 40/200 |loss: 10.293803| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 41
Epoch 41/200 |loss: 10.791370| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 42
Epoch 42/200 |loss: 9.781074| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 43
Epoch 43/200 |loss: 14.180285| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 44
Epoch 44/200 |loss: 12.032832| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 45
Epoch 45/200 |loss: 11.013662| train set 8.138x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 46
Epoch 46/200 |loss: 11.260726| train set 8.178x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 47
Epoch 47/200 |loss: 10.697033| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 48
Epoch 48/200 |loss: 11.115380| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 10.911768| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 50
Epoch 50/200 |loss: 9.854012| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 51
Epoch 51/200 |loss: 11.550144| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 52
Epoch 52/200 |loss: 9.398992| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 53
Epoch 53/200 |loss: 9.832052| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 54
Epoch 54/200 |loss: 9.639481| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 55
Epoch 55/200 |loss: 9.112313| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 56
Epoch 56/200 |loss: 9.934442| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 57
Epoch 57/200 |loss: 9.422752| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 58
Epoch 58/200 |loss: 9.068259| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 59
Epoch 59/200 |loss: 9.807625| train set 8.325x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 60
Epoch 60/200 |loss: 8.109640| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 61
Epoch 61/200 |loss: 9.729513| train set 8.340x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 11.236606| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 63
Epoch 63/200 |loss: 9.568693| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 64
Epoch 64/200 |loss: 9.517015| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 65
Epoch 65/200 |loss: 10.359608| train set 8.339x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 66
Epoch 66/200 |loss: 10.325377| train set 8.328x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 9.750225| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 68
Epoch 68/200 |loss: 7.680798| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 69
Epoch 69/200 |loss: 10.496545| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 70
Epoch 70/200 |loss: 10.558295| train set 8.116x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 71
Epoch 71/200 |loss: 8.617005| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 72
Epoch 72/200 |loss: 10.004262| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 8.490022| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 74
Epoch 74/200 |loss: 8.729944| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 75
Epoch 75/200 |loss: 10.585452| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 76
Epoch 76/200 |loss: 9.367375| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 77
Epoch 77/200 |loss: 10.124943| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 78
Epoch 78/200 |loss: 8.866243| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 79
Epoch 79/200 |loss: 9.626785| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 80
Epoch 80/200 |loss: 9.729681| train set 8.340x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 81
Epoch 81/200 |loss: 7.240145| train set 7.818x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 82
Epoch 82/200 |loss: 9.394080| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 83
Epoch 83/200 |loss: 9.477790| train set 8.185x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 84
Epoch 84/200 |loss: 8.080594| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 85
Epoch 85/200 |loss: 9.793649| train set 8.137x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 86
Epoch 86/200 |loss: 8.530780| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 87
Epoch 87/200 |loss: 10.077155| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 88
Epoch 88/200 |loss: 9.983954| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 89
Epoch 89/200 |loss: 9.555766| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 9.767452| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 91
Epoch 91/200 |loss: 8.665419| train set 8.339x speedup, test set 0.685x speedup, val set 0.720x speedup, step: 92
Epoch 92/200 |loss: 9.640160| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 93
Epoch 93/200 |loss: 8.843946| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 8.815898| train set 8.339x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 95
Epoch 95/200 |loss: 10.200538| train set 7.819x speedup, test set 1.317x speedup, val set 0.720x speedup, step: 96
Epoch 96/200 |loss: 9.982251| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 97
Epoch 97/200 |loss: 8.645396| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 8.814312| train set 8.117x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 9.817261| train set 7.806x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 100
Epoch 100/200 |loss: 8.356667| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 101
Epoch 101/200 |loss: 10.656774| train set 8.333x speedup, test set 1.108x speedup, val set 1.000x speedup, step: 102
Epoch 102/200 |loss: 9.233598| train set 8.179x speedup, test set 0.728x speedup, val set 1.000x speedup, step: 103
Epoch 103/200 |loss: 8.661934| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 104
Epoch 104/200 |loss: 9.129288| train set 8.185x speedup, test set 1.299x speedup, val set 1.000x speedup, step: 105
Epoch 105/200 |loss: 9.901337| train set 8.339x speedup, test set 1.299x speedup, val set 1.000x speedup, step: 106
Epoch 106/200 |loss: 9.687627| train set 8.185x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 107
Epoch 107/200 |loss: 9.054659| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 108
Epoch 108/200 |loss: 9.300606| train set 8.337x speedup, test set 0.892x speedup, val set 0.720x speedup, step: 109
Epoch 109/200 |loss: 8.252846| train set 8.339x speedup, test set 1.299x speedup, val set 0.714x speedup, step: 110
Epoch 110/200 |loss: 9.545643| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 111
Epoch 111/200 |loss: 9.630421| train set 8.339x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 112
Epoch 112/200 |loss: 7.671723| train set 7.819x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 113
Epoch 113/200 |loss: 9.416186| train set 8.339x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 114
Epoch 114/200 |loss: 8.679498| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 115/200 |loss: 8.712243| train set 8.339x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 2
Epoch 116/200 |loss: 8.176111| train set 8.340x speedup, test set 1.143x speedup, val set 1.000x speedup, step: 3
Epoch 117/200 |loss: 9.424760| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 118/200 |loss: 9.363712| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 119/200 |loss: 9.307222| train set 8.340x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 120/200 |loss: 8.164596| train set 8.183x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 3
Epoch 121/200 |loss: 8.516956| train set 8.183x speedup, test set 1.214x speedup, val set 1.000x speedup, step: 4
Epoch 122/200 |loss: 8.166089| train set 8.183x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 123/200 |loss: 8.827377| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 124/200 |loss: 8.107440| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 125/200 |loss: 7.118193| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 126/200 |loss: 8.320739| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 127/200 |loss: 9.018653| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 128/200 |loss: 7.927993| train set 8.332x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 129/200 |loss: 7.703116| train set 8.332x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 2
Epoch 130/200 |loss: 9.251465| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 3
Epoch 131/200 |loss: 8.765321| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 132/200 |loss: 9.484625| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 133/200 |loss: 7.857236| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 3
Epoch 134/200 |loss: 9.526614| train set 8.185x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 135/200 |loss: 8.873443| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 136/200 |loss: 7.690579| train set 8.184x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 137/200 |loss: 8.720864| train set 8.184x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 138/200 |loss: 9.042995| train set 8.183x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 139/200 |loss: 9.121704| train set 8.183x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 140/200 |loss: 9.374628| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 141/200 |loss: 11.138989| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 142/200 |loss: 7.146813| train set 8.339x speedup, test set 0.952x speedup, val set 1.013x speedup, step: 1
Epoch 143/200 |loss: 9.443352| train set 8.339x speedup, test set 1.108x speedup, val set 1.013x speedup, step: 1
Epoch 144/200 |loss: 9.147320| train set 8.339x speedup, test set 0.750x speedup, val set 1.013x speedup, step: 1
Epoch 145/200 |loss: 8.985378| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 146/200 |loss: 9.615714| train set 8.328x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 147/200 |loss: 8.658020| train set 8.339x speedup, test set 1.125x speedup, val set 1.013x speedup, step: 1
Epoch 148/200 |loss: 8.741070| train set 8.339x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 149/200 |loss: 10.035107| train set 7.746x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 150/200 |loss: 8.251141| train set 8.326x speedup, test set 0.757x speedup, val set 1.013x speedup, step: 1
Epoch 151/200 |loss: 9.057398| train set 8.337x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 2
Epoch 152/200 |loss: 9.177810| train set 8.337x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 153/200 |loss: 7.719523| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 154/200 |loss: 10.304974| train set 8.183x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 155/200 |loss: 9.012465| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 156/200 |loss: 10.286066| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 3
Epoch 157/200 |loss: 8.917696| train set 7.856x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 158/200 |loss: 8.504818| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 5
Epoch 159/200 |loss: 9.076939| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 6
Epoch 160/200 |loss: 9.276140| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 7
Epoch 161/200 |loss: 8.124693| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 8
Epoch 162/200 |loss: 8.964596| train set 8.340x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 9
Epoch 163/200 |loss: 7.973689| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 10
Epoch 164/200 |loss: 7.212470| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 11
Epoch 165/200 |loss: 7.161444| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 12
Epoch 166/200 |loss: 8.121324| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 13
Epoch 167/200 |loss: 8.442920| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 168/200 |loss: 7.351528| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 169/200 |loss: 8.455576| train set 8.338x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 170/200 |loss: 8.943706| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 171/200 |loss: 8.505569| train set 8.327x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 172/200 |loss: 9.218274| train set 8.328x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 173/200 |loss: 9.249483| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 174/200 |loss: 8.676662| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 175/200 |loss: 8.094582| train set 8.332x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 176/200 |loss: 8.074488| train set 8.332x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 177/200 |loss: 8.883554| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 178/200 |loss: 8.292124| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 179/200 |loss: 8.294491| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 180/200 |loss: 8.283081| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 181/200 |loss: 8.802841| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 182/200 |loss: 8.543384| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 183/200 |loss: 9.105897| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 184/200 |loss: 7.948636| train set 8.183x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 2
Epoch 185/200 |loss: 6.444058| train set 8.184x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 186/200 |loss: 9.304983| train set 8.338x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 187/200 |loss: 7.788893| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 188/200 |loss: 8.763953| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 189/200 |loss: 8.490527| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 190/200 |loss: 9.399966| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 3
Epoch 191/200 |loss: 8.873728| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 192/200 |loss: 8.395834| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 2
Epoch 193/200 |loss: 8.002491| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 3
Epoch 194/200 |loss: 8.040705| train set 8.338x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 195/200 |loss: 8.709810| train set 8.337x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 196/200 |loss: 8.730533| train set 8.337x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 197/200 |loss: 8.181843| train set 8.183x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 198/200 |loss: 7.843307| train set 8.338x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 199/200 |loss: 8.954618| train set 8.331x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Training per epoch cost 0.969 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 38, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 95, train speedup 7.819, test speedup 1.317, val speedup 0.720
best validation speedup epoch: 199, train speedup 8.331, test speedup 0.693, val speedup 1.013
last model at epoch 199, train speedup 8.331, test speedup 0.693, val speedup 1.013
execution cost 0:08:10.249822
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.382927, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641935| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934925| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014947| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205907| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655504| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.528995| train set 7.575x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.536426| train set 6.716x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.754315| train set 7.460x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.502842| train set 7.691x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.799644| train set 7.691x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.792584| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.676982| train set 8.138x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 13.927478| train set 7.932x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.454089| train set 7.985x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 12.951402| train set 8.077x speedup, test set 0.642x speedup, val set 1.013x speedup, step: 17
Epoch 17/200 |loss: 13.729825| train set 8.275x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 18
Epoch 18/200 |loss: 13.940592| train set 8.077x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 14.628927| train set 8.275x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 20
Epoch 20/200 |loss: 13.429628| train set 8.275x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 21
Epoch 21/200 |loss: 13.371076| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 22
Epoch 22/200 |loss: 12.768242| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.434609| train set 8.275x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 24
Epoch 24/200 |loss: 12.380634| train set 8.275x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 25
Epoch 25/200 |loss: 11.499105| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 26
Epoch 26/200 |loss: 11.002229| train set 7.819x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 27
Epoch 27/200 |loss: 10.321806| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 28
Epoch 28/200 |loss: 11.457376| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 29
Epoch 29/200 |loss: 11.985142| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 30
Epoch 30/200 |loss: 11.140170| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 31
Epoch 31/200 |loss: 11.556668| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 32
Epoch 32/200 |loss: 9.974347| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33
Epoch 33/200 |loss: 10.426119| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 10.945138| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 35
Epoch 35/200 |loss: 10.330339| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 36
Epoch 36/200 |loss: 10.329963| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 37
Epoch 37/200 |loss: 9.887148| train set 8.138x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 38
Epoch 38/200 |loss: 10.815989| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 39
Epoch 39/200 |loss: 10.706099| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 40
Epoch 40/200 |loss: 10.148047| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 41
Epoch 41/200 |loss: 10.688210| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 42
Epoch 42/200 |loss: 9.613204| train set 8.085x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 43
Epoch 43/200 |loss: 14.635652| train set 7.747x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 44
Epoch 44/200 |loss: 12.443108| train set 7.819x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 45
Epoch 45/200 |loss: 11.375799| train set 8.303x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 46
Epoch 46/200 |loss: 12.308723| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 47
Epoch 47/200 |loss: 10.767786| train set 8.340x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 48
Epoch 48/200 |loss: 11.726256| train set 8.338x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 11.271207| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 50
Epoch 50/200 |loss: 10.299012| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 51
Epoch 51/200 |loss: 11.663696| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 52
Epoch 52/200 |loss: 9.926863| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 53
Epoch 53/200 |loss: 9.857408| train set 8.340x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 54
Epoch 54/200 |loss: 9.765354| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 55
Epoch 55/200 |loss: 9.153769| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 56
Epoch 56/200 |loss: 10.248026| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 57
Epoch 57/200 |loss: 9.912356| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 58
Epoch 58/200 |loss: 9.257892| train set 8.340x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 59
Epoch 59/200 |loss: 10.377545| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 60
Epoch 60/200 |loss: 8.057186| train set 8.303x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 61
Epoch 61/200 |loss: 10.156315| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 11.224969| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 63
Epoch 63/200 |loss: 9.750652| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 64
Epoch 64/200 |loss: 9.668737| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 65
Epoch 65/200 |loss: 10.581180| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 66
Epoch 66/200 |loss: 10.565915| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 9.975833| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 68
Epoch 68/200 |loss: 8.358629| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 69
Epoch 69/200 |loss: 10.570073| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 70
Epoch 70/200 |loss: 10.768121| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 71
Epoch 71/200 |loss: 8.837842| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 72
Epoch 72/200 |loss: 9.969104| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 8.701294| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 74
Epoch 74/200 |loss: 8.426837| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 75
Epoch 75/200 |loss: 10.623841| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 76
Epoch 76/200 |loss: 9.375029| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 77
Epoch 77/200 |loss: 10.060698| train set 8.185x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 78
Epoch 78/200 |loss: 9.086692| train set 8.340x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 79
Epoch 79/200 |loss: 9.664824| train set 8.333x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 80
Epoch 80/200 |loss: 9.820261| train set 8.340x speedup, test set 0.738x speedup, val set 0.714x speedup, step: 81
Epoch 81/200 |loss: 7.104994| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 82
Epoch 82/200 |loss: 9.593862| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 83
Epoch 83/200 |loss: 9.629524| train set 8.185x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 84
Epoch 84/200 |loss: 7.787776| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 85
Epoch 85/200 |loss: 9.921216| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 86
Epoch 86/200 |loss: 8.340949| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 87
Epoch 87/200 |loss: 9.880644| train set 8.339x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 88
Epoch 88/200 |loss: 9.844799| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 89
Epoch 89/200 |loss: 9.442862| train set 8.185x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 90
Epoch 90/200 |loss: 9.508810| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 91
Epoch 91/200 |loss: 8.571280| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 92
Epoch 92/200 |loss: 9.297578| train set 8.340x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 93
Epoch 93/200 |loss: 8.856323| train set 8.340x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 94
Epoch 94/200 |loss: 8.216669| train set 8.340x speedup, test set 1.108x speedup, val set 0.720x speedup, step: 95
Epoch 95/200 |loss: 9.883497| train set 8.185x speedup, test set 0.750x speedup, val set 0.720x speedup, step: 96
Epoch 96/200 |loss: 9.202290| train set 8.178x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 97
Epoch 97/200 |loss: 8.604515| train set 8.185x speedup, test set 1.108x speedup, val set 1.013x speedup, step: 98
Epoch 98/200 |loss: 8.188056| train set 8.339x speedup, test set 0.750x speedup, val set 0.720x speedup, step: 99
Epoch 99/200 |loss: 9.636141| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 100
Epoch 100/200 |loss: 8.333772| train set 8.340x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 10.184523| train set 8.335x speedup, test set 1.194x speedup, val set 0.714x speedup, step: 2
Epoch 102/200 |loss: 8.932153| train set 7.813x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 3
Epoch 103/200 |loss: 8.659516| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 104/200 |loss: 9.009445| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 105/200 |loss: 9.873026| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 3
Epoch 106/200 |loss: 9.577110| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 4
Epoch 107/200 |loss: 9.307889| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 5
Epoch 108/200 |loss: 9.076764| train set 8.339x speedup, test set 0.838x speedup, val set 0.720x speedup, step: 6
Epoch 109/200 |loss: 8.341064| train set 8.339x speedup, test set 1.125x speedup, val set 0.714x speedup, step: 7
Epoch 110/200 |loss: 9.774225| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 8
Epoch 111/200 |loss: 9.746327| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 9
Epoch 112/200 |loss: 7.684154| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 10
Epoch 113/200 |loss: 9.282208| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 114/200 |loss: 8.362791| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 115/200 |loss: 8.731603| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 116/200 |loss: 7.942603| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 117/200 |loss: 9.381270| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 118/200 |loss: 9.258663| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 119/200 |loss: 9.270924| train set 8.340x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 120/200 |loss: 8.027535| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 2
Epoch 121/200 |loss: 8.465025| train set 8.174x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 3
Epoch 122/200 |loss: 8.022415| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 123/200 |loss: 8.834899| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 5
Epoch 124/200 |loss: 8.012764| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 6
Epoch 125/200 |loss: 6.930271| train set 8.338x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 7
Epoch 126/200 |loss: 8.175023| train set 8.337x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 8
Epoch 127/200 |loss: 9.110195| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 128/200 |loss: 8.032577| train set 8.332x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 2
Epoch 129/200 |loss: 7.735883| train set 8.332x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 3
Epoch 130/200 |loss: 8.938712| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 131/200 |loss: 8.566018| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 5
Epoch 132/200 |loss: 9.213798| train set 8.185x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 6
Epoch 133/200 |loss: 7.837518| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 7
Epoch 134/200 |loss: 9.182040| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 8
Epoch 135/200 |loss: 8.783874| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 136/200 |loss: 7.635027| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 137/200 |loss: 8.700772| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 138/200 |loss: 9.128270| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 139/200 |loss: 9.191078| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 3
Epoch 140/200 |loss: 9.272167| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 141/200 |loss: 11.017258| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 5
Epoch 142/200 |loss: 7.113901| train set 8.178x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 6
Epoch 143/200 |loss: 9.454069| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 7
Epoch 144/200 |loss: 9.144025| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 8
Epoch 145/200 |loss: 8.941046| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 9
Epoch 146/200 |loss: 9.428930| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 10
Epoch 147/200 |loss: 8.380031| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 148/200 |loss: 8.976037| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 149/200 |loss: 9.893663| train set 7.746x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 3
Epoch 150/200 |loss: 8.527408| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 4
Epoch 151/200 |loss: 9.217912| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 5
Epoch 152/200 |loss: 9.015037| train set 8.337x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 6
Epoch 153/200 |loss: 8.032306| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 154/200 |loss: 10.218743| train set 8.183x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 155/200 |loss: 8.943194| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 3
Epoch 156/200 |loss: 10.166884| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 157/200 |loss: 9.069466| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 5
Epoch 158/200 |loss: 8.542001| train set 8.175x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 6
Epoch 159/200 |loss: 9.176184| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 7
Epoch 160/200 |loss: 9.297228| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 8
Epoch 161/200 |loss: 8.368906| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 9
Epoch 162/200 |loss: 8.840044| train set 8.340x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 10
Epoch 163/200 |loss: 8.184774| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 11
Epoch 164/200 |loss: 7.196824| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 12
Epoch 165/200 |loss: 7.248603| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 13
Epoch 166/200 |loss: 8.039691| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 14
Epoch 167/200 |loss: 8.301304| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 15
Epoch 168/200 |loss: 7.415308| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 16
Epoch 169/200 |loss: 8.403615| train set 8.337x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 17
Epoch 170/200 |loss: 9.022696| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 18
Epoch 171/200 |loss: 8.395628| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 19
Epoch 172/200 |loss: 9.013761| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 20
Epoch 173/200 |loss: 8.887632| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 21
Epoch 174/200 |loss: 8.498044| train set 8.332x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 22
Epoch 175/200 |loss: 7.923018| train set 8.332x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 23
Epoch 176/200 |loss: 7.997717| train set 8.332x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 24
Epoch 177/200 |loss: 8.570437| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 25
Epoch 178/200 |loss: 8.456053| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 26
Epoch 179/200 |loss: 8.652847| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 27
Epoch 180/200 |loss: 8.185800| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 28
Epoch 181/200 |loss: 8.764863| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 29
Epoch 182/200 |loss: 8.475945| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 30
Epoch 183/200 |loss: 9.040040| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 31
Epoch 184/200 |loss: 8.051804| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 32
Epoch 185/200 |loss: 6.482678| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 33
Epoch 186/200 |loss: 9.233519| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 34
Epoch 187/200 |loss: 7.817044| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 35
Epoch 188/200 |loss: 8.614697| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 36
Epoch 189/200 |loss: 8.518383| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 37
Epoch 190/200 |loss: 9.281203| train set 8.339x speedup, test set 0.754x speedup, val set 0.816x speedup, step: 38
Epoch 191/200 |loss: 8.774951| train set 8.339x speedup, test set 0.754x speedup, val set 1.000x speedup, step: 39
Epoch 192/200 |loss: 8.427240| train set 8.185x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 40
Epoch 193/200 |loss: 8.082730| train set 8.339x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 41
Epoch 194/200 |loss: 8.234781| train set 8.339x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 42
Epoch 195/200 |loss: 8.581442| train set 8.338x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 43
Epoch 196/200 |loss: 8.781400| train set 8.173x speedup, test set 1.346x speedup, val set 1.000x speedup, step: 44
Epoch 197/200 |loss: 8.180190| train set 8.338x speedup, test set 1.214x speedup, val set 0.714x speedup, step: 45
Epoch 198/200 |loss: 7.778594| train set 8.339x speedup, test set 1.214x speedup, val set 0.714x speedup, step: 46
Epoch 199/200 |loss: 8.830754| train set 8.337x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 47
Training per epoch cost 0.861 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 27, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 196, train speedup 8.173, test speedup 1.346, val speedup 1.000
best validation speedup epoch: 153, train speedup 8.337, test speedup 0.680, val speedup 1.013
last model at epoch 199, train speedup 8.337, test speedup 0.693, val speedup 0.714
execution cost 0:07:08.365941
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.810767, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641934| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934925| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014949| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205912| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655450| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.528622| train set 7.575x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.532997| train set 6.716x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.748159| train set 7.460x speedup, test set 0.918x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.511250| train set 7.747x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.754324| train set 7.691x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.697289| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.677129| train set 8.077x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 13.888038| train set 8.275x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.492924| train set 7.978x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 12.824510| train set 8.058x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 17
Epoch 17/200 |loss: 13.654314| train set 8.275x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 18
Epoch 18/200 |loss: 13.866085| train set 8.076x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 14.281612| train set 8.338x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 20
Epoch 20/200 |loss: 13.499767| train set 8.137x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 21
Epoch 21/200 |loss: 13.377012| train set 7.690x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 22
Epoch 22/200 |loss: 12.850119| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.550598| train set 8.077x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 24
Epoch 24/200 |loss: 12.885585| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 25
Epoch 25/200 |loss: 11.696226| train set 7.762x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 26
Epoch 26/200 |loss: 11.467402| train set 7.747x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 27
Epoch 27/200 |loss: 10.849152| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 28
Epoch 28/200 |loss: 12.040139| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 29
Epoch 29/200 |loss: 12.459312| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 30
Epoch 30/200 |loss: 11.121208| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 31
Epoch 31/200 |loss: 11.839229| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 32
Epoch 32/200 |loss: 10.064281| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33
Epoch 33/200 |loss: 10.449343| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 11.088450| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 35
Epoch 35/200 |loss: 10.787699| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 36
Epoch 36/200 |loss: 11.022303| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 37
Epoch 37/200 |loss: 10.118819| train set 8.138x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 38
Epoch 38/200 |loss: 10.761533| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 39
Epoch 39/200 |loss: 10.495601| train set 7.817x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 40
Epoch 40/200 |loss: 9.883078| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 41
Epoch 41/200 |loss: 9.756694| train set 8.138x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 42
Epoch 42/200 |loss: 10.085433| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 43
Epoch 43/200 |loss: 12.718649| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 44
Epoch 44/200 |loss: 11.242165| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 45
Epoch 45/200 |loss: 10.078988| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 46
Epoch 46/200 |loss: 10.204351| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 47
Epoch 47/200 |loss: 9.861327| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 48
Epoch 48/200 |loss: 10.619532| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 10.669510| train set 8.339x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 50
Epoch 50/200 |loss: 10.365403| train set 8.332x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 51
Epoch 51/200 |loss: 11.873948| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 52
Epoch 52/200 |loss: 10.262239| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 53
Epoch 53/200 |loss: 9.615482| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 54
Epoch 54/200 |loss: 10.093500| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 55
Epoch 55/200 |loss: 9.559337| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 56
Epoch 56/200 |loss: 9.853612| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 57
Epoch 57/200 |loss: 9.616703| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 58
Epoch 58/200 |loss: 9.106684| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 59
Epoch 59/200 |loss: 9.941779| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 60
Epoch 60/200 |loss: 7.816746| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 61
Epoch 61/200 |loss: 10.174957| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 11.204692| train set 8.339x speedup, test set 1.194x speedup, val set 0.720x speedup, step: 63
Epoch 63/200 |loss: 9.424427| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 64
Epoch 64/200 |loss: 9.447931| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 65
Epoch 65/200 |loss: 10.382877| train set 8.332x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 66
Epoch 66/200 |loss: 9.550085| train set 8.325x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 9.538077| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 68
Epoch 68/200 |loss: 7.593425| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 69
Epoch 69/200 |loss: 10.367154| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 70
Epoch 70/200 |loss: 10.757818| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 71
Epoch 71/200 |loss: 9.171198| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 72
Epoch 72/200 |loss: 10.010754| train set 8.137x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 9.189059| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 74
Epoch 74/200 |loss: 8.618956| train set 8.339x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 75
Epoch 75/200 |loss: 10.838616| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 76
Epoch 76/200 |loss: 10.156523| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 77
Epoch 77/200 |loss: 10.537659| train set 8.339x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 78
Epoch 78/200 |loss: 9.200350| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 79
Epoch 79/200 |loss: 9.752885| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 80
Epoch 80/200 |loss: 9.823377| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 81
Epoch 81/200 |loss: 7.183009| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 82
Epoch 82/200 |loss: 9.268577| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 83
Epoch 83/200 |loss: 9.732686| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 84
Epoch 84/200 |loss: 7.783402| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 85
Epoch 85/200 |loss: 9.925898| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 86
Epoch 86/200 |loss: 8.447144| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 87
Epoch 87/200 |loss: 9.842382| train set 8.339x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 88
Epoch 88/200 |loss: 10.238916| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 89
Epoch 89/200 |loss: 9.558622| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 90
Epoch 90/200 |loss: 9.564991| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 91
Epoch 91/200 |loss: 8.574393| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 92
Epoch 92/200 |loss: 9.423844| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 93
Epoch 93/200 |loss: 8.951099| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 8.627022| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 95
Epoch 95/200 |loss: 10.056797| train set 7.683x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 96
Epoch 96/200 |loss: 9.333158| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 8.560510| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 8.588267| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 99
Epoch 99/200 |loss: 9.510699| train set 8.325x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 100
Epoch 100/200 |loss: 8.346673| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 101/200 |loss: 10.352231| train set 8.333x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 2
Epoch 102/200 |loss: 8.835163| train set 8.340x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 3
Epoch 103/200 |loss: 8.345633| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 104/200 |loss: 9.086660| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 105/200 |loss: 9.871266| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 106/200 |loss: 9.574184| train set 8.178x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 3
Epoch 107/200 |loss: 9.176168| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 4
Epoch 108/200 |loss: 9.187952| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 5
Epoch 109/200 |loss: 8.094527| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 6
Epoch 110/200 |loss: 9.889783| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 111/200 |loss: 9.701774| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 2
Epoch 112/200 |loss: 7.666961| train set 7.819x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 3
Epoch 113/200 |loss: 9.422007| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 114/200 |loss: 8.158033| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 115/200 |loss: 8.911741| train set 8.340x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 116/200 |loss: 8.098427| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 117/200 |loss: 9.715837| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 118/200 |loss: 9.159373| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 119/200 |loss: 9.445799| train set 8.340x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 120/200 |loss: 8.054413| train set 8.185x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 2
Epoch 121/200 |loss: 8.471817| train set 8.179x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 3
Epoch 122/200 |loss: 8.057440| train set 8.184x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 123/200 |loss: 8.842450| train set 8.184x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 124/200 |loss: 8.064007| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 125/200 |loss: 6.976594| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 126/200 |loss: 8.253354| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3
Epoch 127/200 |loss: 9.092017| train set 8.338x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 128/200 |loss: 8.083076| train set 8.338x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 129/200 |loss: 7.774238| train set 8.338x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 2
Epoch 130/200 |loss: 9.076989| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3
Epoch 131/200 |loss: 8.700919| train set 8.340x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 4
Epoch 132/200 |loss: 9.257744| train set 8.185x speedup, test set 0.714x speedup, val set 0.714x speedup, step: 5
Epoch 133/200 |loss: 7.820027| train set 8.185x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 6
Epoch 134/200 |loss: 9.261856| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 7
Epoch 135/200 |loss: 9.050888| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 8
Epoch 136/200 |loss: 7.667401| train set 8.185x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 9
Epoch 137/200 |loss: 8.657622| train set 8.339x speedup, test set 0.686x speedup, val set 0.816x speedup, step: 10
Epoch 138/200 |loss: 9.093663| train set 8.184x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 11
Epoch 139/200 |loss: 9.250854| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 12
Epoch 140/200 |loss: 9.340079| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 13
Epoch 141/200 |loss: 10.792585| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 14
Epoch 142/200 |loss: 7.047023| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 15
Epoch 143/200 |loss: 9.116167| train set 8.339x speedup, test set 0.750x speedup, val set 0.720x speedup, step: 16
Epoch 144/200 |loss: 9.318960| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 145/200 |loss: 8.835141| train set 8.339x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 146/200 |loss: 9.792942| train set 8.332x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 147/200 |loss: 8.418457| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 148/200 |loss: 8.614475| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3
Epoch 149/200 |loss: 9.892215| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 4
Epoch 150/200 |loss: 8.471951| train set 8.339x speedup, test set 0.686x speedup, val set 0.824x speedup, step: 5
Epoch 151/200 |loss: 8.937327| train set 8.337x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 152/200 |loss: 8.864968| train set 8.337x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 153/200 |loss: 7.626884| train set 8.337x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3
Epoch 154/200 |loss: 10.006575| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 155/200 |loss: 9.062997| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 5
Epoch 156/200 |loss: 9.998668| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 6
Epoch 157/200 |loss: 9.105606| train set 7.856x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 7
Epoch 158/200 |loss: 8.381569| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 8
Epoch 159/200 |loss: 9.377398| train set 8.185x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 9
Epoch 160/200 |loss: 9.275984| train set 8.340x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 161/200 |loss: 8.111629| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 162/200 |loss: 9.038568| train set 8.340x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 163/200 |loss: 8.160909| train set 8.185x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 3
Epoch 164/200 |loss: 7.221467| train set 8.337x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 4
Epoch 165/200 |loss: 7.161714| train set 8.337x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 166/200 |loss: 8.091708| train set 8.337x speedup, test set 0.792x speedup, val set 0.720x speedup, step: 2
Epoch 167/200 |loss: 8.358187| train set 8.339x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 3
Epoch 168/200 |loss: 7.419262| train set 8.339x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 169/200 |loss: 8.600272| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 170/200 |loss: 9.045212| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2
Epoch 171/200 |loss: 8.566686| train set 8.338x speedup, test set 0.738x speedup, val set 0.714x speedup, step: 3
Epoch 172/200 |loss: 9.139668| train set 8.184x speedup, test set 0.722x speedup, val set 1.000x speedup, step: 4
Epoch 173/200 |loss: 9.163342| train set 8.338x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 5
Epoch 174/200 |loss: 8.603453| train set 8.339x speedup, test set 0.714x speedup, val set 0.720x speedup, step: 6
Epoch 175/200 |loss: 8.139173| train set 8.343x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 7
Epoch 176/200 |loss: 8.026013| train set 8.339x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 177/200 |loss: 8.955450| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2
Epoch 178/200 |loss: 8.319437| train set 8.339x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 3
Epoch 179/200 |loss: 8.702206| train set 8.339x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 180/200 |loss: 8.332075| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 181/200 |loss: 8.763635| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 182/200 |loss: 8.583151| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 183/200 |loss: 9.144653| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 3
Epoch 184/200 |loss: 7.846769| train set 8.185x speedup, test set 0.686x speedup, val set 0.816x speedup, step: 4
Epoch 185/200 |loss: 6.568426| train set 8.338x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 5
Epoch 186/200 |loss: 9.207841| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 6
Epoch 187/200 |loss: 7.825300| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 7
Epoch 188/200 |loss: 8.827271| train set 8.329x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 8
Epoch 189/200 |loss: 8.568572| train set 8.174x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 9
Epoch 190/200 |loss: 9.258265| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 10
Epoch 191/200 |loss: 8.944912| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 11
Epoch 192/200 |loss: 8.412161| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 12
Epoch 193/200 |loss: 8.146785| train set 8.340x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 13
Epoch 194/200 |loss: 8.369356| train set 8.339x speedup, test set 0.714x speedup, val set 0.714x speedup, step: 14
Epoch 195/200 |loss: 8.777758| train set 8.184x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 15
Epoch 196/200 |loss: 8.724439| train set 8.183x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 197/200 |loss: 8.549498| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 198/200 |loss: 8.033387| train set 8.338x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 2
Epoch 199/200 |loss: 8.999890| train set 8.337x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Training per epoch cost 0.896 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
23, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
24, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
25, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
26, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
29, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 175, train speedup 8.343, test speedup 0.747, val speedup 0.720
best test speedup epoch: 49, train speedup 8.339, test speedup 1.299, val speedup 1.013
best validation speedup epoch: 199, train speedup 8.337, test speedup 0.738, val speedup 1.013
last model at epoch 199, train speedup 8.337, test speedup 0.738, val speedup 1.013
execution cost 0:07:26.303789
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.415216, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641935| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934926| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014948| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205907| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655504| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.528995| train set 7.575x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.536428| train set 6.716x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.754315| train set 7.460x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.502658| train set 7.691x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.799540| train set 7.691x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.791234| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.689089| train set 8.138x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 13.922163| train set 8.130x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.394091| train set 7.440x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 12.938579| train set 8.077x speedup, test set 0.642x speedup, val set 1.013x speedup, step: 17
Epoch 17/200 |loss: 13.673173| train set 8.275x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 18
Epoch 18/200 |loss: 13.888472| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 14.595932| train set 8.275x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 20
Epoch 20/200 |loss: 13.432855| train set 8.138x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 21
Epoch 21/200 |loss: 13.410703| train set 8.275x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 22
Epoch 22/200 |loss: 12.882212| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.489168| train set 8.138x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 24
Epoch 24/200 |loss: 12.372870| train set 8.138x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 25
Epoch 25/200 |loss: 11.593688| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 26
Epoch 26/200 |loss: 11.205028| train set 7.747x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 27
Epoch 27/200 |loss: 10.399155| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 28
Epoch 28/200 |loss: 11.923548| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 29
Epoch 29/200 |loss: 12.208883| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 30
Epoch 30/200 |loss: 11.099203| train set 8.339x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 31
Epoch 31/200 |loss: 11.768294| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 32
Epoch 32/200 |loss: 9.717990| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33
Epoch 33/200 |loss: 10.223934| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 10.674261| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 35
Epoch 35/200 |loss: 10.364726| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 36
Epoch 36/200 |loss: 10.416514| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 37
Epoch 37/200 |loss: 9.928103| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 38
Epoch 38/200 |loss: 10.456541| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 39
Epoch 39/200 |loss: 10.668314| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 40
Epoch 40/200 |loss: 10.035953| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 41
Epoch 41/200 |loss: 10.117874| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 42
Epoch 42/200 |loss: 9.597844| train set 8.150x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 43
Epoch 43/200 |loss: 14.392782| train set 7.747x speedup, test set 1.299x speedup, val set 0.824x speedup, step: 44
Epoch 44/200 |loss: 11.857633| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 45
Epoch 45/200 |loss: 10.763199| train set 8.303x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 46
Epoch 46/200 |loss: 11.892082| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 47
Epoch 47/200 |loss: 10.755637| train set 8.339x speedup, test set 1.194x speedup, val set 0.720x speedup, step: 48
Epoch 48/200 |loss: 11.348559| train set 8.183x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 10.660935| train set 8.339x speedup, test set 0.833x speedup, val set 0.720x speedup, step: 50
Epoch 50/200 |loss: 9.851811| train set 8.339x speedup, test set 1.568x speedup, val set 1.013x speedup, step: 51
Epoch 51/200 |loss: 11.338947| train set 8.339x speedup, test set 1.418x speedup, val set 1.013x speedup, step: 52
Epoch 52/200 |loss: 9.637942| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 53
Epoch 53/200 |loss: 9.755977| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 54
Epoch 54/200 |loss: 9.627813| train set 8.339x speedup, test set 1.299x speedup, val set 0.714x speedup, step: 55
Epoch 55/200 |loss: 9.138649| train set 8.339x speedup, test set 1.299x speedup, val set 0.714x speedup, step: 56
Epoch 56/200 |loss: 10.170197| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 57
Epoch 57/200 |loss: 9.483326| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 58
Epoch 58/200 |loss: 8.985730| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 59
Epoch 59/200 |loss: 9.760567| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 60
Epoch 60/200 |loss: 8.010420| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 61
Epoch 61/200 |loss: 9.935730| train set 8.339x speedup, test set 1.108x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 10.998103| train set 8.185x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 63
Epoch 63/200 |loss: 9.630897| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 64
Epoch 64/200 |loss: 9.344255| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 65
Epoch 65/200 |loss: 10.466081| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 66
Epoch 66/200 |loss: 10.179595| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 9.501701| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 68
Epoch 68/200 |loss: 7.714000| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 69
Epoch 69/200 |loss: 10.788925| train set 8.337x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 70
Epoch 70/200 |loss: 10.942321| train set 7.746x speedup, test set 1.108x speedup, val set 0.720x speedup, step: 71
Epoch 71/200 |loss: 8.625790| train set 8.339x speedup, test set 1.108x speedup, val set 0.720x speedup, step: 72
Epoch 72/200 |loss: 10.108050| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 8.616334| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 74
Epoch 74/200 |loss: 8.904540| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 75
Epoch 75/200 |loss: 10.190787| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 76
Epoch 76/200 |loss: 9.354531| train set 8.185x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 77
Epoch 77/200 |loss: 9.742785| train set 8.340x speedup, test set 0.758x speedup, val set 0.720x speedup, step: 78
Epoch 78/200 |loss: 9.155051| train set 8.333x speedup, test set 0.914x speedup, val set 0.720x speedup, step: 79
Epoch 79/200 |loss: 9.181436| train set 8.340x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 80
Epoch 80/200 |loss: 9.638801| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 81
Epoch 81/200 |loss: 7.090851| train set 7.818x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 82
Epoch 82/200 |loss: 9.329100| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 83
Epoch 83/200 |loss: 9.458666| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 84
Epoch 84/200 |loss: 7.879782| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 85
Epoch 85/200 |loss: 9.563210| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 86
Epoch 86/200 |loss: 8.193227| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 87
Epoch 87/200 |loss: 9.845937| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 88
Epoch 88/200 |loss: 9.821833| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 89
Epoch 89/200 |loss: 9.119524| train set 8.184x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 90
Epoch 90/200 |loss: 9.392233| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 91
Epoch 91/200 |loss: 8.337170| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 92
Epoch 92/200 |loss: 9.302737| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 93
Epoch 93/200 |loss: 8.660212| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 94
Epoch 94/200 |loss: 8.237220| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 95
Epoch 95/200 |loss: 9.785882| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 96
Epoch 96/200 |loss: 9.123747| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 97
Epoch 97/200 |loss: 8.548948| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 98
Epoch 98/200 |loss: 8.188565| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 99
Epoch 99/200 |loss: 9.586746| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 100
Epoch 100/200 |loss: 8.202601| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 1
Epoch 101/200 |loss: 10.529741| train set 8.333x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 102/200 |loss: 8.750253| train set 8.178x speedup, test set 0.693x speedup, val set 0.974x speedup, step: 2
Epoch 103/200 |loss: 8.664533| train set 8.185x speedup, test set 0.680x speedup, val set 0.909x speedup, step: 3
Epoch 104/200 |loss: 9.146539| train set 7.613x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 4
Epoch 105/200 |loss: 10.089002| train set 8.178x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 5
Epoch 106/200 |loss: 9.779022| train set 8.131x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 107/200 |loss: 9.243434| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 108/200 |loss: 9.196714| train set 8.340x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 3
Epoch 109/200 |loss: 8.078479| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 4
Epoch 110/200 |loss: 9.797698| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 111/200 |loss: 9.816398| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 2
Epoch 112/200 |loss: 7.750681| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 3
Epoch 113/200 |loss: 9.266964| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 114/200 |loss: 8.271022| train set 8.303x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 115/200 |loss: 9.107018| train set 7.747x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 116/200 |loss: 8.260117| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3
Epoch 117/200 |loss: 9.714865| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 118/200 |loss: 9.236501| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 5
Epoch 119/200 |loss: 9.500877| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 6
Epoch 120/200 |loss: 8.170413| train set 8.185x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 7
Epoch 121/200 |loss: 8.459325| train set 8.185x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 8
Epoch 122/200 |loss: 7.938267| train set 8.183x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 123/200 |loss: 8.667610| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 124/200 |loss: 8.107674| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 125/200 |loss: 7.009654| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 126/200 |loss: 8.187418| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 127/200 |loss: 8.972362| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 128/200 |loss: 7.892692| train set 8.178x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 2
Epoch 129/200 |loss: 7.754350| train set 8.334x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 3
Epoch 130/200 |loss: 9.001795| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 131/200 |loss: 8.514127| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 5
Epoch 132/200 |loss: 9.154374| train set 8.185x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 6
Epoch 133/200 |loss: 7.763420| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 7
Epoch 134/200 |loss: 9.159371| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 8
Epoch 135/200 |loss: 8.750113| train set 8.184x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 9
Epoch 136/200 |loss: 7.515400| train set 8.339x speedup, test set 0.693x speedup, val set 0.922x speedup, step: 10
Epoch 137/200 |loss: 8.730492| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 11
Epoch 138/200 |loss: 9.020764| train set 8.184x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 12
Epoch 139/200 |loss: 9.342032| train set 8.184x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 13
Epoch 140/200 |loss: 9.307958| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 14
Epoch 141/200 |loss: 11.183390| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 15
Epoch 142/200 |loss: 7.169234| train set 8.171x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 16
Epoch 143/200 |loss: 9.485960| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 17
Epoch 144/200 |loss: 9.177105| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 145/200 |loss: 8.952430| train set 8.332x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 146/200 |loss: 9.648432| train set 8.332x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 147/200 |loss: 8.675319| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 148/200 |loss: 8.717619| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3
Epoch 149/200 |loss: 10.454499| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 150/200 |loss: 8.336895| train set 8.333x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 151/200 |loss: 9.389270| train set 8.337x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 152/200 |loss: 9.025417| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 153/200 |loss: 7.851054| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 154/200 |loss: 10.312902| train set 8.183x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 155/200 |loss: 8.941934| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 156/200 |loss: 10.350821| train set 8.185x speedup, test set 0.680x speedup, val set 1.015x speedup, step: 1
Epoch 157/200 |loss: 9.079742| train set 7.856x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 2
Epoch 158/200 |loss: 8.553913| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 3
Epoch 159/200 |loss: 9.160077| train set 8.185x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 4
Epoch 160/200 |loss: 9.419248| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 5
Epoch 161/200 |loss: 8.141595| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 6
Epoch 162/200 |loss: 8.835467| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 7
Epoch 163/200 |loss: 8.012939| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 8
Epoch 164/200 |loss: 7.220530| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 9
Epoch 165/200 |loss: 7.256929| train set 8.337x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 10
Epoch 166/200 |loss: 8.141336| train set 8.337x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 11
Epoch 167/200 |loss: 8.531893| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 12
Epoch 168/200 |loss: 7.427458| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 13
Epoch 169/200 |loss: 8.513276| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 14
Epoch 170/200 |loss: 9.209973| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 15
Epoch 171/200 |loss: 8.429136| train set 8.338x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 16
Epoch 172/200 |loss: 9.182264| train set 8.184x speedup, test set 0.686x speedup, val set 0.816x speedup, step: 17
Epoch 173/200 |loss: 9.074345| train set 8.184x speedup, test set 0.686x speedup, val set 0.816x speedup, step: 18
Epoch 174/200 |loss: 8.629243| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 19
Epoch 175/200 |loss: 8.030967| train set 8.333x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 20
Epoch 176/200 |loss: 7.938847| train set 8.334x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 21
Epoch 177/200 |loss: 8.674994| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 22
Epoch 178/200 |loss: 8.590065| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 23
Epoch 179/200 |loss: 8.565154| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 24
Epoch 180/200 |loss: 8.297360| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 25
Epoch 181/200 |loss: 8.648139| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 26
Epoch 182/200 |loss: 8.669548| train set 8.184x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 27
Epoch 183/200 |loss: 9.319497| train set 8.184x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 28
Epoch 184/200 |loss: 7.976979| train set 8.185x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 29
Epoch 185/200 |loss: 6.526471| train set 8.339x speedup, test set 0.686x speedup, val set 0.816x speedup, step: 30
Epoch 186/200 |loss: 9.380363| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 31
Epoch 187/200 |loss: 7.880583| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 32
Epoch 188/200 |loss: 8.980116| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33
Epoch 189/200 |loss: 8.477964| train set 8.185x speedup, test set 0.686x speedup, val set 0.816x speedup, step: 34
Epoch 190/200 |loss: 9.419517| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 35
Epoch 191/200 |loss: 8.699770| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 36
Epoch 192/200 |loss: 8.380136| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 37
Epoch 193/200 |loss: 7.826001| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 38
Epoch 194/200 |loss: 8.251615| train set 8.338x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 39
Epoch 195/200 |loss: 8.467420| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 40
Epoch 196/200 |loss: 8.653264| train set 8.183x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 41
Epoch 197/200 |loss: 8.113123| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 42
Epoch 198/200 |loss: 7.757237| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 43
Epoch 199/200 |loss: 8.937694| train set 8.331x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 44
Training per epoch cost 0.849 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 40, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 50, train speedup 8.339, test speedup 1.568, val speedup 1.013
best validation speedup epoch: 156, train speedup 8.185, test speedup 0.680, val speedup 1.015
last model at epoch 199, train speedup 8.331, test speedup 0.693, val speedup 1.013
execution cost 0:07:02.876070
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.920083, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641936| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934926| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014946| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205909| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655494| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.537992| train set 7.359x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.532378| train set 6.716x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.780498| train set 7.629x speedup, test set 0.863x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.534288| train set 7.691x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.746387| train set 7.083x speedup, test set 0.961x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.625143| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.689876| train set 8.077x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 14.068594| train set 8.137x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.675483| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 12.810710| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 17
Epoch 17/200 |loss: 13.090319| train set 8.275x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 18
Epoch 18/200 |loss: 13.559065| train set 8.274x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 13.956974| train set 8.274x speedup, test set 0.642x speedup, val set 0.974x speedup, step: 20
Epoch 20/200 |loss: 13.053454| train set 8.077x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 21
Epoch 21/200 |loss: 12.854459| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 22
Epoch 22/200 |loss: 12.359745| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.144534| train set 8.077x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 24
Epoch 24/200 |loss: 12.420342| train set 8.275x speedup, test set 0.680x speedup, val set 0.781x speedup, step: 25
Epoch 25/200 |loss: 11.679625| train set 7.819x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 26
Epoch 26/200 |loss: 11.315880| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 27
Epoch 27/200 |loss: 10.490788| train set 8.339x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 28
Epoch 28/200 |loss: 11.693014| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 29
Epoch 29/200 |loss: 11.866673| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 30
Epoch 30/200 |loss: 11.329281| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 31
Epoch 31/200 |loss: 11.299599| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 32
Epoch 32/200 |loss: 10.158398| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33
Epoch 33/200 |loss: 10.839176| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 10.444587| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 35
Epoch 35/200 |loss: 10.648455| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 36
Epoch 36/200 |loss: 10.301532| train set 8.338x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 37
Epoch 37/200 |loss: 10.090337| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 38
Epoch 38/200 |loss: 10.252370| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 39
Epoch 39/200 |loss: 10.533246| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 40
Epoch 40/200 |loss: 9.834346| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 41
Epoch 41/200 |loss: 10.132146| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 42
Epoch 42/200 |loss: 9.891840| train set 8.085x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 43
Epoch 43/200 |loss: 13.471790| train set 7.747x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 44
Epoch 44/200 |loss: 11.541837| train set 8.339x speedup, test set 0.747x speedup, val set 0.974x speedup, step: 45
Epoch 45/200 |loss: 10.797698| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 46
Epoch 46/200 |loss: 11.149901| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 47
Epoch 47/200 |loss: 10.187096| train set 8.339x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 48
Epoch 48/200 |loss: 10.908246| train set 7.991x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 10.620124| train set 8.339x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 50
Epoch 50/200 |loss: 10.040362| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 51
Epoch 51/200 |loss: 11.622928| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 52
Epoch 52/200 |loss: 10.143442| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 53
Epoch 53/200 |loss: 9.554878| train set 8.340x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 54
Epoch 54/200 |loss: 10.142673| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 55
Epoch 55/200 |loss: 9.503262| train set 8.339x speedup, test set 0.775x speedup, val set 0.824x speedup, step: 56
Epoch 56/200 |loss: 10.002181| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 57
Epoch 57/200 |loss: 10.149806| train set 8.339x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 58
Epoch 58/200 |loss: 9.373514| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 59
Epoch 59/200 |loss: 10.193943| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 60
Epoch 60/200 |loss: 7.921756| train set 8.325x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 61
Epoch 61/200 |loss: 10.364569| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 11.227041| train set 8.339x speedup, test set 0.789x speedup, val set 0.720x speedup, step: 63
Epoch 63/200 |loss: 9.796376| train set 8.339x speedup, test set 0.714x speedup, val set 0.720x speedup, step: 64
Epoch 64/200 |loss: 9.314332| train set 8.339x speedup, test set 1.056x speedup, val set 0.824x speedup, step: 65
Epoch 65/200 |loss: 10.316705| train set 8.332x speedup, test set 0.722x speedup, val set 0.714x speedup, step: 66
Epoch 66/200 |loss: 9.749077| train set 8.339x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 9.466163| train set 8.339x speedup, test set 1.299x speedup, val set 0.974x speedup, step: 68
Epoch 68/200 |loss: 8.248731| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 69
Epoch 69/200 |loss: 10.309141| train set 8.185x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 70
Epoch 70/200 |loss: 10.836641| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 71
Epoch 71/200 |loss: 9.168149| train set 8.339x speedup, test set 0.750x speedup, val set 0.720x speedup, step: 72
Epoch 72/200 |loss: 10.070853| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 8.928563| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 74
Epoch 74/200 |loss: 8.629316| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 75
Epoch 75/200 |loss: 10.443437| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 76
Epoch 76/200 |loss: 9.631367| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 77
Epoch 77/200 |loss: 9.952994| train set 8.086x speedup, test set 0.693x speedup, val set 0.974x speedup, step: 78
Epoch 78/200 |loss: 9.055554| train set 8.333x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 79
Epoch 79/200 |loss: 9.470122| train set 8.333x speedup, test set 0.722x speedup, val set 0.720x speedup, step: 80
Epoch 80/200 |loss: 9.611842| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 81
Epoch 81/200 |loss: 7.038496| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 82
Epoch 82/200 |loss: 9.283327| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 83
Epoch 83/200 |loss: 9.442490| train set 8.339x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 84
Epoch 84/200 |loss: 7.684836| train set 8.339x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 85
Epoch 85/200 |loss: 9.744695| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 86
Epoch 86/200 |loss: 8.137275| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 87
Epoch 87/200 |loss: 9.807189| train set 8.339x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 88
Epoch 88/200 |loss: 9.996204| train set 8.339x speedup, test set 0.714x speedup, val set 0.816x speedup, step: 89
Epoch 89/200 |loss: 9.111367| train set 8.184x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 90
Epoch 90/200 |loss: 9.462744| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 91
Epoch 91/200 |loss: 8.090785| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 92
Epoch 92/200 |loss: 9.417610| train set 8.340x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 93
Epoch 93/200 |loss: 8.697618| train set 8.340x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 94
Epoch 94/200 |loss: 8.426171| train set 8.339x speedup, test set 0.892x speedup, val set 0.720x speedup, step: 95
Epoch 95/200 |loss: 10.223731| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 96
Epoch 96/200 |loss: 9.389278| train set 8.185x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 97
Epoch 97/200 |loss: 8.546880| train set 8.339x speedup, test set 0.680x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.360827| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 99
Epoch 99/200 |loss: 9.492192| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 100
Epoch 100/200 |loss: 8.383892| train set 8.335x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 1
Epoch 101/200 |loss: 10.396821| train set 8.333x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 1
Epoch 102/200 |loss: 8.818791| train set 8.333x speedup, test set 0.714x speedup, val set 0.720x speedup, step: 1
Epoch 103/200 |loss: 8.529451| train set 8.340x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 1
Epoch 104/200 |loss: 9.098077| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 2
Epoch 105/200 |loss: 9.948899| train set 8.185x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 106/200 |loss: 9.406561| train set 7.991x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 107/200 |loss: 9.159750| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 2
Epoch 108/200 |loss: 9.195159| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 3
Epoch 109/200 |loss: 8.370050| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 4
Epoch 110/200 |loss: 9.475170| train set 8.339x speedup, test set 0.757x speedup, val set 1.013x speedup, step: 1
Epoch 111/200 |loss: 9.763572| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 112/200 |loss: 7.664392| train set 7.819x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 2
Epoch 113/200 |loss: 9.292079| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 114/200 |loss: 8.290288| train set 8.339x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 115/200 |loss: 8.509032| train set 8.339x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 116/200 |loss: 7.879282| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 117/200 |loss: 9.488328| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 118/200 |loss: 9.164384| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 119/200 |loss: 9.441976| train set 8.185x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 120/200 |loss: 7.979433| train set 8.185x speedup, test set 0.714x speedup, val set 0.714x speedup, step: 2
Epoch 121/200 |loss: 8.347265| train set 8.173x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 3
Epoch 122/200 |loss: 7.954867| train set 8.183x speedup, test set 1.108x speedup, val set 1.013x speedup, step: 1
Epoch 123/200 |loss: 8.515557| train set 8.338x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 124/200 |loss: 7.997301| train set 8.338x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 125/200 |loss: 7.056331| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 126/200 |loss: 8.175449| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3
Epoch 127/200 |loss: 9.144486| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 128/200 |loss: 7.791892| train set 8.332x speedup, test set 0.779x speedup, val set 1.000x speedup, step: 2
Epoch 129/200 |loss: 7.763332| train set 8.333x speedup, test set 1.143x speedup, val set 0.798x speedup, step: 3
Epoch 130/200 |loss: 9.120023| train set 8.340x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 4
Epoch 131/200 |loss: 8.587300| train set 8.340x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 5
Epoch 132/200 |loss: 9.406137| train set 8.185x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 6
Epoch 133/200 |loss: 7.895017| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 7
Epoch 134/200 |loss: 9.237134| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 8
Epoch 135/200 |loss: 9.033572| train set 8.185x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 9
Epoch 136/200 |loss: 7.617744| train set 8.183x speedup, test set 0.714x speedup, val set 0.720x speedup, step: 10
Epoch 137/200 |loss: 8.765560| train set 8.338x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 11
Epoch 138/200 |loss: 8.872194| train set 8.183x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 12
Epoch 139/200 |loss: 9.163287| train set 8.184x speedup, test set 0.693x speedup, val set 0.816x speedup, step: 13
Epoch 140/200 |loss: 9.304188| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 14
Epoch 141/200 |loss: 10.874658| train set 8.339x speedup, test set 0.722x speedup, val set 0.714x speedup, step: 15
Epoch 142/200 |loss: 7.233228| train set 8.185x speedup, test set 0.738x speedup, val set 0.714x speedup, step: 16
Epoch 143/200 |loss: 9.286048| train set 8.339x speedup, test set 0.714x speedup, val set 0.714x speedup, step: 17
Epoch 144/200 |loss: 9.533459| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 18
Epoch 145/200 |loss: 9.057674| train set 8.339x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 19
Epoch 146/200 |loss: 10.019288| train set 8.339x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 20
Epoch 147/200 |loss: 8.610167| train set 8.339x speedup, test set 1.214x speedup, val set 0.714x speedup, step: 21
Epoch 148/200 |loss: 8.783232| train set 8.339x speedup, test set 1.299x speedup, val set 0.714x speedup, step: 22
Epoch 149/200 |loss: 10.145095| train set 8.339x speedup, test set 1.299x speedup, val set 1.000x speedup, step: 23
Epoch 150/200 |loss: 8.473177| train set 8.331x speedup, test set 1.143x speedup, val set 1.000x speedup, step: 24
Epoch 151/200 |loss: 9.165076| train set 8.337x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 25
Epoch 152/200 |loss: 8.929243| train set 8.337x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 26
Epoch 153/200 |loss: 7.787015| train set 8.337x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 27
Epoch 154/200 |loss: 9.893824| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 28
Epoch 155/200 |loss: 8.985096| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 29
Epoch 156/200 |loss: 10.043665| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 30
Epoch 157/200 |loss: 8.809470| train set 8.340x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 31
Epoch 158/200 |loss: 8.405282| train set 8.185x speedup, test set 0.693x speedup, val set 0.816x speedup, step: 32
Epoch 159/200 |loss: 9.273715| train set 8.185x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 33
Epoch 160/200 |loss: 9.357924| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 34
Epoch 161/200 |loss: 8.097385| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 35
Epoch 162/200 |loss: 9.048647| train set 8.340x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 36
Epoch 163/200 |loss: 8.034594| train set 8.185x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 37
Epoch 164/200 |loss: 7.334326| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 38
Epoch 165/200 |loss: 7.102491| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 39
Epoch 166/200 |loss: 8.120121| train set 8.337x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 40
Epoch 167/200 |loss: 8.468401| train set 8.337x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 41
Epoch 168/200 |loss: 7.298670| train set 8.338x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 42
Epoch 169/200 |loss: 8.615621| train set 8.338x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 43
Epoch 170/200 |loss: 9.020850| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 44
Epoch 171/200 |loss: 8.609948| train set 8.336x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 45
Epoch 172/200 |loss: 9.150100| train set 8.184x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 46
Epoch 173/200 |loss: 9.034458| train set 8.184x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 47
Epoch 174/200 |loss: 8.661008| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 48
Epoch 175/200 |loss: 8.082787| train set 8.332x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 49
Epoch 176/200 |loss: 7.908331| train set 8.332x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 50
Epoch 177/200 |loss: 8.696646| train set 8.338x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 51
Epoch 178/200 |loss: 8.386372| train set 8.339x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 52
Epoch 179/200 |loss: 8.353812| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 53
Epoch 180/200 |loss: 8.323502| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 54
Epoch 181/200 |loss: 8.739013| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 55
Epoch 182/200 |loss: 8.737967| train set 8.184x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 56
Epoch 183/200 |loss: 9.089736| train set 8.184x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 184/200 |loss: 8.063115| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 185/200 |loss: 6.546626| train set 8.339x speedup, test set 0.722x speedup, val set 0.714x speedup, step: 3
Epoch 186/200 |loss: 9.241571| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 4
Epoch 187/200 |loss: 7.842354| train set 8.339x speedup, test set 0.686x speedup, val set 0.967x speedup, step: 5
Epoch 188/200 |loss: 8.901934| train set 8.339x speedup, test set 0.693x speedup, val set 0.985x speedup, step: 6
Epoch 189/200 |loss: 8.500967| train set 8.185x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 7
Epoch 190/200 |loss: 9.378865| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 8
Epoch 191/200 |loss: 8.858108| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 192/200 |loss: 8.386968| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 193/200 |loss: 8.022464| train set 8.339x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 2
Epoch 194/200 |loss: 8.096657| train set 8.339x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 3
Epoch 195/200 |loss: 8.628496| train set 8.338x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 196/200 |loss: 8.767516| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 197/200 |loss: 8.275334| train set 8.183x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 2
Epoch 198/200 |loss: 7.700346| train set 8.337x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 3
Epoch 199/200 |loss: 8.819373| train set 8.337x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 4
Training per epoch cost 0.989 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 28, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 49, train speedup 8.339, test speedup 1.568, val speedup 0.720
best validation speedup epoch: 196, train speedup 8.184, test speedup 0.680, val speedup 1.013
last model at epoch 199, train speedup 8.337, test speedup 0.686, val speedup 0.714
execution cost 0:08:14.121659
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.911719, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641937| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934926| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014946| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205910| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655495| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.537993| train set 7.359x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.532381| train set 6.716x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.780485| train set 7.629x speedup, test set 0.863x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.534170| train set 7.691x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.743848| train set 7.083x speedup, test set 0.961x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.615851| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.699762| train set 8.077x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 14.015385| train set 8.137x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.671221| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 12.743032| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 17
Epoch 17/200 |loss: 13.154599| train set 8.275x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 18
Epoch 18/200 |loss: 13.524791| train set 8.275x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 13.777877| train set 8.274x speedup, test set 0.642x speedup, val set 1.013x speedup, step: 20
Epoch 20/200 |loss: 13.112993| train set 8.274x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 21
Epoch 21/200 |loss: 12.732039| train set 8.275x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 22
Epoch 22/200 |loss: 12.699448| train set 8.339x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.294763| train set 8.275x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 24
Epoch 24/200 |loss: 12.558745| train set 8.275x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 25
Epoch 25/200 |loss: 11.601256| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 26
Epoch 26/200 |loss: 11.165367| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 27
Epoch 27/200 |loss: 10.229311| train set 8.338x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 28
Epoch 28/200 |loss: 11.827809| train set 8.338x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 29
Epoch 29/200 |loss: 12.006182| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 30
Epoch 30/200 |loss: 11.281253| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 31
Epoch 31/200 |loss: 11.980828| train set 8.138x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 32
Epoch 32/200 |loss: 10.529653| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33
Epoch 33/200 |loss: 11.535783| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 11.353127| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 35
Epoch 35/200 |loss: 10.915309| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 36
Epoch 36/200 |loss: 10.905478| train set 7.817x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 37
Epoch 37/200 |loss: 10.440950| train set 8.138x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 38
Epoch 38/200 |loss: 10.826797| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 39
Epoch 39/200 |loss: 10.581038| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 40
Epoch 40/200 |loss: 10.389524| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 41
Epoch 41/200 |loss: 10.374840| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 42
Epoch 42/200 |loss: 10.101171| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 43
Epoch 43/200 |loss: 13.427701| train set 7.747x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 44
Epoch 44/200 |loss: 12.094577| train set 7.747x speedup, test set 1.368x speedup, val set 1.013x speedup, step: 45
Epoch 45/200 |loss: 10.916591| train set 8.103x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 46
Epoch 46/200 |loss: 11.323157| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 47
Epoch 47/200 |loss: 10.680785| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 48
Epoch 48/200 |loss: 11.140000| train set 8.340x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 10.749685| train set 8.340x speedup, test set 0.989x speedup, val set 0.720x speedup, step: 50
Epoch 50/200 |loss: 10.150412| train set 8.339x speedup, test set 0.833x speedup, val set 1.013x speedup, step: 51
Epoch 51/200 |loss: 11.593695| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 52
Epoch 52/200 |loss: 9.397437| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 53
Epoch 53/200 |loss: 9.855434| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 54
Epoch 54/200 |loss: 9.419926| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 55
Epoch 55/200 |loss: 9.533575| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 56
Epoch 56/200 |loss: 10.066533| train set 8.131x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 57
Epoch 57/200 |loss: 10.023977| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 58
Epoch 58/200 |loss: 9.224926| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 59
Epoch 59/200 |loss: 10.002007| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 60
Epoch 60/200 |loss: 8.083603| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 61
Epoch 61/200 |loss: 10.084757| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 11.649715| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 63
Epoch 63/200 |loss: 9.602159| train set 8.185x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 64
Epoch 64/200 |loss: 10.091940| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 65
Epoch 65/200 |loss: 10.504954| train set 8.340x speedup, test set 1.418x speedup, val set 1.013x speedup, step: 66
Epoch 66/200 |loss: 10.102087| train set 8.316x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 10.243570| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 68
Epoch 68/200 |loss: 7.778567| train set 8.338x speedup, test set 1.108x speedup, val set 1.013x speedup, step: 69
Epoch 69/200 |loss: 10.372454| train set 8.183x speedup, test set 0.680x speedup, val set 0.781x speedup, step: 70
Epoch 70/200 |loss: 10.730700| train set 8.183x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 71
Epoch 71/200 |loss: 8.923801| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 72
Epoch 72/200 |loss: 9.942638| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 8.669202| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 74
Epoch 74/200 |loss: 8.574783| train set 8.340x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 75
Epoch 75/200 |loss: 11.010352| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 76
Epoch 76/200 |loss: 9.729600| train set 7.879x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 77
Epoch 77/200 |loss: 10.558123| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 78
Epoch 78/200 |loss: 8.746763| train set 8.340x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 79
Epoch 79/200 |loss: 9.113204| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 80
Epoch 80/200 |loss: 9.508742| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 81
Epoch 81/200 |loss: 7.174784| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 82
Epoch 82/200 |loss: 9.403584| train set 7.683x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 83
Epoch 83/200 |loss: 9.471416| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 84
Epoch 84/200 |loss: 7.891278| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 85
Epoch 85/200 |loss: 9.859917| train set 8.137x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 86
Epoch 86/200 |loss: 8.429395| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 87
Epoch 87/200 |loss: 9.767450| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 88
Epoch 88/200 |loss: 10.223652| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 89
Epoch 89/200 |loss: 9.430048| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 9.535799| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 91
Epoch 91/200 |loss: 8.431252| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 92
Epoch 92/200 |loss: 9.384289| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 8.752241| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 94
Epoch 94/200 |loss: 8.414677| train set 8.340x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 95
Epoch 95/200 |loss: 10.090964| train set 8.332x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 96
Epoch 96/200 |loss: 9.221134| train set 8.178x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 8.742288| train set 8.185x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 8.317662| train set 8.339x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 9.629136| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 100
Epoch 100/200 |loss: 8.510508| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 10.197485| train set 8.340x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 102/200 |loss: 9.016535| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 103/200 |loss: 8.553159| train set 8.340x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 104/200 |loss: 9.013841| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 105/200 |loss: 9.724977| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 106/200 |loss: 9.862567| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 3
Epoch 107/200 |loss: 8.904302| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 108/200 |loss: 9.138050| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 109/200 |loss: 8.241958| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3
Epoch 110/200 |loss: 9.794792| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 4
Epoch 111/200 |loss: 9.321408| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 5
Epoch 112/200 |loss: 7.708535| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 6
Epoch 113/200 |loss: 9.145726| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 114/200 |loss: 8.537843| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 115/200 |loss: 8.437793| train set 8.185x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 116/200 |loss: 8.098686| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 117/200 |loss: 9.266710| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 118/200 |loss: 9.327057| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 119/200 |loss: 9.256788| train set 8.340x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 120/200 |loss: 7.924147| train set 8.185x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 2
Epoch 121/200 |loss: 8.365149| train set 8.174x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 3
Epoch 122/200 |loss: 8.142596| train set 8.184x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 123/200 |loss: 8.773311| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 124/200 |loss: 8.113377| train set 8.337x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 125/200 |loss: 6.980500| train set 8.338x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 3
Epoch 126/200 |loss: 8.237079| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 4
Epoch 127/200 |loss: 9.073585| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 128/200 |loss: 7.994287| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 2
Epoch 129/200 |loss: 7.666801| train set 8.332x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 3
Epoch 130/200 |loss: 9.315407| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 131/200 |loss: 8.819857| train set 8.340x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 132/200 |loss: 9.397739| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 133/200 |loss: 7.800935| train set 8.185x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 3
Epoch 134/200 |loss: 9.338429| train set 8.185x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 4
Epoch 135/200 |loss: 9.112718| train set 8.185x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 136/200 |loss: 7.700638| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 137/200 |loss: 8.658632| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 138/200 |loss: 8.925614| train set 8.183x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 2
Epoch 139/200 |loss: 9.001976| train set 8.184x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 140/200 |loss: 9.328420| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 141/200 |loss: 11.079654| train set 8.339x speedup, test set 0.754x speedup, val set 1.013x speedup, step: 1
Epoch 142/200 |loss: 6.981087| train set 8.185x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 143/200 |loss: 9.304126| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 144/200 |loss: 9.362386| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 145/200 |loss: 9.079569| train set 8.332x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 146/200 |loss: 9.600589| train set 8.332x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 1
Epoch 147/200 |loss: 8.808300| train set 8.332x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 148/200 |loss: 9.049930| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 149/200 |loss: 10.074245| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 150/200 |loss: 8.512157| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 151/200 |loss: 9.044364| train set 8.184x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 152/200 |loss: 9.038344| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 153/200 |loss: 7.879553| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 154/200 |loss: 10.133224| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 155/200 |loss: 8.898991| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 156/200 |loss: 10.253232| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 157/200 |loss: 9.083539| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2
Epoch 158/200 |loss: 8.704629| train set 8.185x speedup, test set 0.680x speedup, val set 0.716x speedup, step: 3
Epoch 159/200 |loss: 9.137156| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 4
Epoch 160/200 |loss: 9.500379| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 5
Epoch 161/200 |loss: 8.093174| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 162/200 |loss: 8.976000| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 163/200 |loss: 8.040926| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 3
Epoch 164/200 |loss: 7.131233| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 165/200 |loss: 7.235940| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 166/200 |loss: 8.099809| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 167/200 |loss: 8.321340| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 168/200 |loss: 7.441728| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 169/200 |loss: 8.477417| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 170/200 |loss: 8.969867| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 171/200 |loss: 8.467643| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 172/200 |loss: 9.120134| train set 8.174x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 2
Epoch 173/200 |loss: 9.009252| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 174/200 |loss: 8.609624| train set 8.339x speedup, test set 0.689x speedup, val set 1.013x speedup, step: 1
Epoch 175/200 |loss: 8.056542| train set 8.334x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 176/200 |loss: 8.063644| train set 8.332x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 177/200 |loss: 8.733717| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 178/200 |loss: 8.440766| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 179/200 |loss: 8.391745| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 180/200 |loss: 8.229069| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 181/200 |loss: 8.708988| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 2
Epoch 182/200 |loss: 8.555693| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 183/200 |loss: 9.138217| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 2
Epoch 184/200 |loss: 7.808007| train set 8.185x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 3
Epoch 185/200 |loss: 6.396779| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 4
Epoch 186/200 |loss: 9.257450| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 187/200 |loss: 7.763769| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 188/200 |loss: 8.749569| train set 8.340x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 189/200 |loss: 8.395411| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 190/200 |loss: 9.296406| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 3
Epoch 191/200 |loss: 8.722699| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 192/200 |loss: 8.301742| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 193/200 |loss: 8.008740| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 194/200 |loss: 8.094098| train set 8.338x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 195/200 |loss: 8.505761| train set 8.337x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 196/200 |loss: 8.644816| train set 8.183x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 197/200 |loss: 8.098882| train set 8.337x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 198/200 |loss: 7.664197| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 199/200 |loss: 8.690882| train set 8.327x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 2
Training per epoch cost 0.921 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 32, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 65, train speedup 8.340, test speedup 1.418, val speedup 1.013
best validation speedup epoch: 198, train speedup 8.338, test speedup 0.680, val speedup 1.013
last model at epoch 199, train speedup 8.327, test speedup 0.686, val speedup 1.000
execution cost 0:07:43.666019
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.435466, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641937| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934926| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014946| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205910| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655495| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.537993| train set 7.359x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.532383| train set 6.716x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.780485| train set 7.629x speedup, test set 0.863x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.534171| train set 7.691x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.743786| train set 7.083x speedup, test set 0.961x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.614029| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.690656| train set 8.077x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 14.027449| train set 8.137x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.698889| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 12.813704| train set 8.339x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 17
Epoch 17/200 |loss: 12.922394| train set 8.275x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 18
Epoch 18/200 |loss: 13.479151| train set 8.275x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 13.851538| train set 8.308x speedup, test set 0.642x speedup, val set 1.013x speedup, step: 20
Epoch 20/200 |loss: 13.038966| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 21
Epoch 21/200 |loss: 12.810347| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 22
Epoch 22/200 |loss: 12.506318| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.425417| train set 8.275x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 24
Epoch 24/200 |loss: 12.724545| train set 8.275x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 25
Epoch 25/200 |loss: 11.747201| train set 7.812x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 26
Epoch 26/200 |loss: 11.124321| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 27
Epoch 27/200 |loss: 10.484953| train set 8.338x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 28
Epoch 28/200 |loss: 12.137442| train set 8.340x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 29
Epoch 29/200 |loss: 12.084352| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 30
Epoch 30/200 |loss: 11.255015| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 31
Epoch 31/200 |loss: 11.839698| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 32
Epoch 32/200 |loss: 10.336068| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 33
Epoch 33/200 |loss: 10.816331| train set 8.138x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 10.714872| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 35
Epoch 35/200 |loss: 10.446042| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 36
Epoch 36/200 |loss: 10.601609| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 37
Epoch 37/200 |loss: 9.874368| train set 8.138x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 38
Epoch 38/200 |loss: 10.707462| train set 8.340x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 39
Epoch 39/200 |loss: 10.708285| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 40
Epoch 40/200 |loss: 10.237875| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 41
Epoch 41/200 |loss: 10.935120| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 42
Epoch 42/200 |loss: 10.037501| train set 8.075x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 43
Epoch 43/200 |loss: 14.922509| train set 8.340x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 44
Epoch 44/200 |loss: 12.154854| train set 8.339x speedup, test set 1.299x speedup, val set 1.000x speedup, step: 45
Epoch 45/200 |loss: 11.297788| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 46
Epoch 46/200 |loss: 11.725714| train set 8.338x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 47
Epoch 47/200 |loss: 10.734020| train set 8.338x speedup, test set 1.108x speedup, val set 0.720x speedup, step: 48
Epoch 48/200 |loss: 11.218384| train set 7.818x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 10.515571| train set 8.339x speedup, test set 0.750x speedup, val set 0.720x speedup, step: 50
Epoch 50/200 |loss: 11.045908| train set 8.339x speedup, test set 0.684x speedup, val set 1.013x speedup, step: 51
Epoch 51/200 |loss: 11.566950| train set 8.339x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 52
Epoch 52/200 |loss: 9.993494| train set 8.085x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 53
Epoch 53/200 |loss: 9.477283| train set 8.185x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 54
Epoch 54/200 |loss: 10.083735| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 55
Epoch 55/200 |loss: 9.155253| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 56
Epoch 56/200 |loss: 10.636274| train set 8.340x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 57
Epoch 57/200 |loss: 10.310624| train set 8.340x speedup, test set 0.747x speedup, val set 0.974x speedup, step: 58
Epoch 58/200 |loss: 9.840759| train set 8.340x speedup, test set 1.298x speedup, val set 0.974x speedup, step: 59
Epoch 59/200 |loss: 10.273644| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 60
Epoch 60/200 |loss: 8.281633| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 61
Epoch 61/200 |loss: 10.246612| train set 8.339x speedup, test set 0.998x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 11.520367| train set 8.339x speedup, test set 1.143x speedup, val set 0.714x speedup, step: 63
Epoch 63/200 |loss: 9.747133| train set 8.339x speedup, test set 1.299x speedup, val set 0.714x speedup, step: 64
Epoch 64/200 |loss: 9.348269| train set 8.340x speedup, test set 1.299x speedup, val set 0.714x speedup, step: 65
Epoch 65/200 |loss: 10.402165| train set 8.325x speedup, test set 1.143x speedup, val set 0.714x speedup, step: 66
Epoch 66/200 |loss: 9.976803| train set 8.326x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 9.481269| train set 8.340x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 68
Epoch 68/200 |loss: 7.756290| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 69
Epoch 69/200 |loss: 10.207226| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 70
Epoch 70/200 |loss: 10.971577| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 71
Epoch 71/200 |loss: 8.676559| train set 8.118x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 72
Epoch 72/200 |loss: 9.624992| train set 8.118x speedup, test set 1.194x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 8.771346| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 74
Epoch 74/200 |loss: 8.191257| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 75
Epoch 75/200 |loss: 10.600533| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 76
Epoch 76/200 |loss: 9.548117| train set 8.185x speedup, test set 1.194x speedup, val set 1.013x speedup, step: 77
Epoch 77/200 |loss: 10.027541| train set 8.340x speedup, test set 0.757x speedup, val set 1.013x speedup, step: 78
Epoch 78/200 |loss: 9.014164| train set 8.339x speedup, test set 0.714x speedup, val set 0.720x speedup, step: 79
Epoch 79/200 |loss: 9.524818| train set 8.340x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 80
Epoch 80/200 |loss: 9.722836| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 81
Epoch 81/200 |loss: 7.201318| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 82
Epoch 82/200 |loss: 9.175571| train set 7.819x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 83
Epoch 83/200 |loss: 9.671120| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 84
Epoch 84/200 |loss: 7.807772| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 85
Epoch 85/200 |loss: 9.834215| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 86
Epoch 86/200 |loss: 8.210616| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 87
Epoch 87/200 |loss: 9.931617| train set 8.339x speedup, test set 0.714x speedup, val set 0.824x speedup, step: 88
Epoch 88/200 |loss: 9.872162| train set 8.339x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 89
Epoch 89/200 |loss: 9.249420| train set 8.184x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 90
Epoch 90/200 |loss: 9.610556| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 91
Epoch 91/200 |loss: 8.273989| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 92
Epoch 92/200 |loss: 9.219632| train set 8.340x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 8.785892| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 8.400580| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 95
Epoch 95/200 |loss: 9.875240| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 96
Epoch 96/200 |loss: 9.343067| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 8.427383| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 8.044459| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 99
Epoch 99/200 |loss: 9.626429| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 100
Epoch 100/200 |loss: 8.140858| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 10.216267| train set 8.333x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 1
Epoch 102/200 |loss: 8.571596| train set 8.331x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 2
Epoch 103/200 |loss: 8.413654| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 1
Epoch 104/200 |loss: 9.025091| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 105/200 |loss: 9.607703| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 106/200 |loss: 9.521455| train set 8.332x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 3
Epoch 107/200 |loss: 9.181626| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1
Epoch 108/200 |loss: 9.209307| train set 8.340x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 2
Epoch 109/200 |loss: 8.599452| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 3
Epoch 110/200 |loss: 9.848357| train set 8.339x speedup, test set 0.722x speedup, val set 1.000x speedup, step: 4
Epoch 111/200 |loss: 9.918336| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 5
Epoch 112/200 |loss: 7.582700| train set 7.819x speedup, test set 0.747x speedup, val set 0.816x speedup, step: 6
Epoch 113/200 |loss: 9.386714| train set 7.747x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 7
Epoch 114/200 |loss: 8.357656| train set 8.303x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 115/200 |loss: 9.216682| train set 8.340x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 116/200 |loss: 8.224281| train set 8.340x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 2
Epoch 117/200 |loss: 10.111909| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 3
Epoch 118/200 |loss: 9.347606| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 4
Epoch 119/200 |loss: 9.364977| train set 8.340x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 5
Epoch 120/200 |loss: 8.186028| train set 8.185x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 6
Epoch 121/200 |loss: 8.449481| train set 8.184x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 7
Epoch 122/200 |loss: 8.294051| train set 8.184x speedup, test set 1.299x speedup, val set 1.000x speedup, step: 8
Epoch 123/200 |loss: 8.774909| train set 8.183x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 9
Epoch 124/200 |loss: 8.311022| train set 8.183x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 10
Epoch 125/200 |loss: 7.045590| train set 8.338x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 11
Epoch 126/200 |loss: 8.312544| train set 8.338x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 12
Epoch 127/200 |loss: 9.543736| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 13
Epoch 128/200 |loss: 8.038438| train set 8.332x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 14
Epoch 129/200 |loss: 8.096240| train set 8.333x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 15
Epoch 130/200 |loss: 9.037183| train set 8.340x speedup, test set 1.108x speedup, val set 0.714x speedup, step: 16
Epoch 131/200 |loss: 8.996426| train set 8.340x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 17
Epoch 132/200 |loss: 9.403182| train set 8.185x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 18
Epoch 133/200 |loss: 8.172361| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 19
Epoch 134/200 |loss: 9.372339| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 20
Epoch 135/200 |loss: 9.048949| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 21
Epoch 136/200 |loss: 7.615553| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 22
Epoch 137/200 |loss: 8.941499| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 23
Epoch 138/200 |loss: 8.846124| train set 8.185x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 24
Epoch 139/200 |loss: 9.185235| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 25
Epoch 140/200 |loss: 9.422037| train set 8.340x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 26
Epoch 141/200 |loss: 10.968808| train set 8.339x speedup, test set 0.818x speedup, val set 0.714x speedup, step: 27
Epoch 142/200 |loss: 7.108702| train set 8.185x speedup, test set 0.818x speedup, val set 0.714x speedup, step: 28
Epoch 143/200 |loss: 9.480740| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 29
Epoch 144/200 |loss: 9.457802| train set 8.339x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 30
Epoch 145/200 |loss: 8.995239| train set 8.332x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 31
Epoch 146/200 |loss: 9.672888| train set 8.332x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 32
Epoch 147/200 |loss: 8.657424| train set 8.339x speedup, test set 1.214x speedup, val set 0.824x speedup, step: 33
Epoch 148/200 |loss: 8.770062| train set 8.339x speedup, test set 1.418x speedup, val set 0.824x speedup, step: 34
Epoch 149/200 |loss: 10.143021| train set 7.746x speedup, test set 1.214x speedup, val set 0.816x speedup, step: 35
Epoch 150/200 |loss: 8.454782| train set 8.339x speedup, test set 1.143x speedup, val set 1.000x speedup, step: 36
Epoch 151/200 |loss: 9.190418| train set 8.337x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 37
Epoch 152/200 |loss: 8.890263| train set 8.335x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 38
Epoch 153/200 |loss: 8.054812| train set 8.337x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 39
Epoch 154/200 |loss: 10.050093| train set 8.183x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 40
Epoch 155/200 |loss: 8.934567| train set 8.184x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 41
Epoch 156/200 |loss: 9.942415| train set 8.185x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 42
Epoch 157/200 |loss: 8.827333| train set 7.856x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 43
Epoch 158/200 |loss: 8.403603| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 44
Epoch 159/200 |loss: 9.188157| train set 8.184x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 45
Epoch 160/200 |loss: 9.103158| train set 8.339x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 46
Epoch 161/200 |loss: 8.066997| train set 8.339x speedup, test set 0.754x speedup, val set 1.000x speedup, step: 47
Epoch 162/200 |loss: 8.825056| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 48
Epoch 163/200 |loss: 8.035967| train set 8.339x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 49
Epoch 164/200 |loss: 7.186742| train set 8.337x speedup, test set 0.722x speedup, val set 1.000x speedup, step: 50
Epoch 165/200 |loss: 7.010473| train set 8.337x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 51
Epoch 166/200 |loss: 8.018420| train set 8.337x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 52
Epoch 167/200 |loss: 8.303553| train set 8.337x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 53
Epoch 168/200 |loss: 7.286253| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 54
Epoch 169/200 |loss: 8.468657| train set 8.337x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 55
Epoch 170/200 |loss: 8.909811| train set 8.338x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 56
Epoch 171/200 |loss: 8.454671| train set 8.338x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 57
Epoch 172/200 |loss: 9.337073| train set 8.339x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 58
Epoch 173/200 |loss: 9.127178| train set 8.339x speedup, test set 0.714x speedup, val set 0.816x speedup, step: 59
Epoch 174/200 |loss: 8.648693| train set 8.332x speedup, test set 0.693x speedup, val set 0.746x speedup, step: 60
Epoch 175/200 |loss: 8.101657| train set 8.332x speedup, test set 0.693x speedup, val set 0.816x speedup, step: 61
Epoch 176/200 |loss: 8.141203| train set 8.339x speedup, test set 0.693x speedup, val set 0.816x speedup, step: 62
Epoch 177/200 |loss: 8.842341| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 63
Epoch 178/200 |loss: 8.427761| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 64
Epoch 179/200 |loss: 8.740820| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 65
Epoch 180/200 |loss: 8.573935| train set 8.339x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 66
Epoch 181/200 |loss: 8.838550| train set 8.184x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 67
Epoch 182/200 |loss: 8.651749| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 68
Epoch 183/200 |loss: 9.318477| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 69
Epoch 184/200 |loss: 8.121737| train set 8.184x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 70
Epoch 185/200 |loss: 6.675347| train set 8.184x speedup, test set 0.840x speedup, val set 0.714x speedup, step: 71
Epoch 186/200 |loss: 9.370976| train set 8.339x speedup, test set 0.714x speedup, val set 0.714x speedup, step: 72
Epoch 187/200 |loss: 7.827108| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 73
Epoch 188/200 |loss: 8.927058| train set 8.329x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 74
Epoch 189/200 |loss: 8.582101| train set 8.175x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 75
Epoch 190/200 |loss: 9.512639| train set 8.340x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 76
Epoch 191/200 |loss: 9.089602| train set 8.340x speedup, test set 0.747x speedup, val set 0.816x speedup, step: 77
Epoch 192/200 |loss: 8.362234| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 78
Epoch 193/200 |loss: 7.989102| train set 8.339x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 79
Epoch 194/200 |loss: 8.065460| train set 8.338x speedup, test set 0.840x speedup, val set 1.000x speedup, step: 80
Epoch 195/200 |loss: 8.722378| train set 8.337x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 81
Epoch 196/200 |loss: 8.832889| train set 8.337x speedup, test set 0.754x speedup, val set 1.000x speedup, step: 82
Epoch 197/200 |loss: 8.193142| train set 8.183x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 83
Epoch 198/200 |loss: 7.621475| train set 8.176x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 84
Epoch 199/200 |loss: 8.905248| train set 8.330x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 85
Training per epoch cost 0.972 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 28, train speedup 8.340, test speedup 0.747, val speedup 0.720
best test speedup epoch: 48, train speedup 7.818, test speedup 1.568, val speedup 0.720
best validation speedup epoch: 115, train speedup 8.340, test speedup 0.686, val speedup 1.013
last model at epoch 199, train speedup 8.330, test speedup 0.693, val speedup 1.000
execution cost 0:08:06.830427
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.823182, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641933| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934925| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014949| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205911| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655450| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.528620| train set 7.575x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.532990| train set 6.716x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.748155| train set 7.460x speedup, test set 0.918x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.511247| train set 7.747x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.754311| train set 7.691x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.697148| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.674724| train set 8.077x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 13.875854| train set 8.275x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.418440| train set 7.978x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 12.816853| train set 8.058x speedup, test set 0.642x speedup, val set 1.013x speedup, step: 17
Epoch 17/200 |loss: 13.799007| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 18
Epoch 18/200 |loss: 13.936041| train set 7.761x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 14.452441| train set 7.745x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 20
Epoch 20/200 |loss: 13.553819| train set 7.830x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 21
Epoch 21/200 |loss: 13.540257| train set 8.274x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 22
Epoch 22/200 |loss: 12.848791| train set 8.275x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.576447| train set 8.138x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 24
Epoch 24/200 |loss: 12.719223| train set 8.138x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 25
Epoch 25/200 |loss: 11.739777| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 26
Epoch 26/200 |loss: 11.253762| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 27
Epoch 27/200 |loss: 10.711226| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 28
Epoch 28/200 |loss: 11.876818| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 29
Epoch 29/200 |loss: 12.122749| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 30
Epoch 30/200 |loss: 11.163053| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 31
Epoch 31/200 |loss: 11.809290| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 32
Epoch 32/200 |loss: 9.826849| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33
Epoch 33/200 |loss: 10.625310| train set 8.138x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 10.697343| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 35
Epoch 35/200 |loss: 10.521259| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 36
Epoch 36/200 |loss: 10.623557| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 37
Epoch 37/200 |loss: 9.836188| train set 8.338x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 38
Epoch 38/200 |loss: 10.770929| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 39
Epoch 39/200 |loss: 10.476902| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 40
Epoch 40/200 |loss: 10.003406| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 41
Epoch 41/200 |loss: 10.477506| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 42
Epoch 42/200 |loss: 9.762076| train set 8.085x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 43
Epoch 43/200 |loss: 13.991937| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 44
Epoch 44/200 |loss: 12.231097| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 45
Epoch 45/200 |loss: 10.672873| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 46
Epoch 46/200 |loss: 11.314950| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 47
Epoch 47/200 |loss: 10.356756| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 48
Epoch 48/200 |loss: 11.010303| train set 8.340x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 10.510205| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 50
Epoch 50/200 |loss: 9.780669| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 51
Epoch 51/200 |loss: 11.452738| train set 8.339x speedup, test set 1.194x speedup, val set 0.720x speedup, step: 52
Epoch 52/200 |loss: 9.572081| train set 8.332x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 53
Epoch 53/200 |loss: 9.720573| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 54
Epoch 54/200 |loss: 9.276322| train set 8.339x speedup, test set 0.750x speedup, val set 0.720x speedup, step: 55
Epoch 55/200 |loss: 9.254119| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 56
Epoch 56/200 |loss: 9.469286| train set 8.332x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 57
Epoch 57/200 |loss: 9.572278| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 58
Epoch 58/200 |loss: 8.960032| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 59
Epoch 59/200 |loss: 10.005277| train set 8.325x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 60
Epoch 60/200 |loss: 7.972141| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 61
Epoch 61/200 |loss: 10.155749| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 10.876572| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 63
Epoch 63/200 |loss: 9.404500| train set 8.185x speedup, test set 0.714x speedup, val set 0.720x speedup, step: 64
Epoch 64/200 |loss: 9.256789| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 65
Epoch 65/200 |loss: 10.394966| train set 8.332x speedup, test set 1.194x speedup, val set 0.720x speedup, step: 66
Epoch 66/200 |loss: 10.137793| train set 8.325x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 9.819700| train set 8.339x speedup, test set 1.108x speedup, val set 0.720x speedup, step: 68
Epoch 68/200 |loss: 7.976160| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 69
Epoch 69/200 |loss: 10.934570| train set 8.185x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 70
Epoch 70/200 |loss: 11.051929| train set 8.340x speedup, test set 1.125x speedup, val set 0.720x speedup, step: 71
Epoch 71/200 |loss: 8.979825| train set 8.340x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 72
Epoch 72/200 |loss: 9.997513| train set 8.340x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 9.074881| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 74
Epoch 74/200 |loss: 8.214847| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 75
Epoch 75/200 |loss: 11.269772| train set 7.747x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 76
Epoch 76/200 |loss: 9.840106| train set 8.185x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 77
Epoch 77/200 |loss: 10.778482| train set 8.185x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 78
Epoch 78/200 |loss: 9.487187| train set 8.340x speedup, test set 0.757x speedup, val set 1.013x speedup, step: 79
Epoch 79/200 |loss: 10.021686| train set 8.333x speedup, test set 0.952x speedup, val set 0.720x speedup, step: 80
Epoch 80/200 |loss: 10.238118| train set 8.339x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 81
Epoch 81/200 |loss: 7.543482| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 82
Epoch 82/200 |loss: 9.649759| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 83
Epoch 83/200 |loss: 9.621388| train set 7.683x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 84
Epoch 84/200 |loss: 8.299054| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 85
Epoch 85/200 |loss: 9.965923| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 86
Epoch 86/200 |loss: 8.337784| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 87
Epoch 87/200 |loss: 10.056904| train set 8.339x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 88
Epoch 88/200 |loss: 10.317405| train set 8.339x speedup, test set 0.952x speedup, val set 1.013x speedup, step: 89
Epoch 89/200 |loss: 9.110614| train set 8.184x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 90
Epoch 90/200 |loss: 9.573426| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 91
Epoch 91/200 |loss: 8.268400| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 92
Epoch 92/200 |loss: 9.300260| train set 8.340x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 93
Epoch 93/200 |loss: 8.839133| train set 8.340x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 94
Epoch 94/200 |loss: 8.535081| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 95
Epoch 95/200 |loss: 10.042806| train set 8.332x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 96
Epoch 96/200 |loss: 9.243621| train set 8.185x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 97
Epoch 97/200 |loss: 8.555479| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 98
Epoch 98/200 |loss: 8.290084| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 99
Epoch 99/200 |loss: 9.624842| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 100
Epoch 100/200 |loss: 8.224387| train set 8.340x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 101/200 |loss: 10.257612| train set 8.340x speedup, test set 1.143x speedup, val set 0.714x speedup, step: 2
Epoch 102/200 |loss: 8.795260| train set 8.340x speedup, test set 0.952x speedup, val set 0.714x speedup, step: 3
Epoch 103/200 |loss: 8.497402| train set 8.339x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 104/200 |loss: 9.005951| train set 7.747x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 105/200 |loss: 9.821379| train set 8.185x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 106/200 |loss: 9.778614| train set 8.138x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 107/200 |loss: 9.119388| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 108/200 |loss: 9.369414| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 2
Epoch 109/200 |loss: 8.184441| train set 8.185x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 3
Epoch 110/200 |loss: 9.876626| train set 8.339x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 111/200 |loss: 9.815123| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 2
Epoch 112/200 |loss: 7.754277| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 3
Epoch 113/200 |loss: 9.391416| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 1
Epoch 114/200 |loss: 8.427998| train set 8.339x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 115/200 |loss: 8.642890| train set 8.339x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 116/200 |loss: 8.024702| train set 8.340x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 2
Epoch 117/200 |loss: 9.513359| train set 8.340x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 118/200 |loss: 9.167273| train set 8.340x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 119/200 |loss: 9.304405| train set 8.340x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 120/200 |loss: 7.963110| train set 8.185x speedup, test set 0.822x speedup, val set 1.013x speedup, step: 1
Epoch 121/200 |loss: 8.268900| train set 8.183x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 122/200 |loss: 8.117285| train set 8.185x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 123/200 |loss: 8.601494| train set 8.185x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 124/200 |loss: 8.128078| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 125/200 |loss: 6.926114| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2
Epoch 126/200 |loss: 8.263213| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 3
Epoch 127/200 |loss: 9.199316| train set 8.339x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 128/200 |loss: 7.926176| train set 8.339x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 129/200 |loss: 8.010298| train set 8.339x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 130/200 |loss: 9.120639| train set 8.339x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 2
Epoch 131/200 |loss: 8.798204| train set 8.339x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 3
Epoch 132/200 |loss: 9.330328| train set 8.339x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 133/200 |loss: 7.944210| train set 8.185x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 134/200 |loss: 9.288785| train set 8.184x speedup, test set 1.143x speedup, val set 0.896x speedup, step: 2
Epoch 135/200 |loss: 9.016795| train set 8.184x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 3
Epoch 136/200 |loss: 7.626598| train set 8.184x speedup, test set 0.738x speedup, val set 1.013x speedup, step: 1
Epoch 137/200 |loss: 8.723584| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 138/200 |loss: 8.855396| train set 8.184x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 139/200 |loss: 9.071670| train set 8.184x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 140/200 |loss: 9.261567| train set 8.339x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 141/200 |loss: 10.896500| train set 8.339x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 2
Epoch 142/200 |loss: 7.092531| train set 8.339x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 143/200 |loss: 9.323331| train set 8.339x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 144/200 |loss: 9.613780| train set 8.339x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 1
Epoch 145/200 |loss: 9.066133| train set 8.339x speedup, test set 0.757x speedup, val set 1.013x speedup, step: 1
Epoch 146/200 |loss: 9.588656| train set 8.332x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 147/200 |loss: 8.668459| train set 8.334x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 2
Epoch 148/200 |loss: 8.593531| train set 8.328x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 3
Epoch 149/200 |loss: 10.269442| train set 8.339x speedup, test set 1.299x speedup, val set 1.000x speedup, step: 4
Epoch 150/200 |loss: 8.276245| train set 8.339x speedup, test set 1.299x speedup, val set 1.000x speedup, step: 5
Epoch 151/200 |loss: 9.099490| train set 8.337x speedup, test set 1.214x speedup, val set 1.013x speedup, step: 1
Epoch 152/200 |loss: 8.986531| train set 8.337x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 2
Epoch 153/200 |loss: 7.959824| train set 8.337x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3
Epoch 154/200 |loss: 9.917112| train set 8.184x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 4
Epoch 155/200 |loss: 8.929784| train set 8.184x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 5
Epoch 156/200 |loss: 10.036501| train set 8.185x speedup, test set 1.299x speedup, val set 0.885x speedup, step: 6
Epoch 157/200 |loss: 8.865047| train set 7.856x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 7
Epoch 158/200 |loss: 8.356870| train set 8.185x speedup, test set 1.143x speedup, val set 1.000x speedup, step: 8
Epoch 159/200 |loss: 9.042528| train set 8.184x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 9
Epoch 160/200 |loss: 9.237718| train set 8.339x speedup, test set 1.214x speedup, val set 1.000x speedup, step: 10
Epoch 161/200 |loss: 8.202037| train set 8.339x speedup, test set 1.299x speedup, val set 1.000x speedup, step: 11
Epoch 162/200 |loss: 8.784818| train set 8.339x speedup, test set 1.143x speedup, val set 1.000x speedup, step: 12
Epoch 163/200 |loss: 8.135926| train set 8.338x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 13
Epoch 164/200 |loss: 7.323503| train set 8.338x speedup, test set 1.143x speedup, val set 1.000x speedup, step: 14
Epoch 165/200 |loss: 7.040580| train set 8.337x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 166/200 |loss: 8.080397| train set 8.337x speedup, test set 0.952x speedup, val set 0.714x speedup, step: 2
Epoch 167/200 |loss: 8.236043| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 3
Epoch 168/200 |loss: 7.403953| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 169/200 |loss: 8.424021| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 2
Epoch 170/200 |loss: 9.032828| train set 8.338x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 3
Epoch 171/200 |loss: 8.387061| train set 8.184x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 172/200 |loss: 9.148869| train set 8.184x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 2
Epoch 173/200 |loss: 9.015360| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 3
Epoch 174/200 |loss: 8.552290| train set 8.332x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 4
Epoch 175/200 |loss: 8.095147| train set 8.332x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 5
Epoch 176/200 |loss: 7.936096| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 6
Epoch 177/200 |loss: 8.652332| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 7
Epoch 178/200 |loss: 8.509654| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 8
Epoch 179/200 |loss: 8.550934| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 9
Epoch 180/200 |loss: 8.388969| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 10
Epoch 181/200 |loss: 8.857983| train set 8.339x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 11
Epoch 182/200 |loss: 8.834979| train set 8.184x speedup, test set 0.680x speedup, val set 1.000x speedup, step: 12
Epoch 183/200 |loss: 9.263657| train set 8.184x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 184/200 |loss: 8.094651| train set 8.185x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 185/200 |loss: 6.721419| train set 8.340x speedup, test set 0.728x speedup, val set 0.720x speedup, step: 2
Epoch 186/200 |loss: 9.354103| train set 7.819x speedup, test set 0.738x speedup, val set 0.714x speedup, step: 3
Epoch 187/200 |loss: 7.966804| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 188/200 |loss: 8.709055| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 2
Epoch 189/200 |loss: 8.671589| train set 8.185x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 3
Epoch 190/200 |loss: 9.298577| train set 8.339x speedup, test set 1.214x speedup, val set 0.714x speedup, step: 4
Epoch 191/200 |loss: 9.388947| train set 8.339x speedup, test set 1.568x speedup, val set 1.013x speedup, step: 1
Epoch 192/200 |loss: 8.372982| train set 8.339x speedup, test set 0.714x speedup, val set 1.000x speedup, step: 2
Epoch 193/200 |loss: 8.494568| train set 8.339x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 194/200 |loss: 8.304417| train set 8.338x speedup, test set 0.722x speedup, val set 0.714x speedup, step: 4
Epoch 195/200 |loss: 8.872445| train set 8.338x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 5
Epoch 196/200 |loss: 8.934562| train set 8.183x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 6
Epoch 197/200 |loss: 8.436004| train set 8.337x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 198/200 |loss: 7.709582| train set 8.183x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 2
Epoch 199/200 |loss: 9.107474| train set 8.337x speedup, test set 1.143x speedup, val set 1.000x speedup, step: 3
Training per epoch cost 0.882 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 43, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 191, train speedup 8.339, test speedup 1.568, val speedup 1.013
best validation speedup epoch: 197, train speedup 8.337, test speedup 0.686, val speedup 1.013
last model at epoch 199, train speedup 8.337, test speedup 1.143, val speedup 1.000
execution cost 0:07:21.884849
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:02.018647, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 23.609109| train set 4.466x speedup, test set 0.650x speedup, val set 0.816x speedup, step: 1
Epoch 1/200 |loss: 21.746674| train set 4.837x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2
Epoch 2/200 |loss: 21.641935| train set 4.611x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 3
Epoch 3/200 |loss: 22.934926| train set 6.506x speedup, test set 0.729x speedup, val set 0.714x speedup, step: 4
Epoch 4/200 |loss: 24.014949| train set 5.058x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 5
Epoch 5/200 |loss: 19.205910| train set 5.526x speedup, test set 0.698x speedup, val set 0.720x speedup, step: 6
Epoch 6/200 |loss: 16.655450| train set 7.099x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 7
Epoch 7/200 |loss: 17.528624| train set 7.575x speedup, test set 0.790x speedup, val set 0.720x speedup, step: 8
Epoch 8/200 |loss: 15.533016| train set 6.716x speedup, test set 0.650x speedup, val set 0.720x speedup, step: 9
Epoch 9/200 |loss: 17.748142| train set 7.460x speedup, test set 0.889x speedup, val set 0.720x speedup, step: 10
Epoch 10/200 |loss: 14.521697| train set 7.747x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 11
Epoch 11/200 |loss: 13.758473| train set 7.083x speedup, test set 0.662x speedup, val set 0.720x speedup, step: 12
Epoch 12/200 |loss: 16.769200| train set 7.691x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 13
Epoch 13/200 |loss: 13.749043| train set 8.077x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 14
Epoch 14/200 |loss: 13.926535| train set 7.761x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 15
Epoch 15/200 |loss: 14.486779| train set 7.926x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 16
Epoch 16/200 |loss: 13.008631| train set 8.077x speedup, test set 0.642x speedup, val set 1.013x speedup, step: 17
Epoch 17/200 |loss: 13.447788| train set 8.275x speedup, test set 0.642x speedup, val set 0.714x speedup, step: 18
Epoch 18/200 |loss: 13.692596| train set 8.274x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 19
Epoch 19/200 |loss: 14.410271| train set 8.338x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 20
Epoch 20/200 |loss: 13.711091| train set 8.138x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 21
Epoch 21/200 |loss: 13.437411| train set 7.747x speedup, test set 0.642x speedup, val set 0.720x speedup, step: 22
Epoch 22/200 |loss: 13.104786| train set 8.275x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 23
Epoch 23/200 |loss: 10.677145| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 24
Epoch 24/200 |loss: 12.889199| train set 8.077x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 25
Epoch 25/200 |loss: 12.118299| train set 8.275x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 26
Epoch 26/200 |loss: 11.699271| train set 7.818x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 27
Epoch 27/200 |loss: 10.793619| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 28
Epoch 28/200 |loss: 12.256213| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 29
Epoch 29/200 |loss: 12.489410| train set 8.138x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 30
Epoch 30/200 |loss: 11.457678| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 31
Epoch 31/200 |loss: 11.697016| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 32
Epoch 32/200 |loss: 10.120327| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 33
Epoch 33/200 |loss: 10.420155| train set 8.138x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 34
Epoch 34/200 |loss: 11.250676| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 35
Epoch 35/200 |loss: 11.044600| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 36
Epoch 36/200 |loss: 10.726575| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 37
Epoch 37/200 |loss: 10.435916| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 38
Epoch 38/200 |loss: 10.688582| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 39
Epoch 39/200 |loss: 10.837684| train set 8.339x speedup, test set 0.680x speedup, val set 0.974x speedup, step: 40
Epoch 40/200 |loss: 10.364974| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 41
Epoch 41/200 |loss: 10.323139| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 42
Epoch 42/200 |loss: 9.830606| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 43
Epoch 43/200 |loss: 13.599552| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 44
Epoch 44/200 |loss: 11.332205| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 45
Epoch 45/200 |loss: 10.649690| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 46
Epoch 46/200 |loss: 10.918463| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 47
Epoch 47/200 |loss: 10.194770| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 48
Epoch 48/200 |loss: 10.873552| train set 8.340x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 49
Epoch 49/200 |loss: 10.455172| train set 8.339x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 50
Epoch 50/200 |loss: 10.128181| train set 8.339x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 51
Epoch 51/200 |loss: 11.843577| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 52
Epoch 52/200 |loss: 9.565672| train set 8.339x speedup, test set 1.299x speedup, val set 1.013x speedup, step: 53
Epoch 53/200 |loss: 9.803302| train set 8.184x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 54
Epoch 54/200 |loss: 9.411592| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 55
Epoch 55/200 |loss: 9.442431| train set 8.339x speedup, test set 1.108x speedup, val set 0.720x speedup, step: 56
Epoch 56/200 |loss: 9.707291| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 57
Epoch 57/200 |loss: 9.608379| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 58
Epoch 58/200 |loss: 8.896608| train set 7.747x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 59
Epoch 59/200 |loss: 9.988901| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 60
Epoch 60/200 |loss: 7.863130| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 61
Epoch 61/200 |loss: 9.852417| train set 8.339x speedup, test set 1.194x speedup, val set 0.720x speedup, step: 62
Epoch 62/200 |loss: 10.873755| train set 8.339x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 63
Epoch 63/200 |loss: 9.159997| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 64
Epoch 64/200 |loss: 9.172944| train set 8.339x speedup, test set 1.194x speedup, val set 0.720x speedup, step: 65
Epoch 65/200 |loss: 10.351717| train set 8.332x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 66
Epoch 66/200 |loss: 9.830496| train set 8.325x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 67
Epoch 67/200 |loss: 9.575408| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 68
Epoch 68/200 |loss: 7.708982| train set 8.184x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 69
Epoch 69/200 |loss: 10.758126| train set 8.183x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 70
Epoch 70/200 |loss: 10.632680| train set 8.116x speedup, test set 1.108x speedup, val set 0.720x speedup, step: 71
Epoch 71/200 |loss: 9.163943| train set 8.340x speedup, test set 1.194x speedup, val set 0.720x speedup, step: 72
Epoch 72/200 |loss: 9.816866| train set 8.340x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 73
Epoch 73/200 |loss: 9.294964| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 74
Epoch 74/200 |loss: 8.514453| train set 8.138x speedup, test set 0.757x speedup, val set 0.781x speedup, step: 75
Epoch 75/200 |loss: 11.532287| train set 7.819x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 76
Epoch 76/200 |loss: 10.298342| train set 7.747x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 77
Epoch 77/200 |loss: 10.716479| train set 8.185x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 78
Epoch 78/200 |loss: 9.413722| train set 8.340x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 79
Epoch 79/200 |loss: 10.013887| train set 8.340x speedup, test set 0.750x speedup, val set 1.013x speedup, step: 80
Epoch 80/200 |loss: 9.663201| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 81
Epoch 81/200 |loss: 7.468213| train set 8.339x speedup, test set 1.194x speedup, val set 1.013x speedup, step: 82
Epoch 82/200 |loss: 9.467052| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 83
Epoch 83/200 |loss: 9.482697| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 84
Epoch 84/200 |loss: 8.002887| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 85
Epoch 85/200 |loss: 9.880632| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 86
Epoch 86/200 |loss: 8.383250| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 87
Epoch 87/200 |loss: 10.225874| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 88
Epoch 88/200 |loss: 9.987666| train set 8.339x speedup, test set 0.714x speedup, val set 1.013x speedup, step: 89
Epoch 89/200 |loss: 9.170980| train set 8.185x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 90
Epoch 90/200 |loss: 9.663719| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 91
Epoch 91/200 |loss: 8.382192| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 92
Epoch 92/200 |loss: 9.207625| train set 8.340x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 93
Epoch 93/200 |loss: 9.002137| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 94
Epoch 94/200 |loss: 8.421469| train set 8.339x speedup, test set 1.194x speedup, val set 1.013x speedup, step: 95
Epoch 95/200 |loss: 9.899368| train set 8.185x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 96
Epoch 96/200 |loss: 9.344409| train set 8.340x speedup, test set 0.838x speedup, val set 0.720x speedup, step: 97
Epoch 97/200 |loss: 8.651898| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 98
Epoch 98/200 |loss: 8.457667| train set 8.185x speedup, test set 1.108x speedup, val set 0.714x speedup, step: 99
Epoch 99/200 |loss: 9.516955| train set 8.185x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 100
Epoch 100/200 |loss: 8.522501| train set 8.340x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 1
Epoch 101/200 |loss: 10.344238| train set 8.340x speedup, test set 1.317x speedup, val set 0.720x speedup, step: 1
Epoch 102/200 |loss: 8.644089| train set 8.165x speedup, test set 0.758x speedup, val set 1.013x speedup, step: 1
Epoch 103/200 |loss: 8.603703| train set 8.185x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 2
Epoch 104/200 |loss: 8.972872| train set 7.747x speedup, test set 1.298x speedup, val set 0.824x speedup, step: 3
Epoch 105/200 |loss: 10.458517| train set 8.185x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 4
Epoch 106/200 |loss: 9.581508| train set 8.093x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 5
Epoch 107/200 |loss: 9.604918| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 6
Epoch 108/200 |loss: 9.318778| train set 8.339x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 7
Epoch 109/200 |loss: 8.622276| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 8
Epoch 110/200 |loss: 9.981636| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 9
Epoch 111/200 |loss: 10.271167| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 10
Epoch 112/200 |loss: 7.840315| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 11
Epoch 113/200 |loss: 9.601744| train set 8.339x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 12
Epoch 114/200 |loss: 8.454207| train set 8.339x speedup, test set 0.754x speedup, val set 0.824x speedup, step: 13
Epoch 115/200 |loss: 8.712689| train set 8.339x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 14
Epoch 116/200 |loss: 8.167592| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 15
Epoch 117/200 |loss: 9.523337| train set 8.339x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 16
Epoch 118/200 |loss: 9.300809| train set 8.340x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 17
Epoch 119/200 |loss: 9.375280| train set 8.340x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 18
Epoch 120/200 |loss: 8.044021| train set 8.185x speedup, test set 0.714x speedup, val set 0.720x speedup, step: 19
Epoch 121/200 |loss: 8.571498| train set 8.185x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 20
Epoch 122/200 |loss: 8.066453| train set 8.184x speedup, test set 1.299x speedup, val set 0.824x speedup, step: 21
Epoch 123/200 |loss: 8.731943| train set 8.183x speedup, test set 1.108x speedup, val set 0.824x speedup, step: 22
Epoch 124/200 |loss: 8.163805| train set 8.338x speedup, test set 0.686x speedup, val set 0.824x speedup, step: 23
Epoch 125/200 |loss: 7.092654| train set 8.338x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 24
Epoch 126/200 |loss: 8.253342| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 25
Epoch 127/200 |loss: 8.973634| train set 8.338x speedup, test set 1.299x speedup, val set 0.824x speedup, step: 26
Epoch 128/200 |loss: 8.077296| train set 8.338x speedup, test set 1.143x speedup, val set 0.824x speedup, step: 27
Epoch 129/200 |loss: 7.765940| train set 8.340x speedup, test set 1.143x speedup, val set 0.816x speedup, step: 28
Epoch 130/200 |loss: 8.998363| train set 8.340x speedup, test set 1.478x speedup, val set 0.824x speedup, step: 29
Epoch 131/200 |loss: 8.886107| train set 8.340x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 30
Epoch 132/200 |loss: 9.251963| train set 8.185x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 31
Epoch 133/200 |loss: 7.924416| train set 8.185x speedup, test set 0.722x speedup, val set 0.720x speedup, step: 32
Epoch 134/200 |loss: 9.307717| train set 8.185x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 33
Epoch 135/200 |loss: 8.921615| train set 8.184x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 34
Epoch 136/200 |loss: 7.620903| train set 8.184x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 35
Epoch 137/200 |loss: 8.703556| train set 8.184x speedup, test set 1.143x speedup, val set 0.824x speedup, step: 36
Epoch 138/200 |loss: 8.918360| train set 8.184x speedup, test set 1.143x speedup, val set 0.824x speedup, step: 37
Epoch 139/200 |loss: 9.082571| train set 8.184x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 38
Epoch 140/200 |loss: 9.357183| train set 8.339x speedup, test set 0.686x speedup, val set 0.824x speedup, step: 39
Epoch 141/200 |loss: 11.147666| train set 8.339x speedup, test set 0.952x speedup, val set 0.720x speedup, step: 40
Epoch 142/200 |loss: 7.409528| train set 8.339x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 41
Epoch 143/200 |loss: 9.368324| train set 8.339x speedup, test set 1.298x speedup, val set 0.720x speedup, step: 42
Epoch 144/200 |loss: 9.036681| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 43
Epoch 145/200 |loss: 8.942724| train set 8.339x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 44
Epoch 146/200 |loss: 9.441819| train set 8.332x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 45
Epoch 147/200 |loss: 8.655392| train set 8.339x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 46
Epoch 148/200 |loss: 8.680414| train set 8.339x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 47
Epoch 149/200 |loss: 10.211124| train set 7.746x speedup, test set 1.299x speedup, val set 0.824x speedup, step: 48
Epoch 150/200 |loss: 8.386078| train set 8.184x speedup, test set 1.143x speedup, val set 0.824x speedup, step: 49
Epoch 151/200 |loss: 9.079303| train set 8.183x speedup, test set 0.952x speedup, val set 0.824x speedup, step: 50
Epoch 152/200 |loss: 9.013972| train set 8.337x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 51
Epoch 153/200 |loss: 7.837923| train set 8.337x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 52
Epoch 154/200 |loss: 10.143825| train set 8.183x speedup, test set 0.686x speedup, val set 0.824x speedup, step: 53
Epoch 155/200 |loss: 9.022468| train set 8.185x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 54
Epoch 156/200 |loss: 10.018398| train set 8.185x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 55
Epoch 157/200 |loss: 8.980529| train set 7.856x speedup, test set 1.108x speedup, val set 0.816x speedup, step: 56
Epoch 158/200 |loss: 8.310060| train set 8.339x speedup, test set 0.693x speedup, val set 0.816x speedup, step: 57
Epoch 159/200 |loss: 9.256153| train set 8.339x speedup, test set 0.738x speedup, val set 0.816x speedup, step: 58
Epoch 160/200 |loss: 9.207414| train set 8.339x speedup, test set 0.693x speedup, val set 0.816x speedup, step: 59
Epoch 161/200 |loss: 8.031591| train set 8.339x speedup, test set 0.680x speedup, val set 1.013x speedup, step: 60
Epoch 162/200 |loss: 8.940701| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 61
Epoch 163/200 |loss: 7.917652| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 62
Epoch 164/200 |loss: 7.294909| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 165/200 |loss: 7.139043| train set 8.339x speedup, test set 1.143x speedup, val set 0.720x speedup, step: 2
Epoch 166/200 |loss: 8.148266| train set 8.339x speedup, test set 1.143x speedup, val set 0.714x speedup, step: 3
Epoch 167/200 |loss: 8.317111| train set 8.339x speedup, test set 1.143x speedup, val set 0.824x speedup, step: 4
Epoch 168/200 |loss: 7.342074| train set 8.339x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 169/200 |loss: 8.474627| train set 8.185x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2
Epoch 170/200 |loss: 8.971431| train set 8.338x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 3
Epoch 171/200 |loss: 8.514550| train set 8.338x speedup, test set 1.214x speedup, val set 0.824x speedup, step: 4
Epoch 172/200 |loss: 9.207798| train set 8.328x speedup, test set 1.143x speedup, val set 0.824x speedup, step: 5
Epoch 173/200 |loss: 9.195722| train set 8.339x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 6
Epoch 174/200 |loss: 8.599274| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 7
Epoch 175/200 |loss: 8.246183| train set 8.339x speedup, test set 0.686x speedup, val set 0.753x speedup, step: 8
Epoch 176/200 |loss: 8.098563| train set 8.339x speedup, test set 0.686x speedup, val set 1.013x speedup, step: 1
Epoch 177/200 |loss: 8.836676| train set 8.339x speedup, test set 0.686x speedup, val set 0.824x speedup, step: 2
Epoch 178/200 |loss: 8.433880| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 3
Epoch 179/200 |loss: 8.403386| train set 8.339x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 4
Epoch 180/200 |loss: 8.451954| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 5
Epoch 181/200 |loss: 8.802685| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 6
Epoch 182/200 |loss: 8.624284| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 7
Epoch 183/200 |loss: 9.078764| train set 8.184x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 8
Epoch 184/200 |loss: 8.099189| train set 8.185x speedup, test set 0.754x speedup, val set 0.824x speedup, step: 9
Epoch 185/200 |loss: 6.548922| train set 7.682x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 10
Epoch 186/200 |loss: 9.339861| train set 7.817x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 11
Epoch 187/200 |loss: 8.034982| train set 8.338x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 12
Epoch 188/200 |loss: 8.821862| train set 8.340x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 1
Epoch 189/200 |loss: 8.634950| train set 8.185x speedup, test set 0.766x speedup, val set 0.824x speedup, step: 2
Epoch 190/200 |loss: 9.303501| train set 8.339x speedup, test set 1.214x speedup, val set 0.824x speedup, step: 3
Epoch 191/200 |loss: 8.929900| train set 8.339x speedup, test set 1.214x speedup, val set 0.824x speedup, step: 4
Epoch 192/200 |loss: 8.380718| train set 8.339x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 5
Epoch 193/200 |loss: 8.183591| train set 8.339x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 6
Epoch 194/200 |loss: 8.007122| train set 8.338x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 7
Epoch 195/200 |loss: 8.660017| train set 8.338x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 8
Epoch 196/200 |loss: 8.867113| train set 8.338x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 1
Epoch 197/200 |loss: 8.203869| train set 8.337x speedup, test set 1.125x speedup, val set 1.013x speedup, step: 1
Epoch 198/200 |loss: 7.635743| train set 8.337x speedup, test set 1.214x speedup, val set 0.720x speedup, step: 2
Epoch 199/200 |loss: 9.101511| train set 8.333x speedup, test set 1.143x speedup, val set 1.013x speedup, step: 3
Training per epoch cost 0.982 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
25, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
26, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
27, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
28, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
29, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
30, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 43, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 48, train speedup 8.340, test speedup 1.568, val speedup 0.720
best validation speedup epoch: 197, train speedup 8.337, test speedup 1.125, val speedup 1.013
last model at epoch 199, train speedup 8.333, test speedup 1.143, val speedup 1.013
execution cost 0:08:10.476471
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.336484, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281973| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793528| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089632| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913026| train set 3.193x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588147| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.558288| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.379584| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.760285| train set 4.032x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.461717| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.913137| train set 4.630x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 13.903441| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.083240| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.477352| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.484348| train set 4.670x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.242601| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 19
Epoch 19/200 |loss: 10.133694| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.259793| train set 4.631x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.465037| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.046767| train set 4.673x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 23
Epoch 23/200 |loss: 10.544438| train set 5.007x speedup, test set 5.125x speedup, val set 0.994x speedup, step: 24
Epoch 24/200 |loss: 11.712555| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.269449| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.444521| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 11.704120| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 28
Epoch 28/200 |loss: 10.316944| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 9.664214| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 30
Epoch 30/200 |loss: 10.447455| train set 4.958x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 31
Epoch 31/200 |loss: 10.398745| train set 5.008x speedup, test set 1.460x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.280931| train set 4.412x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 33
Epoch 33/200 |loss: 9.834674| train set 4.448x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.343896| train set 4.894x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 12.257557| train set 5.007x speedup, test set 4.387x speedup, val set 0.994x speedup, step: 36
Epoch 36/200 |loss: 12.382306| train set 4.958x speedup, test set 6.681x speedup, val set 1.041x speedup, step: 37
Epoch 37/200 |loss: 10.534528| train set 5.008x speedup, test set 1.476x speedup, val set 0.855x speedup, step: 38
Epoch 38/200 |loss: 9.680966| train set 5.008x speedup, test set 4.387x speedup, val set 0.994x speedup, step: 39
Epoch 39/200 |loss: 10.288949| train set 5.008x speedup, test set 6.681x speedup, val set 1.041x speedup, step: 40
Epoch 40/200 |loss: 9.823035| train set 5.008x speedup, test set 6.681x speedup, val set 1.041x speedup, step: 41
Epoch 41/200 |loss: 10.486414| train set 5.008x speedup, test set 4.387x speedup, val set 1.241x speedup, step: 42
Epoch 42/200 |loss: 11.480008| train set 4.873x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 11.094427| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.501808| train set 4.988x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.680549| train set 4.675x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 46
Epoch 46/200 |loss: 10.085176| train set 4.451x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 10.425402| train set 4.753x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.377842| train set 4.920x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 10.203648| train set 5.007x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.344512| train set 4.958x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 10.120096| train set 4.958x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.934184| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 9.010358| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.889034| train set 4.715x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.554756| train set 5.008x speedup, test set 4.387x speedup, val set 0.957x speedup, step: 56
Epoch 56/200 |loss: 8.979006| train set 4.921x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.350288| train set 5.008x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 58
Epoch 58/200 |loss: 9.208804| train set 5.008x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 59
Epoch 59/200 |loss: 8.498662| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 60
Epoch 60/200 |loss: 9.124286| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.582815| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 62
Epoch 62/200 |loss: 7.954047| train set 4.869x speedup, test set 1.476x speedup, val set 0.742x speedup, step: 63
Epoch 63/200 |loss: 8.776222| train set 4.958x speedup, test set 5.161x speedup, val set 0.957x speedup, step: 64
Epoch 64/200 |loss: 8.237225| train set 4.918x speedup, test set 4.387x speedup, val set 0.957x speedup, step: 65
Epoch 65/200 |loss: 8.927029| train set 4.921x speedup, test set 6.681x speedup, val set 0.957x speedup, step: 66
Epoch 66/200 |loss: 9.924605| train set 5.008x speedup, test set 6.681x speedup, val set 1.133x speedup, step: 67
Epoch 67/200 |loss: 7.494729| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.022964| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.056357| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.423208| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.264747| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 7.773590| train set 5.007x speedup, test set 6.681x speedup, val set 1.133x speedup, step: 73
Epoch 73/200 |loss: 8.881923| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.087658| train set 4.957x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.841973| train set 4.957x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.086942| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 77
Epoch 77/200 |loss: 8.271939| train set 5.007x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 78
Epoch 78/200 |loss: 9.093263| train set 5.007x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.798074| train set 4.918x speedup, test set 4.387x speedup, val set 0.980x speedup, step: 80
Epoch 80/200 |loss: 7.513086| train set 4.921x speedup, test set 5.161x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 9.988524| train set 5.008x speedup, test set 5.161x speedup, val set 0.980x speedup, step: 82
Epoch 82/200 |loss: 9.162164| train set 5.008x speedup, test set 4.387x speedup, val set 0.813x speedup, step: 83
Epoch 83/200 |loss: 8.522486| train set 5.008x speedup, test set 6.214x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 8.979145| train set 5.008x speedup, test set 6.681x speedup, val set 1.211x speedup, step: 85
Epoch 85/200 |loss: 8.027937| train set 4.921x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 86
Epoch 86/200 |loss: 8.766868| train set 5.008x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 87
Epoch 87/200 |loss: 9.540255| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.470435| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 89
Epoch 89/200 |loss: 8.101029| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 90
Epoch 90/200 |loss: 8.696474| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 91
Epoch 91/200 |loss: 8.543997| train set 5.008x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 92
Epoch 92/200 |loss: 8.366694| train set 5.008x speedup, test set 6.681x speedup, val set 1.211x speedup, step: 93
Epoch 93/200 |loss: 9.185999| train set 5.008x speedup, test set 6.681x speedup, val set 0.798x speedup, step: 94
Epoch 94/200 |loss: 8.406950| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 95
Epoch 95/200 |loss: 9.060201| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 9.150323| train set 4.958x speedup, test set 4.499x speedup, val set 0.742x speedup, step: 97
Epoch 97/200 |loss: 9.007315| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.722383| train set 5.008x speedup, test set 6.681x speedup, val set 0.798x speedup, step: 99
Epoch 99/200 |loss: 9.616918| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 100
Epoch 100/200 |loss: 9.182403| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 1
Epoch 101/200 |loss: 9.950667| train set 4.671x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 2
Epoch 102/200 |loss: 9.058675| train set 4.958x speedup, test set 5.161x speedup, val set 1.149x speedup, step: 1
Epoch 103/200 |loss: 9.316547| train set 4.917x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.711681| train set 4.920x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 3
Epoch 105/200 |loss: 7.396692| train set 5.007x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 4
Epoch 106/200 |loss: 8.417700| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 5
Epoch 107/200 |loss: 8.689212| train set 5.007x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 6
Epoch 108/200 |loss: 8.477462| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 7
Epoch 109/200 |loss: 9.455130| train set 4.671x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 110/200 |loss: 7.816646| train set 4.958x speedup, test set 6.681x speedup, val set 1.133x speedup, step: 2
Epoch 111/200 |loss: 8.943528| train set 4.954x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 3
Epoch 112/200 |loss: 9.103596| train set 5.005x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 4
Epoch 113/200 |loss: 8.852121| train set 5.008x speedup, test set 6.681x speedup, val set 0.934x speedup, step: 5
Epoch 114/200 |loss: 9.571317| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 115/200 |loss: 8.022338| train set 5.008x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 2
Epoch 116/200 |loss: 7.965361| train set 5.008x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 3
Epoch 117/200 |loss: 9.953703| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 4
Epoch 118/200 |loss: 9.035248| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 5
Epoch 119/200 |loss: 9.052090| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 6
Epoch 120/200 |loss: 9.824199| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 7
Epoch 121/200 |loss: 8.584955| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 122/200 |loss: 8.741158| train set 4.958x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 123/200 |loss: 7.016353| train set 4.954x speedup, test set 4.387x speedup, val set 0.836x speedup, step: 2
Epoch 124/200 |loss: 9.482574| train set 4.918x speedup, test set 6.681x speedup, val set 0.836x speedup, step: 3
Epoch 125/200 |loss: 9.354125| train set 4.920x speedup, test set 6.681x speedup, val set 1.211x speedup, step: 4
Epoch 126/200 |loss: 10.451963| train set 5.007x speedup, test set 6.681x speedup, val set 0.934x speedup, step: 5
Epoch 127/200 |loss: 8.728837| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 6
Epoch 128/200 |loss: 9.423557| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 7
Epoch 129/200 |loss: 8.482075| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 8
Epoch 130/200 |loss: 9.387274| train set 4.958x speedup, test set 4.387x speedup, val set 0.798x speedup, step: 9
Epoch 131/200 |loss: 8.870693| train set 4.958x speedup, test set 6.681x speedup, val set 1.133x speedup, step: 10
Epoch 132/200 |loss: 9.163485| train set 4.954x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 11
Epoch 133/200 |loss: 7.756628| train set 4.709x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 134/200 |loss: 6.819095| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 135/200 |loss: 8.649867| train set 5.008x speedup, test set 4.387x speedup, val set 0.934x speedup, step: 2
Epoch 136/200 |loss: 7.509738| train set 5.008x speedup, test set 6.681x speedup, val set 0.786x speedup, step: 3
Epoch 137/200 |loss: 8.691376| train set 5.008x speedup, test set 6.681x speedup, val set 0.770x speedup, step: 4
Epoch 138/200 |loss: 9.747686| train set 5.008x speedup, test set 6.681x speedup, val set 0.806x speedup, step: 5
Epoch 139/200 |loss: 9.040467| train set 4.671x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 140/200 |loss: 8.263745| train set 4.958x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 141/200 |loss: 8.486979| train set 4.958x speedup, test set 6.495x speedup, val set 1.302x speedup, step: 2
Epoch 142/200 |loss: 9.003183| train set 4.921x speedup, test set 6.681x speedup, val set 0.990x speedup, step: 3
Epoch 143/200 |loss: 9.583609| train set 4.873x speedup, test set 4.387x speedup, val set 1.211x speedup, step: 4
Epoch 144/200 |loss: 9.108129| train set 4.957x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 5
Epoch 145/200 |loss: 10.153240| train set 5.007x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 6
Epoch 146/200 |loss: 9.391396| train set 4.920x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 7
Epoch 147/200 |loss: 10.088762| train set 4.957x speedup, test set 4.387x speedup, val set 1.316x speedup, step: 1
Epoch 148/200 |loss: 8.638525| train set 5.007x speedup, test set 4.387x speedup, val set 1.316x speedup, step: 1
Epoch 149/200 |loss: 8.916770| train set 5.007x speedup, test set 4.387x speedup, val set 1.316x speedup, step: 1
Epoch 150/200 |loss: 9.696511| train set 4.916x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 2
Epoch 151/200 |loss: 9.209628| train set 5.003x speedup, test set 4.387x speedup, val set 0.739x speedup, step: 3
Epoch 152/200 |loss: 7.814138| train set 5.008x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 4
Epoch 153/200 |loss: 9.812266| train set 5.008x speedup, test set 6.681x speedup, val set 0.798x speedup, step: 5
Epoch 154/200 |loss: 9.029380| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 6
Epoch 155/200 |loss: 9.151844| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 7
Epoch 156/200 |loss: 8.789113| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 8
Epoch 157/200 |loss: 9.148316| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 9
Epoch 158/200 |loss: 10.517312| train set 4.921x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 10
Epoch 159/200 |loss: 7.617763| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 11
Epoch 160/200 |loss: 7.820532| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 12
Epoch 161/200 |loss: 9.178034| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 13
Epoch 162/200 |loss: 8.063109| train set 5.008x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 14
Epoch 163/200 |loss: 7.939258| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 15
Epoch 164/200 |loss: 8.720948| train set 5.008x speedup, test set 6.681x speedup, val set 0.733x speedup, step: 16
Epoch 165/200 |loss: 7.984631| train set 5.008x speedup, test set 6.681x speedup, val set 0.803x speedup, step: 17
Epoch 166/200 |loss: 9.099152| train set 5.007x speedup, test set 6.681x speedup, val set 1.149x speedup, step: 18
Epoch 167/200 |loss: 9.678135| train set 5.007x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 168/200 |loss: 8.780691| train set 4.957x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 169/200 |loss: 8.390514| train set 4.873x speedup, test set 6.681x speedup, val set 1.222x speedup, step: 2
Epoch 170/200 |loss: 8.619416| train set 4.873x speedup, test set 6.681x speedup, val set 0.739x speedup, step: 3
Epoch 171/200 |loss: 9.351803| train set 4.873x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 4
Epoch 172/200 |loss: 9.777397| train set 4.958x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 5
Epoch 173/200 |loss: 8.187569| train set 4.958x speedup, test set 6.681x speedup, val set 0.733x speedup, step: 6
Epoch 174/200 |loss: 8.879213| train set 5.007x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 7
Epoch 175/200 |loss: 9.914742| train set 4.917x speedup, test set 6.681x speedup, val set 0.786x speedup, step: 8
Epoch 176/200 |loss: 8.900402| train set 5.007x speedup, test set 6.681x speedup, val set 0.777x speedup, step: 9
Epoch 177/200 |loss: 8.268785| train set 4.957x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 10
Epoch 178/200 |loss: 9.046457| train set 4.957x speedup, test set 6.681x speedup, val set 1.133x speedup, step: 11
Epoch 179/200 |loss: 8.454970| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 12
Epoch 180/200 |loss: 8.884468| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 13
Epoch 181/200 |loss: 8.367429| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 14
Epoch 182/200 |loss: 9.223193| train set 4.958x speedup, test set 6.681x speedup, val set 0.733x speedup, step: 15
Epoch 183/200 |loss: 8.321659| train set 4.958x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 16
Epoch 184/200 |loss: 7.520695| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 17
Epoch 185/200 |loss: 8.434714| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 18
Epoch 186/200 |loss: 8.921524| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 19
Epoch 187/200 |loss: 8.317093| train set 5.007x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 188/200 |loss: 8.404996| train set 5.007x speedup, test set 6.681x speedup, val set 1.211x speedup, step: 2
Epoch 189/200 |loss: 8.670915| train set 4.920x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 3
Epoch 190/200 |loss: 8.751284| train set 5.007x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 4
Epoch 191/200 |loss: 7.841243| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 5
Epoch 192/200 |loss: 9.892190| train set 4.921x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 6
Epoch 193/200 |loss: 9.194124| train set 4.921x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 7
Epoch 194/200 |loss: 9.765825| train set 4.921x speedup, test set 6.681x speedup, val set 0.813x speedup, step: 8
Epoch 195/200 |loss: 7.561188| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 9
Epoch 196/200 |loss: 8.497298| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 10
Epoch 197/200 |loss: 8.829283| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 11
Epoch 198/200 |loss: 9.200516| train set 4.954x speedup, test set 4.387x speedup, val set 0.804x speedup, step: 12
Epoch 199/200 |loss: 7.573660| train set 5.004x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 13
Training per epoch cost 0.309 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 18.392s, pg runtime 18.392s, speedup 1.000x
02, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
03, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
04, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
05, opt runtime 14.857s, model runtime 14.857s, pg runtime 14.857s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 15.831s, model runtime 15.831s, pg runtime 15.831s, speedup 1.000x
08, opt runtime 9.432s, model runtime 9.432s, pg runtime 9.432s, speedup 1.000x
09, opt runtime 26.874s, model runtime 26.874s, pg runtime 26.874s, speedup 1.000x
10, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 24, train speedup 5.008, test speedup 5.125, val speedup 0.729
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 187, train speedup 5.007, test speedup 6.681, val speedup 1.316
last model at epoch 199, train speedup 5.004, test speedup 6.681, val speedup 0.804
execution cost 0:02:28.875515
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.307611, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281973| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793528| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089630| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913025| train set 3.193x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588146| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.558285| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.379580| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.760283| train set 4.032x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.461714| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.913136| train set 4.630x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 13.903444| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.083203| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.477286| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.484350| train set 4.670x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.240041| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 19
Epoch 19/200 |loss: 10.136597| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.243860| train set 4.631x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.430186| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.089963| train set 4.673x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 23
Epoch 23/200 |loss: 10.393754| train set 5.007x speedup, test set 5.125x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 11.700753| train set 5.008x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.354019| train set 5.008x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.164346| train set 4.674x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 12.053506| train set 5.008x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 28
Epoch 28/200 |loss: 10.378027| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 9.808407| train set 4.865x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 30
Epoch 30/200 |loss: 10.411368| train set 4.958x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 31
Epoch 31/200 |loss: 10.526973| train set 4.957x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.099097| train set 4.448x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 9.819877| train set 4.670x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 10.768196| train set 4.894x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 12.290885| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 11.503193| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.913090| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 38
Epoch 38/200 |loss: 9.301075| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 9.800719| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 40
Epoch 40/200 |loss: 9.242388| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 9.910786| train set 4.921x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 9.900997| train set 4.873x speedup, test set 8.028x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.611910| train set 4.958x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.217658| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.370553| train set 5.007x speedup, test set 5.125x speedup, val set 1.006x speedup, step: 46
Epoch 46/200 |loss: 10.457260| train set 4.753x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 47
Epoch 47/200 |loss: 9.984484| train set 4.452x speedup, test set 4.387x speedup, val set 1.253x speedup, step: 48
Epoch 48/200 |loss: 9.610246| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 9.472695| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.392857| train set 5.008x speedup, test set 5.125x speedup, val set 1.268x speedup, step: 51
Epoch 51/200 |loss: 9.793960| train set 5.008x speedup, test set 4.387x speedup, val set 1.124x speedup, step: 52
Epoch 52/200 |loss: 10.482727| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 9.313024| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 9.097463| train set 4.715x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.969027| train set 4.958x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 9.111345| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.501792| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.575194| train set 5.007x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.512971| train set 5.008x speedup, test set 5.125x speedup, val set 0.934x speedup, step: 60
Epoch 60/200 |loss: 9.382181| train set 4.958x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.152802| train set 4.958x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 62
Epoch 62/200 |loss: 7.901274| train set 4.873x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 63
Epoch 63/200 |loss: 8.828611| train set 4.872x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.333467| train set 4.920x speedup, test set 4.387x speedup, val set 1.268x speedup, step: 65
Epoch 65/200 |loss: 8.914534| train set 5.007x speedup, test set 4.387x speedup, val set 1.228x speedup, step: 66
Epoch 66/200 |loss: 9.928896| train set 5.004x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 67
Epoch 67/200 |loss: 7.577183| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 68
Epoch 68/200 |loss: 9.159814| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.254724| train set 5.008x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.393042| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.312932| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 7.919562| train set 5.007x speedup, test set 5.125x speedup, val set 0.882x speedup, step: 73
Epoch 73/200 |loss: 9.015235| train set 5.007x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.344908| train set 4.958x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.818839| train set 4.958x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 76
Epoch 76/200 |loss: 7.324315| train set 4.921x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.683297| train set 4.835x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 78
Epoch 78/200 |loss: 9.492637| train set 4.879x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 79
Epoch 79/200 |loss: 9.038374| train set 4.917x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 80
Epoch 80/200 |loss: 7.887735| train set 5.008x speedup, test set 5.161x speedup, val set 1.211x speedup, step: 81
Epoch 81/200 |loss: 10.593621| train set 5.008x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 9.276327| train set 5.004x speedup, test set 4.387x speedup, val set 0.804x speedup, step: 83
Epoch 83/200 |loss: 8.875584| train set 5.008x speedup, test set 5.161x speedup, val set 1.133x speedup, step: 84
Epoch 84/200 |loss: 9.348630| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.408749| train set 4.921x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.986643| train set 4.674x speedup, test set 5.161x speedup, val set 0.762x speedup, step: 87
Epoch 87/200 |loss: 9.794874| train set 4.671x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 8.001441| train set 4.958x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 89
Epoch 89/200 |loss: 8.327624| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 90
Epoch 90/200 |loss: 8.724740| train set 5.008x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 91
Epoch 91/200 |loss: 8.585495| train set 5.008x speedup, test set 5.161x speedup, val set 0.957x speedup, step: 92
Epoch 92/200 |loss: 8.759453| train set 5.008x speedup, test set 6.681x speedup, val set 0.994x speedup, step: 93
Epoch 93/200 |loss: 9.066252| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 94
Epoch 94/200 |loss: 8.746234| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 95
Epoch 95/200 |loss: 9.004372| train set 4.958x speedup, test set 4.932x speedup, val set 0.729x speedup, step: 96
Epoch 96/200 |loss: 9.501294| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 97
Epoch 97/200 |loss: 9.122118| train set 5.008x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.718319| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 99
Epoch 99/200 |loss: 9.596187| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 100
Epoch 100/200 |loss: 8.896535| train set 5.008x speedup, test set 5.161x speedup, val set 0.742x speedup, step: 1
Epoch 101/200 |loss: 10.039742| train set 4.715x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 2
Epoch 102/200 |loss: 8.979097| train set 4.991x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 3
Epoch 103/200 |loss: 9.875221| train set 5.003x speedup, test set 5.049x speedup, val set 0.735x speedup, step: 4
Epoch 104/200 |loss: 8.728557| train set 4.916x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 1
Epoch 105/200 |loss: 8.027491| train set 4.920x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 2
Epoch 106/200 |loss: 8.761710| train set 5.007x speedup, test set 6.214x speedup, val set 0.729x speedup, step: 3
Epoch 107/200 |loss: 9.177471| train set 5.007x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 4
Epoch 108/200 |loss: 8.295548| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 5
Epoch 109/200 |loss: 9.215250| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 6
Epoch 110/200 |loss: 7.542111| train set 4.958x speedup, test set 8.560x speedup, val set 0.762x speedup, step: 1
Epoch 111/200 |loss: 8.649193| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 2
Epoch 112/200 |loss: 8.864822| train set 5.004x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 3
Epoch 113/200 |loss: 8.785904| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 4
Epoch 114/200 |loss: 9.279650| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 5
Epoch 115/200 |loss: 7.873073| train set 5.008x speedup, test set 4.387x speedup, val set 0.798x speedup, step: 1
Epoch 116/200 |loss: 7.854507| train set 4.921x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 2
Epoch 117/200 |loss: 9.812817| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 3
Epoch 118/200 |loss: 8.988889| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 4
Epoch 119/200 |loss: 8.794260| train set 5.008x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 5
Epoch 120/200 |loss: 9.708600| train set 4.914x speedup, test set 5.360x speedup, val set 0.735x speedup, step: 6
Epoch 121/200 |loss: 8.697694| train set 4.921x speedup, test set 4.335x speedup, val set 0.729x speedup, step: 7
Epoch 122/200 |loss: 8.673664| train set 4.958x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 8
Epoch 123/200 |loss: 7.004985| train set 4.958x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 9
Epoch 124/200 |loss: 9.132297| train set 4.917x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 10
Epoch 125/200 |loss: 9.315918| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 11
Epoch 126/200 |loss: 10.082786| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 12
Epoch 127/200 |loss: 8.696018| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 13
Epoch 128/200 |loss: 9.049736| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 14
Epoch 129/200 |loss: 8.312608| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 15
Epoch 130/200 |loss: 9.253430| train set 4.958x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 16
Epoch 131/200 |loss: 8.819746| train set 4.958x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 17
Epoch 132/200 |loss: 9.163380| train set 4.958x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 18
Epoch 133/200 |loss: 7.589553| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 19
Epoch 134/200 |loss: 6.905887| train set 4.715x speedup, test set 4.387x speedup, val set 0.733x speedup, step: 20
Epoch 135/200 |loss: 8.411588| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 21
Epoch 136/200 |loss: 7.642986| train set 5.004x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 22
Epoch 137/200 |loss: 8.759619| train set 5.004x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 23
Epoch 138/200 |loss: 9.332401| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 24
Epoch 139/200 |loss: 9.004747| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 25
Epoch 140/200 |loss: 8.098644| train set 4.958x speedup, test set 6.681x speedup, val set 0.934x speedup, step: 1
Epoch 141/200 |loss: 8.465818| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 2
Epoch 142/200 |loss: 8.780322| train set 4.921x speedup, test set 4.963x speedup, val set 0.742x speedup, step: 3
Epoch 143/200 |loss: 9.441129| train set 4.999x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 4
Epoch 144/200 |loss: 8.862862| train set 4.957x speedup, test set 5.161x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.854269| train set 4.957x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 2
Epoch 146/200 |loss: 9.407472| train set 4.920x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 3
Epoch 147/200 |loss: 9.751177| train set 4.872x speedup, test set 4.850x speedup, val set 0.729x speedup, step: 4
Epoch 148/200 |loss: 8.604392| train set 4.957x speedup, test set 5.161x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 9.057021| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 2
Epoch 150/200 |loss: 9.710766| train set 4.920x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 3
Epoch 151/200 |loss: 8.994621| train set 4.921x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 4
Epoch 152/200 |loss: 7.844336| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 5
Epoch 153/200 |loss: 9.766851| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 6
Epoch 154/200 |loss: 9.080555| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 7
Epoch 155/200 |loss: 9.465322| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 8
Epoch 156/200 |loss: 8.775072| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 9
Epoch 157/200 |loss: 9.149845| train set 4.921x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 10
Epoch 158/200 |loss: 10.417050| train set 4.921x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 11
Epoch 159/200 |loss: 7.668543| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 12
Epoch 160/200 |loss: 7.725443| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 13
Epoch 161/200 |loss: 9.083379| train set 5.005x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 14
Epoch 162/200 |loss: 7.965538| train set 5.008x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 15
Epoch 163/200 |loss: 7.769656| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 16
Epoch 164/200 |loss: 8.755603| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 17
Epoch 165/200 |loss: 7.935755| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 18
Epoch 166/200 |loss: 9.059577| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 19
Epoch 167/200 |loss: 9.413165| train set 4.920x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 20
Epoch 168/200 |loss: 8.754118| train set 4.957x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 21
Epoch 169/200 |loss: 8.203618| train set 4.958x speedup, test set 6.353x speedup, val set 1.133x speedup, step: 22
Epoch 170/200 |loss: 8.691782| train set 4.873x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 23
Epoch 171/200 |loss: 9.361257| train set 4.873x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 24
Epoch 172/200 |loss: 10.071408| train set 4.873x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 25
Epoch 173/200 |loss: 7.995250| train set 4.957x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 26
Epoch 174/200 |loss: 9.007382| train set 5.007x speedup, test set 5.360x speedup, val set 0.735x speedup, step: 27
Epoch 175/200 |loss: 9.852860| train set 4.917x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 28
Epoch 176/200 |loss: 9.164570| train set 4.920x speedup, test set 5.360x speedup, val set 0.786x speedup, step: 29
Epoch 177/200 |loss: 8.394872| train set 4.957x speedup, test set 5.360x speedup, val set 0.735x speedup, step: 30
Epoch 178/200 |loss: 9.119132| train set 4.958x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 31
Epoch 179/200 |loss: 8.501552| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 32
Epoch 180/200 |loss: 9.069761| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 33
Epoch 181/200 |loss: 8.353116| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 34
Epoch 182/200 |loss: 9.274948| train set 4.958x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 35
Epoch 183/200 |loss: 8.293866| train set 4.873x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 36
Epoch 184/200 |loss: 7.417054| train set 4.921x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 37
Epoch 185/200 |loss: 8.446917| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 38
Epoch 186/200 |loss: 8.843290| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 39
Epoch 187/200 |loss: 8.347131| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 40
Epoch 188/200 |loss: 8.184461| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 41
Epoch 189/200 |loss: 8.485417| train set 5.007x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 42
Epoch 190/200 |loss: 8.574178| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 43
Epoch 191/200 |loss: 7.727290| train set 5.008x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 44
Epoch 192/200 |loss: 9.696836| train set 4.921x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 45
Epoch 193/200 |loss: 9.146385| train set 4.921x speedup, test set 5.360x speedup, val set 0.735x speedup, step: 46
Epoch 194/200 |loss: 9.429107| train set 4.919x speedup, test set 5.360x speedup, val set 0.735x speedup, step: 47
Epoch 195/200 |loss: 7.508426| train set 4.921x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 48
Epoch 196/200 |loss: 8.648335| train set 5.008x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 49
Epoch 197/200 |loss: 8.759480| train set 4.954x speedup, test set 4.831x speedup, val set 0.742x speedup, step: 50
Epoch 198/200 |loss: 9.249378| train set 4.954x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 51
Epoch 199/200 |loss: 7.588449| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 52
Training per epoch cost 0.314 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 48.604s, pg runtime 18.392s, speedup 0.378x
02, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
03, opt runtime 17.779s, model runtime 47.365s, pg runtime 17.779s, speedup 0.375x
04, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
05, opt runtime 14.857s, model runtime 47.524s, pg runtime 14.857s, speedup 0.313x
06, opt runtime 19.263s, model runtime 48.427s, pg runtime 19.263s, speedup 0.398x
07, opt runtime 15.831s, model runtime 49.113s, pg runtime 15.831s, speedup 0.322x
08, opt runtime 9.432s, model runtime 48.050s, pg runtime 9.432s, speedup 0.196x
09, opt runtime 26.874s, model runtime 45.968s, pg runtime 26.874s, speedup 0.585x
10, opt runtime 21.143s, model runtime 43.215s, pg runtime 21.143s, speedup 0.489x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 25, train speedup 5.008, test speedup 1.476, val speedup 0.729
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 148, train speedup 4.957, test speedup 5.161, val speedup 1.302
last model at epoch 199, train speedup 4.958, test speedup 6.681, val speedup 0.742
execution cost 0:02:29.381797
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.418624, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281971| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286845| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793523| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912635| train set 3.193x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587204| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575417| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370786| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755565| train set 4.032x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455398| train set 4.285x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921764| train set 4.630x speedup, test set 8.560x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914977| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.109000| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590155| train set 4.630x speedup, test set 1.484x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591467| train set 4.670x speedup, test set 1.607x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213897| train set 5.008x speedup, test set 8.560x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153137| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.501633| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.035391| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.297988| train set 5.008x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.687443| train set 5.007x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.887954| train set 5.007x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.657385| train set 5.007x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.568911| train set 4.958x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.335202| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.346307| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 10.295485| train set 4.921x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.684966| train set 5.008x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.363349| train set 4.958x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 32
Epoch 32/200 |loss: 10.560805| train set 4.708x speedup, test set 8.560x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 10.788621| train set 4.630x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.214935| train set 4.614x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 12.972156| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.538687| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.903881| train set 5.008x speedup, test set 8.028x speedup, val set 1.033x speedup, step: 38
Epoch 38/200 |loss: 10.227152| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 10.677511| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.520684| train set 4.818x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 41
Epoch 41/200 |loss: 11.191077| train set 4.921x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.382977| train set 4.921x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.601675| train set 4.671x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 10.997986| train set 4.958x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.277724| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 46
Epoch 46/200 |loss: 10.591918| train set 4.754x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 10.374144| train set 4.452x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.542479| train set 4.988x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 10.335532| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.503244| train set 4.958x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 51
Epoch 51/200 |loss: 9.993935| train set 4.958x speedup, test set 5.125x speedup, val set 1.053x speedup, step: 52
Epoch 52/200 |loss: 10.758742| train set 4.921x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 53
Epoch 53/200 |loss: 8.944320| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 54
Epoch 54/200 |loss: 8.916411| train set 4.715x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 55
Epoch 55/200 |loss: 9.766581| train set 4.958x speedup, test set 6.214x speedup, val set 1.041x speedup, step: 56
Epoch 56/200 |loss: 8.972417| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 57
Epoch 57/200 |loss: 9.938596| train set 5.008x speedup, test set 5.125x speedup, val set 1.053x speedup, step: 58
Epoch 58/200 |loss: 9.423182| train set 5.008x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.470943| train set 5.008x speedup, test set 5.125x speedup, val set 0.775x speedup, step: 60
Epoch 60/200 |loss: 9.336064| train set 5.008x speedup, test set 5.125x speedup, val set 0.957x speedup, step: 61
Epoch 61/200 |loss: 10.215613| train set 4.958x speedup, test set 5.161x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 7.826259| train set 4.873x speedup, test set 5.161x speedup, val set 0.855x speedup, step: 63
Epoch 63/200 |loss: 8.893052| train set 4.872x speedup, test set 5.161x speedup, val set 0.931x speedup, step: 64
Epoch 64/200 |loss: 8.231278| train set 4.920x speedup, test set 5.161x speedup, val set 1.033x speedup, step: 65
Epoch 65/200 |loss: 9.047125| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 66
Epoch 66/200 |loss: 10.017466| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 67
Epoch 67/200 |loss: 7.438518| train set 5.008x speedup, test set 6.681x speedup, val set 1.006x speedup, step: 68
Epoch 68/200 |loss: 9.189982| train set 5.008x speedup, test set 6.681x speedup, val set 1.073x speedup, step: 69
Epoch 69/200 |loss: 9.088469| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 70
Epoch 70/200 |loss: 8.473634| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.458702| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 7.775718| train set 4.957x speedup, test set 6.681x speedup, val set 1.211x speedup, step: 73
Epoch 73/200 |loss: 8.800344| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.252036| train set 4.957x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.678347| train set 5.007x speedup, test set 5.161x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.156333| train set 5.008x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 77
Epoch 77/200 |loss: 8.431203| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 78
Epoch 78/200 |loss: 9.068809| train set 5.007x speedup, test set 4.387x speedup, val set 0.968x speedup, step: 79
Epoch 79/200 |loss: 8.880090| train set 5.008x speedup, test set 4.387x speedup, val set 1.016x speedup, step: 80
Epoch 80/200 |loss: 7.452347| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.350934| train set 5.008x speedup, test set 6.681x speedup, val set 0.968x speedup, step: 82
Epoch 82/200 |loss: 8.778901| train set 4.883x speedup, test set 4.387x speedup, val set 0.848x speedup, step: 83
Epoch 83/200 |loss: 8.797872| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 9.089288| train set 4.921x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.178005| train set 4.921x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.870441| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 87
Epoch 87/200 |loss: 9.620488| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 7.711694| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 89
Epoch 89/200 |loss: 8.347316| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 90
Epoch 90/200 |loss: 8.492580| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.533127| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.266171| train set 5.008x speedup, test set 6.681x speedup, val set 1.241x speedup, step: 93
Epoch 93/200 |loss: 9.421206| train set 5.008x speedup, test set 6.681x speedup, val set 0.991x speedup, step: 94
Epoch 94/200 |loss: 8.328832| train set 4.977x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 95
Epoch 95/200 |loss: 9.084175| train set 4.958x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 96
Epoch 96/200 |loss: 9.255192| train set 4.958x speedup, test set 6.681x speedup, val set 0.980x speedup, step: 97
Epoch 97/200 |loss: 8.977734| train set 4.958x speedup, test set 4.387x speedup, val set 0.991x speedup, step: 98
Epoch 98/200 |loss: 8.750273| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 99
Epoch 99/200 |loss: 9.599535| train set 5.008x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 100
Epoch 100/200 |loss: 9.130114| train set 5.008x speedup, test set 6.681x speedup, val set 0.901x speedup, step: 1
Epoch 101/200 |loss: 9.933324| train set 4.715x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 102/200 |loss: 8.660010| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 103/200 |loss: 9.290583| train set 5.004x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.600098| train set 4.920x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 3
Epoch 105/200 |loss: 7.450871| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.249870| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 107/200 |loss: 8.731364| train set 5.007x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 2
Epoch 108/200 |loss: 8.267367| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 3
Epoch 109/200 |loss: 9.282879| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 110/200 |loss: 7.449254| train set 5.008x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 2
Epoch 111/200 |loss: 8.973707| train set 5.002x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 3
Epoch 112/200 |loss: 9.492623| train set 4.958x speedup, test set 4.387x speedup, val set 1.228x speedup, step: 4
Epoch 113/200 |loss: 8.806521| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 5
Epoch 114/200 |loss: 9.529356| train set 5.008x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 6
Epoch 115/200 |loss: 8.130387| train set 5.008x speedup, test set 4.387x speedup, val set 1.228x speedup, step: 7
Epoch 116/200 |loss: 8.233586| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 117/200 |loss: 9.967217| train set 5.008x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 2
Epoch 118/200 |loss: 8.913637| train set 5.008x speedup, test set 6.681x speedup, val set 0.955x speedup, step: 3
Epoch 119/200 |loss: 8.937442| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 4
Epoch 120/200 |loss: 9.948666| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 5
Epoch 121/200 |loss: 8.487078| train set 5.008x speedup, test set 4.387x speedup, val set 1.228x speedup, step: 6
Epoch 122/200 |loss: 8.546506| train set 4.958x speedup, test set 5.826x speedup, val set 1.228x speedup, step: 7
Epoch 123/200 |loss: 7.042755| train set 4.958x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 8
Epoch 124/200 |loss: 8.994633| train set 4.920x speedup, test set 6.681x speedup, val set 0.868x speedup, step: 9
Epoch 125/200 |loss: 9.528955| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 10
Epoch 126/200 |loss: 10.306061| train set 5.007x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 11
Epoch 127/200 |loss: 8.764229| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 12
Epoch 128/200 |loss: 9.576124| train set 5.008x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 13
Epoch 129/200 |loss: 8.289379| train set 5.008x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 14
Epoch 130/200 |loss: 9.224166| train set 4.674x speedup, test set 5.161x speedup, val set 0.901x speedup, step: 15
Epoch 131/200 |loss: 9.031774| train set 4.958x speedup, test set 5.161x speedup, val set 1.228x speedup, step: 16
Epoch 132/200 |loss: 9.102673| train set 4.873x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 17
Epoch 133/200 |loss: 7.735120| train set 4.958x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 18
Epoch 134/200 |loss: 6.936214| train set 4.958x speedup, test set 4.387x speedup, val set 0.980x speedup, step: 19
Epoch 135/200 |loss: 8.531286| train set 5.008x speedup, test set 4.387x speedup, val set 0.988x speedup, step: 20
Epoch 136/200 |loss: 7.675869| train set 5.008x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 21
Epoch 137/200 |loss: 8.445737| train set 5.008x speedup, test set 6.681x speedup, val set 0.841x speedup, step: 22
Epoch 138/200 |loss: 9.641543| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 23
Epoch 139/200 |loss: 9.155411| train set 5.008x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 24
Epoch 140/200 |loss: 7.828815| train set 4.958x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 141/200 |loss: 8.450253| train set 4.958x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 2
Epoch 142/200 |loss: 8.471295| train set 4.919x speedup, test set 6.681x speedup, val set 0.836x speedup, step: 3
Epoch 143/200 |loss: 9.166059| train set 4.921x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 4
Epoch 144/200 |loss: 8.522874| train set 4.957x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 145/200 |loss: 9.338351| train set 4.957x speedup, test set 6.681x speedup, val set 0.990x speedup, step: 2
Epoch 146/200 |loss: 9.277807| train set 4.921x speedup, test set 4.387x speedup, val set 0.944x speedup, step: 3
Epoch 147/200 |loss: 9.422322| train set 4.957x speedup, test set 6.293x speedup, val set 1.302x speedup, step: 4
Epoch 148/200 |loss: 8.335447| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 5
Epoch 149/200 |loss: 8.890295| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 6
Epoch 150/200 |loss: 9.778564| train set 4.912x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 7
Epoch 151/200 |loss: 8.833274| train set 4.913x speedup, test set 6.681x speedup, val set 0.980x speedup, step: 8
Epoch 152/200 |loss: 7.714667| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 9
Epoch 153/200 |loss: 9.766504| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 10
Epoch 154/200 |loss: 9.155095| train set 5.008x speedup, test set 6.681x speedup, val set 1.211x speedup, step: 11
Epoch 155/200 |loss: 9.321259| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 12
Epoch 156/200 |loss: 8.856346| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 13
Epoch 157/200 |loss: 9.260852| train set 5.008x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 14
Epoch 158/200 |loss: 10.447564| train set 4.921x speedup, test set 6.681x speedup, val set 0.795x speedup, step: 15
Epoch 159/200 |loss: 7.927724| train set 5.008x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 16
Epoch 160/200 |loss: 7.730280| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 17
Epoch 161/200 |loss: 9.315459| train set 5.008x speedup, test set 6.681x speedup, val set 0.990x speedup, step: 18
Epoch 162/200 |loss: 8.099909| train set 5.004x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 19
Epoch 163/200 |loss: 7.660370| train set 5.008x speedup, test set 6.681x speedup, val set 0.868x speedup, step: 20
Epoch 164/200 |loss: 8.800735| train set 5.008x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 21
Epoch 165/200 |loss: 7.880110| train set 5.008x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 22
Epoch 166/200 |loss: 9.112631| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 23
Epoch 167/200 |loss: 9.474950| train set 4.920x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 24
Epoch 168/200 |loss: 8.910339| train set 4.957x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 25
Epoch 169/200 |loss: 8.218454| train set 4.957x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 26
Epoch 170/200 |loss: 8.734854| train set 4.873x speedup, test set 6.681x speedup, val set 0.990x speedup, step: 27
Epoch 171/200 |loss: 9.621376| train set 4.873x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 28
Epoch 172/200 |loss: 9.742052| train set 4.958x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 29
Epoch 173/200 |loss: 8.176058| train set 4.957x speedup, test set 7.760x speedup, val set 1.228x speedup, step: 30
Epoch 174/200 |loss: 8.768764| train set 4.920x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 31
Epoch 175/200 |loss: 9.886096| train set 4.920x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 32
Epoch 176/200 |loss: 8.916030| train set 5.007x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 33
Epoch 177/200 |loss: 8.369232| train set 4.957x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 34
Epoch 178/200 |loss: 9.073678| train set 4.958x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 35
Epoch 179/200 |loss: 8.369445| train set 4.870x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 36
Epoch 180/200 |loss: 9.088891| train set 4.958x speedup, test set 6.681x speedup, val set 0.944x speedup, step: 37
Epoch 181/200 |loss: 8.409007| train set 4.958x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 38
Epoch 182/200 |loss: 9.319695| train set 4.958x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 39
Epoch 183/200 |loss: 8.287766| train set 4.958x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 40
Epoch 184/200 |loss: 7.367803| train set 4.921x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 41
Epoch 185/200 |loss: 8.515241| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 42
Epoch 186/200 |loss: 8.905298| train set 4.753x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 43
Epoch 187/200 |loss: 8.421855| train set 5.007x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 44
Epoch 188/200 |loss: 8.199151| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 45
Epoch 189/200 |loss: 8.587571| train set 5.007x speedup, test set 6.681x speedup, val set 0.813x speedup, step: 46
Epoch 190/200 |loss: 8.715376| train set 5.007x speedup, test set 6.681x speedup, val set 0.901x speedup, step: 47
Epoch 191/200 |loss: 7.745461| train set 5.008x speedup, test set 6.681x speedup, val set 1.149x speedup, step: 48
Epoch 192/200 |loss: 9.824827| train set 4.921x speedup, test set 6.681x speedup, val set 0.777x speedup, step: 49
Epoch 193/200 |loss: 9.232641| train set 4.921x speedup, test set 6.681x speedup, val set 0.868x speedup, step: 50
Epoch 194/200 |loss: 9.380002| train set 4.921x speedup, test set 6.681x speedup, val set 0.990x speedup, step: 51
Epoch 195/200 |loss: 7.598184| train set 4.921x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 52
Epoch 196/200 |loss: 8.668608| train set 4.991x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 53
Epoch 197/200 |loss: 8.858817| train set 4.954x speedup, test set 4.387x speedup, val set 0.836x speedup, step: 54
Epoch 198/200 |loss: 9.229432| train set 4.954x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 55
Epoch 199/200 |loss: 7.483897| train set 4.958x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 56
Training per epoch cost 0.316 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 18.392s, pg runtime 18.392s, speedup 1.000x
02, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
03, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
04, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
05, opt runtime 14.857s, model runtime 14.857s, pg runtime 14.857s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 15.831s, model runtime 15.831s, pg runtime 15.831s, speedup 1.000x
08, opt runtime 9.432s, model runtime 9.432s, pg runtime 9.432s, speedup 1.000x
09, opt runtime 26.874s, model runtime 26.874s, pg runtime 26.874s, speedup 1.000x
10, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 8.560, val speedup 0.965
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 144, train speedup 4.957, test speedup 6.681, val speedup 1.316
last model at epoch 199, train speedup 4.958, test speedup 6.681, val speedup 0.804
execution cost 0:02:30.839703
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.221709, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281971| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286845| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793528| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089631| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913024| train set 3.193x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588146| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.558285| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.379581| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.760285| train set 4.032x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.461716| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.913136| train set 4.630x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 13.903443| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.083241| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.477352| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.484351| train set 4.670x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.242603| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 19
Epoch 19/200 |loss: 10.133667| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.261763| train set 4.631x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.475408| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.062768| train set 4.673x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 23
Epoch 23/200 |loss: 10.508967| train set 5.007x speedup, test set 5.125x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 11.710338| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.252482| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.414464| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 11.631135| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 28
Epoch 28/200 |loss: 10.315184| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 9.548868| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 30
Epoch 30/200 |loss: 10.358402| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 31
Epoch 31/200 |loss: 10.332335| train set 4.958x speedup, test set 6.836x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.183021| train set 4.708x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 9.753144| train set 4.957x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.131980| train set 4.894x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 11.891206| train set 5.007x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 11.537333| train set 4.958x speedup, test set 8.028x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 10.150471| train set 4.674x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 38
Epoch 38/200 |loss: 10.043309| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 9.728388| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 40
Epoch 40/200 |loss: 9.536175| train set 5.008x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 41
Epoch 41/200 |loss: 10.030604| train set 4.921x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 42
Epoch 42/200 |loss: 10.436801| train set 4.873x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 43
Epoch 43/200 |loss: 10.636955| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.578385| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.755958| train set 5.008x speedup, test set 8.560x speedup, val set 0.980x speedup, step: 46
Epoch 46/200 |loss: 9.780016| train set 4.709x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 47
Epoch 47/200 |loss: 10.113295| train set 4.754x speedup, test set 5.125x speedup, val set 1.316x speedup, step: 48
Epoch 48/200 |loss: 9.628906| train set 4.921x speedup, test set 5.125x speedup, val set 0.759x speedup, step: 49
Epoch 49/200 |loss: 9.523636| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.677786| train set 4.958x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 9.794497| train set 4.958x speedup, test set 1.323x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 11.144133| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 53
Epoch 53/200 |loss: 8.770000| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 54
Epoch 54/200 |loss: 9.254562| train set 4.715x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.576730| train set 5.008x speedup, test set 8.560x speedup, val set 0.957x speedup, step: 56
Epoch 56/200 |loss: 8.918183| train set 5.008x speedup, test set 8.560x speedup, val set 0.957x speedup, step: 57
Epoch 57/200 |loss: 10.303284| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 58
Epoch 58/200 |loss: 9.342000| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 59
Epoch 59/200 |loss: 8.447876| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 60
Epoch 60/200 |loss: 9.159593| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 61
Epoch 61/200 |loss: 10.134026| train set 4.958x speedup, test set 6.214x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 7.763596| train set 4.873x speedup, test set 6.214x speedup, val set 1.033x speedup, step: 63
Epoch 63/200 |loss: 8.721649| train set 4.873x speedup, test set 6.214x speedup, val set 1.302x speedup, step: 64
Epoch 64/200 |loss: 8.364335| train set 5.008x speedup, test set 5.125x speedup, val set 1.228x speedup, step: 65
Epoch 65/200 |loss: 8.577221| train set 5.008x speedup, test set 5.125x speedup, val set 1.268x speedup, step: 66
Epoch 66/200 |loss: 9.889522| train set 5.004x speedup, test set 5.125x speedup, val set 0.777x speedup, step: 67
Epoch 67/200 |loss: 7.674957| train set 5.008x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 68
Epoch 68/200 |loss: 9.328332| train set 4.715x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.258504| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.553248| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.380004| train set 5.008x speedup, test set 5.125x speedup, val set 0.934x speedup, step: 72
Epoch 72/200 |loss: 7.987489| train set 5.007x speedup, test set 5.125x speedup, val set 0.735x speedup, step: 73
Epoch 73/200 |loss: 9.109126| train set 5.007x speedup, test set 5.125x speedup, val set 1.316x speedup, step: 74
Epoch 74/200 |loss: 9.236705| train set 4.957x speedup, test set 6.214x speedup, val set 1.316x speedup, step: 75
Epoch 75/200 |loss: 9.160174| train set 4.958x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.245833| train set 4.917x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.525672| train set 5.007x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 78
Epoch 78/200 |loss: 9.224669| train set 5.001x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.931435| train set 4.917x speedup, test set 5.125x speedup, val set 0.790x speedup, step: 80
Epoch 80/200 |loss: 7.903166| train set 5.007x speedup, test set 6.214x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.139768| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 8.922547| train set 5.004x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 83
Epoch 83/200 |loss: 8.468088| train set 5.008x speedup, test set 8.560x speedup, val set 1.211x speedup, step: 84
Epoch 84/200 |loss: 8.920747| train set 5.008x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.190877| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.807261| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 87
Epoch 87/200 |loss: 9.574495| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.814670| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 89
Epoch 89/200 |loss: 8.383116| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 90
Epoch 90/200 |loss: 8.771935| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 91
Epoch 91/200 |loss: 8.511765| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 92
Epoch 92/200 |loss: 8.298615| train set 5.008x speedup, test set 8.560x speedup, val set 1.133x speedup, step: 93
Epoch 93/200 |loss: 9.284938| train set 5.008x speedup, test set 8.028x speedup, val set 0.729x speedup, step: 94
Epoch 94/200 |loss: 8.609454| train set 5.007x speedup, test set 8.028x speedup, val set 1.133x speedup, step: 95
Epoch 95/200 |loss: 8.832756| train set 4.957x speedup, test set 6.214x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 9.211153| train set 4.958x speedup, test set 5.125x speedup, val set 0.735x speedup, step: 97
Epoch 97/200 |loss: 9.042269| train set 4.991x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.778300| train set 4.958x speedup, test set 6.681x speedup, val set 0.957x speedup, step: 99
Epoch 99/200 |loss: 9.602371| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 100
Epoch 100/200 |loss: 9.156046| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 1
Epoch 101/200 |loss: 10.005379| train set 4.670x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 2
Epoch 102/200 |loss: 9.055264| train set 4.958x speedup, test set 5.161x speedup, val set 1.133x speedup, step: 1
Epoch 103/200 |loss: 9.427961| train set 4.917x speedup, test set 6.353x speedup, val set 0.742x speedup, step: 2
Epoch 104/200 |loss: 8.469707| train set 4.921x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 3
Epoch 105/200 |loss: 7.653851| train set 4.921x speedup, test set 5.125x speedup, val set 0.934x speedup, step: 4
Epoch 106/200 |loss: 8.398661| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 5
Epoch 107/200 |loss: 8.800866| train set 5.007x speedup, test set 8.028x speedup, val set 0.735x speedup, step: 6
Epoch 108/200 |loss: 8.161786| train set 5.007x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 7
Epoch 109/200 |loss: 9.499026| train set 4.714x speedup, test set 4.387x speedup, val set 1.149x speedup, step: 1
Epoch 110/200 |loss: 7.651031| train set 4.956x speedup, test set 6.353x speedup, val set 1.241x speedup, step: 1
Epoch 111/200 |loss: 9.208161| train set 5.002x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 2
Epoch 112/200 |loss: 9.247220| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 3
Epoch 113/200 |loss: 9.172212| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 4
Epoch 114/200 |loss: 9.460583| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 5
Epoch 115/200 |loss: 8.123528| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 6
Epoch 116/200 |loss: 8.065838| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 7
Epoch 117/200 |loss: 9.846873| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 8
Epoch 118/200 |loss: 8.774897| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 9
Epoch 119/200 |loss: 8.968848| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 10
Epoch 120/200 |loss: 9.571424| train set 5.008x speedup, test set 5.161x speedup, val set 0.735x speedup, step: 11
Epoch 121/200 |loss: 8.636782| train set 5.008x speedup, test set 6.214x speedup, val set 0.742x speedup, step: 12
Epoch 122/200 |loss: 8.501477| train set 4.958x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 13
Epoch 123/200 |loss: 7.069909| train set 4.958x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 14
Epoch 124/200 |loss: 9.167268| train set 4.920x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 15
Epoch 125/200 |loss: 9.174093| train set 4.920x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 16
Epoch 126/200 |loss: 10.024138| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 17
Epoch 127/200 |loss: 8.411410| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 18
Epoch 128/200 |loss: 9.422396| train set 5.007x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 19
Epoch 129/200 |loss: 8.301810| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 20
Epoch 130/200 |loss: 9.114109| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 21
Epoch 131/200 |loss: 8.683983| train set 4.958x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 22
Epoch 132/200 |loss: 9.147083| train set 4.869x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 23
Epoch 133/200 |loss: 7.602749| train set 5.004x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 24
Epoch 134/200 |loss: 6.930183| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 25
Epoch 135/200 |loss: 8.432908| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 26
Epoch 136/200 |loss: 7.710866| train set 5.008x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 27
Epoch 137/200 |loss: 8.409954| train set 5.008x speedup, test set 4.387x speedup, val set 0.786x speedup, step: 28
Epoch 138/200 |loss: 9.607706| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 29
Epoch 139/200 |loss: 9.173204| train set 4.958x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 140/200 |loss: 8.252928| train set 4.958x speedup, test set 4.625x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.237851| train set 4.916x speedup, test set 8.560x speedup, val set 1.165x speedup, step: 2
Epoch 142/200 |loss: 8.610819| train set 4.921x speedup, test set 6.681x speedup, val set 0.770x speedup, step: 3
Epoch 143/200 |loss: 9.488667| train set 4.991x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 4
Epoch 144/200 |loss: 8.763777| train set 4.957x speedup, test set 6.681x speedup, val set 1.313x speedup, step: 1
Epoch 145/200 |loss: 10.139998| train set 4.957x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 2
Epoch 146/200 |loss: 9.254834| train set 4.921x speedup, test set 4.387x speedup, val set 0.795x speedup, step: 3
Epoch 147/200 |loss: 9.876998| train set 4.872x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 4
Epoch 148/200 |loss: 8.315978| train set 4.957x speedup, test set 4.387x speedup, val set 1.316x speedup, step: 1
Epoch 149/200 |loss: 8.805999| train set 5.007x speedup, test set 6.293x speedup, val set 1.302x speedup, step: 2
Epoch 150/200 |loss: 9.804621| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 3
Epoch 151/200 |loss: 8.883955| train set 5.003x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 4
Epoch 152/200 |loss: 7.983125| train set 4.921x speedup, test set 5.125x speedup, val set 0.735x speedup, step: 5
Epoch 153/200 |loss: 9.624880| train set 5.008x speedup, test set 6.214x speedup, val set 0.729x speedup, step: 6
Epoch 154/200 |loss: 9.006641| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 7
Epoch 155/200 |loss: 9.407995| train set 5.008x speedup, test set 4.954x speedup, val set 0.729x speedup, step: 8
Epoch 156/200 |loss: 8.781975| train set 5.008x speedup, test set 5.125x speedup, val set 0.735x speedup, step: 9
Epoch 157/200 |loss: 9.013949| train set 4.991x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 10
Epoch 158/200 |loss: 10.511410| train set 4.921x speedup, test set 8.093x speedup, val set 0.729x speedup, step: 11
Epoch 159/200 |loss: 7.789326| train set 5.008x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 12
Epoch 160/200 |loss: 7.723123| train set 5.008x speedup, test set 4.335x speedup, val set 0.729x speedup, step: 13
Epoch 161/200 |loss: 9.175494| train set 4.715x speedup, test set 5.161x speedup, val set 0.735x speedup, step: 14
Epoch 162/200 |loss: 8.076291| train set 5.004x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 15
Epoch 163/200 |loss: 7.596166| train set 5.008x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 16
Epoch 164/200 |loss: 8.994515| train set 5.008x speedup, test set 4.323x speedup, val set 0.729x speedup, step: 17
Epoch 165/200 |loss: 8.016833| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 18
Epoch 166/200 |loss: 9.003565| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 19
Epoch 167/200 |loss: 9.454370| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 20
Epoch 168/200 |loss: 8.696585| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 21
Epoch 169/200 |loss: 8.104736| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 22
Epoch 170/200 |loss: 8.944728| train set 4.873x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 23
Epoch 171/200 |loss: 9.474384| train set 4.873x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 24
Epoch 172/200 |loss: 9.882738| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 25
Epoch 173/200 |loss: 8.156493| train set 4.957x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 26
Epoch 174/200 |loss: 8.901202| train set 4.920x speedup, test set 5.826x speedup, val set 0.735x speedup, step: 27
Epoch 175/200 |loss: 9.743497| train set 4.920x speedup, test set 4.387x speedup, val set 0.786x speedup, step: 28
Epoch 176/200 |loss: 9.051370| train set 5.007x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 29
Epoch 177/200 |loss: 8.426845| train set 5.007x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 30
Epoch 178/200 |loss: 9.125843| train set 4.957x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 31
Epoch 179/200 |loss: 8.601542| train set 4.958x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 32
Epoch 180/200 |loss: 8.884449| train set 4.958x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 33
Epoch 181/200 |loss: 8.371418| train set 4.958x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 34
Epoch 182/200 |loss: 9.290673| train set 4.958x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 35
Epoch 183/200 |loss: 8.261732| train set 4.958x speedup, test set 5.360x speedup, val set 0.735x speedup, step: 36
Epoch 184/200 |loss: 7.341774| train set 5.008x speedup, test set 5.360x speedup, val set 0.735x speedup, step: 37
Epoch 185/200 |loss: 8.462823| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 38
Epoch 186/200 |loss: 8.810680| train set 4.754x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 39
Epoch 187/200 |loss: 8.358084| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 40
Epoch 188/200 |loss: 8.160972| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 41
Epoch 189/200 |loss: 8.557361| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 42
Epoch 190/200 |loss: 8.671955| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 43
Epoch 191/200 |loss: 7.753455| train set 5.008x speedup, test set 6.535x speedup, val set 0.735x speedup, step: 44
Epoch 192/200 |loss: 9.699827| train set 4.921x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 45
Epoch 193/200 |loss: 9.195301| train set 4.921x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 46
Epoch 194/200 |loss: 9.530396| train set 4.921x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 47
Epoch 195/200 |loss: 7.594873| train set 4.873x speedup, test set 5.073x speedup, val set 1.302x speedup, step: 48
Epoch 196/200 |loss: 8.786668| train set 4.958x speedup, test set 6.681x speedup, val set 1.149x speedup, step: 49
Epoch 197/200 |loss: 8.791489| train set 4.983x speedup, test set 3.776x speedup, val set 0.762x speedup, step: 50
Epoch 198/200 |loss: 9.310264| train set 4.954x speedup, test set 5.360x speedup, val set 0.786x speedup, step: 51
Epoch 199/200 |loss: 7.744674| train set 4.958x speedup, test set 5.360x speedup, val set 0.762x speedup, step: 52
Training per epoch cost 0.320 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 25, train speedup 5.008, test speedup 8.560, val speedup 0.729
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 148, train speedup 4.957, test speedup 4.387, val speedup 1.316
last model at epoch 199, train speedup 4.958, test speedup 5.360, val speedup 0.762
execution cost 0:02:31.420417
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.249622, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793522| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912633| train set 3.193x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587202| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575416| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370783| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755565| train set 4.032x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455397| train set 4.285x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921762| train set 4.630x speedup, test set 8.560x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914977| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.108999| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590153| train set 4.630x speedup, test set 1.484x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591466| train set 4.670x speedup, test set 1.607x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213900| train set 5.008x speedup, test set 8.560x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153142| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.500189| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.041675| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.292395| train set 5.008x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.729019| train set 5.007x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.943272| train set 5.007x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.749279| train set 5.008x speedup, test set 8.028x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.648414| train set 4.958x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.252696| train set 4.958x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.424964| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 10.232713| train set 4.921x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.781100| train set 5.008x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.555212| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.784216| train set 4.708x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 33
Epoch 33/200 |loss: 10.980978| train set 4.630x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.206543| train set 4.572x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 13.099541| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.233018| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.568143| train set 5.008x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 9.958278| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 10.821874| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.545501| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.090679| train set 4.921x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.559083| train set 4.921x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.533943| train set 4.631x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.213310| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.366224| train set 4.652x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 10.520164| train set 4.754x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 10.318957| train set 4.674x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.517034| train set 4.674x speedup, test set 8.560x speedup, val set 0.957x speedup, step: 49
Epoch 49/200 |loss: 10.399078| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.382729| train set 4.958x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 10.042989| train set 4.958x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.384680| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 8.930014| train set 4.715x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.721549| train set 4.714x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.741047| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 8.619652| train set 4.921x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.059658| train set 5.007x speedup, test set 5.125x speedup, val set 1.268x speedup, step: 58
Epoch 58/200 |loss: 9.492188| train set 5.007x speedup, test set 8.560x speedup, val set 1.073x speedup, step: 59
Epoch 59/200 |loss: 8.762293| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 60
Epoch 60/200 |loss: 9.204026| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 61
Epoch 61/200 |loss: 10.502260| train set 4.958x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 7.935659| train set 4.869x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 63
Epoch 63/200 |loss: 8.708678| train set 4.917x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.298425| train set 5.007x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 65
Epoch 65/200 |loss: 8.934194| train set 5.007x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.686546| train set 5.008x speedup, test set 8.560x speedup, val set 1.241x speedup, step: 67
Epoch 67/200 |loss: 7.488849| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 68
Epoch 68/200 |loss: 9.110804| train set 4.715x speedup, test set 5.125x speedup, val set 0.825x speedup, step: 69
Epoch 69/200 |loss: 9.048573| train set 5.008x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 70
Epoch 70/200 |loss: 8.410938| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 71
Epoch 71/200 |loss: 9.588186| train set 5.008x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 72
Epoch 72/200 |loss: 7.926605| train set 5.008x speedup, test set 8.560x speedup, val set 1.316x speedup, step: 73
Epoch 73/200 |loss: 9.257302| train set 5.008x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.482048| train set 4.957x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 9.018591| train set 4.872x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.292882| train set 4.920x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.478144| train set 5.007x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 78
Epoch 78/200 |loss: 9.421206| train set 5.007x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 79
Epoch 79/200 |loss: 8.822563| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 80
Epoch 80/200 |loss: 7.672622| train set 5.007x speedup, test set 8.560x speedup, val set 0.994x speedup, step: 81
Epoch 81/200 |loss: 10.442649| train set 5.008x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 82
Epoch 82/200 |loss: 9.150028| train set 5.008x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 83
Epoch 83/200 |loss: 8.679045| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 84
Epoch 84/200 |loss: 9.257904| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.394953| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.947406| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 87
Epoch 87/200 |loss: 9.791915| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.843632| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 89
Epoch 89/200 |loss: 8.235307| train set 5.008x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 90
Epoch 90/200 |loss: 8.723011| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 91
Epoch 91/200 |loss: 8.481793| train set 5.008x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 92
Epoch 92/200 |loss: 8.337198| train set 5.008x speedup, test set 8.560x speedup, val set 0.965x speedup, step: 93
Epoch 93/200 |loss: 9.486798| train set 4.921x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 94
Epoch 94/200 |loss: 8.770791| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 95
Epoch 95/200 |loss: 9.183923| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 96
Epoch 96/200 |loss: 9.323763| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 97
Epoch 97/200 |loss: 9.167908| train set 4.958x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 9.064217| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 99
Epoch 99/200 |loss: 9.267939| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 100
Epoch 100/200 |loss: 9.494384| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 1
Epoch 101/200 |loss: 10.058253| train set 4.715x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 1
Epoch 102/200 |loss: 9.404637| train set 5.008x speedup, test set 8.560x speedup, val set 1.133x speedup, step: 1
Epoch 103/200 |loss: 9.455735| train set 5.004x speedup, test set 8.560x speedup, val set 0.786x speedup, step: 2
Epoch 104/200 |loss: 8.734706| train set 4.917x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 3
Epoch 105/200 |loss: 8.069538| train set 4.920x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.812619| train set 5.007x speedup, test set 8.560x speedup, val set 1.133x speedup, step: 2
Epoch 107/200 |loss: 9.218094| train set 5.007x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 3
Epoch 108/200 |loss: 8.632740| train set 5.007x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 4
Epoch 109/200 |loss: 9.556756| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 5
Epoch 110/200 |loss: 7.915402| train set 5.008x speedup, test set 8.560x speedup, val set 1.165x speedup, step: 6
Epoch 111/200 |loss: 8.919365| train set 4.958x speedup, test set 8.560x speedup, val set 1.006x speedup, step: 7
Epoch 112/200 |loss: 9.239635| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 8
Epoch 113/200 |loss: 8.883433| train set 5.008x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 9
Epoch 114/200 |loss: 9.268746| train set 5.008x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 10
Epoch 115/200 |loss: 7.965747| train set 5.008x speedup, test set 5.125x speedup, val set 0.735x speedup, step: 11
Epoch 116/200 |loss: 8.031765| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 12
Epoch 117/200 |loss: 9.773068| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 13
Epoch 118/200 |loss: 9.035104| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 14
Epoch 119/200 |loss: 9.097991| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 15
Epoch 120/200 |loss: 9.693267| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 16
Epoch 121/200 |loss: 8.572090| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 17
Epoch 122/200 |loss: 8.787427| train set 4.958x speedup, test set 5.038x speedup, val set 0.735x speedup, step: 18
Epoch 123/200 |loss: 7.040253| train set 4.958x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 19
Epoch 124/200 |loss: 9.310429| train set 4.921x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 20
Epoch 125/200 |loss: 9.432805| train set 4.920x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 21
Epoch 126/200 |loss: 9.996800| train set 5.007x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 22
Epoch 127/200 |loss: 8.706018| train set 5.007x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 23
Epoch 128/200 |loss: 9.251630| train set 5.007x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 24
Epoch 129/200 |loss: 8.382216| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 25
Epoch 130/200 |loss: 9.164169| train set 5.008x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 26
Epoch 131/200 |loss: 8.917596| train set 4.958x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 27
Epoch 132/200 |loss: 9.220468| train set 5.008x speedup, test set 8.319x speedup, val set 0.735x speedup, step: 28
Epoch 133/200 |loss: 7.477409| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 29
Epoch 134/200 |loss: 6.921876| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 30
Epoch 135/200 |loss: 8.535379| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 31
Epoch 136/200 |loss: 7.399852| train set 5.008x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 32
Epoch 137/200 |loss: 8.610528| train set 5.008x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 33
Epoch 138/200 |loss: 9.306434| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 34
Epoch 139/200 |loss: 8.915348| train set 5.008x speedup, test set 5.125x speedup, val set 0.735x speedup, step: 35
Epoch 140/200 |loss: 7.892509| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 36
Epoch 141/200 |loss: 8.386659| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 37
Epoch 142/200 |loss: 8.871902| train set 4.921x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 38
Epoch 143/200 |loss: 9.102439| train set 5.000x speedup, test set 5.125x speedup, val set 0.735x speedup, step: 39
Epoch 144/200 |loss: 8.917984| train set 4.957x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 40
Epoch 145/200 |loss: 9.259600| train set 5.007x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 41
Epoch 146/200 |loss: 9.108619| train set 4.920x speedup, test set 5.125x speedup, val set 0.735x speedup, step: 42
Epoch 147/200 |loss: 9.641004| train set 5.007x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 43
Epoch 148/200 |loss: 8.450438| train set 5.007x speedup, test set 5.125x speedup, val set 1.133x speedup, step: 44
Epoch 149/200 |loss: 8.860953| train set 5.004x speedup, test set 8.560x speedup, val set 1.149x speedup, step: 45
Epoch 150/200 |loss: 9.730574| train set 5.007x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 46
Epoch 151/200 |loss: 8.834022| train set 4.920x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 47
Epoch 152/200 |loss: 7.719769| train set 4.920x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 48
Epoch 153/200 |loss: 9.616794| train set 4.921x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 49
Epoch 154/200 |loss: 8.919270| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 50
Epoch 155/200 |loss: 9.265166| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 51
Epoch 156/200 |loss: 9.042410| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 52
Epoch 157/200 |loss: 9.225121| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 53
Epoch 158/200 |loss: 10.459037| train set 4.915x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 54
Epoch 159/200 |loss: 7.851083| train set 5.004x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 55
Epoch 160/200 |loss: 7.712172| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 56
Epoch 161/200 |loss: 9.388733| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 57
Epoch 162/200 |loss: 8.087277| train set 5.008x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 58
Epoch 163/200 |loss: 7.766555| train set 5.008x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 59
Epoch 164/200 |loss: 8.761478| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 60
Epoch 165/200 |loss: 8.050726| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 61
Epoch 166/200 |loss: 9.214650| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 62
Epoch 167/200 |loss: 9.538076| train set 4.921x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 63
Epoch 168/200 |loss: 8.773070| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 64
Epoch 169/200 |loss: 8.357202| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 65
Epoch 170/200 |loss: 8.741357| train set 4.873x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 66
Epoch 171/200 |loss: 9.356335| train set 4.873x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 67
Epoch 172/200 |loss: 9.578135| train set 4.873x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 68
Epoch 173/200 |loss: 8.253140| train set 4.957x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 69
Epoch 174/200 |loss: 8.605715| train set 4.920x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 70
Epoch 175/200 |loss: 9.716886| train set 4.920x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 71
Epoch 176/200 |loss: 9.124717| train set 4.920x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 72
Epoch 177/200 |loss: 8.308158| train set 4.957x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 73
Epoch 178/200 |loss: 9.161783| train set 4.957x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 74
Epoch 179/200 |loss: 8.498520| train set 4.958x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 75
Epoch 180/200 |loss: 8.993898| train set 4.958x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 76
Epoch 181/200 |loss: 8.400121| train set 4.958x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 77
Epoch 182/200 |loss: 9.359584| train set 4.958x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 78
Epoch 183/200 |loss: 8.528968| train set 5.008x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 79
Epoch 184/200 |loss: 7.265055| train set 5.008x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 80
Epoch 185/200 |loss: 8.469036| train set 5.008x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 81
Epoch 186/200 |loss: 8.847296| train set 4.753x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 82
Epoch 187/200 |loss: 8.425338| train set 5.007x speedup, test set 8.560x speedup, val set 0.762x speedup, step: 83
Epoch 188/200 |loss: 8.194220| train set 5.007x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 84
Epoch 189/200 |loss: 8.627088| train set 4.920x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 85
Epoch 190/200 |loss: 8.653904| train set 5.008x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 86
Epoch 191/200 |loss: 7.813041| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 87
Epoch 192/200 |loss: 9.721866| train set 4.921x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 88
Epoch 193/200 |loss: 9.083668| train set 4.921x speedup, test set 8.560x speedup, val set 0.786x speedup, step: 89
Epoch 194/200 |loss: 9.623547| train set 4.921x speedup, test set 8.560x speedup, val set 0.786x speedup, step: 90
Epoch 195/200 |loss: 7.424012| train set 4.873x speedup, test set 8.560x speedup, val set 1.149x speedup, step: 91
Epoch 196/200 |loss: 8.588805| train set 4.958x speedup, test set 8.560x speedup, val set 0.806x speedup, step: 92
Epoch 197/200 |loss: 8.835880| train set 4.954x speedup, test set 8.560x speedup, val set 0.795x speedup, step: 93
Epoch 198/200 |loss: 9.165236| train set 4.954x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 94
Epoch 199/200 |loss: 7.426646| train set 5.004x speedup, test set 8.560x speedup, val set 0.795x speedup, step: 95
Training per epoch cost 0.311 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 8.560, val speedup 0.965
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 105, train speedup 4.920, test speedup 5.125, val speedup 1.302
last model at epoch 199, train speedup 5.004, test speedup 8.560, val speedup 0.795
execution cost 0:02:28.094245
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.260391, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286845| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793528| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089631| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913025| train set 3.193x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588146| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.558287| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.379581| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.760285| train set 4.032x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.461717| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.913137| train set 4.630x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 13.903445| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.083204| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.477288| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.484350| train set 4.670x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.240043| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 19
Epoch 19/200 |loss: 10.136599| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.243862| train set 4.631x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.430190| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.089966| train set 4.673x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 23
Epoch 23/200 |loss: 10.393754| train set 5.007x speedup, test set 5.125x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 11.700754| train set 5.008x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.354021| train set 5.008x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.164460| train set 4.674x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 12.053978| train set 5.008x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 28
Epoch 28/200 |loss: 10.382994| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 9.813502| train set 4.865x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 30
Epoch 30/200 |loss: 10.405325| train set 4.958x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 31
Epoch 31/200 |loss: 10.480539| train set 4.957x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.136732| train set 4.464x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 9.762562| train set 4.670x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 10.764394| train set 4.847x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 12.314285| train set 5.007x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 11.802097| train set 5.008x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 37
Epoch 37/200 |loss: 10.086339| train set 5.008x speedup, test set 8.560x speedup, val set 0.957x speedup, step: 38
Epoch 38/200 |loss: 9.452543| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.060533| train set 4.850x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 40
Epoch 40/200 |loss: 9.552876| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 9.991247| train set 4.921x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.409412| train set 4.958x speedup, test set 8.028x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.561619| train set 4.958x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.578334| train set 4.958x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.616580| train set 5.008x speedup, test set 8.560x speedup, val set 0.980x speedup, step: 46
Epoch 46/200 |loss: 10.304013| train set 4.754x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 10.006469| train set 4.452x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.719864| train set 4.921x speedup, test set 8.560x speedup, val set 0.957x speedup, step: 49
Epoch 49/200 |loss: 9.706986| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.497300| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 9.749966| train set 4.921x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 52
Epoch 52/200 |loss: 10.550401| train set 5.008x speedup, test set 7.204x speedup, val set 0.957x speedup, step: 53
Epoch 53/200 |loss: 9.205460| train set 4.715x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.935669| train set 4.715x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 55
Epoch 55/200 |loss: 9.755148| train set 5.007x speedup, test set 6.214x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 9.168745| train set 5.007x speedup, test set 8.560x speedup, val set 0.775x speedup, step: 57
Epoch 57/200 |loss: 10.267555| train set 4.921x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.415237| train set 5.007x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.444358| train set 5.007x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 60
Epoch 60/200 |loss: 9.091540| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.473739| train set 4.958x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 62
Epoch 62/200 |loss: 7.879079| train set 4.873x speedup, test set 8.560x speedup, val set 1.268x speedup, step: 63
Epoch 63/200 |loss: 8.686752| train set 4.869x speedup, test set 8.560x speedup, val set 1.228x speedup, step: 64
Epoch 64/200 |loss: 8.300912| train set 4.920x speedup, test set 5.125x speedup, val set 1.228x speedup, step: 65
Epoch 65/200 |loss: 8.786722| train set 5.007x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 66
Epoch 66/200 |loss: 9.909879| train set 5.004x speedup, test set 8.560x speedup, val set 1.165x speedup, step: 67
Epoch 67/200 |loss: 7.493748| train set 5.004x speedup, test set 8.560x speedup, val set 0.944x speedup, step: 68
Epoch 68/200 |loss: 9.113184| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.208664| train set 5.008x speedup, test set 5.125x speedup, val set 0.798x speedup, step: 70
Epoch 70/200 |loss: 8.441336| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.237770| train set 5.008x speedup, test set 8.560x speedup, val set 1.133x speedup, step: 72
Epoch 72/200 |loss: 7.806324| train set 5.007x speedup, test set 8.028x speedup, val set 1.302x speedup, step: 73
Epoch 73/200 |loss: 8.921357| train set 5.007x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.091405| train set 4.957x speedup, test set 6.214x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.864300| train set 4.957x speedup, test set 8.560x speedup, val set 1.268x speedup, step: 76
Epoch 76/200 |loss: 7.062361| train set 4.917x speedup, test set 5.125x speedup, val set 0.968x speedup, step: 77
Epoch 77/200 |loss: 8.463323| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 78
Epoch 78/200 |loss: 9.063600| train set 5.003x speedup, test set 5.125x speedup, val set 0.980x speedup, step: 79
Epoch 79/200 |loss: 8.762883| train set 4.917x speedup, test set 5.125x speedup, val set 0.868x speedup, step: 80
Epoch 80/200 |loss: 7.680653| train set 5.008x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.317229| train set 5.008x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 82
Epoch 82/200 |loss: 9.015047| train set 5.008x speedup, test set 5.125x speedup, val set 0.804x speedup, step: 83
Epoch 83/200 |loss: 8.624466| train set 5.008x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 9.228539| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.235893| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 9.146323| train set 4.674x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 87
Epoch 87/200 |loss: 9.636490| train set 5.008x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 8.057103| train set 5.008x speedup, test set 8.560x speedup, val set 0.955x speedup, step: 89
Epoch 89/200 |loss: 8.178733| train set 4.958x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 90
Epoch 90/200 |loss: 8.941097| train set 4.958x speedup, test set 5.125x speedup, val set 0.994x speedup, step: 91
Epoch 91/200 |loss: 8.519435| train set 5.008x speedup, test set 6.681x speedup, val set 1.073x speedup, step: 92
Epoch 92/200 |loss: 8.361941| train set 5.008x speedup, test set 6.836x speedup, val set 1.302x speedup, step: 93
Epoch 93/200 |loss: 9.138686| train set 5.008x speedup, test set 8.560x speedup, val set 1.016x speedup, step: 94
Epoch 94/200 |loss: 8.550724| train set 5.008x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 95
Epoch 95/200 |loss: 8.959702| train set 4.958x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 9.319407| train set 4.958x speedup, test set 5.125x speedup, val set 0.769x speedup, step: 97
Epoch 97/200 |loss: 8.698609| train set 5.008x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 98
Epoch 98/200 |loss: 8.615664| train set 5.008x speedup, test set 5.125x speedup, val set 0.762x speedup, step: 99
Epoch 99/200 |loss: 9.403404| train set 5.008x speedup, test set 8.560x speedup, val set 1.006x speedup, step: 100
Epoch 100/200 |loss: 8.951881| train set 5.008x speedup, test set 5.125x speedup, val set 0.980x speedup, step: 101
Epoch 101/200 |loss: 9.984701| train set 4.715x speedup, test set 5.125x speedup, val set 1.117x speedup, step: 1
Epoch 102/200 |loss: 9.034249| train set 4.958x speedup, test set 5.964x speedup, val set 1.228x speedup, step: 1
Epoch 103/200 |loss: 9.361431| train set 5.004x speedup, test set 5.360x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.590362| train set 4.913x speedup, test set 5.125x speedup, val set 0.868x speedup, step: 3
Epoch 105/200 |loss: 7.662840| train set 5.007x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.538123| train set 5.007x speedup, test set 5.125x speedup, val set 1.268x speedup, step: 2
Epoch 107/200 |loss: 8.780203| train set 5.007x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 3
Epoch 108/200 |loss: 8.416028| train set 5.007x speedup, test set 5.125x speedup, val set 0.762x speedup, step: 4
Epoch 109/200 |loss: 9.448340| train set 4.715x speedup, test set 5.125x speedup, val set 1.228x speedup, step: 5
Epoch 110/200 |loss: 7.748772| train set 4.958x speedup, test set 6.214x speedup, val set 0.980x speedup, step: 6
Epoch 111/200 |loss: 8.845345| train set 4.954x speedup, test set 8.560x speedup, val set 0.980x speedup, step: 7
Epoch 112/200 |loss: 8.822248| train set 5.008x speedup, test set 5.125x speedup, val set 1.084x speedup, step: 8
Epoch 113/200 |loss: 8.741360| train set 5.008x speedup, test set 5.125x speedup, val set 0.813x speedup, step: 9
Epoch 114/200 |loss: 9.239111| train set 5.008x speedup, test set 5.125x speedup, val set 1.165x speedup, step: 10
Epoch 115/200 |loss: 7.783950| train set 5.008x speedup, test set 5.125x speedup, val set 1.165x speedup, step: 11
Epoch 116/200 |loss: 7.921407| train set 4.921x speedup, test set 5.125x speedup, val set 0.990x speedup, step: 12
Epoch 117/200 |loss: 9.921403| train set 5.008x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 13
Epoch 118/200 |loss: 8.841319| train set 5.008x speedup, test set 8.560x speedup, val set 0.735x speedup, step: 14
Epoch 119/200 |loss: 8.857773| train set 5.008x speedup, test set 5.360x speedup, val set 0.762x speedup, step: 15
Epoch 120/200 |loss: 9.566063| train set 5.008x speedup, test set 3.776x speedup, val set 1.165x speedup, step: 16
Epoch 121/200 |loss: 8.636203| train set 4.921x speedup, test set 3.776x speedup, val set 1.302x speedup, step: 1
Epoch 122/200 |loss: 8.752927| train set 4.873x speedup, test set 3.776x speedup, val set 1.302x speedup, step: 1
Epoch 123/200 |loss: 6.899005| train set 4.873x speedup, test set 3.776x speedup, val set 1.165x speedup, step: 2
Epoch 124/200 |loss: 9.106278| train set 4.920x speedup, test set 3.776x speedup, val set 0.762x speedup, step: 3
Epoch 125/200 |loss: 9.450783| train set 5.007x speedup, test set 6.535x speedup, val set 0.735x speedup, step: 4
Epoch 126/200 |loss: 10.228555| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 5
Epoch 127/200 |loss: 8.413003| train set 5.007x speedup, test set 5.073x speedup, val set 0.742x speedup, step: 6
Epoch 128/200 |loss: 9.412952| train set 5.007x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 7
Epoch 129/200 |loss: 8.193639| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 8
Epoch 130/200 |loss: 9.129177| train set 5.008x speedup, test set 5.073x speedup, val set 0.729x speedup, step: 9
Epoch 131/200 |loss: 8.856942| train set 4.958x speedup, test set 5.161x speedup, val set 0.735x speedup, step: 10
Epoch 132/200 |loss: 9.207215| train set 4.954x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 11
Epoch 133/200 |loss: 7.572837| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 12
Epoch 134/200 |loss: 6.918057| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 13
Epoch 135/200 |loss: 8.595010| train set 5.008x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 14
Epoch 136/200 |loss: 7.580999| train set 5.008x speedup, test set 5.360x speedup, val set 0.804x speedup, step: 15
Epoch 137/200 |loss: 8.705141| train set 5.008x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 16
Epoch 138/200 |loss: 9.484161| train set 5.008x speedup, test set 4.335x speedup, val set 0.955x speedup, step: 17
Epoch 139/200 |loss: 9.080903| train set 4.638x speedup, test set 3.776x speedup, val set 1.165x speedup, step: 18
Epoch 140/200 |loss: 8.036894| train set 4.958x speedup, test set 5.161x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.376878| train set 4.958x speedup, test set 6.353x speedup, val set 1.302x speedup, step: 1
Epoch 142/200 |loss: 8.493323| train set 4.921x speedup, test set 4.387x speedup, val set 0.990x speedup, step: 2
Epoch 143/200 |loss: 9.397413| train set 5.008x speedup, test set 4.387x speedup, val set 0.813x speedup, step: 3
Epoch 144/200 |loss: 8.491985| train set 4.957x speedup, test set 5.161x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.293669| train set 4.904x speedup, test set 4.387x speedup, val set 0.813x speedup, step: 2
Epoch 146/200 |loss: 9.296219| train set 4.920x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 3
Epoch 147/200 |loss: 9.391237| train set 4.957x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 4
Epoch 148/200 |loss: 8.349523| train set 5.007x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 8.841060| train set 5.007x speedup, test set 4.387x speedup, val set 0.798x speedup, step: 2
Epoch 150/200 |loss: 9.539853| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 3
Epoch 151/200 |loss: 8.744394| train set 4.920x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 4
Epoch 152/200 |loss: 7.703619| train set 4.921x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 5
Epoch 153/200 |loss: 9.933275| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 6
Epoch 154/200 |loss: 9.167472| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 7
Epoch 155/200 |loss: 9.462389| train set 5.008x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 8
Epoch 156/200 |loss: 8.768841| train set 5.008x speedup, test set 5.161x speedup, val set 0.735x speedup, step: 9
Epoch 157/200 |loss: 9.403827| train set 4.958x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 10
Epoch 158/200 |loss: 10.615283| train set 4.921x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 11
Epoch 159/200 |loss: 7.999596| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 12
Epoch 160/200 |loss: 7.939431| train set 5.008x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 13
Epoch 161/200 |loss: 9.311665| train set 5.008x speedup, test set 5.161x speedup, val set 0.742x speedup, step: 14
Epoch 162/200 |loss: 8.068303| train set 5.008x speedup, test set 5.161x speedup, val set 0.795x speedup, step: 15
Epoch 163/200 |loss: 7.671283| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 16
Epoch 164/200 |loss: 8.901562| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 17
Epoch 165/200 |loss: 8.073381| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 18
Epoch 166/200 |loss: 9.047193| train set 5.008x speedup, test set 5.161x speedup, val set 0.742x speedup, step: 19
Epoch 167/200 |loss: 9.966012| train set 5.007x speedup, test set 5.161x speedup, val set 1.133x speedup, step: 20
Epoch 168/200 |loss: 8.980420| train set 4.957x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.433432| train set 4.873x speedup, test set 4.323x speedup, val set 1.302x speedup, step: 1
Epoch 170/200 |loss: 8.624880| train set 4.873x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 2
Epoch 171/200 |loss: 9.455824| train set 4.873x speedup, test set 4.539x speedup, val set 0.735x speedup, step: 3
Epoch 172/200 |loss: 9.631246| train set 4.958x speedup, test set 4.335x speedup, val set 0.934x speedup, step: 4
Epoch 173/200 |loss: 8.234172| train set 4.957x speedup, test set 4.335x speedup, val set 0.944x speedup, step: 5
Epoch 174/200 |loss: 8.630606| train set 4.920x speedup, test set 4.335x speedup, val set 0.786x speedup, step: 6
Epoch 175/200 |loss: 9.812757| train set 4.920x speedup, test set 3.776x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 9.042366| train set 4.920x speedup, test set 3.776x speedup, val set 0.990x speedup, step: 8
Epoch 177/200 |loss: 8.438043| train set 4.957x speedup, test set 6.535x speedup, val set 1.228x speedup, step: 9
Epoch 178/200 |loss: 9.184832| train set 4.958x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 10
Epoch 179/200 |loss: 8.543041| train set 4.958x speedup, test set 8.560x speedup, val set 0.836x speedup, step: 11
Epoch 180/200 |loss: 9.149445| train set 4.958x speedup, test set 8.093x speedup, val set 0.990x speedup, step: 12
Epoch 181/200 |loss: 8.672052| train set 4.954x speedup, test set 3.776x speedup, val set 1.165x speedup, step: 13
Epoch 182/200 |loss: 9.340530| train set 4.954x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 14
Epoch 183/200 |loss: 8.343378| train set 4.958x speedup, test set 8.560x speedup, val set 1.165x speedup, step: 15
Epoch 184/200 |loss: 7.398798| train set 4.921x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 16
Epoch 185/200 |loss: 8.476439| train set 4.920x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 17
Epoch 186/200 |loss: 8.806944| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 18
Epoch 187/200 |loss: 8.360097| train set 5.007x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 19
Epoch 188/200 |loss: 8.168761| train set 5.007x speedup, test set 8.560x speedup, val set 1.165x speedup, step: 20
Epoch 189/200 |loss: 8.578622| train set 5.007x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 21
Epoch 190/200 |loss: 8.516195| train set 5.007x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 22
Epoch 191/200 |loss: 7.871189| train set 5.008x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 23
Epoch 192/200 |loss: 9.697940| train set 4.921x speedup, test set 8.560x speedup, val set 0.742x speedup, step: 24
Epoch 193/200 |loss: 9.212903| train set 4.921x speedup, test set 8.560x speedup, val set 0.786x speedup, step: 25
Epoch 194/200 |loss: 9.589960| train set 4.921x speedup, test set 8.560x speedup, val set 1.165x speedup, step: 26
Epoch 195/200 |loss: 7.477890| train set 4.691x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 1
Epoch 196/200 |loss: 8.731133| train set 4.958x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 2
Epoch 197/200 |loss: 8.700219| train set 4.958x speedup, test set 5.453x speedup, val set 0.795x speedup, step: 3
Epoch 198/200 |loss: 9.229899| train set 4.958x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 4
Epoch 199/200 |loss: 7.578401| train set 4.958x speedup, test set 8.560x speedup, val set 0.770x speedup, step: 5
Training per epoch cost 0.320 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 18.392s, pg runtime 18.392s, speedup 1.000x
02, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
03, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
04, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
05, opt runtime 14.857s, model runtime 14.857s, pg runtime 14.857s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 15.831s, model runtime 15.831s, pg runtime 15.831s, speedup 1.000x
08, opt runtime 9.432s, model runtime 9.432s, pg runtime 9.432s, speedup 1.000x
09, opt runtime 26.874s, model runtime 26.874s, pg runtime 26.874s, speedup 1.000x
10, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 23.436s, pg runtime 432.766s, speedup 18.466x
32, opt runtime 15.120s, model runtime 23.316s, pg runtime 566.078s, speedup 24.279x
33, opt runtime 16.639s, model runtime 23.017s, pg runtime 462.544s, speedup 20.095x
34, opt runtime 16.280s, model runtime 23.060s, pg runtime 634.990s, speedup 27.537x
35, opt runtime 16.528s, model runtime 23.747s, pg runtime 620.762s, speedup 26.141x
36, opt runtime 18.690s, model runtime 25.079s, pg runtime 651.942s, speedup 25.995x
37, opt runtime 16.438s, model runtime 23.248s, pg runtime 546.887s, speedup 23.524x
38, opt runtime 16.138s, model runtime 23.246s, pg runtime 501.793s, speedup 21.586x
39, opt runtime 16.770s, model runtime 23.336s, pg runtime 594.754s, speedup 25.486x
40, opt runtime 16.305s, model runtime 22.633s, pg runtime 436.168s, speedup 19.271x
====================
best train speedup epoch: 25, train speedup 5.008, test speedup 1.476, val speedup 0.729
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 195, train speedup 4.691, test speedup 8.560, val speedup 1.302
last model at epoch 199, train speedup 4.958, test speedup 8.560, val speedup 0.770
execution cost 0:02:33.478835
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.232776, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286845| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793528| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089632| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913026| train set 3.193x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588147| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.558294| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.379483| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.760448| train set 4.032x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.462854| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.908390| train set 4.630x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 13.924261| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.056889| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.510788| train set 4.630x speedup, test set 1.484x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591500| train set 4.670x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.277511| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 19
Epoch 19/200 |loss: 10.106723| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.401884| train set 4.631x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.555573| train set 4.895x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 22
Epoch 22/200 |loss: 10.184419| train set 5.007x speedup, test set 8.560x speedup, val set 0.752x speedup, step: 23
Epoch 23/200 |loss: 10.713859| train set 5.007x speedup, test set 6.741x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.988370| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.382808| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.204224| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 11.674741| train set 4.958x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 28
Epoch 28/200 |loss: 10.086215| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 29
Epoch 29/200 |loss: 9.507366| train set 4.865x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 30
Epoch 30/200 |loss: 10.319024| train set 4.958x speedup, test set 8.028x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 10.457213| train set 4.991x speedup, test set 1.460x speedup, val set 1.033x speedup, step: 32
Epoch 32/200 |loss: 10.404858| train set 4.670x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 33
Epoch 33/200 |loss: 9.859348| train set 4.670x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.115165| train set 4.847x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 12.326333| train set 4.920x speedup, test set 1.323x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 11.455424| train set 4.883x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 37
Epoch 37/200 |loss: 9.789003| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 38
Epoch 38/200 |loss: 9.534768| train set 5.008x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 39
Epoch 39/200 |loss: 9.956442| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 40
Epoch 40/200 |loss: 9.279575| train set 4.958x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 41
Epoch 41/200 |loss: 10.082242| train set 4.921x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.077743| train set 4.873x speedup, test set 8.028x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 9.855861| train set 4.671x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 10.432375| train set 5.008x speedup, test set 5.125x speedup, val set 0.994x speedup, step: 45
Epoch 45/200 |loss: 8.813916| train set 4.753x speedup, test set 5.125x speedup, val set 0.735x speedup, step: 46
Epoch 46/200 |loss: 9.328290| train set 4.451x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 47
Epoch 47/200 |loss: 9.815768| train set 4.451x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 48
Epoch 48/200 |loss: 8.928561| train set 4.921x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 9.787067| train set 4.674x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 50
Epoch 50/200 |loss: 9.226816| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 51
Epoch 51/200 |loss: 9.590041| train set 4.958x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 52
Epoch 52/200 |loss: 10.555119| train set 4.958x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 8.561198| train set 4.715x speedup, test set 6.495x speedup, val set 0.733x speedup, step: 54
Epoch 54/200 |loss: 8.889003| train set 5.008x speedup, test set 6.495x speedup, val set 0.729x speedup, step: 55
Epoch 55/200 |loss: 9.504907| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 56
Epoch 56/200 |loss: 8.670429| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.131169| train set 5.008x speedup, test set 1.361x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.357891| train set 5.008x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 59
Epoch 59/200 |loss: 8.755538| train set 4.715x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 60
Epoch 60/200 |loss: 9.660759| train set 4.958x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.386682| train set 4.873x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 62
Epoch 62/200 |loss: 7.902463| train set 4.873x speedup, test set 5.125x speedup, val set 0.873x speedup, step: 63
Epoch 63/200 |loss: 8.917925| train set 4.873x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 64
Epoch 64/200 |loss: 8.339700| train set 4.920x speedup, test set 5.125x speedup, val set 1.006x speedup, step: 65
Epoch 65/200 |loss: 8.732437| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.880289| train set 5.004x speedup, test set 8.560x speedup, val set 0.980x speedup, step: 67
Epoch 67/200 |loss: 7.449575| train set 5.004x speedup, test set 8.560x speedup, val set 0.980x speedup, step: 68
Epoch 68/200 |loss: 9.116012| train set 4.715x speedup, test set 5.125x speedup, val set 0.957x speedup, step: 69
Epoch 69/200 |loss: 9.054907| train set 5.008x speedup, test set 5.125x speedup, val set 0.762x speedup, step: 70
Epoch 70/200 |loss: 8.379550| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.543090| train set 5.008x speedup, test set 5.125x speedup, val set 0.957x speedup, step: 72
Epoch 72/200 |loss: 7.826068| train set 5.007x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 73
Epoch 73/200 |loss: 9.223351| train set 5.007x speedup, test set 8.560x speedup, val set 1.253x speedup, step: 74
Epoch 74/200 |loss: 9.409889| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 9.269747| train set 5.007x speedup, test set 6.681x speedup, val set 1.150x speedup, step: 76
Epoch 76/200 |loss: 7.209811| train set 4.916x speedup, test set 6.681x speedup, val set 1.006x speedup, step: 77
Epoch 77/200 |loss: 8.695878| train set 5.003x speedup, test set 4.387x speedup, val set 1.041x speedup, step: 78
Epoch 78/200 |loss: 9.456964| train set 5.003x speedup, test set 4.387x speedup, val set 1.041x speedup, step: 79
Epoch 79/200 |loss: 9.088120| train set 4.917x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 80
Epoch 80/200 |loss: 7.701233| train set 5.008x speedup, test set 6.836x speedup, val set 1.033x speedup, step: 81
Epoch 81/200 |loss: 10.517653| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 9.185889| train set 5.004x speedup, test set 4.387x speedup, val set 0.813x speedup, step: 83
Epoch 83/200 |loss: 9.104227| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 84
Epoch 84/200 |loss: 9.303848| train set 5.008x speedup, test set 1.476x speedup, val set 1.033x speedup, step: 85
Epoch 85/200 |loss: 8.363502| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 86
Epoch 86/200 |loss: 8.789532| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 87
Epoch 87/200 |loss: 9.714402| train set 5.008x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 88
Epoch 88/200 |loss: 7.757386| train set 5.008x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 89
Epoch 89/200 |loss: 8.431514| train set 4.868x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 90
Epoch 90/200 |loss: 8.767129| train set 4.958x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.677258| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.419904| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 93
Epoch 93/200 |loss: 9.362670| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 94
Epoch 94/200 |loss: 8.432429| train set 5.008x speedup, test set 6.836x speedup, val set 1.033x speedup, step: 95
Epoch 95/200 |loss: 9.004211| train set 4.957x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 96
Epoch 96/200 |loss: 9.229159| train set 4.958x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 97
Epoch 97/200 |loss: 8.938016| train set 4.958x speedup, test set 4.387x speedup, val set 1.006x speedup, step: 98
Epoch 98/200 |loss: 8.683794| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 99
Epoch 99/200 |loss: 9.389029| train set 5.008x speedup, test set 6.681x speedup, val set 0.980x speedup, step: 100
Epoch 100/200 |loss: 8.862337| train set 5.008x speedup, test set 4.387x speedup, val set 0.980x speedup, step: 1
Epoch 101/200 |loss: 9.908713| train set 4.715x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 1
Epoch 102/200 |loss: 8.797138| train set 5.008x speedup, test set 6.836x speedup, val set 1.006x speedup, step: 2
Epoch 103/200 |loss: 9.186380| train set 5.004x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 3
Epoch 104/200 |loss: 8.490878| train set 4.920x speedup, test set 5.125x speedup, val set 0.990x speedup, step: 4
Epoch 105/200 |loss: 7.481619| train set 5.007x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.263124| train set 5.007x speedup, test set 7.760x speedup, val set 1.302x speedup, step: 1
Epoch 107/200 |loss: 8.742701| train set 5.007x speedup, test set 6.681x speedup, val set 0.879x speedup, step: 2
Epoch 108/200 |loss: 8.177018| train set 5.007x speedup, test set 4.387x speedup, val set 0.902x speedup, step: 3
Epoch 109/200 |loss: 9.314871| train set 5.008x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 4
Epoch 110/200 |loss: 7.517935| train set 4.958x speedup, test set 6.681x speedup, val set 0.980x speedup, step: 5
Epoch 111/200 |loss: 9.053770| train set 4.958x speedup, test set 4.387x speedup, val set 1.006x speedup, step: 6
Epoch 112/200 |loss: 9.358782| train set 5.008x speedup, test set 4.387x speedup, val set 0.980x speedup, step: 7
Epoch 113/200 |loss: 8.919312| train set 5.008x speedup, test set 4.387x speedup, val set 0.980x speedup, step: 8
Epoch 114/200 |loss: 9.598669| train set 5.008x speedup, test set 4.387x speedup, val set 1.228x speedup, step: 9
Epoch 115/200 |loss: 7.905137| train set 5.008x speedup, test set 4.387x speedup, val set 1.149x speedup, step: 10
Epoch 116/200 |loss: 8.014392| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 11
Epoch 117/200 |loss: 9.909039| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 12
Epoch 118/200 |loss: 8.865784| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 13
Epoch 119/200 |loss: 8.584533| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 14
Epoch 120/200 |loss: 9.661195| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 15
Epoch 121/200 |loss: 8.383537| train set 4.958x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 1
Epoch 122/200 |loss: 8.553120| train set 4.958x speedup, test set 5.125x speedup, val set 1.302x speedup, step: 1
Epoch 123/200 |loss: 6.969551| train set 4.873x speedup, test set 5.125x speedup, val set 0.795x speedup, step: 2
Epoch 124/200 |loss: 8.988436| train set 4.920x speedup, test set 4.387x speedup, val set 0.786x speedup, step: 3
Epoch 125/200 |loss: 9.357688| train set 5.007x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 4
Epoch 126/200 |loss: 10.415296| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 5
Epoch 127/200 |loss: 8.962179| train set 5.007x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 6
Epoch 128/200 |loss: 9.513391| train set 5.007x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 7
Epoch 129/200 |loss: 8.554814| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 8
Epoch 130/200 |loss: 9.372854| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 9
Epoch 131/200 |loss: 8.750643| train set 4.958x speedup, test set 5.161x speedup, val set 0.742x speedup, step: 10
Epoch 132/200 |loss: 9.081023| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 11
Epoch 133/200 |loss: 7.760124| train set 4.958x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 12
Epoch 134/200 |loss: 6.931312| train set 4.958x speedup, test set 4.387x speedup, val set 0.780x speedup, step: 13
Epoch 135/200 |loss: 8.639370| train set 5.008x speedup, test set 4.387x speedup, val set 0.739x speedup, step: 14
Epoch 136/200 |loss: 7.471839| train set 5.008x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 15
Epoch 137/200 |loss: 8.652060| train set 5.008x speedup, test set 6.681x speedup, val set 0.980x speedup, step: 16
Epoch 138/200 |loss: 9.641129| train set 5.008x speedup, test set 6.681x speedup, val set 1.041x speedup, step: 17
Epoch 139/200 |loss: 9.010092| train set 4.715x speedup, test set 6.681x speedup, val set 0.988x speedup, step: 18
Epoch 140/200 |loss: 7.920421| train set 4.958x speedup, test set 6.681x speedup, val set 1.014x speedup, step: 19
Epoch 141/200 |loss: 8.415349| train set 4.958x speedup, test set 6.681x speedup, val set 1.006x speedup, step: 20
Epoch 142/200 |loss: 8.584733| train set 4.873x speedup, test set 6.681x speedup, val set 0.868x speedup, step: 21
Epoch 143/200 |loss: 9.192513| train set 4.958x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 22
Epoch 144/200 |loss: 8.764096| train set 4.957x speedup, test set 4.387x speedup, val set 1.228x speedup, step: 23
Epoch 145/200 |loss: 9.445002| train set 4.920x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 24
Epoch 146/200 |loss: 9.253215| train set 4.920x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 25
Epoch 147/200 |loss: 9.430794| train set 4.920x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 148/200 |loss: 8.230314| train set 5.007x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 8.859056| train set 5.007x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 2
Epoch 150/200 |loss: 9.528163| train set 5.007x speedup, test set 4.387x speedup, val set 0.968x speedup, step: 3
Epoch 151/200 |loss: 8.753842| train set 4.915x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 4
Epoch 152/200 |loss: 7.619054| train set 4.921x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 5
Epoch 153/200 |loss: 9.710253| train set 4.921x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 6
Epoch 154/200 |loss: 8.973074| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 7
Epoch 155/200 |loss: 9.306579| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 8
Epoch 156/200 |loss: 8.652275| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 9
Epoch 157/200 |loss: 9.040021| train set 4.958x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 10
Epoch 158/200 |loss: 10.497883| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 11
Epoch 159/200 |loss: 7.671583| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 12
Epoch 160/200 |loss: 7.706099| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 13
Epoch 161/200 |loss: 9.317972| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 14
Epoch 162/200 |loss: 8.043774| train set 5.008x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 15
Epoch 163/200 |loss: 7.491415| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 16
Epoch 164/200 |loss: 8.898335| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 17
Epoch 165/200 |loss: 8.012158| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 18
Epoch 166/200 |loss: 8.878793| train set 4.921x speedup, test set 6.681x speedup, val set 0.839x speedup, step: 19
Epoch 167/200 |loss: 9.522280| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 20
Epoch 168/200 |loss: 8.800925| train set 4.957x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 169/200 |loss: 8.313759| train set 4.958x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 170/200 |loss: 8.782417| train set 4.873x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 2
Epoch 171/200 |loss: 9.504016| train set 4.873x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 3
Epoch 172/200 |loss: 9.811652| train set 4.873x speedup, test set 6.681x speedup, val set 0.798x speedup, step: 4
Epoch 173/200 |loss: 8.099436| train set 4.957x speedup, test set 6.681x speedup, val set 1.160x speedup, step: 5
Epoch 174/200 |loss: 8.822340| train set 4.920x speedup, test set 6.681x speedup, val set 0.786x speedup, step: 6
Epoch 175/200 |loss: 9.919942| train set 4.920x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 9.015655| train set 5.007x speedup, test set 6.681x speedup, val set 0.746x speedup, step: 8
Epoch 177/200 |loss: 8.591162| train set 4.957x speedup, test set 6.681x speedup, val set 0.806x speedup, step: 9
Epoch 178/200 |loss: 9.137276| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 10
Epoch 179/200 |loss: 8.510226| train set 5.004x speedup, test set 6.681x speedup, val set 0.786x speedup, step: 11
Epoch 180/200 |loss: 9.062095| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 12
Epoch 181/200 |loss: 8.575514| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 13
Epoch 182/200 |loss: 9.252417| train set 4.870x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 14
Epoch 183/200 |loss: 8.413195| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 15
Epoch 184/200 |loss: 7.373226| train set 4.967x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 16
Epoch 185/200 |loss: 8.456165| train set 5.007x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 17
Epoch 186/200 |loss: 8.746785| train set 5.007x speedup, test set 6.681x speedup, val set 0.819x speedup, step: 18
Epoch 187/200 |loss: 8.228236| train set 4.753x speedup, test set 6.681x speedup, val set 1.241x speedup, step: 19
Epoch 188/200 |loss: 8.300501| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 20
Epoch 189/200 |loss: 8.551632| train set 5.007x speedup, test set 6.495x speedup, val set 0.742x speedup, step: 21
Epoch 190/200 |loss: 8.648832| train set 5.008x speedup, test set 6.495x speedup, val set 0.742x speedup, step: 22
Epoch 191/200 |loss: 7.748627| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 23
Epoch 192/200 |loss: 9.907311| train set 4.921x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 24
Epoch 193/200 |loss: 9.140813| train set 4.921x speedup, test set 6.681x speedup, val set 0.762x speedup, step: 25
Epoch 194/200 |loss: 9.586601| train set 4.917x speedup, test set 6.681x speedup, val set 0.990x speedup, step: 26
Epoch 195/200 |loss: 7.603788| train set 4.958x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 27
Epoch 196/200 |loss: 8.530474| train set 4.958x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 28
Epoch 197/200 |loss: 8.838373| train set 4.954x speedup, test set 6.681x speedup, val set 0.826x speedup, step: 29
Epoch 198/200 |loss: 9.311587| train set 4.954x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 30
Epoch 199/200 |loss: 7.507667| train set 5.008x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 31
Training per epoch cost 0.320 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 18.392s, pg runtime 18.392s, speedup 1.000x
02, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
03, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
04, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
05, opt runtime 14.857s, model runtime 14.857s, pg runtime 14.857s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 15.831s, model runtime 15.831s, pg runtime 15.831s, speedup 1.000x
08, opt runtime 9.432s, model runtime 9.432s, pg runtime 9.432s, speedup 1.000x
09, opt runtime 26.874s, model runtime 26.874s, pg runtime 26.874s, speedup 1.000x
10, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 24, train speedup 5.008, test speedup 5.125, val speedup 0.729
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 169, train speedup 4.958, test speedup 6.681, val speedup 1.316
last model at epoch 199, train speedup 5.008, test speedup 6.681, val speedup 0.804
execution cost 0:02:32.550602
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.369382, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281973| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286848| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.794130| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.084898| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.898477| train set 3.146x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588909| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.621384| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.479299| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.773631| train set 3.958x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.428034| train set 4.286x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.939297| train set 4.630x speedup, test set 8.560x speedup, val set 1.072x speedup, step: 14
Epoch 14/200 |loss: 14.082239| train set 4.630x speedup, test set 1.484x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.129064| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.687872| train set 4.631x speedup, test set 1.484x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.550585| train set 4.630x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.241062| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 19
Epoch 19/200 |loss: 9.978879| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 20
Epoch 20/200 |loss: 12.419351| train set 4.631x speedup, test set 8.560x speedup, val set 0.965x speedup, step: 21
Epoch 21/200 |loss: 11.773197| train set 5.008x speedup, test set 1.484x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.368786| train set 5.007x speedup, test set 8.560x speedup, val set 1.063x speedup, step: 23
Epoch 23/200 |loss: 10.918234| train set 5.007x speedup, test set 8.028x speedup, val set 1.041x speedup, step: 24
Epoch 24/200 |loss: 11.840428| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.749595| train set 4.958x speedup, test set 8.260x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.832108| train set 4.958x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 12.351112| train set 4.958x speedup, test set 5.125x speedup, val set 0.965x speedup, step: 28
Epoch 28/200 |loss: 10.334249| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 10.168999| train set 5.008x speedup, test set 8.560x speedup, val set 0.775x speedup, step: 30
Epoch 30/200 |loss: 10.803915| train set 5.008x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 10.986999| train set 4.958x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.582151| train set 4.709x speedup, test set 8.560x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 10.422958| train set 4.957x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.136221| train set 4.847x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 12.897771| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 11.969280| train set 4.957x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.700219| train set 5.008x speedup, test set 6.836x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 9.673223| train set 5.008x speedup, test set 4.453x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 10.611495| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.104313| train set 5.008x speedup, test set 6.681x speedup, val set 1.041x speedup, step: 41
Epoch 41/200 |loss: 11.143627| train set 4.921x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.533003| train set 4.921x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 43
Epoch 43/200 |loss: 10.863716| train set 4.630x speedup, test set 4.387x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.936241| train set 4.957x speedup, test set 4.387x speedup, val set 1.041x speedup, step: 45
Epoch 45/200 |loss: 10.042168| train set 4.754x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 11.009700| train set 4.754x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 47
Epoch 47/200 |loss: 10.672273| train set 4.674x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.939717| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 10.790051| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.848708| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 10.113277| train set 5.008x speedup, test set 4.871x speedup, val set 0.994x speedup, step: 52
Epoch 52/200 |loss: 10.778933| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 9.198447| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.992159| train set 4.670x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.759084| train set 4.958x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 9.017862| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.010315| train set 5.008x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.217578| train set 5.008x speedup, test set 5.125x speedup, val set 1.133x speedup, step: 59
Epoch 59/200 |loss: 8.706181| train set 5.007x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 60
Epoch 60/200 |loss: 9.284664| train set 5.008x speedup, test set 4.387x speedup, val set 0.775x speedup, step: 61
Epoch 61/200 |loss: 10.242092| train set 4.958x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 8.021051| train set 4.869x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 63
Epoch 63/200 |loss: 8.656523| train set 4.872x speedup, test set 4.387x speedup, val set 0.957x speedup, step: 64
Epoch 64/200 |loss: 8.298274| train set 4.920x speedup, test set 4.387x speedup, val set 0.798x speedup, step: 65
Epoch 65/200 |loss: 8.791109| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 66
Epoch 66/200 |loss: 9.721074| train set 5.008x speedup, test set 4.387x speedup, val set 0.787x speedup, step: 67
Epoch 67/200 |loss: 7.386545| train set 5.008x speedup, test set 6.293x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.132078| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.108656| train set 4.674x speedup, test set 4.453x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.457405| train set 5.008x speedup, test set 8.028x speedup, val set 0.825x speedup, step: 71
Epoch 71/200 |loss: 9.422018| train set 5.008x speedup, test set 8.028x speedup, val set 1.033x speedup, step: 72
Epoch 72/200 |loss: 7.989529| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 73
Epoch 73/200 |loss: 8.956372| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 74
Epoch 74/200 |loss: 9.439580| train set 5.007x speedup, test set 6.214x speedup, val set 1.268x speedup, step: 75
Epoch 75/200 |loss: 8.777684| train set 4.957x speedup, test set 6.214x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.238505| train set 4.921x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.393824| train set 5.007x speedup, test set 4.387x speedup, val set 0.957x speedup, step: 78
Epoch 78/200 |loss: 9.087397| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.807364| train set 4.917x speedup, test set 5.125x speedup, val set 1.006x speedup, step: 80
Epoch 80/200 |loss: 7.567719| train set 4.921x speedup, test set 5.125x speedup, val set 1.073x speedup, step: 81
Epoch 81/200 |loss: 10.221264| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 8.824191| train set 5.008x speedup, test set 4.387x speedup, val set 0.980x speedup, step: 83
Epoch 83/200 |loss: 8.513814| train set 5.008x speedup, test set 6.353x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 9.005694| train set 4.921x speedup, test set 8.028x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.010272| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.838643| train set 5.008x speedup, test set 4.387x speedup, val set 0.934x speedup, step: 87
Epoch 87/200 |loss: 9.613337| train set 5.008x speedup, test set 4.387x speedup, val set 0.934x speedup, step: 88
Epoch 88/200 |loss: 7.794040| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 89
Epoch 89/200 |loss: 8.138375| train set 4.958x speedup, test set 4.387x speedup, val set 0.775x speedup, step: 90
Epoch 90/200 |loss: 8.690300| train set 5.008x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.576180| train set 5.008x speedup, test set 6.681x speedup, val set 0.957x speedup, step: 92
Epoch 92/200 |loss: 8.274953| train set 5.008x speedup, test set 6.353x speedup, val set 1.133x speedup, step: 93
Epoch 93/200 |loss: 9.015625| train set 5.008x speedup, test set 6.353x speedup, val set 1.133x speedup, step: 94
Epoch 94/200 |loss: 8.319493| train set 5.008x speedup, test set 6.353x speedup, val set 0.882x speedup, step: 95
Epoch 95/200 |loss: 8.942323| train set 4.958x speedup, test set 4.387x speedup, val set 0.934x speedup, step: 96
Epoch 96/200 |loss: 9.128416| train set 4.958x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 97
Epoch 97/200 |loss: 8.911007| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.635606| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 99
Epoch 99/200 |loss: 9.697491| train set 5.008x speedup, test set 6.353x speedup, val set 0.735x speedup, step: 100
Epoch 100/200 |loss: 9.351872| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 101
Epoch 101/200 |loss: 10.163095| train set 4.715x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 1
Epoch 102/200 |loss: 9.048890| train set 4.958x speedup, test set 6.353x speedup, val set 1.268x speedup, step: 1
Epoch 103/200 |loss: 9.378239| train set 4.917x speedup, test set 6.353x speedup, val set 0.868x speedup, step: 2
Epoch 104/200 |loss: 8.692961| train set 4.921x speedup, test set 4.387x speedup, val set 0.806x speedup, step: 3
Epoch 105/200 |loss: 7.647280| train set 5.007x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.249226| train set 5.007x speedup, test set 6.353x speedup, val set 0.994x speedup, step: 2
Epoch 107/200 |loss: 8.881172| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 3
Epoch 108/200 |loss: 8.011499| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 4
Epoch 109/200 |loss: 9.205581| train set 5.008x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 5
Epoch 110/200 |loss: 7.478163| train set 5.005x speedup, test set 6.353x speedup, val set 1.006x speedup, step: 6
Epoch 111/200 |loss: 8.550893| train set 5.004x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 7
Epoch 112/200 |loss: 9.347811| train set 4.958x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 8
Epoch 113/200 |loss: 8.675765| train set 5.008x speedup, test set 6.353x speedup, val set 0.980x speedup, step: 9
Epoch 114/200 |loss: 9.281413| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 10
Epoch 115/200 |loss: 8.199705| train set 5.008x speedup, test set 4.387x speedup, val set 0.798x speedup, step: 11
Epoch 116/200 |loss: 8.024445| train set 4.958x speedup, test set 6.353x speedup, val set 1.133x speedup, step: 12
Epoch 117/200 |loss: 9.911855| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 13
Epoch 118/200 |loss: 9.171201| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 14
Epoch 119/200 |loss: 9.046380| train set 5.008x speedup, test set 6.353x speedup, val set 0.742x speedup, step: 15
Epoch 120/200 |loss: 9.678703| train set 5.008x speedup, test set 5.826x speedup, val set 1.165x speedup, step: 16
Epoch 121/200 |loss: 8.461025| train set 4.921x speedup, test set 4.387x speedup, val set 1.228x speedup, step: 17
Epoch 122/200 |loss: 8.429129| train set 4.958x speedup, test set 6.353x speedup, val set 1.302x speedup, step: 1
Epoch 123/200 |loss: 7.089756| train set 4.958x speedup, test set 4.387x speedup, val set 1.228x speedup, step: 2
Epoch 124/200 |loss: 9.193404| train set 4.921x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 3
Epoch 125/200 |loss: 9.335238| train set 5.008x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 4
Epoch 126/200 |loss: 10.159896| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 5
Epoch 127/200 |loss: 8.816529| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 6
Epoch 128/200 |loss: 9.471930| train set 5.007x speedup, test set 6.353x speedup, val set 0.742x speedup, step: 7
Epoch 129/200 |loss: 8.396539| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 8
Epoch 130/200 |loss: 9.287958| train set 5.008x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 9
Epoch 131/200 |loss: 9.106059| train set 5.008x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 10
Epoch 132/200 |loss: 9.346775| train set 4.958x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 11
Epoch 133/200 |loss: 7.742127| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 12
Epoch 134/200 |loss: 7.053175| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 13
Epoch 135/200 |loss: 8.729481| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 14
Epoch 136/200 |loss: 7.631631| train set 5.002x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 15
Epoch 137/200 |loss: 8.647222| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 16
Epoch 138/200 |loss: 9.649366| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 17
Epoch 139/200 |loss: 9.173794| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 18
Epoch 140/200 |loss: 8.024952| train set 4.958x speedup, test set 6.353x speedup, val set 0.798x speedup, step: 19
Epoch 141/200 |loss: 8.463419| train set 4.958x speedup, test set 6.353x speedup, val set 0.934x speedup, step: 20
Epoch 142/200 |loss: 8.786714| train set 4.921x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 21
Epoch 143/200 |loss: 9.094317| train set 4.921x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 22
Epoch 144/200 |loss: 8.626770| train set 4.957x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 23
Epoch 145/200 |loss: 9.505215| train set 4.957x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 24
Epoch 146/200 |loss: 9.170375| train set 4.920x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 25
Epoch 147/200 |loss: 9.513330| train set 4.872x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 26
Epoch 148/200 |loss: 8.237636| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 27
Epoch 149/200 |loss: 8.755779| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 28
Epoch 150/200 |loss: 9.652288| train set 5.007x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 29
Epoch 151/200 |loss: 8.856661| train set 4.920x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 30
Epoch 152/200 |loss: 7.544989| train set 4.921x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 31
Epoch 153/200 |loss: 9.764554| train set 4.921x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 32
Epoch 154/200 |loss: 8.884840| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 33
Epoch 155/200 |loss: 9.252825| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 34
Epoch 156/200 |loss: 8.921041| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 35
Epoch 157/200 |loss: 9.286022| train set 4.958x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 36
Epoch 158/200 |loss: 10.478800| train set 4.921x speedup, test set 6.353x speedup, val set 0.735x speedup, step: 37
Epoch 159/200 |loss: 7.953053| train set 5.005x speedup, test set 6.353x speedup, val set 0.742x speedup, step: 38
Epoch 160/200 |loss: 7.818275| train set 5.008x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 39
Epoch 161/200 |loss: 9.323041| train set 5.008x speedup, test set 5.161x speedup, val set 0.729x speedup, step: 40
Epoch 162/200 |loss: 8.040114| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 41
Epoch 163/200 |loss: 7.950716| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 42
Epoch 164/200 |loss: 8.873641| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 43
Epoch 165/200 |loss: 8.124382| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 44
Epoch 166/200 |loss: 9.124546| train set 5.008x speedup, test set 5.826x speedup, val set 0.729x speedup, step: 45
Epoch 167/200 |loss: 9.340109| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 46
Epoch 168/200 |loss: 8.898583| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 47
Epoch 169/200 |loss: 8.370642| train set 4.958x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 48
Epoch 170/200 |loss: 8.625962| train set 4.873x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 49
Epoch 171/200 |loss: 9.332386| train set 4.873x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 50
Epoch 172/200 |loss: 9.625830| train set 4.873x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 51
Epoch 173/200 |loss: 8.081067| train set 4.957x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 52
Epoch 174/200 |loss: 8.670779| train set 4.920x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 53
Epoch 175/200 |loss: 9.661757| train set 4.920x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 54
Epoch 176/200 |loss: 9.196102| train set 4.920x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 55
Epoch 177/200 |loss: 8.370433| train set 4.957x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 56
Epoch 178/200 |loss: 9.158992| train set 4.957x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 57
Epoch 179/200 |loss: 8.570806| train set 4.954x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 58
Epoch 180/200 |loss: 9.181765| train set 4.950x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 59
Epoch 181/200 |loss: 8.515987| train set 4.958x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 60
Epoch 182/200 |loss: 9.305540| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 61
Epoch 183/200 |loss: 8.209209| train set 4.958x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 62
Epoch 184/200 |loss: 7.350442| train set 4.921x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 63
Epoch 185/200 |loss: 8.458892| train set 5.004x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 64
Epoch 186/200 |loss: 8.942973| train set 5.007x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 65
Epoch 187/200 |loss: 8.441803| train set 5.007x speedup, test set 6.353x speedup, val set 0.934x speedup, step: 66
Epoch 188/200 |loss: 8.156844| train set 5.007x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 67
Epoch 189/200 |loss: 8.657103| train set 5.008x speedup, test set 6.353x speedup, val set 0.742x speedup, step: 68
Epoch 190/200 |loss: 8.660326| train set 5.008x speedup, test set 6.353x speedup, val set 0.735x speedup, step: 69
Epoch 191/200 |loss: 7.904161| train set 5.008x speedup, test set 6.353x speedup, val set 0.729x speedup, step: 70
Epoch 192/200 |loss: 9.773791| train set 4.921x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 71
Epoch 193/200 |loss: 9.258226| train set 4.921x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 72
Epoch 194/200 |loss: 9.556468| train set 4.913x speedup, test set 5.161x speedup, val set 0.955x speedup, step: 73
Epoch 195/200 |loss: 7.535894| train set 5.008x speedup, test set 5.161x speedup, val set 1.211x speedup, step: 74
Epoch 196/200 |loss: 8.634170| train set 4.958x speedup, test set 5.161x speedup, val set 0.769x speedup, step: 75
Epoch 197/200 |loss: 8.850608| train set 4.954x speedup, test set 4.387x speedup, val set 0.786x speedup, step: 76
Epoch 198/200 |loss: 9.096939| train set 4.954x speedup, test set 4.387x speedup, val set 0.804x speedup, step: 77
Epoch 199/200 |loss: 7.442981| train set 4.958x speedup, test set 6.353x speedup, val set 0.742x speedup, step: 78
Training per epoch cost 0.318 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 19.666s, pg runtime 18.392s, speedup 0.935x
02, opt runtime 23.961s, model runtime 23.961s, pg runtime 32.278s, speedup 1.347x
03, opt runtime 17.779s, model runtime 30.406s, pg runtime 17.779s, speedup 0.585x
04, opt runtime 25.597s, model runtime 25.597s, pg runtime 27.136s, speedup 1.060x
05, opt runtime 14.857s, model runtime 22.665s, pg runtime 14.857s, speedup 0.656x
06, opt runtime 19.263s, model runtime 30.418s, pg runtime 19.263s, speedup 0.633x
07, opt runtime 15.831s, model runtime 20.790s, pg runtime 15.831s, speedup 0.761x
08, opt runtime 9.432s, model runtime 23.132s, pg runtime 9.432s, speedup 0.408x
09, opt runtime 26.874s, model runtime 27.594s, pg runtime 26.874s, speedup 0.974x
10, opt runtime 21.143s, model runtime 24.476s, pg runtime 21.143s, speedup 0.864x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 1.484, val speedup 0.729
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 122, train speedup 4.958, test speedup 6.353, val speedup 1.302
last model at epoch 199, train speedup 4.958, test speedup 6.353, val speedup 0.742
execution cost 0:02:33.119043
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.304579, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793521| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089585| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912633| train set 3.193x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587202| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575415| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370783| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755564| train set 4.032x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455397| train set 4.285x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921761| train set 4.630x speedup, test set 8.560x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914977| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.108998| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590152| train set 4.630x speedup, test set 1.484x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591466| train set 4.670x speedup, test set 1.607x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213900| train set 5.008x speedup, test set 8.560x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153136| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.501279| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.032993| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.299732| train set 5.008x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.682239| train set 5.007x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.868335| train set 5.007x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.634884| train set 5.007x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.590439| train set 4.958x speedup, test set 5.125x speedup, val set 0.965x speedup, step: 27
Epoch 27/200 |loss: 12.321232| train set 4.958x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.397705| train set 5.008x speedup, test set 8.560x speedup, val set 0.965x speedup, step: 29
Epoch 29/200 |loss: 10.244299| train set 4.921x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.696766| train set 4.958x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.444625| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.819840| train set 4.708x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 10.917625| train set 4.630x speedup, test set 6.214x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.388560| train set 4.714x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 12.909698| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.476728| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.842568| train set 5.008x speedup, test set 8.028x speedup, val set 1.033x speedup, step: 38
Epoch 38/200 |loss: 9.912586| train set 4.715x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.600950| train set 5.008x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.237547| train set 4.958x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 10.916718| train set 4.921x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.286131| train set 4.921x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.169090| train set 4.630x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.593389| train set 4.709x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.061073| train set 4.632x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 46
Epoch 46/200 |loss: 10.617412| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 10.046567| train set 4.674x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.805604| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 9.884761| train set 4.921x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.533147| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 10.010614| train set 4.958x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.596513| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 53
Epoch 53/200 |loss: 8.831200| train set 4.921x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 54
Epoch 54/200 |loss: 9.153940| train set 4.715x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.698071| train set 4.958x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 9.076118| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 57
Epoch 57/200 |loss: 10.080567| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 58
Epoch 58/200 |loss: 9.499522| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.706320| train set 5.007x speedup, test set 6.681x speedup, val set 1.053x speedup, step: 60
Epoch 60/200 |loss: 9.374530| train set 5.007x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 61
Epoch 61/200 |loss: 10.462715| train set 4.958x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 7.975306| train set 4.871x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 63
Epoch 63/200 |loss: 8.736299| train set 4.869x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.420289| train set 5.003x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 65
Epoch 65/200 |loss: 8.908052| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.968130| train set 5.008x speedup, test set 8.560x speedup, val set 1.006x speedup, step: 67
Epoch 67/200 |loss: 7.561115| train set 4.999x speedup, test set 6.681x speedup, val set 0.980x speedup, step: 68
Epoch 68/200 |loss: 9.420086| train set 5.008x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 69
Epoch 69/200 |loss: 9.312400| train set 4.958x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 70
Epoch 70/200 |loss: 8.477450| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 71
Epoch 71/200 |loss: 9.325580| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 72
Epoch 72/200 |loss: 7.959484| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 73
Epoch 73/200 |loss: 9.029279| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 8.994730| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.908592| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.138881| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.399128| train set 5.007x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 78
Epoch 78/200 |loss: 8.926479| train set 5.007x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.902062| train set 4.921x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 80
Epoch 80/200 |loss: 7.399159| train set 4.921x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.328288| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 8.808563| train set 5.008x speedup, test set 6.353x speedup, val set 1.041x speedup, step: 83
Epoch 83/200 |loss: 8.647275| train set 5.008x speedup, test set 6.681x speedup, val set 1.150x speedup, step: 84
Epoch 84/200 |loss: 8.997128| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.115337| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 86
Epoch 86/200 |loss: 8.681254| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 87
Epoch 87/200 |loss: 9.403493| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 7.649538| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 89
Epoch 89/200 |loss: 8.155117| train set 4.883x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 90
Epoch 90/200 |loss: 8.673457| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.535796| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.275001| train set 5.008x speedup, test set 6.681x speedup, val set 1.241x speedup, step: 93
Epoch 93/200 |loss: 9.046657| train set 5.008x speedup, test set 6.681x speedup, val set 1.006x speedup, step: 94
Epoch 94/200 |loss: 8.418801| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 95
Epoch 95/200 |loss: 8.801682| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 9.222157| train set 4.958x speedup, test set 6.681x speedup, val set 0.841x speedup, step: 97
Epoch 97/200 |loss: 9.085742| train set 5.008x speedup, test set 6.681x speedup, val set 0.968x speedup, step: 98
Epoch 98/200 |loss: 8.701388| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 99
Epoch 99/200 |loss: 9.429686| train set 5.008x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 100
Epoch 100/200 |loss: 9.388115| train set 4.921x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 1
Epoch 101/200 |loss: 10.078456| train set 4.663x speedup, test set 4.387x speedup, val set 1.133x speedup, step: 1
Epoch 102/200 |loss: 9.048919| train set 4.958x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 103/200 |loss: 9.864969| train set 5.003x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.937414| train set 4.917x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 3
Epoch 105/200 |loss: 7.981018| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 4
Epoch 106/200 |loss: 8.697156| train set 5.007x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 1
Epoch 107/200 |loss: 9.122355| train set 5.007x speedup, test set 6.681x speedup, val set 0.735x speedup, step: 2
Epoch 108/200 |loss: 8.098167| train set 5.008x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 3
Epoch 109/200 |loss: 9.410372| train set 5.008x speedup, test set 6.681x speedup, val set 0.968x speedup, step: 4
Epoch 110/200 |loss: 7.605366| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 5
Epoch 111/200 |loss: 8.798476| train set 4.958x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 6
Epoch 112/200 |loss: 9.417286| train set 5.005x speedup, test set 4.387x speedup, val set 0.864x speedup, step: 7
Epoch 113/200 |loss: 8.911200| train set 5.008x speedup, test set 6.681x speedup, val set 0.782x speedup, step: 8
Epoch 114/200 |loss: 9.567875| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 9
Epoch 115/200 |loss: 8.009123| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 10
Epoch 116/200 |loss: 8.076833| train set 5.008x speedup, test set 4.831x speedup, val set 1.133x speedup, step: 11
Epoch 117/200 |loss: 10.070624| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 12
Epoch 118/200 |loss: 8.806257| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 13
Epoch 119/200 |loss: 8.796097| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 14
Epoch 120/200 |loss: 9.764373| train set 5.008x speedup, test set 6.681x speedup, val set 0.813x speedup, step: 15
Epoch 121/200 |loss: 8.442037| train set 4.921x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 16
Epoch 122/200 |loss: 8.579480| train set 4.958x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 17
Epoch 123/200 |loss: 6.945543| train set 4.958x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 18
Epoch 124/200 |loss: 8.952888| train set 4.921x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 19
Epoch 125/200 |loss: 9.352948| train set 4.920x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 20
Epoch 126/200 |loss: 9.839546| train set 5.007x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 21
Epoch 127/200 |loss: 8.758337| train set 5.007x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 22
Epoch 128/200 |loss: 9.326690| train set 5.007x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 23
Epoch 129/200 |loss: 8.208869| train set 5.008x speedup, test set 6.681x speedup, val set 0.770x speedup, step: 24
Epoch 130/200 |loss: 9.225033| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 25
Epoch 131/200 |loss: 8.710887| train set 4.958x speedup, test set 6.681x speedup, val set 1.149x speedup, step: 26
Epoch 132/200 |loss: 8.937802| train set 4.705x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 27
Epoch 133/200 |loss: 7.697382| train set 4.706x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 28
Epoch 134/200 |loss: 6.969558| train set 4.958x speedup, test set 4.387x speedup, val set 1.149x speedup, step: 29
Epoch 135/200 |loss: 8.469114| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 30
Epoch 136/200 |loss: 7.685722| train set 5.008x speedup, test set 6.681x speedup, val set 0.795x speedup, step: 31
Epoch 137/200 |loss: 8.269113| train set 5.008x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 32
Epoch 138/200 |loss: 9.508987| train set 5.008x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 33
Epoch 139/200 |loss: 9.131394| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 34
Epoch 140/200 |loss: 8.103749| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 35
Epoch 141/200 |loss: 8.280862| train set 4.989x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 36
Epoch 142/200 |loss: 8.952151| train set 4.921x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 37
Epoch 143/200 |loss: 9.210259| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 38
Epoch 144/200 |loss: 8.815364| train set 4.957x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 39
Epoch 145/200 |loss: 9.605772| train set 4.872x speedup, test set 4.387x speedup, val set 1.228x speedup, step: 40
Epoch 146/200 |loss: 9.324669| train set 4.920x speedup, test set 4.387x speedup, val set 0.990x speedup, step: 41
Epoch 147/200 |loss: 9.842882| train set 5.007x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 42
Epoch 148/200 |loss: 8.241509| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 43
Epoch 149/200 |loss: 8.759571| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 44
Epoch 150/200 |loss: 9.582290| train set 4.920x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 45
Epoch 151/200 |loss: 8.842891| train set 4.916x speedup, test set 6.681x speedup, val set 0.836x speedup, step: 46
Epoch 152/200 |loss: 7.710382| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 47
Epoch 153/200 |loss: 9.514224| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 48
Epoch 154/200 |loss: 9.174143| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 49
Epoch 155/200 |loss: 9.216247| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 50
Epoch 156/200 |loss: 8.765812| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 51
Epoch 157/200 |loss: 9.154107| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 52
Epoch 158/200 |loss: 10.356159| train set 4.921x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 53
Epoch 159/200 |loss: 7.698054| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 54
Epoch 160/200 |loss: 7.722852| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 55
Epoch 161/200 |loss: 9.204267| train set 4.999x speedup, test set 6.681x speedup, val set 0.990x speedup, step: 56
Epoch 162/200 |loss: 7.970009| train set 5.008x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 57
Epoch 163/200 |loss: 7.669025| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 58
Epoch 164/200 |loss: 8.702402| train set 5.008x speedup, test set 6.681x speedup, val set 1.149x speedup, step: 59
Epoch 165/200 |loss: 7.901277| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 60
Epoch 166/200 |loss: 9.089670| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 61
Epoch 167/200 |loss: 9.582445| train set 4.920x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 62
Epoch 168/200 |loss: 8.869517| train set 4.957x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 63
Epoch 169/200 |loss: 8.332935| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 64
Epoch 170/200 |loss: 8.609384| train set 4.873x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 65
Epoch 171/200 |loss: 9.271271| train set 4.873x speedup, test set 6.535x speedup, val set 1.165x speedup, step: 66
Epoch 172/200 |loss: 9.768531| train set 4.873x speedup, test set 5.360x speedup, val set 1.228x speedup, step: 67
Epoch 173/200 |loss: 8.172909| train set 4.957x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 68
Epoch 174/200 |loss: 8.730383| train set 4.957x speedup, test set 6.535x speedup, val set 1.165x speedup, step: 69
Epoch 175/200 |loss: 9.863573| train set 4.917x speedup, test set 6.681x speedup, val set 0.836x speedup, step: 70
Epoch 176/200 |loss: 8.954473| train set 4.917x speedup, test set 6.681x speedup, val set 0.836x speedup, step: 71
Epoch 177/200 |loss: 8.253922| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 72
Epoch 178/200 |loss: 8.923372| train set 4.958x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 73
Epoch 179/200 |loss: 8.414442| train set 4.958x speedup, test set 6.681x speedup, val set 0.944x speedup, step: 74
Epoch 180/200 |loss: 8.901435| train set 4.958x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 75
Epoch 181/200 |loss: 8.352278| train set 4.958x speedup, test set 4.387x speedup, val set 0.804x speedup, step: 76
Epoch 182/200 |loss: 9.244785| train set 4.958x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 77
Epoch 183/200 |loss: 8.435254| train set 4.958x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 78
Epoch 184/200 |loss: 7.435721| train set 5.008x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 79
Epoch 185/200 |loss: 8.598433| train set 5.008x speedup, test set 6.681x speedup, val set 0.990x speedup, step: 80
Epoch 186/200 |loss: 8.916895| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 81
Epoch 187/200 |loss: 8.578591| train set 5.007x speedup, test set 6.681x speedup, val set 1.241x speedup, step: 82
Epoch 188/200 |loss: 8.498894| train set 5.007x speedup, test set 6.681x speedup, val set 1.228x speedup, step: 83
Epoch 189/200 |loss: 8.630721| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 84
Epoch 190/200 |loss: 8.513342| train set 5.008x speedup, test set 6.681x speedup, val set 0.813x speedup, step: 85
Epoch 191/200 |loss: 7.747548| train set 4.921x speedup, test set 8.560x speedup, val set 0.777x speedup, step: 86
Epoch 192/200 |loss: 9.841408| train set 4.921x speedup, test set 8.560x speedup, val set 0.813x speedup, step: 87
Epoch 193/200 |loss: 9.113447| train set 4.921x speedup, test set 8.560x speedup, val set 0.868x speedup, step: 88
Epoch 194/200 |loss: 9.687153| train set 4.921x speedup, test set 8.560x speedup, val set 0.944x speedup, step: 89
Epoch 195/200 |loss: 7.620644| train set 4.958x speedup, test set 8.560x speedup, val set 1.165x speedup, step: 90
Epoch 196/200 |loss: 8.421186| train set 4.958x speedup, test set 8.560x speedup, val set 1.165x speedup, step: 91
Epoch 197/200 |loss: 8.808073| train set 4.958x speedup, test set 8.560x speedup, val set 0.990x speedup, step: 92
Epoch 198/200 |loss: 9.164299| train set 4.958x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 93
Epoch 199/200 |loss: 7.517787| train set 5.008x speedup, test set 6.681x speedup, val set 0.804x speedup, step: 94
Training per epoch cost 0.314 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 18.392s, pg runtime 18.392s, speedup 1.000x
02, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
03, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
04, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
05, opt runtime 14.857s, model runtime 14.857s, pg runtime 14.857s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 15.831s, model runtime 15.831s, pg runtime 15.831s, speedup 1.000x
08, opt runtime 9.432s, model runtime 9.432s, pg runtime 9.432s, speedup 1.000x
09, opt runtime 26.874s, model runtime 26.874s, pg runtime 26.874s, speedup 1.000x
10, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 8.560, val speedup 0.965
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 106, train speedup 5.007, test speedup 6.681, val speedup 1.316
last model at epoch 199, train speedup 5.008, test speedup 6.681, val speedup 0.804
execution cost 0:02:29.491093
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.253262, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377736| train set 2.795x speedup, test set 0.854x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 5.981x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 8.560x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 8.560x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793523| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912634| train set 3.193x speedup, test set 6.702x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587204| train set 3.349x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575417| train set 3.511x speedup, test set 1.484x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370786| train set 3.958x speedup, test set 8.560x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755566| train set 4.032x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455399| train set 4.285x speedup, test set 8.560x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921763| train set 4.630x speedup, test set 8.560x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914977| train set 4.630x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.109001| train set 4.895x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590155| train set 4.630x speedup, test set 1.484x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591467| train set 4.670x speedup, test set 1.607x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213896| train set 5.008x speedup, test set 8.560x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153136| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.501633| train set 4.958x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.035406| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.297973| train set 5.008x speedup, test set 1.476x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.687849| train set 5.007x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.883907| train set 5.007x speedup, test set 5.125x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.646014| train set 5.007x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.531389| train set 4.958x speedup, test set 5.125x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.331558| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.345014| train set 4.991x speedup, test set 8.560x speedup, val set 0.733x speedup, step: 29
Epoch 29/200 |loss: 10.292389| train set 4.921x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.726941| train set 5.008x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.463988| train set 4.958x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.677560| train set 4.708x speedup, test set 8.560x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 10.947875| train set 4.630x speedup, test set 8.560x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.315585| train set 4.670x speedup, test set 5.125x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 13.261767| train set 5.007x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.820981| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.757915| train set 5.008x speedup, test set 6.353x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 10.385283| train set 4.715x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 11.034798| train set 4.958x speedup, test set 5.125x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.455382| train set 4.958x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.052541| train set 4.812x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.526467| train set 4.921x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.056070| train set 4.631x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.294898| train set 4.958x speedup, test set 4.387x speedup, val set 1.041x speedup, step: 45
Epoch 45/200 |loss: 9.058827| train set 4.649x speedup, test set 4.387x speedup, val set 0.980x speedup, step: 46
Epoch 46/200 |loss: 10.424956| train set 4.709x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 9.912787| train set 4.630x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 48
Epoch 48/200 |loss: 9.548918| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 10.170800| train set 5.008x speedup, test set 8.560x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.414655| train set 5.008x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 51
Epoch 51/200 |loss: 9.911032| train set 4.958x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 52
Epoch 52/200 |loss: 10.494206| train set 4.812x speedup, test set 1.476x speedup, val set 0.957x speedup, step: 53
Epoch 53/200 |loss: 9.113569| train set 4.921x speedup, test set 4.387x speedup, val set 0.994x speedup, step: 54
Epoch 54/200 |loss: 9.135803| train set 4.715x speedup, test set 4.387x speedup, val set 1.041x speedup, step: 55
Epoch 55/200 |loss: 9.828866| train set 4.957x speedup, test set 5.147x speedup, val set 1.041x speedup, step: 56
Epoch 56/200 |loss: 9.053133| train set 5.008x speedup, test set 5.360x speedup, val set 1.033x speedup, step: 57
Epoch 57/200 |loss: 10.093093| train set 4.921x speedup, test set 3.776x speedup, val set 0.855x speedup, step: 58
Epoch 58/200 |loss: 9.681870| train set 5.007x speedup, test set 5.360x speedup, val set 1.268x speedup, step: 59
Epoch 59/200 |loss: 9.054622| train set 5.007x speedup, test set 5.360x speedup, val set 1.033x speedup, step: 60
Epoch 60/200 |loss: 9.381858| train set 5.008x speedup, test set 4.954x speedup, val set 0.957x speedup, step: 61
Epoch 61/200 |loss: 10.428111| train set 4.958x speedup, test set 5.360x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 8.157930| train set 4.958x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 63
Epoch 63/200 |loss: 8.644030| train set 4.917x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 64
Epoch 64/200 |loss: 8.431898| train set 4.921x speedup, test set 5.360x speedup, val set 1.006x speedup, step: 65
Epoch 65/200 |loss: 8.924926| train set 5.008x speedup, test set 5.360x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.896008| train set 5.008x speedup, test set 8.560x speedup, val set 1.228x speedup, step: 67
Epoch 67/200 |loss: 7.552113| train set 5.008x speedup, test set 8.560x speedup, val set 1.165x speedup, step: 68
Epoch 68/200 |loss: 9.240475| train set 5.008x speedup, test set 8.560x speedup, val set 1.302x speedup, step: 69
Epoch 69/200 |loss: 9.414154| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 70
Epoch 70/200 |loss: 8.447773| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 71
Epoch 71/200 |loss: 9.337164| train set 5.007x speedup, test set 6.681x speedup, val set 1.241x speedup, step: 72
Epoch 72/200 |loss: 7.828311| train set 5.007x speedup, test set 6.681x speedup, val set 1.281x speedup, step: 73
Epoch 73/200 |loss: 8.880794| train set 5.008x speedup, test set 6.681x speedup, val set 1.316x speedup, step: 74
Epoch 74/200 |loss: 9.022324| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.745117| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.023951| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 77
Epoch 77/200 |loss: 8.216035| train set 5.007x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 78
Epoch 78/200 |loss: 9.070197| train set 5.007x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.792078| train set 5.007x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 80
Epoch 80/200 |loss: 7.451068| train set 4.921x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.352533| train set 5.008x speedup, test set 6.353x speedup, val set 0.735x speedup, step: 82
Epoch 82/200 |loss: 8.859716| train set 5.004x speedup, test set 4.387x speedup, val set 0.770x speedup, step: 83
Epoch 83/200 |loss: 8.573175| train set 5.008x speedup, test set 5.147x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 9.058432| train set 5.008x speedup, test set 5.360x speedup, val set 1.211x speedup, step: 85
Epoch 85/200 |loss: 7.944878| train set 4.921x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.709672| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 87
Epoch 87/200 |loss: 9.473906| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 7.685815| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 89
Epoch 89/200 |loss: 8.134598| train set 4.958x speedup, test set 6.495x speedup, val set 1.014x speedup, step: 90
Epoch 90/200 |loss: 8.820362| train set 5.008x speedup, test set 6.681x speedup, val set 1.041x speedup, step: 91
Epoch 91/200 |loss: 8.615435| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.383779| train set 5.008x speedup, test set 6.681x speedup, val set 1.241x speedup, step: 93
Epoch 93/200 |loss: 9.304105| train set 5.008x speedup, test set 6.681x speedup, val set 0.775x speedup, step: 94
Epoch 94/200 |loss: 8.357161| train set 5.008x speedup, test set 6.681x speedup, val set 0.934x speedup, step: 95
Epoch 95/200 |loss: 8.934717| train set 4.958x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 9.135574| train set 4.958x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 97
Epoch 97/200 |loss: 8.911703| train set 4.958x speedup, test set 4.387x speedup, val set 0.957x speedup, step: 98
Epoch 98/200 |loss: 8.687631| train set 5.008x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 99
Epoch 99/200 |loss: 9.329518| train set 5.008x speedup, test set 5.360x speedup, val set 1.033x speedup, step: 100
Epoch 100/200 |loss: 9.138059| train set 5.007x speedup, test set 6.681x speedup, val set 0.980x speedup, step: 101
Epoch 101/200 |loss: 9.986790| train set 4.715x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 1
Epoch 102/200 |loss: 8.684393| train set 4.958x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 1
Epoch 103/200 |loss: 9.279710| train set 5.003x speedup, test set 5.360x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.684518| train set 4.917x speedup, test set 5.360x speedup, val set 0.868x speedup, step: 3
Epoch 105/200 |loss: 7.850171| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.520644| train set 5.007x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 107/200 |loss: 9.001551| train set 5.007x speedup, test set 6.681x speedup, val set 0.980x speedup, step: 2
Epoch 108/200 |loss: 8.375654| train set 5.008x speedup, test set 6.681x speedup, val set 1.045x speedup, step: 3
Epoch 109/200 |loss: 9.253500| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 110/200 |loss: 7.657889| train set 4.958x speedup, test set 6.681x speedup, val set 1.006x speedup, step: 2
Epoch 111/200 |loss: 8.748685| train set 4.958x speedup, test set 4.387x speedup, val set 1.033x speedup, step: 3
Epoch 112/200 |loss: 9.460049| train set 4.958x speedup, test set 6.681x speedup, val set 1.033x speedup, step: 4
Epoch 113/200 |loss: 8.680849| train set 5.008x speedup, test set 6.681x speedup, val set 1.006x speedup, step: 5
Epoch 114/200 |loss: 9.583771| train set 5.008x speedup, test set 4.387x speedup, val set 1.165x speedup, step: 6
Epoch 115/200 |loss: 8.138198| train set 5.008x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 116/200 |loss: 8.159685| train set 5.008x speedup, test set 6.681x speedup, val set 1.302x speedup, step: 1
Epoch 117/200 |loss: 9.944848| train set 5.008x speedup, test set 6.535x speedup, val set 0.735x speedup, step: 2
Epoch 118/200 |loss: 9.352316| train set 5.008x speedup, test set 5.360x speedup, val set 0.735x speedup, step: 3
Epoch 119/200 |loss: 9.095243| train set 5.008x speedup, test set 5.239x speedup, val set 0.742x speedup, step: 4
Epoch 120/200 |loss: 10.037437| train set 5.008x speedup, test set 5.239x speedup, val set 0.735x speedup, step: 5
Epoch 121/200 |loss: 8.467122| train set 4.921x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 6
Epoch 122/200 |loss: 8.971744| train set 4.958x speedup, test set 3.776x speedup, val set 1.228x speedup, step: 7
Epoch 123/200 |loss: 7.122244| train set 4.957x speedup, test set 3.715x speedup, val set 0.955x speedup, step: 8
Epoch 124/200 |loss: 9.286998| train set 5.003x speedup, test set 3.715x speedup, val set 0.786x speedup, step: 9
Epoch 125/200 |loss: 9.521383| train set 5.007x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 10
Epoch 126/200 |loss: 10.047937| train set 5.007x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 11
Epoch 127/200 |loss: 8.520525| train set 5.007x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 12
Epoch 128/200 |loss: 9.473068| train set 5.007x speedup, test set 5.360x speedup, val set 0.762x speedup, step: 13
Epoch 129/200 |loss: 8.231185| train set 5.008x speedup, test set 3.776x speedup, val set 0.786x speedup, step: 14
Epoch 130/200 |loss: 9.333107| train set 5.008x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 15
Epoch 131/200 |loss: 8.813753| train set 4.958x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 16
Epoch 132/200 |loss: 9.226039| train set 4.954x speedup, test set 6.535x speedup, val set 0.990x speedup, step: 17
Epoch 133/200 |loss: 7.794542| train set 4.705x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 18
Epoch 134/200 |loss: 6.982289| train set 4.958x speedup, test set 4.323x speedup, val set 1.302x speedup, step: 1
Epoch 135/200 |loss: 8.580359| train set 5.008x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 1
Epoch 136/200 |loss: 7.746089| train set 5.008x speedup, test set 5.360x speedup, val set 0.762x speedup, step: 2
Epoch 137/200 |loss: 8.675619| train set 5.008x speedup, test set 5.360x speedup, val set 0.770x speedup, step: 3
Epoch 138/200 |loss: 9.544454| train set 5.008x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 4
Epoch 139/200 |loss: 8.989659| train set 4.958x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 1
Epoch 140/200 |loss: 7.955011| train set 4.958x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.309165| train set 4.958x speedup, test set 5.239x speedup, val set 1.165x speedup, step: 2
Epoch 142/200 |loss: 8.886285| train set 4.873x speedup, test set 5.360x speedup, val set 0.804x speedup, step: 3
Epoch 143/200 |loss: 9.262325| train set 4.873x speedup, test set 4.387x speedup, val set 0.806x speedup, step: 4
Epoch 144/200 |loss: 8.846016| train set 4.957x speedup, test set 3.776x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.548595| train set 4.872x speedup, test set 4.323x speedup, val set 1.149x speedup, step: 2
Epoch 146/200 |loss: 9.054039| train set 4.920x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 3
Epoch 147/200 |loss: 9.627642| train set 4.872x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 148/200 |loss: 8.323901| train set 5.007x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 8.686793| train set 5.007x speedup, test set 4.387x speedup, val set 1.302x speedup, step: 1
Epoch 150/200 |loss: 9.424201| train set 5.007x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 2
Epoch 151/200 |loss: 8.835994| train set 4.920x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 3
Epoch 152/200 |loss: 7.628102| train set 4.921x speedup, test set 5.360x speedup, val set 0.813x speedup, step: 4
Epoch 153/200 |loss: 9.543073| train set 5.008x speedup, test set 5.360x speedup, val set 1.133x speedup, step: 5
Epoch 154/200 |loss: 8.761252| train set 5.008x speedup, test set 6.535x speedup, val set 0.735x speedup, step: 6
Epoch 155/200 |loss: 9.255530| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 7
Epoch 156/200 |loss: 8.628931| train set 5.008x speedup, test set 5.360x speedup, val set 1.133x speedup, step: 8
Epoch 157/200 |loss: 9.191022| train set 5.008x speedup, test set 5.360x speedup, val set 1.228x speedup, step: 9
Epoch 158/200 |loss: 10.474120| train set 4.917x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 10
Epoch 159/200 |loss: 7.793700| train set 5.004x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 11
Epoch 160/200 |loss: 7.745499| train set 5.008x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 12
Epoch 161/200 |loss: 9.181350| train set 5.008x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 13
Epoch 162/200 |loss: 8.198665| train set 5.008x speedup, test set 5.360x speedup, val set 0.836x speedup, step: 14
Epoch 163/200 |loss: 7.757777| train set 5.008x speedup, test set 5.360x speedup, val set 0.813x speedup, step: 15
Epoch 164/200 |loss: 9.026020| train set 5.008x speedup, test set 5.360x speedup, val set 0.934x speedup, step: 16
Epoch 165/200 |loss: 8.002148| train set 5.008x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 17
Epoch 166/200 |loss: 9.133757| train set 5.008x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 18
Epoch 167/200 |loss: 9.559874| train set 5.007x speedup, test set 5.360x speedup, val set 1.228x speedup, step: 19
Epoch 168/200 |loss: 8.721472| train set 4.957x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.091960| train set 4.958x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 1
Epoch 170/200 |loss: 8.881834| train set 4.873x speedup, test set 5.360x speedup, val set 1.228x speedup, step: 2
Epoch 171/200 |loss: 9.275055| train set 4.873x speedup, test set 5.360x speedup, val set 1.149x speedup, step: 3
Epoch 172/200 |loss: 9.785860| train set 4.873x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 1
Epoch 173/200 |loss: 8.103228| train set 4.957x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 1
Epoch 174/200 |loss: 9.142745| train set 4.920x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 2
Epoch 175/200 |loss: 9.669234| train set 4.920x speedup, test set 3.776x speedup, val set 0.804x speedup, step: 3
Epoch 176/200 |loss: 9.220466| train set 4.920x speedup, test set 3.776x speedup, val set 0.868x speedup, step: 4
Epoch 177/200 |loss: 8.420560| train set 4.957x speedup, test set 5.360x speedup, val set 1.302x speedup, step: 1
Epoch 178/200 |loss: 9.027631| train set 4.957x speedup, test set 5.360x speedup, val set 1.228x speedup, step: 2
Epoch 179/200 |loss: 8.585520| train set 4.958x speedup, test set 5.360x speedup, val set 0.990x speedup, step: 3
Epoch 180/200 |loss: 9.136403| train set 4.958x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 4
Epoch 181/200 |loss: 8.501721| train set 4.671x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 5
Epoch 182/200 |loss: 9.346939| train set 4.958x speedup, test set 4.720x speedup, val set 0.742x speedup, step: 6
Epoch 183/200 |loss: 8.306294| train set 4.958x speedup, test set 5.360x speedup, val set 0.944x speedup, step: 7
Epoch 184/200 |loss: 7.477408| train set 5.008x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 8
Epoch 185/200 |loss: 8.613142| train set 4.917x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 9
Epoch 186/200 |loss: 8.866554| train set 4.753x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 10
Epoch 187/200 |loss: 8.341108| train set 4.753x speedup, test set 6.535x speedup, val set 1.228x speedup, step: 11
Epoch 188/200 |loss: 8.345977| train set 5.007x speedup, test set 6.681x speedup, val set 1.165x speedup, step: 12
Epoch 189/200 |loss: 8.617322| train set 5.007x speedup, test set 6.681x speedup, val set 0.955x speedup, step: 13
Epoch 190/200 |loss: 8.660295| train set 5.008x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 14
Epoch 191/200 |loss: 7.787230| train set 5.008x speedup, test set 5.360x speedup, val set 1.149x speedup, step: 15
Epoch 192/200 |loss: 9.786323| train set 4.921x speedup, test set 5.360x speedup, val set 1.165x speedup, step: 16
Epoch 193/200 |loss: 9.155783| train set 4.921x speedup, test set 5.360x speedup, val set 0.836x speedup, step: 17
Epoch 194/200 |loss: 9.492904| train set 4.921x speedup, test set 5.360x speedup, val set 0.944x speedup, step: 18
Epoch 195/200 |loss: 7.678038| train set 4.921x speedup, test set 5.360x speedup, val set 1.228x speedup, step: 19
Epoch 196/200 |loss: 8.660073| train set 4.958x speedup, test set 5.360x speedup, val set 1.228x speedup, step: 20
Epoch 197/200 |loss: 8.889834| train set 4.958x speedup, test set 3.776x speedup, val set 0.990x speedup, step: 21
Epoch 198/200 |loss: 9.159442| train set 4.954x speedup, test set 3.776x speedup, val set 0.804x speedup, step: 22
Epoch 199/200 |loss: 7.662790| train set 4.958x speedup, test set 5.360x speedup, val set 0.804x speedup, step: 23
Training per epoch cost 0.315 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 18.392s, pg runtime 18.392s, speedup 1.000x
02, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
03, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
04, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
05, opt runtime 14.857s, model runtime 14.857s, pg runtime 14.857s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 15.831s, model runtime 15.831s, pg runtime 15.831s, speedup 1.000x
08, opt runtime 9.432s, model runtime 9.432s, pg runtime 9.432s, speedup 1.000x
09, opt runtime 26.874s, model runtime 26.874s, pg runtime 26.874s, speedup 1.000x
10, opt runtime 21.143s, model runtime 21.143s, pg runtime 21.143s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 8.560, val speedup 0.965
best test speedup epoch: 2, train speedup 3.191, test speedup 8.560, val speedup 1.007
best validation speedup epoch: 177, train speedup 4.957, test speedup 5.360, val speedup 1.302
last model at epoch 199, train speedup 4.958, test speedup 5.360, val speedup 0.804
execution cost 0:02:32.339105
==================================================
