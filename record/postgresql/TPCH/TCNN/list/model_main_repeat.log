all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.873133, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290459| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282248| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696508| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.238125| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.746904| train set 3.226x speedup, test set 3.060x speedup, val set 3.218x speedup, step: 7
Epoch 7/200 |loss: 21.353819| train set 3.795x speedup, test set 3.673x speedup, val set 3.780x speedup, step: 8
Epoch 8/200 |loss: 20.910847| train set 3.797x speedup, test set 3.674x speedup, val set 3.782x speedup, step: 9
Epoch 9/200 |loss: 20.411451| train set 3.623x speedup, test set 3.431x speedup, val set 3.566x speedup, step: 10
Epoch 10/200 |loss: 19.953287| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.428829| train set 4.040x speedup, test set 3.851x speedup, val set 3.994x speedup, step: 12
Epoch 12/200 |loss: 18.877079| train set 4.154x speedup, test set 3.934x speedup, val set 4.127x speedup, step: 13
Epoch 13/200 |loss: 18.385633| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 14
Epoch 14/200 |loss: 17.908461| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 15
Epoch 15/200 |loss: 17.417931| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 16
Epoch 16/200 |loss: 16.964676| train set 4.485x speedup, test set 4.331x speedup, val set 4.432x speedup, step: 17
Epoch 17/200 |loss: 16.535517| train set 4.553x speedup, test set 4.318x speedup, val set 4.558x speedup, step: 18
Epoch 18/200 |loss: 16.094614| train set 4.655x speedup, test set 4.483x speedup, val set 4.585x speedup, step: 19
Epoch 19/200 |loss: 15.611968| train set 4.922x speedup, test set 4.794x speedup, val set 4.885x speedup, step: 20
Epoch 20/200 |loss: 15.145469| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 21
Epoch 21/200 |loss: 14.769595| train set 4.922x speedup, test set 4.794x speedup, val set 4.885x speedup, step: 22
Epoch 22/200 |loss: 14.455353| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 23
Epoch 23/200 |loss: 14.276248| train set 5.314x speedup, test set 5.226x speedup, val set 5.432x speedup, step: 24
Epoch 24/200 |loss: 13.887918| train set 5.180x speedup, test set 5.059x speedup, val set 5.333x speedup, step: 25
Epoch 25/200 |loss: 13.337634| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 26
Epoch 26/200 |loss: 12.974262| train set 5.327x speedup, test set 5.221x speedup, val set 5.504x speedup, step: 27
Epoch 27/200 |loss: 12.921297| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 28
Epoch 28/200 |loss: 12.699376| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 29
Epoch 29/200 |loss: 12.214536| train set 5.389x speedup, test set 5.241x speedup, val set 5.550x speedup, step: 30
Epoch 30/200 |loss: 12.053839| train set 5.334x speedup, test set 5.134x speedup, val set 5.539x speedup, step: 31
Epoch 31/200 |loss: 12.359186| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 32
Epoch 32/200 |loss: 11.742723| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 33
Epoch 33/200 |loss: 11.562532| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 34
Epoch 34/200 |loss: 11.491825| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 35
Epoch 35/200 |loss: 11.078093| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 36
Epoch 36/200 |loss: 11.137076| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.613245| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 38
Epoch 38/200 |loss: 10.524307| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 39
Epoch 39/200 |loss: 10.361964| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 40
Epoch 40/200 |loss: 10.027747| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 41
Epoch 41/200 |loss: 10.068797| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 42
Epoch 42/200 |loss: 9.817224| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 43
Epoch 43/200 |loss: 9.683588| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 44
Epoch 44/200 |loss: 9.616698| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 45
Epoch 45/200 |loss: 9.575197| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 46
Epoch 46/200 |loss: 9.378142| train set 5.169x speedup, test set 5.031x speedup, val set 5.356x speedup, step: 47
Epoch 47/200 |loss: 9.747922| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 48
Epoch 48/200 |loss: 9.951901| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 9.487405| train set 5.387x speedup, test set 5.259x speedup, val set 5.553x speedup, step: 50
Epoch 50/200 |loss: 9.611010| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 51
Epoch 51/200 |loss: 9.354441| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 52
Epoch 52/200 |loss: 9.080824| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 53
Epoch 53/200 |loss: 9.131277| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 54
Epoch 54/200 |loss: 8.849961| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 55
Epoch 55/200 |loss: 9.003716| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 56/200 |loss: 8.681565| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 57/200 |loss: 8.805346| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 58/200 |loss: 8.550053| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 59/200 |loss: 8.487983| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 60
Epoch 60/200 |loss: 8.494828| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Epoch 61/200 |loss: 8.461029| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 62/200 |loss: 8.412359| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 63/200 |loss: 8.417597| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 64
Epoch 64/200 |loss: 8.589091| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 65/200 |loss: 8.888947| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 66
Epoch 66/200 |loss: 9.089715| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 67
Epoch 67/200 |loss: 8.347455| train set 5.387x speedup, test set 5.262x speedup, val set 5.552x speedup, step: 68
Epoch 68/200 |loss: 9.183884| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 69
Epoch 69/200 |loss: 8.425076| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 70
Epoch 70/200 |loss: 8.716250| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 71
Epoch 71/200 |loss: 8.352655| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 72/200 |loss: 8.493134| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 73
Epoch 73/200 |loss: 8.292844| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 74/200 |loss: 8.453559| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 75/200 |loss: 8.078732| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 76
Epoch 76/200 |loss: 8.325672| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 77
Epoch 77/200 |loss: 8.216108| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 78
Epoch 78/200 |loss: 8.092575| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 79
Epoch 79/200 |loss: 8.070994| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 80
Epoch 80/200 |loss: 8.166246| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 81
Epoch 81/200 |loss: 8.007238| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 82
Epoch 82/200 |loss: 7.958573| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 83/200 |loss: 8.035021| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 84/200 |loss: 7.787376| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 85/200 |loss: 7.839353| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 86/200 |loss: 7.828845| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 87
Epoch 87/200 |loss: 7.737389| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Epoch 88/200 |loss: 7.713900| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 89
Epoch 89/200 |loss: 7.751800| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 90
Epoch 90/200 |loss: 7.714232| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 91
Epoch 91/200 |loss: 7.727673| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 92
Epoch 92/200 |loss: 7.993664| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 93
Epoch 93/200 |loss: 7.871685| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 94
Epoch 94/200 |loss: 7.956659| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Epoch 95/200 |loss: 7.586292| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 96
Epoch 96/200 |loss: 7.780446| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 97
Epoch 97/200 |loss: 8.179694| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 98
Epoch 98/200 |loss: 7.781735| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 99
Epoch 99/200 |loss: 7.860871| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 100
Epoch 100/200 |loss: 8.201481| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 101/200 |loss: 8.026196| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 102/200 |loss: 7.954165| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 103/200 |loss: 8.259091| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 104/200 |loss: 7.752049| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 1
Epoch 105/200 |loss: 8.074966| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2
Epoch 106/200 |loss: 7.942554| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3
Epoch 107/200 |loss: 7.776261| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4
Epoch 108/200 |loss: 7.935234| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 5
Epoch 109/200 |loss: 7.997931| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 6
Epoch 110/200 |loss: 7.769266| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Epoch 111/200 |loss: 7.876505| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8
Epoch 112/200 |loss: 7.669463| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9
Epoch 113/200 |loss: 7.706286| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10
Epoch 114/200 |loss: 7.596247| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11
Epoch 115/200 |loss: 7.631012| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 12
Epoch 116/200 |loss: 7.647586| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13
Epoch 117/200 |loss: 7.557868| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14
Epoch 118/200 |loss: 7.622313| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 15
Epoch 119/200 |loss: 7.580390| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 16
Epoch 120/200 |loss: 7.476933| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 17
Epoch 121/200 |loss: 7.604533| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 18
Epoch 122/200 |loss: 7.614193| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19
Epoch 123/200 |loss: 7.467432| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20
Epoch 124/200 |loss: 7.615372| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 21
Epoch 125/200 |loss: 7.516992| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 22
Epoch 126/200 |loss: 7.438598| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23
Epoch 127/200 |loss: 7.568767| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24
Epoch 128/200 |loss: 7.428472| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25
Epoch 129/200 |loss: 7.443939| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26
Epoch 130/200 |loss: 7.474341| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 27
Epoch 131/200 |loss: 7.378676| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28
Epoch 132/200 |loss: 7.399955| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 29
Epoch 133/200 |loss: 7.413007| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 30
Epoch 134/200 |loss: 7.482442| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31
Epoch 135/200 |loss: 7.446885| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 32
Epoch 136/200 |loss: 7.600646| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 33
Epoch 137/200 |loss: 7.513608| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 34
Epoch 138/200 |loss: 7.448803| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 35
Epoch 139/200 |loss: 7.409345| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 36
Epoch 140/200 |loss: 7.354877| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 37
Epoch 141/200 |loss: 7.381728| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 38
Epoch 142/200 |loss: 7.351219| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 39
Epoch 143/200 |loss: 7.478095| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 40
Epoch 144/200 |loss: 7.392447| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 41
Epoch 145/200 |loss: 7.315000| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 42
Epoch 146/200 |loss: 7.298406| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 43
Epoch 147/200 |loss: 7.334442| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 44
Epoch 148/200 |loss: 7.381485| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 45
Epoch 149/200 |loss: 7.364081| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 46
Epoch 150/200 |loss: 7.450182| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 47
Epoch 151/200 |loss: 7.310566| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 48
Epoch 152/200 |loss: 7.313166| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 49
Epoch 153/200 |loss: 7.354596| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 50
Epoch 154/200 |loss: 7.359804| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 155/200 |loss: 7.373281| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 156/200 |loss: 7.276174| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 53
Epoch 157/200 |loss: 7.259497| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 54
Epoch 158/200 |loss: 7.268823| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 55
Epoch 159/200 |loss: 7.339383| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 160/200 |loss: 7.555467| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 161/200 |loss: 7.331121| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 162/200 |loss: 7.366633| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 163/200 |loss: 7.489929| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 60
Epoch 164/200 |loss: 7.465085| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Epoch 165/200 |loss: 7.436770| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 166/200 |loss: 7.319505| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 167/200 |loss: 7.418619| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 64
Epoch 168/200 |loss: 7.286144| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 169/200 |loss: 7.357868| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 66
Epoch 170/200 |loss: 7.400435| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 67
Epoch 171/200 |loss: 7.360031| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Epoch 172/200 |loss: 7.382156| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 69
Epoch 173/200 |loss: 7.416449| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 70
Epoch 174/200 |loss: 7.433713| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 175/200 |loss: 7.347844| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 176/200 |loss: 7.321061| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 73
Epoch 177/200 |loss: 7.304229| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 178/200 |loss: 7.488934| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 179/200 |loss: 7.258005| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 76
Epoch 180/200 |loss: 7.340626| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 77
Epoch 181/200 |loss: 7.568901| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 78
Epoch 182/200 |loss: 7.315731| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 79
Epoch 183/200 |loss: 7.425881| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 80
Epoch 184/200 |loss: 7.751212| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 81
Epoch 185/200 |loss: 7.305611| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 82
Epoch 186/200 |loss: 7.664214| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 187/200 |loss: 8.039313| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 188/200 |loss: 7.471936| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 85
Epoch 189/200 |loss: 8.074657| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 190/200 |loss: 7.430726| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 87
Epoch 191/200 |loss: 7.738042| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Epoch 192/200 |loss: 7.428128| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 89
Epoch 193/200 |loss: 7.624127| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 194/200 |loss: 7.457662| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 91
Epoch 195/200 |loss: 7.522044| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 92
Epoch 196/200 |loss: 7.453310| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 93
Epoch 197/200 |loss: 7.427017| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 94
Epoch 198/200 |loss: 7.382088| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Epoch 199/200 |loss: 7.350396| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 96
Training per epoch cost 0.204 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.015s, pg runtime 1.092s, speedup 1.076x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 55, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 67, train speedup 5.387, test speedup 5.262, val speedup 5.552
best validation speedup epoch: 104, train speedup 5.389, test speedup 5.258, val speedup 5.548
last model at epoch 199, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:02:07.716712
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.901840, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290459| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282248| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696508| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.238119| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.746902| train set 3.226x speedup, test set 3.060x speedup, val set 3.218x speedup, step: 7
Epoch 7/200 |loss: 21.354050| train set 3.794x speedup, test set 3.671x speedup, val set 3.780x speedup, step: 8
Epoch 8/200 |loss: 20.912249| train set 3.797x speedup, test set 3.674x speedup, val set 3.782x speedup, step: 9
Epoch 9/200 |loss: 20.426373| train set 3.580x speedup, test set 3.431x speedup, val set 3.566x speedup, step: 10
Epoch 10/200 |loss: 19.958096| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.438877| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 12
Epoch 12/200 |loss: 18.894749| train set 4.085x speedup, test set 3.902x speedup, val set 4.062x speedup, step: 13
Epoch 13/200 |loss: 18.404848| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 14
Epoch 14/200 |loss: 17.915970| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 15
Epoch 15/200 |loss: 17.414562| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 16
Epoch 16/200 |loss: 16.943279| train set 4.067x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 17
Epoch 17/200 |loss: 16.474600| train set 4.390x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 18
Epoch 18/200 |loss: 16.038849| train set 4.485x speedup, test set 4.331x speedup, val set 4.432x speedup, step: 19
Epoch 19/200 |loss: 15.611320| train set 4.835x speedup, test set 4.576x speedup, val set 4.920x speedup, step: 20
Epoch 20/200 |loss: 15.139398| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 21
Epoch 21/200 |loss: 14.773481| train set 5.180x speedup, test set 5.059x speedup, val set 5.333x speedup, step: 22
Epoch 22/200 |loss: 14.400357| train set 5.134x speedup, test set 5.034x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 14.074140| train set 5.180x speedup, test set 5.059x speedup, val set 5.333x speedup, step: 24
Epoch 24/200 |loss: 13.804152| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 25
Epoch 25/200 |loss: 13.510075| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 26
Epoch 26/200 |loss: 13.019588| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 27
Epoch 27/200 |loss: 12.676537| train set 5.138x speedup, test set 5.067x speedup, val set 5.278x speedup, step: 28
Epoch 28/200 |loss: 12.543596| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 29
Epoch 29/200 |loss: 12.201537| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 30
Epoch 30/200 |loss: 11.963598| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 31
Epoch 31/200 |loss: 11.609135| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 32
Epoch 32/200 |loss: 11.511528| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 33
Epoch 33/200 |loss: 11.460644| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 34
Epoch 34/200 |loss: 11.375576| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 35
Epoch 35/200 |loss: 11.244804| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 36
Epoch 36/200 |loss: 10.741408| train set 5.320x speedup, test set 5.186x speedup, val set 5.472x speedup, step: 37
Epoch 37/200 |loss: 10.964563| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 38
Epoch 38/200 |loss: 10.506991| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 39
Epoch 39/200 |loss: 10.339802| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 40
Epoch 40/200 |loss: 10.288891| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 41
Epoch 41/200 |loss: 10.167519| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 42
Epoch 42/200 |loss: 10.041570| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 43
Epoch 43/200 |loss: 10.056310| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 44
Epoch 44/200 |loss: 10.080844| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 45
Epoch 45/200 |loss: 9.627406| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 46
Epoch 46/200 |loss: 9.449997| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 47
Epoch 47/200 |loss: 9.700168| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 48
Epoch 48/200 |loss: 9.340369| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 49
Epoch 49/200 |loss: 9.180315| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 50
Epoch 50/200 |loss: 9.105331| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 51/200 |loss: 9.068717| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 52/200 |loss: 9.199445| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 53
Epoch 53/200 |loss: 9.009525| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 54
Epoch 54/200 |loss: 8.739163| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 55
Epoch 55/200 |loss: 8.840605| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 56/200 |loss: 8.989732| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 57/200 |loss: 9.223784| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 58
Epoch 58/200 |loss: 8.670786| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 59/200 |loss: 9.036873| train set 5.202x speedup, test set 5.066x speedup, val set 5.367x speedup, step: 60
Epoch 60/200 |loss: 9.508850| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Epoch 61/200 |loss: 8.567975| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 62
Epoch 62/200 |loss: 9.248165| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 63
Epoch 63/200 |loss: 8.584200| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 64
Epoch 64/200 |loss: 8.723017| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 65
Epoch 65/200 |loss: 8.683763| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 66
Epoch 66/200 |loss: 8.480714| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 67
Epoch 67/200 |loss: 8.734245| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Epoch 68/200 |loss: 8.332460| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 69
Epoch 69/200 |loss: 8.329489| train set 5.350x speedup, test set 5.228x speedup, val set 5.539x speedup, step: 70
Epoch 70/200 |loss: 8.510866| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 71/200 |loss: 8.226211| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 72/200 |loss: 8.390436| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 73
Epoch 73/200 |loss: 8.047359| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 74/200 |loss: 8.087523| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 75/200 |loss: 8.185370| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 76
Epoch 76/200 |loss: 8.128428| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 77
Epoch 77/200 |loss: 8.113544| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 78
Epoch 78/200 |loss: 7.903939| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 79
Epoch 79/200 |loss: 7.828820| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 80
Epoch 80/200 |loss: 7.892580| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 81
Epoch 81/200 |loss: 7.882830| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 82
Epoch 82/200 |loss: 8.083471| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 83/200 |loss: 7.825693| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 84/200 |loss: 7.781531| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 85/200 |loss: 7.782694| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 86/200 |loss: 7.776037| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 87
Epoch 87/200 |loss: 7.989468| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Epoch 88/200 |loss: 7.851562| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 89
Epoch 89/200 |loss: 7.685288| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 90/200 |loss: 7.632307| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 91
Epoch 91/200 |loss: 7.611367| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 92
Epoch 92/200 |loss: 7.653850| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 93
Epoch 93/200 |loss: 7.773978| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 94
Epoch 94/200 |loss: 8.389435| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Epoch 95/200 |loss: 7.735314| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 96
Epoch 96/200 |loss: 8.215658| train set 5.169x speedup, test set 5.032x speedup, val set 5.353x speedup, step: 97
Epoch 97/200 |loss: 8.500999| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 98
Epoch 98/200 |loss: 8.086291| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 99
Epoch 99/200 |loss: 8.543409| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 100
Epoch 100/200 |loss: 8.370722| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 101/200 |loss: 8.454160| train set 5.387x speedup, test set 5.262x speedup, val set 5.552x speedup, step: 1
Epoch 102/200 |loss: 8.053444| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2
Epoch 103/200 |loss: 8.267554| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3
Epoch 104/200 |loss: 7.971624| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4
Epoch 105/200 |loss: 7.953669| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5
Epoch 106/200 |loss: 7.914346| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 6
Epoch 107/200 |loss: 7.779468| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Epoch 108/200 |loss: 7.830137| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8
Epoch 109/200 |loss: 7.705736| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9
Epoch 110/200 |loss: 7.732094| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 10
Epoch 111/200 |loss: 7.675282| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 11
Epoch 112/200 |loss: 7.673188| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12
Epoch 113/200 |loss: 7.680935| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13
Epoch 114/200 |loss: 7.650109| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14
Epoch 115/200 |loss: 7.894503| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15
Epoch 116/200 |loss: 7.685675| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16
Epoch 117/200 |loss: 7.621662| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17
Epoch 118/200 |loss: 7.521219| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 18
Epoch 119/200 |loss: 7.527577| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19
Epoch 120/200 |loss: 7.551799| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20
Epoch 121/200 |loss: 7.528102| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21
Epoch 122/200 |loss: 7.592308| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 22
Epoch 123/200 |loss: 7.446276| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23
Epoch 124/200 |loss: 7.399171| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24
Epoch 125/200 |loss: 7.406594| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25
Epoch 126/200 |loss: 7.422665| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26
Epoch 127/200 |loss: 7.484168| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 27
Epoch 128/200 |loss: 7.526379| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 28
Epoch 129/200 |loss: 7.646817| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 29
Epoch 130/200 |loss: 7.632506| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 30
Epoch 131/200 |loss: 7.976027| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31
Epoch 132/200 |loss: 7.665611| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 1
Epoch 133/200 |loss: 7.913345| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 134/200 |loss: 8.112689| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3
Epoch 135/200 |loss: 7.791440| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4
Epoch 136/200 |loss: 8.100026| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5
Epoch 137/200 |loss: 7.561121| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 6
Epoch 138/200 |loss: 7.749785| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Epoch 139/200 |loss: 7.600855| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8
Epoch 140/200 |loss: 7.665174| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9
Epoch 141/200 |loss: 7.605593| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10
Epoch 142/200 |loss: 7.463929| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11
Epoch 143/200 |loss: 7.615829| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12
Epoch 144/200 |loss: 7.551754| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 13
Epoch 145/200 |loss: 7.427701| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14
Epoch 146/200 |loss: 7.552753| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15
Epoch 147/200 |loss: 7.471613| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16
Epoch 148/200 |loss: 7.403507| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17
Epoch 149/200 |loss: 7.483978| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 18
Epoch 150/200 |loss: 7.457021| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19
Epoch 151/200 |loss: 7.352474| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20
Epoch 152/200 |loss: 7.416291| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21
Epoch 153/200 |loss: 7.369944| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 22
Epoch 154/200 |loss: 7.379454| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23
Epoch 155/200 |loss: 7.462470| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24
Epoch 156/200 |loss: 7.378506| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25
Epoch 157/200 |loss: 7.328702| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26
Epoch 158/200 |loss: 7.325797| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 27
Epoch 159/200 |loss: 7.272696| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28
Epoch 160/200 |loss: 7.268414| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 29
Epoch 161/200 |loss: 7.300812| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 30
Epoch 162/200 |loss: 7.342222| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31
Epoch 163/200 |loss: 7.335475| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 32
Epoch 164/200 |loss: 7.396425| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 33
Epoch 165/200 |loss: 7.345173| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 34
Epoch 166/200 |loss: 7.410555| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 35
Epoch 167/200 |loss: 7.264542| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 36
Epoch 168/200 |loss: 7.213977| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 37
Epoch 169/200 |loss: 7.253889| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 38
Epoch 170/200 |loss: 7.275561| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 39
Epoch 171/200 |loss: 7.359495| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 40
Epoch 172/200 |loss: 7.317626| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 41
Epoch 173/200 |loss: 7.307642| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 42
Epoch 174/200 |loss: 7.228474| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 43
Epoch 175/200 |loss: 7.212253| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 44
Epoch 176/200 |loss: 7.213779| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 45
Epoch 177/200 |loss: 7.259336| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 46
Epoch 178/200 |loss: 7.374073| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 47
Epoch 179/200 |loss: 7.265742| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 48
Epoch 180/200 |loss: 7.228653| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 49
Epoch 181/200 |loss: 7.205338| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 50
Epoch 182/200 |loss: 7.186052| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 183/200 |loss: 7.178450| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 184/200 |loss: 7.202398| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 53
Epoch 185/200 |loss: 7.303355| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 54
Epoch 186/200 |loss: 7.352580| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 55
Epoch 187/200 |loss: 7.703136| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 188/200 |loss: 7.273634| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 189/200 |loss: 7.380430| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 190/200 |loss: 8.046828| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 191/200 |loss: 7.275082| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 60
Epoch 192/200 |loss: 8.063592| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 61
Epoch 193/200 |loss: 8.455440| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 194/200 |loss: 8.166728| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 195/200 |loss: 8.049571| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 64
Epoch 196/200 |loss: 8.056982| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 197/200 |loss: 7.655910| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 66
Epoch 198/200 |loss: 7.873671| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 67
Epoch 199/200 |loss: 7.593151| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Training per epoch cost 0.207 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 39, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 101, train speedup 5.387, test speedup 5.262, val speedup 5.552
best validation speedup epoch: 132, train speedup 5.316, test speedup 5.171, val speedup 5.588
last model at epoch 199, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:02:08.936079
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.906082, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290459| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282248| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696508| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.238125| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.746904| train set 3.226x speedup, test set 3.060x speedup, val set 3.218x speedup, step: 7
Epoch 7/200 |loss: 21.353819| train set 3.795x speedup, test set 3.673x speedup, val set 3.780x speedup, step: 8
Epoch 8/200 |loss: 20.910843| train set 3.797x speedup, test set 3.674x speedup, val set 3.782x speedup, step: 9
Epoch 9/200 |loss: 20.411444| train set 3.673x speedup, test set 3.431x speedup, val set 3.566x speedup, step: 10
Epoch 10/200 |loss: 19.953337| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.428421| train set 4.040x speedup, test set 3.851x speedup, val set 3.994x speedup, step: 12
Epoch 12/200 |loss: 18.880623| train set 4.154x speedup, test set 3.934x speedup, val set 4.127x speedup, step: 13
Epoch 13/200 |loss: 18.389359| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 14
Epoch 14/200 |loss: 17.921999| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 15
Epoch 15/200 |loss: 17.411327| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 16
Epoch 16/200 |loss: 16.935957| train set 4.390x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 17
Epoch 17/200 |loss: 16.457678| train set 4.504x speedup, test set 4.271x speedup, val set 4.505x speedup, step: 18
Epoch 18/200 |loss: 16.065989| train set 4.725x speedup, test set 4.563x speedup, val set 4.643x speedup, step: 19
Epoch 19/200 |loss: 15.734744| train set 4.808x speedup, test set 4.606x speedup, val set 4.854x speedup, step: 20
Epoch 20/200 |loss: 15.307224| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 21
Epoch 21/200 |loss: 14.765031| train set 5.134x speedup, test set 5.034x speedup, val set 5.256x speedup, step: 22
Epoch 22/200 |loss: 14.440554| train set 5.134x speedup, test set 5.034x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 14.208156| train set 5.103x speedup, test set 5.070x speedup, val set 5.180x speedup, step: 24
Epoch 24/200 |loss: 13.838760| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 25
Epoch 25/200 |loss: 13.340685| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 26
Epoch 26/200 |loss: 13.081562| train set 5.389x speedup, test set 5.241x speedup, val set 5.550x speedup, step: 27
Epoch 27/200 |loss: 12.853027| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 28
Epoch 28/200 |loss: 12.623436| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 29
Epoch 29/200 |loss: 12.202660| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 30
Epoch 30/200 |loss: 11.855980| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 31
Epoch 31/200 |loss: 11.931846| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 32
Epoch 32/200 |loss: 11.562297| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 33
Epoch 33/200 |loss: 11.413114| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 34
Epoch 34/200 |loss: 11.043424| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 35
Epoch 35/200 |loss: 10.957651| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 36
Epoch 36/200 |loss: 10.775271| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.547337| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 38
Epoch 38/200 |loss: 10.625865| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 39
Epoch 39/200 |loss: 10.039630| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 40
Epoch 40/200 |loss: 9.961226| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 41
Epoch 41/200 |loss: 10.051620| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 42
Epoch 42/200 |loss: 10.316226| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 43
Epoch 43/200 |loss: 9.698946| train set 5.387x speedup, test set 5.259x speedup, val set 5.553x speedup, step: 44
Epoch 44/200 |loss: 9.772371| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 45
Epoch 45/200 |loss: 9.464938| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 46
Epoch 46/200 |loss: 9.863511| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 47
Epoch 47/200 |loss: 9.248835| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 48
Epoch 48/200 |loss: 9.281961| train set 5.387x speedup, test set 5.259x speedup, val set 5.553x speedup, step: 49
Epoch 49/200 |loss: 9.386433| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 9.847072| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 51
Epoch 51/200 |loss: 8.941298| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 52/200 |loss: 9.293292| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 9.723088| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 54
Epoch 54/200 |loss: 8.909728| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 55
Epoch 55/200 |loss: 9.654556| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 56/200 |loss: 9.111135| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 57/200 |loss: 9.249904| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 58/200 |loss: 8.731687| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 59/200 |loss: 9.048018| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 60
Epoch 60/200 |loss: 8.721795| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 61
Epoch 61/200 |loss: 8.803844| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 62/200 |loss: 8.562446| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 63/200 |loss: 8.599589| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 64
Epoch 64/200 |loss: 8.467942| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 65/200 |loss: 8.410634| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 66
Epoch 66/200 |loss: 8.315636| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 67
Epoch 67/200 |loss: 8.271641| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Epoch 68/200 |loss: 8.215624| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 69
Epoch 69/200 |loss: 8.130897| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 70/200 |loss: 8.168288| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 71/200 |loss: 8.035267| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 72/200 |loss: 8.133882| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 73
Epoch 73/200 |loss: 8.751187| train set 5.136x speedup, test set 5.072x speedup, val set 5.278x speedup, step: 74
Epoch 74/200 |loss: 10.362366| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 75/200 |loss: 9.374708| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 76
Epoch 76/200 |loss: 8.601993| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 77
Epoch 77/200 |loss: 8.935760| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 78
Epoch 78/200 |loss: 8.537222| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 79
Epoch 79/200 |loss: 8.483872| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 80
Epoch 80/200 |loss: 8.563644| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 81
Epoch 81/200 |loss: 8.159798| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 82
Epoch 82/200 |loss: 8.481585| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 83/200 |loss: 8.141602| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 84/200 |loss: 8.104447| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 85/200 |loss: 8.080113| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 86
Epoch 86/200 |loss: 8.068372| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 87
Epoch 87/200 |loss: 7.940440| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Epoch 88/200 |loss: 7.938118| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 89
Epoch 89/200 |loss: 8.012111| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 90/200 |loss: 7.896465| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 91
Epoch 91/200 |loss: 7.798871| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 92
Epoch 92/200 |loss: 7.732923| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 93
Epoch 93/200 |loss: 7.785908| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 94
Epoch 94/200 |loss: 7.815390| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Epoch 95/200 |loss: 7.875873| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 96
Epoch 96/200 |loss: 8.063185| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 97
Epoch 97/200 |loss: 7.685486| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 98
Epoch 98/200 |loss: 7.668445| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 99
Epoch 99/200 |loss: 7.908545| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 100
Epoch 100/200 |loss: 7.747306| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 101/200 |loss: 7.666781| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 102/200 |loss: 7.592007| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 103/200 |loss: 7.571005| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 104/200 |loss: 7.684823| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 105/200 |loss: 7.661180| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 106/200 |loss: 7.574598| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 107/200 |loss: 7.495970| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 108/200 |loss: 7.510191| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 109/200 |loss: 7.570811| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 110/200 |loss: 7.620901| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 111/200 |loss: 7.971252| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 112/200 |loss: 7.538253| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 113/200 |loss: 7.543881| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 114/200 |loss: 7.921653| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 115/200 |loss: 7.499840| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 116/200 |loss: 7.800598| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3
Epoch 117/200 |loss: 8.069860| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 118/200 |loss: 7.727355| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 119/200 |loss: 8.068103| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 120/200 |loss: 7.772522| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 121/200 |loss: 7.897791| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 122/200 |loss: 7.715046| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 123/200 |loss: 7.853725| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 124/200 |loss: 7.618703| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 125/200 |loss: 7.713013| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 126/200 |loss: 7.698721| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 127/200 |loss: 7.586552| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 128/200 |loss: 7.550756| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 129/200 |loss: 7.536294| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 130/200 |loss: 7.576961| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 131/200 |loss: 7.481526| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 132/200 |loss: 7.481312| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 133/200 |loss: 7.427744| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 134/200 |loss: 7.481435| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 135/200 |loss: 7.480759| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 136/200 |loss: 7.403359| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 137/200 |loss: 7.433340| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 138/200 |loss: 7.372458| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 139/200 |loss: 7.389469| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 140/200 |loss: 7.309593| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 141/200 |loss: 7.356509| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 142/200 |loss: 7.333449| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 143/200 |loss: 7.406505| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 144/200 |loss: 7.392375| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 145/200 |loss: 7.568252| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 146/200 |loss: 7.532592| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 147/200 |loss: 7.573875| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 148/200 |loss: 7.363698| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 149/200 |loss: 7.346682| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 150/200 |loss: 7.593061| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 151/200 |loss: 7.423851| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 152/200 |loss: 7.392645| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 153/200 |loss: 7.407897| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 154/200 |loss: 7.330901| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 155/200 |loss: 7.310573| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 156/200 |loss: 7.304279| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 157/200 |loss: 7.325446| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 158/200 |loss: 7.288347| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 159/200 |loss: 7.247029| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 160/200 |loss: 7.255575| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 161/200 |loss: 7.292328| train set 5.384x speedup, test set 5.266x speedup, val set 5.528x speedup, step: 2
Epoch 162/200 |loss: 7.310606| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 163/200 |loss: 7.288147| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 164/200 |loss: 7.232073| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 165/200 |loss: 7.227541| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 166/200 |loss: 7.259596| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 167/200 |loss: 7.304710| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 168/200 |loss: 7.421314| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 169/200 |loss: 7.451504| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 170/200 |loss: 7.905282| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 171/200 |loss: 7.439493| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 172/200 |loss: 7.535512| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3
Epoch 173/200 |loss: 8.125965| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 174/200 |loss: 7.460312| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 175/200 |loss: 8.092741| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3
Epoch 176/200 |loss: 7.900360| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 177/200 |loss: 7.847458| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 178/200 |loss: 7.760036| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 179/200 |loss: 7.690296| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 180/200 |loss: 7.592833| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 181/200 |loss: 7.648994| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 182/200 |loss: 7.461841| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 183/200 |loss: 7.596609| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 184/200 |loss: 7.389919| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 185/200 |loss: 7.548198| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 186/200 |loss: 7.350515| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 187/200 |loss: 7.458362| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 188/200 |loss: 7.326337| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 189/200 |loss: 7.416044| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 190/200 |loss: 7.307063| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 191/200 |loss: 7.370447| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 192/200 |loss: 7.289889| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 193/200 |loss: 7.349785| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 194/200 |loss: 7.284761| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 195/200 |loss: 7.300456| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 196/200 |loss: 7.263226| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 197/200 |loss: 7.253659| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 198/200 |loss: 7.231746| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 199/200 |loss: 7.239117| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Training per epoch cost 0.200 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 51, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 161, train speedup 5.384, test speedup 5.266, val speedup 5.528
best validation speedup epoch: 199, train speedup 5.389, test speedup 5.256, val speedup 5.547
last model at epoch 199, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:02:07.994676
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.886168, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290459| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282248| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696508| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.238121| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.746902| train set 3.226x speedup, test set 3.060x speedup, val set 3.218x speedup, step: 7
Epoch 7/200 |loss: 21.353819| train set 3.795x speedup, test set 3.673x speedup, val set 3.780x speedup, step: 8
Epoch 8/200 |loss: 20.910856| train set 3.797x speedup, test set 3.674x speedup, val set 3.782x speedup, step: 9
Epoch 9/200 |loss: 20.411488| train set 3.673x speedup, test set 3.431x speedup, val set 3.566x speedup, step: 10
Epoch 10/200 |loss: 19.953213| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.426908| train set 4.040x speedup, test set 3.851x speedup, val set 3.994x speedup, step: 12
Epoch 12/200 |loss: 18.877316| train set 4.154x speedup, test set 3.934x speedup, val set 4.127x speedup, step: 13
Epoch 13/200 |loss: 18.393377| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 14
Epoch 14/200 |loss: 17.921156| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 15
Epoch 15/200 |loss: 17.405386| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 16
Epoch 16/200 |loss: 16.921377| train set 4.390x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 17
Epoch 17/200 |loss: 16.448744| train set 4.504x speedup, test set 4.271x speedup, val set 4.505x speedup, step: 18
Epoch 18/200 |loss: 16.042576| train set 4.550x speedup, test set 4.378x speedup, val set 4.485x speedup, step: 19
Epoch 19/200 |loss: 15.718989| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 20
Epoch 20/200 |loss: 15.351638| train set 4.922x speedup, test set 4.794x speedup, val set 4.885x speedup, step: 21
Epoch 21/200 |loss: 14.801944| train set 5.314x speedup, test set 5.226x speedup, val set 5.432x speedup, step: 22
Epoch 22/200 |loss: 14.424379| train set 5.134x speedup, test set 5.034x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 14.170961| train set 5.103x speedup, test set 5.070x speedup, val set 5.180x speedup, step: 24
Epoch 24/200 |loss: 13.842882| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 25
Epoch 25/200 |loss: 13.339214| train set 5.389x speedup, test set 5.241x speedup, val set 5.550x speedup, step: 26
Epoch 26/200 |loss: 13.131562| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 27
Epoch 27/200 |loss: 12.889943| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 28
Epoch 28/200 |loss: 12.744592| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 29
Epoch 29/200 |loss: 12.130417| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 30
Epoch 30/200 |loss: 12.148995| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 31
Epoch 31/200 |loss: 11.783859| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 32
Epoch 32/200 |loss: 11.461112| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 33
Epoch 33/200 |loss: 11.289965| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 34
Epoch 34/200 |loss: 10.836705| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 35
Epoch 35/200 |loss: 10.915913| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 36
Epoch 36/200 |loss: 10.893247| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 37
Epoch 37/200 |loss: 10.904908| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 38
Epoch 38/200 |loss: 11.609904| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 39
Epoch 39/200 |loss: 11.105069| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 40
Epoch 40/200 |loss: 10.515405| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 41
Epoch 41/200 |loss: 10.706618| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 42
Epoch 42/200 |loss: 10.333350| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 43
Epoch 43/200 |loss: 10.337040| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 44
Epoch 44/200 |loss: 9.828311| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 45
Epoch 45/200 |loss: 9.900841| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 46
Epoch 46/200 |loss: 9.605737| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 9.463527| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 48
Epoch 48/200 |loss: 9.467083| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 49
Epoch 49/200 |loss: 9.138809| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 50
Epoch 50/200 |loss: 9.211205| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 51
Epoch 51/200 |loss: 8.986126| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 52
Epoch 52/200 |loss: 8.969857| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 53
Epoch 53/200 |loss: 9.005191| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 9.854704| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 55
Epoch 55/200 |loss: 10.115260| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 9.394757| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.998022| train set 5.387x speedup, test set 5.259x speedup, val set 5.553x speedup, step: 58
Epoch 58/200 |loss: 9.551029| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 59
Epoch 59/200 |loss: 8.664279| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 60
Epoch 60/200 |loss: 9.000818| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 61
Epoch 61/200 |loss: 8.757406| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 62/200 |loss: 8.652315| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 63/200 |loss: 8.758150| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 64
Epoch 64/200 |loss: 8.533822| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 65/200 |loss: 8.549253| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 66
Epoch 66/200 |loss: 8.479884| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 67
Epoch 67/200 |loss: 8.398237| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Epoch 68/200 |loss: 8.427691| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 69
Epoch 69/200 |loss: 8.293324| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 70/200 |loss: 8.209638| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 71/200 |loss: 8.222232| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 72/200 |loss: 8.261925| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 73
Epoch 73/200 |loss: 8.075470| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 74/200 |loss: 8.094738| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 75
Epoch 75/200 |loss: 8.132443| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 76
Epoch 76/200 |loss: 7.979682| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 77
Epoch 77/200 |loss: 8.022411| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 78
Epoch 78/200 |loss: 7.852489| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 79
Epoch 79/200 |loss: 7.880961| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 80
Epoch 80/200 |loss: 7.914471| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 81
Epoch 81/200 |loss: 8.094865| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 82
Epoch 82/200 |loss: 8.913948| train set 5.168x speedup, test set 5.036x speedup, val set 5.356x speedup, step: 83
Epoch 83/200 |loss: 10.288381| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 84
Epoch 84/200 |loss: 9.230597| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 85
Epoch 85/200 |loss: 9.526418| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 86/200 |loss: 9.132777| train set 5.323x speedup, test set 5.165x speedup, val set 5.449x speedup, step: 87
Epoch 87/200 |loss: 8.873542| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Epoch 88/200 |loss: 8.740650| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 89
Epoch 89/200 |loss: 8.554275| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 90/200 |loss: 8.544497| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 91
Epoch 91/200 |loss: 8.384998| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 92
Epoch 92/200 |loss: 8.426527| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 93
Epoch 93/200 |loss: 8.342431| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 94
Epoch 94/200 |loss: 8.328290| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 95
Epoch 95/200 |loss: 8.087498| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 96
Epoch 96/200 |loss: 8.156351| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 97
Epoch 97/200 |loss: 8.011199| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 98
Epoch 98/200 |loss: 7.960552| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 99
Epoch 99/200 |loss: 7.987146| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 100
Epoch 100/200 |loss: 7.859993| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 101/200 |loss: 7.845379| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 102/200 |loss: 7.827821| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 103/200 |loss: 7.781415| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 104/200 |loss: 7.770574| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 105/200 |loss: 7.743878| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 106/200 |loss: 7.635248| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 107/200 |loss: 7.673042| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 108/200 |loss: 7.667074| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 109/200 |loss: 7.609370| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 110/200 |loss: 7.579304| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 111/200 |loss: 7.623672| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 112/200 |loss: 7.702602| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 113/200 |loss: 8.017901| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 114/200 |loss: 7.951031| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 115/200 |loss: 7.768112| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 116/200 |loss: 7.854093| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 117/200 |loss: 7.638858| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 118/200 |loss: 7.856285| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 119/200 |loss: 7.953110| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 120/200 |loss: 7.598071| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 121/200 |loss: 7.761452| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 122/200 |loss: 7.962813| train set 5.387x speedup, test set 5.261x speedup, val set 5.547x speedup, step: 1
Epoch 123/200 |loss: 7.663987| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 124/200 |loss: 7.807760| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 125/200 |loss: 7.938642| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 126/200 |loss: 7.633855| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 127/200 |loss: 7.805682| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 128/200 |loss: 7.672147| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3
Epoch 129/200 |loss: 7.517170| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 130/200 |loss: 7.680890| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 131/200 |loss: 7.397583| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 132/200 |loss: 7.647349| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 133/200 |loss: 7.400678| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 134/200 |loss: 7.520123| train set 5.383x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 135/200 |loss: 7.472764| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 136/200 |loss: 7.442231| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 137/200 |loss: 7.412600| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 138/200 |loss: 7.373888| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 139/200 |loss: 7.420208| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 140/200 |loss: 7.360958| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 141/200 |loss: 7.433002| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 142/200 |loss: 7.473299| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 143/200 |loss: 7.460856| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 144/200 |loss: 7.368232| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 145/200 |loss: 7.372618| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 146/200 |loss: 7.343946| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 147/200 |loss: 7.324551| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 148/200 |loss: 7.342542| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 149/200 |loss: 7.349835| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 150/200 |loss: 7.492461| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 151/200 |loss: 7.475797| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 152/200 |loss: 7.734148| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 153/200 |loss: 7.430991| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 154/200 |loss: 7.300464| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 155/200 |loss: 7.348342| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 156/200 |loss: 7.468464| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 157/200 |loss: 7.641119| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 158/200 |loss: 7.312307| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 159/200 |loss: 7.460397| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 160/200 |loss: 7.731371| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 161/200 |loss: 7.372563| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 162/200 |loss: 7.604204| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3
Epoch 163/200 |loss: 7.861570| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 164/200 |loss: 7.437080| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 165/200 |loss: 7.899030| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 166/200 |loss: 7.365555| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 167/200 |loss: 7.650783| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 168/200 |loss: 7.348614| train set 5.383x speedup, test set 5.251x speedup, val set 5.544x speedup, step: 2
Epoch 169/200 |loss: 7.521575| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 170/200 |loss: 7.386240| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 171/200 |loss: 7.430415| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 172/200 |loss: 7.354409| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 173/200 |loss: 7.390672| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 174/200 |loss: 7.328061| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 175/200 |loss: 7.354580| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 176/200 |loss: 7.290362| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 177/200 |loss: 7.322081| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 178/200 |loss: 7.264010| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 179/200 |loss: 7.275499| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 180/200 |loss: 7.245166| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 181/200 |loss: 7.248754| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 182/200 |loss: 7.225115| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 183/200 |loss: 7.231152| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 184/200 |loss: 7.218105| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 185/200 |loss: 7.231955| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 186/200 |loss: 7.372552| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 187/200 |loss: 7.485428| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 188/200 |loss: 8.025345| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 189/200 |loss: 7.489256| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 190/200 |loss: 7.584026| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 1
Epoch 191/200 |loss: 8.323581| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2
Epoch 192/200 |loss: 7.766246| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3
Epoch 193/200 |loss: 7.958339| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 1
Epoch 194/200 |loss: 8.121835| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 2
Epoch 195/200 |loss: 7.836480| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 3
Epoch 196/200 |loss: 7.976946| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4
Epoch 197/200 |loss: 7.462998| train set 5.202x speedup, test set 5.066x speedup, val set 5.367x speedup, step: 5
Epoch 198/200 |loss: 7.870859| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 6
Epoch 199/200 |loss: 7.441542| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Training per epoch cost 0.203 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.197s, pg runtime 7.799s, speedup 1.084x
28, opt runtime 7.063s, model runtime 7.159s, pg runtime 7.063s, speedup 0.987x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 40, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 91, train speedup 5.387, test speedup 5.261, val speedup 5.550
best validation speedup epoch: 193, train speedup 5.387, test speedup 5.261, val speedup 5.550
last model at epoch 199, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:02:08.103271
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.874269, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290459| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282272| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696487| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.237478| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.742975| train set 3.234x speedup, test set 3.063x speedup, val set 3.256x speedup, step: 7
Epoch 7/200 |loss: 21.334484| train set 3.508x speedup, test set 3.358x speedup, val set 3.496x speedup, step: 8
Epoch 8/200 |loss: 20.890108| train set 3.995x speedup, test set 3.756x speedup, val set 3.937x speedup, step: 9
Epoch 9/200 |loss: 20.381166| train set 4.112x speedup, test set 3.804x speedup, val set 3.972x speedup, step: 10
Epoch 10/200 |loss: 19.927608| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.384666| train set 4.040x speedup, test set 3.851x speedup, val set 3.994x speedup, step: 12
Epoch 12/200 |loss: 18.820377| train set 4.154x speedup, test set 3.964x speedup, val set 4.127x speedup, step: 13
Epoch 13/200 |loss: 18.314896| train set 4.089x speedup, test set 3.899x speedup, val set 4.046x speedup, step: 14
Epoch 14/200 |loss: 17.825666| train set 4.390x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 15
Epoch 15/200 |loss: 17.313784| train set 4.259x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 16
Epoch 16/200 |loss: 16.836325| train set 4.390x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 17
Epoch 17/200 |loss: 16.365046| train set 4.485x speedup, test set 4.331x speedup, val set 4.432x speedup, step: 18
Epoch 18/200 |loss: 15.916291| train set 4.725x speedup, test set 4.563x speedup, val set 4.643x speedup, step: 19
Epoch 19/200 |loss: 15.464457| train set 4.922x speedup, test set 4.794x speedup, val set 4.885x speedup, step: 20
Epoch 20/200 |loss: 15.032619| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 21
Epoch 21/200 |loss: 14.724302| train set 5.103x speedup, test set 5.070x speedup, val set 5.180x speedup, step: 22
Epoch 22/200 |loss: 14.984094| train set 5.011x speedup, test set 4.878x speedup, val set 5.069x speedup, step: 23
Epoch 23/200 |loss: 14.608711| train set 5.164x speedup, test set 4.958x speedup, val set 5.181x speedup, step: 24
Epoch 24/200 |loss: 13.783442| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 25
Epoch 25/200 |loss: 13.818762| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 26
Epoch 26/200 |loss: 13.096474| train set 5.204x speedup, test set 5.061x speedup, val set 5.366x speedup, step: 27
Epoch 27/200 |loss: 13.054969| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 28
Epoch 28/200 |loss: 12.604612| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 29
Epoch 29/200 |loss: 12.384522| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 30
Epoch 30/200 |loss: 12.126039| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 31
Epoch 31/200 |loss: 11.794609| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 32
Epoch 32/200 |loss: 11.779922| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 33
Epoch 33/200 |loss: 11.392422| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 34
Epoch 34/200 |loss: 11.133879| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 35
Epoch 35/200 |loss: 10.935108| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 36
Epoch 36/200 |loss: 10.618035| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 37
Epoch 37/200 |loss: 10.472394| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.390027| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 39
Epoch 39/200 |loss: 10.244686| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 10.312910| train set 5.320x speedup, test set 5.187x speedup, val set 5.469x speedup, step: 41
Epoch 41/200 |loss: 10.633961| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 42
Epoch 42/200 |loss: 10.153986| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 43
Epoch 43/200 |loss: 9.740034| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 44
Epoch 44/200 |loss: 9.864473| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 10.196813| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.819930| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 47
Epoch 47/200 |loss: 9.640899| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 48
Epoch 48/200 |loss: 9.469968| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 49
Epoch 49/200 |loss: 9.471687| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 50
Epoch 50/200 |loss: 9.017804| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 51/200 |loss: 9.492303| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 52/200 |loss: 9.084848| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 53
Epoch 53/200 |loss: 8.859854| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 54
Epoch 54/200 |loss: 9.196464| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 55
Epoch 55/200 |loss: 8.924241| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 56/200 |loss: 8.862192| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 57/200 |loss: 8.694201| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 58/200 |loss: 8.633469| train set 5.383x speedup, test set 5.224x speedup, val set 5.547x speedup, step: 59
Epoch 59/200 |loss: 8.550324| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 60
Epoch 60/200 |loss: 8.566026| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Epoch 61/200 |loss: 8.683387| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 62/200 |loss: 9.160350| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 63
Epoch 63/200 |loss: 9.383192| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 64
Epoch 64/200 |loss: 8.700547| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 65
Epoch 65/200 |loss: 9.251457| train set 5.388x speedup, test set 5.261x speedup, val set 5.547x speedup, step: 66
Epoch 66/200 |loss: 8.756798| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 67
Epoch 67/200 |loss: 8.681974| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Epoch 68/200 |loss: 8.786594| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 69
Epoch 69/200 |loss: 8.587069| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 70/200 |loss: 8.328774| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 71/200 |loss: 8.473573| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 72/200 |loss: 8.181349| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 73
Epoch 73/200 |loss: 8.384039| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 74/200 |loss: 8.097399| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 75/200 |loss: 8.170308| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 76
Epoch 76/200 |loss: 8.006254| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 77
Epoch 77/200 |loss: 8.085036| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 78
Epoch 78/200 |loss: 7.934599| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 79
Epoch 79/200 |loss: 8.043512| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 80
Epoch 80/200 |loss: 8.009390| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 81
Epoch 81/200 |loss: 8.087633| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 82
Epoch 82/200 |loss: 8.271826| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 83
Epoch 83/200 |loss: 8.329654| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 84
Epoch 84/200 |loss: 8.409671| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 85/200 |loss: 7.798491| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 86/200 |loss: 8.361075| train set 5.287x speedup, test set 5.133x speedup, val set 5.438x speedup, step: 87
Epoch 87/200 |loss: 8.707143| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 88
Epoch 88/200 |loss: 8.005547| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 89
Epoch 89/200 |loss: 8.688106| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 90/200 |loss: 7.917868| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 91
Epoch 91/200 |loss: 8.248077| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 92
Epoch 92/200 |loss: 7.884693| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 93
Epoch 93/200 |loss: 8.139546| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 94
Epoch 94/200 |loss: 7.861680| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Epoch 95/200 |loss: 7.985458| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 96
Epoch 96/200 |loss: 7.734339| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 97
Epoch 97/200 |loss: 7.929489| train set 5.383x speedup, test set 5.224x speedup, val set 5.547x speedup, step: 98
Epoch 98/200 |loss: 7.702494| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 99
Epoch 99/200 |loss: 7.800251| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 100
Epoch 100/200 |loss: 7.690115| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 101/200 |loss: 7.684696| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 102/200 |loss: 7.682292| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 103/200 |loss: 7.600436| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 104/200 |loss: 7.638766| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 105/200 |loss: 7.564768| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 106/200 |loss: 7.540687| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 107/200 |loss: 7.502565| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 108/200 |loss: 7.473409| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 109/200 |loss: 7.499812| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 110/200 |loss: 7.489757| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 111/200 |loss: 7.523157| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 112/200 |loss: 7.699599| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 113/200 |loss: 7.803303| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 114/200 |loss: 8.105754| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 115/200 |loss: 7.531916| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 116/200 |loss: 7.667226| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 117/200 |loss: 8.114815| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 118/200 |loss: 7.486819| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 119/200 |loss: 7.888665| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 120/200 |loss: 7.946367| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 121/200 |loss: 7.624443| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 122/200 |loss: 7.958739| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 123/200 |loss: 7.636020| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 124/200 |loss: 7.753992| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 125/200 |loss: 7.556977| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 126/200 |loss: 7.635183| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 127/200 |loss: 7.508381| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 128/200 |loss: 7.582423| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 129/200 |loss: 7.468451| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 130/200 |loss: 7.558127| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 131/200 |loss: 7.392150| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 132/200 |loss: 7.538624| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 133/200 |loss: 7.362035| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 134/200 |loss: 7.477511| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 135/200 |loss: 7.404691| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 136/200 |loss: 7.440375| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 137/200 |loss: 7.368248| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 138/200 |loss: 7.381339| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 139/200 |loss: 7.374940| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 140/200 |loss: 7.348068| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 141/200 |loss: 7.328125| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 142/200 |loss: 7.280971| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 143/200 |loss: 7.324915| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 144/200 |loss: 7.279851| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 145/200 |loss: 7.302392| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 146/200 |loss: 7.267514| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 147/200 |loss: 7.277940| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 148/200 |loss: 7.265545| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 149/200 |loss: 7.302269| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 150/200 |loss: 7.458866| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 151/200 |loss: 7.490194| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 152/200 |loss: 7.673531| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 153/200 |loss: 7.479417| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 154/200 |loss: 7.417746| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3
Epoch 155/200 |loss: 7.715622| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 4
Epoch 156/200 |loss: 7.594626| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 5
Epoch 157/200 |loss: 7.702404| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 158/200 |loss: 7.433537| train set 5.390x speedup, test set 5.266x speedup, val set 5.547x speedup, step: 1
Epoch 159/200 |loss: 7.623599| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 160/200 |loss: 7.883423| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 161/200 |loss: 7.502743| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 162/200 |loss: 7.714171| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 163/200 |loss: 7.818646| train set 5.369x speedup, test set 5.224x speedup, val set 5.547x speedup, step: 1
Epoch 164/200 |loss: 7.482410| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 165/200 |loss: 7.814829| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 166/200 |loss: 7.481858| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 167/200 |loss: 7.514373| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 168/200 |loss: 7.584334| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 169/200 |loss: 7.377217| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 170/200 |loss: 7.445709| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 171/200 |loss: 7.365224| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 172/200 |loss: 7.367307| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 173/200 |loss: 7.382777| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 174/200 |loss: 7.333157| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 175/200 |loss: 7.320029| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 176/200 |loss: 7.327919| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 177/200 |loss: 7.282479| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 178/200 |loss: 7.307182| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 179/200 |loss: 7.264171| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 180/200 |loss: 7.257659| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 181/200 |loss: 7.256037| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 182/200 |loss: 7.225743| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 183/200 |loss: 7.240476| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 184/200 |loss: 7.202230| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 185/200 |loss: 7.226506| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 186/200 |loss: 7.217152| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 187/200 |loss: 7.176586| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 188/200 |loss: 7.196562| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 189/200 |loss: 7.184409| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 190/200 |loss: 7.178433| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 191/200 |loss: 7.205280| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 192/200 |loss: 7.254182| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 193/200 |loss: 7.296341| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3
Epoch 194/200 |loss: 7.596192| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 195/200 |loss: 7.435145| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 196/200 |loss: 7.544139| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 197/200 |loss: 7.873838| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 198/200 |loss: 7.353329| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 199/200 |loss: 7.612028| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 1
Training per epoch cost 0.203 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.197s, pg runtime 7.799s, speedup 1.084x
28, opt runtime 7.063s, model runtime 7.159s, pg runtime 7.063s, speedup 0.987x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 158, train speedup 5.390, test speedup 5.266, val speedup 5.547
best test speedup epoch: 158, train speedup 5.390, test speedup 5.266, val speedup 5.547
best validation speedup epoch: 199, train speedup 5.387, test speedup 5.261, val speedup 5.550
last model at epoch 199, train speedup 5.387, test speedup 5.261, val speedup 5.550
execution cost 0:02:07.307071
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.867644, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290459| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282248| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696508| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.238125| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.746904| train set 3.226x speedup, test set 3.060x speedup, val set 3.218x speedup, step: 7
Epoch 7/200 |loss: 21.353819| train set 3.795x speedup, test set 3.673x speedup, val set 3.780x speedup, step: 8
Epoch 8/200 |loss: 20.910841| train set 3.797x speedup, test set 3.674x speedup, val set 3.782x speedup, step: 9
Epoch 9/200 |loss: 20.411444| train set 3.673x speedup, test set 3.431x speedup, val set 3.566x speedup, step: 10
Epoch 10/200 |loss: 19.953339| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.428421| train set 4.040x speedup, test set 3.851x speedup, val set 3.994x speedup, step: 12
Epoch 12/200 |loss: 18.880623| train set 4.154x speedup, test set 3.934x speedup, val set 4.127x speedup, step: 13
Epoch 13/200 |loss: 18.389359| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 14
Epoch 14/200 |loss: 17.921999| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 15
Epoch 15/200 |loss: 17.411327| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 16
Epoch 16/200 |loss: 16.935957| train set 4.390x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 17
Epoch 17/200 |loss: 16.457687| train set 4.504x speedup, test set 4.271x speedup, val set 4.505x speedup, step: 18
Epoch 18/200 |loss: 16.066128| train set 4.725x speedup, test set 4.563x speedup, val set 4.643x speedup, step: 19
Epoch 19/200 |loss: 15.734141| train set 4.808x speedup, test set 4.606x speedup, val set 4.854x speedup, step: 20
Epoch 20/200 |loss: 15.303262| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 21
Epoch 21/200 |loss: 14.761785| train set 5.134x speedup, test set 5.034x speedup, val set 5.256x speedup, step: 22
Epoch 22/200 |loss: 14.419631| train set 5.134x speedup, test set 5.034x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 14.187274| train set 5.314x speedup, test set 5.226x speedup, val set 5.432x speedup, step: 24
Epoch 24/200 |loss: 13.860382| train set 5.314x speedup, test set 5.226x speedup, val set 5.432x speedup, step: 25
Epoch 25/200 |loss: 13.332885| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 26
Epoch 26/200 |loss: 13.053382| train set 5.389x speedup, test set 5.241x speedup, val set 5.550x speedup, step: 27
Epoch 27/200 |loss: 12.877639| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 28
Epoch 28/200 |loss: 12.504395| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 29
Epoch 29/200 |loss: 12.153249| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 30
Epoch 30/200 |loss: 11.988400| train set 5.169x speedup, test set 5.031x speedup, val set 5.356x speedup, step: 31
Epoch 31/200 |loss: 12.261313| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 32
Epoch 32/200 |loss: 11.482301| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 33
Epoch 33/200 |loss: 11.350485| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 34
Epoch 34/200 |loss: 11.257882| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 35
Epoch 35/200 |loss: 11.352962| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 36
Epoch 36/200 |loss: 10.603806| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 37
Epoch 37/200 |loss: 10.909869| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 38
Epoch 38/200 |loss: 10.684347| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 39
Epoch 39/200 |loss: 10.437029| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 10.342116| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 41
Epoch 41/200 |loss: 10.501422| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.966448| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 43
Epoch 43/200 |loss: 10.077705| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 44
Epoch 44/200 |loss: 9.616553| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 45
Epoch 45/200 |loss: 9.488324| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 46
Epoch 46/200 |loss: 9.335863| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 47
Epoch 47/200 |loss: 9.374749| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 48
Epoch 48/200 |loss: 9.394704| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 9.973354| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 50
Epoch 50/200 |loss: 9.059607| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 51
Epoch 51/200 |loss: 9.880505| train set 5.108x speedup, test set 4.947x speedup, val set 5.264x speedup, step: 52
Epoch 52/200 |loss: 10.005787| train set 5.350x speedup, test set 5.227x speedup, val set 5.542x speedup, step: 53
Epoch 53/200 |loss: 10.116979| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 54
Epoch 54/200 |loss: 9.649172| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 55
Epoch 55/200 |loss: 9.664859| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 56/200 |loss: 9.336728| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 57/200 |loss: 9.508881| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 58/200 |loss: 8.805792| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 59/200 |loss: 9.223947| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 60
Epoch 60/200 |loss: 8.865155| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Epoch 61/200 |loss: 8.731420| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 62
Epoch 62/200 |loss: 8.736236| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 63/200 |loss: 8.832351| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 64
Epoch 64/200 |loss: 8.499547| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 65/200 |loss: 8.592981| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 66
Epoch 66/200 |loss: 8.467601| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 67
Epoch 67/200 |loss: 8.444893| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Epoch 68/200 |loss: 8.304043| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 69
Epoch 69/200 |loss: 8.263372| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 70/200 |loss: 8.191272| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 71/200 |loss: 8.254507| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 72/200 |loss: 8.101225| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 73
Epoch 73/200 |loss: 8.040617| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 74/200 |loss: 8.054926| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 75/200 |loss: 7.951876| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 76
Epoch 76/200 |loss: 7.990845| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 77
Epoch 77/200 |loss: 8.094327| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 78
Epoch 78/200 |loss: 8.305439| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 79
Epoch 79/200 |loss: 8.412802| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 80
Epoch 80/200 |loss: 8.571549| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 81
Epoch 81/200 |loss: 8.014807| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 82
Epoch 82/200 |loss: 8.055305| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 83
Epoch 83/200 |loss: 8.242691| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 84/200 |loss: 7.927806| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 85/200 |loss: 7.761209| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 86/200 |loss: 8.051248| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 87
Epoch 87/200 |loss: 7.925163| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Epoch 88/200 |loss: 7.661107| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 89
Epoch 89/200 |loss: 7.894533| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 90/200 |loss: 7.813261| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 91
Epoch 91/200 |loss: 7.688640| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 92
Epoch 92/200 |loss: 7.722108| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 93
Epoch 93/200 |loss: 7.678244| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 94
Epoch 94/200 |loss: 7.671693| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 95
Epoch 95/200 |loss: 7.903954| train set 5.312x speedup, test set 5.174x speedup, val set 5.566x speedup, step: 96
Epoch 96/200 |loss: 8.572978| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 97
Epoch 97/200 |loss: 10.385920| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 98
Epoch 98/200 |loss: 9.284906| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 99
Epoch 99/200 |loss: 9.629597| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 100
Epoch 100/200 |loss: 9.336143| train set 5.323x speedup, test set 5.165x speedup, val set 5.449x speedup, step: 101
Epoch 101/200 |loss: 8.908465| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 102/200 |loss: 8.759905| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 103/200 |loss: 8.641889| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 104/200 |loss: 8.571788| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 105/200 |loss: 8.437263| train set 5.387x speedup, test set 5.259x speedup, val set 5.553x speedup, step: 1
Epoch 106/200 |loss: 8.374577| train set 5.202x speedup, test set 5.066x speedup, val set 5.367x speedup, step: 2
Epoch 107/200 |loss: 8.271665| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 3
Epoch 108/200 |loss: 8.239744| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 4
Epoch 109/200 |loss: 8.255704| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 5
Epoch 110/200 |loss: 8.053424| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 6
Epoch 111/200 |loss: 8.072039| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Epoch 112/200 |loss: 7.990162| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8
Epoch 113/200 |loss: 7.892123| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9
Epoch 114/200 |loss: 7.905864| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 10
Epoch 115/200 |loss: 7.889581| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 11
Epoch 116/200 |loss: 7.759640| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 12
Epoch 117/200 |loss: 7.796557| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13
Epoch 118/200 |loss: 7.710610| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14
Epoch 119/200 |loss: 7.685032| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15
Epoch 120/200 |loss: 7.627744| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16
Epoch 121/200 |loss: 7.620370| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17
Epoch 122/200 |loss: 7.616251| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 18
Epoch 123/200 |loss: 7.605802| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19
Epoch 124/200 |loss: 7.540843| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 20
Epoch 125/200 |loss: 7.523477| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21
Epoch 126/200 |loss: 7.501689| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 22
Epoch 127/200 |loss: 7.517655| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23
Epoch 128/200 |loss: 7.511087| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24
Epoch 129/200 |loss: 7.476869| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25
Epoch 130/200 |loss: 7.445442| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26
Epoch 131/200 |loss: 7.428334| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 27
Epoch 132/200 |loss: 7.401611| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28
Epoch 133/200 |loss: 7.393053| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 29
Epoch 134/200 |loss: 7.393653| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 30
Epoch 135/200 |loss: 7.414818| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31
Epoch 136/200 |loss: 7.491957| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 32
Epoch 137/200 |loss: 7.647744| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 33
Epoch 138/200 |loss: 7.955443| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 34
Epoch 139/200 |loss: 7.715050| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 35
Epoch 140/200 |loss: 7.461558| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 36
Epoch 141/200 |loss: 7.383029| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 37
Epoch 142/200 |loss: 7.549460| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 38
Epoch 143/200 |loss: 7.807463| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 39
Epoch 144/200 |loss: 7.428791| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 40
Epoch 145/200 |loss: 7.445279| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 41
Epoch 146/200 |loss: 7.825830| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 42
Epoch 147/200 |loss: 7.434987| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 43
Epoch 148/200 |loss: 7.613554| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 44
Epoch 149/200 |loss: 7.747939| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 45
Epoch 150/200 |loss: 7.484914| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 46
Epoch 151/200 |loss: 7.690548| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 47
Epoch 152/200 |loss: 7.843690| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 48
Epoch 153/200 |loss: 7.545314| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 49
Epoch 154/200 |loss: 7.707693| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 50
Epoch 155/200 |loss: 7.567325| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 156/200 |loss: 7.509449| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 157/200 |loss: 7.569262| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 53
Epoch 158/200 |loss: 7.477031| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 54
Epoch 159/200 |loss: 7.475046| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 55
Epoch 160/200 |loss: 7.471290| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 161/200 |loss: 7.389041| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 57
Epoch 162/200 |loss: 7.505010| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 163/200 |loss: 7.316072| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 164/200 |loss: 7.439265| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 60
Epoch 165/200 |loss: 7.283827| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 61
Epoch 166/200 |loss: 7.363998| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 167/200 |loss: 7.303198| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 168/200 |loss: 7.311996| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 64
Epoch 169/200 |loss: 7.316503| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 170/200 |loss: 7.328386| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 66
Epoch 171/200 |loss: 7.539038| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 67
Epoch 172/200 |loss: 7.649556| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Epoch 173/200 |loss: 8.349631| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 69
Epoch 174/200 |loss: 7.435846| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 175/200 |loss: 8.270041| train set 5.350x speedup, test set 5.228x speedup, val set 5.539x speedup, step: 71
Epoch 176/200 |loss: 8.425959| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 177/200 |loss: 7.900168| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 73
Epoch 178/200 |loss: 8.149873| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 74
Epoch 179/200 |loss: 7.789103| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 75
Epoch 180/200 |loss: 7.819507| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 76
Epoch 181/200 |loss: 7.737397| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 77
Epoch 182/200 |loss: 7.776795| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 78
Epoch 183/200 |loss: 7.549552| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 79
Epoch 184/200 |loss: 7.694442| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 80
Epoch 185/200 |loss: 7.470278| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 81
Epoch 186/200 |loss: 7.610223| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 82
Epoch 187/200 |loss: 7.463717| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 188/200 |loss: 7.452138| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 189/200 |loss: 7.487816| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 190/200 |loss: 7.373484| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 191/200 |loss: 7.446219| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 87
Epoch 192/200 |loss: 7.349298| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Epoch 193/200 |loss: 7.388751| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 89
Epoch 194/200 |loss: 7.331288| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 195/200 |loss: 7.340632| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 91
Epoch 196/200 |loss: 7.316618| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 92
Epoch 197/200 |loss: 7.297996| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 93
Epoch 198/200 |loss: 7.324463| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 94
Epoch 199/200 |loss: 7.259085| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Training per epoch cost 0.206 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.214s, pg runtime 1.214s, speedup 1.000x
20, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.197s, pg runtime 7.799s, speedup 1.084x
28, opt runtime 7.063s, model runtime 7.159s, pg runtime 7.063s, speedup 0.987x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 55, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 61, train speedup 5.387, test speedup 5.261, val speedup 5.550
best validation speedup epoch: 105, train speedup 5.387, test speedup 5.259, val speedup 5.553
last model at epoch 199, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:02:07.693129
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.866514, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290459| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282248| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696508| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.238121| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.746904| train set 3.226x speedup, test set 3.060x speedup, val set 3.218x speedup, step: 7
Epoch 7/200 |loss: 21.353817| train set 3.795x speedup, test set 3.673x speedup, val set 3.780x speedup, step: 8
Epoch 8/200 |loss: 20.910843| train set 3.797x speedup, test set 3.674x speedup, val set 3.782x speedup, step: 9
Epoch 9/200 |loss: 20.411444| train set 3.673x speedup, test set 3.431x speedup, val set 3.566x speedup, step: 10
Epoch 10/200 |loss: 19.953339| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.428421| train set 4.040x speedup, test set 3.851x speedup, val set 3.994x speedup, step: 12
Epoch 12/200 |loss: 18.880623| train set 4.154x speedup, test set 3.934x speedup, val set 4.127x speedup, step: 13
Epoch 13/200 |loss: 18.389359| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 14
Epoch 14/200 |loss: 17.921999| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 15
Epoch 15/200 |loss: 17.411331| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 16
Epoch 16/200 |loss: 16.935963| train set 4.390x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 17
Epoch 17/200 |loss: 16.457682| train set 4.504x speedup, test set 4.271x speedup, val set 4.505x speedup, step: 18
Epoch 18/200 |loss: 16.066055| train set 4.725x speedup, test set 4.563x speedup, val set 4.643x speedup, step: 19
Epoch 19/200 |loss: 15.734619| train set 4.808x speedup, test set 4.606x speedup, val set 4.854x speedup, step: 20
Epoch 20/200 |loss: 15.303428| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 21
Epoch 21/200 |loss: 14.766347| train set 5.134x speedup, test set 5.034x speedup, val set 5.256x speedup, step: 22
Epoch 22/200 |loss: 14.429659| train set 5.134x speedup, test set 5.034x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 14.193991| train set 5.103x speedup, test set 5.070x speedup, val set 5.180x speedup, step: 24
Epoch 24/200 |loss: 13.860983| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 25
Epoch 25/200 |loss: 13.369005| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 26
Epoch 26/200 |loss: 13.087024| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 27
Epoch 27/200 |loss: 12.871618| train set 5.180x speedup, test set 5.059x speedup, val set 5.333x speedup, step: 28
Epoch 28/200 |loss: 12.694036| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 29
Epoch 29/200 |loss: 12.135426| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 30
Epoch 30/200 |loss: 11.909429| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 31
Epoch 31/200 |loss: 11.938593| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 32
Epoch 32/200 |loss: 11.516873| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 33
Epoch 33/200 |loss: 11.220764| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 34
Epoch 34/200 |loss: 10.898208| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 35
Epoch 35/200 |loss: 10.987118| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 36
Epoch 36/200 |loss: 11.267767| train set 5.320x speedup, test set 5.186x speedup, val set 5.472x speedup, step: 37
Epoch 37/200 |loss: 11.186679| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 38
Epoch 38/200 |loss: 10.383024| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 10.589329| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 40
Epoch 40/200 |loss: 10.319974| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 41
Epoch 41/200 |loss: 10.088469| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 42
Epoch 42/200 |loss: 9.934122| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 43
Epoch 43/200 |loss: 9.816978| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 44
Epoch 44/200 |loss: 9.640393| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 45
Epoch 45/200 |loss: 9.847347| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 46
Epoch 46/200 |loss: 9.972066| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 10.114375| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 48
Epoch 48/200 |loss: 9.383476| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 49
Epoch 49/200 |loss: 9.636175| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 50
Epoch 50/200 |loss: 9.595361| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 51
Epoch 51/200 |loss: 9.309283| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 52/200 |loss: 9.381947| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 53
Epoch 53/200 |loss: 9.126294| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 54
Epoch 54/200 |loss: 9.042199| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 55
Epoch 55/200 |loss: 9.054964| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 56
Epoch 56/200 |loss: 8.847547| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.755630| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 58/200 |loss: 8.673148| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 59/200 |loss: 8.530861| train set 5.384x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 60
Epoch 60/200 |loss: 8.750075| train set 5.388x speedup, test set 5.261x speedup, val set 5.547x speedup, step: 61
Epoch 61/200 |loss: 8.895526| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 62/200 |loss: 9.121759| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 63/200 |loss: 8.419668| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 64
Epoch 64/200 |loss: 8.583091| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 65/200 |loss: 8.803814| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 66
Epoch 66/200 |loss: 8.523910| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 67
Epoch 67/200 |loss: 8.558099| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 68
Epoch 68/200 |loss: 8.705396| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 69
Epoch 69/200 |loss: 8.253560| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 70/200 |loss: 8.810673| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 71
Epoch 71/200 |loss: 9.110935| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 72
Epoch 72/200 |loss: 8.703835| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 73
Epoch 73/200 |loss: 8.779313| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 74/200 |loss: 8.393898| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 75/200 |loss: 8.502099| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 76
Epoch 76/200 |loss: 8.288885| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 77
Epoch 77/200 |loss: 8.267309| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 78
Epoch 78/200 |loss: 8.315177| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 79
Epoch 79/200 |loss: 8.067668| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 80
Epoch 80/200 |loss: 8.280409| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 81
Epoch 81/200 |loss: 8.143694| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 82
Epoch 82/200 |loss: 7.970627| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 83/200 |loss: 8.129693| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 84/200 |loss: 7.942337| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 85
Epoch 85/200 |loss: 7.941004| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 86/200 |loss: 7.988207| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 87
Epoch 87/200 |loss: 7.951232| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Epoch 88/200 |loss: 7.822650| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 89
Epoch 89/200 |loss: 7.946856| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 90/200 |loss: 7.760644| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 91
Epoch 91/200 |loss: 7.765606| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 92
Epoch 92/200 |loss: 7.842893| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 93
Epoch 93/200 |loss: 7.744106| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 94
Epoch 94/200 |loss: 7.738676| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Epoch 95/200 |loss: 7.800036| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 96
Epoch 96/200 |loss: 7.861956| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 97
Epoch 97/200 |loss: 7.682111| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 98
Epoch 98/200 |loss: 7.704281| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 99
Epoch 99/200 |loss: 7.907944| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 100
Epoch 100/200 |loss: 7.586438| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 101/200 |loss: 7.610819| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 102/200 |loss: 7.663836| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 103/200 |loss: 7.593862| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 104/200 |loss: 7.617301| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 105/200 |loss: 7.662705| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 106/200 |loss: 7.999454| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 107/200 |loss: 7.784747| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 108/200 |loss: 7.514359| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 109/200 |loss: 7.484893| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 110/200 |loss: 7.696055| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 111/200 |loss: 7.605901| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 112/200 |loss: 7.416815| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 113/200 |loss: 7.512818| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 114/200 |loss: 7.571403| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 115/200 |loss: 7.597692| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 116/200 |loss: 7.498098| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 117/200 |loss: 7.670433| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 118/200 |loss: 7.669756| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 119/200 |loss: 7.612642| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 120/200 |loss: 7.497303| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 121/200 |loss: 7.582728| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 122/200 |loss: 7.458058| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 123/200 |loss: 7.355111| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 124/200 |loss: 7.423275| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 125/200 |loss: 7.451486| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 126/200 |loss: 7.442672| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 127/200 |loss: 7.470624| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 128/200 |loss: 7.508471| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 129/200 |loss: 7.459355| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 130/200 |loss: 7.402778| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 131/200 |loss: 7.359955| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 132/200 |loss: 7.447507| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 133/200 |loss: 7.367566| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 134/200 |loss: 7.334601| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 135/200 |loss: 7.305219| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 136/200 |loss: 7.319291| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 137/200 |loss: 7.362456| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 138/200 |loss: 7.419309| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 139/200 |loss: 7.449488| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 140/200 |loss: 7.957832| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 3
Epoch 141/200 |loss: 7.785050| train set 5.384x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 142/200 |loss: 7.795987| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 143/200 |loss: 7.394867| train set 5.316x speedup, test set 5.173x speedup, val set 5.569x speedup, step: 1
Epoch 144/200 |loss: 7.899918| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 145/200 |loss: 7.881886| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3
Epoch 146/200 |loss: 7.607404| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 1
Epoch 147/200 |loss: 7.830420| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2
Epoch 148/200 |loss: 7.492367| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3
Epoch 149/200 |loss: 7.665461| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4
Epoch 150/200 |loss: 7.525856| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5
Epoch 151/200 |loss: 7.473770| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 6
Epoch 152/200 |loss: 7.478841| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Epoch 153/200 |loss: 7.450308| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 8
Epoch 154/200 |loss: 7.479137| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9
Epoch 155/200 |loss: 7.440279| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10
Epoch 156/200 |loss: 7.380599| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11
Epoch 157/200 |loss: 7.375320| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12
Epoch 158/200 |loss: 7.355518| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13
Epoch 159/200 |loss: 7.386064| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14
Epoch 160/200 |loss: 7.388315| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15
Epoch 161/200 |loss: 7.473957| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16
Epoch 162/200 |loss: 7.437710| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17
Epoch 163/200 |loss: 7.374360| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 18
Epoch 164/200 |loss: 7.393938| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19
Epoch 165/200 |loss: 7.293694| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20
Epoch 166/200 |loss: 7.342574| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21
Epoch 167/200 |loss: 7.240603| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 22
Epoch 168/200 |loss: 7.305071| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23
Epoch 169/200 |loss: 7.341675| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24
Epoch 170/200 |loss: 7.365836| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25
Epoch 171/200 |loss: 7.582248| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26
Epoch 172/200 |loss: 7.347149| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 27
Epoch 173/200 |loss: 7.323622| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 28
Epoch 174/200 |loss: 7.414668| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 29
Epoch 175/200 |loss: 7.421616| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 30
Epoch 176/200 |loss: 7.450703| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31
Epoch 177/200 |loss: 7.273901| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 32
Epoch 178/200 |loss: 7.258737| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 33
Epoch 179/200 |loss: 7.314794| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 34
Epoch 180/200 |loss: 7.368081| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 35
Epoch 181/200 |loss: 7.530920| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 36
Epoch 182/200 |loss: 7.296487| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 37
Epoch 183/200 |loss: 7.400959| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 38
Epoch 184/200 |loss: 7.797427| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 39
Epoch 185/200 |loss: 7.452716| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 40
Epoch 186/200 |loss: 7.419710| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 41
Epoch 187/200 |loss: 7.748432| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 42
Epoch 188/200 |loss: 7.474691| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 43
Epoch 189/200 |loss: 7.458115| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 44
Epoch 190/200 |loss: 7.866026| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 45
Epoch 191/200 |loss: 7.320281| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 46
Epoch 192/200 |loss: 7.750577| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 47
Epoch 193/200 |loss: 7.613400| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 48
Epoch 194/200 |loss: 7.454073| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 49
Epoch 195/200 |loss: 7.706282| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 50
Epoch 196/200 |loss: 7.412110| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 197/200 |loss: 7.545256| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 198/200 |loss: 7.342410| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 53
Epoch 199/200 |loss: 7.432206| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 54
Training per epoch cost 0.208 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 51, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 60, train speedup 5.388, test speedup 5.261, val speedup 5.547
best validation speedup epoch: 146, train speedup 5.316, test speedup 5.171, val speedup 5.588
last model at epoch 199, train speedup 5.389, test speedup 5.258, val speedup 5.548
execution cost 0:02:08.920972
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.876813, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290461| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282248| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696508| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.238125| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.746904| train set 3.226x speedup, test set 3.060x speedup, val set 3.218x speedup, step: 7
Epoch 7/200 |loss: 21.353819| train set 3.795x speedup, test set 3.673x speedup, val set 3.780x speedup, step: 8
Epoch 8/200 |loss: 20.910847| train set 3.797x speedup, test set 3.674x speedup, val set 3.782x speedup, step: 9
Epoch 9/200 |loss: 20.411451| train set 3.623x speedup, test set 3.431x speedup, val set 3.566x speedup, step: 10
Epoch 10/200 |loss: 19.953287| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.428829| train set 4.040x speedup, test set 3.851x speedup, val set 3.994x speedup, step: 12
Epoch 12/200 |loss: 18.877079| train set 4.154x speedup, test set 3.934x speedup, val set 4.127x speedup, step: 13
Epoch 13/200 |loss: 18.385633| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 14
Epoch 14/200 |loss: 17.908459| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 15
Epoch 15/200 |loss: 17.417931| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 16
Epoch 16/200 |loss: 16.964674| train set 4.485x speedup, test set 4.331x speedup, val set 4.432x speedup, step: 17
Epoch 17/200 |loss: 16.535517| train set 4.553x speedup, test set 4.318x speedup, val set 4.558x speedup, step: 18
Epoch 18/200 |loss: 16.094606| train set 4.655x speedup, test set 4.483x speedup, val set 4.585x speedup, step: 19
Epoch 19/200 |loss: 15.611969| train set 4.922x speedup, test set 4.794x speedup, val set 4.885x speedup, step: 20
Epoch 20/200 |loss: 15.145409| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 21
Epoch 21/200 |loss: 14.768912| train set 4.922x speedup, test set 4.794x speedup, val set 4.885x speedup, step: 22
Epoch 22/200 |loss: 14.454499| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 23
Epoch 23/200 |loss: 14.285787| train set 5.314x speedup, test set 5.226x speedup, val set 5.432x speedup, step: 24
Epoch 24/200 |loss: 13.908939| train set 5.180x speedup, test set 5.059x speedup, val set 5.333x speedup, step: 25
Epoch 25/200 |loss: 13.327287| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 26
Epoch 26/200 |loss: 12.990308| train set 5.327x speedup, test set 5.221x speedup, val set 5.504x speedup, step: 27
Epoch 27/200 |loss: 12.978373| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 28
Epoch 28/200 |loss: 12.664622| train set 5.172x speedup, test set 5.097x speedup, val set 5.287x speedup, step: 29
Epoch 29/200 |loss: 12.167992| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 30
Epoch 30/200 |loss: 12.123239| train set 5.169x speedup, test set 5.031x speedup, val set 5.356x speedup, step: 31
Epoch 31/200 |loss: 12.232270| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 32
Epoch 32/200 |loss: 11.563228| train set 5.383x speedup, test set 5.223x speedup, val set 5.550x speedup, step: 33
Epoch 33/200 |loss: 11.604630| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 34
Epoch 34/200 |loss: 11.267904| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 35
Epoch 35/200 |loss: 11.172452| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 36
Epoch 36/200 |loss: 10.883620| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.873366| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 38
Epoch 38/200 |loss: 10.331569| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 39
Epoch 39/200 |loss: 10.319221| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 40
Epoch 40/200 |loss: 10.173750| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 41
Epoch 41/200 |loss: 9.852208| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 42
Epoch 42/200 |loss: 9.720505| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 43
Epoch 43/200 |loss: 9.542996| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 44
Epoch 44/200 |loss: 9.561030| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 45
Epoch 45/200 |loss: 9.518511| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 46
Epoch 46/200 |loss: 9.410234| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 9.470443| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 48
Epoch 48/200 |loss: 9.193375| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 8.945520| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 50
Epoch 50/200 |loss: 8.885043| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 51
Epoch 51/200 |loss: 9.107327| train set 5.387x speedup, test set 5.261x speedup, val set 5.547x speedup, step: 52
Epoch 52/200 |loss: 9.307625| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 9.956322| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 54
Epoch 54/200 |loss: 8.953034| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 55
Epoch 55/200 |loss: 9.335874| train set 5.323x speedup, test set 5.165x speedup, val set 5.449x speedup, step: 56
Epoch 56/200 |loss: 9.283078| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 57/200 |loss: 9.098329| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 58/200 |loss: 8.867021| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 59/200 |loss: 9.042732| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 60
Epoch 60/200 |loss: 8.632925| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Epoch 61/200 |loss: 8.702971| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 62
Epoch 62/200 |loss: 8.591852| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 63/200 |loss: 8.510384| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 64
Epoch 64/200 |loss: 8.405635| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 65/200 |loss: 8.368939| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 66
Epoch 66/200 |loss: 8.316557| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 67
Epoch 67/200 |loss: 8.310511| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Epoch 68/200 |loss: 8.259408| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 69
Epoch 69/200 |loss: 8.174571| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 70/200 |loss: 8.107916| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 71/200 |loss: 8.220344| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 72/200 |loss: 8.180156| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 73
Epoch 73/200 |loss: 8.397477| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 74/200 |loss: 7.897886| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 75/200 |loss: 8.048120| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 76
Epoch 76/200 |loss: 8.630539| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 77
Epoch 77/200 |loss: 7.949683| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 78
Epoch 78/200 |loss: 8.449210| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 79
Epoch 79/200 |loss: 8.893041| train set 5.202x speedup, test set 5.066x speedup, val set 5.367x speedup, step: 80
Epoch 80/200 |loss: 8.726142| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 81
Epoch 81/200 |loss: 9.048178| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 82
Epoch 82/200 |loss: 8.381644| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 83/200 |loss: 8.392406| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 84/200 |loss: 8.190737| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 85/200 |loss: 8.500433| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 86/200 |loss: 8.134973| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 87
Epoch 87/200 |loss: 8.203073| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 88
Epoch 88/200 |loss: 8.180884| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 89
Epoch 89/200 |loss: 8.059939| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 90/200 |loss: 7.990639| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 91
Epoch 91/200 |loss: 8.032311| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 92
Epoch 92/200 |loss: 7.937402| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 93
Epoch 93/200 |loss: 7.848553| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 94
Epoch 94/200 |loss: 7.826457| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Epoch 95/200 |loss: 7.784036| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 96
Epoch 96/200 |loss: 7.692944| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 97
Epoch 97/200 |loss: 7.696498| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 98
Epoch 98/200 |loss: 7.651189| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 99
Epoch 99/200 |loss: 7.638580| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 100
Epoch 100/200 |loss: 7.573887| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 101/200 |loss: 7.589378| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 102/200 |loss: 7.521511| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 103/200 |loss: 7.541993| train set 5.384x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 104/200 |loss: 7.519437| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 105/200 |loss: 7.543622| train set 5.369x speedup, test set 5.236x speedup, val set 5.547x speedup, step: 1
Epoch 106/200 |loss: 7.626740| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 107/200 |loss: 7.810798| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 108/200 |loss: 8.392179| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 109/200 |loss: 7.624269| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 110/200 |loss: 7.737616| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 111/200 |loss: 8.328793| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 112/200 |loss: 7.617476| train set 5.312x speedup, test set 5.174x speedup, val set 5.566x speedup, step: 1
Epoch 113/200 |loss: 8.313441| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 114/200 |loss: 8.175863| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3
Epoch 115/200 |loss: 8.118420| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4
Epoch 116/200 |loss: 7.827638| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5
Epoch 117/200 |loss: 8.004837| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 6
Epoch 118/200 |loss: 7.661694| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Epoch 119/200 |loss: 7.914464| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8
Epoch 120/200 |loss: 7.623903| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9
Epoch 121/200 |loss: 7.821773| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10
Epoch 122/200 |loss: 7.519802| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11
Epoch 123/200 |loss: 7.696133| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12
Epoch 124/200 |loss: 7.514539| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13
Epoch 125/200 |loss: 7.624303| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14
Epoch 126/200 |loss: 7.463906| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15
Epoch 127/200 |loss: 7.547359| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16
Epoch 128/200 |loss: 7.424905| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17
Epoch 129/200 |loss: 7.515829| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 18
Epoch 130/200 |loss: 7.486920| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19
Epoch 131/200 |loss: 7.616953| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20
Epoch 132/200 |loss: 7.549911| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21
Epoch 133/200 |loss: 7.514866| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 22
Epoch 134/200 |loss: 7.372225| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23
Epoch 135/200 |loss: 7.390419| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24
Epoch 136/200 |loss: 7.430294| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25
Epoch 137/200 |loss: 7.461139| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26
Epoch 138/200 |loss: 7.421618| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 27
Epoch 139/200 |loss: 7.357759| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28
Epoch 140/200 |loss: 7.313745| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 29
Epoch 141/200 |loss: 7.324698| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 30
Epoch 142/200 |loss: 7.355954| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31
Epoch 143/200 |loss: 7.362334| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 32
Epoch 144/200 |loss: 7.333634| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 33
Epoch 145/200 |loss: 7.283429| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 34
Epoch 146/200 |loss: 7.276030| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 35
Epoch 147/200 |loss: 7.256508| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 36
Epoch 148/200 |loss: 7.285663| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 37
Epoch 149/200 |loss: 7.298752| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 38
Epoch 150/200 |loss: 7.382540| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 39
Epoch 151/200 |loss: 7.493273| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 40
Epoch 152/200 |loss: 8.140862| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 41
Epoch 153/200 |loss: 7.562377| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 42
Epoch 154/200 |loss: 7.370896| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 43
Epoch 155/200 |loss: 7.727904| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 44
Epoch 156/200 |loss: 7.510500| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 45
Epoch 157/200 |loss: 7.378363| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 46
Epoch 158/200 |loss: 7.398194| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 47
Epoch 159/200 |loss: 7.399655| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 48
Epoch 160/200 |loss: 7.320440| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 49
Epoch 161/200 |loss: 7.313256| train set 5.390x speedup, test set 5.266x speedup, val set 5.547x speedup, step: 50
Epoch 162/200 |loss: 7.344503| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 163/200 |loss: 7.316697| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 164/200 |loss: 7.285049| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 53
Epoch 165/200 |loss: 7.296434| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 54
Epoch 166/200 |loss: 7.333583| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 55
Epoch 167/200 |loss: 7.300851| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 168/200 |loss: 7.240205| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 169/200 |loss: 7.252047| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 170/200 |loss: 7.250415| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 171/200 |loss: 7.305323| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 60
Epoch 172/200 |loss: 7.314223| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Epoch 173/200 |loss: 7.335004| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 174/200 |loss: 7.308499| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 175/200 |loss: 7.483518| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 64
Epoch 176/200 |loss: 7.446664| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 65
Epoch 177/200 |loss: 7.513336| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 66
Epoch 178/200 |loss: 7.622961| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 67
Epoch 179/200 |loss: 7.223722| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 68
Epoch 180/200 |loss: 7.526390| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 69
Epoch 181/200 |loss: 7.923458| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 182/200 |loss: 7.486516| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 183/200 |loss: 7.909260| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 72
Epoch 184/200 |loss: 8.029921| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 73
Epoch 185/200 |loss: 7.690097| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 186/200 |loss: 8.068715| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 187/200 |loss: 7.604341| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 76
Epoch 188/200 |loss: 7.683004| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 77
Epoch 189/200 |loss: 7.726040| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 78
Epoch 190/200 |loss: 7.482717| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 79
Epoch 191/200 |loss: 7.588724| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 80
Epoch 192/200 |loss: 7.482646| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 81
Epoch 193/200 |loss: 7.451835| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 82
Epoch 194/200 |loss: 7.506442| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 195/200 |loss: 7.341962| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 196/200 |loss: 7.457941| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 197/200 |loss: 7.417715| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 198/200 |loss: 7.385184| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 87
Epoch 199/200 |loss: 7.408337| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Training per epoch cost 0.207 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 7.202s, pg runtime 31.019s, speedup 4.307x
08, opt runtime 7.913s, model runtime 7.913s, pg runtime 15.548s, speedup 1.965x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.590s, model runtime 4.223s, pg runtime 12.193s, speedup 2.887x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 161, train speedup 5.390, test speedup 5.266, val speedup 5.547
best test speedup epoch: 161, train speedup 5.390, test speedup 5.266, val speedup 5.547
best validation speedup epoch: 112, train speedup 5.312, test speedup 5.174, val speedup 5.566
last model at epoch 199, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:02:07.770696
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.877430, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290459| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282248| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696508| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.238121| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.746904| train set 3.226x speedup, test set 3.060x speedup, val set 3.218x speedup, step: 7
Epoch 7/200 |loss: 21.353819| train set 3.795x speedup, test set 3.673x speedup, val set 3.780x speedup, step: 8
Epoch 8/200 |loss: 20.910856| train set 3.797x speedup, test set 3.674x speedup, val set 3.782x speedup, step: 9
Epoch 9/200 |loss: 20.411489| train set 3.673x speedup, test set 3.431x speedup, val set 3.566x speedup, step: 10
Epoch 10/200 |loss: 19.953213| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.426908| train set 4.040x speedup, test set 3.851x speedup, val set 3.994x speedup, step: 12
Epoch 12/200 |loss: 18.877316| train set 4.154x speedup, test set 3.934x speedup, val set 4.127x speedup, step: 13
Epoch 13/200 |loss: 18.393377| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 14
Epoch 14/200 |loss: 17.921150| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 15
Epoch 15/200 |loss: 17.405390| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 16
Epoch 16/200 |loss: 16.921698| train set 4.390x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 17
Epoch 17/200 |loss: 16.449608| train set 4.504x speedup, test set 4.271x speedup, val set 4.505x speedup, step: 18
Epoch 18/200 |loss: 16.035387| train set 4.485x speedup, test set 4.331x speedup, val set 4.432x speedup, step: 19
Epoch 19/200 |loss: 15.721714| train set 4.835x speedup, test set 4.576x speedup, val set 4.920x speedup, step: 20
Epoch 20/200 |loss: 15.375506| train set 4.922x speedup, test set 4.794x speedup, val set 4.885x speedup, step: 21
Epoch 21/200 |loss: 14.807262| train set 5.314x speedup, test set 5.226x speedup, val set 5.432x speedup, step: 22
Epoch 22/200 |loss: 14.469589| train set 5.180x speedup, test set 5.059x speedup, val set 5.333x speedup, step: 23
Epoch 23/200 |loss: 14.192434| train set 5.103x speedup, test set 5.070x speedup, val set 5.180x speedup, step: 24
Epoch 24/200 |loss: 13.797717| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 25
Epoch 25/200 |loss: 13.313919| train set 5.389x speedup, test set 5.241x speedup, val set 5.550x speedup, step: 26
Epoch 26/200 |loss: 13.171128| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 27
Epoch 27/200 |loss: 12.926386| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 28
Epoch 28/200 |loss: 12.596457| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 29
Epoch 29/200 |loss: 12.080554| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 30
Epoch 30/200 |loss: 12.103468| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 31
Epoch 31/200 |loss: 12.076291| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 32
Epoch 32/200 |loss: 11.546613| train set 5.320x speedup, test set 5.186x speedup, val set 5.472x speedup, step: 33
Epoch 33/200 |loss: 11.951418| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 34
Epoch 34/200 |loss: 11.388330| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 35
Epoch 35/200 |loss: 11.005131| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 36
Epoch 36/200 |loss: 11.005235| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.589865| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 38
Epoch 38/200 |loss: 10.518579| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 39
Epoch 39/200 |loss: 10.363309| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 40
Epoch 40/200 |loss: 10.419831| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 41
Epoch 41/200 |loss: 10.293977| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 42
Epoch 42/200 |loss: 10.742919| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 43
Epoch 43/200 |loss: 9.878069| train set 5.387x speedup, test set 5.259x speedup, val set 5.553x speedup, step: 44
Epoch 44/200 |loss: 10.162911| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 45
Epoch 45/200 |loss: 9.886936| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 46
Epoch 46/200 |loss: 9.752258| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 47
Epoch 47/200 |loss: 9.561365| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 48
Epoch 48/200 |loss: 9.468167| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 49
Epoch 49/200 |loss: 9.384523| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 9.264706| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 51/200 |loss: 9.218906| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 52/200 |loss: 8.866000| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 53
Epoch 53/200 |loss: 9.052379| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 54
Epoch 54/200 |loss: 8.788793| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.961359| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 56
Epoch 56/200 |loss: 8.969654| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 57
Epoch 57/200 |loss: 8.838462| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 58
Epoch 58/200 |loss: 8.689092| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 59/200 |loss: 8.469622| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 60
Epoch 60/200 |loss: 8.366436| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Epoch 61/200 |loss: 8.345931| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 62
Epoch 62/200 |loss: 8.338432| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 63/200 |loss: 8.481584| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 64
Epoch 64/200 |loss: 8.521842| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 65
Epoch 65/200 |loss: 9.204805| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 66
Epoch 66/200 |loss: 10.790775| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 67
Epoch 67/200 |loss: 9.620461| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 68
Epoch 68/200 |loss: 9.787875| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 69
Epoch 69/200 |loss: 9.429216| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 70/200 |loss: 9.277003| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 71/200 |loss: 8.823820| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 72/200 |loss: 8.862351| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 73
Epoch 73/200 |loss: 8.903170| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 74/200 |loss: 8.456959| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 75/200 |loss: 8.662230| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 76
Epoch 76/200 |loss: 8.440942| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 77
Epoch 77/200 |loss: 8.457244| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 78
Epoch 78/200 |loss: 8.296817| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 79
Epoch 79/200 |loss: 8.303265| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 80
Epoch 80/200 |loss: 8.136894| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 81
Epoch 81/200 |loss: 8.187168| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 82
Epoch 82/200 |loss: 8.018393| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 83/200 |loss: 8.025921| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 84/200 |loss: 7.999820| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 85/200 |loss: 7.945638| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 86
Epoch 86/200 |loss: 7.885109| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 87
Epoch 87/200 |loss: 7.818438| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 88
Epoch 88/200 |loss: 7.834829| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 89
Epoch 89/200 |loss: 7.780698| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 90
Epoch 90/200 |loss: 7.796714| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 91
Epoch 91/200 |loss: 7.800164| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 92
Epoch 92/200 |loss: 7.881308| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 93
Epoch 93/200 |loss: 7.941671| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 94
Epoch 94/200 |loss: 8.132260| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Epoch 95/200 |loss: 7.745178| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 96
Epoch 96/200 |loss: 7.620972| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 97
Epoch 97/200 |loss: 7.730413| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 98
Epoch 98/200 |loss: 7.761429| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 99
Epoch 99/200 |loss: 7.837533| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 100
Epoch 100/200 |loss: 7.868741| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 101/200 |loss: 7.850855| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 102/200 |loss: 8.336339| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 103/200 |loss: 7.662745| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 104/200 |loss: 7.780179| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 105/200 |loss: 8.269306| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 106/200 |loss: 7.672289| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 1
Epoch 107/200 |loss: 8.376752| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 108/200 |loss: 8.334476| train set 5.388x speedup, test set 5.261x speedup, val set 5.547x speedup, step: 3
Epoch 109/200 |loss: 8.216493| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4
Epoch 110/200 |loss: 8.022754| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5
Epoch 111/200 |loss: 8.058000| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 6
Epoch 112/200 |loss: 7.773491| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Epoch 113/200 |loss: 7.973422| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8
Epoch 114/200 |loss: 7.764664| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9
Epoch 115/200 |loss: 7.862275| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10
Epoch 116/200 |loss: 7.673759| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11
Epoch 117/200 |loss: 7.822545| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12
Epoch 118/200 |loss: 7.600411| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13
Epoch 119/200 |loss: 7.769536| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 14
Epoch 120/200 |loss: 7.552508| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15
Epoch 121/200 |loss: 7.711882| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16
Epoch 122/200 |loss: 7.559526| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17
Epoch 123/200 |loss: 7.651776| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 18
Epoch 124/200 |loss: 7.489283| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 19
Epoch 125/200 |loss: 7.575440| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20
Epoch 126/200 |loss: 7.473226| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21
Epoch 127/200 |loss: 7.583376| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 22
Epoch 128/200 |loss: 7.462007| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23
Epoch 129/200 |loss: 7.505157| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24
Epoch 130/200 |loss: 7.385146| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25
Epoch 131/200 |loss: 7.426774| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26
Epoch 132/200 |loss: 7.359741| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 27
Epoch 133/200 |loss: 7.403552| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28
Epoch 134/200 |loss: 7.380568| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 29
Epoch 135/200 |loss: 7.419817| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 30
Epoch 136/200 |loss: 7.648082| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31
Epoch 137/200 |loss: 7.748516| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 32
Epoch 138/200 |loss: 8.212608| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 33
Epoch 139/200 |loss: 7.549960| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 34
Epoch 140/200 |loss: 7.900526| train set 5.350x speedup, test set 5.228x speedup, val set 5.539x speedup, step: 35
Epoch 141/200 |loss: 8.140100| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 36
Epoch 142/200 |loss: 7.617998| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 37
Epoch 143/200 |loss: 8.242449| train set 5.351x speedup, test set 5.229x speedup, val set 5.536x speedup, step: 38
Epoch 144/200 |loss: 7.968639| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 39
Epoch 145/200 |loss: 7.915938| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 40
Epoch 146/200 |loss: 7.724320| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 1
Epoch 147/200 |loss: 7.900161| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 148/200 |loss: 7.654961| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3
Epoch 149/200 |loss: 7.846229| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4
Epoch 150/200 |loss: 7.554591| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5
Epoch 151/200 |loss: 7.716805| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 6
Epoch 152/200 |loss: 7.565701| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Epoch 153/200 |loss: 7.576420| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8
Epoch 154/200 |loss: 7.553408| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9
Epoch 155/200 |loss: 7.489277| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 10
Epoch 156/200 |loss: 7.513386| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11
Epoch 157/200 |loss: 7.414206| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12
Epoch 158/200 |loss: 7.487813| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13
Epoch 159/200 |loss: 7.367876| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14
Epoch 160/200 |loss: 7.434799| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15
Epoch 161/200 |loss: 7.362743| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16
Epoch 162/200 |loss: 7.386722| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17
Epoch 163/200 |loss: 7.329374| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 18
Epoch 164/200 |loss: 7.367879| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19
Epoch 165/200 |loss: 7.318903| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20
Epoch 166/200 |loss: 7.320255| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21
Epoch 167/200 |loss: 7.302399| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 22
Epoch 168/200 |loss: 7.288556| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23
Epoch 169/200 |loss: 7.283875| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24
Epoch 170/200 |loss: 7.263213| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25
Epoch 171/200 |loss: 7.268974| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26
Epoch 172/200 |loss: 7.253650| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 27
Epoch 173/200 |loss: 7.250133| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28
Epoch 174/200 |loss: 7.242257| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 29
Epoch 175/200 |loss: 7.247659| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 30
Epoch 176/200 |loss: 7.261812| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31
Epoch 177/200 |loss: 7.329524| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 32
Epoch 178/200 |loss: 7.467853| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 33
Epoch 179/200 |loss: 7.475253| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 34
Epoch 180/200 |loss: 7.541449| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 35
Epoch 181/200 |loss: 7.346422| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 36
Epoch 182/200 |loss: 7.329109| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 37
Epoch 183/200 |loss: 7.583925| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 38
Epoch 184/200 |loss: 7.268008| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 39
Epoch 185/200 |loss: 7.369661| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 40
Epoch 186/200 |loss: 7.804555| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 41
Epoch 187/200 |loss: 7.319141| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 42
Epoch 188/200 |loss: 7.817372| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 43
Epoch 189/200 |loss: 7.811412| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 44
Epoch 190/200 |loss: 7.601684| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 45
Epoch 191/200 |loss: 7.682750| train set 5.388x speedup, test set 5.261x speedup, val set 5.547x speedup, step: 46
Epoch 192/200 |loss: 7.518007| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 47
Epoch 193/200 |loss: 7.668402| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 48
Epoch 194/200 |loss: 7.423372| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 49
Epoch 195/200 |loss: 7.562103| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 50
Epoch 196/200 |loss: 7.410098| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 197/200 |loss: 7.445820| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 198/200 |loss: 7.374762| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 53
Epoch 199/200 |loss: 7.456060| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 54
Training per epoch cost 0.203 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 108, train speedup 5.388, test speedup 5.261, val speedup 5.547
best validation speedup epoch: 146, train speedup 5.316, test speedup 5.171, val speedup 5.588
last model at epoch 199, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:02:07.113211
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.873074, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.976044| train set 3.323x speedup, test set 3.211x speedup, val set 3.319x speedup, step: 1
Epoch 1/200 |loss: 24.290459| train set 3.086x speedup, test set 2.868x speedup, val set 3.050x speedup, step: 2
Epoch 2/200 |loss: 23.744152| train set 3.294x speedup, test set 3.072x speedup, val set 3.216x speedup, step: 3
Epoch 3/200 |loss: 23.282272| train set 3.208x speedup, test set 3.000x speedup, val set 3.139x speedup, step: 4
Epoch 4/200 |loss: 22.696487| train set 3.420x speedup, test set 3.244x speedup, val set 3.390x speedup, step: 5
Epoch 5/200 |loss: 22.237480| train set 3.239x speedup, test set 3.067x speedup, val set 3.261x speedup, step: 6
Epoch 6/200 |loss: 21.742975| train set 3.234x speedup, test set 3.063x speedup, val set 3.256x speedup, step: 7
Epoch 7/200 |loss: 21.334393| train set 3.508x speedup, test set 3.358x speedup, val set 3.496x speedup, step: 8
Epoch 8/200 |loss: 20.891764| train set 3.943x speedup, test set 3.756x speedup, val set 3.937x speedup, step: 9
Epoch 9/200 |loss: 20.387966| train set 3.996x speedup, test set 3.804x speedup, val set 3.972x speedup, step: 10
Epoch 10/200 |loss: 19.925268| train set 3.949x speedup, test set 3.759x speedup, val set 3.930x speedup, step: 11
Epoch 11/200 |loss: 19.387463| train set 4.154x speedup, test set 3.964x speedup, val set 4.127x speedup, step: 12
Epoch 12/200 |loss: 18.821791| train set 4.154x speedup, test set 3.964x speedup, val set 4.127x speedup, step: 13
Epoch 13/200 |loss: 18.298084| train set 4.470x speedup, test set 4.247x speedup, val set 4.482x speedup, step: 14
Epoch 14/200 |loss: 17.807497| train set 4.390x speedup, test set 4.176x speedup, val set 4.406x speedup, step: 15
Epoch 15/200 |loss: 17.285664| train set 4.010x speedup, test set 3.773x speedup, val set 4.025x speedup, step: 16
Epoch 16/200 |loss: 16.805946| train set 4.282x speedup, test set 3.899x speedup, val set 4.432x speedup, step: 17
Epoch 17/200 |loss: 16.375235| train set 4.504x speedup, test set 4.271x speedup, val set 4.505x speedup, step: 18
Epoch 18/200 |loss: 16.006578| train set 4.550x speedup, test set 4.406x speedup, val set 4.485x speedup, step: 19
Epoch 19/200 |loss: 15.756987| train set 4.922x speedup, test set 4.794x speedup, val set 4.885x speedup, step: 20
Epoch 20/200 |loss: 15.355422| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 21
Epoch 21/200 |loss: 14.747106| train set 4.950x speedup, test set 4.762x speedup, val set 4.952x speedup, step: 22
Epoch 22/200 |loss: 14.520332| train set 4.993x speedup, test set 4.784x speedup, val set 5.021x speedup, step: 23
Epoch 23/200 |loss: 14.243621| train set 5.364x speedup, test set 5.253x speedup, val set 5.515x speedup, step: 24
Epoch 24/200 |loss: 13.776590| train set 4.993x speedup, test set 4.784x speedup, val set 5.021x speedup, step: 25
Epoch 25/200 |loss: 13.457329| train set 5.169x speedup, test set 5.031x speedup, val set 5.356x speedup, step: 26
Epoch 26/200 |loss: 13.268494| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 27
Epoch 27/200 |loss: 12.750294| train set 5.164x speedup, test set 4.958x speedup, val set 5.181x speedup, step: 28
Epoch 28/200 |loss: 12.582891| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 29
Epoch 29/200 |loss: 12.211281| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 30
Epoch 30/200 |loss: 11.913490| train set 5.169x speedup, test set 5.031x speedup, val set 5.356x speedup, step: 31
Epoch 31/200 |loss: 11.918280| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 32
Epoch 32/200 |loss: 11.518956| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 33
Epoch 33/200 |loss: 11.309752| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 34
Epoch 34/200 |loss: 11.026701| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 35
Epoch 35/200 |loss: 11.071867| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 36
Epoch 36/200 |loss: 11.418445| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 37
Epoch 37/200 |loss: 10.582150| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 38
Epoch 38/200 |loss: 10.375073| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 39
Epoch 39/200 |loss: 10.283641| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 40
Epoch 40/200 |loss: 10.106877| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 41
Epoch 41/200 |loss: 9.902055| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 42
Epoch 42/200 |loss: 9.862982| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 43
Epoch 43/200 |loss: 9.914020| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 44
Epoch 44/200 |loss: 9.729796| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 45
Epoch 45/200 |loss: 9.552947| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 46
Epoch 46/200 |loss: 9.430887| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 47
Epoch 47/200 |loss: 9.016179| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 48
Epoch 48/200 |loss: 9.202412| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 49
Epoch 49/200 |loss: 8.948334| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 9.230617| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 51/200 |loss: 9.412981| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 9.972396| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 53
Epoch 53/200 |loss: 9.102090| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 54
Epoch 54/200 |loss: 9.487337| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 9.484292| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 56/200 |loss: 9.015821| train set 5.320x speedup, test set 5.187x speedup, val set 5.469x speedup, step: 57
Epoch 57/200 |loss: 9.378362| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 58
Epoch 58/200 |loss: 8.981305| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 59
Epoch 59/200 |loss: 8.899664| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 60
Epoch 60/200 |loss: 8.787311| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Epoch 61/200 |loss: 8.765998| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 62
Epoch 62/200 |loss: 8.579405| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 63
Epoch 63/200 |loss: 8.566056| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 64
Epoch 64/200 |loss: 8.455626| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 65
Epoch 65/200 |loss: 8.348290| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 66
Epoch 66/200 |loss: 8.397616| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 67
Epoch 67/200 |loss: 8.245642| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 68
Epoch 68/200 |loss: 8.223724| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 69
Epoch 69/200 |loss: 8.214698| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 70
Epoch 70/200 |loss: 7.981355| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 71
Epoch 71/200 |loss: 8.107138| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 72
Epoch 72/200 |loss: 7.989856| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 73
Epoch 73/200 |loss: 8.004481| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 74
Epoch 74/200 |loss: 7.900843| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 75
Epoch 75/200 |loss: 8.007730| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 76
Epoch 76/200 |loss: 8.040956| train set 5.199x speedup, test set 5.057x speedup, val set 5.360x speedup, step: 77
Epoch 77/200 |loss: 8.723525| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 78
Epoch 78/200 |loss: 9.473138| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 79
Epoch 79/200 |loss: 8.797863| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 80
Epoch 80/200 |loss: 8.461275| train set 5.169x speedup, test set 5.032x speedup, val set 5.353x speedup, step: 81
Epoch 81/200 |loss: 8.848606| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 82
Epoch 82/200 |loss: 8.289051| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 83
Epoch 83/200 |loss: 8.314882| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 84
Epoch 84/200 |loss: 8.357275| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 85
Epoch 85/200 |loss: 8.254869| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 86
Epoch 86/200 |loss: 8.020068| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 87
Epoch 87/200 |loss: 8.174684| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 88
Epoch 88/200 |loss: 7.953665| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 89
Epoch 89/200 |loss: 7.989684| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 90
Epoch 90/200 |loss: 8.019751| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 91
Epoch 91/200 |loss: 7.962847| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 92
Epoch 92/200 |loss: 8.122952| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 93
Epoch 93/200 |loss: 7.931855| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 94
Epoch 94/200 |loss: 7.883547| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 95
Epoch 95/200 |loss: 7.714000| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 96
Epoch 96/200 |loss: 7.681093| train set 5.369x speedup, test set 5.224x speedup, val set 5.547x speedup, step: 97
Epoch 97/200 |loss: 7.724829| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 98
Epoch 98/200 |loss: 7.740886| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 99
Epoch 99/200 |loss: 7.811226| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 100
Epoch 100/200 |loss: 7.642058| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 101/200 |loss: 7.601196| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 102/200 |loss: 7.588857| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 103/200 |loss: 7.564698| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 104/200 |loss: 7.728657| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 105/200 |loss: 7.704253| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 106/200 |loss: 7.780441| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 107/200 |loss: 7.525983| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 108/200 |loss: 7.432745| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 109/200 |loss: 7.416798| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 110/200 |loss: 7.496112| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 111/200 |loss: 7.673134| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 112/200 |loss: 7.630054| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 113/200 |loss: 7.699935| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 114/200 |loss: 7.437608| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 115/200 |loss: 7.417783| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 116/200 |loss: 7.548687| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 117/200 |loss: 7.520821| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 118/200 |loss: 7.540150| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 119/200 |loss: 7.398439| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 120/200 |loss: 7.445081| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 121/200 |loss: 7.659799| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 122/200 |loss: 7.424145| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 123/200 |loss: 7.489642| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 124/200 |loss: 7.752819| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 125/200 |loss: 7.472121| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 126/200 |loss: 7.360882| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 127/200 |loss: 7.586915| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 128/200 |loss: 7.412908| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 129/200 |loss: 7.313857| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 130/200 |loss: 7.387831| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 131/200 |loss: 7.386868| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 132/200 |loss: 7.379711| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2
Epoch 133/200 |loss: 7.431876| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 3
Epoch 134/200 |loss: 7.607024| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 4
Epoch 135/200 |loss: 8.178615| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1
Epoch 136/200 |loss: 7.447114| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 2
Epoch 137/200 |loss: 8.000673| train set 5.350x speedup, test set 5.228x speedup, val set 5.539x speedup, step: 3
Epoch 138/200 |loss: 8.465798| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 4
Epoch 139/200 |loss: 7.760609| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 1
Epoch 140/200 |loss: 8.345020| train set 5.172x speedup, test set 5.099x speedup, val set 5.285x speedup, step: 2
Epoch 141/200 |loss: 7.910635| train set 5.388x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3
Epoch 142/200 |loss: 7.832903| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4
Epoch 143/200 |loss: 7.762098| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5
Epoch 144/200 |loss: 7.750674| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 6
Epoch 145/200 |loss: 7.678909| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7
Epoch 146/200 |loss: 7.674136| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8
Epoch 147/200 |loss: 7.667369| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9
Epoch 148/200 |loss: 7.489674| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10
Epoch 149/200 |loss: 7.605860| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11
Epoch 150/200 |loss: 7.409380| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12
Epoch 151/200 |loss: 7.554604| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13
Epoch 152/200 |loss: 7.408291| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14
Epoch 153/200 |loss: 7.429734| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15
Epoch 154/200 |loss: 7.408203| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16
Epoch 155/200 |loss: 7.357422| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17
Epoch 156/200 |loss: 7.373730| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 18
Epoch 157/200 |loss: 7.332709| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19
Epoch 158/200 |loss: 7.322226| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20
Epoch 159/200 |loss: 7.309672| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21
Epoch 160/200 |loss: 7.289668| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 22
Epoch 161/200 |loss: 7.283348| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23
Epoch 162/200 |loss: 7.264762| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24
Epoch 163/200 |loss: 7.275404| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25
Epoch 164/200 |loss: 7.250067| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26
Epoch 165/200 |loss: 7.265185| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 27
Epoch 166/200 |loss: 7.292973| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28
Epoch 167/200 |loss: 7.425543| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 29
Epoch 168/200 |loss: 7.447647| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 30
Epoch 169/200 |loss: 7.849286| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31
Epoch 170/200 |loss: 7.337516| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 32
Epoch 171/200 |loss: 7.501184| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 33
Epoch 172/200 |loss: 8.218760| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 34
Epoch 173/200 |loss: 7.325422| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 35
Epoch 174/200 |loss: 8.469863| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 36
Epoch 175/200 |loss: 7.973125| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 37
Epoch 176/200 |loss: 8.047780| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 38
Epoch 177/200 |loss: 7.744374| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 39
Epoch 178/200 |loss: 7.848033| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 40
Epoch 179/200 |loss: 7.695758| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 41
Epoch 180/200 |loss: 7.669250| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 42
Epoch 181/200 |loss: 7.677110| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 43
Epoch 182/200 |loss: 7.512039| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 44
Epoch 183/200 |loss: 7.620532| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 45
Epoch 184/200 |loss: 7.459353| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 46
Epoch 185/200 |loss: 7.513352| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 47
Epoch 186/200 |loss: 7.428762| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 48
Epoch 187/200 |loss: 7.448720| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 49
Epoch 188/200 |loss: 7.391957| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 50
Epoch 189/200 |loss: 7.364807| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 51
Epoch 190/200 |loss: 7.374934| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 52
Epoch 191/200 |loss: 7.331307| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 53
Epoch 192/200 |loss: 7.337633| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 54
Epoch 193/200 |loss: 7.290515| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 55
Epoch 194/200 |loss: 7.302136| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 56
Epoch 195/200 |loss: 7.270605| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 57
Epoch 196/200 |loss: 7.278023| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 58
Epoch 197/200 |loss: 7.243589| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 59
Epoch 198/200 |loss: 7.262053| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 60
Epoch 199/200 |loss: 7.246568| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 61
Training per epoch cost 0.205 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 33, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 79, train speedup 5.387, test speedup 5.261, val speedup 5.550
best validation speedup epoch: 139, train speedup 5.316, test speedup 5.171, val speedup 5.588
last model at epoch 199, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:02:07.400070
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.134855, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995949| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037216| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524662| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074562| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570393| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.079531| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586479| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.067806| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 14
Epoch 14/200 |loss: 17.602137| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.146929| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 16
Epoch 16/200 |loss: 16.682730| train set 4.552x speedup, test set 4.339x speedup, val set 4.345x speedup, step: 17
Epoch 17/200 |loss: 16.274240| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 18
Epoch 18/200 |loss: 15.853537| train set 4.702x speedup, test set 4.509x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.446270| train set 4.832x speedup, test set 4.681x speedup, val set 4.526x speedup, step: 20
Epoch 20/200 |loss: 15.073397| train set 4.978x speedup, test set 4.777x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.585343| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.155015| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 13.886172| train set 5.456x speedup, test set 5.358x speedup, val set 5.072x speedup, step: 24
Epoch 24/200 |loss: 13.651081| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.596194| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.333137| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.536123| train set 5.308x speedup, test set 5.189x speedup, val set 4.963x speedup, step: 28
Epoch 28/200 |loss: 12.659408| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.382206| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 30/200 |loss: 11.763570| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.939219| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 32/200 |loss: 11.702450| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 12.006692| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 10.953775| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 35
Epoch 35/200 |loss: 11.659110| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 36
Epoch 36/200 |loss: 11.050830| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 11.066203| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 38
Epoch 38/200 |loss: 10.592166| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 39
Epoch 39/200 |loss: 10.839200| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.215355| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 10.149906| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 10.061247| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.681766| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 9.856915| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.436846| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.401728| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.227208| train set 5.450x speedup, test set 5.222x speedup, val set 5.054x speedup, step: 48
Epoch 48/200 |loss: 9.338873| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.238455| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 10.243299| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 51
Epoch 51/200 |loss: 10.218028| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.083767| train set 5.465x speedup, test set 5.421x speedup, val set 5.128x speedup, step: 53
Epoch 53/200 |loss: 9.247974| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.766413| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.745331| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 9.381041| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.833173| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.906049| train set 5.450x speedup, test set 5.222x speedup, val set 5.054x speedup, step: 59
Epoch 59/200 |loss: 8.951447| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.510740| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.723835| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.433544| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 8.682414| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.463584| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 65
Epoch 65/200 |loss: 8.378716| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.399643| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.196359| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.188059| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.110442| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.103359| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.044169| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 72
Epoch 72/200 |loss: 8.093710| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 73
Epoch 73/200 |loss: 8.525594| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 74
Epoch 74/200 |loss: 8.418113| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 8.433203| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.017776| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 77
Epoch 77/200 |loss: 8.524906| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 78
Epoch 78/200 |loss: 8.445847| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.197402| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 80
Epoch 80/200 |loss: 8.332913| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 81
Epoch 81/200 |loss: 7.983996| train set 5.498x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 82
Epoch 82/200 |loss: 8.107226| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 83
Epoch 83/200 |loss: 7.856361| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 7.957630| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.880672| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 86
Epoch 86/200 |loss: 7.848589| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 87
Epoch 87/200 |loss: 7.861761| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.990545| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.848928| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 90
Epoch 90/200 |loss: 7.819412| train set 5.460x speedup, test set 5.375x speedup, val set 5.204x speedup, step: 91
Epoch 91/200 |loss: 7.873404| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.713650| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 93
Epoch 93/200 |loss: 7.661963| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 7.662268| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 95
Epoch 95/200 |loss: 7.625519| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 7.543990| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 7.552331| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 98
Epoch 98/200 |loss: 7.530460| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.607888| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.638417| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 1
Epoch 101/200 |loss: 7.742463| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 102/200 |loss: 7.635392| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3
Epoch 103/200 |loss: 7.583867| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 104/200 |loss: 8.058384| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 2
Epoch 105/200 |loss: 7.616000| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 3
Epoch 106/200 |loss: 7.558510| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 4
Epoch 107/200 |loss: 7.540755| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 5
Epoch 108/200 |loss: 7.639445| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6
Epoch 109/200 |loss: 7.667773| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 7
Epoch 110/200 |loss: 7.450902| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 8
Epoch 111/200 |loss: 7.473176| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 9
Epoch 112/200 |loss: 7.550434| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 10
Epoch 113/200 |loss: 7.524931| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 11
Epoch 114/200 |loss: 7.414438| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 12
Epoch 115/200 |loss: 7.362196| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 13
Epoch 116/200 |loss: 7.424419| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 14
Epoch 117/200 |loss: 7.559424| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 15
Epoch 118/200 |loss: 7.467725| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16
Epoch 119/200 |loss: 7.363540| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17
Epoch 120/200 |loss: 7.338557| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 18
Epoch 121/200 |loss: 7.397084| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 122/200 |loss: 7.810236| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 123/200 |loss: 7.395709| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 3
Epoch 124/200 |loss: 7.346589| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 125/200 |loss: 7.594570| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 5
Epoch 126/200 |loss: 7.564721| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6
Epoch 127/200 |loss: 7.375650| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7
Epoch 128/200 |loss: 7.332007| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 8
Epoch 129/200 |loss: 7.417843| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 9
Epoch 130/200 |loss: 7.572620| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 10
Epoch 131/200 |loss: 7.422555| train set 5.449x speedup, test set 5.331x speedup, val set 5.065x speedup, step: 11
Epoch 132/200 |loss: 7.362453| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 12
Epoch 133/200 |loss: 7.571233| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13
Epoch 134/200 |loss: 7.361962| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 14
Epoch 135/200 |loss: 7.266581| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 15
Epoch 136/200 |loss: 7.352311| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16
Epoch 137/200 |loss: 7.308307| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17
Epoch 138/200 |loss: 7.254993| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18
Epoch 139/200 |loss: 7.236467| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19
Epoch 140/200 |loss: 7.308288| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 141/200 |loss: 7.411642| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21
Epoch 142/200 |loss: 7.420418| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 22
Epoch 143/200 |loss: 7.436562| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23
Epoch 144/200 |loss: 7.365911| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 24
Epoch 145/200 |loss: 7.335299| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 25
Epoch 146/200 |loss: 7.454304| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 26
Epoch 147/200 |loss: 7.360494| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 148/200 |loss: 7.294065| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 28
Epoch 149/200 |loss: 7.276926| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 29
Epoch 150/200 |loss: 7.372382| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 30
Epoch 151/200 |loss: 7.350605| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 31
Epoch 152/200 |loss: 7.251299| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 32
Epoch 153/200 |loss: 7.178532| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 33
Epoch 154/200 |loss: 7.266997| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 34
Epoch 155/200 |loss: 7.322147| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 35
Epoch 156/200 |loss: 7.318481| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 36
Epoch 157/200 |loss: 7.393219| train set 5.498x speedup, test set 5.421x speedup, val set 5.114x speedup, step: 37
Epoch 158/200 |loss: 7.227290| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 38
Epoch 159/200 |loss: 7.330783| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 39
Epoch 160/200 |loss: 7.386348| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 161/200 |loss: 7.295718| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 162/200 |loss: 7.247898| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 163/200 |loss: 7.260284| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 164/200 |loss: 7.280899| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 44
Epoch 165/200 |loss: 7.329119| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 166/200 |loss: 7.216126| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 46
Epoch 167/200 |loss: 7.274058| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 47
Epoch 168/200 |loss: 7.669192| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 48
Epoch 169/200 |loss: 7.309101| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 49
Epoch 170/200 |loss: 7.316859| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 50
Epoch 171/200 |loss: 7.264100| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 51
Epoch 172/200 |loss: 7.290505| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 52
Epoch 173/200 |loss: 7.444653| train set 5.499x speedup, test set 5.403x speedup, val set 5.109x speedup, step: 53
Epoch 174/200 |loss: 7.265855| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 54
Epoch 175/200 |loss: 7.419100| train set 5.450x speedup, test set 5.315x speedup, val set 5.070x speedup, step: 55
Epoch 176/200 |loss: 7.363386| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 177/200 |loss: 7.438415| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 57
Epoch 178/200 |loss: 7.230743| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 179/200 |loss: 7.233327| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 180/200 |loss: 7.308534| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 60
Epoch 181/200 |loss: 7.278575| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 182/200 |loss: 7.276816| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 183/200 |loss: 7.352723| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 63
Epoch 184/200 |loss: 7.663384| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 64
Epoch 185/200 |loss: 7.241824| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 186/200 |loss: 7.558265| train set 5.498x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 66
Epoch 187/200 |loss: 8.126062| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 67
Epoch 188/200 |loss: 7.459285| train set 5.426x speedup, test set 5.395x speedup, val set 4.961x speedup, step: 68
Epoch 189/200 |loss: 8.127684| train set 5.307x speedup, test set 5.189x speedup, val set 4.965x speedup, step: 69
Epoch 190/200 |loss: 7.681757| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 70
Epoch 191/200 |loss: 7.668229| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 71
Epoch 192/200 |loss: 7.655132| train set 5.497x speedup, test set 5.422x speedup, val set 5.103x speedup, step: 72
Epoch 193/200 |loss: 7.639699| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 73
Epoch 194/200 |loss: 7.457484| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 74
Epoch 195/200 |loss: 7.535219| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 196/200 |loss: 7.352993| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 197/200 |loss: 7.424760| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 77
Epoch 198/200 |loss: 7.330095| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 78
Epoch 199/200 |loss: 7.348609| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Training per epoch cost 0.202 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 144, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 42, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 121, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 199, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:02:08.172034
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.111231, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055296| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995949| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037214| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524662| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074562| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570393| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.079531| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586479| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.067806| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 14
Epoch 14/200 |loss: 17.602137| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.146929| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 16
Epoch 16/200 |loss: 16.682732| train set 4.552x speedup, test set 4.339x speedup, val set 4.345x speedup, step: 17
Epoch 17/200 |loss: 16.274242| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 18
Epoch 18/200 |loss: 15.853737| train set 4.702x speedup, test set 4.509x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.445741| train set 4.803x speedup, test set 4.643x speedup, val set 4.539x speedup, step: 20
Epoch 20/200 |loss: 15.071044| train set 4.978x speedup, test set 4.777x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.586793| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.157400| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 13.888359| train set 5.456x speedup, test set 5.358x speedup, val set 5.072x speedup, step: 24
Epoch 24/200 |loss: 13.646111| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.608920| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.321939| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.552599| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 28
Epoch 28/200 |loss: 12.681885| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.411145| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 30
Epoch 30/200 |loss: 11.959016| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.780361| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 32/200 |loss: 11.528634| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.824442| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 11.009147| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 35
Epoch 35/200 |loss: 11.205523| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 11.000020| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.856070| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.434244| train set 5.450x speedup, test set 5.312x speedup, val set 5.194x speedup, step: 39
Epoch 39/200 |loss: 10.713243| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.194467| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 41
Epoch 41/200 |loss: 10.633827| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 42
Epoch 42/200 |loss: 10.809901| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.747293| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 10.321989| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.592541| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.939151| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.405459| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.571222| train set 5.498x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 49
Epoch 49/200 |loss: 9.409680| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.280625| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.097153| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.141559| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 9.005474| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 8.999554| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.814959| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.665725| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 57
Epoch 57/200 |loss: 8.627579| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.602226| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.527843| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.641824| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.513961| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.525661| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 63
Epoch 63/200 |loss: 8.553475| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.421919| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.583072| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.639084| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.192693| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 68
Epoch 68/200 |loss: 8.356216| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.522001| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.047574| train set 5.448x speedup, test set 5.331x speedup, val set 5.064x speedup, step: 71
Epoch 71/200 |loss: 8.512520| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 72
Epoch 72/200 |loss: 8.702807| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.365399| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 74
Epoch 74/200 |loss: 8.940276| train set 5.497x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 75
Epoch 75/200 |loss: 8.241674| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.404089| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 77
Epoch 77/200 |loss: 8.101566| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 78
Epoch 78/200 |loss: 8.237629| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.287439| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 8.284169| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 81
Epoch 81/200 |loss: 8.108251| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 8.071766| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 83
Epoch 83/200 |loss: 7.941493| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 8.085979| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 85
Epoch 85/200 |loss: 7.996341| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 86
Epoch 86/200 |loss: 8.049045| train set 5.497x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 87
Epoch 87/200 |loss: 7.779565| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.852582| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.852883| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 90
Epoch 90/200 |loss: 7.830234| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.794488| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.659879| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 93
Epoch 93/200 |loss: 7.723522| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 7.630074| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 7.647402| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 7.564694| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 7.571280| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 98
Epoch 98/200 |loss: 7.520417| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.511572| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.507454| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 101/200 |loss: 7.496856| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 1
Epoch 102/200 |loss: 7.637074| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 103/200 |loss: 8.015437| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 3
Epoch 104/200 |loss: 8.829013| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 1
Epoch 105/200 |loss: 9.265253| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 106/200 |loss: 8.814295| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 3
Epoch 107/200 |loss: 9.192347| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 4
Epoch 108/200 |loss: 8.358335| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5
Epoch 109/200 |loss: 8.423383| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6
Epoch 110/200 |loss: 8.529390| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 111/200 |loss: 8.309067| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 8
Epoch 112/200 |loss: 8.316832| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 9
Epoch 113/200 |loss: 8.082348| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 10
Epoch 114/200 |loss: 8.028903| train set 5.498x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 11
Epoch 115/200 |loss: 8.026341| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 12
Epoch 116/200 |loss: 7.818414| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 13
Epoch 117/200 |loss: 7.859241| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 14
Epoch 118/200 |loss: 7.853339| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 15
Epoch 119/200 |loss: 7.759074| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 16
Epoch 120/200 |loss: 7.703904| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 17
Epoch 121/200 |loss: 7.714495| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 18
Epoch 122/200 |loss: 7.604012| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 19
Epoch 123/200 |loss: 7.645827| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 1
Epoch 124/200 |loss: 7.721634| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 2
Epoch 125/200 |loss: 7.549526| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 3
Epoch 126/200 |loss: 7.532350| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 4
Epoch 127/200 |loss: 7.508402| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 5
Epoch 128/200 |loss: 7.578081| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6
Epoch 129/200 |loss: 7.517996| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7
Epoch 130/200 |loss: 7.475625| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 8
Epoch 131/200 |loss: 7.382591| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 9
Epoch 132/200 |loss: 7.442246| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 10
Epoch 133/200 |loss: 7.444099| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 11
Epoch 134/200 |loss: 7.459777| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 12
Epoch 135/200 |loss: 7.376574| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 13
Epoch 136/200 |loss: 7.317497| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 14
Epoch 137/200 |loss: 7.330657| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 15
Epoch 138/200 |loss: 7.359969| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16
Epoch 139/200 |loss: 7.452278| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 17
Epoch 140/200 |loss: 7.422238| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18
Epoch 141/200 |loss: 7.477173| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 19
Epoch 142/200 |loss: 7.328366| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 143/200 |loss: 7.256341| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21
Epoch 144/200 |loss: 7.252379| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 22
Epoch 145/200 |loss: 7.285467| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23
Epoch 146/200 |loss: 7.367039| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 24
Epoch 147/200 |loss: 7.320749| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 25
Epoch 148/200 |loss: 7.280965| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 149/200 |loss: 7.224634| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 27
Epoch 150/200 |loss: 7.214991| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 151/200 |loss: 7.236205| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 29
Epoch 152/200 |loss: 7.258798| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 153/200 |loss: 7.318935| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 31
Epoch 154/200 |loss: 7.322361| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 155/200 |loss: 7.455499| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 33
Epoch 156/200 |loss: 7.399226| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 34
Epoch 157/200 |loss: 7.442795| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 35
Epoch 158/200 |loss: 7.279838| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 36
Epoch 159/200 |loss: 7.244309| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 37
Epoch 160/200 |loss: 7.409648| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 38
Epoch 161/200 |loss: 7.373488| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 39
Epoch 162/200 |loss: 7.300047| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 163/200 |loss: 7.182853| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 164/200 |loss: 7.265223| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 165/200 |loss: 7.443177| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 166/200 |loss: 7.226912| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 44
Epoch 167/200 |loss: 7.193716| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 168/200 |loss: 7.329756| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 169/200 |loss: 7.283091| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 170/200 |loss: 7.180794| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 48
Epoch 171/200 |loss: 7.250895| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 172/200 |loss: 7.293486| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 50
Epoch 173/200 |loss: 7.279408| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 51
Epoch 174/200 |loss: 7.168056| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 52
Epoch 175/200 |loss: 7.220948| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 53
Epoch 176/200 |loss: 7.303153| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 54
Epoch 177/200 |loss: 7.155472| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 55
Epoch 178/200 |loss: 7.202709| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 179/200 |loss: 7.265838| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 180/200 |loss: 7.224219| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 181/200 |loss: 7.166934| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 59
Epoch 182/200 |loss: 7.288473| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 183/200 |loss: 7.423114| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 61
Epoch 184/200 |loss: 7.375388| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 185/200 |loss: 7.583257| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 63
Epoch 186/200 |loss: 7.294947| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 64
Epoch 187/200 |loss: 7.340726| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 188/200 |loss: 7.338099| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 66
Epoch 189/200 |loss: 7.275720| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 190/200 |loss: 7.383526| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 68
Epoch 191/200 |loss: 7.313626| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 69
Epoch 192/200 |loss: 7.290646| train set 5.497x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 70
Epoch 193/200 |loss: 7.286246| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 71
Epoch 194/200 |loss: 7.308514| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 72
Epoch 195/200 |loss: 7.295549| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 73
Epoch 196/200 |loss: 7.156001| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 74
Epoch 197/200 |loss: 7.316677| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 198/200 |loss: 7.321767| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 199/200 |loss: 7.186145| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 77
Training per epoch cost 0.206 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.309s, pg runtime 1.356s, speedup 1.036x
20, opt runtime 1.340s, model runtime 1.490s, pg runtime 1.340s, speedup 0.899x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 48, train speedup 5.498, test speedup 5.421, val speedup 5.103
best test speedup epoch: 51, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 123, train speedup 5.450, test speedup 5.310, val speedup 5.195
last model at epoch 199, train speedup 5.496, test speedup 5.420, val speedup 5.107
execution cost 0:02:09.353287
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.145131, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511551| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037216| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524693| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074823| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570261| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.080355| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.587557| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.083212| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 14
Epoch 14/200 |loss: 17.617689| train set 4.548x speedup, test set 4.360x speedup, val set 4.274x speedup, step: 15
Epoch 15/200 |loss: 17.116896| train set 4.498x speedup, test set 4.313x speedup, val set 4.228x speedup, step: 16
Epoch 16/200 |loss: 16.685041| train set 4.423x speedup, test set 4.186x speedup, val set 4.195x speedup, step: 17
Epoch 17/200 |loss: 16.256329| train set 4.419x speedup, test set 4.236x speedup, val set 4.157x speedup, step: 18
Epoch 18/200 |loss: 15.840820| train set 4.702x speedup, test set 4.509x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.455232| train set 4.832x speedup, test set 4.681x speedup, val set 4.526x speedup, step: 20
Epoch 20/200 |loss: 15.099000| train set 4.978x speedup, test set 4.777x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.622593| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.201694| train set 5.212x speedup, test set 5.052x speedup, val set 4.944x speedup, step: 23
Epoch 23/200 |loss: 13.874599| train set 5.431x speedup, test set 5.320x speedup, val set 5.069x speedup, step: 24
Epoch 24/200 |loss: 13.764702| train set 5.285x speedup, test set 5.154x speedup, val set 4.961x speedup, step: 25
Epoch 25/200 |loss: 13.697248| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.010973| train set 5.472x speedup, test set 5.383x speedup, val set 5.103x speedup, step: 27
Epoch 27/200 |loss: 12.753662| train set 5.272x speedup, test set 5.142x speedup, val set 4.978x speedup, step: 28
Epoch 28/200 |loss: 12.844988| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 29
Epoch 29/200 |loss: 12.115562| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 30
Epoch 30/200 |loss: 12.263099| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 31
Epoch 31/200 |loss: 11.866915| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 32
Epoch 32/200 |loss: 11.479806| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 33
Epoch 33/200 |loss: 11.501467| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 34
Epoch 34/200 |loss: 11.073483| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 35
Epoch 35/200 |loss: 11.392900| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 10.572360| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.670505| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.416511| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 39
Epoch 39/200 |loss: 10.329578| train set 5.421x speedup, test set 5.349x speedup, val set 5.038x speedup, step: 40
Epoch 40/200 |loss: 10.247765| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 41
Epoch 41/200 |loss: 9.858682| train set 5.496x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 10.167365| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 43
Epoch 43/200 |loss: 10.494397| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 44
Epoch 44/200 |loss: 11.203715| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 45
Epoch 45/200 |loss: 9.551374| train set 5.449x speedup, test set 5.221x speedup, val set 5.054x speedup, step: 46
Epoch 46/200 |loss: 10.674503| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.942649| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.717933| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.618198| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.312507| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.520997| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.224434| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 9.520531| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.006139| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 9.042925| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 56
Epoch 56/200 |loss: 9.250926| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.792821| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.822135| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 59
Epoch 59/200 |loss: 8.923749| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.753347| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.409650| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.564503| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 63
Epoch 63/200 |loss: 8.462619| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.525444| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.321159| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 66
Epoch 66/200 |loss: 8.309014| train set 5.450x speedup, test set 5.223x speedup, val set 5.055x speedup, step: 67
Epoch 67/200 |loss: 8.623998| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.122561| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 69
Epoch 69/200 |loss: 8.368205| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 70
Epoch 70/200 |loss: 8.620117| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.248701| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 72
Epoch 72/200 |loss: 8.656367| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 73
Epoch 73/200 |loss: 9.271810| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 74
Epoch 74/200 |loss: 8.647586| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 75
Epoch 75/200 |loss: 8.621386| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 76
Epoch 76/200 |loss: 8.363811| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 8.519018| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 8.266270| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.206583| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 8.215225| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 81
Epoch 81/200 |loss: 8.028095| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 8.225865| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 83
Epoch 83/200 |loss: 7.994658| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 8.091158| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.896213| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 86
Epoch 86/200 |loss: 7.870850| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 87
Epoch 87/200 |loss: 7.899596| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.873675| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.768983| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 7.732333| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.693681| train set 5.496x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 92
Epoch 92/200 |loss: 7.697509| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 93
Epoch 93/200 |loss: 7.691240| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 7.633271| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 7.660051| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 7.597050| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 97
Epoch 97/200 |loss: 7.814967| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 98
Epoch 98/200 |loss: 7.822112| train set 5.496x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 8.216289| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 100
Epoch 100/200 |loss: 7.714435| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 1
Epoch 101/200 |loss: 8.259671| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 1
Epoch 102/200 |loss: 9.003433| train set 5.456x speedup, test set 5.421x speedup, val set 5.204x speedup, step: 1
Epoch 103/200 |loss: 8.391068| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 104/200 |loss: 8.598200| train set 5.273x speedup, test set 5.142x speedup, val set 4.978x speedup, step: 3
Epoch 105/200 |loss: 8.138182| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 4
Epoch 106/200 |loss: 8.046574| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 5
Epoch 107/200 |loss: 7.946057| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6
Epoch 108/200 |loss: 7.995676| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 109/200 |loss: 7.944164| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8
Epoch 110/200 |loss: 7.861315| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 9
Epoch 111/200 |loss: 7.825121| train set 5.496x speedup, test set 5.420x speedup, val set 5.104x speedup, step: 10
Epoch 112/200 |loss: 7.677253| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 11
Epoch 113/200 |loss: 7.808455| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 12
Epoch 114/200 |loss: 7.634840| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13
Epoch 115/200 |loss: 7.669637| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 14
Epoch 116/200 |loss: 7.627513| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 15
Epoch 117/200 |loss: 7.536622| train set 5.497x speedup, test set 5.420x speedup, val set 5.104x speedup, step: 16
Epoch 118/200 |loss: 7.573250| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 17
Epoch 119/200 |loss: 7.531549| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 18
Epoch 120/200 |loss: 7.493938| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 19
Epoch 121/200 |loss: 7.504445| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 20
Epoch 122/200 |loss: 7.521994| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 21
Epoch 123/200 |loss: 7.420722| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 22
Epoch 124/200 |loss: 7.462726| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 23
Epoch 125/200 |loss: 7.502326| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 24
Epoch 126/200 |loss: 7.369415| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 25
Epoch 127/200 |loss: 7.447924| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 26
Epoch 128/200 |loss: 7.666397| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 129/200 |loss: 7.342059| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 28
Epoch 130/200 |loss: 7.541124| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 29
Epoch 131/200 |loss: 7.810721| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 30
Epoch 132/200 |loss: 7.566065| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 31
Epoch 133/200 |loss: 8.004829| train set 5.451x speedup, test set 5.311x speedup, val set 5.191x speedup, step: 32
Epoch 134/200 |loss: 7.957565| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 33
Epoch 135/200 |loss: 7.554272| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 34
Epoch 136/200 |loss: 7.803756| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 35
Epoch 137/200 |loss: 7.598635| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 36
Epoch 138/200 |loss: 7.815602| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 37
Epoch 139/200 |loss: 7.453921| train set 5.450x speedup, test set 5.331x speedup, val set 5.076x speedup, step: 38
Epoch 140/200 |loss: 7.636717| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 39
Epoch 141/200 |loss: 7.458897| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 142/200 |loss: 7.560251| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 41
Epoch 143/200 |loss: 7.332115| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 42
Epoch 144/200 |loss: 7.531250| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 145/200 |loss: 7.438491| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 44
Epoch 146/200 |loss: 7.427541| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 147/200 |loss: 7.404465| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 46
Epoch 148/200 |loss: 7.428483| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 149/200 |loss: 7.432521| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 48
Epoch 150/200 |loss: 7.291280| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 49
Epoch 151/200 |loss: 7.365557| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Epoch 152/200 |loss: 7.297013| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 51
Epoch 153/200 |loss: 7.358056| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 52
Epoch 154/200 |loss: 7.251261| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 53
Epoch 155/200 |loss: 7.259218| train set 5.496x speedup, test set 5.420x speedup, val set 5.104x speedup, step: 54
Epoch 156/200 |loss: 7.309545| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 157/200 |loss: 7.287502| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 56
Epoch 158/200 |loss: 7.240678| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 159/200 |loss: 7.223164| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 160/200 |loss: 7.224640| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 59
Epoch 161/200 |loss: 7.275695| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 162/200 |loss: 7.248056| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 61
Epoch 163/200 |loss: 7.233251| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 62
Epoch 164/200 |loss: 7.193625| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 63
Epoch 165/200 |loss: 7.182539| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 64
Epoch 166/200 |loss: 7.212147| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 167/200 |loss: 7.198039| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 66
Epoch 168/200 |loss: 7.250889| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 169/200 |loss: 7.205060| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 68
Epoch 170/200 |loss: 7.217831| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 69
Epoch 171/200 |loss: 7.201690| train set 5.498x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 70
Epoch 172/200 |loss: 7.177872| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 71
Epoch 173/200 |loss: 7.144149| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 72
Epoch 174/200 |loss: 7.153018| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 175/200 |loss: 7.160131| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 74
Epoch 176/200 |loss: 7.210148| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 177/200 |loss: 7.279511| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 76
Epoch 178/200 |loss: 7.542602| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 77
Epoch 179/200 |loss: 7.403123| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 78
Epoch 180/200 |loss: 7.283243| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 79
Epoch 181/200 |loss: 7.145943| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 80
Epoch 182/200 |loss: 7.238197| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 81
Epoch 183/200 |loss: 7.453469| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 82
Epoch 184/200 |loss: 7.220280| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 83
Epoch 185/200 |loss: 7.205845| train set 5.497x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 84
Epoch 186/200 |loss: 7.267299| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 85
Epoch 187/200 |loss: 7.249838| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 86
Epoch 188/200 |loss: 7.394720| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 87
Epoch 189/200 |loss: 7.251726| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 88
Epoch 190/200 |loss: 7.176376| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 89
Epoch 191/200 |loss: 7.294967| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 90
Epoch 192/200 |loss: 7.244810| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 91
Epoch 193/200 |loss: 7.232190| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 92
Epoch 194/200 |loss: 7.226808| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 93
Epoch 195/200 |loss: 7.219342| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 94
Epoch 196/200 |loss: 7.239347| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 95
Epoch 197/200 |loss: 7.182993| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 96
Epoch 198/200 |loss: 7.193538| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 97
Epoch 199/200 |loss: 7.160023| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 98
Training per epoch cost 0.203 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 7.469s, model runtime 7.469s, pg runtime 23.223s, speedup 3.109x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 178, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 46, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 102, train speedup 5.456, test speedup 5.421, val speedup 5.204
last model at epoch 199, train speedup 5.451, test speedup 5.315, val speedup 5.069
execution cost 0:02:10.399876
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.287633, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055296| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511551| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474644| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995949| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037212| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524681| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074415| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.569862| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.077787| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586277| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.082529| train set 4.548x speedup, test set 4.360x speedup, val set 4.274x speedup, step: 14
Epoch 14/200 |loss: 17.598980| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.100105| train set 4.371x speedup, test set 4.161x speedup, val set 4.086x speedup, step: 16
Epoch 16/200 |loss: 16.651323| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 17
Epoch 17/200 |loss: 16.172380| train set 4.553x speedup, test set 4.340x speedup, val set 4.345x speedup, step: 18
Epoch 18/200 |loss: 15.683555| train set 4.803x speedup, test set 4.643x speedup, val set 4.539x speedup, step: 19
Epoch 19/200 |loss: 15.321424| train set 5.129x speedup, test set 4.979x speedup, val set 4.849x speedup, step: 20
Epoch 20/200 |loss: 15.366627| train set 4.906x speedup, test set 4.745x speedup, val set 4.609x speedup, step: 21
Epoch 21/200 |loss: 15.186729| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.224730| train set 5.456x speedup, test set 5.358x speedup, val set 5.072x speedup, step: 23
Epoch 23/200 |loss: 14.337442| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 24
Epoch 24/200 |loss: 13.689338| train set 5.285x speedup, test set 5.154x speedup, val set 4.961x speedup, step: 25
Epoch 25/200 |loss: 13.527379| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.148970| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 27
Epoch 27/200 |loss: 12.704507| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 28/200 |loss: 12.679727| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.069282| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 30/200 |loss: 11.915439| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.705517| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 32
Epoch 32/200 |loss: 11.275657| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.351435| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 34
Epoch 34/200 |loss: 11.849978| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 35
Epoch 35/200 |loss: 11.238737| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 11.382345| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.529023| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 38
Epoch 38/200 |loss: 10.700041| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 39
Epoch 39/200 |loss: 11.161507| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 11.133008| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 10.277922| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 10.723454| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 10.192356| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 10.099237| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.997144| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.690054| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.555820| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.459918| train set 5.307x speedup, test set 5.189x speedup, val set 4.963x speedup, step: 49
Epoch 49/200 |loss: 9.360624| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.184026| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.039931| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 52
Epoch 52/200 |loss: 9.114892| train set 5.426x speedup, test set 5.395x speedup, val set 4.959x speedup, step: 53
Epoch 53/200 |loss: 8.948062| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 8.962802| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 55
Epoch 55/200 |loss: 8.767527| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.699376| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.838244| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 58
Epoch 58/200 |loss: 8.719247| train set 5.273x speedup, test set 5.142x speedup, val set 4.978x speedup, step: 59
Epoch 59/200 |loss: 8.712443| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.475471| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.324895| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.388568| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 63
Epoch 63/200 |loss: 8.710529| train set 5.336x speedup, test set 5.097x speedup, val set 4.992x speedup, step: 64
Epoch 64/200 |loss: 9.794063| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 9.014766| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 66
Epoch 66/200 |loss: 9.851279| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 67
Epoch 67/200 |loss: 9.273416| train set 5.495x speedup, test set 5.409x speedup, val set 5.099x speedup, step: 68
Epoch 68/200 |loss: 9.656623| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.809329| train set 5.228x speedup, test set 5.062x speedup, val set 4.941x speedup, step: 70
Epoch 70/200 |loss: 9.209762| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 71
Epoch 71/200 |loss: 8.477573| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.716895| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.600861| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 74
Epoch 74/200 |loss: 8.229639| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 75
Epoch 75/200 |loss: 8.590685| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.162711| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 8.329970| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 8.128284| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.199297| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 8.056673| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 81
Epoch 81/200 |loss: 8.038904| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 82
Epoch 82/200 |loss: 8.035868| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 83
Epoch 83/200 |loss: 7.895606| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 84
Epoch 84/200 |loss: 7.939088| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 85
Epoch 85/200 |loss: 7.844630| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 86
Epoch 86/200 |loss: 7.796215| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 87
Epoch 87/200 |loss: 7.820921| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.725671| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.693681| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 7.696618| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.660548| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.685816| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 93
Epoch 93/200 |loss: 7.743182| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 7.918323| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 8.679015| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 96
Epoch 96/200 |loss: 8.219969| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 8.206945| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 98
Epoch 98/200 |loss: 8.658605| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 8.051414| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 100
Epoch 100/200 |loss: 8.534829| train set 5.264x speedup, test set 5.088x speedup, val set 5.047x speedup, step: 101
Epoch 101/200 |loss: 8.357904| train set 5.497x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 1
Epoch 102/200 |loss: 8.242711| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 103/200 |loss: 8.142962| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 104/200 |loss: 8.119901| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 105/200 |loss: 7.880805| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 106/200 |loss: 8.051944| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 3
Epoch 107/200 |loss: 7.778393| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 1
Epoch 108/200 |loss: 7.951851| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 109/200 |loss: 7.771258| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 110/200 |loss: 7.807971| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 111/200 |loss: 7.723168| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 112/200 |loss: 7.709015| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 113/200 |loss: 7.636858| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 114/200 |loss: 7.631295| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 2
Epoch 115/200 |loss: 7.579545| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 3
Epoch 116/200 |loss: 7.551866| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 117/200 |loss: 7.516692| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 118/200 |loss: 7.515138| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 119/200 |loss: 7.458365| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 120/200 |loss: 7.460195| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3
Epoch 121/200 |loss: 7.440799| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 122/200 |loss: 7.478792| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5
Epoch 123/200 |loss: 7.536622| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 6
Epoch 124/200 |loss: 7.756215| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 125/200 |loss: 7.667561| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 8
Epoch 126/200 |loss: 7.658623| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 9
Epoch 127/200 |loss: 7.818033| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 10
Epoch 128/200 |loss: 7.532224| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 11
Epoch 129/200 |loss: 7.492119| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 1
Epoch 130/200 |loss: 7.640417| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 131/200 |loss: 7.530670| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3
Epoch 132/200 |loss: 7.564277| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 133/200 |loss: 7.431282| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 5
Epoch 134/200 |loss: 7.690201| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 135/200 |loss: 7.935661| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 136/200 |loss: 7.594000| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 3
Epoch 137/200 |loss: 7.933882| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 4
Epoch 138/200 |loss: 7.626529| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 5
Epoch 139/200 |loss: 7.587635| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 6
Epoch 140/200 |loss: 7.697361| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 141/200 |loss: 7.482248| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 8
Epoch 142/200 |loss: 7.502460| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 9
Epoch 143/200 |loss: 7.485875| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 10
Epoch 144/200 |loss: 7.464678| train set 5.498x speedup, test set 5.420x speedup, val set 5.104x speedup, step: 11
Epoch 145/200 |loss: 7.523141| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 12
Epoch 146/200 |loss: 7.365053| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13
Epoch 147/200 |loss: 7.417160| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 14
Epoch 148/200 |loss: 7.305950| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 15
Epoch 149/200 |loss: 7.413613| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16
Epoch 150/200 |loss: 7.320133| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 17
Epoch 151/200 |loss: 7.330691| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 18
Epoch 152/200 |loss: 7.290606| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 19
Epoch 153/200 |loss: 7.279147| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 20
Epoch 154/200 |loss: 7.294761| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 21
Epoch 155/200 |loss: 7.325997| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 22
Epoch 156/200 |loss: 7.297194| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 23
Epoch 157/200 |loss: 7.372274| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 24
Epoch 158/200 |loss: 7.271036| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 25
Epoch 159/200 |loss: 7.282101| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 160/200 |loss: 7.235475| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 161/200 |loss: 7.194025| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 162/200 |loss: 7.200910| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 163/200 |loss: 7.171040| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 164/200 |loss: 7.172266| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 165/200 |loss: 7.175076| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 166/200 |loss: 7.162143| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 33
Epoch 167/200 |loss: 7.177559| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 34
Epoch 168/200 |loss: 7.275148| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 35
Epoch 169/200 |loss: 7.571297| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 36
Epoch 170/200 |loss: 8.777732| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 37
Epoch 171/200 |loss: 7.414658| train set 5.452x speedup, test set 5.205x speedup, val set 5.055x speedup, step: 38
Epoch 172/200 |loss: 8.528250| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 39
Epoch 173/200 |loss: 8.957984| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 174/200 |loss: 8.390197| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 2
Epoch 175/200 |loss: 8.284849| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 3
Epoch 176/200 |loss: 8.397703| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 4
Epoch 177/200 |loss: 7.991993| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5
Epoch 178/200 |loss: 7.981806| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 6
Epoch 179/200 |loss: 7.989546| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 180/200 |loss: 7.850848| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 8
Epoch 181/200 |loss: 7.805278| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 9
Epoch 182/200 |loss: 7.700415| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 10
Epoch 183/200 |loss: 7.702173| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 11
Epoch 184/200 |loss: 7.632919| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 12
Epoch 185/200 |loss: 7.624945| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 13
Epoch 186/200 |loss: 7.547666| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 14
Epoch 187/200 |loss: 7.502529| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 15
Epoch 188/200 |loss: 7.479881| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 16
Epoch 189/200 |loss: 7.455814| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17
Epoch 190/200 |loss: 7.405262| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18
Epoch 191/200 |loss: 7.396209| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 19
Epoch 192/200 |loss: 7.373717| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 193/200 |loss: 7.321619| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21
Epoch 194/200 |loss: 7.335756| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 22
Epoch 195/200 |loss: 7.311208| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23
Epoch 196/200 |loss: 7.277180| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 24
Epoch 197/200 |loss: 7.298062| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 25
Epoch 198/200 |loss: 7.260129| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 199/200 |loss: 7.243636| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 27
Training per epoch cost 0.210 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 168, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 43, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 173, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 199, train speedup 5.496, test speedup 5.420, val speedup 5.107
execution cost 0:02:11.934700
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.129052, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474646| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995949| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037212| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524681| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074415| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.569862| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.077787| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586277| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.082529| train set 4.548x speedup, test set 4.360x speedup, val set 4.274x speedup, step: 14
Epoch 14/200 |loss: 17.598980| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.100107| train set 4.371x speedup, test set 4.161x speedup, val set 4.086x speedup, step: 16
Epoch 16/200 |loss: 16.651323| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 17
Epoch 17/200 |loss: 16.172380| train set 4.553x speedup, test set 4.340x speedup, val set 4.345x speedup, step: 18
Epoch 18/200 |loss: 15.683554| train set 4.803x speedup, test set 4.643x speedup, val set 4.539x speedup, step: 19
Epoch 19/200 |loss: 15.321421| train set 5.129x speedup, test set 4.979x speedup, val set 4.849x speedup, step: 20
Epoch 20/200 |loss: 15.366619| train set 4.906x speedup, test set 4.745x speedup, val set 4.609x speedup, step: 21
Epoch 21/200 |loss: 15.186912| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.226257| train set 5.456x speedup, test set 5.358x speedup, val set 5.072x speedup, step: 23
Epoch 23/200 |loss: 14.330428| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 24
Epoch 24/200 |loss: 13.683465| train set 5.285x speedup, test set 5.154x speedup, val set 4.961x speedup, step: 25
Epoch 25/200 |loss: 13.502649| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.146069| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.684274| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 28/200 |loss: 12.663127| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.108233| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 30/200 |loss: 11.917927| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.790223| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 32
Epoch 32/200 |loss: 11.513736| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.526371| train set 5.229x speedup, test set 5.042x speedup, val set 5.061x speedup, step: 34
Epoch 34/200 |loss: 11.446391| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 35
Epoch 35/200 |loss: 10.965394| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 10.913103| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.448373| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.561259| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 39
Epoch 39/200 |loss: 10.220855| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 40
Epoch 40/200 |loss: 10.324867| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 10.532669| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 10.093035| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.972968| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 9.530114| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.978721| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 46
Epoch 46/200 |loss: 9.585333| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 47
Epoch 47/200 |loss: 9.551687| train set 5.308x speedup, test set 5.190x speedup, val set 4.964x speedup, step: 48
Epoch 48/200 |loss: 9.522274| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.164478| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 50
Epoch 50/200 |loss: 9.323292| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 51
Epoch 51/200 |loss: 9.377055| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.423741| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 9.104617| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 8.999851| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.915763| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 9.115811| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 9.305844| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.814540| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.807024| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.911333| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.655283| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.472348| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 8.646507| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 64
Epoch 64/200 |loss: 8.328489| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 65
Epoch 65/200 |loss: 8.354384| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.409291| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.258274| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.389457| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 69
Epoch 69/200 |loss: 8.556185| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 70
Epoch 70/200 |loss: 8.767898| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.163640| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.226887| train set 5.450x speedup, test set 5.222x speedup, val set 5.054x speedup, step: 73
Epoch 73/200 |loss: 8.420090| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 74
Epoch 74/200 |loss: 8.095878| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 75
Epoch 75/200 |loss: 7.974693| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.091486| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 77
Epoch 77/200 |loss: 8.032191| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 8.081240| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 7.939574| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 7.912550| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 81
Epoch 81/200 |loss: 7.881899| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 7.935282| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 83
Epoch 83/200 |loss: 7.955241| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 7.814679| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.735428| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 86
Epoch 86/200 |loss: 7.913498| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 87
Epoch 87/200 |loss: 7.810721| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.813082| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.691487| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 7.728781| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.713913| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.614287| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 93
Epoch 93/200 |loss: 7.668695| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 94
Epoch 94/200 |loss: 7.714431| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 95
Epoch 95/200 |loss: 8.172329| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 96
Epoch 96/200 |loss: 7.917218| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 97
Epoch 97/200 |loss: 7.733325| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 98
Epoch 98/200 |loss: 7.520878| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 99
Epoch 99/200 |loss: 7.717010| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.976160| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 101/200 |loss: 7.642653| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 102/200 |loss: 7.731403| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 1
Epoch 103/200 |loss: 8.183764| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 2
Epoch 104/200 |loss: 7.741213| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 3
Epoch 105/200 |loss: 8.092920| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 106/200 |loss: 8.537928| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 2
Epoch 107/200 |loss: 8.313272| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 3
Epoch 108/200 |loss: 8.089675| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 4
Epoch 109/200 |loss: 8.079493| train set 5.449x speedup, test set 5.220x speedup, val set 5.055x speedup, step: 5
Epoch 110/200 |loss: 7.795977| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6
Epoch 111/200 |loss: 8.024302| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7
Epoch 112/200 |loss: 7.742065| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 1
Epoch 113/200 |loss: 7.868283| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 2
Epoch 114/200 |loss: 7.749629| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 3
Epoch 115/200 |loss: 7.779957| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 4
Epoch 116/200 |loss: 7.671535| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 5
Epoch 117/200 |loss: 7.730250| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6
Epoch 118/200 |loss: 7.556631| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7
Epoch 119/200 |loss: 7.630541| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 8
Epoch 120/200 |loss: 7.612086| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 9
Epoch 121/200 |loss: 7.645499| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 10
Epoch 122/200 |loss: 7.475378| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 11
Epoch 123/200 |loss: 7.530869| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 12
Epoch 124/200 |loss: 7.516390| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13
Epoch 125/200 |loss: 7.507138| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 14
Epoch 126/200 |loss: 7.437422| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 15
Epoch 127/200 |loss: 7.391240| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16
Epoch 128/200 |loss: 7.392122| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 17
Epoch 129/200 |loss: 7.421771| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 18
Epoch 130/200 |loss: 7.361504| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 19
Epoch 131/200 |loss: 7.345336| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 132/200 |loss: 7.340406| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21
Epoch 133/200 |loss: 7.399114| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 22
Epoch 134/200 |loss: 7.537475| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23
Epoch 135/200 |loss: 8.068645| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 24
Epoch 136/200 |loss: 7.439759| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 25
Epoch 137/200 |loss: 7.547861| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 138/200 |loss: 7.792929| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 27
Epoch 139/200 |loss: 7.618648| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 140/200 |loss: 7.472133| train set 5.450x speedup, test set 5.312x speedup, val set 5.194x speedup, step: 29
Epoch 141/200 |loss: 7.596178| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 30
Epoch 142/200 |loss: 7.454967| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 143/200 |loss: 7.370760| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 144/200 |loss: 7.473151| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 33
Epoch 145/200 |loss: 7.337854| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 34
Epoch 146/200 |loss: 7.362091| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 35
Epoch 147/200 |loss: 7.424232| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 36
Epoch 148/200 |loss: 7.302479| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 37
Epoch 149/200 |loss: 7.325835| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 38
Epoch 150/200 |loss: 7.350670| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 39
Epoch 151/200 |loss: 7.288488| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 152/200 |loss: 7.289532| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 153/200 |loss: 7.347452| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 154/200 |loss: 7.288985| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 155/200 |loss: 7.230046| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 44
Epoch 156/200 |loss: 7.258250| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 157/200 |loss: 7.306155| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 158/200 |loss: 7.274661| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 159/200 |loss: 7.241343| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 48
Epoch 160/200 |loss: 7.174827| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 161/200 |loss: 7.200196| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Epoch 162/200 |loss: 7.236948| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 51
Epoch 163/200 |loss: 7.326055| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 52
Epoch 164/200 |loss: 7.323946| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 53
Epoch 165/200 |loss: 7.321691| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 54
Epoch 166/200 |loss: 7.190643| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 167/200 |loss: 7.154162| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 56
Epoch 168/200 |loss: 7.189400| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 169/200 |loss: 7.243246| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 170/200 |loss: 7.334166| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 171/200 |loss: 7.269618| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 60
Epoch 172/200 |loss: 7.304950| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 173/200 |loss: 7.453370| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 62
Epoch 174/200 |loss: 7.707957| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 63
Epoch 175/200 |loss: 7.943480| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 64
Epoch 176/200 |loss: 7.403195| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 65
Epoch 177/200 |loss: 7.823715| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 1
Epoch 178/200 |loss: 8.147873| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 2
Epoch 179/200 |loss: 8.043093| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 3
Epoch 180/200 |loss: 7.763096| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 4
Epoch 181/200 |loss: 7.598542| train set 5.404x speedup, test set 5.118x speedup, val set 5.138x speedup, step: 5
Epoch 182/200 |loss: 7.674349| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6
Epoch 183/200 |loss: 7.519846| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 184/200 |loss: 7.458155| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8
Epoch 185/200 |loss: 7.576434| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 9
Epoch 186/200 |loss: 7.354907| train set 5.499x speedup, test set 5.404x speedup, val set 5.105x speedup, step: 10
Epoch 187/200 |loss: 7.543022| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 11
Epoch 188/200 |loss: 7.406380| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 12
Epoch 189/200 |loss: 7.397681| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 13
Epoch 190/200 |loss: 7.374143| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 14
Epoch 191/200 |loss: 7.429207| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 15
Epoch 192/200 |loss: 7.306716| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16
Epoch 193/200 |loss: 7.348263| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 17
Epoch 194/200 |loss: 7.293736| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18
Epoch 195/200 |loss: 7.290201| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 19
Epoch 196/200 |loss: 7.259316| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 197/200 |loss: 7.233884| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 21
Epoch 198/200 |loss: 7.232708| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 22
Epoch 199/200 |loss: 7.225926| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23
Training per epoch cost 0.203 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.309s, pg runtime 1.356s, speedup 1.036x
20, opt runtime 1.340s, model runtime 1.490s, pg runtime 1.340s, speedup 0.899x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 163, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 41, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 177, train speedup 5.450, test speedup 5.310, val speedup 5.195
last model at epoch 199, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:02:08.958572
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.153430, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474646| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995949| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037212| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524681| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074417| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.569862| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.077785| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586277| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.082529| train set 4.548x speedup, test set 4.360x speedup, val set 4.274x speedup, step: 14
Epoch 14/200 |loss: 17.598980| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.100006| train set 4.371x speedup, test set 4.161x speedup, val set 4.086x speedup, step: 16
Epoch 16/200 |loss: 16.651136| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 17
Epoch 17/200 |loss: 16.171558| train set 4.553x speedup, test set 4.340x speedup, val set 4.345x speedup, step: 18
Epoch 18/200 |loss: 15.684453| train set 4.803x speedup, test set 4.643x speedup, val set 4.539x speedup, step: 19
Epoch 19/200 |loss: 15.327068| train set 5.129x speedup, test set 4.979x speedup, val set 4.849x speedup, step: 20
Epoch 20/200 |loss: 15.402000| train set 4.906x speedup, test set 4.745x speedup, val set 4.609x speedup, step: 21
Epoch 21/200 |loss: 15.144628| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.245709| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 14.349874| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 24
Epoch 24/200 |loss: 13.635736| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.620443| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.119186| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 27
Epoch 27/200 |loss: 12.808040| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 28/200 |loss: 12.622845| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.069847| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 30/200 |loss: 12.101551| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 31
Epoch 31/200 |loss: 11.717337| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 32/200 |loss: 11.396146| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.559560| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 34
Epoch 34/200 |loss: 11.544338| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 35
Epoch 35/200 |loss: 11.642123| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 36
Epoch 36/200 |loss: 11.033990| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 11.155571| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.439646| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 39
Epoch 39/200 |loss: 10.573996| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.231989| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 10.181001| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 9.737300| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.849570| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 9.673794| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.513280| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.537670| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.238029| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.198011| train set 5.308x speedup, test set 5.189x speedup, val set 4.963x speedup, step: 49
Epoch 49/200 |loss: 9.204439| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 8.961829| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 51
Epoch 51/200 |loss: 9.008916| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 8.667759| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 8.799483| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.281075| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 10.115038| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 56
Epoch 56/200 |loss: 9.613503| train set 5.273x speedup, test set 5.142x speedup, val set 4.978x speedup, step: 57
Epoch 57/200 |loss: 9.294316| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 9.304283| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 9.048147| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.928459| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.795464| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.679667| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 8.616091| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 64
Epoch 64/200 |loss: 8.595440| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.314289| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.607777| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.286029| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 68
Epoch 68/200 |loss: 8.610061| train set 5.264x speedup, test set 5.088x speedup, val set 5.046x speedup, step: 69
Epoch 69/200 |loss: 9.119080| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.404337| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 71
Epoch 71/200 |loss: 8.922691| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 72
Epoch 72/200 |loss: 9.456601| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 9.274412| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 74
Epoch 74/200 |loss: 8.762869| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 9.053444| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 76
Epoch 76/200 |loss: 8.547223| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 8.644043| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 78
Epoch 78/200 |loss: 8.350590| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.440689| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 8.320248| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 81
Epoch 81/200 |loss: 8.127964| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 82
Epoch 82/200 |loss: 8.233537| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 83
Epoch 83/200 |loss: 8.097896| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 84
Epoch 84/200 |loss: 8.109632| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.986561| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 86
Epoch 86/200 |loss: 7.990030| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 87
Epoch 87/200 |loss: 7.901655| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.895961| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.818369| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 90
Epoch 90/200 |loss: 7.805385| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 91
Epoch 91/200 |loss: 7.759592| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 92
Epoch 92/200 |loss: 7.704423| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 93
Epoch 93/200 |loss: 7.716639| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 94
Epoch 94/200 |loss: 7.647941| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 95
Epoch 95/200 |loss: 7.696901| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 96
Epoch 96/200 |loss: 7.706033| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 97
Epoch 97/200 |loss: 7.858450| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 98
Epoch 98/200 |loss: 8.332272| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 99
Epoch 99/200 |loss: 8.048410| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 100
Epoch 100/200 |loss: 7.614129| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 101
Epoch 101/200 |loss: 7.715271| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 102
Epoch 102/200 |loss: 8.019158| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 103/200 |loss: 7.918539| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 104/200 |loss: 7.594769| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3
Epoch 105/200 |loss: 7.770234| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 106/200 |loss: 7.712084| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 5
Epoch 107/200 |loss: 7.564132| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6
Epoch 108/200 |loss: 7.705784| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 109/200 |loss: 7.481667| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8
Epoch 110/200 |loss: 7.486605| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 9
Epoch 111/200 |loss: 7.615807| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 10
Epoch 112/200 |loss: 7.483940| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 11
Epoch 113/200 |loss: 7.464367| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 12
Epoch 114/200 |loss: 7.463507| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13
Epoch 115/200 |loss: 7.410708| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 14
Epoch 116/200 |loss: 7.378240| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 15
Epoch 117/200 |loss: 7.376852| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16
Epoch 118/200 |loss: 7.391437| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17
Epoch 119/200 |loss: 7.418716| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 18
Epoch 120/200 |loss: 7.563420| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 121/200 |loss: 8.164377| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 2
Epoch 122/200 |loss: 7.477400| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 3
Epoch 123/200 |loss: 8.260098| train set 5.403x speedup, test set 5.118x speedup, val set 5.140x speedup, step: 4
Epoch 124/200 |loss: 9.097538| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 5
Epoch 125/200 |loss: 8.739178| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 6
Epoch 126/200 |loss: 8.357808| train set 5.272x speedup, test set 5.142x speedup, val set 4.978x speedup, step: 7
Epoch 127/200 |loss: 8.439091| train set 5.307x speedup, test set 5.188x speedup, val set 4.963x speedup, step: 8
Epoch 128/200 |loss: 7.989048| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 9
Epoch 129/200 |loss: 8.215368| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 130/200 |loss: 7.842641| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 131/200 |loss: 7.984046| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3
Epoch 132/200 |loss: 7.817503| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 133/200 |loss: 7.785218| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 5
Epoch 134/200 |loss: 7.757195| train set 5.448x speedup, test set 5.331x speedup, val set 5.066x speedup, step: 6
Epoch 135/200 |loss: 7.804458| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 136/200 |loss: 7.640647| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 8
Epoch 137/200 |loss: 7.656752| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 9
Epoch 138/200 |loss: 7.583188| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 10
Epoch 139/200 |loss: 7.589580| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 11
Epoch 140/200 |loss: 7.522824| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 12
Epoch 141/200 |loss: 7.511530| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13
Epoch 142/200 |loss: 7.472158| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 14
Epoch 143/200 |loss: 7.432261| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 15
Epoch 144/200 |loss: 7.449289| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16
Epoch 145/200 |loss: 7.424098| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 17
Epoch 146/200 |loss: 7.381438| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 18
Epoch 147/200 |loss: 7.348751| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19
Epoch 148/200 |loss: 7.348393| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 149/200 |loss: 7.318405| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21
Epoch 150/200 |loss: 7.311003| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 22
Epoch 151/200 |loss: 7.299876| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23
Epoch 152/200 |loss: 7.284344| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 24
Epoch 153/200 |loss: 7.283970| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 25
Epoch 154/200 |loss: 7.279635| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 155/200 |loss: 7.297535| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 156/200 |loss: 7.327354| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 157/200 |loss: 7.399458| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 158/200 |loss: 7.642647| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 159/200 |loss: 7.478709| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 160/200 |loss: 7.556686| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 161/200 |loss: 7.451399| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3
Epoch 162/200 |loss: 7.532086| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 163/200 |loss: 7.484466| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5
Epoch 164/200 |loss: 7.265080| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 165/200 |loss: 7.384964| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 2
Epoch 166/200 |loss: 7.533504| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3
Epoch 167/200 |loss: 7.287865| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 168/200 |loss: 7.247511| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 5
Epoch 169/200 |loss: 7.388618| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6
Epoch 170/200 |loss: 7.285977| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7
Epoch 171/200 |loss: 7.201951| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8
Epoch 172/200 |loss: 7.270309| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 9
Epoch 173/200 |loss: 7.252550| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 10
Epoch 174/200 |loss: 7.191001| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 11
Epoch 175/200 |loss: 7.190764| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 12
Epoch 176/200 |loss: 7.216947| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 13
Epoch 177/200 |loss: 7.209697| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 14
Epoch 178/200 |loss: 7.150667| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 15
Epoch 179/200 |loss: 7.172268| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16
Epoch 180/200 |loss: 7.215128| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17
Epoch 181/200 |loss: 7.185123| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18
Epoch 182/200 |loss: 7.159480| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19
Epoch 183/200 |loss: 7.158995| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 20
Epoch 184/200 |loss: 7.213710| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 21
Epoch 185/200 |loss: 7.257121| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 22
Epoch 186/200 |loss: 7.338600| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 23
Epoch 187/200 |loss: 7.222274| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 24
Epoch 188/200 |loss: 7.210392| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 25
Epoch 189/200 |loss: 7.235965| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 26
Epoch 190/200 |loss: 7.320418| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 191/200 |loss: 7.217002| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 192/200 |loss: 7.155967| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 193/200 |loss: 7.177677| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 194/200 |loss: 7.194274| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 195/200 |loss: 7.212709| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 196/200 |loss: 7.178245| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 33
Epoch 197/200 |loss: 7.192082| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 34
Epoch 198/200 |loss: 7.172452| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 35
Epoch 199/200 |loss: 7.173570| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 36
Training per epoch cost 0.202 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 197, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 42, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 164, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 199, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:02:08.178612
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.198188, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037214| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524693| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074823| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570261| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.080355| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.587557| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.083212| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 14
Epoch 14/200 |loss: 17.617691| train set 4.548x speedup, test set 4.360x speedup, val set 4.274x speedup, step: 15
Epoch 15/200 |loss: 17.116896| train set 4.498x speedup, test set 4.313x speedup, val set 4.228x speedup, step: 16
Epoch 16/200 |loss: 16.684948| train set 4.423x speedup, test set 4.186x speedup, val set 4.195x speedup, step: 17
Epoch 17/200 |loss: 16.256145| train set 4.419x speedup, test set 4.236x speedup, val set 4.157x speedup, step: 18
Epoch 18/200 |loss: 15.845182| train set 4.702x speedup, test set 4.509x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.464693| train set 4.832x speedup, test set 4.681x speedup, val set 4.526x speedup, step: 20
Epoch 20/200 |loss: 15.082429| train set 4.978x speedup, test set 4.777x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.612399| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.193741| train set 5.212x speedup, test set 5.052x speedup, val set 4.944x speedup, step: 23
Epoch 23/200 |loss: 13.870323| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 24
Epoch 24/200 |loss: 13.769983| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 25
Epoch 25/200 |loss: 13.794701| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 26/200 |loss: 13.040029| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 27
Epoch 27/200 |loss: 12.824275| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 28
Epoch 28/200 |loss: 12.799573| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 29
Epoch 29/200 |loss: 12.123539| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 30/200 |loss: 12.222718| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.861539| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 32
Epoch 32/200 |loss: 11.646813| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.267239| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 34
Epoch 34/200 |loss: 11.075645| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 35
Epoch 35/200 |loss: 11.221731| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 10.595920| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.814848| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.473478| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 39
Epoch 39/200 |loss: 11.225555| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 40
Epoch 40/200 |loss: 10.054707| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 41
Epoch 41/200 |loss: 10.480518| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 42
Epoch 42/200 |loss: 10.168446| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 43
Epoch 43/200 |loss: 9.905709| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 44
Epoch 44/200 |loss: 10.089043| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.798525| train set 5.496x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.722235| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 47
Epoch 47/200 |loss: 9.479075| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 48
Epoch 48/200 |loss: 9.914294| train set 5.450x speedup, test set 5.222x speedup, val set 5.054x speedup, step: 49
Epoch 49/200 |loss: 9.759591| train set 5.308x speedup, test set 5.190x speedup, val set 4.964x speedup, step: 50
Epoch 50/200 |loss: 9.828089| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.339632| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.164412| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 9.249107| train set 5.450x speedup, test set 5.222x speedup, val set 5.054x speedup, step: 54
Epoch 54/200 |loss: 8.924567| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.883283| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.713894| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.755421| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.570828| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.516107| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.462794| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.402750| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.292488| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 63
Epoch 63/200 |loss: 8.264748| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 64
Epoch 64/200 |loss: 8.194735| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.271912| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.572288| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 67
Epoch 67/200 |loss: 8.585021| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.871355| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 69
Epoch 69/200 |loss: 8.921635| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.251919| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.305070| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.548365| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.075989| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 74
Epoch 74/200 |loss: 8.088074| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 8.173114| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 7.919808| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 7.980488| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 78
Epoch 78/200 |loss: 8.094520| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 7.831218| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 7.845437| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 81
Epoch 81/200 |loss: 8.047909| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 82
Epoch 82/200 |loss: 7.991458| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 83
Epoch 83/200 |loss: 8.942060| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 84
Epoch 84/200 |loss: 8.082952| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 85
Epoch 85/200 |loss: 8.183418| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 86
Epoch 86/200 |loss: 9.006759| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 87
Epoch 87/200 |loss: 8.182744| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 88
Epoch 88/200 |loss: 9.030760| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 89
Epoch 89/200 |loss: 8.303075| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 8.477862| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 91
Epoch 91/200 |loss: 8.206017| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 92
Epoch 92/200 |loss: 8.251925| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 93
Epoch 93/200 |loss: 8.173729| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 8.110522| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 95
Epoch 95/200 |loss: 8.035625| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 96
Epoch 96/200 |loss: 7.918239| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 97
Epoch 97/200 |loss: 7.847530| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 98
Epoch 98/200 |loss: 7.945380| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.722087| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 100
Epoch 100/200 |loss: 7.855576| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 101
Epoch 101/200 |loss: 7.693945| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 102
Epoch 102/200 |loss: 7.708312| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 103
Epoch 103/200 |loss: 7.672855| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 104
Epoch 104/200 |loss: 7.615839| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 105
Epoch 105/200 |loss: 7.616394| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 106
Epoch 106/200 |loss: 7.605871| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 107
Epoch 107/200 |loss: 7.507938| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 108
Epoch 108/200 |loss: 7.605226| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 109
Epoch 109/200 |loss: 7.594546| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 110
Epoch 110/200 |loss: 7.485970| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 111
Epoch 111/200 |loss: 7.538059| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 112
Epoch 112/200 |loss: 7.660701| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 113
Epoch 113/200 |loss: 7.462325| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 114
Epoch 114/200 |loss: 7.542251| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 115/200 |loss: 7.701405| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 116/200 |loss: 7.425389| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 3
Epoch 117/200 |loss: 7.567101| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 118/200 |loss: 7.750098| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5
Epoch 119/200 |loss: 7.469381| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 6
Epoch 120/200 |loss: 7.850963| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 121/200 |loss: 7.969886| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 8
Epoch 122/200 |loss: 7.956098| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 9
Epoch 123/200 |loss: 8.076163| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 10
Epoch 124/200 |loss: 7.735228| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 11
Epoch 125/200 |loss: 7.655601| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 12
Epoch 126/200 |loss: 7.562079| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 13
Epoch 127/200 |loss: 7.762012| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 14
Epoch 128/200 |loss: 7.581257| train set 5.496x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 15
Epoch 129/200 |loss: 7.541626| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 16
Epoch 130/200 |loss: 7.632334| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17
Epoch 131/200 |loss: 7.578566| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18
Epoch 132/200 |loss: 7.450873| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 19
Epoch 133/200 |loss: 7.520007| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 134/200 |loss: 7.493857| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21
Epoch 135/200 |loss: 7.386769| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 22
Epoch 136/200 |loss: 7.394387| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23
Epoch 137/200 |loss: 7.423143| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 24
Epoch 138/200 |loss: 7.311303| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 25
Epoch 139/200 |loss: 7.376148| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 26
Epoch 140/200 |loss: 7.353253| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 27
Epoch 141/200 |loss: 7.321365| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 28
Epoch 142/200 |loss: 7.301319| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 29
Epoch 143/200 |loss: 7.377863| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 30
Epoch 144/200 |loss: 7.291660| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 31
Epoch 145/200 |loss: 7.270219| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 32
Epoch 146/200 |loss: 7.331276| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 33
Epoch 147/200 |loss: 7.288589| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 34
Epoch 148/200 |loss: 7.230910| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 35
Epoch 149/200 |loss: 7.234812| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 36
Epoch 150/200 |loss: 7.284363| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 37
Epoch 151/200 |loss: 7.325585| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 38
Epoch 152/200 |loss: 7.352362| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 39
Epoch 153/200 |loss: 7.641056| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 154/200 |loss: 7.568316| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 155/200 |loss: 7.471691| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 156/200 |loss: 7.247484| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 157/200 |loss: 7.255694| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 44
Epoch 158/200 |loss: 7.378651| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 159/200 |loss: 7.283945| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 160/200 |loss: 7.210512| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 47
Epoch 161/200 |loss: 7.234615| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 48
Epoch 162/200 |loss: 7.281618| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 163/200 |loss: 7.259263| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Epoch 164/200 |loss: 7.201432| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 51
Epoch 165/200 |loss: 7.249133| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 52
Epoch 166/200 |loss: 7.270024| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 53
Epoch 167/200 |loss: 7.305037| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 54
Epoch 168/200 |loss: 7.168605| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 169/200 |loss: 7.232355| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 170/200 |loss: 7.307712| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 171/200 |loss: 7.216663| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 172/200 |loss: 7.170409| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 59
Epoch 173/200 |loss: 7.268226| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 60
Epoch 174/200 |loss: 7.291793| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 61
Epoch 175/200 |loss: 7.399302| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 176/200 |loss: 7.321162| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 63
Epoch 177/200 |loss: 7.393615| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 64
Epoch 178/200 |loss: 7.191015| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 65
Epoch 179/200 |loss: 7.132483| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 66
Epoch 180/200 |loss: 7.236102| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 181/200 |loss: 7.278389| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 68
Epoch 182/200 |loss: 7.343832| train set 5.499x speedup, test set 5.403x speedup, val set 5.109x speedup, step: 69
Epoch 183/200 |loss: 7.198077| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 70
Epoch 184/200 |loss: 7.297651| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 71
Epoch 185/200 |loss: 7.260780| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 72
Epoch 186/200 |loss: 7.225752| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 187/200 |loss: 7.412848| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 74
Epoch 188/200 |loss: 7.234297| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 189/200 |loss: 7.151412| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 190/200 |loss: 7.161434| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 77
Epoch 191/200 |loss: 7.183639| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 78
Epoch 192/200 |loss: 7.251870| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 193/200 |loss: 7.221215| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 80
Epoch 194/200 |loss: 7.182115| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 81
Epoch 195/200 |loss: 7.106004| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 82
Epoch 196/200 |loss: 7.130042| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 83
Epoch 197/200 |loss: 7.135219| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 84
Epoch 198/200 |loss: 7.140139| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 85
Epoch 199/200 |loss: 7.198781| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 86
Training per epoch cost 0.203 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 199, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 71, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 114, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 199, train speedup 5.499, test speedup 5.404, val speedup 5.107
execution cost 0:02:08.096606
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.146099, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511551| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037212| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524662| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074562| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570393| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.079531| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586479| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.067806| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 14
Epoch 14/200 |loss: 17.602135| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.146929| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 16
Epoch 16/200 |loss: 16.682732| train set 4.552x speedup, test set 4.339x speedup, val set 4.345x speedup, step: 17
Epoch 17/200 |loss: 16.274240| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 18
Epoch 18/200 |loss: 15.853537| train set 4.702x speedup, test set 4.509x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.446267| train set 4.832x speedup, test set 4.681x speedup, val set 4.526x speedup, step: 20
Epoch 20/200 |loss: 15.073396| train set 4.978x speedup, test set 4.777x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.585345| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.155014| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 13.886172| train set 5.456x speedup, test set 5.358x speedup, val set 5.072x speedup, step: 24
Epoch 24/200 |loss: 13.651034| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.596606| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.334217| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.538246| train set 5.308x speedup, test set 5.189x speedup, val set 4.963x speedup, step: 28
Epoch 28/200 |loss: 12.675312| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.376264| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 30/200 |loss: 11.775329| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.943956| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 32/200 |loss: 11.619831| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 12.054643| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 10.996728| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 35
Epoch 35/200 |loss: 11.416247| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 36
Epoch 36/200 |loss: 11.026386| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.983854| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.595793| train set 5.308x speedup, test set 5.189x speedup, val set 4.963x speedup, step: 39
Epoch 39/200 |loss: 11.034718| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.462704| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 10.321072| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 10.116130| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.759200| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 9.908154| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.535616| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.544497| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.524673| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.498287| train set 5.450x speedup, test set 5.222x speedup, val set 5.054x speedup, step: 49
Epoch 49/200 |loss: 9.832459| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 50
Epoch 50/200 |loss: 9.537726| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.276842| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.075500| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 53
Epoch 53/200 |loss: 9.527375| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.407703| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.938609| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 9.229217| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.912587| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.721066| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.766948| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 60
Epoch 60/200 |loss: 8.563766| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.563183| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.489475| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 63
Epoch 63/200 |loss: 8.349165| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.404688| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.211589| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.200584| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.227520| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 68
Epoch 68/200 |loss: 8.173979| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.083239| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 7.980416| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 71
Epoch 71/200 |loss: 8.035114| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.290414| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.372768| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 74
Epoch 74/200 |loss: 8.768315| train set 5.454x speedup, test set 5.421x speedup, val set 5.128x speedup, step: 75
Epoch 75/200 |loss: 8.171293| train set 5.497x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 76
Epoch 76/200 |loss: 8.287488| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 8.375448| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 8.058789| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 79
Epoch 79/200 |loss: 8.393921| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 80
Epoch 80/200 |loss: 9.035435| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 81
Epoch 81/200 |loss: 8.208792| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 82
Epoch 82/200 |loss: 8.955835| train set 5.449x speedup, test set 5.221x speedup, val set 5.054x speedup, step: 83
Epoch 83/200 |loss: 8.401831| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 8.552099| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 8.306767| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 86
Epoch 86/200 |loss: 8.482155| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 87
Epoch 87/200 |loss: 7.999630| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 8.260783| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 89
Epoch 89/200 |loss: 8.069139| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 7.992554| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 8.033174| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.870595| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 93
Epoch 93/200 |loss: 7.863163| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 94
Epoch 94/200 |loss: 7.949692| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 95
Epoch 95/200 |loss: 7.737787| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 96
Epoch 96/200 |loss: 7.853199| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 97
Epoch 97/200 |loss: 7.733596| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 98
Epoch 98/200 |loss: 7.714316| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.687792| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.658869| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 101/200 |loss: 7.573749| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 102/200 |loss: 7.637419| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 103/200 |loss: 7.638018| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 104/200 |loss: 7.613015| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 105/200 |loss: 7.692293| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 1
Epoch 106/200 |loss: 7.888348| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 107/200 |loss: 7.635876| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 3
Epoch 108/200 |loss: 7.527033| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 4
Epoch 109/200 |loss: 7.532758| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5
Epoch 110/200 |loss: 7.497324| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6
Epoch 111/200 |loss: 7.450665| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 7
Epoch 112/200 |loss: 7.377140| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8
Epoch 113/200 |loss: 7.420348| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 9
Epoch 114/200 |loss: 7.536539| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 10
Epoch 115/200 |loss: 7.520339| train set 5.460x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 116/200 |loss: 7.718733| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 2
Epoch 117/200 |loss: 7.641939| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3
Epoch 118/200 |loss: 7.709107| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 4
Epoch 119/200 |loss: 7.628573| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 5
Epoch 120/200 |loss: 7.354659| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6
Epoch 121/200 |loss: 7.547141| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 7
Epoch 122/200 |loss: 7.864990| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8
Epoch 123/200 |loss: 7.451691| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 9
Epoch 124/200 |loss: 7.560430| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 10
Epoch 125/200 |loss: 7.893888| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 11
Epoch 126/200 |loss: 7.450619| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 12
Epoch 127/200 |loss: 7.605087| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13
Epoch 128/200 |loss: 7.758876| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 14
Epoch 129/200 |loss: 7.437926| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 15
Epoch 130/200 |loss: 7.658904| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 16
Epoch 131/200 |loss: 7.712370| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 17
Epoch 132/200 |loss: 7.411812| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 18
Epoch 133/200 |loss: 7.652716| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19
Epoch 134/200 |loss: 7.474228| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 135/200 |loss: 7.506175| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21
Epoch 136/200 |loss: 7.502485| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 22
Epoch 137/200 |loss: 7.301539| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 23
Epoch 138/200 |loss: 7.517118| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 24
Epoch 139/200 |loss: 7.277359| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 25
Epoch 140/200 |loss: 7.463923| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 141/200 |loss: 7.461030| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 27
Epoch 142/200 |loss: 7.394752| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 143/200 |loss: 7.385866| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 144/200 |loss: 7.294909| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 145/200 |loss: 7.376944| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 146/200 |loss: 7.370358| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 147/200 |loss: 7.395859| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 33
Epoch 148/200 |loss: 7.406869| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 34
Epoch 149/200 |loss: 7.326647| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 35
Epoch 150/200 |loss: 7.280628| train set 5.460x speedup, test set 5.375x speedup, val set 5.204x speedup, step: 1
Epoch 151/200 |loss: 7.358929| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 2
Epoch 152/200 |loss: 7.361012| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 3
Epoch 153/200 |loss: 7.378435| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 4
Epoch 154/200 |loss: 7.257404| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 5
Epoch 155/200 |loss: 7.273197| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6
Epoch 156/200 |loss: 7.331514| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 7
Epoch 157/200 |loss: 7.293070| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8
Epoch 158/200 |loss: 7.266565| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 9
Epoch 159/200 |loss: 7.175764| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 10
Epoch 160/200 |loss: 7.273788| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 11
Epoch 161/200 |loss: 7.228655| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 12
Epoch 162/200 |loss: 7.226608| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 13
Epoch 163/200 |loss: 7.216318| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 14
Epoch 164/200 |loss: 7.206770| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 15
Epoch 165/200 |loss: 7.209230| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16
Epoch 166/200 |loss: 7.186678| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17
Epoch 167/200 |loss: 7.176235| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18
Epoch 168/200 |loss: 7.132417| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19
Epoch 169/200 |loss: 7.155602| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 170/200 |loss: 7.140207| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21
Epoch 171/200 |loss: 7.145352| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 22
Epoch 172/200 |loss: 7.190806| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23
Epoch 173/200 |loss: 7.198124| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 24
Epoch 174/200 |loss: 7.267064| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 25
Epoch 175/200 |loss: 7.250618| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 176/200 |loss: 7.388881| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 27
Epoch 177/200 |loss: 7.306983| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 28
Epoch 178/200 |loss: 7.774083| train set 5.448x speedup, test set 5.331x speedup, val set 5.065x speedup, step: 29
Epoch 179/200 |loss: 7.603914| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 180/200 |loss: 7.413798| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 31
Epoch 181/200 |loss: 7.283081| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 32
Epoch 182/200 |loss: 7.364038| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 33
Epoch 183/200 |loss: 7.433404| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 34
Epoch 184/200 |loss: 7.316210| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 35
Epoch 185/200 |loss: 7.347363| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 36
Epoch 186/200 |loss: 7.630581| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 37
Epoch 187/200 |loss: 7.199524| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 38
Epoch 188/200 |loss: 7.612771| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 39
Epoch 189/200 |loss: 7.870096| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 190/200 |loss: 7.470235| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 41
Epoch 191/200 |loss: 7.921120| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 192/200 |loss: 7.427333| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 193/200 |loss: 7.539165| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 44
Epoch 194/200 |loss: 7.407862| train set 5.496x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 195/200 |loss: 7.421887| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 46
Epoch 196/200 |loss: 7.409027| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 197/200 |loss: 7.366939| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 48
Epoch 198/200 |loss: 7.349804| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 199/200 |loss: 7.363679| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Training per epoch cost 0.208 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 7.469s, pg runtime 23.223s, speedup 3.109x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 139, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 42, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 150, train speedup 5.460, test speedup 5.375, val speedup 5.204
last model at epoch 199, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:02:10.038507
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.278373, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055296| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511551| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474649| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037216| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524694| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074774| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570408| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.079777| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.587358| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.079872| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 14
Epoch 14/200 |loss: 17.624088| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.143946| train set 4.419x speedup, test set 4.236x speedup, val set 4.157x speedup, step: 16
Epoch 16/200 |loss: 16.675379| train set 4.423x speedup, test set 4.186x speedup, val set 4.195x speedup, step: 17
Epoch 17/200 |loss: 16.232174| train set 4.552x speedup, test set 4.339x speedup, val set 4.345x speedup, step: 18
Epoch 18/200 |loss: 15.856031| train set 4.702x speedup, test set 4.509x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.607270| train set 4.803x speedup, test set 4.643x speedup, val set 4.539x speedup, step: 20
Epoch 20/200 |loss: 15.216039| train set 5.009x speedup, test set 4.817x speedup, val set 4.783x speedup, step: 21
Epoch 21/200 |loss: 14.603423| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.502889| train set 5.212x speedup, test set 5.052x speedup, val set 4.944x speedup, step: 23
Epoch 23/200 |loss: 14.172097| train set 5.472x speedup, test set 5.383x speedup, val set 5.103x speedup, step: 24
Epoch 24/200 |loss: 13.635985| train set 5.400x speedup, test set 5.312x speedup, val set 5.038x speedup, step: 25
Epoch 25/200 |loss: 13.516128| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 26
Epoch 26/200 |loss: 13.163829| train set 5.472x speedup, test set 5.383x speedup, val set 5.103x speedup, step: 27
Epoch 27/200 |loss: 12.749838| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 28
Epoch 28/200 |loss: 12.538139| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 29
Epoch 29/200 |loss: 12.144666| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 30
Epoch 30/200 |loss: 11.967386| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 31
Epoch 31/200 |loss: 11.640335| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 32/200 |loss: 11.403741| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 33
Epoch 33/200 |loss: 11.936133| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 12.601688| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 35
Epoch 35/200 |loss: 11.103357| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 11.384058| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 37
Epoch 37/200 |loss: 11.046273| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 38
Epoch 38/200 |loss: 10.709713| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 39
Epoch 39/200 |loss: 10.720772| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.186350| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 10.413453| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 9.941968| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 43
Epoch 43/200 |loss: 10.255067| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 44
Epoch 44/200 |loss: 9.624187| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.718350| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.423479| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 47
Epoch 47/200 |loss: 9.318449| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.255565| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.137214| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 50
Epoch 50/200 |loss: 9.265154| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 51
Epoch 51/200 |loss: 9.658427| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 52
Epoch 52/200 |loss: 9.252287| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 9.428539| train set 5.229x speedup, test set 5.043x speedup, val set 5.062x speedup, step: 54
Epoch 54/200 |loss: 9.730585| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 9.388896| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 56
Epoch 56/200 |loss: 9.349974| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 9.289504| train set 5.273x speedup, test set 5.143x speedup, val set 4.979x speedup, step: 58
Epoch 58/200 |loss: 8.887045| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.856756| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.714168| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.775654| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.514547| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 63
Epoch 63/200 |loss: 8.569975| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.404772| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.323972| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.332460| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.197903| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.169249| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.177697| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.020385| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.086933| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.026412| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.204078| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 74
Epoch 74/200 |loss: 8.351779| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 75
Epoch 75/200 |loss: 9.122458| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.029053| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 77
Epoch 77/200 |loss: 9.179283| train set 5.307x speedup, test set 5.188x speedup, val set 4.964x speedup, step: 78
Epoch 78/200 |loss: 8.672812| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.777411| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 8.413659| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 81
Epoch 81/200 |loss: 8.666462| train set 5.496x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 8.292727| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 83
Epoch 83/200 |loss: 8.528751| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 8.073500| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 8.104878| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 86
Epoch 86/200 |loss: 8.048360| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 87
Epoch 87/200 |loss: 7.988266| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.915671| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.903553| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 7.821024| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 91
Epoch 91/200 |loss: 7.781652| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.769392| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 93
Epoch 93/200 |loss: 7.694705| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 7.745819| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 7.737638| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 96
Epoch 96/200 |loss: 7.826417| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 8.134753| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 98
Epoch 98/200 |loss: 7.906260| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 99
Epoch 99/200 |loss: 7.625324| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 100
Epoch 100/200 |loss: 7.596107| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 101
Epoch 101/200 |loss: 7.884865| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 102/200 |loss: 8.019733| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 2
Epoch 103/200 |loss: 7.667695| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 104/200 |loss: 7.606928| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 2
Epoch 105/200 |loss: 7.993612| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 3
Epoch 106/200 |loss: 7.600738| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1
Epoch 107/200 |loss: 7.525087| train set 5.459x speedup, test set 5.374x speedup, val set 5.205x speedup, step: 1
Epoch 108/200 |loss: 7.713162| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 2
Epoch 109/200 |loss: 7.516153| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 3
Epoch 110/200 |loss: 7.470352| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 4
Epoch 111/200 |loss: 7.698781| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 5
Epoch 112/200 |loss: 7.482406| train set 5.497x speedup, test set 5.420x speedup, val set 5.104x speedup, step: 6
Epoch 113/200 |loss: 7.408802| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7
Epoch 114/200 |loss: 7.527946| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 8
Epoch 115/200 |loss: 7.456168| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 9
Epoch 116/200 |loss: 7.381995| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 10
Epoch 117/200 |loss: 7.355412| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 11
Epoch 118/200 |loss: 7.395973| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 12
Epoch 119/200 |loss: 7.460118| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 13
Epoch 120/200 |loss: 7.341743| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 14
Epoch 121/200 |loss: 7.325961| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 15
Epoch 122/200 |loss: 7.346751| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 16
Epoch 123/200 |loss: 7.419250| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17
Epoch 124/200 |loss: 7.411727| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18
Epoch 125/200 |loss: 7.405746| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19
Epoch 126/200 |loss: 7.328321| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 127/200 |loss: 7.520806| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 21
Epoch 128/200 |loss: 7.669696| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 22
Epoch 129/200 |loss: 8.272821| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23
Epoch 130/200 |loss: 7.649117| train set 5.450x speedup, test set 5.315x speedup, val set 5.070x speedup, step: 24
Epoch 131/200 |loss: 8.362268| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 25
Epoch 132/200 |loss: 8.316164| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 133/200 |loss: 7.860302| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 27
Epoch 134/200 |loss: 8.324457| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 28
Epoch 135/200 |loss: 7.884058| train set 5.449x speedup, test set 5.221x speedup, val set 5.054x speedup, step: 29
Epoch 136/200 |loss: 7.829726| train set 5.448x speedup, test set 5.332x speedup, val set 5.067x speedup, step: 30
Epoch 137/200 |loss: 7.835252| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 31
Epoch 138/200 |loss: 7.726273| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 32
Epoch 139/200 |loss: 7.809261| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 33
Epoch 140/200 |loss: 7.527230| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 34
Epoch 141/200 |loss: 7.766891| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 35
Epoch 142/200 |loss: 7.488001| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 36
Epoch 143/200 |loss: 7.637927| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 37
Epoch 144/200 |loss: 7.432476| train set 5.449x speedup, test set 5.331x speedup, val set 5.065x speedup, step: 38
Epoch 145/200 |loss: 7.590271| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 39
Epoch 146/200 |loss: 7.440211| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 40
Epoch 147/200 |loss: 7.482232| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 41
Epoch 148/200 |loss: 7.372353| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 42
Epoch 149/200 |loss: 7.409596| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 43
Epoch 150/200 |loss: 7.419703| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 44
Epoch 151/200 |loss: 7.431273| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 45
Epoch 152/200 |loss: 7.459587| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 46
Epoch 153/200 |loss: 7.335273| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 47
Epoch 154/200 |loss: 7.311447| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 48
Epoch 155/200 |loss: 7.376736| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 49
Epoch 156/200 |loss: 7.302905| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 50
Epoch 157/200 |loss: 7.333121| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 51
Epoch 158/200 |loss: 7.258809| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 52
Epoch 159/200 |loss: 7.231625| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 53
Epoch 160/200 |loss: 7.273226| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 54
Epoch 161/200 |loss: 7.255991| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 55
Epoch 162/200 |loss: 7.240315| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 56
Epoch 163/200 |loss: 7.243886| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 164/200 |loss: 7.238149| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 165/200 |loss: 7.238328| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 166/200 |loss: 7.241825| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 60
Epoch 167/200 |loss: 7.196702| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 168/200 |loss: 7.218092| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 62
Epoch 169/200 |loss: 7.251133| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 63
Epoch 170/200 |loss: 7.283287| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 64
Epoch 171/200 |loss: 7.309264| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 172/200 |loss: 7.465209| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 66
Epoch 173/200 |loss: 7.369666| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 174/200 |loss: 7.344958| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 68
Epoch 175/200 |loss: 7.190213| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 69
Epoch 176/200 |loss: 7.174392| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 70
Epoch 177/200 |loss: 7.222869| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 71
Epoch 178/200 |loss: 7.170338| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 72
Epoch 179/200 |loss: 7.186897| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 180/200 |loss: 7.189800| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 74
Epoch 181/200 |loss: 7.183022| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 182/200 |loss: 7.175286| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 183/200 |loss: 7.175505| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 77
Epoch 184/200 |loss: 7.166447| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 78
Epoch 185/200 |loss: 7.201044| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 186/200 |loss: 7.203362| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 80
Epoch 187/200 |loss: 7.220749| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 81
Epoch 188/200 |loss: 7.180825| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 82
Epoch 189/200 |loss: 7.223968| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 83
Epoch 190/200 |loss: 7.205940| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 84
Epoch 191/200 |loss: 7.187173| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 85
Epoch 192/200 |loss: 7.140047| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 86
Epoch 193/200 |loss: 7.193185| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 87
Epoch 194/200 |loss: 7.169033| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 88
Epoch 195/200 |loss: 7.195468| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 89
Epoch 196/200 |loss: 7.241277| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 90
Epoch 197/200 |loss: 7.500841| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 91
Epoch 198/200 |loss: 7.267214| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 92
Epoch 199/200 |loss: 7.160283| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 93
Training per epoch cost 0.208 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 7.469s, pg runtime 23.223s, speedup 3.109x
19, opt runtime 1.309s, model runtime 1.309s, pg runtime 1.356s, speedup 1.036x
20, opt runtime 1.340s, model runtime 1.490s, pg runtime 1.340s, speedup 0.899x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 172, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 40, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 107, train speedup 5.459, test speedup 5.374, val speedup 5.205
last model at epoch 199, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:02:11.252361
==================================================
all print will write to path record/postgresql/TPCH/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.111918, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.567x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055296| train set 3.159x speedup, test set 3.019x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 3.064x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 3.398x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 3.932x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995949| train set 4.128x speedup, test set 3.894x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 4.190x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037212| train set 3.601x speedup, test set 3.471x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524681| train set 3.688x speedup, test set 3.466x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074415| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.569862| train set 4.397x speedup, test set 4.211x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.077785| train set 4.418x speedup, test set 4.204x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586597| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.082907| train set 4.548x speedup, test set 4.360x speedup, val set 4.274x speedup, step: 14
Epoch 14/200 |loss: 17.599068| train set 4.467x speedup, test set 4.282x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.098194| train set 4.418x speedup, test set 4.205x speedup, val set 4.129x speedup, step: 16
Epoch 16/200 |loss: 16.651695| train set 4.342x speedup, test set 4.131x speedup, val set 4.060x speedup, step: 17
Epoch 17/200 |loss: 16.165287| train set 4.553x speedup, test set 4.340x speedup, val set 4.345x speedup, step: 18
Epoch 18/200 |loss: 15.695159| train set 4.803x speedup, test set 4.643x speedup, val set 4.539x speedup, step: 19
Epoch 19/200 |loss: 15.340376| train set 4.902x speedup, test set 4.712x speedup, val set 4.707x speedup, step: 20
Epoch 20/200 |loss: 15.427233| train set 4.906x speedup, test set 4.745x speedup, val set 4.609x speedup, step: 21
Epoch 21/200 |loss: 14.972824| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.187304| train set 5.431x speedup, test set 5.321x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 14.260273| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 24
Epoch 24/200 |loss: 13.575062| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.425442| train set 5.472x speedup, test set 5.383x speedup, val set 5.103x speedup, step: 26
Epoch 26/200 |loss: 13.111935| train set 5.472x speedup, test set 5.383x speedup, val set 5.103x speedup, step: 27
Epoch 27/200 |loss: 12.629019| train set 5.308x speedup, test set 5.189x speedup, val set 4.963x speedup, step: 28
Epoch 28/200 |loss: 12.652429| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.216926| train set 5.472x speedup, test set 5.383x speedup, val set 5.103x speedup, step: 30
Epoch 30/200 |loss: 11.935658| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 31
Epoch 31/200 |loss: 11.754412| train set 5.472x speedup, test set 5.383x speedup, val set 5.103x speedup, step: 32
Epoch 32/200 |loss: 11.387930| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.642909| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 34
Epoch 34/200 |loss: 11.543797| train set 5.472x speedup, test set 5.383x speedup, val set 5.104x speedup, step: 35
Epoch 35/200 |loss: 11.123115| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 10.774243| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.866965| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 38
Epoch 38/200 |loss: 10.691651| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 39
Epoch 39/200 |loss: 10.323560| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 40
Epoch 40/200 |loss: 10.259329| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 41
Epoch 41/200 |loss: 10.355077| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 9.965888| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.829410| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 10.027033| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 45
Epoch 45/200 |loss: 9.985658| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.834632| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.292570| train set 5.449x speedup, test set 5.221x speedup, val set 5.054x speedup, step: 48
Epoch 48/200 |loss: 9.494905| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.397331| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.258873| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.140954| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.123247| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 8.983589| train set 5.308x speedup, test set 5.189x speedup, val set 4.963x speedup, step: 54
Epoch 54/200 |loss: 8.880105| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.716457| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.720200| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.523180| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.520178| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.548298| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 60
Epoch 60/200 |loss: 8.591011| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.820259| train set 5.449x speedup, test set 5.331x speedup, val set 5.064x speedup, step: 62
Epoch 62/200 |loss: 8.357797| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 63
Epoch 63/200 |loss: 8.349576| train set 5.449x speedup, test set 5.221x speedup, val set 5.054x speedup, step: 64
Epoch 64/200 |loss: 8.524835| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 65
Epoch 65/200 |loss: 8.568956| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.230825| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.132462| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 68
Epoch 68/200 |loss: 8.334288| train set 5.450x speedup, test set 5.222x speedup, val set 5.054x speedup, step: 69
Epoch 69/200 |loss: 8.532920| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 70
Epoch 70/200 |loss: 8.078379| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 71
Epoch 71/200 |loss: 8.322097| train set 5.404x speedup, test set 5.120x speedup, val set 5.141x speedup, step: 72
Epoch 72/200 |loss: 9.037383| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.267177| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 74
Epoch 74/200 |loss: 9.118337| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 8.398504| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.591833| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 8.457847| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 78
Epoch 78/200 |loss: 8.436162| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.174145| train set 5.498x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 80
Epoch 80/200 |loss: 8.363279| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 81
Epoch 81/200 |loss: 8.110244| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 82
Epoch 82/200 |loss: 8.363117| train set 5.459x speedup, test set 5.373x speedup, val set 5.204x speedup, step: 83
Epoch 83/200 |loss: 7.884124| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 8.163326| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.969377| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 86
Epoch 86/200 |loss: 8.082310| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 87
Epoch 87/200 |loss: 7.845267| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.963816| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 89
Epoch 89/200 |loss: 7.898922| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 90
Epoch 90/200 |loss: 7.835369| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 91
Epoch 91/200 |loss: 7.723367| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.790370| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 93
Epoch 93/200 |loss: 7.746099| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 7.682886| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 7.621634| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 7.651004| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 7.635290| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 98
Epoch 98/200 |loss: 7.740088| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.674878| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.976618| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 101
Epoch 101/200 |loss: 7.593952| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 102/200 |loss: 7.549221| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 103/200 |loss: 7.559871| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 104/200 |loss: 7.623714| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 105/200 |loss: 7.590144| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 106/200 |loss: 7.457125| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 107/200 |loss: 7.398487| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 108/200 |loss: 7.454627| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 109/200 |loss: 7.520630| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1
Epoch 110/200 |loss: 7.677150| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2
Epoch 111/200 |loss: 7.586732| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 1
Epoch 112/200 |loss: 7.613470| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 2
Epoch 113/200 |loss: 7.561456| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 3
Epoch 114/200 |loss: 7.674971| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 115/200 |loss: 7.942803| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 5
Epoch 116/200 |loss: 7.525777| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 6
Epoch 117/200 |loss: 7.591962| train set 5.450x speedup, test set 5.222x speedup, val set 5.054x speedup, step: 7
Epoch 118/200 |loss: 7.880377| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8
Epoch 119/200 |loss: 7.611202| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 9
Epoch 120/200 |loss: 7.788281| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1
Epoch 121/200 |loss: 8.426267| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 2
Epoch 122/200 |loss: 7.676113| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 3
Epoch 123/200 |loss: 8.508936| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4
Epoch 124/200 |loss: 8.027693| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5
Epoch 125/200 |loss: 8.106620| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6
Epoch 126/200 |loss: 7.798223| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 7
Epoch 127/200 |loss: 8.010489| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 8
Epoch 128/200 |loss: 7.775043| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 9
Epoch 129/200 |loss: 7.780326| train set 5.448x speedup, test set 5.331x speedup, val set 5.066x speedup, step: 10
Epoch 130/200 |loss: 7.770317| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 11
Epoch 131/200 |loss: 7.743220| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 12
Epoch 132/200 |loss: 7.613715| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 13
Epoch 133/200 |loss: 7.622239| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 14
Epoch 134/200 |loss: 7.593301| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 15
Epoch 135/200 |loss: 7.516811| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16
Epoch 136/200 |loss: 7.461502| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 17
Epoch 137/200 |loss: 7.482165| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 18
Epoch 138/200 |loss: 7.486724| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19
Epoch 139/200 |loss: 7.366541| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20
Epoch 140/200 |loss: 7.426089| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 21
Epoch 141/200 |loss: 7.365908| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 22
Epoch 142/200 |loss: 7.366460| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 23
Epoch 143/200 |loss: 7.321329| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 24
Epoch 144/200 |loss: 7.331351| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 25
Epoch 145/200 |loss: 7.308626| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 26
Epoch 146/200 |loss: 7.284822| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 27
Epoch 147/200 |loss: 7.299119| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28
Epoch 148/200 |loss: 7.265624| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 29
Epoch 149/200 |loss: 7.258129| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30
Epoch 150/200 |loss: 7.243560| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31
Epoch 151/200 |loss: 7.245543| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 32
Epoch 152/200 |loss: 7.261664| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 33
Epoch 153/200 |loss: 7.259719| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 34
Epoch 154/200 |loss: 7.278450| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 35
Epoch 155/200 |loss: 7.255006| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 36
Epoch 156/200 |loss: 7.231772| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 37
Epoch 157/200 |loss: 7.212811| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 38
Epoch 158/200 |loss: 7.233981| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 39
Epoch 159/200 |loss: 7.360547| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 40
Epoch 160/200 |loss: 7.365335| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41
Epoch 161/200 |loss: 7.537150| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 42
Epoch 162/200 |loss: 7.421029| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 43
Epoch 163/200 |loss: 7.342050| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 44
Epoch 164/200 |loss: 7.203384| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 45
Epoch 165/200 |loss: 7.251483| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46
Epoch 166/200 |loss: 7.395406| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 47
Epoch 167/200 |loss: 7.242063| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 48
Epoch 168/200 |loss: 7.236879| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 49
Epoch 169/200 |loss: 7.352451| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 50
Epoch 170/200 |loss: 7.239282| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 51
Epoch 171/200 |loss: 7.167959| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 52
Epoch 172/200 |loss: 7.190920| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 53
Epoch 173/200 |loss: 7.213799| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 54
Epoch 174/200 |loss: 7.235223| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 55
Epoch 175/200 |loss: 7.142913| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 56
Epoch 176/200 |loss: 7.167438| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 57
Epoch 177/200 |loss: 7.255661| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 58
Epoch 178/200 |loss: 7.282117| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 59
Epoch 179/200 |loss: 7.248207| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 60
Epoch 180/200 |loss: 7.519243| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 61
Epoch 181/200 |loss: 7.537844| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 62
Epoch 182/200 |loss: 7.584052| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 63
Epoch 183/200 |loss: 7.247750| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 64
Epoch 184/200 |loss: 7.359714| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 65
Epoch 185/200 |loss: 7.589571| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 66
Epoch 186/200 |loss: 7.383590| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 67
Epoch 187/200 |loss: 7.427047| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 68
Epoch 188/200 |loss: 7.535148| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 69
Epoch 189/200 |loss: 7.349826| train set 5.493x speedup, test set 5.414x speedup, val set 5.109x speedup, step: 70
Epoch 190/200 |loss: 7.404729| train set 5.498x speedup, test set 5.421x speedup, val set 5.103x speedup, step: 71
Epoch 191/200 |loss: 7.396593| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 72
Epoch 192/200 |loss: 7.319888| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 73
Epoch 193/200 |loss: 7.277501| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 74
Epoch 194/200 |loss: 7.343310| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 75
Epoch 195/200 |loss: 7.233973| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 76
Epoch 196/200 |loss: 7.296282| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 77
Epoch 197/200 |loss: 7.410439| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 78
Epoch 198/200 |loss: 7.175225| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 79
Epoch 199/200 |loss: 7.464938| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 80
Training per epoch cost 0.211 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 164, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 43, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 120, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 199, train speedup 5.497, test speedup 5.422, val speedup 5.106
execution cost 0:02:11.632148
==================================================
