all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.521015, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.405166| train set 3.719x speedup, test set 3.647x speedup, val set 3.676x speedup, step: 1, train time 10.16 s
Epoch 1/50 |loss: 0.241225| train set 5.320x speedup, test set 5.186x speedup, val set 5.472x speedup, step: 2, train time 10.01 s
Epoch 2/50 |loss: 0.207356| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 3, train time 9.48 s
Epoch 3/50 |loss: 0.188397| train set 5.138x speedup, test set 5.068x speedup, val set 5.275x speedup, step: 4, train time 9.20 s
Epoch 4/50 |loss: 0.174653| train set 5.007x speedup, test set 4.890x speedup, val set 5.032x speedup, step: 1, train time 9.96 s
Epoch 5/50 |loss: 0.167195| train set 5.248x speedup, test set 5.104x speedup, val set 5.509x speedup, step: 2, train time 9.31 s
Epoch 6/50 |loss: 0.163977| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 3, train time 9.31 s
Epoch 7/50 |loss: 0.158982| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 9.79 s
Epoch 8/50 |loss: 0.152330| train set 5.316x speedup, test set 5.190x speedup, val set 5.467x speedup, step: 5, train time 9.32 s
Epoch 9/50 |loss: 0.150544| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 1, train time 9.10 s
Epoch 10/50 |loss: 0.151959| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 7.41 s
Epoch 11/50 |loss: 0.148028| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 8.02 s
Epoch 12/50 |loss: 0.141628| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 4, train time 9.23 s
Epoch 13/50 |loss: 0.141563| train set 5.284x speedup, test set 5.157x speedup, val set 5.460x speedup, step: 5, train time 8.82 s
Epoch 14/50 |loss: 0.145147| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 6, train time 9.50 s
Epoch 15/50 |loss: 0.139583| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 7, train time 9.49 s
Epoch 16/50 |loss: 0.134656| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8, train time 9.47 s
Epoch 17/50 |loss: 0.139558| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 9, train time 9.58 s
Epoch 18/50 |loss: 0.136300| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 10, train time 9.60 s
Epoch 19/50 |loss: 0.135686| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11, train time 9.51 s
Epoch 20/50 |loss: 0.133876| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 12, train time 9.31 s
Epoch 21/50 |loss: 0.132404| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13, train time 9.68 s
Epoch 22/50 |loss: 0.133720| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 9.11 s
Epoch 23/50 |loss: 0.135388| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15, train time 9.80 s
Epoch 24/50 |loss: 0.130903| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 1, train time 9.22 s
Epoch 25/50 |loss: 0.134013| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 9.30 s
Epoch 26/50 |loss: 0.129379| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 9.38 s
Epoch 27/50 |loss: 0.131792| train set 5.287x speedup, test set 5.133x speedup, val set 5.438x speedup, step: 4, train time 9.20 s
Epoch 28/50 |loss: 0.130082| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 5, train time 9.39 s
Epoch 29/50 |loss: 0.131217| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 6, train time 9.29 s
Epoch 30/50 |loss: 0.128513| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7, train time 9.30 s
Epoch 31/50 |loss: 0.128360| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 8, train time 9.49 s
Epoch 32/50 |loss: 0.128336| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9, train time 9.72 s
Epoch 33/50 |loss: 0.128148| train set 5.387x speedup, test set 5.262x speedup, val set 5.531x speedup, step: 10, train time 9.49 s
Epoch 34/50 |loss: 0.128784| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11, train time 9.48 s
Epoch 35/50 |loss: 0.125234| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12, train time 9.37 s
Epoch 36/50 |loss: 0.127478| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 13, train time 9.38 s
Epoch 37/50 |loss: 0.124432| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 9.51 s
Epoch 38/50 |loss: 0.127265| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15, train time 9.69 s
Epoch 39/50 |loss: 0.127726| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16, train time 9.29 s
Epoch 40/50 |loss: 0.124551| train set 5.215x speedup, test set 5.076x speedup, val set 5.430x speedup, step: 17, train time 9.31 s
Epoch 41/50 |loss: 0.125425| train set 5.383x speedup, test set 5.262x speedup, val set 5.547x speedup, step: 18, train time 9.78 s
Epoch 42/50 |loss: 0.124747| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 9.48 s
Epoch 43/50 |loss: 0.126644| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20, train time 9.62 s
Epoch 44/50 |loss: 0.125054| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21, train time 9.40 s
Epoch 45/50 |loss: 0.123696| train set 5.385x speedup, test set 5.259x speedup, val set 5.525x speedup, step: 22, train time 9.19 s
Epoch 46/50 |loss: 0.122378| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 23, train time 9.39 s
Epoch 47/50 |loss: 0.124248| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 24, train time 9.39 s
Epoch 48/50 |loss: 0.123288| train set 5.348x speedup, test set 5.225x speedup, val set 5.533x speedup, step: 25, train time 9.51 s
Epoch 49/50 |loss: 0.122760| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26, train time 9.29 s
Training per epoch cost 9.381 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.015s, pg runtime 1.092s, speedup 1.076x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 7, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 33, train speedup 5.387, test speedup 5.262, val speedup 5.531
best validation speedup epoch: 24, train speedup 5.389, test speedup 5.258, val speedup 5.548
last model at epoch 49, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:08:16.006502
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.547388, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.403165| train set 4.660x speedup, test set 4.578x speedup, val set 4.656x speedup, step: 1, train time 9.70 s
Epoch 1/50 |loss: 0.242517| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 2, train time 9.69 s
Epoch 2/50 |loss: 0.208491| train set 5.320x speedup, test set 5.187x speedup, val set 5.469x speedup, step: 3, train time 9.59 s
Epoch 3/50 |loss: 0.186441| train set 5.138x speedup, test set 5.067x speedup, val set 5.278x speedup, step: 4, train time 9.49 s
Epoch 4/50 |loss: 0.177492| train set 5.169x speedup, test set 5.032x speedup, val set 5.353x speedup, step: 1, train time 9.51 s
Epoch 5/50 |loss: 0.168338| train set 5.320x speedup, test set 5.188x speedup, val set 5.470x speedup, step: 2, train time 9.57 s
Epoch 6/50 |loss: 0.162403| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 3, train time 9.22 s
Epoch 7/50 |loss: 0.158516| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 9.22 s
Epoch 8/50 |loss: 0.151248| train set 5.316x speedup, test set 5.188x speedup, val set 5.467x speedup, step: 5, train time 9.51 s
Epoch 9/50 |loss: 0.152750| train set 5.320x speedup, test set 5.187x speedup, val set 5.469x speedup, step: 1, train time 9.08 s
Epoch 10/50 |loss: 0.152034| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 8.80 s
Epoch 11/50 |loss: 0.146952| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3, train time 9.32 s
Epoch 12/50 |loss: 0.142502| train set 5.215x speedup, test set 5.077x speedup, val set 5.446x speedup, step: 4, train time 9.18 s
Epoch 13/50 |loss: 0.140439| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 5, train time 9.38 s
Epoch 14/50 |loss: 0.145436| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 6, train time 9.21 s
Epoch 15/50 |loss: 0.138387| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 7, train time 9.12 s
Epoch 16/50 |loss: 0.135572| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8, train time 9.12 s
Epoch 17/50 |loss: 0.138225| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 9, train time 9.12 s
Epoch 18/50 |loss: 0.136137| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 10, train time 9.27 s
Epoch 19/50 |loss: 0.135687| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 1, train time 9.28 s
Epoch 20/50 |loss: 0.133548| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2, train time 8.91 s
Epoch 21/50 |loss: 0.131249| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 9.00 s
Epoch 22/50 |loss: 0.133200| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 8.81 s
Epoch 23/50 |loss: 0.132949| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5, train time 8.59 s
Epoch 24/50 |loss: 0.129627| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 6, train time 9.41 s
Epoch 25/50 |loss: 0.132989| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 7, train time 8.79 s
Epoch 26/50 |loss: 0.128250| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 8, train time 9.20 s
Epoch 27/50 |loss: 0.130140| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9, train time 9.52 s
Epoch 28/50 |loss: 0.129915| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 10, train time 8.70 s
Epoch 29/50 |loss: 0.130855| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 11, train time 9.17 s
Epoch 30/50 |loss: 0.126172| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12, train time 9.72 s
Epoch 31/50 |loss: 0.127216| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 13, train time 9.09 s
Epoch 32/50 |loss: 0.127085| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 8.70 s
Epoch 33/50 |loss: 0.126948| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15, train time 9.28 s
Epoch 34/50 |loss: 0.127582| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16, train time 8.88 s
Epoch 35/50 |loss: 0.126087| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 17, train time 9.10 s
Epoch 36/50 |loss: 0.125524| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 18, train time 9.12 s
Epoch 37/50 |loss: 0.124510| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 9.09 s
Epoch 38/50 |loss: 0.126979| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20, train time 9.09 s
Epoch 39/50 |loss: 0.127079| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21, train time 9.29 s
early stopping at epoch 39
Training per epoch cost 9.196 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 7, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 15, train speedup 5.389, test speedup 5.258, val speedup 5.548
best validation speedup epoch: 19, train speedup 5.316, test speedup 5.171, val speedup 5.588
last model at epoch 39, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:06:29.831668
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.532120, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.402989| train set 4.473x speedup, test set 4.295x speedup, val set 4.423x speedup, step: 1, train time 9.98 s
Epoch 1/50 |loss: 0.242654| train set 5.320x speedup, test set 5.186x speedup, val set 5.472x speedup, step: 2, train time 8.99 s
Epoch 2/50 |loss: 0.205553| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 9.31 s
Epoch 3/50 |loss: 0.187385| train set 5.138x speedup, test set 5.068x speedup, val set 5.275x speedup, step: 4, train time 9.20 s
Epoch 4/50 |loss: 0.175561| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 1, train time 9.30 s
Epoch 5/50 |loss: 0.168039| train set 5.248x speedup, test set 5.105x speedup, val set 5.510x speedup, step: 2, train time 9.01 s
Epoch 6/50 |loss: 0.162958| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3, train time 9.28 s
Epoch 7/50 |loss: 0.160020| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 8.98 s
Epoch 8/50 |loss: 0.151303| train set 5.316x speedup, test set 5.189x speedup, val set 5.466x speedup, step: 5, train time 8.68 s
Epoch 9/50 |loss: 0.152405| train set 5.318x speedup, test set 5.191x speedup, val set 5.472x speedup, step: 6, train time 7.59 s
Epoch 10/50 |loss: 0.151589| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7, train time 8.19 s
Epoch 11/50 |loss: 0.147981| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8, train time 9.29 s
Epoch 12/50 |loss: 0.140832| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 9, train time 9.08 s
Epoch 13/50 |loss: 0.140066| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 10, train time 9.29 s
Epoch 14/50 |loss: 0.145069| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1, train time 9.39 s
Epoch 15/50 |loss: 0.137056| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 2, train time 9.87 s
Epoch 16/50 |loss: 0.136476| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 9.31 s
Epoch 17/50 |loss: 0.138398| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 9.80 s
Epoch 18/50 |loss: 0.135081| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 5, train time 9.30 s
Epoch 19/50 |loss: 0.135231| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1, train time 9.48 s
Epoch 20/50 |loss: 0.134712| train set 5.352x speedup, test set 5.226x speedup, val set 5.517x speedup, step: 2, train time 9.48 s
Epoch 21/50 |loss: 0.131661| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 9.70 s
Epoch 22/50 |loss: 0.133512| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 9.48 s
Epoch 23/50 |loss: 0.133645| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5, train time 9.59 s
Epoch 24/50 |loss: 0.130501| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 1, train time 8.98 s
Epoch 25/50 |loss: 0.131391| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2, train time 9.29 s
Epoch 26/50 |loss: 0.128709| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 9.18 s
Epoch 27/50 |loss: 0.131489| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 4, train time 9.49 s
Epoch 28/50 |loss: 0.129605| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 5, train time 8.99 s
Epoch 29/50 |loss: 0.129949| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 6, train time 9.49 s
Epoch 30/50 |loss: 0.127107| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 7, train time 9.40 s
Epoch 31/50 |loss: 0.128179| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8, train time 9.02 s
Epoch 32/50 |loss: 0.127965| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9, train time 9.61 s
Epoch 33/50 |loss: 0.127343| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 10, train time 9.51 s
Epoch 34/50 |loss: 0.126498| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 11, train time 9.40 s
Epoch 35/50 |loss: 0.125661| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12, train time 9.28 s
Epoch 36/50 |loss: 0.124948| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 13, train time 9.39 s
Epoch 37/50 |loss: 0.123513| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 14, train time 9.20 s
Epoch 38/50 |loss: 0.125970| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15, train time 9.09 s
Epoch 39/50 |loss: 0.126203| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16, train time 9.48 s
Epoch 40/50 |loss: 0.121733| train set 5.215x speedup, test set 5.076x speedup, val set 5.430x speedup, step: 17, train time 9.10 s
Epoch 41/50 |loss: 0.125040| train set 5.385x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 18, train time 9.40 s
Epoch 42/50 |loss: 0.122780| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 9.38 s
Epoch 43/50 |loss: 0.124759| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20, train time 9.49 s
Epoch 44/50 |loss: 0.124180| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21, train time 9.39 s
Epoch 45/50 |loss: 0.123604| train set 5.348x speedup, test set 5.225x speedup, val set 5.533x speedup, step: 22, train time 9.22 s
Epoch 46/50 |loss: 0.121497| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23, train time 9.18 s
Epoch 47/50 |loss: 0.120898| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 24, train time 9.29 s
Epoch 48/50 |loss: 0.123213| train set 5.348x speedup, test set 5.225x speedup, val set 5.533x speedup, step: 25, train time 9.30 s
Epoch 49/50 |loss: 0.121519| train set 5.323x speedup, test set 5.165x speedup, val set 5.449x speedup, step: 26, train time 7.89 s
Training per epoch cost 9.240 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.015s, pg runtime 1.092s, speedup 1.076x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 2, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 33, train speedup 5.389, test speedup 5.258, val speedup 5.528
best validation speedup epoch: 24, train speedup 5.389, test speedup 5.258, val speedup 5.548
last model at epoch 49, train speedup 5.323, test speedup 5.165, val speedup 5.449
execution cost 0:08:07.767394
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.523932, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.399782| train set 3.843x speedup, test set 3.872x speedup, val set 3.895x speedup, step: 1, train time 9.87 s
Epoch 1/50 |loss: 0.243622| train set 5.247x speedup, test set 5.158x speedup, val set 5.357x speedup, step: 2, train time 9.82 s
Epoch 2/50 |loss: 0.207549| train set 5.320x speedup, test set 5.187x speedup, val set 5.469x speedup, step: 3, train time 9.70 s
Epoch 3/50 |loss: 0.187936| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 4, train time 9.80 s
Epoch 4/50 |loss: 0.176510| train set 5.169x speedup, test set 5.032x speedup, val set 5.353x speedup, step: 1, train time 9.47 s
Epoch 5/50 |loss: 0.169756| train set 5.320x speedup, test set 5.188x speedup, val set 5.470x speedup, step: 2, train time 9.98 s
Epoch 6/50 |loss: 0.163169| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 3, train time 9.80 s
Epoch 7/50 |loss: 0.160285| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 4, train time 9.11 s
Epoch 8/50 |loss: 0.152128| train set 5.316x speedup, test set 5.192x speedup, val set 5.449x speedup, step: 5, train time 9.78 s
Epoch 9/50 |loss: 0.151441| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 1, train time 10.01 s
Epoch 10/50 |loss: 0.152730| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 9.48 s
Epoch 11/50 |loss: 0.149594| train set 5.323x speedup, test set 5.165x speedup, val set 5.449x speedup, step: 3, train time 9.51 s
Epoch 12/50 |loss: 0.142837| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 4, train time 9.80 s
Epoch 13/50 |loss: 0.141031| train set 5.280x speedup, test set 5.141x speedup, val set 5.578x speedup, step: 5, train time 9.31 s
Epoch 14/50 |loss: 0.145244| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 6, train time 9.76 s
Epoch 15/50 |loss: 0.139274| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 7, train time 10.11 s
Epoch 16/50 |loss: 0.135952| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8, train time 9.49 s
Epoch 17/50 |loss: 0.137014| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9, train time 9.59 s
Epoch 18/50 |loss: 0.136911| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 10, train time 9.50 s
Epoch 19/50 |loss: 0.135121| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 1, train time 9.31 s
Epoch 20/50 |loss: 0.135420| train set 5.352x speedup, test set 5.226x speedup, val set 5.517x speedup, step: 2, train time 9.18 s
Epoch 21/50 |loss: 0.132501| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 9.69 s
Epoch 22/50 |loss: 0.134745| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 8.69 s
Epoch 23/50 |loss: 0.134665| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5, train time 9.08 s
Epoch 24/50 |loss: 0.130493| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 6, train time 9.39 s
Epoch 25/50 |loss: 0.132445| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 7, train time 9.18 s
Epoch 26/50 |loss: 0.129886| train set 5.387x speedup, test set 5.262x speedup, val set 5.552x speedup, step: 8, train time 9.19 s
Epoch 27/50 |loss: 0.132066| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9, train time 9.07 s
Epoch 28/50 |loss: 0.130717| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 10, train time 9.09 s
Epoch 29/50 |loss: 0.131602| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 11, train time 9.38 s
Epoch 30/50 |loss: 0.128494| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 12, train time 9.02 s
Epoch 31/50 |loss: 0.129420| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13, train time 9.40 s
Epoch 32/50 |loss: 0.129135| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 9.22 s
Epoch 33/50 |loss: 0.128768| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 15, train time 9.18 s
Epoch 34/50 |loss: 0.129186| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16, train time 9.21 s
Epoch 35/50 |loss: 0.126806| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17, train time 9.21 s
Epoch 36/50 |loss: 0.128285| train set 5.368x speedup, test set 5.225x speedup, val set 5.548x speedup, step: 18, train time 8.82 s
Epoch 37/50 |loss: 0.125181| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 9.91 s
Epoch 38/50 |loss: 0.128018| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20, train time 9.28 s
Epoch 39/50 |loss: 0.128553| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 21, train time 9.18 s
Epoch 40/50 |loss: 0.124382| train set 5.389x speedup, test set 5.257x speedup, val set 5.531x speedup, step: 22, train time 9.08 s
Epoch 41/50 |loss: 0.125318| train set 5.383x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 23, train time 9.48 s
Epoch 42/50 |loss: 0.124716| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24, train time 8.88 s
Epoch 43/50 |loss: 0.124561| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25, train time 9.38 s
Epoch 44/50 |loss: 0.124638| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 26, train time 9.41 s
Epoch 45/50 |loss: 0.124058| train set 5.348x speedup, test set 5.225x speedup, val set 5.533x speedup, step: 27, train time 9.31 s
Epoch 46/50 |loss: 0.123098| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28, train time 9.32 s
Epoch 47/50 |loss: 0.122821| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 29, train time 9.18 s
Epoch 48/50 |loss: 0.123417| train set 5.348x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 30, train time 7.98 s
Epoch 49/50 |loss: 0.121999| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31, train time 7.59 s
Training per epoch cost 9.344 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.197s, pg runtime 7.799s, speedup 1.084x
28, opt runtime 7.063s, model runtime 7.159s, pg runtime 7.063s, speedup 0.987x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 10, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 26, train speedup 5.387, test speedup 5.262, val speedup 5.552
best validation speedup epoch: 19, train speedup 5.387, test speedup 5.261, val speedup 5.550
last model at epoch 49, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:08:13.524708
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.532033, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.399549| train set 4.879x speedup, test set 4.770x speedup, val set 4.899x speedup, step: 1, train time 8.41 s
Epoch 1/50 |loss: 0.242584| train set 5.320x speedup, test set 5.186x speedup, val set 5.472x speedup, step: 2, train time 7.11 s
Epoch 2/50 |loss: 0.207805| train set 5.320x speedup, test set 5.186x speedup, val set 5.472x speedup, step: 3, train time 7.42 s
Epoch 3/50 |loss: 0.189739| train set 5.210x speedup, test set 5.035x speedup, val set 5.269x speedup, step: 4, train time 7.21 s
Epoch 4/50 |loss: 0.175265| train set 5.138x speedup, test set 5.067x speedup, val set 5.278x speedup, step: 1, train time 7.19 s
Epoch 5/50 |loss: 0.169058| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 7.20 s
Epoch 6/50 |loss: 0.163826| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3, train time 7.21 s
Epoch 7/50 |loss: 0.160432| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 4, train time 7.22 s
Epoch 8/50 |loss: 0.153077| train set 5.316x speedup, test set 5.192x speedup, val set 5.449x speedup, step: 5, train time 7.20 s
Epoch 9/50 |loss: 0.152591| train set 5.318x speedup, test set 5.191x speedup, val set 5.472x speedup, step: 1, train time 7.11 s
Epoch 10/50 |loss: 0.153341| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 7.11 s
Epoch 11/50 |loss: 0.147896| train set 5.287x speedup, test set 5.133x speedup, val set 5.438x speedup, step: 3, train time 7.02 s
Epoch 12/50 |loss: 0.142837| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 4, train time 7.29 s
Epoch 13/50 |loss: 0.139166| train set 5.316x speedup, test set 5.172x speedup, val set 5.589x speedup, step: 5, train time 7.23 s
Epoch 14/50 |loss: 0.144224| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1, train time 7.31 s
Epoch 15/50 |loss: 0.137519| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 2, train time 7.22 s
Epoch 16/50 |loss: 0.135888| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 3, train time 7.22 s
Epoch 17/50 |loss: 0.137991| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.21 s
Epoch 18/50 |loss: 0.134293| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 5, train time 7.32 s
Epoch 19/50 |loss: 0.136453| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 1, train time 7.23 s
Epoch 20/50 |loss: 0.134397| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2, train time 7.20 s
Epoch 21/50 |loss: 0.131578| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.50 s
Epoch 22/50 |loss: 0.132670| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.31 s
Epoch 23/50 |loss: 0.134077| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5, train time 7.30 s
Epoch 24/50 |loss: 0.130520| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 6, train time 7.41 s
Epoch 25/50 |loss: 0.131940| train set 5.383x speedup, test set 5.224x speedup, val set 5.547x speedup, step: 7, train time 7.31 s
Epoch 26/50 |loss: 0.130110| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 8, train time 7.21 s
Epoch 27/50 |loss: 0.130961| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9, train time 7.32 s
Epoch 28/50 |loss: 0.129612| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 10, train time 7.41 s
Epoch 29/50 |loss: 0.132429| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 11, train time 7.22 s
Epoch 30/50 |loss: 0.128208| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12, train time 7.19 s
Epoch 31/50 |loss: 0.128909| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 13, train time 7.30 s
Epoch 32/50 |loss: 0.127674| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 7.29 s
Epoch 33/50 |loss: 0.128125| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 15, train time 7.31 s
Epoch 34/50 |loss: 0.128490| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16, train time 7.30 s
Epoch 35/50 |loss: 0.126463| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17, train time 7.41 s
Epoch 36/50 |loss: 0.126896| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 18, train time 7.31 s
Epoch 37/50 |loss: 0.124579| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 7.29 s
Epoch 38/50 |loss: 0.126854| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20, train time 7.29 s
Epoch 39/50 |loss: 0.126793| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21, train time 7.10 s
Epoch 40/50 |loss: 0.123627| train set 5.389x speedup, test set 5.257x speedup, val set 5.531x speedup, step: 22, train time 7.41 s
Epoch 41/50 |loss: 0.124212| train set 5.385x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 23, train time 7.32 s
Epoch 42/50 |loss: 0.123358| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 24, train time 7.21 s
Epoch 43/50 |loss: 0.125242| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25, train time 7.30 s
Epoch 44/50 |loss: 0.124325| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26, train time 7.32 s
Epoch 45/50 |loss: 0.123590| train set 5.385x speedup, test set 5.258x speedup, val set 5.544x speedup, step: 27, train time 7.38 s
Epoch 46/50 |loss: 0.121543| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28, train time 7.31 s
Epoch 47/50 |loss: 0.121508| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 29, train time 7.10 s
Epoch 48/50 |loss: 0.122288| train set 5.348x speedup, test set 5.225x speedup, val set 5.533x speedup, step: 30, train time 7.22 s
Epoch 49/50 |loss: 0.122791| train set 5.385x speedup, test set 5.258x speedup, val set 5.544x speedup, step: 31, train time 7.31 s
Training per epoch cost 7.286 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 5, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 16, train speedup 5.387, test speedup 5.261, val speedup 5.550
best validation speedup epoch: 19, train speedup 5.316, test speedup 5.171, val speedup 5.588
last model at epoch 49, train speedup 5.385, test speedup 5.258, val speedup 5.544
execution cost 0:06:29.154041
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.527972, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.403564| train set 4.647x speedup, test set 4.538x speedup, val set 4.729x speedup, step: 1, train time 8.63 s
Epoch 1/50 |loss: 0.243841| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 2, train time 7.40 s
Epoch 2/50 |loss: 0.205933| train set 5.037x speedup, test set 4.857x speedup, val set 5.101x speedup, step: 3, train time 7.29 s
Epoch 3/50 |loss: 0.187256| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 4, train time 7.21 s
Epoch 4/50 |loss: 0.175495| train set 5.138x speedup, test set 5.068x speedup, val set 5.275x speedup, step: 1, train time 7.32 s
Epoch 5/50 |loss: 0.167383| train set 5.320x speedup, test set 5.187x speedup, val set 5.469x speedup, step: 2, train time 7.48 s
Epoch 6/50 |loss: 0.163816| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3, train time 7.30 s
Epoch 7/50 |loss: 0.158106| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 4, train time 7.22 s
Epoch 8/50 |loss: 0.153904| train set 5.320x speedup, test set 5.187x speedup, val set 5.473x speedup, step: 5, train time 7.30 s
Epoch 9/50 |loss: 0.150149| train set 5.318x speedup, test set 5.191x speedup, val set 5.472x speedup, step: 1, train time 7.41 s
Epoch 10/50 |loss: 0.151689| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 7.41 s
Epoch 11/50 |loss: 0.148867| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.29 s
Epoch 12/50 |loss: 0.143567| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 4, train time 7.43 s
Epoch 13/50 |loss: 0.140035| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 5, train time 7.41 s
Epoch 14/50 |loss: 0.143994| train set 5.384x speedup, test set 5.250x speedup, val set 5.546x speedup, step: 1, train time 7.39 s
Epoch 15/50 |loss: 0.139749| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 2, train time 7.21 s
Epoch 16/50 |loss: 0.136417| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.20 s
Epoch 17/50 |loss: 0.138453| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.29 s
Epoch 18/50 |loss: 0.136111| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 5, train time 7.31 s
Epoch 19/50 |loss: 0.136642| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 1, train time 7.41 s
Epoch 20/50 |loss: 0.134516| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2, train time 7.40 s
Epoch 21/50 |loss: 0.131191| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.50 s
Epoch 22/50 |loss: 0.134213| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.02 s
Epoch 23/50 |loss: 0.134549| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5, train time 7.29 s
Epoch 24/50 |loss: 0.130810| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 6, train time 7.31 s
Epoch 25/50 |loss: 0.132644| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 7, train time 7.32 s
Epoch 26/50 |loss: 0.129426| train set 5.389x speedup, test set 5.259x speedup, val set 5.530x speedup, step: 8, train time 7.28 s
Epoch 27/50 |loss: 0.132602| train set 5.287x speedup, test set 5.133x speedup, val set 5.438x speedup, step: 9, train time 7.42 s
Epoch 28/50 |loss: 0.130190| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10, train time 7.38 s
Epoch 29/50 |loss: 0.131608| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 11, train time 7.52 s
Epoch 30/50 |loss: 0.127633| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 12, train time 7.30 s
Epoch 31/50 |loss: 0.128751| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 13, train time 7.31 s
Epoch 32/50 |loss: 0.128948| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 7.41 s
Epoch 33/50 |loss: 0.128864| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 15, train time 7.31 s
Epoch 34/50 |loss: 0.128047| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16, train time 7.52 s
Epoch 35/50 |loss: 0.125255| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17, train time 7.30 s
Epoch 36/50 |loss: 0.126943| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 18, train time 7.19 s
Epoch 37/50 |loss: 0.125514| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 7.51 s
Epoch 38/50 |loss: 0.127365| train set 5.385x speedup, test set 5.258x speedup, val set 5.544x speedup, step: 20, train time 7.40 s
Epoch 39/50 |loss: 0.126435| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 21, train time 7.41 s
Epoch 40/50 |loss: 0.124198| train set 5.389x speedup, test set 5.257x speedup, val set 5.531x speedup, step: 22, train time 7.32 s
Epoch 41/50 |loss: 0.125149| train set 5.386x speedup, test set 5.250x speedup, val set 5.547x speedup, step: 23, train time 7.21 s
Epoch 42/50 |loss: 0.124207| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24, train time 7.41 s
Epoch 43/50 |loss: 0.125436| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25, train time 7.41 s
Epoch 44/50 |loss: 0.125449| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26, train time 7.49 s
early stopping at epoch 44
Training per epoch cost 7.374 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 10, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 26, train speedup 5.389, test speedup 5.259, val speedup 5.530
best validation speedup epoch: 19, train speedup 5.316, test speedup 5.171, val speedup 5.588
last model at epoch 44, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:05:54.445743
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.522757, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.400434| train set 4.986x speedup, test set 4.821x speedup, val set 4.979x speedup, step: 1, train time 8.41 s
Epoch 1/50 |loss: 0.239184| train set 5.291x speedup, test set 5.161x speedup, val set 5.440x speedup, step: 2, train time 7.42 s
Epoch 2/50 |loss: 0.209383| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 3, train time 7.32 s
Epoch 3/50 |loss: 0.186597| train set 5.352x speedup, test set 5.224x speedup, val set 5.540x speedup, step: 4, train time 7.50 s
Epoch 4/50 |loss: 0.176693| train set 5.049x speedup, test set 4.925x speedup, val set 5.239x speedup, step: 1, train time 7.33 s
Epoch 5/50 |loss: 0.169225| train set 5.248x speedup, test set 5.103x speedup, val set 5.511x speedup, step: 2, train time 7.22 s
Epoch 6/50 |loss: 0.165579| train set 5.352x speedup, test set 5.224x speedup, val set 5.540x speedup, step: 3, train time 7.30 s
Epoch 7/50 |loss: 0.158247| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.30 s
Epoch 8/50 |loss: 0.151984| train set 5.316x speedup, test set 5.189x speedup, val set 5.466x speedup, step: 5, train time 7.41 s
Epoch 9/50 |loss: 0.150736| train set 5.318x speedup, test set 5.193x speedup, val set 5.473x speedup, step: 1, train time 7.41 s
Epoch 10/50 |loss: 0.151252| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 7.30 s
Epoch 11/50 |loss: 0.147317| train set 5.287x speedup, test set 5.133x speedup, val set 5.438x speedup, step: 3, train time 7.40 s
Epoch 12/50 |loss: 0.142679| train set 5.215x speedup, test set 5.077x speedup, val set 5.446x speedup, step: 4, train time 7.40 s
Epoch 13/50 |loss: 0.138608| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 5, train time 7.32 s
Epoch 14/50 |loss: 0.143938| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 1, train time 7.41 s
Epoch 15/50 |loss: 0.138302| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 2, train time 7.50 s
Epoch 16/50 |loss: 0.134382| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.42 s
Epoch 17/50 |loss: 0.136786| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.31 s
Epoch 18/50 |loss: 0.135541| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 5, train time 7.39 s
Epoch 19/50 |loss: 0.135271| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 1, train time 7.51 s
Epoch 20/50 |loss: 0.134197| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2, train time 7.30 s
Epoch 21/50 |loss: 0.132320| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.41 s
Epoch 22/50 |loss: 0.132695| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.40 s
Epoch 23/50 |loss: 0.133249| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5, train time 7.32 s
Epoch 24/50 |loss: 0.130573| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 6, train time 7.41 s
Epoch 25/50 |loss: 0.131261| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 7, train time 7.42 s
Epoch 26/50 |loss: 0.129735| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 8, train time 7.49 s
Epoch 27/50 |loss: 0.129646| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9, train time 7.32 s
Epoch 28/50 |loss: 0.129183| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10, train time 7.22 s
Epoch 29/50 |loss: 0.131295| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 11, train time 7.31 s
Epoch 30/50 |loss: 0.127305| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12, train time 7.61 s
Epoch 31/50 |loss: 0.128318| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13, train time 7.42 s
Epoch 32/50 |loss: 0.127517| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 7.49 s
Epoch 33/50 |loss: 0.127216| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 15, train time 7.40 s
Epoch 34/50 |loss: 0.127084| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 16, train time 7.40 s
Epoch 35/50 |loss: 0.126445| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17, train time 7.29 s
Epoch 36/50 |loss: 0.126992| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 18, train time 7.43 s
Epoch 37/50 |loss: 0.125081| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 7.41 s
Epoch 38/50 |loss: 0.126325| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20, train time 7.32 s
Epoch 39/50 |loss: 0.126485| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21, train time 7.51 s
Epoch 40/50 |loss: 0.122627| train set 5.389x speedup, test set 5.257x speedup, val set 5.531x speedup, step: 22, train time 7.50 s
Epoch 41/50 |loss: 0.124004| train set 5.383x speedup, test set 5.263x speedup, val set 5.549x speedup, step: 23, train time 7.42 s
Epoch 42/50 |loss: 0.124309| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24, train time 7.19 s
Epoch 43/50 |loss: 0.124744| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25, train time 7.51 s
Epoch 44/50 |loss: 0.125646| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 26, train time 7.61 s
Epoch 45/50 |loss: 0.124476| train set 5.348x speedup, test set 5.225x speedup, val set 5.533x speedup, step: 27, train time 7.58 s
Epoch 46/50 |loss: 0.121969| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28, train time 7.42 s
Epoch 47/50 |loss: 0.122169| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 29, train time 7.70 s
Epoch 48/50 |loss: 0.122354| train set 5.348x speedup, test set 5.225x speedup, val set 5.533x speedup, step: 30, train time 7.59 s
Epoch 49/50 |loss: 0.121658| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31, train time 7.52 s
Training per epoch cost 7.430 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.197s, pg runtime 7.799s, speedup 1.084x
28, opt runtime 7.063s, model runtime 7.159s, pg runtime 7.063s, speedup 0.987x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 7, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 41, train speedup 5.383, test speedup 5.263, val speedup 5.549
best validation speedup epoch: 19, train speedup 5.387, test speedup 5.261, val speedup 5.550
last model at epoch 49, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:06:36.376775
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.518795, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.405437| train set 3.602x speedup, test set 3.420x speedup, val set 3.480x speedup, step: 1, train time 8.55 s
Epoch 1/50 |loss: 0.241713| train set 5.278x speedup, test set 5.171x speedup, val set 5.451x speedup, step: 2, train time 7.38 s
Epoch 2/50 |loss: 0.208450| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 3, train time 7.40 s
Epoch 3/50 |loss: 0.186700| train set 5.352x speedup, test set 5.224x speedup, val set 5.540x speedup, step: 4, train time 7.51 s
Epoch 4/50 |loss: 0.176442| train set 5.049x speedup, test set 4.925x speedup, val set 5.239x speedup, step: 1, train time 7.52 s
Epoch 5/50 |loss: 0.167783| train set 5.320x speedup, test set 5.187x speedup, val set 5.469x speedup, step: 2, train time 7.40 s
Epoch 6/50 |loss: 0.163131| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 3, train time 7.49 s
Epoch 7/50 |loss: 0.159501| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.41 s
Epoch 8/50 |loss: 0.150307| train set 5.316x speedup, test set 5.192x speedup, val set 5.449x speedup, step: 5, train time 7.42 s
Epoch 9/50 |loss: 0.152406| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1, train time 7.51 s
Epoch 10/50 |loss: 0.151304| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 7.39 s
Epoch 11/50 |loss: 0.149838| train set 5.388x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 3, train time 7.52 s
Epoch 12/50 |loss: 0.143003| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.49 s
Epoch 13/50 |loss: 0.140382| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 5, train time 7.32 s
Epoch 14/50 |loss: 0.145040| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 6, train time 7.53 s
Epoch 15/50 |loss: 0.139625| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 7, train time 7.42 s
Epoch 16/50 |loss: 0.136178| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8, train time 7.52 s
Epoch 17/50 |loss: 0.137757| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9, train time 7.40 s
Epoch 18/50 |loss: 0.136443| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 10, train time 7.50 s
Epoch 19/50 |loss: 0.135841| train set 5.314x speedup, test set 5.175x speedup, val set 5.591x speedup, step: 1, train time 7.49 s
Epoch 20/50 |loss: 0.134659| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2, train time 7.59 s
Epoch 21/50 |loss: 0.132569| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.68 s
Epoch 22/50 |loss: 0.134252| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.42 s
Epoch 23/50 |loss: 0.133981| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5, train time 7.49 s
Epoch 24/50 |loss: 0.130800| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 6, train time 7.68 s
Epoch 25/50 |loss: 0.131717| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7, train time 7.51 s
Epoch 26/50 |loss: 0.130017| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 8, train time 7.52 s
Epoch 27/50 |loss: 0.131510| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9, train time 7.41 s
Epoch 28/50 |loss: 0.129425| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 10, train time 7.59 s
Epoch 29/50 |loss: 0.131108| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 11, train time 7.59 s
Epoch 30/50 |loss: 0.127860| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 12, train time 7.42 s
Epoch 31/50 |loss: 0.129778| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13, train time 7.61 s
Epoch 32/50 |loss: 0.129836| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 7.52 s
Epoch 33/50 |loss: 0.129246| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 15, train time 7.59 s
Epoch 34/50 |loss: 0.128270| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16, train time 7.32 s
Epoch 35/50 |loss: 0.127591| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17, train time 7.39 s
Epoch 36/50 |loss: 0.129190| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 18, train time 7.52 s
Epoch 37/50 |loss: 0.125768| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 7.51 s
Epoch 38/50 |loss: 0.127720| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20, train time 7.42 s
Epoch 39/50 |loss: 0.127958| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 21, train time 7.61 s
Epoch 40/50 |loss: 0.123699| train set 5.389x speedup, test set 5.257x speedup, val set 5.531x speedup, step: 22, train time 7.43 s
Epoch 41/50 |loss: 0.125328| train set 5.383x speedup, test set 5.262x speedup, val set 5.551x speedup, step: 23, train time 7.61 s
Epoch 42/50 |loss: 0.123486| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 24, train time 7.58 s
Epoch 43/50 |loss: 0.124517| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 25, train time 7.60 s
Epoch 44/50 |loss: 0.124979| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 26, train time 7.52 s
Epoch 45/50 |loss: 0.125254| train set 5.386x speedup, test set 5.258x speedup, val set 5.544x speedup, step: 27, train time 7.62 s
Epoch 46/50 |loss: 0.123501| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28, train time 7.52 s
Epoch 47/50 |loss: 0.124447| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 29, train time 7.50 s
Epoch 48/50 |loss: 0.123821| train set 5.348x speedup, test set 5.225x speedup, val set 5.533x speedup, step: 30, train time 7.41 s
Epoch 49/50 |loss: 0.123627| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31, train time 7.59 s
Training per epoch cost 7.519 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.197s, pg runtime 7.799s, speedup 1.084x
28, opt runtime 7.063s, model runtime 7.159s, pg runtime 7.063s, speedup 0.987x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 7, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 41, train speedup 5.383, test speedup 5.262, val speedup 5.551
best validation speedup epoch: 19, train speedup 5.314, test speedup 5.175, val speedup 5.591
last model at epoch 49, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:06:41.269735
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.527233, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.404877| train set 4.986x speedup, test set 4.821x speedup, val set 4.979x speedup, step: 1, train time 8.45 s
Epoch 1/50 |loss: 0.239430| train set 5.295x speedup, test set 5.184x speedup, val set 5.438x speedup, step: 2, train time 7.22 s
Epoch 2/50 |loss: 0.207419| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 3, train time 7.51 s
Epoch 3/50 |loss: 0.188629| train set 5.138x speedup, test set 5.068x speedup, val set 5.275x speedup, step: 4, train time 7.32 s
Epoch 4/50 |loss: 0.175044| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 1, train time 7.51 s
Epoch 5/50 |loss: 0.166563| train set 5.248x speedup, test set 5.104x speedup, val set 5.509x speedup, step: 2, train time 7.38 s
Epoch 6/50 |loss: 0.163832| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 3, train time 7.51 s
Epoch 7/50 |loss: 0.161539| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.50 s
Epoch 8/50 |loss: 0.152115| train set 5.320x speedup, test set 5.188x speedup, val set 5.470x speedup, step: 5, train time 7.50 s
Epoch 9/50 |loss: 0.150731| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 1, train time 7.42 s
Epoch 10/50 |loss: 0.152754| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 7.38 s
Epoch 11/50 |loss: 0.149011| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.40 s
Epoch 12/50 |loss: 0.141371| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 4, train time 7.50 s
Epoch 13/50 |loss: 0.140544| train set 5.320x speedup, test set 5.187x speedup, val set 5.469x speedup, step: 5, train time 7.58 s
Epoch 14/50 |loss: 0.145039| train set 5.204x speedup, test set 5.062x speedup, val set 5.364x speedup, step: 6, train time 7.50 s
Epoch 15/50 |loss: 0.139121| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 7, train time 7.42 s
Epoch 16/50 |loss: 0.136465| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 8, train time 7.49 s
Epoch 17/50 |loss: 0.137888| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 9, train time 7.40 s
Epoch 18/50 |loss: 0.135621| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 10, train time 7.49 s
Epoch 19/50 |loss: 0.136854| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 1, train time 7.60 s
Epoch 20/50 |loss: 0.133829| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2, train time 7.30 s
Epoch 21/50 |loss: 0.132387| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.72 s
Epoch 22/50 |loss: 0.133001| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.60 s
Epoch 23/50 |loss: 0.134005| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5, train time 7.60 s
Epoch 24/50 |loss: 0.130755| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 6, train time 7.62 s
Epoch 25/50 |loss: 0.132221| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 7, train time 7.50 s
Epoch 26/50 |loss: 0.129832| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8, train time 7.61 s
Epoch 27/50 |loss: 0.131940| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9, train time 7.50 s
Epoch 28/50 |loss: 0.129158| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10, train time 7.60 s
Epoch 29/50 |loss: 0.131464| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 11, train time 7.49 s
Epoch 30/50 |loss: 0.127120| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 12, train time 7.50 s
Epoch 31/50 |loss: 0.128371| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 13, train time 7.51 s
Epoch 32/50 |loss: 0.127748| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 7.58 s
Epoch 33/50 |loss: 0.127189| train set 5.389x speedup, test set 5.258x speedup, val set 5.528x speedup, step: 15, train time 7.71 s
Epoch 34/50 |loss: 0.127887| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 16, train time 7.40 s
Epoch 35/50 |loss: 0.126017| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17, train time 7.51 s
Epoch 36/50 |loss: 0.127209| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 18, train time 7.60 s
Epoch 37/50 |loss: 0.124955| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 7.51 s
Epoch 38/50 |loss: 0.127210| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20, train time 7.47 s
Epoch 39/50 |loss: 0.126743| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21, train time 7.52 s
Epoch 40/50 |loss: 0.123334| train set 5.389x speedup, test set 5.257x speedup, val set 5.531x speedup, step: 22, train time 7.42 s
Epoch 41/50 |loss: 0.125193| train set 5.385x speedup, test set 5.258x speedup, val set 5.544x speedup, step: 23, train time 7.41 s
Epoch 42/50 |loss: 0.124079| train set 5.387x speedup, test set 5.261x speedup, val set 5.550x speedup, step: 24, train time 7.52 s
Epoch 43/50 |loss: 0.124482| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 25, train time 7.49 s
Epoch 44/50 |loss: 0.124916| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 26, train time 7.51 s
Epoch 45/50 |loss: 0.124049| train set 5.385x speedup, test set 5.258x speedup, val set 5.544x speedup, step: 27, train time 7.51 s
Epoch 46/50 |loss: 0.121680| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 28, train time 7.42 s
Epoch 47/50 |loss: 0.122961| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 29, train time 7.37 s
Epoch 48/50 |loss: 0.122096| train set 5.352x speedup, test set 5.223x speedup, val set 5.539x speedup, step: 30, train time 7.61 s
Epoch 49/50 |loss: 0.122081| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 31, train time 7.51 s
Training per epoch cost 7.515 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.197s, pg runtime 7.799s, speedup 1.084x
28, opt runtime 7.063s, model runtime 7.159s, pg runtime 7.063s, speedup 0.987x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 7, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 2, train speedup 5.387, test speedup 5.261, val speedup 5.550
best validation speedup epoch: 19, train speedup 5.387, test speedup 5.261, val speedup 5.550
last model at epoch 49, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:06:41.593845
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[2, 3, 4, 6, 7, 9] [1, 0] [8 5]
[0, 1, 2, 5, 7, 9] [4, 3] [6 8]
[0, 1, 5, 6, 7, 8] [3, 2] [4 9]
[0, 2, 3, 4, 6, 7, 9] [1, 8] [5 5]
[0, 3, 4, 5, 7, 9] [1, 6] [8 2]
[1, 2, 4, 5, 6, 8] [0, 9] [3 7]
[0, 2, 5, 6, 7, 8, 9] [1, 3] [4 4]
[0, 1, 2, 4, 6, 7] [3, 8] [9 5]
[1, 2, 3, 5, 6, 7] [9, 0] [4 8]
[0, 1, 4, 5, 6, 7] [8, 3] [9 2]
[0, 1, 2, 3, 7, 9] [8, 6] [5 4]
[0, 2, 4, 5, 6, 8] [3, 7] [1 9]
[0, 1, 2, 5, 7, 8] [9, 4] [3 6]
[1, 4, 5, 6, 8, 9] [0, 2] [7 3]
[0, 1, 2, 4, 7, 8] [6, 5] [9 3]
[1, 3, 5, 7, 8, 9] [4, 2] [6 0]
[0, 2, 6, 7, 8, 9] [3, 5] [4 1]
[0, 2, 3, 4, 7, 8] [1, 9] [6 5]
[2, 3, 5, 7, 8, 9] [6, 1] [4 0]
[1, 3, 4, 6, 7, 8] [5, 9] [0 2]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.555411, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.405453| train set 4.552x speedup, test set 4.379x speedup, val set 4.480x speedup, step: 1, train time 8.71 s
Epoch 1/50 |loss: 0.245367| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 2, train time 7.28 s
Epoch 2/50 |loss: 0.210526| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 3, train time 7.48 s
Epoch 3/50 |loss: 0.191997| train set 5.138x speedup, test set 5.069x speedup, val set 5.276x speedup, step: 4, train time 7.30 s
Epoch 4/50 |loss: 0.178370| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 1, train time 7.39 s
Epoch 5/50 |loss: 0.171114| train set 5.248x speedup, test set 5.104x speedup, val set 5.509x speedup, step: 2, train time 7.31 s
Epoch 6/50 |loss: 0.165397| train set 5.352x speedup, test set 5.225x speedup, val set 5.538x speedup, step: 3, train time 7.50 s
Epoch 7/50 |loss: 0.159559| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.40 s
Epoch 8/50 |loss: 0.153515| train set 5.320x speedup, test set 5.187x speedup, val set 5.469x speedup, step: 5, train time 7.32 s
Epoch 9/50 |loss: 0.153760| train set 5.318x speedup, test set 5.191x speedup, val set 5.472x speedup, step: 6, train time 7.41 s
Epoch 10/50 |loss: 0.152576| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 7, train time 7.50 s
Epoch 11/50 |loss: 0.149052| train set 5.323x speedup, test set 5.163x speedup, val set 5.451x speedup, step: 8, train time 7.42 s
Epoch 12/50 |loss: 0.142879| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 9, train time 7.40 s
Epoch 13/50 |loss: 0.141710| train set 5.280x speedup, test set 5.141x speedup, val set 5.578x speedup, step: 10, train time 7.51 s
Epoch 14/50 |loss: 0.144543| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 1, train time 7.51 s
Epoch 15/50 |loss: 0.140480| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 2, train time 7.59 s
Epoch 16/50 |loss: 0.135649| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.61 s
Epoch 17/50 |loss: 0.138033| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.52 s
Epoch 18/50 |loss: 0.137125| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 5, train time 7.50 s
Epoch 19/50 |loss: 0.136760| train set 5.316x speedup, test set 5.171x speedup, val set 5.588x speedup, step: 1, train time 7.52 s
Epoch 20/50 |loss: 0.134430| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 2, train time 7.42 s
Epoch 21/50 |loss: 0.131856| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 3, train time 7.71 s
Epoch 22/50 |loss: 0.134579| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 4, train time 7.58 s
Epoch 23/50 |loss: 0.134038| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 5, train time 7.52 s
Epoch 24/50 |loss: 0.130546| train set 5.389x speedup, test set 5.258x speedup, val set 5.548x speedup, step: 6, train time 7.50 s
Epoch 25/50 |loss: 0.132847| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 7, train time 7.30 s
Epoch 26/50 |loss: 0.131218| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 8, train time 7.62 s
Epoch 27/50 |loss: 0.131928| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 9, train time 7.49 s
Epoch 28/50 |loss: 0.130650| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 10, train time 7.49 s
Epoch 29/50 |loss: 0.131773| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 11, train time 7.60 s
Epoch 30/50 |loss: 0.128123| train set 5.389x speedup, test set 5.255x speedup, val set 5.550x speedup, step: 12, train time 7.52 s
Epoch 31/50 |loss: 0.127922| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 13, train time 7.61 s
Epoch 32/50 |loss: 0.130217| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 14, train time 7.58 s
Epoch 33/50 |loss: 0.129244| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 15, train time 7.60 s
Epoch 34/50 |loss: 0.128611| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 16, train time 7.63 s
Epoch 35/50 |loss: 0.128131| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 17, train time 7.42 s
Epoch 36/50 |loss: 0.128136| train set 5.352x speedup, test set 5.224x speedup, val set 5.536x speedup, step: 18, train time 7.60 s
Epoch 37/50 |loss: 0.125747| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 19, train time 7.47 s
Epoch 38/50 |loss: 0.128574| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 20, train time 7.50 s
Epoch 39/50 |loss: 0.128550| train set 5.389x speedup, test set 5.256x speedup, val set 5.547x speedup, step: 21, train time 7.63 s
early stopping at epoch 39
Training per epoch cost 7.524 s
Optimal speedup on test set is 5.356x
01, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
02, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
03, opt runtime 29.269s, model runtime 29.269s, pg runtime 91.296s, speedup 3.119x
04, opt runtime 29.286s, model runtime 29.286s, pg runtime 92.131s, speedup 3.146x
05, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
06, opt runtime 17.779s, model runtime 17.779s, pg runtime 17.779s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.913s, model runtime 9.037s, pg runtime 15.548s, speedup 1.720x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 21.913s, model runtime 21.913s, pg runtime 74.973s, speedup 3.421x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.590s, model runtime 3.590s, pg runtime 12.193s, speedup 3.396x
15, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
16, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
17, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.148s, model runtime 1.148s, pg runtime 1.214s, speedup 1.057x
20, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
21, opt runtime 18.267s, model runtime 21.055s, pg runtime 21.055s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.360s, model runtime 1.360s, pg runtime 1.360s, speedup 1.000x
26, opt runtime 1.265s, model runtime 1.265s, pg runtime 1.265s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
29, opt runtime 5.415s, model runtime 5.415s, pg runtime 5.415s, speedup 1.000x
30, opt runtime 5.175s, model runtime 5.175s, pg runtime 5.175s, speedup 1.000x
31, opt runtime 25.236s, model runtime 25.236s, pg runtime 601.756s, speedup 23.845x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
36, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
37, opt runtime 11.734s, model runtime 11.734s, pg runtime 11.734s, speedup 1.000x
38, opt runtime 15.302s, model runtime 15.302s, pg runtime 15.302s, speedup 1.000x
39, opt runtime 1.015s, model runtime 1.092s, pg runtime 1.092s, speedup 1.000x
40, opt runtime 1.084s, model runtime 1.155s, pg runtime 1.155s, speedup 1.000x
====================
best train speedup epoch: 1, train speedup 5.389, test speedup 5.256, val speedup 5.547
best test speedup epoch: 12, train speedup 5.389, test speedup 5.258, val speedup 5.548
best validation speedup epoch: 19, train speedup 5.316, test speedup 5.171, val speedup 5.588
last model at epoch 39, train speedup 5.389, test speedup 5.256, val speedup 5.547
execution cost 0:05:22.103086
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.793999, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397172| train set 5.201x speedup, test set 5.030x speedup, val set 4.934x speedup, step: 1, train time 8.63 s
Epoch 1/50 |loss: 0.246289| train set 5.320x speedup, test set 5.188x speedup, val set 5.077x speedup, step: 2, train time 7.09 s
Epoch 2/50 |loss: 0.212592| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.10 s
Epoch 3/50 |loss: 0.188316| train set 5.456x speedup, test set 5.358x speedup, val set 5.072x speedup, step: 4, train time 7.02 s
Epoch 4/50 |loss: 0.179690| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 1, train time 7.09 s
Epoch 5/50 |loss: 0.172026| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 2, train time 7.20 s
Epoch 6/50 |loss: 0.158236| train set 5.495x speedup, test set 5.409x speedup, val set 5.099x speedup, step: 3, train time 7.00 s
Epoch 7/50 |loss: 0.156360| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 4, train time 7.21 s
Epoch 8/50 |loss: 0.150581| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 5, train time 7.00 s
Epoch 9/50 |loss: 0.153921| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 6, train time 7.27 s
Epoch 10/50 |loss: 0.149402| train set 5.446x speedup, test set 5.320x speedup, val set 5.060x speedup, step: 7, train time 7.19 s
Epoch 11/50 |loss: 0.147721| train set 5.362x speedup, test set 5.165x speedup, val set 5.118x speedup, step: 8, train time 7.29 s
Epoch 12/50 |loss: 0.141327| train set 5.450x speedup, test set 5.310x speedup, val set 5.192x speedup, step: 9, train time 7.37 s
Epoch 13/50 |loss: 0.138655| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 10, train time 7.10 s
Epoch 14/50 |loss: 0.138374| train set 5.494x speedup, test set 5.409x speedup, val set 5.099x speedup, step: 11, train time 7.11 s
Epoch 15/50 |loss: 0.135805| train set 5.450x speedup, test set 5.314x speedup, val set 5.068x speedup, step: 12, train time 7.30 s
Epoch 16/50 |loss: 0.135984| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 13, train time 7.40 s
Epoch 17/50 |loss: 0.133560| train set 5.401x speedup, test set 5.223x speedup, val set 5.154x speedup, step: 14, train time 7.21 s
Epoch 18/50 |loss: 0.134430| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 15, train time 7.30 s
Epoch 19/50 |loss: 0.129787| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1, train time 7.19 s
Epoch 20/50 |loss: 0.137928| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 2, train time 7.21 s
Epoch 21/50 |loss: 0.132580| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 3, train time 7.30 s
Epoch 22/50 |loss: 0.132159| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4, train time 7.38 s
Epoch 23/50 |loss: 0.132404| train set 5.493x speedup, test set 5.401x speedup, val set 5.117x speedup, step: 5, train time 7.22 s
Epoch 24/50 |loss: 0.133168| train set 5.494x speedup, test set 5.408x speedup, val set 5.100x speedup, step: 6, train time 7.30 s
Epoch 25/50 |loss: 0.128749| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.29 s
Epoch 26/50 |loss: 0.130811| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8, train time 7.31 s
Epoch 27/50 |loss: 0.128946| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 9, train time 7.11 s
Epoch 28/50 |loss: 0.127347| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 10, train time 7.38 s
Epoch 29/50 |loss: 0.126389| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1, train time 7.21 s
Epoch 30/50 |loss: 0.128939| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 2, train time 7.28 s
Epoch 31/50 |loss: 0.126253| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 3, train time 7.18 s
Epoch 32/50 |loss: 0.123571| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 4, train time 7.20 s
Epoch 33/50 |loss: 0.125795| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5, train time 7.20 s
Epoch 34/50 |loss: 0.125478| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6, train time 7.27 s
Epoch 35/50 |loss: 0.125813| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.39 s
Epoch 36/50 |loss: 0.124860| train set 5.449x speedup, test set 5.309x speedup, val set 5.194x speedup, step: 8, train time 7.41 s
Epoch 37/50 |loss: 0.126771| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.20 s
Epoch 38/50 |loss: 0.125873| train set 5.404x speedup, test set 5.209x speedup, val set 5.157x speedup, step: 10, train time 7.41 s
Epoch 39/50 |loss: 0.122608| train set 5.402x speedup, test set 5.224x speedup, val set 5.154x speedup, step: 11, train time 7.19 s
Epoch 40/50 |loss: 0.123051| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 12, train time 7.19 s
Epoch 41/50 |loss: 0.122279| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13, train time 7.22 s
Epoch 42/50 |loss: 0.121958| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 14, train time 7.37 s
Epoch 43/50 |loss: 0.121967| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 15, train time 7.30 s
Epoch 44/50 |loss: 0.126430| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1, train time 7.38 s
Epoch 45/50 |loss: 0.121601| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 2, train time 7.29 s
Epoch 46/50 |loss: 0.125104| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 3, train time 7.40 s
Epoch 47/50 |loss: 0.122275| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 4, train time 7.21 s
Epoch 48/50 |loss: 0.119187| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5, train time 7.28 s
Epoch 49/50 |loss: 0.120629| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 6, train time 7.40 s
Training per epoch cost 7.271 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 20, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 44, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 49, train speedup 5.496, test speedup 5.420, val speedup 5.106
execution cost 0:06:30.866938
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.766364, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394572| train set 4.819x speedup, test set 4.592x speedup, val set 4.484x speedup, step: 1, train time 8.39 s
Epoch 1/50 |loss: 0.241551| train set 5.443x speedup, test set 5.304x speedup, val set 5.184x speedup, step: 2, train time 7.29 s
Epoch 2/50 |loss: 0.203621| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3, train time 7.27 s
Epoch 3/50 |loss: 0.186092| train set 5.455x speedup, test set 5.357x speedup, val set 5.073x speedup, step: 4, train time 7.10 s
Epoch 4/50 |loss: 0.176589| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1, train time 7.01 s
Epoch 5/50 |loss: 0.168745| train set 5.423x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 2, train time 7.11 s
Epoch 6/50 |loss: 0.158534| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.20 s
Epoch 7/50 |loss: 0.154930| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 4, train time 7.20 s
Epoch 8/50 |loss: 0.149986| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 5, train time 7.10 s
Epoch 9/50 |loss: 0.151472| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 6, train time 7.19 s
Epoch 10/50 |loss: 0.147823| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 7, train time 7.21 s
Epoch 11/50 |loss: 0.143446| train set 5.402x speedup, test set 5.224x speedup, val set 5.153x speedup, step: 8, train time 7.03 s
Epoch 12/50 |loss: 0.137623| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 9, train time 7.02 s
Epoch 13/50 |loss: 0.135398| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 10, train time 7.10 s
Epoch 14/50 |loss: 0.137411| train set 5.494x speedup, test set 5.409x speedup, val set 5.099x speedup, step: 11, train time 7.00 s
Epoch 15/50 |loss: 0.135239| train set 5.448x speedup, test set 5.331x speedup, val set 5.066x speedup, step: 12, train time 7.30 s
Epoch 16/50 |loss: 0.135443| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 13, train time 7.20 s
Epoch 17/50 |loss: 0.131242| train set 5.265x speedup, test set 5.081x speedup, val set 4.981x speedup, step: 14, train time 7.22 s
Epoch 18/50 |loss: 0.133433| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 15, train time 7.10 s
Epoch 19/50 |loss: 0.128252| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1, train time 7.01 s
Epoch 20/50 |loss: 0.136068| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 2, train time 7.19 s
Epoch 21/50 |loss: 0.131027| train set 5.290x speedup, test set 5.094x speedup, val set 4.977x speedup, step: 3, train time 7.29 s
Epoch 22/50 |loss: 0.132087| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 4, train time 7.30 s
Epoch 23/50 |loss: 0.129547| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 5, train time 7.13 s
Epoch 24/50 |loss: 0.132271| train set 5.494x speedup, test set 5.408x speedup, val set 5.100x speedup, step: 6, train time 7.02 s
Epoch 25/50 |loss: 0.127477| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.13 s
Epoch 26/50 |loss: 0.130211| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 8, train time 7.21 s
Epoch 27/50 |loss: 0.125867| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 9, train time 7.10 s
Epoch 28/50 |loss: 0.125357| train set 5.446x speedup, test set 5.291x speedup, val set 5.206x speedup, step: 10, train time 7.21 s
Epoch 29/50 |loss: 0.125830| train set 5.402x speedup, test set 5.224x speedup, val set 5.154x speedup, step: 1, train time 7.08 s
Epoch 30/50 |loss: 0.127806| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 2, train time 6.99 s
Epoch 31/50 |loss: 0.125339| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 3, train time 7.32 s
Epoch 32/50 |loss: 0.123945| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 4, train time 7.12 s
Epoch 33/50 |loss: 0.124117| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5, train time 7.30 s
Epoch 34/50 |loss: 0.124061| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6, train time 7.29 s
Epoch 35/50 |loss: 0.126014| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.32 s
Epoch 36/50 |loss: 0.124987| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 8, train time 7.20 s
Epoch 37/50 |loss: 0.126035| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.21 s
Epoch 38/50 |loss: 0.124383| train set 5.404x speedup, test set 5.207x speedup, val set 5.156x speedup, step: 10, train time 7.29 s
Epoch 39/50 |loss: 0.122202| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 11, train time 7.21 s
Epoch 40/50 |loss: 0.121412| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 12, train time 7.11 s
Epoch 41/50 |loss: 0.121201| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13, train time 7.08 s
Epoch 42/50 |loss: 0.120381| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 14, train time 7.27 s
Epoch 43/50 |loss: 0.120904| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 15, train time 7.10 s
Epoch 44/50 |loss: 0.125351| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16, train time 7.21 s
Epoch 45/50 |loss: 0.121564| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17, train time 7.28 s
Epoch 46/50 |loss: 0.124490| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 18, train time 7.22 s
Epoch 47/50 |loss: 0.120332| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19, train time 7.27 s
Epoch 48/50 |loss: 0.118878| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20, train time 7.27 s
Epoch 49/50 |loss: 0.120447| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21, train time 7.20 s
Training per epoch cost 7.200 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.309s, pg runtime 1.356s, speedup 1.036x
20, opt runtime 1.340s, model runtime 1.490s, pg runtime 1.340s, speedup 0.899x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 20, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 29, train speedup 5.402, test speedup 5.224, val speedup 5.154
last model at epoch 49, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:06:26.752042
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.753318, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394348| train set 4.819x speedup, test set 4.592x speedup, val set 4.484x speedup, step: 1, train time 8.33 s
Epoch 1/50 |loss: 0.240420| train set 5.425x speedup, test set 5.274x speedup, val set 5.191x speedup, step: 2, train time 7.39 s
Epoch 2/50 |loss: 0.207709| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.08 s
Epoch 3/50 |loss: 0.184772| train set 5.455x speedup, test set 5.357x speedup, val set 5.073x speedup, step: 4, train time 7.13 s
Epoch 4/50 |loss: 0.176338| train set 5.378x speedup, test set 5.240x speedup, val set 5.127x speedup, step: 1, train time 7.10 s
Epoch 5/50 |loss: 0.169520| train set 5.423x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 2, train time 7.19 s
Epoch 6/50 |loss: 0.161765| train set 5.449x speedup, test set 5.348x speedup, val set 5.071x speedup, step: 3, train time 6.92 s
Epoch 7/50 |loss: 0.155894| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 4, train time 7.30 s
Epoch 8/50 |loss: 0.151654| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 5, train time 7.20 s
Epoch 9/50 |loss: 0.153714| train set 5.448x speedup, test set 5.332x speedup, val set 5.068x speedup, step: 6, train time 7.13 s
Epoch 10/50 |loss: 0.150551| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 7, train time 7.19 s
Epoch 11/50 |loss: 0.146566| train set 5.401x speedup, test set 5.224x speedup, val set 5.155x speedup, step: 8, train time 7.11 s
Epoch 12/50 |loss: 0.139059| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.11 s
Epoch 13/50 |loss: 0.138224| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 10, train time 7.20 s
Epoch 14/50 |loss: 0.139154| train set 5.494x speedup, test set 5.409x speedup, val set 5.099x speedup, step: 11, train time 7.00 s
Epoch 15/50 |loss: 0.135776| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 12, train time 7.01 s
Epoch 16/50 |loss: 0.135154| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 13, train time 7.19 s
Epoch 17/50 |loss: 0.132765| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 14, train time 7.17 s
Epoch 18/50 |loss: 0.134935| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 15, train time 7.20 s
Epoch 19/50 |loss: 0.130995| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16, train time 7.10 s
Epoch 20/50 |loss: 0.135722| train set 5.336x speedup, test set 5.178x speedup, val set 5.016x speedup, step: 17, train time 7.10 s
Epoch 21/50 |loss: 0.131407| train set 5.246x speedup, test set 4.918x speedup, val set 4.928x speedup, step: 18, train time 7.10 s
Epoch 22/50 |loss: 0.131570| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19, train time 7.12 s
Epoch 23/50 |loss: 0.130567| train set 5.446x speedup, test set 5.291x speedup, val set 5.206x speedup, step: 20, train time 7.08 s
Epoch 24/50 |loss: 0.133023| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 21, train time 7.11 s
Epoch 25/50 |loss: 0.128667| train set 5.493x speedup, test set 5.413x speedup, val set 5.100x speedup, step: 22, train time 7.22 s
Epoch 26/50 |loss: 0.129871| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23, train time 7.20 s
Epoch 27/50 |loss: 0.129394| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 24, train time 7.22 s
Epoch 28/50 |loss: 0.126156| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 25, train time 7.29 s
Epoch 29/50 |loss: 0.127428| train set 5.402x speedup, test set 5.225x speedup, val set 5.153x speedup, step: 1, train time 7.07 s
Epoch 30/50 |loss: 0.128709| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 2, train time 7.29 s
Epoch 31/50 |loss: 0.126240| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 3, train time 7.13 s
Epoch 32/50 |loss: 0.124336| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 4, train time 7.10 s
Epoch 33/50 |loss: 0.125870| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5, train time 7.20 s
Epoch 34/50 |loss: 0.125637| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6, train time 7.38 s
Epoch 35/50 |loss: 0.127335| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.38 s
Epoch 36/50 |loss: 0.126871| train set 5.449x speedup, test set 5.309x speedup, val set 5.194x speedup, step: 8, train time 7.32 s
Epoch 37/50 |loss: 0.125613| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.31 s
Epoch 38/50 |loss: 0.125749| train set 5.452x speedup, test set 5.295x speedup, val set 5.196x speedup, step: 10, train time 7.57 s
Epoch 39/50 |loss: 0.123322| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 11, train time 7.47 s
Epoch 40/50 |loss: 0.123316| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 12, train time 7.30 s
Epoch 41/50 |loss: 0.122707| train set 5.494x speedup, test set 5.408x speedup, val set 5.100x speedup, step: 13, train time 7.10 s
Epoch 42/50 |loss: 0.121524| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 14, train time 7.21 s
Epoch 43/50 |loss: 0.121207| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 15, train time 7.40 s
Epoch 44/50 |loss: 0.124841| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16, train time 7.33 s
Epoch 45/50 |loss: 0.122729| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 17, train time 7.22 s
Epoch 46/50 |loss: 0.126098| train set 5.444x speedup, test set 5.324x speedup, val set 5.060x speedup, step: 18, train time 7.21 s
Epoch 47/50 |loss: 0.121221| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 19, train time 7.27 s
Epoch 48/50 |loss: 0.119843| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20, train time 7.18 s
Epoch 49/50 |loss: 0.120551| train set 5.496x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21, train time 7.30 s
Training per epoch cost 7.225 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 49, train speedup 5.496, test speedup 5.421, val speedup 5.106
best validation speedup epoch: 29, train speedup 5.402, test speedup 5.225, val speedup 5.153
last model at epoch 49, train speedup 5.496, test speedup 5.421, val speedup 5.106
execution cost 0:06:28.423293
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.759042, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.395132| train set 5.011x speedup, test set 4.837x speedup, val set 4.766x speedup, step: 1, train time 8.48 s
Epoch 1/50 |loss: 0.242590| train set 5.338x speedup, test set 5.181x speedup, val set 5.091x speedup, step: 2, train time 7.29 s
Epoch 2/50 |loss: 0.207230| train set 5.423x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.31 s
Epoch 3/50 |loss: 0.183513| train set 5.144x speedup, test set 5.033x speedup, val set 4.740x speedup, step: 4, train time 7.20 s
Epoch 4/50 |loss: 0.172895| train set 5.460x speedup, test set 5.375x speedup, val set 5.204x speedup, step: 1, train time 7.12 s
Epoch 5/50 |loss: 0.169369| train set 5.376x speedup, test set 5.261x speedup, val set 5.002x speedup, step: 2, train time 7.28 s
Epoch 6/50 |loss: 0.158759| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.11 s
Epoch 7/50 |loss: 0.156353| train set 5.403x speedup, test set 5.118x speedup, val set 5.140x speedup, step: 4, train time 7.18 s
Epoch 8/50 |loss: 0.150640| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5, train time 7.20 s
Epoch 9/50 |loss: 0.153614| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 6, train time 7.30 s
Epoch 10/50 |loss: 0.148739| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 7, train time 7.31 s
Epoch 11/50 |loss: 0.144877| train set 5.402x speedup, test set 5.224x speedup, val set 5.153x speedup, step: 8, train time 7.31 s
Epoch 12/50 |loss: 0.137717| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.21 s
Epoch 13/50 |loss: 0.136809| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 10, train time 7.09 s
Epoch 14/50 |loss: 0.137293| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 11, train time 7.20 s
Epoch 15/50 |loss: 0.135413| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 12, train time 7.27 s
Epoch 16/50 |loss: 0.133100| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 13, train time 7.30 s
Epoch 17/50 |loss: 0.133084| train set 5.308x speedup, test set 5.182x speedup, val set 4.900x speedup, step: 14, train time 7.22 s
Epoch 18/50 |loss: 0.133422| train set 5.336x speedup, test set 5.177x speedup, val set 5.014x speedup, step: 15, train time 7.37 s
Epoch 19/50 |loss: 0.129584| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16, train time 7.49 s
Epoch 20/50 |loss: 0.134920| train set 5.494x speedup, test set 5.410x speedup, val set 5.099x speedup, step: 17, train time 7.30 s
Epoch 21/50 |loss: 0.130864| train set 5.336x speedup, test set 5.176x speedup, val set 5.015x speedup, step: 18, train time 7.27 s
Epoch 22/50 |loss: 0.131668| train set 5.336x speedup, test set 5.177x speedup, val set 5.014x speedup, step: 19, train time 7.49 s
Epoch 23/50 |loss: 0.130806| train set 5.290x speedup, test set 5.059x speedup, val set 5.111x speedup, step: 20, train time 7.49 s
Epoch 24/50 |loss: 0.132791| train set 5.494x speedup, test set 5.408x speedup, val set 5.100x speedup, step: 21, train time 7.29 s
Epoch 25/50 |loss: 0.127828| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 22, train time 7.19 s
Epoch 26/50 |loss: 0.131983| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23, train time 7.42 s
Epoch 27/50 |loss: 0.127693| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 24, train time 7.21 s
Epoch 28/50 |loss: 0.125629| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 25, train time 7.30 s
Epoch 29/50 |loss: 0.125771| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 26, train time 7.40 s
Epoch 30/50 |loss: 0.128641| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 27, train time 7.37 s
Epoch 31/50 |loss: 0.125794| train set 5.496x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 28, train time 7.40 s
Epoch 32/50 |loss: 0.123012| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 29, train time 7.51 s
Epoch 33/50 |loss: 0.125861| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30, train time 7.41 s
Epoch 34/50 |loss: 0.124394| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 31, train time 7.50 s
Epoch 35/50 |loss: 0.127981| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 32, train time 7.32 s
Epoch 36/50 |loss: 0.124855| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 33, train time 7.28 s
Epoch 37/50 |loss: 0.126448| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 34, train time 7.51 s
Epoch 38/50 |loss: 0.124756| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 35, train time 7.38 s
Epoch 39/50 |loss: 0.123382| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 36, train time 7.49 s
Epoch 40/50 |loss: 0.123394| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 37, train time 7.40 s
Epoch 41/50 |loss: 0.121202| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 38, train time 7.31 s
Epoch 42/50 |loss: 0.119758| train set 5.449x speedup, test set 5.311x speedup, val set 5.195x speedup, step: 39, train time 7.39 s
Epoch 43/50 |loss: 0.121158| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 40, train time 7.47 s
Epoch 44/50 |loss: 0.125218| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 41, train time 7.41 s
Epoch 45/50 |loss: 0.121306| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 42, train time 7.48 s
Epoch 46/50 |loss: 0.125544| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 43, train time 7.31 s
Epoch 47/50 |loss: 0.120621| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 44, train time 7.32 s
Epoch 48/50 |loss: 0.120280| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45, train time 7.35 s
Epoch 49/50 |loss: 0.120435| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 46, train time 7.29 s
Training per epoch cost 7.350 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 7.469s, pg runtime 23.223s, speedup 3.109x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 38, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 31, train speedup 5.496, test speedup 5.421, val speedup 5.106
best validation speedup epoch: 4, train speedup 5.460, test speedup 5.375, val speedup 5.204
last model at epoch 49, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:06:34.563787
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.754363, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.395355| train set 5.162x speedup, test set 5.083x speedup, val set 4.806x speedup, step: 1, train time 8.35 s
Epoch 1/50 |loss: 0.245307| train set 5.223x speedup, test set 5.037x speedup, val set 5.053x speedup, step: 2, train time 7.17 s
Epoch 2/50 |loss: 0.208240| train set 5.402x speedup, test set 5.325x speedup, val set 5.022x speedup, step: 3, train time 7.01 s
Epoch 3/50 |loss: 0.185531| train set 5.167x speedup, test set 4.999x speedup, val set 4.876x speedup, step: 4, train time 7.19 s
Epoch 4/50 |loss: 0.176024| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1, train time 7.08 s
Epoch 5/50 |loss: 0.169160| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 2, train time 7.19 s
Epoch 6/50 |loss: 0.158914| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3, train time 7.19 s
Epoch 7/50 |loss: 0.158530| train set 5.403x speedup, test set 5.118x speedup, val set 5.140x speedup, step: 4, train time 7.20 s
Epoch 8/50 |loss: 0.151806| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 5, train time 7.19 s
Epoch 9/50 |loss: 0.151122| train set 5.447x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 6, train time 7.19 s
Epoch 10/50 |loss: 0.149360| train set 5.448x speedup, test set 5.331x speedup, val set 5.066x speedup, step: 7, train time 6.91 s
Epoch 11/50 |loss: 0.147430| train set 5.404x speedup, test set 5.207x speedup, val set 5.156x speedup, step: 8, train time 7.09 s
Epoch 12/50 |loss: 0.140138| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.38 s
Epoch 13/50 |loss: 0.137980| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 10, train time 7.02 s
Epoch 14/50 |loss: 0.137532| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 11, train time 7.10 s
Epoch 15/50 |loss: 0.135871| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 12, train time 7.18 s
Epoch 16/50 |loss: 0.133452| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 13, train time 7.13 s
Epoch 17/50 |loss: 0.134000| train set 5.265x speedup, test set 5.081x speedup, val set 4.981x speedup, step: 14, train time 7.20 s
Epoch 18/50 |loss: 0.134465| train set 5.336x speedup, test set 5.177x speedup, val set 5.014x speedup, step: 15, train time 7.20 s
Epoch 19/50 |loss: 0.129110| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16, train time 7.12 s
Epoch 20/50 |loss: 0.135583| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 17, train time 7.10 s
Epoch 21/50 |loss: 0.133295| train set 5.334x speedup, test set 5.165x speedup, val set 5.009x speedup, step: 18, train time 7.09 s
Epoch 22/50 |loss: 0.132836| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 19, train time 7.20 s
Epoch 23/50 |loss: 0.130606| train set 5.286x speedup, test set 5.073x speedup, val set 5.109x speedup, step: 20, train time 7.19 s
Epoch 24/50 |loss: 0.132284| train set 5.494x speedup, test set 5.408x speedup, val set 5.100x speedup, step: 21, train time 7.31 s
Epoch 25/50 |loss: 0.129149| train set 5.493x speedup, test set 5.413x speedup, val set 5.100x speedup, step: 22, train time 7.31 s
Epoch 26/50 |loss: 0.131594| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 23, train time 7.20 s
Epoch 27/50 |loss: 0.127909| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 24, train time 7.13 s
Epoch 28/50 |loss: 0.126096| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 25, train time 7.19 s
Epoch 29/50 |loss: 0.126443| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 26, train time 7.39 s
Epoch 30/50 |loss: 0.127354| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 27, train time 7.38 s
Epoch 31/50 |loss: 0.127232| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 28, train time 7.20 s
Epoch 32/50 |loss: 0.124083| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 29, train time 7.28 s
Epoch 33/50 |loss: 0.126354| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 30, train time 7.12 s
Epoch 34/50 |loss: 0.124295| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 31, train time 7.21 s
Epoch 35/50 |loss: 0.125936| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 32, train time 7.21 s
Epoch 36/50 |loss: 0.124901| train set 5.449x speedup, test set 5.309x speedup, val set 5.194x speedup, step: 33, train time 7.29 s
Epoch 37/50 |loss: 0.127498| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 34, train time 7.13 s
Epoch 38/50 |loss: 0.125243| train set 5.404x speedup, test set 5.209x speedup, val set 5.157x speedup, step: 35, train time 6.99 s
Epoch 39/50 |loss: 0.122682| train set 5.402x speedup, test set 5.224x speedup, val set 5.154x speedup, step: 36, train time 7.22 s
Epoch 40/50 |loss: 0.122947| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 37, train time 7.20 s
Epoch 41/50 |loss: 0.121233| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 38, train time 7.28 s
Epoch 42/50 |loss: 0.121401| train set 5.450x speedup, test set 5.312x speedup, val set 5.194x speedup, step: 39, train time 7.17 s
Epoch 43/50 |loss: 0.120334| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 40, train time 7.22 s
Epoch 44/50 |loss: 0.126123| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 41, train time 7.27 s
Epoch 45/50 |loss: 0.121021| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 42, train time 7.30 s
Epoch 46/50 |loss: 0.124313| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 43, train time 7.12 s
Epoch 47/50 |loss: 0.120074| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 44, train time 7.29 s
Epoch 48/50 |loss: 0.119598| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 45, train time 7.40 s
Epoch 49/50 |loss: 0.121211| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 46, train time 7.21 s
Training per epoch cost 7.213 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 6, train speedup 5.497, test speedup 5.421, val speedup 5.106
best test speedup epoch: 20, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 4, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 49, train speedup 5.496, test speedup 5.421, val speedup 5.107
execution cost 0:06:27.784615
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.749823, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397845| train set 5.008x speedup, test set 4.850x speedup, val set 4.743x speedup, step: 1, train time 8.49 s
Epoch 1/50 |loss: 0.244661| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 2, train time 7.38 s
Epoch 2/50 |loss: 0.209460| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.18 s
Epoch 3/50 |loss: 0.186397| train set 5.384x speedup, test set 5.287x speedup, val set 5.007x speedup, step: 4, train time 7.08 s
Epoch 4/50 |loss: 0.178918| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 1, train time 7.19 s
Epoch 5/50 |loss: 0.171042| train set 5.378x speedup, test set 5.154x speedup, val set 4.990x speedup, step: 2, train time 7.29 s
Epoch 6/50 |loss: 0.160286| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3, train time 7.22 s
Epoch 7/50 |loss: 0.155926| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 4, train time 7.30 s
Epoch 8/50 |loss: 0.150821| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5, train time 7.12 s
Epoch 9/50 |loss: 0.153882| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 6, train time 7.19 s
Epoch 10/50 |loss: 0.148875| train set 5.446x speedup, test set 5.320x speedup, val set 5.060x speedup, step: 7, train time 7.51 s
Epoch 11/50 |loss: 0.146908| train set 5.404x speedup, test set 5.208x speedup, val set 5.155x speedup, step: 8, train time 7.28 s
Epoch 12/50 |loss: 0.139306| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.02 s
Epoch 13/50 |loss: 0.137694| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 10, train time 7.41 s
Epoch 14/50 |loss: 0.137746| train set 5.494x speedup, test set 5.409x speedup, val set 5.099x speedup, step: 11, train time 7.29 s
Epoch 15/50 |loss: 0.135867| train set 5.448x speedup, test set 5.331x speedup, val set 5.066x speedup, step: 12, train time 7.40 s
Epoch 16/50 |loss: 0.136529| train set 5.450x speedup, test set 5.314x speedup, val set 5.068x speedup, step: 13, train time 7.21 s
Epoch 17/50 |loss: 0.133792| train set 5.265x speedup, test set 5.081x speedup, val set 4.981x speedup, step: 14, train time 7.20 s
Epoch 18/50 |loss: 0.136599| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 15, train time 7.18 s
Epoch 19/50 |loss: 0.129989| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1, train time 7.21 s
Epoch 20/50 |loss: 0.137471| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 2, train time 7.38 s
Epoch 21/50 |loss: 0.132127| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 3, train time 7.31 s
Epoch 22/50 |loss: 0.132285| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 4, train time 7.29 s
Epoch 23/50 |loss: 0.130587| train set 5.446x speedup, test set 5.291x speedup, val set 5.206x speedup, step: 5, train time 7.20 s
Epoch 24/50 |loss: 0.132327| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1, train time 7.38 s
Epoch 25/50 |loss: 0.130497| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 2, train time 7.39 s
Epoch 26/50 |loss: 0.130308| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3, train time 7.38 s
Epoch 27/50 |loss: 0.128147| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 4, train time 7.20 s
Epoch 28/50 |loss: 0.126589| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 5, train time 7.31 s
Epoch 29/50 |loss: 0.128340| train set 5.405x speedup, test set 5.209x speedup, val set 5.155x speedup, step: 1, train time 7.29 s
Epoch 30/50 |loss: 0.128863| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 2, train time 7.28 s
Epoch 31/50 |loss: 0.125839| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 3, train time 7.28 s
Epoch 32/50 |loss: 0.123797| train set 5.450x speedup, test set 5.315x speedup, val set 5.070x speedup, step: 4, train time 7.32 s
Epoch 33/50 |loss: 0.126219| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5, train time 7.39 s
Epoch 34/50 |loss: 0.125389| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6, train time 7.38 s
Epoch 35/50 |loss: 0.127054| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.30 s
Epoch 36/50 |loss: 0.125332| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 8, train time 7.39 s
Epoch 37/50 |loss: 0.126140| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.48 s
Epoch 38/50 |loss: 0.126216| train set 5.404x speedup, test set 5.208x speedup, val set 5.156x speedup, step: 10, train time 7.30 s
Epoch 39/50 |loss: 0.123137| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 11, train time 7.30 s
Epoch 40/50 |loss: 0.122552| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 12, train time 7.40 s
Epoch 41/50 |loss: 0.122373| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13, train time 7.31 s
Epoch 42/50 |loss: 0.121338| train set 5.449x speedup, test set 5.311x speedup, val set 5.195x speedup, step: 14, train time 7.31 s
Epoch 43/50 |loss: 0.121158| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 15, train time 7.20 s
Epoch 44/50 |loss: 0.125714| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16, train time 7.41 s
Epoch 45/50 |loss: 0.122928| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17, train time 7.47 s
Epoch 46/50 |loss: 0.124351| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 18, train time 7.31 s
Epoch 47/50 |loss: 0.121252| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 19, train time 7.38 s
Epoch 48/50 |loss: 0.120523| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20, train time 7.37 s
Epoch 49/50 |loss: 0.121020| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21, train time 7.30 s
Training per epoch cost 7.323 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.841s, pg runtime 14.286s, speedup 1.822x
08, opt runtime 7.237s, model runtime 8.427s, pg runtime 17.708s, speedup 2.101x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 47, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 20, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 29, train speedup 5.405, test speedup 5.209, val speedup 5.155
last model at epoch 49, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:06:32.986125
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.909153, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.396200| train set 4.544x speedup, test set 4.300x speedup, val set 4.233x speedup, step: 1, train time 8.49 s
Epoch 1/50 |loss: 0.241226| train set 5.378x speedup, test set 5.240x speedup, val set 5.126x speedup, step: 2, train time 7.19 s
Epoch 2/50 |loss: 0.207032| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3, train time 7.18 s
Epoch 3/50 |loss: 0.184441| train set 5.210x speedup, test set 5.098x speedup, val set 4.798x speedup, step: 4, train time 7.21 s
Epoch 4/50 |loss: 0.177008| train set 5.492x speedup, test set 5.423x speedup, val set 5.100x speedup, step: 1, train time 7.07 s
Epoch 5/50 |loss: 0.168251| train set 5.412x speedup, test set 5.335x speedup, val set 5.027x speedup, step: 2, train time 7.09 s
Epoch 6/50 |loss: 0.157712| train set 5.492x speedup, test set 5.422x speedup, val set 5.099x speedup, step: 3, train time 7.10 s
Epoch 7/50 |loss: 0.155599| train set 5.403x speedup, test set 5.118x speedup, val set 5.140x speedup, step: 4, train time 7.00 s
Epoch 8/50 |loss: 0.150160| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 5, train time 7.20 s
Epoch 9/50 |loss: 0.152852| train set 5.447x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 6, train time 7.02 s
Epoch 10/50 |loss: 0.148148| train set 5.448x speedup, test set 5.331x speedup, val set 5.066x speedup, step: 7, train time 7.04 s
Epoch 11/50 |loss: 0.145770| train set 5.402x speedup, test set 5.225x speedup, val set 5.153x speedup, step: 8, train time 7.11 s
Epoch 12/50 |loss: 0.136116| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 9, train time 7.30 s
Epoch 13/50 |loss: 0.135873| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 10, train time 7.38 s
Epoch 14/50 |loss: 0.135654| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 1, train time 7.20 s
Epoch 15/50 |loss: 0.134318| train set 5.450x speedup, test set 5.314x speedup, val set 5.068x speedup, step: 2, train time 7.29 s
Epoch 16/50 |loss: 0.134864| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 3, train time 7.31 s
Epoch 17/50 |loss: 0.132598| train set 5.308x speedup, test set 5.182x speedup, val set 4.900x speedup, step: 4, train time 7.28 s
Epoch 18/50 |loss: 0.133468| train set 5.290x speedup, test set 5.095x speedup, val set 4.978x speedup, step: 5, train time 7.18 s
Epoch 19/50 |loss: 0.128515| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1, train time 7.47 s
Epoch 20/50 |loss: 0.136705| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 2, train time 7.21 s
Epoch 21/50 |loss: 0.131991| train set 5.290x speedup, test set 5.094x speedup, val set 4.977x speedup, step: 3, train time 7.40 s
Epoch 22/50 |loss: 0.131790| train set 5.336x speedup, test set 5.177x speedup, val set 5.015x speedup, step: 4, train time 7.29 s
Epoch 23/50 |loss: 0.130280| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 5, train time 7.30 s
Epoch 24/50 |loss: 0.133295| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1, train time 7.28 s
Epoch 25/50 |loss: 0.128176| train set 5.493x speedup, test set 5.413x speedup, val set 5.100x speedup, step: 2, train time 7.21 s
Epoch 26/50 |loss: 0.130028| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3, train time 7.30 s
Epoch 27/50 |loss: 0.129143| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4, train time 7.20 s
Epoch 28/50 |loss: 0.125974| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 5, train time 7.22 s
Epoch 29/50 |loss: 0.125857| train set 5.402x speedup, test set 5.225x speedup, val set 5.153x speedup, step: 1, train time 7.17 s
Epoch 30/50 |loss: 0.128258| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 2, train time 7.51 s
Epoch 31/50 |loss: 0.126055| train set 5.496x speedup, test set 5.421x speedup, val set 5.107x speedup, step: 3, train time 7.20 s
Epoch 32/50 |loss: 0.124168| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 4, train time 7.32 s
Epoch 33/50 |loss: 0.125467| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 5, train time 7.18 s
Epoch 34/50 |loss: 0.124038| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6, train time 7.11 s
Epoch 35/50 |loss: 0.125435| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.31 s
Epoch 36/50 |loss: 0.124312| train set 5.449x speedup, test set 5.220x speedup, val set 5.129x speedup, step: 8, train time 7.20 s
Epoch 37/50 |loss: 0.125482| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.30 s
Epoch 38/50 |loss: 0.123795| train set 5.405x speedup, test set 5.209x speedup, val set 5.155x speedup, step: 10, train time 7.40 s
Epoch 39/50 |loss: 0.123151| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 11, train time 7.11 s
Epoch 40/50 |loss: 0.122273| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 12, train time 7.08 s
Epoch 41/50 |loss: 0.120880| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13, train time 7.20 s
Epoch 42/50 |loss: 0.121754| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 14, train time 7.21 s
Epoch 43/50 |loss: 0.122136| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 15, train time 7.31 s
Epoch 44/50 |loss: 0.124763| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16, train time 7.30 s
Epoch 45/50 |loss: 0.121256| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 17, train time 7.40 s
Epoch 46/50 |loss: 0.124644| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 18, train time 7.19 s
Epoch 47/50 |loss: 0.121099| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19, train time 7.47 s
Epoch 48/50 |loss: 0.119526| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20, train time 7.39 s
Epoch 49/50 |loss: 0.121248| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21, train time 7.20 s
Training per epoch cost 7.261 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 42.151s, pg runtime 70.116s, speedup 1.663x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 45, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 4, train speedup 5.492, test speedup 5.423, val speedup 5.100
best validation speedup epoch: 29, train speedup 5.402, test speedup 5.225, val speedup 5.153
last model at epoch 49, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:06:30.177107
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.763005, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394107| train set 5.056x speedup, test set 4.881x speedup, val set 4.922x speedup, step: 1, train time 8.22 s
Epoch 1/50 |loss: 0.245766| train set 5.315x speedup, test set 5.183x speedup, val set 5.068x speedup, step: 2, train time 7.10 s
Epoch 2/50 |loss: 0.208987| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.11 s
Epoch 3/50 |loss: 0.187890| train set 5.449x speedup, test set 5.350x speedup, val set 5.068x speedup, step: 4, train time 7.09 s
Epoch 4/50 |loss: 0.179255| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1, train time 7.09 s
Epoch 5/50 |loss: 0.169754| train set 5.423x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 2, train time 7.19 s
Epoch 6/50 |loss: 0.159649| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.10 s
Epoch 7/50 |loss: 0.157980| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 4, train time 6.92 s
Epoch 8/50 |loss: 0.150919| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 5, train time 7.20 s
Epoch 9/50 |loss: 0.153904| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 6, train time 7.17 s
Epoch 10/50 |loss: 0.150329| train set 5.448x speedup, test set 5.331x speedup, val set 5.066x speedup, step: 7, train time 6.93 s
Epoch 11/50 |loss: 0.145602| train set 5.401x speedup, test set 5.223x speedup, val set 5.154x speedup, step: 8, train time 7.02 s
Epoch 12/50 |loss: 0.137639| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 6.98 s
Epoch 13/50 |loss: 0.136133| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 10, train time 7.02 s
Epoch 14/50 |loss: 0.137333| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 11, train time 6.91 s
Epoch 15/50 |loss: 0.135683| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 12, train time 7.00 s
Epoch 16/50 |loss: 0.134689| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 13, train time 7.02 s
Epoch 17/50 |loss: 0.132100| train set 5.265x speedup, test set 5.081x speedup, val set 4.981x speedup, step: 14, train time 7.19 s
Epoch 18/50 |loss: 0.132774| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 15, train time 7.19 s
Epoch 19/50 |loss: 0.128567| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16, train time 7.17 s
Epoch 20/50 |loss: 0.136322| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 17, train time 7.20 s
Epoch 21/50 |loss: 0.131430| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 18, train time 7.20 s
Epoch 22/50 |loss: 0.131248| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 19, train time 7.18 s
Epoch 23/50 |loss: 0.130457| train set 5.446x speedup, test set 5.291x speedup, val set 5.206x speedup, step: 20, train time 7.20 s
Epoch 24/50 |loss: 0.131665| train set 5.494x speedup, test set 5.408x speedup, val set 5.100x speedup, step: 21, train time 7.12 s
Epoch 25/50 |loss: 0.127480| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 22, train time 7.07 s
Epoch 26/50 |loss: 0.130131| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 23, train time 7.20 s
Epoch 27/50 |loss: 0.127443| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 24, train time 7.08 s
Epoch 28/50 |loss: 0.125136| train set 5.446x speedup, test set 5.291x speedup, val set 5.206x speedup, step: 25, train time 7.02 s
Epoch 29/50 |loss: 0.125836| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1, train time 7.02 s
Epoch 30/50 |loss: 0.127831| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 2, train time 7.11 s
Epoch 31/50 |loss: 0.125164| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 3, train time 7.11 s
Epoch 32/50 |loss: 0.123714| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 4, train time 7.19 s
Epoch 33/50 |loss: 0.125603| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5, train time 7.08 s
Epoch 34/50 |loss: 0.123456| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6, train time 7.31 s
Epoch 35/50 |loss: 0.125297| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.20 s
Epoch 36/50 |loss: 0.125061| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 8, train time 7.10 s
Epoch 37/50 |loss: 0.126882| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.22 s
Epoch 38/50 |loss: 0.125176| train set 5.452x speedup, test set 5.293x speedup, val set 5.196x speedup, step: 10, train time 7.31 s
Epoch 39/50 |loss: 0.121571| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 11, train time 7.21 s
Epoch 40/50 |loss: 0.122592| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 12, train time 7.12 s
Epoch 41/50 |loss: 0.120773| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 13, train time 7.13 s
Epoch 42/50 |loss: 0.120950| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 14, train time 7.12 s
Epoch 43/50 |loss: 0.121196| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 15, train time 7.20 s
Epoch 44/50 |loss: 0.124990| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16, train time 7.21 s
Epoch 45/50 |loss: 0.120802| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17, train time 7.18 s
Epoch 46/50 |loss: 0.124687| train set 5.444x speedup, test set 5.324x speedup, val set 5.060x speedup, step: 18, train time 7.30 s
Epoch 47/50 |loss: 0.120666| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 19, train time 7.06 s
Epoch 48/50 |loss: 0.119477| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20, train time 7.19 s
Epoch 49/50 |loss: 0.120236| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 21, train time 7.10 s
Training per epoch cost 7.147 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 20, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 29, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 49, train speedup 5.496, test speedup 5.420, val speedup 5.107
execution cost 0:06:24.438323
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.952210, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394301| train set 4.729x speedup, test set 4.484x speedup, val set 4.444x speedup, step: 1, train time 8.40 s
Epoch 1/50 |loss: 0.244607| train set 5.320x speedup, test set 5.188x speedup, val set 5.077x speedup, step: 2, train time 7.17 s
Epoch 2/50 |loss: 0.205416| train set 5.423x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.17 s
Epoch 3/50 |loss: 0.186630| train set 5.139x speedup, test set 5.028x speedup, val set 4.736x speedup, step: 4, train time 7.20 s
Epoch 4/50 |loss: 0.177387| train set 5.419x speedup, test set 5.350x speedup, val set 5.036x speedup, step: 1, train time 7.01 s
Epoch 5/50 |loss: 0.169769| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 2, train time 6.94 s
Epoch 6/50 |loss: 0.160006| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3, train time 7.07 s
Epoch 7/50 |loss: 0.157563| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 4, train time 7.21 s
Epoch 8/50 |loss: 0.150696| train set 5.449x speedup, test set 5.309x speedup, val set 5.194x speedup, step: 5, train time 7.12 s
Epoch 9/50 |loss: 0.151642| train set 5.448x speedup, test set 5.331x speedup, val set 5.065x speedup, step: 1, train time 7.10 s
Epoch 10/50 |loss: 0.149866| train set 5.446x speedup, test set 5.320x speedup, val set 5.060x speedup, step: 2, train time 7.09 s
Epoch 11/50 |loss: 0.145860| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 3, train time 7.10 s
Epoch 12/50 |loss: 0.138728| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 4, train time 7.08 s
Epoch 13/50 |loss: 0.137543| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 5, train time 7.19 s
Epoch 14/50 |loss: 0.137565| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 1, train time 7.12 s
Epoch 15/50 |loss: 0.136974| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 2, train time 7.16 s
Epoch 16/50 |loss: 0.135552| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 3, train time 6.99 s
Epoch 17/50 |loss: 0.133588| train set 5.265x speedup, test set 5.081x speedup, val set 4.981x speedup, step: 4, train time 7.07 s
Epoch 18/50 |loss: 0.133029| train set 5.336x speedup, test set 5.177x speedup, val set 5.014x speedup, step: 5, train time 6.98 s
Epoch 19/50 |loss: 0.129138| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1, train time 6.98 s
Epoch 20/50 |loss: 0.135651| train set 5.495x speedup, test set 5.410x speedup, val set 5.100x speedup, step: 2, train time 7.10 s
Epoch 21/50 |loss: 0.131921| train set 5.445x speedup, test set 5.319x speedup, val set 5.061x speedup, step: 3, train time 6.90 s
Epoch 22/50 |loss: 0.134191| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 4, train time 6.98 s
Epoch 23/50 |loss: 0.129917| train set 5.443x speedup, test set 5.307x speedup, val set 5.204x speedup, step: 5, train time 7.10 s
Epoch 24/50 |loss: 0.132577| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 1, train time 7.27 s
Epoch 25/50 |loss: 0.128579| train set 5.493x speedup, test set 5.413x speedup, val set 5.100x speedup, step: 2, train time 6.99 s
Epoch 26/50 |loss: 0.129409| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3, train time 6.92 s
Epoch 27/50 |loss: 0.128064| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 4, train time 7.10 s
Epoch 28/50 |loss: 0.126021| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 5, train time 7.30 s
Epoch 29/50 |loss: 0.125519| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1, train time 7.10 s
Epoch 30/50 |loss: 0.128554| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 2, train time 7.10 s
Epoch 31/50 |loss: 0.124802| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 3, train time 6.98 s
Epoch 32/50 |loss: 0.124437| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 4, train time 7.10 s
Epoch 33/50 |loss: 0.124759| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 5, train time 7.22 s
Epoch 34/50 |loss: 0.124170| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 6, train time 7.20 s
Epoch 35/50 |loss: 0.126155| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.11 s
Epoch 36/50 |loss: 0.124987| train set 5.449x speedup, test set 5.309x speedup, val set 5.194x speedup, step: 8, train time 7.00 s
Epoch 37/50 |loss: 0.125390| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.20 s
Epoch 38/50 |loss: 0.124862| train set 5.450x speedup, test set 5.314x speedup, val set 5.070x speedup, step: 10, train time 7.12 s
Epoch 39/50 |loss: 0.122289| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 11, train time 7.08 s
Epoch 40/50 |loss: 0.123475| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 12, train time 7.02 s
Epoch 41/50 |loss: 0.120547| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13, train time 7.18 s
Epoch 42/50 |loss: 0.120566| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 14, train time 7.13 s
Epoch 43/50 |loss: 0.120682| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 15, train time 7.10 s
Epoch 44/50 |loss: 0.124192| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 16, train time 7.11 s
Epoch 45/50 |loss: 0.122170| train set 5.499x speedup, test set 5.403x speedup, val set 5.109x speedup, step: 17, train time 7.12 s
Epoch 46/50 |loss: 0.124517| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18, train time 7.10 s
Epoch 47/50 |loss: 0.120422| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 19, train time 7.11 s
Epoch 48/50 |loss: 0.119513| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20, train time 7.08 s
Epoch 49/50 |loss: 0.120099| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21, train time 7.00 s
Training per epoch cost 7.119 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 47, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 6, train speedup 5.497, test speedup 5.421, val speedup 5.106
best validation speedup epoch: 29, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 49, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:06:23.313969
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.788114, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394106| train set 5.047x speedup, test set 4.828x speedup, val set 4.913x speedup, step: 1, train time 8.42 s
Epoch 1/50 |loss: 0.243700| train set 5.423x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 2, train time 7.08 s
Epoch 2/50 |loss: 0.211968| train set 5.424x speedup, test set 5.348x speedup, val set 5.040x speedup, step: 3, train time 7.01 s
Epoch 3/50 |loss: 0.185467| train set 5.333x speedup, test set 5.175x speedup, val set 5.087x speedup, step: 4, train time 7.39 s
Epoch 4/50 |loss: 0.177139| train set 5.378x speedup, test set 5.240x speedup, val set 5.126x speedup, step: 1, train time 7.28 s
Epoch 5/50 |loss: 0.169871| train set 5.422x speedup, test set 5.337x speedup, val set 5.034x speedup, step: 2, train time 7.39 s
Epoch 6/50 |loss: 0.160260| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 3, train time 7.21 s
Epoch 7/50 |loss: 0.157623| train set 5.404x speedup, test set 5.119x speedup, val set 5.140x speedup, step: 4, train time 7.38 s
Epoch 8/50 |loss: 0.152750| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 5, train time 7.31 s
Epoch 9/50 |loss: 0.151872| train set 5.447x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 6, train time 7.19 s
Epoch 10/50 |loss: 0.147909| train set 5.446x speedup, test set 5.320x speedup, val set 5.060x speedup, step: 7, train time 7.28 s
Epoch 11/50 |loss: 0.146345| train set 5.404x speedup, test set 5.209x speedup, val set 5.155x speedup, step: 8, train time 7.11 s
Epoch 12/50 |loss: 0.137873| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.27 s
Epoch 13/50 |loss: 0.136556| train set 5.499x speedup, test set 5.404x speedup, val set 5.107x speedup, step: 10, train time 7.30 s
Epoch 14/50 |loss: 0.138320| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 11, train time 7.37 s
Epoch 15/50 |loss: 0.134618| train set 5.451x speedup, test set 5.315x speedup, val set 5.069x speedup, step: 12, train time 7.28 s
Epoch 16/50 |loss: 0.135590| train set 5.450x speedup, test set 5.314x speedup, val set 5.069x speedup, step: 13, train time 7.30 s
Epoch 17/50 |loss: 0.134029| train set 5.496x speedup, test set 5.420x speedup, val set 5.106x speedup, step: 14, train time 7.30 s
Epoch 18/50 |loss: 0.133360| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 15, train time 7.10 s
Epoch 19/50 |loss: 0.129885| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16, train time 7.21 s
Epoch 20/50 |loss: 0.135768| train set 5.497x speedup, test set 5.422x speedup, val set 5.106x speedup, step: 17, train time 7.28 s
Epoch 21/50 |loss: 0.133127| train set 5.494x speedup, test set 5.408x speedup, val set 5.100x speedup, step: 18, train time 7.29 s
Epoch 22/50 |loss: 0.131614| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 19, train time 7.19 s
Epoch 23/50 |loss: 0.129640| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 20, train time 7.28 s
Epoch 24/50 |loss: 0.132591| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 21, train time 7.30 s
Epoch 25/50 |loss: 0.128147| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 22, train time 7.19 s
Epoch 26/50 |loss: 0.130724| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 23, train time 7.30 s
Epoch 27/50 |loss: 0.127303| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 24, train time 7.28 s
Epoch 28/50 |loss: 0.126083| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 25, train time 7.29 s
Epoch 29/50 |loss: 0.126209| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 1, train time 7.30 s
Epoch 30/50 |loss: 0.129763| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 2, train time 7.09 s
Epoch 31/50 |loss: 0.125858| train set 5.447x speedup, test set 5.330x speedup, val set 5.068x speedup, step: 3, train time 7.22 s
Epoch 32/50 |loss: 0.124453| train set 5.448x speedup, test set 5.331x speedup, val set 5.067x speedup, step: 4, train time 7.20 s
Epoch 33/50 |loss: 0.125742| train set 5.496x speedup, test set 5.420x speedup, val set 5.105x speedup, step: 5, train time 7.30 s
Epoch 34/50 |loss: 0.124694| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 6, train time 7.38 s
Epoch 35/50 |loss: 0.125915| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 7, train time 7.20 s
Epoch 36/50 |loss: 0.125550| train set 5.449x speedup, test set 5.310x speedup, val set 5.193x speedup, step: 8, train time 7.31 s
Epoch 37/50 |loss: 0.126806| train set 5.450x speedup, test set 5.310x speedup, val set 5.195x speedup, step: 9, train time 7.10 s
Epoch 38/50 |loss: 0.125847| train set 5.452x speedup, test set 5.294x speedup, val set 5.195x speedup, step: 10, train time 7.28 s
Epoch 39/50 |loss: 0.123085| train set 5.448x speedup, test set 5.331x speedup, val set 5.068x speedup, step: 11, train time 7.10 s
Epoch 40/50 |loss: 0.123475| train set 5.450x speedup, test set 5.311x speedup, val set 5.193x speedup, step: 12, train time 7.17 s
Epoch 41/50 |loss: 0.122097| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 13, train time 7.23 s
Epoch 42/50 |loss: 0.120884| train set 5.449x speedup, test set 5.311x speedup, val set 5.195x speedup, step: 14, train time 7.32 s
Epoch 43/50 |loss: 0.121119| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 15, train time 7.28 s
Epoch 44/50 |loss: 0.126019| train set 5.496x speedup, test set 5.420x speedup, val set 5.107x speedup, step: 16, train time 7.40 s
Epoch 45/50 |loss: 0.121613| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 17, train time 7.28 s
Epoch 46/50 |loss: 0.124483| train set 5.495x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 18, train time 7.31 s
Epoch 47/50 |loss: 0.120507| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 19, train time 7.18 s
Epoch 48/50 |loss: 0.119875| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 20, train time 7.18 s
Epoch 49/50 |loss: 0.120952| train set 5.497x speedup, test set 5.421x speedup, val set 5.106x speedup, step: 21, train time 7.40 s
Training per epoch cost 7.276 s
Optimal speedup on test set is 5.508x
01, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
02, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 29.763s, model runtime 29.763s, pg runtime 91.648s, speedup 3.079x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 19.263s, model runtime 19.263s, pg runtime 19.263s, speedup 1.000x
07, opt runtime 7.110s, model runtime 7.110s, pg runtime 14.286s, speedup 2.009x
08, opt runtime 7.237s, model runtime 7.237s, pg runtime 17.708s, speedup 2.447x
09, opt runtime 4.881s, model runtime 4.881s, pg runtime 4.881s, speedup 1.000x
10, opt runtime 5.086s, model runtime 5.086s, pg runtime 5.086s, speedup 1.000x
11, opt runtime 25.043s, model runtime 25.043s, pg runtime 73.019s, speedup 2.916x
12, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 2.995s, model runtime 2.995s, pg runtime 14.646s, speedup 4.890x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 7.469s, model runtime 14.931s, pg runtime 23.223s, speedup 1.555x
19, opt runtime 1.309s, model runtime 1.356s, pg runtime 1.356s, speedup 1.000x
20, opt runtime 1.340s, model runtime 1.340s, pg runtime 1.340s, speedup 1.000x
21, opt runtime 6.281s, model runtime 6.281s, pg runtime 6.281s, speedup 1.000x
22, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
23, opt runtime 5.961s, model runtime 5.961s, pg runtime 31.210s, speedup 5.236x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.306s, model runtime 1.306s, pg runtime 1.306s, speedup 1.000x
26, opt runtime 1.342s, model runtime 1.342s, pg runtime 1.342s, speedup 1.000x
27, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
28, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
29, opt runtime 5.414s, model runtime 5.414s, pg runtime 5.414s, speedup 1.000x
30, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
31, opt runtime 25.363s, model runtime 25.363s, pg runtime 611.327s, speedup 24.103x
32, opt runtime 24.706s, model runtime 24.706s, pg runtime 610.808s, speedup 24.723x
33, opt runtime 35.538s, model runtime 35.538s, pg runtime 70.116s, speedup 1.973x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
36, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
37, opt runtime 15.754s, model runtime 15.754s, pg runtime 15.754s, speedup 1.000x
38, opt runtime 13.961s, model runtime 13.961s, pg runtime 13.961s, speedup 1.000x
39, opt runtime 1.098s, model runtime 1.098s, pg runtime 1.100s, speedup 1.001x
40, opt runtime 1.084s, model runtime 1.084s, pg runtime 1.155s, speedup 1.065x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 5.404, val speedup 5.107
best test speedup epoch: 20, train speedup 5.497, test speedup 5.422, val speedup 5.106
best validation speedup epoch: 29, train speedup 5.450, test speedup 5.311, val speedup 5.193
last model at epoch 49, train speedup 5.497, test speedup 5.421, val speedup 5.106
execution cost 0:06:30.487297
==================================================
