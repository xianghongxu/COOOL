all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.710035, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.309090| train set 8.077x speedup, test set 0.745x speedup, val set 0.720x speedup, step: 1, train time 19.88 s
Epoch 1/50 |loss: 0.202415| train set 7.991x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 2, train time 17.45 s
Epoch 2/50 |loss: 0.167672| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3, train time 17.50 s
Epoch 3/50 |loss: 0.156145| train set 8.136x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 17.24 s
Epoch 4/50 |loss: 0.157329| train set 8.184x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 1, train time 17.33 s
Epoch 5/50 |loss: 0.147033| train set 8.332x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2, train time 17.31 s
Epoch 6/50 |loss: 0.142406| train set 8.184x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 3, train time 17.50 s
Epoch 7/50 |loss: 0.143767| train set 8.339x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 4, train time 17.34 s
Epoch 8/50 |loss: 0.142774| train set 8.332x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 5, train time 17.58 s
Epoch 9/50 |loss: 0.133104| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 1, train time 17.33 s
Epoch 10/50 |loss: 0.131594| train set 8.177x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 2, train time 17.41 s
Epoch 11/50 |loss: 0.133841| train set 8.184x speedup, test set 0.757x speedup, val set 0.824x speedup, step: 3, train time 17.81 s
Epoch 12/50 |loss: 0.131177| train set 8.184x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 4, train time 17.83 s
Epoch 13/50 |loss: 0.130547| train set 8.185x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 5, train time 17.73 s
Epoch 14/50 |loss: 0.128069| train set 8.185x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 1, train time 17.74 s
Epoch 15/50 |loss: 0.128180| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2, train time 18.02 s
Epoch 16/50 |loss: 0.127607| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3, train time 17.52 s
Epoch 17/50 |loss: 0.126381| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 4, train time 17.82 s
Epoch 18/50 |loss: 0.125703| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 5, train time 17.73 s
Epoch 19/50 |loss: 0.127926| train set 8.337x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 1, train time 17.62 s
Epoch 20/50 |loss: 0.124826| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 2, train time 17.81 s
Epoch 21/50 |loss: 0.125558| train set 8.340x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 3, train time 17.73 s
Epoch 22/50 |loss: 0.123626| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 17.80 s
Epoch 23/50 |loss: 0.125946| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 5, train time 17.74 s
Epoch 24/50 |loss: 0.124701| train set 8.183x speedup, test set 0.754x speedup, val set 0.824x speedup, step: 1, train time 17.80 s
Epoch 25/50 |loss: 0.122453| train set 8.339x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 2, train time 17.72 s
Epoch 26/50 |loss: 0.123270| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 3, train time 17.63 s
Epoch 27/50 |loss: 0.122213| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 4, train time 17.73 s
Epoch 28/50 |loss: 0.120286| train set 7.818x speedup, test set 0.805x speedup, val set 0.720x speedup, step: 5, train time 17.73 s
Epoch 29/50 |loss: 0.120129| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 6, train time 17.70 s
Epoch 30/50 |loss: 0.120517| train set 8.339x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 7, train time 17.23 s
Epoch 31/50 |loss: 0.119267| train set 8.184x speedup, test set 0.740x speedup, val set 0.720x speedup, step: 8, train time 17.21 s
Epoch 32/50 |loss: 0.121353| train set 8.332x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 9, train time 17.43 s
Epoch 33/50 |loss: 0.121215| train set 8.337x speedup, test set 0.696x speedup, val set 0.824x speedup, step: 10, train time 17.61 s
Epoch 34/50 |loss: 0.118268| train set 8.339x speedup, test set 0.792x speedup, val set 0.824x speedup, step: 1, train time 17.64 s
Epoch 35/50 |loss: 0.120861| train set 8.184x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 2, train time 17.40 s
Epoch 36/50 |loss: 0.121944| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 3, train time 17.61 s
Epoch 37/50 |loss: 0.119735| train set 8.332x speedup, test set 0.818x speedup, val set 0.720x speedup, step: 4, train time 17.60 s
Epoch 38/50 |loss: 0.118718| train set 8.339x speedup, test set 0.816x speedup, val set 0.720x speedup, step: 5, train time 17.64 s
Epoch 39/50 |loss: 0.118640| train set 8.184x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 6, train time 17.62 s
Epoch 40/50 |loss: 0.120117| train set 8.339x speedup, test set 0.829x speedup, val set 0.720x speedup, step: 7, train time 17.62 s
Epoch 41/50 |loss: 0.116741| train set 8.184x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 8, train time 17.62 s
Epoch 42/50 |loss: 0.116988| train set 8.339x speedup, test set 0.798x speedup, val set 0.720x speedup, step: 9, train time 17.63 s
Epoch 43/50 |loss: 0.117477| train set 8.339x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 10, train time 17.34 s
Epoch 44/50 |loss: 0.119382| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 11, train time 17.71 s
Epoch 45/50 |loss: 0.115460| train set 8.339x speedup, test set 1.346x speedup, val set 0.720x speedup, step: 12, train time 17.61 s
Epoch 46/50 |loss: 0.116895| train set 8.336x speedup, test set 0.722x speedup, val set 0.720x speedup, step: 13, train time 17.67 s
Epoch 47/50 |loss: 0.118107| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 14, train time 17.80 s
Epoch 48/50 |loss: 0.115966| train set 8.339x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 15, train time 17.71 s
Epoch 49/50 |loss: 0.116470| train set 8.339x speedup, test set 0.829x speedup, val set 0.720x speedup, step: 16, train time 17.72 s
Training per epoch cost 17.649 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 9.171s, pg runtime 17.708s, speedup 1.931x
12, opt runtime 6.284s, model runtime 9.232s, pg runtime 31.019s, speedup 3.360x
13, opt runtime 7.851s, model runtime 12.431s, pg runtime 13.622s, speedup 1.096x
14, opt runtime 7.442s, model runtime 9.800s, pg runtime 14.838s, speedup 1.514x
15, opt runtime 7.110s, model runtime 12.431s, pg runtime 14.286s, speedup 1.149x
16, opt runtime 6.810s, model runtime 11.534s, pg runtime 13.796s, speedup 1.196x
17, opt runtime 6.460s, model runtime 10.619s, pg runtime 16.134s, speedup 1.519x
18, opt runtime 6.656s, model runtime 8.786s, pg runtime 15.260s, speedup 1.737x
19, opt runtime 7.913s, model runtime 9.315s, pg runtime 15.548s, speedup 1.669x
20, opt runtime 7.377s, model runtime 8.566s, pg runtime 28.655s, speedup 3.345x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
32, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
33, opt runtime 6.888s, model runtime 6.888s, pg runtime 29.820s, speedup 4.329x
34, opt runtime 6.248s, model runtime 6.248s, pg runtime 19.123s, speedup 3.061x
35, opt runtime 5.874s, model runtime 5.874s, pg runtime 29.356s, speedup 4.998x
36, opt runtime 11.830s, model runtime 23.790s, pg runtime 20.360s, speedup 0.856x
37, opt runtime 7.469s, model runtime 7.469s, pg runtime 23.223s, speedup 3.109x
38, opt runtime 7.662s, model runtime 12.827s, pg runtime 15.898s, speedup 1.239x
39, opt runtime 7.867s, model runtime 7.870s, pg runtime 24.303s, speedup 3.088x
40, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
====================
best train speedup epoch: 2, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 45, train speedup 8.339, test speedup 1.346, val speedup 0.720
best validation speedup epoch: 34, train speedup 8.339, test speedup 0.792, val speedup 0.824
last model at epoch 49, train speedup 8.339, test speedup 0.829, val speedup 0.720
execution cost 0:16:00.200493
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.141996, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.312257| train set 8.275x speedup, test set 1.387x speedup, val set 0.720x speedup, step: 1, train time 20.28 s
Epoch 1/50 |loss: 0.202184| train set 8.077x speedup, test set 0.713x speedup, val set 0.714x speedup, step: 2, train time 17.73 s
Epoch 2/50 |loss: 0.168524| train set 8.339x speedup, test set 0.689x speedup, val set 0.720x speedup, step: 3, train time 17.62 s
Epoch 3/50 |loss: 0.155153| train set 8.137x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 4, train time 17.71 s
Epoch 4/50 |loss: 0.156837| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 1, train time 17.74 s
Epoch 5/50 |loss: 0.148350| train set 8.339x speedup, test set 0.775x speedup, val set 0.720x speedup, step: 2, train time 17.63 s
Epoch 6/50 |loss: 0.143032| train set 8.178x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 3, train time 17.51 s
Epoch 7/50 |loss: 0.143964| train set 8.339x speedup, test set 0.685x speedup, val set 0.824x speedup, step: 4, train time 17.61 s
Epoch 8/50 |loss: 0.140065| train set 8.332x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 5, train time 17.71 s
Epoch 9/50 |loss: 0.132280| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 6, train time 17.77 s
Epoch 10/50 |loss: 0.133637| train set 8.178x speedup, test set 0.693x speedup, val set 0.816x speedup, step: 7, train time 17.72 s
Epoch 11/50 |loss: 0.134879| train set 8.185x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 8, train time 17.61 s
Epoch 12/50 |loss: 0.132290| train set 8.184x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 9, train time 17.54 s
Epoch 13/50 |loss: 0.129588| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 10, train time 17.72 s
Epoch 14/50 |loss: 0.128553| train set 8.185x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 1, train time 17.63 s
Epoch 15/50 |loss: 0.127870| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2, train time 18.03 s
Epoch 16/50 |loss: 0.127494| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 3, train time 17.82 s
Epoch 17/50 |loss: 0.127302| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 4, train time 17.72 s
Epoch 18/50 |loss: 0.125146| train set 8.338x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 5, train time 17.92 s
Epoch 19/50 |loss: 0.127997| train set 8.184x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 6, train time 18.00 s
Epoch 20/50 |loss: 0.125542| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 7, train time 17.92 s
Epoch 21/50 |loss: 0.124703| train set 8.340x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 8, train time 17.94 s
Epoch 22/50 |loss: 0.123724| train set 8.339x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 9, train time 17.82 s
Epoch 23/50 |loss: 0.126742| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 10, train time 17.80 s
Epoch 24/50 |loss: 0.124562| train set 8.184x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 1, train time 17.90 s
Epoch 25/50 |loss: 0.122051| train set 8.184x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 2, train time 17.80 s
Epoch 26/50 |loss: 0.123664| train set 8.339x speedup, test set 0.840x speedup, val set 0.714x speedup, step: 3, train time 17.91 s
Epoch 27/50 |loss: 0.122042| train set 8.339x speedup, test set 0.840x speedup, val set 0.714x speedup, step: 4, train time 17.72 s
Epoch 28/50 |loss: 0.121193| train set 8.184x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 5, train time 17.12 s
Epoch 29/50 |loss: 0.119298| train set 8.332x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 6, train time 17.39 s
Epoch 30/50 |loss: 0.121219| train set 8.339x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 7, train time 17.74 s
Epoch 31/50 |loss: 0.119514| train set 8.184x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 8, train time 17.73 s
Epoch 32/50 |loss: 0.120017| train set 8.339x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 9, train time 17.63 s
Epoch 33/50 |loss: 0.121756| train set 8.184x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 10, train time 17.83 s
Epoch 34/50 |loss: 0.117462| train set 8.339x speedup, test set 0.685x speedup, val set 0.720x speedup, step: 11, train time 17.93 s
Epoch 35/50 |loss: 0.119620| train set 8.183x speedup, test set 0.829x speedup, val set 0.714x speedup, step: 12, train time 17.90 s
Epoch 36/50 |loss: 0.121045| train set 8.339x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 13, train time 17.92 s
Epoch 37/50 |loss: 0.119957| train set 8.339x speedup, test set 0.840x speedup, val set 0.714x speedup, step: 14, train time 17.92 s
Epoch 38/50 |loss: 0.119081| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 15, train time 18.03 s
Epoch 39/50 |loss: 0.118123| train set 8.183x speedup, test set 0.840x speedup, val set 0.714x speedup, step: 16, train time 17.91 s
Epoch 40/50 |loss: 0.120648| train set 8.339x speedup, test set 0.829x speedup, val set 0.720x speedup, step: 17, train time 17.74 s
Epoch 41/50 |loss: 0.118280| train set 8.184x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 18, train time 17.64 s
Epoch 42/50 |loss: 0.116392| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 19, train time 18.10 s
Epoch 43/50 |loss: 0.117934| train set 8.332x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 20, train time 18.01 s
Epoch 44/50 |loss: 0.120354| train set 8.339x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 21, train time 18.12 s
Epoch 45/50 |loss: 0.116264| train set 8.339x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 22, train time 17.93 s
Epoch 46/50 |loss: 0.117923| train set 8.339x speedup, test set 0.818x speedup, val set 0.720x speedup, step: 23, train time 17.88 s
Epoch 47/50 |loss: 0.118352| train set 8.339x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 24, train time 17.92 s
Epoch 48/50 |loss: 0.116311| train set 8.339x speedup, test set 0.840x speedup, val set 0.714x speedup, step: 25, train time 17.91 s
Epoch 49/50 |loss: 0.116962| train set 8.339x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 26, train time 17.91 s
Training per epoch cost 17.840 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
23, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
24, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
25, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
26, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
27, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
28, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
29, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
30, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 21, train speedup 8.340, test speedup 0.693, val speedup 0.714
best test speedup epoch: 0, train speedup 8.275, test speedup 1.387, val speedup 0.720
best validation speedup epoch: 24, train speedup 8.184, test speedup 0.757, val speedup 0.816
last model at epoch 49, train speedup 8.339, test speedup 0.840, val speedup 0.720
execution cost 0:16:11.441503
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.156328, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.311773| train set 8.077x speedup, test set 0.703x speedup, val set 0.720x speedup, step: 1, train time 20.17 s
Epoch 1/50 |loss: 0.200294| train set 7.983x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2, train time 17.72 s
Epoch 2/50 |loss: 0.168516| train set 8.338x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 3, train time 17.62 s
Epoch 3/50 |loss: 0.155874| train set 8.136x speedup, test set 0.775x speedup, val set 0.720x speedup, step: 4, train time 17.75 s
Epoch 4/50 |loss: 0.155109| train set 7.991x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 1, train time 17.81 s
Epoch 5/50 |loss: 0.147897| train set 8.339x speedup, test set 0.703x speedup, val set 0.720x speedup, step: 2, train time 17.72 s
Epoch 6/50 |loss: 0.143891| train set 8.178x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 3, train time 17.62 s
Epoch 7/50 |loss: 0.145823| train set 8.339x speedup, test set 0.775x speedup, val set 0.824x speedup, step: 4, train time 17.81 s
Epoch 8/50 |loss: 0.141875| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 5, train time 17.72 s
Epoch 9/50 |loss: 0.132389| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 1, train time 17.62 s
Epoch 10/50 |loss: 0.134316| train set 8.178x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 2, train time 17.82 s
Epoch 11/50 |loss: 0.135451| train set 8.184x speedup, test set 0.722x speedup, val set 1.013x speedup, step: 3, train time 17.83 s
Epoch 12/50 |loss: 0.132687| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 4, train time 17.90 s
Epoch 13/50 |loss: 0.129655| train set 8.185x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 5, train time 17.71 s
Epoch 14/50 |loss: 0.128369| train set 8.185x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 1, train time 17.84 s
Epoch 15/50 |loss: 0.128366| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 2, train time 18.42 s
Epoch 16/50 |loss: 0.127315| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 3, train time 17.73 s
Epoch 17/50 |loss: 0.127120| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 4, train time 17.69 s
Epoch 18/50 |loss: 0.126201| train set 8.337x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 5, train time 17.73 s
Epoch 19/50 |loss: 0.128159| train set 8.337x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 1, train time 17.62 s
Epoch 20/50 |loss: 0.125807| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 2, train time 17.72 s
Epoch 21/50 |loss: 0.125613| train set 8.340x speedup, test set 0.703x speedup, val set 0.720x speedup, step: 3, train time 17.73 s
Epoch 22/50 |loss: 0.124040| train set 8.338x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 17.91 s
Epoch 23/50 |loss: 0.127285| train set 8.339x speedup, test set 0.703x speedup, val set 0.720x speedup, step: 5, train time 17.82 s
Epoch 24/50 |loss: 0.127258| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 1, train time 17.32 s
Epoch 25/50 |loss: 0.123434| train set 8.339x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 2, train time 17.23 s
Epoch 26/50 |loss: 0.124461| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 3, train time 17.40 s
Epoch 27/50 |loss: 0.122876| train set 8.339x speedup, test set 0.722x speedup, val set 0.720x speedup, step: 4, train time 17.52 s
Epoch 28/50 |loss: 0.121322| train set 7.819x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 5, train time 17.43 s
Epoch 29/50 |loss: 0.120304| train set 8.339x speedup, test set 0.783x speedup, val set 0.720x speedup, step: 6, train time 17.84 s
Epoch 30/50 |loss: 0.120936| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 7, train time 17.52 s
Epoch 31/50 |loss: 0.119415| train set 8.184x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 8, train time 17.74 s
Epoch 32/50 |loss: 0.120939| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 9, train time 17.52 s
Epoch 33/50 |loss: 0.121435| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 10, train time 17.55 s
Epoch 34/50 |loss: 0.119016| train set 8.339x speedup, test set 0.783x speedup, val set 0.720x speedup, step: 11, train time 17.54 s
Epoch 35/50 |loss: 0.120775| train set 8.337x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 12, train time 17.83 s
Epoch 36/50 |loss: 0.121835| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 13, train time 17.61 s
Epoch 37/50 |loss: 0.120161| train set 8.339x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 14, train time 17.43 s
Epoch 38/50 |loss: 0.118667| train set 8.338x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 15, train time 17.51 s
Epoch 39/50 |loss: 0.119563| train set 8.183x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 16, train time 17.71 s
Epoch 40/50 |loss: 0.120188| train set 8.339x speedup, test set 0.714x speedup, val set 0.720x speedup, step: 17, train time 18.02 s
early stopping at epoch 40
Training per epoch cost 17.751 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 21, train speedup 8.340, test speedup 0.703, val speedup 0.720
best test speedup epoch: 29, train speedup 8.339, test speedup 0.783, val speedup 0.720
best validation speedup epoch: 24, train speedup 8.339, test speedup 0.680, val speedup 0.824
last model at epoch 40, train speedup 8.339, test speedup 0.714, val speedup 0.720
execution cost 0:13:13.485699
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.983925, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.309595| train set 8.275x speedup, test set 1.568x speedup, val set 0.720x speedup, step: 1, train time 20.20 s
Epoch 1/50 |loss: 0.199172| train set 7.932x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 2, train time 17.72 s
Epoch 2/50 |loss: 0.169126| train set 8.339x speedup, test set 0.758x speedup, val set 0.720x speedup, step: 3, train time 17.72 s
Epoch 3/50 |loss: 0.156155| train set 8.137x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 17.92 s
Epoch 4/50 |loss: 0.155843| train set 7.991x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 1, train time 17.81 s
Epoch 5/50 |loss: 0.146326| train set 8.332x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 2, train time 17.62 s
Epoch 6/50 |loss: 0.142744| train set 8.178x speedup, test set 0.840x speedup, val set 0.714x speedup, step: 3, train time 17.65 s
Epoch 7/50 |loss: 0.142428| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 4, train time 17.53 s
Epoch 8/50 |loss: 0.139648| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 5, train time 17.61 s
Epoch 9/50 |loss: 0.132031| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 6, train time 17.60 s
Epoch 10/50 |loss: 0.133468| train set 8.178x speedup, test set 1.446x speedup, val set 1.013x speedup, step: 7, train time 17.70 s
Epoch 11/50 |loss: 0.133398| train set 8.185x speedup, test set 0.840x speedup, val set 1.000x speedup, step: 8, train time 17.91 s
Epoch 12/50 |loss: 0.131626| train set 8.184x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 9, train time 17.42 s
Epoch 13/50 |loss: 0.128827| train set 8.185x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 10, train time 17.52 s
Epoch 14/50 |loss: 0.128715| train set 8.185x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 1, train time 17.63 s
Epoch 15/50 |loss: 0.127645| train set 8.339x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 2, train time 18.02 s
Epoch 16/50 |loss: 0.128517| train set 8.339x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 3, train time 17.81 s
Epoch 17/50 |loss: 0.125639| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 17.71 s
Epoch 18/50 |loss: 0.125435| train set 8.337x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 5, train time 17.63 s
Epoch 19/50 |loss: 0.127712| train set 8.184x speedup, test set 0.718x speedup, val set 0.720x speedup, step: 6, train time 17.83 s
Epoch 20/50 |loss: 0.125548| train set 8.339x speedup, test set 0.754x speedup, val set 1.000x speedup, step: 7, train time 17.80 s
Epoch 21/50 |loss: 0.125127| train set 8.340x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 8, train time 17.71 s
Epoch 22/50 |loss: 0.123781| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 9, train time 17.81 s
Epoch 23/50 |loss: 0.126026| train set 8.337x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 10, train time 17.73 s
Epoch 24/50 |loss: 0.124506| train set 8.337x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 1, train time 17.91 s
Epoch 25/50 |loss: 0.122440| train set 8.184x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 2, train time 17.70 s
Epoch 26/50 |loss: 0.123884| train set 8.339x speedup, test set 0.788x speedup, val set 0.714x speedup, step: 3, train time 17.63 s
Epoch 27/50 |loss: 0.122193| train set 8.339x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 4, train time 17.83 s
Epoch 28/50 |loss: 0.120301| train set 7.819x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 5, train time 17.72 s
Epoch 29/50 |loss: 0.120272| train set 8.332x speedup, test set 0.775x speedup, val set 0.720x speedup, step: 6, train time 17.63 s
Epoch 30/50 |loss: 0.119913| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 7, train time 17.82 s
Epoch 31/50 |loss: 0.120829| train set 8.184x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 8, train time 17.50 s
Epoch 32/50 |loss: 0.120488| train set 8.332x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 9, train time 17.13 s
Epoch 33/50 |loss: 0.121272| train set 8.339x speedup, test set 0.754x speedup, val set 0.824x speedup, step: 10, train time 17.63 s
Epoch 34/50 |loss: 0.119010| train set 8.339x speedup, test set 0.775x speedup, val set 0.720x speedup, step: 11, train time 17.41 s
Epoch 35/50 |loss: 0.120804| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 12, train time 17.61 s
Epoch 36/50 |loss: 0.119798| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 13, train time 17.61 s
Epoch 37/50 |loss: 0.119812| train set 8.332x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 14, train time 17.61 s
Epoch 38/50 |loss: 0.119576| train set 8.337x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 15, train time 17.50 s
Epoch 39/50 |loss: 0.118912| train set 8.183x speedup, test set 0.788x speedup, val set 0.720x speedup, step: 16, train time 17.50 s
Epoch 40/50 |loss: 0.119434| train set 8.332x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 17, train time 17.42 s
Epoch 41/50 |loss: 0.117599| train set 8.184x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 18, train time 17.62 s
Epoch 42/50 |loss: 0.115994| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 19, train time 17.42 s
Epoch 43/50 |loss: 0.117999| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 20, train time 17.49 s
Epoch 44/50 |loss: 0.119209| train set 8.339x speedup, test set 0.818x speedup, val set 0.720x speedup, step: 21, train time 17.54 s
Epoch 45/50 |loss: 0.115847| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 22, train time 17.71 s
Epoch 46/50 |loss: 0.116633| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 23, train time 17.72 s
Epoch 47/50 |loss: 0.118018| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 24, train time 17.80 s
Epoch 48/50 |loss: 0.115624| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 25, train time 17.64 s
Epoch 49/50 |loss: 0.117135| train set 8.338x speedup, test set 1.346x speedup, val set 0.720x speedup, step: 26, train time 17.72 s
Training per epoch cost 17.709 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
32, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
33, opt runtime 6.888s, model runtime 6.888s, pg runtime 29.820s, speedup 4.329x
34, opt runtime 6.248s, model runtime 6.248s, pg runtime 19.123s, speedup 3.061x
35, opt runtime 5.874s, model runtime 5.874s, pg runtime 29.356s, speedup 4.998x
36, opt runtime 11.830s, model runtime 23.790s, pg runtime 20.360s, speedup 0.856x
37, opt runtime 7.469s, model runtime 7.469s, pg runtime 23.223s, speedup 3.109x
38, opt runtime 7.662s, model runtime 12.827s, pg runtime 15.898s, speedup 1.239x
39, opt runtime 7.867s, model runtime 7.870s, pg runtime 24.303s, speedup 3.088x
40, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
====================
best train speedup epoch: 21, train speedup 8.340, test speedup 0.747, val speedup 0.720
best test speedup epoch: 0, train speedup 8.275, test speedup 1.568, val speedup 0.720
best validation speedup epoch: 24, train speedup 8.337, test speedup 0.747, val speedup 1.013
last model at epoch 49, train speedup 8.338, test speedup 1.346, val speedup 0.720
execution cost 0:16:04.006300
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.713599, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.310564| train set 8.275x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 1, train time 18.35 s
Epoch 1/50 |loss: 0.198294| train set 7.991x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 2, train time 16.62 s
Epoch 2/50 |loss: 0.170084| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 3, train time 16.53 s
Epoch 3/50 |loss: 0.155982| train set 8.137x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 16.71 s
Epoch 4/50 |loss: 0.154681| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 1, train time 16.52 s
Epoch 5/50 |loss: 0.146157| train set 8.332x speedup, test set 0.775x speedup, val set 0.714x speedup, step: 2, train time 16.62 s
Epoch 6/50 |loss: 0.143043| train set 8.188x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 3, train time 16.52 s
Epoch 7/50 |loss: 0.143482| train set 8.339x speedup, test set 0.708x speedup, val set 0.714x speedup, step: 4, train time 16.60 s
Epoch 8/50 |loss: 0.141550| train set 8.332x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 5, train time 16.60 s
Epoch 9/50 |loss: 0.130703| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 1, train time 16.51 s
Epoch 10/50 |loss: 0.135141| train set 8.178x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 2, train time 16.51 s
Epoch 11/50 |loss: 0.135908| train set 8.184x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 3, train time 16.51 s
Epoch 12/50 |loss: 0.133109| train set 8.184x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 4, train time 16.51 s
Epoch 13/50 |loss: 0.129722| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 5, train time 16.73 s
Epoch 14/50 |loss: 0.129144| train set 8.185x speedup, test set 0.693x speedup, val set 0.816x speedup, step: 1, train time 16.42 s
Epoch 15/50 |loss: 0.127153| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 2, train time 16.88 s
Epoch 16/50 |loss: 0.127529| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 3, train time 16.62 s
Epoch 17/50 |loss: 0.126528| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 4, train time 16.52 s
Epoch 18/50 |loss: 0.125485| train set 8.337x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 5, train time 16.62 s
Epoch 19/50 |loss: 0.128201| train set 8.183x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 6, train time 16.40 s
Epoch 20/50 |loss: 0.125985| train set 8.339x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 7, train time 16.63 s
Epoch 21/50 |loss: 0.125311| train set 8.340x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 8, train time 16.61 s
Epoch 22/50 |loss: 0.124220| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 9, train time 16.53 s
Epoch 23/50 |loss: 0.125722| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 10, train time 16.53 s
Epoch 24/50 |loss: 0.124958| train set 8.183x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 1, train time 16.42 s
Epoch 25/50 |loss: 0.121544| train set 8.184x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 2, train time 16.62 s
Epoch 26/50 |loss: 0.123573| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 3, train time 16.41 s
Epoch 27/50 |loss: 0.122204| train set 8.339x speedup, test set 0.738x speedup, val set 1.000x speedup, step: 4, train time 16.63 s
Epoch 28/50 |loss: 0.120884| train set 7.682x speedup, test set 0.736x speedup, val set 0.714x speedup, step: 5, train time 16.51 s
Epoch 29/50 |loss: 0.120097| train set 8.339x speedup, test set 0.710x speedup, val set 0.714x speedup, step: 6, train time 16.62 s
Epoch 30/50 |loss: 0.120987| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 7, train time 16.52 s
Epoch 31/50 |loss: 0.119171| train set 8.184x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 8, train time 16.51 s
Epoch 32/50 |loss: 0.121044| train set 8.332x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 9, train time 16.60 s
Epoch 33/50 |loss: 0.121434| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 10, train time 16.60 s
Epoch 34/50 |loss: 0.118560| train set 8.339x speedup, test set 0.783x speedup, val set 0.720x speedup, step: 11, train time 16.53 s
Epoch 35/50 |loss: 0.120317| train set 8.184x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 12, train time 16.72 s
Epoch 36/50 |loss: 0.120755| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 13, train time 16.92 s
Epoch 37/50 |loss: 0.119112| train set 8.339x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 14, train time 17.01 s
Epoch 38/50 |loss: 0.120099| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 15, train time 16.99 s
Epoch 39/50 |loss: 0.119346| train set 8.184x speedup, test set 0.726x speedup, val set 0.714x speedup, step: 16, train time 16.92 s
Epoch 40/50 |loss: 0.121100| train set 8.339x speedup, test set 0.818x speedup, val set 0.720x speedup, step: 17, train time 16.90 s
early stopping at epoch 40
Training per epoch cost 16.659 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 21, train speedup 8.340, test speedup 0.680, val speedup 0.714
best test speedup epoch: 40, train speedup 8.339, test speedup 0.818, val speedup 0.720
best validation speedup epoch: 24, train speedup 8.183, test speedup 0.680, val speedup 0.816
last model at epoch 40, train speedup 8.339, test speedup 0.818, val speedup 0.720
execution cost 0:12:19.482190
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.170143, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.309965| train set 7.744x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 1, train time 20.14 s
Epoch 1/50 |loss: 0.201506| train set 7.991x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 2, train time 17.91 s
Epoch 2/50 |loss: 0.168687| train set 8.339x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 3, train time 17.90 s
Epoch 3/50 |loss: 0.158568| train set 8.136x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 4, train time 17.91 s
Epoch 4/50 |loss: 0.156852| train set 8.183x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 1, train time 17.81 s
Epoch 5/50 |loss: 0.149349| train set 8.332x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 2, train time 17.82 s
Epoch 6/50 |loss: 0.143154| train set 8.185x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 3, train time 17.62 s
Epoch 7/50 |loss: 0.143772| train set 8.339x speedup, test set 0.747x speedup, val set 0.816x speedup, step: 4, train time 17.75 s
Epoch 8/50 |loss: 0.141288| train set 8.332x speedup, test set 0.754x speedup, val set 0.714x speedup, step: 5, train time 17.70 s
Epoch 9/50 |loss: 0.132502| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 1, train time 17.83 s
Epoch 10/50 |loss: 0.134071| train set 8.178x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 2, train time 17.62 s
Epoch 11/50 |loss: 0.134685| train set 8.185x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 3, train time 17.52 s
Epoch 12/50 |loss: 0.133099| train set 8.184x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 4, train time 17.55 s
Epoch 13/50 |loss: 0.129789| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 5, train time 17.92 s
Epoch 14/50 |loss: 0.129460| train set 8.184x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 1, train time 17.72 s
Epoch 15/50 |loss: 0.129115| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 2, train time 18.20 s
Epoch 16/50 |loss: 0.127033| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 3, train time 17.63 s
Epoch 17/50 |loss: 0.127638| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 4, train time 17.75 s
Epoch 18/50 |loss: 0.125207| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 5, train time 17.73 s
Epoch 19/50 |loss: 0.128785| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 1, train time 17.80 s
Epoch 20/50 |loss: 0.125647| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 2, train time 17.78 s
Epoch 21/50 |loss: 0.124774| train set 8.340x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 3, train time 17.62 s
Epoch 22/50 |loss: 0.123943| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 4, train time 17.73 s
Epoch 23/50 |loss: 0.126989| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 5, train time 17.74 s
Epoch 24/50 |loss: 0.125901| train set 8.184x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 1, train time 17.55 s
Epoch 25/50 |loss: 0.121932| train set 8.184x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 2, train time 17.81 s
Epoch 26/50 |loss: 0.123374| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 3, train time 17.72 s
Epoch 27/50 |loss: 0.123008| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 4, train time 17.83 s
Epoch 28/50 |loss: 0.121633| train set 8.339x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 5, train time 17.85 s
Epoch 29/50 |loss: 0.119779| train set 8.339x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 1, train time 17.71 s
Epoch 30/50 |loss: 0.121249| train set 8.337x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 2, train time 17.71 s
Epoch 31/50 |loss: 0.119875| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 3, train time 17.81 s
Epoch 32/50 |loss: 0.121141| train set 8.339x speedup, test set 0.736x speedup, val set 0.720x speedup, step: 4, train time 17.93 s
Epoch 33/50 |loss: 0.121756| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 5, train time 17.65 s
Epoch 34/50 |loss: 0.118063| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 6, train time 17.91 s
Epoch 35/50 |loss: 0.120742| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 7, train time 17.72 s
Epoch 36/50 |loss: 0.120018| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 8, train time 17.72 s
Epoch 37/50 |loss: 0.119592| train set 8.339x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 9, train time 17.83 s
Epoch 38/50 |loss: 0.119441| train set 8.337x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 10, train time 17.83 s
Epoch 39/50 |loss: 0.119548| train set 8.183x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 11, train time 17.70 s
Epoch 40/50 |loss: 0.119681| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 12, train time 17.53 s
Epoch 41/50 |loss: 0.118218| train set 8.184x speedup, test set 0.738x speedup, val set 0.720x speedup, step: 13, train time 17.13 s
Epoch 42/50 |loss: 0.116727| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 14, train time 17.60 s
Epoch 43/50 |loss: 0.117493| train set 8.332x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 15, train time 17.55 s
Epoch 44/50 |loss: 0.119065| train set 8.340x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 16, train time 17.72 s
Epoch 45/50 |loss: 0.115707| train set 8.339x speedup, test set 0.818x speedup, val set 0.720x speedup, step: 17, train time 17.71 s
Epoch 46/50 |loss: 0.117612| train set 8.332x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 18, train time 17.89 s
Epoch 47/50 |loss: 0.118231| train set 8.339x speedup, test set 0.668x speedup, val set 0.720x speedup, step: 19, train time 17.83 s
Epoch 48/50 |loss: 0.116035| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 20, train time 17.87 s
Epoch 49/50 |loss: 0.117413| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 21, train time 17.72 s
Training per epoch cost 17.791 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 21, train speedup 8.340, test speedup 0.693, val speedup 0.714
best test speedup epoch: 2, train speedup 8.339, test speedup 1.299, val speedup 0.720
best validation speedup epoch: 29, train speedup 8.339, test speedup 0.693, val speedup 0.824
last model at epoch 49, train speedup 8.339, test speedup 0.686, val speedup 0.720
execution cost 0:16:09.121908
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.183440, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.309186| train set 8.257x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 1, train time 20.34 s
Epoch 1/50 |loss: 0.204813| train set 7.932x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 2, train time 17.99 s
Epoch 2/50 |loss: 0.170100| train set 8.332x speedup, test set 0.689x speedup, val set 0.720x speedup, step: 3, train time 17.94 s
Epoch 3/50 |loss: 0.155251| train set 8.137x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 4, train time 17.83 s
Epoch 4/50 |loss: 0.155227| train set 7.991x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 1, train time 17.81 s
Epoch 5/50 |loss: 0.147790| train set 8.177x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 2, train time 17.71 s
Epoch 6/50 |loss: 0.141847| train set 8.185x speedup, test set 0.757x speedup, val set 0.714x speedup, step: 3, train time 17.73 s
Epoch 7/50 |loss: 0.143087| train set 8.339x speedup, test set 0.685x speedup, val set 0.714x speedup, step: 4, train time 17.62 s
Epoch 8/50 |loss: 0.140729| train set 8.328x speedup, test set 0.783x speedup, val set 0.714x speedup, step: 5, train time 17.75 s
Epoch 9/50 |loss: 0.133498| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 1, train time 17.89 s
Epoch 10/50 |loss: 0.133589| train set 8.175x speedup, test set 0.686x speedup, val set 0.816x speedup, step: 2, train time 17.72 s
Epoch 11/50 |loss: 0.134949| train set 8.185x speedup, test set 0.757x speedup, val set 0.816x speedup, step: 3, train time 17.77 s
Epoch 12/50 |loss: 0.133531| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 4, train time 17.61 s
Epoch 13/50 |loss: 0.129389| train set 8.185x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 5, train time 17.80 s
Epoch 14/50 |loss: 0.129111| train set 8.185x speedup, test set 0.722x speedup, val set 0.816x speedup, step: 1, train time 17.72 s
Epoch 15/50 |loss: 0.128901| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 2, train time 17.82 s
Epoch 16/50 |loss: 0.128297| train set 8.339x speedup, test set 0.686x speedup, val set 0.720x speedup, step: 3, train time 17.71 s
Epoch 17/50 |loss: 0.127995| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 4, train time 17.42 s
Epoch 18/50 |loss: 0.126860| train set 8.339x speedup, test set 0.686x speedup, val set 0.714x speedup, step: 5, train time 17.68 s
Epoch 19/50 |loss: 0.129282| train set 8.338x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 6, train time 17.64 s
Epoch 20/50 |loss: 0.124561| train set 8.339x speedup, test set 0.686x speedup, val set 1.000x speedup, step: 7, train time 17.71 s
Epoch 21/50 |loss: 0.125088| train set 8.340x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 8, train time 17.91 s
Epoch 22/50 |loss: 0.125670| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 9, train time 17.90 s
Epoch 23/50 |loss: 0.126880| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 10, train time 17.81 s
Epoch 24/50 |loss: 0.124796| train set 8.183x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 11, train time 17.72 s
Epoch 25/50 |loss: 0.121883| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 12, train time 17.82 s
Epoch 26/50 |loss: 0.124484| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 13, train time 17.84 s
Epoch 27/50 |loss: 0.123040| train set 8.339x speedup, test set 0.714x speedup, val set 0.720x speedup, step: 14, train time 17.54 s
Epoch 28/50 |loss: 0.121767| train set 7.819x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 15, train time 17.81 s
Epoch 29/50 |loss: 0.119683| train set 8.332x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 16, train time 17.72 s
Epoch 30/50 |loss: 0.120840| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 17, train time 17.82 s
Epoch 31/50 |loss: 0.119664| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 18, train time 17.63 s
Epoch 32/50 |loss: 0.121372| train set 8.332x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 19, train time 17.73 s
Epoch 33/50 |loss: 0.121818| train set 8.339x speedup, test set 0.680x speedup, val set 0.824x speedup, step: 20, train time 17.81 s
Epoch 34/50 |loss: 0.119403| train set 8.339x speedup, test set 0.703x speedup, val set 0.720x speedup, step: 21, train time 17.72 s
Epoch 35/50 |loss: 0.121282| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 22, train time 17.80 s
Epoch 36/50 |loss: 0.121776| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 23, train time 18.00 s
Epoch 37/50 |loss: 0.120399| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 24, train time 17.71 s
Epoch 38/50 |loss: 0.119242| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 25, train time 17.20 s
Epoch 39/50 |loss: 0.118184| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 26, train time 14.71 s
Epoch 40/50 |loss: 0.120620| train set 8.332x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 27, train time 13.73 s
Epoch 41/50 |loss: 0.117917| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 28, train time 17.69 s
Epoch 42/50 |loss: 0.117361| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 29, train time 17.85 s
Epoch 43/50 |loss: 0.118922| train set 8.339x speedup, test set 0.685x speedup, val set 0.720x speedup, step: 30, train time 18.04 s
Epoch 44/50 |loss: 0.118728| train set 8.340x speedup, test set 0.685x speedup, val set 0.720x speedup, step: 31, train time 17.73 s
Epoch 45/50 |loss: 0.115687| train set 8.339x speedup, test set 0.685x speedup, val set 0.720x speedup, step: 32, train time 17.73 s
Epoch 46/50 |loss: 0.118379| train set 8.332x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 33, train time 17.83 s
Epoch 47/50 |loss: 0.118370| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 34, train time 17.91 s
Epoch 48/50 |loss: 0.116630| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 35, train time 17.91 s
Epoch 49/50 |loss: 0.116035| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 36, train time 17.84 s
Training per epoch cost 17.673 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
23, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
24, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
25, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 21, train speedup 8.340, test speedup 0.680, val speedup 0.720
best test speedup epoch: 0, train speedup 8.257, test speedup 1.299, val speedup 0.720
best validation speedup epoch: 14, train speedup 8.185, test speedup 0.722, val speedup 0.816
last model at epoch 49, train speedup 8.339, test speedup 0.680, val speedup 0.720
execution cost 0:16:01.433914
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.205303, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.308902| train set 8.077x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 1, train time 20.21 s
Epoch 1/50 |loss: 0.200703| train set 7.991x speedup, test set 0.728x speedup, val set 0.714x speedup, step: 2, train time 18.03 s
Epoch 2/50 |loss: 0.167241| train set 8.332x speedup, test set 1.065x speedup, val set 0.720x speedup, step: 3, train time 17.83 s
Epoch 3/50 |loss: 0.156409| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 17.80 s
Epoch 4/50 |loss: 0.156365| train set 8.183x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 1, train time 17.81 s
Epoch 5/50 |loss: 0.146710| train set 8.332x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 2, train time 17.70 s
Epoch 6/50 |loss: 0.142366| train set 8.185x speedup, test set 0.840x speedup, val set 0.714x speedup, step: 3, train time 17.73 s
Epoch 7/50 |loss: 0.145100| train set 8.339x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 4, train time 17.91 s
Epoch 8/50 |loss: 0.140702| train set 8.332x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 5, train time 17.53 s
Epoch 9/50 |loss: 0.133495| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 6, train time 17.71 s
Epoch 10/50 |loss: 0.133250| train set 8.185x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 7, train time 17.73 s
Epoch 11/50 |loss: 0.135151| train set 8.184x speedup, test set 0.757x speedup, val set 1.013x speedup, step: 8, train time 17.82 s
Epoch 12/50 |loss: 0.132667| train set 8.185x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 9, train time 17.82 s
Epoch 13/50 |loss: 0.129841| train set 8.340x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 10, train time 17.95 s
Epoch 14/50 |loss: 0.128684| train set 8.185x speedup, test set 0.714x speedup, val set 0.714x speedup, step: 11, train time 17.92 s
Epoch 15/50 |loss: 0.128005| train set 8.339x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 12, train time 18.33 s
Epoch 16/50 |loss: 0.127732| train set 8.339x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 13, train time 17.81 s
Epoch 17/50 |loss: 0.127782| train set 8.184x speedup, test set 0.680x speedup, val set 0.720x speedup, step: 14, train time 17.82 s
Epoch 18/50 |loss: 0.125728| train set 8.337x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 15, train time 18.00 s
Epoch 19/50 |loss: 0.127327| train set 8.339x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 1, train time 18.12 s
Epoch 20/50 |loss: 0.126110| train set 8.339x speedup, test set 0.747x speedup, val set 1.013x speedup, step: 2, train time 17.82 s
Epoch 21/50 |loss: 0.124597| train set 8.340x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 3, train time 17.82 s
Epoch 22/50 |loss: 0.123299| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 17.90 s
Epoch 23/50 |loss: 0.126890| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 5, train time 17.88 s
Epoch 24/50 |loss: 0.125932| train set 8.183x speedup, test set 0.693x speedup, val set 0.824x speedup, step: 1, train time 17.82 s
Epoch 25/50 |loss: 0.122471| train set 8.184x speedup, test set 0.818x speedup, val set 0.720x speedup, step: 2, train time 17.90 s
Epoch 26/50 |loss: 0.122739| train set 8.339x speedup, test set 0.788x speedup, val set 0.720x speedup, step: 3, train time 18.03 s
Epoch 27/50 |loss: 0.122205| train set 8.339x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 4, train time 17.90 s
Epoch 28/50 |loss: 0.120997| train set 7.683x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 5, train time 17.89 s
Epoch 29/50 |loss: 0.119876| train set 8.339x speedup, test set 0.754x speedup, val set 0.720x speedup, step: 6, train time 17.84 s
Epoch 30/50 |loss: 0.121358| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 7, train time 17.73 s
Epoch 31/50 |loss: 0.118938| train set 8.184x speedup, test set 0.693x speedup, val set 0.720x speedup, step: 8, train time 17.31 s
Epoch 32/50 |loss: 0.120807| train set 8.339x speedup, test set 0.829x speedup, val set 0.720x speedup, step: 9, train time 17.33 s
Epoch 33/50 |loss: 0.120796| train set 8.184x speedup, test set 0.693x speedup, val set 1.013x speedup, step: 10, train time 17.64 s
Epoch 34/50 |loss: 0.118033| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 11, train time 17.74 s
Epoch 35/50 |loss: 0.121577| train set 8.337x speedup, test set 0.788x speedup, val set 0.720x speedup, step: 12, train time 17.92 s
Epoch 36/50 |loss: 0.121280| train set 8.338x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 13, train time 17.83 s
Epoch 37/50 |loss: 0.119717| train set 8.339x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 14, train time 18.00 s
Epoch 38/50 |loss: 0.118536| train set 8.337x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 15, train time 18.12 s
Epoch 39/50 |loss: 0.118186| train set 8.183x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 16, train time 17.92 s
Epoch 40/50 |loss: 0.119319| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 17, train time 17.93 s
Epoch 41/50 |loss: 0.117373| train set 8.184x speedup, test set 0.829x speedup, val set 0.720x speedup, step: 18, train time 17.84 s
Epoch 42/50 |loss: 0.116667| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 19, train time 17.96 s
Epoch 43/50 |loss: 0.117761| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 20, train time 17.91 s
Epoch 44/50 |loss: 0.118428| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 21, train time 17.95 s
Epoch 45/50 |loss: 0.116452| train set 8.339x speedup, test set 0.745x speedup, val set 0.720x speedup, step: 22, train time 17.91 s
Epoch 46/50 |loss: 0.117977| train set 8.332x speedup, test set 0.749x speedup, val set 0.720x speedup, step: 23, train time 18.03 s
Epoch 47/50 |loss: 0.118281| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 24, train time 17.91 s
Epoch 48/50 |loss: 0.115375| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 25, train time 18.09 s
Epoch 49/50 |loss: 0.116107| train set 8.339x speedup, test set 0.788x speedup, val set 0.720x speedup, step: 26, train time 17.72 s
Training per epoch cost 17.903 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 13, train speedup 8.340, test speedup 0.747, val speedup 0.720
best test speedup epoch: 2, train speedup 8.332, test speedup 1.065, val speedup 0.720
best validation speedup epoch: 24, train speedup 8.183, test speedup 0.693, val speedup 0.824
last model at epoch 49, train speedup 8.339, test speedup 0.788, val speedup 0.720
execution cost 0:16:13.918380
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.181487, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.309420| train set 7.926x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 1, train time 19.81 s
Epoch 1/50 |loss: 0.201213| train set 7.974x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 2, train time 17.02 s
Epoch 2/50 |loss: 0.171441| train set 8.339x speedup, test set 0.758x speedup, val set 0.720x speedup, step: 3, train time 16.92 s
Epoch 3/50 |loss: 0.157422| train set 8.337x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 17.13 s
Epoch 4/50 |loss: 0.154876| train set 8.184x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 1, train time 17.01 s
Epoch 5/50 |loss: 0.147985| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 2, train time 16.99 s
Epoch 6/50 |loss: 0.143423| train set 8.184x speedup, test set 0.825x speedup, val set 1.000x speedup, step: 3, train time 16.93 s
Epoch 7/50 |loss: 0.144948| train set 8.339x speedup, test set 0.685x speedup, val set 1.000x speedup, step: 4, train time 17.01 s
Epoch 8/50 |loss: 0.142029| train set 8.332x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 5, train time 16.91 s
Epoch 9/50 |loss: 0.132676| train set 8.339x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 1, train time 17.02 s
Epoch 10/50 |loss: 0.132659| train set 8.184x speedup, test set 0.747x speedup, val set 1.000x speedup, step: 2, train time 16.98 s
Epoch 11/50 |loss: 0.134868| train set 8.339x speedup, test set 0.840x speedup, val set 1.000x speedup, step: 3, train time 17.00 s
Epoch 12/50 |loss: 0.132782| train set 8.183x speedup, test set 0.818x speedup, val set 1.000x speedup, step: 4, train time 16.82 s
Epoch 13/50 |loss: 0.130165| train set 8.184x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 5, train time 17.23 s
Epoch 14/50 |loss: 0.129074| train set 8.185x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 6, train time 16.99 s
Epoch 15/50 |loss: 0.127955| train set 8.339x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 7, train time 17.60 s
Epoch 16/50 |loss: 0.128110| train set 8.339x speedup, test set 0.693x speedup, val set 0.714x speedup, step: 8, train time 17.02 s
Epoch 17/50 |loss: 0.126800| train set 8.339x speedup, test set 0.818x speedup, val set 0.714x speedup, step: 9, train time 17.01 s
Epoch 18/50 |loss: 0.128464| train set 8.337x speedup, test set 0.788x speedup, val set 0.714x speedup, step: 10, train time 17.02 s
Epoch 19/50 |loss: 0.128423| train set 8.183x speedup, test set 0.754x speedup, val set 0.714x speedup, step: 11, train time 16.92 s
Epoch 20/50 |loss: 0.125962| train set 8.339x speedup, test set 0.693x speedup, val set 1.000x speedup, step: 12, train time 17.09 s
Epoch 21/50 |loss: 0.125819| train set 8.340x speedup, test set 0.714x speedup, val set 0.714x speedup, step: 13, train time 17.03 s
Epoch 22/50 |loss: 0.124744| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 14, train time 17.02 s
Epoch 23/50 |loss: 0.126135| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 15, train time 17.28 s
Epoch 24/50 |loss: 0.125773| train set 8.337x speedup, test set 0.680x speedup, val set 0.816x speedup, step: 16, train time 17.02 s
Epoch 25/50 |loss: 0.121776| train set 8.184x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 17, train time 16.71 s
Epoch 26/50 |loss: 0.123603| train set 8.339x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 18, train time 16.62 s
Epoch 27/50 |loss: 0.122522| train set 8.339x speedup, test set 0.757x speedup, val set 1.000x speedup, step: 19, train time 16.69 s
Epoch 28/50 |loss: 0.121710| train set 7.682x speedup, test set 0.840x speedup, val set 0.714x speedup, step: 20, train time 16.62 s
Epoch 29/50 |loss: 0.120164| train set 8.339x speedup, test set 0.829x speedup, val set 0.714x speedup, step: 21, train time 16.72 s
Epoch 30/50 |loss: 0.121143| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 22, train time 16.61 s
Epoch 31/50 |loss: 0.119118| train set 8.339x speedup, test set 0.754x speedup, val set 0.714x speedup, step: 23, train time 16.90 s
Epoch 32/50 |loss: 0.121478| train set 8.332x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 24, train time 16.63 s
Epoch 33/50 |loss: 0.122038| train set 8.339x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 25, train time 16.72 s
Epoch 34/50 |loss: 0.118455| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 26, train time 16.61 s
Epoch 35/50 |loss: 0.120956| train set 8.184x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 27, train time 16.83 s
Epoch 36/50 |loss: 0.121293| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 28, train time 16.72 s
Epoch 37/50 |loss: 0.120210| train set 8.332x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 29, train time 16.71 s
Epoch 38/50 |loss: 0.119083| train set 8.339x speedup, test set 0.840x speedup, val set 0.720x speedup, step: 30, train time 16.82 s
Epoch 39/50 |loss: 0.119254| train set 8.183x speedup, test set 0.805x speedup, val set 0.720x speedup, step: 31, train time 16.72 s
Epoch 40/50 |loss: 0.120473| train set 8.339x speedup, test set 0.757x speedup, val set 0.720x speedup, step: 32, train time 16.81 s
early stopping at epoch 40
Training per epoch cost 16.981 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
32, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
33, opt runtime 6.888s, model runtime 6.888s, pg runtime 29.820s, speedup 4.329x
34, opt runtime 6.248s, model runtime 6.248s, pg runtime 19.123s, speedup 3.061x
35, opt runtime 5.874s, model runtime 5.874s, pg runtime 29.356s, speedup 4.998x
36, opt runtime 11.830s, model runtime 23.790s, pg runtime 20.360s, speedup 0.856x
37, opt runtime 7.469s, model runtime 7.469s, pg runtime 23.223s, speedup 3.109x
38, opt runtime 7.662s, model runtime 12.827s, pg runtime 15.898s, speedup 1.239x
39, opt runtime 7.867s, model runtime 7.870s, pg runtime 24.303s, speedup 3.088x
40, opt runtime 7.565s, model runtime 7.565s, pg runtime 20.255s, speedup 2.678x
====================
best train speedup epoch: 21, train speedup 8.340, test speedup 0.714, val speedup 0.714
best test speedup epoch: 0, train speedup 7.926, test speedup 1.299, val speedup 0.720
best validation speedup epoch: 9, train speedup 8.339, test speedup 0.747, val speedup 1.000
last model at epoch 40, train speedup 8.339, test speedup 0.757, val speedup 0.720
execution cost 0:12:35.252462
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [5, 1, 10, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.205387, and there are 14360 training samples
in channel 9
Epoch 0/50 |loss: 0.309087| train set 8.077x speedup, test set 1.299x speedup, val set 0.720x speedup, step: 1, train time 20.11 s
Epoch 1/50 |loss: 0.200670| train set 7.991x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 2, train time 17.60 s
Epoch 2/50 |loss: 0.170257| train set 8.339x speedup, test set 0.747x speedup, val set 0.824x speedup, step: 3, train time 17.54 s
Epoch 3/50 |loss: 0.156393| train set 8.136x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 4, train time 17.43 s
Epoch 4/50 |loss: 0.155309| train set 8.184x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 1, train time 17.47 s
Epoch 5/50 |loss: 0.148614| train set 8.184x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 2, train time 17.50 s
Epoch 6/50 |loss: 0.142202| train set 8.185x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 3, train time 17.31 s
Epoch 7/50 |loss: 0.142197| train set 8.339x speedup, test set 0.685x speedup, val set 0.714x speedup, step: 4, train time 17.73 s
Epoch 8/50 |loss: 0.139715| train set 8.332x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 5, train time 17.74 s
Epoch 9/50 |loss: 0.132092| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 1, train time 17.83 s
Epoch 10/50 |loss: 0.134256| train set 8.177x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 2, train time 17.80 s
Epoch 11/50 |loss: 0.135032| train set 8.339x speedup, test set 0.762x speedup, val set 1.000x speedup, step: 3, train time 18.11 s
Epoch 12/50 |loss: 0.133561| train set 8.183x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 4, train time 17.93 s
Epoch 13/50 |loss: 0.129750| train set 8.185x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 5, train time 17.83 s
Epoch 14/50 |loss: 0.128819| train set 8.185x speedup, test set 0.693x speedup, val set 0.816x speedup, step: 1, train time 18.02 s
Epoch 15/50 |loss: 0.127100| train set 8.339x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 2, train time 18.40 s
Epoch 16/50 |loss: 0.127584| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 3, train time 17.98 s
Epoch 17/50 |loss: 0.125818| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 4, train time 18.10 s
Epoch 18/50 |loss: 0.125457| train set 8.337x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 5, train time 17.91 s
Epoch 19/50 |loss: 0.127532| train set 8.185x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 6, train time 17.82 s
Epoch 20/50 |loss: 0.125390| train set 8.339x speedup, test set 0.754x speedup, val set 1.000x speedup, step: 7, train time 17.80 s
Epoch 21/50 |loss: 0.124374| train set 8.337x speedup, test set 0.680x speedup, val set 0.714x speedup, step: 8, train time 17.91 s
Epoch 22/50 |loss: 0.123574| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 9, train time 17.94 s
Epoch 23/50 |loss: 0.125763| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 10, train time 17.92 s
Epoch 24/50 |loss: 0.125564| train set 8.183x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 11, train time 17.82 s
Epoch 25/50 |loss: 0.122643| train set 8.184x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 12, train time 17.71 s
Epoch 26/50 |loss: 0.123032| train set 8.339x speedup, test set 0.754x speedup, val set 0.714x speedup, step: 13, train time 17.91 s
Epoch 27/50 |loss: 0.121688| train set 8.339x speedup, test set 0.754x speedup, val set 0.714x speedup, step: 14, train time 17.99 s
Epoch 28/50 |loss: 0.120556| train set 7.819x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 15, train time 18.12 s
Epoch 29/50 |loss: 0.119643| train set 8.339x speedup, test set 0.754x speedup, val set 0.714x speedup, step: 16, train time 17.84 s
Epoch 30/50 |loss: 0.121631| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 17, train time 17.43 s
Epoch 31/50 |loss: 0.119283| train set 8.339x speedup, test set 0.754x speedup, val set 0.714x speedup, step: 18, train time 17.81 s
Epoch 32/50 |loss: 0.120390| train set 8.339x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 19, train time 18.05 s
Epoch 33/50 |loss: 0.121401| train set 8.339x speedup, test set 0.747x speedup, val set 0.816x speedup, step: 20, train time 18.03 s
Epoch 34/50 |loss: 0.118751| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 21, train time 17.93 s
Epoch 35/50 |loss: 0.120269| train set 8.183x speedup, test set 0.754x speedup, val set 0.714x speedup, step: 22, train time 18.13 s
Epoch 36/50 |loss: 0.121542| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 23, train time 18.01 s
Epoch 37/50 |loss: 0.119382| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 24, train time 18.12 s
Epoch 38/50 |loss: 0.118141| train set 8.338x speedup, test set 0.762x speedup, val set 0.714x speedup, step: 25, train time 18.11 s
Epoch 39/50 |loss: 0.118527| train set 8.337x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 26, train time 18.02 s
Epoch 40/50 |loss: 0.119456| train set 8.339x speedup, test set 0.762x speedup, val set 0.720x speedup, step: 27, train time 18.04 s
Epoch 41/50 |loss: 0.117140| train set 8.184x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 28, train time 18.12 s
Epoch 42/50 |loss: 0.116934| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 29, train time 18.00 s
Epoch 43/50 |loss: 0.117742| train set 8.339x speedup, test set 0.788x speedup, val set 0.714x speedup, step: 30, train time 18.01 s
Epoch 44/50 |loss: 0.118652| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 31, train time 18.24 s
Epoch 45/50 |loss: 0.115636| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 32, train time 17.93 s
Epoch 46/50 |loss: 0.116825| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 33, train time 18.23 s
Epoch 47/50 |loss: 0.118508| train set 8.339x speedup, test set 0.747x speedup, val set 0.720x speedup, step: 34, train time 18.22 s
Epoch 48/50 |loss: 0.116723| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 35, train time 18.13 s
Epoch 49/50 |loss: 0.115914| train set 8.339x speedup, test set 0.747x speedup, val set 0.714x speedup, step: 36, train time 18.02 s
Training per epoch cost 17.954 s
Optimal speedup on test set is 1.793x
01, opt runtime 26.072s, model runtime 26.072s, pg runtime 26.072s, speedup 1.000x
02, opt runtime 29.200s, model runtime 29.200s, pg runtime 29.200s, speedup 1.000x
03, opt runtime 25.356s, model runtime 25.356s, pg runtime 25.356s, speedup 1.000x
04, opt runtime 24.220s, model runtime 24.220s, pg runtime 24.220s, speedup 1.000x
05, opt runtime 18.665s, model runtime 18.665s, pg runtime 18.665s, speedup 1.000x
06, opt runtime 30.353s, model runtime 30.353s, pg runtime 30.353s, speedup 1.000x
07, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
08, opt runtime 18.955s, model runtime 18.955s, pg runtime 18.955s, speedup 1.000x
09, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
10, opt runtime 20.460s, model runtime 20.460s, pg runtime 20.460s, speedup 1.000x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
22, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
23, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
24, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
25, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
26, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
27, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
28, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
29, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
30, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
31, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
32, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
33, opt runtime 6.888s, model runtime 25.761s, pg runtime 29.820s, speedup 1.158x
34, opt runtime 6.248s, model runtime 22.424s, pg runtime 19.123s, speedup 0.853x
35, opt runtime 5.874s, model runtime 33.655s, pg runtime 29.356s, speedup 0.872x
36, opt runtime 11.830s, model runtime 40.939s, pg runtime 20.360s, speedup 0.497x
37, opt runtime 7.469s, model runtime 23.737s, pg runtime 23.223s, speedup 0.978x
38, opt runtime 7.662s, model runtime 40.441s, pg runtime 15.898s, speedup 0.393x
39, opt runtime 7.867s, model runtime 29.728s, pg runtime 24.303s, speedup 0.818x
40, opt runtime 7.565s, model runtime 29.575s, pg runtime 20.255s, speedup 0.685x
====================
best train speedup epoch: 2, train speedup 8.339, test speedup 0.747, val speedup 0.824
best test speedup epoch: 0, train speedup 8.077, test speedup 1.299, val speedup 0.720
best validation speedup epoch: 14, train speedup 8.185, test speedup 0.693, val speedup 0.816
last model at epoch 49, train speedup 8.339, test speedup 0.747, val speedup 0.714
execution cost 0:16:18.676992
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.894100, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 5.360x speedup, val set 1.008x speedup, step: 1, train time 9.35 s
Epoch 1/50 |loss: 0.206249| train set 4.864x speedup, test set 5.774x speedup, val set 1.033x speedup, step: 2, train time 8.10 s
Epoch 2/50 |loss: 0.180376| train set 4.488x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 3, train time 8.02 s
Epoch 3/50 |loss: 0.172029| train set 5.007x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 8.07 s
Epoch 4/50 |loss: 0.160028| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 7.92 s
Epoch 5/50 |loss: 0.158105| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 7.90 s
Epoch 6/50 |loss: 0.152674| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 7.80 s
Epoch 7/50 |loss: 0.147299| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 7.91 s
Epoch 8/50 |loss: 0.149226| train set 4.715x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 5, train time 8.09 s
Epoch 9/50 |loss: 0.147352| train set 5.008x speedup, test set 5.239x speedup, val set 0.729x speedup, step: 1, train time 7.82 s
Epoch 10/50 |loss: 0.143375| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 2, train time 8.12 s
Epoch 11/50 |loss: 0.137865| train set 5.007x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 3, train time 8.08 s
Epoch 12/50 |loss: 0.142525| train set 5.007x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 7.88 s
Epoch 13/50 |loss: 0.139615| train set 5.008x speedup, test set 3.715x speedup, val set 0.735x speedup, step: 5, train time 7.92 s
Epoch 14/50 |loss: 0.137579| train set 4.872x speedup, test set 4.076x speedup, val set 0.735x speedup, step: 1, train time 7.98 s
Epoch 15/50 |loss: 0.137572| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 2, train time 8.07 s
Epoch 16/50 |loss: 0.136664| train set 4.921x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 3, train time 7.93 s
Epoch 17/50 |loss: 0.136147| train set 5.008x speedup, test set 0.841x speedup, val set 0.729x speedup, step: 4, train time 7.99 s
Epoch 18/50 |loss: 0.133581| train set 5.008x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 5, train time 8.20 s
Epoch 19/50 |loss: 0.135311| train set 4.991x speedup, test set 4.335x speedup, val set 0.729x speedup, step: 6, train time 8.00 s
Epoch 20/50 |loss: 0.134510| train set 4.921x speedup, test set 4.149x speedup, val set 0.762x speedup, step: 7, train time 7.90 s
Epoch 21/50 |loss: 0.135142| train set 4.873x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 8, train time 8.01 s
Epoch 22/50 |loss: 0.136222| train set 5.008x speedup, test set 5.988x speedup, val set 0.742x speedup, step: 9, train time 8.09 s
Epoch 23/50 |loss: 0.131963| train set 5.008x speedup, test set 4.076x speedup, val set 0.735x speedup, step: 10, train time 8.11 s
Epoch 24/50 |loss: 0.130636| train set 5.008x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 11, train time 8.11 s
Epoch 25/50 |loss: 0.130523| train set 5.008x speedup, test set 0.844x speedup, val set 0.735x speedup, step: 12, train time 8.10 s
Epoch 26/50 |loss: 0.131307| train set 5.007x speedup, test set 4.076x speedup, val set 0.742x speedup, step: 13, train time 8.02 s
Epoch 27/50 |loss: 0.131548| train set 4.873x speedup, test set 4.076x speedup, val set 0.729x speedup, step: 14, train time 8.02 s
Epoch 28/50 |loss: 0.129624| train set 5.008x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 15, train time 8.11 s
Epoch 29/50 |loss: 0.130109| train set 5.008x speedup, test set 4.076x speedup, val set 0.729x speedup, step: 16, train time 8.10 s
Epoch 30/50 |loss: 0.130631| train set 5.007x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 17, train time 8.20 s
Epoch 31/50 |loss: 0.129174| train set 4.958x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 18, train time 8.01 s
Epoch 32/50 |loss: 0.127156| train set 5.008x speedup, test set 4.149x speedup, val set 0.742x speedup, step: 19, train time 8.01 s
Epoch 33/50 |loss: 0.128115| train set 5.008x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 20, train time 8.09 s
Epoch 34/50 |loss: 0.126897| train set 5.008x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 21, train time 8.31 s
Epoch 35/50 |loss: 0.128324| train set 5.008x speedup, test set 4.076x speedup, val set 0.729x speedup, step: 22, train time 8.10 s
Epoch 36/50 |loss: 0.127989| train set 5.008x speedup, test set 4.149x speedup, val set 0.742x speedup, step: 23, train time 8.29 s
Epoch 37/50 |loss: 0.129222| train set 5.008x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 24, train time 8.10 s
Epoch 38/50 |loss: 0.129366| train set 4.958x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 25, train time 8.20 s
Epoch 39/50 |loss: 0.128678| train set 5.008x speedup, test set 4.149x speedup, val set 0.735x speedup, step: 1, train time 8.19 s
Epoch 40/50 |loss: 0.124797| train set 5.008x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 2, train time 8.00 s
Epoch 41/50 |loss: 0.126340| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 3, train time 8.22 s
Epoch 42/50 |loss: 0.127480| train set 5.008x speedup, test set 4.172x speedup, val set 0.729x speedup, step: 4, train time 8.20 s
Epoch 43/50 |loss: 0.126371| train set 5.003x speedup, test set 4.149x speedup, val set 0.804x speedup, step: 5, train time 8.30 s
Epoch 44/50 |loss: 0.126949| train set 4.958x speedup, test set 4.149x speedup, val set 0.733x speedup, step: 6, train time 8.30 s
Epoch 45/50 |loss: 0.127506| train set 5.008x speedup, test set 4.149x speedup, val set 0.742x speedup, step: 7, train time 8.10 s
Epoch 46/50 |loss: 0.126901| train set 4.921x speedup, test set 4.076x speedup, val set 0.729x speedup, step: 8, train time 8.21 s
Epoch 47/50 |loss: 0.124826| train set 5.008x speedup, test set 4.076x speedup, val set 0.735x speedup, step: 9, train time 8.37 s
Epoch 48/50 |loss: 0.126461| train set 4.958x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 10, train time 8.32 s
Epoch 49/50 |loss: 0.125374| train set 4.958x speedup, test set 4.756x speedup, val set 0.729x speedup, step: 11, train time 8.20 s
early stopping at epoch 49
Training per epoch cost 8.108 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 50.522s, pg runtime 432.766s, speedup 8.566x
32, opt runtime 15.120s, model runtime 50.456s, pg runtime 566.078s, speedup 11.219x
33, opt runtime 16.639s, model runtime 50.349s, pg runtime 462.544s, speedup 9.187x
34, opt runtime 16.280s, model runtime 50.583s, pg runtime 634.990s, speedup 12.553x
35, opt runtime 16.528s, model runtime 49.548s, pg runtime 620.762s, speedup 12.528x
36, opt runtime 18.690s, model runtime 53.540s, pg runtime 651.942s, speedup 12.177x
37, opt runtime 16.438s, model runtime 49.592s, pg runtime 546.887s, speedup 11.028x
38, opt runtime 16.138s, model runtime 49.340s, pg runtime 501.793s, speedup 10.170x
39, opt runtime 16.770s, model runtime 50.646s, pg runtime 594.754s, speedup 11.743x
40, opt runtime 16.305s, model runtime 50.496s, pg runtime 436.168s, speedup 8.638x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 5.360, val speedup 1.008
best test speedup epoch: 22, train speedup 5.008, test speedup 5.988, val speedup 0.742
best validation speedup epoch: 39, train speedup 5.008, test speedup 4.149, val speedup 0.735
last model at epoch 49, train speedup 4.958, test speedup 4.756, val speedup 0.729
execution cost 0:07:12.291639
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.922062, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 5.360x speedup, val set 1.008x speedup, step: 1, train time 9.30 s
Epoch 1/50 |loss: 0.206276| train set 4.864x speedup, test set 5.360x speedup, val set 1.033x speedup, step: 2, train time 8.20 s
Epoch 2/50 |loss: 0.179380| train set 4.715x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 3, train time 8.01 s
Epoch 3/50 |loss: 0.171425| train set 5.007x speedup, test set 3.776x speedup, val set 0.994x speedup, step: 4, train time 7.99 s
Epoch 4/50 |loss: 0.161470| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.02 s
Epoch 5/50 |loss: 0.156902| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 8.01 s
Epoch 6/50 |loss: 0.151694| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.01 s
Epoch 7/50 |loss: 0.148990| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 8.11 s
Epoch 8/50 |loss: 0.152103| train set 5.008x speedup, test set 3.715x speedup, val set 0.733x speedup, step: 5, train time 8.08 s
Epoch 9/50 |loss: 0.148907| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.02 s
Epoch 10/50 |loss: 0.144446| train set 5.004x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 2, train time 8.21 s
Epoch 11/50 |loss: 0.139504| train set 5.007x speedup, test set 3.715x speedup, val set 0.735x speedup, step: 3, train time 8.00 s
Epoch 12/50 |loss: 0.142027| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 7.91 s
Epoch 13/50 |loss: 0.138724| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 5, train time 8.10 s
Epoch 14/50 |loss: 0.137380| train set 4.872x speedup, test set 3.715x speedup, val set 0.735x speedup, step: 1, train time 8.20 s
Epoch 15/50 |loss: 0.138566| train set 4.921x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 7.91 s
Epoch 16/50 |loss: 0.136663| train set 4.921x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 3, train time 8.00 s
Epoch 17/50 |loss: 0.136976| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 8.10 s
Epoch 18/50 |loss: 0.134307| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 5, train time 8.03 s
Epoch 19/50 |loss: 0.135481| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 6, train time 8.01 s
Epoch 20/50 |loss: 0.133739| train set 4.921x speedup, test set 3.715x speedup, val set 0.762x speedup, step: 7, train time 7.99 s
Epoch 21/50 |loss: 0.134386| train set 4.873x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 8, train time 7.92 s
Epoch 22/50 |loss: 0.136157| train set 4.921x speedup, test set 5.988x speedup, val set 0.735x speedup, step: 9, train time 8.11 s
Epoch 23/50 |loss: 0.132849| train set 5.008x speedup, test set 5.988x speedup, val set 0.735x speedup, step: 10, train time 8.02 s
Epoch 24/50 |loss: 0.129819| train set 4.921x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 11, train time 8.07 s
Epoch 25/50 |loss: 0.131051| train set 5.008x speedup, test set 4.305x speedup, val set 0.742x speedup, step: 12, train time 8.02 s
Epoch 26/50 |loss: 0.131130| train set 5.007x speedup, test set 4.076x speedup, val set 0.739x speedup, step: 13, train time 8.20 s
Epoch 27/50 |loss: 0.132180| train set 4.873x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 14, train time 8.02 s
Epoch 28/50 |loss: 0.129693| train set 5.008x speedup, test set 4.076x speedup, val set 0.739x speedup, step: 15, train time 8.00 s
Epoch 29/50 |loss: 0.131844| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 16, train time 8.30 s
Epoch 30/50 |loss: 0.131556| train set 5.008x speedup, test set 3.715x speedup, val set 0.733x speedup, step: 17, train time 8.10 s
Epoch 31/50 |loss: 0.129834| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 18, train time 8.19 s
Epoch 32/50 |loss: 0.127560| train set 5.008x speedup, test set 3.715x speedup, val set 0.735x speedup, step: 19, train time 8.11 s
Epoch 33/50 |loss: 0.128707| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 20, train time 8.20 s
Epoch 34/50 |loss: 0.127611| train set 5.008x speedup, test set 4.076x speedup, val set 0.729x speedup, step: 21, train time 8.10 s
Epoch 35/50 |loss: 0.129009| train set 5.008x speedup, test set 5.239x speedup, val set 0.729x speedup, step: 22, train time 8.12 s
Epoch 36/50 |loss: 0.129084| train set 5.008x speedup, test set 3.715x speedup, val set 0.795x speedup, step: 23, train time 8.20 s
Epoch 37/50 |loss: 0.129858| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 24, train time 8.03 s
Epoch 38/50 |loss: 0.130488| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 25, train time 8.22 s
Epoch 39/50 |loss: 0.127784| train set 5.004x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 26, train time 8.01 s
Epoch 40/50 |loss: 0.124975| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 27, train time 8.02 s
Epoch 41/50 |loss: 0.126809| train set 5.008x speedup, test set 5.239x speedup, val set 0.729x speedup, step: 28, train time 8.30 s
Epoch 42/50 |loss: 0.126783| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 29, train time 8.12 s
Epoch 43/50 |loss: 0.126132| train set 4.917x speedup, test set 4.076x speedup, val set 0.804x speedup, step: 30, train time 8.20 s
Epoch 44/50 |loss: 0.127982| train set 4.958x speedup, test set 3.715x speedup, val set 0.733x speedup, step: 31, train time 8.02 s
Epoch 45/50 |loss: 0.127582| train set 5.008x speedup, test set 3.715x speedup, val set 0.739x speedup, step: 32, train time 8.00 s
Epoch 46/50 |loss: 0.128135| train set 4.921x speedup, test set 4.076x speedup, val set 0.729x speedup, step: 33, train time 8.00 s
Epoch 47/50 |loss: 0.125466| train set 5.004x speedup, test set 3.715x speedup, val set 0.733x speedup, step: 34, train time 8.12 s
Epoch 48/50 |loss: 0.127385| train set 4.958x speedup, test set 3.715x speedup, val set 0.733x speedup, step: 35, train time 8.10 s
Epoch 49/50 |loss: 0.125241| train set 4.958x speedup, test set 3.715x speedup, val set 0.733x speedup, step: 36, train time 8.00 s
early stopping at epoch 49
Training per epoch cost 8.100 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 9.462s, pg runtime 7.799s, speedup 0.824x
22, opt runtime 7.096s, model runtime 9.079s, pg runtime 7.096s, speedup 0.782x
23, opt runtime 7.063s, model runtime 9.862s, pg runtime 7.063s, speedup 0.716x
24, opt runtime 7.268s, model runtime 10.315s, pg runtime 7.268s, speedup 0.705x
25, opt runtime 6.854s, model runtime 10.279s, pg runtime 6.854s, speedup 0.667x
26, opt runtime 6.905s, model runtime 9.336s, pg runtime 6.905s, speedup 0.740x
27, opt runtime 6.663s, model runtime 9.628s, pg runtime 6.663s, speedup 0.692x
28, opt runtime 7.199s, model runtime 9.907s, pg runtime 7.619s, speedup 0.769x
29, opt runtime 7.066s, model runtime 9.776s, pg runtime 7.533s, speedup 0.771x
30, opt runtime 6.961s, model runtime 9.536s, pg runtime 6.961s, speedup 0.730x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 5.360, val speedup 1.008
best test speedup epoch: 22, train speedup 4.921, test speedup 5.988, val speedup 0.735
best validation speedup epoch: 14, train speedup 4.872, test speedup 3.715, val speedup 0.735
last model at epoch 49, train speedup 4.958, test speedup 3.715, val speedup 0.733
execution cost 0:07:11.885637
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.874574, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 5.360x speedup, val set 1.008x speedup, step: 1, train time 9.17 s
Epoch 1/50 |loss: 0.205420| train set 4.864x speedup, test set 5.634x speedup, val set 0.729x speedup, step: 2, train time 8.20 s
Epoch 2/50 |loss: 0.178046| train set 4.419x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 3, train time 7.81 s
Epoch 3/50 |loss: 0.170918| train set 5.007x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 7.82 s
Epoch 4/50 |loss: 0.159158| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 7.97 s
Epoch 5/50 |loss: 0.158307| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 7.92 s
Epoch 6/50 |loss: 0.151765| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 7.90 s
Epoch 7/50 |loss: 0.148203| train set 4.921x speedup, test set 3.776x speedup, val set 0.834x speedup, step: 4, train time 8.00 s
Epoch 8/50 |loss: 0.149523| train set 5.008x speedup, test set 3.776x speedup, val set 0.746x speedup, step: 5, train time 7.93 s
Epoch 9/50 |loss: 0.147124| train set 5.008x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 1, train time 8.00 s
Epoch 10/50 |loss: 0.144086| train set 5.004x speedup, test set 5.360x speedup, val set 0.742x speedup, step: 2, train time 7.91 s
Epoch 11/50 |loss: 0.138285| train set 5.007x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.08 s
Epoch 12/50 |loss: 0.142400| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 4, train time 8.10 s
Epoch 13/50 |loss: 0.138571| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 5, train time 7.91 s
Epoch 14/50 |loss: 0.138229| train set 4.873x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 7.91 s
Epoch 15/50 |loss: 0.137524| train set 4.921x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 2, train time 7.91 s
Epoch 16/50 |loss: 0.136008| train set 4.921x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 3, train time 8.00 s
Epoch 17/50 |loss: 0.135690| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 4, train time 7.82 s
Epoch 18/50 |loss: 0.134485| train set 4.921x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 5, train time 8.00 s
Epoch 19/50 |loss: 0.136684| train set 5.008x speedup, test set 6.535x speedup, val set 0.735x speedup, step: 1, train time 7.81 s
Epoch 20/50 |loss: 0.133448| train set 4.921x speedup, test set 4.149x speedup, val set 0.786x speedup, step: 2, train time 8.00 s
Epoch 21/50 |loss: 0.133632| train set 4.873x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 3, train time 7.92 s
Epoch 22/50 |loss: 0.136204| train set 5.008x speedup, test set 5.988x speedup, val set 0.742x speedup, step: 4, train time 8.01 s
Epoch 23/50 |loss: 0.132350| train set 5.008x speedup, test set 4.076x speedup, val set 0.742x speedup, step: 5, train time 7.91 s
Epoch 24/50 |loss: 0.130073| train set 4.921x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 6, train time 8.00 s
Epoch 25/50 |loss: 0.131674| train set 5.008x speedup, test set 0.913x speedup, val set 0.735x speedup, step: 7, train time 8.01 s
Epoch 26/50 |loss: 0.130886| train set 5.008x speedup, test set 4.305x speedup, val set 0.733x speedup, step: 8, train time 7.82 s
Epoch 27/50 |loss: 0.130407| train set 4.921x speedup, test set 3.715x speedup, val set 0.735x speedup, step: 9, train time 8.08 s
Epoch 28/50 |loss: 0.129186| train set 5.008x speedup, test set 4.149x speedup, val set 0.746x speedup, step: 10, train time 7.92 s
Epoch 29/50 |loss: 0.134374| train set 5.008x speedup, test set 4.305x speedup, val set 0.729x speedup, step: 11, train time 8.11 s
Epoch 30/50 |loss: 0.131702| train set 5.008x speedup, test set 4.305x speedup, val set 0.729x speedup, step: 12, train time 7.92 s
Epoch 31/50 |loss: 0.129582| train set 4.958x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 13, train time 8.01 s
Epoch 32/50 |loss: 0.126900| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 14, train time 7.80 s
Epoch 33/50 |loss: 0.129245| train set 5.007x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 15, train time 8.32 s
Epoch 34/50 |loss: 0.128154| train set 5.008x speedup, test set 4.387x speedup, val set 0.739x speedup, step: 1, train time 9.20 s
Epoch 35/50 |loss: 0.129176| train set 5.008x speedup, test set 6.495x speedup, val set 0.733x speedup, step: 2, train time 8.29 s
Epoch 36/50 |loss: 0.129213| train set 5.008x speedup, test set 4.387x speedup, val set 0.746x speedup, step: 3, train time 9.79 s
Epoch 37/50 |loss: 0.128565| train set 4.921x speedup, test set 6.681x speedup, val set 0.746x speedup, step: 4, train time 7.91 s
Epoch 38/50 |loss: 0.129748| train set 4.958x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 5, train time 7.99 s
Epoch 39/50 |loss: 0.127883| train set 5.008x speedup, test set 6.146x speedup, val set 0.729x speedup, step: 6, train time 7.98 s
Epoch 40/50 |loss: 0.124792| train set 4.921x speedup, test set 4.149x speedup, val set 0.746x speedup, step: 7, train time 7.88 s
Epoch 41/50 |loss: 0.126819| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 8, train time 7.91 s
Epoch 42/50 |loss: 0.126902| train set 4.958x speedup, test set 4.387x speedup, val set 0.733x speedup, step: 9, train time 8.01 s
Epoch 43/50 |loss: 0.126617| train set 4.917x speedup, test set 4.149x speedup, val set 0.809x speedup, step: 10, train time 7.90 s
Epoch 44/50 |loss: 0.127453| train set 4.958x speedup, test set 4.387x speedup, val set 0.733x speedup, step: 11, train time 7.93 s
Epoch 45/50 |loss: 0.128224| train set 5.000x speedup, test set 4.149x speedup, val set 0.746x speedup, step: 12, train time 7.91 s
Epoch 46/50 |loss: 0.127579| train set 4.921x speedup, test set 4.149x speedup, val set 0.742x speedup, step: 13, train time 8.01 s
Epoch 47/50 |loss: 0.125686| train set 5.008x speedup, test set 4.305x speedup, val set 0.739x speedup, step: 14, train time 8.01 s
Epoch 48/50 |loss: 0.127479| train set 4.958x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 15, train time 8.01 s
Epoch 49/50 |loss: 0.125388| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 16, train time 8.00 s
early stopping at epoch 49
Training per epoch cost 8.054 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 5.360, val speedup 1.008
best test speedup epoch: 21, train speedup 4.873, test speedup 6.681, val speedup 0.729
best validation speedup epoch: 34, train speedup 5.008, test speedup 4.387, val speedup 0.739
last model at epoch 49, train speedup 4.958, test speedup 4.387, val speedup 0.729
execution cost 0:07:08.842091
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.928214, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336391| train set 5.008x speedup, test set 3.776x speedup, val set 1.008x speedup, step: 1, train time 9.26 s
Epoch 1/50 |loss: 0.208482| train set 4.657x speedup, test set 5.239x speedup, val set 0.729x speedup, step: 2, train time 8.00 s
Epoch 2/50 |loss: 0.179362| train set 4.448x speedup, test set 1.323x speedup, val set 0.983x speedup, step: 3, train time 8.12 s
Epoch 3/50 |loss: 0.171582| train set 5.007x speedup, test set 3.715x speedup, val set 1.033x speedup, step: 4, train time 8.10 s
Epoch 4/50 |loss: 0.160534| train set 5.008x speedup, test set 1.323x speedup, val set 0.740x speedup, step: 1, train time 7.83 s
Epoch 5/50 |loss: 0.158680| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 8.11 s
Epoch 6/50 |loss: 0.152634| train set 5.008x speedup, test set 3.776x speedup, val set 0.738x speedup, step: 3, train time 8.10 s
Epoch 7/50 |loss: 0.146560| train set 4.921x speedup, test set 3.776x speedup, val set 1.000x speedup, step: 4, train time 8.09 s
Epoch 8/50 |loss: 0.149616| train set 4.988x speedup, test set 4.076x speedup, val set 1.014x speedup, step: 5, train time 8.06 s
Epoch 9/50 |loss: 0.147946| train set 5.008x speedup, test set 5.239x speedup, val set 0.735x speedup, step: 6, train time 8.00 s
Epoch 10/50 |loss: 0.141768| train set 5.008x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 7, train time 7.91 s
Epoch 11/50 |loss: 0.138201| train set 5.007x speedup, test set 4.076x speedup, val set 1.007x speedup, step: 8, train time 8.13 s
Epoch 12/50 |loss: 0.141019| train set 5.008x speedup, test set 4.305x speedup, val set 1.000x speedup, step: 9, train time 7.92 s
Epoch 13/50 |loss: 0.137961| train set 5.008x speedup, test set 3.715x speedup, val set 0.794x speedup, step: 10, train time 8.10 s
Epoch 14/50 |loss: 0.136623| train set 4.872x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 1, train time 8.00 s
Epoch 15/50 |loss: 0.137367| train set 4.921x speedup, test set 4.305x speedup, val set 0.770x speedup, step: 2, train time 8.09 s
Epoch 16/50 |loss: 0.136104| train set 4.921x speedup, test set 5.239x speedup, val set 0.762x speedup, step: 3, train time 8.01 s
Epoch 17/50 |loss: 0.136740| train set 5.008x speedup, test set 4.305x speedup, val set 0.729x speedup, step: 4, train time 8.12 s
Epoch 18/50 |loss: 0.134443| train set 5.008x speedup, test set 4.305x speedup, val set 0.804x speedup, step: 5, train time 7.99 s
Epoch 19/50 |loss: 0.135472| train set 4.958x speedup, test set 3.715x speedup, val set 0.995x speedup, step: 1, train time 8.09 s
Epoch 20/50 |loss: 0.134578| train set 4.921x speedup, test set 4.305x speedup, val set 0.742x speedup, step: 2, train time 7.90 s
Epoch 21/50 |loss: 0.133585| train set 4.873x speedup, test set 5.239x speedup, val set 0.729x speedup, step: 3, train time 8.11 s
Epoch 22/50 |loss: 0.135816| train set 4.921x speedup, test set 5.988x speedup, val set 0.786x speedup, step: 4, train time 8.21 s
Epoch 23/50 |loss: 0.132263| train set 5.008x speedup, test set 4.076x speedup, val set 0.735x speedup, step: 5, train time 8.19 s
Epoch 24/50 |loss: 0.130213| train set 4.921x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 6, train time 8.02 s
Epoch 25/50 |loss: 0.130985| train set 5.008x speedup, test set 4.305x speedup, val set 0.795x speedup, step: 7, train time 8.10 s
Epoch 26/50 |loss: 0.131945| train set 5.007x speedup, test set 6.495x speedup, val set 0.775x speedup, step: 8, train time 8.12 s
Epoch 27/50 |loss: 0.131426| train set 4.873x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 9, train time 8.19 s
Epoch 28/50 |loss: 0.129861| train set 5.008x speedup, test set 3.715x speedup, val set 0.804x speedup, step: 10, train time 8.02 s
Epoch 29/50 |loss: 0.130833| train set 5.008x speedup, test set 4.305x speedup, val set 0.735x speedup, step: 11, train time 8.20 s
Epoch 30/50 |loss: 0.131365| train set 5.008x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 12, train time 8.11 s
Epoch 31/50 |loss: 0.129317| train set 4.958x speedup, test set 4.305x speedup, val set 0.742x speedup, step: 13, train time 7.91 s
Epoch 32/50 |loss: 0.127053| train set 5.008x speedup, test set 4.387x speedup, val set 0.786x speedup, step: 14, train time 8.11 s
Epoch 33/50 |loss: 0.128742| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 15, train time 8.10 s
Epoch 34/50 |loss: 0.127433| train set 5.008x speedup, test set 5.049x speedup, val set 0.729x speedup, step: 16, train time 8.18 s
Epoch 35/50 |loss: 0.127991| train set 5.008x speedup, test set 6.495x speedup, val set 0.729x speedup, step: 17, train time 8.09 s
Epoch 36/50 |loss: 0.128721| train set 5.008x speedup, test set 6.495x speedup, val set 0.804x speedup, step: 18, train time 7.90 s
Epoch 37/50 |loss: 0.128589| train set 4.958x speedup, test set 4.305x speedup, val set 0.729x speedup, step: 19, train time 8.21 s
Epoch 38/50 |loss: 0.129116| train set 4.958x speedup, test set 4.305x speedup, val set 0.742x speedup, step: 20, train time 8.22 s
Epoch 39/50 |loss: 0.127900| train set 5.004x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 21, train time 8.00 s
Epoch 40/50 |loss: 0.125471| train set 5.008x speedup, test set 4.076x speedup, val set 0.742x speedup, step: 22, train time 8.19 s
Epoch 41/50 |loss: 0.126434| train set 5.008x speedup, test set 8.560x speedup, val set 0.729x speedup, step: 23, train time 8.31 s
Epoch 42/50 |loss: 0.126430| train set 4.958x speedup, test set 4.965x speedup, val set 0.735x speedup, step: 24, train time 8.30 s
Epoch 43/50 |loss: 0.125908| train set 5.004x speedup, test set 4.305x speedup, val set 0.742x speedup, step: 25, train time 8.18 s
Epoch 44/50 |loss: 0.126461| train set 4.958x speedup, test set 4.387x speedup, val set 0.739x speedup, step: 26, train time 8.11 s
Epoch 45/50 |loss: 0.128993| train set 5.008x speedup, test set 4.387x speedup, val set 0.739x speedup, step: 27, train time 8.21 s
Epoch 46/50 |loss: 0.127270| train set 4.921x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 28, train time 8.09 s
Epoch 47/50 |loss: 0.125252| train set 5.008x speedup, test set 4.965x speedup, val set 0.735x speedup, step: 29, train time 8.12 s
Epoch 48/50 |loss: 0.127347| train set 4.958x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 30, train time 8.20 s
Epoch 49/50 |loss: 0.125591| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 31, train time 8.28 s
early stopping at epoch 49
Training per epoch cost 8.118 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 9.462s, pg runtime 7.799s, speedup 0.824x
22, opt runtime 7.096s, model runtime 9.079s, pg runtime 7.096s, speedup 0.782x
23, opt runtime 7.063s, model runtime 9.862s, pg runtime 7.063s, speedup 0.716x
24, opt runtime 7.268s, model runtime 10.315s, pg runtime 7.268s, speedup 0.705x
25, opt runtime 6.854s, model runtime 10.279s, pg runtime 6.854s, speedup 0.667x
26, opt runtime 6.905s, model runtime 9.336s, pg runtime 6.905s, speedup 0.740x
27, opt runtime 6.663s, model runtime 9.628s, pg runtime 6.663s, speedup 0.692x
28, opt runtime 7.199s, model runtime 9.907s, pg runtime 7.619s, speedup 0.769x
29, opt runtime 7.066s, model runtime 9.776s, pg runtime 7.533s, speedup 0.771x
30, opt runtime 6.961s, model runtime 9.536s, pg runtime 6.961s, speedup 0.730x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 3.776, val speedup 1.008
best test speedup epoch: 41, train speedup 5.008, test speedup 8.560, val speedup 0.729
best validation speedup epoch: 19, train speedup 4.958, test speedup 3.715, val speedup 0.995
last model at epoch 49, train speedup 4.958, test speedup 4.387, val speedup 0.729
execution cost 0:07:12.611152
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.929333, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 5.360x speedup, val set 1.008x speedup, step: 1, train time 9.44 s
Epoch 1/50 |loss: 0.206117| train set 4.864x speedup, test set 3.910x speedup, val set 1.033x speedup, step: 2, train time 8.01 s
Epoch 2/50 |loss: 0.179991| train set 4.638x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 3, train time 7.82 s
Epoch 3/50 |loss: 0.170491| train set 5.007x speedup, test set 3.776x speedup, val set 0.752x speedup, step: 4, train time 7.91 s
Epoch 4/50 |loss: 0.161874| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.11 s
Epoch 5/50 |loss: 0.157145| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 8.01 s
Epoch 6/50 |loss: 0.152980| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 7.91 s
Epoch 7/50 |loss: 0.150543| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 8.02 s
Epoch 8/50 |loss: 0.152132| train set 4.715x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 5, train time 7.80 s
Epoch 9/50 |loss: 0.149931| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.11 s
Epoch 10/50 |loss: 0.144621| train set 5.008x speedup, test set 3.715x speedup, val set 0.735x speedup, step: 2, train time 8.00 s
Epoch 11/50 |loss: 0.138356| train set 5.007x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.00 s
Epoch 12/50 |loss: 0.142681| train set 5.007x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 8.01 s
Epoch 13/50 |loss: 0.138479| train set 4.988x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 5, train time 8.07 s
Epoch 14/50 |loss: 0.137819| train set 4.921x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 1, train time 8.01 s
Epoch 15/50 |loss: 0.138343| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 2, train time 8.09 s
Epoch 16/50 |loss: 0.137273| train set 4.921x speedup, test set 3.776x speedup, val set 0.762x speedup, step: 3, train time 7.90 s
Epoch 17/50 |loss: 0.137569| train set 5.008x speedup, test set 0.844x speedup, val set 0.729x speedup, step: 4, train time 8.02 s
Epoch 18/50 |loss: 0.134696| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 5, train time 8.01 s
Epoch 19/50 |loss: 0.136604| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 6, train time 8.11 s
Epoch 20/50 |loss: 0.134459| train set 5.008x speedup, test set 4.149x speedup, val set 0.742x speedup, step: 7, train time 8.00 s
Epoch 21/50 |loss: 0.135325| train set 4.873x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 8, train time 8.00 s
Epoch 22/50 |loss: 0.136780| train set 4.921x speedup, test set 5.722x speedup, val set 0.742x speedup, step: 9, train time 8.02 s
Epoch 23/50 |loss: 0.133313| train set 5.008x speedup, test set 4.149x speedup, val set 0.735x speedup, step: 10, train time 8.10 s
Epoch 24/50 |loss: 0.130324| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 11, train time 8.11 s
Epoch 25/50 |loss: 0.132621| train set 5.008x speedup, test set 0.844x speedup, val set 0.742x speedup, step: 12, train time 8.11 s
Epoch 26/50 |loss: 0.131293| train set 5.007x speedup, test set 4.076x speedup, val set 0.739x speedup, step: 13, train time 8.01 s
Epoch 27/50 |loss: 0.132815| train set 4.921x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 14, train time 8.01 s
Epoch 28/50 |loss: 0.130527| train set 5.008x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 15, train time 8.01 s
Epoch 29/50 |loss: 0.130765| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 16, train time 8.12 s
Epoch 30/50 |loss: 0.131770| train set 5.008x speedup, test set 4.387x speedup, val set 0.733x speedup, step: 17, train time 8.00 s
Epoch 31/50 |loss: 0.131738| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 18, train time 8.09 s
Epoch 32/50 |loss: 0.129083| train set 4.954x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 19, train time 8.22 s
Epoch 33/50 |loss: 0.129945| train set 5.008x speedup, test set 3.762x speedup, val set 0.729x speedup, step: 20, train time 8.00 s
Epoch 34/50 |loss: 0.128396| train set 5.008x speedup, test set 4.149x speedup, val set 0.733x speedup, step: 21, train time 8.21 s
Epoch 35/50 |loss: 0.128566| train set 5.008x speedup, test set 4.305x speedup, val set 0.733x speedup, step: 22, train time 8.00 s
Epoch 36/50 |loss: 0.129864| train set 5.008x speedup, test set 3.776x speedup, val set 0.746x speedup, step: 23, train time 8.10 s
Epoch 37/50 |loss: 0.128578| train set 4.958x speedup, test set 4.335x speedup, val set 0.729x speedup, step: 24, train time 8.00 s
Epoch 38/50 |loss: 0.130015| train set 4.958x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 25, train time 8.01 s
Epoch 39/50 |loss: 0.128765| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 26, train time 8.01 s
Epoch 40/50 |loss: 0.125738| train set 5.008x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 27, train time 8.00 s
Epoch 41/50 |loss: 0.127015| train set 5.008x speedup, test set 3.776x speedup, val set 0.746x speedup, step: 28, train time 8.10 s
Epoch 42/50 |loss: 0.127725| train set 5.008x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 29, train time 8.01 s
Epoch 43/50 |loss: 0.127092| train set 5.007x speedup, test set 4.149x speedup, val set 0.805x speedup, step: 30, train time 7.92 s
Epoch 44/50 |loss: 0.127954| train set 4.958x speedup, test set 3.776x speedup, val set 0.739x speedup, step: 1, train time 7.93 s
Epoch 45/50 |loss: 0.128091| train set 5.008x speedup, test set 3.824x speedup, val set 0.739x speedup, step: 2, train time 7.90 s
Epoch 46/50 |loss: 0.128861| train set 4.921x speedup, test set 4.149x speedup, val set 0.746x speedup, step: 3, train time 8.01 s
Epoch 47/50 |loss: 0.126248| train set 5.008x speedup, test set 3.715x speedup, val set 0.746x speedup, step: 4, train time 7.92 s
Epoch 48/50 |loss: 0.127769| train set 4.958x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 5, train time 7.99 s
Epoch 49/50 |loss: 0.126130| train set 4.958x speedup, test set 4.387x speedup, val set 0.733x speedup, step: 6, train time 7.91 s
early stopping at epoch 49
Training per epoch cost 8.044 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 5.360, val speedup 1.008
best test speedup epoch: 22, train speedup 4.921, test speedup 5.722, val speedup 0.742
best validation speedup epoch: 44, train speedup 4.958, test speedup 3.776, val speedup 0.739
last model at epoch 49, train speedup 4.958, test speedup 4.387, val speedup 0.733
execution cost 0:07:09.112838
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.891712, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336391| train set 5.008x speedup, test set 3.776x speedup, val set 1.008x speedup, step: 1, train time 9.46 s
Epoch 1/50 |loss: 0.209527| train set 5.007x speedup, test set 5.239x speedup, val set 0.855x speedup, step: 2, train time 8.18 s
Epoch 2/50 |loss: 0.177912| train set 4.715x speedup, test set 1.323x speedup, val set 1.000x speedup, step: 3, train time 8.01 s
Epoch 3/50 |loss: 0.170493| train set 5.007x speedup, test set 3.776x speedup, val set 0.973x speedup, step: 4, train time 8.11 s
Epoch 4/50 |loss: 0.160536| train set 5.008x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 1, train time 8.01 s
Epoch 5/50 |loss: 0.158067| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 7.92 s
Epoch 6/50 |loss: 0.153169| train set 5.008x speedup, test set 3.191x speedup, val set 0.729x speedup, step: 3, train time 8.19 s
Epoch 7/50 |loss: 0.149703| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 8.00 s
Epoch 8/50 |loss: 0.149862| train set 4.715x speedup, test set 4.256x speedup, val set 0.965x speedup, step: 5, train time 7.91 s
Epoch 9/50 |loss: 0.148739| train set 4.895x speedup, test set 0.900x speedup, val set 0.735x speedup, step: 1, train time 7.89 s
Epoch 10/50 |loss: 0.144460| train set 5.008x speedup, test set 4.305x speedup, val set 0.735x speedup, step: 2, train time 8.01 s
Epoch 11/50 |loss: 0.140687| train set 5.007x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 3, train time 7.91 s
Epoch 12/50 |loss: 0.142200| train set 5.007x speedup, test set 4.305x speedup, val set 0.729x speedup, step: 4, train time 8.01 s
Epoch 13/50 |loss: 0.138755| train set 4.988x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 5, train time 8.01 s
Epoch 14/50 |loss: 0.138115| train set 4.873x speedup, test set 4.323x speedup, val set 0.729x speedup, step: 6, train time 8.01 s
Epoch 15/50 |loss: 0.138064| train set 4.921x speedup, test set 4.305x speedup, val set 0.786x speedup, step: 7, train time 7.92 s
Epoch 16/50 |loss: 0.137895| train set 4.921x speedup, test set 4.305x speedup, val set 0.786x speedup, step: 8, train time 8.11 s
Epoch 17/50 |loss: 0.136709| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 9, train time 8.08 s
Epoch 18/50 |loss: 0.134563| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 10, train time 8.02 s
Epoch 19/50 |loss: 0.135704| train set 4.958x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 1, train time 8.03 s
Epoch 20/50 |loss: 0.134436| train set 4.921x speedup, test set 3.776x speedup, val set 0.770x speedup, step: 2, train time 8.10 s
Epoch 21/50 |loss: 0.135856| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 3, train time 8.21 s
Epoch 22/50 |loss: 0.135954| train set 5.008x speedup, test set 5.988x speedup, val set 0.742x speedup, step: 4, train time 8.11 s
Epoch 23/50 |loss: 0.132030| train set 5.008x speedup, test set 5.988x speedup, val set 0.729x speedup, step: 5, train time 8.10 s
Epoch 24/50 |loss: 0.130065| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 6, train time 8.10 s
Epoch 25/50 |loss: 0.132985| train set 5.008x speedup, test set 4.387x speedup, val set 0.786x speedup, step: 7, train time 8.12 s
Epoch 26/50 |loss: 0.130993| train set 5.007x speedup, test set 0.841x speedup, val set 0.746x speedup, step: 8, train time 8.10 s
Epoch 27/50 |loss: 0.131989| train set 4.921x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 9, train time 8.40 s
Epoch 28/50 |loss: 0.130656| train set 5.008x speedup, test set 3.776x speedup, val set 0.791x speedup, step: 10, train time 8.12 s
Epoch 29/50 |loss: 0.130214| train set 5.008x speedup, test set 0.841x speedup, val set 0.742x speedup, step: 1, train time 8.09 s
Epoch 30/50 |loss: 0.131966| train set 5.008x speedup, test set 3.715x speedup, val set 0.735x speedup, step: 2, train time 7.91 s
Epoch 31/50 |loss: 0.130326| train set 4.958x speedup, test set 4.305x speedup, val set 0.742x speedup, step: 3, train time 8.21 s
Epoch 32/50 |loss: 0.127661| train set 4.958x speedup, test set 4.305x speedup, val set 0.742x speedup, step: 4, train time 8.12 s
Epoch 33/50 |loss: 0.129813| train set 5.008x speedup, test set 5.239x speedup, val set 0.735x speedup, step: 5, train time 8.02 s
Epoch 34/50 |loss: 0.127483| train set 5.008x speedup, test set 4.076x speedup, val set 0.735x speedup, step: 6, train time 7.99 s
Epoch 35/50 |loss: 0.129588| train set 5.008x speedup, test set 6.495x speedup, val set 0.729x speedup, step: 7, train time 8.02 s
Epoch 36/50 |loss: 0.129528| train set 4.958x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 8, train time 8.10 s
Epoch 37/50 |loss: 0.129421| train set 4.917x speedup, test set 4.387x speedup, val set 0.786x speedup, step: 9, train time 8.20 s
Epoch 38/50 |loss: 0.130512| train set 4.958x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 10, train time 7.92 s
Epoch 39/50 |loss: 0.128683| train set 5.007x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 11, train time 8.10 s
Epoch 40/50 |loss: 0.125725| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 12, train time 8.10 s
Epoch 41/50 |loss: 0.126526| train set 5.008x speedup, test set 6.681x speedup, val set 0.742x speedup, step: 13, train time 8.17 s
Epoch 42/50 |loss: 0.126816| train set 4.958x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 14, train time 8.20 s
Epoch 43/50 |loss: 0.126704| train set 4.917x speedup, test set 4.387x speedup, val set 0.804x speedup, step: 15, train time 7.99 s
Epoch 44/50 |loss: 0.127221| train set 4.958x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 1, train time 8.23 s
Epoch 45/50 |loss: 0.127916| train set 5.008x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 2, train time 8.11 s
Epoch 46/50 |loss: 0.126731| train set 4.921x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 3, train time 8.30 s
Epoch 47/50 |loss: 0.126001| train set 5.008x speedup, test set 4.305x speedup, val set 0.742x speedup, step: 4, train time 8.31 s
Epoch 48/50 |loss: 0.126963| train set 4.958x speedup, test set 3.776x speedup, val set 0.804x speedup, step: 5, train time 8.10 s
Epoch 49/50 |loss: 0.125624| train set 4.958x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 6, train time 8.20 s
Training per epoch cost 8.110 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 42.788s, pg runtime 432.766s, speedup 10.114x
32, opt runtime 15.120s, model runtime 42.444s, pg runtime 566.078s, speedup 13.337x
33, opt runtime 16.639s, model runtime 42.154s, pg runtime 462.544s, speedup 10.973x
34, opt runtime 16.280s, model runtime 43.992s, pg runtime 634.990s, speedup 14.434x
35, opt runtime 16.528s, model runtime 42.465s, pg runtime 620.762s, speedup 14.618x
36, opt runtime 18.690s, model runtime 43.980s, pg runtime 651.942s, speedup 14.824x
37, opt runtime 16.438s, model runtime 43.087s, pg runtime 546.887s, speedup 12.693x
38, opt runtime 16.138s, model runtime 41.893s, pg runtime 501.793s, speedup 11.978x
39, opt runtime 16.770s, model runtime 42.663s, pg runtime 594.754s, speedup 13.941x
40, opt runtime 16.305s, model runtime 42.603s, pg runtime 436.168s, speedup 10.238x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 3.776, val speedup 1.008
best test speedup epoch: 41, train speedup 5.008, test speedup 6.681, val speedup 0.742
best validation speedup epoch: 44, train speedup 4.958, test speedup 4.387, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 4.387, val speedup 0.729
execution cost 0:07:11.621950
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.884505, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336543| train set 5.008x speedup, test set 5.360x speedup, val set 1.000x speedup, step: 1, train time 9.42 s
Epoch 1/50 |loss: 0.209230| train set 4.987x speedup, test set 5.239x speedup, val set 0.729x speedup, step: 2, train time 8.21 s
Epoch 2/50 |loss: 0.182881| train set 4.620x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 3, train time 8.30 s
Epoch 3/50 |loss: 0.170808| train set 5.007x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 4, train time 8.02 s
Epoch 4/50 |loss: 0.161385| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.20 s
Epoch 5/50 |loss: 0.156123| train set 4.556x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 8.11 s
Epoch 6/50 |loss: 0.152424| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.00 s
Epoch 7/50 |loss: 0.147404| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 8.21 s
Epoch 8/50 |loss: 0.147540| train set 4.715x speedup, test set 3.715x speedup, val set 0.733x speedup, step: 5, train time 8.30 s
Epoch 9/50 |loss: 0.146815| train set 5.004x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 1, train time 7.92 s
Epoch 10/50 |loss: 0.142224| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 8.01 s
Epoch 11/50 |loss: 0.138447| train set 5.007x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 3, train time 8.12 s
Epoch 12/50 |loss: 0.142136| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 8.49 s
Epoch 13/50 |loss: 0.137013| train set 4.988x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 5, train time 8.02 s
Epoch 14/50 |loss: 0.138535| train set 4.873x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.10 s
Epoch 15/50 |loss: 0.136751| train set 4.921x speedup, test set 4.305x speedup, val set 0.735x speedup, step: 2, train time 8.10 s
Epoch 16/50 |loss: 0.136753| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 3, train time 8.09 s
Epoch 17/50 |loss: 0.136273| train set 5.008x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 4, train time 8.02 s
Epoch 18/50 |loss: 0.135019| train set 5.008x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 5, train time 8.11 s
Epoch 19/50 |loss: 0.136733| train set 4.958x speedup, test set 3.715x speedup, val set 0.735x speedup, step: 1, train time 8.30 s
Epoch 20/50 |loss: 0.133270| train set 4.921x speedup, test set 3.776x speedup, val set 0.762x speedup, step: 2, train time 8.04 s
Epoch 21/50 |loss: 0.133974| train set 4.873x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.12 s
Epoch 22/50 |loss: 0.135719| train set 4.921x speedup, test set 5.722x speedup, val set 0.735x speedup, step: 4, train time 8.01 s
Epoch 23/50 |loss: 0.131954| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 5, train time 8.21 s
Epoch 24/50 |loss: 0.130468| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 6, train time 8.11 s
Epoch 25/50 |loss: 0.131879| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 7, train time 8.01 s
Epoch 26/50 |loss: 0.130675| train set 5.008x speedup, test set 3.715x speedup, val set 0.733x speedup, step: 8, train time 8.19 s
Epoch 27/50 |loss: 0.131619| train set 4.921x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 9, train time 8.10 s
Epoch 28/50 |loss: 0.129348| train set 5.008x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 10, train time 8.01 s
Epoch 29/50 |loss: 0.132365| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 11, train time 8.21 s
Epoch 30/50 |loss: 0.131117| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 12, train time 8.10 s
Epoch 31/50 |loss: 0.130952| train set 4.873x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 13, train time 8.21 s
Epoch 32/50 |loss: 0.127766| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 14, train time 8.12 s
Epoch 33/50 |loss: 0.129111| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 15, train time 8.01 s
Epoch 34/50 |loss: 0.127956| train set 5.008x speedup, test set 4.149x speedup, val set 0.733x speedup, step: 16, train time 8.11 s
Epoch 35/50 |loss: 0.128162| train set 5.008x speedup, test set 4.945x speedup, val set 0.729x speedup, step: 17, train time 8.21 s
Epoch 36/50 |loss: 0.128522| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 18, train time 8.12 s
Epoch 37/50 |loss: 0.129285| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 19, train time 8.01 s
Epoch 38/50 |loss: 0.130622| train set 4.958x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 20, train time 8.18 s
Epoch 39/50 |loss: 0.128133| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 21, train time 8.11 s
Epoch 40/50 |loss: 0.125195| train set 4.921x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 22, train time 8.28 s
Epoch 41/50 |loss: 0.127142| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 23, train time 8.38 s
Epoch 42/50 |loss: 0.127083| train set 4.958x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 24, train time 8.21 s
Epoch 43/50 |loss: 0.127431| train set 4.916x speedup, test set 4.149x speedup, val set 0.804x speedup, step: 25, train time 8.18 s
Epoch 44/50 |loss: 0.127799| train set 4.958x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 26, train time 8.02 s
Epoch 45/50 |loss: 0.128456| train set 5.000x speedup, test set 3.776x speedup, val set 0.739x speedup, step: 27, train time 8.01 s
Epoch 46/50 |loss: 0.127828| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 28, train time 8.02 s
Epoch 47/50 |loss: 0.125016| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 29, train time 8.21 s
Epoch 48/50 |loss: 0.126907| train set 4.958x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 30, train time 8.10 s
Epoch 49/50 |loss: 0.126101| train set 4.958x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 31, train time 8.30 s
early stopping at epoch 49
Training per epoch cost 8.158 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 9.462s, pg runtime 7.799s, speedup 0.824x
22, opt runtime 7.096s, model runtime 9.079s, pg runtime 7.096s, speedup 0.782x
23, opt runtime 7.063s, model runtime 9.862s, pg runtime 7.063s, speedup 0.716x
24, opt runtime 7.268s, model runtime 10.315s, pg runtime 7.268s, speedup 0.705x
25, opt runtime 6.854s, model runtime 10.279s, pg runtime 6.854s, speedup 0.667x
26, opt runtime 6.905s, model runtime 9.336s, pg runtime 6.905s, speedup 0.740x
27, opt runtime 6.663s, model runtime 9.628s, pg runtime 6.663s, speedup 0.692x
28, opt runtime 7.199s, model runtime 9.907s, pg runtime 7.619s, speedup 0.769x
29, opt runtime 7.066s, model runtime 9.776s, pg runtime 7.533s, speedup 0.771x
30, opt runtime 6.961s, model runtime 9.536s, pg runtime 6.961s, speedup 0.730x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 5.360, val speedup 1.000
best test speedup epoch: 22, train speedup 4.921, test speedup 5.722, val speedup 0.735
best validation speedup epoch: 19, train speedup 4.958, test speedup 3.715, val speedup 0.735
last model at epoch 49, train speedup 4.958, test speedup 3.776, val speedup 0.729
execution cost 0:07:14.925107
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.904731, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336543| train set 5.008x speedup, test set 5.360x speedup, val set 1.000x speedup, step: 1, train time 9.30 s
Epoch 1/50 |loss: 0.208803| train set 4.988x speedup, test set 5.239x speedup, val set 0.729x speedup, step: 2, train time 8.20 s
Epoch 2/50 |loss: 0.180849| train set 4.715x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 3, train time 8.10 s
Epoch 3/50 |loss: 0.170355| train set 5.007x speedup, test set 5.360x speedup, val set 0.981x speedup, step: 4, train time 7.99 s
Epoch 4/50 |loss: 0.162554| train set 4.808x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.07 s
Epoch 5/50 |loss: 0.157297| train set 4.630x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 8.06 s
Epoch 6/50 |loss: 0.151470| train set 5.000x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.09 s
Epoch 7/50 |loss: 0.148542| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 7.92 s
Epoch 8/50 |loss: 0.148064| train set 4.715x speedup, test set 4.149x speedup, val set 0.733x speedup, step: 5, train time 7.99 s
Epoch 9/50 |loss: 0.149185| train set 5.008x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 1, train time 8.17 s
Epoch 10/50 |loss: 0.143558| train set 4.921x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 2, train time 7.90 s
Epoch 11/50 |loss: 0.138683| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.11 s
Epoch 12/50 |loss: 0.141910| train set 5.008x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 4, train time 7.99 s
Epoch 13/50 |loss: 0.138542| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 5, train time 7.91 s
Epoch 14/50 |loss: 0.137207| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 7.92 s
Epoch 15/50 |loss: 0.137261| train set 4.921x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 2, train time 8.00 s
Epoch 16/50 |loss: 0.136776| train set 4.921x speedup, test set 5.816x speedup, val set 0.786x speedup, step: 3, train time 7.99 s
Epoch 17/50 |loss: 0.137490| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 8.01 s
Epoch 18/50 |loss: 0.133526| train set 5.008x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 5, train time 8.09 s
Epoch 19/50 |loss: 0.137115| train set 4.708x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 1, train time 8.10 s
Epoch 20/50 |loss: 0.133918| train set 4.921x speedup, test set 4.149x speedup, val set 0.804x speedup, step: 2, train time 7.99 s
Epoch 21/50 |loss: 0.133900| train set 4.873x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 3, train time 8.10 s
Epoch 22/50 |loss: 0.135904| train set 5.008x speedup, test set 5.988x speedup, val set 0.742x speedup, step: 4, train time 8.30 s
Epoch 23/50 |loss: 0.132517| train set 5.008x speedup, test set 5.988x speedup, val set 0.742x speedup, step: 5, train time 8.10 s
Epoch 24/50 |loss: 0.130261| train set 5.008x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 6, train time 8.11 s
Epoch 25/50 |loss: 0.132285| train set 5.008x speedup, test set 5.125x speedup, val set 0.786x speedup, step: 7, train time 8.19 s
Epoch 26/50 |loss: 0.131026| train set 5.004x speedup, test set 4.149x speedup, val set 0.746x speedup, step: 8, train time 8.01 s
Epoch 27/50 |loss: 0.132075| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 9, train time 8.20 s
Epoch 28/50 |loss: 0.129753| train set 5.008x speedup, test set 4.149x speedup, val set 0.746x speedup, step: 10, train time 8.22 s
Epoch 29/50 |loss: 0.134257| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 11, train time 8.17 s
Epoch 30/50 |loss: 0.133035| train set 5.008x speedup, test set 3.715x speedup, val set 0.733x speedup, step: 12, train time 8.11 s
Epoch 31/50 |loss: 0.130745| train set 4.873x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 13, train time 8.11 s
Epoch 32/50 |loss: 0.127582| train set 4.958x speedup, test set 5.125x speedup, val set 0.742x speedup, step: 14, train time 8.11 s
Epoch 33/50 |loss: 0.128942| train set 5.008x speedup, test set 4.149x speedup, val set 0.735x speedup, step: 15, train time 8.08 s
Epoch 34/50 |loss: 0.127638| train set 5.008x speedup, test set 4.149x speedup, val set 0.739x speedup, step: 16, train time 8.09 s
Epoch 35/50 |loss: 0.128450| train set 5.008x speedup, test set 5.239x speedup, val set 0.733x speedup, step: 17, train time 8.02 s
Epoch 36/50 |loss: 0.129564| train set 5.008x speedup, test set 3.715x speedup, val set 0.746x speedup, step: 18, train time 8.20 s
Epoch 37/50 |loss: 0.129020| train set 4.917x speedup, test set 4.149x speedup, val set 0.742x speedup, step: 19, train time 8.11 s
Epoch 38/50 |loss: 0.130119| train set 4.958x speedup, test set 6.088x speedup, val set 0.735x speedup, step: 20, train time 8.11 s
Epoch 39/50 |loss: 0.128154| train set 5.008x speedup, test set 5.360x speedup, val set 0.735x speedup, step: 21, train time 8.11 s
Epoch 40/50 |loss: 0.125873| train set 5.008x speedup, test set 4.149x speedup, val set 0.746x speedup, step: 22, train time 8.21 s
Epoch 41/50 |loss: 0.127562| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 23, train time 8.31 s
Epoch 42/50 |loss: 0.126942| train set 4.958x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 24, train time 8.12 s
Epoch 43/50 |loss: 0.126538| train set 4.917x speedup, test set 4.149x speedup, val set 0.786x speedup, step: 25, train time 8.21 s
Epoch 44/50 |loss: 0.127582| train set 4.958x speedup, test set 4.149x speedup, val set 0.739x speedup, step: 26, train time 8.10 s
Epoch 45/50 |loss: 0.128817| train set 5.000x speedup, test set 4.149x speedup, val set 0.742x speedup, step: 27, train time 8.10 s
Epoch 46/50 |loss: 0.127330| train set 4.921x speedup, test set 4.149x speedup, val set 0.739x speedup, step: 28, train time 8.40 s
Epoch 47/50 |loss: 0.125740| train set 5.008x speedup, test set 4.663x speedup, val set 0.739x speedup, step: 29, train time 8.29 s
Epoch 48/50 |loss: 0.127869| train set 4.958x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 30, train time 8.10 s
Epoch 49/50 |loss: 0.126791| train set 4.958x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 31, train time 8.10 s
early stopping at epoch 49
Training per epoch cost 8.127 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 9.462s, pg runtime 7.799s, speedup 0.824x
22, opt runtime 7.096s, model runtime 9.079s, pg runtime 7.096s, speedup 0.782x
23, opt runtime 7.063s, model runtime 9.862s, pg runtime 7.063s, speedup 0.716x
24, opt runtime 7.268s, model runtime 10.315s, pg runtime 7.268s, speedup 0.705x
25, opt runtime 6.854s, model runtime 10.279s, pg runtime 6.854s, speedup 0.667x
26, opt runtime 6.905s, model runtime 9.336s, pg runtime 6.905s, speedup 0.740x
27, opt runtime 6.663s, model runtime 9.628s, pg runtime 6.663s, speedup 0.692x
28, opt runtime 7.199s, model runtime 9.907s, pg runtime 7.619s, speedup 0.769x
29, opt runtime 7.066s, model runtime 9.776s, pg runtime 7.533s, speedup 0.771x
30, opt runtime 6.961s, model runtime 9.536s, pg runtime 6.961s, speedup 0.730x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 5.360, val speedup 1.000
best test speedup epoch: 38, train speedup 4.958, test speedup 6.088, val speedup 0.735
best validation speedup epoch: 19, train speedup 4.708, test speedup 3.715, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 3.776, val speedup 0.733
execution cost 0:07:12.829396
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.880552, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 5.360x speedup, val set 1.008x speedup, step: 1, train time 9.16 s
Epoch 1/50 |loss: 0.206117| train set 4.864x speedup, test set 3.910x speedup, val set 1.033x speedup, step: 2, train time 8.20 s
Epoch 2/50 |loss: 0.179596| train set 4.638x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 3, train time 8.03 s
Epoch 3/50 |loss: 0.171231| train set 5.007x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 7.91 s
Epoch 4/50 |loss: 0.159420| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.20 s
Epoch 5/50 |loss: 0.157377| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 2, train time 8.00 s
Epoch 6/50 |loss: 0.154014| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.12 s
Epoch 7/50 |loss: 0.147734| train set 4.921x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 7.91 s
Epoch 8/50 |loss: 0.149925| train set 4.697x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 5, train time 8.00 s
Epoch 9/50 |loss: 0.148510| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.17 s
Epoch 10/50 |loss: 0.144634| train set 5.008x speedup, test set 4.256x speedup, val set 0.729x speedup, step: 2, train time 7.97 s
Epoch 11/50 |loss: 0.139080| train set 5.007x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 3, train time 7.99 s
Epoch 12/50 |loss: 0.141527| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 8.18 s
Epoch 13/50 |loss: 0.138588| train set 5.008x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 5, train time 8.07 s
Epoch 14/50 |loss: 0.137961| train set 4.921x speedup, test set 3.722x speedup, val set 0.729x speedup, step: 1, train time 8.08 s
Epoch 15/50 |loss: 0.138722| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 2, train time 8.01 s
Epoch 16/50 |loss: 0.137061| train set 4.921x speedup, test set 3.715x speedup, val set 0.735x speedup, step: 3, train time 8.21 s
Epoch 17/50 |loss: 0.137657| train set 5.008x speedup, test set 0.844x speedup, val set 0.729x speedup, step: 4, train time 8.10 s
Epoch 18/50 |loss: 0.134646| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 5, train time 8.17 s
Epoch 19/50 |loss: 0.136068| train set 4.958x speedup, test set 4.256x speedup, val set 0.729x speedup, step: 1, train time 8.01 s
Epoch 20/50 |loss: 0.134344| train set 4.921x speedup, test set 4.149x speedup, val set 0.742x speedup, step: 2, train time 8.20 s
Epoch 21/50 |loss: 0.133738| train set 4.873x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 3, train time 8.02 s
Epoch 22/50 |loss: 0.136494| train set 5.008x speedup, test set 4.076x speedup, val set 0.735x speedup, step: 4, train time 8.18 s
Epoch 23/50 |loss: 0.132458| train set 5.008x speedup, test set 4.076x speedup, val set 0.729x speedup, step: 5, train time 8.22 s
Epoch 24/50 |loss: 0.131366| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.30 s
Epoch 25/50 |loss: 0.132347| train set 5.008x speedup, test set 0.844x speedup, val set 0.735x speedup, step: 2, train time 8.10 s
Epoch 26/50 |loss: 0.132294| train set 5.007x speedup, test set 4.076x speedup, val set 0.742x speedup, step: 3, train time 8.30 s
Epoch 27/50 |loss: 0.131631| train set 4.921x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 8.20 s
Epoch 28/50 |loss: 0.129521| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 5, train time 8.12 s
Epoch 29/50 |loss: 0.130991| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 1, train time 8.29 s
Epoch 30/50 |loss: 0.131753| train set 5.008x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 2, train time 8.17 s
Epoch 31/50 |loss: 0.130982| train set 4.958x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.18 s
Epoch 32/50 |loss: 0.127835| train set 5.008x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 4, train time 8.01 s
Epoch 33/50 |loss: 0.129202| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 5, train time 8.00 s
Epoch 34/50 |loss: 0.128359| train set 5.008x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 1, train time 8.11 s
Epoch 35/50 |loss: 0.128826| train set 4.753x speedup, test set 5.090x speedup, val set 0.729x speedup, step: 2, train time 8.20 s
Epoch 36/50 |loss: 0.129306| train set 5.008x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 3, train time 8.10 s
Epoch 37/50 |loss: 0.128723| train set 4.920x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 4, train time 8.20 s
Epoch 38/50 |loss: 0.131063| train set 4.958x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 5, train time 8.09 s
Epoch 39/50 |loss: 0.128390| train set 5.008x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 1, train time 8.08 s
Epoch 40/50 |loss: 0.125669| train set 4.921x speedup, test set 3.715x speedup, val set 0.742x speedup, step: 2, train time 8.20 s
Epoch 41/50 |loss: 0.127497| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 3, train time 8.30 s
Epoch 42/50 |loss: 0.127262| train set 4.958x speedup, test set 3.715x speedup, val set 0.729x speedup, step: 4, train time 8.21 s
Epoch 43/50 |loss: 0.127090| train set 4.921x speedup, test set 4.149x speedup, val set 0.786x speedup, step: 5, train time 8.11 s
Epoch 44/50 |loss: 0.127184| train set 4.958x speedup, test set 3.732x speedup, val set 0.739x speedup, step: 1, train time 8.22 s
Epoch 45/50 |loss: 0.127660| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 2, train time 8.29 s
Epoch 46/50 |loss: 0.127728| train set 4.921x speedup, test set 4.149x speedup, val set 0.729x speedup, step: 3, train time 8.20 s
Epoch 47/50 |loss: 0.125629| train set 5.008x speedup, test set 4.305x speedup, val set 0.746x speedup, step: 4, train time 8.28 s
Epoch 48/50 |loss: 0.127231| train set 4.958x speedup, test set 3.776x speedup, val set 0.739x speedup, step: 5, train time 8.20 s
Epoch 49/50 |loss: 0.126177| train set 4.958x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 6, train time 8.19 s
early stopping at epoch 49
Training per epoch cost 8.155 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 9.079s, pg runtime 7.096s, speedup 0.782x
23, opt runtime 7.063s, model runtime 9.862s, pg runtime 7.063s, speedup 0.716x
24, opt runtime 7.268s, model runtime 10.315s, pg runtime 7.268s, speedup 0.705x
25, opt runtime 6.854s, model runtime 10.279s, pg runtime 6.854s, speedup 0.667x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 9.907s, pg runtime 7.619s, speedup 0.769x
29, opt runtime 7.066s, model runtime 9.776s, pg runtime 7.533s, speedup 0.771x
30, opt runtime 6.961s, model runtime 9.536s, pg runtime 6.961s, speedup 0.730x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 5.360, val speedup 1.008
best test speedup epoch: 0, train speedup 5.008, test speedup 5.360, val speedup 1.008
best validation speedup epoch: 44, train speedup 4.958, test speedup 3.732, val speedup 0.739
last model at epoch 49, train speedup 4.958, test speedup 3.776, val speedup 0.733
execution cost 0:07:13.234682
==================================================
all print will write to path record/postgresql/TPCH/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.915340, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336394| train set 5.008x speedup, test set 5.360x speedup, val set 1.008x speedup, step: 1, train time 9.43 s
Epoch 1/50 |loss: 0.208996| train set 4.864x speedup, test set 5.360x speedup, val set 0.957x speedup, step: 2, train time 8.20 s
Epoch 2/50 |loss: 0.179845| train set 4.638x speedup, test set 1.323x speedup, val set 0.729x speedup, step: 3, train time 8.02 s
Epoch 3/50 |loss: 0.169399| train set 5.008x speedup, test set 3.776x speedup, val set 1.033x speedup, step: 4, train time 7.92 s
Epoch 4/50 |loss: 0.162529| train set 5.008x speedup, test set 1.323x speedup, val set 0.742x speedup, step: 1, train time 7.90 s
Epoch 5/50 |loss: 0.156931| train set 4.958x speedup, test set 4.305x speedup, val set 0.729x speedup, step: 2, train time 8.00 s
Epoch 6/50 |loss: 0.152192| train set 5.008x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 3, train time 8.02 s
Epoch 7/50 |loss: 0.146856| train set 4.921x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 4, train time 7.92 s
Epoch 8/50 |loss: 0.150626| train set 4.697x speedup, test set 3.776x speedup, val set 0.746x speedup, step: 5, train time 8.10 s
Epoch 9/50 |loss: 0.148964| train set 5.005x speedup, test set 5.360x speedup, val set 0.729x speedup, step: 6, train time 8.01 s
Epoch 10/50 |loss: 0.143145| train set 5.008x speedup, test set 4.387x speedup, val set 0.735x speedup, step: 7, train time 8.01 s
Epoch 11/50 |loss: 0.138222| train set 5.007x speedup, test set 3.715x speedup, val set 0.983x speedup, step: 8, train time 7.99 s
Epoch 12/50 |loss: 0.141495| train set 5.008x speedup, test set 4.387x speedup, val set 0.754x speedup, step: 9, train time 8.08 s
Epoch 13/50 |loss: 0.138432| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 10, train time 8.17 s
Epoch 14/50 |loss: 0.137686| train set 4.873x speedup, test set 4.305x speedup, val set 0.729x speedup, step: 11, train time 8.13 s
Epoch 15/50 |loss: 0.137715| train set 4.921x speedup, test set 4.305x speedup, val set 0.742x speedup, step: 12, train time 8.02 s
Epoch 16/50 |loss: 0.136774| train set 4.921x speedup, test set 4.387x speedup, val set 0.742x speedup, step: 13, train time 8.08 s
Epoch 17/50 |loss: 0.136399| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 14, train time 8.11 s
Epoch 18/50 |loss: 0.134305| train set 5.008x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 15, train time 8.21 s
Epoch 19/50 |loss: 0.134774| train set 4.958x speedup, test set 3.776x speedup, val set 0.735x speedup, step: 16, train time 8.01 s
Epoch 20/50 |loss: 0.133336| train set 4.921x speedup, test set 4.387x speedup, val set 0.762x speedup, step: 17, train time 8.22 s
Epoch 21/50 |loss: 0.134687| train set 4.873x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 18, train time 8.11 s
Epoch 22/50 |loss: 0.137288| train set 4.921x speedup, test set 6.184x speedup, val set 0.742x speedup, step: 19, train time 8.02 s
Epoch 23/50 |loss: 0.133093| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 20, train time 8.18 s
Epoch 24/50 |loss: 0.130137| train set 5.008x speedup, test set 3.776x speedup, val set 0.729x speedup, step: 21, train time 8.11 s
Epoch 25/50 |loss: 0.131528| train set 5.008x speedup, test set 0.844x speedup, val set 0.742x speedup, step: 22, train time 8.03 s
Epoch 26/50 |loss: 0.130985| train set 5.007x speedup, test set 0.841x speedup, val set 0.767x speedup, step: 23, train time 8.07 s
Epoch 27/50 |loss: 0.132191| train set 4.873x speedup, test set 3.776x speedup, val set 0.733x speedup, step: 24, train time 7.99 s
Epoch 28/50 |loss: 0.129145| train set 5.008x speedup, test set 3.776x speedup, val set 0.746x speedup, step: 25, train time 8.02 s
Epoch 29/50 |loss: 0.131964| train set 5.008x speedup, test set 0.844x speedup, val set 0.729x speedup, step: 26, train time 8.00 s
Epoch 30/50 |loss: 0.131287| train set 5.008x speedup, test set 0.844x speedup, val set 0.739x speedup, step: 27, train time 8.01 s
Epoch 31/50 |loss: 0.129355| train set 4.958x speedup, test set 3.776x speedup, val set 0.742x speedup, step: 28, train time 8.01 s
Epoch 32/50 |loss: 0.127674| train set 5.004x speedup, test set 4.387x speedup, val set 0.729x speedup, step: 29, train time 7.91 s
Epoch 33/50 |loss: 0.130013| train set 5.008x speedup, test set 6.681x speedup, val set 0.729x speedup, step: 30, train time 8.00 s
Epoch 34/50 |loss: 0.127427| train set 5.008x speedup, test set 4.149x speedup, val set 0.735x speedup, step: 31, train time 8.01 s
Epoch 35/50 |loss: 0.128595| train set 5.008x speedup, test set 0.900x speedup, val set 0.729x speedup, step: 32, train time 8.08 s
Epoch 36/50 |loss: 0.129320| train set 5.008x speedup, test set 4.387x speedup, val set 0.804x speedup, step: 33, train time 8.38 s
Epoch 37/50 |loss: 0.129367| train set 5.008x speedup, test set 4.387x speedup, val set 0.733x speedup, step: 34, train time 8.19 s
early stopping at epoch 37
Training per epoch cost 8.097 s
Optimal speedup on test set is 11.825x
01, opt runtime 18.392s, model runtime 70.813s, pg runtime 18.392s, speedup 0.260x
02, opt runtime 23.961s, model runtime 65.782s, pg runtime 32.278s, speedup 0.491x
03, opt runtime 17.779s, model runtime 67.652s, pg runtime 17.779s, speedup 0.263x
04, opt runtime 25.597s, model runtime 61.712s, pg runtime 27.136s, speedup 0.440x
05, opt runtime 14.857s, model runtime 69.366s, pg runtime 14.857s, speedup 0.214x
06, opt runtime 19.263s, model runtime 66.156s, pg runtime 19.263s, speedup 0.291x
07, opt runtime 15.831s, model runtime 58.181s, pg runtime 15.831s, speedup 0.272x
08, opt runtime 9.432s, model runtime 67.176s, pg runtime 9.432s, speedup 0.140x
09, opt runtime 26.874s, model runtime 71.579s, pg runtime 26.874s, speedup 0.375x
10, opt runtime 21.143s, model runtime 66.849s, pg runtime 21.143s, speedup 0.316x
11, opt runtime 7.237s, model runtime 17.708s, pg runtime 17.708s, speedup 1.000x
12, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
13, opt runtime 7.851s, model runtime 13.622s, pg runtime 13.622s, speedup 1.000x
14, opt runtime 7.442s, model runtime 14.838s, pg runtime 14.838s, speedup 1.000x
15, opt runtime 7.110s, model runtime 14.286s, pg runtime 14.286s, speedup 1.000x
16, opt runtime 6.810s, model runtime 13.796s, pg runtime 13.796s, speedup 1.000x
17, opt runtime 6.460s, model runtime 16.134s, pg runtime 16.134s, speedup 1.000x
18, opt runtime 6.656s, model runtime 15.260s, pg runtime 15.260s, speedup 1.000x
19, opt runtime 7.913s, model runtime 15.548s, pg runtime 15.548s, speedup 1.000x
20, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
21, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
22, opt runtime 7.096s, model runtime 7.096s, pg runtime 7.096s, speedup 1.000x
23, opt runtime 7.063s, model runtime 7.063s, pg runtime 7.063s, speedup 1.000x
24, opt runtime 7.268s, model runtime 7.268s, pg runtime 7.268s, speedup 1.000x
25, opt runtime 6.854s, model runtime 6.854s, pg runtime 6.854s, speedup 1.000x
26, opt runtime 6.905s, model runtime 6.905s, pg runtime 6.905s, speedup 1.000x
27, opt runtime 6.663s, model runtime 6.663s, pg runtime 6.663s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 7.066s, model runtime 7.533s, pg runtime 7.533s, speedup 1.000x
30, opt runtime 6.961s, model runtime 6.961s, pg runtime 6.961s, speedup 1.000x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 5.360, val speedup 1.008
best test speedup epoch: 21, train speedup 4.873, test speedup 6.681, val speedup 0.729
best validation speedup epoch: 4, train speedup 5.008, test speedup 1.323, val speedup 0.742
last model at epoch 37, train speedup 5.008, test speedup 4.387, val speedup 0.733
execution cost 0:05:28.626457
==================================================
