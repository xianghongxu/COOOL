all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.879760, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265707| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655592| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191648| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782269| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315985| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842960| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317862| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803158| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291479| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819450| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.348015| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.856348| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.355169| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.876110| train set 4.376x speedup, test set 4.618x speedup, val set 4.468x speedup, step: 19
Epoch 19/200 |loss: 15.421858| train set 4.815x speedup, test set 5.073x speedup, val set 4.897x speedup, step: 20
Epoch 20/200 |loss: 15.064102| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 21
Epoch 21/200 |loss: 14.959160| train set 4.880x speedup, test set 5.070x speedup, val set 5.054x speedup, step: 22
Epoch 22/200 |loss: 14.677857| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 23
Epoch 23/200 |loss: 13.911055| train set 5.049x speedup, test set 5.188x speedup, val set 5.284x speedup, step: 24
Epoch 24/200 |loss: 13.834606| train set 5.121x speedup, test set 5.403x speedup, val set 5.129x speedup, step: 25
Epoch 25/200 |loss: 13.477600| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 26
Epoch 26/200 |loss: 12.947465| train set 5.321x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 27
Epoch 27/200 |loss: 12.784565| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 28
Epoch 28/200 |loss: 12.361934| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 29
Epoch 29/200 |loss: 11.959085| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 30
Epoch 30/200 |loss: 11.849435| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.583488| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 32
Epoch 32/200 |loss: 11.423550| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 33
Epoch 33/200 |loss: 11.462826| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 34
Epoch 34/200 |loss: 11.619344| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 35
Epoch 35/200 |loss: 10.822673| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 36
Epoch 36/200 |loss: 11.287405| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 37
Epoch 37/200 |loss: 10.431465| train set 5.058x speedup, test set 5.391x speedup, val set 5.160x speedup, step: 38
Epoch 38/200 |loss: 10.742523| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 39
Epoch 39/200 |loss: 10.298601| train set 5.255x speedup, test set 5.487x speedup, val set 5.332x speedup, step: 40
Epoch 40/200 |loss: 10.515862| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 41
Epoch 41/200 |loss: 10.344071| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 42
Epoch 42/200 |loss: 9.810811| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 43
Epoch 43/200 |loss: 9.847866| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 44
Epoch 44/200 |loss: 9.671151| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 45
Epoch 45/200 |loss: 9.488449| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 46
Epoch 46/200 |loss: 9.316002| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 47
Epoch 47/200 |loss: 9.365129| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 48
Epoch 48/200 |loss: 9.226369| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 49
Epoch 49/200 |loss: 8.949195| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 50
Epoch 50/200 |loss: 8.900130| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 51
Epoch 51/200 |loss: 8.908515| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 52
Epoch 52/200 |loss: 8.672235| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 53
Epoch 53/200 |loss: 8.830422| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 54
Epoch 54/200 |loss: 8.586184| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 55
Epoch 55/200 |loss: 8.450349| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 56
Epoch 56/200 |loss: 8.493201| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 57
Epoch 57/200 |loss: 8.427853| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 58
Epoch 58/200 |loss: 8.474251| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 59
Epoch 59/200 |loss: 8.740538| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 60
Epoch 60/200 |loss: 8.892452| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 61
Epoch 61/200 |loss: 8.750210| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 62
Epoch 62/200 |loss: 8.199323| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 63
Epoch 63/200 |loss: 8.544830| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 64
Epoch 64/200 |loss: 8.724070| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 65
Epoch 65/200 |loss: 8.137568| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 66
Epoch 66/200 |loss: 8.611931| train set 5.325x speedup, test set 5.562x speedup, val set 5.399x speedup, step: 67
Epoch 67/200 |loss: 8.599258| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 68
Epoch 68/200 |loss: 8.361863| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 69
Epoch 69/200 |loss: 8.391209| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 70/200 |loss: 8.295277| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 8.041106| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 72
Epoch 72/200 |loss: 8.228063| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 73
Epoch 73/200 |loss: 8.042958| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 74
Epoch 74/200 |loss: 8.455908| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 75
Epoch 75/200 |loss: 8.117946| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 76
Epoch 76/200 |loss: 8.141705| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 77
Epoch 77/200 |loss: 7.834559| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 78
Epoch 78/200 |loss: 8.097034| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 79
Epoch 79/200 |loss: 8.357108| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 80
Epoch 80/200 |loss: 7.847044| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 81
Epoch 81/200 |loss: 8.485030| train set 5.082x speedup, test set 5.364x speedup, val set 5.252x speedup, step: 82
Epoch 82/200 |loss: 8.637617| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 83
Epoch 83/200 |loss: 8.278250| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 84
Epoch 84/200 |loss: 8.278160| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 85
Epoch 85/200 |loss: 8.049458| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 86
Epoch 86/200 |loss: 7.974228| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 87
Epoch 87/200 |loss: 7.936419| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 88
Epoch 88/200 |loss: 7.908578| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 89
Epoch 89/200 |loss: 7.807466| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 90
Epoch 90/200 |loss: 7.817098| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 91
Epoch 91/200 |loss: 7.710064| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 92
Epoch 92/200 |loss: 7.758638| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 93
Epoch 93/200 |loss: 7.586157| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 94
Epoch 94/200 |loss: 7.718364| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 95
Epoch 95/200 |loss: 7.536060| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 96
Epoch 96/200 |loss: 7.618557| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 97
Epoch 97/200 |loss: 7.494462| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 98
Epoch 98/200 |loss: 7.547431| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 99
Epoch 99/200 |loss: 7.458247| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 100
Epoch 100/200 |loss: 7.490771| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 101/200 |loss: 7.449398| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 102/200 |loss: 7.431427| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 103/200 |loss: 7.421206| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 104/200 |loss: 7.392401| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 105/200 |loss: 7.446177| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 106/200 |loss: 7.533536| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 107/200 |loss: 8.047324| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 2
Epoch 108/200 |loss: 7.863738| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 109/200 |loss: 7.803123| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 110/200 |loss: 7.397542| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 3
Epoch 111/200 |loss: 7.890548| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 4
Epoch 112/200 |loss: 7.919356| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5
Epoch 113/200 |loss: 7.617611| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 6
Epoch 114/200 |loss: 7.895116| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 115/200 |loss: 7.518915| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 116/200 |loss: 7.579685| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 117/200 |loss: 7.602866| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 10
Epoch 118/200 |loss: 7.444147| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11
Epoch 119/200 |loss: 7.575215| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12
Epoch 120/200 |loss: 7.418213| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13
Epoch 121/200 |loss: 7.469681| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 122/200 |loss: 7.445410| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 123/200 |loss: 7.354604| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3
Epoch 124/200 |loss: 7.454122| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4
Epoch 125/200 |loss: 7.371965| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5
Epoch 126/200 |loss: 7.348879| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6
Epoch 127/200 |loss: 7.406618| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 7
Epoch 128/200 |loss: 7.337009| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 8
Epoch 129/200 |loss: 7.296956| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9
Epoch 130/200 |loss: 7.380204| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 131/200 |loss: 7.330654| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11
Epoch 132/200 |loss: 7.276505| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12
Epoch 133/200 |loss: 7.344702| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 13
Epoch 134/200 |loss: 7.374062| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 14
Epoch 135/200 |loss: 7.245247| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 15
Epoch 136/200 |loss: 7.366000| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16
Epoch 137/200 |loss: 7.447062| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 17
Epoch 138/200 |loss: 7.421576| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 18
Epoch 139/200 |loss: 7.539793| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19
Epoch 140/200 |loss: 7.688047| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 20
Epoch 141/200 |loss: 7.261016| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 21
Epoch 142/200 |loss: 7.602488| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 22
Epoch 143/200 |loss: 7.691930| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 23
Epoch 144/200 |loss: 7.420180| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 24
Epoch 145/200 |loss: 7.688636| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 25
Epoch 146/200 |loss: 7.431561| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26
Epoch 147/200 |loss: 7.612859| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 27
Epoch 148/200 |loss: 7.334520| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 28
Epoch 149/200 |loss: 7.502724| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 29
Epoch 150/200 |loss: 7.459804| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 30
Epoch 151/200 |loss: 7.334026| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 31
Epoch 152/200 |loss: 7.470074| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 32
Epoch 153/200 |loss: 7.297255| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 33
Epoch 154/200 |loss: 7.421260| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 34
Epoch 155/200 |loss: 7.248115| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 35
Epoch 156/200 |loss: 7.431746| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 36
Epoch 157/200 |loss: 7.270345| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 37
Epoch 158/200 |loss: 7.317158| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 38
Epoch 159/200 |loss: 7.262626| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 39
Epoch 160/200 |loss: 7.286917| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 40
Epoch 161/200 |loss: 7.242642| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 41
Epoch 162/200 |loss: 7.225501| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 42
Epoch 163/200 |loss: 7.250089| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 43
Epoch 164/200 |loss: 7.244184| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 44
Epoch 165/200 |loss: 7.229270| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 45
Epoch 166/200 |loss: 7.214811| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 46
Epoch 167/200 |loss: 7.211705| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 47
Epoch 168/200 |loss: 7.214132| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 48
Epoch 169/200 |loss: 7.230423| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 49
Epoch 170/200 |loss: 7.190965| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 50
Epoch 171/200 |loss: 7.173446| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 51
Epoch 172/200 |loss: 7.184582| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 52
Epoch 173/200 |loss: 7.178871| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 53
Epoch 174/200 |loss: 7.210216| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 54
Epoch 175/200 |loss: 7.209976| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 55
Epoch 176/200 |loss: 7.189889| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 56
Epoch 177/200 |loss: 7.195385| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 57
Epoch 178/200 |loss: 7.139256| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 58
Epoch 179/200 |loss: 7.166565| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 59
Epoch 180/200 |loss: 7.137031| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 60
Epoch 181/200 |loss: 7.170028| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 61
Epoch 182/200 |loss: 7.218292| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 62
Epoch 183/200 |loss: 7.231692| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 63
Epoch 184/200 |loss: 7.316787| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 64
Epoch 185/200 |loss: 7.276568| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 65
Epoch 186/200 |loss: 7.340896| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 66
Epoch 187/200 |loss: 7.198997| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 188/200 |loss: 7.216623| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 68
Epoch 189/200 |loss: 7.265530| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 69
Epoch 190/200 |loss: 7.322481| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 70
Epoch 191/200 |loss: 7.462450| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 192/200 |loss: 7.282615| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 72
Epoch 193/200 |loss: 7.228368| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 73
Epoch 194/200 |loss: 7.212217| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 74
Epoch 195/200 |loss: 7.303066| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 75
Epoch 196/200 |loss: 7.491102| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 76
Epoch 197/200 |loss: 7.269891| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 77
Epoch 198/200 |loss: 7.381642| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 78
Epoch 199/200 |loss: 7.609402| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 79
Training per epoch cost 0.207 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 56, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 66, train speedup 5.325, test speedup 5.562, val speedup 5.399
best validation speedup epoch: 121, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 199, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:02:08.624660
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.918196, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265709| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655590| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191648| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782267| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315981| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842957| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317846| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803158| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291454| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819803| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.347839| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.855747| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.351021| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.868466| train set 4.376x speedup, test set 4.618x speedup, val set 4.468x speedup, step: 19
Epoch 19/200 |loss: 15.435192| train set 4.857x speedup, test set 5.092x speedup, val set 4.968x speedup, step: 20
Epoch 20/200 |loss: 15.173585| train set 4.631x speedup, test set 4.867x speedup, val set 4.772x speedup, step: 21
Epoch 21/200 |loss: 15.007608| train set 4.880x speedup, test set 5.069x speedup, val set 5.054x speedup, step: 22
Epoch 22/200 |loss: 14.359833| train set 4.880x speedup, test set 5.070x speedup, val set 5.054x speedup, step: 23
Epoch 23/200 |loss: 13.916826| train set 5.042x speedup, test set 5.371x speedup, val set 5.125x speedup, step: 24
Epoch 24/200 |loss: 13.817933| train set 5.249x speedup, test set 5.477x speedup, val set 5.460x speedup, step: 25
Epoch 25/200 |loss: 13.256851| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 26
Epoch 26/200 |loss: 12.950207| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 27
Epoch 27/200 |loss: 12.686491| train set 5.264x speedup, test set 5.496x speedup, val set 5.498x speedup, step: 28
Epoch 28/200 |loss: 12.353288| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 29
Epoch 29/200 |loss: 12.166514| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 30
Epoch 30/200 |loss: 11.837647| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.645726| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 32
Epoch 32/200 |loss: 11.429134| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 33
Epoch 33/200 |loss: 11.182300| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 34
Epoch 34/200 |loss: 10.842856| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 35
Epoch 35/200 |loss: 10.687757| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 36
Epoch 36/200 |loss: 10.703307| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 37
Epoch 37/200 |loss: 11.012232| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 38
Epoch 38/200 |loss: 10.416179| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 39
Epoch 39/200 |loss: 10.126957| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 40
Epoch 40/200 |loss: 10.093636| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 41
Epoch 41/200 |loss: 9.869622| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 42
Epoch 42/200 |loss: 9.638033| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 43
Epoch 43/200 |loss: 9.662195| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 44
Epoch 44/200 |loss: 9.392950| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 45
Epoch 45/200 |loss: 9.257538| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 46
Epoch 46/200 |loss: 9.021456| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 47
Epoch 47/200 |loss: 9.073712| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 48
Epoch 48/200 |loss: 8.994918| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 49
Epoch 49/200 |loss: 8.993908| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 50
Epoch 50/200 |loss: 9.097980| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 51
Epoch 51/200 |loss: 8.775852| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 52
Epoch 52/200 |loss: 9.238405| train set 5.058x speedup, test set 5.392x speedup, val set 5.160x speedup, step: 53
Epoch 53/200 |loss: 9.634121| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 54
Epoch 54/200 |loss: 8.991715| train set 5.268x speedup, test set 5.501x speedup, val set 5.365x speedup, step: 55
Epoch 55/200 |loss: 8.931818| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 56
Epoch 56/200 |loss: 8.856405| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 57
Epoch 57/200 |loss: 8.603846| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 58
Epoch 58/200 |loss: 8.551332| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 59
Epoch 59/200 |loss: 8.563869| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 60
Epoch 60/200 |loss: 8.220566| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 61
Epoch 61/200 |loss: 8.551955| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 62
Epoch 62/200 |loss: 8.349401| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 63
Epoch 63/200 |loss: 8.358206| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 64
Epoch 64/200 |loss: 8.206455| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 65
Epoch 65/200 |loss: 8.182314| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 66
Epoch 66/200 |loss: 8.108329| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 67
Epoch 67/200 |loss: 7.997243| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 68
Epoch 68/200 |loss: 7.982213| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 69
Epoch 69/200 |loss: 7.909186| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 70
Epoch 70/200 |loss: 7.880581| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 7.854246| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 72
Epoch 72/200 |loss: 7.840229| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 73
Epoch 73/200 |loss: 7.842912| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 74
Epoch 74/200 |loss: 8.038743| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 75
Epoch 75/200 |loss: 8.444082| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 76
Epoch 76/200 |loss: 9.034273| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 77
Epoch 77/200 |loss: 7.940548| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 78
Epoch 78/200 |loss: 8.575853| train set 5.265x speedup, test set 5.505x speedup, val set 5.495x speedup, step: 79
Epoch 79/200 |loss: 8.973166| train set 5.326x speedup, test set 5.559x speedup, val set 5.400x speedup, step: 80
Epoch 80/200 |loss: 8.101181| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 81
Epoch 81/200 |loss: 8.875072| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 82
Epoch 82/200 |loss: 8.374447| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 83
Epoch 83/200 |loss: 8.393893| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 84
Epoch 84/200 |loss: 8.154757| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 85
Epoch 85/200 |loss: 8.215914| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 86
Epoch 86/200 |loss: 8.213016| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 87
Epoch 87/200 |loss: 7.867982| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 88
Epoch 88/200 |loss: 7.995265| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 89
Epoch 89/200 |loss: 7.875068| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 90
Epoch 90/200 |loss: 7.979026| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 91
Epoch 91/200 |loss: 7.759901| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 92
Epoch 92/200 |loss: 7.883540| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 93
Epoch 93/200 |loss: 7.685149| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 94
Epoch 94/200 |loss: 7.801907| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 95
Epoch 95/200 |loss: 7.548368| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 96
Epoch 96/200 |loss: 7.725144| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 97
Epoch 97/200 |loss: 7.571092| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 98
Epoch 98/200 |loss: 7.660496| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 99
Epoch 99/200 |loss: 7.575607| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 100
Epoch 100/200 |loss: 7.552532| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 101/200 |loss: 7.497982| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 102/200 |loss: 7.485975| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 103/200 |loss: 7.447618| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 104/200 |loss: 7.447618| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 105/200 |loss: 7.394476| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 106/200 |loss: 7.422215| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 107/200 |loss: 7.413894| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 108/200 |loss: 7.545949| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2
Epoch 109/200 |loss: 7.655155| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 110/200 |loss: 8.027043| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 111/200 |loss: 7.784133| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3
Epoch 112/200 |loss: 7.412354| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 113/200 |loss: 7.605016| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 5
Epoch 114/200 |loss: 7.675982| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6
Epoch 115/200 |loss: 7.491187| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 7
Epoch 116/200 |loss: 7.437482| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 8
Epoch 117/200 |loss: 7.665774| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9
Epoch 118/200 |loss: 7.882819| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 10
Epoch 119/200 |loss: 7.515733| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 11
Epoch 120/200 |loss: 7.950620| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12
Epoch 121/200 |loss: 7.518637| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 13
Epoch 122/200 |loss: 7.656422| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 14
Epoch 123/200 |loss: 7.457637| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 15
Epoch 124/200 |loss: 7.555998| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16
Epoch 125/200 |loss: 7.456451| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 17
Epoch 126/200 |loss: 7.480217| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 18
Epoch 127/200 |loss: 7.410816| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19
Epoch 128/200 |loss: 7.410195| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20
Epoch 129/200 |loss: 7.404376| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21
Epoch 130/200 |loss: 7.433419| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 22
Epoch 131/200 |loss: 7.466791| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 23
Epoch 132/200 |loss: 7.508131| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 24
Epoch 133/200 |loss: 7.424024| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 25
Epoch 134/200 |loss: 7.403483| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26
Epoch 135/200 |loss: 7.360535| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 27
Epoch 136/200 |loss: 7.301952| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28
Epoch 137/200 |loss: 7.307910| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29
Epoch 138/200 |loss: 7.341711| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 30
Epoch 139/200 |loss: 7.358348| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 31
Epoch 140/200 |loss: 7.332296| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 32
Epoch 141/200 |loss: 7.232154| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 33
Epoch 142/200 |loss: 7.278883| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34
Epoch 143/200 |loss: 7.202693| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 35
Epoch 144/200 |loss: 7.247121| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 36
Epoch 145/200 |loss: 7.197182| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 37
Epoch 146/200 |loss: 7.213982| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 38
Epoch 147/200 |loss: 7.196375| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 39
Epoch 148/200 |loss: 7.206650| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 40
Epoch 149/200 |loss: 7.265839| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 41
Epoch 150/200 |loss: 7.364014| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 42
Epoch 151/200 |loss: 7.901171| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 43
Epoch 152/200 |loss: 7.472472| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 44
Epoch 153/200 |loss: 7.260179| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 45
Epoch 154/200 |loss: 7.200234| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 46
Epoch 155/200 |loss: 7.370341| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 47
Epoch 156/200 |loss: 7.613755| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 48
Epoch 157/200 |loss: 7.295255| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 49
Epoch 158/200 |loss: 7.298569| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 50
Epoch 159/200 |loss: 7.570486| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 51
Epoch 160/200 |loss: 7.235178| train set 5.326x speedup, test set 5.561x speedup, val set 5.384x speedup, step: 52
Epoch 161/200 |loss: 7.337070| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 53
Epoch 162/200 |loss: 7.521276| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 54
Epoch 163/200 |loss: 7.208259| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 55
Epoch 164/200 |loss: 7.549699| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 56
Epoch 165/200 |loss: 7.615875| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 57
Epoch 166/200 |loss: 7.294028| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 58
Epoch 167/200 |loss: 7.731010| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 59
Epoch 168/200 |loss: 7.427308| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 60
Epoch 169/200 |loss: 7.451435| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 61
Epoch 170/200 |loss: 7.461166| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 62
Epoch 171/200 |loss: 7.282766| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 63
Epoch 172/200 |loss: 7.427222| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 64
Epoch 173/200 |loss: 7.218261| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 65
Epoch 174/200 |loss: 7.447772| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 66
Epoch 175/200 |loss: 7.372925| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 67
Epoch 176/200 |loss: 7.321872| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 68
Epoch 177/200 |loss: 7.369777| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 69
Epoch 178/200 |loss: 7.240655| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 70
Epoch 179/200 |loss: 7.325274| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 71
Epoch 180/200 |loss: 7.199611| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 72
Epoch 181/200 |loss: 7.287153| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 73
Epoch 182/200 |loss: 7.251090| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 74
Epoch 183/200 |loss: 7.204214| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 75
Epoch 184/200 |loss: 7.267714| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 76
Epoch 185/200 |loss: 7.297223| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 77
Epoch 186/200 |loss: 7.217347| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 78
Epoch 187/200 |loss: 7.289734| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 79
Epoch 188/200 |loss: 7.306971| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 80
Epoch 189/200 |loss: 7.242678| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 81
Epoch 190/200 |loss: 7.250244| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 82
Epoch 191/200 |loss: 7.245273| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 83
Epoch 192/200 |loss: 7.250016| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 84
Epoch 193/200 |loss: 7.218355| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 85
Epoch 194/200 |loss: 7.210631| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 86
Epoch 195/200 |loss: 7.205597| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 87
Epoch 196/200 |loss: 7.223144| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 88
Epoch 197/200 |loss: 7.233355| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 89
Epoch 198/200 |loss: 7.134429| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 90
Epoch 199/200 |loss: 7.241292| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 91
Training per epoch cost 0.209 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 160, train speedup 5.326, test speedup 5.561, val speedup 5.384
best test speedup epoch: 66, train speedup 5.325, test speedup 5.566, val speedup 5.399
best validation speedup epoch: 109, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 199, train speedup 5.326, test speedup 5.559, val speedup 5.403
execution cost 0:02:10.171252
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.879019, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265707| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655592| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191648| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782269| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315983| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842960| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317846| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803158| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291471| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819931| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.348309| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.853706| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.348749| train set 4.516x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.865553| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 19
Epoch 19/200 |loss: 15.409463| train set 4.815x speedup, test set 5.072x speedup, val set 4.896x speedup, step: 20
Epoch 20/200 |loss: 15.013299| train set 4.696x speedup, test set 4.886x speedup, val set 4.840x speedup, step: 21
Epoch 21/200 |loss: 14.889256| train set 4.880x speedup, test set 5.069x speedup, val set 5.054x speedup, step: 22
Epoch 22/200 |loss: 14.760907| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 23
Epoch 23/200 |loss: 13.955644| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 24
Epoch 24/200 |loss: 13.879208| train set 5.120x speedup, test set 5.402x speedup, val set 5.127x speedup, step: 25
Epoch 25/200 |loss: 13.521989| train set 5.306x speedup, test set 5.536x speedup, val set 5.363x speedup, step: 26
Epoch 26/200 |loss: 12.963946| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 27
Epoch 27/200 |loss: 12.922555| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 28
Epoch 28/200 |loss: 12.269066| train set 5.324x speedup, test set 5.557x speedup, val set 5.402x speedup, step: 29
Epoch 29/200 |loss: 12.185926| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 30
Epoch 30/200 |loss: 12.027435| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.600040| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 32
Epoch 32/200 |loss: 11.318681| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 33
Epoch 33/200 |loss: 11.196437| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 34
Epoch 34/200 |loss: 11.220428| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 35
Epoch 35/200 |loss: 10.859686| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 36
Epoch 36/200 |loss: 10.806505| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 37
Epoch 37/200 |loss: 10.844722| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 38
Epoch 38/200 |loss: 10.700397| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 39
Epoch 39/200 |loss: 10.057085| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 40
Epoch 40/200 |loss: 10.550079| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 41
Epoch 41/200 |loss: 9.823022| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 42
Epoch 42/200 |loss: 10.044906| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 43
Epoch 43/200 |loss: 9.439827| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 44
Epoch 44/200 |loss: 9.648352| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 45
Epoch 45/200 |loss: 9.348604| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 46
Epoch 46/200 |loss: 9.277382| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 47
Epoch 47/200 |loss: 9.228769| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 48
Epoch 48/200 |loss: 9.124928| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 49
Epoch 49/200 |loss: 9.136176| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 50
Epoch 50/200 |loss: 9.116725| train set 5.265x speedup, test set 5.505x speedup, val set 5.496x speedup, step: 51
Epoch 51/200 |loss: 9.204627| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 52
Epoch 52/200 |loss: 9.285340| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 53
Epoch 53/200 |loss: 8.760794| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 54
Epoch 54/200 |loss: 8.972125| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 55
Epoch 55/200 |loss: 8.895798| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 56
Epoch 56/200 |loss: 8.948495| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 57
Epoch 57/200 |loss: 8.649506| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 58
Epoch 58/200 |loss: 8.846787| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 59
Epoch 59/200 |loss: 8.710635| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 60
Epoch 60/200 |loss: 8.491531| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 61
Epoch 61/200 |loss: 8.549644| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 62
Epoch 62/200 |loss: 8.567922| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 63
Epoch 63/200 |loss: 8.296740| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 64
Epoch 64/200 |loss: 8.416099| train set 5.082x speedup, test set 5.364x speedup, val set 5.252x speedup, step: 65
Epoch 65/200 |loss: 8.472476| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 66
Epoch 66/200 |loss: 8.059057| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 67/200 |loss: 8.261067| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 68
Epoch 68/200 |loss: 8.240462| train set 5.324x speedup, test set 5.562x speedup, val set 5.399x speedup, step: 69
Epoch 69/200 |loss: 8.127107| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 70/200 |loss: 8.163487| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 8.166267| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 72
Epoch 72/200 |loss: 7.857740| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 73
Epoch 73/200 |loss: 8.105260| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 74
Epoch 74/200 |loss: 8.135245| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 75
Epoch 75/200 |loss: 7.798637| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 76
Epoch 76/200 |loss: 8.013374| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 77
Epoch 77/200 |loss: 8.103479| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 78
Epoch 78/200 |loss: 7.743238| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 79
Epoch 79/200 |loss: 7.899895| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 80
Epoch 80/200 |loss: 7.969882| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 81
Epoch 81/200 |loss: 7.687419| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 82
Epoch 82/200 |loss: 7.861001| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 83
Epoch 83/200 |loss: 8.246748| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 84
Epoch 84/200 |loss: 7.739393| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 85
Epoch 85/200 |loss: 7.975353| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 86
Epoch 86/200 |loss: 7.957412| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 87
Epoch 87/200 |loss: 7.720558| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 88
Epoch 88/200 |loss: 8.086989| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 89
Epoch 89/200 |loss: 7.755653| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 90
Epoch 90/200 |loss: 7.792295| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 91
Epoch 91/200 |loss: 7.713335| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 92
Epoch 92/200 |loss: 7.557075| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 93
Epoch 93/200 |loss: 7.625657| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 94
Epoch 94/200 |loss: 7.550903| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 95
Epoch 95/200 |loss: 7.585026| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 96
Epoch 96/200 |loss: 7.718598| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 97
Epoch 97/200 |loss: 7.884992| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 98
Epoch 98/200 |loss: 7.656441| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 99
Epoch 99/200 |loss: 7.538317| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 100
Epoch 100/200 |loss: 7.462063| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 101/200 |loss: 7.413684| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 102/200 |loss: 7.551034| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2
Epoch 103/200 |loss: 7.513542| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 104/200 |loss: 7.539453| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 105/200 |loss: 7.401873| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 106/200 |loss: 7.357744| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 107/200 |loss: 7.334286| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 108/200 |loss: 7.327168| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 109/200 |loss: 7.338072| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 110/200 |loss: 7.377955| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 111/200 |loss: 7.610136| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2
Epoch 112/200 |loss: 7.558105| train set 5.286x speedup, test set 5.496x speedup, val set 5.514x speedup, step: 1
Epoch 113/200 |loss: 7.699296| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 2
Epoch 114/200 |loss: 7.420552| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 115/200 |loss: 7.330460| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 4
Epoch 116/200 |loss: 7.472678| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 5
Epoch 117/200 |loss: 7.495837| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6
Epoch 118/200 |loss: 7.375423| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 7
Epoch 119/200 |loss: 7.290263| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 8
Epoch 120/200 |loss: 7.390203| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 121/200 |loss: 7.442390| train set 5.327x speedup, test set 5.566x speedup, val set 5.403x speedup, step: 10
Epoch 122/200 |loss: 7.345219| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11
Epoch 123/200 |loss: 7.335265| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12
Epoch 124/200 |loss: 7.330126| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13
Epoch 125/200 |loss: 7.365252| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 14
Epoch 126/200 |loss: 7.468777| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 15
Epoch 127/200 |loss: 7.311569| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 16
Epoch 128/200 |loss: 7.263216| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 17
Epoch 129/200 |loss: 7.396146| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 18
Epoch 130/200 |loss: 7.324286| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19
Epoch 131/200 |loss: 7.279029| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20
Epoch 132/200 |loss: 7.271034| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 21
Epoch 133/200 |loss: 7.283056| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 22
Epoch 134/200 |loss: 7.393838| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 23
Epoch 135/200 |loss: 7.412016| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 24
Epoch 136/200 |loss: 7.328241| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 25
Epoch 137/200 |loss: 7.425598| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26
Epoch 138/200 |loss: 7.414224| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 27
Epoch 139/200 |loss: 7.445839| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 28
Epoch 140/200 |loss: 7.250000| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 29
Epoch 141/200 |loss: 7.234756| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 30
Epoch 142/200 |loss: 7.240601| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 31
Epoch 143/200 |loss: 7.303283| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 32
Epoch 144/200 |loss: 7.334049| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 33
Epoch 145/200 |loss: 7.269308| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34
Epoch 146/200 |loss: 7.265976| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 35
Epoch 147/200 |loss: 7.337118| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 36
Epoch 148/200 |loss: 7.322876| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 37
Epoch 149/200 |loss: 7.268140| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 38
Epoch 150/200 |loss: 7.253348| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 39
Epoch 151/200 |loss: 7.239677| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 40
Epoch 152/200 |loss: 7.289526| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 41
Epoch 153/200 |loss: 7.248005| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 42
Epoch 154/200 |loss: 7.221150| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 43
Epoch 155/200 |loss: 7.164638| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 44
Epoch 156/200 |loss: 7.157899| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 45
Epoch 157/200 |loss: 7.176395| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 46
Epoch 158/200 |loss: 7.195258| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 47
Epoch 159/200 |loss: 7.267219| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 48
Epoch 160/200 |loss: 7.277238| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 49
Epoch 161/200 |loss: 7.435364| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 50
Epoch 162/200 |loss: 7.311935| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 51
Epoch 163/200 |loss: 7.326135| train set 5.301x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 52
Epoch 164/200 |loss: 7.337230| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 53
Epoch 165/200 |loss: 7.281340| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 54
Epoch 166/200 |loss: 7.282264| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 55
Epoch 167/200 |loss: 7.171457| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 56
Epoch 168/200 |loss: 7.174807| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 57
Epoch 169/200 |loss: 7.289566| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 58
Epoch 170/200 |loss: 7.378092| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 59
Epoch 171/200 |loss: 7.310904| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 60
Epoch 172/200 |loss: 7.352949| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 61
Epoch 173/200 |loss: 7.325562| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 62
Epoch 174/200 |loss: 7.413149| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 63
Epoch 175/200 |loss: 7.232837| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 64
Epoch 176/200 |loss: 7.235530| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 65
Epoch 177/200 |loss: 7.325595| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 66
Epoch 178/200 |loss: 7.252415| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 179/200 |loss: 7.265366| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 68
Epoch 180/200 |loss: 7.321865| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 69
Epoch 181/200 |loss: 7.306519| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 182/200 |loss: 7.325727| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 71
Epoch 183/200 |loss: 7.376558| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 72
Epoch 184/200 |loss: 7.290133| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 73
Epoch 185/200 |loss: 7.278780| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 74
Epoch 186/200 |loss: 7.278304| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 75
Epoch 187/200 |loss: 7.203637| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 76
Epoch 188/200 |loss: 7.191030| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 77
Epoch 189/200 |loss: 7.236537| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 78
Epoch 190/200 |loss: 7.185511| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 79
Epoch 191/200 |loss: 7.187253| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 80
Epoch 192/200 |loss: 7.204480| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 81
Epoch 193/200 |loss: 7.358120| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 82
Epoch 194/200 |loss: 7.496576| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 83
Epoch 195/200 |loss: 8.166119| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 84
Epoch 196/200 |loss: 7.660576| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 85
Epoch 197/200 |loss: 7.611476| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 86
Epoch 198/200 |loss: 7.906791| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 87
Epoch 199/200 |loss: 7.561422| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 88
Training per epoch cost 0.208 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 121, train speedup 5.327, test speedup 5.566, val speedup 5.403
best test speedup epoch: 121, train speedup 5.327, test speedup 5.566, val speedup 5.403
best validation speedup epoch: 112, train speedup 5.286, test speedup 5.496, val speedup 5.514
last model at epoch 199, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:02:09.517039
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.897156, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265709| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655590| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191647| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782267| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315981| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842957| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317846| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803156| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291451| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819801| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.347836| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.855810| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.351509| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.867967| train set 4.376x speedup, test set 4.618x speedup, val set 4.468x speedup, step: 19
Epoch 19/200 |loss: 15.433935| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 20
Epoch 20/200 |loss: 15.182605| train set 4.631x speedup, test set 4.867x speedup, val set 4.772x speedup, step: 21
Epoch 21/200 |loss: 15.068646| train set 4.880x speedup, test set 5.069x speedup, val set 5.054x speedup, step: 22
Epoch 22/200 |loss: 14.367572| train set 4.880x speedup, test set 5.070x speedup, val set 5.054x speedup, step: 23
Epoch 23/200 |loss: 13.896934| train set 5.042x speedup, test set 5.371x speedup, val set 5.125x speedup, step: 24
Epoch 24/200 |loss: 13.803366| train set 5.249x speedup, test set 5.477x speedup, val set 5.460x speedup, step: 25
Epoch 25/200 |loss: 13.216973| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 26
Epoch 26/200 |loss: 12.896791| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 27
Epoch 27/200 |loss: 12.679145| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 28
Epoch 28/200 |loss: 12.402296| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 29
Epoch 29/200 |loss: 12.010060| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 30
Epoch 30/200 |loss: 11.632014| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.482874| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 32
Epoch 32/200 |loss: 11.266743| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 33
Epoch 33/200 |loss: 11.401410| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 34
Epoch 34/200 |loss: 11.209949| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 35
Epoch 35/200 |loss: 10.712434| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 36
Epoch 36/200 |loss: 10.875741| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 37
Epoch 37/200 |loss: 10.912347| train set 5.138x speedup, test set 5.422x speedup, val set 5.163x speedup, step: 38
Epoch 38/200 |loss: 11.216730| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 39
Epoch 39/200 |loss: 10.401386| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 40
Epoch 40/200 |loss: 10.018534| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 41
Epoch 41/200 |loss: 10.053967| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 42
Epoch 42/200 |loss: 9.677520| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 43
Epoch 43/200 |loss: 9.560136| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 44
Epoch 44/200 |loss: 9.414390| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 45
Epoch 45/200 |loss: 9.342162| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 46
Epoch 46/200 |loss: 9.299571| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 47
Epoch 47/200 |loss: 9.215812| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 48
Epoch 48/200 |loss: 9.182773| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 49
Epoch 49/200 |loss: 8.943902| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 50
Epoch 50/200 |loss: 8.747268| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 51
Epoch 51/200 |loss: 8.797313| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 52
Epoch 52/200 |loss: 8.679236| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 53
Epoch 53/200 |loss: 8.656098| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 54
Epoch 54/200 |loss: 8.589784| train set 5.324x speedup, test set 5.566x speedup, val set 5.400x speedup, step: 55
Epoch 55/200 |loss: 8.463981| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 56
Epoch 56/200 |loss: 8.399728| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 57
Epoch 57/200 |loss: 8.529953| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 58
Epoch 58/200 |loss: 8.291378| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 59
Epoch 59/200 |loss: 8.638880| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 60
Epoch 60/200 |loss: 10.185688| train set 5.199x speedup, test set 5.433x speedup, val set 5.285x speedup, step: 61
Epoch 61/200 |loss: 9.202015| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 62
Epoch 62/200 |loss: 8.955270| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 63
Epoch 63/200 |loss: 9.454933| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 64
Epoch 64/200 |loss: 9.028518| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 65
Epoch 65/200 |loss: 9.154866| train set 5.301x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 66
Epoch 66/200 |loss: 8.718220| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 67
Epoch 67/200 |loss: 8.696965| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 68
Epoch 68/200 |loss: 8.389244| train set 5.267x speedup, test set 5.509x speedup, val set 5.360x speedup, step: 69
Epoch 69/200 |loss: 8.651921| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 70/200 |loss: 8.242404| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 8.392294| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 72
Epoch 72/200 |loss: 8.217117| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 73
Epoch 73/200 |loss: 8.163921| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 74
Epoch 74/200 |loss: 8.133677| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 75
Epoch 75/200 |loss: 7.981562| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 76
Epoch 76/200 |loss: 8.107716| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 77
Epoch 77/200 |loss: 7.882629| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 78
Epoch 78/200 |loss: 7.932508| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 79
Epoch 79/200 |loss: 7.890097| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 80
Epoch 80/200 |loss: 7.745623| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 81
Epoch 81/200 |loss: 7.869241| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 82
Epoch 82/200 |loss: 7.718746| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 83
Epoch 83/200 |loss: 7.695978| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 84
Epoch 84/200 |loss: 7.710585| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 85
Epoch 85/200 |loss: 7.675345| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 86
Epoch 86/200 |loss: 7.780485| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 87
Epoch 87/200 |loss: 8.037425| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 88
Epoch 88/200 |loss: 8.571049| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 89
Epoch 89/200 |loss: 8.050832| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 90
Epoch 90/200 |loss: 7.761202| train set 5.325x speedup, test set 5.567x speedup, val set 5.399x speedup, step: 91
Epoch 91/200 |loss: 7.978200| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 92
Epoch 92/200 |loss: 7.794476| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 93
Epoch 93/200 |loss: 7.721133| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 94
Epoch 94/200 |loss: 7.853521| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 95
Epoch 95/200 |loss: 7.544087| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 96
Epoch 96/200 |loss: 7.629281| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 97
Epoch 97/200 |loss: 7.621644| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 98
Epoch 98/200 |loss: 7.551655| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 99
Epoch 99/200 |loss: 7.611191| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 100
Epoch 100/200 |loss: 7.692970| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 101/200 |loss: 7.768434| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1
Epoch 102/200 |loss: 7.865930| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 103/200 |loss: 7.488820| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 104/200 |loss: 7.642511| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 105/200 |loss: 8.033286| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 106/200 |loss: 7.564301| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 3
Epoch 107/200 |loss: 8.119460| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4
Epoch 108/200 |loss: 7.884567| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5
Epoch 109/200 |loss: 7.892745| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6
Epoch 110/200 |loss: 7.649282| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 7
Epoch 111/200 |loss: 7.796652| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 112/200 |loss: 7.687716| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 113/200 |loss: 7.656697| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 10
Epoch 114/200 |loss: 7.549361| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 11
Epoch 115/200 |loss: 7.610079| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12
Epoch 116/200 |loss: 7.586802| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 13
Epoch 117/200 |loss: 7.537580| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 14
Epoch 118/200 |loss: 7.508130| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 15
Epoch 119/200 |loss: 7.443623| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16
Epoch 120/200 |loss: 7.472905| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 17
Epoch 121/200 |loss: 7.408874| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 18
Epoch 122/200 |loss: 7.445250| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19
Epoch 123/200 |loss: 7.338264| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20
Epoch 124/200 |loss: 7.418794| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21
Epoch 125/200 |loss: 7.337818| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 22
Epoch 126/200 |loss: 7.397209| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 23
Epoch 127/200 |loss: 7.399634| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 24
Epoch 128/200 |loss: 7.409946| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 25
Epoch 129/200 |loss: 7.489614| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26
Epoch 130/200 |loss: 7.344395| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 27
Epoch 131/200 |loss: 7.351206| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28
Epoch 132/200 |loss: 7.282157| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29
Epoch 133/200 |loss: 7.372480| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 30
Epoch 134/200 |loss: 7.398782| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 31
Epoch 135/200 |loss: 7.358878| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 32
Epoch 136/200 |loss: 7.373534| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 33
Epoch 137/200 |loss: 7.273752| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34
Epoch 138/200 |loss: 7.271142| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 35
Epoch 139/200 |loss: 7.278224| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 36
Epoch 140/200 |loss: 7.300282| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 37
Epoch 141/200 |loss: 7.332497| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 38
Epoch 142/200 |loss: 7.256804| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 39
Epoch 143/200 |loss: 7.280289| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 40
Epoch 144/200 |loss: 7.212173| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 41
Epoch 145/200 |loss: 7.229492| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 42
Epoch 146/200 |loss: 7.209175| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 43
Epoch 147/200 |loss: 7.210105| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 44
Epoch 148/200 |loss: 7.243154| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 45
Epoch 149/200 |loss: 7.257417| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 46
Epoch 150/200 |loss: 7.336829| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 47
Epoch 151/200 |loss: 7.318521| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 48
Epoch 152/200 |loss: 7.353988| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 49
Epoch 153/200 |loss: 7.267784| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 50
Epoch 154/200 |loss: 7.225007| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 51
Epoch 155/200 |loss: 7.216202| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 52
Epoch 156/200 |loss: 7.205873| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 53
Epoch 157/200 |loss: 7.215362| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 54
Epoch 158/200 |loss: 7.247559| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 55
Epoch 159/200 |loss: 7.338690| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 56
Epoch 160/200 |loss: 7.267753| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 57
Epoch 161/200 |loss: 7.215910| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 58
Epoch 162/200 |loss: 7.162725| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 59
Epoch 163/200 |loss: 7.167733| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 60
Epoch 164/200 |loss: 7.249562| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 61
Epoch 165/200 |loss: 7.335340| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 62
Epoch 166/200 |loss: 7.604124| train set 5.326x speedup, test set 5.561x speedup, val set 5.384x speedup, step: 63
Epoch 167/200 |loss: 7.310117| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 64
Epoch 168/200 |loss: 7.346235| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 65
Epoch 169/200 |loss: 7.384987| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 66
Epoch 170/200 |loss: 7.328645| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 171/200 |loss: 7.354110| train set 5.326x speedup, test set 5.561x speedup, val set 5.384x speedup, step: 68
Epoch 172/200 |loss: 7.330572| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 69
Epoch 173/200 |loss: 7.362588| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 70
Epoch 174/200 |loss: 7.294007| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 175/200 |loss: 7.302728| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 72
Epoch 176/200 |loss: 7.521752| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 73
Epoch 177/200 |loss: 7.313972| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 74
Epoch 178/200 |loss: 7.187181| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 75
Epoch 179/200 |loss: 7.319796| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 76
Epoch 180/200 |loss: 7.271418| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 77
Epoch 181/200 |loss: 7.270575| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 78
Epoch 182/200 |loss: 7.285582| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 79
Epoch 183/200 |loss: 7.206264| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 80
Epoch 184/200 |loss: 7.199741| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 81
Epoch 185/200 |loss: 7.255001| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 82
Epoch 186/200 |loss: 7.299256| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 83
Epoch 187/200 |loss: 7.256927| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 84
Epoch 188/200 |loss: 7.200215| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 85
Epoch 189/200 |loss: 7.184344| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 86
Epoch 190/200 |loss: 7.174506| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 87
Epoch 191/200 |loss: 7.163717| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 88
Epoch 192/200 |loss: 7.195684| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 89
Epoch 193/200 |loss: 7.277719| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 90
Epoch 194/200 |loss: 7.306752| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 91
Epoch 195/200 |loss: 7.573990| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 92
Epoch 196/200 |loss: 7.252639| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 93
Epoch 197/200 |loss: 7.158552| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 94
Epoch 198/200 |loss: 7.306024| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 95
Epoch 199/200 |loss: 7.340925| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 96
Training per epoch cost 0.211 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 166, train speedup 5.326, test speedup 5.561, val speedup 5.384
best test speedup epoch: 90, train speedup 5.325, test speedup 5.567, val speedup 5.399
best validation speedup epoch: 104, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 199, train speedup 5.326, test speedup 5.559, val speedup 5.403
execution cost 0:02:11.369728
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.937791, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265709| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655590| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191648| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782269| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315983| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842960| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317846| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803158| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291452| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819803| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.347851| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.854961| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.347336| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.866583| train set 4.376x speedup, test set 4.618x speedup, val set 4.468x speedup, step: 19
Epoch 19/200 |loss: 15.430213| train set 4.815x speedup, test set 5.072x speedup, val set 4.896x speedup, step: 20
Epoch 20/200 |loss: 15.160344| train set 4.631x speedup, test set 4.867x speedup, val set 4.772x speedup, step: 21
Epoch 21/200 |loss: 15.066988| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 22
Epoch 22/200 |loss: 14.401238| train set 4.880x speedup, test set 5.070x speedup, val set 5.054x speedup, step: 23
Epoch 23/200 |loss: 13.920073| train set 5.042x speedup, test set 5.371x speedup, val set 5.125x speedup, step: 24
Epoch 24/200 |loss: 13.814817| train set 5.249x speedup, test set 5.477x speedup, val set 5.460x speedup, step: 25
Epoch 25/200 |loss: 13.222978| train set 5.308x speedup, test set 5.537x speedup, val set 5.364x speedup, step: 26
Epoch 26/200 |loss: 12.914380| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 27
Epoch 27/200 |loss: 12.709142| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28
Epoch 28/200 |loss: 12.382290| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 29
Epoch 29/200 |loss: 12.016542| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 30
Epoch 30/200 |loss: 11.689394| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.530334| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 32
Epoch 32/200 |loss: 11.228714| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 33
Epoch 33/200 |loss: 11.165114| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 34
Epoch 34/200 |loss: 11.056982| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 35
Epoch 35/200 |loss: 10.957012| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 36
Epoch 36/200 |loss: 11.468220| train set 5.058x speedup, test set 5.391x speedup, val set 5.160x speedup, step: 37
Epoch 37/200 |loss: 11.133704| train set 5.082x speedup, test set 5.365x speedup, val set 5.252x speedup, step: 38
Epoch 38/200 |loss: 10.891114| train set 5.255x speedup, test set 5.487x speedup, val set 5.332x speedup, step: 39
Epoch 39/200 |loss: 11.062277| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 40
Epoch 40/200 |loss: 10.664250| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 41
Epoch 41/200 |loss: 10.348606| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 42
Epoch 42/200 |loss: 10.313014| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 43
Epoch 43/200 |loss: 9.863779| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 44
Epoch 44/200 |loss: 10.023265| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 45
Epoch 45/200 |loss: 9.408381| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 46
Epoch 46/200 |loss: 9.629661| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 47
Epoch 47/200 |loss: 9.346665| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 48
Epoch 48/200 |loss: 9.347754| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 49
Epoch 49/200 |loss: 9.003220| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 50
Epoch 50/200 |loss: 9.200270| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 51
Epoch 51/200 |loss: 9.073620| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 52
Epoch 52/200 |loss: 8.924236| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 53
Epoch 53/200 |loss: 8.778665| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 54
Epoch 54/200 |loss: 8.818748| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 55
Epoch 55/200 |loss: 8.748874| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 56
Epoch 56/200 |loss: 8.568431| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 57
Epoch 57/200 |loss: 8.526747| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 58
Epoch 58/200 |loss: 8.516704| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 59
Epoch 59/200 |loss: 8.540941| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 60
Epoch 60/200 |loss: 8.337629| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 61
Epoch 61/200 |loss: 8.441718| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 62
Epoch 62/200 |loss: 8.194214| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 63
Epoch 63/200 |loss: 8.224070| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 64
Epoch 64/200 |loss: 8.155673| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 65
Epoch 65/200 |loss: 8.080412| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 66
Epoch 66/200 |loss: 8.272103| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 67/200 |loss: 8.221731| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 68
Epoch 68/200 |loss: 8.292351| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 69
Epoch 69/200 |loss: 7.934592| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 70/200 |loss: 7.989062| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 8.235307| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 72
Epoch 72/200 |loss: 7.919194| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 73
Epoch 73/200 |loss: 7.864807| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 74
Epoch 74/200 |loss: 8.294713| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 75
Epoch 75/200 |loss: 8.112317| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 76
Epoch 76/200 |loss: 8.359840| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 77
Epoch 77/200 |loss: 8.432869| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 78
Epoch 78/200 |loss: 7.837924| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 79
Epoch 79/200 |loss: 7.928582| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 80
Epoch 80/200 |loss: 8.219654| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 81
Epoch 81/200 |loss: 7.749456| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 82
Epoch 82/200 |loss: 8.079691| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 83
Epoch 83/200 |loss: 8.320863| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 84
Epoch 84/200 |loss: 7.897891| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 85
Epoch 85/200 |loss: 8.179762| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 86
Epoch 86/200 |loss: 8.185776| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 87
Epoch 87/200 |loss: 7.773783| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 88
Epoch 88/200 |loss: 8.078691| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 89
Epoch 89/200 |loss: 7.729713| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 90
Epoch 90/200 |loss: 7.737680| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 91
Epoch 91/200 |loss: 7.727871| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 92
Epoch 92/200 |loss: 7.589486| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 93
Epoch 93/200 |loss: 7.711654| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 94
Epoch 94/200 |loss: 7.517293| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 95
Epoch 95/200 |loss: 7.636926| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 96
Epoch 96/200 |loss: 7.715333| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 97
Epoch 97/200 |loss: 7.653276| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 98
Epoch 98/200 |loss: 8.106620| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 99
Epoch 99/200 |loss: 7.946126| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 100
Epoch 100/200 |loss: 7.546039| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 101
Epoch 101/200 |loss: 7.577249| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 102/200 |loss: 7.642683| train set 5.301x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1
Epoch 103/200 |loss: 7.579464| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 104/200 |loss: 7.551895| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 105/200 |loss: 7.482672| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 106/200 |loss: 7.396588| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 5
Epoch 107/200 |loss: 7.535412| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 108/200 |loss: 7.548260| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 109/200 |loss: 7.440590| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 110/200 |loss: 7.448182| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4
Epoch 111/200 |loss: 7.403593| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5
Epoch 112/200 |loss: 7.323390| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 113/200 |loss: 7.390230| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 114/200 |loss: 7.400769| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 115/200 |loss: 7.326790| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9
Epoch 116/200 |loss: 7.387846| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 117/200 |loss: 7.535253| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 2
Epoch 118/200 |loss: 7.462658| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 119/200 |loss: 7.803512| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2
Epoch 120/200 |loss: 7.512518| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3
Epoch 121/200 |loss: 7.326903| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 122/200 |loss: 7.615926| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5
Epoch 123/200 |loss: 7.528846| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 124/200 |loss: 7.294232| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 125/200 |loss: 7.470976| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 8
Epoch 126/200 |loss: 7.488954| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9
Epoch 127/200 |loss: 7.286497| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 128/200 |loss: 7.449268| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11
Epoch 129/200 |loss: 7.440337| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 12
Epoch 130/200 |loss: 7.275874| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13
Epoch 131/200 |loss: 7.516778| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 14
Epoch 132/200 |loss: 7.525787| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 15
Epoch 133/200 |loss: 7.373145| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16
Epoch 134/200 |loss: 7.590944| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 17
Epoch 135/200 |loss: 7.306792| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18
Epoch 136/200 |loss: 7.427911| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19
Epoch 137/200 |loss: 7.499989| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 20
Epoch 138/200 |loss: 7.319491| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 21
Epoch 139/200 |loss: 7.380166| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 22
Epoch 140/200 |loss: 7.326363| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 23
Epoch 141/200 |loss: 7.415866| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 24
Epoch 142/200 |loss: 7.424533| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 25
Epoch 143/200 |loss: 7.318671| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26
Epoch 144/200 |loss: 7.342088| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 27
Epoch 145/200 |loss: 7.278285| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 28
Epoch 146/200 |loss: 7.355189| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29
Epoch 147/200 |loss: 7.384766| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 30
Epoch 148/200 |loss: 7.308543| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 31
Epoch 149/200 |loss: 7.253153| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 32
Epoch 150/200 |loss: 7.311193| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 33
Epoch 151/200 |loss: 7.285250| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34
Epoch 152/200 |loss: 7.339530| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 35
Epoch 153/200 |loss: 7.229980| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 36
Epoch 154/200 |loss: 7.238374| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 37
Epoch 155/200 |loss: 7.225333| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 38
Epoch 156/200 |loss: 7.235384| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 39
Epoch 157/200 |loss: 7.321687| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 40
Epoch 158/200 |loss: 7.242690| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 41
Epoch 159/200 |loss: 7.237858| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 42
Epoch 160/200 |loss: 7.185978| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 43
Epoch 161/200 |loss: 7.198510| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 44
Epoch 162/200 |loss: 7.198516| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 45
Epoch 163/200 |loss: 7.207342| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 46
Epoch 164/200 |loss: 7.259119| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 47
Epoch 165/200 |loss: 7.236181| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 166/200 |loss: 7.284210| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 167/200 |loss: 7.269355| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 168/200 |loss: 7.251056| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 169/200 |loss: 7.180968| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5
Epoch 170/200 |loss: 7.149181| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 171/200 |loss: 7.163495| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 172/200 |loss: 7.183088| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 173/200 |loss: 7.236622| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9
Epoch 174/200 |loss: 7.245577| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 10
Epoch 175/200 |loss: 7.288278| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11
Epoch 176/200 |loss: 7.184985| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 12
Epoch 177/200 |loss: 7.145794| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 13
Epoch 178/200 |loss: 7.132560| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 14
Epoch 179/200 |loss: 7.175612| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 15
Epoch 180/200 |loss: 7.282398| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 16
Epoch 181/200 |loss: 7.264306| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 17
Epoch 182/200 |loss: 7.329333| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 18
Epoch 183/200 |loss: 7.186279| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19
Epoch 184/200 |loss: 7.182280| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20
Epoch 185/200 |loss: 7.197471| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 21
Epoch 186/200 |loss: 7.234277| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 22
Epoch 187/200 |loss: 7.348060| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 23
Epoch 188/200 |loss: 7.228243| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 24
Epoch 189/200 |loss: 7.184172| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 25
Epoch 190/200 |loss: 7.178375| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26
Epoch 191/200 |loss: 7.268073| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 27
Epoch 192/200 |loss: 7.464038| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28
Epoch 193/200 |loss: 7.251266| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29
Epoch 194/200 |loss: 7.345100| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 30
Epoch 195/200 |loss: 7.490675| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 31
Epoch 196/200 |loss: 7.232525| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 32
Epoch 197/200 |loss: 7.387894| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 33
Epoch 198/200 |loss: 7.588231| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 34
Epoch 199/200 |loss: 7.220332| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 35
Training per epoch cost 0.207 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 66, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 49, train speedup 5.325, test speedup 5.566, val speedup 5.399
best validation speedup epoch: 165, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 199, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:02:09.577447
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.033919, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265709| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655592| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191648| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782269| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315983| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842960| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317846| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803158| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291454| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819807| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.347839| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.855749| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.351038| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.868057| train set 4.376x speedup, test set 4.618x speedup, val set 4.468x speedup, step: 19
Epoch 19/200 |loss: 15.437203| train set 4.857x speedup, test set 5.092x speedup, val set 4.968x speedup, step: 20
Epoch 20/200 |loss: 15.181282| train set 4.631x speedup, test set 4.867x speedup, val set 4.772x speedup, step: 21
Epoch 21/200 |loss: 15.023214| train set 4.880x speedup, test set 5.069x speedup, val set 5.054x speedup, step: 22
Epoch 22/200 |loss: 14.342967| train set 4.880x speedup, test set 5.070x speedup, val set 5.054x speedup, step: 23
Epoch 23/200 |loss: 13.920650| train set 5.042x speedup, test set 5.371x speedup, val set 5.125x speedup, step: 24
Epoch 24/200 |loss: 13.796790| train set 5.249x speedup, test set 5.477x speedup, val set 5.460x speedup, step: 25
Epoch 25/200 |loss: 13.235901| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 26
Epoch 26/200 |loss: 12.914704| train set 5.249x speedup, test set 5.477x speedup, val set 5.460x speedup, step: 27
Epoch 27/200 |loss: 12.695746| train set 5.324x speedup, test set 5.557x speedup, val set 5.402x speedup, step: 28
Epoch 28/200 |loss: 12.393996| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 29
Epoch 29/200 |loss: 12.140454| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 30
Epoch 30/200 |loss: 11.795001| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.600684| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 32
Epoch 32/200 |loss: 11.512741| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 33
Epoch 33/200 |loss: 11.179779| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 34
Epoch 34/200 |loss: 10.901481| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 35
Epoch 35/200 |loss: 11.013771| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 36
Epoch 36/200 |loss: 11.003793| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 37
Epoch 37/200 |loss: 10.763181| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 38
Epoch 38/200 |loss: 10.150810| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 39
Epoch 39/200 |loss: 10.152796| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 40
Epoch 40/200 |loss: 10.051731| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 41
Epoch 41/200 |loss: 9.967975| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 42
Epoch 42/200 |loss: 9.703783| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 43
Epoch 43/200 |loss: 9.520432| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 44
Epoch 44/200 |loss: 9.290282| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 45
Epoch 45/200 |loss: 9.316207| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 46
Epoch 46/200 |loss: 9.094390| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 47
Epoch 47/200 |loss: 9.030808| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 48
Epoch 48/200 |loss: 9.341511| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 49
Epoch 49/200 |loss: 9.151763| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 50
Epoch 50/200 |loss: 9.575347| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 51
Epoch 51/200 |loss: 8.850798| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 52
Epoch 52/200 |loss: 9.082577| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 53
Epoch 53/200 |loss: 9.101834| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 54
Epoch 54/200 |loss: 8.801840| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 55
Epoch 55/200 |loss: 8.518710| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 56
Epoch 56/200 |loss: 8.591901| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 57
Epoch 57/200 |loss: 8.590988| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 58
Epoch 58/200 |loss: 8.628821| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 59
Epoch 59/200 |loss: 8.307819| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 60
Epoch 60/200 |loss: 8.330534| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 61
Epoch 61/200 |loss: 8.364154| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 62
Epoch 62/200 |loss: 8.584257| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 63
Epoch 63/200 |loss: 9.225306| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 64
Epoch 64/200 |loss: 8.469428| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 65
Epoch 65/200 |loss: 9.335142| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 66
Epoch 66/200 |loss: 8.882001| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 67
Epoch 67/200 |loss: 8.763117| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 68
Epoch 68/200 |loss: 8.564242| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 69
Epoch 69/200 |loss: 8.576743| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 70/200 |loss: 8.389930| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 8.460805| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 72
Epoch 72/200 |loss: 8.103049| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 73
Epoch 73/200 |loss: 8.283042| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 74
Epoch 74/200 |loss: 8.026152| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 75
Epoch 75/200 |loss: 8.119050| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 76
Epoch 76/200 |loss: 7.904998| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 77
Epoch 77/200 |loss: 7.996842| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 78
Epoch 78/200 |loss: 7.847069| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 79
Epoch 79/200 |loss: 7.901124| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 80
Epoch 80/200 |loss: 7.747252| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 81
Epoch 81/200 |loss: 7.802936| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 82
Epoch 82/200 |loss: 7.783867| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 83
Epoch 83/200 |loss: 7.801301| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 84
Epoch 84/200 |loss: 8.054555| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 85
Epoch 85/200 |loss: 7.809022| train set 5.301x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 86
Epoch 86/200 |loss: 7.825384| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 87
Epoch 87/200 |loss: 7.574717| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 88
Epoch 88/200 |loss: 7.639167| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 89
Epoch 89/200 |loss: 7.658163| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 90
Epoch 90/200 |loss: 7.654999| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 91
Epoch 91/200 |loss: 7.697934| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 92
Epoch 92/200 |loss: 7.553667| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 93
Epoch 93/200 |loss: 7.620586| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 94
Epoch 94/200 |loss: 7.511349| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 95
Epoch 95/200 |loss: 7.649416| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 96
Epoch 96/200 |loss: 7.705144| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 97
Epoch 97/200 |loss: 7.594062| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 98
Epoch 98/200 |loss: 7.644384| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 99
Epoch 99/200 |loss: 7.418031| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 100
Epoch 100/200 |loss: 7.593634| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 101/200 |loss: 7.621119| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2
Epoch 102/200 |loss: 7.672606| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 103/200 |loss: 7.678811| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 104/200 |loss: 7.539267| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 105/200 |loss: 7.642140| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 106/200 |loss: 7.831969| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 107/200 |loss: 7.634926| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 108/200 |loss: 7.481013| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 109/200 |loss: 7.767341| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5
Epoch 110/200 |loss: 7.595830| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 111/200 |loss: 7.476617| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 112/200 |loss: 7.639643| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 8
Epoch 113/200 |loss: 7.591166| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9
Epoch 114/200 |loss: 7.434237| train set 5.297x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 10
Epoch 115/200 |loss: 7.450011| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11
Epoch 116/200 |loss: 7.492224| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12
Epoch 117/200 |loss: 7.654610| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 13
Epoch 118/200 |loss: 7.375874| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 14
Epoch 119/200 |loss: 7.609628| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 15
Epoch 120/200 |loss: 7.716731| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 16
Epoch 121/200 |loss: 7.501174| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 17
Epoch 122/200 |loss: 7.769487| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18
Epoch 123/200 |loss: 7.642738| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19
Epoch 124/200 |loss: 7.417849| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 20
Epoch 125/200 |loss: 7.617414| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21
Epoch 126/200 |loss: 7.409959| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 22
Epoch 127/200 |loss: 7.462735| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 23
Epoch 128/200 |loss: 7.452637| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 24
Epoch 129/200 |loss: 7.354483| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 25
Epoch 130/200 |loss: 7.430549| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26
Epoch 131/200 |loss: 7.340883| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 27
Epoch 132/200 |loss: 7.336536| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28
Epoch 133/200 |loss: 7.333050| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 29
Epoch 134/200 |loss: 7.313306| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 30
Epoch 135/200 |loss: 7.272639| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 31
Epoch 136/200 |loss: 7.323627| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 32
Epoch 137/200 |loss: 7.239727| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 33
Epoch 138/200 |loss: 7.302108| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34
Epoch 139/200 |loss: 7.312173| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 35
Epoch 140/200 |loss: 7.463733| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 36
Epoch 141/200 |loss: 7.723381| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 37
Epoch 142/200 |loss: 8.450559| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 38
Epoch 143/200 |loss: 7.458926| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 39
Epoch 144/200 |loss: 8.312516| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 40
Epoch 145/200 |loss: 8.731635| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 41
Epoch 146/200 |loss: 7.784890| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 42
Epoch 147/200 |loss: 8.980827| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 43
Epoch 148/200 |loss: 7.883537| train set 5.057x speedup, test set 5.398x speedup, val set 5.155x speedup, step: 44
Epoch 149/200 |loss: 8.170728| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 45
Epoch 150/200 |loss: 8.098721| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 46
Epoch 151/200 |loss: 7.700734| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 47
Epoch 152/200 |loss: 7.816021| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 48
Epoch 153/200 |loss: 7.720878| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 49
Epoch 154/200 |loss: 7.692089| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 50
Epoch 155/200 |loss: 7.613678| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 156/200 |loss: 7.657176| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 157/200 |loss: 7.537217| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3
Epoch 158/200 |loss: 7.496316| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4
Epoch 159/200 |loss: 7.503639| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5
Epoch 160/200 |loss: 7.435553| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 161/200 |loss: 7.456539| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 162/200 |loss: 7.380275| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 163/200 |loss: 7.388996| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 164/200 |loss: 7.341705| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 165/200 |loss: 7.343181| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11
Epoch 166/200 |loss: 7.313383| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12
Epoch 167/200 |loss: 7.310709| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 13
Epoch 168/200 |loss: 7.269206| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 14
Epoch 169/200 |loss: 7.289893| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 15
Epoch 170/200 |loss: 7.252766| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16
Epoch 171/200 |loss: 7.251318| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 17
Epoch 172/200 |loss: 7.246136| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18
Epoch 173/200 |loss: 7.232081| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19
Epoch 174/200 |loss: 7.221730| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20
Epoch 175/200 |loss: 7.211339| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21
Epoch 176/200 |loss: 7.214709| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 22
Epoch 177/200 |loss: 7.204787| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 23
Epoch 178/200 |loss: 7.188251| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 24
Epoch 179/200 |loss: 7.189410| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 25
Epoch 180/200 |loss: 7.179364| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 26
Epoch 181/200 |loss: 7.179964| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 27
Epoch 182/200 |loss: 7.167340| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28
Epoch 183/200 |loss: 7.163448| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29
Epoch 184/200 |loss: 7.160048| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 30
Epoch 185/200 |loss: 7.154183| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 31
Epoch 186/200 |loss: 7.152348| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 32
Epoch 187/200 |loss: 7.148456| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 33
Epoch 188/200 |loss: 7.145945| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34
Epoch 189/200 |loss: 7.149587| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 35
Epoch 190/200 |loss: 7.149503| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 36
Epoch 191/200 |loss: 7.168160| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 37
Epoch 192/200 |loss: 7.190855| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 38
Epoch 193/200 |loss: 7.292797| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 39
Epoch 194/200 |loss: 7.310640| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 40
Epoch 195/200 |loss: 7.428955| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 41
Epoch 196/200 |loss: 7.212889| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 42
Epoch 197/200 |loss: 7.131963| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 43
Epoch 198/200 |loss: 7.161154| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 44
Epoch 199/200 |loss: 7.253750| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 45
Training per epoch cost 0.209 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 50, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 51, train speedup 5.325, test speedup 5.566, val speedup 5.399
best validation speedup epoch: 155, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 199, train speedup 5.326, test speedup 5.559, val speedup 5.403
execution cost 0:02:12.061814
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.902498, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265709| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655592| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191648| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782269| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315985| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842960| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317862| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803158| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291481| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819450| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.348015| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.856348| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.355169| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.876111| train set 4.376x speedup, test set 4.618x speedup, val set 4.468x speedup, step: 19
Epoch 19/200 |loss: 15.421858| train set 4.815x speedup, test set 5.073x speedup, val set 4.897x speedup, step: 20
Epoch 20/200 |loss: 15.064102| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 21
Epoch 21/200 |loss: 14.959159| train set 4.880x speedup, test set 5.070x speedup, val set 5.054x speedup, step: 22
Epoch 22/200 |loss: 14.677859| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 23
Epoch 23/200 |loss: 13.911058| train set 5.049x speedup, test set 5.188x speedup, val set 5.284x speedup, step: 24
Epoch 24/200 |loss: 13.834592| train set 5.121x speedup, test set 5.403x speedup, val set 5.129x speedup, step: 25
Epoch 25/200 |loss: 13.477203| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 26
Epoch 26/200 |loss: 12.946816| train set 5.321x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 27
Epoch 27/200 |loss: 12.788306| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 28
Epoch 28/200 |loss: 12.368396| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 29
Epoch 29/200 |loss: 11.970232| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 30
Epoch 30/200 |loss: 11.862777| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.621607| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 32
Epoch 32/200 |loss: 11.491601| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 33
Epoch 33/200 |loss: 11.365348| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 34
Epoch 34/200 |loss: 11.459805| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 35
Epoch 35/200 |loss: 10.943378| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 36
Epoch 36/200 |loss: 11.146831| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 37
Epoch 37/200 |loss: 10.957707| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 38
Epoch 38/200 |loss: 10.778694| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 39
Epoch 39/200 |loss: 10.248454| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 40
Epoch 40/200 |loss: 10.497126| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 41
Epoch 41/200 |loss: 10.251020| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 42
Epoch 42/200 |loss: 10.189301| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 43
Epoch 43/200 |loss: 9.856499| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 44
Epoch 44/200 |loss: 9.701118| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 45
Epoch 45/200 |loss: 9.430262| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 46
Epoch 46/200 |loss: 9.469058| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 47
Epoch 47/200 |loss: 9.140145| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 48
Epoch 48/200 |loss: 9.133644| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 49
Epoch 49/200 |loss: 9.028988| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 50
Epoch 50/200 |loss: 8.874534| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 51
Epoch 51/200 |loss: 8.728982| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 52
Epoch 52/200 |loss: 8.732354| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 53
Epoch 53/200 |loss: 8.656460| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 54
Epoch 54/200 |loss: 8.764676| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 55
Epoch 55/200 |loss: 9.309844| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 56
Epoch 56/200 |loss: 10.690711| train set 5.255x speedup, test set 5.489x speedup, val set 5.333x speedup, step: 57
Epoch 57/200 |loss: 9.436509| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 58
Epoch 58/200 |loss: 9.773087| train set 5.058x speedup, test set 5.390x speedup, val set 5.159x speedup, step: 59
Epoch 59/200 |loss: 9.274288| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 60
Epoch 60/200 |loss: 9.325817| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 61
Epoch 61/200 |loss: 8.952140| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 62
Epoch 62/200 |loss: 8.939715| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 63
Epoch 63/200 |loss: 8.914813| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 64
Epoch 64/200 |loss: 8.630621| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 65
Epoch 65/200 |loss: 8.591402| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 66
Epoch 66/200 |loss: 8.528292| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 67/200 |loss: 8.416014| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 68
Epoch 68/200 |loss: 8.366590| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 69
Epoch 69/200 |loss: 8.360051| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 70/200 |loss: 8.133458| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 8.214683| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 72
Epoch 72/200 |loss: 8.033424| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 73
Epoch 73/200 |loss: 8.095646| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 74
Epoch 74/200 |loss: 7.978378| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 75
Epoch 75/200 |loss: 7.929683| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 76
Epoch 76/200 |loss: 7.935493| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 77
Epoch 77/200 |loss: 7.827673| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 78
Epoch 78/200 |loss: 7.823376| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 79
Epoch 79/200 |loss: 7.776238| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 80
Epoch 80/200 |loss: 7.737457| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 81
Epoch 81/200 |loss: 7.751588| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 82
Epoch 82/200 |loss: 7.699513| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 83
Epoch 83/200 |loss: 7.817858| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 84
Epoch 84/200 |loss: 7.887560| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 85
Epoch 85/200 |loss: 8.145937| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 86
Epoch 86/200 |loss: 7.841333| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 87
Epoch 87/200 |loss: 7.764228| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 88
Epoch 88/200 |loss: 7.949469| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 89
Epoch 89/200 |loss: 7.628301| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 90
Epoch 90/200 |loss: 7.895806| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 91
Epoch 91/200 |loss: 8.076089| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 92
Epoch 92/200 |loss: 7.559330| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 93
Epoch 93/200 |loss: 8.280844| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 94
Epoch 94/200 |loss: 8.457028| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 95
Epoch 95/200 |loss: 8.380624| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 96
Epoch 96/200 |loss: 8.011079| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 97
Epoch 97/200 |loss: 8.225002| train set 5.138x speedup, test set 5.422x speedup, val set 5.163x speedup, step: 98
Epoch 98/200 |loss: 8.018970| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 99
Epoch 99/200 |loss: 7.903980| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 100
Epoch 100/200 |loss: 7.921070| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 101/200 |loss: 7.850920| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 102/200 |loss: 7.751863| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 103/200 |loss: 7.779739| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 104/200 |loss: 7.686997| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 105/200 |loss: 7.643733| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 106/200 |loss: 7.628066| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 107/200 |loss: 7.580705| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 108/200 |loss: 7.553802| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 109/200 |loss: 7.534017| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 110/200 |loss: 7.478414| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 5
Epoch 111/200 |loss: 7.483289| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 112/200 |loss: 7.445745| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 113/200 |loss: 7.427841| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 114/200 |loss: 7.463985| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 115/200 |loss: 7.513960| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 116/200 |loss: 7.885030| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 117/200 |loss: 8.113099| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 118/200 |loss: 8.558625| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 119/200 |loss: 7.516091| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 120/200 |loss: 8.565285| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 4
Epoch 121/200 |loss: 8.063046| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5
Epoch 122/200 |loss: 7.938212| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 6
Epoch 123/200 |loss: 7.935466| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 124/200 |loss: 7.790444| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 8
Epoch 125/200 |loss: 7.836883| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 126/200 |loss: 7.570190| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 10
Epoch 127/200 |loss: 7.857427| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11
Epoch 128/200 |loss: 7.525504| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 12
Epoch 129/200 |loss: 7.686689| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 13
Epoch 130/200 |loss: 7.562776| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 14
Epoch 131/200 |loss: 7.498358| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 15
Epoch 132/200 |loss: 7.498543| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 16
Epoch 133/200 |loss: 7.407513| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 17
Epoch 134/200 |loss: 7.495408| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 18
Epoch 135/200 |loss: 7.393578| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19
Epoch 136/200 |loss: 7.429288| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 20
Epoch 137/200 |loss: 7.383231| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 21
Epoch 138/200 |loss: 7.343634| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 22
Epoch 139/200 |loss: 7.369963| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 23
Epoch 140/200 |loss: 7.307979| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 24
Epoch 141/200 |loss: 7.337957| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 25
Epoch 142/200 |loss: 7.298209| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26
Epoch 143/200 |loss: 7.310544| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 27
Epoch 144/200 |loss: 7.268717| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 28
Epoch 145/200 |loss: 7.294506| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 29
Epoch 146/200 |loss: 7.254794| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 30
Epoch 147/200 |loss: 7.259886| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 31
Epoch 148/200 |loss: 7.259013| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 32
Epoch 149/200 |loss: 7.245039| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 33
Epoch 150/200 |loss: 7.228846| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 34
Epoch 151/200 |loss: 7.231145| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 35
Epoch 152/200 |loss: 7.231107| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 36
Epoch 153/200 |loss: 7.215745| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 37
Epoch 154/200 |loss: 7.206113| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 38
Epoch 155/200 |loss: 7.206174| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 39
Epoch 156/200 |loss: 7.206873| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 40
Epoch 157/200 |loss: 7.201282| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 41
Epoch 158/200 |loss: 7.193669| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 42
Epoch 159/200 |loss: 7.180226| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 43
Epoch 160/200 |loss: 7.182449| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 44
Epoch 161/200 |loss: 7.178309| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 45
Epoch 162/200 |loss: 7.177858| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 46
Epoch 163/200 |loss: 7.178151| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 47
Epoch 164/200 |loss: 7.175709| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 48
Epoch 165/200 |loss: 7.172669| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 49
Epoch 166/200 |loss: 7.176884| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 50
Epoch 167/200 |loss: 7.177702| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 51
Epoch 168/200 |loss: 7.181203| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 52
Epoch 169/200 |loss: 7.201907| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 53
Epoch 170/200 |loss: 7.276806| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 54
Epoch 171/200 |loss: 7.376439| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 55
Epoch 172/200 |loss: 7.839614| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 56
Epoch 173/200 |loss: 7.586401| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 174/200 |loss: 7.856086| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2
Epoch 175/200 |loss: 7.465845| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 3
Epoch 176/200 |loss: 7.948973| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 4
Epoch 177/200 |loss: 8.148741| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5
Epoch 178/200 |loss: 7.781360| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 6
Epoch 179/200 |loss: 8.108758| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 180/200 |loss: 7.813680| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 181/200 |loss: 7.662513| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 182/200 |loss: 7.853919| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3
Epoch 183/200 |loss: 7.649498| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4
Epoch 184/200 |loss: 7.706583| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5
Epoch 185/200 |loss: 7.453682| train set 5.268x speedup, test set 5.504x speedup, val set 5.360x speedup, step: 6
Epoch 186/200 |loss: 7.661765| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 7
Epoch 187/200 |loss: 7.484697| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 188/200 |loss: 7.475954| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 189/200 |loss: 7.474525| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 190/200 |loss: 7.415543| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11
Epoch 191/200 |loss: 7.382267| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 12
Epoch 192/200 |loss: 7.368947| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13
Epoch 193/200 |loss: 7.357808| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 14
Epoch 194/200 |loss: 7.322088| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 15
Epoch 195/200 |loss: 7.288476| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16
Epoch 196/200 |loss: 7.328215| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 17
Epoch 197/200 |loss: 7.277183| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18
Epoch 198/200 |loss: 7.247772| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19
Epoch 199/200 |loss: 7.293177| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 20
Training per epoch cost 0.205 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 53, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 120, train speedup 5.325, test speedup 5.566, val speedup 5.399
best validation speedup epoch: 180, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 199, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:02:09.754833
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.968802, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265707| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655592| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191648| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782269| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315983| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842960| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317862| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803158| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291479| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819448| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.348166| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.856640| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.355412| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.877200| train set 4.376x speedup, test set 4.618x speedup, val set 4.468x speedup, step: 19
Epoch 19/200 |loss: 15.432649| train set 4.734x speedup, test set 4.806x speedup, val set 4.863x speedup, step: 20
Epoch 20/200 |loss: 15.116572| train set 4.815x speedup, test set 5.073x speedup, val set 4.897x speedup, step: 21
Epoch 21/200 |loss: 15.001422| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 22
Epoch 22/200 |loss: 14.515863| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 23
Epoch 23/200 |loss: 13.894844| train set 5.042x speedup, test set 5.371x speedup, val set 5.125x speedup, step: 24
Epoch 24/200 |loss: 13.807386| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 25
Epoch 25/200 |loss: 13.389920| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 26
Epoch 26/200 |loss: 12.914495| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 27
Epoch 27/200 |loss: 12.716296| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 28
Epoch 28/200 |loss: 12.491675| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 29
Epoch 29/200 |loss: 11.981709| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 30
Epoch 30/200 |loss: 11.678324| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.558307| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 32
Epoch 32/200 |loss: 11.443451| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 33
Epoch 33/200 |loss: 11.268777| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 34
Epoch 34/200 |loss: 10.954077| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 35
Epoch 35/200 |loss: 10.870070| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 36
Epoch 36/200 |loss: 10.585799| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 37
Epoch 37/200 |loss: 10.639538| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 38
Epoch 38/200 |loss: 10.180616| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 39
Epoch 39/200 |loss: 10.022376| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 40
Epoch 40/200 |loss: 10.109817| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 41
Epoch 41/200 |loss: 9.791225| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 42
Epoch 42/200 |loss: 9.474079| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 43
Epoch 43/200 |loss: 9.399652| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 44
Epoch 44/200 |loss: 9.179649| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 45
Epoch 45/200 |loss: 9.349149| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 46
Epoch 46/200 |loss: 9.446322| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 47
Epoch 47/200 |loss: 9.729222| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 48
Epoch 48/200 |loss: 9.107386| train set 5.268x speedup, test set 5.504x speedup, val set 5.361x speedup, step: 49
Epoch 49/200 |loss: 10.835973| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 50
Epoch 50/200 |loss: 10.280980| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 51
Epoch 51/200 |loss: 9.875009| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 52
Epoch 52/200 |loss: 9.765449| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 53
Epoch 53/200 |loss: 9.329497| train set 5.138x speedup, test set 5.422x speedup, val set 5.163x speedup, step: 54
Epoch 54/200 |loss: 9.546341| train set 5.308x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 55
Epoch 55/200 |loss: 9.008453| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 56
Epoch 56/200 |loss: 8.984289| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 57
Epoch 57/200 |loss: 8.995694| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 58
Epoch 58/200 |loss: 8.702932| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 59
Epoch 59/200 |loss: 8.687621| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 60
Epoch 60/200 |loss: 8.623915| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 61
Epoch 61/200 |loss: 8.501704| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 62
Epoch 62/200 |loss: 8.388673| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 63
Epoch 63/200 |loss: 8.389751| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 64
Epoch 64/200 |loss: 8.264491| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 65
Epoch 65/200 |loss: 8.162615| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 66
Epoch 66/200 |loss: 8.158005| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 67/200 |loss: 8.160557| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 68
Epoch 68/200 |loss: 8.210596| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 69
Epoch 69/200 |loss: 8.620281| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 70/200 |loss: 8.263533| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 7.920723| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 72
Epoch 72/200 |loss: 7.930219| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 73
Epoch 73/200 |loss: 8.070859| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 74
Epoch 74/200 |loss: 8.170011| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 75
Epoch 75/200 |loss: 7.878029| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 76
Epoch 76/200 |loss: 7.862566| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 77
Epoch 77/200 |loss: 8.111841| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 78
Epoch 78/200 |loss: 7.937478| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 79
Epoch 79/200 |loss: 7.854664| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 80
Epoch 80/200 |loss: 7.957423| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 81
Epoch 81/200 |loss: 8.107488| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 82
Epoch 82/200 |loss: 8.050586| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 83
Epoch 83/200 |loss: 8.184346| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 84
Epoch 84/200 |loss: 7.826990| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 85
Epoch 85/200 |loss: 8.221926| train set 5.138x speedup, test set 5.422x speedup, val set 5.163x speedup, step: 86
Epoch 86/200 |loss: 8.664454| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 87
Epoch 87/200 |loss: 8.274886| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 88
Epoch 88/200 |loss: 8.522522| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 89
Epoch 89/200 |loss: 7.809578| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 90
Epoch 90/200 |loss: 8.459664| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 91
Epoch 91/200 |loss: 7.786406| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 92
Epoch 92/200 |loss: 8.017662| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 93
Epoch 93/200 |loss: 7.910110| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 94
Epoch 94/200 |loss: 7.871965| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 95
Epoch 95/200 |loss: 7.719250| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 96
Epoch 96/200 |loss: 7.801128| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 97
Epoch 97/200 |loss: 7.868262| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 98
Epoch 98/200 |loss: 7.738070| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 99
Epoch 99/200 |loss: 7.716696| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 100
Epoch 100/200 |loss: 7.655994| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 101/200 |loss: 7.637672| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 102/200 |loss: 7.549109| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 103/200 |loss: 7.575765| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 104/200 |loss: 7.504106| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 105/200 |loss: 7.543154| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5
Epoch 106/200 |loss: 7.484361| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 107/200 |loss: 7.470592| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 108/200 |loss: 7.447377| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 109/200 |loss: 7.379848| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 110/200 |loss: 7.426728| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 111/200 |loss: 7.408784| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 112/200 |loss: 7.383110| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 113/200 |loss: 7.460143| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 114/200 |loss: 7.517404| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 115/200 |loss: 7.704344| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 116/200 |loss: 8.281473| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 2
Epoch 117/200 |loss: 7.583375| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3
Epoch 118/200 |loss: 7.765848| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4
Epoch 119/200 |loss: 7.976538| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 5
Epoch 120/200 |loss: 7.801558| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6
Epoch 121/200 |loss: 7.935752| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 7
Epoch 122/200 |loss: 7.934304| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 8
Epoch 123/200 |loss: 7.697574| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 124/200 |loss: 7.787110| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 125/200 |loss: 7.482480| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11
Epoch 126/200 |loss: 7.669559| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12
Epoch 127/200 |loss: 7.479001| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 13
Epoch 128/200 |loss: 7.571305| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 14
Epoch 129/200 |loss: 7.421962| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 15
Epoch 130/200 |loss: 7.544653| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16
Epoch 131/200 |loss: 7.385417| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 17
Epoch 132/200 |loss: 7.457938| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 18
Epoch 133/200 |loss: 7.360622| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19
Epoch 134/200 |loss: 7.431750| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 20
Epoch 135/200 |loss: 7.307911| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21
Epoch 136/200 |loss: 7.360482| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 22
Epoch 137/200 |loss: 7.324810| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 23
Epoch 138/200 |loss: 7.299106| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 24
Epoch 139/200 |loss: 7.306652| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 25
Epoch 140/200 |loss: 7.262422| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 26
Epoch 141/200 |loss: 7.302374| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 27
Epoch 142/200 |loss: 7.263888| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28
Epoch 143/200 |loss: 7.268587| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29
Epoch 144/200 |loss: 7.243302| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 30
Epoch 145/200 |loss: 7.242276| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 31
Epoch 146/200 |loss: 7.225584| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 32
Epoch 147/200 |loss: 7.228383| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 33
Epoch 148/200 |loss: 7.232999| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34
Epoch 149/200 |loss: 7.253683| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 35
Epoch 150/200 |loss: 7.309069| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 36
Epoch 151/200 |loss: 7.386244| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 152/200 |loss: 7.671869| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 153/200 |loss: 7.407484| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 3
Epoch 154/200 |loss: 7.353775| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 155/200 |loss: 7.285295| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5
Epoch 156/200 |loss: 7.412715| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6
Epoch 157/200 |loss: 7.542430| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 158/200 |loss: 7.302041| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 8
Epoch 159/200 |loss: 7.479972| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9
Epoch 160/200 |loss: 7.606235| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 161/200 |loss: 7.319468| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11
Epoch 162/200 |loss: 7.548867| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 12
Epoch 163/200 |loss: 7.612257| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 13
Epoch 164/200 |loss: 7.398179| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 14
Epoch 165/200 |loss: 7.572353| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 15
Epoch 166/200 |loss: 7.394400| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 16
Epoch 167/200 |loss: 7.350436| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 17
Epoch 168/200 |loss: 7.441063| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 18
Epoch 169/200 |loss: 7.384022| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19
Epoch 170/200 |loss: 7.385657| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 20
Epoch 171/200 |loss: 7.345364| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 21
Epoch 172/200 |loss: 7.415515| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 22
Epoch 173/200 |loss: 7.303175| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 23
Epoch 174/200 |loss: 7.315244| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 24
Epoch 175/200 |loss: 7.350801| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 25
Epoch 176/200 |loss: 7.207838| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 26
Epoch 177/200 |loss: 7.326707| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 27
Epoch 178/200 |loss: 7.189770| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28
Epoch 179/200 |loss: 7.274784| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 29
Epoch 180/200 |loss: 7.232794| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 30
Epoch 181/200 |loss: 7.204771| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 31
Epoch 182/200 |loss: 7.227108| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 32
Epoch 183/200 |loss: 7.198598| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 33
Epoch 184/200 |loss: 7.189520| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34
Epoch 185/200 |loss: 7.197967| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 35
Epoch 186/200 |loss: 7.203809| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 36
Epoch 187/200 |loss: 7.140494| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 37
Epoch 188/200 |loss: 7.199918| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 38
Epoch 189/200 |loss: 7.180954| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 39
Epoch 190/200 |loss: 7.165989| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 40
Epoch 191/200 |loss: 7.195393| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 41
Epoch 192/200 |loss: 7.142474| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 42
Epoch 193/200 |loss: 7.141454| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 43
Epoch 194/200 |loss: 7.187413| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 44
Epoch 195/200 |loss: 7.161110| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 45
Epoch 196/200 |loss: 7.140442| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 46
Epoch 197/200 |loss: 7.145700| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 47
Epoch 198/200 |loss: 7.154648| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 48
Epoch 199/200 |loss: 7.113246| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 49
Training per epoch cost 0.207 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 51, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 51, train speedup 5.326, test speedup 5.559, val speedup 5.403
best validation speedup epoch: 151, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 199, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:02:09.653289
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.863380, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265707| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655590| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191647| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782265| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315981| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842953| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317846| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803154| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291451| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819798| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.347836| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.855841| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.351196| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.868304| train set 4.376x speedup, test set 4.618x speedup, val set 4.468x speedup, step: 19
Epoch 19/200 |loss: 15.433975| train set 4.857x speedup, test set 5.093x speedup, val set 4.969x speedup, step: 20
Epoch 20/200 |loss: 15.167108| train set 4.631x speedup, test set 4.867x speedup, val set 4.772x speedup, step: 21
Epoch 21/200 |loss: 15.049605| train set 4.880x speedup, test set 5.070x speedup, val set 5.054x speedup, step: 22
Epoch 22/200 |loss: 14.391894| train set 4.880x speedup, test set 5.070x speedup, val set 5.054x speedup, step: 23
Epoch 23/200 |loss: 13.905785| train set 5.042x speedup, test set 5.371x speedup, val set 5.125x speedup, step: 24
Epoch 24/200 |loss: 13.839595| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 25
Epoch 25/200 |loss: 13.243731| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 26
Epoch 26/200 |loss: 12.949617| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 27
Epoch 27/200 |loss: 12.754459| train set 5.264x speedup, test set 5.496x speedup, val set 5.498x speedup, step: 28
Epoch 28/200 |loss: 12.363508| train set 5.306x speedup, test set 5.536x speedup, val set 5.363x speedup, step: 29
Epoch 29/200 |loss: 11.961058| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 30
Epoch 30/200 |loss: 11.812701| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.648823| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 32
Epoch 32/200 |loss: 11.515405| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 33
Epoch 33/200 |loss: 11.012735| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 34
Epoch 34/200 |loss: 10.922202| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 35
Epoch 35/200 |loss: 10.849647| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 36
Epoch 36/200 |loss: 10.371187| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 37
Epoch 37/200 |loss: 10.460875| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 38
Epoch 38/200 |loss: 10.337237| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 39
Epoch 39/200 |loss: 10.121974| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 40
Epoch 40/200 |loss: 10.631506| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 41
Epoch 41/200 |loss: 11.035500| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 42
Epoch 42/200 |loss: 10.050901| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 43
Epoch 43/200 |loss: 9.936375| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 44
Epoch 44/200 |loss: 9.837958| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 45
Epoch 45/200 |loss: 9.395215| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 46
Epoch 46/200 |loss: 9.438750| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 47
Epoch 47/200 |loss: 9.307751| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 48
Epoch 48/200 |loss: 9.102835| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 49
Epoch 49/200 |loss: 9.061753| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 50
Epoch 50/200 |loss: 8.957629| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 51
Epoch 51/200 |loss: 8.773053| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 52
Epoch 52/200 |loss: 8.722434| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 53
Epoch 53/200 |loss: 8.717818| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 54
Epoch 54/200 |loss: 8.766639| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 55
Epoch 55/200 |loss: 8.553392| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 56
Epoch 56/200 |loss: 8.395391| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 57
Epoch 57/200 |loss: 8.481931| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 58
Epoch 58/200 |loss: 9.047097| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 59
Epoch 59/200 |loss: 8.555746| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 60
Epoch 60/200 |loss: 8.205338| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 61
Epoch 61/200 |loss: 8.400916| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 62
Epoch 62/200 |loss: 8.515821| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 63
Epoch 63/200 |loss: 8.414823| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 64
Epoch 64/200 |loss: 8.133456| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 65
Epoch 65/200 |loss: 8.713866| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 66
Epoch 66/200 |loss: 8.441010| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 67/200 |loss: 8.240602| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 68
Epoch 68/200 |loss: 8.647363| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 69
Epoch 69/200 |loss: 7.970200| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 70/200 |loss: 8.440941| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 8.458098| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 72
Epoch 72/200 |loss: 8.165356| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 73
Epoch 73/200 |loss: 8.851915| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 74
Epoch 74/200 |loss: 8.075205| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 75
Epoch 75/200 |loss: 8.860415| train set 5.113x speedup, test set 5.449x speedup, val set 5.074x speedup, step: 76
Epoch 76/200 |loss: 8.447476| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 77
Epoch 77/200 |loss: 8.446399| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 78
Epoch 78/200 |loss: 8.200863| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 79
Epoch 79/200 |loss: 8.198541| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 80
Epoch 80/200 |loss: 8.009829| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 81
Epoch 81/200 |loss: 8.127371| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 82
Epoch 82/200 |loss: 7.917908| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 83
Epoch 83/200 |loss: 7.925854| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 84
Epoch 84/200 |loss: 7.889993| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 85
Epoch 85/200 |loss: 7.819829| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 86
Epoch 86/200 |loss: 7.787742| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 87
Epoch 87/200 |loss: 7.659248| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 88
Epoch 88/200 |loss: 7.741672| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 89
Epoch 89/200 |loss: 7.596358| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 90
Epoch 90/200 |loss: 7.662086| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 91
Epoch 91/200 |loss: 7.561852| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 92
Epoch 92/200 |loss: 7.598886| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 93
Epoch 93/200 |loss: 7.636192| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 94
Epoch 94/200 |loss: 7.777356| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 95
Epoch 95/200 |loss: 8.395230| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 96
Epoch 96/200 |loss: 7.696834| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 97
Epoch 97/200 |loss: 7.861263| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 98
Epoch 98/200 |loss: 8.347966| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 99
Epoch 99/200 |loss: 8.051908| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 100
Epoch 100/200 |loss: 7.850733| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 101/200 |loss: 7.955567| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 102/200 |loss: 7.647572| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 103/200 |loss: 7.794734| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 104/200 |loss: 7.754451| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 105/200 |loss: 7.659746| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 106/200 |loss: 7.696599| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 107/200 |loss: 7.654533| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 5
Epoch 108/200 |loss: 7.589190| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 6
Epoch 109/200 |loss: 7.481019| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 110/200 |loss: 7.573062| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 111/200 |loss: 7.431228| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 9
Epoch 112/200 |loss: 7.552049| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 113/200 |loss: 7.516094| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11
Epoch 114/200 |loss: 7.522882| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 115/200 |loss: 7.392470| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 116/200 |loss: 7.483923| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 117/200 |loss: 7.401614| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 118/200 |loss: 7.373635| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5
Epoch 119/200 |loss: 7.360559| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 120/200 |loss: 7.354835| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 121/200 |loss: 7.390743| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 122/200 |loss: 7.339605| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 123/200 |loss: 7.346300| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 124/200 |loss: 7.304708| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 125/200 |loss: 7.320237| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 126/200 |loss: 7.369810| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 127/200 |loss: 7.395663| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 128/200 |loss: 7.476004| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 129/200 |loss: 7.408456| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 130/200 |loss: 7.367473| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 131/200 |loss: 7.276392| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 132/200 |loss: 7.262867| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 133/200 |loss: 7.325195| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 134/200 |loss: 7.344047| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5
Epoch 135/200 |loss: 7.411234| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 136/200 |loss: 7.290222| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 137/200 |loss: 7.254854| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 138/200 |loss: 7.233438| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 139/200 |loss: 7.286956| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 140/200 |loss: 7.338941| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 141/200 |loss: 7.271283| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 142/200 |loss: 7.254038| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 143/200 |loss: 7.200784| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 144/200 |loss: 7.250254| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 145/200 |loss: 7.306126| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 146/200 |loss: 7.282130| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 147/200 |loss: 7.297150| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 148/200 |loss: 7.216223| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 149/200 |loss: 7.227399| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 150/200 |loss: 7.256897| train set 5.326x speedup, test set 5.561x speedup, val set 5.384x speedup, step: 5
Epoch 151/200 |loss: 7.296876| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6
Epoch 152/200 |loss: 7.394528| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 7
Epoch 153/200 |loss: 7.265819| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 154/200 |loss: 7.249066| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 155/200 |loss: 7.197927| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 156/200 |loss: 7.233857| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 157/200 |loss: 7.297749| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2
Epoch 158/200 |loss: 7.299555| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 159/200 |loss: 7.322541| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 160/200 |loss: 7.289807| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 161/200 |loss: 7.393526| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 162/200 |loss: 7.814931| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 163/200 |loss: 7.575697| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 164/200 |loss: 7.333231| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 165/200 |loss: 7.253848| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 166/200 |loss: 7.325202| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 167/200 |loss: 7.540712| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 168/200 |loss: 7.291003| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 169/200 |loss: 7.403007| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 170/200 |loss: 7.616080| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2
Epoch 171/200 |loss: 7.277864| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 172/200 |loss: 7.422839| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 173/200 |loss: 7.532207| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 174/200 |loss: 7.295567| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 3
Epoch 175/200 |loss: 7.550212| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 176/200 |loss: 7.569265| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 177/200 |loss: 7.372291| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 2
Epoch 178/200 |loss: 7.669889| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 179/200 |loss: 7.408754| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 180/200 |loss: 7.487636| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 3
Epoch 181/200 |loss: 7.392106| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 182/200 |loss: 7.364201| train set 5.325x speedup, test set 5.564x speedup, val set 5.400x speedup, step: 5
Epoch 183/200 |loss: 7.386705| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6
Epoch 184/200 |loss: 7.271056| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 185/200 |loss: 7.337481| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 186/200 |loss: 7.241763| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 187/200 |loss: 7.296962| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 188/200 |loss: 7.234645| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 11
Epoch 189/200 |loss: 7.282256| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12
Epoch 190/200 |loss: 7.201027| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13
Epoch 191/200 |loss: 7.253301| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 14
Epoch 192/200 |loss: 7.224603| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 15
Epoch 193/200 |loss: 7.226406| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 16
Epoch 194/200 |loss: 7.236065| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 17
Epoch 195/200 |loss: 7.274134| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18
Epoch 196/200 |loss: 7.228291| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19
Epoch 197/200 |loss: 7.207366| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20
Epoch 198/200 |loss: 7.270250| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 21
Epoch 199/200 |loss: 7.210491| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 22
Training per epoch cost 0.205 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 150, train speedup 5.326, test speedup 5.561, val speedup 5.384
best test speedup epoch: 51, train speedup 5.325, test speedup 5.566, val speedup 5.399
best validation speedup epoch: 178, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 199, train speedup 5.326, test speedup 5.559, val speedup 5.403
execution cost 0:02:08.958621
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.881793, and there are 122 training samples
in channel 9
Epoch 0/200 |loss: 24.956434| train set 3.215x speedup, test set 3.566x speedup, val set 3.227x speedup, step: 1
Epoch 1/200 |loss: 24.265707| train set 3.109x speedup, test set 3.620x speedup, val set 3.162x speedup, step: 2
Epoch 2/200 |loss: 23.684248| train set 3.037x speedup, test set 3.522x speedup, val set 3.122x speedup, step: 3
Epoch 3/200 |loss: 23.222136| train set 3.304x speedup, test set 3.745x speedup, val set 3.396x speedup, step: 4
Epoch 4/200 |loss: 22.622990| train set 3.945x speedup, test set 4.103x speedup, val set 3.985x speedup, step: 5
Epoch 5/200 |loss: 22.135164| train set 4.003x speedup, test set 4.157x speedup, val set 4.047x speedup, step: 6
Epoch 6/200 |loss: 21.655592| train set 3.766x speedup, test set 3.980x speedup, val set 3.917x speedup, step: 7
Epoch 7/200 |loss: 21.191648| train set 3.776x speedup, test set 4.030x speedup, val set 3.813x speedup, step: 8
Epoch 8/200 |loss: 20.782269| train set 3.777x speedup, test set 4.358x speedup, val set 3.814x speedup, step: 9
Epoch 9/200 |loss: 20.315985| train set 3.771x speedup, test set 4.354x speedup, val set 3.807x speedup, step: 10
Epoch 10/200 |loss: 19.842960| train set 3.775x speedup, test set 4.204x speedup, val set 3.840x speedup, step: 11
Epoch 11/200 |loss: 19.317846| train set 3.930x speedup, test set 4.308x speedup, val set 4.049x speedup, step: 12
Epoch 12/200 |loss: 18.803160| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 13
Epoch 13/200 |loss: 18.291454| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 14
Epoch 14/200 |loss: 17.819807| train set 4.309x speedup, test set 4.398x speedup, val set 4.440x speedup, step: 15
Epoch 15/200 |loss: 17.347839| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 16
Epoch 16/200 |loss: 16.855749| train set 4.328x speedup, test set 4.570x speedup, val set 4.420x speedup, step: 17
Epoch 17/200 |loss: 16.351040| train set 4.540x speedup, test set 4.803x speedup, val set 4.577x speedup, step: 18
Epoch 18/200 |loss: 15.868057| train set 4.376x speedup, test set 4.618x speedup, val set 4.468x speedup, step: 19
Epoch 19/200 |loss: 15.437205| train set 4.857x speedup, test set 5.092x speedup, val set 4.968x speedup, step: 20
Epoch 20/200 |loss: 15.181284| train set 4.631x speedup, test set 4.867x speedup, val set 4.772x speedup, step: 21
Epoch 21/200 |loss: 15.023212| train set 4.880x speedup, test set 5.069x speedup, val set 5.054x speedup, step: 22
Epoch 22/200 |loss: 14.342965| train set 4.880x speedup, test set 5.070x speedup, val set 5.054x speedup, step: 23
Epoch 23/200 |loss: 13.920650| train set 5.042x speedup, test set 5.371x speedup, val set 5.125x speedup, step: 24
Epoch 24/200 |loss: 13.796789| train set 5.249x speedup, test set 5.477x speedup, val set 5.460x speedup, step: 25
Epoch 25/200 |loss: 13.235893| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 26
Epoch 26/200 |loss: 12.914786| train set 5.249x speedup, test set 5.477x speedup, val set 5.460x speedup, step: 27
Epoch 27/200 |loss: 12.695384| train set 5.324x speedup, test set 5.557x speedup, val set 5.402x speedup, step: 28
Epoch 28/200 |loss: 12.396208| train set 5.308x speedup, test set 5.537x speedup, val set 5.365x speedup, step: 29
Epoch 29/200 |loss: 12.138906| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 30
Epoch 30/200 |loss: 11.786588| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 31
Epoch 31/200 |loss: 11.603961| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 32
Epoch 32/200 |loss: 11.495996| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 33
Epoch 33/200 |loss: 11.151907| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 34
Epoch 34/200 |loss: 10.863512| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 35
Epoch 35/200 |loss: 11.026479| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 36
Epoch 36/200 |loss: 11.051243| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 37
Epoch 37/200 |loss: 10.873300| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 38
Epoch 38/200 |loss: 10.103266| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 39
Epoch 39/200 |loss: 10.121818| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 40
Epoch 40/200 |loss: 9.985844| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 41
Epoch 41/200 |loss: 9.946703| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 42
Epoch 42/200 |loss: 9.693575| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 43
Epoch 43/200 |loss: 9.482587| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 44
Epoch 44/200 |loss: 9.280267| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 45
Epoch 45/200 |loss: 9.329515| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 46
Epoch 46/200 |loss: 9.049951| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 47
Epoch 47/200 |loss: 8.961931| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 48
Epoch 48/200 |loss: 9.173044| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 49
Epoch 49/200 |loss: 9.019986| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 50
Epoch 50/200 |loss: 9.166829| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 51
Epoch 51/200 |loss: 9.199946| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 52
Epoch 52/200 |loss: 9.193167| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 53
Epoch 53/200 |loss: 8.990460| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 54
Epoch 54/200 |loss: 8.781172| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 55
Epoch 55/200 |loss: 8.802505| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 56
Epoch 56/200 |loss: 8.618813| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 57
Epoch 57/200 |loss: 8.366879| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 58
Epoch 58/200 |loss: 8.563280| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 59
Epoch 59/200 |loss: 8.620344| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 60
Epoch 60/200 |loss: 8.864379| train set 5.081x speedup, test set 5.373x speedup, val set 5.248x speedup, step: 61
Epoch 61/200 |loss: 9.123512| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 62
Epoch 62/200 |loss: 8.488229| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 63
Epoch 63/200 |loss: 8.442259| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 64
Epoch 64/200 |loss: 8.794235| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 65
Epoch 65/200 |loss: 8.216342| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 66
Epoch 66/200 |loss: 8.409096| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 67/200 |loss: 8.450935| train set 5.325x speedup, test set 5.564x speedup, val set 5.399x speedup, step: 68
Epoch 68/200 |loss: 8.346437| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 69
Epoch 69/200 |loss: 8.163212| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 70
Epoch 70/200 |loss: 8.463516| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 71
Epoch 71/200 |loss: 7.960216| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 72
Epoch 72/200 |loss: 8.180264| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 73
Epoch 73/200 |loss: 8.076225| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 74
Epoch 74/200 |loss: 8.002221| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 75
Epoch 75/200 |loss: 7.957028| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 76
Epoch 76/200 |loss: 8.198433| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 77
Epoch 77/200 |loss: 7.813060| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 78
Epoch 78/200 |loss: 8.016521| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 79
Epoch 79/200 |loss: 8.072883| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 80
Epoch 80/200 |loss: 7.811891| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 81
Epoch 81/200 |loss: 7.988321| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 82
Epoch 82/200 |loss: 8.263151| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 83
Epoch 83/200 |loss: 7.770486| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 84
Epoch 84/200 |loss: 8.431336| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 85
Epoch 85/200 |loss: 8.449009| train set 5.285x speedup, test set 5.523x speedup, val set 5.509x speedup, step: 86
Epoch 86/200 |loss: 8.634689| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 87
Epoch 87/200 |loss: 8.408735| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 88
Epoch 88/200 |loss: 8.085574| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 89
Epoch 89/200 |loss: 8.205722| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 90
Epoch 90/200 |loss: 8.096591| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 91
Epoch 91/200 |loss: 7.936864| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 92
Epoch 92/200 |loss: 7.918576| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 93
Epoch 93/200 |loss: 7.827440| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 94
Epoch 94/200 |loss: 7.842406| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 95
Epoch 95/200 |loss: 7.743608| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 96
Epoch 96/200 |loss: 7.765388| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 97
Epoch 97/200 |loss: 7.724371| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 98
Epoch 98/200 |loss: 7.647654| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 99
Epoch 99/200 |loss: 7.621522| train set 5.138x speedup, test set 5.422x speedup, val set 5.163x speedup, step: 100
Epoch 100/200 |loss: 7.729039| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 101/200 |loss: 7.507601| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 102/200 |loss: 7.574447| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 1
Epoch 103/200 |loss: 7.588001| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 104/200 |loss: 7.500210| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 105/200 |loss: 7.482107| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 106/200 |loss: 7.473608| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 107/200 |loss: 7.473613| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 108/200 |loss: 7.429281| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 109/200 |loss: 7.460653| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 110/200 |loss: 7.474030| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 111/200 |loss: 7.516256| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 112/200 |loss: 7.400162| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 1
Epoch 113/200 |loss: 7.365781| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 114/200 |loss: 7.514418| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 115/200 |loss: 7.533295| train set 5.286x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1
Epoch 116/200 |loss: 7.573841| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 117/200 |loss: 7.365215| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3
Epoch 118/200 |loss: 7.406307| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1
Epoch 119/200 |loss: 7.603630| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2
Epoch 120/200 |loss: 7.323415| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 3
Epoch 121/200 |loss: 7.401194| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1
Epoch 122/200 |loss: 7.554574| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 123/200 |loss: 7.333775| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 3
Epoch 124/200 |loss: 7.526173| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1
Epoch 125/200 |loss: 7.685591| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2
Epoch 126/200 |loss: 7.442191| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 3
Epoch 127/200 |loss: 7.639507| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4
Epoch 128/200 |loss: 7.527425| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5
Epoch 129/200 |loss: 7.459481| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 6
Epoch 130/200 |loss: 7.425962| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7
Epoch 131/200 |loss: 7.417495| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8
Epoch 132/200 |loss: 7.365826| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9
Epoch 133/200 |loss: 7.365366| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10
Epoch 134/200 |loss: 7.426055| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11
Epoch 135/200 |loss: 7.355199| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 12
Epoch 136/200 |loss: 7.487803| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13
Epoch 137/200 |loss: 7.506001| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 14
Epoch 138/200 |loss: 7.546657| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 15
Epoch 139/200 |loss: 7.473367| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 16
Epoch 140/200 |loss: 7.299498| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 17
Epoch 141/200 |loss: 7.402397| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 18
Epoch 142/200 |loss: 7.373090| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19
Epoch 143/200 |loss: 7.566998| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20
Epoch 144/200 |loss: 7.595937| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 21
Epoch 145/200 |loss: 7.474855| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 22
Epoch 146/200 |loss: 7.312958| train set 5.325x speedup, test set 5.567x speedup, val set 5.399x speedup, step: 23
Epoch 147/200 |loss: 7.540915| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 24
Epoch 148/200 |loss: 7.435198| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 25
Epoch 149/200 |loss: 7.326100| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 26
Epoch 150/200 |loss: 7.294067| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 27
Epoch 151/200 |loss: 7.395398| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28
Epoch 152/200 |loss: 7.434699| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29
Epoch 153/200 |loss: 7.260570| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 30
Epoch 154/200 |loss: 7.373618| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 31
Epoch 155/200 |loss: 7.447796| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 32
Epoch 156/200 |loss: 7.246176| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 33
Epoch 157/200 |loss: 7.363694| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34
Epoch 158/200 |loss: 7.446982| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 35
Epoch 159/200 |loss: 7.264981| train set 5.326x speedup, test set 5.561x speedup, val set 5.384x speedup, step: 36
Epoch 160/200 |loss: 7.414077| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 37
Epoch 161/200 |loss: 7.582247| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 38
Epoch 162/200 |loss: 7.225489| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 39
Epoch 163/200 |loss: 7.607829| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 40
Epoch 164/200 |loss: 7.651711| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 41
Epoch 165/200 |loss: 7.377522| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 42
Epoch 166/200 |loss: 7.699953| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 43
Epoch 167/200 |loss: 7.301409| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 44
Epoch 168/200 |loss: 7.457780| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 45
Epoch 169/200 |loss: 7.338754| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 46
Epoch 170/200 |loss: 7.370564| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 47
Epoch 171/200 |loss: 7.375735| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 48
Epoch 172/200 |loss: 7.295293| train set 5.326x speedup, test set 5.561x speedup, val set 5.384x speedup, step: 49
Epoch 173/200 |loss: 7.350453| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 50
Epoch 174/200 |loss: 7.276212| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 51
Epoch 175/200 |loss: 7.236671| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 52
Epoch 176/200 |loss: 7.281918| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 53
Epoch 177/200 |loss: 7.193238| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 54
Epoch 178/200 |loss: 7.259467| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 55
Epoch 179/200 |loss: 7.197134| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 56
Epoch 180/200 |loss: 7.201072| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 57
Epoch 181/200 |loss: 7.210427| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 58
Epoch 182/200 |loss: 7.165559| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 59
Epoch 183/200 |loss: 7.187672| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 60
Epoch 184/200 |loss: 7.198458| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 61
Epoch 185/200 |loss: 7.169810| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 62
Epoch 186/200 |loss: 7.179695| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 63
Epoch 187/200 |loss: 7.176424| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 64
Epoch 188/200 |loss: 7.158213| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 65
Epoch 189/200 |loss: 7.154222| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 66
Epoch 190/200 |loss: 7.177186| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 67
Epoch 191/200 |loss: 7.183534| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 68
Epoch 192/200 |loss: 7.171296| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 69
Epoch 193/200 |loss: 7.241816| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 70
Epoch 194/200 |loss: 7.223843| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 71
Epoch 195/200 |loss: 7.311433| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 72
Epoch 196/200 |loss: 7.176048| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 73
Epoch 197/200 |loss: 7.157510| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 74
Epoch 198/200 |loss: 7.158296| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 75
Epoch 199/200 |loss: 7.147895| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 76
Training per epoch cost 0.206 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 159, train speedup 5.326, test speedup 5.561, val speedup 5.384
best test speedup epoch: 146, train speedup 5.325, test speedup 5.567, val speedup 5.399
best validation speedup epoch: 124, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 199, train speedup 5.326, test speedup 5.559, val speedup 5.403
execution cost 0:02:09.336673
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.098805, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039595| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442951| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563330| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087484| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613012| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642015| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135260| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.630001| train set 4.218x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115280| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589657| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067186| train set 4.388x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.605206| train set 4.400x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.135443| train set 4.401x speedup, test set 4.465x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.671431| train set 4.548x speedup, test set 4.490x speedup, val set 4.675x speedup, step: 19
Epoch 19/200 |loss: 15.270952| train set 4.464x speedup, test set 4.693x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.021660| train set 4.600x speedup, test set 4.604x speedup, val set 4.863x speedup, step: 21
Epoch 21/200 |loss: 14.706023| train set 4.825x speedup, test set 5.051x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.118239| train set 5.034x speedup, test set 5.186x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 13.794979| train set 4.551x speedup, test set 4.840x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.565227| train set 5.058x speedup, test set 5.189x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.184243| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.658118| train set 5.058x speedup, test set 5.189x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.610845| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.290591| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.790906| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.683102| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.238913| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.359958| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 11.197288| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.885317| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 35
Epoch 35/200 |loss: 10.768498| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 36
Epoch 36/200 |loss: 10.981209| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 37
Epoch 37/200 |loss: 10.636994| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 38
Epoch 38/200 |loss: 10.138949| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 10.349891| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 10.011469| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 9.744545| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.960295| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 43
Epoch 43/200 |loss: 9.623776| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.290296| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.251728| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.365430| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 9.037549| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 8.893987| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 8.716834| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 8.776733| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.494475| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.672801| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.910471| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.710621| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.276834| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.301997| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 57
Epoch 57/200 |loss: 8.396685| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 58
Epoch 58/200 |loss: 8.621774| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 59
Epoch 59/200 |loss: 8.122916| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 60
Epoch 60/200 |loss: 8.394581| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 8.518947| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.241858| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 63
Epoch 63/200 |loss: 8.398792| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 64
Epoch 64/200 |loss: 8.545925| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 65
Epoch 65/200 |loss: 8.451698| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 8.260653| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 8.254968| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 7.940005| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 69
Epoch 69/200 |loss: 8.166748| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 8.012306| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 7.877355| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 72
Epoch 72/200 |loss: 7.748154| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 73
Epoch 73/200 |loss: 7.872534| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 7.892043| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 75
Epoch 75/200 |loss: 7.684411| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 76
Epoch 76/200 |loss: 7.749384| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 77
Epoch 77/200 |loss: 7.681054| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.678851| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.497619| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 7.593433| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 81
Epoch 81/200 |loss: 7.402586| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 82
Epoch 82/200 |loss: 7.555448| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.534187| train set 5.056x speedup, test set 5.366x speedup, val set 5.362x speedup, step: 84
Epoch 84/200 |loss: 8.784095| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 7.676337| train set 5.179x speedup, test set 5.500x speedup, val set 5.679x speedup, step: 86
Epoch 86/200 |loss: 8.789321| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 87
Epoch 87/200 |loss: 9.833265| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 88
Epoch 88/200 |loss: 8.640087| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 89
Epoch 89/200 |loss: 9.288453| train set 5.055x speedup, test set 5.364x speedup, val set 5.363x speedup, step: 90
Epoch 90/200 |loss: 8.309289| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 8.714900| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 8.095241| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 93
Epoch 93/200 |loss: 8.332146| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 8.002751| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 8.107066| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.697389| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 8.058057| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.663639| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 99
Epoch 99/200 |loss: 7.728085| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.617660| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.612166| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 102/200 |loss: 7.480605| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 103/200 |loss: 7.537021| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 104/200 |loss: 7.392280| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.417709| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 106/200 |loss: 7.337970| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 7.343190| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.259974| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 109/200 |loss: 7.283049| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 110/200 |loss: 7.215960| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 111/200 |loss: 7.216136| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.158942| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 113/200 |loss: 7.149253| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.118299| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 115/200 |loss: 7.107114| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 116/200 |loss: 7.106168| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 117/200 |loss: 7.059146| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 118/200 |loss: 7.091627| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 119/200 |loss: 7.126875| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 120/200 |loss: 7.221562| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 121/200 |loss: 7.372078| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 122/200 |loss: 8.033403| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 123/200 |loss: 7.324210| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 124/200 |loss: 7.095829| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 125/200 |loss: 7.401267| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 126/200 |loss: 7.278470| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 127/200 |loss: 7.008547| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 128/200 |loss: 7.230311| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.140315| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 130/200 |loss: 7.041865| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 131/200 |loss: 7.073522| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.097093| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 133/200 |loss: 7.113069| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 6.970042| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 135/200 |loss: 7.109702| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 136/200 |loss: 7.094815| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 137/200 |loss: 6.996094| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 138/200 |loss: 7.049740| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 7.183656| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 140/200 |loss: 6.977812| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 7.033669| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 142/200 |loss: 7.158383| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 143/200 |loss: 6.958882| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 144/200 |loss: 7.018220| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 145/200 |loss: 7.075613| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 146/200 |loss: 6.994039| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 147/200 |loss: 7.000175| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 148/200 |loss: 7.219123| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 149/200 |loss: 7.040787| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 150/200 |loss: 7.219954| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 7.108222| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 152/200 |loss: 6.997112| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 153/200 |loss: 7.143770| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 154/200 |loss: 7.096539| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 155/200 |loss: 6.913113| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 156/200 |loss: 7.105867| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 157/200 |loss: 6.985924| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 158/200 |loss: 6.928346| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 159/200 |loss: 7.037190| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 160/200 |loss: 6.944865| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 6.890465| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 6.990357| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 163/200 |loss: 6.908645| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 164/200 |loss: 6.886067| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 165/200 |loss: 6.972345| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 166/200 |loss: 6.869298| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 6.889679| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 168/200 |loss: 6.944637| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 169/200 |loss: 6.903641| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 170/200 |loss: 6.926084| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 171/200 |loss: 6.982189| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 172/200 |loss: 6.995676| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 173/200 |loss: 6.959600| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 174/200 |loss: 7.039881| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 175/200 |loss: 6.949322| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 176/200 |loss: 6.898768| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 6.860538| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 178/200 |loss: 6.881926| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 179/200 |loss: 6.859362| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 6.839538| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 181/200 |loss: 6.869136| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 182/200 |loss: 6.884333| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 183/200 |loss: 7.019900| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 184/200 |loss: 7.030375| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 185/200 |loss: 7.264977| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 186/200 |loss: 6.920807| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.862874| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 188/200 |loss: 6.959795| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 189/200 |loss: 6.943034| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 190/200 |loss: 6.960430| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 191/200 |loss: 6.854682| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 192/200 |loss: 6.837184| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 193/200 |loss: 6.833047| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 194/200 |loss: 6.886609| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 195/200 |loss: 6.985740| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 196/200 |loss: 6.867413| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 197/200 |loss: 6.827793| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 198/200 |loss: 6.847964| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 199/200 |loss: 6.862855| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Training per epoch cost 0.204 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 96, train speedup 5.267, test speedup 5.498, val speedup 5.638
best test speedup epoch: 34, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 196, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 199, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:02:11.967956
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.151426, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442945| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563326| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087481| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613005| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114954| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642027| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135202| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629988| train set 4.166x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.116007| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.593994| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.063347| train set 4.388x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.590620| train set 4.352x speedup, test set 4.419x speedup, val set 4.547x speedup, step: 17
Epoch 17/200 |loss: 16.153082| train set 4.463x speedup, test set 4.692x speedup, val set 4.640x speedup, step: 18
Epoch 18/200 |loss: 15.752023| train set 4.376x speedup, test set 4.388x speedup, val set 4.532x speedup, step: 19
Epoch 19/200 |loss: 15.332630| train set 4.653x speedup, test set 4.758x speedup, val set 4.755x speedup, step: 20
Epoch 20/200 |loss: 14.858128| train set 4.623x speedup, test set 4.868x speedup, val set 4.909x speedup, step: 21
Epoch 21/200 |loss: 14.460881| train set 4.411x speedup, test set 4.771x speedup, val set 4.664x speedup, step: 22
Epoch 22/200 |loss: 14.127481| train set 4.825x speedup, test set 5.051x speedup, val set 5.077x speedup, step: 23
Epoch 23/200 |loss: 13.787486| train set 4.993x speedup, test set 5.128x speedup, val set 5.215x speedup, step: 24
Epoch 24/200 |loss: 13.520577| train set 4.993x speedup, test set 5.126x speedup, val set 5.216x speedup, step: 25
Epoch 25/200 |loss: 13.315032| train set 4.835x speedup, test set 5.111x speedup, val set 5.140x speedup, step: 26
Epoch 26/200 |loss: 13.078577| train set 4.622x speedup, test set 4.909x speedup, val set 4.855x speedup, step: 27
Epoch 27/200 |loss: 12.421627| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.371878| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.076987| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 30
Epoch 30/200 |loss: 11.514447| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.681240| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 32
Epoch 32/200 |loss: 11.277747| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 10.822450| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 34
Epoch 34/200 |loss: 10.892029| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 35
Epoch 35/200 |loss: 10.619780| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 36
Epoch 36/200 |loss: 10.217344| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 37
Epoch 37/200 |loss: 10.094786| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 38
Epoch 38/200 |loss: 10.264932| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 39
Epoch 39/200 |loss: 9.864696| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 10.304619| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 9.589396| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.441038| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 9.740001| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.468324| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.363821| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.204598| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 9.289384| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 9.225166| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 49
Epoch 49/200 |loss: 9.021167| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 8.890285| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.582341| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.561757| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.557421| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.352347| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.359399| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 56
Epoch 56/200 |loss: 8.115871| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 57
Epoch 57/200 |loss: 8.268619| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 58
Epoch 58/200 |loss: 8.345604| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 9.193752| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 60
Epoch 60/200 |loss: 8.702934| train set 5.056x speedup, test set 5.366x speedup, val set 5.362x speedup, step: 61
Epoch 61/200 |loss: 8.975796| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.849650| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 63
Epoch 63/200 |loss: 8.947334| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 64
Epoch 64/200 |loss: 8.853465| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 8.652404| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 8.396375| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 67
Epoch 67/200 |loss: 8.317137| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 68
Epoch 68/200 |loss: 8.516602| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 7.951138| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 8.263553| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 7.928565| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 72
Epoch 72/200 |loss: 8.035339| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 7.854937| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 7.800074| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.759880| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.698822| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 77
Epoch 77/200 |loss: 7.637753| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 78
Epoch 78/200 |loss: 7.636991| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 79
Epoch 79/200 |loss: 7.543368| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 7.520712| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.449096| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.426438| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 83
Epoch 83/200 |loss: 7.445340| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 84
Epoch 84/200 |loss: 7.461162| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 7.576235| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.546431| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 87
Epoch 87/200 |loss: 7.714472| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.407346| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 7.334812| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.332300| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.378548| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 92
Epoch 92/200 |loss: 7.401928| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 93
Epoch 93/200 |loss: 7.313070| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 94
Epoch 94/200 |loss: 7.228406| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 95
Epoch 95/200 |loss: 7.213959| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.246575| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 7.385377| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.639376| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.287498| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 100
Epoch 100/200 |loss: 7.137611| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.231320| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 102/200 |loss: 7.530643| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.423494| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 104/200 |loss: 7.310462| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.253881| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 106/200 |loss: 7.492177| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 107/200 |loss: 7.187771| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.206462| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 109/200 |loss: 7.472270| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 110/200 |loss: 7.274202| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 111/200 |loss: 7.429133| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.354221| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 113/200 |loss: 7.349524| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 114/200 |loss: 7.566911| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 115/200 |loss: 7.229093| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.440631| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 117/200 |loss: 7.474966| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.590824| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 119/200 |loss: 7.197066| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 120/200 |loss: 7.660681| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 121/200 |loss: 7.191761| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 122/200 |loss: 7.672027| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 123/200 |loss: 7.085868| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 124/200 |loss: 7.395976| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 125/200 |loss: 7.404430| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 126/200 |loss: 7.194391| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.295836| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 128/200 |loss: 7.283811| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.339752| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 130/200 |loss: 7.487937| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.168666| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.507259| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 133/200 |loss: 7.411500| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 134/200 |loss: 7.232499| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 135/200 |loss: 7.374927| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 136/200 |loss: 7.121526| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 137/200 |loss: 7.228639| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 138/200 |loss: 7.078954| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 7.119067| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 140/200 |loss: 7.080894| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 7.068361| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 142/200 |loss: 7.047539| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 143/200 |loss: 7.015677| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 144/200 |loss: 7.014173| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 145/200 |loss: 7.005111| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 146/200 |loss: 6.971545| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 147/200 |loss: 7.004947| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 148/200 |loss: 6.909648| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 6.967664| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 150/200 |loss: 6.911404| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 6.933290| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 152/200 |loss: 6.908617| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 6.907368| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 154/200 |loss: 6.892174| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 155/200 |loss: 6.889864| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 156/200 |loss: 6.877126| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 157/200 |loss: 6.863815| train set 5.222x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 158/200 |loss: 6.877931| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 159/200 |loss: 6.877872| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 160/200 |loss: 6.952760| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 7.105190| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 7.729086| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 163/200 |loss: 7.004103| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 164/200 |loss: 7.200180| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 165/200 |loss: 7.735474| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 166/200 |loss: 7.091794| train set 5.179x speedup, test set 5.500x speedup, val set 5.679x speedup, step: 1
Epoch 167/200 |loss: 7.620426| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 168/200 |loss: 7.250219| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 169/200 |loss: 7.256656| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4
Epoch 170/200 |loss: 7.347048| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 171/200 |loss: 7.116338| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6
Epoch 172/200 |loss: 7.237092| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 7
Epoch 173/200 |loss: 7.023292| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8
Epoch 174/200 |loss: 7.072216| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 9
Epoch 175/200 |loss: 7.033615| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10
Epoch 176/200 |loss: 6.993111| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 11
Epoch 177/200 |loss: 7.012811| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 12
Epoch 178/200 |loss: 6.911255| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 13
Epoch 179/200 |loss: 6.960700| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 14
Epoch 180/200 |loss: 6.903454| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 15
Epoch 181/200 |loss: 6.914178| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 16
Epoch 182/200 |loss: 6.888364| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 17
Epoch 183/200 |loss: 6.874597| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 18
Epoch 184/200 |loss: 6.881501| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 19
Epoch 185/200 |loss: 6.863105| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 20
Epoch 186/200 |loss: 6.859009| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 21
Epoch 187/200 |loss: 6.866800| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 22
Epoch 188/200 |loss: 6.918325| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 23
Epoch 189/200 |loss: 7.200023| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 24
Epoch 190/200 |loss: 7.093696| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 25
Epoch 191/200 |loss: 7.313136| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 26
Epoch 192/200 |loss: 6.946274| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 27
Epoch 193/200 |loss: 7.209691| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 28
Epoch 194/200 |loss: 7.308630| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 29
Epoch 195/200 |loss: 7.085680| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 30
Epoch 196/200 |loss: 7.276619| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 31
Epoch 197/200 |loss: 7.358875| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 32
Epoch 198/200 |loss: 7.091404| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 33
Epoch 199/200 |loss: 7.163991| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 34
Training per epoch cost 0.206 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 158, train speedup 5.267, test speedup 5.498, val speedup 5.638
best test speedup epoch: 36, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 166, train speedup 5.179, test speedup 5.500, val speedup 5.679
last model at epoch 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
execution cost 0:02:09.350243
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.125538, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963154| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563330| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087482| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642014| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135258| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629997| train set 4.218x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115276| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589630| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067343| train set 4.319x speedup, test set 4.397x speedup, val set 4.515x speedup, step: 16
Epoch 16/200 |loss: 16.607136| train set 4.400x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.138931| train set 4.401x speedup, test set 4.465x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.685968| train set 4.696x speedup, test set 4.665x speedup, val set 4.826x speedup, step: 19
Epoch 19/200 |loss: 15.307281| train set 4.464x speedup, test set 4.693x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.014216| train set 4.682x speedup, test set 4.863x speedup, val set 4.928x speedup, step: 21
Epoch 21/200 |loss: 14.644540| train set 4.766x speedup, test set 4.992x speedup, val set 5.016x speedup, step: 22
Epoch 22/200 |loss: 14.151722| train set 4.844x speedup, test set 5.068x speedup, val set 5.097x speedup, step: 23
Epoch 23/200 |loss: 13.781915| train set 5.014x speedup, test set 5.146x speedup, val set 5.236x speedup, step: 24
Epoch 24/200 |loss: 13.524218| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 25
Epoch 25/200 |loss: 13.246632| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.812392| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 27
Epoch 27/200 |loss: 12.462418| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.146329| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.979784| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 30
Epoch 30/200 |loss: 11.729741| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.312165| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.189346| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 33
Epoch 33/200 |loss: 11.636624| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 11.316934| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 35
Epoch 35/200 |loss: 10.590816| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 36
Epoch 36/200 |loss: 10.971642| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 37
Epoch 37/200 |loss: 10.078966| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 38
Epoch 38/200 |loss: 10.369496| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 9.954871| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 9.916899| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 9.603146| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.478209| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 43
Epoch 43/200 |loss: 9.339664| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 44
Epoch 44/200 |loss: 9.636451| train set 5.162x speedup, test set 5.468x speedup, val set 5.482x speedup, step: 45
Epoch 45/200 |loss: 10.979748| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 46
Epoch 46/200 |loss: 10.336431| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 9.806356| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 10.277692| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 9.198791| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 50
Epoch 50/200 |loss: 9.830417| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 51
Epoch 51/200 |loss: 9.011403| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 9.142635| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.990367| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 54
Epoch 54/200 |loss: 8.674685| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 55
Epoch 55/200 |loss: 8.881824| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 56
Epoch 56/200 |loss: 8.499664| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 57
Epoch 57/200 |loss: 8.593692| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 58
Epoch 58/200 |loss: 8.470322| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 59
Epoch 59/200 |loss: 8.337504| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 60
Epoch 60/200 |loss: 8.243273| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 61
Epoch 61/200 |loss: 8.206285| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 62
Epoch 62/200 |loss: 8.059439| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 63
Epoch 63/200 |loss: 8.124775| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 64
Epoch 64/200 |loss: 7.961847| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 65
Epoch 65/200 |loss: 7.982038| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 66
Epoch 66/200 |loss: 7.921373| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 67
Epoch 67/200 |loss: 7.908373| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 7.895548| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 7.854020| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 70
Epoch 70/200 |loss: 7.788933| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 7.703149| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 7.647271| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 73
Epoch 73/200 |loss: 7.606709| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 7.619473| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.612187| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 76
Epoch 76/200 |loss: 7.992621| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 77
Epoch 77/200 |loss: 7.743751| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 78
Epoch 78/200 |loss: 7.633588| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.427631| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 7.565633| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 81
Epoch 81/200 |loss: 7.866206| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.587715| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.324523| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 7.503518| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 7.608454| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 86
Epoch 86/200 |loss: 7.715934| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.304259| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.567445| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 8.028223| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.433589| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 8.018493| train set 5.056x speedup, test set 5.366x speedup, val set 5.362x speedup, step: 92
Epoch 92/200 |loss: 8.150167| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 93
Epoch 93/200 |loss: 7.695769| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 8.050929| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.669247| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.918747| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 97
Epoch 97/200 |loss: 7.612094| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.612670| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.567981| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.432075| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.554845| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.343809| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.380004| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 104/200 |loss: 7.314527| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 105/200 |loss: 7.257958| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 106/200 |loss: 7.324102| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 7.178998| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.251019| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.179320| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 110/200 |loss: 7.160686| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 111/200 |loss: 7.143063| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 112/200 |loss: 7.172321| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 113/200 |loss: 7.198088| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.216723| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 115/200 |loss: 7.627701| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.866037| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 117/200 |loss: 8.010964| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 118/200 |loss: 7.330306| train set 5.179x speedup, test set 5.500x speedup, val set 5.679x speedup, step: 1
Epoch 119/200 |loss: 8.207238| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 120/200 |loss: 8.019696| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 121/200 |loss: 7.796997| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4
Epoch 122/200 |loss: 7.693344| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5
Epoch 123/200 |loss: 7.681287| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6
Epoch 124/200 |loss: 7.693119| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 7
Epoch 125/200 |loss: 7.540071| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8
Epoch 126/200 |loss: 7.496738| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 9
Epoch 127/200 |loss: 7.556281| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 10
Epoch 128/200 |loss: 7.262290| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 11
Epoch 129/200 |loss: 7.500142| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 12
Epoch 130/200 |loss: 7.217453| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 13
Epoch 131/200 |loss: 7.306236| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 14
Epoch 132/200 |loss: 7.257111| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 15
Epoch 133/200 |loss: 7.272052| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 16
Epoch 134/200 |loss: 7.145004| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 17
Epoch 135/200 |loss: 7.243523| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 18
Epoch 136/200 |loss: 7.231498| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 19
Epoch 137/200 |loss: 7.070774| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 20
Epoch 138/200 |loss: 7.186813| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 21
Epoch 139/200 |loss: 7.152310| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 22
Epoch 140/200 |loss: 7.040379| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 23
Epoch 141/200 |loss: 7.155248| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 24
Epoch 142/200 |loss: 7.169901| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 25
Epoch 143/200 |loss: 7.014132| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 26
Epoch 144/200 |loss: 7.166612| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 27
Epoch 145/200 |loss: 7.131616| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 28
Epoch 146/200 |loss: 7.035071| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 29
Epoch 147/200 |loss: 7.137786| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 30
Epoch 148/200 |loss: 7.132347| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 31
Epoch 149/200 |loss: 7.015541| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 32
Epoch 150/200 |loss: 7.078870| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 33
Epoch 151/200 |loss: 7.063286| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 34
Epoch 152/200 |loss: 6.966472| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 35
Epoch 153/200 |loss: 7.030420| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 36
Epoch 154/200 |loss: 7.043486| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 37
Epoch 155/200 |loss: 6.930264| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 38
Epoch 156/200 |loss: 7.043111| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 39
Epoch 157/200 |loss: 6.985509| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 40
Epoch 158/200 |loss: 6.902215| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 41
Epoch 159/200 |loss: 7.033555| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 42
Epoch 160/200 |loss: 6.967882| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 43
Epoch 161/200 |loss: 6.930387| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 44
Epoch 162/200 |loss: 6.986275| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 45
Epoch 163/200 |loss: 6.936255| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 46
Epoch 164/200 |loss: 6.900981| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 47
Epoch 165/200 |loss: 6.978457| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 48
Epoch 166/200 |loss: 6.993228| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 49
Epoch 167/200 |loss: 6.884794| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 50
Epoch 168/200 |loss: 7.006206| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 51
Epoch 169/200 |loss: 7.067354| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 52
Epoch 170/200 |loss: 6.888700| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 53
Epoch 171/200 |loss: 7.164293| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 54
Epoch 172/200 |loss: 7.169569| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 55
Epoch 173/200 |loss: 6.980797| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 56
Epoch 174/200 |loss: 7.310009| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 57
Epoch 175/200 |loss: 7.141757| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 58
Epoch 176/200 |loss: 7.071310| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 59
Epoch 177/200 |loss: 7.131151| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 60
Epoch 178/200 |loss: 6.884694| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 61
Epoch 179/200 |loss: 7.030544| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 62
Epoch 180/200 |loss: 6.894514| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 63
Epoch 181/200 |loss: 6.992630| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 64
Epoch 182/200 |loss: 6.938611| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 65
Epoch 183/200 |loss: 6.919706| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 66
Epoch 184/200 |loss: 6.954427| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 67
Epoch 185/200 |loss: 6.878205| train set 5.256x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 68
Epoch 186/200 |loss: 6.919205| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 69
Epoch 187/200 |loss: 6.844831| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 70
Epoch 188/200 |loss: 6.899781| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 71
Epoch 189/200 |loss: 6.857648| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 72
Epoch 190/200 |loss: 6.855389| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 73
Epoch 191/200 |loss: 6.867414| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 74
Epoch 192/200 |loss: 6.814438| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 75
Epoch 193/200 |loss: 6.852623| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 76
Epoch 194/200 |loss: 6.818179| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 77
Epoch 195/200 |loss: 6.813552| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 78
Epoch 196/200 |loss: 6.836544| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 79
Epoch 197/200 |loss: 6.798774| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 80
Epoch 198/200 |loss: 6.829576| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 81
Epoch 199/200 |loss: 6.898240| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 82
Training per epoch cost 0.202 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 38, train speedup 5.264, test speedup 5.499, val speedup 5.539
best test speedup epoch: 32, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 118, train speedup 5.179, test speedup 5.500, val speedup 5.679
last model at epoch 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
execution cost 0:02:08.679713
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.089465, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449986| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442953| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563332| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087486| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613012| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114962| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642015| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135260| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.630003| train set 4.218x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115280| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589657| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067188| train set 4.388x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.605207| train set 4.400x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.135443| train set 4.401x speedup, test set 4.465x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.671431| train set 4.548x speedup, test set 4.490x speedup, val set 4.675x speedup, step: 19
Epoch 19/200 |loss: 15.270933| train set 4.464x speedup, test set 4.693x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.021622| train set 4.600x speedup, test set 4.604x speedup, val set 4.863x speedup, step: 21
Epoch 21/200 |loss: 14.705939| train set 4.825x speedup, test set 5.051x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.115808| train set 5.030x speedup, test set 5.186x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 13.800064| train set 4.993x speedup, test set 5.128x speedup, val set 5.215x speedup, step: 24
Epoch 24/200 |loss: 13.560281| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 25
Epoch 25/200 |loss: 13.168663| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.675073| train set 5.058x speedup, test set 5.189x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.562733| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.268287| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.737881| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.650640| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.208045| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 32
Epoch 32/200 |loss: 11.162845| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 11.488031| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 34
Epoch 34/200 |loss: 11.063526| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 35
Epoch 35/200 |loss: 11.211872| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 36
Epoch 36/200 |loss: 11.497148| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.519106| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 38
Epoch 38/200 |loss: 10.743553| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 39
Epoch 39/200 |loss: 10.351202| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 10.343362| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 41
Epoch 41/200 |loss: 9.812572| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 10.109998| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 9.630949| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.817792| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 45
Epoch 45/200 |loss: 9.328261| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.216645| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.300836| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 9.019658| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 8.956750| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 8.688426| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.809812| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.569662| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.672099| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.458473| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.393044| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.349352| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.294428| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 58
Epoch 58/200 |loss: 8.286671| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.388144| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 60
Epoch 60/200 |loss: 8.210505| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 8.056593| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 7.983993| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 63
Epoch 63/200 |loss: 7.981162| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 64
Epoch 64/200 |loss: 8.206985| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 65
Epoch 65/200 |loss: 8.121843| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 7.858850| train set 5.267x speedup, test set 5.499x speedup, val set 5.637x speedup, step: 67
Epoch 67/200 |loss: 7.752992| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 7.918014| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 69
Epoch 69/200 |loss: 7.997561| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 8.015401| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 71
Epoch 71/200 |loss: 7.980539| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 8.003943| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 73
Epoch 73/200 |loss: 8.163414| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 9.086463| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 75
Epoch 75/200 |loss: 8.404384| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 8.308197| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 77
Epoch 77/200 |loss: 8.139974| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 8.183867| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.881722| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 8.013320| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 81
Epoch 81/200 |loss: 7.678210| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.896406| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.880683| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 7.746236| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 7.597285| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.523146| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 87
Epoch 87/200 |loss: 7.529365| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 88
Epoch 88/200 |loss: 7.463389| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 7.461682| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 90
Epoch 90/200 |loss: 7.390775| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.369892| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 92
Epoch 92/200 |loss: 7.359804| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 93
Epoch 93/200 |loss: 7.347559| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 94
Epoch 94/200 |loss: 7.357264| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 95
Epoch 95/200 |loss: 7.331322| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.320858| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 7.199954| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.211134| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 99
Epoch 99/200 |loss: 7.234782| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.322932| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 101
Epoch 101/200 |loss: 7.472091| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.265835| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 103/200 |loss: 7.240608| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.509809| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 105/200 |loss: 8.140752| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 106/200 |loss: 7.383062| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 7.325236| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.807477| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.475704| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 110/200 |loss: 7.454208| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.637475| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.130481| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 113/200 |loss: 7.541581| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.299904| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 115/200 |loss: 7.245903| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 116/200 |loss: 7.390877| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 117/200 |loss: 7.176666| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.284493| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 119/200 |loss: 7.271120| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 120/200 |loss: 7.162833| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 121/200 |loss: 7.144678| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 122/200 |loss: 7.087840| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 123/200 |loss: 7.134209| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 124/200 |loss: 7.240519| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 125/200 |loss: 7.244749| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 126/200 |loss: 7.498240| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.053331| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 128/200 |loss: 7.266076| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 129/200 |loss: 7.692025| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 130/200 |loss: 7.155210| train set 5.263x speedup, test set 5.568x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.779251| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 132/200 |loss: 7.742882| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 133/200 |loss: 7.657197| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 7.437578| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 135/200 |loss: 7.568026| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 7.255587| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 137/200 |loss: 7.507395| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 138/200 |loss: 7.239560| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 139/200 |loss: 7.303605| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 140/200 |loss: 7.155244| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 7.260661| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 142/200 |loss: 7.110075| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 143/200 |loss: 7.147305| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 144/200 |loss: 7.096270| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 145/200 |loss: 7.121306| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 146/200 |loss: 7.035858| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 147/200 |loss: 7.090501| train set 5.256x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 148/200 |loss: 7.048913| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 7.012335| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 150/200 |loss: 7.012031| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 7.044137| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 152/200 |loss: 6.973814| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 153/200 |loss: 6.969977| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 154/200 |loss: 6.991948| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 155/200 |loss: 6.975196| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 156/200 |loss: 6.967072| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 157/200 |loss: 6.931041| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 158/200 |loss: 6.924466| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 159/200 |loss: 6.961408| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 160/200 |loss: 6.941590| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 6.896855| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 162/200 |loss: 6.894359| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 163/200 |loss: 6.916107| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 164/200 |loss: 6.913456| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 165/200 |loss: 6.878486| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 166/200 |loss: 6.896046| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 167/200 |loss: 6.900546| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 168/200 |loss: 6.896318| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 169/200 |loss: 6.877523| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 170/200 |loss: 6.931091| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 171/200 |loss: 6.996360| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 172/200 |loss: 7.215720| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 173/200 |loss: 7.006822| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 174/200 |loss: 7.060268| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 175/200 |loss: 6.980499| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 176/200 |loss: 6.945478| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 7.129476| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 178/200 |loss: 6.949822| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 179/200 |loss: 6.875459| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 180/200 |loss: 7.027511| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 181/200 |loss: 6.982485| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 182/200 |loss: 6.931080| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 183/200 |loss: 6.902639| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 184/200 |loss: 6.916785| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 185/200 |loss: 7.035031| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 186/200 |loss: 6.916131| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 187/200 |loss: 6.939977| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 188/200 |loss: 6.852841| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 189/200 |loss: 6.925354| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 190/200 |loss: 7.038640| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 191/200 |loss: 6.950473| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 192/200 |loss: 6.960766| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 193/200 |loss: 6.896017| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 194/200 |loss: 6.961337| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 195/200 |loss: 7.182932| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 196/200 |loss: 6.972498| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 197/200 |loss: 6.941812| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 198/200 |loss: 7.178023| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 199/200 |loss: 6.932595| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Training per epoch cost 0.206 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 66, train speedup 5.267, test speedup 5.499, val speedup 5.637
best test speedup epoch: 130, train speedup 5.263, test speedup 5.568, val speedup 5.638
best validation speedup epoch: 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
execution cost 0:02:10.791085
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.128937, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449986| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442951| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563330| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087484| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642014| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135260| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629999| train set 4.218x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115280| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589657| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067184| train set 4.388x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.605204| train set 4.400x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.135439| train set 4.401x speedup, test set 4.465x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.671395| train set 4.548x speedup, test set 4.490x speedup, val set 4.675x speedup, step: 19
Epoch 19/200 |loss: 15.269638| train set 4.464x speedup, test set 4.693x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.017657| train set 4.600x speedup, test set 4.604x speedup, val set 4.863x speedup, step: 21
Epoch 21/200 |loss: 14.698841| train set 4.825x speedup, test set 5.051x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.127333| train set 5.034x speedup, test set 5.186x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 13.812066| train set 4.993x speedup, test set 5.128x speedup, val set 5.215x speedup, step: 24
Epoch 24/200 |loss: 13.535515| train set 5.058x speedup, test set 5.189x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.196495| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.695208| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 27
Epoch 27/200 |loss: 12.550207| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.262465| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.811739| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.626128| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.343783| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 32
Epoch 32/200 |loss: 11.323046| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 10.911800| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 34
Epoch 34/200 |loss: 10.679249| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 35
Epoch 35/200 |loss: 10.519186| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 36
Epoch 36/200 |loss: 10.150816| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 37
Epoch 37/200 |loss: 10.282920| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.285688| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 39
Epoch 39/200 |loss: 10.196131| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 9.942639| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 10.397502| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 42
Epoch 42/200 |loss: 10.355967| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 9.679894| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.848299| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.762259| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.281314| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.610220| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 48
Epoch 48/200 |loss: 9.001857| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 9.141741| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 8.793386| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 51
Epoch 51/200 |loss: 8.848006| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.757582| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.533179| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 54
Epoch 54/200 |loss: 8.534452| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.462616| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.188387| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.323502| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 58
Epoch 58/200 |loss: 8.177639| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.095920| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 7.966996| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 8.028512| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 7.914332| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 63
Epoch 63/200 |loss: 7.896298| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 64
Epoch 64/200 |loss: 7.821508| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 65
Epoch 65/200 |loss: 8.063532| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 66
Epoch 66/200 |loss: 8.801112| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 8.248589| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 8.279950| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 69
Epoch 69/200 |loss: 7.980531| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 70
Epoch 70/200 |loss: 8.374795| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 71
Epoch 71/200 |loss: 7.987154| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 72
Epoch 72/200 |loss: 7.995894| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 73
Epoch 73/200 |loss: 8.047087| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 7.853180| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.831869| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.684227| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 77
Epoch 77/200 |loss: 7.807318| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.511328| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 79
Epoch 79/200 |loss: 7.617550| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 80
Epoch 80/200 |loss: 7.684285| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 81
Epoch 81/200 |loss: 7.605419| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.600029| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 83
Epoch 83/200 |loss: 8.190577| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 84
Epoch 84/200 |loss: 7.732089| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 7.394640| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 86
Epoch 86/200 |loss: 7.798293| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.774669| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 88
Epoch 88/200 |loss: 7.475334| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 89
Epoch 89/200 |loss: 7.394120| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 90
Epoch 90/200 |loss: 7.605978| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.537043| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.423058| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 93
Epoch 93/200 |loss: 7.372139| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 94
Epoch 94/200 |loss: 7.573972| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.382897| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 96
Epoch 96/200 |loss: 7.358178| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 97
Epoch 97/200 |loss: 7.307361| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.299256| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 99
Epoch 99/200 |loss: 7.363765| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.457823| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.213959| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 102/200 |loss: 7.185363| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 103/200 |loss: 7.390248| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 104/200 |loss: 7.407848| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.299117| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 106/200 |loss: 7.314498| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 107/200 |loss: 7.240435| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 108/200 |loss: 7.198071| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 109/200 |loss: 7.227203| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 110/200 |loss: 7.270584| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.326433| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.084575| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 113/200 |loss: 7.158460| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 114/200 |loss: 7.339112| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 115/200 |loss: 7.122988| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 116/200 |loss: 7.114079| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 117/200 |loss: 7.209955| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.027524| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 119/200 |loss: 7.062661| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 120/200 |loss: 7.158974| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 121/200 |loss: 7.107469| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 122/200 |loss: 7.120774| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 123/200 |loss: 7.387970| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 124/200 |loss: 7.145091| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 125/200 |loss: 6.993815| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 126/200 |loss: 7.004258| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.068231| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 128/200 |loss: 7.163219| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.026052| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 130/200 |loss: 6.999731| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 131/200 |loss: 7.014301| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.041530| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 133/200 |loss: 7.075256| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 6.988622| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 135/200 |loss: 6.990678| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 6.957991| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 137/200 |loss: 6.942033| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 138/200 |loss: 7.024724| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 7.003136| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 140/200 |loss: 7.083436| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 6.945356| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 142/200 |loss: 6.956371| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 143/200 |loss: 7.125394| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 144/200 |loss: 7.079154| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 145/200 |loss: 7.007382| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 146/200 |loss: 6.941709| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 147/200 |loss: 7.021862| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 148/200 |loss: 7.078790| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 6.891319| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 150/200 |loss: 6.933044| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 151/200 |loss: 7.009989| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 152/200 |loss: 6.976472| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 153/200 |loss: 6.907318| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 154/200 |loss: 6.911204| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 155/200 |loss: 6.953096| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 156/200 |loss: 7.081292| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 157/200 |loss: 6.946105| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 158/200 |loss: 7.117426| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 159/200 |loss: 7.278208| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 160/200 |loss: 7.397620| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 7.172115| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 7.293956| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 163/200 |loss: 7.059043| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 164/200 |loss: 7.045782| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 165/200 |loss: 7.035892| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 166/200 |loss: 6.988064| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 167/200 |loss: 7.064365| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 168/200 |loss: 6.987995| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 169/200 |loss: 6.950609| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 170/200 |loss: 6.938406| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 171/200 |loss: 6.980270| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 172/200 |loss: 6.974598| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 173/200 |loss: 6.930546| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 174/200 |loss: 6.901722| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 175/200 |loss: 6.876165| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 176/200 |loss: 6.894150| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 6.953682| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 178/200 |loss: 6.981118| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 179/200 |loss: 7.022012| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 7.041717| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 181/200 |loss: 7.540084| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 182/200 |loss: 7.235394| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 183/200 |loss: 7.021097| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 184/200 |loss: 6.978208| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 185/200 |loss: 6.923105| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 186/200 |loss: 7.000734| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.957836| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 188/200 |loss: 6.927239| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 189/200 |loss: 6.924644| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 190/200 |loss: 6.960576| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 191/200 |loss: 7.011804| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 192/200 |loss: 7.024468| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 193/200 |loss: 6.880884| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 194/200 |loss: 6.821887| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 195/200 |loss: 6.814906| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 196/200 |loss: 6.831055| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 197/200 |loss: 6.976787| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 7.002972| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 199/200 |loss: 7.389617| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Training per epoch cost 0.204 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 110, train speedup 5.267, test speedup 5.498, val speedup 5.638
best test speedup epoch: 34, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
execution cost 0:02:10.815842
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.142094, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449986| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963154| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563328| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087482| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642014| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135256| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629999| train set 4.218x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115276| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589628| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067345| train set 4.319x speedup, test set 4.397x speedup, val set 4.515x speedup, step: 16
Epoch 16/200 |loss: 16.607138| train set 4.400x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.138931| train set 4.401x speedup, test set 4.465x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.685968| train set 4.696x speedup, test set 4.665x speedup, val set 4.826x speedup, step: 19
Epoch 19/200 |loss: 15.307290| train set 4.464x speedup, test set 4.693x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.014232| train set 4.682x speedup, test set 4.863x speedup, val set 4.928x speedup, step: 21
Epoch 21/200 |loss: 14.644617| train set 4.766x speedup, test set 4.992x speedup, val set 5.016x speedup, step: 22
Epoch 22/200 |loss: 14.151777| train set 4.844x speedup, test set 5.068x speedup, val set 5.097x speedup, step: 23
Epoch 23/200 |loss: 13.784954| train set 4.825x speedup, test set 5.029x speedup, val set 5.078x speedup, step: 24
Epoch 24/200 |loss: 13.523363| train set 5.014x speedup, test set 5.146x speedup, val set 5.236x speedup, step: 25
Epoch 25/200 |loss: 13.255467| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 26
Epoch 26/200 |loss: 12.808027| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 27
Epoch 27/200 |loss: 12.469885| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.224789| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.075180| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 30
Epoch 30/200 |loss: 11.733477| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 31
Epoch 31/200 |loss: 11.227215| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.064085| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 33
Epoch 33/200 |loss: 11.219976| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 11.282475| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 35
Epoch 35/200 |loss: 10.711933| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 36
Epoch 36/200 |loss: 11.521344| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.741834| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.695300| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 10.523434| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 10.190471| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 41
Epoch 41/200 |loss: 10.269818| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 42
Epoch 42/200 |loss: 9.580880| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 43
Epoch 43/200 |loss: 9.947797| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.316183| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 45
Epoch 45/200 |loss: 9.476871| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 46
Epoch 46/200 |loss: 9.083949| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.185151| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 48
Epoch 48/200 |loss: 8.951096| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 49
Epoch 49/200 |loss: 9.238406| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 50
Epoch 50/200 |loss: 9.924268| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 51
Epoch 51/200 |loss: 8.952770| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 9.057012| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 9.072596| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 54
Epoch 54/200 |loss: 8.786441| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.587061| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.546513| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 57
Epoch 57/200 |loss: 8.321760| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 58
Epoch 58/200 |loss: 8.417693| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.268714| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 60
Epoch 60/200 |loss: 8.296779| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 61
Epoch 61/200 |loss: 8.097994| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.150825| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 63
Epoch 63/200 |loss: 8.050435| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 64
Epoch 64/200 |loss: 7.960177| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 8.037273| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 7.957850| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 7.812199| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 7.788750| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 7.831005| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 70
Epoch 70/200 |loss: 8.002907| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 71
Epoch 71/200 |loss: 7.739142| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 7.833622| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 7.828170| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 7.737456| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.657411| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 76
Epoch 76/200 |loss: 7.591775| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 77
Epoch 77/200 |loss: 7.748978| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 78
Epoch 78/200 |loss: 7.577687| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.594215| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 80
Epoch 80/200 |loss: 7.563303| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.525892| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.518655| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 83
Epoch 83/200 |loss: 7.491911| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 84
Epoch 84/200 |loss: 7.412413| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 7.525232| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.535223| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 87
Epoch 87/200 |loss: 8.148586| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.969375| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 89
Epoch 89/200 |loss: 7.930765| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 8.328563| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 8.259126| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 8.172494| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 8.215907| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 7.874441| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 95
Epoch 95/200 |loss: 8.061162| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.754565| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 7.760978| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.544585| train set 5.003x speedup, test set 5.392x speedup, val set 5.361x speedup, step: 99
Epoch 99/200 |loss: 7.721748| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 100
Epoch 100/200 |loss: 7.412457| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 1
Epoch 101/200 |loss: 7.432048| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 1
Epoch 102/200 |loss: 7.389844| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.346668| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 104/200 |loss: 7.349411| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.265691| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 106/200 |loss: 7.205108| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 107/200 |loss: 7.208758| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 108/200 |loss: 7.183721| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 109/200 |loss: 7.195907| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 110/200 |loss: 7.229478| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 111/200 |loss: 7.453158| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.276031| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 113/200 |loss: 7.263132| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 114/200 |loss: 7.102244| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 115/200 |loss: 7.066303| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 116/200 |loss: 7.108592| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.167072| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.324707| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 119/200 |loss: 7.132712| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 120/200 |loss: 7.086360| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 121/200 |loss: 7.043368| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 122/200 |loss: 7.060689| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 123/200 |loss: 7.115496| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 124/200 |loss: 7.105213| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 125/200 |loss: 7.180791| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 126/200 |loss: 7.074450| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.048070| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 128/200 |loss: 7.060577| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 129/200 |loss: 7.051373| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 130/200 |loss: 7.101689| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.032331| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 132/200 |loss: 6.996988| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 133/200 |loss: 6.992915| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 6.989573| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 135/200 |loss: 7.047605| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 7.042101| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 137/200 |loss: 7.082836| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 138/200 |loss: 6.939738| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 6.948512| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 140/200 |loss: 7.039674| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 7.034713| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 142/200 |loss: 7.075536| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 143/200 |loss: 6.940453| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 144/200 |loss: 6.932496| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 145/200 |loss: 6.962450| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 6.945542| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 147/200 |loss: 6.940263| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 148/200 |loss: 6.901875| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 6.888026| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 150/200 |loss: 6.885379| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 151/200 |loss: 6.988539| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 152/200 |loss: 7.019170| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 7.133681| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 154/200 |loss: 6.964229| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 155/200 |loss: 6.855816| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 156/200 |loss: 6.856755| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 157/200 |loss: 6.911800| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 158/200 |loss: 6.981157| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 159/200 |loss: 7.011371| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 160/200 |loss: 7.000406| train set 5.252x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 6.901154| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 162/200 |loss: 6.879619| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 163/200 |loss: 6.947588| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 164/200 |loss: 7.335302| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 165/200 |loss: 7.297628| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 166/200 |loss: 7.660289| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 6.984745| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 168/200 |loss: 7.598572| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 169/200 |loss: 8.178098| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 170/200 |loss: 7.359196| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 171/200 |loss: 7.938724| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 172/200 |loss: 7.452672| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 173/200 |loss: 7.462231| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 174/200 |loss: 7.395197| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 175/200 |loss: 7.377433| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 176/200 |loss: 7.283563| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 7.385466| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 178/200 |loss: 7.282498| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 179/200 |loss: 7.174798| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 7.286899| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 181/200 |loss: 7.161541| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 182/200 |loss: 7.135227| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 183/200 |loss: 7.127882| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 184/200 |loss: 7.152171| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 185/200 |loss: 7.024682| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 186/200 |loss: 7.092299| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 187/200 |loss: 7.092248| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 188/200 |loss: 6.973943| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 189/200 |loss: 7.041778| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 190/200 |loss: 7.025199| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 191/200 |loss: 6.928628| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 192/200 |loss: 6.972674| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 193/200 |loss: 6.969666| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 194/200 |loss: 6.908099| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 195/200 |loss: 6.916321| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 196/200 |loss: 6.979180| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 197/200 |loss: 6.877397| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 6.892587| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 199/200 |loss: 6.933291| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Training per epoch cost 0.198 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 36, train speedup 5.264, test speedup 5.499, val speedup 5.539
best test speedup epoch: 32, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
execution cost 0:02:09.186090
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.124047, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039595| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442951| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563332| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087484| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642014| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135260| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.630001| train set 4.218x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115280| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589659| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067184| train set 4.388x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.605207| train set 4.400x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.135443| train set 4.401x speedup, test set 4.465x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.671431| train set 4.548x speedup, test set 4.490x speedup, val set 4.675x speedup, step: 19
Epoch 19/200 |loss: 15.270952| train set 4.464x speedup, test set 4.693x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.021662| train set 4.600x speedup, test set 4.604x speedup, val set 4.863x speedup, step: 21
Epoch 21/200 |loss: 14.706023| train set 4.825x speedup, test set 5.051x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.118238| train set 5.034x speedup, test set 5.186x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 13.794982| train set 4.551x speedup, test set 4.840x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.565227| train set 5.058x speedup, test set 5.189x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.184241| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.658120| train set 5.058x speedup, test set 5.189x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.610847| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.290581| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.790911| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.683342| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.240640| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.367552| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 11.213926| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.856073| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 35
Epoch 35/200 |loss: 10.702813| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 36
Epoch 36/200 |loss: 10.806508| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 37
Epoch 37/200 |loss: 10.735226| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.425644| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 10.559192| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 10.123168| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 10.001594| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 42
Epoch 42/200 |loss: 9.996930| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 43
Epoch 43/200 |loss: 9.528028| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.575621| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.306177| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.220557| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 8.994420| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 8.977190| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 8.649551| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 8.808129| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 51
Epoch 51/200 |loss: 8.668166| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.790131| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 53
Epoch 53/200 |loss: 8.705235| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 9.287998| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.725554| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 56
Epoch 56/200 |loss: 8.579074| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 57
Epoch 57/200 |loss: 8.981049| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 58
Epoch 58/200 |loss: 8.571887| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 59
Epoch 59/200 |loss: 8.417523| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.876340| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 8.296548| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 62
Epoch 62/200 |loss: 8.563071| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 63
Epoch 63/200 |loss: 8.167197| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 64
Epoch 64/200 |loss: 8.191239| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 65
Epoch 65/200 |loss: 8.008636| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 8.118377| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 7.853477| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 8.036260| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 7.698016| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 7.857042| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 71
Epoch 71/200 |loss: 7.670306| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 7.669960| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 7.620834| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 7.544254| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 75
Epoch 75/200 |loss: 7.647219| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.464789| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 7.573035| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.433964| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 79
Epoch 79/200 |loss: 7.575311| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 7.773459| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 81
Epoch 81/200 |loss: 8.449504| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.884997| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 83
Epoch 83/200 |loss: 7.475844| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 7.564682| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 7.524711| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 86
Epoch 86/200 |loss: 7.361075| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.400365| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.433579| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 7.344434| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.223363| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.314806| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.289028| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 7.271045| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 7.295085| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.336211| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 96
Epoch 96/200 |loss: 7.748116| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 97
Epoch 97/200 |loss: 8.590219| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.601555| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 8.373372| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 100
Epoch 100/200 |loss: 7.917651| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 1
Epoch 101/200 |loss: 7.909698| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.995979| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 103/200 |loss: 7.702055| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.641695| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.728014| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 106/200 |loss: 7.650541| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 107/200 |loss: 7.393495| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.635497| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 109/200 |loss: 7.361000| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 110/200 |loss: 7.498259| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.298498| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.386090| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 113/200 |loss: 7.236768| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 114/200 |loss: 7.338696| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 115/200 |loss: 7.169562| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.228750| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.165034| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 118/200 |loss: 7.218182| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 119/200 |loss: 7.110521| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 120/200 |loss: 7.107926| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 121/200 |loss: 7.093447| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 122/200 |loss: 7.090156| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 123/200 |loss: 7.146044| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 124/200 |loss: 7.067406| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 125/200 |loss: 7.073424| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 126/200 |loss: 7.020123| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.017012| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 128/200 |loss: 7.027530| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.035461| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 130/200 |loss: 7.099116| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.046778| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 132/200 |loss: 7.024652| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 133/200 |loss: 6.978341| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 134/200 |loss: 6.981278| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 135/200 |loss: 6.980408| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 7.020772| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 137/200 |loss: 7.125097| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 138/200 |loss: 7.070553| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 139/200 |loss: 7.061887| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 140/200 |loss: 6.936960| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 141/200 |loss: 6.923540| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 142/200 |loss: 6.979576| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 143/200 |loss: 7.074458| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 144/200 |loss: 7.178834| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 145/200 |loss: 7.087664| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 6.979726| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 147/200 |loss: 7.044793| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 148/200 |loss: 7.070101| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 7.199950| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 150/200 |loss: 6.927430| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 7.035924| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 152/200 |loss: 7.362221| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 153/200 |loss: 6.953312| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 154/200 |loss: 7.124091| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 155/200 |loss: 7.398411| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 156/200 |loss: 7.098355| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 157/200 |loss: 7.246716| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 158/200 |loss: 7.309253| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 159/200 |loss: 7.071087| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 160/200 |loss: 7.239727| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 161/200 |loss: 7.151402| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 162/200 |loss: 7.012971| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 163/200 |loss: 7.180692| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 164/200 |loss: 7.154068| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 165/200 |loss: 7.074306| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 166/200 |loss: 7.171327| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 167/200 |loss: 7.236964| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 168/200 |loss: 7.113719| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 169/200 |loss: 7.152280| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 170/200 |loss: 7.148298| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 171/200 |loss: 7.085340| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 172/200 |loss: 7.058430| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 173/200 |loss: 7.032670| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6
Epoch 174/200 |loss: 6.960927| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 175/200 |loss: 7.044017| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 176/200 |loss: 6.957433| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 177/200 |loss: 6.962265| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 178/200 |loss: 6.960538| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 179/200 |loss: 7.012649| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 6.886940| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 181/200 |loss: 6.976289| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 182/200 |loss: 6.991892| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 183/200 |loss: 6.902688| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 184/200 |loss: 6.971406| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 185/200 |loss: 6.989232| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 186/200 |loss: 6.859914| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.993901| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 188/200 |loss: 6.979833| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 189/200 |loss: 6.892304| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 190/200 |loss: 6.977963| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 191/200 |loss: 6.906883| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 192/200 |loss: 6.855661| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 193/200 |loss: 6.926548| train set 5.263x speedup, test set 5.498x speedup, val set 5.570x speedup, step: 2
Epoch 194/200 |loss: 6.864429| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 195/200 |loss: 6.843137| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 196/200 |loss: 6.893789| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 197/200 |loss: 6.864044| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 6.892042| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 199/200 |loss: 7.040047| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Training per epoch cost 0.202 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 148, train speedup 5.267, test speedup 5.498, val speedup 5.638
best test speedup epoch: 34, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 198, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 199, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:02:08.191807
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.112333, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449986| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563330| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087484| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642014| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135260| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629999| train set 4.218x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115280| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589657| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067184| train set 4.388x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.605206| train set 4.400x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.135439| train set 4.401x speedup, test set 4.465x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.671427| train set 4.548x speedup, test set 4.490x speedup, val set 4.675x speedup, step: 19
Epoch 19/200 |loss: 15.270968| train set 4.464x speedup, test set 4.693x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.022665| train set 4.600x speedup, test set 4.604x speedup, val set 4.863x speedup, step: 21
Epoch 21/200 |loss: 14.705810| train set 4.825x speedup, test set 5.051x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.112837| train set 5.030x speedup, test set 5.186x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 13.801036| train set 4.993x speedup, test set 5.128x speedup, val set 5.215x speedup, step: 24
Epoch 24/200 |loss: 13.584549| train set 5.058x speedup, test set 5.189x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.194933| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.681552| train set 4.622x speedup, test set 4.909x speedup, val set 4.855x speedup, step: 27
Epoch 27/200 |loss: 12.637091| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.277997| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.776279| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 30
Epoch 30/200 |loss: 11.700507| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.404767| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 32
Epoch 32/200 |loss: 11.263729| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 10.947372| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.641091| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 35
Epoch 35/200 |loss: 10.650110| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 36
Epoch 36/200 |loss: 10.438812| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 37
Epoch 37/200 |loss: 10.876777| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.864477| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 10.641103| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 10.184608| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 10.076396| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.751408| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 9.690126| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 44
Epoch 44/200 |loss: 9.533918| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.237024| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 46
Epoch 46/200 |loss: 9.261109| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.000219| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 48
Epoch 48/200 |loss: 9.008047| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 8.953580| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 50
Epoch 50/200 |loss: 8.918498| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.841472| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.605176| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.456415| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.375142| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 55
Epoch 55/200 |loss: 8.442772| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.525917| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 57
Epoch 57/200 |loss: 8.499187| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 58
Epoch 58/200 |loss: 8.602630| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.016953| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 60
Epoch 60/200 |loss: 8.364471| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 8.607471| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.100156| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 63
Epoch 63/200 |loss: 8.461011| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 64
Epoch 64/200 |loss: 7.973093| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 65
Epoch 65/200 |loss: 8.122143| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 7.893247| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 67
Epoch 67/200 |loss: 7.958410| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 68
Epoch 68/200 |loss: 7.869782| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 7.836195| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 7.894855| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 8.045502| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 8.194034| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 73
Epoch 73/200 |loss: 8.074073| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 7.952600| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.703590| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.887843| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 8.138664| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.671808| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 79
Epoch 79/200 |loss: 7.830804| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 7.733628| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.685692| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 82
Epoch 82/200 |loss: 7.584505| train set 5.054x speedup, test set 5.424x speedup, val set 5.454x speedup, step: 83
Epoch 83/200 |loss: 7.898708| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 7.679530| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 7.639334| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 86
Epoch 86/200 |loss: 7.678054| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.555858| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 88
Epoch 88/200 |loss: 7.503180| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 7.387063| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.410527| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 91
Epoch 91/200 |loss: 7.262569| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.321794| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 7.365213| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 7.424073| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.809546| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 96
Epoch 96/200 |loss: 7.593012| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 97
Epoch 97/200 |loss: 7.486484| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.227543| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.454320| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 100
Epoch 100/200 |loss: 7.669216| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 1
Epoch 101/200 |loss: 7.289884| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.538294| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 103/200 |loss: 7.652025| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.602810| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.373573| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 106/200 |loss: 7.610188| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 7.352701| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.442102| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 109/200 |loss: 7.473919| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 110/200 |loss: 7.200099| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.424852| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 112/200 |loss: 7.337140| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 113/200 |loss: 7.318664| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.198120| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 115/200 |loss: 7.380787| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 116/200 |loss: 7.146515| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 117/200 |loss: 7.262147| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 118/200 |loss: 7.263627| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 119/200 |loss: 7.196012| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 120/200 |loss: 7.095477| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 121/200 |loss: 7.233768| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 122/200 |loss: 7.062283| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 123/200 |loss: 7.106630| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 124/200 |loss: 7.074755| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 125/200 |loss: 7.105932| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 126/200 |loss: 7.034718| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.067908| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 128/200 |loss: 7.000271| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 129/200 |loss: 7.026641| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 130/200 |loss: 7.052106| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 131/200 |loss: 7.081876| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.035430| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 133/200 |loss: 6.958751| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 6.972218| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 135/200 |loss: 6.968139| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 136/200 |loss: 6.985639| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 137/200 |loss: 6.961674| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 138/200 |loss: 6.915303| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 6.909538| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 140/200 |loss: 6.897403| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 6.924401| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 142/200 |loss: 6.936695| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 143/200 |loss: 6.949007| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 144/200 |loss: 7.017089| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 145/200 |loss: 7.116259| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 146/200 |loss: 7.696127| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 147/200 |loss: 7.067652| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 148/200 |loss: 7.073008| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 149/200 |loss: 7.568572| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 150/200 |loss: 7.014692| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 7.350416| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 152/200 |loss: 7.803261| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 7.223519| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 154/200 |loss: 7.745980| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 155/200 |loss: 7.260263| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 156/200 |loss: 7.403252| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 157/200 |loss: 7.256219| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 158/200 |loss: 7.242427| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 159/200 |loss: 7.115591| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 160/200 |loss: 7.205617| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 7.054334| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 7.138478| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 163/200 |loss: 7.029415| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 164/200 |loss: 7.053142| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 165/200 |loss: 7.025380| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 166/200 |loss: 6.980117| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 7.009059| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 168/200 |loss: 6.964097| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 169/200 |loss: 6.943842| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 170/200 |loss: 6.995082| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 171/200 |loss: 6.992622| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 172/200 |loss: 6.953623| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 173/200 |loss: 6.953100| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 174/200 |loss: 6.961662| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 175/200 |loss: 6.942612| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 176/200 |loss: 6.912346| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 177/200 |loss: 6.900073| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 178/200 |loss: 6.896649| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 179/200 |loss: 6.922412| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 6.868535| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 181/200 |loss: 6.865228| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 182/200 |loss: 6.839358| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 183/200 |loss: 6.848510| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 184/200 |loss: 6.840578| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 185/200 |loss: 6.848205| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 186/200 |loss: 6.836577| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.852327| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 188/200 |loss: 6.873467| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 189/200 |loss: 6.877611| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 190/200 |loss: 6.977600| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 191/200 |loss: 6.911006| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 192/200 |loss: 6.903562| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 193/200 |loss: 6.870225| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 194/200 |loss: 7.098022| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 195/200 |loss: 7.153901| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 196/200 |loss: 7.236139| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 197/200 |loss: 7.075564| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 7.099946| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 199/200 |loss: 6.984529| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Training per epoch cost 0.203 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 37, train speedup 5.264, test speedup 5.499, val speedup 5.539
best test speedup epoch: 34, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 198, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 199, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:02:08.238799
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.097057, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963154| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563330| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087482| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642014| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135258| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629999| train set 4.218x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115276| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589628| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067343| train set 4.319x speedup, test set 4.397x speedup, val set 4.515x speedup, step: 16
Epoch 16/200 |loss: 16.607136| train set 4.400x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.138931| train set 4.401x speedup, test set 4.465x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.685968| train set 4.696x speedup, test set 4.665x speedup, val set 4.826x speedup, step: 19
Epoch 19/200 |loss: 15.307281| train set 4.464x speedup, test set 4.693x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.014215| train set 4.682x speedup, test set 4.863x speedup, val set 4.928x speedup, step: 21
Epoch 21/200 |loss: 14.644540| train set 4.766x speedup, test set 4.992x speedup, val set 5.016x speedup, step: 22
Epoch 22/200 |loss: 14.151722| train set 4.844x speedup, test set 5.068x speedup, val set 5.097x speedup, step: 23
Epoch 23/200 |loss: 13.781915| train set 5.014x speedup, test set 5.146x speedup, val set 5.236x speedup, step: 24
Epoch 24/200 |loss: 13.524216| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 25
Epoch 25/200 |loss: 13.246632| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.812395| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 27
Epoch 27/200 |loss: 12.462418| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.146327| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.979788| train set 5.079x speedup, test set 5.208x speedup, val set 5.303x speedup, step: 30
Epoch 30/200 |loss: 11.729743| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.312161| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.189350| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 33
Epoch 33/200 |loss: 11.636628| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 11.316910| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 35
Epoch 35/200 |loss: 10.590811| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 36
Epoch 36/200 |loss: 10.971889| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 37
Epoch 37/200 |loss: 10.078602| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 38
Epoch 38/200 |loss: 10.365561| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 9.941183| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 9.909788| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 9.588891| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.473025| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 43
Epoch 43/200 |loss: 9.321922| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.548129| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 10.663562| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 46
Epoch 46/200 |loss: 10.641292| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 9.429921| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 10.313250| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 9.093309| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 50
Epoch 50/200 |loss: 9.812821| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 51
Epoch 51/200 |loss: 9.215692| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 52
Epoch 52/200 |loss: 9.103904| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 53
Epoch 53/200 |loss: 9.129770| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 54
Epoch 54/200 |loss: 8.667164| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.953209| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 56
Epoch 56/200 |loss: 8.473162| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 57
Epoch 57/200 |loss: 8.590005| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 58
Epoch 58/200 |loss: 8.510894| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 59
Epoch 59/200 |loss: 8.313426| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 60
Epoch 60/200 |loss: 8.327251| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 61
Epoch 61/200 |loss: 8.162828| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 62
Epoch 62/200 |loss: 8.090364| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 63
Epoch 63/200 |loss: 8.085345| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 64
Epoch 64/200 |loss: 7.936645| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 65
Epoch 65/200 |loss: 7.937357| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 66
Epoch 66/200 |loss: 7.868343| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 7.855217| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 68
Epoch 68/200 |loss: 8.083251| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 69
Epoch 69/200 |loss: 8.988485| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 70
Epoch 70/200 |loss: 8.030867| train set 5.179x speedup, test set 5.500x speedup, val set 5.679x speedup, step: 71
Epoch 71/200 |loss: 8.770225| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 8.568249| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 8.524814| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 8.154865| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 8.509501| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.862992| train set 5.054x speedup, test set 5.424x speedup, val set 5.454x speedup, step: 77
Epoch 77/200 |loss: 8.139050| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.844769| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.892861| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 7.705829| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 81
Epoch 81/200 |loss: 7.751957| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 82
Epoch 82/200 |loss: 7.570679| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.674123| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 7.515053| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 7.556158| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.474962| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 87
Epoch 87/200 |loss: 7.414087| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 88
Epoch 88/200 |loss: 7.417980| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 7.329216| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.316905| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.282964| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.272954| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 93
Epoch 93/200 |loss: 7.225651| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 94
Epoch 94/200 |loss: 7.252828| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 95
Epoch 95/200 |loss: 7.420192| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 8.080688| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 7.768485| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.612116| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.990393| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 8.751870| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 101
Epoch 101/200 |loss: 7.588541| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 102
Epoch 102/200 |loss: 8.836222| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 103
Epoch 103/200 |loss: 7.752506| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.873483| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.732105| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 106/200 |loss: 7.622224| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 7.781958| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.570664| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 109/200 |loss: 7.574849| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 110/200 |loss: 7.428966| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 111/200 |loss: 7.478616| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 112/200 |loss: 7.354276| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 113/200 |loss: 7.305455| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.333785| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 115/200 |loss: 7.195569| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 116/200 |loss: 7.282895| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.150570| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.176296| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 119/200 |loss: 7.138660| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 120/200 |loss: 7.119925| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 121/200 |loss: 7.147115| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 122/200 |loss: 7.094444| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 123/200 |loss: 7.154624| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 124/200 |loss: 7.162841| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 125/200 |loss: 7.180316| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 126/200 |loss: 7.128840| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.079331| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 128/200 |loss: 7.029588| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.009754| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 130/200 |loss: 6.965281| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 131/200 |loss: 6.973189| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 6.976682| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 133/200 |loss: 7.002404| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 7.034265| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 135/200 |loss: 7.175723| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 7.132108| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 137/200 |loss: 7.181432| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 138/200 |loss: 6.977508| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 6.921009| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 140/200 |loss: 6.986522| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 7.015329| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 142/200 |loss: 7.079507| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 143/200 |loss: 6.928401| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 144/200 |loss: 6.904795| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 145/200 |loss: 6.972362| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 6.998443| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 147/200 |loss: 7.049700| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 148/200 |loss: 6.907714| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 6.889794| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 150/200 |loss: 6.975266| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 7.007010| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 152/200 |loss: 7.064417| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 6.896440| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 154/200 |loss: 6.885281| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 155/200 |loss: 7.006083| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 156/200 |loss: 6.994988| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 157/200 |loss: 7.002832| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 158/200 |loss: 6.871511| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 159/200 |loss: 6.917609| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 160/200 |loss: 7.094216| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 6.915464| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 6.864275| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 163/200 |loss: 6.926001| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 164/200 |loss: 6.915820| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 165/200 |loss: 6.952829| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 166/200 |loss: 6.859128| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 6.838725| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 168/200 |loss: 6.862744| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 169/200 |loss: 6.864979| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 170/200 |loss: 6.918005| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 171/200 |loss: 6.887789| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 172/200 |loss: 6.931883| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 173/200 |loss: 6.885730| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 174/200 |loss: 6.884466| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 175/200 |loss: 6.872145| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 176/200 |loss: 6.993276| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 7.095428| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 178/200 |loss: 7.124834| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 179/200 |loss: 6.931564| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 180/200 |loss: 6.832391| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 181/200 |loss: 6.934166| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 182/200 |loss: 7.008545| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 183/200 |loss: 7.230510| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 184/200 |loss: 7.019814| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 185/200 |loss: 6.983061| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 186/200 |loss: 6.992932| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 187/200 |loss: 6.948143| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 188/200 |loss: 6.981326| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 189/200 |loss: 6.928329| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 190/200 |loss: 6.974516| train set 5.263x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 191/200 |loss: 6.924865| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 192/200 |loss: 6.836163| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 193/200 |loss: 6.918548| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 194/200 |loss: 6.879574| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 195/200 |loss: 6.841605| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 196/200 |loss: 6.934649| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 197/200 |loss: 7.166413| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 7.042197| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 199/200 |loss: 7.013982| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Training per epoch cost 0.204 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 38, train speedup 5.264, test speedup 5.499, val speedup 5.539
best test speedup epoch: 32, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 199, train speedup 5.262, test speedup 5.559, val speedup 5.638
execution cost 0:02:10.475614
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:01.110341, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 3.620x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 3.644x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 3.900x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 3.745x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 4.038x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 4.103x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563328| train set 3.650x speedup, test set 4.099x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087484| train set 3.529x speedup, test set 3.754x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 3.983x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 4.205x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642033| train set 3.878x speedup, test set 4.247x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135206| train set 3.943x speedup, test set 4.309x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629988| train set 4.166x speedup, test set 4.309x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.116011| train set 4.054x speedup, test set 4.465x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.593994| train set 4.401x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.063534| train set 4.388x speedup, test set 4.464x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.591366| train set 4.401x speedup, test set 4.465x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.149645| train set 4.463x speedup, test set 4.692x speedup, val set 4.640x speedup, step: 18
Epoch 18/200 |loss: 15.731859| train set 4.613x speedup, test set 4.793x speedup, val set 4.852x speedup, step: 19
Epoch 19/200 |loss: 15.341888| train set 4.447x speedup, test set 4.679x speedup, val set 4.623x speedup, step: 20
Epoch 20/200 |loss: 14.874121| train set 4.640x speedup, test set 4.885x speedup, val set 4.927x speedup, step: 21
Epoch 21/200 |loss: 14.457945| train set 4.825x speedup, test set 5.051x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.067558| train set 4.825x speedup, test set 5.051x speedup, val set 5.077x speedup, step: 23
Epoch 23/200 |loss: 13.723136| train set 4.551x speedup, test set 4.840x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.362545| train set 5.058x speedup, test set 5.188x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.152625| train set 4.885x speedup, test set 5.087x speedup, val set 5.141x speedup, step: 26
Epoch 26/200 |loss: 13.491572| train set 5.058x speedup, test set 5.188x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.590161| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.387950| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.309339| train set 5.079x speedup, test set 5.206x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.702142| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.756851| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.250094| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 10.941212| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.992775| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 35
Epoch 35/200 |loss: 10.414699| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 36
Epoch 36/200 |loss: 10.530657| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.270638| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 9.904391| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 10.021845| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 10.194905| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 41
Epoch 41/200 |loss: 9.910329| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.497679| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 9.478689| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.561641| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.506065| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.072359| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.216807| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 8.841998| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 49
Epoch 49/200 |loss: 8.929434| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 50
Epoch 50/200 |loss: 8.679477| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.614936| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.505800| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.390343| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.485379| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 55
Epoch 55/200 |loss: 8.315296| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.626775| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 57
Epoch 57/200 |loss: 8.440332| train set 5.056x speedup, test set 5.366x speedup, val set 5.362x speedup, step: 58
Epoch 58/200 |loss: 8.512526| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.215227| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.083259| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 8.160430| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 62
Epoch 62/200 |loss: 8.287161| train set 5.056x speedup, test set 5.366x speedup, val set 5.362x speedup, step: 63
Epoch 63/200 |loss: 8.377593| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 64
Epoch 64/200 |loss: 8.132412| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 7.877784| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 66
Epoch 66/200 |loss: 7.878397| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 67
Epoch 67/200 |loss: 7.941249| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 7.961357| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 7.837442| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 7.957535| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 71
Epoch 71/200 |loss: 8.276202| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 7.879456| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 7.839980| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 7.771789| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 75
Epoch 75/200 |loss: 7.714314| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 76
Epoch 76/200 |loss: 7.695619| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 77
Epoch 77/200 |loss: 7.504800| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 78
Epoch 78/200 |loss: 7.787643| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 8.105984| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 80
Epoch 80/200 |loss: 9.016772| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.943819| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 8.914568| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 83
Epoch 83/200 |loss: 8.491427| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 8.078399| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 8.480267| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 86
Epoch 86/200 |loss: 7.903284| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 87
Epoch 87/200 |loss: 7.937289| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.888844| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 89
Epoch 89/200 |loss: 7.812014| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.754356| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 91
Epoch 91/200 |loss: 7.662070| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 92
Epoch 92/200 |loss: 7.647331| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 7.532491| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 94
Epoch 94/200 |loss: 7.525046| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 95
Epoch 95/200 |loss: 7.418084| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 96
Epoch 96/200 |loss: 7.437314| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 97
Epoch 97/200 |loss: 7.332340| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.405465| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 99
Epoch 99/200 |loss: 7.274307| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.295795| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 101
Epoch 101/200 |loss: 7.240666| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 102
Epoch 102/200 |loss: 7.210507| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.198578| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.157429| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.184124| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 106/200 |loss: 7.216008| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 7.387402| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 108/200 |loss: 7.974636| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.639081| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 110/200 |loss: 7.412850| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 111/200 |loss: 7.262695| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.393486| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 113/200 |loss: 7.488948| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.161153| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 115/200 |loss: 7.347201| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.383418| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.174000| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.263176| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 119/200 |loss: 7.460091| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 120/200 |loss: 7.117990| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 121/200 |loss: 7.547272| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 122/200 |loss: 7.746357| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 123/200 |loss: 7.423387| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 124/200 |loss: 7.575687| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 125/200 |loss: 7.154067| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 126/200 |loss: 7.430543| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.128478| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 128/200 |loss: 7.328135| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 129/200 |loss: 7.180676| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 130/200 |loss: 7.143719| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.191480| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.067945| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 133/200 |loss: 7.158915| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 7.078259| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 135/200 |loss: 7.077418| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 136/200 |loss: 7.039904| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 137/200 |loss: 7.059464| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 138/200 |loss: 6.981796| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 7.024989| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 140/200 |loss: 6.978532| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 141/200 |loss: 6.974936| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 142/200 |loss: 6.968485| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 143/200 |loss: 6.943547| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 144/200 |loss: 6.953108| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 145/200 |loss: 6.935794| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 146/200 |loss: 6.929310| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 147/200 |loss: 6.913392| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 148/200 |loss: 6.924170| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 6.891642| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 150/200 |loss: 6.921737| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 6.913361| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 152/200 |loss: 6.970968| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 7.058572| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 154/200 |loss: 7.421239| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 155/200 |loss: 7.089481| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 156/200 |loss: 7.082500| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 157/200 |loss: 7.143522| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 158/200 |loss: 7.082696| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 159/200 |loss: 7.076242| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 160/200 |loss: 6.952022| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 7.218262| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 7.212145| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 163/200 |loss: 6.969821| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 164/200 |loss: 7.211104| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 165/200 |loss: 7.139388| train set 5.256x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 166/200 |loss: 7.063152| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 7.075657| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 168/200 |loss: 7.035236| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 169/200 |loss: 6.974113| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 170/200 |loss: 7.052721| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 171/200 |loss: 6.989869| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 172/200 |loss: 6.982674| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 173/200 |loss: 6.986246| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 174/200 |loss: 6.918548| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 175/200 |loss: 6.908655| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 176/200 |loss: 6.923179| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 177/200 |loss: 6.875117| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 178/200 |loss: 6.903932| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 179/200 |loss: 6.907518| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 180/200 |loss: 6.950895| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 181/200 |loss: 7.276933| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 182/200 |loss: 7.383088| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 183/200 |loss: 8.081718| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 184/200 |loss: 7.210103| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 185/200 |loss: 8.017696| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 186/200 |loss: 7.479850| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 187/200 |loss: 7.475014| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1
Epoch 188/200 |loss: 7.592483| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 189/200 |loss: 7.273716| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 190/200 |loss: 7.261353| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 191/200 |loss: 7.222370| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 192/200 |loss: 7.153279| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Epoch 193/200 |loss: 7.162707| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4
Epoch 194/200 |loss: 7.070309| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5
Epoch 195/200 |loss: 7.127079| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6
Epoch 196/200 |loss: 7.062085| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 197/200 |loss: 7.034150| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 7.014216| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2
Epoch 199/200 |loss: 6.993475| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3
Training per epoch cost 0.206 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 117, train speedup 5.267, test speedup 5.498, val speedup 5.638
best test speedup epoch: 40, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 197, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 199, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:02:10.444782
==================================================
