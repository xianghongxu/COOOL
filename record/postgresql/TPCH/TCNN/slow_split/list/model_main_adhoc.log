all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:02.048772, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884075| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100779| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726250| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990705| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590581| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702864| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341871| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393393| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043757| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769525| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977990| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257024| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.923798| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.196635| train set 1.552x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.129611| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.833106| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 14.983354| train set 2.022x speedup, test set 0.966x speedup, val set 0.502x speedup, step: 17
Epoch 17/200 |loss: 15.665996| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.134064| train set 1.997x speedup, test set 0.968x speedup, val set 0.502x speedup, step: 19
Epoch 19/200 |loss: 15.948027| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.586143| train set 1.856x speedup, test set 1.559x speedup, val set 1.000x speedup, step: 21
Epoch 21/200 |loss: 12.267584| train set 1.835x speedup, test set 1.669x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.605367| train set 2.021x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.297904| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 13.077949| train set 1.997x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 10.932435| train set 2.022x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.523664| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.543585| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 11.972982| train set 1.683x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.531349| train set 1.565x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 11.847833| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.677087| train set 1.941x speedup, test set 1.114x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 9.939144| train set 2.014x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.710240| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.446801| train set 2.022x speedup, test set 1.171x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.366329| train set 1.978x speedup, test set 1.171x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 9.669573| train set 2.022x speedup, test set 1.157x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 10.932395| train set 1.997x speedup, test set 1.171x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 12.632493| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 11.525103| train set 2.022x speedup, test set 1.164x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.132823| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 10.893147| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 10.778642| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 10.073833| train set 1.924x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 12.078973| train set 1.997x speedup, test set 1.171x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 13.495930| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 46
Epoch 46/200 |loss: 12.757372| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 47
Epoch 47/200 |loss: 10.788046| train set 1.997x speedup, test set 1.171x speedup, val set 0.502x speedup, step: 48
Epoch 48/200 |loss: 12.268552| train set 1.854x speedup, test set 1.177x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 10.302490| train set 1.996x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 11.816406| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 10.353822| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 10.983543| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 11.931982| train set 1.965x speedup, test set 1.129x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 10.651165| train set 1.819x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 10.840818| train set 1.856x speedup, test set 2.299x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 11.392950| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 10.405779| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 9.894197| train set 1.954x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 9.894501| train set 1.954x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.579558| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 10.523772| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.621453| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 10.134649| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 10.062784| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.045416| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 11.054792| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 11.066112| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 9.645774| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 9.264715| train set 1.856x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 9.268337| train set 1.835x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 9.976932| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 9.782970| train set 1.954x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.551125| train set 1.997x speedup, test set 1.106x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 10.440932| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 75
Epoch 75/200 |loss: 11.251115| train set 1.965x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 76
Epoch 76/200 |loss: 10.846245| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 77
Epoch 77/200 |loss: 9.378380| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 78
Epoch 78/200 |loss: 10.082942| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 9.745388| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 10.915152| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 9.099173| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.555936| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 83
Epoch 83/200 |loss: 9.640107| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.380682| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.417949| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 86
Epoch 86/200 |loss: 9.549371| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 87
Epoch 87/200 |loss: 8.708962| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 9.093403| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 10.338068| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 9.241507| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.870557| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 92
Epoch 92/200 |loss: 8.718338| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 9.552085| train set 1.856x speedup, test set 1.141x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.421204| train set 1.955x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 95
Epoch 95/200 |loss: 8.069704| train set 1.955x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 96
Epoch 96/200 |loss: 8.780374| train set 1.955x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 97
Epoch 97/200 |loss: 8.728026| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.665545| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 99
Epoch 99/200 |loss: 10.934503| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 100
Epoch 100/200 |loss: 9.624050| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 101/200 |loss: 8.867709| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 102/200 |loss: 8.622512| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 103/200 |loss: 9.691271| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 104/200 |loss: 9.507507| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 105/200 |loss: 9.712036| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 106/200 |loss: 10.304681| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 107/200 |loss: 8.652552| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 108/200 |loss: 11.203619| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 1
Epoch 109/200 |loss: 9.084307| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 110/200 |loss: 10.074221| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 111/200 |loss: 10.241067| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 112/200 |loss: 9.305660| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 113/200 |loss: 11.549035| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 114/200 |loss: 10.660139| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 115/200 |loss: 11.443247| train set 2.021x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 116/200 |loss: 11.225689| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 117/200 |loss: 10.751312| train set 1.856x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 118/200 |loss: 8.694967| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 119/200 |loss: 8.795089| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 120/200 |loss: 8.822877| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 121/200 |loss: 9.883475| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 122/200 |loss: 9.347221| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 123/200 |loss: 10.723343| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 124/200 |loss: 8.249949| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 125/200 |loss: 9.017946| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 126/200 |loss: 9.387177| train set 2.020x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 127/200 |loss: 9.417796| train set 2.020x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 128/200 |loss: 8.627328| train set 2.020x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 129/200 |loss: 9.568520| train set 2.020x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 130/200 |loss: 8.348748| train set 2.020x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 131/200 |loss: 9.467766| train set 2.020x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 132/200 |loss: 9.143738| train set 2.019x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 133/200 |loss: 9.266881| train set 2.013x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 134/200 |loss: 10.036462| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 135/200 |loss: 9.596811| train set 1.996x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 136/200 |loss: 10.408935| train set 2.022x speedup, test set 1.100x speedup, val set 1.000x speedup, step: 1
Epoch 137/200 |loss: 8.767978| train set 2.022x speedup, test set 1.098x speedup, val set 1.000x speedup, step: 1
Epoch 138/200 |loss: 8.573864| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 139/200 |loss: 8.502516| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 140/200 |loss: 8.597939| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 4
Epoch 141/200 |loss: 10.288088| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 5
Epoch 142/200 |loss: 8.160295| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 6
Epoch 143/200 |loss: 8.807030| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 7
Epoch 144/200 |loss: 8.334899| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 8
Epoch 145/200 |loss: 9.984666| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 9
Epoch 146/200 |loss: 8.100424| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 10
Epoch 147/200 |loss: 9.598920| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 11
Epoch 148/200 |loss: 8.577871| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 12
Epoch 149/200 |loss: 9.413064| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 13
Epoch 150/200 |loss: 8.139513| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 14
Epoch 151/200 |loss: 9.417115| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 15
Epoch 152/200 |loss: 8.340101| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 16
Epoch 153/200 |loss: 7.413994| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 17
Epoch 154/200 |loss: 8.358686| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 18
Epoch 155/200 |loss: 7.664010| train set 1.954x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 19
Epoch 156/200 |loss: 7.897997| train set 1.954x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 20
Epoch 157/200 |loss: 8.756746| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 21
Epoch 158/200 |loss: 10.305749| train set 1.977x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 22
Epoch 159/200 |loss: 10.404463| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 23
Epoch 160/200 |loss: 9.429113| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 24
Epoch 161/200 |loss: 9.628414| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 25
Epoch 162/200 |loss: 11.099729| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 26
Epoch 163/200 |loss: 9.772078| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 27
Epoch 164/200 |loss: 10.319947| train set 1.856x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 28
Epoch 165/200 |loss: 11.094287| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 29
Epoch 166/200 |loss: 7.983950| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 30
Epoch 167/200 |loss: 9.930701| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 31
Epoch 168/200 |loss: 8.522604| train set 1.994x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 32
Epoch 169/200 |loss: 10.603890| train set 1.994x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 33
Epoch 170/200 |loss: 9.696674| train set 1.975x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 171/200 |loss: 8.993667| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 172/200 |loss: 8.632675| train set 1.838x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 3
Epoch 173/200 |loss: 9.539664| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 4
Epoch 174/200 |loss: 9.154463| train set 1.978x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 5
Epoch 175/200 |loss: 9.027709| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 6
Epoch 176/200 |loss: 10.738419| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 7
Epoch 177/200 |loss: 9.707771| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 8
Epoch 178/200 |loss: 8.141086| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 9
Epoch 179/200 |loss: 9.752750| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 10
Epoch 180/200 |loss: 9.286306| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 181/200 |loss: 9.914938| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 12
Epoch 182/200 |loss: 9.336670| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 13
Epoch 183/200 |loss: 9.627458| train set 1.997x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 14
Epoch 184/200 |loss: 9.082261| train set 2.020x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 15
Epoch 185/200 |loss: 10.377985| train set 2.020x speedup, test set 1.116x speedup, val set 1.000x speedup, step: 1
Epoch 186/200 |loss: 8.879807| train set 2.019x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 187/200 |loss: 10.350826| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 2
Epoch 188/200 |loss: 8.244809| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 3
Epoch 189/200 |loss: 9.252819| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 4
Epoch 190/200 |loss: 8.589080| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 5
Epoch 191/200 |loss: 9.505715| train set 2.022x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 6
Epoch 192/200 |loss: 8.595869| train set 2.022x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 7
Epoch 193/200 |loss: 9.378262| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 8
Epoch 194/200 |loss: 9.228691| train set 1.996x speedup, test set 0.939x speedup, val set 0.502x speedup, step: 9
Epoch 195/200 |loss: 10.909273| train set 2.020x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 10
Epoch 196/200 |loss: 8.488680| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 197/200 |loss: 8.889904| train set 2.021x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 12
Epoch 198/200 |loss: 9.452753| train set 2.021x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 13
Epoch 199/200 |loss: 8.044282| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 14
Training per epoch cost 0.902 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
15, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
16, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
17, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
18, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
19, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
20, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 81, train speedup 2.022, test speedup 1.103, val speedup 0.502
best test speedup epoch: 55, train speedup 1.856, test speedup 2.299, val speedup 0.502
best validation speedup epoch: 186, train speedup 2.019, test speedup 1.103, val speedup 1.000
last model at epoch 199, train speedup 1.977, test speedup 1.121, val speedup 0.502
execution cost 0:07:28.006302
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.976078, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884075| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100779| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726250| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990705| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590576| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702855| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341859| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393375| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043753| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769519| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977969| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257071| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.923573| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.204330| train set 1.666x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.121465| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.831443| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 15.023989| train set 2.022x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 17
Epoch 17/200 |loss: 15.731148| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.058829| train set 2.022x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 19
Epoch 19/200 |loss: 16.152710| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.643988| train set 2.022x speedup, test set 1.516x speedup, val set 0.502x speedup, step: 21
Epoch 21/200 |loss: 12.343631| train set 1.834x speedup, test set 1.640x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.632047| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.288065| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 12.837255| train set 1.997x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 11.032803| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.398174| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.733228| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 12.305480| train set 1.683x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.585454| train set 1.581x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 12.008796| train set 1.941x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.829652| train set 1.941x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 10.292430| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.743662| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.496860| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.490966| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 9.557418| train set 1.924x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 10.997309| train set 1.996x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 12.684479| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 11.549313| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.038436| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 11.048990| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 10.733610| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 9.968153| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 12.086941| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 12.511028| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 46
Epoch 46/200 |loss: 12.697381| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 47
Epoch 47/200 |loss: 9.850037| train set 1.835x speedup, test set 1.162x speedup, val set 0.911x speedup, step: 48
Epoch 48/200 |loss: 12.772785| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 9.732818| train set 1.921x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 12.329228| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 10.010160| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 11.409993| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 12.241485| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 10.594327| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 11.428643| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 11.271455| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 10.923415| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 10.136899| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 9.907569| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.803583| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 10.530839| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.544688| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 10.430737| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 10.094929| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.229526| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 11.477637| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 10.832970| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 10.148190| train set 2.022x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 9.043128| train set 1.876x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 9.273890| train set 1.856x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 10.160613| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 9.670273| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.489062| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 10.293437| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 75
Epoch 75/200 |loss: 11.186274| train set 1.964x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 76
Epoch 76/200 |loss: 10.937573| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 77
Epoch 77/200 |loss: 9.370110| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 78
Epoch 78/200 |loss: 10.416498| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 9.713456| train set 2.022x speedup, test set 2.063x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 11.143380| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 9.265177| train set 1.975x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.428328| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 83
Epoch 83/200 |loss: 9.947106| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.526886| train set 1.976x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.762520| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 86
Epoch 86/200 |loss: 9.489592| train set 1.997x speedup, test set 2.063x speedup, val set 0.502x speedup, step: 87
Epoch 87/200 |loss: 8.709219| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 8.852210| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 10.608279| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 9.137973| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.761384| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 92
Epoch 92/200 |loss: 9.124829| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 9.482417| train set 1.856x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.771965| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 95
Epoch 95/200 |loss: 7.913125| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 96
Epoch 96/200 |loss: 8.684868| train set 1.954x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 97
Epoch 97/200 |loss: 8.662760| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.581047| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 99
Epoch 99/200 |loss: 11.022169| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 100
Epoch 100/200 |loss: 9.448175| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 101/200 |loss: 8.832515| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 102/200 |loss: 8.784847| train set 2.014x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 103/200 |loss: 9.517010| train set 2.014x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 104/200 |loss: 9.731231| train set 2.022x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 105/200 |loss: 9.616940| train set 1.978x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 106/200 |loss: 10.452502| train set 1.978x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 107/200 |loss: 8.812044| train set 1.978x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 108/200 |loss: 11.242974| train set 1.978x speedup, test set 2.143x speedup, val set 0.502x speedup, step: 1
Epoch 109/200 |loss: 8.970501| train set 2.022x speedup, test set 2.125x speedup, val set 0.502x speedup, step: 1
Epoch 110/200 |loss: 9.942959| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 111/200 |loss: 10.049007| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 112/200 |loss: 8.971539| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 113/200 |loss: 10.975179| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 114/200 |loss: 10.426953| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 115/200 |loss: 10.849328| train set 2.021x speedup, test set 2.143x speedup, val set 0.502x speedup, step: 1
Epoch 116/200 |loss: 11.255484| train set 2.022x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 117/200 |loss: 10.295243| train set 1.876x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 118/200 |loss: 8.168745| train set 2.022x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 119/200 |loss: 8.558662| train set 2.022x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 120/200 |loss: 8.647995| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 121/200 |loss: 9.663260| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 122/200 |loss: 9.233785| train set 2.022x speedup, test set 2.100x speedup, val set 0.502x speedup, step: 1
Epoch 123/200 |loss: 10.463778| train set 2.022x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 124/200 |loss: 8.108609| train set 2.022x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 125/200 |loss: 9.101277| train set 1.997x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 126/200 |loss: 9.221319| train set 2.020x speedup, test set 2.134x speedup, val set 0.502x speedup, step: 1
Epoch 127/200 |loss: 9.646530| train set 2.020x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 128/200 |loss: 8.698127| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 129/200 |loss: 9.647221| train set 2.019x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 130/200 |loss: 8.448950| train set 1.976x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 131/200 |loss: 9.404786| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 132/200 |loss: 9.013193| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 133/200 |loss: 9.310433| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 134/200 |loss: 9.914567| train set 1.997x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 135/200 |loss: 9.542121| train set 1.996x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 136/200 |loss: 10.389577| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 137/200 |loss: 8.683764| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 138/200 |loss: 8.474872| train set 2.020x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 139/200 |loss: 8.465878| train set 2.021x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 140/200 |loss: 8.526585| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 141/200 |loss: 10.278874| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 142/200 |loss: 8.214163| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 143/200 |loss: 8.935746| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 144/200 |loss: 8.156092| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 145/200 |loss: 10.021900| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 146/200 |loss: 8.017581| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 147/200 |loss: 9.638636| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 148/200 |loss: 8.468202| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 149/200 |loss: 9.408903| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 150/200 |loss: 8.233855| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 151/200 |loss: 9.407590| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 152/200 |loss: 8.386058| train set 1.978x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 153/200 |loss: 7.463525| train set 1.819x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 154/200 |loss: 8.465715| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 155/200 |loss: 7.601321| train set 1.954x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 156/200 |loss: 7.896618| train set 1.954x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 157/200 |loss: 8.930737| train set 1.978x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 158/200 |loss: 10.367402| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 159/200 |loss: 10.689963| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 160/200 |loss: 9.535184| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 161/200 |loss: 9.913795| train set 2.022x speedup, test set 2.143x speedup, val set 0.502x speedup, step: 1
Epoch 162/200 |loss: 11.374852| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 163/200 |loss: 9.529368| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 164/200 |loss: 10.493645| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 165/200 |loss: 10.890287| train set 1.997x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 1
Epoch 166/200 |loss: 7.994576| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 167/200 |loss: 9.951431| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 168/200 |loss: 8.520223| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 169/200 |loss: 10.414163| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 170/200 |loss: 9.395474| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 171/200 |loss: 8.682012| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 172/200 |loss: 8.386789| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 173/200 |loss: 9.362305| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 1
Epoch 174/200 |loss: 8.974611| train set 1.978x speedup, test set 2.143x speedup, val set 0.502x speedup, step: 1
Epoch 175/200 |loss: 9.080400| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 176/200 |loss: 10.073333| train set 1.997x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 177/200 |loss: 9.114310| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 178/200 |loss: 7.577999| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 179/200 |loss: 9.483562| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 180/200 |loss: 8.733377| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 181/200 |loss: 9.568826| train set 2.022x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 1
Epoch 182/200 |loss: 8.907341| train set 1.997x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 183/200 |loss: 8.872863| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 184/200 |loss: 8.713617| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 185/200 |loss: 9.641695| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 186/200 |loss: 8.832686| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 187/200 |loss: 10.258562| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 188/200 |loss: 8.161468| train set 1.977x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 189/200 |loss: 9.234790| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 190/200 |loss: 8.859738| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 191/200 |loss: 10.026353| train set 1.977x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 192/200 |loss: 8.917390| train set 2.022x speedup, test set 2.063x speedup, val set 0.502x speedup, step: 1
Epoch 193/200 |loss: 9.551250| train set 1.997x speedup, test set 2.063x speedup, val set 0.502x speedup, step: 1
Epoch 194/200 |loss: 9.246613| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 195/200 |loss: 10.898481| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 196/200 |loss: 8.594108| train set 2.020x speedup, test set 2.143x speedup, val set 0.502x speedup, step: 1
Epoch 197/200 |loss: 9.214234| train set 2.022x speedup, test set 2.100x speedup, val set 0.502x speedup, step: 1
Epoch 198/200 |loss: 9.747145| train set 2.022x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 199/200 |loss: 8.339719| train set 1.977x speedup, test set 2.143x speedup, val set 0.502x speedup, step: 1
Training per epoch cost 0.854 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 35.457s, pg runtime 601.866s, speedup 16.975x
22, opt runtime 24.079s, model runtime 42.549s, pg runtime 608.707s, speedup 14.306x
23, opt runtime 24.662s, model runtime 38.046s, pg runtime 613.999s, speedup 16.138x
24, opt runtime 24.459s, model runtime 35.309s, pg runtime 608.717s, speedup 17.240x
25, opt runtime 25.236s, model runtime 38.025s, pg runtime 601.756s, speedup 15.825x
26, opt runtime 25.363s, model runtime 39.865s, pg runtime 611.327s, speedup 15.335x
27, opt runtime 24.706s, model runtime 37.014s, pg runtime 610.808s, speedup 16.502x
28, opt runtime 25.075s, model runtime 38.121s, pg runtime 612.430s, speedup 16.065x
29, opt runtime 24.840s, model runtime 42.656s, pg runtime 626.529s, speedup 14.688x
30, opt runtime 24.920s, model runtime 41.372s, pg runtime 610.993s, speedup 14.768x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 34, train speedup 2.022, test speedup 1.098, val speedup 0.502
best test speedup epoch: 108, train speedup 1.978, test speedup 2.143, val speedup 0.502
best validation speedup epoch: 199, train speedup 1.977, test speedup 2.143, val speedup 0.502
last model at epoch 199, train speedup 1.977, test speedup 2.143, val speedup 0.502
execution cost 0:07:11.328561
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.430434, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884075| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100779| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726252| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990707| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590583| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702868| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341879| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393410| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043763| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769517| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977851| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257065| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.924331| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.190131| train set 1.552x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.136445| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.843291| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 15.000392| train set 2.022x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 17
Epoch 17/200 |loss: 15.614481| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.086020| train set 1.997x speedup, test set 0.968x speedup, val set 0.502x speedup, step: 19
Epoch 19/200 |loss: 16.070109| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.713728| train set 1.856x speedup, test set 1.640x speedup, val set 1.000x speedup, step: 21
Epoch 21/200 |loss: 12.175738| train set 1.856x speedup, test set 1.669x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.598987| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.323448| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 13.144436| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 10.826608| train set 1.683x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.401659| train set 1.653x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.614352| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 12.023479| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.386003| train set 1.565x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 11.794311| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.755617| train set 1.941x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 10.019494| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.642053| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.448828| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.322982| train set 1.978x speedup, test set 1.157x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 9.778191| train set 1.996x speedup, test set 0.958x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 10.887256| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 12.619507| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 11.912701| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.430852| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 11.012754| train set 1.954x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 10.704438| train set 1.954x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 9.937910| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 11.625422| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 11.018485| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 46
Epoch 46/200 |loss: 12.308122| train set 1.978x speedup, test set 0.917x speedup, val set 0.911x speedup, step: 47
Epoch 47/200 |loss: 9.700018| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 48
Epoch 48/200 |loss: 10.820245| train set 1.954x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 9.790145| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 10.297470| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 10.010718| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 10.232597| train set 2.022x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 11.251096| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 9.833767| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 10.569894| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 10.746706| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 9.826576| train set 1.924x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 9.415164| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 9.630630| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.156861| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 10.154298| train set 1.995x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.485086| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 9.918393| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 9.918958| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.617068| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 10.477339| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 10.571158| train set 1.987x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 10.268075| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 9.111686| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 9.316420| train set 1.854x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 10.116570| train set 1.954x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 9.864054| train set 1.954x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.204151| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 10.361776| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 75
Epoch 75/200 |loss: 10.410430| train set 2.022x speedup, test set 1.103x speedup, val set 0.911x speedup, step: 76
Epoch 76/200 |loss: 10.231164| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 77
Epoch 77/200 |loss: 8.993288| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 78
Epoch 78/200 |loss: 10.185799| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 10.131161| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 10.756480| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 9.101609| train set 1.856x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.853374| train set 2.019x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 83
Epoch 83/200 |loss: 9.362788| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.434975| train set 1.975x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.405128| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 86
Epoch 86/200 |loss: 9.150552| train set 1.847x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 87
Epoch 87/200 |loss: 8.688536| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 8.895973| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 9.974692| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 8.729391| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.264472| train set 2.022x speedup, test set 1.111x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 8.606343| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 10.223627| train set 1.835x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.229224| train set 1.954x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 8.314075| train set 1.976x speedup, test set 1.100x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 8.379663| train set 1.978x speedup, test set 0.919x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 8.880544| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.608071| train set 1.978x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 10.803800| train set 1.997x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 100
Epoch 100/200 |loss: 10.064250| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 101
Epoch 101/200 |loss: 8.878928| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 102
Epoch 102/200 |loss: 8.718884| train set 1.997x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 103
Epoch 103/200 |loss: 9.690422| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 104
Epoch 104/200 |loss: 9.401679| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 105
Epoch 105/200 |loss: 9.854242| train set 1.978x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 106
Epoch 106/200 |loss: 10.437800| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 107
Epoch 107/200 |loss: 8.822805| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 108
Epoch 108/200 |loss: 11.679905| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 109
Epoch 109/200 |loss: 9.245570| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 110
Epoch 110/200 |loss: 10.492897| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 111
Epoch 111/200 |loss: 10.080385| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 112
Epoch 112/200 |loss: 9.408949| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 113
Epoch 113/200 |loss: 11.645308| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 114
Epoch 114/200 |loss: 10.448597| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 115
Epoch 115/200 |loss: 11.120686| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 116
Epoch 116/200 |loss: 11.349941| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 117
Epoch 117/200 |loss: 10.373242| train set 1.876x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 118
Epoch 118/200 |loss: 8.201613| train set 1.876x speedup, test set 0.925x speedup, val set 0.502x speedup, step: 119
Epoch 119/200 |loss: 8.608859| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 120
Epoch 120/200 |loss: 8.596420| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 121
Epoch 121/200 |loss: 9.608005| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 122
Epoch 122/200 |loss: 9.416535| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 123
Epoch 123/200 |loss: 10.525917| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 124
Epoch 124/200 |loss: 8.216669| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 125
Epoch 125/200 |loss: 8.897620| train set 1.997x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 126
Epoch 126/200 |loss: 9.132123| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 127
Epoch 127/200 |loss: 9.432300| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 128
Epoch 128/200 |loss: 8.585902| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 129
Epoch 129/200 |loss: 9.675157| train set 2.021x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 130
Epoch 130/200 |loss: 8.417696| train set 2.019x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 131
Epoch 131/200 |loss: 9.457607| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 132
Epoch 132/200 |loss: 9.073310| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 133
Epoch 133/200 |loss: 9.272989| train set 1.997x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 134
Epoch 134/200 |loss: 9.934072| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 135
Epoch 135/200 |loss: 9.518140| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 136
Epoch 136/200 |loss: 10.512114| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 137
Epoch 137/200 |loss: 8.807548| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 138
Epoch 138/200 |loss: 8.416676| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 139
Epoch 139/200 |loss: 8.462215| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 140
Epoch 140/200 |loss: 8.489462| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 141
Epoch 141/200 |loss: 10.440542| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 142
Epoch 142/200 |loss: 8.505804| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 143
Epoch 143/200 |loss: 8.978301| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 144
Epoch 144/200 |loss: 8.468408| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 145
Epoch 145/200 |loss: 10.229009| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 146
Epoch 146/200 |loss: 8.171478| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 147
Epoch 147/200 |loss: 9.700854| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 148
Epoch 148/200 |loss: 8.674102| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 149
Epoch 149/200 |loss: 9.546384| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 150
Epoch 150/200 |loss: 8.164570| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 151
Epoch 151/200 |loss: 9.535869| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 152
Epoch 152/200 |loss: 8.496816| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 153
Epoch 153/200 |loss: 7.567018| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 154
Epoch 154/200 |loss: 8.623728| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 155
Epoch 155/200 |loss: 7.764916| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 156
Epoch 156/200 |loss: 7.954055| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 157
Epoch 157/200 |loss: 8.890306| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 158
Epoch 158/200 |loss: 10.346317| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 159
Epoch 159/200 |loss: 10.461113| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 160
Epoch 160/200 |loss: 9.170540| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 161
Epoch 161/200 |loss: 9.493290| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 162
Epoch 162/200 |loss: 10.649221| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 163
Epoch 163/200 |loss: 9.557432| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 164
Epoch 164/200 |loss: 10.111507| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 165
Epoch 165/200 |loss: 10.092509| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 166
Epoch 166/200 |loss: 7.989854| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 167
Epoch 167/200 |loss: 9.263067| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 168
Epoch 168/200 |loss: 8.268781| train set 2.019x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 169
Epoch 169/200 |loss: 9.886608| train set 2.019x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 170
Epoch 170/200 |loss: 9.465208| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 171
Epoch 171/200 |loss: 8.244424| train set 1.978x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 172
Epoch 172/200 |loss: 8.297799| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 173
Epoch 173/200 |loss: 9.077758| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 174
Epoch 174/200 |loss: 8.975266| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 175
Epoch 175/200 |loss: 8.843359| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 176
Epoch 176/200 |loss: 10.139731| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 177
Epoch 177/200 |loss: 8.904711| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 178
Epoch 178/200 |loss: 7.545560| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 179
Epoch 179/200 |loss: 9.530915| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 180
Epoch 180/200 |loss: 8.802703| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 181
Epoch 181/200 |loss: 9.657873| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 182
Epoch 182/200 |loss: 9.100213| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 183
Epoch 183/200 |loss: 8.953846| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 184
Epoch 184/200 |loss: 8.858542| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 185
Epoch 185/200 |loss: 9.619688| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 186
Epoch 186/200 |loss: 8.743009| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 187
Epoch 187/200 |loss: 10.074052| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 188
Epoch 188/200 |loss: 7.861931| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 189
Epoch 189/200 |loss: 9.314623| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 190
Epoch 190/200 |loss: 8.616715| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 191
Epoch 191/200 |loss: 9.526785| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 192
Epoch 192/200 |loss: 8.505038| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 193
Epoch 193/200 |loss: 9.462063| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 194
Epoch 194/200 |loss: 9.208469| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 195
Epoch 195/200 |loss: 10.774499| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 196
Epoch 196/200 |loss: 8.461475| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 197
Epoch 197/200 |loss: 9.078572| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 198
Epoch 198/200 |loss: 9.633321| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 199
Epoch 199/200 |loss: 8.167169| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 200
Training per epoch cost 0.994 s
Optimal speedup on test set is 11.153x
====================
best train speedup epoch: 37, train speedup 2.022, test speedup 0.917, val speedup 0.502
best test speedup epoch: 5, train speedup 1.250, test speedup 1.759, val speedup 0.502
best validation speedup epoch: 99, train speedup 1.997, test speedup 1.103, val speedup 1.000
last model at epoch 199, train speedup 1.977, test speedup 1.121, val speedup 0.502
execution cost 0:08:11.453914
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.561633, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884075| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100779| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726250| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990706| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590582| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702866| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341876| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393398| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043759| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769526| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977996| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257028| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.923733| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.196878| train set 1.552x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.128192| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.802547| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 14.939142| train set 2.022x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 17
Epoch 17/200 |loss: 15.712021| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.028693| train set 1.997x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 19
Epoch 19/200 |loss: 15.958834| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.551322| train set 1.856x speedup, test set 1.640x speedup, val set 1.000x speedup, step: 21
Epoch 21/200 |loss: 12.484363| train set 1.835x speedup, test set 1.669x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.394214| train set 2.021x speedup, test set 0.927x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.329406| train set 2.016x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 12.928478| train set 1.991x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 10.904607| train set 2.021x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.020837| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.322175| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 11.615345| train set 1.683x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.125943| train set 1.666x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 11.488655| train set 1.901x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.782941| train set 1.997x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 10.004967| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.410022| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.499998| train set 2.022x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.039932| train set 1.978x speedup, test set 1.039x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 9.871760| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 10.824883| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 12.687884| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 11.983659| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.238907| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 11.201586| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 10.814130| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 9.803635| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 11.942209| train set 1.855x speedup, test set 1.137x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 11.866652| train set 1.965x speedup, test set 1.098x speedup, val set 1.000x speedup, step: 46
Epoch 46/200 |loss: 12.270569| train set 2.021x speedup, test set 1.098x speedup, val set 1.000x speedup, step: 47
Epoch 47/200 |loss: 10.094023| train set 1.997x speedup, test set 1.177x speedup, val set 0.502x speedup, step: 48
Epoch 48/200 |loss: 11.621939| train set 1.996x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 9.855844| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 11.345677| train set 2.022x speedup, test set 1.137x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 9.970988| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 10.535997| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 11.272706| train set 1.819x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 10.302529| train set 1.856x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 10.686964| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 10.760555| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 9.859858| train set 1.924x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 9.397392| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 9.621467| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.523479| train set 1.997x speedup, test set 1.148x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 10.220044| train set 1.952x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.702047| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 10.440863| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 10.030681| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.372626| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 10.840211| train set 2.022x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 10.997871| train set 2.022x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 10.217214| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 8.579756| train set 1.838x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 10.088321| train set 1.835x speedup, test set 1.157x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 10.745805| train set 1.997x speedup, test set 2.299x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 10.022791| train set 1.954x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.545973| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 10.780908| train set 1.942x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 75
Epoch 75/200 |loss: 11.190773| train set 1.964x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 76
Epoch 76/200 |loss: 11.180817| train set 2.022x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 77
Epoch 77/200 |loss: 9.559091| train set 1.856x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 78
Epoch 78/200 |loss: 10.452246| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 9.623581| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 10.808318| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 9.193800| train set 1.854x speedup, test set 1.148x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.797940| train set 2.022x speedup, test set 1.161x speedup, val set 0.502x speedup, step: 83
Epoch 83/200 |loss: 9.797849| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.504579| train set 1.976x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.199271| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 86
Epoch 86/200 |loss: 9.648878| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 87
Epoch 87/200 |loss: 8.418231| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 9.101150| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 10.152774| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 8.827974| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.447065| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 92
Epoch 92/200 |loss: 8.626790| train set 1.855x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 9.804067| train set 1.835x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.365506| train set 1.955x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 95
Epoch 95/200 |loss: 8.018559| train set 1.955x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 96
Epoch 96/200 |loss: 8.382325| train set 1.976x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 97
Epoch 97/200 |loss: 8.785921| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.591740| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 99
Epoch 99/200 |loss: 11.143850| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 100
Epoch 100/200 |loss: 9.613144| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 101/200 |loss: 8.860532| train set 1.997x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 102/200 |loss: 8.808479| train set 1.996x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 103/200 |loss: 9.870154| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 104/200 |loss: 9.634232| train set 1.997x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 105/200 |loss: 9.649147| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 106/200 |loss: 10.488542| train set 2.022x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 1
Epoch 107/200 |loss: 8.856271| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 108/200 |loss: 11.531521| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 109/200 |loss: 9.099044| train set 1.953x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 110/200 |loss: 10.093424| train set 1.997x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 111/200 |loss: 10.272973| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 112/200 |loss: 9.074695| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 113/200 |loss: 11.238566| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 114/200 |loss: 10.410835| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 115/200 |loss: 10.766703| train set 2.021x speedup, test set 2.143x speedup, val set 0.502x speedup, step: 1
Epoch 116/200 |loss: 11.256539| train set 2.021x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 117/200 |loss: 10.338824| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 118/200 |loss: 8.004967| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 119/200 |loss: 8.625583| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 120/200 |loss: 8.504629| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 121/200 |loss: 9.757946| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 1
Epoch 122/200 |loss: 9.135695| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1
Epoch 123/200 |loss: 10.244380| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1
Epoch 124/200 |loss: 8.092227| train set 2.022x speedup, test set 0.939x speedup, val set 0.502x speedup, step: 1
Epoch 125/200 |loss: 9.039839| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 126/200 |loss: 8.902429| train set 1.975x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 127/200 |loss: 9.825084| train set 2.020x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 128/200 |loss: 8.592818| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 129/200 |loss: 9.809538| train set 2.020x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 130/200 |loss: 8.786924| train set 2.020x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 1
Epoch 131/200 |loss: 9.746488| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 132/200 |loss: 9.016822| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 133/200 |loss: 9.573034| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 134/200 |loss: 9.849229| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 135/200 |loss: 9.801428| train set 1.997x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 136/200 |loss: 10.747637| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 137/200 |loss: 8.769737| train set 2.022x speedup, test set 1.100x speedup, val set 1.000x speedup, step: 1
Epoch 138/200 |loss: 8.464258| train set 2.022x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 139/200 |loss: 8.525954| train set 1.978x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 140/200 |loss: 8.623882| train set 2.021x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 141/200 |loss: 10.203101| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 3
Epoch 142/200 |loss: 8.195288| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 4
Epoch 143/200 |loss: 8.874262| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 5
Epoch 144/200 |loss: 8.210185| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 6
Epoch 145/200 |loss: 9.796738| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 7
Epoch 146/200 |loss: 8.226965| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 8
Epoch 147/200 |loss: 9.635768| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 9
Epoch 148/200 |loss: 8.604988| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 10
Epoch 149/200 |loss: 9.235512| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 11
Epoch 150/200 |loss: 8.042654| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 12
Epoch 151/200 |loss: 9.315826| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 13
Epoch 152/200 |loss: 8.333522| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 14
Epoch 153/200 |loss: 7.428189| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 15
Epoch 154/200 |loss: 8.453761| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 16
Epoch 155/200 |loss: 7.615328| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 17
Epoch 156/200 |loss: 7.834758| train set 1.954x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 18
Epoch 157/200 |loss: 8.791934| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 19
Epoch 158/200 |loss: 10.205752| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 20
Epoch 159/200 |loss: 10.398574| train set 2.022x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 21
Epoch 160/200 |loss: 9.515045| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 22
Epoch 161/200 |loss: 9.663809| train set 2.001x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 162/200 |loss: 11.224621| train set 2.021x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 163/200 |loss: 9.497992| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 164/200 |loss: 10.254947| train set 1.835x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 3
Epoch 165/200 |loss: 10.877393| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 166/200 |loss: 7.901860| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 167/200 |loss: 10.029778| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 6
Epoch 168/200 |loss: 8.534363| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 7
Epoch 169/200 |loss: 10.702729| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 8
Epoch 170/200 |loss: 9.604300| train set 1.978x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 171/200 |loss: 8.927912| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 172/200 |loss: 8.576429| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 3
Epoch 173/200 |loss: 9.629485| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 4
Epoch 174/200 |loss: 9.109124| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 175/200 |loss: 8.991979| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 6
Epoch 176/200 |loss: 10.367333| train set 1.995x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 7
Epoch 177/200 |loss: 9.631701| train set 1.993x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 8
Epoch 178/200 |loss: 8.007809| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 9
Epoch 179/200 |loss: 9.577840| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 10
Epoch 180/200 |loss: 9.132717| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 181/200 |loss: 9.591623| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 12
Epoch 182/200 |loss: 9.165519| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 13
Epoch 183/200 |loss: 9.304630| train set 2.022x speedup, test set 1.116x speedup, val set 1.000x speedup, step: 1
Epoch 184/200 |loss: 8.708414| train set 1.977x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 185/200 |loss: 10.307748| train set 2.022x speedup, test set 1.118x speedup, val set 1.000x speedup, step: 1
Epoch 186/200 |loss: 8.824115| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 187/200 |loss: 11.208172| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 3
Epoch 188/200 |loss: 8.315818| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 189/200 |loss: 9.646019| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 190/200 |loss: 9.242296| train set 1.978x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 6
Epoch 191/200 |loss: 9.728524| train set 2.021x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 7
Epoch 192/200 |loss: 8.777785| train set 2.021x speedup, test set 1.100x speedup, val set 1.000x speedup, step: 1
Epoch 193/200 |loss: 9.336554| train set 2.021x speedup, test set 1.116x speedup, val set 1.000x speedup, step: 1
Epoch 194/200 |loss: 9.247817| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 195/200 |loss: 11.228686| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 196/200 |loss: 8.679824| train set 2.021x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 197/200 |loss: 8.887619| train set 2.021x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 198/200 |loss: 9.225315| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 199/200 |loss: 8.258008| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Training per epoch cost 0.867 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 37, train speedup 2.022, test speedup 1.098, val speedup 0.502
best test speedup epoch: 71, train speedup 1.997, test speedup 2.299, val speedup 0.502
best validation speedup epoch: 197, train speedup 2.021, test speedup 1.121, val speedup 1.000
last model at epoch 199, train speedup 2.021, test speedup 1.121, val speedup 0.502
execution cost 0:07:13.170345
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.257325, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884075| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100779| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726250| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990704| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590576| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702854| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341855| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393369| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043751| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769513| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977836| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257608| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.920151| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.196193| train set 1.666x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.137104| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.792618| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 14.958399| train set 2.022x speedup, test set 0.971x speedup, val set 1.000x speedup, step: 17
Epoch 17/200 |loss: 15.655141| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.038175| train set 2.022x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 19
Epoch 19/200 |loss: 15.971516| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.770641| train set 1.856x speedup, test set 1.516x speedup, val set 0.502x speedup, step: 21
Epoch 21/200 |loss: 12.223793| train set 1.835x speedup, test set 1.669x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.720195| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.266275| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 12.870540| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 10.973264| train set 1.666x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.208733| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.489694| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 11.842126| train set 1.683x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.246196| train set 1.683x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 11.607606| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.695307| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 10.090851| train set 2.013x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.748398| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.474199| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.543602| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 9.812961| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 10.843035| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 12.689080| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 11.651215| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.456328| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 11.178069| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 10.583347| train set 1.954x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 9.778533| train set 1.955x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 11.883437| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 11.539476| train set 1.924x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 46
Epoch 46/200 |loss: 12.415040| train set 2.022x speedup, test set 1.100x speedup, val set 0.911x speedup, step: 47
Epoch 47/200 |loss: 9.840093| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 48
Epoch 48/200 |loss: 11.404839| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 9.489018| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 10.724136| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 10.223513| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 10.242468| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 11.219188| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 9.961341| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 10.404539| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 10.906689| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 10.160687| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 9.543720| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 9.721636| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.365848| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 10.071500| train set 1.952x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.570116| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 10.205846| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 10.002700| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.432790| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 10.596393| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 10.730109| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 10.292743| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 8.564673| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 9.903865| train set 1.854x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 10.530632| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 9.436254| train set 1.924x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.598658| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 10.241911| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 75
Epoch 75/200 |loss: 10.880365| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 76
Epoch 76/200 |loss: 10.553959| train set 2.022x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 77
Epoch 77/200 |loss: 9.342034| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 78
Epoch 78/200 |loss: 10.047833| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 9.366432| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 10.773977| train set 1.856x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 9.003741| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.532242| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 83
Epoch 83/200 |loss: 9.602087| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.291682| train set 1.977x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.242908| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 86
Epoch 86/200 |loss: 9.588861| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 87
Epoch 87/200 |loss: 8.327398| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 8.970610| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 10.073050| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 9.069441| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.283327| train set 1.977x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 92
Epoch 92/200 |loss: 8.510024| train set 2.013x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 9.230359| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.004577| train set 1.954x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 95
Epoch 95/200 |loss: 8.192749| train set 1.955x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 96
Epoch 96/200 |loss: 8.352571| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 97
Epoch 97/200 |loss: 8.734722| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.417876| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 99
Epoch 99/200 |loss: 11.171262| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 100
Epoch 100/200 |loss: 9.664321| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 101/200 |loss: 8.820200| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 102/200 |loss: 8.620659| train set 1.997x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 1
Epoch 103/200 |loss: 9.843082| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 104/200 |loss: 9.528595| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 105/200 |loss: 9.818017| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 106/200 |loss: 10.540209| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 107/200 |loss: 8.657413| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 108/200 |loss: 11.814402| train set 1.976x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 109/200 |loss: 9.095217| train set 1.976x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 110/200 |loss: 10.178195| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 111/200 |loss: 10.324189| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 112/200 |loss: 9.171068| train set 2.021x speedup, test set 0.941x speedup, val set 0.502x speedup, step: 1
Epoch 113/200 |loss: 11.881513| train set 2.022x speedup, test set 0.935x speedup, val set 0.502x speedup, step: 1
Epoch 114/200 |loss: 10.298367| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 115/200 |loss: 11.206722| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 116/200 |loss: 11.246235| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 117/200 |loss: 10.614707| train set 1.876x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 118/200 |loss: 8.020914| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 119/200 |loss: 8.609347| train set 2.022x speedup, test set 1.100x speedup, val set 1.000x speedup, step: 1
Epoch 120/200 |loss: 8.825435| train set 2.020x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 121/200 |loss: 9.609903| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 3
Epoch 122/200 |loss: 9.235756| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 4
Epoch 123/200 |loss: 10.736689| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 5
Epoch 124/200 |loss: 8.363864| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 6
Epoch 125/200 |loss: 8.811010| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 7
Epoch 126/200 |loss: 9.490734| train set 2.022x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 127/200 |loss: 9.488115| train set 2.020x speedup, test set 1.111x speedup, val set 1.000x speedup, step: 1
Epoch 128/200 |loss: 8.848459| train set 2.020x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 129/200 |loss: 9.565096| train set 2.020x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 3
Epoch 130/200 |loss: 8.434631| train set 2.020x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 4
Epoch 131/200 |loss: 9.331097| train set 1.977x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 5
Epoch 132/200 |loss: 9.210561| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 6
Epoch 133/200 |loss: 9.168065| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 7
Epoch 134/200 |loss: 10.122591| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 8
Epoch 135/200 |loss: 9.654572| train set 2.018x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 9
Epoch 136/200 |loss: 10.203246| train set 2.022x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 137/200 |loss: 8.789701| train set 2.022x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 138/200 |loss: 8.492836| train set 2.020x speedup, test set 0.946x speedup, val set 0.502x speedup, step: 2
Epoch 139/200 |loss: 8.459393| train set 2.020x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3
Epoch 140/200 |loss: 8.379326| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 4
Epoch 141/200 |loss: 10.379967| train set 2.022x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 5
Epoch 142/200 |loss: 8.073264| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 6
Epoch 143/200 |loss: 8.731894| train set 1.978x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 7
Epoch 144/200 |loss: 8.105844| train set 1.978x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 8
Epoch 145/200 |loss: 9.991585| train set 2.022x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 9
Epoch 146/200 |loss: 8.147565| train set 2.022x speedup, test set 0.959x speedup, val set 0.911x speedup, step: 10
Epoch 147/200 |loss: 9.626148| train set 2.022x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 11
Epoch 148/200 |loss: 8.510687| train set 2.021x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 12
Epoch 149/200 |loss: 9.478388| train set 2.021x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 13
Epoch 150/200 |loss: 8.126629| train set 2.021x speedup, test set 0.954x speedup, val set 0.782x speedup, step: 14
Epoch 151/200 |loss: 9.430436| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 15
Epoch 152/200 |loss: 8.375335| train set 1.978x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 16
Epoch 153/200 |loss: 7.539266| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 17
Epoch 154/200 |loss: 8.459263| train set 1.978x speedup, test set 0.935x speedup, val set 0.502x speedup, step: 18
Epoch 155/200 |loss: 7.657380| train set 1.954x speedup, test set 0.935x speedup, val set 0.502x speedup, step: 19
Epoch 156/200 |loss: 7.890668| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 20
Epoch 157/200 |loss: 8.905478| train set 1.977x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 21
Epoch 158/200 |loss: 10.273827| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 22
Epoch 159/200 |loss: 10.409726| train set 2.022x speedup, test set 0.935x speedup, val set 0.502x speedup, step: 23
Epoch 160/200 |loss: 9.308768| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 24
Epoch 161/200 |loss: 9.521954| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 25
Epoch 162/200 |loss: 11.067499| train set 2.022x speedup, test set 1.116x speedup, val set 1.000x speedup, step: 1
Epoch 163/200 |loss: 9.568822| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 164/200 |loss: 10.425443| train set 1.997x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 3
Epoch 165/200 |loss: 11.085982| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 4
Epoch 166/200 |loss: 7.972784| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 167/200 |loss: 9.890858| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 6
Epoch 168/200 |loss: 8.599796| train set 1.997x speedup, test set 1.098x speedup, val set 1.000x speedup, step: 1
Epoch 169/200 |loss: 10.731053| train set 2.014x speedup, test set 1.098x speedup, val set 1.000x speedup, step: 1
Epoch 170/200 |loss: 9.669210| train set 1.978x speedup, test set 1.109x speedup, val set 1.000x speedup, step: 1
Epoch 171/200 |loss: 8.759100| train set 1.978x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 172/200 |loss: 8.455891| train set 1.978x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 2
Epoch 173/200 |loss: 9.443809| train set 1.978x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 3
Epoch 174/200 |loss: 9.028270| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4
Epoch 175/200 |loss: 9.179898| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5
Epoch 176/200 |loss: 10.463705| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 6
Epoch 177/200 |loss: 9.385833| train set 1.995x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 7
Epoch 178/200 |loss: 7.674600| train set 1.995x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 8
Epoch 179/200 |loss: 9.708097| train set 1.995x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 9
Epoch 180/200 |loss: 8.897782| train set 1.995x speedup, test set 0.926x speedup, val set 0.502x speedup, step: 10
Epoch 181/200 |loss: 9.528237| train set 1.997x speedup, test set 0.920x speedup, val set 1.000x speedup, step: 1
Epoch 182/200 |loss: 9.096289| train set 1.997x speedup, test set 0.920x speedup, val set 1.000x speedup, step: 1
Epoch 183/200 |loss: 8.906251| train set 2.021x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 2
Epoch 184/200 |loss: 8.818388| train set 2.022x speedup, test set 1.118x speedup, val set 1.000x speedup, step: 1
Epoch 185/200 |loss: 9.808230| train set 2.022x speedup, test set 1.109x speedup, val set 1.000x speedup, step: 1
Epoch 186/200 |loss: 8.641490| train set 1.978x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 2
Epoch 187/200 |loss: 10.092435| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 188/200 |loss: 7.897177| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 189/200 |loss: 9.158281| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 5
Epoch 190/200 |loss: 8.476574| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 6
Epoch 191/200 |loss: 9.532700| train set 2.022x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 192/200 |loss: 8.676782| train set 2.022x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 193/200 |loss: 9.273666| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 194/200 |loss: 8.913292| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 3
Epoch 195/200 |loss: 10.866088| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 196/200 |loss: 8.607868| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 197/200 |loss: 8.951902| train set 2.021x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 6
Epoch 198/200 |loss: 9.557171| train set 2.021x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 7
Epoch 199/200 |loss: 8.245673| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 8
Training per epoch cost 0.850 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
15, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
16, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
17, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
18, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
19, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
20, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 81, train speedup 2.022, test speedup 1.100, val speedup 0.502
best test speedup epoch: 5, train speedup 1.250, test speedup 1.759, val speedup 0.502
best validation speedup epoch: 192, train speedup 2.022, test speedup 1.103, val speedup 1.000
last model at epoch 199, train speedup 1.977, test speedup 1.121, val speedup 0.502
execution cost 0:07:03.236597
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.878540, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884075| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100778| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726250| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990707| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590581| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702864| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341873| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393396| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043757| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769526| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977993| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257028| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.923731| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.196878| train set 1.552x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.128195| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.802554| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 14.937109| train set 2.022x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 17
Epoch 17/200 |loss: 15.708284| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.007955| train set 1.997x speedup, test set 0.971x speedup, val set 1.000x speedup, step: 19
Epoch 19/200 |loss: 15.966930| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.489598| train set 1.856x speedup, test set 1.655x speedup, val set 1.000x speedup, step: 21
Epoch 21/200 |loss: 12.485871| train set 1.856x speedup, test set 0.982x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.332407| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.267329| train set 2.016x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 12.872548| train set 1.996x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 10.951145| train set 1.876x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.307001| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.416367| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 11.788730| train set 1.683x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.170655| train set 1.666x speedup, test set 0.923x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 11.571048| train set 1.941x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.790046| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 9.924610| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.434106| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.459287| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.085436| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 9.930511| train set 1.996x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 11.176071| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 12.849315| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 12.354110| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.339124| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 11.373076| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 10.881197| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 9.843223| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 11.909292| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 11.431262| train set 1.924x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 46
Epoch 46/200 |loss: 12.005757| train set 2.022x speedup, test set 1.100x speedup, val set 0.934x speedup, step: 47
Epoch 47/200 |loss: 9.666500| train set 1.997x speedup, test set 1.177x speedup, val set 0.502x speedup, step: 48
Epoch 48/200 |loss: 11.085622| train set 2.021x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 9.609902| train set 1.978x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 10.488307| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 10.061538| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 10.329996| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 11.031112| train set 1.819x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 9.951574| train set 1.856x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 10.318165| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 10.425027| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 9.854166| train set 1.924x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 9.254263| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 9.605545| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.198928| train set 1.995x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 10.064079| train set 1.995x speedup, test set 1.132x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.438308| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 10.185444| train set 1.978x speedup, test set 1.164x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 9.966656| train set 1.978x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.783241| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 10.734018| train set 2.022x speedup, test set 1.164x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 10.982178| train set 2.022x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 9.714101| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 8.864591| train set 1.838x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 9.640268| train set 1.876x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 11.055407| train set 1.876x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 9.553794| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.921181| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 11.159545| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 75
Epoch 75/200 |loss: 10.946249| train set 1.919x speedup, test set 1.141x speedup, val set 0.502x speedup, step: 76
Epoch 76/200 |loss: 11.132822| train set 1.997x speedup, test set 1.172x speedup, val set 1.000x speedup, step: 77
Epoch 77/200 |loss: 9.822629| train set 2.022x speedup, test set 1.162x speedup, val set 1.000x speedup, step: 78
Epoch 78/200 |loss: 10.384186| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 9.791580| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 11.231097| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 9.231874| train set 2.022x speedup, test set 1.141x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.700490| train set 2.022x speedup, test set 1.164x speedup, val set 1.000x speedup, step: 83
Epoch 83/200 |loss: 9.851633| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.284039| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.492319| train set 2.022x speedup, test set 1.100x speedup, val set 0.828x speedup, step: 86
Epoch 86/200 |loss: 9.600467| train set 2.022x speedup, test set 1.098x speedup, val set 1.000x speedup, step: 87
Epoch 87/200 |loss: 8.562336| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 8.917747| train set 2.022x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 10.114504| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 9.021236| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.250669| train set 1.978x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 92
Epoch 92/200 |loss: 8.717543| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 9.547233| train set 1.835x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.396907| train set 1.978x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 7.715490| train set 1.978x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 8.450684| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 97
Epoch 97/200 |loss: 8.746430| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.721582| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 99
Epoch 99/200 |loss: 11.354535| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 100
Epoch 100/200 |loss: 9.543546| train set 1.997x speedup, test set 1.164x speedup, val set 0.502x speedup, step: 1
Epoch 101/200 |loss: 8.871381| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 102/200 |loss: 8.922636| train set 1.994x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 103/200 |loss: 9.920363| train set 2.020x speedup, test set 1.126x speedup, val set 0.502x speedup, step: 1
Epoch 104/200 |loss: 9.838874| train set 2.021x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 1
Epoch 105/200 |loss: 9.861641| train set 1.978x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 1
Epoch 106/200 |loss: 10.657657| train set 2.022x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 1
Epoch 107/200 |loss: 9.077317| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 108/200 |loss: 11.184072| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 109/200 |loss: 9.043975| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 110/200 |loss: 10.032044| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 111/200 |loss: 9.716992| train set 1.976x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 112/200 |loss: 9.023145| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 113/200 |loss: 11.269600| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 114/200 |loss: 10.072600| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 115/200 |loss: 10.863440| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 116/200 |loss: 11.076039| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 117/200 |loss: 10.394449| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 118/200 |loss: 8.050803| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 119/200 |loss: 8.539087| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 1
Epoch 120/200 |loss: 8.560735| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 121/200 |loss: 9.646813| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 122/200 |loss: 9.368396| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 123/200 |loss: 10.589516| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 124/200 |loss: 8.336884| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 125/200 |loss: 8.961293| train set 1.996x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 126/200 |loss: 9.366988| train set 2.019x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 127/200 |loss: 9.455913| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 128/200 |loss: 8.645891| train set 2.020x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 129/200 |loss: 9.764617| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 130/200 |loss: 8.450986| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 131/200 |loss: 9.459685| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 132/200 |loss: 9.161762| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 133/200 |loss: 9.228992| train set 2.019x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 134/200 |loss: 9.995180| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 135/200 |loss: 9.674203| train set 1.997x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 136/200 |loss: 10.307732| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 137/200 |loss: 8.881899| train set 2.020x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 138/200 |loss: 8.355773| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 139/200 |loss: 8.259597| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 140/200 |loss: 8.398237| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 141/200 |loss: 10.265688| train set 2.022x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 1
Epoch 142/200 |loss: 8.207006| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 143/200 |loss: 9.003927| train set 1.978x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 144/200 |loss: 8.266051| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 145/200 |loss: 9.808414| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 146/200 |loss: 8.212216| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 147/200 |loss: 9.641988| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 148/200 |loss: 8.508850| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 149/200 |loss: 9.423573| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 150/200 |loss: 8.183772| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 151/200 |loss: 9.362929| train set 2.021x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 152/200 |loss: 8.354907| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 153/200 |loss: 7.432344| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 154/200 |loss: 8.478171| train set 1.978x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 155/200 |loss: 7.580809| train set 1.954x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 156/200 |loss: 7.813072| train set 1.954x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 157/200 |loss: 8.960572| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 158/200 |loss: 10.308688| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 159/200 |loss: 10.573278| train set 2.022x speedup, test set 2.077x speedup, val set 0.502x speedup, step: 1
Epoch 160/200 |loss: 9.505049| train set 2.022x speedup, test set 2.100x speedup, val set 0.502x speedup, step: 1
Epoch 161/200 |loss: 10.009090| train set 2.022x speedup, test set 1.148x speedup, val set 0.502x speedup, step: 1
Epoch 162/200 |loss: 11.534810| train set 2.022x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 163/200 |loss: 9.811142| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 164/200 |loss: 11.070724| train set 1.835x speedup, test set 2.063x speedup, val set 0.502x speedup, step: 3
Epoch 165/200 |loss: 13.384393| train set 1.835x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 4
Epoch 166/200 |loss: 8.699763| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 167/200 |loss: 9.999543| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 6
Epoch 168/200 |loss: 9.525014| train set 2.022x speedup, test set 1.100x speedup, val set 1.000x speedup, step: 1
Epoch 169/200 |loss: 10.516567| train set 1.997x speedup, test set 1.098x speedup, val set 1.000x speedup, step: 1
Epoch 170/200 |loss: 10.586227| train set 1.997x speedup, test set 1.098x speedup, val set 1.000x speedup, step: 1
Epoch 171/200 |loss: 8.719869| train set 1.955x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 2
Epoch 172/200 |loss: 8.343450| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 173/200 |loss: 9.830209| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 4
Epoch 174/200 |loss: 9.037206| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 5
Epoch 175/200 |loss: 9.309837| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 6
Epoch 176/200 |loss: 10.464303| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 7
Epoch 177/200 |loss: 9.143532| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 8
Epoch 178/200 |loss: 7.675550| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 9
Epoch 179/200 |loss: 9.645635| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 10
Epoch 180/200 |loss: 8.874846| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 181/200 |loss: 9.733005| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 12
Epoch 182/200 |loss: 8.932298| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 13
Epoch 183/200 |loss: 9.037961| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 14
Epoch 184/200 |loss: 8.752837| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 15
Epoch 185/200 |loss: 9.852601| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 16
Epoch 186/200 |loss: 8.709641| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 17
Epoch 187/200 |loss: 10.368790| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 18
Epoch 188/200 |loss: 7.946226| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 19
Epoch 189/200 |loss: 9.408437| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 20
Epoch 190/200 |loss: 8.635494| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 21
Epoch 191/200 |loss: 9.629750| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 22
Epoch 192/200 |loss: 8.654319| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 23
Epoch 193/200 |loss: 9.319826| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 24
Epoch 194/200 |loss: 9.148294| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 25
Epoch 195/200 |loss: 10.998684| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 26
Epoch 196/200 |loss: 8.445445| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 27
Epoch 197/200 |loss: 9.115586| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 28
Epoch 198/200 |loss: 9.482380| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 29
Epoch 199/200 |loss: 8.194495| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 30
Training per epoch cost 0.862 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 162.273s, pg runtime 148.707s, speedup 0.916x
12, opt runtime 48.784s, model runtime 166.153s, pg runtime 78.349s, speedup 0.472x
13, opt runtime 53.440s, model runtime 159.318s, pg runtime 140.742s, speedup 0.883x
14, opt runtime 47.812s, model runtime 160.525s, pg runtime 83.069s, speedup 0.517x
15, opt runtime 47.518s, model runtime 159.536s, pg runtime 75.736s, speedup 0.475x
16, opt runtime 48.067s, model runtime 159.772s, pg runtime 81.014s, speedup 0.507x
17, opt runtime 47.738s, model runtime 162.027s, pg runtime 76.021s, speedup 0.469x
18, opt runtime 47.804s, model runtime 161.759s, pg runtime 81.177s, speedup 0.502x
19, opt runtime 49.511s, model runtime 179.218s, pg runtime 87.329s, speedup 0.487x
20, opt runtime 51.276s, model runtime 161.291s, pg runtime 79.222s, speedup 0.491x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 43, train speedup 2.022, test speedup 1.162, val speedup 0.502
best test speedup epoch: 160, train speedup 2.022, test speedup 2.100, val speedup 0.502
best validation speedup epoch: 170, train speedup 1.997, test speedup 1.098, val speedup 1.000
last model at epoch 199, train speedup 1.978, test speedup 1.121, val speedup 0.502
execution cost 0:07:09.310205
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.781920, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884075| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100779| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726250| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990707| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590582| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702866| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341876| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393397| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043760| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769527| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977996| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257028| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.923732| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.196878| train set 1.552x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.128192| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.802547| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 14.939142| train set 2.022x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 17
Epoch 17/200 |loss: 15.712020| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.028694| train set 1.997x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 19
Epoch 19/200 |loss: 15.958836| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.551320| train set 1.856x speedup, test set 1.640x speedup, val set 1.000x speedup, step: 21
Epoch 21/200 |loss: 12.484365| train set 1.835x speedup, test set 1.669x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.394194| train set 2.021x speedup, test set 0.927x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.329413| train set 2.016x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 12.929153| train set 1.991x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 10.901907| train set 2.021x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.014289| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.323870| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 11.606066| train set 1.683x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.147190| train set 1.666x speedup, test set 0.928x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 11.485098| train set 1.901x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.848128| train set 1.941x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 10.102452| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.497286| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.539482| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.065845| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 10.008017| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 10.863419| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 12.748168| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 11.641963| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.187267| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 11.227753| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 10.721492| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 9.765271| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 11.730207| train set 1.996x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 11.335780| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 46
Epoch 46/200 |loss: 12.461405| train set 2.022x speedup, test set 1.100x speedup, val set 1.000x speedup, step: 47
Epoch 47/200 |loss: 9.600566| train set 1.997x speedup, test set 1.177x speedup, val set 0.502x speedup, step: 48
Epoch 48/200 |loss: 11.059655| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 9.872025| train set 1.978x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 10.731292| train set 2.022x speedup, test set 1.169x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 10.015220| train set 2.022x speedup, test set 1.164x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 10.414823| train set 2.022x speedup, test set 1.164x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 11.202861| train set 1.856x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 9.910691| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 10.608198| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 10.571749| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 9.819411| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 9.523698| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 9.453053| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.154744| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 9.973250| train set 1.995x speedup, test set 0.964x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.301170| train set 1.997x speedup, test set 0.980x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 9.808769| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 9.856922| train set 1.978x speedup, test set 1.106x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.500553| train set 2.022x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 10.628575| train set 2.022x speedup, test set 0.980x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 11.019939| train set 2.022x speedup, test set 0.964x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 10.310068| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 8.508327| train set 1.876x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 9.437002| train set 1.876x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 10.648593| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 9.404541| train set 1.954x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.482899| train set 1.997x speedup, test set 0.944x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 10.662398| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 75
Epoch 75/200 |loss: 10.937402| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 76
Epoch 76/200 |loss: 10.261194| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 77
Epoch 77/200 |loss: 9.415361| train set 2.022x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 78
Epoch 78/200 |loss: 10.226216| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 9.696959| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 10.754002| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 9.050947| train set 2.019x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.265630| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 83
Epoch 83/200 |loss: 9.435324| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.166061| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.282567| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 86
Epoch 86/200 |loss: 9.092183| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 87
Epoch 87/200 |loss: 8.367870| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 9.222508| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 10.389131| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 9.281099| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.990252| train set 1.923x speedup, test set 1.109x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 8.636273| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 9.804507| train set 1.835x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.275769| train set 1.954x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 95
Epoch 95/200 |loss: 8.029965| train set 1.954x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 96
Epoch 96/200 |loss: 8.427428| train set 1.954x speedup, test set 1.164x speedup, val set 0.502x speedup, step: 97
Epoch 97/200 |loss: 8.767903| train set 1.978x speedup, test set 0.964x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.278176| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 99
Epoch 99/200 |loss: 11.148391| train set 2.022x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 100
Epoch 100/200 |loss: 9.845263| train set 1.997x speedup, test set 1.164x speedup, val set 0.502x speedup, step: 1
Epoch 101/200 |loss: 9.069902| train set 1.997x speedup, test set 1.124x speedup, val set 0.502x speedup, step: 1
Epoch 102/200 |loss: 8.753903| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 103/200 |loss: 10.205481| train set 1.996x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 1
Epoch 104/200 |loss: 10.053381| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 1
Epoch 105/200 |loss: 9.903103| train set 1.978x speedup, test set 1.126x speedup, val set 0.502x speedup, step: 1
Epoch 106/200 |loss: 10.674953| train set 1.978x speedup, test set 1.132x speedup, val set 0.502x speedup, step: 1
Epoch 107/200 |loss: 8.817513| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 108/200 |loss: 11.760713| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 109/200 |loss: 9.107307| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 110/200 |loss: 10.169261| train set 2.022x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 1
Epoch 111/200 |loss: 9.794253| train set 2.022x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 1
Epoch 112/200 |loss: 9.158535| train set 1.978x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 1
Epoch 113/200 |loss: 11.852503| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 114/200 |loss: 9.946162| train set 2.022x speedup, test set 2.183x speedup, val set 0.502x speedup, step: 1
Epoch 115/200 |loss: 10.949157| train set 2.019x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 116/200 |loss: 11.191750| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 117/200 |loss: 10.611917| train set 1.856x speedup, test set 1.126x speedup, val set 0.502x speedup, step: 1
Epoch 118/200 |loss: 8.215955| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 119/200 |loss: 8.641378| train set 2.022x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 120/200 |loss: 8.580466| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 121/200 |loss: 9.773201| train set 2.021x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 3
Epoch 122/200 |loss: 9.232328| train set 2.021x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 4
Epoch 123/200 |loss: 10.736793| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 5
Epoch 124/200 |loss: 8.423573| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 6
Epoch 125/200 |loss: 9.281777| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 7
Epoch 126/200 |loss: 9.578292| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 8
Epoch 127/200 |loss: 9.983572| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 9
Epoch 128/200 |loss: 9.075985| train set 2.020x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 10
Epoch 129/200 |loss: 9.696151| train set 2.021x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 11
Epoch 130/200 |loss: 8.410186| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 12
Epoch 131/200 |loss: 9.395122| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 13
Epoch 132/200 |loss: 9.297294| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 14
Epoch 133/200 |loss: 9.329156| train set 1.997x speedup, test set 1.142x speedup, val set 0.502x speedup, step: 15
Epoch 134/200 |loss: 10.057894| train set 2.019x speedup, test set 1.126x speedup, val set 0.502x speedup, step: 16
Epoch 135/200 |loss: 9.680988| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 17
Epoch 136/200 |loss: 10.369757| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 18
Epoch 137/200 |loss: 8.840646| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 19
Epoch 138/200 |loss: 8.405022| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 20
Epoch 139/200 |loss: 8.419192| train set 2.021x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 21
Epoch 140/200 |loss: 8.329313| train set 2.022x speedup, test set 0.980x speedup, val set 0.502x speedup, step: 22
Epoch 141/200 |loss: 10.330878| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 23
Epoch 142/200 |loss: 7.963246| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 24
Epoch 143/200 |loss: 8.620264| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 25
Epoch 144/200 |loss: 7.838975| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 26
Epoch 145/200 |loss: 9.628791| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 27
Epoch 146/200 |loss: 8.027025| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 28
Epoch 147/200 |loss: 9.339158| train set 2.021x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 29
Epoch 148/200 |loss: 8.510509| train set 2.022x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 30
Epoch 149/200 |loss: 9.208763| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 31
Epoch 150/200 |loss: 8.184993| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 32
Epoch 151/200 |loss: 9.186403| train set 2.021x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 33
Epoch 152/200 |loss: 8.187740| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 34
Epoch 153/200 |loss: 7.439090| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 35
Epoch 154/200 |loss: 8.392920| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 36
Epoch 155/200 |loss: 7.555535| train set 1.954x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 37
Epoch 156/200 |loss: 7.799377| train set 1.954x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 38
Epoch 157/200 |loss: 9.007162| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 39
Epoch 158/200 |loss: 10.242553| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 40
Epoch 159/200 |loss: 10.293877| train set 2.022x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 41
Epoch 160/200 |loss: 9.491248| train set 2.022x speedup, test set 1.148x speedup, val set 0.502x speedup, step: 42
Epoch 161/200 |loss: 9.713995| train set 1.997x speedup, test set 1.132x speedup, val set 0.502x speedup, step: 43
Epoch 162/200 |loss: 11.335538| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 44
Epoch 163/200 |loss: 9.682849| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 45
Epoch 164/200 |loss: 10.333417| train set 1.835x speedup, test set 1.132x speedup, val set 0.502x speedup, step: 46
Epoch 165/200 |loss: 10.837722| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 47
Epoch 166/200 |loss: 7.779493| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 48
Epoch 167/200 |loss: 9.962296| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 49
Epoch 168/200 |loss: 8.355917| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 50
Epoch 169/200 |loss: 10.774084| train set 2.006x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 51
Epoch 170/200 |loss: 9.592856| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 52
Epoch 171/200 |loss: 8.955779| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 53
Epoch 172/200 |loss: 8.533538| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 54
Epoch 173/200 |loss: 9.579789| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 55
Epoch 174/200 |loss: 8.956539| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 56
Epoch 175/200 |loss: 9.181359| train set 1.976x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 57
Epoch 176/200 |loss: 10.541283| train set 1.995x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 58
Epoch 177/200 |loss: 9.571791| train set 1.995x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 59
Epoch 178/200 |loss: 7.826977| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 60
Epoch 179/200 |loss: 9.623510| train set 1.976x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 61
Epoch 180/200 |loss: 9.077558| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 62
Epoch 181/200 |loss: 9.561754| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 63
Epoch 182/200 |loss: 9.289804| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 64
Epoch 183/200 |loss: 9.154995| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 65
Epoch 184/200 |loss: 8.982817| train set 2.022x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 185/200 |loss: 10.103145| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 2
Epoch 186/200 |loss: 8.935758| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 3
Epoch 187/200 |loss: 10.679414| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 188/200 |loss: 8.006629| train set 1.974x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 189/200 |loss: 9.759369| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 6
Epoch 190/200 |loss: 8.650889| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 7
Epoch 191/200 |loss: 10.173310| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 8
Epoch 192/200 |loss: 8.750538| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 9
Epoch 193/200 |loss: 9.337672| train set 1.997x speedup, test set 1.116x speedup, val set 0.911x speedup, step: 10
Epoch 194/200 |loss: 9.050712| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 195/200 |loss: 11.451828| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 12
Epoch 196/200 |loss: 8.550365| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 13
Epoch 197/200 |loss: 9.441762| train set 2.021x speedup, test set 2.143x speedup, val set 0.502x speedup, step: 14
Epoch 198/200 |loss: 9.773145| train set 2.021x speedup, test set 2.125x speedup, val set 0.502x speedup, step: 15
Epoch 199/200 |loss: 8.264880| train set 2.021x speedup, test set 2.143x speedup, val set 0.502x speedup, step: 16
Training per epoch cost 0.983 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 36, train speedup 2.022, test speedup 1.098, val speedup 0.502
best test speedup epoch: 114, train speedup 2.022, test speedup 2.183, val speedup 0.502
best validation speedup epoch: 184, train speedup 2.022, test speedup 1.121, val speedup 1.000
last model at epoch 199, train speedup 2.021, test speedup 2.143, val speedup 0.502
execution cost 0:08:14.404186
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.581922, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884077| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100779| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726250| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990705| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590579| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702860| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341864| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393381| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043756| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769523| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977973| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257070| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.923563| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.204376| train set 1.666x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.122080| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.824039| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 14.979257| train set 2.022x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 17
Epoch 17/200 |loss: 15.685911| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.003647| train set 2.022x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 19
Epoch 19/200 |loss: 15.935148| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.535859| train set 1.856x speedup, test set 0.928x speedup, val set 0.502x speedup, step: 21
Epoch 21/200 |loss: 12.400322| train set 1.835x speedup, test set 0.928x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.355171| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.145962| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 12.757165| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 10.553881| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.041953| train set 1.977x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.565377| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 11.835711| train set 1.996x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.378722| train set 1.854x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 11.567960| train set 1.941x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.677516| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 10.028045| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.759057| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.719507| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.474558| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 9.746618| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 10.843811| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 13.179232| train set 1.996x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 12.413689| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.403876| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 11.443291| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 10.871221| train set 1.954x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 10.042072| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 12.305956| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 11.667189| train set 1.965x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 46
Epoch 46/200 |loss: 11.799039| train set 2.022x speedup, test set 1.098x speedup, val set 0.911x speedup, step: 47
Epoch 47/200 |loss: 10.296326| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 48
Epoch 48/200 |loss: 10.848341| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 9.970540| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 10.793729| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 10.343216| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 10.587428| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 11.546616| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 9.971593| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 10.811810| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 10.682608| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 9.936972| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 9.402180| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 9.596634| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.545915| train set 2.022x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 10.044278| train set 2.020x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.541506| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 10.058372| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 10.028426| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.486510| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 10.776495| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 11.235283| train set 2.022x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 10.047908| train set 2.022x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 8.661868| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 9.644310| train set 1.854x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 10.644439| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 9.417907| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.608884| train set 1.997x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 10.696602| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 75
Epoch 75/200 |loss: 10.639446| train set 1.964x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 76
Epoch 76/200 |loss: 11.021107| train set 2.022x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 77
Epoch 77/200 |loss: 9.312092| train set 2.014x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 78
Epoch 78/200 |loss: 10.274974| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 9.446554| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 11.174274| train set 2.019x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 8.931963| train set 1.853x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.835626| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 83
Epoch 83/200 |loss: 9.516537| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.177279| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.319217| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 86
Epoch 86/200 |loss: 9.283221| train set 1.963x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 87
Epoch 87/200 |loss: 8.167825| train set 1.978x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 9.173082| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 10.713493| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 8.954401| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.667141| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 92
Epoch 92/200 |loss: 8.584916| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 9.820225| train set 1.835x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.495998| train set 1.955x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 95
Epoch 95/200 |loss: 8.052724| train set 1.955x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 96
Epoch 96/200 |loss: 8.351096| train set 1.954x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 97
Epoch 97/200 |loss: 8.736865| train set 1.876x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.674829| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 99
Epoch 99/200 |loss: 11.277050| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 100
Epoch 100/200 |loss: 9.590243| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 101/200 |loss: 8.863181| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 102/200 |loss: 8.619164| train set 1.995x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 103/200 |loss: 9.698427| train set 1.995x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 104/200 |loss: 9.679953| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 105/200 |loss: 9.651331| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 106/200 |loss: 10.511191| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 107/200 |loss: 8.811613| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 108/200 |loss: 11.531251| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 109/200 |loss: 9.106476| train set 1.997x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 110/200 |loss: 10.066314| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 111/200 |loss: 9.929925| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 112/200 |loss: 9.306065| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 1
Epoch 113/200 |loss: 11.561131| train set 2.022x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 1
Epoch 114/200 |loss: 10.725558| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 115/200 |loss: 10.992636| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 116/200 |loss: 11.369715| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 117/200 |loss: 10.434281| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 118/200 |loss: 8.147334| train set 1.856x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 119/200 |loss: 8.719607| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 120/200 |loss: 8.669217| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 121/200 |loss: 9.535362| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 122/200 |loss: 9.374264| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 123/200 |loss: 10.636242| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 124/200 |loss: 8.189419| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 125/200 |loss: 8.939666| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 126/200 |loss: 9.201623| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 127/200 |loss: 9.442595| train set 2.019x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 128/200 |loss: 8.426548| train set 2.021x speedup, test set 1.109x speedup, val set 0.911x speedup, step: 1
Epoch 129/200 |loss: 9.787527| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 130/200 |loss: 8.384964| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 131/200 |loss: 9.570902| train set 2.022x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 4
Epoch 132/200 |loss: 9.023538| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 5
Epoch 133/200 |loss: 9.516750| train set 1.997x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 6
Epoch 134/200 |loss: 9.928852| train set 1.997x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 7
Epoch 135/200 |loss: 9.711854| train set 1.996x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 8
Epoch 136/200 |loss: 10.288255| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 9
Epoch 137/200 |loss: 8.857817| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 10
Epoch 138/200 |loss: 8.476480| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 139/200 |loss: 8.406555| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 12
Epoch 140/200 |loss: 8.382081| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 13
Epoch 141/200 |loss: 10.160963| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 14
Epoch 142/200 |loss: 8.081347| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 15
Epoch 143/200 |loss: 8.764311| train set 1.978x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 16
Epoch 144/200 |loss: 8.184383| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 17
Epoch 145/200 |loss: 10.044902| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 18
Epoch 146/200 |loss: 8.096318| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 19
Epoch 147/200 |loss: 9.717883| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 20
Epoch 148/200 |loss: 8.499357| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 21
Epoch 149/200 |loss: 9.338508| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 22
Epoch 150/200 |loss: 8.374972| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 23
Epoch 151/200 |loss: 9.576306| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 24
Epoch 152/200 |loss: 8.591785| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 25
Epoch 153/200 |loss: 7.519692| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 26
Epoch 154/200 |loss: 8.700080| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 27
Epoch 155/200 |loss: 7.778095| train set 1.954x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 28
Epoch 156/200 |loss: 8.021888| train set 1.978x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 29
Epoch 157/200 |loss: 8.955598| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 30
Epoch 158/200 |loss: 10.425421| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 31
Epoch 159/200 |loss: 10.655868| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 32
Epoch 160/200 |loss: 9.334048| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 33
Epoch 161/200 |loss: 9.484841| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 34
Epoch 162/200 |loss: 10.895164| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 35
Epoch 163/200 |loss: 9.483730| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 36
Epoch 164/200 |loss: 10.156853| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 37
Epoch 165/200 |loss: 10.107516| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 38
Epoch 166/200 |loss: 7.762445| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 39
Epoch 167/200 |loss: 9.220382| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 40
Epoch 168/200 |loss: 8.503624| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 41
Epoch 169/200 |loss: 9.741639| train set 1.997x speedup, test set 1.109x speedup, val set 0.911x speedup, step: 1
Epoch 170/200 |loss: 9.530206| train set 1.955x speedup, test set 1.118x speedup, val set 0.911x speedup, step: 1
Epoch 171/200 |loss: 8.456633| train set 1.955x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 2
Epoch 172/200 |loss: 8.327763| train set 1.838x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 3
Epoch 173/200 |loss: 9.246198| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 4
Epoch 174/200 |loss: 9.092446| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 5
Epoch 175/200 |loss: 9.192578| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 6
Epoch 176/200 |loss: 10.234643| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 7
Epoch 177/200 |loss: 9.127576| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 8
Epoch 178/200 |loss: 7.702331| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 9
Epoch 179/200 |loss: 9.647130| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 10
Epoch 180/200 |loss: 8.967461| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 181/200 |loss: 9.691513| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 12
Epoch 182/200 |loss: 8.954145| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 13
Epoch 183/200 |loss: 8.813437| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 14
Epoch 184/200 |loss: 8.791579| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 15
Epoch 185/200 |loss: 9.570848| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 16
Epoch 186/200 |loss: 8.778153| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 17
Epoch 187/200 |loss: 10.029523| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 18
Epoch 188/200 |loss: 7.946199| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 19
Epoch 189/200 |loss: 9.398346| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 20
Epoch 190/200 |loss: 8.566482| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 21
Epoch 191/200 |loss: 9.671083| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 22
Epoch 192/200 |loss: 8.484329| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 23
Epoch 193/200 |loss: 9.561006| train set 2.021x speedup, test set 1.121x speedup, val set 0.911x speedup, step: 1
Epoch 194/200 |loss: 9.523494| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 195/200 |loss: 11.145124| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 196/200 |loss: 8.457982| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 197/200 |loss: 9.079416| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 198/200 |loss: 9.659888| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 6
Epoch 199/200 |loss: 8.206114| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 7
Training per epoch cost 0.973 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 51, train speedup 2.022, test speedup 1.098, val speedup 0.502
best test speedup epoch: 5, train speedup 1.250, test speedup 1.759, val speedup 0.502
best validation speedup epoch: 193, train speedup 2.021, test speedup 1.121, val speedup 0.911
last model at epoch 199, train speedup 1.977, test speedup 1.121, val speedup 0.502
execution cost 0:08:07.464823
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.625261, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884075| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100779| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726250| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990708| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590584| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702868| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341884| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393414| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043765| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769519| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977856| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257068| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.924334| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.190133| train set 1.552x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.136445| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.843293| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 15.000545| train set 2.022x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 17
Epoch 17/200 |loss: 15.615240| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.092731| train set 1.997x speedup, test set 0.968x speedup, val set 0.502x speedup, step: 19
Epoch 19/200 |loss: 16.070160| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.719875| train set 2.022x speedup, test set 1.640x speedup, val set 1.000x speedup, step: 21
Epoch 21/200 |loss: 12.186854| train set 1.856x speedup, test set 1.669x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.608552| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.295649| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 13.200987| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 10.854718| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.497602| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.499277| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 12.047401| train set 1.683x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.288446| train set 1.566x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 11.917840| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.781777| train set 1.941x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 10.119541| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.678436| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.468202| train set 1.856x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.387721| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 9.845042| train set 2.021x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 10.798505| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 12.589505| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 11.494228| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.088170| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 10.780977| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 10.574122| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 9.672477| train set 1.997x speedup, test set 1.114x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 11.525762| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 10.867140| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 46
Epoch 46/200 |loss: 12.328260| train set 2.022x speedup, test set 1.098x speedup, val set 0.911x speedup, step: 47
Epoch 47/200 |loss: 9.687580| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 48
Epoch 48/200 |loss: 10.639047| train set 1.901x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 9.564038| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 10.220996| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 9.577909| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 10.031557| train set 1.856x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 11.526299| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 10.027690| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 11.376384| train set 1.849x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 11.251839| train set 1.964x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 10.249771| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 9.891359| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 10.009543| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.692831| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 10.468738| train set 1.997x speedup, test set 1.148x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.533656| train set 1.997x speedup, test set 1.126x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 10.138045| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 9.866568| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.416639| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 10.554343| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 10.566757| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 10.410293| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 8.870536| train set 1.876x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 9.202538| train set 1.876x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 10.001700| train set 1.954x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 9.454045| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.484926| train set 1.997x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 10.097604| train set 1.942x speedup, test set 0.948x speedup, val set 0.911x speedup, step: 75
Epoch 75/200 |loss: 10.852115| train set 1.997x speedup, test set 0.963x speedup, val set 0.502x speedup, step: 76
Epoch 76/200 |loss: 10.129877| train set 2.022x speedup, test set 0.928x speedup, val set 0.502x speedup, step: 77
Epoch 77/200 |loss: 8.978961| train set 1.978x speedup, test set 0.925x speedup, val set 1.000x speedup, step: 78
Epoch 78/200 |loss: 10.238506| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 10.278610| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 10.923985| train set 1.819x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 9.620987| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.420271| train set 2.022x speedup, test set 0.932x speedup, val set 0.911x speedup, step: 83
Epoch 83/200 |loss: 9.763293| train set 1.978x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.382268| train set 1.976x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.152494| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 86
Epoch 86/200 |loss: 9.322229| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 87
Epoch 87/200 |loss: 8.600036| train set 1.978x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 8.925894| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 10.184871| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 9.167022| train set 1.978x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.658370| train set 2.022x speedup, test set 0.935x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 8.891550| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 10.179452| train set 1.835x speedup, test set 0.926x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.416203| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 95
Epoch 95/200 |loss: 7.986310| train set 1.978x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 8.208762| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 97
Epoch 97/200 |loss: 8.882821| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.201590| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 99
Epoch 99/200 |loss: 11.255282| train set 1.997x speedup, test set 0.920x speedup, val set 0.911x speedup, step: 100
Epoch 100/200 |loss: 9.904863| train set 1.997x speedup, test set 1.100x speedup, val set 0.502x speedup, step: 101
Epoch 101/200 |loss: 8.804077| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 102
Epoch 102/200 |loss: 8.842105| train set 1.997x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 103
Epoch 103/200 |loss: 9.983128| train set 1.996x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 104
Epoch 104/200 |loss: 9.601307| train set 1.954x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 105
Epoch 105/200 |loss: 10.035680| train set 1.954x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 106
Epoch 106/200 |loss: 10.397772| train set 2.022x speedup, test set 1.109x speedup, val set 1.000x speedup, step: 1
Epoch 107/200 |loss: 8.869128| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 108/200 |loss: 11.706568| train set 1.975x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 109/200 |loss: 9.248291| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 110/200 |loss: 10.066607| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 5
Epoch 111/200 |loss: 9.959901| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 6
Epoch 112/200 |loss: 9.165364| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 7
Epoch 113/200 |loss: 11.441266| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 8
Epoch 114/200 |loss: 10.440242| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 9
Epoch 115/200 |loss: 10.776410| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 10
Epoch 116/200 |loss: 11.593242| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 117/200 |loss: 10.493667| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 12
Epoch 118/200 |loss: 7.937238| train set 1.856x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 13
Epoch 119/200 |loss: 8.755037| train set 2.022x speedup, test set 0.935x speedup, val set 1.000x speedup, step: 1
Epoch 120/200 |loss: 8.450912| train set 2.022x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 121/200 |loss: 9.688863| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 2
Epoch 122/200 |loss: 9.219569| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 3
Epoch 123/200 |loss: 10.438532| train set 2.022x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 4
Epoch 124/200 |loss: 8.371113| train set 2.022x speedup, test set 0.939x speedup, val set 0.502x speedup, step: 5
Epoch 125/200 |loss: 9.063066| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 6
Epoch 126/200 |loss: 9.026996| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 7
Epoch 127/200 |loss: 9.776724| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 8
Epoch 128/200 |loss: 8.467939| train set 2.021x speedup, test set 1.103x speedup, val set 0.911x speedup, step: 9
Epoch 129/200 |loss: 9.887871| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 10
Epoch 130/200 |loss: 8.451725| train set 1.978x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 11
Epoch 131/200 |loss: 9.681481| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 12
Epoch 132/200 |loss: 8.984379| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 13
Epoch 133/200 |loss: 9.457721| train set 1.997x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 14
Epoch 134/200 |loss: 9.935825| train set 1.997x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 15
Epoch 135/200 |loss: 9.626747| train set 1.997x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 16
Epoch 136/200 |loss: 10.556606| train set 2.022x speedup, test set 1.109x speedup, val set 0.834x speedup, step: 17
Epoch 137/200 |loss: 8.717366| train set 2.022x speedup, test set 1.103x speedup, val set 0.911x speedup, step: 18
Epoch 138/200 |loss: 8.454446| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 19
Epoch 139/200 |loss: 8.280002| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 20
Epoch 140/200 |loss: 8.418141| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 21
Epoch 141/200 |loss: 10.283800| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 22
Epoch 142/200 |loss: 8.026681| train set 1.978x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 23
Epoch 143/200 |loss: 8.765541| train set 1.978x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 24
Epoch 144/200 |loss: 8.153415| train set 1.978x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 25
Epoch 145/200 |loss: 10.115531| train set 2.022x speedup, test set 0.944x speedup, val set 0.502x speedup, step: 26
Epoch 146/200 |loss: 8.183596| train set 2.021x speedup, test set 1.121x speedup, val set 0.934x speedup, step: 27
Epoch 147/200 |loss: 9.748935| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 28
Epoch 148/200 |loss: 8.549716| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 29
Epoch 149/200 |loss: 9.233074| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 30
Epoch 150/200 |loss: 8.146286| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 31
Epoch 151/200 |loss: 9.251525| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 32
Epoch 152/200 |loss: 8.277977| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 33
Epoch 153/200 |loss: 7.524376| train set 1.978x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 34
Epoch 154/200 |loss: 8.497641| train set 1.978x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 155/200 |loss: 7.632278| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 156/200 |loss: 7.907517| train set 2.022x speedup, test set 0.925x speedup, val set 0.502x speedup, step: 3
Epoch 157/200 |loss: 9.220729| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4
Epoch 158/200 |loss: 10.371125| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5
Epoch 159/200 |loss: 10.817281| train set 2.022x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 6
Epoch 160/200 |loss: 9.311738| train set 2.022x speedup, test set 0.964x speedup, val set 0.502x speedup, step: 7
Epoch 161/200 |loss: 9.641395| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 8
Epoch 162/200 |loss: 10.883398| train set 2.022x speedup, test set 0.948x speedup, val set 1.000x speedup, step: 1
Epoch 163/200 |loss: 9.672050| train set 2.022x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 2
Epoch 164/200 |loss: 10.391222| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3
Epoch 165/200 |loss: 10.719585| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4
Epoch 166/200 |loss: 8.198995| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 5
Epoch 167/200 |loss: 10.471310| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 6
Epoch 168/200 |loss: 9.182377| train set 1.978x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 169/200 |loss: 10.606264| train set 2.022x speedup, test set 1.103x speedup, val set 1.000x speedup, step: 1
Epoch 170/200 |loss: 9.930292| train set 1.997x speedup, test set 0.932x speedup, val set 1.000x speedup, step: 1
Epoch 171/200 |loss: 8.839738| train set 2.022x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 2
Epoch 172/200 |loss: 8.489007| train set 1.978x speedup, test set 0.935x speedup, val set 0.502x speedup, step: 3
Epoch 173/200 |loss: 9.584303| train set 1.978x speedup, test set 0.944x speedup, val set 0.502x speedup, step: 4
Epoch 174/200 |loss: 9.211774| train set 1.978x speedup, test set 0.929x speedup, val set 1.000x speedup, step: 1
Epoch 175/200 |loss: 9.123029| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 2
Epoch 176/200 |loss: 10.459064| train set 1.997x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 3
Epoch 177/200 |loss: 9.040673| train set 1.997x speedup, test set 0.925x speedup, val set 0.502x speedup, step: 4
Epoch 178/200 |loss: 7.796278| train set 1.995x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5
Epoch 179/200 |loss: 9.621967| train set 1.995x speedup, test set 0.933x speedup, val set 1.000x speedup, step: 1
Epoch 180/200 |loss: 8.933654| train set 2.022x speedup, test set 0.933x speedup, val set 1.000x speedup, step: 1
Epoch 181/200 |loss: 9.667580| train set 2.022x speedup, test set 0.926x speedup, val set 1.000x speedup, step: 1
Epoch 182/200 |loss: 9.212583| train set 1.997x speedup, test set 0.920x speedup, val set 1.000x speedup, step: 1
Epoch 183/200 |loss: 9.019675| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 2
Epoch 184/200 |loss: 8.732841| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3
Epoch 185/200 |loss: 10.198502| train set 2.022x speedup, test set 0.933x speedup, val set 1.000x speedup, step: 1
Epoch 186/200 |loss: 8.839780| train set 2.022x speedup, test set 1.166x speedup, val set 1.000x speedup, step: 1
Epoch 187/200 |loss: 10.939165| train set 2.022x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 188/200 |loss: 8.276665| train set 1.975x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 189/200 |loss: 9.527463| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 190/200 |loss: 8.841465| train set 2.021x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 3
Epoch 191/200 |loss: 9.525737| train set 2.021x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 4
Epoch 192/200 |loss: 8.684947| train set 2.022x speedup, test set 1.109x speedup, val set 1.000x speedup, step: 1
Epoch 193/200 |loss: 9.274920| train set 2.022x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 194/200 |loss: 9.117424| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 195/200 |loss: 11.006345| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 196/200 |loss: 8.589520| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 197/200 |loss: 9.137233| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 198/200 |loss: 9.608906| train set 2.021x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 6
Epoch 199/200 |loss: 8.154672| train set 2.021x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Training per epoch cost 0.859 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 46, train speedup 2.022, test speedup 1.098, val speedup 0.911
best test speedup epoch: 5, train speedup 1.250, test speedup 1.759, val speedup 0.502
best validation speedup epoch: 199, train speedup 2.021, test speedup 1.121, val speedup 1.000
last model at epoch 199, train speedup 2.021, test speedup 1.121, val speedup 1.000
execution cost 0:07:06.890186
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.670024, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 25.884075| train set 1.049x speedup, test set 0.915x speedup, val set 0.502x speedup, step: 1
Epoch 1/200 |loss: 25.100779| train set 0.874x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 2
Epoch 2/200 |loss: 22.726250| train set 0.875x speedup, test set 1.136x speedup, val set 0.502x speedup, step: 3
Epoch 3/200 |loss: 19.990706| train set 1.366x speedup, test set 1.649x speedup, val set 1.000x speedup, step: 4
Epoch 4/200 |loss: 20.590582| train set 1.457x speedup, test set 1.649x speedup, val set 0.502x speedup, step: 5
Epoch 5/200 |loss: 20.702864| train set 1.250x speedup, test set 1.759x speedup, val set 0.502x speedup, step: 6
Epoch 6/200 |loss: 19.341873| train set 1.184x speedup, test set 1.756x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 20.393394| train set 1.264x speedup, test set 1.659x speedup, val set 1.000x speedup, step: 8
Epoch 8/200 |loss: 18.043757| train set 1.236x speedup, test set 1.669x speedup, val set 1.000x speedup, step: 9
Epoch 9/200 |loss: 17.769526| train set 1.439x speedup, test set 1.685x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 14.977993| train set 1.383x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 11
Epoch 11/200 |loss: 16.257027| train set 1.385x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 12
Epoch 12/200 |loss: 16.923730| train set 1.531x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 13
Epoch 13/200 |loss: 14.196877| train set 1.552x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 14
Epoch 14/200 |loss: 15.128194| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 15
Epoch 15/200 |loss: 15.802552| train set 1.803x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 16
Epoch 16/200 |loss: 14.937110| train set 2.022x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 17
Epoch 17/200 |loss: 15.708284| train set 1.875x speedup, test set 0.971x speedup, val set 0.502x speedup, step: 18
Epoch 18/200 |loss: 13.007955| train set 1.997x speedup, test set 0.971x speedup, val set 1.000x speedup, step: 19
Epoch 19/200 |loss: 15.966932| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 13.489581| train set 1.856x speedup, test set 1.655x speedup, val set 1.000x speedup, step: 21
Epoch 21/200 |loss: 12.485875| train set 1.856x speedup, test set 0.982x speedup, val set 0.502x speedup, step: 22
Epoch 22/200 |loss: 14.332380| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 23
Epoch 23/200 |loss: 13.267199| train set 2.016x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 24
Epoch 24/200 |loss: 12.873746| train set 1.996x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 25
Epoch 25/200 |loss: 10.946570| train set 1.876x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 26
Epoch 26/200 |loss: 13.315746| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 27
Epoch 27/200 |loss: 12.446203| train set 2.021x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 28
Epoch 28/200 |loss: 11.844559| train set 1.683x speedup, test set 0.932x speedup, val set 0.502x speedup, step: 29
Epoch 29/200 |loss: 12.190944| train set 1.666x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 30
Epoch 30/200 |loss: 11.602407| train set 1.941x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 31
Epoch 31/200 |loss: 10.701203| train set 1.997x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 32
Epoch 32/200 |loss: 9.870242| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 33
Epoch 33/200 |loss: 11.352113| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 34
Epoch 34/200 |loss: 10.376258| train set 2.022x speedup, test set 1.161x speedup, val set 0.502x speedup, step: 35
Epoch 35/200 |loss: 11.058016| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 36
Epoch 36/200 |loss: 9.868610| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 37
Epoch 37/200 |loss: 11.230989| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 38
Epoch 38/200 |loss: 12.951491| train set 1.835x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 39
Epoch 39/200 |loss: 12.598720| train set 2.022x speedup, test set 1.134x speedup, val set 0.502x speedup, step: 40
Epoch 40/200 |loss: 10.610789| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 41
Epoch 41/200 |loss: 11.708689| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 42
Epoch 42/200 |loss: 11.162531| train set 2.022x speedup, test set 1.137x speedup, val set 0.502x speedup, step: 43
Epoch 43/200 |loss: 10.144352| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 44
Epoch 44/200 |loss: 12.356253| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 45
Epoch 45/200 |loss: 11.999598| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 46
Epoch 46/200 |loss: 11.900749| train set 1.924x speedup, test set 1.109x speedup, val set 1.000x speedup, step: 47
Epoch 47/200 |loss: 10.067873| train set 1.997x speedup, test set 1.177x speedup, val set 0.502x speedup, step: 48
Epoch 48/200 |loss: 10.853161| train set 1.835x speedup, test set 1.177x speedup, val set 0.502x speedup, step: 49
Epoch 49/200 |loss: 10.063542| train set 1.954x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 50
Epoch 50/200 |loss: 10.994417| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 51
Epoch 51/200 |loss: 9.860088| train set 2.019x speedup, test set 1.113x speedup, val set 0.502x speedup, step: 52
Epoch 52/200 |loss: 10.487617| train set 1.965x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 53
Epoch 53/200 |loss: 11.244922| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 54
Epoch 54/200 |loss: 10.142610| train set 1.856x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 55
Epoch 55/200 |loss: 10.774160| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 56
Epoch 56/200 |loss: 10.853852| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 57
Epoch 57/200 |loss: 10.274152| train set 1.924x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 58
Epoch 58/200 |loss: 9.812386| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 59
Epoch 59/200 |loss: 9.567533| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 60
Epoch 60/200 |loss: 11.588660| train set 1.997x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 61
Epoch 61/200 |loss: 10.133419| train set 1.954x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 62
Epoch 62/200 |loss: 10.469337| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 63
Epoch 63/200 |loss: 10.209671| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 64
Epoch 64/200 |loss: 9.758613| train set 1.978x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 65
Epoch 65/200 |loss: 8.457128| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 66
Epoch 66/200 |loss: 10.737247| train set 2.022x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 67
Epoch 67/200 |loss: 10.882762| train set 2.022x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 68
Epoch 68/200 |loss: 9.946136| train set 2.022x speedup, test set 1.132x speedup, val set 0.502x speedup, step: 69
Epoch 69/200 |loss: 8.792980| train set 1.978x speedup, test set 1.126x speedup, val set 0.502x speedup, step: 70
Epoch 70/200 |loss: 9.479809| train set 1.854x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 71
Epoch 71/200 |loss: 10.538323| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 72
Epoch 72/200 |loss: 9.601739| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 73
Epoch 73/200 |loss: 10.363006| train set 1.997x speedup, test set 0.963x speedup, val set 0.502x speedup, step: 74
Epoch 74/200 |loss: 10.606387| train set 1.997x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 75
Epoch 75/200 |loss: 10.687647| train set 1.923x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 76
Epoch 76/200 |loss: 10.865852| train set 2.022x speedup, test set 0.961x speedup, val set 0.502x speedup, step: 77
Epoch 77/200 |loss: 9.239078| train set 1.856x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 78
Epoch 78/200 |loss: 10.316811| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 79
Epoch 79/200 |loss: 9.516292| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 80
Epoch 80/200 |loss: 11.126989| train set 1.856x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 81
Epoch 81/200 |loss: 9.264596| train set 2.022x speedup, test set 1.148x speedup, val set 0.502x speedup, step: 82
Epoch 82/200 |loss: 10.673188| train set 2.022x speedup, test set 1.103x speedup, val set 0.911x speedup, step: 83
Epoch 83/200 |loss: 10.010202| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 84
Epoch 84/200 |loss: 9.267125| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 85
Epoch 85/200 |loss: 10.368103| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 86
Epoch 86/200 |loss: 9.268209| train set 2.022x speedup, test set 1.111x speedup, val set 0.502x speedup, step: 87
Epoch 87/200 |loss: 8.349977| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 88
Epoch 88/200 |loss: 9.094154| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 89
Epoch 89/200 |loss: 10.474031| train set 2.022x speedup, test set 1.098x speedup, val set 0.502x speedup, step: 90
Epoch 90/200 |loss: 8.618034| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 91
Epoch 91/200 |loss: 10.790303| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 92
Epoch 92/200 |loss: 8.581945| train set 1.997x speedup, test set 1.162x speedup, val set 0.502x speedup, step: 93
Epoch 93/200 |loss: 9.717160| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 94
Epoch 94/200 |loss: 9.243660| train set 1.954x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 95
Epoch 95/200 |loss: 8.446121| train set 1.954x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 96
Epoch 96/200 |loss: 8.296768| train set 1.954x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 97
Epoch 97/200 |loss: 8.829870| train set 1.978x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 98
Epoch 98/200 |loss: 9.485797| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 99
Epoch 99/200 |loss: 11.357976| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 100
Epoch 100/200 |loss: 9.610079| train set 1.997x speedup, test set 1.166x speedup, val set 0.502x speedup, step: 1
Epoch 101/200 |loss: 8.922919| train set 1.994x speedup, test set 1.132x speedup, val set 0.502x speedup, step: 1
Epoch 102/200 |loss: 8.505006| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 103/200 |loss: 9.904686| train set 1.996x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 1
Epoch 104/200 |loss: 9.599909| train set 1.997x speedup, test set 0.964x speedup, val set 0.502x speedup, step: 1
Epoch 105/200 |loss: 9.680371| train set 2.022x speedup, test set 0.935x speedup, val set 0.502x speedup, step: 1
Epoch 106/200 |loss: 10.282213| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 107/200 |loss: 8.703706| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 108/200 |loss: 11.225921| train set 1.976x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 109/200 |loss: 9.130928| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 110/200 |loss: 10.080585| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 111/200 |loss: 9.945524| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 112/200 |loss: 9.150704| train set 1.978x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 1
Epoch 113/200 |loss: 11.742037| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 114/200 |loss: 10.102193| train set 2.022x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 115/200 |loss: 11.117516| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 116/200 |loss: 11.102117| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 117/200 |loss: 10.422985| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1
Epoch 118/200 |loss: 8.162098| train set 2.022x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 1
Epoch 119/200 |loss: 8.611652| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 1
Epoch 120/200 |loss: 8.689375| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 121/200 |loss: 9.643503| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 122/200 |loss: 9.466400| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 123/200 |loss: 10.467683| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 124/200 |loss: 8.474783| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 125/200 |loss: 9.101560| train set 1.997x speedup, test set 1.103x speedup, val set 0.502x speedup, step: 1
Epoch 126/200 |loss: 9.158138| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 127/200 |loss: 9.542248| train set 2.019x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 128/200 |loss: 8.533720| train set 2.022x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 129/200 |loss: 9.848433| train set 2.022x speedup, test set 0.948x speedup, val set 0.502x speedup, step: 1
Epoch 130/200 |loss: 8.556540| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 131/200 |loss: 9.381315| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 132/200 |loss: 9.236548| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 133/200 |loss: 9.432209| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 134/200 |loss: 9.979455| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 135/200 |loss: 9.541442| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 136/200 |loss: 10.292783| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 137/200 |loss: 8.731250| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 138/200 |loss: 8.472510| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 139/200 |loss: 8.492384| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1
Epoch 140/200 |loss: 8.235431| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1
Epoch 141/200 |loss: 10.224330| train set 2.022x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 1
Epoch 142/200 |loss: 8.073132| train set 1.954x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1
Epoch 143/200 |loss: 8.972657| train set 1.954x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1
Epoch 144/200 |loss: 8.294558| train set 2.022x speedup, test set 0.925x speedup, val set 0.502x speedup, step: 1
Epoch 145/200 |loss: 9.783894| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 1
Epoch 146/200 |loss: 8.123938| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 147/200 |loss: 9.624300| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 148/200 |loss: 8.539808| train set 2.022x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 1
Epoch 149/200 |loss: 9.352509| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 150/200 |loss: 8.096994| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 151/200 |loss: 9.304214| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 152/200 |loss: 8.397434| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 153/200 |loss: 7.529599| train set 1.819x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 154/200 |loss: 8.572817| train set 1.978x speedup, test set 1.118x speedup, val set 0.502x speedup, step: 1
Epoch 155/200 |loss: 7.657121| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 156/200 |loss: 7.842360| train set 1.978x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 1
Epoch 157/200 |loss: 8.855377| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 158/200 |loss: 10.423498| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 159/200 |loss: 10.538020| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 160/200 |loss: 9.298750| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 161/200 |loss: 9.877140| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 162/200 |loss: 10.944302| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 163/200 |loss: 9.791294| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 164/200 |loss: 10.230049| train set 1.876x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1
Epoch 165/200 |loss: 10.388994| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1
Epoch 166/200 |loss: 7.964734| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 167/200 |loss: 9.099497| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 168/200 |loss: 8.562549| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 1
Epoch 169/200 |loss: 10.064287| train set 2.022x speedup, test set 1.121x speedup, val set 0.911x speedup, step: 1
Epoch 170/200 |loss: 9.427771| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 171/200 |loss: 8.428553| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 172/200 |loss: 8.506945| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 173/200 |loss: 9.210019| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 174/200 |loss: 9.140810| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 6
Epoch 175/200 |loss: 8.878795| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 7
Epoch 176/200 |loss: 10.275798| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 8
Epoch 177/200 |loss: 9.309837| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 9
Epoch 178/200 |loss: 7.627892| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 10
Epoch 179/200 |loss: 9.591224| train set 1.995x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 180/200 |loss: 8.791111| train set 1.997x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 12
Epoch 181/200 |loss: 9.553212| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 13
Epoch 182/200 |loss: 9.126204| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 14
Epoch 183/200 |loss: 8.873192| train set 1.978x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 15
Epoch 184/200 |loss: 8.982195| train set 2.022x speedup, test set 1.121x speedup, val set 1.000x speedup, step: 1
Epoch 185/200 |loss: 9.751618| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 2
Epoch 186/200 |loss: 8.800395| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 3
Epoch 187/200 |loss: 9.991230| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 4
Epoch 188/200 |loss: 8.156180| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 5
Epoch 189/200 |loss: 9.335822| train set 2.022x speedup, test set 1.116x speedup, val set 0.502x speedup, step: 6
Epoch 190/200 |loss: 8.540051| train set 2.022x speedup, test set 1.109x speedup, val set 0.502x speedup, step: 7
Epoch 191/200 |loss: 9.602476| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 8
Epoch 192/200 |loss: 8.796001| train set 2.022x speedup, test set 1.121x speedup, val set 0.911x speedup, step: 9
Epoch 193/200 |loss: 9.717770| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 10
Epoch 194/200 |loss: 9.136697| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 11
Epoch 195/200 |loss: 11.360707| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 12
Epoch 196/200 |loss: 8.520702| train set 2.020x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 13
Epoch 197/200 |loss: 9.030507| train set 2.021x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 14
Epoch 198/200 |loss: 9.549215| train set 2.022x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 15
Epoch 199/200 |loss: 8.208363| train set 1.977x speedup, test set 1.121x speedup, val set 0.502x speedup, step: 16
Training per epoch cost 0.914 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 53, train speedup 2.022, test speedup 1.098, val speedup 0.502
best test speedup epoch: 5, train speedup 1.250, test speedup 1.759, val speedup 0.502
best validation speedup epoch: 184, train speedup 2.022, test speedup 1.121, val speedup 1.000
last model at epoch 199, train speedup 1.977, test speedup 1.121, val speedup 0.502
execution cost 0:07:38.053100
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.507991, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406729| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027801| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935728| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.431202| train set 1.200x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.471951| train set 1.306x speedup, test set 1.782x speedup, val set 0.807x speedup, step: 6
Epoch 6/200 |loss: 15.122293| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.958988| train set 1.383x speedup, test set 1.782x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.261464| train set 1.225x speedup, test set 1.671x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.668037| train set 1.417x speedup, test set 1.669x speedup, val set 0.883x speedup, step: 10
Epoch 10/200 |loss: 13.353562| train set 1.423x speedup, test set 1.782x speedup, val set 0.437x speedup, step: 11
Epoch 11/200 |loss: 15.052129| train set 1.367x speedup, test set 2.381x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.130071| train set 1.367x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 13
Epoch 13/200 |loss: 11.201129| train set 1.435x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.375290| train set 1.550x speedup, test set 2.387x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.926057| train set 1.620x speedup, test set 2.549x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.493843| train set 1.663x speedup, test set 1.737x speedup, val set 0.297x speedup, step: 17
Epoch 17/200 |loss: 10.602726| train set 1.680x speedup, test set 1.037x speedup, val set 0.437x speedup, step: 18
Epoch 18/200 |loss: 11.428355| train set 1.766x speedup, test set 1.037x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.657517| train set 1.790x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.467348| train set 1.790x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.877910| train set 1.663x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.731900| train set 1.810x speedup, test set 1.280x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.208232| train set 1.790x speedup, test set 6.906x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.152245| train set 1.791x speedup, test set 1.859x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.384013| train set 1.810x speedup, test set 1.004x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.789114| train set 1.810x speedup, test set 1.263x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.737391| train set 1.790x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.714516| train set 1.790x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.727319| train set 1.810x speedup, test set 0.968x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.697803| train set 1.810x speedup, test set 1.188x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.857294| train set 1.790x speedup, test set 5.883x speedup, val set 0.275x speedup, step: 32
Epoch 32/200 |loss: 9.905300| train set 1.694x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.043592| train set 1.790x speedup, test set 1.188x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.379027| train set 1.790x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.106679| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.530149| train set 1.810x speedup, test set 2.524x speedup, val set 0.887x speedup, step: 37
Epoch 37/200 |loss: 9.514335| train set 1.664x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.552931| train set 1.810x speedup, test set 1.859x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.994135| train set 1.734x speedup, test set 1.705x speedup, val set 0.426x speedup, step: 40
Epoch 40/200 |loss: 8.786925| train set 1.680x speedup, test set 1.659x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.640382| train set 1.651x speedup, test set 1.035x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.614045| train set 1.791x speedup, test set 1.859x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.540930| train set 1.791x speedup, test set 1.004x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.626931| train set 1.776x speedup, test set 1.004x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.816472| train set 1.776x speedup, test set 1.882x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.024178| train set 1.711x speedup, test set 2.524x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.325243| train set 1.711x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.496733| train set 1.776x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.910607| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.566220| train set 1.790x speedup, test set 1.859x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.547858| train set 1.790x speedup, test set 1.768x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.788139| train set 1.776x speedup, test set 1.768x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.152179| train set 1.810x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.968372| train set 1.776x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.815474| train set 1.776x speedup, test set 1.007x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.232068| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.677250| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 7.964333| train set 1.810x speedup, test set 1.657x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.683827| train set 1.810x speedup, test set 1.657x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.430814| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.872221| train set 1.791x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.057033| train set 1.757x speedup, test set 1.770x speedup, val set 0.477x speedup, step: 63
Epoch 63/200 |loss: 8.610056| train set 1.757x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.062796| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.965855| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.174066| train set 1.734x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.749472| train set 1.776x speedup, test set 1.860x speedup, val set 0.477x speedup, step: 68
Epoch 68/200 |loss: 8.596470| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.641541| train set 1.696x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.347342| train set 1.791x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.043705| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.573370| train set 1.810x speedup, test set 6.921x speedup, val set 0.477x speedup, step: 73
Epoch 73/200 |loss: 7.336651| train set 1.810x speedup, test set 6.921x speedup, val set 0.477x speedup, step: 74
Epoch 74/200 |loss: 9.500077| train set 1.810x speedup, test set 6.921x speedup, val set 0.477x speedup, step: 75
Epoch 75/200 |loss: 8.483759| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.011299| train set 1.790x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.830853| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.343086| train set 1.810x speedup, test set 1.657x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.528033| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.104935| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.471133| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.151120| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.974545| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 84
Epoch 84/200 |loss: 8.340037| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.068069| train set 1.696x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.157917| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.925324| train set 1.776x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.259423| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.181255| train set 1.804x speedup, test set 1.768x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.630141| train set 1.810x speedup, test set 1.768x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.372898| train set 1.810x speedup, test set 1.861x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.663929| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.208043| train set 1.810x speedup, test set 1.768x speedup, val set 0.477x speedup, step: 94
Epoch 94/200 |loss: 8.574962| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.485705| train set 1.791x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 10.287206| train set 1.757x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.219991| train set 1.776x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.516897| train set 1.791x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.950233| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.209325| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.510772| train set 1.810x speedup, test set 6.921x speedup, val set 0.477x speedup, step: 1
Epoch 102/200 |loss: 8.052853| train set 1.810x speedup, test set 1.963x speedup, val set 0.296x speedup, step: 2
Epoch 103/200 |loss: 10.086036| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 3
Epoch 104/200 |loss: 8.990178| train set 1.776x speedup, test set 1.961x speedup, val set 0.477x speedup, step: 1
Epoch 105/200 |loss: 8.787007| train set 1.776x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 2
Epoch 106/200 |loss: 9.051992| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 3
Epoch 107/200 |loss: 10.321977| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 4
Epoch 108/200 |loss: 9.797655| train set 1.776x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 5
Epoch 109/200 |loss: 8.528780| train set 1.776x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 6
Epoch 110/200 |loss: 8.994350| train set 1.791x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 7
Epoch 111/200 |loss: 8.675523| train set 1.810x speedup, test set 1.768x speedup, val set 0.296x speedup, step: 8
Epoch 112/200 |loss: 7.713386| train set 1.810x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 9
Epoch 113/200 |loss: 9.729399| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 10
Epoch 114/200 |loss: 8.722168| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 11
Epoch 115/200 |loss: 8.205165| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 12
Epoch 116/200 |loss: 7.992859| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 13
Epoch 117/200 |loss: 10.945832| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 14
Epoch 118/200 |loss: 8.267434| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 1
Epoch 119/200 |loss: 8.517069| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.113678| train set 1.774x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 2
Epoch 121/200 |loss: 9.603543| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 3
Epoch 122/200 |loss: 9.508541| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 4
Epoch 123/200 |loss: 9.182353| train set 1.790x speedup, test set 1.770x speedup, val set 0.296x speedup, step: 5
Epoch 124/200 |loss: 8.760546| train set 1.757x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 6
Epoch 125/200 |loss: 9.110169| train set 1.776x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 7
Epoch 126/200 |loss: 8.277172| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 8
Epoch 127/200 |loss: 7.625352| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 9
Epoch 128/200 |loss: 9.063112| train set 1.776x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 10
Epoch 129/200 |loss: 8.672282| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 11
Epoch 130/200 |loss: 8.609771| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 12
Epoch 131/200 |loss: 8.929275| train set 1.791x speedup, test set 1.739x speedup, val set 0.477x speedup, step: 1
Epoch 132/200 |loss: 8.252482| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 2
Epoch 133/200 |loss: 8.396883| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 3
Epoch 134/200 |loss: 9.177980| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 4
Epoch 135/200 |loss: 8.331749| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 5
Epoch 136/200 |loss: 7.848776| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 6
Epoch 137/200 |loss: 8.232202| train set 1.776x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 7
Epoch 138/200 |loss: 6.884004| train set 1.776x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 8
Epoch 139/200 |loss: 7.338645| train set 1.680x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 9
Epoch 140/200 |loss: 6.933869| train set 1.791x speedup, test set 1.963x speedup, val set 0.296x speedup, step: 10
Epoch 141/200 |loss: 10.425852| train set 1.810x speedup, test set 1.961x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.586870| train set 1.776x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.340653| train set 1.679x speedup, test set 1.806x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.621668| train set 1.790x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.371529| train set 1.775x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.165574| train set 1.757x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.467129| train set 1.757x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 6.968808| train set 1.776x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 8.787996| train set 1.810x speedup, test set 1.770x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.580736| train set 1.810x speedup, test set 1.770x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.214261| train set 1.776x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 7.552886| train set 1.776x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.404266| train set 1.810x speedup, test set 1.963x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.448553| train set 1.810x speedup, test set 1.963x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 7.548086| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.435229| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.613296| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 9.855118| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.950165| train set 1.810x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 8.020600| train set 1.791x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 9.971525| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 10.855321| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 8.268051| train set 1.776x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 23
Epoch 164/200 |loss: 8.881017| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 8.270525| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 9.352578| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 26
Epoch 167/200 |loss: 8.076931| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 27
Epoch 168/200 |loss: 7.924454| train set 1.790x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 28
Epoch 169/200 |loss: 8.890228| train set 1.790x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 29
Epoch 170/200 |loss: 9.306272| train set 1.757x speedup, test set 1.860x speedup, val set 0.477x speedup, step: 1
Epoch 171/200 |loss: 7.929656| train set 1.757x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 2
Epoch 172/200 |loss: 8.540794| train set 1.791x speedup, test set 1.963x speedup, val set 0.296x speedup, step: 3
Epoch 173/200 |loss: 7.895936| train set 1.810x speedup, test set 1.963x speedup, val set 0.477x speedup, step: 1
Epoch 174/200 |loss: 8.012064| train set 1.776x speedup, test set 1.963x speedup, val set 1.000x speedup, step: 1
Epoch 175/200 |loss: 8.581480| train set 1.775x speedup, test set 7.044x speedup, val set 0.437x speedup, step: 2
Epoch 176/200 |loss: 9.625340| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 3
Epoch 177/200 |loss: 7.898307| train set 1.790x speedup, test set 8.160x speedup, val set 0.296x speedup, step: 4
Epoch 178/200 |loss: 8.131826| train set 1.760x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 5
Epoch 179/200 |loss: 8.434968| train set 1.790x speedup, test set 1.860x speedup, val set 0.477x speedup, step: 6
Epoch 180/200 |loss: 9.121997| train set 1.791x speedup, test set 1.862x speedup, val set 0.513x speedup, step: 7
Epoch 181/200 |loss: 8.637064| train set 1.810x speedup, test set 1.739x speedup, val set 0.513x speedup, step: 8
Epoch 182/200 |loss: 8.595737| train set 1.810x speedup, test set 7.044x speedup, val set 0.437x speedup, step: 9
Epoch 183/200 |loss: 8.429972| train set 1.810x speedup, test set 7.044x speedup, val set 1.000x speedup, step: 1
Epoch 184/200 |loss: 7.217905| train set 1.810x speedup, test set 6.949x speedup, val set 1.000x speedup, step: 1
Epoch 185/200 |loss: 7.157485| train set 1.810x speedup, test set 2.302x speedup, val set 0.437x speedup, step: 2
Epoch 186/200 |loss: 9.322935| train set 1.810x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 3
Epoch 187/200 |loss: 9.545625| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 4
Epoch 188/200 |loss: 6.949049| train set 1.810x speedup, test set 8.121x speedup, val set 0.477x speedup, step: 5
Epoch 189/200 |loss: 8.720591| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 6
Epoch 190/200 |loss: 7.691656| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 7
Epoch 191/200 |loss: 8.168349| train set 1.776x speedup, test set 6.435x speedup, val set 0.296x speedup, step: 8
Epoch 192/200 |loss: 9.809815| train set 1.776x speedup, test set 1.823x speedup, val set 0.296x speedup, step: 9
Epoch 193/200 |loss: 8.356828| train set 1.776x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 10
Epoch 194/200 |loss: 9.204170| train set 1.776x speedup, test set 1.963x speedup, val set 0.296x speedup, step: 11
Epoch 195/200 |loss: 9.535033| train set 1.810x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 12
Epoch 196/200 |loss: 8.406871| train set 1.810x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 13
Epoch 197/200 |loss: 8.133710| train set 1.791x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 14
Epoch 198/200 |loss: 8.798181| train set 1.791x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 15
Epoch 199/200 |loss: 8.496860| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 16
Training per epoch cost 0.301 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 60, train speedup 1.810, test speedup 1.738, val speedup 0.296
best test speedup epoch: 64, train speedup 1.810, test speedup 8.607, val speedup 0.296
best validation speedup epoch: 184, train speedup 1.810, test speedup 6.949, val speedup 1.000
last model at epoch 199, train speedup 1.810, test speedup 1.738, val speedup 0.296
execution cost 0:02:34.866335
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.451039, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406733| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027799| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936129| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435102| train set 1.200x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472630| train set 1.142x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150178| train set 1.352x speedup, test set 1.782x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997276| train set 1.383x speedup, test set 1.782x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.314549| train set 1.225x speedup, test set 1.671x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.689704| train set 1.417x speedup, test set 1.649x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.356986| train set 1.342x speedup, test set 1.646x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.934371| train set 1.335x speedup, test set 2.338x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.165415| train set 1.367x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.217153| train set 1.435x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.458428| train set 1.550x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.894133| train set 1.620x speedup, test set 1.193x speedup, val set 0.437x speedup, step: 16
Epoch 16/200 |loss: 12.626110| train set 1.663x speedup, test set 2.549x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.578207| train set 1.663x speedup, test set 2.553x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.418581| train set 1.765x speedup, test set 1.216x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.722711| train set 1.790x speedup, test set 2.528x speedup, val set 0.296x speedup, step: 20
Epoch 20/200 |loss: 12.774415| train set 1.786x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 12.186677| train set 1.680x speedup, test set 2.549x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.993202| train set 1.810x speedup, test set 1.234x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.550379| train set 1.764x speedup, test set 2.549x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 11.984829| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.217407| train set 1.458x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.858668| train set 1.810x speedup, test set 1.634x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.734816| train set 1.790x speedup, test set 1.634x speedup, val set 0.477x speedup, step: 28
Epoch 28/200 |loss: 10.619662| train set 1.790x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.881987| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.259017| train set 1.810x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.749795| train set 1.791x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.444366| train set 1.790x speedup, test set 1.859x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.245372| train set 1.790x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.425662| train set 1.790x speedup, test set 1.564x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.234702| train set 1.790x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.902304| train set 1.791x speedup, test set 1.224x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.895971| train set 1.791x speedup, test set 1.216x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.466680| train set 1.791x speedup, test set 1.216x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.931173| train set 1.734x speedup, test set 2.381x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.950813| train set 1.810x speedup, test set 1.184x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.685171| train set 1.680x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.723192| train set 1.791x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.707868| train set 1.747x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.192927| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.572455| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.360607| train set 1.711x speedup, test set 2.524x speedup, val set 0.447x speedup, step: 47
Epoch 47/200 |loss: 9.805978| train set 1.810x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.667999| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.968194| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.597947| train set 1.791x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.934034| train set 1.791x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.929410| train set 1.791x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.381196| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 10.099375| train set 1.776x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.960599| train set 1.776x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.250641| train set 1.757x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.874762| train set 1.790x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 7.984691| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.592234| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.376987| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.745807| train set 1.790x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 9.980947| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.349710| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.203826| train set 1.680x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.257352| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.055129| train set 1.733x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.907704| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.526080| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.730820| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 8.973884| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 8.932017| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.620288| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.554883| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.317371| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.586714| train set 1.679x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.099804| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.964743| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.407265| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.585093| train set 1.807x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.071447| train set 1.807x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.742694| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.208751| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.993865| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.348102| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.175695| train set 1.696x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.140296| train set 1.680x speedup, test set 2.721x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.887137| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.139762| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 8.959802| train set 1.791x speedup, test set 1.249x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.533523| train set 1.776x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.145615| train set 1.810x speedup, test set 2.721x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.774538| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.214735| train set 1.766x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.515975| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.732342| train set 1.791x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.777893| train set 1.757x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.141911| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.469319| train set 1.791x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.219291| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.975681| train set 1.734x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.867230| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.873126| train set 1.791x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 11.001592| train set 1.810x speedup, test set 0.995x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.400020| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 9.228120| train set 1.776x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.452337| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.564520| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 10.218770| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.811314| train set 1.790x speedup, test set 2.721x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 8.999101| train set 1.791x speedup, test set 2.721x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.887036| train set 1.810x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 7.883305| train set 1.810x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 9.512414| train set 1.810x speedup, test set 1.012x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.126558| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.387113| train set 1.810x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.031731| train set 1.810x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 11.327717| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.799571| train set 1.810x speedup, test set 1.160x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.978446| train set 1.810x speedup, test set 2.530x speedup, val set 0.450x speedup, step: 17
Epoch 120/200 |loss: 8.351834| train set 1.776x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 18
Epoch 121/200 |loss: 9.758121| train set 1.678x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 19
Epoch 122/200 |loss: 9.874836| train set 1.679x speedup, test set 2.537x speedup, val set 0.296x speedup, step: 20
Epoch 123/200 |loss: 9.378071| train set 1.790x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 21
Epoch 124/200 |loss: 8.902457| train set 1.757x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 22
Epoch 125/200 |loss: 9.106286| train set 1.757x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 23
Epoch 126/200 |loss: 8.497481| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 24
Epoch 127/200 |loss: 7.752058| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 25
Epoch 128/200 |loss: 8.847450| train set 1.776x speedup, test set 1.791x speedup, val set 0.296x speedup, step: 26
Epoch 129/200 |loss: 8.457336| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 27
Epoch 130/200 |loss: 8.689562| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 28
Epoch 131/200 |loss: 8.858974| train set 1.790x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 29
Epoch 132/200 |loss: 8.410675| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 30
Epoch 133/200 |loss: 8.355174| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 31
Epoch 134/200 |loss: 9.269848| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 32
Epoch 135/200 |loss: 8.020334| train set 1.791x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 33
Epoch 136/200 |loss: 8.050266| train set 1.810x speedup, test set 1.160x speedup, val set 0.296x speedup, step: 34
Epoch 137/200 |loss: 8.073315| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 35
Epoch 138/200 |loss: 7.049013| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 36
Epoch 139/200 |loss: 7.086591| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 37
Epoch 140/200 |loss: 6.865481| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 38
Epoch 141/200 |loss: 10.152189| train set 1.810x speedup, test set 1.707x speedup, val set 0.296x speedup, step: 39
Epoch 142/200 |loss: 7.589490| train set 1.810x speedup, test set 1.707x speedup, val set 0.296x speedup, step: 40
Epoch 143/200 |loss: 8.120505| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 41
Epoch 144/200 |loss: 9.349704| train set 1.790x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 42
Epoch 145/200 |loss: 9.455550| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 43
Epoch 146/200 |loss: 7.258657| train set 1.757x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 44
Epoch 147/200 |loss: 9.610035| train set 1.757x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 45
Epoch 148/200 |loss: 6.987229| train set 1.776x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 46
Epoch 149/200 |loss: 8.714045| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 47
Epoch 150/200 |loss: 8.730205| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 48
Epoch 151/200 |loss: 9.198615| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 49
Epoch 152/200 |loss: 7.816753| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 50
Epoch 153/200 |loss: 7.461451| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 51
Epoch 154/200 |loss: 8.424608| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 52
Epoch 155/200 |loss: 7.772529| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 53
Epoch 156/200 |loss: 7.431993| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 54
Epoch 157/200 |loss: 7.557955| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 55
Epoch 158/200 |loss: 9.813681| train set 1.776x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 56
Epoch 159/200 |loss: 9.481602| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 57
Epoch 160/200 |loss: 8.166635| train set 1.810x speedup, test set 2.475x speedup, val set 0.296x speedup, step: 58
Epoch 161/200 |loss: 9.866475| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 59
Epoch 162/200 |loss: 10.959536| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 60
Epoch 163/200 |loss: 7.915928| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 61
Epoch 164/200 |loss: 8.709515| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 62
Epoch 165/200 |loss: 8.151671| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 63
Epoch 166/200 |loss: 9.298251| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 64
Epoch 167/200 |loss: 8.039639| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 65
Epoch 168/200 |loss: 7.919529| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 66
Epoch 169/200 |loss: 8.801298| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 67
Epoch 170/200 |loss: 9.380569| train set 1.757x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 68
Epoch 171/200 |loss: 7.990745| train set 1.758x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 69
Epoch 172/200 |loss: 8.808158| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 70
Epoch 173/200 |loss: 7.899850| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 71
Epoch 174/200 |loss: 8.449120| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 72
Epoch 175/200 |loss: 8.815875| train set 1.775x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 73
Epoch 176/200 |loss: 9.534969| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 74
Epoch 177/200 |loss: 8.307620| train set 1.791x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 75
Epoch 178/200 |loss: 8.002508| train set 1.747x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 76
Epoch 179/200 |loss: 8.510514| train set 1.747x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 77
Epoch 180/200 |loss: 9.316698| train set 1.791x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 78
Epoch 181/200 |loss: 8.899118| train set 1.791x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 79
Epoch 182/200 |loss: 8.905720| train set 1.776x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 80
Epoch 183/200 |loss: 9.170152| train set 1.810x speedup, test set 2.475x speedup, val set 0.296x speedup, step: 81
Epoch 184/200 |loss: 7.455678| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 82
Epoch 185/200 |loss: 7.393653| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 83
Epoch 186/200 |loss: 9.596342| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 84
Epoch 187/200 |loss: 9.633897| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 85
Epoch 188/200 |loss: 6.992206| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 86
Epoch 189/200 |loss: 8.836824| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 87
Epoch 190/200 |loss: 7.964858| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 88
Epoch 191/200 |loss: 8.377350| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 89
Epoch 192/200 |loss: 9.980753| train set 1.776x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 90
Epoch 193/200 |loss: 8.476753| train set 1.776x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 91
Epoch 194/200 |loss: 9.301768| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 92
Epoch 195/200 |loss: 9.722770| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 93
Epoch 196/200 |loss: 8.411600| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 94
Epoch 197/200 |loss: 8.296336| train set 1.791x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 95
Epoch 198/200 |loss: 8.619127| train set 1.791x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 96
Epoch 199/200 |loss: 8.508551| train set 1.791x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 97
Training per epoch cost 0.333 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 580.359s, pg runtime 432.766s, speedup 0.746x
32, opt runtime 15.120s, model runtime 580.203s, pg runtime 566.078s, speedup 0.976x
33, opt runtime 16.639s, model runtime 576.339s, pg runtime 462.544s, speedup 0.803x
34, opt runtime 16.280s, model runtime 615.635s, pg runtime 634.990s, speedup 1.031x
35, opt runtime 16.528s, model runtime 616.056s, pg runtime 620.762s, speedup 1.008x
36, opt runtime 18.690s, model runtime 637.615s, pg runtime 651.942s, speedup 1.022x
37, opt runtime 16.438s, model runtime 583.941s, pg runtime 546.887s, speedup 0.937x
38, opt runtime 16.138s, model runtime 572.741s, pg runtime 501.793s, speedup 0.876x
39, opt runtime 16.770s, model runtime 617.719s, pg runtime 594.754s, speedup 0.963x
40, opt runtime 16.305s, model runtime 577.424s, pg runtime 436.168s, speedup 0.755x
====================
best train speedup epoch: 40, train speedup 1.810, test speedup 1.184, val speedup 0.296
best test speedup epoch: 161, train speedup 1.810, test speedup 8.607, val speedup 0.296
best validation speedup epoch: 103, train speedup 1.810, test speedup 0.995, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 1.739, val speedup 0.296
execution cost 0:02:46.451324
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.471162, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406727| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027796| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935155| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438592| train set 1.142x speedup, test set 1.782x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477202| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149712| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990737| train set 1.383x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259733| train set 1.225x speedup, test set 1.672x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653822| train set 1.417x speedup, test set 1.657x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351100| train set 1.478x speedup, test set 1.646x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908951| train set 1.412x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132761| train set 1.367x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.264369| train set 1.435x speedup, test set 1.195x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.361889| train set 1.550x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.800315| train set 1.623x speedup, test set 2.549x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.409026| train set 1.663x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.500642| train set 1.663x speedup, test set 0.994x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.381045| train set 1.790x speedup, test set 1.033x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.540546| train set 1.790x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.197967| train set 1.806x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.768212| train set 1.810x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.523419| train set 1.810x speedup, test set 2.384x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.370321| train set 1.764x speedup, test set 6.906x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.359792| train set 1.766x speedup, test set 2.524x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.549170| train set 1.810x speedup, test set 1.199x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 11.224169| train set 1.541x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 27
Epoch 27/200 |loss: 11.800232| train set 1.790x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.461155| train set 1.790x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.112978| train set 1.810x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.455239| train set 1.810x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.864847| train set 1.790x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.789585| train set 1.672x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.201608| train set 1.810x speedup, test set 1.263x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.416368| train set 1.790x speedup, test set 1.657x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.950741| train set 1.776x speedup, test set 1.564x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.612114| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.459906| train set 1.791x speedup, test set 2.696x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.409008| train set 1.810x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.585386| train set 1.776x speedup, test set 1.737x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.701472| train set 1.680x speedup, test set 1.767x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.231339| train set 1.788x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.380553| train set 1.757x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 12.085236| train set 1.747x speedup, test set 1.033x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.172054| train set 1.791x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 9.017650| train set 1.810x speedup, test set 1.564x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.462708| train set 1.711x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.814897| train set 1.711x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.655548| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.158587| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.655556| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.993820| train set 1.747x speedup, test set 2.411x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.861251| train set 1.747x speedup, test set 1.177x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.515262| train set 1.810x speedup, test set 1.668x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.908631| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.091867| train set 1.776x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.680861| train set 1.776x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.780728| train set 1.790x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.189664| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 8.007572| train set 1.766x speedup, test set 1.682x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.752707| train set 1.810x speedup, test set 0.978x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.096167| train set 1.791x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.542960| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.783931| train set 1.757x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.633661| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.919086| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.580717| train set 1.766x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.793859| train set 1.734x speedup, test set 1.264x speedup, val set 0.477x speedup, step: 68
Epoch 68/200 |loss: 8.824154| train set 1.776x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.903850| train set 1.680x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.503631| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.216098| train set 1.790x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.683178| train set 1.790x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 73
Epoch 73/200 |loss: 7.602132| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.472939| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.378996| train set 1.696x speedup, test set 1.741x speedup, val set 0.450x speedup, step: 76
Epoch 76/200 |loss: 8.239780| train set 1.696x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.952222| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.404747| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.885069| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.091038| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.557016| train set 1.808x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.248011| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.882706| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 84
Epoch 84/200 |loss: 8.529258| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.145248| train set 1.696x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.160208| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.732223| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.109268| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 8.965395| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.636120| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.011359| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.730083| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.066343| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.151224| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.188469| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.649417| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.986606| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.214623| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.876189| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.794201| train set 1.734x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 1
Epoch 101/200 |loss: 9.008096| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 2
Epoch 102/200 |loss: 8.008043| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 3
Epoch 103/200 |loss: 9.876223| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 8.885069| train set 1.776x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 1
Epoch 105/200 |loss: 8.626391| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 2
Epoch 106/200 |loss: 8.988404| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 3
Epoch 107/200 |loss: 10.238027| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 4
Epoch 108/200 |loss: 9.600620| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 109/200 |loss: 8.390037| train set 1.791x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 6
Epoch 110/200 |loss: 9.011195| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 7
Epoch 111/200 |loss: 8.574680| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 8
Epoch 112/200 |loss: 8.017015| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 9
Epoch 113/200 |loss: 9.800741| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 10
Epoch 114/200 |loss: 9.087317| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 11
Epoch 115/200 |loss: 8.582573| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 12
Epoch 116/200 |loss: 8.592148| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 13
Epoch 117/200 |loss: 10.993864| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 14
Epoch 118/200 |loss: 8.723963| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 15
Epoch 119/200 |loss: 8.422164| train set 1.810x speedup, test set 0.995x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.420207| train set 1.776x speedup, test set 1.264x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.571782| train set 1.776x speedup, test set 1.264x speedup, val set 0.477x speedup, step: 1
Epoch 122/200 |loss: 9.687793| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 2
Epoch 123/200 |loss: 9.188236| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 3
Epoch 124/200 |loss: 8.995718| train set 1.791x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 4
Epoch 125/200 |loss: 8.879347| train set 1.791x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 5
Epoch 126/200 |loss: 8.295785| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 6
Epoch 127/200 |loss: 7.795250| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 7
Epoch 128/200 |loss: 8.871881| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 8
Epoch 129/200 |loss: 8.527527| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 9
Epoch 130/200 |loss: 8.658173| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 10
Epoch 131/200 |loss: 9.020629| train set 1.791x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 11
Epoch 132/200 |loss: 8.314837| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 12
Epoch 133/200 |loss: 8.627420| train set 1.711x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 13
Epoch 134/200 |loss: 9.150539| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 14
Epoch 135/200 |loss: 8.307361| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 15
Epoch 136/200 |loss: 8.002345| train set 1.776x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 16
Epoch 137/200 |loss: 8.262102| train set 1.776x speedup, test set 1.543x speedup, val set 0.296x speedup, step: 17
Epoch 138/200 |loss: 6.991022| train set 1.776x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 18
Epoch 139/200 |loss: 7.339868| train set 1.696x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 19
Epoch 140/200 |loss: 6.860159| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 20
Epoch 141/200 |loss: 10.203150| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 21
Epoch 142/200 |loss: 7.803615| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 22
Epoch 143/200 |loss: 8.719101| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 23
Epoch 144/200 |loss: 9.002087| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 24
Epoch 145/200 |loss: 9.697525| train set 1.757x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 25
Epoch 146/200 |loss: 6.947762| train set 1.756x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 26
Epoch 147/200 |loss: 9.733211| train set 1.757x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 27
Epoch 148/200 |loss: 6.879992| train set 1.790x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 28
Epoch 149/200 |loss: 9.906775| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 29
Epoch 150/200 |loss: 8.960422| train set 1.776x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 151/200 |loss: 9.261434| train set 1.776x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 152/200 |loss: 8.129609| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 2
Epoch 153/200 |loss: 7.507148| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 3
Epoch 154/200 |loss: 8.734041| train set 1.810x speedup, test set 2.472x speedup, val set 0.296x speedup, step: 4
Epoch 155/200 |loss: 7.953621| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 156/200 |loss: 7.539646| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 6
Epoch 157/200 |loss: 7.611629| train set 1.776x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 7
Epoch 158/200 |loss: 10.116274| train set 1.776x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 8
Epoch 159/200 |loss: 9.613868| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 9
Epoch 160/200 |loss: 7.361405| train set 1.810x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 10
Epoch 161/200 |loss: 9.184290| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 11
Epoch 162/200 |loss: 10.312600| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 12
Epoch 163/200 |loss: 7.625846| train set 1.810x speedup, test set 5.369x speedup, val set 0.296x speedup, step: 13
Epoch 164/200 |loss: 8.337473| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 14
Epoch 165/200 |loss: 7.972968| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 15
Epoch 166/200 |loss: 9.136313| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 16
Epoch 167/200 |loss: 7.873429| train set 1.810x speedup, test set 2.859x speedup, val set 0.296x speedup, step: 17
Epoch 168/200 |loss: 7.746127| train set 1.790x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 18
Epoch 169/200 |loss: 8.703073| train set 1.757x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 19
Epoch 170/200 |loss: 9.388923| train set 1.757x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 20
Epoch 171/200 |loss: 7.866065| train set 1.757x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 21
Epoch 172/200 |loss: 8.593202| train set 1.791x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 22
Epoch 173/200 |loss: 7.890944| train set 1.790x speedup, test set 5.776x speedup, val set 0.296x speedup, step: 23
Epoch 174/200 |loss: 7.912809| train set 1.776x speedup, test set 2.313x speedup, val set 0.513x speedup, step: 1
Epoch 175/200 |loss: 8.607728| train set 1.775x speedup, test set 2.313x speedup, val set 0.513x speedup, step: 1
Epoch 176/200 |loss: 9.618030| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 2
Epoch 177/200 |loss: 8.034081| train set 1.791x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 3
Epoch 178/200 |loss: 8.029541| train set 1.790x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 4
Epoch 179/200 |loss: 8.493685| train set 1.716x speedup, test set 1.860x speedup, val set 1.510x speedup, step: 1
Epoch 180/200 |loss: 9.328001| train set 1.757x speedup, test set 1.860x speedup, val set 0.513x speedup, step: 2
Epoch 181/200 |loss: 8.607694| train set 1.757x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 3
Epoch 182/200 |loss: 8.698958| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 4
Epoch 183/200 |loss: 9.039822| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 5
Epoch 184/200 |loss: 7.436325| train set 1.810x speedup, test set 2.313x speedup, val set 0.477x speedup, step: 6
Epoch 185/200 |loss: 7.400458| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 7
Epoch 186/200 |loss: 9.373726| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 8
Epoch 187/200 |loss: 9.749163| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 9
Epoch 188/200 |loss: 6.911225| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 10
Epoch 189/200 |loss: 8.743518| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 11
Epoch 190/200 |loss: 7.878308| train set 1.810x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 12
Epoch 191/200 |loss: 8.054904| train set 1.776x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 13
Epoch 192/200 |loss: 9.984852| train set 1.776x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 14
Epoch 193/200 |loss: 8.510668| train set 1.776x speedup, test set 2.313x speedup, val set 0.296x speedup, step: 15
Epoch 194/200 |loss: 8.923990| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 16
Epoch 195/200 |loss: 9.665816| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 17
Epoch 196/200 |loss: 8.178414| train set 1.776x speedup, test set 2.316x speedup, val set 0.513x speedup, step: 18
Epoch 197/200 |loss: 8.244977| train set 1.791x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 19
Epoch 198/200 |loss: 8.622113| train set 1.791x speedup, test set 2.316x speedup, val set 0.296x speedup, step: 20
Epoch 199/200 |loss: 8.319794| train set 1.791x speedup, test set 2.313x speedup, val set 0.513x speedup, step: 21
Training per epoch cost 0.329 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 33.598s, pg runtime 601.866s, speedup 17.914x
22, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
23, opt runtime 24.662s, model runtime 32.192s, pg runtime 613.999s, speedup 19.073x
24, opt runtime 24.459s, model runtime 32.532s, pg runtime 608.717s, speedup 18.711x
25, opt runtime 25.236s, model runtime 33.141s, pg runtime 601.756s, speedup 18.157x
26, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
27, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
28, opt runtime 25.075s, model runtime 32.865s, pg runtime 612.430s, speedup 18.635x
29, opt runtime 24.840s, model runtime 32.681s, pg runtime 626.529s, speedup 19.171x
30, opt runtime 24.920s, model runtime 32.473s, pg runtime 610.993s, speedup 18.816x
31, opt runtime 16.268s, model runtime 432.766s, pg runtime 432.766s, speedup 1.000x
32, opt runtime 15.120s, model runtime 566.078s, pg runtime 566.078s, speedup 1.000x
33, opt runtime 16.639s, model runtime 462.544s, pg runtime 462.544s, speedup 1.000x
34, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
35, opt runtime 16.528s, model runtime 620.762s, pg runtime 620.762s, speedup 1.000x
36, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
37, opt runtime 16.438s, model runtime 546.887s, pg runtime 546.887s, speedup 1.000x
38, opt runtime 16.138s, model runtime 501.793s, pg runtime 501.793s, speedup 1.000x
39, opt runtime 16.770s, model runtime 594.754s, pg runtime 594.754s, speedup 1.000x
40, opt runtime 16.305s, model runtime 436.168s, pg runtime 436.168s, speedup 1.000x
====================
best train speedup epoch: 25, train speedup 1.810, test speedup 1.199, val speedup 0.296
best test speedup epoch: 57, train speedup 1.790, test speedup 8.563, val speedup 0.296
best validation speedup epoch: 179, train speedup 1.716, test speedup 1.860, val speedup 1.510
last model at epoch 199, train speedup 1.791, test speedup 2.313, val speedup 0.513
execution cost 0:02:45.420593
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.269658, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406727| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027799| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935156| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438596| train set 1.142x speedup, test set 1.782x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477203| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149716| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990743| train set 1.383x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259744| train set 1.225x speedup, test set 1.672x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653832| train set 1.417x speedup, test set 1.657x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351129| train set 1.478x speedup, test set 1.646x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908955| train set 1.416x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.131951| train set 1.367x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.265821| train set 1.435x speedup, test set 1.195x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.360164| train set 1.471x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 15
Epoch 15/200 |loss: 12.805375| train set 1.623x speedup, test set 2.549x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.435837| train set 1.663x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.535454| train set 1.663x speedup, test set 0.994x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.414418| train set 1.790x speedup, test set 1.861x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.610078| train set 1.790x speedup, test set 1.859x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 12.222376| train set 1.675x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.848526| train set 1.810x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.535582| train set 1.810x speedup, test set 1.564x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.440343| train set 1.790x speedup, test set 1.859x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.240766| train set 1.810x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 25
Epoch 25/200 |loss: 9.315057| train set 1.810x speedup, test set 1.211x speedup, val set 0.437x speedup, step: 26
Epoch 26/200 |loss: 10.748693| train set 1.810x speedup, test set 1.634x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.707556| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.525792| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.980795| train set 1.776x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 30
Epoch 30/200 |loss: 11.557910| train set 1.810x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 10.047355| train set 1.791x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.905563| train set 1.747x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.170194| train set 1.810x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.251454| train set 1.810x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.816080| train set 1.776x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.565187| train set 1.810x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.223496| train set 1.791x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.250940| train set 1.766x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.540179| train set 1.776x speedup, test set 1.737x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.532746| train set 1.680x speedup, test set 1.199x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.453484| train set 1.774x speedup, test set 1.872x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.551975| train set 1.757x speedup, test set 1.872x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.274930| train set 1.791x speedup, test set 1.008x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.337996| train set 1.791x speedup, test set 1.008x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.292354| train set 1.776x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 46
Epoch 46/200 |loss: 10.795605| train set 1.680x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.521252| train set 1.791x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.959907| train set 1.766x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.908194| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 9.097302| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.747853| train set 1.790x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.735149| train set 1.803x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.460528| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.530140| train set 1.776x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.204275| train set 1.776x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 9.958004| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.796548| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 7.968127| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.509255| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.397565| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.809339| train set 1.791x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 9.880401| train set 1.757x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.609605| train set 1.757x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.292354| train set 1.776x speedup, test set 1.750x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.676659| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.062817| train set 1.779x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.779798| train set 1.776x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.453740| train set 1.776x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.610748| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 8.924825| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 8.896292| train set 1.791x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.554385| train set 1.766x speedup, test set 5.909x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.486099| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.196498| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.439408| train set 1.696x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.059506| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.990645| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.317632| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.663159| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 8.878268| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.552756| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.094788| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.897232| train set 1.776x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.376307| train set 1.776x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.165593| train set 1.696x speedup, test set 1.884x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.178078| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.869929| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.333045| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 8.903195| train set 1.790x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.664679| train set 1.790x speedup, test set 1.861x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 8.760378| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.690382| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 9.867352| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.052820| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.195448| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.589938| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.947486| train set 1.791x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.201267| train set 1.791x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.010972| train set 1.791x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.735084| train set 1.776x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.150935| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.134483| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.327468| train set 1.810x speedup, test set 8.563x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.229254| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.614822| train set 1.651x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.106216| train set 1.776x speedup, test set 1.829x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.227665| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.915633| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.438522| train set 1.679x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.360099| train set 1.696x speedup, test set 7.373x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.829262| train set 1.810x speedup, test set 1.645x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 8.066424| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 9.940657| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.097030| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.447517| train set 1.791x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.225545| train set 1.791x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 10.881907| train set 1.810x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.593885| train set 1.810x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.352983| train set 1.810x speedup, test set 6.921x speedup, val set 0.450x speedup, step: 17
Epoch 120/200 |loss: 8.397814| train set 1.776x speedup, test set 6.921x speedup, val set 0.450x speedup, step: 18
Epoch 121/200 |loss: 9.511163| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 19
Epoch 122/200 |loss: 9.404153| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 20
Epoch 123/200 |loss: 9.105563| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 21
Epoch 124/200 |loss: 9.130871| train set 1.757x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 22
Epoch 125/200 |loss: 8.636299| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 23
Epoch 126/200 |loss: 8.318243| train set 1.790x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 24
Epoch 127/200 |loss: 7.717532| train set 1.776x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 25
Epoch 128/200 |loss: 8.907598| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 26
Epoch 129/200 |loss: 8.487339| train set 1.776x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 27
Epoch 130/200 |loss: 8.787807| train set 1.810x speedup, test set 1.829x speedup, val set 0.296x speedup, step: 28
Epoch 131/200 |loss: 8.684209| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 29
Epoch 132/200 |loss: 7.966023| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 30
Epoch 133/200 |loss: 8.278058| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 31
Epoch 134/200 |loss: 8.846536| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 32
Epoch 135/200 |loss: 8.043756| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 33
Epoch 136/200 |loss: 7.947123| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 34
Epoch 137/200 |loss: 8.062796| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 35
Epoch 138/200 |loss: 6.945698| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 36
Epoch 139/200 |loss: 7.082078| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 37
Epoch 140/200 |loss: 6.748492| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 38
Epoch 141/200 |loss: 10.231701| train set 1.776x speedup, test set 6.756x speedup, val set 0.296x speedup, step: 39
Epoch 142/200 |loss: 7.883507| train set 1.776x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 40
Epoch 143/200 |loss: 8.039771| train set 1.791x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 41
Epoch 144/200 |loss: 9.292085| train set 1.790x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 42
Epoch 145/200 |loss: 9.281000| train set 1.756x speedup, test set 5.480x speedup, val set 0.296x speedup, step: 43
Epoch 146/200 |loss: 7.111187| train set 1.757x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 44
Epoch 147/200 |loss: 9.353179| train set 1.790x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 45
Epoch 148/200 |loss: 6.947395| train set 1.776x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 46
Epoch 149/200 |loss: 8.649477| train set 1.810x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 47
Epoch 150/200 |loss: 8.562922| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 48
Epoch 151/200 |loss: 9.070825| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 49
Epoch 152/200 |loss: 7.776462| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 50
Epoch 153/200 |loss: 7.274731| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 51
Epoch 154/200 |loss: 8.409024| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 52
Epoch 155/200 |loss: 7.494566| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 53
Epoch 156/200 |loss: 7.296966| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 54
Epoch 157/200 |loss: 7.624724| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 55
Epoch 158/200 |loss: 9.749621| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 56
Epoch 159/200 |loss: 9.136384| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 57
Epoch 160/200 |loss: 7.919751| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 58
Epoch 161/200 |loss: 9.389834| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 59
Epoch 162/200 |loss: 10.196362| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 60
Epoch 163/200 |loss: 7.587111| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 61
Epoch 164/200 |loss: 8.480071| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 62
Epoch 165/200 |loss: 7.827217| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 63
Epoch 166/200 |loss: 9.241520| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 64
Epoch 167/200 |loss: 8.261513| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 65
Epoch 168/200 |loss: 7.753780| train set 1.790x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 66
Epoch 169/200 |loss: 8.726529| train set 1.757x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 67
Epoch 170/200 |loss: 9.157148| train set 1.757x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 68
Epoch 171/200 |loss: 7.768478| train set 1.757x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 69
Epoch 172/200 |loss: 8.463634| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 70
Epoch 173/200 |loss: 7.820561| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 71
Epoch 174/200 |loss: 7.842642| train set 1.776x speedup, test set 6.612x speedup, val set 0.296x speedup, step: 72
Epoch 175/200 |loss: 8.669056| train set 1.776x speedup, test set 6.612x speedup, val set 0.296x speedup, step: 73
Epoch 176/200 |loss: 9.217676| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 74
Epoch 177/200 |loss: 7.999709| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 75
Epoch 178/200 |loss: 8.037811| train set 1.747x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 76
Epoch 179/200 |loss: 8.398762| train set 1.757x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 77
Epoch 180/200 |loss: 9.246510| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 78
Epoch 181/200 |loss: 8.634760| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 79
Epoch 182/200 |loss: 8.598504| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 80
Epoch 183/200 |loss: 8.816532| train set 1.790x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 81
Epoch 184/200 |loss: 7.266976| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 82
Epoch 185/200 |loss: 7.393161| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 83
Epoch 186/200 |loss: 9.140457| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 84
Epoch 187/200 |loss: 9.452767| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 85
Epoch 188/200 |loss: 6.869616| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 86
Epoch 189/200 |loss: 8.757442| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 87
Epoch 190/200 |loss: 7.738792| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 88
Epoch 191/200 |loss: 8.025827| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 89
Epoch 192/200 |loss: 9.936608| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 90
Epoch 193/200 |loss: 8.285946| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 91
Epoch 194/200 |loss: 9.005432| train set 1.776x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 92
Epoch 195/200 |loss: 9.691913| train set 1.776x speedup, test set 6.299x speedup, val set 0.296x speedup, step: 93
Epoch 196/200 |loss: 8.084267| train set 1.776x speedup, test set 6.299x speedup, val set 0.296x speedup, step: 94
Epoch 197/200 |loss: 8.064159| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 95
Epoch 198/200 |loss: 8.824965| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 96
Epoch 199/200 |loss: 8.409296| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 97
Training per epoch cost 0.317 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 56.876s, pg runtime 91.784s, speedup 1.614x
02, opt runtime 29.763s, model runtime 55.506s, pg runtime 91.648s, speedup 1.651x
03, opt runtime 30.267s, model runtime 57.401s, pg runtime 100.885s, speedup 1.758x
04, opt runtime 29.286s, model runtime 58.701s, pg runtime 92.131s, speedup 1.569x
05, opt runtime 29.269s, model runtime 57.330s, pg runtime 91.296s, speedup 1.592x
06, opt runtime 29.502s, model runtime 60.311s, pg runtime 112.305s, speedup 1.862x
07, opt runtime 27.886s, model runtime 58.497s, pg runtime 97.629s, speedup 1.669x
08, opt runtime 30.705s, model runtime 56.560s, pg runtime 89.698s, speedup 1.586x
09, opt runtime 27.651s, model runtime 58.506s, pg runtime 91.255s, speedup 1.560x
10, opt runtime 33.637s, model runtime 57.182s, pg runtime 90.618s, speedup 1.585x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 33.598s, pg runtime 601.866s, speedup 17.914x
22, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
23, opt runtime 24.662s, model runtime 32.192s, pg runtime 613.999s, speedup 19.073x
24, opt runtime 24.459s, model runtime 32.532s, pg runtime 608.717s, speedup 18.711x
25, opt runtime 25.236s, model runtime 33.141s, pg runtime 601.756s, speedup 18.157x
26, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
27, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
28, opt runtime 25.075s, model runtime 32.865s, pg runtime 612.430s, speedup 18.635x
29, opt runtime 24.840s, model runtime 32.681s, pg runtime 626.529s, speedup 19.171x
30, opt runtime 24.920s, model runtime 32.473s, pg runtime 610.993s, speedup 18.816x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 69, train speedup 1.810, test speedup 2.526, val speedup 0.296
best test speedup epoch: 86, train speedup 1.810, test speedup 8.607, val speedup 0.296
best validation speedup epoch: 103, train speedup 1.810, test speedup 8.563, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 6.949, val speedup 0.296
execution cost 0:02:39.639021
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.343045, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406723| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027798| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935156| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438596| train set 1.142x speedup, test set 1.782x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477203| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149718| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990744| train set 1.383x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259748| train set 1.225x speedup, test set 1.672x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653831| train set 1.417x speedup, test set 1.657x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351113| train set 1.478x speedup, test set 1.646x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908954| train set 1.416x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132315| train set 1.367x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.265417| train set 1.435x speedup, test set 1.195x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.362810| train set 1.550x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.807595| train set 1.623x speedup, test set 2.549x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.399991| train set 1.663x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.527073| train set 1.663x speedup, test set 0.994x speedup, val set 0.374x speedup, step: 18
Epoch 18/200 |loss: 11.397221| train set 1.790x speedup, test set 1.033x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.567636| train set 1.790x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.169208| train set 1.810x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.756187| train set 1.810x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.412371| train set 1.810x speedup, test set 1.929x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.279634| train set 1.790x speedup, test set 6.906x speedup, val set 0.450x speedup, step: 24
Epoch 24/200 |loss: 12.210500| train set 1.762x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 25
Epoch 25/200 |loss: 9.754775| train set 1.766x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.787805| train set 1.810x speedup, test set 2.524x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 12.141908| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.529025| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.107503| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.342379| train set 1.791x speedup, test set 2.366x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.908835| train set 1.791x speedup, test set 2.366x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.668920| train set 1.694x speedup, test set 2.366x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.090188| train set 1.810x speedup, test set 1.171x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.552754| train set 1.810x speedup, test set 2.366x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.961408| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.747992| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.329776| train set 1.664x speedup, test set 2.366x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.663492| train set 1.766x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 9.033799| train set 1.810x speedup, test set 2.359x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.872891| train set 1.680x speedup, test set 2.553x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.808064| train set 1.678x speedup, test set 2.553x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.328014| train set 1.776x speedup, test set 1.638x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.714021| train set 1.791x speedup, test set 1.004x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.170221| train set 1.791x speedup, test set 0.984x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.626300| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.530523| train set 1.711x speedup, test set 2.524x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.514020| train set 1.595x speedup, test set 2.682x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.855173| train set 1.776x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.278154| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.943966| train set 1.790x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.132630| train set 1.790x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.806634| train set 1.747x speedup, test set 0.976x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.297812| train set 1.810x speedup, test set 1.657x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.866026| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.981268| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.335250| train set 1.757x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.638684| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.016140| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.466916| train set 1.810x speedup, test set 1.682x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.589161| train set 1.810x speedup, test set 1.709x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.708792| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.068053| train set 1.757x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.611737| train set 1.776x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.184234| train set 1.680x speedup, test set 2.165x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.956505| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.163759| train set 1.765x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.899969| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.446463| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.719703| train set 1.696x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.108851| train set 1.696x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.087826| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.484074| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.857677| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.415340| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.586603| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.010179| train set 1.791x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.861449| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.313569| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.750957| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 8.968401| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.439470| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.156307| train set 1.774x speedup, test set 1.884x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 8.141739| train set 1.808x speedup, test set 2.626x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.506502| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.150377| train set 1.696x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.558020| train set 1.810x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.816926| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.452308| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.085886| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.619831| train set 1.810x speedup, test set 1.771x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.178249| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.766039| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.203079| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.241313| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.207607| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.812140| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.051942| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.232434| train set 1.791x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.788930| train set 1.791x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.880990| train set 1.766x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.166944| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.052808| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.699237| train set 1.810x speedup, test set 1.825x speedup, val set 0.450x speedup, step: 1
Epoch 104/200 |loss: 8.934729| train set 1.776x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.538411| train set 1.776x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.417360| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.322244| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.633254| train set 1.711x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.402362| train set 1.711x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.290979| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.664084| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 7.933470| train set 1.810x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 9.898050| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 8.847509| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.567986| train set 1.790x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.136655| train set 1.790x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 10.912109| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.469329| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.206838| train set 1.810x speedup, test set 6.921x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.196652| train set 1.810x speedup, test set 6.949x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.362293| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 2
Epoch 122/200 |loss: 9.488759| train set 1.791x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 3
Epoch 123/200 |loss: 8.861210| train set 1.791x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 4
Epoch 124/200 |loss: 8.589008| train set 1.716x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 5
Epoch 125/200 |loss: 8.769258| train set 1.776x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 6
Epoch 126/200 |loss: 8.135484| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 7
Epoch 127/200 |loss: 7.737844| train set 1.776x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 8
Epoch 128/200 |loss: 8.741447| train set 1.776x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 9
Epoch 129/200 |loss: 8.420383| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 10
Epoch 130/200 |loss: 8.459714| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 11
Epoch 131/200 |loss: 8.635561| train set 1.791x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 12
Epoch 132/200 |loss: 8.076454| train set 1.791x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 13
Epoch 133/200 |loss: 8.505704| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 14
Epoch 134/200 |loss: 8.875974| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 15
Epoch 135/200 |loss: 8.101464| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 16
Epoch 136/200 |loss: 7.897874| train set 1.776x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 17
Epoch 137/200 |loss: 7.977301| train set 1.776x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 18
Epoch 138/200 |loss: 6.928625| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 19
Epoch 139/200 |loss: 7.321025| train set 1.696x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 20
Epoch 140/200 |loss: 6.849980| train set 1.810x speedup, test set 1.829x speedup, val set 0.296x speedup, step: 21
Epoch 141/200 |loss: 10.122129| train set 1.776x speedup, test set 1.741x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.254566| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.509073| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.469903| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.421153| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.028311| train set 1.776x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.266564| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.134963| train set 1.810x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 8.748444| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.541883| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.200472| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 7.729654| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.231450| train set 1.810x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.545109| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 1
Epoch 155/200 |loss: 7.778020| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 2
Epoch 156/200 |loss: 7.303898| train set 1.810x speedup, test set 5.386x speedup, val set 0.296x speedup, step: 3
Epoch 157/200 |loss: 7.880202| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 4
Epoch 158/200 |loss: 10.068298| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 5
Epoch 159/200 |loss: 9.336361| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 6
Epoch 160/200 |loss: 7.990032| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 7
Epoch 161/200 |loss: 9.677025| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 8
Epoch 162/200 |loss: 10.385246| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 9
Epoch 163/200 |loss: 7.790016| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 10
Epoch 164/200 |loss: 8.690488| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 11
Epoch 165/200 |loss: 8.180648| train set 1.810x speedup, test set 5.569x speedup, val set 0.296x speedup, step: 12
Epoch 166/200 |loss: 9.286576| train set 1.810x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 13
Epoch 167/200 |loss: 8.055732| train set 1.810x speedup, test set 5.569x speedup, val set 0.296x speedup, step: 14
Epoch 168/200 |loss: 7.779480| train set 1.790x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 15
Epoch 169/200 |loss: 8.848701| train set 1.790x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 16
Epoch 170/200 |loss: 9.361449| train set 1.757x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 17
Epoch 171/200 |loss: 7.768465| train set 1.758x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 18
Epoch 172/200 |loss: 8.439037| train set 1.791x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 19
Epoch 173/200 |loss: 8.005252| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 20
Epoch 174/200 |loss: 7.937979| train set 1.775x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 21
Epoch 175/200 |loss: 8.872757| train set 1.775x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 22
Epoch 176/200 |loss: 9.241562| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 23
Epoch 177/200 |loss: 8.237986| train set 1.790x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 24
Epoch 178/200 |loss: 8.012755| train set 1.757x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 25
Epoch 179/200 |loss: 8.465768| train set 1.757x speedup, test set 6.949x speedup, val set 0.477x speedup, step: 1
Epoch 180/200 |loss: 9.317511| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 2
Epoch 181/200 |loss: 8.786652| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 3
Epoch 182/200 |loss: 8.802825| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 4
Epoch 183/200 |loss: 8.822158| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 5
Epoch 184/200 |loss: 7.276022| train set 1.810x speedup, test set 6.949x speedup, val set 0.477x speedup, step: 1
Epoch 185/200 |loss: 7.585570| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 2
Epoch 186/200 |loss: 8.897863| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 3
Epoch 187/200 |loss: 9.586111| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 4
Epoch 188/200 |loss: 6.971059| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 5
Epoch 189/200 |loss: 8.478492| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 6
Epoch 190/200 |loss: 7.707472| train set 1.810x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 7
Epoch 191/200 |loss: 7.923749| train set 1.776x speedup, test set 6.933x speedup, val set 0.296x speedup, step: 8
Epoch 192/200 |loss: 9.783505| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 9
Epoch 193/200 |loss: 8.300142| train set 1.757x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 10
Epoch 194/200 |loss: 9.249078| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 11
Epoch 195/200 |loss: 9.748172| train set 1.776x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 12
Epoch 196/200 |loss: 8.132091| train set 1.810x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 13
Epoch 197/200 |loss: 8.103059| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 14
Epoch 198/200 |loss: 8.934023| train set 1.791x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 15
Epoch 199/200 |loss: 8.589354| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 16
Training per epoch cost 0.310 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 73, train speedup 1.810, test speedup 1.738, val speedup 0.296
best test speedup epoch: 65, train speedup 1.810, test speedup 8.607, val speedup 0.296
best validation speedup epoch: 184, train speedup 1.810, test speedup 6.949, val speedup 0.477
last model at epoch 199, train speedup 1.810, test speedup 1.739, val speedup 0.296
execution cost 0:02:37.051746
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.297898, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406736| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027803| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936134| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435114| train set 1.200x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472637| train set 1.142x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150177| train set 1.352x speedup, test set 1.782x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997663| train set 1.383x speedup, test set 1.782x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.317591| train set 1.225x speedup, test set 1.671x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.691855| train set 1.417x speedup, test set 1.649x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.373310| train set 1.370x speedup, test set 1.646x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.951848| train set 1.335x speedup, test set 2.335x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.190176| train set 1.367x speedup, test set 1.990x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.241402| train set 1.435x speedup, test set 0.984x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.425594| train set 1.550x speedup, test set 2.387x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.913957| train set 1.620x speedup, test set 2.549x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.550939| train set 1.550x speedup, test set 2.524x speedup, val set 0.437x speedup, step: 17
Epoch 17/200 |loss: 10.479389| train set 1.680x speedup, test set 0.994x speedup, val set 0.437x speedup, step: 18
Epoch 18/200 |loss: 11.347580| train set 1.766x speedup, test set 1.216x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.598114| train set 1.790x speedup, test set 1.211x speedup, val set 0.477x speedup, step: 20
Epoch 20/200 |loss: 12.553696| train set 1.679x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.745358| train set 1.810x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.542923| train set 1.810x speedup, test set 1.216x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.137551| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 11.860818| train set 1.806x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.875315| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.879812| train set 1.733x speedup, test set 1.645x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 12.034174| train set 1.663x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.887834| train set 1.790x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.035143| train set 1.766x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.886769| train set 1.810x speedup, test set 2.528x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 10.069733| train set 1.790x speedup, test set 2.524x speedup, val set 0.450x speedup, step: 32
Epoch 32/200 |loss: 10.017427| train set 1.694x speedup, test set 1.171x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.258064| train set 1.790x speedup, test set 1.171x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.652170| train set 1.790x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.038233| train set 1.810x speedup, test set 1.564x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 9.067549| train set 1.810x speedup, test set 1.171x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.520545| train set 1.791x speedup, test set 1.033x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.495090| train set 1.810x speedup, test set 1.005x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.903924| train set 1.766x speedup, test set 1.211x speedup, val set 0.426x speedup, step: 40
Epoch 40/200 |loss: 8.876097| train set 1.810x speedup, test set 2.528x speedup, val set 0.477x speedup, step: 41
Epoch 41/200 |loss: 10.663596| train set 1.680x speedup, test set 2.721x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.499084| train set 1.776x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.318752| train set 1.766x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.834207| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.200088| train set 1.681x speedup, test set 1.634x speedup, val set 0.477x speedup, step: 46
Epoch 46/200 |loss: 9.987045| train set 1.711x speedup, test set 1.634x speedup, val set 0.477x speedup, step: 47
Epoch 47/200 |loss: 9.374957| train set 1.711x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.344372| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.124054| train set 1.766x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.664407| train set 1.791x speedup, test set 2.533x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.935736| train set 1.791x speedup, test set 1.636x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.641658| train set 1.716x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.325352| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.789086| train set 1.810x speedup, test set 1.272x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.097041| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.079158| train set 1.776x speedup, test set 1.713x speedup, val set 0.477x speedup, step: 57
Epoch 57/200 |loss: 9.897024| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.013708| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.762598| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.533208| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.174277| train set 1.790x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.200469| train set 1.757x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.666959| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.295561| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.002504| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.292749| train set 1.766x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.851542| train set 1.776x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.347400| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.823452| train set 1.679x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.064827| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.008771| train set 1.790x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.535362| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.485207| train set 1.810x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.456010| train set 1.810x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.543474| train set 1.696x speedup, test set 1.638x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.200659| train set 1.810x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.893327| train set 1.810x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.400197| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.529204| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.082683| train set 1.810x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.533052| train set 1.810x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.083927| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 8.094141| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.627129| train set 1.810x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.306337| train set 1.696x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.141598| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.972764| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.324969| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.277854| train set 1.791x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.598200| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.365533| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.976529| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.434121| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.453749| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.590525| train set 1.791x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.805534| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.960043| train set 1.776x speedup, test set 1.642x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.554857| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.773234| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.002920| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 8.878846| train set 1.810x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.069127| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.573072| train set 1.810x speedup, test set 1.713x speedup, val set 0.398x speedup, step: 1
Epoch 104/200 |loss: 8.883974| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.384699| train set 1.776x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.347827| train set 1.776x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.157368| train set 1.776x speedup, test set 1.254x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.701313| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.816019| train set 1.696x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.234298| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.796087| train set 1.810x speedup, test set 1.171x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 8.442195| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 10.425383| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.297811| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.677469| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.137314| train set 1.790x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 10.996083| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.405771| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.464837| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 17
Epoch 120/200 |loss: 8.050786| train set 1.810x speedup, test set 1.352x speedup, val set 0.296x speedup, step: 18
Epoch 121/200 |loss: 9.381169| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 19
Epoch 122/200 |loss: 9.626343| train set 1.791x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 20
Epoch 123/200 |loss: 9.031173| train set 1.790x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 21
Epoch 124/200 |loss: 8.974503| train set 1.757x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 22
Epoch 125/200 |loss: 8.883527| train set 1.776x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 23
Epoch 126/200 |loss: 8.146307| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 24
Epoch 127/200 |loss: 7.800109| train set 1.810x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 25
Epoch 128/200 |loss: 8.796224| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 26
Epoch 129/200 |loss: 8.605812| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 27
Epoch 130/200 |loss: 8.493229| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 28
Epoch 131/200 |loss: 8.898029| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 29
Epoch 132/200 |loss: 8.117696| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 30
Epoch 133/200 |loss: 8.411644| train set 1.791x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 31
Epoch 134/200 |loss: 9.025508| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 32
Epoch 135/200 |loss: 7.976562| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 33
Epoch 136/200 |loss: 7.977299| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 34
Epoch 137/200 |loss: 8.029129| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 35
Epoch 138/200 |loss: 6.970537| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 36
Epoch 139/200 |loss: 7.322114| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 37
Epoch 140/200 |loss: 6.825861| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 38
Epoch 141/200 |loss: 10.279191| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 39
Epoch 142/200 |loss: 8.069990| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 40
Epoch 143/200 |loss: 8.329312| train set 1.791x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 41
Epoch 144/200 |loss: 9.522875| train set 1.790x speedup, test set 1.005x speedup, val set 0.296x speedup, step: 42
Epoch 145/200 |loss: 9.397092| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 43
Epoch 146/200 |loss: 7.086164| train set 1.757x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 44
Epoch 147/200 |loss: 9.276526| train set 1.790x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 45
Epoch 148/200 |loss: 6.901226| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 46
Epoch 149/200 |loss: 8.621342| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 47
Epoch 150/200 |loss: 8.657462| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 48
Epoch 151/200 |loss: 8.838946| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 49
Epoch 152/200 |loss: 7.558133| train set 1.776x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 50
Epoch 153/200 |loss: 7.212988| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 51
Epoch 154/200 |loss: 8.401464| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 52
Epoch 155/200 |loss: 7.443214| train set 1.810x speedup, test set 1.012x speedup, val set 0.296x speedup, step: 53
Epoch 156/200 |loss: 7.331259| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 54
Epoch 157/200 |loss: 7.636803| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 55
Epoch 158/200 |loss: 9.757493| train set 1.776x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 56
Epoch 159/200 |loss: 9.324861| train set 1.810x speedup, test set 1.829x speedup, val set 0.296x speedup, step: 57
Epoch 160/200 |loss: 7.973331| train set 1.810x speedup, test set 1.829x speedup, val set 0.296x speedup, step: 58
Epoch 161/200 |loss: 9.447928| train set 1.810x speedup, test set 1.829x speedup, val set 0.296x speedup, step: 59
Epoch 162/200 |loss: 10.625257| train set 1.776x speedup, test set 1.012x speedup, val set 0.296x speedup, step: 60
Epoch 163/200 |loss: 7.945364| train set 1.810x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 61
Epoch 164/200 |loss: 8.455639| train set 1.810x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 62
Epoch 165/200 |loss: 7.930674| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 63
Epoch 166/200 |loss: 8.961160| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 64
Epoch 167/200 |loss: 8.332090| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 65
Epoch 168/200 |loss: 7.806452| train set 1.790x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 66
Epoch 169/200 |loss: 8.820746| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 67
Epoch 170/200 |loss: 9.032165| train set 1.757x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 68
Epoch 171/200 |loss: 7.908517| train set 1.758x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 69
Epoch 172/200 |loss: 8.810576| train set 1.791x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 70
Epoch 173/200 |loss: 7.875211| train set 1.791x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 71
Epoch 174/200 |loss: 8.110660| train set 1.776x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 72
Epoch 175/200 |loss: 8.609755| train set 1.775x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 73
Epoch 176/200 |loss: 9.397882| train set 1.810x speedup, test set 1.829x speedup, val set 0.296x speedup, step: 74
Epoch 177/200 |loss: 8.301483| train set 1.791x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 75
Epoch 178/200 |loss: 7.952265| train set 1.747x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 76
Epoch 179/200 |loss: 8.543520| train set 1.757x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 77
Epoch 180/200 |loss: 9.055459| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 78
Epoch 181/200 |loss: 8.728684| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 79
Epoch 182/200 |loss: 8.547031| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 80
Epoch 183/200 |loss: 8.898101| train set 1.791x speedup, test set 1.860x speedup, val set 0.296x speedup, step: 81
Epoch 184/200 |loss: 7.260646| train set 1.810x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 82
Epoch 185/200 |loss: 7.392104| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 83
Epoch 186/200 |loss: 9.492176| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 84
Epoch 187/200 |loss: 9.592308| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 85
Epoch 188/200 |loss: 7.081671| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 86
Epoch 189/200 |loss: 9.045615| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 87
Epoch 190/200 |loss: 7.728705| train set 1.810x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 88
Epoch 191/200 |loss: 8.123977| train set 1.776x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 89
Epoch 192/200 |loss: 10.276418| train set 1.776x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 90
Epoch 193/200 |loss: 8.558443| train set 1.790x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 91
Epoch 194/200 |loss: 9.208900| train set 1.776x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 92
Epoch 195/200 |loss: 9.662850| train set 1.776x speedup, test set 1.016x speedup, val set 0.296x speedup, step: 93
Epoch 196/200 |loss: 8.333816| train set 1.776x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 94
Epoch 197/200 |loss: 8.150663| train set 1.791x speedup, test set 1.829x speedup, val set 0.296x speedup, step: 95
Epoch 198/200 |loss: 8.877840| train set 1.791x speedup, test set 1.829x speedup, val set 0.296x speedup, step: 96
Epoch 199/200 |loss: 8.444517| train set 1.791x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 97
Training per epoch cost 0.322 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 56.876s, pg runtime 91.784s, speedup 1.614x
02, opt runtime 29.763s, model runtime 55.506s, pg runtime 91.648s, speedup 1.651x
03, opt runtime 30.267s, model runtime 57.401s, pg runtime 100.885s, speedup 1.758x
04, opt runtime 29.286s, model runtime 58.701s, pg runtime 92.131s, speedup 1.569x
05, opt runtime 29.269s, model runtime 57.330s, pg runtime 91.296s, speedup 1.592x
06, opt runtime 29.502s, model runtime 60.311s, pg runtime 112.305s, speedup 1.862x
07, opt runtime 27.886s, model runtime 58.497s, pg runtime 97.629s, speedup 1.669x
08, opt runtime 30.705s, model runtime 56.560s, pg runtime 89.698s, speedup 1.586x
09, opt runtime 27.651s, model runtime 58.506s, pg runtime 91.255s, speedup 1.560x
10, opt runtime 33.637s, model runtime 57.182s, pg runtime 90.618s, speedup 1.585x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 318.834s, pg runtime 601.866s, speedup 1.888x
22, opt runtime 24.079s, model runtime 320.574s, pg runtime 608.707s, speedup 1.899x
23, opt runtime 24.662s, model runtime 317.659s, pg runtime 613.999s, speedup 1.933x
24, opt runtime 24.459s, model runtime 316.659s, pg runtime 608.717s, speedup 1.922x
25, opt runtime 25.236s, model runtime 324.062s, pg runtime 601.756s, speedup 1.857x
26, opt runtime 25.363s, model runtime 312.889s, pg runtime 611.327s, speedup 1.954x
27, opt runtime 24.706s, model runtime 329.304s, pg runtime 610.808s, speedup 1.855x
28, opt runtime 25.075s, model runtime 339.226s, pg runtime 612.430s, speedup 1.805x
29, opt runtime 24.840s, model runtime 330.901s, pg runtime 626.529s, speedup 1.893x
30, opt runtime 24.920s, model runtime 318.881s, pg runtime 610.993s, speedup 1.916x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 88, train speedup 1.810, test speedup 1.253, val speedup 0.296
best test speedup epoch: 193, train speedup 1.790, test speedup 8.607, val speedup 0.296
best validation speedup epoch: 103, train speedup 1.810, test speedup 1.713, val speedup 0.398
last model at epoch 199, train speedup 1.791, test speedup 1.741, val speedup 0.296
execution cost 0:02:39.379930
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.324160, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406727| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027799| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935156| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438597| train set 1.142x speedup, test set 1.782x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477203| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149718| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990746| train set 1.383x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259750| train set 1.225x speedup, test set 1.672x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653832| train set 1.417x speedup, test set 1.657x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351127| train set 1.478x speedup, test set 1.646x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908977| train set 1.416x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132776| train set 1.367x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.264631| train set 1.435x speedup, test set 1.195x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.360422| train set 1.471x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.802037| train set 1.623x speedup, test set 2.549x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.402994| train set 1.663x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.528696| train set 1.663x speedup, test set 0.994x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.437760| train set 1.790x speedup, test set 1.033x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.562121| train set 1.790x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.220326| train set 1.806x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.821794| train set 1.810x speedup, test set 2.524x speedup, val set 0.404x speedup, step: 22
Epoch 22/200 |loss: 11.655267| train set 1.810x speedup, test set 1.573x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.580095| train set 1.764x speedup, test set 6.934x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.296921| train set 1.810x speedup, test set 2.524x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.560810| train set 1.542x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 11.118134| train set 1.542x speedup, test set 1.634x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.672589| train set 1.810x speedup, test set 2.524x speedup, val set 0.450x speedup, step: 28
Epoch 28/200 |loss: 10.230651| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.942143| train set 1.790x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.164589| train set 1.791x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.838987| train set 1.791x speedup, test set 2.363x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.650937| train set 1.694x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.204811| train set 1.711x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.094850| train set 1.696x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.910780| train set 1.776x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.631404| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.463515| train set 1.790x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.244676| train set 1.810x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.908988| train set 1.810x speedup, test set 1.986x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.622308| train set 1.810x speedup, test set 2.528x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.742739| train set 1.810x speedup, test set 1.253x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.824216| train set 1.757x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.741673| train set 1.747x speedup, test set 1.263x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.339990| train set 1.791x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.936765| train set 1.776x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.341533| train set 1.711x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.929162| train set 1.680x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.864463| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.043466| train set 1.776x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.571813| train set 1.810x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.055177| train set 1.747x speedup, test set 1.291x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.749804| train set 1.747x speedup, test set 1.263x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.406850| train set 1.810x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.791691| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.107561| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.729238| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.678041| train set 1.790x speedup, test set 8.582x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.277393| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.769182| train set 1.766x speedup, test set 0.994x speedup, val set 0.275x speedup, step: 60
Epoch 60/200 |loss: 10.061040| train set 1.810x speedup, test set 1.005x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.081883| train set 1.791x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.827347| train set 1.791x speedup, test set 1.310x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.838917| train set 1.757x speedup, test set 1.310x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.723655| train set 1.664x speedup, test set 3.007x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.000048| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.590115| train set 1.766x speedup, test set 3.007x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.859252| train set 1.734x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.570154| train set 1.810x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.751723| train set 1.680x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.059749| train set 1.696x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.135192| train set 1.790x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.833075| train set 1.790x speedup, test set 8.319x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.761143| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.179008| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.595099| train set 1.810x speedup, test set 1.961x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 7.903260| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.986686| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.497804| train set 1.810x speedup, test set 1.884x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.833725| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.154960| train set 1.810x speedup, test set 1.310x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.545478| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.209651| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.859056| train set 1.810x speedup, test set 1.340x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.495017| train set 1.810x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.241148| train set 1.696x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.318157| train set 1.810x speedup, test set 1.310x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.829548| train set 1.776x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.403449| train set 1.791x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.068044| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.688595| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.228374| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.818678| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.461269| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.438628| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.455572| train set 1.791x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.792435| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.743186| train set 1.776x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.543543| train set 1.791x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.743221| train set 1.791x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.958678| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 8.956265| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.174728| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.719604| train set 1.810x speedup, test set 1.825x speedup, val set 0.450x speedup, step: 1
Epoch 104/200 |loss: 8.947480| train set 1.776x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.590172| train set 1.666x speedup, test set 1.310x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.283466| train set 1.776x speedup, test set 1.310x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.262161| train set 1.810x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.698093| train set 1.776x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.448303| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.555089| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.697429| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 8.171249| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 9.964034| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 8.807150| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.747246| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.456802| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 10.989556| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.439397| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.299863| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 17
Epoch 120/200 |loss: 8.067156| train set 1.810x speedup, test set 1.793x speedup, val set 0.296x speedup, step: 18
Epoch 121/200 |loss: 9.342634| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 19
Epoch 122/200 |loss: 9.514937| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 20
Epoch 123/200 |loss: 8.884707| train set 1.791x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 21
Epoch 124/200 |loss: 8.993447| train set 1.757x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 22
Epoch 125/200 |loss: 8.674782| train set 1.757x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 23
Epoch 126/200 |loss: 8.258160| train set 1.810x speedup, test set 1.180x speedup, val set 0.296x speedup, step: 24
Epoch 127/200 |loss: 7.773237| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 25
Epoch 128/200 |loss: 9.116610| train set 1.776x speedup, test set 1.010x speedup, val set 0.296x speedup, step: 26
Epoch 129/200 |loss: 8.286675| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 27
Epoch 130/200 |loss: 8.771667| train set 1.810x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 28
Epoch 131/200 |loss: 8.767610| train set 1.791x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 29
Epoch 132/200 |loss: 8.274795| train set 1.791x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 30
Epoch 133/200 |loss: 8.485034| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 31
Epoch 134/200 |loss: 9.125970| train set 1.791x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 32
Epoch 135/200 |loss: 8.364764| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 33
Epoch 136/200 |loss: 8.088225| train set 1.734x speedup, test set 1.639x speedup, val set 0.296x speedup, step: 34
Epoch 137/200 |loss: 8.202762| train set 1.776x speedup, test set 1.639x speedup, val set 0.296x speedup, step: 35
Epoch 138/200 |loss: 7.119651| train set 1.666x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 36
Epoch 139/200 |loss: 7.415423| train set 1.696x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 37
Epoch 140/200 |loss: 6.968659| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 38
Epoch 141/200 |loss: 10.337795| train set 1.776x speedup, test set 6.559x speedup, val set 0.450x speedup, step: 1
Epoch 142/200 |loss: 8.482138| train set 1.776x speedup, test set 1.639x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.528427| train set 1.676x speedup, test set 1.717x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.321897| train set 1.791x speedup, test set 1.717x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.703731| train set 1.776x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.202641| train set 1.776x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.731550| train set 1.790x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.113328| train set 1.790x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 9.429615| train set 1.810x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.658356| train set 1.776x speedup, test set 5.550x speedup, val set 0.513x speedup, step: 1
Epoch 151/200 |loss: 9.523737| train set 1.776x speedup, test set 5.550x speedup, val set 0.477x speedup, step: 2
Epoch 152/200 |loss: 7.961770| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 3
Epoch 153/200 |loss: 7.569335| train set 1.810x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 4
Epoch 154/200 |loss: 8.599006| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 5
Epoch 155/200 |loss: 7.782454| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 6
Epoch 156/200 |loss: 7.550919| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 7
Epoch 157/200 |loss: 7.536199| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 8
Epoch 158/200 |loss: 9.942394| train set 1.776x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 9
Epoch 159/200 |loss: 9.489406| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 10
Epoch 160/200 |loss: 7.456228| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 11
Epoch 161/200 |loss: 9.385757| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 12
Epoch 162/200 |loss: 10.227426| train set 1.810x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 13
Epoch 163/200 |loss: 7.624712| train set 1.810x speedup, test set 1.639x speedup, val set 0.296x speedup, step: 14
Epoch 164/200 |loss: 8.643558| train set 1.810x speedup, test set 1.639x speedup, val set 0.296x speedup, step: 15
Epoch 165/200 |loss: 7.997719| train set 1.810x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 16
Epoch 166/200 |loss: 9.107862| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 17
Epoch 167/200 |loss: 7.875175| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 18
Epoch 168/200 |loss: 7.692005| train set 1.790x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 19
Epoch 169/200 |loss: 8.706173| train set 1.757x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 20
Epoch 170/200 |loss: 9.292596| train set 1.757x speedup, test set 1.639x speedup, val set 0.296x speedup, step: 21
Epoch 171/200 |loss: 7.754144| train set 1.758x speedup, test set 1.639x speedup, val set 0.296x speedup, step: 22
Epoch 172/200 |loss: 8.615169| train set 1.791x speedup, test set 1.717x speedup, val set 0.296x speedup, step: 23
Epoch 173/200 |loss: 7.880985| train set 1.810x speedup, test set 1.717x speedup, val set 0.296x speedup, step: 24
Epoch 174/200 |loss: 7.804172| train set 1.776x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 25
Epoch 175/200 |loss: 8.648315| train set 1.776x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 26
Epoch 176/200 |loss: 9.286817| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 27
Epoch 177/200 |loss: 7.975888| train set 1.790x speedup, test set 1.717x speedup, val set 0.296x speedup, step: 28
Epoch 178/200 |loss: 8.037823| train set 1.747x speedup, test set 1.639x speedup, val set 0.296x speedup, step: 29
Epoch 179/200 |loss: 8.437541| train set 1.757x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 30
Epoch 180/200 |loss: 8.971201| train set 1.791x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 31
Epoch 181/200 |loss: 8.698877| train set 1.791x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 32
Epoch 182/200 |loss: 8.701258| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 33
Epoch 183/200 |loss: 8.672292| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 34
Epoch 184/200 |loss: 7.358915| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 35
Epoch 185/200 |loss: 7.519445| train set 1.810x speedup, test set 1.717x speedup, val set 0.296x speedup, step: 36
Epoch 186/200 |loss: 9.006311| train set 1.810x speedup, test set 1.717x speedup, val set 0.296x speedup, step: 37
Epoch 187/200 |loss: 9.480492| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 38
Epoch 188/200 |loss: 6.892976| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 39
Epoch 189/200 |loss: 8.639098| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 40
Epoch 190/200 |loss: 7.665272| train set 1.776x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 41
Epoch 191/200 |loss: 8.131628| train set 1.776x speedup, test set 5.233x speedup, val set 0.296x speedup, step: 42
Epoch 192/200 |loss: 10.140932| train set 1.776x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 43
Epoch 193/200 |loss: 8.325542| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 44
Epoch 194/200 |loss: 9.484146| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 45
Epoch 195/200 |loss: 9.832905| train set 1.776x speedup, test set 1.717x speedup, val set 0.296x speedup, step: 46
Epoch 196/200 |loss: 8.455285| train set 1.776x speedup, test set 1.699x speedup, val set 0.296x speedup, step: 47
Epoch 197/200 |loss: 8.490788| train set 1.810x speedup, test set 1.639x speedup, val set 0.296x speedup, step: 48
Epoch 198/200 |loss: 8.741744| train set 1.791x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 49
Epoch 199/200 |loss: 8.437909| train set 1.791x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 50
Training per epoch cost 0.320 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 33.598s, pg runtime 601.866s, speedup 17.914x
22, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
23, opt runtime 24.662s, model runtime 32.192s, pg runtime 613.999s, speedup 19.073x
24, opt runtime 24.459s, model runtime 32.532s, pg runtime 608.717s, speedup 18.711x
25, opt runtime 25.236s, model runtime 33.141s, pg runtime 601.756s, speedup 18.157x
26, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
27, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
28, opt runtime 25.075s, model runtime 32.865s, pg runtime 612.430s, speedup 18.635x
29, opt runtime 24.840s, model runtime 32.681s, pg runtime 626.529s, speedup 19.171x
30, opt runtime 24.920s, model runtime 32.473s, pg runtime 610.993s, speedup 18.816x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 40, train speedup 1.810, test speedup 2.528, val speedup 0.296
best test speedup epoch: 65, train speedup 1.810, test speedup 8.607, val speedup 0.296
best validation speedup epoch: 150, train speedup 1.776, test speedup 5.550, val speedup 0.513
last model at epoch 199, train speedup 1.791, test speedup 5.550, val speedup 0.296
execution cost 0:02:40.575282
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.539955, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406727| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027797| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935153| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438593| train set 1.142x speedup, test set 1.782x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477202| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149714| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990738| train set 1.383x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259737| train set 1.225x speedup, test set 1.672x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653824| train set 1.417x speedup, test set 1.657x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351105| train set 1.478x speedup, test set 1.646x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908954| train set 1.412x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132761| train set 1.367x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.264370| train set 1.435x speedup, test set 1.195x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.361891| train set 1.550x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.800315| train set 1.623x speedup, test set 2.549x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.409031| train set 1.663x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.500638| train set 1.663x speedup, test set 0.994x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.381048| train set 1.790x speedup, test set 1.033x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.540548| train set 1.790x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.197967| train set 1.806x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.768181| train set 1.810x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.523500| train set 1.810x speedup, test set 2.384x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.372115| train set 1.764x speedup, test set 6.906x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.359388| train set 1.766x speedup, test set 2.524x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.529851| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 11.218951| train set 1.809x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 27
Epoch 27/200 |loss: 11.824821| train set 1.747x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.464469| train set 1.790x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.100587| train set 1.810x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.428177| train set 1.810x speedup, test set 2.366x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.885541| train set 1.791x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.740696| train set 1.766x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.180890| train set 1.810x speedup, test set 1.280x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.451149| train set 1.790x speedup, test set 1.280x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.025213| train set 1.810x speedup, test set 1.564x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.581426| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.438687| train set 1.664x speedup, test set 2.528x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.474054| train set 1.810x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.522037| train set 1.776x speedup, test set 1.263x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.725710| train set 1.680x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.303424| train set 1.808x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.334118| train set 1.791x speedup, test set 2.524x speedup, val set 0.450x speedup, step: 43
Epoch 43/200 |loss: 11.692248| train set 1.747x speedup, test set 0.968x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.179199| train set 1.790x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.804463| train set 1.681x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.593974| train set 1.711x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.500102| train set 1.711x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.678328| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.075505| train set 1.766x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.912616| train set 1.791x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.866386| train set 1.747x speedup, test set 2.533x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 11.034191| train set 1.716x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.183619| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.914409| train set 1.776x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.990412| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.158052| train set 1.776x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.892553| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 7.890901| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.407728| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.569460| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.635259| train set 1.791x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.047280| train set 1.757x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.683276| train set 1.758x speedup, test set 1.713x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.217062| train set 1.791x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.904625| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.091387| train set 1.733x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.910365| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.589032| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.829448| train set 1.696x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.023372| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.054242| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.665467| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.606829| train set 1.766x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.299376| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.524990| train set 1.679x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.166822| train set 1.790x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.957399| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.260394| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.626963| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.064955| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.452340| train set 1.810x speedup, test set 1.791x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.032450| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.945240| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.158852| train set 1.810x speedup, test set 1.738x speedup, val set 0.450x speedup, step: 85
Epoch 85/200 |loss: 9.095203| train set 1.696x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.262769| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.834719| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.292620| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 8.870142| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.525907| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 8.944710| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.906337| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.014186| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.264527| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.316175| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.454735| train set 1.757x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.006095| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.397843| train set 1.790x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.133508| train set 1.747x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.159959| train set 1.734x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.108559| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.578477| train set 1.810x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.117369| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 1
Epoch 104/200 |loss: 9.133759| train set 1.810x speedup, test set 1.825x speedup, val set 0.477x speedup, step: 1
Epoch 105/200 |loss: 9.028549| train set 1.810x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 2
Epoch 106/200 |loss: 8.950064| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 3
Epoch 107/200 |loss: 10.486727| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 4
Epoch 108/200 |loss: 9.901752| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 109/200 |loss: 8.639713| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 6
Epoch 110/200 |loss: 8.964036| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 7
Epoch 111/200 |loss: 8.854343| train set 1.810x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 112/200 |loss: 7.651908| train set 1.810x speedup, test set 0.995x speedup, val set 0.513x speedup, step: 1
Epoch 113/200 |loss: 9.550566| train set 1.810x speedup, test set 0.995x speedup, val set 0.513x speedup, step: 1
Epoch 114/200 |loss: 8.966633| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 2
Epoch 115/200 |loss: 8.320279| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 3
Epoch 116/200 |loss: 8.218869| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 4
Epoch 117/200 |loss: 11.065300| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 118/200 |loss: 8.428672| train set 1.810x speedup, test set 1.201x speedup, val set 0.296x speedup, step: 6
Epoch 119/200 |loss: 8.322227| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 7
Epoch 120/200 |loss: 8.360292| train set 1.776x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 8
Epoch 121/200 |loss: 9.328412| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 9
Epoch 122/200 |loss: 9.249002| train set 1.791x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 10
Epoch 123/200 |loss: 9.014340| train set 1.790x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 11
Epoch 124/200 |loss: 8.797762| train set 1.757x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 12
Epoch 125/200 |loss: 8.666899| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 13
Epoch 126/200 |loss: 8.101969| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 14
Epoch 127/200 |loss: 7.666558| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 15
Epoch 128/200 |loss: 8.694458| train set 1.776x speedup, test set 1.705x speedup, val set 0.296x speedup, step: 16
Epoch 129/200 |loss: 8.548746| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 17
Epoch 130/200 |loss: 8.513366| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 18
Epoch 131/200 |loss: 8.893988| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 19
Epoch 132/200 |loss: 7.957771| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 20
Epoch 133/200 |loss: 8.340816| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 21
Epoch 134/200 |loss: 8.891296| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 22
Epoch 135/200 |loss: 8.097611| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 23
Epoch 136/200 |loss: 7.658849| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 24
Epoch 137/200 |loss: 8.099349| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 25
Epoch 138/200 |loss: 6.839344| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 26
Epoch 139/200 |loss: 7.274073| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 27
Epoch 140/200 |loss: 6.761549| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 28
Epoch 141/200 |loss: 10.149087| train set 1.776x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 29
Epoch 142/200 |loss: 7.908202| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 30
Epoch 143/200 |loss: 8.476597| train set 1.791x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 31
Epoch 144/200 |loss: 9.367340| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 32
Epoch 145/200 |loss: 9.587692| train set 1.776x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 146/200 |loss: 7.313891| train set 1.756x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 2
Epoch 147/200 |loss: 9.331998| train set 1.757x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 3
Epoch 148/200 |loss: 6.952539| train set 1.810x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 149/200 |loss: 8.833442| train set 1.810x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 150/200 |loss: 8.476055| train set 1.776x speedup, test set 1.705x speedup, val set 0.513x speedup, step: 1
Epoch 151/200 |loss: 8.902767| train set 1.776x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 152/200 |loss: 7.424906| train set 1.810x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 153/200 |loss: 7.277450| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 2
Epoch 154/200 |loss: 8.279023| train set 1.810x speedup, test set 1.739x speedup, val set 0.513x speedup, step: 1
Epoch 155/200 |loss: 7.358251| train set 1.810x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 156/200 |loss: 7.154382| train set 1.810x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 157/200 |loss: 7.581603| train set 1.790x speedup, test set 1.862x speedup, val set 0.513x speedup, step: 1
Epoch 158/200 |loss: 9.815499| train set 1.776x speedup, test set 5.550x speedup, val set 0.513x speedup, step: 1
Epoch 159/200 |loss: 9.768852| train set 1.810x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 2
Epoch 160/200 |loss: 8.147238| train set 1.791x speedup, test set 2.475x speedup, val set 0.296x speedup, step: 3
Epoch 161/200 |loss: 10.016407| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 4
Epoch 162/200 |loss: 10.669605| train set 1.810x speedup, test set 6.559x speedup, val set 0.296x speedup, step: 5
Epoch 163/200 |loss: 8.289501| train set 1.810x speedup, test set 2.278x speedup, val set 0.296x speedup, step: 6
Epoch 164/200 |loss: 8.996964| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 7
Epoch 165/200 |loss: 8.348919| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 8
Epoch 166/200 |loss: 9.371110| train set 1.810x speedup, test set 6.559x speedup, val set 0.477x speedup, step: 9
Epoch 167/200 |loss: 8.412300| train set 1.810x speedup, test set 6.559x speedup, val set 0.304x speedup, step: 10
Epoch 168/200 |loss: 8.029651| train set 1.810x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 11
Epoch 169/200 |loss: 8.992310| train set 1.791x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 12
Epoch 170/200 |loss: 9.368242| train set 1.757x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 13
Epoch 171/200 |loss: 7.857471| train set 1.758x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 14
Epoch 172/200 |loss: 8.472922| train set 1.758x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 15
Epoch 173/200 |loss: 7.812470| train set 1.776x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 16
Epoch 174/200 |loss: 8.135472| train set 1.776x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 17
Epoch 175/200 |loss: 8.693150| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 18
Epoch 176/200 |loss: 9.466575| train set 1.776x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 19
Epoch 177/200 |loss: 8.075098| train set 1.790x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 20
Epoch 178/200 |loss: 8.030200| train set 1.790x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 21
Epoch 179/200 |loss: 8.564283| train set 1.790x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 22
Epoch 180/200 |loss: 9.357334| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 23
Epoch 181/200 |loss: 8.763829| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 24
Epoch 182/200 |loss: 9.020794| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 25
Epoch 183/200 |loss: 8.910357| train set 1.810x speedup, test set 5.550x speedup, val set 0.477x speedup, step: 26
Epoch 184/200 |loss: 7.528628| train set 1.810x speedup, test set 5.550x speedup, val set 0.477x speedup, step: 27
Epoch 185/200 |loss: 7.490706| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 28
Epoch 186/200 |loss: 9.477878| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 29
Epoch 187/200 |loss: 9.634799| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 30
Epoch 188/200 |loss: 6.923956| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 31
Epoch 189/200 |loss: 8.774490| train set 1.810x speedup, test set 1.862x speedup, val set 0.296x speedup, step: 32
Epoch 190/200 |loss: 7.967293| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 33
Epoch 191/200 |loss: 8.136188| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 34
Epoch 192/200 |loss: 10.116378| train set 1.776x speedup, test set 1.756x speedup, val set 0.296x speedup, step: 35
Epoch 193/200 |loss: 8.549161| train set 1.776x speedup, test set 1.705x speedup, val set 0.296x speedup, step: 36
Epoch 194/200 |loss: 9.058214| train set 1.776x speedup, test set 1.705x speedup, val set 0.296x speedup, step: 37
Epoch 195/200 |loss: 9.735473| train set 1.776x speedup, test set 1.729x speedup, val set 0.296x speedup, step: 38
Epoch 196/200 |loss: 8.119930| train set 1.776x speedup, test set 1.705x speedup, val set 0.296x speedup, step: 39
Epoch 197/200 |loss: 8.214355| train set 1.791x speedup, test set 1.726x speedup, val set 0.296x speedup, step: 40
Epoch 198/200 |loss: 8.606633| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 41
Epoch 199/200 |loss: 8.271838| train set 1.791x speedup, test set 1.729x speedup, val set 0.513x speedup, step: 1
Training per epoch cost 0.318 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 118.456s, pg runtime 92.131s, speedup 0.778x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 33.598s, pg runtime 601.866s, speedup 17.914x
22, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
23, opt runtime 24.662s, model runtime 32.192s, pg runtime 613.999s, speedup 19.073x
24, opt runtime 24.459s, model runtime 32.532s, pg runtime 608.717s, speedup 18.711x
25, opt runtime 25.236s, model runtime 33.141s, pg runtime 601.756s, speedup 18.157x
26, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
27, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
28, opt runtime 25.075s, model runtime 32.865s, pg runtime 612.430s, speedup 18.635x
29, opt runtime 24.840s, model runtime 32.681s, pg runtime 626.529s, speedup 19.171x
30, opt runtime 24.920s, model runtime 32.473s, pg runtime 610.993s, speedup 18.816x
31, opt runtime 16.268s, model runtime 580.359s, pg runtime 432.766s, speedup 0.746x
32, opt runtime 15.120s, model runtime 580.203s, pg runtime 566.078s, speedup 0.976x
33, opt runtime 16.639s, model runtime 576.339s, pg runtime 462.544s, speedup 0.803x
34, opt runtime 16.280s, model runtime 615.635s, pg runtime 634.990s, speedup 1.031x
35, opt runtime 16.528s, model runtime 616.056s, pg runtime 620.762s, speedup 1.008x
36, opt runtime 18.690s, model runtime 637.615s, pg runtime 651.942s, speedup 1.022x
37, opt runtime 16.438s, model runtime 583.941s, pg runtime 546.887s, speedup 0.937x
38, opt runtime 16.138s, model runtime 572.741s, pg runtime 501.793s, speedup 0.876x
39, opt runtime 16.770s, model runtime 617.719s, pg runtime 594.754s, speedup 0.963x
40, opt runtime 16.305s, model runtime 577.424s, pg runtime 436.168s, speedup 0.755x
====================
best train speedup epoch: 25, train speedup 1.810, test speedup 1.211, val speedup 0.296
best test speedup epoch: 23, train speedup 1.764, test speedup 6.906, val speedup 0.296
best validation speedup epoch: 199, train speedup 1.791, test speedup 1.729, val speedup 0.513
last model at epoch 199, train speedup 1.791, test speedup 1.729, val speedup 0.513
execution cost 0:02:40.250395
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.501696, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406727| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027796| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935153| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438592| train set 1.142x speedup, test set 1.782x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477202| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149711| train set 1.306x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990734| train set 1.383x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259732| train set 1.225x speedup, test set 1.672x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653821| train set 1.417x speedup, test set 1.657x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351100| train set 1.478x speedup, test set 1.646x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908951| train set 1.412x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132760| train set 1.367x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.264368| train set 1.435x speedup, test set 1.195x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.361890| train set 1.550x speedup, test set 1.195x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.800316| train set 1.623x speedup, test set 2.549x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.409026| train set 1.663x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.500640| train set 1.663x speedup, test set 0.994x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.381045| train set 1.790x speedup, test set 1.033x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.540550| train set 1.790x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.197966| train set 1.806x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.768181| train set 1.810x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.523500| train set 1.810x speedup, test set 2.384x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.372114| train set 1.764x speedup, test set 6.906x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.359393| train set 1.766x speedup, test set 2.524x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.529847| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 11.218957| train set 1.809x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 27
Epoch 27/200 |loss: 11.824815| train set 1.747x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.464473| train set 1.790x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.100630| train set 1.810x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.427480| train set 1.810x speedup, test set 2.366x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.881214| train set 1.790x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.738785| train set 1.766x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.171771| train set 1.810x speedup, test set 1.327x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.439650| train set 1.790x speedup, test set 1.280x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.003335| train set 1.810x speedup, test set 1.564x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.593736| train set 1.810x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.430363| train set 1.791x speedup, test set 2.528x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.478362| train set 1.810x speedup, test set 1.263x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.539447| train set 1.776x speedup, test set 1.263x speedup, val set 0.426x speedup, step: 40
Epoch 40/200 |loss: 8.653898| train set 1.680x speedup, test set 1.737x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.339280| train set 1.810x speedup, test set 0.968x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.464662| train set 1.791x speedup, test set 1.657x speedup, val set 0.450x speedup, step: 43
Epoch 43/200 |loss: 11.824450| train set 1.791x speedup, test set 0.968x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.006322| train set 1.791x speedup, test set 0.968x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.812200| train set 1.681x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.333506| train set 1.711x speedup, test set 2.524x speedup, val set 0.477x speedup, step: 47
Epoch 47/200 |loss: 9.466558| train set 1.711x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.743073| train set 1.810x speedup, test set 0.992x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.874690| train set 1.810x speedup, test set 0.968x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.930961| train set 1.810x speedup, test set 1.660x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.849036| train set 1.679x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.798515| train set 1.747x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.306136| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 10.002392| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.950082| train set 1.776x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.417127| train set 1.757x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.645030| train set 1.790x speedup, test set 1.741x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.129623| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.556844| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.513003| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.794298| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.120295| train set 1.757x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.770425| train set 1.757x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.041580| train set 1.680x speedup, test set 2.721x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.063488| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.160881| train set 1.733x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.512448| train set 1.776x speedup, test set 1.264x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.330712| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.689287| train set 1.696x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 8.876760| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 8.923265| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.471390| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.606678| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.223805| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.338456| train set 1.679x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.115750| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.810651| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.365587| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.587374| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 8.981311| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.540530| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.099921| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.979472| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.318348| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.048027| train set 1.696x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.298651| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.748255| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 88
Epoch 88/200 |loss: 7.346790| train set 1.747x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.206311| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.604168| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.204798| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.777158| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.217476| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.521094| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.410666| train set 1.664x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 10.148084| train set 1.757x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.892666| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.398121| train set 1.810x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.126471| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.981965| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.075490| train set 1.791x speedup, test set 1.884x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.694986| train set 1.791x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.163421| train set 1.810x speedup, test set 1.310x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.267069| train set 1.810x speedup, test set 1.825x speedup, val set 0.477x speedup, step: 1
Epoch 105/200 |loss: 9.303681| train set 1.680x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 2
Epoch 106/200 |loss: 9.428203| train set 1.810x speedup, test set 0.984x speedup, val set 0.296x speedup, step: 3
Epoch 107/200 |loss: 10.596719| train set 1.680x speedup, test set 0.984x speedup, val set 0.296x speedup, step: 4
Epoch 108/200 |loss: 10.102916| train set 1.711x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 109/200 |loss: 8.730354| train set 1.764x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 6
Epoch 110/200 |loss: 9.122877| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 7
Epoch 111/200 |loss: 8.870054| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 8
Epoch 112/200 |loss: 7.951573| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 9
Epoch 113/200 |loss: 9.850520| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 10
Epoch 114/200 |loss: 9.013887| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 11
Epoch 115/200 |loss: 8.664058| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 12
Epoch 116/200 |loss: 8.224557| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 13
Epoch 117/200 |loss: 11.092274| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 14
Epoch 118/200 |loss: 8.280647| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 15
Epoch 119/200 |loss: 8.309642| train set 1.810x speedup, test set 0.995x speedup, val set 0.450x speedup, step: 16
Epoch 120/200 |loss: 8.113085| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 17
Epoch 121/200 |loss: 9.269526| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 18
Epoch 122/200 |loss: 9.335103| train set 1.757x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 19
Epoch 123/200 |loss: 8.743449| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 20
Epoch 124/200 |loss: 8.627875| train set 1.757x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 21
Epoch 125/200 |loss: 8.417640| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 22
Epoch 126/200 |loss: 8.003392| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 23
Epoch 127/200 |loss: 7.623559| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 24
Epoch 128/200 |loss: 8.775202| train set 1.775x speedup, test set 1.663x speedup, val set 0.513x speedup, step: 1
Epoch 129/200 |loss: 8.375531| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 2
Epoch 130/200 |loss: 8.387866| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 3
Epoch 131/200 |loss: 8.624686| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 4
Epoch 132/200 |loss: 7.896006| train set 1.802x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 133/200 |loss: 8.140838| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 6
Epoch 134/200 |loss: 8.762436| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 7
Epoch 135/200 |loss: 8.004730| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 8
Epoch 136/200 |loss: 7.858635| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 9
Epoch 137/200 |loss: 8.173148| train set 1.776x speedup, test set 0.984x speedup, val set 0.296x speedup, step: 10
Epoch 138/200 |loss: 7.078994| train set 1.810x speedup, test set 1.705x speedup, val set 0.296x speedup, step: 11
Epoch 139/200 |loss: 7.216584| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 12
Epoch 140/200 |loss: 6.874293| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 13
Epoch 141/200 |loss: 10.196339| train set 1.775x speedup, test set 1.587x speedup, val set 0.296x speedup, step: 14
Epoch 142/200 |loss: 7.909940| train set 1.776x speedup, test set 1.716x speedup, val set 0.296x speedup, step: 15
Epoch 143/200 |loss: 8.409576| train set 1.679x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 16
Epoch 144/200 |loss: 9.399981| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 17
Epoch 145/200 |loss: 9.564540| train set 1.756x speedup, test set 1.716x speedup, val set 0.296x speedup, step: 18
Epoch 146/200 |loss: 7.321054| train set 1.756x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 19
Epoch 147/200 |loss: 9.433268| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 20
Epoch 148/200 |loss: 6.920549| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 21
Epoch 149/200 |loss: 8.632842| train set 1.776x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 150/200 |loss: 8.516574| train set 1.776x speedup, test set 1.738x speedup, val set 0.513x speedup, step: 1
Epoch 151/200 |loss: 8.998038| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 2
Epoch 152/200 |loss: 7.676009| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 3
Epoch 153/200 |loss: 7.253897| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 4
Epoch 154/200 |loss: 8.231916| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 155/200 |loss: 7.674037| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 6
Epoch 156/200 |loss: 7.269678| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 7
Epoch 157/200 |loss: 7.671245| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 8
Epoch 158/200 |loss: 9.769307| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 9
Epoch 159/200 |loss: 10.039178| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 10
Epoch 160/200 |loss: 8.315705| train set 1.810x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 11
Epoch 161/200 |loss: 10.241943| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 12
Epoch 162/200 |loss: 11.000352| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 13
Epoch 163/200 |loss: 8.275755| train set 1.810x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 14
Epoch 164/200 |loss: 8.909183| train set 1.776x speedup, test set 1.825x speedup, val set 0.296x speedup, step: 15
Epoch 165/200 |loss: 8.619115| train set 1.776x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 16
Epoch 166/200 |loss: 9.621142| train set 1.810x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 17
Epoch 167/200 |loss: 8.305759| train set 1.810x speedup, test set 6.876x speedup, val set 0.296x speedup, step: 18
Epoch 168/200 |loss: 8.207595| train set 1.790x speedup, test set 2.472x speedup, val set 0.296x speedup, step: 19
Epoch 169/200 |loss: 9.122511| train set 1.790x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 20
Epoch 170/200 |loss: 9.348579| train set 1.757x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 21
Epoch 171/200 |loss: 8.055124| train set 1.757x speedup, test set 1.310x speedup, val set 0.296x speedup, step: 22
Epoch 172/200 |loss: 8.771313| train set 1.791x speedup, test set 1.827x speedup, val set 0.296x speedup, step: 23
Epoch 173/200 |loss: 7.780695| train set 1.810x speedup, test set 2.475x speedup, val set 0.296x speedup, step: 24
Epoch 174/200 |loss: 8.141753| train set 1.810x speedup, test set 2.475x speedup, val set 0.296x speedup, step: 25
Epoch 175/200 |loss: 8.716881| train set 1.776x speedup, test set 2.472x speedup, val set 0.296x speedup, step: 26
Epoch 176/200 |loss: 9.500787| train set 1.776x speedup, test set 8.563x speedup, val set 0.296x speedup, step: 27
Epoch 177/200 |loss: 7.901931| train set 1.791x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 28
Epoch 178/200 |loss: 7.961742| train set 1.790x speedup, test set 6.921x speedup, val set 0.296x speedup, step: 29
Epoch 179/200 |loss: 8.320495| train set 1.790x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 30
Epoch 180/200 |loss: 9.030721| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 31
Epoch 181/200 |loss: 8.703390| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 32
Epoch 182/200 |loss: 8.791548| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 33
Epoch 183/200 |loss: 9.036367| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 34
Epoch 184/200 |loss: 7.421836| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 35
Epoch 185/200 |loss: 7.327959| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 36
Epoch 186/200 |loss: 9.672448| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 37
Epoch 187/200 |loss: 9.449340| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 38
Epoch 188/200 |loss: 7.056399| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 39
Epoch 189/200 |loss: 8.867404| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 40
Epoch 190/200 |loss: 7.926680| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 41
Epoch 191/200 |loss: 8.283544| train set 1.776x speedup, test set 1.705x speedup, val set 0.296x speedup, step: 42
Epoch 192/200 |loss: 10.066545| train set 1.776x speedup, test set 1.705x speedup, val set 0.296x speedup, step: 43
Epoch 193/200 |loss: 8.441379| train set 1.776x speedup, test set 1.705x speedup, val set 0.296x speedup, step: 44
Epoch 194/200 |loss: 9.154990| train set 1.776x speedup, test set 1.705x speedup, val set 0.296x speedup, step: 45
Epoch 195/200 |loss: 9.790540| train set 1.810x speedup, test set 0.984x speedup, val set 0.296x speedup, step: 46
Epoch 196/200 |loss: 8.170240| train set 1.810x speedup, test set 0.984x speedup, val set 0.296x speedup, step: 47
Epoch 197/200 |loss: 8.157202| train set 1.791x speedup, test set 0.984x speedup, val set 0.296x speedup, step: 48
Epoch 198/200 |loss: 8.601599| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 49
Epoch 199/200 |loss: 8.370806| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 50
Training per epoch cost 0.320 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 33.598s, pg runtime 601.866s, speedup 17.914x
22, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
23, opt runtime 24.662s, model runtime 32.192s, pg runtime 613.999s, speedup 19.073x
24, opt runtime 24.459s, model runtime 32.532s, pg runtime 608.717s, speedup 18.711x
25, opt runtime 25.236s, model runtime 33.141s, pg runtime 601.756s, speedup 18.157x
26, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
27, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
28, opt runtime 25.075s, model runtime 32.865s, pg runtime 612.430s, speedup 18.635x
29, opt runtime 24.840s, model runtime 32.681s, pg runtime 626.529s, speedup 19.171x
30, opt runtime 24.920s, model runtime 32.473s, pg runtime 610.993s, speedup 18.816x
31, opt runtime 16.268s, model runtime 580.359s, pg runtime 432.766s, speedup 0.746x
32, opt runtime 15.120s, model runtime 580.203s, pg runtime 566.078s, speedup 0.976x
33, opt runtime 16.639s, model runtime 576.339s, pg runtime 462.544s, speedup 0.803x
34, opt runtime 16.280s, model runtime 615.635s, pg runtime 634.990s, speedup 1.031x
35, opt runtime 16.528s, model runtime 616.056s, pg runtime 620.762s, speedup 1.008x
36, opt runtime 18.690s, model runtime 637.615s, pg runtime 651.942s, speedup 1.022x
37, opt runtime 16.438s, model runtime 583.941s, pg runtime 546.887s, speedup 0.937x
38, opt runtime 16.138s, model runtime 572.741s, pg runtime 501.793s, speedup 0.876x
39, opt runtime 16.770s, model runtime 617.719s, pg runtime 594.754s, speedup 0.963x
40, opt runtime 16.305s, model runtime 577.424s, pg runtime 436.168s, speedup 0.755x
====================
best train speedup epoch: 25, train speedup 1.810, test speedup 1.211, val speedup 0.296
best test speedup epoch: 160, train speedup 1.810, test speedup 8.607, val speedup 0.296
best validation speedup epoch: 150, train speedup 1.776, test speedup 1.738, val speedup 0.513
last model at epoch 199, train speedup 1.791, test speedup 1.738, val speedup 0.296
execution cost 0:02:41.280184
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.199167, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 0.973x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406732| train set 1.013x speedup, test set 0.973x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027806| train set 0.882x speedup, test set 1.649x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936133| train set 0.965x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435116| train set 1.200x speedup, test set 1.759x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472622| train set 1.142x speedup, test set 1.782x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150183| train set 1.352x speedup, test set 1.782x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.999659| train set 1.383x speedup, test set 1.782x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.322505| train set 1.225x speedup, test set 1.671x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.701950| train set 1.417x speedup, test set 1.660x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.364318| train set 1.342x speedup, test set 1.646x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.980073| train set 1.367x speedup, test set 2.338x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.217670| train set 1.367x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.270708| train set 1.435x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.452962| train set 1.550x speedup, test set 2.387x speedup, val set 0.437x speedup, step: 15
Epoch 15/200 |loss: 12.930645| train set 1.534x speedup, test set 1.165x speedup, val set 0.437x speedup, step: 16
Epoch 16/200 |loss: 12.681292| train set 1.663x speedup, test set 1.211x speedup, val set 0.437x speedup, step: 17
Epoch 17/200 |loss: 10.472784| train set 1.680x speedup, test set 1.228x speedup, val set 0.437x speedup, step: 18
Epoch 18/200 |loss: 11.411241| train set 1.810x speedup, test set 2.528x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.614584| train set 1.790x speedup, test set 2.528x speedup, val set 0.477x speedup, step: 20
Epoch 20/200 |loss: 12.459383| train set 1.747x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.818335| train set 1.680x speedup, test set 2.524x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.735785| train set 1.810x speedup, test set 1.188x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.396636| train set 1.790x speedup, test set 2.366x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.179406| train set 1.654x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.684121| train set 1.810x speedup, test set 1.228x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.745885| train set 1.542x speedup, test set 1.634x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.889981| train set 1.790x speedup, test set 1.634x speedup, val set 0.450x speedup, step: 28
Epoch 28/200 |loss: 10.748769| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.855282| train set 1.810x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.448966| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.833562| train set 1.790x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.609828| train set 1.711x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.355919| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.455160| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.136897| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.888261| train set 1.810x speedup, test set 2.359x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.588922| train set 1.791x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.507542| train set 1.810x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.901243| train set 1.734x speedup, test set 1.564x speedup, val set 0.426x speedup, step: 40
Epoch 40/200 |loss: 8.888467| train set 1.776x speedup, test set 2.359x speedup, val set 0.477x speedup, step: 41
Epoch 41/200 |loss: 10.457126| train set 1.680x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.791948| train set 1.791x speedup, test set 2.524x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.601807| train set 1.747x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.831807| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.448382| train set 1.711x speedup, test set 1.634x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.046395| train set 1.711x speedup, test set 2.524x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.323532| train set 1.711x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.929558| train set 1.734x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.174155| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.940933| train set 1.790x speedup, test set 2.716x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.954306| train set 1.790x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.843120| train set 1.757x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.411212| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.818974| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.915971| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.184646| train set 1.810x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.744560| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 7.981021| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.564047| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.440792| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.762929| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 9.894218| train set 1.757x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.552693| train set 1.732x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.085821| train set 1.680x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.125404| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.257967| train set 1.765x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.842600| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.205817| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.384218| train set 1.679x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 8.971640| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 8.926535| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.511438| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.409964| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.276412| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.619465| train set 1.790x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.239726| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.963843| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.455792| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.689700| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.010444| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.723116| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.192461| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 8.018079| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 84
Epoch 84/200 |loss: 8.496706| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 85
Epoch 85/200 |loss: 9.094815| train set 1.696x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.234632| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.925220| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 88
Epoch 88/200 |loss: 7.280435| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.158711| train set 1.790x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.574093| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.192464| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.850720| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.231416| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 94
Epoch 94/200 |loss: 8.504364| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.470951| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.800946| train set 1.776x speedup, test set 2.526x speedup, val set 0.512x speedup, step: 97
Epoch 97/200 |loss: 9.349605| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.515587| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.445837| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.961726| train set 1.776x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 101/200 |loss: 9.854950| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 2
Epoch 102/200 |loss: 8.370490| train set 1.696x speedup, test set 1.791x speedup, val set 0.296x speedup, step: 3
Epoch 103/200 |loss: 10.410091| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.407056| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 105/200 |loss: 8.736576| train set 1.776x speedup, test set 2.168x speedup, val set 0.296x speedup, step: 2
Epoch 106/200 |loss: 9.524179| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 3
Epoch 107/200 |loss: 10.561285| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 4
Epoch 108/200 |loss: 9.934298| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 109/200 |loss: 8.789732| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 6
Epoch 110/200 |loss: 9.061515| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 7
Epoch 111/200 |loss: 8.769508| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 8
Epoch 112/200 |loss: 7.807817| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 9
Epoch 113/200 |loss: 9.844689| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 10
Epoch 114/200 |loss: 8.960332| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 11
Epoch 115/200 |loss: 8.318944| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 12
Epoch 116/200 |loss: 7.997661| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 13
Epoch 117/200 |loss: 10.944426| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 14
Epoch 118/200 |loss: 8.484000| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 15
Epoch 119/200 |loss: 8.361228| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.104401| train set 1.774x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 2
Epoch 121/200 |loss: 9.386823| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 3
Epoch 122/200 |loss: 9.329953| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 4
Epoch 123/200 |loss: 9.062923| train set 1.790x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 5
Epoch 124/200 |loss: 8.777659| train set 1.757x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 6
Epoch 125/200 |loss: 8.774187| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 7
Epoch 126/200 |loss: 8.157058| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 8
Epoch 127/200 |loss: 7.849161| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 9
Epoch 128/200 |loss: 8.859358| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 10
Epoch 129/200 |loss: 8.463919| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 11
Epoch 130/200 |loss: 8.537499| train set 1.791x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 12
Epoch 131/200 |loss: 8.816571| train set 1.791x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 1
Epoch 132/200 |loss: 8.134033| train set 1.810x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 1
Epoch 133/200 |loss: 8.459169| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 2
Epoch 134/200 |loss: 8.932213| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 3
Epoch 135/200 |loss: 8.052857| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 4
Epoch 136/200 |loss: 7.778218| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 5
Epoch 137/200 |loss: 8.054996| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 6
Epoch 138/200 |loss: 7.097054| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 7
Epoch 139/200 |loss: 7.397695| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 8
Epoch 140/200 |loss: 6.773626| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 9
Epoch 141/200 |loss: 10.042953| train set 1.775x speedup, test set 1.738x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.044768| train set 1.776x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.385927| train set 1.791x speedup, test set 6.949x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.485394| train set 1.791x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.557907| train set 1.776x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 5
Epoch 146/200 |loss: 7.203806| train set 1.776x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.325178| train set 1.790x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 6.914485| train set 1.790x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 8.670093| train set 1.810x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.573198| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.003990| train set 1.776x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 7.530494| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.362136| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.248204| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 7.508433| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.430733| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.564069| train set 1.810x speedup, test set 1.738x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 9.753626| train set 1.776x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.813957| train set 1.810x speedup, test set 1.739x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 8.411481| train set 1.791x speedup, test set 8.607x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 10.443020| train set 1.810x speedup, test set 1.818x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 11.083322| train set 1.810x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 8.379245| train set 1.776x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 23
Epoch 164/200 |loss: 9.121943| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 8.780120| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 9.648893| train set 1.776x speedup, test set 2.716x speedup, val set 0.477x speedup, step: 1
Epoch 167/200 |loss: 8.435473| train set 1.810x speedup, test set 1.635x speedup, val set 0.477x speedup, step: 1
Epoch 168/200 |loss: 8.253110| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 2
Epoch 169/200 |loss: 9.288780| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 3
Epoch 170/200 |loss: 9.338144| train set 1.757x speedup, test set 1.635x speedup, val set 0.477x speedup, step: 1
Epoch 171/200 |loss: 8.110974| train set 1.758x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 2
Epoch 172/200 |loss: 8.752370| train set 1.791x speedup, test set 1.635x speedup, val set 0.296x speedup, step: 3
Epoch 173/200 |loss: 7.957711| train set 1.791x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 174/200 |loss: 8.292649| train set 1.810x speedup, test set 2.168x speedup, val set 0.477x speedup, step: 1
Epoch 175/200 |loss: 8.862202| train set 1.776x speedup, test set 1.635x speedup, val set 0.477x speedup, step: 1
Epoch 176/200 |loss: 9.452737| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 2
Epoch 177/200 |loss: 8.120327| train set 1.790x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 3
Epoch 178/200 |loss: 8.016559| train set 1.790x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 179/200 |loss: 8.201317| train set 1.790x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 180/200 |loss: 9.006123| train set 1.791x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 181/200 |loss: 8.803259| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 2
Epoch 182/200 |loss: 8.739435| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 3
Epoch 183/200 |loss: 9.171286| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 184/200 |loss: 7.385977| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 185/200 |loss: 7.261091| train set 1.810x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 2
Epoch 186/200 |loss: 9.708130| train set 1.810x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 3
Epoch 187/200 |loss: 9.444025| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 188/200 |loss: 6.916462| train set 1.810x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 189/200 |loss: 8.693539| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 2
Epoch 190/200 |loss: 7.791030| train set 1.810x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 3
Epoch 191/200 |loss: 8.186205| train set 1.776x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 4
Epoch 192/200 |loss: 10.010225| train set 1.776x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 193/200 |loss: 8.605310| train set 1.776x speedup, test set 2.526x speedup, val set 0.477x speedup, step: 1
Epoch 194/200 |loss: 9.059108| train set 1.776x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 2
Epoch 195/200 |loss: 9.708028| train set 1.776x speedup, test set 2.530x speedup, val set 0.477x speedup, step: 1
Epoch 196/200 |loss: 8.277797| train set 1.776x speedup, test set 2.530x speedup, val set 0.477x speedup, step: 1
Epoch 197/200 |loss: 8.371660| train set 1.791x speedup, test set 2.530x speedup, val set 0.296x speedup, step: 2
Epoch 198/200 |loss: 8.740291| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 3
Epoch 199/200 |loss: 8.373423| train set 1.791x speedup, test set 2.526x speedup, val set 0.296x speedup, step: 4
Training per epoch cost 0.318 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 349.951s, pg runtime 432.766s, speedup 1.237x
32, opt runtime 15.120s, model runtime 350.307s, pg runtime 566.078s, speedup 1.616x
33, opt runtime 16.639s, model runtime 343.997s, pg runtime 462.544s, speedup 1.345x
34, opt runtime 16.280s, model runtime 379.482s, pg runtime 634.990s, speedup 1.673x
35, opt runtime 16.528s, model runtime 362.680s, pg runtime 620.762s, speedup 1.712x
36, opt runtime 18.690s, model runtime 356.056s, pg runtime 651.942s, speedup 1.831x
37, opt runtime 16.438s, model runtime 349.045s, pg runtime 546.887s, speedup 1.567x
38, opt runtime 16.138s, model runtime 349.458s, pg runtime 501.793s, speedup 1.436x
39, opt runtime 16.770s, model runtime 354.159s, pg runtime 594.754s, speedup 1.679x
40, opt runtime 16.305s, model runtime 348.685s, pg runtime 436.168s, speedup 1.251x
====================
best train speedup epoch: 44, train speedup 1.810, test speedup 1.211, val speedup 0.296
best test speedup epoch: 160, train speedup 1.791, test speedup 8.607, val speedup 0.296
best validation speedup epoch: 196, train speedup 1.776, test speedup 2.530, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 2.526, val speedup 0.296
execution cost 0:02:42.013172
==================================================
