all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.267244, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.327964| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 1, train time 19.13 s
Epoch 1/50 |loss: 0.218678| train set 1.869x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 16.72 s
Epoch 2/50 |loss: 0.203846| train set 2.021x speedup, test set 1.608x speedup, val set 0.502x speedup, step: 3, train time 16.43 s
Epoch 3/50 |loss: 0.178706| train set 1.853x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.43 s
Epoch 4/50 |loss: 0.172184| train set 2.022x speedup, test set 0.951x speedup, val set 0.502x speedup, step: 1, train time 16.80 s
Epoch 5/50 |loss: 0.165390| train set 2.021x speedup, test set 1.439x speedup, val set 0.502x speedup, step: 2, train time 16.31 s
Epoch 6/50 |loss: 0.159018| train set 1.997x speedup, test set 1.446x speedup, val set 0.502x speedup, step: 3, train time 16.32 s
Epoch 7/50 |loss: 0.158911| train set 1.952x speedup, test set 0.926x speedup, val set 0.502x speedup, step: 4, train time 16.41 s
Epoch 8/50 |loss: 0.157193| train set 2.022x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 5, train time 16.61 s
Epoch 9/50 |loss: 0.153283| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 16.40 s
Epoch 10/50 |loss: 0.152518| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 16.41 s
Epoch 11/50 |loss: 0.150898| train set 2.021x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 3, train time 16.41 s
Epoch 12/50 |loss: 0.146456| train set 1.876x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.53 s
Epoch 13/50 |loss: 0.149689| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.39 s
Epoch 14/50 |loss: 0.146092| train set 1.994x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 16.41 s
Epoch 15/50 |loss: 0.144072| train set 1.978x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 2, train time 16.66 s
Epoch 16/50 |loss: 0.142345| train set 1.996x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 3, train time 16.51 s
Epoch 17/50 |loss: 0.142644| train set 2.021x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 4, train time 16.52 s
Epoch 18/50 |loss: 0.143120| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.41 s
Epoch 19/50 |loss: 0.139247| train set 1.995x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 16.51 s
Epoch 20/50 |loss: 0.138947| train set 2.020x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 2, train time 16.40 s
Epoch 21/50 |loss: 0.140232| train set 1.997x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 3, train time 16.32 s
Epoch 22/50 |loss: 0.144164| train set 1.997x speedup, test set 0.925x speedup, val set 0.502x speedup, step: 4, train time 16.41 s
Epoch 23/50 |loss: 0.140651| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.28 s
Epoch 24/50 |loss: 0.139779| train set 1.997x speedup, test set 1.446x speedup, val set 0.502x speedup, step: 1, train time 16.50 s
Epoch 25/50 |loss: 0.136818| train set 1.997x speedup, test set 4.053x speedup, val set 0.502x speedup, step: 2, train time 16.48 s
Epoch 26/50 |loss: 0.139356| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 16.71 s
Epoch 27/50 |loss: 0.139648| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 16.59 s
Epoch 28/50 |loss: 0.136981| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.71 s
Epoch 29/50 |loss: 0.135633| train set 1.975x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 1, train time 16.60 s
Epoch 30/50 |loss: 0.135578| train set 2.020x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 2, train time 16.71 s
Epoch 31/50 |loss: 0.138038| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 3, train time 16.71 s
Epoch 32/50 |loss: 0.138430| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 16.70 s
Epoch 33/50 |loss: 0.137184| train set 2.021x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 5, train time 16.62 s
Epoch 34/50 |loss: 0.136849| train set 2.019x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 1, train time 16.60 s
early stopping at epoch 34
Training per epoch cost 16.591 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 4, train speedup 2.022, test speedup 0.951, val speedup 0.502
best test speedup epoch: 25, train speedup 1.997, test speedup 4.053, val speedup 0.502
best validation speedup epoch: 34, train speedup 2.019, test speedup 1.478, val speedup 0.502
last model at epoch 34, train speedup 2.019, test speedup 1.478, val speedup 0.502
execution cost 0:10:38.850381
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.150934, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.327285| train set 2.021x speedup, test set 0.941x speedup, val set 1.000x speedup, step: 1, train time 19.05 s
Epoch 1/50 |loss: 0.216793| train set 1.965x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 16.68 s
Epoch 2/50 |loss: 0.202516| train set 1.965x speedup, test set 1.768x speedup, val set 1.000x speedup, step: 3, train time 16.71 s
Epoch 3/50 |loss: 0.176732| train set 1.853x speedup, test set 0.950x speedup, val set 0.502x speedup, step: 4, train time 16.50 s
Epoch 4/50 |loss: 0.170682| train set 2.022x speedup, test set 1.030x speedup, val set 0.502x speedup, step: 1, train time 16.60 s
Epoch 5/50 |loss: 0.166327| train set 1.873x speedup, test set 4.620x speedup, val set 0.502x speedup, step: 2, train time 16.62 s
Epoch 6/50 |loss: 0.159714| train set 1.996x speedup, test set 3.834x speedup, val set 0.502x speedup, step: 3, train time 16.81 s
Epoch 7/50 |loss: 0.157946| train set 1.977x speedup, test set 1.655x speedup, val set 0.502x speedup, step: 4, train time 16.71 s
Epoch 8/50 |loss: 0.157793| train set 1.827x speedup, test set 3.890x speedup, val set 0.502x speedup, step: 5, train time 16.81 s
Epoch 9/50 |loss: 0.153538| train set 1.977x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 1, train time 16.62 s
Epoch 10/50 |loss: 0.151534| train set 1.978x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 2, train time 16.69 s
Epoch 11/50 |loss: 0.149602| train set 2.021x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 3, train time 16.80 s
Epoch 12/50 |loss: 0.146779| train set 1.876x speedup, test set 1.695x speedup, val set 0.502x speedup, step: 4, train time 16.80 s
Epoch 13/50 |loss: 0.149509| train set 1.965x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 5, train time 16.71 s
Epoch 14/50 |loss: 0.146730| train set 2.019x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 1, train time 16.62 s
Epoch 15/50 |loss: 0.143226| train set 2.022x speedup, test set 4.063x speedup, val set 0.502x speedup, step: 2, train time 17.12 s
Epoch 16/50 |loss: 0.142760| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 3, train time 16.72 s
Epoch 17/50 |loss: 0.142924| train set 1.977x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 4, train time 16.70 s
Epoch 18/50 |loss: 0.141833| train set 2.022x speedup, test set 4.063x speedup, val set 0.502x speedup, step: 5, train time 16.68 s
Epoch 19/50 |loss: 0.141292| train set 1.997x speedup, test set 4.063x speedup, val set 0.502x speedup, step: 1, train time 16.61 s
Epoch 20/50 |loss: 0.140784| train set 2.022x speedup, test set 4.063x speedup, val set 0.502x speedup, step: 2, train time 16.43 s
Epoch 21/50 |loss: 0.139988| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 3, train time 16.80 s
Epoch 22/50 |loss: 0.142776| train set 2.022x speedup, test set 4.752x speedup, val set 0.502x speedup, step: 4, train time 16.61 s
Epoch 23/50 |loss: 0.139459| train set 1.977x speedup, test set 1.627x speedup, val set 0.502x speedup, step: 5, train time 16.70 s
Epoch 24/50 |loss: 0.139186| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 1, train time 16.68 s
Epoch 25/50 |loss: 0.140299| train set 1.856x speedup, test set 4.063x speedup, val set 0.502x speedup, step: 2, train time 16.71 s
Epoch 26/50 |loss: 0.138832| train set 1.954x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 3, train time 16.73 s
Epoch 27/50 |loss: 0.138464| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 4, train time 16.60 s
Epoch 28/50 |loss: 0.138847| train set 2.020x speedup, test set 1.627x speedup, val set 0.502x speedup, step: 5, train time 16.72 s
Epoch 29/50 |loss: 0.136514| train set 1.975x speedup, test set 4.063x speedup, val set 0.502x speedup, step: 1, train time 16.60 s
Epoch 30/50 |loss: 0.135885| train set 2.021x speedup, test set 1.627x speedup, val set 0.502x speedup, step: 2, train time 16.60 s
Epoch 31/50 |loss: 0.137041| train set 1.997x speedup, test set 4.053x speedup, val set 0.502x speedup, step: 3, train time 16.71 s
Epoch 32/50 |loss: 0.138234| train set 2.022x speedup, test set 4.738x speedup, val set 0.502x speedup, step: 4, train time 16.73 s
Epoch 33/50 |loss: 0.138810| train set 2.021x speedup, test set 4.053x speedup, val set 0.502x speedup, step: 5, train time 16.60 s
Epoch 34/50 |loss: 0.137041| train set 2.019x speedup, test set 4.063x speedup, val set 0.502x speedup, step: 1, train time 16.61 s
Epoch 35/50 |loss: 0.135128| train set 1.977x speedup, test set 1.627x speedup, val set 0.502x speedup, step: 2, train time 16.59 s
Epoch 36/50 |loss: 0.133647| train set 1.997x speedup, test set 4.053x speedup, val set 0.502x speedup, step: 3, train time 16.69 s
Epoch 37/50 |loss: 0.133159| train set 1.997x speedup, test set 3.890x speedup, val set 0.502x speedup, step: 4, train time 16.83 s
Epoch 38/50 |loss: 0.137207| train set 1.977x speedup, test set 3.890x speedup, val set 0.502x speedup, step: 5, train time 16.88 s
Epoch 39/50 |loss: 0.136497| train set 2.022x speedup, test set 4.063x speedup, val set 0.502x speedup, step: 1, train time 16.72 s
early stopping at epoch 39
Training per epoch cost 16.752 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 4, train speedup 2.022, test speedup 1.030, val speedup 0.502
best test speedup epoch: 22, train speedup 2.022, test speedup 4.752, val speedup 0.502
best validation speedup epoch: 39, train speedup 2.022, test speedup 4.063, val speedup 0.502
last model at epoch 39, train speedup 2.022, test speedup 4.063, val speedup 0.502
execution cost 0:12:15.737475
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.268422, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.327172| train set 2.022x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 1, train time 19.14 s
Epoch 1/50 |loss: 0.219968| train set 2.022x speedup, test set 1.439x speedup, val set 0.502x speedup, step: 2, train time 16.82 s
Epoch 2/50 |loss: 0.201081| train set 1.965x speedup, test set 0.953x speedup, val set 1.000x speedup, step: 3, train time 16.79 s
Epoch 3/50 |loss: 0.177040| train set 1.832x speedup, test set 0.976x speedup, val set 0.502x speedup, step: 4, train time 16.71 s
Epoch 4/50 |loss: 0.170084| train set 1.965x speedup, test set 0.962x speedup, val set 0.502x speedup, step: 1, train time 16.79 s
Epoch 5/50 |loss: 0.167052| train set 2.022x speedup, test set 0.950x speedup, val set 0.502x speedup, step: 2, train time 15.90 s
Epoch 6/50 |loss: 0.160352| train set 1.997x speedup, test set 0.950x speedup, val set 0.502x speedup, step: 3, train time 16.03 s
Epoch 7/50 |loss: 0.157198| train set 1.978x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 4, train time 16.21 s
Epoch 8/50 |loss: 0.157557| train set 1.965x speedup, test set 0.953x speedup, val set 0.502x speedup, step: 5, train time 16.22 s
Epoch 9/50 |loss: 0.153435| train set 1.977x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 1, train time 16.20 s
Epoch 10/50 |loss: 0.152270| train set 2.022x speedup, test set 0.952x speedup, val set 0.502x speedup, step: 2, train time 16.11 s
Epoch 11/50 |loss: 0.150602| train set 2.021x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 3, train time 16.09 s
Epoch 12/50 |loss: 0.146052| train set 1.854x speedup, test set 0.950x speedup, val set 0.502x speedup, step: 4, train time 16.23 s
Epoch 13/50 |loss: 0.149772| train set 2.022x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 5, train time 16.32 s
Epoch 14/50 |loss: 0.146621| train set 2.018x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 1, train time 16.19 s
Epoch 15/50 |loss: 0.144418| train set 2.022x speedup, test set 0.967x speedup, val set 0.757x speedup, step: 2, train time 16.89 s
Epoch 16/50 |loss: 0.142523| train set 1.996x speedup, test set 0.963x speedup, val set 0.502x speedup, step: 3, train time 16.38 s
Epoch 17/50 |loss: 0.143304| train set 1.977x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 4, train time 16.44 s
Epoch 18/50 |loss: 0.142721| train set 2.021x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 5, train time 16.23 s
Epoch 19/50 |loss: 0.140142| train set 1.995x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 1, train time 16.30 s
Epoch 20/50 |loss: 0.140108| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 2, train time 16.09 s
Epoch 21/50 |loss: 0.140885| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 3, train time 16.29 s
Epoch 22/50 |loss: 0.142401| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 4, train time 16.20 s
Epoch 23/50 |loss: 0.141796| train set 1.975x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 5, train time 16.21 s
Epoch 24/50 |loss: 0.140417| train set 1.978x speedup, test set 0.963x speedup, val set 0.502x speedup, step: 1, train time 16.22 s
Epoch 25/50 |loss: 0.138944| train set 2.020x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 2, train time 16.28 s
Epoch 26/50 |loss: 0.138889| train set 1.954x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 3, train time 16.10 s
Epoch 27/50 |loss: 0.137567| train set 1.997x speedup, test set 0.963x speedup, val set 0.502x speedup, step: 4, train time 16.28 s
Epoch 28/50 |loss: 0.136801| train set 2.020x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 5, train time 16.40 s
Epoch 29/50 |loss: 0.136666| train set 1.976x speedup, test set 1.657x speedup, val set 1.000x speedup, step: 1, train time 16.10 s
Epoch 30/50 |loss: 0.135506| train set 2.021x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 2, train time 16.30 s
Epoch 31/50 |loss: 0.136947| train set 1.997x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 3, train time 16.49 s
Epoch 32/50 |loss: 0.136773| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 4, train time 16.34 s
Epoch 33/50 |loss: 0.136940| train set 2.021x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 5, train time 16.20 s
Epoch 34/50 |loss: 0.136162| train set 2.019x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 6, train time 16.39 s
Epoch 35/50 |loss: 0.134674| train set 2.021x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 7, train time 16.28 s
Epoch 36/50 |loss: 0.135040| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 8, train time 16.41 s
Epoch 37/50 |loss: 0.132840| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 9, train time 16.33 s
Epoch 38/50 |loss: 0.135022| train set 1.977x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 10, train time 16.22 s
Epoch 39/50 |loss: 0.135126| train set 1.856x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 11, train time 16.49 s
Epoch 40/50 |loss: 0.133345| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 12, train time 16.39 s
Epoch 41/50 |loss: 0.135745| train set 2.022x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 13, train time 16.40 s
Epoch 42/50 |loss: 0.134689| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 14, train time 16.48 s
Epoch 43/50 |loss: 0.134450| train set 2.022x speedup, test set 1.655x speedup, val set 0.502x speedup, step: 15, train time 16.22 s
Epoch 44/50 |loss: 0.133200| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 16, train time 16.11 s
Epoch 45/50 |loss: 0.133648| train set 2.020x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 17, train time 16.30 s
Epoch 46/50 |loss: 0.134460| train set 2.002x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 18, train time 16.51 s
early stopping at epoch 46
Training per epoch cost 16.383 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 432.766s, pg runtime 432.766s, speedup 1.000x
32, opt runtime 15.120s, model runtime 566.078s, pg runtime 566.078s, speedup 1.000x
33, opt runtime 16.639s, model runtime 462.544s, pg runtime 462.544s, speedup 1.000x
34, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
35, opt runtime 16.528s, model runtime 620.762s, pg runtime 620.762s, speedup 1.000x
36, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
37, opt runtime 16.438s, model runtime 546.887s, pg runtime 546.887s, speedup 1.000x
38, opt runtime 16.138s, model runtime 501.793s, pg runtime 501.793s, speedup 1.000x
39, opt runtime 16.770s, model runtime 594.754s, pg runtime 594.754s, speedup 1.000x
40, opt runtime 16.305s, model runtime 436.168s, pg runtime 436.168s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 2.022, test speedup 0.967, val speedup 0.502
best test speedup epoch: 20, train speedup 2.022, test speedup 1.657, val speedup 0.502
best validation speedup epoch: 29, train speedup 1.976, test speedup 1.657, val speedup 1.000
last model at epoch 46, train speedup 2.002, test speedup 0.967, val speedup 0.502
execution cost 0:14:03.674648
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.897311, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.327756| train set 2.022x speedup, test set 1.515x speedup, val set 0.502x speedup, step: 1, train time 18.76 s
Epoch 1/50 |loss: 0.217940| train set 1.965x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 16.52 s
Epoch 2/50 |loss: 0.202522| train set 1.965x speedup, test set 3.777x speedup, val set 0.502x speedup, step: 3, train time 16.19 s
Epoch 3/50 |loss: 0.177362| train set 1.853x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.30 s
Epoch 4/50 |loss: 0.171060| train set 2.022x speedup, test set 0.951x speedup, val set 0.502x speedup, step: 1, train time 16.40 s
Epoch 5/50 |loss: 0.168774| train set 1.876x speedup, test set 1.439x speedup, val set 0.502x speedup, step: 2, train time 16.31 s
Epoch 6/50 |loss: 0.162186| train set 1.997x speedup, test set 1.443x speedup, val set 0.502x speedup, step: 3, train time 15.99 s
Epoch 7/50 |loss: 0.159820| train set 1.977x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 4, train time 15.99 s
Epoch 8/50 |loss: 0.158285| train set 1.961x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 5, train time 15.91 s
Epoch 9/50 |loss: 0.154061| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 16.02 s
Epoch 10/50 |loss: 0.153367| train set 1.978x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 16.00 s
Epoch 11/50 |loss: 0.152897| train set 2.021x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 3, train time 16.11 s
Epoch 12/50 |loss: 0.146438| train set 1.876x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.02 s
Epoch 13/50 |loss: 0.150497| train set 2.022x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 5, train time 16.02 s
Epoch 14/50 |loss: 0.149236| train set 1.996x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 16.24 s
Epoch 15/50 |loss: 0.146078| train set 2.022x speedup, test set 1.538x speedup, val set 0.502x speedup, step: 2, train time 16.50 s
Epoch 16/50 |loss: 0.142831| train set 2.021x speedup, test set 0.925x speedup, val set 0.502x speedup, step: 3, train time 16.18 s
Epoch 17/50 |loss: 0.143533| train set 1.976x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 16.31 s
Epoch 18/50 |loss: 0.143357| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.12 s
Epoch 19/50 |loss: 0.139439| train set 1.997x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 1, train time 16.12 s
Epoch 20/50 |loss: 0.141512| train set 2.022x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 2, train time 16.17 s
Epoch 21/50 |loss: 0.140172| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 3, train time 16.31 s
Epoch 22/50 |loss: 0.144033| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 4, train time 16.02 s
Epoch 23/50 |loss: 0.141011| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.11 s
Epoch 24/50 |loss: 0.140404| train set 2.022x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 1, train time 16.40 s
Epoch 25/50 |loss: 0.139022| train set 2.022x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 2, train time 16.18 s
Epoch 26/50 |loss: 0.138994| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 16.14 s
Epoch 27/50 |loss: 0.139956| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 16.20 s
Epoch 28/50 |loss: 0.138787| train set 2.020x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.30 s
Epoch 29/50 |loss: 0.136157| train set 1.977x speedup, test set 0.933x speedup, val set 0.757x speedup, step: 1, train time 16.13 s
Epoch 30/50 |loss: 0.135212| train set 2.021x speedup, test set 0.923x speedup, val set 0.502x speedup, step: 2, train time 16.30 s
Epoch 31/50 |loss: 0.137344| train set 1.997x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 3, train time 15.91 s
Epoch 32/50 |loss: 0.137765| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 16.19 s
Epoch 33/50 |loss: 0.138246| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.01 s
Epoch 34/50 |loss: 0.136604| train set 2.019x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 6, train time 16.18 s
Epoch 35/50 |loss: 0.135280| train set 1.977x speedup, test set 0.923x speedup, val set 0.502x speedup, step: 7, train time 16.12 s
Epoch 36/50 |loss: 0.135033| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 8, train time 16.11 s
Epoch 37/50 |loss: 0.133865| train set 2.022x speedup, test set 0.925x speedup, val set 0.502x speedup, step: 9, train time 16.20 s
Epoch 38/50 |loss: 0.134270| train set 1.977x speedup, test set 1.454x speedup, val set 0.502x speedup, step: 10, train time 16.31 s
Epoch 39/50 |loss: 0.136073| train set 1.978x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 11, train time 16.02 s
Epoch 40/50 |loss: 0.133525| train set 1.978x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 12, train time 16.10 s
Epoch 41/50 |loss: 0.135085| train set 1.997x speedup, test set 0.926x speedup, val set 0.502x speedup, step: 13, train time 15.91 s
Epoch 42/50 |loss: 0.134100| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 14, train time 16.20 s
Epoch 43/50 |loss: 0.133187| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 15, train time 16.29 s
Epoch 44/50 |loss: 0.132688| train set 1.997x speedup, test set 1.521x speedup, val set 0.502x speedup, step: 16, train time 16.31 s
Epoch 45/50 |loss: 0.133443| train set 1.995x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 17, train time 16.28 s
Epoch 46/50 |loss: 0.134035| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 18, train time 16.41 s
Epoch 47/50 |loss: 0.133939| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 19, train time 16.60 s
Epoch 48/50 |loss: 0.130886| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 20, train time 16.59 s
Epoch 49/50 |loss: 0.133978| train set 2.022x speedup, test set 0.923x speedup, val set 0.502x speedup, step: 21, train time 16.82 s
Training per epoch cost 16.257 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 580.359s, pg runtime 432.766s, speedup 0.746x
32, opt runtime 15.120s, model runtime 580.203s, pg runtime 566.078s, speedup 0.976x
33, opt runtime 16.639s, model runtime 576.339s, pg runtime 462.544s, speedup 0.803x
34, opt runtime 16.280s, model runtime 615.635s, pg runtime 634.990s, speedup 1.031x
35, opt runtime 16.528s, model runtime 616.056s, pg runtime 620.762s, speedup 1.008x
36, opt runtime 18.690s, model runtime 637.615s, pg runtime 651.942s, speedup 1.022x
37, opt runtime 16.438s, model runtime 583.941s, pg runtime 546.887s, speedup 0.937x
38, opt runtime 16.138s, model runtime 572.741s, pg runtime 501.793s, speedup 0.876x
39, opt runtime 16.770s, model runtime 617.719s, pg runtime 594.754s, speedup 0.963x
40, opt runtime 16.305s, model runtime 577.424s, pg runtime 436.168s, speedup 0.755x
====================
best train speedup epoch: 13, train speedup 2.022, test speedup 0.931, val speedup 0.502
best test speedup epoch: 2, train speedup 1.965, test speedup 3.777, val speedup 0.502
best validation speedup epoch: 29, train speedup 1.977, test speedup 0.933, val speedup 0.757
last model at epoch 49, train speedup 2.022, test speedup 0.923, val speedup 0.502
execution cost 0:14:50.487571
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.946995, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.327443| train set 2.021x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 1, train time 17.83 s
Epoch 1/50 |loss: 0.218211| train set 1.827x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 15.99 s
Epoch 2/50 |loss: 0.201704| train set 1.959x speedup, test set 1.607x speedup, val set 1.000x speedup, step: 3, train time 15.83 s
Epoch 3/50 |loss: 0.175079| train set 1.835x speedup, test set 0.952x speedup, val set 0.502x speedup, step: 4, train time 15.89 s
Epoch 4/50 |loss: 0.169568| train set 2.022x speedup, test set 4.338x speedup, val set 1.000x speedup, step: 1, train time 15.72 s
Epoch 5/50 |loss: 0.165336| train set 2.022x speedup, test set 1.510x speedup, val set 0.502x speedup, step: 2, train time 15.79 s
Epoch 6/50 |loss: 0.159965| train set 1.997x speedup, test set 1.617x speedup, val set 0.502x speedup, step: 3, train time 15.68 s
Epoch 7/50 |loss: 0.158113| train set 1.978x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 4, train time 15.40 s
Epoch 8/50 |loss: 0.157422| train set 1.965x speedup, test set 1.737x speedup, val set 0.502x speedup, step: 5, train time 15.51 s
Epoch 9/50 |loss: 0.153162| train set 1.977x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 6, train time 15.49 s
Epoch 10/50 |loss: 0.152391| train set 2.022x speedup, test set 1.525x speedup, val set 0.502x speedup, step: 7, train time 15.58 s
Epoch 11/50 |loss: 0.150888| train set 2.019x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 8, train time 15.33 s
Epoch 12/50 |loss: 0.146392| train set 1.876x speedup, test set 1.609x speedup, val set 0.502x speedup, step: 9, train time 15.59 s
Epoch 13/50 |loss: 0.150594| train set 2.022x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 10, train time 15.58 s
Epoch 14/50 |loss: 0.147395| train set 1.996x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 11, train time 15.52 s
Epoch 15/50 |loss: 0.144255| train set 2.022x speedup, test set 4.063x speedup, val set 0.502x speedup, step: 12, train time 15.88 s
Epoch 16/50 |loss: 0.143198| train set 2.021x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 13, train time 15.39 s
Epoch 17/50 |loss: 0.144094| train set 1.978x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 14, train time 15.61 s
Epoch 18/50 |loss: 0.143413| train set 1.978x speedup, test set 4.752x speedup, val set 0.502x speedup, step: 15, train time 15.51 s
Epoch 19/50 |loss: 0.140890| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 16, train time 15.51 s
Epoch 20/50 |loss: 0.141098| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 17, train time 15.60 s
Epoch 21/50 |loss: 0.140336| train set 1.996x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 18, train time 15.49 s
Epoch 22/50 |loss: 0.144410| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 19, train time 15.59 s
Epoch 23/50 |loss: 0.140789| train set 2.021x speedup, test set 4.752x speedup, val set 0.502x speedup, step: 20, train time 15.48 s
Epoch 24/50 |loss: 0.138680| train set 2.022x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 21, train time 15.70 s
Epoch 25/50 |loss: 0.139078| train set 2.022x speedup, test set 4.752x speedup, val set 0.502x speedup, step: 22, train time 15.53 s
Epoch 26/50 |loss: 0.139681| train set 1.954x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 23, train time 15.67 s
Epoch 27/50 |loss: 0.138259| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 24, train time 15.62 s
Epoch 28/50 |loss: 0.138274| train set 2.022x speedup, test set 4.752x speedup, val set 0.502x speedup, step: 25, train time 15.60 s
Epoch 29/50 |loss: 0.136342| train set 2.021x speedup, test set 4.752x speedup, val set 1.000x speedup, step: 1, train time 15.60 s
Epoch 30/50 |loss: 0.136162| train set 2.021x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 2, train time 15.48 s
Epoch 31/50 |loss: 0.138926| train set 1.997x speedup, test set 4.053x speedup, val set 0.502x speedup, step: 3, train time 15.52 s
Epoch 32/50 |loss: 0.137419| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 4, train time 15.61 s
Epoch 33/50 |loss: 0.137243| train set 2.021x speedup, test set 1.735x speedup, val set 0.502x speedup, step: 5, train time 15.59 s
Epoch 34/50 |loss: 0.137048| train set 2.019x speedup, test set 1.655x speedup, val set 0.502x speedup, step: 6, train time 15.51 s
Epoch 35/50 |loss: 0.135990| train set 1.977x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 7, train time 15.51 s
Epoch 36/50 |loss: 0.134243| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 8, train time 15.42 s
Epoch 37/50 |loss: 0.133091| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 9, train time 15.69 s
Epoch 38/50 |loss: 0.134971| train set 1.977x speedup, test set 1.655x speedup, val set 0.502x speedup, step: 10, train time 15.69 s
Epoch 39/50 |loss: 0.136010| train set 2.022x speedup, test set 4.752x speedup, val set 0.502x speedup, step: 11, train time 15.51 s
Epoch 40/50 |loss: 0.134213| train set 2.022x speedup, test set 4.752x speedup, val set 0.502x speedup, step: 12, train time 15.42 s
Epoch 41/50 |loss: 0.135705| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 13, train time 15.69 s
Epoch 42/50 |loss: 0.134170| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 14, train time 15.40 s
Epoch 43/50 |loss: 0.134120| train set 2.022x speedup, test set 4.752x speedup, val set 0.502x speedup, step: 15, train time 15.52 s
Epoch 44/50 |loss: 0.133493| train set 1.997x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 16, train time 15.52 s
Epoch 45/50 |loss: 0.134015| train set 1.996x speedup, test set 1.655x speedup, val set 0.502x speedup, step: 17, train time 15.39 s
Epoch 46/50 |loss: 0.135484| train set 2.022x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 18, train time 15.51 s
early stopping at epoch 46
Training per epoch cost 15.627 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 13, train speedup 2.022, test speedup 0.967, val speedup 0.502
best test speedup epoch: 18, train speedup 1.978, test speedup 4.752, val speedup 0.502
best validation speedup epoch: 29, train speedup 2.021, test speedup 4.752, val speedup 1.000
last model at epoch 46, train speedup 2.022, test speedup 0.967, val speedup 0.502
execution cost 0:13:19.635051
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.361778, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.327875| train set 2.022x speedup, test set 1.515x speedup, val set 1.000x speedup, step: 1, train time 18.44 s
Epoch 1/50 |loss: 0.218317| train set 1.965x speedup, test set 2.081x speedup, val set 0.502x speedup, step: 2, train time 16.02 s
Epoch 2/50 |loss: 0.205212| train set 1.965x speedup, test set 3.777x speedup, val set 0.502x speedup, step: 3, train time 15.90 s
Epoch 3/50 |loss: 0.177180| train set 1.853x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.09 s
Epoch 4/50 |loss: 0.170399| train set 2.022x speedup, test set 1.439x speedup, val set 0.502x speedup, step: 1, train time 16.11 s
Epoch 5/50 |loss: 0.167415| train set 2.022x speedup, test set 3.777x speedup, val set 0.502x speedup, step: 2, train time 15.49 s
Epoch 6/50 |loss: 0.160270| train set 1.997x speedup, test set 1.439x speedup, val set 0.502x speedup, step: 3, train time 15.69 s
Epoch 7/50 |loss: 0.157004| train set 1.978x speedup, test set 0.964x speedup, val set 0.502x speedup, step: 4, train time 15.50 s
Epoch 8/50 |loss: 0.160071| train set 1.961x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 5, train time 15.62 s
Epoch 9/50 |loss: 0.155469| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 15.69 s
Epoch 10/50 |loss: 0.152074| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 2, train time 15.50 s
Epoch 11/50 |loss: 0.151559| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.51 s
Epoch 12/50 |loss: 0.148054| train set 1.876x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 15.51 s
Epoch 13/50 |loss: 0.151224| train set 1.965x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 15.51 s
Epoch 14/50 |loss: 0.148300| train set 1.993x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 15.52 s
Epoch 15/50 |loss: 0.144677| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 2, train time 16.11 s
Epoch 16/50 |loss: 0.143422| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.60 s
Epoch 17/50 |loss: 0.144805| train set 1.977x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 4, train time 15.50 s
Epoch 18/50 |loss: 0.144200| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 15.70 s
Epoch 19/50 |loss: 0.139849| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 15.72 s
Epoch 20/50 |loss: 0.141102| train set 2.019x speedup, test set 4.053x speedup, val set 0.502x speedup, step: 2, train time 15.59 s
Epoch 21/50 |loss: 0.140604| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.70 s
Epoch 22/50 |loss: 0.144220| train set 2.022x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 4, train time 15.60 s
Epoch 23/50 |loss: 0.140323| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 15.51 s
Epoch 24/50 |loss: 0.140442| train set 1.997x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 1, train time 15.69 s
Epoch 25/50 |loss: 0.137956| train set 2.022x speedup, test set 4.053x speedup, val set 0.502x speedup, step: 2, train time 15.40 s
Epoch 26/50 |loss: 0.139190| train set 1.954x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.61 s
Epoch 27/50 |loss: 0.138278| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 15.61 s
Epoch 28/50 |loss: 0.138808| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 15.61 s
Epoch 29/50 |loss: 0.136261| train set 1.976x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 1, train time 15.62 s
Epoch 30/50 |loss: 0.136928| train set 2.020x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 2, train time 15.51 s
Epoch 31/50 |loss: 0.137415| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.51 s
Epoch 32/50 |loss: 0.138232| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 15.72 s
Epoch 33/50 |loss: 0.139055| train set 2.021x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 5, train time 15.53 s
Epoch 34/50 |loss: 0.137882| train set 2.019x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 1, train time 15.68 s
Epoch 35/50 |loss: 0.136706| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 2, train time 15.60 s
Epoch 36/50 |loss: 0.135582| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.60 s
Epoch 37/50 |loss: 0.133057| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 4, train time 15.70 s
Epoch 38/50 |loss: 0.136036| train set 1.977x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 5, train time 15.51 s
Epoch 39/50 |loss: 0.135279| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 15.69 s
Epoch 40/50 |loss: 0.134650| train set 1.996x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 2, train time 15.68 s
Epoch 41/50 |loss: 0.137089| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.49 s
Epoch 42/50 |loss: 0.134102| train set 1.997x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 4, train time 15.51 s
Epoch 43/50 |loss: 0.135107| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 15.61 s
Epoch 44/50 |loss: 0.132779| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 15.52 s
Epoch 45/50 |loss: 0.134415| train set 1.996x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 2, train time 15.51 s
Epoch 46/50 |loss: 0.134916| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.53 s
early stopping at epoch 46
Training per epoch cost 15.693 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 580.359s, pg runtime 432.766s, speedup 0.746x
32, opt runtime 15.120s, model runtime 580.203s, pg runtime 566.078s, speedup 0.976x
33, opt runtime 16.639s, model runtime 576.339s, pg runtime 462.544s, speedup 0.803x
34, opt runtime 16.280s, model runtime 615.635s, pg runtime 634.990s, speedup 1.031x
35, opt runtime 16.528s, model runtime 616.056s, pg runtime 620.762s, speedup 1.008x
36, opt runtime 18.690s, model runtime 637.615s, pg runtime 651.942s, speedup 1.022x
37, opt runtime 16.438s, model runtime 583.941s, pg runtime 546.887s, speedup 0.937x
38, opt runtime 16.138s, model runtime 572.741s, pg runtime 501.793s, speedup 0.876x
39, opt runtime 16.770s, model runtime 617.719s, pg runtime 594.754s, speedup 0.963x
40, opt runtime 16.305s, model runtime 577.424s, pg runtime 436.168s, speedup 0.755x
====================
best train speedup epoch: 43, train speedup 2.022, test speedup 0.933, val speedup 0.502
best test speedup epoch: 20, train speedup 2.019, test speedup 4.053, val speedup 0.502
best validation speedup epoch: 44, train speedup 1.997, test speedup 0.933, val speedup 0.502
last model at epoch 46, train speedup 1.997, test speedup 0.933, val speedup 0.502
execution cost 0:13:25.067440
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.199280, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.327784| train set 2.022x speedup, test set 1.515x speedup, val set 0.502x speedup, step: 1, train time 18.50 s
Epoch 1/50 |loss: 0.218520| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 16.28 s
Epoch 2/50 |loss: 0.202327| train set 2.022x speedup, test set 1.519x speedup, val set 1.000x speedup, step: 3, train time 16.39 s
Epoch 3/50 |loss: 0.175753| train set 1.832x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.21 s
Epoch 4/50 |loss: 0.169213| train set 2.022x speedup, test set 1.439x speedup, val set 0.502x speedup, step: 1, train time 16.30 s
Epoch 5/50 |loss: 0.166557| train set 2.019x speedup, test set 1.439x speedup, val set 0.502x speedup, step: 2, train time 16.08 s
Epoch 6/50 |loss: 0.161112| train set 1.997x speedup, test set 1.443x speedup, val set 0.502x speedup, step: 3, train time 16.09 s
Epoch 7/50 |loss: 0.159022| train set 1.954x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 4, train time 15.93 s
Epoch 8/50 |loss: 0.158209| train set 1.961x speedup, test set 0.926x speedup, val set 0.502x speedup, step: 5, train time 16.22 s
Epoch 9/50 |loss: 0.154349| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 16.21 s
Epoch 10/50 |loss: 0.154121| train set 1.978x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 2, train time 15.99 s
Epoch 11/50 |loss: 0.151898| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.51 s
Epoch 12/50 |loss: 0.148089| train set 1.997x speedup, test set 1.439x speedup, val set 0.502x speedup, step: 4, train time 15.41 s
Epoch 13/50 |loss: 0.150341| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 15.32 s
Epoch 14/50 |loss: 0.146840| train set 2.018x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 1, train time 15.60 s
Epoch 15/50 |loss: 0.145518| train set 2.022x speedup, test set 1.469x speedup, val set 0.502x speedup, step: 2, train time 15.81 s
Epoch 16/50 |loss: 0.143856| train set 2.022x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 3, train time 15.50 s
Epoch 17/50 |loss: 0.144030| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 15.59 s
Epoch 18/50 |loss: 0.144247| train set 2.021x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 5, train time 15.40 s
Epoch 19/50 |loss: 0.140157| train set 1.997x speedup, test set 1.469x speedup, val set 0.502x speedup, step: 1, train time 15.60 s
Epoch 20/50 |loss: 0.141608| train set 2.022x speedup, test set 3.983x speedup, val set 0.502x speedup, step: 2, train time 15.50 s
Epoch 21/50 |loss: 0.140577| train set 1.997x speedup, test set 0.954x speedup, val set 0.502x speedup, step: 3, train time 15.42 s
Epoch 22/50 |loss: 0.142612| train set 2.022x speedup, test set 1.538x speedup, val set 0.502x speedup, step: 4, train time 15.53 s
Epoch 23/50 |loss: 0.141164| train set 1.977x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 5, train time 15.50 s
Epoch 24/50 |loss: 0.141142| train set 2.013x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 15.52 s
Epoch 25/50 |loss: 0.139244| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 2, train time 15.41 s
Epoch 26/50 |loss: 0.138218| train set 1.954x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 3, train time 15.62 s
Epoch 27/50 |loss: 0.139870| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 4, train time 15.60 s
Epoch 28/50 |loss: 0.138250| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 5, train time 15.58 s
Epoch 29/50 |loss: 0.135729| train set 1.977x speedup, test set 1.478x speedup, val set 1.000x speedup, step: 1, train time 15.60 s
Epoch 30/50 |loss: 0.135762| train set 2.021x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 2, train time 15.59 s
Epoch 31/50 |loss: 0.138603| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 3, train time 15.77 s
Epoch 32/50 |loss: 0.138431| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 4, train time 15.69 s
Epoch 33/50 |loss: 0.138102| train set 2.019x speedup, test set 3.983x speedup, val set 0.502x speedup, step: 5, train time 15.70 s
Epoch 34/50 |loss: 0.137106| train set 2.019x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 6, train time 15.61 s
Epoch 35/50 |loss: 0.134967| train set 2.021x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 7, train time 15.60 s
Epoch 36/50 |loss: 0.135737| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 8, train time 15.68 s
Epoch 37/50 |loss: 0.133596| train set 1.997x speedup, test set 1.469x speedup, val set 0.502x speedup, step: 9, train time 15.48 s
Epoch 38/50 |loss: 0.134254| train set 1.977x speedup, test set 1.454x speedup, val set 0.502x speedup, step: 10, train time 15.59 s
Epoch 39/50 |loss: 0.135954| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 11, train time 15.43 s
Epoch 40/50 |loss: 0.133669| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 12, train time 15.43 s
Epoch 41/50 |loss: 0.135767| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 13, train time 15.49 s
Epoch 42/50 |loss: 0.134444| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 14, train time 15.51 s
Epoch 43/50 |loss: 0.134356| train set 2.022x speedup, test set 1.474x speedup, val set 0.502x speedup, step: 15, train time 15.59 s
Epoch 44/50 |loss: 0.132770| train set 1.978x speedup, test set 3.983x speedup, val set 0.502x speedup, step: 16, train time 15.39 s
Epoch 45/50 |loss: 0.134649| train set 1.995x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 17, train time 15.60 s
Epoch 46/50 |loss: 0.135063| train set 2.021x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 18, train time 15.41 s
early stopping at epoch 46
Training per epoch cost 15.740 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 13, train speedup 2.022, test speedup 0.933, val speedup 0.502
best test speedup epoch: 20, train speedup 2.022, test speedup 3.983, val speedup 0.502
best validation speedup epoch: 29, train speedup 1.977, test speedup 1.478, val speedup 1.000
last model at epoch 46, train speedup 2.021, test speedup 1.478, val speedup 0.502
execution cost 0:13:27.043572
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.988524, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.327733| train set 2.022x speedup, test set 1.515x speedup, val set 1.000x speedup, step: 1, train time 18.77 s
Epoch 1/50 |loss: 0.220999| train set 1.965x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 16.30 s
Epoch 2/50 |loss: 0.200606| train set 1.924x speedup, test set 1.443x speedup, val set 1.000x speedup, step: 3, train time 16.22 s
Epoch 3/50 |loss: 0.177991| train set 1.832x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.25 s
Epoch 4/50 |loss: 0.170246| train set 2.022x speedup, test set 1.439x speedup, val set 0.502x speedup, step: 1, train time 16.10 s
Epoch 5/50 |loss: 0.168311| train set 2.022x speedup, test set 0.951x speedup, val set 0.502x speedup, step: 2, train time 16.04 s
Epoch 6/50 |loss: 0.161240| train set 1.997x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 3, train time 16.31 s
Epoch 7/50 |loss: 0.159301| train set 1.997x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 4, train time 16.13 s
Epoch 8/50 |loss: 0.160094| train set 1.961x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 5, train time 16.23 s
Epoch 9/50 |loss: 0.156115| train set 1.977x speedup, test set 0.933x speedup, val set 1.000x speedup, step: 1, train time 16.09 s
Epoch 10/50 |loss: 0.152837| train set 1.978x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 2, train time 16.10 s
Epoch 11/50 |loss: 0.152836| train set 2.020x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 16.21 s
Epoch 12/50 |loss: 0.147277| train set 1.876x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.29 s
Epoch 13/50 |loss: 0.151326| train set 2.022x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 5, train time 16.21 s
Epoch 14/50 |loss: 0.148807| train set 1.992x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 6, train time 16.01 s
Epoch 15/50 |loss: 0.145271| train set 2.022x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 7, train time 16.43 s
Epoch 16/50 |loss: 0.146215| train set 2.021x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 8, train time 16.19 s
Epoch 17/50 |loss: 0.145738| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 9, train time 16.21 s
Epoch 18/50 |loss: 0.143687| train set 2.020x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 10, train time 16.18 s
Epoch 19/50 |loss: 0.140738| train set 1.997x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 11, train time 15.99 s
Epoch 20/50 |loss: 0.141665| train set 2.020x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 12, train time 15.94 s
Epoch 21/50 |loss: 0.140722| train set 1.997x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 13, train time 16.13 s
Epoch 22/50 |loss: 0.144640| train set 2.022x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 14, train time 15.90 s
Epoch 23/50 |loss: 0.141874| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 15, train time 16.11 s
Epoch 24/50 |loss: 0.140114| train set 1.997x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 16, train time 16.30 s
Epoch 25/50 |loss: 0.139385| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 17, train time 16.29 s
Epoch 26/50 |loss: 0.140047| train set 1.978x speedup, test set 0.931x speedup, val set 0.502x speedup, step: 18, train time 16.29 s
Epoch 27/50 |loss: 0.139626| train set 1.997x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 19, train time 16.22 s
Epoch 28/50 |loss: 0.139185| train set 1.876x speedup, test set 0.925x speedup, val set 0.502x speedup, step: 20, train time 16.31 s
Epoch 29/50 |loss: 0.137201| train set 1.975x speedup, test set 1.478x speedup, val set 1.000x speedup, step: 1, train time 16.43 s
Epoch 30/50 |loss: 0.136038| train set 2.020x speedup, test set 0.923x speedup, val set 0.502x speedup, step: 2, train time 16.32 s
Epoch 31/50 |loss: 0.138613| train set 1.996x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 3, train time 16.61 s
Epoch 32/50 |loss: 0.138326| train set 2.022x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 4, train time 16.31 s
Epoch 33/50 |loss: 0.138642| train set 2.021x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 5, train time 16.40 s
Epoch 34/50 |loss: 0.137771| train set 2.019x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 6, train time 16.30 s
Epoch 35/50 |loss: 0.136225| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 7, train time 16.42 s
Epoch 36/50 |loss: 0.135659| train set 1.997x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 8, train time 16.38 s
Epoch 37/50 |loss: 0.134121| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 9, train time 16.51 s
Epoch 38/50 |loss: 0.135800| train set 2.021x speedup, test set 0.957x speedup, val set 0.502x speedup, step: 10, train time 16.39 s
Epoch 39/50 |loss: 0.135330| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 11, train time 16.33 s
Epoch 40/50 |loss: 0.134722| train set 1.978x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 12, train time 16.29 s
Epoch 41/50 |loss: 0.136150| train set 1.997x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 13, train time 16.30 s
Epoch 42/50 |loss: 0.135213| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 14, train time 16.48 s
Epoch 43/50 |loss: 0.134974| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 15, train time 16.50 s
Epoch 44/50 |loss: 0.133826| train set 1.978x speedup, test set 1.472x speedup, val set 0.502x speedup, step: 16, train time 16.22 s
Epoch 45/50 |loss: 0.135124| train set 1.995x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 17, train time 16.30 s
Epoch 46/50 |loss: 0.134460| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 18, train time 16.31 s
early stopping at epoch 46
Training per epoch cost 16.309 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 13, train speedup 2.022, test speedup 0.931, val speedup 0.502
best test speedup epoch: 0, train speedup 2.022, test speedup 1.515, val speedup 1.000
best validation speedup epoch: 29, train speedup 1.975, test speedup 1.478, val speedup 1.000
last model at epoch 46, train speedup 2.022, test speedup 0.933, val speedup 0.502
execution cost 0:14:00.294662
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.256142, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.326961| train set 2.021x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 1, train time 18.47 s
Epoch 1/50 |loss: 0.217465| train set 1.965x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 15.90 s
Epoch 2/50 |loss: 0.202193| train set 1.965x speedup, test set 1.607x speedup, val set 1.000x speedup, step: 3, train time 15.73 s
Epoch 3/50 |loss: 0.175265| train set 1.856x speedup, test set 0.950x speedup, val set 0.502x speedup, step: 4, train time 15.68 s
Epoch 4/50 |loss: 0.170554| train set 2.022x speedup, test set 1.001x speedup, val set 0.502x speedup, step: 1, train time 15.69 s
Epoch 5/50 |loss: 0.166213| train set 2.022x speedup, test set 1.444x speedup, val set 0.502x speedup, step: 2, train time 15.58 s
Epoch 6/50 |loss: 0.161731| train set 1.997x speedup, test set 1.443x speedup, val set 0.502x speedup, step: 3, train time 15.60 s
Epoch 7/50 |loss: 0.157472| train set 1.977x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 4, train time 15.52 s
Epoch 8/50 |loss: 0.157064| train set 1.961x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 5, train time 15.70 s
Epoch 9/50 |loss: 0.154038| train set 2.021x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 1, train time 15.79 s
Epoch 10/50 |loss: 0.151798| train set 1.978x speedup, test set 1.222x speedup, val set 0.502x speedup, step: 2, train time 15.60 s
Epoch 11/50 |loss: 0.149838| train set 2.022x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 3, train time 15.60 s
Epoch 12/50 |loss: 0.147262| train set 1.854x speedup, test set 1.607x speedup, val set 0.502x speedup, step: 4, train time 15.59 s
Epoch 13/50 |loss: 0.148448| train set 1.965x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 5, train time 15.51 s
Epoch 14/50 |loss: 0.148040| train set 1.994x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 1, train time 15.69 s
Epoch 15/50 |loss: 0.144855| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 2, train time 16.17 s
Epoch 16/50 |loss: 0.144298| train set 1.996x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 3, train time 15.60 s
Epoch 17/50 |loss: 0.144179| train set 2.022x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 4, train time 15.69 s
Epoch 18/50 |loss: 0.142785| train set 2.021x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 5, train time 15.59 s
Epoch 19/50 |loss: 0.140786| train set 1.997x speedup, test set 1.735x speedup, val set 0.502x speedup, step: 1, train time 15.61 s
Epoch 20/50 |loss: 0.140871| train set 2.020x speedup, test set 4.053x speedup, val set 0.502x speedup, step: 2, train time 15.48 s
Epoch 21/50 |loss: 0.142226| train set 1.997x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 3, train time 15.61 s
Epoch 22/50 |loss: 0.142442| train set 2.022x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 4, train time 15.50 s
Epoch 23/50 |loss: 0.141716| train set 2.021x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 5, train time 15.70 s
Epoch 24/50 |loss: 0.140147| train set 1.997x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 1, train time 15.61 s
Epoch 25/50 |loss: 0.137887| train set 1.856x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 2, train time 15.58 s
Epoch 26/50 |loss: 0.139664| train set 1.978x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 3, train time 15.42 s
Epoch 27/50 |loss: 0.139824| train set 1.997x speedup, test set 1.655x speedup, val set 0.502x speedup, step: 4, train time 15.60 s
Epoch 28/50 |loss: 0.137613| train set 2.020x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 5, train time 15.61 s
Epoch 29/50 |loss: 0.135963| train set 1.977x speedup, test set 1.655x speedup, val set 0.502x speedup, step: 1, train time 15.50 s
Epoch 30/50 |loss: 0.135912| train set 2.021x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 2, train time 15.59 s
Epoch 31/50 |loss: 0.137672| train set 1.997x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 3, train time 15.42 s
Epoch 32/50 |loss: 0.138039| train set 1.997x speedup, test set 1.655x speedup, val set 0.502x speedup, step: 4, train time 15.68 s
Epoch 33/50 |loss: 0.138823| train set 2.021x speedup, test set 1.735x speedup, val set 0.502x speedup, step: 5, train time 15.50 s
Epoch 34/50 |loss: 0.136834| train set 2.019x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 1, train time 15.61 s
Epoch 35/50 |loss: 0.136446| train set 1.977x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 2, train time 15.49 s
Epoch 36/50 |loss: 0.135100| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 3, train time 15.70 s
Epoch 37/50 |loss: 0.133234| train set 1.997x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 4, train time 15.60 s
Epoch 38/50 |loss: 0.136549| train set 1.977x speedup, test set 1.657x speedup, val set 0.502x speedup, step: 5, train time 15.70 s
Epoch 39/50 |loss: 0.136655| train set 2.022x speedup, test set 2.007x speedup, val set 0.502x speedup, step: 1, train time 15.70 s
early stopping at epoch 39
Training per epoch cost 15.698 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 365.512s, pg runtime 432.766s, speedup 1.184x
32, opt runtime 15.120s, model runtime 429.377s, pg runtime 566.078s, speedup 1.318x
33, opt runtime 16.639s, model runtime 378.987s, pg runtime 462.544s, speedup 1.220x
34, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
35, opt runtime 16.528s, model runtime 437.980s, pg runtime 620.762s, speedup 1.417x
36, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
37, opt runtime 16.438s, model runtime 387.494s, pg runtime 546.887s, speedup 1.411x
38, opt runtime 16.138s, model runtime 385.465s, pg runtime 501.793s, speedup 1.302x
39, opt runtime 16.770s, model runtime 393.974s, pg runtime 594.754s, speedup 1.510x
40, opt runtime 16.305s, model runtime 401.313s, pg runtime 436.168s, speedup 1.087x
====================
best train speedup epoch: 4, train speedup 2.022, test speedup 1.001, val speedup 0.502
best test speedup epoch: 20, train speedup 2.020, test speedup 4.053, val speedup 0.502
best validation speedup epoch: 39, train speedup 2.022, test speedup 2.007, val speedup 0.502
last model at epoch 39, train speedup 2.022, test speedup 2.007, val speedup 0.502
execution cost 0:11:25.676208
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.127850, and there are 13430 training samples
in channel 9
Epoch 0/50 |loss: 0.328285| train set 1.965x speedup, test set 0.917x speedup, val set 1.000x speedup, step: 1, train time 19.14 s
Epoch 1/50 |loss: 0.217948| train set 2.022x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 2, train time 16.30 s
Epoch 2/50 |loss: 0.202388| train set 2.021x speedup, test set 1.771x speedup, val set 1.000x speedup, step: 3, train time 16.32 s
Epoch 3/50 |loss: 0.177578| train set 1.835x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.12 s
Epoch 4/50 |loss: 0.170129| train set 2.022x speedup, test set 1.549x speedup, val set 0.502x speedup, step: 1, train time 16.39 s
Epoch 5/50 |loss: 0.166916| train set 2.022x speedup, test set 0.951x speedup, val set 0.502x speedup, step: 2, train time 16.31 s
Epoch 6/50 |loss: 0.159582| train set 1.996x speedup, test set 0.920x speedup, val set 0.502x speedup, step: 3, train time 16.29 s
Epoch 7/50 |loss: 0.158407| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 16.41 s
Epoch 8/50 |loss: 0.157693| train set 1.965x speedup, test set 0.929x speedup, val set 0.502x speedup, step: 5, train time 16.40 s
Epoch 9/50 |loss: 0.154355| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 16.10 s
Epoch 10/50 |loss: 0.152931| train set 2.022x speedup, test set 0.919x speedup, val set 0.502x speedup, step: 2, train time 16.09 s
Epoch 11/50 |loss: 0.150754| train set 2.019x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 16.20 s
Epoch 12/50 |loss: 0.147806| train set 1.854x speedup, test set 0.917x speedup, val set 0.502x speedup, step: 4, train time 16.18 s
Epoch 13/50 |loss: 0.149617| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.31 s
Epoch 14/50 |loss: 0.145868| train set 2.019x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 1, train time 16.33 s
Epoch 15/50 |loss: 0.144291| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 2, train time 16.71 s
Epoch 16/50 |loss: 0.141785| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 16.21 s
Epoch 17/50 |loss: 0.143232| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 4, train time 16.21 s
Epoch 18/50 |loss: 0.142818| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 16.11 s
Epoch 19/50 |loss: 0.139315| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 1, train time 15.50 s
Epoch 20/50 |loss: 0.140027| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 2, train time 15.59 s
Epoch 21/50 |loss: 0.140045| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 3, train time 15.50 s
Epoch 22/50 |loss: 0.142852| train set 2.022x speedup, test set 1.446x speedup, val set 0.502x speedup, step: 4, train time 15.50 s
Epoch 23/50 |loss: 0.140372| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 15.51 s
Epoch 24/50 |loss: 0.139697| train set 1.997x speedup, test set 1.474x speedup, val set 0.502x speedup, step: 1, train time 15.62 s
Epoch 25/50 |loss: 0.138477| train set 2.022x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 2, train time 15.58 s
Epoch 26/50 |loss: 0.139833| train set 1.978x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 3, train time 15.69 s
Epoch 27/50 |loss: 0.138506| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 4, train time 15.59 s
Epoch 28/50 |loss: 0.139130| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 5, train time 15.51 s
Epoch 29/50 |loss: 0.136496| train set 1.975x speedup, test set 1.478x speedup, val set 1.000x speedup, step: 1, train time 15.78 s
Epoch 30/50 |loss: 0.135488| train set 2.021x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 2, train time 15.48 s
Epoch 31/50 |loss: 0.136895| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 3, train time 15.68 s
Epoch 32/50 |loss: 0.137955| train set 2.022x speedup, test set 0.926x speedup, val set 0.502x speedup, step: 4, train time 15.41 s
Epoch 33/50 |loss: 0.137322| train set 2.021x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 5, train time 15.70 s
Epoch 34/50 |loss: 0.137795| train set 2.019x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 6, train time 15.49 s
Epoch 35/50 |loss: 0.135521| train set 1.977x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 7, train time 15.49 s
Epoch 36/50 |loss: 0.134623| train set 2.022x speedup, test set 0.933x speedup, val set 0.502x speedup, step: 8, train time 15.59 s
Epoch 37/50 |loss: 0.132740| train set 1.997x speedup, test set 0.967x speedup, val set 0.502x speedup, step: 9, train time 15.41 s
Epoch 38/50 |loss: 0.136000| train set 1.977x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 10, train time 15.51 s
Epoch 39/50 |loss: 0.136706| train set 1.997x speedup, test set 1.478x speedup, val set 0.502x speedup, step: 11, train time 15.41 s
early stopping at epoch 39
Training per epoch cost 15.966 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
12, opt runtime 48.784s, model runtime 140.509s, pg runtime 78.349s, speedup 0.558x
13, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
14, opt runtime 47.812s, model runtime 139.115s, pg runtime 83.069s, speedup 0.597x
15, opt runtime 47.518s, model runtime 133.905s, pg runtime 75.736s, speedup 0.566x
16, opt runtime 48.067s, model runtime 135.202s, pg runtime 81.014s, speedup 0.599x
17, opt runtime 47.738s, model runtime 135.818s, pg runtime 76.021s, speedup 0.560x
18, opt runtime 47.804s, model runtime 136.805s, pg runtime 81.177s, speedup 0.593x
19, opt runtime 49.511s, model runtime 157.094s, pg runtime 87.329s, speedup 0.556x
20, opt runtime 51.276s, model runtime 134.457s, pg runtime 79.222s, speedup 0.589x
21, opt runtime 24.391s, model runtime 601.866s, pg runtime 601.866s, speedup 1.000x
22, opt runtime 24.079s, model runtime 608.707s, pg runtime 608.707s, speedup 1.000x
23, opt runtime 24.662s, model runtime 613.999s, pg runtime 613.999s, speedup 1.000x
24, opt runtime 24.459s, model runtime 608.717s, pg runtime 608.717s, speedup 1.000x
25, opt runtime 25.236s, model runtime 601.756s, pg runtime 601.756s, speedup 1.000x
26, opt runtime 25.363s, model runtime 611.327s, pg runtime 611.327s, speedup 1.000x
27, opt runtime 24.706s, model runtime 610.808s, pg runtime 610.808s, speedup 1.000x
28, opt runtime 25.075s, model runtime 612.430s, pg runtime 612.430s, speedup 1.000x
29, opt runtime 24.840s, model runtime 626.529s, pg runtime 626.529s, speedup 1.000x
30, opt runtime 24.920s, model runtime 610.993s, pg runtime 610.993s, speedup 1.000x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 16, train speedup 2.022, test speedup 0.933, val speedup 0.502
best test speedup epoch: 2, train speedup 2.021, test speedup 1.771, val speedup 1.000
best validation speedup epoch: 29, train speedup 1.975, test speedup 1.478, val speedup 1.000
last model at epoch 39, train speedup 1.997, test speedup 1.478, val speedup 0.502
execution cost 0:11:39.163018
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.127929, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.343830| train set 1.762x speedup, test set 1.008x speedup, val set 0.477x speedup, step: 1, train time 5.68 s
Epoch 1/50 |loss: 0.231923| train set 1.579x speedup, test set 1.033x speedup, val set 0.296x speedup, step: 2, train time 4.02 s
Epoch 2/50 |loss: 0.204464| train set 1.635x speedup, test set 0.971x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 3/50 |loss: 0.192769| train set 1.517x speedup, test set 1.567x speedup, val set 0.437x speedup, step: 4, train time 3.99 s
Epoch 4/50 |loss: 0.177165| train set 1.810x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 1, train time 3.90 s
Epoch 5/50 |loss: 0.169368| train set 1.734x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 2, train time 3.90 s
Epoch 6/50 |loss: 0.168279| train set 1.734x speedup, test set 4.872x speedup, val set 0.437x speedup, step: 3, train time 3.92 s
Epoch 7/50 |loss: 0.164596| train set 1.681x speedup, test set 5.541x speedup, val set 0.437x speedup, step: 4, train time 4.02 s
Epoch 8/50 |loss: 0.157642| train set 1.776x speedup, test set 6.559x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 9/50 |loss: 0.153081| train set 1.663x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 10/50 |loss: 0.155410| train set 1.791x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 2, train time 4.12 s
Epoch 11/50 |loss: 0.153747| train set 1.679x speedup, test set 6.122x speedup, val set 0.437x speedup, step: 3, train time 3.81 s
Epoch 12/50 |loss: 0.152858| train set 1.776x speedup, test set 5.304x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 13/50 |loss: 0.149839| train set 1.791x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 5, train time 3.93 s
Epoch 14/50 |loss: 0.149873| train set 1.810x speedup, test set 1.590x speedup, val set 0.437x speedup, step: 1, train time 3.90 s
Epoch 15/50 |loss: 0.148491| train set 1.757x speedup, test set 4.675x speedup, val set 0.437x speedup, step: 2, train time 3.82 s
Epoch 16/50 |loss: 0.147169| train set 1.776x speedup, test set 5.550x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 17/50 |loss: 0.146975| train set 1.810x speedup, test set 1.556x speedup, val set 0.437x speedup, step: 4, train time 3.97 s
Epoch 18/50 |loss: 0.144671| train set 1.696x speedup, test set 5.550x speedup, val set 0.437x speedup, step: 5, train time 3.90 s
Epoch 19/50 |loss: 0.146981| train set 1.791x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
Epoch 20/50 |loss: 0.144377| train set 1.810x speedup, test set 5.161x speedup, val set 0.437x speedup, step: 2, train time 3.89 s
Epoch 21/50 |loss: 0.145620| train set 1.775x speedup, test set 6.326x speedup, val set 0.437x speedup, step: 3, train time 3.84 s
Epoch 22/50 |loss: 0.144359| train set 1.775x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 4, train time 3.83 s
Epoch 23/50 |loss: 0.144740| train set 1.775x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 5, train time 3.98 s
Epoch 24/50 |loss: 0.145237| train set 1.810x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 1, train time 3.88 s
Epoch 25/50 |loss: 0.142795| train set 1.810x speedup, test set 1.701x speedup, val set 0.437x speedup, step: 2, train time 3.81 s
Epoch 26/50 |loss: 0.143986| train set 1.810x speedup, test set 5.651x speedup, val set 0.437x speedup, step: 3, train time 3.93 s
Epoch 27/50 |loss: 0.140887| train set 1.757x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 4, train time 4.02 s
Epoch 28/50 |loss: 0.139593| train set 1.810x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 5, train time 4.31 s
Epoch 29/50 |loss: 0.142216| train set 1.810x speedup, test set 6.122x speedup, val set 0.437x speedup, step: 1, train time 4.38 s
Epoch 30/50 |loss: 0.140949| train set 1.790x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 2, train time 4.02 s
Epoch 31/50 |loss: 0.140642| train set 1.776x speedup, test set 5.738x speedup, val set 0.437x speedup, step: 3, train time 3.74 s
Epoch 32/50 |loss: 0.139681| train set 1.810x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 4, train time 3.82 s
Epoch 33/50 |loss: 0.138863| train set 1.775x speedup, test set 5.873x speedup, val set 0.437x speedup, step: 5, train time 3.99 s
Epoch 34/50 |loss: 0.140628| train set 1.757x speedup, test set 6.435x speedup, val set 0.437x speedup, step: 1, train time 3.79 s
Epoch 35/50 |loss: 0.139575| train set 1.810x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 2, train time 3.72 s
Epoch 36/50 |loss: 0.140456| train set 1.810x speedup, test set 6.787x speedup, val set 0.437x speedup, step: 3, train time 3.71 s
Epoch 37/50 |loss: 0.137952| train set 1.810x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 4, train time 3.71 s
Epoch 38/50 |loss: 0.138241| train set 1.810x speedup, test set 6.720x speedup, val set 0.437x speedup, step: 5, train time 3.90 s
Epoch 39/50 |loss: 0.136677| train set 1.810x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 1, train time 3.89 s
Epoch 40/50 |loss: 0.138571| train set 1.776x speedup, test set 6.435x speedup, val set 0.437x speedup, step: 2, train time 3.79 s
Epoch 41/50 |loss: 0.138227| train set 1.765x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 42/50 |loss: 0.139568| train set 1.810x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 4, train time 4.00 s
Epoch 43/50 |loss: 0.139718| train set 1.776x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 44/50 |loss: 0.140421| train set 1.810x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 1, train time 3.93 s
early stopping at epoch 44
Training per epoch cost 3.969 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 33.598s, pg runtime 601.866s, speedup 17.914x
22, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
23, opt runtime 24.662s, model runtime 32.192s, pg runtime 613.999s, speedup 19.073x
24, opt runtime 24.459s, model runtime 32.532s, pg runtime 608.717s, speedup 18.711x
25, opt runtime 25.236s, model runtime 33.141s, pg runtime 601.756s, speedup 18.157x
26, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
27, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
28, opt runtime 25.075s, model runtime 32.865s, pg runtime 612.430s, speedup 18.635x
29, opt runtime 24.840s, model runtime 32.681s, pg runtime 626.529s, speedup 19.171x
30, opt runtime 24.920s, model runtime 32.473s, pg runtime 610.993s, speedup 18.816x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 28, train speedup 1.810, test speedup 6.921, val speedup 0.437
best test speedup epoch: 22, train speedup 1.775, test speedup 6.921, val speedup 0.437
best validation speedup epoch: 44, train speedup 1.810, test speedup 6.921, val speedup 0.437
last model at epoch 44, train speedup 1.810, test speedup 6.921, val speedup 0.437
execution cost 0:03:26.518539
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.167968, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.021x speedup, val set 0.477x speedup, step: 1, train time 5.28 s
Epoch 1/50 |loss: 0.229276| train set 1.655x speedup, test set 1.046x speedup, val set 0.477x speedup, step: 2, train time 3.99 s
Epoch 2/50 |loss: 0.202426| train set 1.790x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 3, train time 3.82 s
Epoch 3/50 |loss: 0.193098| train set 1.810x speedup, test set 0.968x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 4/50 |loss: 0.177892| train set 1.809x speedup, test set 1.567x speedup, val set 0.437x speedup, step: 1, train time 3.92 s
Epoch 5/50 |loss: 0.170452| train set 1.776x speedup, test set 1.004x speedup, val set 0.437x speedup, step: 2, train time 4.06 s
Epoch 6/50 |loss: 0.165782| train set 1.733x speedup, test set 0.999x speedup, val set 0.437x speedup, step: 3, train time 4.22 s
Epoch 7/50 |loss: 0.163869| train set 1.810x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 8/50 |loss: 0.156765| train set 1.790x speedup, test set 1.768x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 9/50 |loss: 0.153904| train set 1.662x speedup, test set 4.817x speedup, val set 0.437x speedup, step: 1, train time 3.83 s
Epoch 10/50 |loss: 0.156676| train set 1.790x speedup, test set 1.577x speedup, val set 0.437x speedup, step: 2, train time 3.98 s
Epoch 11/50 |loss: 0.154344| train set 1.790x speedup, test set 1.780x speedup, val set 0.296x speedup, step: 3, train time 3.90 s
Epoch 12/50 |loss: 0.154260| train set 1.776x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 4, train time 3.92 s
Epoch 13/50 |loss: 0.150701| train set 1.810x speedup, test set 4.817x speedup, val set 0.437x speedup, step: 5, train time 3.91 s
Epoch 14/50 |loss: 0.148012| train set 1.810x speedup, test set 1.034x speedup, val set 0.437x speedup, step: 1, train time 3.93 s
Epoch 15/50 |loss: 0.148290| train set 1.776x speedup, test set 1.873x speedup, val set 0.437x speedup, step: 2, train time 3.90 s
Epoch 16/50 |loss: 0.146421| train set 1.810x speedup, test set 1.797x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 17/50 |loss: 0.147265| train set 1.810x speedup, test set 1.008x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 18/50 |loss: 0.144497| train set 1.696x speedup, test set 5.569x speedup, val set 0.437x speedup, step: 5, train time 3.98 s
Epoch 19/50 |loss: 0.147365| train set 1.790x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 1, train time 3.92 s
Epoch 20/50 |loss: 0.144476| train set 1.810x speedup, test set 5.559x speedup, val set 0.437x speedup, step: 2, train time 3.92 s
Epoch 21/50 |loss: 0.145622| train set 1.775x speedup, test set 1.799x speedup, val set 0.437x speedup, step: 3, train time 3.93 s
Epoch 22/50 |loss: 0.143800| train set 1.775x speedup, test set 1.891x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 23/50 |loss: 0.145971| train set 1.809x speedup, test set 1.754x speedup, val set 0.437x speedup, step: 5, train time 3.89 s
Epoch 24/50 |loss: 0.145224| train set 1.810x speedup, test set 1.799x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 25/50 |loss: 0.144168| train set 1.810x speedup, test set 1.799x speedup, val set 0.437x speedup, step: 2, train time 3.90 s
Epoch 26/50 |loss: 0.144144| train set 1.810x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 27/50 |loss: 0.142166| train set 1.757x speedup, test set 1.891x speedup, val set 0.437x speedup, step: 4, train time 4.03 s
Epoch 28/50 |loss: 0.140549| train set 1.810x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 5, train time 3.92 s
Epoch 29/50 |loss: 0.143003| train set 1.810x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 1, train time 3.91 s
Epoch 30/50 |loss: 0.141261| train set 1.790x speedup, test set 1.872x speedup, val set 0.437x speedup, step: 2, train time 3.81 s
Epoch 31/50 |loss: 0.141373| train set 1.775x speedup, test set 1.717x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 32/50 |loss: 0.139615| train set 1.810x speedup, test set 1.774x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 33/50 |loss: 0.139975| train set 1.775x speedup, test set 3.919x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 34/50 |loss: 0.141257| train set 1.810x speedup, test set 1.874x speedup, val set 0.437x speedup, step: 1, train time 3.98 s
Epoch 35/50 |loss: 0.140638| train set 1.810x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 2, train time 3.90 s
Epoch 36/50 |loss: 0.141913| train set 1.810x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 37/50 |loss: 0.139938| train set 1.810x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 4, train time 4.00 s
Epoch 38/50 |loss: 0.139284| train set 1.810x speedup, test set 1.782x speedup, val set 0.437x speedup, step: 5, train time 3.83 s
Epoch 39/50 |loss: 0.137672| train set 1.790x speedup, test set 1.963x speedup, val set 0.437x speedup, step: 1, train time 3.88 s
Epoch 40/50 |loss: 0.138758| train set 1.776x speedup, test set 1.809x speedup, val set 0.437x speedup, step: 2, train time 4.16 s
Epoch 41/50 |loss: 0.138552| train set 1.765x speedup, test set 1.872x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 42/50 |loss: 0.140591| train set 1.810x speedup, test set 1.961x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 43/50 |loss: 0.139888| train set 1.776x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 5, train time 3.91 s
Epoch 44/50 |loss: 0.140636| train set 1.776x speedup, test set 1.799x speedup, val set 0.437x speedup, step: 1, train time 4.02 s
Epoch 45/50 |loss: 0.140535| train set 1.790x speedup, test set 1.874x speedup, val set 0.437x speedup, step: 2, train time 3.81 s
Epoch 46/50 |loss: 0.139817| train set 1.791x speedup, test set 1.874x speedup, val set 0.437x speedup, step: 3, train time 3.91 s
Epoch 47/50 |loss: 0.137414| train set 1.810x speedup, test set 1.961x speedup, val set 0.437x speedup, step: 4, train time 4.00 s
Epoch 48/50 |loss: 0.135355| train set 1.810x speedup, test set 1.870x speedup, val set 0.437x speedup, step: 5, train time 3.92 s
Epoch 49/50 |loss: 0.137109| train set 1.810x speedup, test set 1.861x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Training per epoch cost 3.980 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 56.876s, pg runtime 91.784s, speedup 1.614x
02, opt runtime 29.763s, model runtime 55.506s, pg runtime 91.648s, speedup 1.651x
03, opt runtime 30.267s, model runtime 57.401s, pg runtime 100.885s, speedup 1.758x
04, opt runtime 29.286s, model runtime 58.701s, pg runtime 92.131s, speedup 1.569x
05, opt runtime 29.269s, model runtime 57.330s, pg runtime 91.296s, speedup 1.592x
06, opt runtime 29.502s, model runtime 60.311s, pg runtime 112.305s, speedup 1.862x
07, opt runtime 27.886s, model runtime 58.497s, pg runtime 97.629s, speedup 1.669x
08, opt runtime 30.705s, model runtime 56.560s, pg runtime 89.698s, speedup 1.586x
09, opt runtime 27.651s, model runtime 58.506s, pg runtime 91.255s, speedup 1.560x
10, opt runtime 33.637s, model runtime 57.182s, pg runtime 90.618s, speedup 1.585x
11, opt runtime 53.298s, model runtime 91.571s, pg runtime 148.707s, speedup 1.624x
12, opt runtime 48.784s, model runtime 85.611s, pg runtime 78.349s, speedup 0.915x
13, opt runtime 53.440s, model runtime 86.638s, pg runtime 140.742s, speedup 1.624x
14, opt runtime 47.812s, model runtime 88.819s, pg runtime 83.069s, speedup 0.935x
15, opt runtime 47.518s, model runtime 83.137s, pg runtime 75.736s, speedup 0.911x
16, opt runtime 48.067s, model runtime 87.942s, pg runtime 81.014s, speedup 0.921x
17, opt runtime 47.738s, model runtime 83.106s, pg runtime 76.021s, speedup 0.915x
18, opt runtime 47.804s, model runtime 87.416s, pg runtime 81.177s, speedup 0.929x
19, opt runtime 49.511s, model runtime 92.597s, pg runtime 87.329s, speedup 0.943x
20, opt runtime 51.276s, model runtime 84.921s, pg runtime 79.222s, speedup 0.933x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 432.766s, pg runtime 432.766s, speedup 1.000x
32, opt runtime 15.120s, model runtime 566.078s, pg runtime 566.078s, speedup 1.000x
33, opt runtime 16.639s, model runtime 462.544s, pg runtime 462.544s, speedup 1.000x
34, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
35, opt runtime 16.528s, model runtime 620.762s, pg runtime 620.762s, speedup 1.000x
36, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
37, opt runtime 16.438s, model runtime 546.887s, pg runtime 546.887s, speedup 1.000x
38, opt runtime 16.138s, model runtime 501.793s, pg runtime 501.793s, speedup 1.000x
39, opt runtime 16.770s, model runtime 594.754s, pg runtime 594.754s, speedup 1.000x
40, opt runtime 16.305s, model runtime 436.168s, pg runtime 436.168s, speedup 1.000x
====================
best train speedup epoch: 42, train speedup 1.810, test speedup 1.961, val speedup 0.437
best test speedup epoch: 28, train speedup 1.810, test speedup 6.949, val speedup 0.437
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.861, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.861, val speedup 0.437
execution cost 0:03:48.497992
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.035641, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345320| train set 1.762x speedup, test set 1.000x speedup, val set 0.296x speedup, step: 1, train time 5.20 s
Epoch 1/50 |loss: 0.231497| train set 1.663x speedup, test set 1.006x speedup, val set 0.477x speedup, step: 2, train time 4.01 s
Epoch 2/50 |loss: 0.203660| train set 1.790x speedup, test set 0.968x speedup, val set 0.477x speedup, step: 3, train time 3.91 s
Epoch 3/50 |loss: 0.193627| train set 1.776x speedup, test set 1.211x speedup, val set 0.437x speedup, step: 4, train time 3.98 s
Epoch 4/50 |loss: 0.177916| train set 1.679x speedup, test set 2.172x speedup, val set 1.000x speedup, step: 1, train time 4.01 s
Epoch 5/50 |loss: 0.170423| train set 1.776x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 2, train time 3.98 s
Epoch 6/50 |loss: 0.167466| train set 1.734x speedup, test set 3.709x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 7/50 |loss: 0.165333| train set 1.810x speedup, test set 5.709x speedup, val set 0.437x speedup, step: 4, train time 4.30 s
Epoch 8/50 |loss: 0.158032| train set 1.776x speedup, test set 1.962x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 9/50 |loss: 0.154175| train set 1.790x speedup, test set 1.657x speedup, val set 0.437x speedup, step: 6, train time 3.91 s
Epoch 10/50 |loss: 0.157429| train set 1.791x speedup, test set 1.657x speedup, val set 0.437x speedup, step: 7, train time 3.92 s
Epoch 11/50 |loss: 0.153929| train set 1.679x speedup, test set 2.172x speedup, val set 0.437x speedup, step: 8, train time 3.92 s
Epoch 12/50 |loss: 0.155064| train set 1.776x speedup, test set 1.657x speedup, val set 0.437x speedup, step: 9, train time 4.03 s
Epoch 13/50 |loss: 0.150377| train set 1.810x speedup, test set 1.768x speedup, val set 0.437x speedup, step: 10, train time 3.91 s
Epoch 14/50 |loss: 0.150082| train set 1.810x speedup, test set 1.004x speedup, val set 0.437x speedup, step: 11, train time 3.90 s
Epoch 15/50 |loss: 0.148778| train set 1.776x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 12, train time 4.02 s
Epoch 16/50 |loss: 0.146688| train set 1.776x speedup, test set 5.550x speedup, val set 0.437x speedup, step: 13, train time 3.90 s
Epoch 17/50 |loss: 0.146823| train set 1.810x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 14, train time 3.83 s
Epoch 18/50 |loss: 0.144767| train set 1.696x speedup, test set 1.657x speedup, val set 0.437x speedup, step: 15, train time 4.13 s
Epoch 19/50 |loss: 0.146260| train set 1.789x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 16, train time 3.90 s
Epoch 20/50 |loss: 0.145856| train set 1.776x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 17, train time 3.92 s
Epoch 21/50 |loss: 0.145941| train set 1.775x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 18, train time 3.88 s
Epoch 22/50 |loss: 0.143744| train set 1.776x speedup, test set 2.472x speedup, val set 0.437x speedup, step: 19, train time 3.80 s
Epoch 23/50 |loss: 0.144864| train set 1.809x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 20, train time 4.00 s
Epoch 24/50 |loss: 0.146908| train set 1.810x speedup, test set 0.995x speedup, val set 0.437x speedup, step: 21, train time 3.84 s
Epoch 25/50 |loss: 0.143940| train set 1.809x speedup, test set 0.995x speedup, val set 0.437x speedup, step: 22, train time 3.90 s
Epoch 26/50 |loss: 0.143926| train set 1.810x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 23, train time 4.03 s
Epoch 27/50 |loss: 0.142196| train set 1.776x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 24, train time 4.01 s
Epoch 28/50 |loss: 0.140348| train set 1.810x speedup, test set 6.921x speedup, val set 1.000x speedup, step: 25, train time 4.00 s
Epoch 29/50 |loss: 0.142954| train set 1.810x speedup, test set 2.313x speedup, val set 0.437x speedup, step: 26, train time 3.93 s
Epoch 30/50 |loss: 0.141415| train set 1.790x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 27, train time 3.99 s
Epoch 31/50 |loss: 0.140669| train set 1.809x speedup, test set 1.810x speedup, val set 0.437x speedup, step: 28, train time 3.96 s
Epoch 32/50 |loss: 0.139157| train set 1.810x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 29, train time 3.91 s
Epoch 33/50 |loss: 0.139469| train set 1.775x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 30, train time 4.02 s
Epoch 34/50 |loss: 0.140964| train set 1.776x speedup, test set 1.823x speedup, val set 0.437x speedup, step: 31, train time 4.21 s
Epoch 35/50 |loss: 0.141761| train set 1.810x speedup, test set 1.860x speedup, val set 0.868x speedup, step: 32, train time 4.22 s
Epoch 36/50 |loss: 0.141671| train set 1.810x speedup, test set 1.768x speedup, val set 0.437x speedup, step: 33, train time 3.91 s
Epoch 37/50 |loss: 0.137889| train set 1.810x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 34, train time 3.81 s
Epoch 38/50 |loss: 0.138620| train set 1.790x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 35, train time 3.80 s
Epoch 39/50 |loss: 0.137927| train set 1.790x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 36, train time 3.83 s
Epoch 40/50 |loss: 0.138530| train set 1.776x speedup, test set 1.716x speedup, val set 0.437x speedup, step: 37, train time 3.81 s
Epoch 41/50 |loss: 0.139298| train set 1.810x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 38, train time 3.74 s
Epoch 42/50 |loss: 0.139486| train set 1.810x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 39, train time 3.80 s
Epoch 43/50 |loss: 0.139064| train set 1.776x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 40, train time 3.73 s
Epoch 44/50 |loss: 0.139862| train set 1.810x speedup, test set 1.739x speedup, val set 0.437x speedup, step: 41, train time 3.79 s
Epoch 45/50 |loss: 0.137663| train set 1.810x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 42, train time 4.23 s
Epoch 46/50 |loss: 0.139263| train set 1.790x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 43, train time 4.00 s
Epoch 47/50 |loss: 0.137811| train set 1.810x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 44, train time 3.98 s
Epoch 48/50 |loss: 0.135287| train set 1.776x speedup, test set 1.738x speedup, val set 0.437x speedup, step: 45, train time 4.08 s
Epoch 49/50 |loss: 0.137456| train set 1.810x speedup, test set 1.657x speedup, val set 0.437x speedup, step: 46, train time 4.08 s
Training per epoch cost 3.981 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 91.571s, pg runtime 148.707s, speedup 1.624x
12, opt runtime 48.784s, model runtime 85.611s, pg runtime 78.349s, speedup 0.915x
13, opt runtime 53.440s, model runtime 86.638s, pg runtime 140.742s, speedup 1.624x
14, opt runtime 47.812s, model runtime 88.819s, pg runtime 83.069s, speedup 0.935x
15, opt runtime 47.518s, model runtime 83.137s, pg runtime 75.736s, speedup 0.911x
16, opt runtime 48.067s, model runtime 87.942s, pg runtime 81.014s, speedup 0.921x
17, opt runtime 47.738s, model runtime 83.106s, pg runtime 76.021s, speedup 0.915x
18, opt runtime 47.804s, model runtime 87.416s, pg runtime 81.177s, speedup 0.929x
19, opt runtime 49.511s, model runtime 92.597s, pg runtime 87.329s, speedup 0.943x
20, opt runtime 51.276s, model runtime 84.921s, pg runtime 79.222s, speedup 0.933x
21, opt runtime 24.391s, model runtime 33.598s, pg runtime 601.866s, speedup 17.914x
22, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
23, opt runtime 24.662s, model runtime 32.192s, pg runtime 613.999s, speedup 19.073x
24, opt runtime 24.459s, model runtime 32.532s, pg runtime 608.717s, speedup 18.711x
25, opt runtime 25.236s, model runtime 33.141s, pg runtime 601.756s, speedup 18.157x
26, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
27, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
28, opt runtime 25.075s, model runtime 32.865s, pg runtime 612.430s, speedup 18.635x
29, opt runtime 24.840s, model runtime 32.681s, pg runtime 626.529s, speedup 19.171x
30, opt runtime 24.920s, model runtime 32.473s, pg runtime 610.993s, speedup 18.816x
31, opt runtime 16.268s, model runtime 365.512s, pg runtime 432.766s, speedup 1.184x
32, opt runtime 15.120s, model runtime 429.377s, pg runtime 566.078s, speedup 1.318x
33, opt runtime 16.639s, model runtime 378.987s, pg runtime 462.544s, speedup 1.220x
34, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
35, opt runtime 16.528s, model runtime 437.980s, pg runtime 620.762s, speedup 1.417x
36, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
37, opt runtime 16.438s, model runtime 387.494s, pg runtime 546.887s, speedup 1.411x
38, opt runtime 16.138s, model runtime 385.465s, pg runtime 501.793s, speedup 1.302x
39, opt runtime 16.770s, model runtime 393.974s, pg runtime 594.754s, speedup 1.510x
40, opt runtime 16.305s, model runtime 401.313s, pg runtime 436.168s, speedup 1.087x
====================
best train speedup epoch: 35, train speedup 1.810, test speedup 1.860, val speedup 0.868
best test speedup epoch: 28, train speedup 1.810, test speedup 6.921, val speedup 1.000
best validation speedup epoch: 4, train speedup 1.679, test speedup 2.172, val speedup 1.000
last model at epoch 49, train speedup 1.810, test speedup 1.657, val speedup 0.437
execution cost 0:03:48.491219
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.099116, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.021x speedup, val set 0.477x speedup, step: 1, train time 5.32 s
Epoch 1/50 |loss: 0.229276| train set 1.655x speedup, test set 1.046x speedup, val set 0.477x speedup, step: 2, train time 3.92 s
Epoch 2/50 |loss: 0.202657| train set 1.791x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 3, train time 3.81 s
Epoch 3/50 |loss: 0.191252| train set 1.776x speedup, test set 0.971x speedup, val set 0.437x speedup, step: 4, train time 3.83 s
Epoch 4/50 |loss: 0.176031| train set 1.775x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 1, train time 3.81 s
Epoch 5/50 |loss: 0.170597| train set 1.775x speedup, test set 1.668x speedup, val set 0.437x speedup, step: 2, train time 3.89 s
Epoch 6/50 |loss: 0.166373| train set 1.775x speedup, test set 1.631x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 7/50 |loss: 0.165849| train set 1.711x speedup, test set 5.550x speedup, val set 0.437x speedup, step: 4, train time 3.81 s
Epoch 8/50 |loss: 0.157571| train set 1.790x speedup, test set 5.681x speedup, val set 0.437x speedup, step: 5, train time 3.81 s
Epoch 9/50 |loss: 0.154631| train set 1.790x speedup, test set 1.861x speedup, val set 0.437x speedup, step: 1, train time 3.89 s
Epoch 10/50 |loss: 0.156815| train set 1.791x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 2, train time 3.80 s
Epoch 11/50 |loss: 0.154050| train set 1.790x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 3, train time 3.82 s
Epoch 12/50 |loss: 0.154352| train set 1.776x speedup, test set 1.754x speedup, val set 0.437x speedup, step: 4, train time 3.81 s
Epoch 13/50 |loss: 0.150482| train set 1.790x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 5, train time 3.91 s
Epoch 14/50 |loss: 0.149484| train set 1.810x speedup, test set 1.771x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 15/50 |loss: 0.148507| train set 1.776x speedup, test set 1.768x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 16/50 |loss: 0.146970| train set 1.776x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 3, train time 3.81 s
Epoch 17/50 |loss: 0.147551| train set 1.810x speedup, test set 1.754x speedup, val set 0.437x speedup, step: 4, train time 3.81 s
Epoch 18/50 |loss: 0.144598| train set 1.696x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 5, train time 3.91 s
Epoch 19/50 |loss: 0.147165| train set 1.790x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 1, train time 3.80 s
Epoch 20/50 |loss: 0.144904| train set 1.810x speedup, test set 6.559x speedup, val set 0.437x speedup, step: 2, train time 3.80 s
Epoch 21/50 |loss: 0.144710| train set 1.775x speedup, test set 1.963x speedup, val set 0.437x speedup, step: 3, train time 3.82 s
Epoch 22/50 |loss: 0.143818| train set 1.775x speedup, test set 1.961x speedup, val set 0.437x speedup, step: 4, train time 3.82 s
Epoch 23/50 |loss: 0.144282| train set 1.810x speedup, test set 6.349x speedup, val set 0.437x speedup, step: 5, train time 3.89 s
Epoch 24/50 |loss: 0.145863| train set 1.810x speedup, test set 1.799x speedup, val set 0.437x speedup, step: 1, train time 3.79 s
Epoch 25/50 |loss: 0.144396| train set 1.809x speedup, test set 1.574x speedup, val set 0.437x speedup, step: 2, train time 3.99 s
Epoch 26/50 |loss: 0.144296| train set 1.810x speedup, test set 1.797x speedup, val set 0.437x speedup, step: 3, train time 3.79 s
Epoch 27/50 |loss: 0.142199| train set 1.758x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 4, train time 3.74 s
Epoch 28/50 |loss: 0.140135| train set 1.810x speedup, test set 8.563x speedup, val set 0.437x speedup, step: 5, train time 3.90 s
Epoch 29/50 |loss: 0.143355| train set 1.810x speedup, test set 1.961x speedup, val set 0.437x speedup, step: 1, train time 3.83 s
Epoch 30/50 |loss: 0.140498| train set 1.790x speedup, test set 1.872x speedup, val set 0.437x speedup, step: 2, train time 3.73 s
Epoch 31/50 |loss: 0.140001| train set 1.809x speedup, test set 1.708x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 32/50 |loss: 0.139667| train set 1.810x speedup, test set 5.807x speedup, val set 0.437x speedup, step: 4, train time 3.73 s
Epoch 33/50 |loss: 0.139208| train set 1.775x speedup, test set 1.595x speedup, val set 0.437x speedup, step: 5, train time 3.74 s
Epoch 34/50 |loss: 0.141291| train set 1.810x speedup, test set 1.941x speedup, val set 0.437x speedup, step: 1, train time 3.80 s
Epoch 35/50 |loss: 0.140230| train set 1.810x speedup, test set 1.950x speedup, val set 0.437x speedup, step: 2, train time 3.91 s
Epoch 36/50 |loss: 0.141854| train set 1.810x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 3, train time 3.83 s
Epoch 37/50 |loss: 0.139570| train set 1.810x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 4, train time 3.81 s
Epoch 38/50 |loss: 0.138785| train set 1.810x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 5, train time 3.81 s
Epoch 39/50 |loss: 0.137785| train set 1.810x speedup, test set 1.961x speedup, val set 0.437x speedup, step: 1, train time 3.83 s
Epoch 40/50 |loss: 0.139549| train set 1.776x speedup, test set 1.933x speedup, val set 0.437x speedup, step: 2, train time 3.89 s
Epoch 41/50 |loss: 0.137749| train set 1.765x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 3, train time 3.83 s
Epoch 42/50 |loss: 0.140005| train set 1.810x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 4, train time 3.89 s
Epoch 43/50 |loss: 0.139612| train set 1.776x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 5, train time 3.83 s
Epoch 44/50 |loss: 0.139658| train set 1.810x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 1, train time 3.80 s
Epoch 45/50 |loss: 0.138071| train set 1.809x speedup, test set 1.872x speedup, val set 0.437x speedup, step: 2, train time 3.79 s
Epoch 46/50 |loss: 0.138691| train set 1.790x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 3, train time 3.73 s
Epoch 47/50 |loss: 0.137011| train set 1.810x speedup, test set 1.797x speedup, val set 0.437x speedup, step: 4, train time 3.81 s
Epoch 48/50 |loss: 0.136492| train set 1.810x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 5, train time 3.80 s
Epoch 49/50 |loss: 0.136804| train set 1.810x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 1, train time 3.74 s
Training per epoch cost 3.868 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 91.571s, pg runtime 148.707s, speedup 1.624x
12, opt runtime 48.784s, model runtime 78.349s, pg runtime 78.349s, speedup 1.000x
13, opt runtime 53.440s, model runtime 86.638s, pg runtime 140.742s, speedup 1.624x
14, opt runtime 47.812s, model runtime 83.069s, pg runtime 83.069s, speedup 1.000x
15, opt runtime 47.518s, model runtime 75.736s, pg runtime 75.736s, speedup 1.000x
16, opt runtime 48.067s, model runtime 81.014s, pg runtime 81.014s, speedup 1.000x
17, opt runtime 47.738s, model runtime 76.021s, pg runtime 76.021s, speedup 1.000x
18, opt runtime 47.804s, model runtime 81.177s, pg runtime 81.177s, speedup 1.000x
19, opt runtime 49.511s, model runtime 87.329s, pg runtime 87.329s, speedup 1.000x
20, opt runtime 51.276s, model runtime 79.222s, pg runtime 79.222s, speedup 1.000x
21, opt runtime 24.391s, model runtime 33.598s, pg runtime 601.866s, speedup 17.914x
22, opt runtime 24.079s, model runtime 32.888s, pg runtime 608.707s, speedup 18.509x
23, opt runtime 24.662s, model runtime 32.192s, pg runtime 613.999s, speedup 19.073x
24, opt runtime 24.459s, model runtime 32.532s, pg runtime 608.717s, speedup 18.711x
25, opt runtime 25.236s, model runtime 33.141s, pg runtime 601.756s, speedup 18.157x
26, opt runtime 25.363s, model runtime 35.021s, pg runtime 611.327s, speedup 17.456x
27, opt runtime 24.706s, model runtime 32.983s, pg runtime 610.808s, speedup 18.519x
28, opt runtime 25.075s, model runtime 32.865s, pg runtime 612.430s, speedup 18.635x
29, opt runtime 24.840s, model runtime 32.681s, pg runtime 626.529s, speedup 19.171x
30, opt runtime 24.920s, model runtime 32.473s, pg runtime 610.993s, speedup 18.816x
31, opt runtime 16.268s, model runtime 432.766s, pg runtime 432.766s, speedup 1.000x
32, opt runtime 15.120s, model runtime 566.078s, pg runtime 566.078s, speedup 1.000x
33, opt runtime 16.639s, model runtime 462.544s, pg runtime 462.544s, speedup 1.000x
34, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
35, opt runtime 16.528s, model runtime 620.762s, pg runtime 620.762s, speedup 1.000x
36, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
37, opt runtime 16.438s, model runtime 546.887s, pg runtime 546.887s, speedup 1.000x
38, opt runtime 16.138s, model runtime 501.793s, pg runtime 501.793s, speedup 1.000x
39, opt runtime 16.770s, model runtime 594.754s, pg runtime 594.754s, speedup 1.000x
40, opt runtime 16.305s, model runtime 436.168s, pg runtime 436.168s, speedup 1.000x
====================
best train speedup epoch: 28, train speedup 1.810, test speedup 8.563, val speedup 0.437
best test speedup epoch: 28, train speedup 1.810, test speedup 8.563, val speedup 0.437
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.780, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.780, val speedup 0.437
execution cost 0:03:41.828682
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.120900, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.021x speedup, val set 0.477x speedup, step: 1, train time 4.91 s
Epoch 1/50 |loss: 0.229785| train set 1.428x speedup, test set 1.050x speedup, val set 0.477x speedup, step: 2, train time 3.80 s
Epoch 2/50 |loss: 0.201581| train set 1.776x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 3, train time 4.01 s
Epoch 3/50 |loss: 0.193249| train set 1.517x speedup, test set 1.567x speedup, val set 0.296x speedup, step: 4, train time 4.00 s
Epoch 4/50 |loss: 0.177515| train set 1.809x speedup, test set 4.703x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 5/50 |loss: 0.170503| train set 1.681x speedup, test set 1.556x speedup, val set 0.437x speedup, step: 2, train time 3.92 s
Epoch 6/50 |loss: 0.167231| train set 1.775x speedup, test set 4.134x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 7/50 |loss: 0.165611| train set 1.711x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 8/50 |loss: 0.157593| train set 1.757x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 5, train time 3.98 s
Epoch 9/50 |loss: 0.153088| train set 1.679x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 10/50 |loss: 0.156774| train set 1.790x speedup, test set 1.782x speedup, val set 0.437x speedup, step: 2, train time 3.91 s
Epoch 11/50 |loss: 0.154456| train set 1.679x speedup, test set 1.797x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 12/50 |loss: 0.154910| train set 1.733x speedup, test set 1.754x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 13/50 |loss: 0.151497| train set 1.790x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 5, train time 3.99 s
Epoch 14/50 |loss: 0.149842| train set 1.790x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 1, train time 4.08 s
Epoch 15/50 |loss: 0.148648| train set 1.757x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 2, train time 3.82 s
Epoch 16/50 |loss: 0.147177| train set 1.776x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 3, train time 3.99 s
Epoch 17/50 |loss: 0.147518| train set 1.810x speedup, test set 1.000x speedup, val set 0.437x speedup, step: 4, train time 4.07 s
Epoch 18/50 |loss: 0.144893| train set 1.810x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 19/50 |loss: 0.147378| train set 1.792x speedup, test set 1.754x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
Epoch 20/50 |loss: 0.146511| train set 1.810x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 2, train time 4.01 s
Epoch 21/50 |loss: 0.146323| train set 1.775x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 3, train time 4.02 s
Epoch 22/50 |loss: 0.144519| train set 1.776x speedup, test set 1.963x speedup, val set 0.437x speedup, step: 4, train time 3.93 s
Epoch 23/50 |loss: 0.145295| train set 1.809x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 5, train time 3.92 s
Epoch 24/50 |loss: 0.145874| train set 1.810x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 25/50 |loss: 0.143182| train set 1.711x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 26/50 |loss: 0.145193| train set 1.810x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 27/50 |loss: 0.142907| train set 1.776x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 4, train time 4.08 s
Epoch 28/50 |loss: 0.140310| train set 1.810x speedup, test set 6.622x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 29/50 |loss: 0.144044| train set 1.810x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 30/50 |loss: 0.141348| train set 1.790x speedup, test set 1.782x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 31/50 |loss: 0.141662| train set 1.775x speedup, test set 1.632x speedup, val set 0.437x speedup, step: 3, train time 4.02 s
Epoch 32/50 |loss: 0.140220| train set 1.810x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 33/50 |loss: 0.140326| train set 1.775x speedup, test set 1.764x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 34/50 |loss: 0.141014| train set 1.810x speedup, test set 1.893x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 35/50 |loss: 0.140318| train set 1.810x speedup, test set 1.846x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 36/50 |loss: 0.140908| train set 1.810x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 37/50 |loss: 0.139818| train set 1.810x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 4, train time 3.98 s
Epoch 38/50 |loss: 0.139785| train set 1.790x speedup, test set 1.799x speedup, val set 0.437x speedup, step: 5, train time 4.00 s
Epoch 39/50 |loss: 0.138730| train set 1.790x speedup, test set 1.799x speedup, val set 0.437x speedup, step: 1, train time 4.09 s
Epoch 40/50 |loss: 0.140058| train set 1.776x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 41/50 |loss: 0.138996| train set 1.765x speedup, test set 6.144x speedup, val set 0.437x speedup, step: 3, train time 3.92 s
Epoch 42/50 |loss: 0.140866| train set 1.810x speedup, test set 7.670x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 43/50 |loss: 0.140408| train set 1.776x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 44/50 |loss: 0.141382| train set 1.776x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
early stopping at epoch 44
Training per epoch cost 4.043 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 78.349s, pg runtime 78.349s, speedup 1.000x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 83.069s, pg runtime 83.069s, speedup 1.000x
15, opt runtime 47.518s, model runtime 75.736s, pg runtime 75.736s, speedup 1.000x
16, opt runtime 48.067s, model runtime 81.014s, pg runtime 81.014s, speedup 1.000x
17, opt runtime 47.738s, model runtime 76.021s, pg runtime 76.021s, speedup 1.000x
18, opt runtime 47.804s, model runtime 81.177s, pg runtime 81.177s, speedup 1.000x
19, opt runtime 49.511s, model runtime 87.329s, pg runtime 87.329s, speedup 1.000x
20, opt runtime 51.276s, model runtime 79.222s, pg runtime 79.222s, speedup 1.000x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 432.766s, pg runtime 432.766s, speedup 1.000x
32, opt runtime 15.120s, model runtime 566.078s, pg runtime 566.078s, speedup 1.000x
33, opt runtime 16.639s, model runtime 462.544s, pg runtime 462.544s, speedup 1.000x
34, opt runtime 16.280s, model runtime 634.990s, pg runtime 634.990s, speedup 1.000x
35, opt runtime 16.528s, model runtime 620.762s, pg runtime 620.762s, speedup 1.000x
36, opt runtime 18.690s, model runtime 651.942s, pg runtime 651.942s, speedup 1.000x
37, opt runtime 16.438s, model runtime 546.887s, pg runtime 546.887s, speedup 1.000x
38, opt runtime 16.138s, model runtime 501.793s, pg runtime 501.793s, speedup 1.000x
39, opt runtime 16.770s, model runtime 594.754s, pg runtime 594.754s, speedup 1.000x
40, opt runtime 16.305s, model runtime 436.168s, pg runtime 436.168s, speedup 1.000x
====================
best train speedup epoch: 18, train speedup 1.810, test speedup 1.862, val speedup 0.437
best test speedup epoch: 42, train speedup 1.810, test speedup 7.670, val speedup 0.437
best validation speedup epoch: 44, train speedup 1.776, test speedup 1.756, val speedup 0.437
last model at epoch 44, train speedup 1.776, test speedup 1.756, val speedup 0.437
execution cost 0:03:28.930670
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.096314, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344760| train set 1.620x speedup, test set 1.008x speedup, val set 0.477x speedup, step: 1, train time 5.33 s
Epoch 1/50 |loss: 0.232814| train set 1.528x speedup, test set 1.008x speedup, val set 0.296x speedup, step: 2, train time 4.00 s
Epoch 2/50 |loss: 0.202961| train set 1.698x speedup, test set 1.004x speedup, val set 0.437x speedup, step: 3, train time 3.92 s
Epoch 3/50 |loss: 0.195435| train set 1.776x speedup, test set 1.004x speedup, val set 0.437x speedup, step: 4, train time 3.90 s
Epoch 4/50 |loss: 0.180093| train set 1.809x speedup, test set 1.768x speedup, val set 0.437x speedup, step: 1, train time 3.98 s
Epoch 5/50 |loss: 0.169875| train set 1.775x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 6/50 |loss: 0.165180| train set 1.733x speedup, test set 1.595x speedup, val set 0.437x speedup, step: 3, train time 3.92 s
Epoch 7/50 |loss: 0.164512| train set 1.810x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 4, train time 3.99 s
Epoch 8/50 |loss: 0.156444| train set 1.810x speedup, test set 4.908x speedup, val set 0.437x speedup, step: 5, train time 4.00 s
Epoch 9/50 |loss: 0.154661| train set 1.662x speedup, test set 1.736x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
Epoch 10/50 |loss: 0.157754| train set 1.790x speedup, test set 1.768x speedup, val set 0.437x speedup, step: 2, train time 3.99 s
Epoch 11/50 |loss: 0.153361| train set 1.679x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 12/50 |loss: 0.153391| train set 1.776x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 13/50 |loss: 0.151115| train set 1.810x speedup, test set 1.768x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 14/50 |loss: 0.149672| train set 1.810x speedup, test set 1.008x speedup, val set 0.437x speedup, step: 1, train time 3.89 s
Epoch 15/50 |loss: 0.147960| train set 1.757x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 2, train time 4.12 s
Epoch 16/50 |loss: 0.145990| train set 1.776x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 3, train time 3.98 s
Epoch 17/50 |loss: 0.147404| train set 1.810x speedup, test set 1.004x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 18/50 |loss: 0.144959| train set 1.696x speedup, test set 1.016x speedup, val set 0.437x speedup, step: 5, train time 3.93 s
Epoch 19/50 |loss: 0.146879| train set 1.789x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
Epoch 20/50 |loss: 0.145285| train set 1.810x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 2, train time 4.12 s
Epoch 21/50 |loss: 0.145754| train set 1.775x speedup, test set 1.014x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 22/50 |loss: 0.144757| train set 1.775x speedup, test set 1.687x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 23/50 |loss: 0.145624| train set 1.775x speedup, test set 5.643x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 24/50 |loss: 0.145314| train set 1.810x speedup, test set 1.825x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 25/50 |loss: 0.143674| train set 1.809x speedup, test set 1.004x speedup, val set 0.437x speedup, step: 2, train time 4.18 s
Epoch 26/50 |loss: 0.143636| train set 1.810x speedup, test set 4.460x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 27/50 |loss: 0.141090| train set 1.756x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 4, train time 3.98 s
Epoch 28/50 |loss: 0.139915| train set 1.810x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 5, train time 3.91 s
Epoch 29/50 |loss: 0.141493| train set 1.810x speedup, test set 5.879x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 30/50 |loss: 0.140745| train set 1.791x speedup, test set 4.646x speedup, val set 0.437x speedup, step: 2, train time 3.92 s
Epoch 31/50 |loss: 0.139524| train set 1.809x speedup, test set 1.569x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 32/50 |loss: 0.139906| train set 1.810x speedup, test set 5.143x speedup, val set 0.437x speedup, step: 4, train time 3.90 s
Epoch 33/50 |loss: 0.139384| train set 1.775x speedup, test set 1.568x speedup, val set 0.437x speedup, step: 5, train time 3.93 s
Epoch 34/50 |loss: 0.140814| train set 1.810x speedup, test set 1.801x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 35/50 |loss: 0.139757| train set 1.810x speedup, test set 1.754x speedup, val set 0.437x speedup, step: 2, train time 4.08 s
Epoch 36/50 |loss: 0.141098| train set 1.810x speedup, test set 1.764x speedup, val set 0.437x speedup, step: 3, train time 3.91 s
Epoch 37/50 |loss: 0.137741| train set 1.810x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 4, train time 4.12 s
Epoch 38/50 |loss: 0.138612| train set 1.810x speedup, test set 6.299x speedup, val set 0.437x speedup, step: 5, train time 4.22 s
Epoch 39/50 |loss: 0.137428| train set 1.810x speedup, test set 6.459x speedup, val set 0.437x speedup, step: 1, train time 3.91 s
Epoch 40/50 |loss: 0.137813| train set 1.776x speedup, test set 4.094x speedup, val set 0.437x speedup, step: 2, train time 4.07 s
Epoch 41/50 |loss: 0.138808| train set 1.810x speedup, test set 1.717x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 42/50 |loss: 0.138814| train set 1.810x speedup, test set 4.900x speedup, val set 0.437x speedup, step: 4, train time 3.98 s
Epoch 43/50 |loss: 0.139700| train set 1.776x speedup, test set 5.524x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 44/50 |loss: 0.139837| train set 1.810x speedup, test set 5.938x speedup, val set 0.437x speedup, step: 1, train time 4.09 s
Epoch 45/50 |loss: 0.138698| train set 1.776x speedup, test set 1.721x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 46/50 |loss: 0.138659| train set 1.757x speedup, test set 4.908x speedup, val set 0.437x speedup, step: 3, train time 3.98 s
early stopping at epoch 46
Training per epoch cost 4.042 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 99.906s, pg runtime 91.784s, speedup 0.919x
02, opt runtime 29.763s, model runtime 99.246s, pg runtime 91.648s, speedup 0.923x
03, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
04, opt runtime 29.286s, model runtime 118.456s, pg runtime 92.131s, speedup 0.778x
05, opt runtime 29.269s, model runtime 116.896s, pg runtime 91.296s, speedup 0.781x
06, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
07, opt runtime 27.886s, model runtime 120.312s, pg runtime 97.629s, speedup 0.811x
08, opt runtime 30.705s, model runtime 101.271s, pg runtime 89.698s, speedup 0.886x
09, opt runtime 27.651s, model runtime 105.385s, pg runtime 91.255s, speedup 0.866x
10, opt runtime 33.637s, model runtime 110.814s, pg runtime 90.618s, speedup 0.818x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 34, train speedup 1.810, test speedup 1.801, val speedup 0.437
best test speedup epoch: 28, train speedup 1.810, test speedup 6.949, val speedup 0.437
best validation speedup epoch: 44, train speedup 1.810, test speedup 5.938, val speedup 0.437
last model at epoch 46, train speedup 1.757, test speedup 4.908, val speedup 0.437
execution cost 0:03:37.774021
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.006477, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344966| train set 1.620x speedup, test set 1.021x speedup, val set 0.477x speedup, step: 1, train time 5.23 s
Epoch 1/50 |loss: 0.230512| train set 1.747x speedup, test set 1.033x speedup, val set 0.296x speedup, step: 2, train time 3.74 s
Epoch 2/50 |loss: 0.203437| train set 1.663x speedup, test set 1.017x speedup, val set 0.296x speedup, step: 3, train time 3.99 s
Epoch 3/50 |loss: 0.189002| train set 1.776x speedup, test set 1.567x speedup, val set 0.437x speedup, step: 4, train time 4.23 s
Epoch 4/50 |loss: 0.175021| train set 1.809x speedup, test set 2.359x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 5/50 |loss: 0.169978| train set 1.776x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 2, train time 4.41 s
Epoch 6/50 |loss: 0.165877| train set 1.733x speedup, test set 3.709x speedup, val set 0.437x speedup, step: 3, train time 4.34 s
Epoch 7/50 |loss: 0.165337| train set 1.711x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 4, train time 4.49 s
Epoch 8/50 |loss: 0.158082| train set 1.776x speedup, test set 5.541x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 9/50 |loss: 0.154502| train set 1.789x speedup, test set 5.541x speedup, val set 0.437x speedup, step: 1, train time 4.28 s
Epoch 10/50 |loss: 0.157669| train set 1.791x speedup, test set 1.004x speedup, val set 0.437x speedup, step: 2, train time 4.03 s
Epoch 11/50 |loss: 0.153981| train set 1.790x speedup, test set 5.797x speedup, val set 0.437x speedup, step: 3, train time 4.20 s
Epoch 12/50 |loss: 0.155090| train set 1.776x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 4, train time 4.40 s
Epoch 13/50 |loss: 0.150973| train set 1.810x speedup, test set 1.638x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 14/50 |loss: 0.149918| train set 1.810x speedup, test set 1.034x speedup, val set 0.437x speedup, step: 1, train time 4.17 s
Epoch 15/50 |loss: 0.148730| train set 1.776x speedup, test set 1.811x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 16/50 |loss: 0.148259| train set 1.776x speedup, test set 5.550x speedup, val set 0.437x speedup, step: 3, train time 4.31 s
Epoch 17/50 |loss: 0.147833| train set 1.810x speedup, test set 1.004x speedup, val set 0.437x speedup, step: 4, train time 4.30 s
Epoch 18/50 |loss: 0.145029| train set 1.696x speedup, test set 1.025x speedup, val set 0.437x speedup, step: 5, train time 4.39 s
Epoch 19/50 |loss: 0.146897| train set 1.790x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 20/50 |loss: 0.145984| train set 1.810x speedup, test set 5.541x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 21/50 |loss: 0.146324| train set 1.775x speedup, test set 1.004x speedup, val set 0.437x speedup, step: 3, train time 4.70 s
Epoch 22/50 |loss: 0.145339| train set 1.775x speedup, test set 1.740x speedup, val set 0.437x speedup, step: 4, train time 4.08 s
Epoch 23/50 |loss: 0.145736| train set 1.809x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 24/50 |loss: 0.145783| train set 1.810x speedup, test set 1.034x speedup, val set 0.437x speedup, step: 1, train time 4.29 s
Epoch 25/50 |loss: 0.144075| train set 1.810x speedup, test set 1.577x speedup, val set 0.437x speedup, step: 2, train time 4.17 s
Epoch 26/50 |loss: 0.144535| train set 1.810x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 3, train time 4.61 s
Epoch 27/50 |loss: 0.142598| train set 1.757x speedup, test set 1.741x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 28/50 |loss: 0.140137| train set 1.810x speedup, test set 1.741x speedup, val set 0.437x speedup, step: 5, train time 3.99 s
Epoch 29/50 |loss: 0.142900| train set 1.810x speedup, test set 5.797x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 30/50 |loss: 0.140673| train set 1.790x speedup, test set 1.567x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 31/50 |loss: 0.141099| train set 1.775x speedup, test set 4.209x speedup, val set 0.437x speedup, step: 3, train time 4.38 s
Epoch 32/50 |loss: 0.139969| train set 1.810x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 33/50 |loss: 0.140000| train set 1.775x speedup, test set 4.275x speedup, val set 1.000x speedup, step: 5, train time 4.30 s
Epoch 34/50 |loss: 0.141017| train set 1.776x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 35/50 |loss: 0.141817| train set 1.810x speedup, test set 5.541x speedup, val set 0.437x speedup, step: 2, train time 4.37 s
Epoch 36/50 |loss: 0.142094| train set 1.810x speedup, test set 1.033x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 37/50 |loss: 0.139188| train set 1.810x speedup, test set 6.675x speedup, val set 0.437x speedup, step: 4, train time 3.92 s
Epoch 38/50 |loss: 0.139039| train set 1.810x speedup, test set 1.567x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 39/50 |loss: 0.138058| train set 1.810x speedup, test set 6.585x speedup, val set 0.437x speedup, step: 1, train time 4.23 s
Epoch 40/50 |loss: 0.140247| train set 1.776x speedup, test set 7.124x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 41/50 |loss: 0.138699| train set 1.765x speedup, test set 1.859x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 42/50 |loss: 0.140344| train set 1.810x speedup, test set 5.541x speedup, val set 0.437x speedup, step: 4, train time 4.50 s
Epoch 43/50 |loss: 0.140317| train set 1.776x speedup, test set 6.787x speedup, val set 0.437x speedup, step: 5, train time 4.31 s
Epoch 44/50 |loss: 0.141563| train set 1.810x speedup, test set 5.950x speedup, val set 0.437x speedup, step: 1, train time 4.21 s
Epoch 45/50 |loss: 0.138633| train set 1.775x speedup, test set 1.872x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 46/50 |loss: 0.138964| train set 1.757x speedup, test set 2.107x speedup, val set 0.437x speedup, step: 3, train time 4.31 s
Epoch 47/50 |loss: 0.137688| train set 1.810x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 4, train time 4.22 s
Epoch 48/50 |loss: 0.135355| train set 1.810x speedup, test set 1.033x speedup, val set 0.437x speedup, step: 5, train time 4.12 s
Epoch 49/50 |loss: 0.136148| train set 1.810x speedup, test set 4.969x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Training per epoch cost 4.229 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 58.701s, pg runtime 92.131s, speedup 1.569x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 60.311s, pg runtime 112.305s, speedup 1.862x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 91.571s, pg runtime 148.707s, speedup 1.624x
12, opt runtime 48.784s, model runtime 85.611s, pg runtime 78.349s, speedup 0.915x
13, opt runtime 53.440s, model runtime 86.638s, pg runtime 140.742s, speedup 1.624x
14, opt runtime 47.812s, model runtime 88.819s, pg runtime 83.069s, speedup 0.935x
15, opt runtime 47.518s, model runtime 83.137s, pg runtime 75.736s, speedup 0.911x
16, opt runtime 48.067s, model runtime 87.942s, pg runtime 81.014s, speedup 0.921x
17, opt runtime 47.738s, model runtime 83.106s, pg runtime 76.021s, speedup 0.915x
18, opt runtime 47.804s, model runtime 87.416s, pg runtime 81.177s, speedup 0.929x
19, opt runtime 49.511s, model runtime 92.597s, pg runtime 87.329s, speedup 0.943x
20, opt runtime 51.276s, model runtime 84.921s, pg runtime 79.222s, speedup 0.933x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 64.202s, pg runtime 432.766s, speedup 6.741x
32, opt runtime 15.120s, model runtime 62.890s, pg runtime 566.078s, speedup 9.001x
33, opt runtime 16.639s, model runtime 63.262s, pg runtime 462.544s, speedup 7.312x
34, opt runtime 16.280s, model runtime 65.389s, pg runtime 634.990s, speedup 9.711x
35, opt runtime 16.528s, model runtime 65.648s, pg runtime 620.762s, speedup 9.456x
36, opt runtime 18.690s, model runtime 65.943s, pg runtime 651.942s, speedup 9.886x
37, opt runtime 16.438s, model runtime 65.669s, pg runtime 546.887s, speedup 8.328x
38, opt runtime 16.138s, model runtime 65.836s, pg runtime 501.793s, speedup 7.622x
39, opt runtime 16.770s, model runtime 64.638s, pg runtime 594.754s, speedup 9.201x
40, opt runtime 16.305s, model runtime 62.435s, pg runtime 436.168s, speedup 6.986x
====================
best train speedup epoch: 35, train speedup 1.810, test speedup 5.541, val speedup 0.437
best test speedup epoch: 40, train speedup 1.776, test speedup 7.124, val speedup 0.437
best validation speedup epoch: 49, train speedup 1.810, test speedup 4.969, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 4.969, val speedup 0.437
execution cost 0:04:01.211500
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.129568, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.021x speedup, val set 0.477x speedup, step: 1, train time 5.21 s
Epoch 1/50 |loss: 0.229645| train set 1.428x speedup, test set 1.050x speedup, val set 0.477x speedup, step: 2, train time 3.83 s
Epoch 2/50 |loss: 0.202880| train set 1.791x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 3, train time 3.98 s
Epoch 3/50 |loss: 0.190037| train set 1.776x speedup, test set 1.171x speedup, val set 0.437x speedup, step: 4, train time 4.00 s
Epoch 4/50 |loss: 0.175985| train set 1.809x speedup, test set 1.716x speedup, val set 0.437x speedup, step: 1, train time 4.09 s
Epoch 5/50 |loss: 0.168789| train set 1.680x speedup, test set 2.384x speedup, val set 0.437x speedup, step: 2, train time 3.92 s
Epoch 6/50 |loss: 0.168173| train set 1.734x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 7/50 |loss: 0.163922| train set 1.810x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 4, train time 3.82 s
Epoch 8/50 |loss: 0.158107| train set 1.790x speedup, test set 4.908x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 9/50 |loss: 0.153927| train set 1.662x speedup, test set 4.817x speedup, val set 0.437x speedup, step: 1, train time 4.02 s
Epoch 10/50 |loss: 0.157332| train set 1.790x speedup, test set 5.662x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 11/50 |loss: 0.154002| train set 1.790x speedup, test set 1.782x speedup, val set 0.437x speedup, step: 3, train time 3.91 s
Epoch 12/50 |loss: 0.154440| train set 1.776x speedup, test set 1.754x speedup, val set 0.437x speedup, step: 4, train time 3.90 s
Epoch 13/50 |loss: 0.151581| train set 1.790x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 5, train time 3.92 s
Epoch 14/50 |loss: 0.149855| train set 1.810x speedup, test set 1.799x speedup, val set 0.437x speedup, step: 1, train time 4.02 s
Epoch 15/50 |loss: 0.148553| train set 1.757x speedup, test set 1.861x speedup, val set 0.437x speedup, step: 2, train time 3.97 s
Epoch 16/50 |loss: 0.148277| train set 1.776x speedup, test set 5.550x speedup, val set 0.437x speedup, step: 3, train time 3.91 s
Epoch 17/50 |loss: 0.148055| train set 1.810x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 18/50 |loss: 0.145073| train set 1.810x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 5, train time 3.90 s
Epoch 19/50 |loss: 0.146438| train set 1.790x speedup, test set 1.768x speedup, val set 0.437x speedup, step: 1, train time 3.80 s
Epoch 20/50 |loss: 0.146306| train set 1.810x speedup, test set 5.442x speedup, val set 0.437x speedup, step: 2, train time 3.70 s
Epoch 21/50 |loss: 0.145724| train set 1.775x speedup, test set 1.782x speedup, val set 0.437x speedup, step: 3, train time 3.82 s
Epoch 22/50 |loss: 0.144135| train set 1.775x speedup, test set 1.797x speedup, val set 0.437x speedup, step: 4, train time 3.81 s
Epoch 23/50 |loss: 0.145147| train set 1.810x speedup, test set 1.797x speedup, val set 0.437x speedup, step: 5, train time 3.91 s
Epoch 24/50 |loss: 0.145588| train set 1.810x speedup, test set 1.776x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 25/50 |loss: 0.143955| train set 1.809x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 26/50 |loss: 0.144668| train set 1.810x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 3, train time 3.82 s
Epoch 27/50 |loss: 0.142683| train set 1.776x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 4, train time 3.98 s
Epoch 28/50 |loss: 0.139809| train set 1.810x speedup, test set 5.658x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 29/50 |loss: 0.143217| train set 1.810x speedup, test set 1.767x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 30/50 |loss: 0.140673| train set 1.790x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 2, train time 3.82 s
Epoch 31/50 |loss: 0.141657| train set 1.775x speedup, test set 1.595x speedup, val set 0.437x speedup, step: 3, train time 3.80 s
Epoch 32/50 |loss: 0.139912| train set 1.809x speedup, test set 1.767x speedup, val set 0.437x speedup, step: 4, train time 3.80 s
Epoch 33/50 |loss: 0.140343| train set 1.809x speedup, test set 1.589x speedup, val set 0.437x speedup, step: 5, train time 3.75 s
Epoch 34/50 |loss: 0.140937| train set 1.810x speedup, test set 1.872x speedup, val set 0.437x speedup, step: 1, train time 3.72 s
Epoch 35/50 |loss: 0.141152| train set 1.810x speedup, test set 1.754x speedup, val set 0.437x speedup, step: 2, train time 3.71 s
Epoch 36/50 |loss: 0.142108| train set 1.810x speedup, test set 1.782x speedup, val set 0.437x speedup, step: 3, train time 3.79 s
Epoch 37/50 |loss: 0.138402| train set 1.810x speedup, test set 1.756x speedup, val set 0.437x speedup, step: 4, train time 3.82 s
Epoch 38/50 |loss: 0.138831| train set 1.810x speedup, test set 1.782x speedup, val set 0.437x speedup, step: 5, train time 4.08 s
Epoch 39/50 |loss: 0.139698| train set 1.810x speedup, test set 1.782x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 40/50 |loss: 0.138540| train set 1.776x speedup, test set 1.846x speedup, val set 0.437x speedup, step: 2, train time 3.98 s
Epoch 41/50 |loss: 0.139436| train set 1.765x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 3, train time 3.91 s
Epoch 42/50 |loss: 0.140389| train set 1.810x speedup, test set 1.780x speedup, val set 0.437x speedup, step: 4, train time 3.94 s
Epoch 43/50 |loss: 0.139838| train set 1.776x speedup, test set 5.950x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 44/50 |loss: 0.140106| train set 1.810x speedup, test set 5.887x speedup, val set 0.437x speedup, step: 1, train time 3.90 s
Epoch 45/50 |loss: 0.138629| train set 1.809x speedup, test set 1.874x speedup, val set 0.437x speedup, step: 2, train time 3.97 s
Epoch 46/50 |loss: 0.139635| train set 1.790x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 3, train time 3.99 s
early stopping at epoch 46
Training per epoch cost 3.947 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 78.349s, pg runtime 78.349s, speedup 1.000x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 83.069s, pg runtime 83.069s, speedup 1.000x
15, opt runtime 47.518s, model runtime 75.736s, pg runtime 75.736s, speedup 1.000x
16, opt runtime 48.067s, model runtime 81.014s, pg runtime 81.014s, speedup 1.000x
17, opt runtime 47.738s, model runtime 76.021s, pg runtime 76.021s, speedup 1.000x
18, opt runtime 47.804s, model runtime 81.177s, pg runtime 81.177s, speedup 1.000x
19, opt runtime 49.511s, model runtime 87.329s, pg runtime 87.329s, speedup 1.000x
20, opt runtime 51.276s, model runtime 79.222s, pg runtime 79.222s, speedup 1.000x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 29, train speedup 1.810, test speedup 1.767, val speedup 0.437
best test speedup epoch: 43, train speedup 1.776, test speedup 5.950, val speedup 0.437
best validation speedup epoch: 44, train speedup 1.810, test speedup 5.887, val speedup 0.437
last model at epoch 46, train speedup 1.790, test speedup 1.770, val speedup 0.437
execution cost 0:03:32.923424
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.199303, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345335| train set 1.620x speedup, test set 1.008x speedup, val set 0.477x speedup, step: 1, train time 5.62 s
Epoch 1/50 |loss: 0.233089| train set 1.747x speedup, test set 1.033x speedup, val set 0.477x speedup, step: 2, train time 4.11 s
Epoch 2/50 |loss: 0.203782| train set 1.790x speedup, test set 0.983x speedup, val set 0.296x speedup, step: 3, train time 4.20 s
Epoch 3/50 |loss: 0.191655| train set 1.776x speedup, test set 1.171x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 4/50 |loss: 0.174308| train set 1.809x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 1, train time 4.31 s
Epoch 5/50 |loss: 0.168931| train set 1.775x speedup, test set 4.908x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 6/50 |loss: 0.165720| train set 1.734x speedup, test set 4.209x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 7/50 |loss: 0.162062| train set 1.711x speedup, test set 5.837x speedup, val set 0.437x speedup, step: 4, train time 4.32 s
Epoch 8/50 |loss: 0.156213| train set 1.810x speedup, test set 5.569x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 9/50 |loss: 0.152364| train set 1.663x speedup, test set 4.803x speedup, val set 0.437x speedup, step: 1, train time 4.31 s
Epoch 10/50 |loss: 0.155468| train set 1.791x speedup, test set 1.567x speedup, val set 0.437x speedup, step: 2, train time 4.40 s
Epoch 11/50 |loss: 0.154055| train set 1.679x speedup, test set 5.569x speedup, val set 0.437x speedup, step: 3, train time 3.93 s
Epoch 12/50 |loss: 0.152694| train set 1.776x speedup, test set 4.851x speedup, val set 0.437x speedup, step: 4, train time 4.32 s
Epoch 13/50 |loss: 0.148960| train set 1.790x speedup, test set 4.716x speedup, val set 0.437x speedup, step: 5, train time 3.90 s
Epoch 14/50 |loss: 0.147946| train set 1.810x speedup, test set 4.716x speedup, val set 0.437x speedup, step: 1, train time 4.09 s
Epoch 15/50 |loss: 0.147667| train set 1.776x speedup, test set 4.716x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 16/50 |loss: 0.145825| train set 1.776x speedup, test set 5.569x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 17/50 |loss: 0.145958| train set 1.810x speedup, test set 4.716x speedup, val set 0.437x speedup, step: 4, train time 3.92 s
Epoch 18/50 |loss: 0.142914| train set 1.810x speedup, test set 5.569x speedup, val set 0.437x speedup, step: 5, train time 3.99 s
Epoch 19/50 |loss: 0.145580| train set 1.790x speedup, test set 4.894x speedup, val set 0.437x speedup, step: 1, train time 3.91 s
Epoch 20/50 |loss: 0.143845| train set 1.810x speedup, test set 6.044x speedup, val set 0.437x speedup, step: 2, train time 4.02 s
Epoch 21/50 |loss: 0.144489| train set 1.775x speedup, test set 1.846x speedup, val set 0.437x speedup, step: 3, train time 3.94 s
Epoch 22/50 |loss: 0.142910| train set 1.775x speedup, test set 8.111x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 23/50 |loss: 0.143185| train set 1.775x speedup, test set 5.670x speedup, val set 0.437x speedup, step: 5, train time 3.88 s
Epoch 24/50 |loss: 0.145267| train set 1.810x speedup, test set 4.716x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 25/50 |loss: 0.142892| train set 1.809x speedup, test set 1.816x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 26/50 |loss: 0.142924| train set 1.810x speedup, test set 4.716x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 27/50 |loss: 0.140539| train set 1.776x speedup, test set 5.569x speedup, val set 0.437x speedup, step: 4, train time 3.81 s
Epoch 28/50 |loss: 0.138358| train set 1.810x speedup, test set 6.728x speedup, val set 0.437x speedup, step: 5, train time 3.98 s
Epoch 29/50 |loss: 0.141292| train set 1.810x speedup, test set 5.559x speedup, val set 0.437x speedup, step: 1, train time 3.84 s
Epoch 30/50 |loss: 0.141035| train set 1.790x speedup, test set 5.681x speedup, val set 0.437x speedup, step: 2, train time 3.80 s
Epoch 31/50 |loss: 0.139622| train set 1.809x speedup, test set 4.460x speedup, val set 0.437x speedup, step: 3, train time 3.82 s
Epoch 32/50 |loss: 0.139522| train set 1.810x speedup, test set 4.485x speedup, val set 0.437x speedup, step: 4, train time 3.81 s
Epoch 33/50 |loss: 0.139427| train set 1.775x speedup, test set 3.572x speedup, val set 0.437x speedup, step: 5, train time 3.82 s
Epoch 34/50 |loss: 0.139917| train set 1.791x speedup, test set 1.846x speedup, val set 0.437x speedup, step: 1, train time 3.80 s
Epoch 35/50 |loss: 0.139522| train set 1.810x speedup, test set 5.425x speedup, val set 0.437x speedup, step: 2, train time 3.80 s
Epoch 36/50 |loss: 0.140684| train set 1.810x speedup, test set 4.716x speedup, val set 0.437x speedup, step: 3, train time 3.80 s
Epoch 37/50 |loss: 0.136879| train set 1.810x speedup, test set 5.670x speedup, val set 0.437x speedup, step: 4, train time 3.90 s
Epoch 38/50 |loss: 0.138025| train set 1.810x speedup, test set 1.846x speedup, val set 0.437x speedup, step: 5, train time 3.91 s
Epoch 39/50 |loss: 0.136574| train set 1.790x speedup, test set 7.405x speedup, val set 0.437x speedup, step: 1, train time 4.62 s
Epoch 40/50 |loss: 0.137427| train set 1.776x speedup, test set 6.728x speedup, val set 0.437x speedup, step: 2, train time 4.41 s
Epoch 41/50 |loss: 0.137827| train set 1.765x speedup, test set 5.315x speedup, val set 0.437x speedup, step: 3, train time 4.77 s
Epoch 42/50 |loss: 0.140542| train set 1.810x speedup, test set 6.642x speedup, val set 0.437x speedup, step: 4, train time 4.32 s
Epoch 43/50 |loss: 0.139110| train set 1.776x speedup, test set 5.670x speedup, val set 0.437x speedup, step: 5, train time 4.18 s
Epoch 44/50 |loss: 0.139325| train set 1.776x speedup, test set 5.938x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 45/50 |loss: 0.137454| train set 1.809x speedup, test set 4.563x speedup, val set 0.437x speedup, step: 2, train time 4.11 s
Epoch 46/50 |loss: 0.138272| train set 1.791x speedup, test set 4.817x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
early stopping at epoch 46
Training per epoch cost 4.096 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 99.906s, pg runtime 91.784s, speedup 0.919x
02, opt runtime 29.763s, model runtime 99.246s, pg runtime 91.648s, speedup 0.923x
03, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
04, opt runtime 29.286s, model runtime 118.456s, pg runtime 92.131s, speedup 0.778x
05, opt runtime 29.269s, model runtime 116.896s, pg runtime 91.296s, speedup 0.781x
06, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
07, opt runtime 27.886s, model runtime 120.312s, pg runtime 97.629s, speedup 0.811x
08, opt runtime 30.705s, model runtime 101.271s, pg runtime 89.698s, speedup 0.886x
09, opt runtime 27.651s, model runtime 105.385s, pg runtime 91.255s, speedup 0.866x
10, opt runtime 33.637s, model runtime 110.814s, pg runtime 90.618s, speedup 0.818x
11, opt runtime 53.298s, model runtime 148.707s, pg runtime 148.707s, speedup 1.000x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 140.742s, pg runtime 140.742s, speedup 1.000x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 16.268s, pg runtime 432.766s, speedup 26.603x
32, opt runtime 15.120s, model runtime 16.499s, pg runtime 566.078s, speedup 34.310x
33, opt runtime 16.639s, model runtime 16.639s, pg runtime 462.544s, speedup 27.800x
34, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
35, opt runtime 16.528s, model runtime 16.528s, pg runtime 620.762s, speedup 37.558x
36, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
37, opt runtime 16.438s, model runtime 16.438s, pg runtime 546.887s, speedup 33.269x
38, opt runtime 16.138s, model runtime 16.138s, pg runtime 501.793s, speedup 31.094x
39, opt runtime 16.770s, model runtime 16.770s, pg runtime 594.754s, speedup 35.464x
40, opt runtime 16.305s, model runtime 16.305s, pg runtime 436.168s, speedup 26.751x
====================
best train speedup epoch: 42, train speedup 1.810, test speedup 6.642, val speedup 0.437
best test speedup epoch: 22, train speedup 1.775, test speedup 8.111, val speedup 0.437
best validation speedup epoch: 44, train speedup 1.776, test speedup 5.938, val speedup 0.437
last model at epoch 46, train speedup 1.791, test speedup 4.817, val speedup 0.437
execution cost 0:03:40.373903
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
train, test, validation (140, 49) (40, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.110759, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345789| train set 1.762x speedup, test set 1.008x speedup, val set 0.477x speedup, step: 1, train time 5.18 s
Epoch 1/50 |loss: 0.229733| train set 1.694x speedup, test set 4.829x speedup, val set 0.296x speedup, step: 2, train time 3.89 s
Epoch 2/50 |loss: 0.204613| train set 1.790x speedup, test set 0.971x speedup, val set 0.296x speedup, step: 3, train time 3.90 s
Epoch 3/50 |loss: 0.187783| train set 1.776x speedup, test set 0.996x speedup, val set 0.437x speedup, step: 4, train time 3.93 s
Epoch 4/50 |loss: 0.174749| train set 1.790x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 1, train time 3.91 s
Epoch 5/50 |loss: 0.169171| train set 1.775x speedup, test set 4.716x speedup, val set 0.437x speedup, step: 2, train time 3.90 s
Epoch 6/50 |loss: 0.165417| train set 1.733x speedup, test set 1.688x speedup, val set 0.437x speedup, step: 3, train time 3.92 s
Epoch 7/50 |loss: 0.164463| train set 1.810x speedup, test set 5.550x speedup, val set 0.296x speedup, step: 4, train time 3.88 s
Epoch 8/50 |loss: 0.156235| train set 1.757x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 9/50 |loss: 0.152994| train set 1.663x speedup, test set 5.817x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 10/50 |loss: 0.156016| train set 1.790x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 2, train time 3.88 s
Epoch 11/50 |loss: 0.153965| train set 1.679x speedup, test set 6.921x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 12/50 |loss: 0.153608| train set 1.776x speedup, test set 1.834x speedup, val set 0.437x speedup, step: 4, train time 4.02 s
Epoch 13/50 |loss: 0.149972| train set 1.810x speedup, test set 1.779x speedup, val set 0.437x speedup, step: 5, train time 3.98 s
Epoch 14/50 |loss: 0.149173| train set 1.810x speedup, test set 1.034x speedup, val set 0.437x speedup, step: 1, train time 3.91 s
Epoch 15/50 |loss: 0.148287| train set 1.757x speedup, test set 1.837x speedup, val set 0.437x speedup, step: 2, train time 3.89 s
Epoch 16/50 |loss: 0.146479| train set 1.776x speedup, test set 1.860x speedup, val set 0.437x speedup, step: 3, train time 3.81 s
Epoch 17/50 |loss: 0.147181| train set 1.810x speedup, test set 1.034x speedup, val set 0.437x speedup, step: 4, train time 3.90 s
Epoch 18/50 |loss: 0.144435| train set 1.696x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 5, train time 3.88 s
Epoch 19/50 |loss: 0.146968| train set 1.790x speedup, test set 1.768x speedup, val set 0.437x speedup, step: 1, train time 3.98 s
Epoch 20/50 |loss: 0.144871| train set 1.810x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 2, train time 3.88 s
Epoch 21/50 |loss: 0.146276| train set 1.775x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 3, train time 3.99 s
Epoch 22/50 |loss: 0.145709| train set 1.776x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 4, train time 3.90 s
Epoch 23/50 |loss: 0.144528| train set 1.809x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 5, train time 3.89 s
Epoch 24/50 |loss: 0.145052| train set 1.810x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 1, train time 4.02 s
Epoch 25/50 |loss: 0.143747| train set 1.810x speedup, test set 1.862x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 26/50 |loss: 0.144999| train set 1.810x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 27/50 |loss: 0.141078| train set 1.776x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 4, train time 3.89 s
Epoch 28/50 |loss: 0.140122| train set 1.810x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 5, train time 3.99 s
Epoch 29/50 |loss: 0.141293| train set 1.810x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 30/50 |loss: 0.139508| train set 1.791x speedup, test set 1.770x speedup, val set 0.437x speedup, step: 2, train time 4.03 s
Epoch 31/50 |loss: 0.140242| train set 1.775x speedup, test set 1.919x speedup, val set 0.437x speedup, step: 3, train time 3.81 s
Epoch 32/50 |loss: 0.139779| train set 1.810x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 4, train time 3.89 s
Epoch 33/50 |loss: 0.139321| train set 1.775x speedup, test set 1.919x speedup, val set 0.437x speedup, step: 5, train time 3.88 s
Epoch 34/50 |loss: 0.141063| train set 1.810x speedup, test set 5.817x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 35/50 |loss: 0.139949| train set 1.810x speedup, test set 6.949x speedup, val set 1.000x speedup, step: 2, train time 3.99 s
Epoch 36/50 |loss: 0.140699| train set 1.810x speedup, test set 2.175x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 37/50 |loss: 0.137489| train set 1.810x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 4, train time 3.90 s
Epoch 38/50 |loss: 0.138375| train set 1.810x speedup, test set 2.175x speedup, val set 0.437x speedup, step: 5, train time 4.00 s
Epoch 39/50 |loss: 0.136269| train set 1.810x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
Epoch 40/50 |loss: 0.138397| train set 1.776x speedup, test set 1.919x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 41/50 |loss: 0.138032| train set 1.810x speedup, test set 2.175x speedup, val set 0.437x speedup, step: 3, train time 4.21 s
Epoch 42/50 |loss: 0.139991| train set 1.810x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 4, train time 4.30 s
Epoch 43/50 |loss: 0.139359| train set 1.776x speedup, test set 6.949x speedup, val set 0.437x speedup, step: 5, train time 3.90 s
Epoch 44/50 |loss: 0.140795| train set 1.776x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 1, train time 4.09 s
Epoch 45/50 |loss: 0.138227| train set 1.810x speedup, test set 2.175x speedup, val set 0.437x speedup, step: 2, train time 3.99 s
Epoch 46/50 |loss: 0.140081| train set 1.790x speedup, test set 2.316x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
early stopping at epoch 46
Training per epoch cost 3.989 s
Optimal speedup on test set is 11.153x
01, opt runtime 28.639s, model runtime 91.784s, pg runtime 91.784s, speedup 1.000x
02, opt runtime 29.763s, model runtime 91.648s, pg runtime 91.648s, speedup 1.000x
03, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
04, opt runtime 29.286s, model runtime 92.131s, pg runtime 92.131s, speedup 1.000x
05, opt runtime 29.269s, model runtime 91.296s, pg runtime 91.296s, speedup 1.000x
06, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
07, opt runtime 27.886s, model runtime 97.629s, pg runtime 97.629s, speedup 1.000x
08, opt runtime 30.705s, model runtime 89.698s, pg runtime 89.698s, speedup 1.000x
09, opt runtime 27.651s, model runtime 91.255s, pg runtime 91.255s, speedup 1.000x
10, opt runtime 33.637s, model runtime 90.618s, pg runtime 90.618s, speedup 1.000x
11, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
12, opt runtime 48.784s, model runtime 48.784s, pg runtime 78.349s, speedup 1.606x
13, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
14, opt runtime 47.812s, model runtime 47.812s, pg runtime 83.069s, speedup 1.737x
15, opt runtime 47.518s, model runtime 47.518s, pg runtime 75.736s, speedup 1.594x
16, opt runtime 48.067s, model runtime 48.067s, pg runtime 81.014s, speedup 1.685x
17, opt runtime 47.738s, model runtime 47.738s, pg runtime 76.021s, speedup 1.592x
18, opt runtime 47.804s, model runtime 47.804s, pg runtime 81.177s, speedup 1.698x
19, opt runtime 49.511s, model runtime 49.511s, pg runtime 87.329s, speedup 1.764x
20, opt runtime 51.276s, model runtime 51.276s, pg runtime 79.222s, speedup 1.545x
21, opt runtime 24.391s, model runtime 31.563s, pg runtime 601.866s, speedup 19.069x
22, opt runtime 24.079s, model runtime 32.527s, pg runtime 608.707s, speedup 18.714x
23, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
24, opt runtime 24.459s, model runtime 30.923s, pg runtime 608.717s, speedup 19.685x
25, opt runtime 25.236s, model runtime 32.391s, pg runtime 601.756s, speedup 18.578x
26, opt runtime 25.363s, model runtime 33.350s, pg runtime 611.327s, speedup 18.331x
27, opt runtime 24.706s, model runtime 31.441s, pg runtime 610.808s, speedup 19.427x
28, opt runtime 25.075s, model runtime 33.122s, pg runtime 612.430s, speedup 18.490x
29, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
30, opt runtime 24.920s, model runtime 32.417s, pg runtime 610.993s, speedup 18.848x
31, opt runtime 16.268s, model runtime 365.512s, pg runtime 432.766s, speedup 1.184x
32, opt runtime 15.120s, model runtime 429.377s, pg runtime 566.078s, speedup 1.318x
33, opt runtime 16.639s, model runtime 378.987s, pg runtime 462.544s, speedup 1.220x
34, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
35, opt runtime 16.528s, model runtime 437.980s, pg runtime 620.762s, speedup 1.417x
36, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
37, opt runtime 16.438s, model runtime 387.494s, pg runtime 546.887s, speedup 1.411x
38, opt runtime 16.138s, model runtime 385.465s, pg runtime 501.793s, speedup 1.302x
39, opt runtime 16.770s, model runtime 393.974s, pg runtime 594.754s, speedup 1.510x
40, opt runtime 16.305s, model runtime 401.313s, pg runtime 436.168s, speedup 1.087x
====================
best train speedup epoch: 35, train speedup 1.810, test speedup 6.949, val speedup 1.000
best test speedup epoch: 8, train speedup 1.757, test speedup 6.949, val speedup 0.437
best validation speedup epoch: 44, train speedup 1.776, test speedup 2.316, val speedup 0.437
last model at epoch 46, train speedup 1.790, test speedup 2.316, val speedup 0.437
execution cost 0:03:35.426594
==================================================
