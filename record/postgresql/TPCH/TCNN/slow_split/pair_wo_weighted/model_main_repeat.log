all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.528254, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.394083| train set 3.929x speedup, test set 4.717x speedup, val set 3.959x speedup, step: 1, train time 8.67 s
Epoch 1/50 |loss: 0.236612| train set 5.147x speedup, test set 5.385x speedup, val set 5.226x speedup, step: 2, train time 7.49 s
Epoch 2/50 |loss: 0.207468| train set 5.255x speedup, test set 5.489x speedup, val set 5.333x speedup, step: 3, train time 7.49 s
Epoch 3/50 |loss: 0.189853| train set 5.152x speedup, test set 5.318x speedup, val set 5.163x speedup, step: 4, train time 7.43 s
Epoch 4/50 |loss: 0.174457| train set 5.210x speedup, test set 5.441x speedup, val set 5.459x speedup, step: 1, train time 7.41 s
Epoch 5/50 |loss: 0.163218| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2, train time 7.49 s
Epoch 6/50 |loss: 0.159940| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.41 s
Epoch 7/50 |loss: 0.153917| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 4, train time 7.41 s
Epoch 8/50 |loss: 0.147899| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 5, train time 7.49 s
Epoch 9/50 |loss: 0.149922| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.41 s
Epoch 10/50 |loss: 0.147436| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 2, train time 7.51 s
Epoch 11/50 |loss: 0.144042| train set 5.196x speedup, test set 5.430x speedup, val set 5.418x speedup, step: 3, train time 7.51 s
Epoch 12/50 |loss: 0.143564| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4, train time 7.62 s
Epoch 13/50 |loss: 0.141290| train set 5.251x speedup, test set 5.480x speedup, val set 5.307x speedup, step: 5, train time 7.48 s
Epoch 14/50 |loss: 0.141187| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 6, train time 7.52 s
Epoch 15/50 |loss: 0.136582| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 7, train time 7.59 s
Epoch 16/50 |loss: 0.137082| train set 5.267x speedup, test set 5.507x speedup, val set 5.360x speedup, step: 8, train time 7.50 s
Epoch 17/50 |loss: 0.134622| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9, train time 7.62 s
Epoch 18/50 |loss: 0.136408| train set 5.308x speedup, test set 5.538x speedup, val set 5.365x speedup, step: 10, train time 7.51 s
Epoch 19/50 |loss: 0.132388| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 11, train time 7.52 s
Epoch 20/50 |loss: 0.131637| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 12, train time 7.59 s
Epoch 21/50 |loss: 0.132181| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13, train time 7.91 s
Epoch 22/50 |loss: 0.132681| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 14, train time 7.52 s
Epoch 23/50 |loss: 0.133436| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 15, train time 7.59 s
Epoch 24/50 |loss: 0.128563| train set 5.267x speedup, test set 5.509x speedup, val set 5.360x speedup, step: 16, train time 7.51 s
Epoch 25/50 |loss: 0.130286| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 17, train time 7.47 s
Epoch 26/50 |loss: 0.130797| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18, train time 7.60 s
Epoch 27/50 |loss: 0.127511| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19, train time 7.51 s
Epoch 28/50 |loss: 0.128092| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20, train time 7.61 s
Epoch 29/50 |loss: 0.128443| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.58 s
Epoch 30/50 |loss: 0.126154| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 22, train time 7.49 s
Epoch 31/50 |loss: 0.127142| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 23, train time 7.51 s
Epoch 32/50 |loss: 0.126313| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 24, train time 7.62 s
Epoch 33/50 |loss: 0.126592| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 25, train time 7.59 s
Epoch 34/50 |loss: 0.128395| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26, train time 7.81 s
Epoch 35/50 |loss: 0.123630| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 27, train time 7.50 s
Epoch 36/50 |loss: 0.125206| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 28, train time 7.52 s
Epoch 37/50 |loss: 0.125658| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 29, train time 7.59 s
Epoch 38/50 |loss: 0.126181| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 30, train time 7.51 s
Epoch 39/50 |loss: 0.125609| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 1, train time 7.60 s
Epoch 40/50 |loss: 0.123201| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 2, train time 7.41 s
Epoch 41/50 |loss: 0.124165| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 3, train time 7.49 s
Epoch 42/50 |loss: 0.123330| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4, train time 7.50 s
Epoch 43/50 |loss: 0.121980| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 5, train time 7.62 s
Epoch 44/50 |loss: 0.123799| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6, train time 7.50 s
Epoch 45/50 |loss: 0.123461| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 7, train time 7.59 s
Epoch 46/50 |loss: 0.123134| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8, train time 7.59 s
Epoch 47/50 |loss: 0.121114| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9, train time 7.60 s
Epoch 48/50 |loss: 0.121372| train set 5.261x speedup, test set 5.503x speedup, val set 5.488x speedup, step: 10, train time 7.61 s
Epoch 49/50 |loss: 0.120098| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11, train time 7.52 s
Training per epoch cost 7.563 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 6, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 41, train speedup 5.325, test speedup 5.566, val speedup 5.399
best validation speedup epoch: 39, train speedup 5.266, test speedup 5.497, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:43.241097
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.568869, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.394030| train set 3.888x speedup, test set 4.420x speedup, val set 3.930x speedup, step: 1, train time 8.74 s
Epoch 1/50 |loss: 0.239709| train set 5.268x speedup, test set 5.499x speedup, val set 5.206x speedup, step: 2, train time 7.39 s
Epoch 2/50 |loss: 0.206415| train set 5.265x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 3, train time 7.39 s
Epoch 3/50 |loss: 0.185949| train set 5.006x speedup, test set 5.335x speedup, val set 5.123x speedup, step: 4, train time 7.59 s
Epoch 4/50 |loss: 0.172861| train set 5.210x speedup, test set 5.441x speedup, val set 5.459x speedup, step: 1, train time 7.58 s
Epoch 5/50 |loss: 0.163115| train set 5.199x speedup, test set 5.431x speedup, val set 5.294x speedup, step: 2, train time 7.48 s
Epoch 6/50 |loss: 0.159225| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 3, train time 7.41 s
Epoch 7/50 |loss: 0.153778| train set 5.251x speedup, test set 5.478x speedup, val set 5.326x speedup, step: 4, train time 7.49 s
Epoch 8/50 |loss: 0.149483| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5, train time 7.49 s
Epoch 9/50 |loss: 0.145160| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.41 s
Epoch 10/50 |loss: 0.145387| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 2, train time 7.41 s
Epoch 11/50 |loss: 0.142581| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 3, train time 7.42 s
Epoch 12/50 |loss: 0.144426| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4, train time 7.59 s
Epoch 13/50 |loss: 0.139588| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 5, train time 7.49 s
Epoch 14/50 |loss: 0.140572| train set 5.163x speedup, test set 5.422x speedup, val set 5.130x speedup, step: 6, train time 7.52 s
Epoch 15/50 |loss: 0.134191| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 7, train time 7.60 s
Epoch 16/50 |loss: 0.136282| train set 5.267x speedup, test set 5.507x speedup, val set 5.360x speedup, step: 8, train time 7.51 s
Epoch 17/50 |loss: 0.135065| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 9, train time 7.51 s
Epoch 18/50 |loss: 0.135140| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 10, train time 7.52 s
Epoch 19/50 |loss: 0.131520| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11, train time 7.41 s
Epoch 20/50 |loss: 0.130950| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 12, train time 7.41 s
Epoch 21/50 |loss: 0.132614| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13, train time 7.61 s
Epoch 22/50 |loss: 0.133227| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 14, train time 7.50 s
Epoch 23/50 |loss: 0.131964| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 15, train time 7.49 s
Epoch 24/50 |loss: 0.128954| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 16, train time 7.49 s
Epoch 25/50 |loss: 0.129368| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 17, train time 7.50 s
Epoch 26/50 |loss: 0.129563| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18, train time 7.49 s
Epoch 27/50 |loss: 0.128993| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19, train time 7.38 s
Epoch 28/50 |loss: 0.129175| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 20, train time 7.43 s
Epoch 29/50 |loss: 0.127829| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.51 s
Epoch 30/50 |loss: 0.126718| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 22, train time 7.60 s
Epoch 31/50 |loss: 0.127164| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 23, train time 7.59 s
Epoch 32/50 |loss: 0.125480| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 24, train time 7.50 s
Epoch 33/50 |loss: 0.125744| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 25, train time 7.60 s
Epoch 34/50 |loss: 0.126524| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26, train time 7.52 s
Epoch 35/50 |loss: 0.123611| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 27, train time 7.52 s
Epoch 36/50 |loss: 0.124882| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 28, train time 7.50 s
Epoch 37/50 |loss: 0.124607| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29, train time 7.51 s
Epoch 38/50 |loss: 0.125924| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 30, train time 7.42 s
Epoch 39/50 |loss: 0.125426| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.51 s
Epoch 40/50 |loss: 0.123551| train set 5.326x speedup, test set 5.560x speedup, val set 5.385x speedup, step: 2, train time 7.40 s
Epoch 41/50 |loss: 0.123469| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 3, train time 7.42 s
Epoch 42/50 |loss: 0.121995| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4, train time 7.63 s
Epoch 43/50 |loss: 0.120940| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5, train time 7.49 s
Epoch 44/50 |loss: 0.123326| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6, train time 7.59 s
Epoch 45/50 |loss: 0.122946| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 7, train time 7.50 s
Epoch 46/50 |loss: 0.122638| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8, train time 7.40 s
Epoch 47/50 |loss: 0.121660| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 9, train time 7.42 s
Epoch 48/50 |loss: 0.121534| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 10, train time 7.58 s
Epoch 49/50 |loss: 0.119920| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11, train time 7.60 s
Training per epoch cost 7.521 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 8, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 41, train speedup 5.325, test speedup 5.566, val speedup 5.399
best validation speedup epoch: 39, train speedup 5.266, test speedup 5.496, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:41.602115
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.527261, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.395609| train set 4.645x speedup, test set 4.829x speedup, val set 4.712x speedup, step: 1, train time 8.47 s
Epoch 1/50 |loss: 0.239438| train set 5.152x speedup, test set 5.319x speedup, val set 5.163x speedup, step: 2, train time 7.38 s
Epoch 2/50 |loss: 0.205563| train set 5.255x speedup, test set 5.489x speedup, val set 5.333x speedup, step: 3, train time 7.21 s
Epoch 3/50 |loss: 0.185747| train set 5.098x speedup, test set 5.264x speedup, val set 5.127x speedup, step: 4, train time 7.31 s
Epoch 4/50 |loss: 0.174041| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1, train time 7.32 s
Epoch 5/50 |loss: 0.166010| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2, train time 7.28 s
Epoch 6/50 |loss: 0.158898| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 3, train time 7.22 s
Epoch 7/50 |loss: 0.154022| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 4, train time 7.32 s
Epoch 8/50 |loss: 0.147277| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5, train time 7.21 s
Epoch 9/50 |loss: 0.146942| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 1, train time 7.02 s
Epoch 10/50 |loss: 0.146862| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 2, train time 7.17 s
Epoch 11/50 |loss: 0.143229| train set 5.266x speedup, test set 5.499x speedup, val set 5.501x speedup, step: 3, train time 7.29 s
Epoch 12/50 |loss: 0.141306| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4, train time 7.30 s
Epoch 13/50 |loss: 0.140467| train set 5.268x speedup, test set 5.500x speedup, val set 5.345x speedup, step: 5, train time 7.20 s
Epoch 14/50 |loss: 0.140623| train set 5.267x speedup, test set 5.507x speedup, val set 5.360x speedup, step: 6, train time 7.12 s
Epoch 15/50 |loss: 0.135833| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 7, train time 7.10 s
Epoch 16/50 |loss: 0.136020| train set 5.267x speedup, test set 5.507x speedup, val set 5.360x speedup, step: 8, train time 7.32 s
Epoch 17/50 |loss: 0.134451| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9, train time 7.17 s
Epoch 18/50 |loss: 0.136508| train set 5.308x speedup, test set 5.538x speedup, val set 5.365x speedup, step: 10, train time 7.31 s
Epoch 19/50 |loss: 0.132414| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11, train time 7.41 s
Epoch 20/50 |loss: 0.131185| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 12, train time 7.22 s
Epoch 21/50 |loss: 0.132804| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13, train time 7.42 s
Epoch 22/50 |loss: 0.132950| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 14, train time 7.11 s
Epoch 23/50 |loss: 0.133483| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 15, train time 7.21 s
Epoch 24/50 |loss: 0.129060| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 16, train time 7.19 s
Epoch 25/50 |loss: 0.131671| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 17, train time 7.30 s
Epoch 26/50 |loss: 0.131180| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18, train time 7.31 s
Epoch 27/50 |loss: 0.128781| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19, train time 7.21 s
Epoch 28/50 |loss: 0.128981| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 20, train time 7.42 s
Epoch 29/50 |loss: 0.128258| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.32 s
Epoch 30/50 |loss: 0.126108| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 22, train time 7.29 s
Epoch 31/50 |loss: 0.128127| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 23, train time 7.30 s
Epoch 32/50 |loss: 0.126930| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 24, train time 7.42 s
Epoch 33/50 |loss: 0.126645| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 25, train time 7.38 s
Epoch 34/50 |loss: 0.126961| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 26, train time 7.22 s
Epoch 35/50 |loss: 0.125104| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 27, train time 7.39 s
Epoch 36/50 |loss: 0.124984| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 28, train time 7.38 s
Epoch 37/50 |loss: 0.125359| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29, train time 7.30 s
Epoch 38/50 |loss: 0.126143| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 30, train time 7.20 s
Epoch 39/50 |loss: 0.124998| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 31, train time 7.30 s
Epoch 40/50 |loss: 0.123859| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 32, train time 7.29 s
Epoch 41/50 |loss: 0.124533| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 33, train time 7.11 s
Epoch 42/50 |loss: 0.123427| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 34, train time 7.32 s
Epoch 43/50 |loss: 0.121180| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 35, train time 7.11 s
Epoch 44/50 |loss: 0.123820| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 36, train time 7.27 s
Epoch 45/50 |loss: 0.123554| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 37, train time 7.40 s
Epoch 46/50 |loss: 0.123997| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 38, train time 7.30 s
Epoch 47/50 |loss: 0.122397| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 39, train time 7.40 s
Epoch 48/50 |loss: 0.121114| train set 5.261x speedup, test set 5.506x speedup, val set 5.489x speedup, step: 40, train time 7.19 s
Epoch 49/50 |loss: 0.121192| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 41, train time 7.29 s
Training per epoch cost 7.294 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 8, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 8, train speedup 5.326, test speedup 5.559, val speedup 5.403
best validation speedup epoch: 9, train speedup 5.266, test speedup 5.497, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:29.961830
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.520154, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.394356| train set 4.645x speedup, test set 4.830x speedup, val set 4.712x speedup, step: 1, train time 8.58 s
Epoch 1/50 |loss: 0.238385| train set 5.247x speedup, test set 5.483x speedup, val set 5.328x speedup, step: 2, train time 7.40 s
Epoch 2/50 |loss: 0.211067| train set 5.255x speedup, test set 5.489x speedup, val set 5.333x speedup, step: 3, train time 7.39 s
Epoch 3/50 |loss: 0.186445| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 4, train time 7.29 s
Epoch 4/50 |loss: 0.174764| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1, train time 7.32 s
Epoch 5/50 |loss: 0.163620| train set 5.199x speedup, test set 5.431x speedup, val set 5.294x speedup, step: 2, train time 7.29 s
Epoch 6/50 |loss: 0.162336| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.49 s
Epoch 7/50 |loss: 0.154325| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 4, train time 7.30 s
Epoch 8/50 |loss: 0.150045| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 5, train time 7.42 s
Epoch 9/50 |loss: 0.147969| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 6, train time 7.40 s
Epoch 10/50 |loss: 0.147269| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 7, train time 7.40 s
Epoch 11/50 |loss: 0.143056| train set 5.249x speedup, test set 5.476x speedup, val set 5.460x speedup, step: 8, train time 7.50 s
Epoch 12/50 |loss: 0.142879| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9, train time 7.41 s
Epoch 13/50 |loss: 0.140379| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 10, train time 7.31 s
Epoch 14/50 |loss: 0.141422| train set 5.261x speedup, test set 5.484x speedup, val set 5.403x speedup, step: 11, train time 7.42 s
Epoch 15/50 |loss: 0.136986| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 12, train time 7.59 s
Epoch 16/50 |loss: 0.136271| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 13, train time 7.59 s
Epoch 17/50 |loss: 0.134968| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 14, train time 7.40 s
Epoch 18/50 |loss: 0.136087| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 15, train time 7.58 s
Epoch 19/50 |loss: 0.132531| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 16, train time 7.49 s
Epoch 20/50 |loss: 0.131044| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 17, train time 7.62 s
Epoch 21/50 |loss: 0.133407| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 18, train time 7.69 s
Epoch 22/50 |loss: 0.133633| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19, train time 7.42 s
Epoch 23/50 |loss: 0.133850| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 20, train time 7.43 s
Epoch 24/50 |loss: 0.129001| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.51 s
Epoch 25/50 |loss: 0.130175| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 22, train time 7.42 s
Epoch 26/50 |loss: 0.130012| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 23, train time 7.51 s
Epoch 27/50 |loss: 0.128372| train set 5.308x speedup, test set 5.537x speedup, val set 5.364x speedup, step: 24, train time 7.61 s
Epoch 28/50 |loss: 0.129044| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 25, train time 7.51 s
Epoch 29/50 |loss: 0.127933| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 26, train time 7.50 s
Epoch 30/50 |loss: 0.126474| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 27, train time 7.51 s
Epoch 31/50 |loss: 0.126840| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 28, train time 7.50 s
Epoch 32/50 |loss: 0.126152| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29, train time 7.67 s
Epoch 33/50 |loss: 0.127195| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 30, train time 7.52 s
Epoch 34/50 |loss: 0.127229| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 31, train time 7.60 s
Epoch 35/50 |loss: 0.125186| train set 5.321x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 32, train time 7.61 s
Epoch 36/50 |loss: 0.124486| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 33, train time 7.49 s
Epoch 37/50 |loss: 0.127046| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 34, train time 7.52 s
Epoch 38/50 |loss: 0.126798| train set 5.266x speedup, test set 5.496x speedup, val set 5.496x speedup, step: 35, train time 7.42 s
Epoch 39/50 |loss: 0.125430| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 1, train time 7.53 s
Epoch 40/50 |loss: 0.124304| train set 5.266x speedup, test set 5.498x speedup, val set 5.481x speedup, step: 2, train time 7.60 s
Epoch 41/50 |loss: 0.125218| train set 5.325x speedup, test set 5.567x speedup, val set 5.399x speedup, step: 3, train time 7.51 s
Epoch 42/50 |loss: 0.124975| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4, train time 7.61 s
Epoch 43/50 |loss: 0.120997| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5, train time 7.51 s
Epoch 44/50 |loss: 0.124020| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6, train time 7.68 s
Epoch 45/50 |loss: 0.123171| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 7, train time 7.61 s
Epoch 46/50 |loss: 0.122624| train set 5.308x speedup, test set 5.537x speedup, val set 5.364x speedup, step: 8, train time 7.60 s
Epoch 47/50 |loss: 0.122234| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 9, train time 7.59 s
Epoch 48/50 |loss: 0.122443| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 10, train time 7.49 s
Epoch 49/50 |loss: 0.120808| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11, train time 7.42 s
Training per epoch cost 7.515 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 6, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 41, train speedup 5.325, test speedup 5.567, val speedup 5.399
best validation speedup epoch: 39, train speedup 5.266, test speedup 5.497, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:41.289557
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.549847, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.393200| train set 4.437x speedup, test set 5.131x speedup, val set 4.405x speedup, step: 1, train time 8.52 s
Epoch 1/50 |loss: 0.235335| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 2, train time 7.40 s
Epoch 2/50 |loss: 0.208621| train set 5.107x speedup, test set 5.366x speedup, val set 5.218x speedup, step: 3, train time 7.30 s
Epoch 3/50 |loss: 0.186981| train set 5.113x speedup, test set 5.449x speedup, val set 5.074x speedup, step: 4, train time 7.37 s
Epoch 4/50 |loss: 0.174812| train set 5.210x speedup, test set 5.441x speedup, val set 5.459x speedup, step: 1, train time 7.31 s
Epoch 5/50 |loss: 0.165097| train set 5.199x speedup, test set 5.431x speedup, val set 5.294x speedup, step: 2, train time 7.32 s
Epoch 6/50 |loss: 0.158733| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 3, train time 7.30 s
Epoch 7/50 |loss: 0.154373| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 4, train time 7.40 s
Epoch 8/50 |loss: 0.150705| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 5, train time 7.29 s
Epoch 9/50 |loss: 0.149068| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.31 s
Epoch 10/50 |loss: 0.146890| train set 5.251x speedup, test set 5.478x speedup, val set 5.326x speedup, step: 2, train time 7.38 s
Epoch 11/50 |loss: 0.143861| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 3, train time 7.32 s
Epoch 12/50 |loss: 0.143496| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4, train time 7.29 s
Epoch 13/50 |loss: 0.141567| train set 5.251x speedup, test set 5.480x speedup, val set 5.326x speedup, step: 5, train time 7.32 s
Epoch 14/50 |loss: 0.142849| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6, train time 7.42 s
Epoch 15/50 |loss: 0.138404| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 7, train time 7.12 s
Epoch 16/50 |loss: 0.136808| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 8, train time 7.03 s
Epoch 17/50 |loss: 0.135801| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9, train time 7.31 s
Epoch 18/50 |loss: 0.135717| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10, train time 7.22 s
Epoch 19/50 |loss: 0.133652| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11, train time 7.28 s
Epoch 20/50 |loss: 0.132585| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 12, train time 7.31 s
Epoch 21/50 |loss: 0.132385| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13, train time 7.59 s
Epoch 22/50 |loss: 0.133260| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 14, train time 7.40 s
Epoch 23/50 |loss: 0.134397| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 15, train time 7.32 s
Epoch 24/50 |loss: 0.129336| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 16, train time 7.30 s
Epoch 25/50 |loss: 0.131114| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 17, train time 7.18 s
Epoch 26/50 |loss: 0.130583| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18, train time 7.32 s
Epoch 27/50 |loss: 0.128210| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19, train time 7.28 s
Epoch 28/50 |loss: 0.129600| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 20, train time 7.31 s
Epoch 29/50 |loss: 0.128281| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.22 s
Epoch 30/50 |loss: 0.127395| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 22, train time 7.30 s
Epoch 31/50 |loss: 0.126895| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 23, train time 7.40 s
Epoch 32/50 |loss: 0.127021| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 24, train time 7.32 s
Epoch 33/50 |loss: 0.127182| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 25, train time 7.27 s
Epoch 34/50 |loss: 0.125639| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.41 s
Epoch 35/50 |loss: 0.125212| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2, train time 7.28 s
Epoch 36/50 |loss: 0.124961| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.38 s
Epoch 37/50 |loss: 0.125876| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4, train time 7.37 s
Epoch 38/50 |loss: 0.126360| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 5, train time 7.32 s
Epoch 39/50 |loss: 0.127118| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1, train time 7.40 s
Epoch 40/50 |loss: 0.123786| train set 5.326x speedup, test set 5.560x speedup, val set 5.385x speedup, step: 2, train time 7.12 s
Epoch 41/50 |loss: 0.124372| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.32 s
Epoch 42/50 |loss: 0.123225| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4, train time 7.40 s
Epoch 43/50 |loss: 0.120926| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 5, train time 7.30 s
Epoch 44/50 |loss: 0.124616| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6, train time 7.29 s
Epoch 45/50 |loss: 0.124181| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 7, train time 7.40 s
Epoch 46/50 |loss: 0.122369| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 8, train time 7.02 s
Epoch 47/50 |loss: 0.122482| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 9, train time 7.30 s
Epoch 48/50 |loss: 0.122530| train set 5.205x speedup, test set 5.446x speedup, val set 5.448x speedup, step: 10, train time 7.29 s
Epoch 49/50 |loss: 0.120423| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11, train time 7.30 s
Training per epoch cost 7.332 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 12, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 6, train speedup 5.326, test speedup 5.560, val speedup 5.404
best validation speedup epoch: 39, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:32.084840
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.527722, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.393202| train set 4.437x speedup, test set 5.131x speedup, val set 4.405x speedup, step: 1, train time 8.53 s
Epoch 1/50 |loss: 0.236809| train set 5.226x speedup, test set 5.465x speedup, val set 5.297x speedup, step: 2, train time 7.39 s
Epoch 2/50 |loss: 0.209443| train set 5.196x speedup, test set 5.428x speedup, val set 5.427x speedup, step: 3, train time 7.32 s
Epoch 3/50 |loss: 0.186521| train set 5.060x speedup, test set 5.393x speedup, val set 5.040x speedup, step: 4, train time 7.30 s
Epoch 4/50 |loss: 0.174472| train set 5.197x speedup, test set 5.429x speedup, val set 5.427x speedup, step: 1, train time 7.30 s
Epoch 5/50 |loss: 0.164794| train set 5.199x speedup, test set 5.431x speedup, val set 5.294x speedup, step: 2, train time 7.39 s
Epoch 6/50 |loss: 0.161902| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 3, train time 7.39 s
Epoch 7/50 |loss: 0.152723| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 4, train time 7.30 s
Epoch 8/50 |loss: 0.150325| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5, train time 7.22 s
Epoch 9/50 |loss: 0.149497| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.30 s
Epoch 10/50 |loss: 0.144833| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2, train time 7.31 s
Epoch 11/50 |loss: 0.141234| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 3, train time 7.30 s
Epoch 12/50 |loss: 0.142283| train set 5.268x speedup, test set 5.502x speedup, val set 5.345x speedup, step: 4, train time 7.39 s
Epoch 13/50 |loss: 0.139260| train set 5.251x speedup, test set 5.480x speedup, val set 5.326x speedup, step: 5, train time 7.11 s
Epoch 14/50 |loss: 0.141010| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6, train time 7.40 s
Epoch 15/50 |loss: 0.135672| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 7, train time 7.40 s
Epoch 16/50 |loss: 0.137584| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 8, train time 7.51 s
Epoch 17/50 |loss: 0.135122| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9, train time 7.31 s
Epoch 18/50 |loss: 0.135608| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 10, train time 7.39 s
Epoch 19/50 |loss: 0.133047| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11, train time 7.42 s
Epoch 20/50 |loss: 0.130928| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 12, train time 7.30 s
Epoch 21/50 |loss: 0.131750| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13, train time 7.52 s
Epoch 22/50 |loss: 0.132400| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 14, train time 7.42 s
Epoch 23/50 |loss: 0.132993| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 15, train time 7.41 s
Epoch 24/50 |loss: 0.127702| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16, train time 7.32 s
Epoch 25/50 |loss: 0.129399| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 17, train time 7.40 s
Epoch 26/50 |loss: 0.130325| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 18, train time 7.31 s
Epoch 27/50 |loss: 0.129110| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19, train time 7.30 s
Epoch 28/50 |loss: 0.127923| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20, train time 7.51 s
Epoch 29/50 |loss: 0.128407| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.41 s
Epoch 30/50 |loss: 0.126628| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 22, train time 7.29 s
Epoch 31/50 |loss: 0.126004| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 23, train time 7.40 s
Epoch 32/50 |loss: 0.125957| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 24, train time 7.32 s
Epoch 33/50 |loss: 0.125831| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 25, train time 7.40 s
Epoch 34/50 |loss: 0.126193| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.30 s
Epoch 35/50 |loss: 0.124379| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2, train time 7.31 s
Epoch 36/50 |loss: 0.124304| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.39 s
Epoch 37/50 |loss: 0.125612| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4, train time 7.32 s
Epoch 38/50 |loss: 0.125851| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 5, train time 7.30 s
Epoch 39/50 |loss: 0.126196| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.31 s
Epoch 40/50 |loss: 0.122295| train set 5.266x speedup, test set 5.498x speedup, val set 5.481x speedup, step: 2, train time 7.40 s
Epoch 41/50 |loss: 0.124715| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.40 s
Epoch 42/50 |loss: 0.121781| train set 5.319x speedup, test set 5.555x speedup, val set 5.398x speedup, step: 4, train time 7.43 s
Epoch 43/50 |loss: 0.121506| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 5, train time 7.48 s
Epoch 44/50 |loss: 0.124037| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6, train time 7.31 s
Epoch 45/50 |loss: 0.122771| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 7, train time 7.40 s
Epoch 46/50 |loss: 0.122973| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 8, train time 7.31 s
Epoch 47/50 |loss: 0.122981| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9, train time 7.49 s
Epoch 48/50 |loss: 0.122250| train set 5.210x speedup, test set 5.441x speedup, val set 5.459x speedup, step: 10, train time 7.31 s
Epoch 49/50 |loss: 0.120082| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11, train time 7.40 s
Training per epoch cost 7.383 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 14, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 14, train speedup 5.326, test speedup 5.559, val speedup 5.403
best validation speedup epoch: 39, train speedup 5.266, test speedup 5.496, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:34.186357
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.549918, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.394254| train set 4.645x speedup, test set 4.830x speedup, val set 4.712x speedup, step: 1, train time 8.63 s
Epoch 1/50 |loss: 0.243863| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 2, train time 7.40 s
Epoch 2/50 |loss: 0.207977| train set 5.196x speedup, test set 5.430x speedup, val set 5.428x speedup, step: 3, train time 7.32 s
Epoch 3/50 |loss: 0.187471| train set 5.060x speedup, test set 5.393x speedup, val set 5.040x speedup, step: 4, train time 7.20 s
Epoch 4/50 |loss: 0.176727| train set 5.197x speedup, test set 5.429x speedup, val set 5.427x speedup, step: 1, train time 7.41 s
Epoch 5/50 |loss: 0.164665| train set 5.199x speedup, test set 5.431x speedup, val set 5.294x speedup, step: 2, train time 7.40 s
Epoch 6/50 |loss: 0.160300| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.32 s
Epoch 7/50 |loss: 0.155295| train set 5.251x speedup, test set 5.478x speedup, val set 5.326x speedup, step: 4, train time 7.42 s
Epoch 8/50 |loss: 0.151016| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 5, train time 7.29 s
Epoch 9/50 |loss: 0.148715| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1, train time 7.41 s
Epoch 10/50 |loss: 0.148481| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 2, train time 7.27 s
Epoch 11/50 |loss: 0.142841| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 3, train time 7.32 s
Epoch 12/50 |loss: 0.143327| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 4, train time 7.51 s
Epoch 13/50 |loss: 0.142299| train set 5.251x speedup, test set 5.478x speedup, val set 5.326x speedup, step: 5, train time 7.40 s
Epoch 14/50 |loss: 0.141817| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 6, train time 7.40 s
Epoch 15/50 |loss: 0.136701| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 7, train time 7.29 s
Epoch 16/50 |loss: 0.135531| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 8, train time 7.29 s
Epoch 17/50 |loss: 0.136116| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9, train time 7.39 s
Epoch 18/50 |loss: 0.136342| train set 5.249x speedup, test set 5.478x speedup, val set 5.460x speedup, step: 10, train time 7.40 s
Epoch 19/50 |loss: 0.131489| train set 5.267x speedup, test set 5.509x speedup, val set 5.360x speedup, step: 11, train time 7.29 s
Epoch 20/50 |loss: 0.131479| train set 5.251x speedup, test set 5.478x speedup, val set 5.326x speedup, step: 12, train time 7.32 s
Epoch 21/50 |loss: 0.132147| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13, train time 7.59 s
Epoch 22/50 |loss: 0.134088| train set 5.326x speedup, test set 5.561x speedup, val set 5.384x speedup, step: 14, train time 7.51 s
Epoch 23/50 |loss: 0.134511| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 15, train time 7.42 s
Epoch 24/50 |loss: 0.131553| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 16, train time 7.40 s
Epoch 25/50 |loss: 0.131306| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 17, train time 7.38 s
Epoch 26/50 |loss: 0.132164| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18, train time 7.32 s
Epoch 27/50 |loss: 0.128354| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19, train time 7.41 s
Epoch 28/50 |loss: 0.129288| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20, train time 7.32 s
Epoch 29/50 |loss: 0.127919| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.42 s
Epoch 30/50 |loss: 0.126761| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 22, train time 7.50 s
Epoch 31/50 |loss: 0.126400| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 23, train time 7.42 s
Epoch 32/50 |loss: 0.126112| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 24, train time 7.58 s
Epoch 33/50 |loss: 0.126936| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 25, train time 7.51 s
Epoch 34/50 |loss: 0.127111| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 26, train time 7.51 s
Epoch 35/50 |loss: 0.124474| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 27, train time 7.40 s
Epoch 36/50 |loss: 0.125641| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 28, train time 7.30 s
Epoch 37/50 |loss: 0.125922| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 29, train time 7.30 s
Epoch 38/50 |loss: 0.126277| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 30, train time 7.40 s
Epoch 39/50 |loss: 0.126603| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 31, train time 7.42 s
Epoch 40/50 |loss: 0.124085| train set 5.326x speedup, test set 5.560x speedup, val set 5.385x speedup, step: 32, train time 7.61 s
Epoch 41/50 |loss: 0.125535| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 33, train time 7.52 s
Epoch 42/50 |loss: 0.122747| train set 5.319x speedup, test set 5.555x speedup, val set 5.398x speedup, step: 34, train time 7.52 s
Epoch 43/50 |loss: 0.121055| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 35, train time 7.50 s
Epoch 44/50 |loss: 0.123750| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 36, train time 7.59 s
Epoch 45/50 |loss: 0.123748| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 37, train time 7.48 s
Epoch 46/50 |loss: 0.123973| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 38, train time 7.62 s
Epoch 47/50 |loss: 0.122696| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 39, train time 7.40 s
Epoch 48/50 |loss: 0.121807| train set 5.210x speedup, test set 5.439x speedup, val set 5.459x speedup, step: 40, train time 7.31 s
Epoch 49/50 |loss: 0.119992| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 41, train time 7.47 s
Training per epoch cost 7.436 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 22, train speedup 5.326, test speedup 5.561, val speedup 5.384
best test speedup epoch: 16, train speedup 5.325, test speedup 5.566, val speedup 5.399
best validation speedup epoch: 9, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:36.964508
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.531514, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.394359| train set 4.645x speedup, test set 4.830x speedup, val set 4.712x speedup, step: 1, train time 8.76 s
Epoch 1/50 |loss: 0.240565| train set 5.255x speedup, test set 5.487x speedup, val set 5.332x speedup, step: 2, train time 7.49 s
Epoch 2/50 |loss: 0.209102| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 3, train time 7.59 s
Epoch 3/50 |loss: 0.186238| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4, train time 7.61 s
Epoch 4/50 |loss: 0.174615| train set 5.255x speedup, test set 5.489x speedup, val set 5.333x speedup, step: 1, train time 7.49 s
Epoch 5/50 |loss: 0.169143| train set 5.268x speedup, test set 5.501x speedup, val set 5.365x speedup, step: 2, train time 7.49 s
Epoch 6/50 |loss: 0.158926| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 3, train time 7.61 s
Epoch 7/50 |loss: 0.153579| train set 5.250x speedup, test set 5.478x speedup, val set 5.326x speedup, step: 4, train time 7.51 s
Epoch 8/50 |loss: 0.149366| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 5, train time 7.51 s
Epoch 9/50 |loss: 0.148107| train set 5.196x speedup, test set 5.427x speedup, val set 5.427x speedup, step: 1, train time 7.59 s
Epoch 10/50 |loss: 0.148032| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 2, train time 7.56 s
Epoch 11/50 |loss: 0.143852| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 3, train time 7.42 s
Epoch 12/50 |loss: 0.140640| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 4, train time 7.49 s
Epoch 13/50 |loss: 0.140657| train set 5.251x speedup, test set 5.480x speedup, val set 5.326x speedup, step: 5, train time 7.61 s
Epoch 14/50 |loss: 0.139302| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 6, train time 7.52 s
Epoch 15/50 |loss: 0.137331| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 7, train time 7.50 s
Epoch 16/50 |loss: 0.136553| train set 5.267x speedup, test set 5.507x speedup, val set 5.360x speedup, step: 8, train time 7.41 s
Epoch 17/50 |loss: 0.134467| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9, train time 7.62 s
Epoch 18/50 |loss: 0.136837| train set 5.308x speedup, test set 5.538x speedup, val set 5.365x speedup, step: 10, train time 7.51 s
Epoch 19/50 |loss: 0.131781| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 11, train time 7.52 s
Epoch 20/50 |loss: 0.131756| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 12, train time 7.70 s
Epoch 21/50 |loss: 0.132149| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13, train time 7.72 s
Epoch 22/50 |loss: 0.133667| train set 5.326x speedup, test set 5.561x speedup, val set 5.384x speedup, step: 14, train time 7.51 s
Epoch 23/50 |loss: 0.133932| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 15, train time 7.51 s
Epoch 24/50 |loss: 0.129726| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 16, train time 7.52 s
Epoch 25/50 |loss: 0.130490| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 17, train time 7.49 s
Epoch 26/50 |loss: 0.131707| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 18, train time 7.51 s
Epoch 27/50 |loss: 0.129810| train set 5.308x speedup, test set 5.538x speedup, val set 5.365x speedup, step: 19, train time 7.62 s
Epoch 28/50 |loss: 0.130168| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20, train time 7.51 s
Epoch 29/50 |loss: 0.128447| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.70 s
Epoch 30/50 |loss: 0.126531| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 22, train time 7.50 s
Epoch 31/50 |loss: 0.127394| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 23, train time 7.52 s
Epoch 32/50 |loss: 0.125037| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 24, train time 7.58 s
Epoch 33/50 |loss: 0.126513| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 25, train time 7.49 s
Epoch 34/50 |loss: 0.126194| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.52 s
Epoch 35/50 |loss: 0.124485| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 2, train time 7.61 s
Epoch 36/50 |loss: 0.124860| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.41 s
Epoch 37/50 |loss: 0.125698| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4, train time 7.59 s
Epoch 38/50 |loss: 0.126084| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 5, train time 7.58 s
Epoch 39/50 |loss: 0.125582| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.51 s
Epoch 40/50 |loss: 0.123026| train set 5.326x speedup, test set 5.561x speedup, val set 5.385x speedup, step: 2, train time 7.50 s
Epoch 41/50 |loss: 0.126025| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 3, train time 7.50 s
Epoch 42/50 |loss: 0.123013| train set 5.325x speedup, test set 5.567x speedup, val set 5.399x speedup, step: 4, train time 7.61 s
Epoch 43/50 |loss: 0.120984| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 5, train time 7.59 s
Epoch 44/50 |loss: 0.123507| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6, train time 7.52 s
Epoch 45/50 |loss: 0.123150| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 7, train time 7.58 s
Epoch 46/50 |loss: 0.123407| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 8, train time 7.43 s
Epoch 47/50 |loss: 0.121125| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 9, train time 7.51 s
Epoch 48/50 |loss: 0.121701| train set 5.266x speedup, test set 5.497x speedup, val set 5.500x speedup, step: 10, train time 7.60 s
Epoch 49/50 |loss: 0.120523| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11, train time 7.48 s
Training per epoch cost 7.565 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 22, train speedup 5.326, test speedup 5.561, val speedup 5.384
best test speedup epoch: 42, train speedup 5.325, test speedup 5.567, val speedup 5.399
best validation speedup epoch: 39, train speedup 5.266, test speedup 5.496, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:43.486805
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.528541, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.394226| train set 4.645x speedup, test set 4.830x speedup, val set 4.712x speedup, step: 1, train time 8.45 s
Epoch 1/50 |loss: 0.240849| train set 5.192x speedup, test set 5.426x speedup, val set 5.290x speedup, step: 2, train time 7.41 s
Epoch 2/50 |loss: 0.210396| train set 5.091x speedup, test set 5.344x speedup, val set 5.182x speedup, step: 3, train time 7.61 s
Epoch 3/50 |loss: 0.187463| train set 5.060x speedup, test set 5.392x speedup, val set 5.039x speedup, step: 4, train time 7.40 s
Epoch 4/50 |loss: 0.177320| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1, train time 7.42 s
Epoch 5/50 |loss: 0.164462| train set 5.199x speedup, test set 5.432x speedup, val set 5.295x speedup, step: 2, train time 7.21 s
Epoch 6/50 |loss: 0.161129| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 3, train time 7.41 s
Epoch 7/50 |loss: 0.154944| train set 5.250x speedup, test set 5.478x speedup, val set 5.326x speedup, step: 4, train time 7.30 s
Epoch 8/50 |loss: 0.148708| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 5, train time 7.32 s
Epoch 9/50 |loss: 0.149648| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 6, train time 7.60 s
Epoch 10/50 |loss: 0.147599| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 7, train time 7.41 s
Epoch 11/50 |loss: 0.143370| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 8, train time 7.51 s
Epoch 12/50 |loss: 0.142231| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 9, train time 7.50 s
Epoch 13/50 |loss: 0.142239| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 10, train time 7.41 s
Epoch 14/50 |loss: 0.140177| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11, train time 7.41 s
Epoch 15/50 |loss: 0.135611| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 12, train time 7.60 s
Epoch 16/50 |loss: 0.135674| train set 5.325x speedup, test set 5.566x speedup, val set 5.399x speedup, step: 13, train time 7.61 s
Epoch 17/50 |loss: 0.135365| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 14, train time 7.52 s
Epoch 18/50 |loss: 0.134484| train set 5.308x speedup, test set 5.538x speedup, val set 5.365x speedup, step: 15, train time 7.60 s
Epoch 19/50 |loss: 0.130652| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16, train time 7.72 s
Epoch 20/50 |loss: 0.130749| train set 5.264x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 17, train time 7.60 s
Epoch 21/50 |loss: 0.132429| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 18, train time 7.89 s
Epoch 22/50 |loss: 0.133303| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 19, train time 7.71 s
Epoch 23/50 |loss: 0.133842| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 20, train time 7.79 s
Epoch 24/50 |loss: 0.128843| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.61 s
Epoch 25/50 |loss: 0.130506| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 22, train time 7.52 s
Epoch 26/50 |loss: 0.129301| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 23, train time 7.49 s
Epoch 27/50 |loss: 0.127791| train set 5.308x speedup, test set 5.537x speedup, val set 5.364x speedup, step: 24, train time 7.61 s
Epoch 28/50 |loss: 0.129157| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 25, train time 7.42 s
Epoch 29/50 |loss: 0.127341| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 26, train time 7.50 s
Epoch 30/50 |loss: 0.127138| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 27, train time 7.60 s
Epoch 31/50 |loss: 0.127427| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 28, train time 7.49 s
Epoch 32/50 |loss: 0.126153| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 29, train time 7.49 s
Epoch 33/50 |loss: 0.126428| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 30, train time 7.61 s
Epoch 34/50 |loss: 0.125826| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 1, train time 7.50 s
Epoch 35/50 |loss: 0.125088| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2, train time 7.59 s
Epoch 36/50 |loss: 0.124655| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.60 s
Epoch 37/50 |loss: 0.125186| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4, train time 7.51 s
Epoch 38/50 |loss: 0.125406| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 5, train time 7.51 s
Epoch 39/50 |loss: 0.125194| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 6, train time 7.61 s
Epoch 40/50 |loss: 0.123846| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 7, train time 7.71 s
Epoch 41/50 |loss: 0.125995| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 8, train time 7.62 s
Epoch 42/50 |loss: 0.123580| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 9, train time 7.78 s
Epoch 43/50 |loss: 0.120920| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 10, train time 7.60 s
Epoch 44/50 |loss: 0.124130| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11, train time 7.62 s
Epoch 45/50 |loss: 0.122559| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 12, train time 7.50 s
Epoch 46/50 |loss: 0.122879| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 13, train time 7.72 s
Epoch 47/50 |loss: 0.121056| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 14, train time 7.52 s
Epoch 48/50 |loss: 0.121568| train set 5.261x speedup, test set 5.503x speedup, val set 5.488x speedup, step: 15, train time 7.51 s
Epoch 49/50 |loss: 0.120264| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 16, train time 7.68 s
Training per epoch cost 7.566 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 14, train speedup 5.326, test speedup 5.559, val speedup 5.403
best test speedup epoch: 16, train speedup 5.325, test speedup 5.566, val speedup 5.399
best validation speedup epoch: 34, train speedup 5.266, test speedup 5.498, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:43.301739
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

load TPCH...
[0, 1, 2, 4, 5, 9] [6, 8] [7 3]
[0, 1, 3, 4, 7, 9] [5, 2] [6 8]
[0, 2, 5, 6, 7, 8] [1, 3] [4 9]
[0, 2, 3, 4, 6, 7, 8] [1, 9] [5 5]
[0, 3, 4, 5, 6, 9] [7, 2] [8 1]
[0, 1, 3, 4, 6, 8] [5, 9] [2 7]
[0, 2, 4, 5, 7, 8, 9] [1, 6] [3 3]
[1, 3, 4, 5, 7, 8] [0, 2] [9 6]
[2, 3, 4, 6, 7, 8] [1, 0] [5 9]
[0, 1, 4, 5, 6, 7] [3, 9] [8 2]
[0, 1, 2, 3, 8, 9] [4, 6] [7 5]
[0, 2, 3, 4, 5, 6] [9, 8] [1 7]
[0, 3, 4, 6, 8, 9] [1, 2] [5 7]
[1, 3, 4, 5, 8, 9] [0, 7] [6 2]
[0, 1, 4, 6, 7, 8] [3, 2] [9 5]
[1, 3, 4, 6, 7, 9] [8, 2] [5 0]
[0, 2, 4, 6, 7, 9] [8, 5] [3 1]
[0, 1, 2, 4, 8, 9] [5, 3] [7 6]
[1, 2, 4, 5, 6, 8] [7, 9] [3 0]
[1, 4, 5, 7, 8, 9] [2, 6] [0 3]
load TPCH succ
train, test, validation (122, 49) (40, 49) (40, 49)
(122, 49)
(122, 49)
construct training samples cost 0:00:00.543456, and there are 11964 training samples
in channel 9
Epoch 0/50 |loss: 0.394450| train set 4.814x speedup, test set 5.078x speedup, val set 4.852x speedup, step: 1, train time 8.56 s
Epoch 1/50 |loss: 0.237953| train set 4.938x speedup, test set 5.242x speedup, val set 5.052x speedup, step: 2, train time 7.32 s
Epoch 2/50 |loss: 0.209339| train set 5.026x speedup, test set 5.279x speedup, val set 5.117x speedup, step: 3, train time 7.39 s
Epoch 3/50 |loss: 0.186551| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4, train time 7.61 s
Epoch 4/50 |loss: 0.173853| train set 5.210x speedup, test set 5.441x speedup, val set 5.459x speedup, step: 1, train time 7.52 s
Epoch 5/50 |loss: 0.165532| train set 5.199x speedup, test set 5.431x speedup, val set 5.294x speedup, step: 2, train time 7.40 s
Epoch 6/50 |loss: 0.161437| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 3, train time 7.42 s
Epoch 7/50 |loss: 0.152187| train set 5.268x speedup, test set 5.498x speedup, val set 5.364x speedup, step: 4, train time 7.43 s
Epoch 8/50 |loss: 0.149802| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 5, train time 7.39 s
Epoch 9/50 |loss: 0.147768| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.41 s
Epoch 10/50 |loss: 0.147792| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 2, train time 7.38 s
Epoch 11/50 |loss: 0.142749| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 3, train time 7.51 s
Epoch 12/50 |loss: 0.141695| train set 5.326x speedup, test set 5.561x speedup, val set 5.384x speedup, step: 4, train time 7.41 s
Epoch 13/50 |loss: 0.140450| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 5, train time 7.50 s
Epoch 14/50 |loss: 0.141243| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 6, train time 7.49 s
Epoch 15/50 |loss: 0.134686| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 7, train time 7.51 s
Epoch 16/50 |loss: 0.136545| train set 5.267x speedup, test set 5.507x speedup, val set 5.360x speedup, step: 8, train time 7.51 s
Epoch 17/50 |loss: 0.135190| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9, train time 7.51 s
Epoch 18/50 |loss: 0.136558| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 10, train time 7.52 s
Epoch 19/50 |loss: 0.130767| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 11, train time 7.49 s
Epoch 20/50 |loss: 0.130203| train set 5.268x speedup, test set 5.499x speedup, val set 5.364x speedup, step: 12, train time 7.69 s
Epoch 21/50 |loss: 0.130541| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 13, train time 7.79 s
Epoch 22/50 |loss: 0.133045| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 14, train time 7.68 s
Epoch 23/50 |loss: 0.132250| train set 5.266x speedup, test set 5.498x speedup, val set 5.480x speedup, step: 15, train time 7.60 s
Epoch 24/50 |loss: 0.128687| train set 5.268x speedup, test set 5.500x speedup, val set 5.364x speedup, step: 16, train time 7.62 s
Epoch 25/50 |loss: 0.129090| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 17, train time 7.61 s
Epoch 26/50 |loss: 0.129679| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 18, train time 7.60 s
Epoch 27/50 |loss: 0.127240| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 19, train time 7.53 s
Epoch 28/50 |loss: 0.129362| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 20, train time 7.51 s
Epoch 29/50 |loss: 0.126877| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 21, train time 7.67 s
Epoch 30/50 |loss: 0.125618| train set 5.326x speedup, test set 5.558x speedup, val set 5.404x speedup, step: 22, train time 7.71 s
Epoch 31/50 |loss: 0.126657| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 23, train time 7.82 s
Epoch 32/50 |loss: 0.124540| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 24, train time 7.61 s
Epoch 33/50 |loss: 0.124154| train set 5.210x speedup, test set 5.440x speedup, val set 5.440x speedup, step: 25, train time 7.71 s
Epoch 34/50 |loss: 0.127086| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.60 s
Epoch 35/50 |loss: 0.123986| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 2, train time 7.57 s
Epoch 36/50 |loss: 0.125199| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.60 s
Epoch 37/50 |loss: 0.125182| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 4, train time 7.61 s
Epoch 38/50 |loss: 0.125561| train set 5.265x speedup, test set 5.501x speedup, val set 5.495x speedup, step: 5, train time 7.62 s
Epoch 39/50 |loss: 0.124400| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 1, train time 7.52 s
Epoch 40/50 |loss: 0.122714| train set 5.326x speedup, test set 5.560x speedup, val set 5.404x speedup, step: 2, train time 7.68 s
Epoch 41/50 |loss: 0.123907| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 3, train time 7.77 s
Epoch 42/50 |loss: 0.121861| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 4, train time 7.71 s
Epoch 43/50 |loss: 0.121384| train set 5.326x speedup, test set 5.559x speedup, val set 5.384x speedup, step: 5, train time 7.42 s
Epoch 44/50 |loss: 0.122868| train set 5.326x speedup, test set 5.559x speedup, val set 5.403x speedup, step: 6, train time 7.50 s
Epoch 45/50 |loss: 0.122426| train set 5.266x speedup, test set 5.498x speedup, val set 5.500x speedup, step: 7, train time 7.52 s
Epoch 46/50 |loss: 0.122269| train set 5.266x speedup, test set 5.496x speedup, val set 5.500x speedup, step: 8, train time 7.48 s
Epoch 47/50 |loss: 0.121239| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 9, train time 7.60 s
Epoch 48/50 |loss: 0.121468| train set 5.266x speedup, test set 5.500x speedup, val set 5.480x speedup, step: 10, train time 7.48 s
Epoch 49/50 |loss: 0.120374| train set 5.326x speedup, test set 5.557x speedup, val set 5.403x speedup, step: 11, train time 7.60 s
Training per epoch cost 7.574 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 16.078s, pg runtime 32.939s, speedup 2.049x
18, opt runtime 6.149s, model runtime 8.538s, pg runtime 30.760s, speedup 3.603x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 12, train speedup 5.326, test speedup 5.561, val speedup 5.384
best test speedup epoch: 12, train speedup 5.326, test speedup 5.561, val speedup 5.384
best validation speedup epoch: 39, train speedup 5.266, test speedup 5.496, val speedup 5.500
last model at epoch 49, train speedup 5.326, test speedup 5.557, val speedup 5.403
execution cost 0:06:44.406284
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.773575, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.393609| train set 4.265x speedup, test set 4.662x speedup, val set 4.537x speedup, step: 1, train time 8.47 s
Epoch 1/50 |loss: 0.244490| train set 5.136x speedup, test set 5.381x speedup, val set 5.413x speedup, step: 2, train time 7.39 s
Epoch 2/50 |loss: 0.205634| train set 5.240x speedup, test set 5.539x speedup, val set 5.614x speedup, step: 3, train time 7.20 s
Epoch 3/50 |loss: 0.183669| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 4, train time 7.19 s
Epoch 4/50 |loss: 0.176401| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 1, train time 7.18 s
Epoch 5/50 |loss: 0.170504| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.08 s
Epoch 6/50 |loss: 0.164433| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 3, train time 7.11 s
Epoch 7/50 |loss: 0.155446| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.18 s
Epoch 8/50 |loss: 0.149208| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.21 s
Epoch 9/50 |loss: 0.152016| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 6, train time 7.11 s
Epoch 10/50 |loss: 0.147665| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 7, train time 7.19 s
Epoch 11/50 |loss: 0.143605| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 8, train time 7.10 s
Epoch 12/50 |loss: 0.138574| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 9, train time 7.08 s
Epoch 13/50 |loss: 0.140517| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 10, train time 7.18 s
Epoch 14/50 |loss: 0.138977| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.03 s
Epoch 15/50 |loss: 0.139105| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 2, train time 7.37 s
Epoch 16/50 |loss: 0.134986| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.20 s
Epoch 17/50 |loss: 0.134127| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.30 s
Epoch 18/50 |loss: 0.136575| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 5, train time 7.32 s
Epoch 19/50 |loss: 0.133507| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.27 s
Epoch 20/50 |loss: 0.134333| train set 5.261x speedup, test set 5.494x speedup, val set 5.527x speedup, step: 2, train time 7.31 s
Epoch 21/50 |loss: 0.129323| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.30 s
Epoch 22/50 |loss: 0.129450| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.39 s
Epoch 23/50 |loss: 0.127702| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.20 s
Epoch 24/50 |loss: 0.130259| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.31 s
Epoch 25/50 |loss: 0.127907| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.39 s
Epoch 26/50 |loss: 0.129515| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.40 s
Epoch 27/50 |loss: 0.124340| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.13 s
Epoch 28/50 |loss: 0.126798| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.43 s
Epoch 29/50 |loss: 0.126485| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.33 s
Epoch 30/50 |loss: 0.122818| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.20 s
Epoch 31/50 |loss: 0.124245| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.52 s
Epoch 32/50 |loss: 0.126133| train set 5.253x speedup, test set 5.561x speedup, val set 5.657x speedup, step: 9, train time 7.37 s
Epoch 33/50 |loss: 0.124714| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.40 s
Epoch 34/50 |loss: 0.124389| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.51 s
Epoch 35/50 |loss: 0.122210| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.40 s
Epoch 36/50 |loss: 0.125403| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.40 s
Epoch 37/50 |loss: 0.123230| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.31 s
Epoch 38/50 |loss: 0.121476| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.47 s
Epoch 39/50 |loss: 0.123104| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.38 s
Epoch 40/50 |loss: 0.124018| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.39 s
Epoch 41/50 |loss: 0.121259| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 8, train time 7.30 s
Epoch 42/50 |loss: 0.120689| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 9, train time 7.49 s
Epoch 43/50 |loss: 0.121396| train set 5.179x speedup, test set 5.500x speedup, val set 5.679x speedup, step: 10, train time 7.40 s
Epoch 44/50 |loss: 0.121333| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.39 s
Epoch 45/50 |loss: 0.119928| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.36 s
Epoch 46/50 |loss: 0.120774| train set 5.259x speedup, test set 5.555x speedup, val set 5.625x speedup, step: 3, train time 7.30 s
Epoch 47/50 |loss: 0.121464| train set 5.253x speedup, test set 5.561x speedup, val set 5.657x speedup, step: 4, train time 7.39 s
Epoch 48/50 |loss: 0.118987| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.29 s
Epoch 49/50 |loss: 0.122281| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.58 s
Training per epoch cost 7.323 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 5, train speedup 5.263, test speedup 5.498, val speedup 5.539
best test speedup epoch: 32, train speedup 5.253, test speedup 5.561, val speedup 5.657
best validation speedup epoch: 44, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:33.670627
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.783426, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.393156| train set 3.959x speedup, test set 4.561x speedup, val set 4.053x speedup, step: 1, train time 8.64 s
Epoch 1/50 |loss: 0.243893| train set 5.193x speedup, test set 5.427x speedup, val set 5.467x speedup, step: 2, train time 7.20 s
Epoch 2/50 |loss: 0.205691| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 3, train time 7.10 s
Epoch 3/50 |loss: 0.183100| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 4, train time 7.12 s
Epoch 4/50 |loss: 0.181906| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 1, train time 7.21 s
Epoch 5/50 |loss: 0.172208| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.10 s
Epoch 6/50 |loss: 0.165866| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 3, train time 7.19 s
Epoch 7/50 |loss: 0.156067| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.01 s
Epoch 8/50 |loss: 0.153740| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.07 s
Epoch 9/50 |loss: 0.152045| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.23 s
Epoch 10/50 |loss: 0.146231| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 7, train time 7.01 s
Epoch 11/50 |loss: 0.144070| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 8, train time 7.18 s
Epoch 12/50 |loss: 0.138930| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 9, train time 7.11 s
Epoch 13/50 |loss: 0.138553| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.08 s
Epoch 14/50 |loss: 0.138621| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 1, train time 7.32 s
Epoch 15/50 |loss: 0.137775| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 2, train time 7.17 s
Epoch 16/50 |loss: 0.135094| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 3, train time 7.20 s
Epoch 17/50 |loss: 0.133680| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 4, train time 7.28 s
Epoch 18/50 |loss: 0.135260| train set 5.254x speedup, test set 5.500x speedup, val set 5.558x speedup, step: 5, train time 7.32 s
Epoch 19/50 |loss: 0.133495| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 6, train time 7.21 s
Epoch 20/50 |loss: 0.133541| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.22 s
Epoch 21/50 |loss: 0.130989| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 8, train time 7.31 s
Epoch 22/50 |loss: 0.129266| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 9, train time 7.30 s
Epoch 23/50 |loss: 0.127413| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.42 s
Epoch 24/50 |loss: 0.130278| train set 5.253x speedup, test set 5.561x speedup, val set 5.657x speedup, step: 1, train time 7.40 s
Epoch 25/50 |loss: 0.126848| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.59 s
Epoch 26/50 |loss: 0.127620| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.31 s
Epoch 27/50 |loss: 0.123664| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.61 s
Epoch 28/50 |loss: 0.125655| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.48 s
Epoch 29/50 |loss: 0.125109| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.32 s
Epoch 30/50 |loss: 0.124751| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.38 s
Epoch 31/50 |loss: 0.123967| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.38 s
Epoch 32/50 |loss: 0.125564| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 9, train time 7.31 s
Epoch 33/50 |loss: 0.125570| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 10, train time 7.39 s
Epoch 34/50 |loss: 0.124138| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 11, train time 7.31 s
Epoch 35/50 |loss: 0.121621| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 12, train time 7.41 s
Epoch 36/50 |loss: 0.123735| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 13, train time 7.39 s
Epoch 37/50 |loss: 0.122931| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 14, train time 7.49 s
Epoch 38/50 |loss: 0.123142| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 15, train time 7.38 s
Epoch 39/50 |loss: 0.121635| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 16, train time 7.50 s
Epoch 40/50 |loss: 0.122716| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 17, train time 7.57 s
Epoch 41/50 |loss: 0.120157| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 18, train time 7.22 s
Epoch 42/50 |loss: 0.121062| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 19, train time 7.40 s
Epoch 43/50 |loss: 0.119529| train set 5.179x speedup, test set 5.500x speedup, val set 5.679x speedup, step: 20, train time 7.48 s
Epoch 44/50 |loss: 0.121221| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 21, train time 7.41 s
Epoch 45/50 |loss: 0.118858| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 22, train time 7.29 s
Epoch 46/50 |loss: 0.120230| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 23, train time 7.40 s
Epoch 47/50 |loss: 0.121273| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 24, train time 7.47 s
Epoch 48/50 |loss: 0.116807| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 25, train time 7.18 s
Epoch 49/50 |loss: 0.122913| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 26, train time 7.30 s
Training per epoch cost 7.327 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 7.202s, pg runtime 31.019s, speedup 4.307x
08, opt runtime 7.377s, model runtime 7.377s, pg runtime 28.655s, speedup 3.885x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 33, train speedup 5.264, test speedup 5.499, val speedup 5.539
best test speedup epoch: 24, train speedup 5.253, test speedup 5.561, val speedup 5.657
best validation speedup epoch: 24, train speedup 5.253, test speedup 5.561, val speedup 5.657
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:33.969972
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.776442, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397249| train set 4.422x speedup, test set 4.683x speedup, val set 4.587x speedup, step: 1, train time 8.59 s
Epoch 1/50 |loss: 0.244420| train set 5.069x speedup, test set 5.315x speedup, val set 5.344x speedup, step: 2, train time 7.40 s
Epoch 2/50 |loss: 0.204310| train set 5.241x speedup, test set 5.477x speedup, val set 5.517x speedup, step: 3, train time 7.11 s
Epoch 3/50 |loss: 0.183378| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 4, train time 7.21 s
Epoch 4/50 |loss: 0.181471| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 1, train time 7.29 s
Epoch 5/50 |loss: 0.168399| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 2, train time 7.19 s
Epoch 6/50 |loss: 0.161665| train set 5.054x speedup, test set 5.424x speedup, val set 5.454x speedup, step: 3, train time 7.31 s
Epoch 7/50 |loss: 0.157533| train set 5.162x speedup, test set 5.468x speedup, val set 5.482x speedup, step: 4, train time 7.17 s
Epoch 8/50 |loss: 0.150858| train set 5.261x speedup, test set 5.494x speedup, val set 5.527x speedup, step: 5, train time 7.37 s
Epoch 9/50 |loss: 0.151175| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 1, train time 7.22 s
Epoch 10/50 |loss: 0.148078| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.27 s
Epoch 11/50 |loss: 0.143219| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.28 s
Epoch 12/50 |loss: 0.138644| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.27 s
Epoch 13/50 |loss: 0.138785| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 5, train time 7.40 s
Epoch 14/50 |loss: 0.138199| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 1, train time 7.32 s
Epoch 15/50 |loss: 0.136514| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 2, train time 7.31 s
Epoch 16/50 |loss: 0.135025| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.31 s
Epoch 17/50 |loss: 0.134380| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.28 s
Epoch 18/50 |loss: 0.135929| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 5, train time 7.40 s
Epoch 19/50 |loss: 0.133956| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.21 s
Epoch 20/50 |loss: 0.133659| train set 5.263x speedup, test set 5.498x speedup, val set 5.528x speedup, step: 2, train time 7.22 s
Epoch 21/50 |loss: 0.128706| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.31 s
Epoch 22/50 |loss: 0.129262| train set 5.257x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.28 s
Epoch 23/50 |loss: 0.127885| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.43 s
Epoch 24/50 |loss: 0.129802| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.40 s
Epoch 25/50 |loss: 0.128022| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.30 s
Epoch 26/50 |loss: 0.130263| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.47 s
Epoch 27/50 |loss: 0.125478| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.49 s
Epoch 28/50 |loss: 0.126214| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.32 s
Epoch 29/50 |loss: 0.125071| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.40 s
Epoch 30/50 |loss: 0.125083| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.41 s
Epoch 31/50 |loss: 0.124123| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.29 s
Epoch 32/50 |loss: 0.124523| train set 5.253x speedup, test set 5.561x speedup, val set 5.657x speedup, step: 9, train time 7.48 s
Epoch 33/50 |loss: 0.124555| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.40 s
Epoch 34/50 |loss: 0.123329| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.40 s
Epoch 35/50 |loss: 0.121566| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.50 s
Epoch 36/50 |loss: 0.124534| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.48 s
Epoch 37/50 |loss: 0.122959| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.31 s
Epoch 38/50 |loss: 0.122520| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.38 s
Epoch 39/50 |loss: 0.122275| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.47 s
Epoch 40/50 |loss: 0.122476| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.52 s
Epoch 41/50 |loss: 0.120420| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 8, train time 7.42 s
Epoch 42/50 |loss: 0.119301| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 9, train time 7.50 s
Epoch 43/50 |loss: 0.121949| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 10, train time 7.39 s
Epoch 44/50 |loss: 0.120783| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.41 s
Epoch 45/50 |loss: 0.118250| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.48 s
Epoch 46/50 |loss: 0.120238| train set 5.259x speedup, test set 5.555x speedup, val set 5.625x speedup, step: 3, train time 7.50 s
Epoch 47/50 |loss: 0.121538| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.46 s
Epoch 48/50 |loss: 0.117890| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.50 s
Epoch 49/50 |loss: 0.120894| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.32 s
Training per epoch cost 7.383 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 13, train speedup 5.264, test speedup 5.499, val speedup 5.539
best test speedup epoch: 32, train speedup 5.253, test speedup 5.561, val speedup 5.657
best validation speedup epoch: 44, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:36.029110
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.770141, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.398565| train set 4.940x speedup, test set 5.084x speedup, val set 5.167x speedup, step: 1, train time 8.39 s
Epoch 1/50 |loss: 0.241284| train set 5.069x speedup, test set 5.315x speedup, val set 5.344x speedup, step: 2, train time 7.18 s
Epoch 2/50 |loss: 0.204205| train set 5.241x speedup, test set 5.477x speedup, val set 5.517x speedup, step: 3, train time 7.12 s
Epoch 3/50 |loss: 0.181830| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 4, train time 7.19 s
Epoch 4/50 |loss: 0.178043| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 1, train time 7.09 s
Epoch 5/50 |loss: 0.169311| train set 5.241x speedup, test set 5.478x speedup, val set 5.516x speedup, step: 2, train time 7.17 s
Epoch 6/50 |loss: 0.160992| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.00 s
Epoch 7/50 |loss: 0.155406| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 4, train time 7.17 s
Epoch 8/50 |loss: 0.146906| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.20 s
Epoch 9/50 |loss: 0.149727| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 1, train time 7.11 s
Epoch 10/50 |loss: 0.146281| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.00 s
Epoch 11/50 |loss: 0.142050| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 3, train time 7.10 s
Epoch 12/50 |loss: 0.136721| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.10 s
Epoch 13/50 |loss: 0.139579| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 5, train time 7.20 s
Epoch 14/50 |loss: 0.135767| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 1, train time 7.11 s
Epoch 15/50 |loss: 0.136973| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 2, train time 7.21 s
Epoch 16/50 |loss: 0.132904| train set 5.240x speedup, test set 5.538x speedup, val set 5.614x speedup, step: 3, train time 7.03 s
Epoch 17/50 |loss: 0.131877| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 4, train time 7.09 s
Epoch 18/50 |loss: 0.133815| train set 5.254x speedup, test set 5.500x speedup, val set 5.558x speedup, step: 5, train time 7.10 s
Epoch 19/50 |loss: 0.132438| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 6, train time 7.27 s
Epoch 20/50 |loss: 0.133721| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.12 s
Epoch 21/50 |loss: 0.127389| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.11 s
Epoch 22/50 |loss: 0.130595| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 9, train time 7.21 s
Epoch 23/50 |loss: 0.126136| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.29 s
Epoch 24/50 |loss: 0.128564| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 11, train time 7.31 s
Epoch 25/50 |loss: 0.127444| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 12, train time 7.13 s
Epoch 26/50 |loss: 0.127886| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 13, train time 7.20 s
Epoch 27/50 |loss: 0.123996| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 14, train time 7.21 s
Epoch 28/50 |loss: 0.125047| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 15, train time 7.22 s
Epoch 29/50 |loss: 0.124611| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 16, train time 7.20 s
Epoch 30/50 |loss: 0.122801| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 17, train time 7.26 s
Epoch 31/50 |loss: 0.122519| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 18, train time 7.09 s
Epoch 32/50 |loss: 0.123999| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 19, train time 7.31 s
Epoch 33/50 |loss: 0.124718| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 20, train time 7.30 s
Epoch 34/50 |loss: 0.122250| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 21, train time 7.18 s
Epoch 35/50 |loss: 0.121766| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 22, train time 7.18 s
Epoch 36/50 |loss: 0.123986| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 23, train time 7.29 s
Epoch 37/50 |loss: 0.122167| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 24, train time 7.10 s
Epoch 38/50 |loss: 0.121575| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 25, train time 7.22 s
Epoch 39/50 |loss: 0.121217| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 26, train time 7.30 s
Epoch 40/50 |loss: 0.123185| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 27, train time 7.08 s
Epoch 41/50 |loss: 0.120101| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 28, train time 7.30 s
Epoch 42/50 |loss: 0.119390| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 29, train time 7.21 s
Epoch 43/50 |loss: 0.119302| train set 5.179x speedup, test set 5.500x speedup, val set 5.679x speedup, step: 30, train time 7.16 s
Epoch 44/50 |loss: 0.118151| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 31, train time 7.20 s
Epoch 45/50 |loss: 0.118039| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 32, train time 7.20 s
Epoch 46/50 |loss: 0.118706| train set 5.257x speedup, test set 5.563x speedup, val set 5.621x speedup, step: 33, train time 7.41 s
Epoch 47/50 |loss: 0.119893| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 34, train time 7.30 s
Epoch 48/50 |loss: 0.118200| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 35, train time 7.10 s
Epoch 49/50 |loss: 0.120002| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 36, train time 7.40 s
Training per epoch cost 7.208 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 5.264, test speedup 5.499, val speedup 5.539
best test speedup epoch: 46, train speedup 5.257, test speedup 5.563, val speedup 5.621
best validation speedup epoch: 14, train speedup 5.262, test speedup 5.557, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:27.560014
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.759366, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.393212| train set 4.265x speedup, test set 4.662x speedup, val set 4.537x speedup, step: 1, train time 8.43 s
Epoch 1/50 |loss: 0.246565| train set 4.614x speedup, test set 5.006x speedup, val set 4.888x speedup, step: 2, train time 7.19 s
Epoch 2/50 |loss: 0.203752| train set 5.046x speedup, test set 5.351x speedup, val set 5.413x speedup, step: 3, train time 7.38 s
Epoch 3/50 |loss: 0.183621| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 4, train time 7.13 s
Epoch 4/50 |loss: 0.175286| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 1, train time 7.01 s
Epoch 5/50 |loss: 0.168888| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.18 s
Epoch 6/50 |loss: 0.164229| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.19 s
Epoch 7/50 |loss: 0.154867| train set 5.162x speedup, test set 5.468x speedup, val set 5.482x speedup, step: 4, train time 7.19 s
Epoch 8/50 |loss: 0.150244| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.00 s
Epoch 9/50 |loss: 0.150266| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.18 s
Epoch 10/50 |loss: 0.146804| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.16 s
Epoch 11/50 |loss: 0.144501| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.29 s
Epoch 12/50 |loss: 0.140642| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.20 s
Epoch 13/50 |loss: 0.139514| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.12 s
Epoch 14/50 |loss: 0.137964| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 6, train time 7.39 s
Epoch 15/50 |loss: 0.137197| train set 5.262x speedup, test set 5.558x speedup, val set 5.638x speedup, step: 7, train time 7.22 s
Epoch 16/50 |loss: 0.134956| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 8, train time 7.12 s
Epoch 17/50 |loss: 0.133888| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 9, train time 7.13 s
Epoch 18/50 |loss: 0.135937| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 10, train time 7.32 s
Epoch 19/50 |loss: 0.135839| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.28 s
Epoch 20/50 |loss: 0.133786| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.20 s
Epoch 21/50 |loss: 0.130498| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.51 s
Epoch 22/50 |loss: 0.130109| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.28 s
Epoch 23/50 |loss: 0.127452| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.32 s
Epoch 24/50 |loss: 0.131619| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.40 s
Epoch 25/50 |loss: 0.127735| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.29 s
Epoch 26/50 |loss: 0.129115| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.31 s
Epoch 27/50 |loss: 0.125155| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.12 s
Epoch 28/50 |loss: 0.126652| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.29 s
Epoch 29/50 |loss: 0.125366| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.33 s
Epoch 30/50 |loss: 0.123439| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.22 s
Epoch 31/50 |loss: 0.123736| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.17 s
Epoch 32/50 |loss: 0.125207| train set 5.170x speedup, test set 5.502x speedup, val set 5.699x speedup, step: 9, train time 7.20 s
Epoch 33/50 |loss: 0.125411| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.30 s
Epoch 34/50 |loss: 0.124894| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.32 s
Epoch 35/50 |loss: 0.122391| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.20 s
Epoch 36/50 |loss: 0.123648| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.37 s
Epoch 37/50 |loss: 0.124144| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.22 s
Epoch 38/50 |loss: 0.121951| train set 5.254x speedup, test set 5.500x speedup, val set 5.558x speedup, step: 5, train time 7.32 s
Epoch 39/50 |loss: 0.122435| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.50 s
Epoch 40/50 |loss: 0.122788| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.37 s
Epoch 41/50 |loss: 0.121892| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 8, train time 7.42 s
Epoch 42/50 |loss: 0.121856| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 9, train time 7.20 s
Epoch 43/50 |loss: 0.121381| train set 5.179x speedup, test set 5.500x speedup, val set 5.679x speedup, step: 10, train time 7.20 s
Epoch 44/50 |loss: 0.120944| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.30 s
Epoch 45/50 |loss: 0.120280| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.39 s
Epoch 46/50 |loss: 0.121495| train set 5.259x speedup, test set 5.555x speedup, val set 5.625x speedup, step: 3, train time 7.32 s
Epoch 47/50 |loss: 0.120849| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.37 s
Epoch 48/50 |loss: 0.120348| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.52 s
Epoch 49/50 |loss: 0.121168| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.30 s
Training per epoch cost 7.287 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 5, train speedup 5.263, test speedup 5.498, val speedup 5.539
best test speedup epoch: 4, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 44, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:31.867662
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.801390, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.392329| train set 4.329x speedup, test set 5.010x speedup, val set 4.576x speedup, step: 1, train time 8.54 s
Epoch 1/50 |loss: 0.241690| train set 4.614x speedup, test set 5.006x speedup, val set 4.888x speedup, step: 2, train time 7.40 s
Epoch 2/50 |loss: 0.206858| train set 5.263x speedup, test set 5.497x speedup, val set 5.540x speedup, step: 3, train time 7.19 s
Epoch 3/50 |loss: 0.179740| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.19 s
Epoch 4/50 |loss: 0.176278| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 1, train time 7.19 s
Epoch 5/50 |loss: 0.168712| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 2, train time 7.09 s
Epoch 6/50 |loss: 0.162697| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 3, train time 7.11 s
Epoch 7/50 |loss: 0.154825| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.10 s
Epoch 8/50 |loss: 0.151340| train set 5.261x speedup, test set 5.494x speedup, val set 5.527x speedup, step: 5, train time 7.11 s
Epoch 9/50 |loss: 0.149142| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 1, train time 7.13 s
Epoch 10/50 |loss: 0.144666| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.19 s
Epoch 11/50 |loss: 0.141773| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.17 s
Epoch 12/50 |loss: 0.137029| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.28 s
Epoch 13/50 |loss: 0.137811| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.37 s
Epoch 14/50 |loss: 0.138345| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 1, train time 7.22 s
Epoch 15/50 |loss: 0.135367| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 2, train time 7.29 s
Epoch 16/50 |loss: 0.134519| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.08 s
Epoch 17/50 |loss: 0.132656| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 4, train time 7.19 s
Epoch 18/50 |loss: 0.133990| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.29 s
Epoch 19/50 |loss: 0.132605| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.23 s
Epoch 20/50 |loss: 0.131897| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.20 s
Epoch 21/50 |loss: 0.128442| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.20 s
Epoch 22/50 |loss: 0.130277| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.15 s
Epoch 23/50 |loss: 0.127659| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.23 s
Epoch 24/50 |loss: 0.129173| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.23 s
Epoch 25/50 |loss: 0.126028| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.40 s
Epoch 26/50 |loss: 0.128957| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.39 s
Epoch 27/50 |loss: 0.123637| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.40 s
Epoch 28/50 |loss: 0.127200| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.32 s
Epoch 29/50 |loss: 0.124151| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.30 s
Epoch 30/50 |loss: 0.124239| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.28 s
Epoch 31/50 |loss: 0.122409| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.49 s
Epoch 32/50 |loss: 0.123975| train set 5.254x speedup, test set 5.500x speedup, val set 5.558x speedup, step: 9, train time 7.30 s
Epoch 33/50 |loss: 0.124735| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.29 s
Epoch 34/50 |loss: 0.123425| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.27 s
Epoch 35/50 |loss: 0.122198| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.39 s
Epoch 36/50 |loss: 0.122643| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.10 s
Epoch 37/50 |loss: 0.123171| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.40 s
Epoch 38/50 |loss: 0.121575| train set 5.241x speedup, test set 5.478x speedup, val set 5.516x speedup, step: 5, train time 7.40 s
Epoch 39/50 |loss: 0.121656| train set 5.261x speedup, test set 5.494x speedup, val set 5.527x speedup, step: 6, train time 7.28 s
Epoch 40/50 |loss: 0.122666| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.28 s
Epoch 41/50 |loss: 0.120127| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.37 s
Epoch 42/50 |loss: 0.120831| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 9, train time 7.51 s
Epoch 43/50 |loss: 0.120797| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 10, train time 7.36 s
Epoch 44/50 |loss: 0.119493| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.48 s
Epoch 45/50 |loss: 0.117296| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.19 s
Epoch 46/50 |loss: 0.119408| train set 5.259x speedup, test set 5.555x speedup, val set 5.625x speedup, step: 3, train time 7.18 s
Epoch 47/50 |loss: 0.120221| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.09 s
Epoch 48/50 |loss: 0.118214| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.39 s
Epoch 49/50 |loss: 0.119438| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.30 s
Training per epoch cost 7.290 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 4, train speedup 5.264, test speedup 5.499, val speedup 5.539
best test speedup epoch: 5, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 44, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:32.518984
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.756272, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.398570| train set 4.940x speedup, test set 5.084x speedup, val set 5.167x speedup, step: 1, train time 8.40 s
Epoch 1/50 |loss: 0.240400| train set 4.717x speedup, test set 5.107x speedup, val set 4.991x speedup, step: 2, train time 7.20 s
Epoch 2/50 |loss: 0.203489| train set 5.241x speedup, test set 5.477x speedup, val set 5.517x speedup, step: 3, train time 7.09 s
Epoch 3/50 |loss: 0.181718| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 4, train time 7.22 s
Epoch 4/50 |loss: 0.181599| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 1, train time 7.40 s
Epoch 5/50 |loss: 0.169934| train set 5.241x speedup, test set 5.478x speedup, val set 5.516x speedup, step: 2, train time 6.99 s
Epoch 6/50 |loss: 0.163434| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 3, train time 7.21 s
Epoch 7/50 |loss: 0.154261| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 4, train time 7.18 s
Epoch 8/50 |loss: 0.151761| train set 5.261x speedup, test set 5.494x speedup, val set 5.527x speedup, step: 5, train time 7.08 s
Epoch 9/50 |loss: 0.148549| train set 5.267x speedup, test set 5.498x speedup, val set 5.638x speedup, step: 1, train time 7.11 s
Epoch 10/50 |loss: 0.145389| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.19 s
Epoch 11/50 |loss: 0.143899| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 3, train time 7.27 s
Epoch 12/50 |loss: 0.138282| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.11 s
Epoch 13/50 |loss: 0.139444| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.19 s
Epoch 14/50 |loss: 0.137000| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 1, train time 7.19 s
Epoch 15/50 |loss: 0.137789| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 2, train time 7.19 s
Epoch 16/50 |loss: 0.132697| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.27 s
Epoch 17/50 |loss: 0.132585| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.22 s
Epoch 18/50 |loss: 0.135429| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.02 s
Epoch 19/50 |loss: 0.134253| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 6, train time 7.22 s
Epoch 20/50 |loss: 0.133154| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.23 s
Epoch 21/50 |loss: 0.128774| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.21 s
Epoch 22/50 |loss: 0.130013| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 9, train time 7.28 s
Epoch 23/50 |loss: 0.127938| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.19 s
Epoch 24/50 |loss: 0.128947| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 11, train time 7.20 s
Epoch 25/50 |loss: 0.126449| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 12, train time 7.12 s
Epoch 26/50 |loss: 0.128879| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 13, train time 7.11 s
Epoch 27/50 |loss: 0.125369| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 14, train time 7.32 s
Epoch 28/50 |loss: 0.124688| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 15, train time 7.12 s
Epoch 29/50 |loss: 0.124266| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 16, train time 7.31 s
Epoch 30/50 |loss: 0.124073| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 17, train time 7.49 s
Epoch 31/50 |loss: 0.123004| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 18, train time 7.23 s
Epoch 32/50 |loss: 0.124356| train set 5.253x speedup, test set 5.561x speedup, val set 5.657x speedup, step: 19, train time 7.02 s
Epoch 33/50 |loss: 0.125152| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 20, train time 7.20 s
Epoch 34/50 |loss: 0.123145| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 21, train time 7.21 s
Epoch 35/50 |loss: 0.121075| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 22, train time 7.29 s
Epoch 36/50 |loss: 0.123200| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 23, train time 7.20 s
Epoch 37/50 |loss: 0.123843| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 24, train time 7.30 s
Epoch 38/50 |loss: 0.122149| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 25, train time 7.29 s
Epoch 39/50 |loss: 0.121764| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 26, train time 7.40 s
Epoch 40/50 |loss: 0.122309| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 27, train time 7.41 s
Epoch 41/50 |loss: 0.120094| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 28, train time 7.41 s
Epoch 42/50 |loss: 0.120302| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 29, train time 7.39 s
Epoch 43/50 |loss: 0.120581| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 30, train time 7.23 s
Epoch 44/50 |loss: 0.119611| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 31, train time 7.10 s
Epoch 45/50 |loss: 0.117710| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 32, train time 7.32 s
Epoch 46/50 |loss: 0.119646| train set 5.259x speedup, test set 5.555x speedup, val set 5.625x speedup, step: 33, train time 7.32 s
Epoch 47/50 |loss: 0.120132| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 34, train time 7.29 s
Epoch 48/50 |loss: 0.117633| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 35, train time 7.22 s
Epoch 49/50 |loss: 0.120195| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 36, train time 7.40 s
Training per epoch cost 7.251 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 9, train speedup 5.267, test speedup 5.498, val speedup 5.638
best test speedup epoch: 32, train speedup 5.253, test speedup 5.561, val speedup 5.657
best validation speedup epoch: 14, train speedup 5.262, test speedup 5.557, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:29.905380
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.757155, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397637| train set 4.875x speedup, test set 5.017x speedup, val set 5.077x speedup, step: 1, train time 8.26 s
Epoch 1/50 |loss: 0.241040| train set 4.614x speedup, test set 5.006x speedup, val set 4.888x speedup, step: 2, train time 7.19 s
Epoch 2/50 |loss: 0.202430| train set 5.240x speedup, test set 5.539x speedup, val set 5.614x speedup, step: 3, train time 7.21 s
Epoch 3/50 |loss: 0.183692| train set 5.145x speedup, test set 5.465x speedup, val set 5.511x speedup, step: 4, train time 7.21 s
Epoch 4/50 |loss: 0.180672| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 1, train time 7.17 s
Epoch 5/50 |loss: 0.169508| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.02 s
Epoch 6/50 |loss: 0.159482| train set 5.054x speedup, test set 5.424x speedup, val set 5.454x speedup, step: 3, train time 7.12 s
Epoch 7/50 |loss: 0.154956| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 4, train time 7.39 s
Epoch 8/50 |loss: 0.148799| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.18 s
Epoch 9/50 |loss: 0.148659| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.02 s
Epoch 10/50 |loss: 0.145577| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.00 s
Epoch 11/50 |loss: 0.143636| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.11 s
Epoch 12/50 |loss: 0.137249| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.10 s
Epoch 13/50 |loss: 0.138237| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 6.98 s
Epoch 14/50 |loss: 0.137062| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 6, train time 6.91 s
Epoch 15/50 |loss: 0.138077| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 7, train time 7.17 s
Epoch 16/50 |loss: 0.133965| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.12 s
Epoch 17/50 |loss: 0.132964| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 9, train time 7.20 s
Epoch 18/50 |loss: 0.135649| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.21 s
Epoch 19/50 |loss: 0.133459| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.29 s
Epoch 20/50 |loss: 0.132674| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.10 s
Epoch 21/50 |loss: 0.129929| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 3, train time 7.09 s
Epoch 22/50 |loss: 0.130058| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.09 s
Epoch 23/50 |loss: 0.128112| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.10 s
Epoch 24/50 |loss: 0.130869| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.11 s
Epoch 25/50 |loss: 0.127907| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.07 s
Epoch 26/50 |loss: 0.129063| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.22 s
Epoch 27/50 |loss: 0.124461| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.11 s
Epoch 28/50 |loss: 0.126903| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.21 s
Epoch 29/50 |loss: 0.125825| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.12 s
Epoch 30/50 |loss: 0.123071| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.10 s
Epoch 31/50 |loss: 0.123551| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.20 s
Epoch 32/50 |loss: 0.124201| train set 5.253x speedup, test set 5.561x speedup, val set 5.657x speedup, step: 9, train time 7.20 s
Epoch 33/50 |loss: 0.123614| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.11 s
Epoch 34/50 |loss: 0.123502| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.28 s
Epoch 35/50 |loss: 0.122965| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.00 s
Epoch 36/50 |loss: 0.124323| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.09 s
Epoch 37/50 |loss: 0.123254| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.10 s
Epoch 38/50 |loss: 0.121119| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 6.99 s
Epoch 39/50 |loss: 0.122161| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.31 s
Epoch 40/50 |loss: 0.124050| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.20 s
Epoch 41/50 |loss: 0.120693| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 8, train time 7.09 s
Epoch 42/50 |loss: 0.121910| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 9, train time 6.90 s
Epoch 43/50 |loss: 0.119655| train set 5.181x speedup, test set 5.441x speedup, val set 5.579x speedup, step: 10, train time 7.18 s
Epoch 44/50 |loss: 0.119617| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.29 s
Epoch 45/50 |loss: 0.119127| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.01 s
Epoch 46/50 |loss: 0.120355| train set 5.259x speedup, test set 5.555x speedup, val set 5.625x speedup, step: 3, train time 7.19 s
Epoch 47/50 |loss: 0.120136| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.19 s
Epoch 48/50 |loss: 0.118577| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.31 s
Epoch 49/50 |loss: 0.120415| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.18 s
Training per epoch cost 7.160 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 4, train speedup 5.263, test speedup 5.498, val speedup 5.539
best test speedup epoch: 32, train speedup 5.253, test speedup 5.561, val speedup 5.657
best validation speedup epoch: 44, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:24.790382
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.861172, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397637| train set 4.875x speedup, test set 5.017x speedup, val set 5.077x speedup, step: 1, train time 8.30 s
Epoch 1/50 |loss: 0.241048| train set 4.717x speedup, test set 5.107x speedup, val set 4.991x speedup, step: 2, train time 7.18 s
Epoch 2/50 |loss: 0.203932| train set 5.241x speedup, test set 5.478x speedup, val set 5.516x speedup, step: 3, train time 7.11 s
Epoch 3/50 |loss: 0.181977| train set 4.929x speedup, test set 5.227x speedup, val set 5.153x speedup, step: 4, train time 7.29 s
Epoch 4/50 |loss: 0.177098| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 1, train time 7.10 s
Epoch 5/50 |loss: 0.167346| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.21 s
Epoch 6/50 |loss: 0.161934| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 3, train time 7.20 s
Epoch 7/50 |loss: 0.156326| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 4, train time 7.10 s
Epoch 8/50 |loss: 0.147842| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.00 s
Epoch 9/50 |loss: 0.148132| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 1, train time 6.88 s
Epoch 10/50 |loss: 0.147518| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.09 s
Epoch 11/50 |loss: 0.143887| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 3, train time 7.09 s
Epoch 12/50 |loss: 0.137844| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.21 s
Epoch 13/50 |loss: 0.139095| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 5, train time 7.07 s
Epoch 14/50 |loss: 0.135301| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 1, train time 6.89 s
Epoch 15/50 |loss: 0.136708| train set 5.191x speedup, test set 5.487x speedup, val set 5.563x speedup, step: 2, train time 7.30 s
Epoch 16/50 |loss: 0.133874| train set 5.239x speedup, test set 5.537x speedup, val set 5.614x speedup, step: 3, train time 7.30 s
Epoch 17/50 |loss: 0.133222| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 4, train time 7.12 s
Epoch 18/50 |loss: 0.134629| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 5, train time 6.89 s
Epoch 19/50 |loss: 0.132501| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 6, train time 6.98 s
Epoch 20/50 |loss: 0.132430| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.19 s
Epoch 21/50 |loss: 0.128609| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.21 s
Epoch 22/50 |loss: 0.129100| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 9, train time 6.97 s
Epoch 23/50 |loss: 0.126866| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.09 s
Epoch 24/50 |loss: 0.128990| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 11, train time 7.10 s
Epoch 25/50 |loss: 0.127220| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 12, train time 7.20 s
Epoch 26/50 |loss: 0.128316| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 13, train time 7.10 s
Epoch 27/50 |loss: 0.124092| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 14, train time 7.18 s
Epoch 28/50 |loss: 0.125298| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 15, train time 7.08 s
Epoch 29/50 |loss: 0.125828| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 16, train time 7.10 s
Epoch 30/50 |loss: 0.125035| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 17, train time 7.30 s
Epoch 31/50 |loss: 0.123527| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 18, train time 7.10 s
Epoch 32/50 |loss: 0.124111| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 19, train time 7.11 s
Epoch 33/50 |loss: 0.124036| train set 5.264x speedup, test set 5.499x speedup, val set 5.539x speedup, step: 20, train time 6.99 s
Epoch 34/50 |loss: 0.122330| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 21, train time 7.11 s
Epoch 35/50 |loss: 0.121249| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 22, train time 7.10 s
Epoch 36/50 |loss: 0.123030| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 23, train time 7.28 s
Epoch 37/50 |loss: 0.122467| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 24, train time 7.17 s
Epoch 38/50 |loss: 0.120872| train set 5.254x speedup, test set 5.500x speedup, val set 5.558x speedup, step: 25, train time 7.29 s
Epoch 39/50 |loss: 0.121288| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 26, train time 7.07 s
Epoch 40/50 |loss: 0.122548| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 27, train time 7.09 s
Epoch 41/50 |loss: 0.119353| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 28, train time 7.09 s
Epoch 42/50 |loss: 0.120663| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 29, train time 7.09 s
Epoch 43/50 |loss: 0.119492| train set 5.179x speedup, test set 5.500x speedup, val set 5.679x speedup, step: 30, train time 7.10 s
Epoch 44/50 |loss: 0.119589| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 31, train time 7.18 s
Epoch 45/50 |loss: 0.118339| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 32, train time 7.20 s
Epoch 46/50 |loss: 0.119854| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 33, train time 7.09 s
Epoch 47/50 |loss: 0.119606| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 34, train time 7.18 s
Epoch 48/50 |loss: 0.118299| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 35, train time 7.17 s
Epoch 49/50 |loss: 0.119414| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 36, train time 7.09 s
Training per epoch cost 7.146 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.206s, pg runtime 1.206s, speedup 1.000x
40, opt runtime 1.086s, model runtime 1.181s, pg runtime 1.181s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 5.264, test speedup 5.499, val speedup 5.539
best test speedup epoch: 6, train speedup 5.262, test speedup 5.560, val speedup 5.637
best validation speedup epoch: 14, train speedup 5.262, test speedup 5.557, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:24.328871
==================================================
all print will write to path record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: TPCH
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/TPCH/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/TPCH/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
train, test, validation (120, 49) (40, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.815924, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.393244| train set 4.192x speedup, test set 4.718x speedup, val set 4.508x speedup, step: 1, train time 8.45 s
Epoch 1/50 |loss: 0.242247| train set 5.193x speedup, test set 5.427x speedup, val set 5.467x speedup, step: 2, train time 7.00 s
Epoch 2/50 |loss: 0.201625| train set 5.241x speedup, test set 5.477x speedup, val set 5.517x speedup, step: 3, train time 7.29 s
Epoch 3/50 |loss: 0.183008| train set 5.192x speedup, test set 5.489x speedup, val set 5.562x speedup, step: 4, train time 7.10 s
Epoch 4/50 |loss: 0.178704| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 1, train time 7.01 s
Epoch 5/50 |loss: 0.170826| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.07 s
Epoch 6/50 |loss: 0.165907| train set 5.262x speedup, test set 5.560x speedup, val set 5.637x speedup, step: 3, train time 7.03 s
Epoch 7/50 |loss: 0.156470| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 4, train time 7.31 s
Epoch 8/50 |loss: 0.153482| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.20 s
Epoch 9/50 |loss: 0.149878| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.12 s
Epoch 10/50 |loss: 0.145857| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 7, train time 7.19 s
Epoch 11/50 |loss: 0.142890| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 8, train time 7.19 s
Epoch 12/50 |loss: 0.138447| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 9, train time 7.17 s
Epoch 13/50 |loss: 0.140080| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.10 s
Epoch 14/50 |loss: 0.138292| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 11, train time 7.10 s
Epoch 15/50 |loss: 0.138288| train set 5.262x speedup, test set 5.557x speedup, val set 5.638x speedup, step: 12, train time 7.18 s
Epoch 16/50 |loss: 0.135393| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 13, train time 7.17 s
Epoch 17/50 |loss: 0.134142| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 14, train time 7.07 s
Epoch 18/50 |loss: 0.134721| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 15, train time 7.21 s
Epoch 19/50 |loss: 0.133943| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.18 s
Epoch 20/50 |loss: 0.134327| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.30 s
Epoch 21/50 |loss: 0.130134| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.30 s
Epoch 22/50 |loss: 0.129681| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.22 s
Epoch 23/50 |loss: 0.126515| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.40 s
Epoch 24/50 |loss: 0.131444| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.21 s
Epoch 25/50 |loss: 0.127314| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 2, train time 7.10 s
Epoch 26/50 |loss: 0.128860| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.12 s
Epoch 27/50 |loss: 0.124958| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.02 s
Epoch 28/50 |loss: 0.126233| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 5, train time 7.09 s
Epoch 29/50 |loss: 0.125290| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.18 s
Epoch 30/50 |loss: 0.124595| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.12 s
Epoch 31/50 |loss: 0.124211| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 8, train time 7.11 s
Epoch 32/50 |loss: 0.125407| train set 5.253x speedup, test set 5.561x speedup, val set 5.657x speedup, step: 9, train time 7.19 s
Epoch 33/50 |loss: 0.124683| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 10, train time 7.27 s
Epoch 34/50 |loss: 0.123600| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.10 s
Epoch 35/50 |loss: 0.122105| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.19 s
Epoch 36/50 |loss: 0.124578| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 3, train time 7.20 s
Epoch 37/50 |loss: 0.122459| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.12 s
Epoch 38/50 |loss: 0.122921| train set 5.263x speedup, test set 5.496x speedup, val set 5.540x speedup, step: 5, train time 7.22 s
Epoch 39/50 |loss: 0.123482| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.30 s
Epoch 40/50 |loss: 0.123237| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 7, train time 7.40 s
Epoch 41/50 |loss: 0.121658| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 8, train time 7.31 s
Epoch 42/50 |loss: 0.120620| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 9, train time 7.29 s
Epoch 43/50 |loss: 0.122647| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 10, train time 7.09 s
Epoch 44/50 |loss: 0.120010| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 1, train time 7.30 s
Epoch 45/50 |loss: 0.118637| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 2, train time 7.31 s
Epoch 46/50 |loss: 0.121842| train set 5.261x speedup, test set 5.494x speedup, val set 5.527x speedup, step: 3, train time 7.30 s
Epoch 47/50 |loss: 0.120200| train set 5.262x speedup, test set 5.559x speedup, val set 5.638x speedup, step: 4, train time 7.21 s
Epoch 48/50 |loss: 0.119508| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 5, train time 7.41 s
Epoch 49/50 |loss: 0.120567| train set 5.263x speedup, test set 5.498x speedup, val set 5.539x speedup, step: 6, train time 7.18 s
Training per epoch cost 7.214 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 29.502s, pg runtime 112.305s, speedup 3.807x
04, opt runtime 30.267s, model runtime 30.267s, pg runtime 100.885s, speedup 3.333x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 6.284s, pg runtime 31.019s, speedup 4.937x
08, opt runtime 7.377s, model runtime 8.474s, pg runtime 28.655s, speedup 3.382x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 23.205s, pg runtime 87.340s, speedup 3.764x
12, opt runtime 26.602s, model runtime 26.602s, pg runtime 85.447s, speedup 3.212x
13, opt runtime 3.332s, model runtime 4.140s, pg runtime 21.298s, speedup 5.144x
14, opt runtime 3.258s, model runtime 3.312s, pg runtime 18.141s, speedup 5.478x
15, opt runtime 53.298s, model runtime 53.298s, pg runtime 148.707s, speedup 2.790x
16, opt runtime 53.440s, model runtime 53.440s, pg runtime 140.742s, speedup 2.634x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.347s, pg runtime 1.438s, speedup 1.067x
20, opt runtime 1.428s, model runtime 1.595s, pg runtime 1.428s, speedup 0.896x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 7.799s, pg runtime 7.799s, speedup 1.000x
28, opt runtime 7.199s, model runtime 7.619s, pg runtime 7.619s, speedup 1.000x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 19.707s, pg runtime 19.707s, speedup 1.000x
38, opt runtime 18.262s, model runtime 18.262s, pg runtime 18.262s, speedup 1.000x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 7, train speedup 5.263, test speedup 5.498, val speedup 5.539
best test speedup epoch: 32, train speedup 5.253, test speedup 5.561, val speedup 5.657
best validation speedup epoch: 44, train speedup 5.262, test speedup 5.559, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 5.498, val speedup 5.539
execution cost 0:06:27.817516
==================================================
