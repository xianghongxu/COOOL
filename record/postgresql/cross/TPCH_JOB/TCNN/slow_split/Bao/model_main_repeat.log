all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.946827, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014864| train set 2.868x speedup, test set 0.984x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008820| train set 3.281x speedup, test set 0.895x speedup, val set 3.476x speedup, step: 1
Epoch 3/300 |loss: 0.005955| train set 3.567x speedup, test set 1.141x speedup, val set 3.913x speedup, step: 1
Epoch 4/300 |loss: 0.004536| train set 3.271x speedup, test set 0.927x speedup, val set 3.565x speedup, step: 2
Epoch 5/300 |loss: 0.004244| train set 3.584x speedup, test set 1.285x speedup, val set 3.909x speedup, step: 3
Epoch 6/300 |loss: 0.003539| train set 4.553x speedup, test set 1.116x speedup, val set 4.943x speedup, step: 1
Epoch 7/300 |loss: 0.005711| train set 3.719x speedup, test set 0.753x speedup, val set 4.025x speedup, step: 2
Epoch 8/300 |loss: 0.003217| train set 4.570x speedup, test set 1.283x speedup, val set 4.968x speedup, step: 1
Epoch 9/300 |loss: 0.002471| train set 3.927x speedup, test set 1.256x speedup, val set 4.144x speedup, step: 2
Epoch 10/300 |loss: 0.002542| train set 5.220x speedup, test set 0.900x speedup, val set 5.472x speedup, step: 1
Epoch 11/300 |loss: 0.002895| train set 3.691x speedup, test set 0.713x speedup, val set 3.835x speedup, step: 2
Epoch 12/300 |loss: 0.003586| train set 5.222x speedup, test set 0.895x speedup, val set 5.473x speedup, step: 1
Epoch 13/300 |loss: 0.001933| train set 4.192x speedup, test set 0.678x speedup, val set 4.779x speedup, step: 2
Epoch 14/300 |loss: 0.001907| train set 5.154x speedup, test set 0.915x speedup, val set 5.374x speedup, step: 3
Epoch 15/300 |loss: 0.001871| train set 3.723x speedup, test set 0.685x speedup, val set 3.993x speedup, step: 4
Epoch 16/300 |loss: 0.001808| train set 5.121x speedup, test set 1.363x speedup, val set 5.376x speedup, step: 5
Epoch 17/300 |loss: 0.001603| train set 5.209x speedup, test set 0.916x speedup, val set 5.387x speedup, step: 6
Epoch 18/300 |loss: 0.001484| train set 5.141x speedup, test set 0.678x speedup, val set 5.457x speedup, step: 7
Epoch 19/300 |loss: 0.001312| train set 5.084x speedup, test set 0.670x speedup, val set 5.282x speedup, step: 8
Epoch 20/300 |loss: 0.001343| train set 5.075x speedup, test set 0.707x speedup, val set 5.304x speedup, step: 9
Epoch 21/300 |loss: 0.001471| train set 5.156x speedup, test set 0.651x speedup, val set 5.408x speedup, step: 10
Epoch 22/300 |loss: 0.001451| train set 5.218x speedup, test set 0.776x speedup, val set 5.452x speedup, step: 11
Epoch 23/300 |loss: 0.001293| train set 5.105x speedup, test set 0.697x speedup, val set 5.350x speedup, step: 12
Epoch 24/300 |loss: 0.001198| train set 5.122x speedup, test set 0.685x speedup, val set 5.315x speedup, step: 13
Epoch 25/300 |loss: 0.000851| train set 5.222x speedup, test set 0.657x speedup, val set 5.487x speedup, step: 1
Epoch 26/300 |loss: 0.000842| train set 5.249x speedup, test set 0.655x speedup, val set 5.487x speedup, step: 1
Epoch 27/300 |loss: 0.000815| train set 5.247x speedup, test set 0.785x speedup, val set 5.485x speedup, step: 2
Epoch 28/300 |loss: 0.000822| train set 5.248x speedup, test set 0.659x speedup, val set 5.487x speedup, step: 3
Epoch 29/300 |loss: 0.000978| train set 5.249x speedup, test set 0.692x speedup, val set 5.487x speedup, step: 1
Epoch 30/300 |loss: 0.001017| train set 5.247x speedup, test set 0.680x speedup, val set 5.484x speedup, step: 2
Epoch 31/300 |loss: 0.001414| train set 5.193x speedup, test set 0.782x speedup, val set 5.440x speedup, step: 3
Epoch 32/300 |loss: 0.000979| train set 5.248x speedup, test set 0.671x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000704| train set 5.244x speedup, test set 0.667x speedup, val set 5.473x speedup, step: 2
Epoch 34/300 |loss: 0.000633| train set 5.247x speedup, test set 0.669x speedup, val set 5.485x speedup, step: 3
Epoch 35/300 |loss: 0.000621| train set 5.209x speedup, test set 0.701x speedup, val set 5.387x speedup, step: 4
Epoch 36/300 |loss: 0.000642| train set 5.211x speedup, test set 0.665x speedup, val set 5.389x speedup, step: 5
Epoch 37/300 |loss: 0.001503| train set 5.247x speedup, test set 0.665x speedup, val set 5.484x speedup, step: 6
Epoch 38/300 |loss: 0.000748| train set 5.247x speedup, test set 0.667x speedup, val set 5.484x speedup, step: 7
Epoch 39/300 |loss: 0.000623| train set 5.247x speedup, test set 0.671x speedup, val set 5.484x speedup, step: 8
Epoch 40/300 |loss: 0.000599| train set 5.246x speedup, test set 0.707x speedup, val set 5.485x speedup, step: 9
Epoch 41/300 |loss: 0.000627| train set 5.226x speedup, test set 0.666x speedup, val set 5.459x speedup, step: 10
Epoch 42/300 |loss: 0.000646| train set 5.244x speedup, test set 0.666x speedup, val set 5.475x speedup, step: 11
Epoch 43/300 |loss: 0.000667| train set 5.246x speedup, test set 0.666x speedup, val set 5.485x speedup, step: 12
early stopping at epoch 43
Training per epoch cost 0.873 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.418s, pg runtime 0.354s, speedup 0.847x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 2.408s, pg runtime 2.389s, speedup 0.992x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 26, train speedup 5.249, test speedup 0.655, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 32, train speedup 5.248, test speedup 0.671, val speedup 5.487
last model at epoch 43, train speedup 5.246, test speedup 0.666, val speedup 5.485
execution cost 0:02:01.536333
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.659065, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014859| train set 2.871x speedup, test set 0.984x speedup, val set 2.899x speedup, step: 1
Epoch 2/300 |loss: 0.008719| train set 3.465x speedup, test set 0.911x speedup, val set 3.559x speedup, step: 1
Epoch 3/300 |loss: 0.006220| train set 3.558x speedup, test set 1.158x speedup, val set 3.902x speedup, step: 1
Epoch 4/300 |loss: 0.004447| train set 3.350x speedup, test set 0.872x speedup, val set 3.572x speedup, step: 2
Epoch 5/300 |loss: 0.004432| train set 3.632x speedup, test set 0.898x speedup, val set 3.937x speedup, step: 1
Epoch 6/300 |loss: 0.003794| train set 4.569x speedup, test set 1.178x speedup, val set 4.966x speedup, step: 1
Epoch 7/300 |loss: 0.004868| train set 3.882x speedup, test set 0.935x speedup, val set 4.073x speedup, step: 2
Epoch 8/300 |loss: 0.003182| train set 3.641x speedup, test set 0.913x speedup, val set 3.952x speedup, step: 3
Epoch 9/300 |loss: 0.002554| train set 3.631x speedup, test set 0.864x speedup, val set 3.938x speedup, step: 4
Epoch 10/300 |loss: 0.002501| train set 4.575x speedup, test set 0.854x speedup, val set 4.972x speedup, step: 1
Epoch 11/300 |loss: 0.002803| train set 3.711x speedup, test set 0.695x speedup, val set 3.886x speedup, step: 2
Epoch 12/300 |loss: 0.003734| train set 5.222x speedup, test set 0.920x speedup, val set 5.473x speedup, step: 1
Epoch 13/300 |loss: 0.002066| train set 3.909x speedup, test set 0.743x speedup, val set 3.903x speedup, step: 2
Epoch 14/300 |loss: 0.002016| train set 4.204x speedup, test set 0.867x speedup, val set 5.279x speedup, step: 3
Epoch 15/300 |loss: 0.001932| train set 3.662x speedup, test set 0.719x speedup, val set 3.815x speedup, step: 4
Epoch 16/300 |loss: 0.001747| train set 5.115x speedup, test set 1.044x speedup, val set 5.384x speedup, step: 5
Epoch 17/300 |loss: 0.001644| train set 5.241x speedup, test set 0.800x speedup, val set 5.481x speedup, step: 1
Epoch 18/300 |loss: 0.001591| train set 5.249x speedup, test set 0.711x speedup, val set 5.487x speedup, step: 1
Epoch 19/300 |loss: 0.001391| train set 5.206x speedup, test set 0.712x speedup, val set 5.485x speedup, step: 2
Epoch 20/300 |loss: 0.001379| train set 5.046x speedup, test set 0.712x speedup, val set 5.278x speedup, step: 3
Epoch 21/300 |loss: 0.001409| train set 5.228x speedup, test set 0.674x speedup, val set 5.459x speedup, step: 4
Epoch 22/300 |loss: 0.001425| train set 5.247x speedup, test set 0.666x speedup, val set 5.484x speedup, step: 5
Epoch 23/300 |loss: 0.001473| train set 5.110x speedup, test set 0.690x speedup, val set 5.361x speedup, step: 6
Epoch 24/300 |loss: 0.001397| train set 4.503x speedup, test set 0.711x speedup, val set 5.390x speedup, step: 7
Epoch 25/300 |loss: 0.000948| train set 5.128x speedup, test set 0.697x speedup, val set 5.323x speedup, step: 8
Epoch 26/300 |loss: 0.000853| train set 5.248x speedup, test set 0.803x speedup, val set 5.489x speedup, step: 1
Epoch 27/300 |loss: 0.001065| train set 5.240x speedup, test set 0.802x speedup, val set 5.479x speedup, step: 2
Epoch 28/300 |loss: 0.000902| train set 5.249x speedup, test set 0.670x speedup, val set 5.487x speedup, step: 3
Epoch 29/300 |loss: 0.001073| train set 5.249x speedup, test set 0.708x speedup, val set 5.487x speedup, step: 4
Epoch 30/300 |loss: 0.000772| train set 5.239x speedup, test set 0.683x speedup, val set 5.479x speedup, step: 5
Epoch 31/300 |loss: 0.000858| train set 5.249x speedup, test set 0.708x speedup, val set 5.487x speedup, step: 6
Epoch 32/300 |loss: 0.000762| train set 5.248x speedup, test set 0.675x speedup, val set 5.487x speedup, step: 7
Epoch 33/300 |loss: 0.000650| train set 5.247x speedup, test set 0.678x speedup, val set 5.484x speedup, step: 8
Epoch 34/300 |loss: 0.000688| train set 5.222x speedup, test set 0.675x speedup, val set 5.471x speedup, step: 9
Epoch 35/300 |loss: 0.000712| train set 5.249x speedup, test set 0.675x speedup, val set 5.487x speedup, step: 10
Epoch 36/300 |loss: 0.000704| train set 5.228x speedup, test set 0.649x speedup, val set 5.459x speedup, step: 11
Epoch 37/300 |loss: 0.001679| train set 5.247x speedup, test set 0.696x speedup, val set 5.487x speedup, step: 12
Epoch 38/300 |loss: 0.000725| train set 5.244x speedup, test set 0.649x speedup, val set 5.473x speedup, step: 13
Epoch 39/300 |loss: 0.000651| train set 5.247x speedup, test set 0.647x speedup, val set 5.484x speedup, step: 14
Epoch 40/300 |loss: 0.000625| train set 5.208x speedup, test set 0.641x speedup, val set 5.387x speedup, step: 15
Epoch 41/300 |loss: 0.000588| train set 5.248x speedup, test set 0.647x speedup, val set 5.490x speedup, step: 1
Epoch 42/300 |loss: 0.000637| train set 5.247x speedup, test set 0.648x speedup, val set 5.484x speedup, step: 2
Epoch 43/300 |loss: 0.000660| train set 5.239x speedup, test set 0.648x speedup, val set 5.479x speedup, step: 3
Epoch 44/300 |loss: 0.000608| train set 5.247x speedup, test set 0.651x speedup, val set 5.484x speedup, step: 4
Epoch 45/300 |loss: 0.000696| train set 5.248x speedup, test set 0.649x speedup, val set 5.490x speedup, step: 1
Epoch 46/300 |loss: 0.000656| train set 5.239x speedup, test set 0.647x speedup, val set 5.480x speedup, step: 2
Epoch 47/300 |loss: 0.000641| train set 5.247x speedup, test set 0.633x speedup, val set 5.484x speedup, step: 3
Epoch 48/300 |loss: 0.000688| train set 5.228x speedup, test set 0.649x speedup, val set 5.459x speedup, step: 4
Epoch 49/300 |loss: 0.000653| train set 5.242x speedup, test set 0.651x speedup, val set 5.484x speedup, step: 5
early stopping at epoch 49
Training per epoch cost 0.859 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 18, train speedup 5.249, test speedup 0.711, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 45, train speedup 5.248, test speedup 0.649, val speedup 5.490
last model at epoch 49, train speedup 5.242, test speedup 0.651, val speedup 5.484
execution cost 0:02:12.955238
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.864673, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014866| train set 2.868x speedup, test set 0.846x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008699| train set 3.373x speedup, test set 0.895x speedup, val set 3.645x speedup, step: 1
Epoch 3/300 |loss: 0.006273| train set 3.633x speedup, test set 1.158x speedup, val set 3.943x speedup, step: 1
Epoch 4/300 |loss: 0.004427| train set 3.397x speedup, test set 0.873x speedup, val set 3.615x speedup, step: 2
Epoch 5/300 |loss: 0.004404| train set 3.326x speedup, test set 1.175x speedup, val set 3.539x speedup, step: 3
Epoch 6/300 |loss: 0.003346| train set 3.996x speedup, test set 1.160x speedup, val set 4.322x speedup, step: 1
Epoch 7/300 |loss: 0.005495| train set 3.965x speedup, test set 0.760x speedup, val set 4.195x speedup, step: 2
Epoch 8/300 |loss: 0.003000| train set 3.629x speedup, test set 1.318x speedup, val set 3.944x speedup, step: 3
Epoch 9/300 |loss: 0.002404| train set 3.966x speedup, test set 0.930x speedup, val set 4.190x speedup, step: 4
Epoch 10/300 |loss: 0.002556| train set 4.648x speedup, test set 1.231x speedup, val set 5.031x speedup, step: 1
Epoch 11/300 |loss: 0.002958| train set 4.005x speedup, test set 0.710x speedup, val set 4.186x speedup, step: 2
Epoch 12/300 |loss: 0.003789| train set 4.993x speedup, test set 0.886x speedup, val set 5.249x speedup, step: 1
Epoch 13/300 |loss: 0.001930| train set 5.226x speedup, test set 0.920x speedup, val set 5.459x speedup, step: 1
Epoch 14/300 |loss: 0.001979| train set 5.032x speedup, test set 0.898x speedup, val set 5.260x speedup, step: 2
Epoch 15/300 |loss: 0.001909| train set 3.972x speedup, test set 0.722x speedup, val set 4.164x speedup, step: 3
Epoch 16/300 |loss: 0.001767| train set 5.121x speedup, test set 1.579x speedup, val set 5.378x speedup, step: 4
Epoch 17/300 |loss: 0.001671| train set 5.105x speedup, test set 1.017x speedup, val set 5.422x speedup, step: 5
Epoch 18/300 |loss: 0.001652| train set 4.522x speedup, test set 0.706x speedup, val set 5.389x speedup, step: 6
Epoch 19/300 |loss: 0.001406| train set 5.127x speedup, test set 0.822x speedup, val set 5.382x speedup, step: 7
Epoch 20/300 |loss: 0.001482| train set 5.160x speedup, test set 0.678x speedup, val set 5.416x speedup, step: 8
Epoch 21/300 |loss: 0.001456| train set 5.249x speedup, test set 0.673x speedup, val set 5.487x speedup, step: 1
Epoch 22/300 |loss: 0.001424| train set 5.227x speedup, test set 0.822x speedup, val set 5.456x speedup, step: 2
Epoch 23/300 |loss: 0.001466| train set 4.680x speedup, test set 0.685x speedup, val set 4.999x speedup, step: 3
Epoch 24/300 |loss: 0.001359| train set 4.720x speedup, test set 0.711x speedup, val set 5.047x speedup, step: 4
Epoch 25/300 |loss: 0.000980| train set 5.129x speedup, test set 0.681x speedup, val set 5.322x speedup, step: 5
Epoch 26/300 |loss: 0.000859| train set 5.247x speedup, test set 0.681x speedup, val set 5.484x speedup, step: 6
Epoch 27/300 |loss: 0.001050| train set 5.247x speedup, test set 0.674x speedup, val set 5.485x speedup, step: 7
Epoch 28/300 |loss: 0.000873| train set 5.249x speedup, test set 0.679x speedup, val set 5.487x speedup, step: 1
Epoch 29/300 |loss: 0.001016| train set 5.208x speedup, test set 0.665x speedup, val set 5.386x speedup, step: 2
Epoch 30/300 |loss: 0.001039| train set 5.244x speedup, test set 0.686x speedup, val set 5.473x speedup, step: 3
Epoch 31/300 |loss: 0.001252| train set 5.189x speedup, test set 0.778x speedup, val set 5.430x speedup, step: 4
Epoch 32/300 |loss: 0.000987| train set 5.248x speedup, test set 0.665x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000663| train set 5.245x speedup, test set 0.659x speedup, val set 5.481x speedup, step: 2
Epoch 34/300 |loss: 0.000687| train set 5.227x speedup, test set 0.658x speedup, val set 5.456x speedup, step: 3
Epoch 35/300 |loss: 0.000663| train set 5.210x speedup, test set 0.662x speedup, val set 5.392x speedup, step: 4
Epoch 36/300 |loss: 0.000704| train set 5.247x speedup, test set 0.652x speedup, val set 5.484x speedup, step: 5
Epoch 37/300 |loss: 0.001640| train set 5.248x speedup, test set 0.652x speedup, val set 5.490x speedup, step: 1
Epoch 38/300 |loss: 0.000969| train set 5.219x speedup, test set 0.641x speedup, val set 5.459x speedup, step: 2
Epoch 39/300 |loss: 0.000683| train set 5.239x speedup, test set 0.650x speedup, val set 5.480x speedup, step: 3
Epoch 40/300 |loss: 0.000620| train set 5.247x speedup, test set 0.662x speedup, val set 5.485x speedup, step: 4
Epoch 41/300 |loss: 0.000620| train set 5.249x speedup, test set 0.650x speedup, val set 5.487x speedup, step: 5
Epoch 42/300 |loss: 0.000590| train set 5.244x speedup, test set 0.653x speedup, val set 5.473x speedup, step: 6
Epoch 43/300 |loss: 0.000636| train set 5.209x speedup, test set 0.649x speedup, val set 5.386x speedup, step: 7
Epoch 44/300 |loss: 0.000563| train set 5.242x speedup, test set 0.650x speedup, val set 5.473x speedup, step: 8
Epoch 45/300 |loss: 0.000604| train set 5.248x speedup, test set 0.636x speedup, val set 5.487x speedup, step: 9
Epoch 46/300 |loss: 0.000645| train set 5.239x speedup, test set 0.665x speedup, val set 5.480x speedup, step: 10
Epoch 47/300 |loss: 0.000622| train set 5.247x speedup, test set 0.629x speedup, val set 5.484x speedup, step: 11
Epoch 48/300 |loss: 0.000641| train set 5.227x speedup, test set 0.645x speedup, val set 5.457x speedup, step: 12
Epoch 49/300 |loss: 0.000669| train set 5.242x speedup, test set 0.649x speedup, val set 5.476x speedup, step: 13
early stopping at epoch 49
Training per epoch cost 0.639 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.089s, pg runtime 0.089s, speedup 1.000x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 2.408s, pg runtime 2.389s, speedup 0.992x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 21, train speedup 5.249, test speedup 0.673, val speedup 5.487
best test speedup epoch: 16, train speedup 5.121, test speedup 1.579, val speedup 5.378
best validation speedup epoch: 37, train speedup 5.248, test speedup 0.652, val speedup 5.490
last model at epoch 49, train speedup 5.242, test speedup 0.649, val speedup 5.476
execution cost 0:01:51.568612
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.616630, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014864| train set 2.868x speedup, test set 0.984x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008820| train set 3.281x speedup, test set 0.895x speedup, val set 3.476x speedup, step: 1
Epoch 3/300 |loss: 0.005955| train set 3.567x speedup, test set 1.141x speedup, val set 3.913x speedup, step: 1
Epoch 4/300 |loss: 0.004536| train set 3.271x speedup, test set 0.927x speedup, val set 3.565x speedup, step: 2
Epoch 5/300 |loss: 0.004241| train set 3.584x speedup, test set 1.285x speedup, val set 3.909x speedup, step: 3
Epoch 6/300 |loss: 0.003507| train set 4.553x speedup, test set 1.116x speedup, val set 4.943x speedup, step: 1
Epoch 7/300 |loss: 0.005818| train set 3.719x speedup, test set 0.757x speedup, val set 4.025x speedup, step: 2
Epoch 8/300 |loss: 0.003376| train set 4.569x speedup, test set 1.310x speedup, val set 4.966x speedup, step: 1
Epoch 9/300 |loss: 0.002523| train set 3.977x speedup, test set 1.260x speedup, val set 4.208x speedup, step: 2
Epoch 10/300 |loss: 0.002544| train set 5.202x speedup, test set 0.933x speedup, val set 5.445x speedup, step: 1
Epoch 11/300 |loss: 0.002953| train set 3.951x speedup, test set 0.862x speedup, val set 4.145x speedup, step: 2
Epoch 12/300 |loss: 0.003501| train set 5.091x speedup, test set 1.137x speedup, val set 5.319x speedup, step: 3
Epoch 13/300 |loss: 0.001950| train set 4.039x speedup, test set 0.792x speedup, val set 4.261x speedup, step: 4
Epoch 14/300 |loss: 0.001898| train set 5.132x speedup, test set 0.845x speedup, val set 5.348x speedup, step: 5
Epoch 15/300 |loss: 0.001860| train set 3.723x speedup, test set 0.700x speedup, val set 3.993x speedup, step: 6
Epoch 16/300 |loss: 0.001823| train set 5.121x speedup, test set 1.059x speedup, val set 5.376x speedup, step: 7
Epoch 17/300 |loss: 0.001584| train set 5.240x speedup, test set 0.914x speedup, val set 5.478x speedup, step: 1
Epoch 18/300 |loss: 0.001489| train set 5.249x speedup, test set 0.674x speedup, val set 5.487x speedup, step: 1
Epoch 19/300 |loss: 0.001300| train set 5.090x speedup, test set 0.857x speedup, val set 5.286x speedup, step: 2
Epoch 20/300 |loss: 0.001386| train set 5.081x speedup, test set 0.653x speedup, val set 5.311x speedup, step: 3
Epoch 21/300 |loss: 0.001360| train set 5.156x speedup, test set 0.790x speedup, val set 5.408x speedup, step: 4
Epoch 22/300 |loss: 0.001426| train set 5.239x speedup, test set 0.802x speedup, val set 5.479x speedup, step: 5
Epoch 23/300 |loss: 0.001376| train set 5.112x speedup, test set 0.718x speedup, val set 5.355x speedup, step: 6
Epoch 24/300 |loss: 0.001213| train set 5.122x speedup, test set 0.718x speedup, val set 5.318x speedup, step: 7
Epoch 25/300 |loss: 0.000830| train set 5.242x speedup, test set 0.706x speedup, val set 5.481x speedup, step: 8
Epoch 26/300 |loss: 0.000785| train set 5.249x speedup, test set 0.765x speedup, val set 5.487x speedup, step: 1
Epoch 27/300 |loss: 0.000800| train set 5.247x speedup, test set 0.791x speedup, val set 5.485x speedup, step: 2
Epoch 28/300 |loss: 0.000851| train set 5.248x speedup, test set 0.706x speedup, val set 5.487x speedup, step: 3
Epoch 29/300 |loss: 0.001069| train set 5.210x speedup, test set 0.714x speedup, val set 5.392x speedup, step: 4
Epoch 30/300 |loss: 0.000835| train set 5.247x speedup, test set 0.548x speedup, val set 5.485x speedup, step: 5
Epoch 31/300 |loss: 0.001121| train set 5.187x speedup, test set 0.685x speedup, val set 5.435x speedup, step: 6
Epoch 32/300 |loss: 0.000838| train set 5.249x speedup, test set 0.695x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000684| train set 5.244x speedup, test set 0.697x speedup, val set 5.473x speedup, step: 2
Epoch 34/300 |loss: 0.000660| train set 5.247x speedup, test set 0.694x speedup, val set 5.485x speedup, step: 3
Epoch 35/300 |loss: 0.000662| train set 5.211x speedup, test set 0.720x speedup, val set 5.389x speedup, step: 4
Epoch 36/300 |loss: 0.000759| train set 5.249x speedup, test set 0.698x speedup, val set 5.487x speedup, step: 1
Epoch 37/300 |loss: 0.001718| train set 5.249x speedup, test set 0.716x speedup, val set 5.487x speedup, step: 2
Epoch 38/300 |loss: 0.000824| train set 5.222x speedup, test set 0.695x speedup, val set 5.471x speedup, step: 3
Epoch 39/300 |loss: 0.000676| train set 5.244x speedup, test set 0.697x speedup, val set 5.473x speedup, step: 4
Epoch 40/300 |loss: 0.000593| train set 5.246x speedup, test set 0.697x speedup, val set 5.485x speedup, step: 5
Epoch 41/300 |loss: 0.000616| train set 5.220x speedup, test set 0.695x speedup, val set 5.451x speedup, step: 6
Epoch 42/300 |loss: 0.000634| train set 5.249x speedup, test set 0.681x speedup, val set 5.487x speedup, step: 7
Epoch 43/300 |loss: 0.000639| train set 5.243x speedup, test set 0.683x speedup, val set 5.461x speedup, step: 8
Epoch 44/300 |loss: 0.000569| train set 5.245x speedup, test set 0.682x speedup, val set 5.476x speedup, step: 9
Epoch 45/300 |loss: 0.000620| train set 5.248x speedup, test set 0.531x speedup, val set 5.487x speedup, step: 10
Epoch 46/300 |loss: 0.000676| train set 5.239x speedup, test set 0.665x speedup, val set 5.479x speedup, step: 11
Epoch 47/300 |loss: 0.000691| train set 5.244x speedup, test set 0.692x speedup, val set 5.476x speedup, step: 12
Epoch 48/300 |loss: 0.000615| train set 5.227x speedup, test set 0.692x speedup, val set 5.456x speedup, step: 13
Epoch 49/300 |loss: 0.000618| train set 5.242x speedup, test set 0.692x speedup, val set 5.481x speedup, step: 14
early stopping at epoch 49
Training per epoch cost 0.644 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.885s, pg runtime 2.718s, speedup 0.942x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.418s, pg runtime 0.354s, speedup 0.847x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.089s, pg runtime 0.089s, speedup 1.000x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 2.408s, pg runtime 2.389s, speedup 0.992x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 35.640s, pg runtime 6.444s, speedup 0.181x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 18, train speedup 5.249, test speedup 0.674, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 36, train speedup 5.249, test speedup 0.698, val speedup 5.487
last model at epoch 49, train speedup 5.242, test speedup 0.692, val speedup 5.481
execution cost 0:01:53.330809
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.545849, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014864| train set 2.868x speedup, test set 0.984x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008820| train set 3.281x speedup, test set 0.895x speedup, val set 3.476x speedup, step: 1
Epoch 3/300 |loss: 0.005955| train set 3.567x speedup, test set 1.141x speedup, val set 3.913x speedup, step: 1
Epoch 4/300 |loss: 0.004536| train set 3.317x speedup, test set 0.890x speedup, val set 3.565x speedup, step: 2
Epoch 5/300 |loss: 0.004233| train set 3.584x speedup, test set 1.283x speedup, val set 3.909x speedup, step: 3
Epoch 6/300 |loss: 0.003502| train set 4.553x speedup, test set 1.100x speedup, val set 4.943x speedup, step: 1
Epoch 7/300 |loss: 0.005647| train set 3.710x speedup, test set 0.757x speedup, val set 3.987x speedup, step: 2
Epoch 8/300 |loss: 0.003194| train set 3.752x speedup, test set 1.324x speedup, val set 3.945x speedup, step: 3
Epoch 9/300 |loss: 0.002490| train set 3.633x speedup, test set 1.264x speedup, val set 3.948x speedup, step: 4
Epoch 10/300 |loss: 0.002464| train set 5.201x speedup, test set 0.916x speedup, val set 5.445x speedup, step: 1
Epoch 11/300 |loss: 0.002941| train set 3.939x speedup, test set 0.710x speedup, val set 4.129x speedup, step: 2
Epoch 12/300 |loss: 0.003623| train set 5.060x speedup, test set 0.825x speedup, val set 5.234x speedup, step: 3
Epoch 13/300 |loss: 0.001951| train set 3.988x speedup, test set 0.638x speedup, val set 4.197x speedup, step: 4
Epoch 14/300 |loss: 0.001962| train set 5.037x speedup, test set 0.810x speedup, val set 5.276x speedup, step: 5
Epoch 15/300 |loss: 0.001891| train set 3.852x speedup, test set 0.678x speedup, val set 4.448x speedup, step: 6
Epoch 16/300 |loss: 0.001788| train set 5.134x speedup, test set 0.827x speedup, val set 5.397x speedup, step: 7
Epoch 17/300 |loss: 0.001658| train set 5.202x speedup, test set 0.953x speedup, val set 5.381x speedup, step: 8
Epoch 18/300 |loss: 0.001574| train set 5.211x speedup, test set 0.680x speedup, val set 5.389x speedup, step: 9
Epoch 19/300 |loss: 0.001347| train set 5.084x speedup, test set 0.684x speedup, val set 5.282x speedup, step: 10
Epoch 20/300 |loss: 0.001446| train set 5.155x speedup, test set 0.657x speedup, val set 5.381x speedup, step: 11
Epoch 21/300 |loss: 0.001349| train set 5.247x speedup, test set 0.661x speedup, val set 5.484x speedup, step: 1
Epoch 22/300 |loss: 0.001513| train set 5.239x speedup, test set 0.790x speedup, val set 5.480x speedup, step: 2
Epoch 23/300 |loss: 0.001335| train set 5.108x speedup, test set 0.660x speedup, val set 5.355x speedup, step: 3
Epoch 24/300 |loss: 0.001221| train set 5.122x speedup, test set 0.708x speedup, val set 5.318x speedup, step: 4
Epoch 25/300 |loss: 0.000885| train set 5.166x speedup, test set 0.665x speedup, val set 5.416x speedup, step: 5
Epoch 26/300 |loss: 0.001012| train set 5.224x speedup, test set 0.669x speedup, val set 5.473x speedup, step: 6
Epoch 27/300 |loss: 0.001156| train set 5.128x speedup, test set 0.663x speedup, val set 5.382x speedup, step: 7
Epoch 28/300 |loss: 0.000817| train set 5.248x speedup, test set 0.665x speedup, val set 5.487x speedup, step: 1
Epoch 29/300 |loss: 0.000900| train set 5.208x speedup, test set 0.664x speedup, val set 5.386x speedup, step: 2
Epoch 30/300 |loss: 0.000858| train set 5.244x speedup, test set 0.657x speedup, val set 5.473x speedup, step: 3
Epoch 31/300 |loss: 0.001320| train set 5.193x speedup, test set 0.664x speedup, val set 5.440x speedup, step: 4
Epoch 32/300 |loss: 0.000928| train set 5.247x speedup, test set 0.668x speedup, val set 5.485x speedup, step: 5
Epoch 33/300 |loss: 0.000670| train set 5.247x speedup, test set 0.663x speedup, val set 5.487x speedup, step: 6
Epoch 34/300 |loss: 0.000670| train set 5.178x speedup, test set 0.663x speedup, val set 5.368x speedup, step: 7
Epoch 35/300 |loss: 0.000678| train set 5.209x speedup, test set 0.662x speedup, val set 5.379x speedup, step: 8
Epoch 36/300 |loss: 0.000771| train set 5.249x speedup, test set 0.658x speedup, val set 5.487x speedup, step: 9
Epoch 37/300 |loss: 0.001540| train set 5.246x speedup, test set 0.677x speedup, val set 5.484x speedup, step: 10
Epoch 38/300 |loss: 0.000777| train set 5.244x speedup, test set 0.664x speedup, val set 5.473x speedup, step: 11
Epoch 39/300 |loss: 0.000646| train set 5.244x speedup, test set 0.664x speedup, val set 5.473x speedup, step: 12
Epoch 40/300 |loss: 0.000605| train set 5.246x speedup, test set 0.666x speedup, val set 5.485x speedup, step: 13
Epoch 41/300 |loss: 0.000629| train set 5.225x speedup, test set 0.666x speedup, val set 5.462x speedup, step: 14
Epoch 42/300 |loss: 0.000602| train set 5.244x speedup, test set 0.658x speedup, val set 5.473x speedup, step: 15
Epoch 43/300 |loss: 0.000636| train set 5.244x speedup, test set 0.649x speedup, val set 5.473x speedup, step: 16
Epoch 44/300 |loss: 0.000586| train set 5.242x speedup, test set 0.659x speedup, val set 5.473x speedup, step: 17
Epoch 45/300 |loss: 0.000619| train set 5.249x speedup, test set 0.664x speedup, val set 5.487x speedup, step: 18
Epoch 46/300 |loss: 0.000667| train set 5.239x speedup, test set 0.664x speedup, val set 5.479x speedup, step: 19
Epoch 47/300 |loss: 0.000648| train set 5.247x speedup, test set 0.665x speedup, val set 5.487x speedup, step: 20
Epoch 48/300 |loss: 0.000640| train set 5.224x speedup, test set 0.664x speedup, val set 5.445x speedup, step: 21
Epoch 49/300 |loss: 0.000623| train set 5.242x speedup, test set 0.666x speedup, val set 5.481x speedup, step: 22
early stopping at epoch 49
Training per epoch cost 0.625 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.675s, pg runtime 1.680s, speedup 1.003x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.885s, pg runtime 2.718s, speedup 0.942x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.418s, pg runtime 0.354s, speedup 0.847x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.214s, pg runtime 0.158s, speedup 0.739x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 36, train speedup 5.249, test speedup 0.658, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 28, train speedup 5.248, test speedup 0.665, val speedup 5.487
last model at epoch 49, train speedup 5.242, test speedup 0.666, val speedup 5.481
execution cost 0:01:49.804661
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.934745, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014866| train set 2.868x speedup, test set 0.846x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008700| train set 3.373x speedup, test set 0.895x speedup, val set 3.645x speedup, step: 1
Epoch 3/300 |loss: 0.006219| train set 3.633x speedup, test set 1.162x speedup, val set 3.943x speedup, step: 1
Epoch 4/300 |loss: 0.004427| train set 3.302x speedup, test set 1.246x speedup, val set 3.568x speedup, step: 2
Epoch 5/300 |loss: 0.004491| train set 3.594x speedup, test set 1.196x speedup, val set 3.892x speedup, step: 3
Epoch 6/300 |loss: 0.003355| train set 3.996x speedup, test set 1.199x speedup, val set 4.322x speedup, step: 1
Epoch 7/300 |loss: 0.005272| train set 3.965x speedup, test set 0.944x speedup, val set 4.195x speedup, step: 2
Epoch 8/300 |loss: 0.003038| train set 4.664x speedup, test set 1.211x speedup, val set 5.056x speedup, step: 1
Epoch 9/300 |loss: 0.002479| train set 4.097x speedup, test set 1.271x speedup, val set 4.683x speedup, step: 2
Epoch 10/300 |loss: 0.002515| train set 4.640x speedup, test set 0.866x speedup, val set 5.025x speedup, step: 3
Epoch 11/300 |loss: 0.002861| train set 3.711x speedup, test set 0.714x speedup, val set 3.885x speedup, step: 4
Epoch 12/300 |loss: 0.003779| train set 5.110x speedup, test set 0.926x speedup, val set 5.374x speedup, step: 1
Epoch 13/300 |loss: 0.001946| train set 4.267x speedup, test set 0.746x speedup, val set 5.345x speedup, step: 2
Epoch 14/300 |loss: 0.001966| train set 5.037x speedup, test set 0.871x speedup, val set 5.276x speedup, step: 3
Epoch 15/300 |loss: 0.001904| train set 3.973x speedup, test set 0.716x speedup, val set 4.164x speedup, step: 4
Epoch 16/300 |loss: 0.001769| train set 5.121x speedup, test set 0.995x speedup, val set 5.376x speedup, step: 1
Epoch 17/300 |loss: 0.001577| train set 5.240x speedup, test set 0.852x speedup, val set 5.479x speedup, step: 1
Epoch 18/300 |loss: 0.001613| train set 5.239x speedup, test set 0.707x speedup, val set 5.480x speedup, step: 1
Epoch 19/300 |loss: 0.001370| train set 5.127x speedup, test set 0.670x speedup, val set 5.382x speedup, step: 2
Epoch 20/300 |loss: 0.001438| train set 5.081x speedup, test set 0.677x speedup, val set 5.311x speedup, step: 3
Epoch 21/300 |loss: 0.001384| train set 5.156x speedup, test set 0.653x speedup, val set 5.408x speedup, step: 4
Epoch 22/300 |loss: 0.001349| train set 5.247x speedup, test set 0.676x speedup, val set 5.485x speedup, step: 1
Epoch 23/300 |loss: 0.001267| train set 5.069x speedup, test set 0.761x speedup, val set 5.261x speedup, step: 2
Epoch 24/300 |loss: 0.001133| train set 5.129x speedup, test set 0.675x speedup, val set 5.320x speedup, step: 3
Epoch 25/300 |loss: 0.000776| train set 5.165x speedup, test set 0.794x speedup, val set 5.415x speedup, step: 4
Epoch 26/300 |loss: 0.000942| train set 5.249x speedup, test set 0.678x speedup, val set 5.487x speedup, step: 1
Epoch 27/300 |loss: 0.001061| train set 5.240x speedup, test set 0.748x speedup, val set 5.479x speedup, step: 2
Epoch 28/300 |loss: 0.000863| train set 5.161x speedup, test set 0.678x speedup, val set 5.322x speedup, step: 3
Epoch 29/300 |loss: 0.001002| train set 5.208x speedup, test set 0.650x speedup, val set 5.386x speedup, step: 4
Epoch 30/300 |loss: 0.000728| train set 5.244x speedup, test set 0.666x speedup, val set 5.473x speedup, step: 5
Epoch 31/300 |loss: 0.000964| train set 5.247x speedup, test set 0.648x speedup, val set 5.484x speedup, step: 6
Epoch 32/300 |loss: 0.000716| train set 5.249x speedup, test set 0.651x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000628| train set 5.244x speedup, test set 0.647x speedup, val set 5.473x speedup, step: 2
Epoch 34/300 |loss: 0.000637| train set 5.211x speedup, test set 0.650x speedup, val set 5.389x speedup, step: 3
Epoch 35/300 |loss: 0.000651| train set 5.209x speedup, test set 0.650x speedup, val set 5.387x speedup, step: 4
Epoch 36/300 |loss: 0.000710| train set 5.239x speedup, test set 0.650x speedup, val set 5.479x speedup, step: 5
Epoch 37/300 |loss: 0.001471| train set 5.248x speedup, test set 0.642x speedup, val set 5.490x speedup, step: 1
Epoch 38/300 |loss: 0.000672| train set 5.244x speedup, test set 0.645x speedup, val set 5.476x speedup, step: 2
Epoch 39/300 |loss: 0.000644| train set 5.209x speedup, test set 0.636x speedup, val set 5.386x speedup, step: 3
Epoch 40/300 |loss: 0.000648| train set 5.213x speedup, test set 0.643x speedup, val set 5.374x speedup, step: 4
Epoch 41/300 |loss: 0.000583| train set 5.249x speedup, test set 0.645x speedup, val set 5.487x speedup, step: 5
Epoch 42/300 |loss: 0.000681| train set 5.244x speedup, test set 0.645x speedup, val set 5.473x speedup, step: 6
Epoch 43/300 |loss: 0.000614| train set 5.246x speedup, test set 0.653x speedup, val set 5.457x speedup, step: 7
Epoch 44/300 |loss: 0.000636| train set 5.242x speedup, test set 0.637x speedup, val set 5.473x speedup, step: 8
Epoch 45/300 |loss: 0.000835| train set 5.248x speedup, test set 0.629x speedup, val set 5.489x speedup, step: 9
Epoch 46/300 |loss: 0.000636| train set 5.239x speedup, test set 0.643x speedup, val set 5.479x speedup, step: 10
Epoch 47/300 |loss: 0.000637| train set 5.244x speedup, test set 0.640x speedup, val set 5.473x speedup, step: 11
Epoch 48/300 |loss: 0.000628| train set 5.228x speedup, test set 0.627x speedup, val set 5.461x speedup, step: 12
Epoch 49/300 |loss: 0.000598| train set 5.242x speedup, test set 0.639x speedup, val set 5.481x speedup, step: 13
Epoch 50/300 |loss: 0.001509| train set 5.219x speedup, test set 0.629x speedup, val set 5.462x speedup, step: 14
early stopping at epoch 50
Training per epoch cost 0.624 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 8.321s, pg runtime 4.730s, speedup 0.568x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.938s, pg runtime 3.112s, speedup 1.059x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 26, train speedup 5.249, test speedup 0.678, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 37, train speedup 5.248, test speedup 0.642, val speedup 5.490
last model at epoch 50, train speedup 5.219, test speedup 0.629, val speedup 5.462
execution cost 0:01:52.555178
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:01.080434, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014866| train set 2.868x speedup, test set 0.846x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008700| train set 3.373x speedup, test set 0.895x speedup, val set 3.645x speedup, step: 1
Epoch 3/300 |loss: 0.006219| train set 3.633x speedup, test set 1.162x speedup, val set 3.943x speedup, step: 1
Epoch 4/300 |loss: 0.004422| train set 3.302x speedup, test set 1.246x speedup, val set 3.568x speedup, step: 2
Epoch 5/300 |loss: 0.004457| train set 3.594x speedup, test set 1.163x speedup, val set 3.892x speedup, step: 3
Epoch 6/300 |loss: 0.003357| train set 3.996x speedup, test set 1.112x speedup, val set 4.322x speedup, step: 1
Epoch 7/300 |loss: 0.005501| train set 3.977x speedup, test set 0.904x speedup, val set 4.212x speedup, step: 2
Epoch 8/300 |loss: 0.003020| train set 3.633x speedup, test set 1.285x speedup, val set 3.946x speedup, step: 3
Epoch 9/300 |loss: 0.002446| train set 4.433x speedup, test set 0.884x speedup, val set 5.350x speedup, step: 1
Epoch 10/300 |loss: 0.002510| train set 5.201x speedup, test set 0.977x speedup, val set 5.445x speedup, step: 1
Epoch 11/300 |loss: 0.002967| train set 3.636x speedup, test set 0.714x speedup, val set 3.789x speedup, step: 2
Epoch 12/300 |loss: 0.003735| train set 5.091x speedup, test set 1.203x speedup, val set 5.347x speedup, step: 3
Epoch 13/300 |loss: 0.001931| train set 5.153x speedup, test set 0.936x speedup, val set 5.372x speedup, step: 4
Epoch 14/300 |loss: 0.001940| train set 5.042x speedup, test set 0.908x speedup, val set 5.268x speedup, step: 5
Epoch 15/300 |loss: 0.001947| train set 3.727x speedup, test set 0.713x speedup, val set 3.996x speedup, step: 6
Epoch 16/300 |loss: 0.001734| train set 5.141x speedup, test set 0.998x speedup, val set 5.402x speedup, step: 7
Epoch 17/300 |loss: 0.001603| train set 5.202x speedup, test set 1.003x speedup, val set 5.381x speedup, step: 8
Epoch 18/300 |loss: 0.001561| train set 5.249x speedup, test set 0.706x speedup, val set 5.487x speedup, step: 1
Epoch 19/300 |loss: 0.001368| train set 5.127x speedup, test set 0.681x speedup, val set 5.382x speedup, step: 2
Epoch 20/300 |loss: 0.001454| train set 5.076x speedup, test set 0.663x speedup, val set 5.306x speedup, step: 3
Epoch 21/300 |loss: 0.001470| train set 5.238x speedup, test set 0.667x speedup, val set 5.479x speedup, step: 4
Epoch 22/300 |loss: 0.001466| train set 5.218x speedup, test set 0.788x speedup, val set 5.451x speedup, step: 5
Epoch 23/300 |loss: 0.001299| train set 5.076x speedup, test set 0.668x speedup, val set 5.262x speedup, step: 6
Epoch 24/300 |loss: 0.001247| train set 5.122x speedup, test set 0.664x speedup, val set 5.314x speedup, step: 7
Epoch 25/300 |loss: 0.000904| train set 5.166x speedup, test set 0.660x speedup, val set 5.415x speedup, step: 8
Epoch 26/300 |loss: 0.000875| train set 5.245x speedup, test set 0.658x speedup, val set 5.483x speedup, step: 9
Epoch 27/300 |loss: 0.000899| train set 5.240x speedup, test set 0.665x speedup, val set 5.479x speedup, step: 10
Epoch 28/300 |loss: 0.000823| train set 5.243x speedup, test set 0.666x speedup, val set 5.484x speedup, step: 11
Epoch 29/300 |loss: 0.001009| train set 5.222x speedup, test set 0.643x speedup, val set 5.473x speedup, step: 12
Epoch 30/300 |loss: 0.000771| train set 5.239x speedup, test set 0.684x speedup, val set 5.479x speedup, step: 13
Epoch 31/300 |loss: 0.001086| train set 5.219x speedup, test set 0.767x speedup, val set 5.465x speedup, step: 14
Epoch 32/300 |loss: 0.000858| train set 5.249x speedup, test set 0.650x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000640| train set 5.242x speedup, test set 0.638x speedup, val set 5.470x speedup, step: 2
Epoch 34/300 |loss: 0.000653| train set 5.222x speedup, test set 0.662x speedup, val set 5.471x speedup, step: 3
Epoch 35/300 |loss: 0.000688| train set 5.248x speedup, test set 0.668x speedup, val set 5.490x speedup, step: 1
Epoch 36/300 |loss: 0.000769| train set 5.249x speedup, test set 0.664x speedup, val set 5.487x speedup, step: 2
Epoch 37/300 |loss: 0.001958| train set 5.240x speedup, test set 0.668x speedup, val set 5.482x speedup, step: 3
Epoch 38/300 |loss: 0.000749| train set 5.244x speedup, test set 0.656x speedup, val set 5.473x speedup, step: 4
Epoch 39/300 |loss: 0.000613| train set 5.209x speedup, test set 0.662x speedup, val set 5.387x speedup, step: 5
Epoch 40/300 |loss: 0.000608| train set 5.247x speedup, test set 0.668x speedup, val set 5.487x speedup, step: 6
Epoch 41/300 |loss: 0.000605| train set 5.228x speedup, test set 0.656x speedup, val set 5.474x speedup, step: 7
Epoch 42/300 |loss: 0.000603| train set 5.249x speedup, test set 0.662x speedup, val set 5.487x speedup, step: 8
Epoch 43/300 |loss: 0.000662| train set 5.247x speedup, test set 0.662x speedup, val set 5.484x speedup, step: 9
Epoch 44/300 |loss: 0.000572| train set 5.246x speedup, test set 0.662x speedup, val set 5.485x speedup, step: 10
Epoch 45/300 |loss: 0.000596| train set 5.248x speedup, test set 0.665x speedup, val set 5.487x speedup, step: 11
Epoch 46/300 |loss: 0.000612| train set 5.247x speedup, test set 0.662x speedup, val set 5.485x speedup, step: 12
Epoch 47/300 |loss: 0.000626| train set 5.247x speedup, test set 0.662x speedup, val set 5.485x speedup, step: 13
Epoch 48/300 |loss: 0.000635| train set 5.248x speedup, test set 0.667x speedup, val set 5.485x speedup, step: 14
early stopping at epoch 48
Training per epoch cost 0.868 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.083s, pg runtime 0.089s, speedup 1.083x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 18, train speedup 5.249, test speedup 0.706, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 35, train speedup 5.248, test speedup 0.668, val speedup 5.490
last model at epoch 48, train speedup 5.248, test speedup 0.667, val speedup 5.485
execution cost 0:02:11.234301
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.946320, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014859| train set 2.871x speedup, test set 0.984x speedup, val set 2.899x speedup, step: 1
Epoch 2/300 |loss: 0.008719| train set 3.465x speedup, test set 0.911x speedup, val set 3.559x speedup, step: 1
Epoch 3/300 |loss: 0.006220| train set 3.558x speedup, test set 1.158x speedup, val set 3.902x speedup, step: 1
Epoch 4/300 |loss: 0.004447| train set 3.350x speedup, test set 0.872x speedup, val set 3.572x speedup, step: 2
Epoch 5/300 |loss: 0.004432| train set 3.632x speedup, test set 0.898x speedup, val set 3.937x speedup, step: 1
Epoch 6/300 |loss: 0.003797| train set 4.569x speedup, test set 1.094x speedup, val set 4.966x speedup, step: 1
Epoch 7/300 |loss: 0.004872| train set 3.934x speedup, test set 0.935x speedup, val set 4.151x speedup, step: 2
Epoch 8/300 |loss: 0.003197| train set 3.645x speedup, test set 1.186x speedup, val set 3.955x speedup, step: 3
Epoch 9/300 |loss: 0.002554| train set 3.631x speedup, test set 0.864x speedup, val set 3.936x speedup, step: 4
Epoch 10/300 |loss: 0.002508| train set 5.214x speedup, test set 0.881x speedup, val set 5.468x speedup, step: 1
Epoch 11/300 |loss: 0.002749| train set 4.031x speedup, test set 0.701x speedup, val set 4.247x speedup, step: 2
Epoch 12/300 |loss: 0.003802| train set 5.103x speedup, test set 0.879x speedup, val set 5.371x speedup, step: 3
Epoch 13/300 |loss: 0.002138| train set 3.715x speedup, test set 0.745x speedup, val set 3.889x speedup, step: 4
Epoch 14/300 |loss: 0.001949| train set 5.161x speedup, test set 0.858x speedup, val set 5.380x speedup, step: 5
Epoch 15/300 |loss: 0.001979| train set 3.662x speedup, test set 0.724x speedup, val set 3.815x speedup, step: 6
Epoch 16/300 |loss: 0.001883| train set 5.115x speedup, test set 0.979x speedup, val set 5.370x speedup, step: 7
Epoch 17/300 |loss: 0.001680| train set 5.105x speedup, test set 0.810x speedup, val set 5.422x speedup, step: 8
Epoch 18/300 |loss: 0.001641| train set 4.290x speedup, test set 0.680x speedup, val set 5.458x speedup, step: 9
Epoch 19/300 |loss: 0.001426| train set 5.127x speedup, test set 0.675x speedup, val set 5.382x speedup, step: 10
Epoch 20/300 |loss: 0.001572| train set 5.053x speedup, test set 0.711x speedup, val set 5.286x speedup, step: 11
Epoch 21/300 |loss: 0.001497| train set 5.227x speedup, test set 0.670x speedup, val set 5.456x speedup, step: 12
Epoch 22/300 |loss: 0.001495| train set 5.214x speedup, test set 0.672x speedup, val set 5.465x speedup, step: 13
Epoch 23/300 |loss: 0.001410| train set 5.140x speedup, test set 0.680x speedup, val set 5.387x speedup, step: 14
Epoch 24/300 |loss: 0.001397| train set 4.455x speedup, test set 0.701x speedup, val set 5.315x speedup, step: 15
Epoch 25/300 |loss: 0.000966| train set 5.122x speedup, test set 0.709x speedup, val set 5.317x speedup, step: 16
Epoch 26/300 |loss: 0.000912| train set 5.248x speedup, test set 0.802x speedup, val set 5.487x speedup, step: 1
Epoch 27/300 |loss: 0.001074| train set 5.240x speedup, test set 0.708x speedup, val set 5.479x speedup, step: 2
Epoch 28/300 |loss: 0.000888| train set 5.249x speedup, test set 0.690x speedup, val set 5.487x speedup, step: 3
Epoch 29/300 |loss: 0.000965| train set 5.248x speedup, test set 0.687x speedup, val set 5.487x speedup, step: 1
Epoch 30/300 |loss: 0.000771| train set 5.239x speedup, test set 0.679x speedup, val set 5.479x speedup, step: 2
Epoch 31/300 |loss: 0.000854| train set 5.249x speedup, test set 0.682x speedup, val set 5.487x speedup, step: 3
Epoch 32/300 |loss: 0.000792| train set 5.244x speedup, test set 0.631x speedup, val set 5.476x speedup, step: 4
Epoch 33/300 |loss: 0.000659| train set 5.239x speedup, test set 0.657x speedup, val set 5.479x speedup, step: 5
Epoch 34/300 |loss: 0.000671| train set 5.222x speedup, test set 0.657x speedup, val set 5.470x speedup, step: 6
Epoch 35/300 |loss: 0.000708| train set 5.247x speedup, test set 0.657x speedup, val set 5.485x speedup, step: 7
Epoch 36/300 |loss: 0.000697| train set 5.249x speedup, test set 0.649x speedup, val set 5.487x speedup, step: 8
Epoch 37/300 |loss: 0.001540| train set 5.246x speedup, test set 0.682x speedup, val set 5.489x speedup, step: 1
Epoch 38/300 |loss: 0.000756| train set 5.253x speedup, test set 0.684x speedup, val set 5.459x speedup, step: 2
Epoch 39/300 |loss: 0.000634| train set 5.247x speedup, test set 0.690x speedup, val set 5.484x speedup, step: 3
Epoch 40/300 |loss: 0.000622| train set 5.210x speedup, test set 0.674x speedup, val set 5.372x speedup, step: 4
Epoch 41/300 |loss: 0.000599| train set 5.249x speedup, test set 0.649x speedup, val set 5.487x speedup, step: 5
Epoch 42/300 |loss: 0.000668| train set 5.239x speedup, test set 0.651x speedup, val set 5.479x speedup, step: 6
Epoch 43/300 |loss: 0.000652| train set 5.247x speedup, test set 0.659x speedup, val set 5.484x speedup, step: 7
Epoch 44/300 |loss: 0.000615| train set 5.246x speedup, test set 0.636x speedup, val set 5.485x speedup, step: 8
Epoch 45/300 |loss: 0.000657| train set 5.248x speedup, test set 0.640x speedup, val set 5.489x speedup, step: 1
Epoch 46/300 |loss: 0.000658| train set 5.239x speedup, test set 0.639x speedup, val set 5.480x speedup, step: 2
Epoch 47/300 |loss: 0.000610| train set 5.247x speedup, test set 0.662x speedup, val set 5.484x speedup, step: 3
Epoch 48/300 |loss: 0.000690| train set 5.228x speedup, test set 0.670x speedup, val set 5.459x speedup, step: 4
Epoch 49/300 |loss: 0.000672| train set 5.242x speedup, test set 0.667x speedup, val set 5.484x speedup, step: 5
early stopping at epoch 49
Training per epoch cost 0.733 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.938s, pg runtime 3.112s, speedup 1.059x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.256s, pg runtime 0.158s, speedup 0.620x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 5.253, test speedup 0.684, val speedup 5.459
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 45, train speedup 5.248, test speedup 0.640, val speedup 5.489
last model at epoch 49, train speedup 5.242, test speedup 0.667, val speedup 5.484
execution cost 0:02:00.470595
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.857304, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014866| train set 2.868x speedup, test set 0.846x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008730| train set 3.373x speedup, test set 0.895x speedup, val set 3.645x speedup, step: 1
Epoch 3/300 |loss: 0.006215| train set 3.567x speedup, test set 1.092x speedup, val set 3.913x speedup, step: 1
Epoch 4/300 |loss: 0.004403| train set 3.344x speedup, test set 0.867x speedup, val set 3.568x speedup, step: 2
Epoch 5/300 |loss: 0.004347| train set 3.594x speedup, test set 1.175x speedup, val set 3.892x speedup, step: 3
Epoch 6/300 |loss: 0.003469| train set 4.553x speedup, test set 1.095x speedup, val set 4.943x speedup, step: 1
Epoch 7/300 |loss: 0.005551| train set 3.955x speedup, test set 0.942x speedup, val set 4.154x speedup, step: 2
Epoch 8/300 |loss: 0.003077| train set 3.629x speedup, test set 1.288x speedup, val set 3.943x speedup, step: 3
Epoch 9/300 |loss: 0.002467| train set 3.902x speedup, test set 0.904x speedup, val set 4.121x speedup, step: 4
Epoch 10/300 |loss: 0.002624| train set 5.201x speedup, test set 1.534x speedup, val set 5.445x speedup, step: 1
Epoch 11/300 |loss: 0.003119| train set 3.946x speedup, test set 0.922x speedup, val set 4.178x speedup, step: 2
Epoch 12/300 |loss: 0.003810| train set 5.026x speedup, test set 0.939x speedup, val set 5.252x speedup, step: 3
Epoch 13/300 |loss: 0.001976| train set 5.247x speedup, test set 0.717x speedup, val set 5.487x speedup, step: 1
Epoch 14/300 |loss: 0.001962| train set 5.044x speedup, test set 0.688x speedup, val set 5.279x speedup, step: 2
Epoch 15/300 |loss: 0.001889| train set 3.650x speedup, test set 0.723x speedup, val set 3.805x speedup, step: 3
Epoch 16/300 |loss: 0.001744| train set 5.121x speedup, test set 1.001x speedup, val set 5.378x speedup, step: 4
Epoch 17/300 |loss: 0.001607| train set 5.203x speedup, test set 0.717x speedup, val set 5.479x speedup, step: 5
Epoch 18/300 |loss: 0.001532| train set 4.515x speedup, test set 0.680x speedup, val set 5.381x speedup, step: 6
Epoch 19/300 |loss: 0.001353| train set 5.127x speedup, test set 0.677x speedup, val set 5.382x speedup, step: 7
Epoch 20/300 |loss: 0.001407| train set 5.048x speedup, test set 0.657x speedup, val set 5.282x speedup, step: 8
Epoch 21/300 |loss: 0.001454| train set 5.218x speedup, test set 0.654x speedup, val set 5.466x speedup, step: 9
Epoch 22/300 |loss: 0.001493| train set 5.247x speedup, test set 0.790x speedup, val set 5.484x speedup, step: 10
Epoch 23/300 |loss: 0.001360| train set 5.105x speedup, test set 0.659x speedup, val set 5.352x speedup, step: 11
Epoch 24/300 |loss: 0.001373| train set 5.122x speedup, test set 0.711x speedup, val set 5.322x speedup, step: 12
Epoch 25/300 |loss: 0.000913| train set 5.159x speedup, test set 0.682x speedup, val set 5.410x speedup, step: 13
Epoch 26/300 |loss: 0.000796| train set 5.247x speedup, test set 0.654x speedup, val set 5.484x speedup, step: 14
Epoch 27/300 |loss: 0.000874| train set 5.247x speedup, test set 0.654x speedup, val set 5.484x speedup, step: 15
Epoch 28/300 |loss: 0.000860| train set 5.248x speedup, test set 0.657x speedup, val set 5.489x speedup, step: 1
Epoch 29/300 |loss: 0.000942| train set 5.247x speedup, test set 0.658x speedup, val set 5.487x speedup, step: 2
Epoch 30/300 |loss: 0.000790| train set 5.244x speedup, test set 0.677x speedup, val set 5.473x speedup, step: 3
Epoch 31/300 |loss: 0.001235| train set 5.007x speedup, test set 0.663x speedup, val set 5.286x speedup, step: 4
Epoch 32/300 |loss: 0.000913| train set 5.248x speedup, test set 0.663x speedup, val set 5.487x speedup, step: 5
Epoch 33/300 |loss: 0.000671| train set 5.224x speedup, test set 0.660x speedup, val set 5.445x speedup, step: 6
Epoch 34/300 |loss: 0.000662| train set 5.247x speedup, test set 0.660x speedup, val set 5.485x speedup, step: 7
Epoch 35/300 |loss: 0.000698| train set 5.248x speedup, test set 0.669x speedup, val set 5.490x speedup, step: 1
Epoch 36/300 |loss: 0.000641| train set 5.239x speedup, test set 0.666x speedup, val set 5.479x speedup, step: 2
Epoch 37/300 |loss: 0.001560| train set 5.244x speedup, test set 0.660x speedup, val set 5.476x speedup, step: 3
Epoch 38/300 |loss: 0.000743| train set 5.244x speedup, test set 0.653x speedup, val set 5.473x speedup, step: 4
Epoch 39/300 |loss: 0.000667| train set 5.096x speedup, test set 0.655x speedup, val set 5.353x speedup, step: 5
Epoch 40/300 |loss: 0.000652| train set 5.229x speedup, test set 0.663x speedup, val set 5.456x speedup, step: 6
Epoch 41/300 |loss: 0.000593| train set 5.249x speedup, test set 0.655x speedup, val set 5.487x speedup, step: 7
Epoch 42/300 |loss: 0.000640| train set 5.239x speedup, test set 0.657x speedup, val set 5.479x speedup, step: 8
Epoch 43/300 |loss: 0.000668| train set 5.247x speedup, test set 0.652x speedup, val set 5.484x speedup, step: 9
Epoch 44/300 |loss: 0.000597| train set 5.247x speedup, test set 0.655x speedup, val set 5.485x speedup, step: 10
Epoch 45/300 |loss: 0.000684| train set 5.248x speedup, test set 0.652x speedup, val set 5.487x speedup, step: 11
Epoch 46/300 |loss: 0.000676| train set 5.239x speedup, test set 0.663x speedup, val set 5.479x speedup, step: 12
Epoch 47/300 |loss: 0.000686| train set 5.245x speedup, test set 0.666x speedup, val set 5.481x speedup, step: 13
Epoch 48/300 |loss: 0.000625| train set 5.228x speedup, test set 0.659x speedup, val set 5.459x speedup, step: 14
Epoch 49/300 |loss: 0.000629| train set 5.242x speedup, test set 0.669x speedup, val set 5.481x speedup, step: 15
Epoch 50/300 |loss: 0.001428| train set 5.222x speedup, test set 0.666x speedup, val set 5.473x speedup, step: 16
early stopping at epoch 50
Training per epoch cost 0.851 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.885s, pg runtime 2.718s, speedup 0.942x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.418s, pg runtime 0.354s, speedup 0.847x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.083s, pg runtime 0.089s, speedup 1.083x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 2.408s, pg runtime 2.389s, speedup 0.992x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 41, train speedup 5.249, test speedup 0.655, val speedup 5.487
best test speedup epoch: 10, train speedup 5.201, test speedup 1.534, val speedup 5.445
best validation speedup epoch: 35, train speedup 5.248, test speedup 0.669, val speedup 5.490
last model at epoch 50, train speedup 5.222, test speedup 0.666, val speedup 5.473
execution cost 0:02:14.542503
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.960565, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014864| train set 2.868x speedup, test set 0.984x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008820| train set 3.281x speedup, test set 0.895x speedup, val set 3.476x speedup, step: 1
Epoch 3/300 |loss: 0.005955| train set 3.567x speedup, test set 1.141x speedup, val set 3.913x speedup, step: 1
Epoch 4/300 |loss: 0.004536| train set 3.271x speedup, test set 0.927x speedup, val set 3.565x speedup, step: 2
Epoch 5/300 |loss: 0.004230| train set 3.584x speedup, test set 1.285x speedup, val set 3.909x speedup, step: 3
Epoch 6/300 |loss: 0.003493| train set 4.612x speedup, test set 1.116x speedup, val set 5.025x speedup, step: 1
Epoch 7/300 |loss: 0.005811| train set 3.719x speedup, test set 0.757x speedup, val set 4.025x speedup, step: 2
Epoch 8/300 |loss: 0.003294| train set 4.569x speedup, test set 1.290x speedup, val set 4.966x speedup, step: 3
Epoch 9/300 |loss: 0.002478| train set 3.976x speedup, test set 1.264x speedup, val set 4.205x speedup, step: 4
Epoch 10/300 |loss: 0.002495| train set 5.219x speedup, test set 0.915x speedup, val set 5.469x speedup, step: 1
Epoch 11/300 |loss: 0.002905| train set 3.674x speedup, test set 0.938x speedup, val set 3.836x speedup, step: 2
Epoch 12/300 |loss: 0.003482| train set 5.095x speedup, test set 1.091x speedup, val set 5.231x speedup, step: 3
Epoch 13/300 |loss: 0.001939| train set 4.550x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 14/300 |loss: 0.001895| train set 5.154x speedup, test set 0.822x speedup, val set 5.374x speedup, step: 2
Epoch 15/300 |loss: 0.001879| train set 3.713x speedup, test set 0.690x speedup, val set 3.986x speedup, step: 3
Epoch 16/300 |loss: 0.001798| train set 5.134x speedup, test set 0.971x speedup, val set 5.396x speedup, step: 4
Epoch 17/300 |loss: 0.001549| train set 5.247x speedup, test set 0.920x speedup, val set 5.487x speedup, step: 1
Epoch 18/300 |loss: 0.001485| train set 5.249x speedup, test set 0.687x speedup, val set 5.487x speedup, step: 2
Epoch 19/300 |loss: 0.001331| train set 5.091x speedup, test set 0.687x speedup, val set 5.287x speedup, step: 3
Epoch 20/300 |loss: 0.001343| train set 5.062x speedup, test set 0.676x speedup, val set 5.285x speedup, step: 4
Epoch 21/300 |loss: 0.001351| train set 5.246x speedup, test set 0.656x speedup, val set 5.485x speedup, step: 5
Epoch 22/300 |loss: 0.001329| train set 5.246x speedup, test set 0.791x speedup, val set 5.485x speedup, step: 6
Epoch 23/300 |loss: 0.001304| train set 5.105x speedup, test set 0.718x speedup, val set 5.352x speedup, step: 7
Epoch 24/300 |loss: 0.001162| train set 5.122x speedup, test set 0.711x speedup, val set 5.318x speedup, step: 8
Epoch 25/300 |loss: 0.000841| train set 5.246x speedup, test set 0.669x speedup, val set 5.485x speedup, step: 9
Epoch 26/300 |loss: 0.000943| train set 5.224x speedup, test set 0.767x speedup, val set 5.473x speedup, step: 10
Epoch 27/300 |loss: 0.000837| train set 5.247x speedup, test set 0.937x speedup, val set 5.485x speedup, step: 11
Epoch 28/300 |loss: 0.000882| train set 5.249x speedup, test set 0.719x speedup, val set 5.487x speedup, step: 12
Epoch 29/300 |loss: 0.000960| train set 5.247x speedup, test set 0.697x speedup, val set 5.485x speedup, step: 13
Epoch 30/300 |loss: 0.000847| train set 5.247x speedup, test set 0.539x speedup, val set 5.484x speedup, step: 14
Epoch 31/300 |loss: 0.001419| train set 5.123x speedup, test set 0.786x speedup, val set 5.493x speedup, step: 1
Epoch 32/300 |loss: 0.000904| train set 5.248x speedup, test set 0.539x speedup, val set 5.487x speedup, step: 2
Epoch 33/300 |loss: 0.000663| train set 5.224x speedup, test set 0.695x speedup, val set 5.445x speedup, step: 3
Epoch 34/300 |loss: 0.000661| train set 5.209x speedup, test set 0.695x speedup, val set 5.387x speedup, step: 4
Epoch 35/300 |loss: 0.000686| train set 5.211x speedup, test set 0.701x speedup, val set 5.389x speedup, step: 5
Epoch 36/300 |loss: 0.000698| train set 5.249x speedup, test set 0.668x speedup, val set 5.487x speedup, step: 6
Epoch 37/300 |loss: 0.001517| train set 5.247x speedup, test set 0.697x speedup, val set 5.484x speedup, step: 7
Epoch 38/300 |loss: 0.000725| train set 5.219x speedup, test set 0.538x speedup, val set 5.462x speedup, step: 8
Epoch 39/300 |loss: 0.000647| train set 5.244x speedup, test set 0.669x speedup, val set 5.473x speedup, step: 9
Epoch 40/300 |loss: 0.000603| train set 5.209x speedup, test set 0.697x speedup, val set 5.388x speedup, step: 10
Epoch 41/300 |loss: 0.000607| train set 5.226x speedup, test set 0.539x speedup, val set 5.459x speedup, step: 11
Epoch 42/300 |loss: 0.000623| train set 5.244x speedup, test set 0.697x speedup, val set 5.473x speedup, step: 12
Epoch 43/300 |loss: 0.000627| train set 5.247x speedup, test set 0.697x speedup, val set 5.466x speedup, step: 13
Epoch 44/300 |loss: 0.000586| train set 5.246x speedup, test set 0.669x speedup, val set 5.474x speedup, step: 14
Epoch 45/300 |loss: 0.000594| train set 5.248x speedup, test set 0.539x speedup, val set 5.487x speedup, step: 15
Epoch 46/300 |loss: 0.000647| train set 5.239x speedup, test set 0.667x speedup, val set 5.479x speedup, step: 16
Epoch 47/300 |loss: 0.000666| train set 5.244x speedup, test set 0.537x speedup, val set 5.473x speedup, step: 17
Epoch 48/300 |loss: 0.000660| train set 5.227x speedup, test set 0.539x speedup, val set 5.456x speedup, step: 18
early stopping at epoch 48
Training per epoch cost 0.860 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.885s, pg runtime 2.718s, speedup 0.942x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.418s, pg runtime 0.354s, speedup 0.847x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.089s, pg runtime 0.089s, speedup 1.000x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 2.408s, pg runtime 2.389s, speedup 0.992x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 8.351s, pg runtime 6.444s, speedup 0.772x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 18, train speedup 5.249, test speedup 0.687, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 31, train speedup 5.123, test speedup 0.786, val speedup 5.493
last model at epoch 48, train speedup 5.227, test speedup 0.539, val speedup 5.456
execution cost 0:02:10.252426
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.528489, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014864| train set 2.868x speedup, test set 0.984x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008817| train set 3.281x speedup, test set 0.895x speedup, val set 3.476x speedup, step: 1
Epoch 3/300 |loss: 0.006016| train set 3.567x speedup, test set 1.158x speedup, val set 3.913x speedup, step: 1
Epoch 4/300 |loss: 0.004520| train set 3.347x speedup, test set 1.246x speedup, val set 3.570x speedup, step: 2
Epoch 5/300 |loss: 0.004301| train set 3.327x speedup, test set 1.145x speedup, val set 3.536x speedup, step: 3
Epoch 6/300 |loss: 0.003364| train set 4.553x speedup, test set 1.116x speedup, val set 4.943x speedup, step: 1
Epoch 7/300 |loss: 0.005649| train set 3.977x speedup, test set 0.934x speedup, val set 4.212x speedup, step: 2
Epoch 8/300 |loss: 0.003311| train set 3.627x speedup, test set 1.305x speedup, val set 3.938x speedup, step: 3
Epoch 9/300 |loss: 0.002532| train set 3.635x speedup, test set 1.255x speedup, val set 3.939x speedup, step: 4
Epoch 10/300 |loss: 0.002655| train set 5.203x speedup, test set 1.272x speedup, val set 5.448x speedup, step: 1
Epoch 11/300 |loss: 0.003092| train set 3.692x speedup, test set 0.858x speedup, val set 3.837x speedup, step: 2
Epoch 12/300 |loss: 0.003665| train set 4.558x speedup, test set 1.115x speedup, val set 4.947x speedup, step: 3
Epoch 13/300 |loss: 0.002021| train set 3.722x speedup, test set 0.826x speedup, val set 3.900x speedup, step: 4
Epoch 14/300 |loss: 0.001915| train set 5.125x speedup, test set 0.823x speedup, val set 5.345x speedup, step: 5
Epoch 15/300 |loss: 0.001810| train set 4.703x speedup, test set 0.824x speedup, val set 5.022x speedup, step: 6
Epoch 16/300 |loss: 0.001721| train set 5.057x speedup, test set 1.053x speedup, val set 5.298x speedup, step: 7
Epoch 17/300 |loss: 0.001660| train set 5.222x speedup, test set 0.978x speedup, val set 5.471x speedup, step: 1
Epoch 18/300 |loss: 0.001497| train set 4.365x speedup, test set 0.685x speedup, val set 5.487x speedup, step: 1
Epoch 19/300 |loss: 0.001334| train set 5.127x speedup, test set 0.688x speedup, val set 5.382x speedup, step: 2
Epoch 20/300 |loss: 0.001450| train set 5.029x speedup, test set 0.665x speedup, val set 5.253x speedup, step: 3
Epoch 21/300 |loss: 0.001409| train set 5.247x speedup, test set 0.667x speedup, val set 5.484x speedup, step: 4
Epoch 22/300 |loss: 0.001461| train set 5.247x speedup, test set 0.794x speedup, val set 5.485x speedup, step: 5
Epoch 23/300 |loss: 0.001231| train set 5.136x speedup, test set 0.663x speedup, val set 5.390x speedup, step: 6
Epoch 24/300 |loss: 0.001191| train set 5.126x speedup, test set 0.722x speedup, val set 5.322x speedup, step: 7
Epoch 25/300 |loss: 0.000813| train set 5.165x speedup, test set 0.675x speedup, val set 5.419x speedup, step: 8
Epoch 26/300 |loss: 0.000775| train set 5.248x speedup, test set 0.663x speedup, val set 5.487x speedup, step: 1
Epoch 27/300 |loss: 0.000745| train set 5.240x speedup, test set 0.672x speedup, val set 5.484x speedup, step: 2
Epoch 28/300 |loss: 0.000800| train set 5.161x speedup, test set 0.675x speedup, val set 5.380x speedup, step: 3
Epoch 29/300 |loss: 0.000928| train set 5.202x speedup, test set 0.699x speedup, val set 5.381x speedup, step: 4
Epoch 30/300 |loss: 0.000826| train set 5.247x speedup, test set 0.677x speedup, val set 5.485x speedup, step: 5
Epoch 31/300 |loss: 0.001094| train set 5.193x speedup, test set 0.675x speedup, val set 5.440x speedup, step: 6
Epoch 32/300 |loss: 0.000821| train set 5.210x speedup, test set 0.671x speedup, val set 5.390x speedup, step: 7
Epoch 33/300 |loss: 0.000644| train set 5.244x speedup, test set 0.677x speedup, val set 5.473x speedup, step: 8
Epoch 34/300 |loss: 0.000650| train set 5.222x speedup, test set 0.671x speedup, val set 5.471x speedup, step: 9
Epoch 35/300 |loss: 0.000686| train set 5.210x speedup, test set 0.674x speedup, val set 5.392x speedup, step: 10
Epoch 36/300 |loss: 0.000676| train set 5.249x speedup, test set 0.662x speedup, val set 5.487x speedup, step: 11
Epoch 37/300 |loss: 0.001450| train set 5.244x speedup, test set 0.673x speedup, val set 5.473x speedup, step: 12
Epoch 38/300 |loss: 0.000799| train set 5.247x speedup, test set 0.669x speedup, val set 5.484x speedup, step: 13
Epoch 39/300 |loss: 0.000693| train set 5.247x speedup, test set 0.677x speedup, val set 5.484x speedup, step: 14
Epoch 40/300 |loss: 0.000606| train set 5.248x speedup, test set 0.674x speedup, val set 5.469x speedup, step: 15
Epoch 41/300 |loss: 0.000618| train set 5.249x speedup, test set 0.669x speedup, val set 5.469x speedup, step: 16
Epoch 42/300 |loss: 0.000646| train set 5.157x speedup, test set 0.676x speedup, val set 5.366x speedup, step: 17
Epoch 43/300 |loss: 0.000623| train set 5.239x speedup, test set 0.665x speedup, val set 5.479x speedup, step: 18
Epoch 44/300 |loss: 0.000575| train set 5.247x speedup, test set 0.668x speedup, val set 5.484x speedup, step: 19
Epoch 45/300 |loss: 0.000613| train set 5.248x speedup, test set 0.656x speedup, val set 5.487x speedup, step: 1
Epoch 46/300 |loss: 0.000651| train set 5.239x speedup, test set 0.660x speedup, val set 5.479x speedup, step: 2
Epoch 47/300 |loss: 0.000627| train set 5.247x speedup, test set 0.678x speedup, val set 5.487x speedup, step: 3
Epoch 48/300 |loss: 0.000640| train set 5.218x speedup, test set 0.662x speedup, val set 5.452x speedup, step: 4
Epoch 49/300 |loss: 0.000683| train set 5.242x speedup, test set 0.653x speedup, val set 5.481x speedup, step: 5
early stopping at epoch 49
Training per epoch cost 0.460 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.885s, pg runtime 2.718s, speedup 0.942x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.089s, pg runtime 0.089s, speedup 1.000x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 41, train speedup 5.249, test speedup 0.669, val speedup 5.469
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 45, train speedup 5.248, test speedup 0.656, val speedup 5.487
last model at epoch 49, train speedup 5.242, test speedup 0.653, val speedup 5.481
execution cost 0:00:54.868850
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.535229, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014859| train set 2.871x speedup, test set 0.984x speedup, val set 2.899x speedup, step: 1
Epoch 2/300 |loss: 0.008731| train set 3.568x speedup, test set 0.911x speedup, val set 3.737x speedup, step: 1
Epoch 3/300 |loss: 0.006171| train set 3.350x speedup, test set 1.145x speedup, val set 3.572x speedup, step: 2
Epoch 4/300 |loss: 0.004404| train set 3.350x speedup, test set 1.129x speedup, val set 3.572x speedup, step: 3
Epoch 5/300 |loss: 0.004525| train set 3.552x speedup, test set 1.164x speedup, val set 3.735x speedup, step: 4
Epoch 6/300 |loss: 0.003526| train set 4.553x speedup, test set 1.098x speedup, val set 4.943x speedup, step: 1
Epoch 7/300 |loss: 0.005383| train set 3.955x speedup, test set 0.730x speedup, val set 4.154x speedup, step: 2
Epoch 8/300 |loss: 0.003129| train set 3.622x speedup, test set 1.300x speedup, val set 3.930x speedup, step: 3
Epoch 9/300 |loss: 0.002536| train set 3.513x speedup, test set 1.297x speedup, val set 3.621x speedup, step: 4
Epoch 10/300 |loss: 0.002589| train set 4.657x speedup, test set 1.181x speedup, val set 5.049x speedup, step: 1
Epoch 11/300 |loss: 0.002890| train set 3.711x speedup, test set 0.755x speedup, val set 3.885x speedup, step: 2
Epoch 12/300 |loss: 0.004069| train set 4.572x speedup, test set 1.154x speedup, val set 4.958x speedup, step: 3
Epoch 13/300 |loss: 0.002072| train set 5.247x speedup, test set 0.723x speedup, val set 5.484x speedup, step: 1
Epoch 14/300 |loss: 0.001950| train set 5.044x speedup, test set 0.726x speedup, val set 5.279x speedup, step: 2
Epoch 15/300 |loss: 0.001852| train set 3.652x speedup, test set 0.713x speedup, val set 3.802x speedup, step: 3
Epoch 16/300 |loss: 0.001731| train set 5.145x speedup, test set 0.865x speedup, val set 5.389x speedup, step: 4
Epoch 17/300 |loss: 0.001684| train set 5.178x speedup, test set 0.681x speedup, val set 5.367x speedup, step: 5
Epoch 18/300 |loss: 0.001699| train set 5.132x speedup, test set 0.648x speedup, val set 5.450x speedup, step: 6
Epoch 19/300 |loss: 0.001441| train set 5.135x speedup, test set 0.641x speedup, val set 5.387x speedup, step: 7
Epoch 20/300 |loss: 0.001584| train set 5.052x speedup, test set 0.642x speedup, val set 5.289x speedup, step: 8
Epoch 21/300 |loss: 0.001532| train set 5.239x speedup, test set 0.652x speedup, val set 5.479x speedup, step: 9
Epoch 22/300 |loss: 0.001519| train set 5.223x speedup, test set 0.648x speedup, val set 5.446x speedup, step: 10
Epoch 23/300 |loss: 0.001377| train set 5.104x speedup, test set 0.653x speedup, val set 5.355x speedup, step: 11
Epoch 24/300 |loss: 0.001269| train set 5.122x speedup, test set 0.651x speedup, val set 5.318x speedup, step: 12
Epoch 25/300 |loss: 0.000923| train set 5.165x speedup, test set 0.649x speedup, val set 5.418x speedup, step: 13
Epoch 26/300 |loss: 0.000845| train set 5.249x speedup, test set 0.649x speedup, val set 5.487x speedup, step: 1
Epoch 27/300 |loss: 0.000995| train set 5.240x speedup, test set 0.646x speedup, val set 5.482x speedup, step: 2
Epoch 28/300 |loss: 0.000893| train set 5.123x speedup, test set 0.650x speedup, val set 5.318x speedup, step: 3
Epoch 29/300 |loss: 0.001012| train set 5.246x speedup, test set 0.652x speedup, val set 5.485x speedup, step: 4
Epoch 30/300 |loss: 0.001058| train set 5.247x speedup, test set 0.646x speedup, val set 5.487x speedup, step: 1
Epoch 31/300 |loss: 0.000957| train set 5.203x speedup, test set 0.650x speedup, val set 5.445x speedup, step: 2
Epoch 32/300 |loss: 0.000800| train set 5.249x speedup, test set 0.647x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000623| train set 5.247x speedup, test set 0.649x speedup, val set 5.484x speedup, step: 2
Epoch 34/300 |loss: 0.000632| train set 5.247x speedup, test set 0.649x speedup, val set 5.484x speedup, step: 3
Epoch 35/300 |loss: 0.000709| train set 5.162x speedup, test set 0.677x speedup, val set 5.379x speedup, step: 4
Epoch 36/300 |loss: 0.000688| train set 5.248x speedup, test set 0.649x speedup, val set 5.485x speedup, step: 5
Epoch 37/300 |loss: 0.001548| train set 5.244x speedup, test set 0.651x speedup, val set 5.473x speedup, step: 6
Epoch 38/300 |loss: 0.000718| train set 5.157x speedup, test set 0.652x speedup, val set 5.366x speedup, step: 7
Epoch 39/300 |loss: 0.000642| train set 5.239x speedup, test set 0.649x speedup, val set 5.479x speedup, step: 8
Epoch 40/300 |loss: 0.000604| train set 5.212x speedup, test set 0.652x speedup, val set 5.374x speedup, step: 9
Epoch 41/300 |loss: 0.000592| train set 5.251x speedup, test set 0.651x speedup, val set 5.471x speedup, step: 10
Epoch 42/300 |loss: 0.000647| train set 5.244x speedup, test set 0.651x speedup, val set 5.473x speedup, step: 11
Epoch 43/300 |loss: 0.000660| train set 5.209x speedup, test set 0.651x speedup, val set 5.386x speedup, step: 12
early stopping at epoch 43
Training per epoch cost 0.454 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.418s, pg runtime 0.354s, speedup 0.847x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.083s, pg runtime 0.089s, speedup 1.083x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.938s, pg runtime 3.112s, speedup 1.059x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 41, train speedup 5.251, test speedup 0.651, val speedup 5.471
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 32, train speedup 5.249, test speedup 0.647, val speedup 5.487
last model at epoch 43, train speedup 5.209, test speedup 0.651, val speedup 5.386
execution cost 0:00:48.960663
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.521704, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014866| train set 2.868x speedup, test set 0.846x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008700| train set 3.373x speedup, test set 0.895x speedup, val set 3.645x speedup, step: 1
Epoch 3/300 |loss: 0.006219| train set 3.633x speedup, test set 1.162x speedup, val set 3.943x speedup, step: 1
Epoch 4/300 |loss: 0.004427| train set 3.302x speedup, test set 1.246x speedup, val set 3.568x speedup, step: 2
Epoch 5/300 |loss: 0.004491| train set 3.594x speedup, test set 1.196x speedup, val set 3.892x speedup, step: 3
Epoch 6/300 |loss: 0.003355| train set 3.996x speedup, test set 1.199x speedup, val set 4.322x speedup, step: 1
Epoch 7/300 |loss: 0.005272| train set 3.965x speedup, test set 0.944x speedup, val set 4.195x speedup, step: 2
Epoch 8/300 |loss: 0.003038| train set 4.664x speedup, test set 1.211x speedup, val set 5.056x speedup, step: 1
Epoch 9/300 |loss: 0.002480| train set 4.433x speedup, test set 1.203x speedup, val set 5.352x speedup, step: 1
Epoch 10/300 |loss: 0.002504| train set 4.647x speedup, test set 0.866x speedup, val set 5.029x speedup, step: 2
Epoch 11/300 |loss: 0.002869| train set 3.711x speedup, test set 0.759x speedup, val set 3.886x speedup, step: 3
Epoch 12/300 |loss: 0.003823| train set 5.222x speedup, test set 0.945x speedup, val set 5.470x speedup, step: 1
Epoch 13/300 |loss: 0.001927| train set 5.220x speedup, test set 0.933x speedup, val set 5.450x speedup, step: 2
Epoch 14/300 |loss: 0.001956| train set 5.141x speedup, test set 0.895x speedup, val set 5.356x speedup, step: 3
Epoch 15/300 |loss: 0.001874| train set 3.961x speedup, test set 0.717x speedup, val set 4.149x speedup, step: 4
Epoch 16/300 |loss: 0.001768| train set 5.121x speedup, test set 0.908x speedup, val set 5.376x speedup, step: 5
Epoch 17/300 |loss: 0.001611| train set 5.240x speedup, test set 0.799x speedup, val set 5.478x speedup, step: 1
Epoch 18/300 |loss: 0.001615| train set 5.200x speedup, test set 0.705x speedup, val set 5.382x speedup, step: 2
Epoch 19/300 |loss: 0.001382| train set 5.135x speedup, test set 0.675x speedup, val set 5.387x speedup, step: 3
Epoch 20/300 |loss: 0.001452| train set 5.095x speedup, test set 0.660x speedup, val set 5.291x speedup, step: 4
Epoch 21/300 |loss: 0.001431| train set 5.218x speedup, test set 0.658x speedup, val set 5.451x speedup, step: 5
Epoch 22/300 |loss: 0.001402| train set 5.218x speedup, test set 0.683x speedup, val set 5.452x speedup, step: 6
Epoch 23/300 |loss: 0.001348| train set 5.105x speedup, test set 0.681x speedup, val set 5.350x speedup, step: 7
Epoch 24/300 |loss: 0.001315| train set 5.129x speedup, test set 0.703x speedup, val set 5.320x speedup, step: 8
Epoch 25/300 |loss: 0.000852| train set 5.166x speedup, test set 0.662x speedup, val set 5.415x speedup, step: 9
Epoch 26/300 |loss: 0.000962| train set 5.120x speedup, test set 0.632x speedup, val set 5.246x speedup, step: 10
Epoch 27/300 |loss: 0.001090| train set 5.128x speedup, test set 0.625x speedup, val set 5.382x speedup, step: 11
Epoch 28/300 |loss: 0.001001| train set 5.210x speedup, test set 0.681x speedup, val set 5.389x speedup, step: 12
Epoch 29/300 |loss: 0.000845| train set 5.209x speedup, test set 0.676x speedup, val set 5.386x speedup, step: 13
Epoch 30/300 |loss: 0.000734| train set 5.239x speedup, test set 0.673x speedup, val set 5.479x speedup, step: 1
Epoch 31/300 |loss: 0.000951| train set 5.198x speedup, test set 0.637x speedup, val set 5.437x speedup, step: 2
Epoch 32/300 |loss: 0.000740| train set 5.249x speedup, test set 0.643x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000650| train set 5.247x speedup, test set 0.644x speedup, val set 5.484x speedup, step: 2
Epoch 34/300 |loss: 0.000642| train set 5.249x speedup, test set 0.655x speedup, val set 5.487x speedup, step: 1
Epoch 35/300 |loss: 0.000651| train set 5.247x speedup, test set 0.680x speedup, val set 5.487x speedup, step: 1
Epoch 36/300 |loss: 0.000680| train set 5.239x speedup, test set 0.646x speedup, val set 5.479x speedup, step: 2
Epoch 37/300 |loss: 0.001485| train set 5.239x speedup, test set 0.663x speedup, val set 5.482x speedup, step: 3
Epoch 38/300 |loss: 0.000701| train set 5.244x speedup, test set 0.654x speedup, val set 5.473x speedup, step: 4
Epoch 39/300 |loss: 0.000635| train set 5.209x speedup, test set 0.654x speedup, val set 5.386x speedup, step: 5
Epoch 40/300 |loss: 0.000633| train set 5.211x speedup, test set 0.664x speedup, val set 5.371x speedup, step: 6
Epoch 41/300 |loss: 0.000593| train set 5.251x speedup, test set 0.663x speedup, val set 5.478x speedup, step: 7
Epoch 42/300 |loss: 0.000668| train set 5.239x speedup, test set 0.677x speedup, val set 5.482x speedup, step: 8
Epoch 43/300 |loss: 0.000597| train set 5.249x speedup, test set 0.671x speedup, val set 5.468x speedup, step: 9
Epoch 44/300 |loss: 0.000610| train set 5.242x speedup, test set 0.662x speedup, val set 5.473x speedup, step: 10
Epoch 45/300 |loss: 0.000723| train set 5.248x speedup, test set 0.647x speedup, val set 5.487x speedup, step: 1
Epoch 46/300 |loss: 0.000629| train set 5.239x speedup, test set 0.660x speedup, val set 5.482x speedup, step: 2
Epoch 47/300 |loss: 0.000628| train set 5.244x speedup, test set 0.655x speedup, val set 5.475x speedup, step: 3
Epoch 48/300 |loss: 0.000640| train set 5.226x speedup, test set 0.644x speedup, val set 5.457x speedup, step: 4
Epoch 49/300 |loss: 0.000598| train set 5.242x speedup, test set 0.664x speedup, val set 5.481x speedup, step: 5
Epoch 50/300 |loss: 0.001496| train set 5.217x speedup, test set 0.645x speedup, val set 5.446x speedup, step: 6
early stopping at epoch 50
Training per epoch cost 0.462 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 3.507s, pg runtime 3.507s, speedup 1.000x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.885s, pg runtime 2.718s, speedup 0.942x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.418s, pg runtime 0.354s, speedup 0.847x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.083s, pg runtime 0.089s, speedup 1.083x
21, opt runtime 0.953s, model runtime 8.321s, pg runtime 4.730s, speedup 0.568x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.847s, pg runtime 3.112s, speedup 1.093x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 41, train speedup 5.251, test speedup 0.663, val speedup 5.478
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 45, train speedup 5.248, test speedup 0.647, val speedup 5.487
last model at epoch 50, train speedup 5.217, test speedup 0.645, val speedup 5.446
execution cost 0:00:56.827176
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.499879, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014866| train set 2.868x speedup, test set 0.846x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008698| train set 3.373x speedup, test set 0.895x speedup, val set 3.645x speedup, step: 1
Epoch 3/300 |loss: 0.006196| train set 3.472x speedup, test set 1.162x speedup, val set 3.757x speedup, step: 1
Epoch 4/300 |loss: 0.004374| train set 3.254x speedup, test set 1.166x speedup, val set 3.524x speedup, step: 2
Epoch 5/300 |loss: 0.004390| train set 3.594x speedup, test set 1.156x speedup, val set 3.892x speedup, step: 1
Epoch 6/300 |loss: 0.003445| train set 3.996x speedup, test set 1.150x speedup, val set 4.322x speedup, step: 1
Epoch 7/300 |loss: 0.005547| train set 3.977x speedup, test set 1.281x speedup, val set 4.212x speedup, step: 2
Epoch 8/300 |loss: 0.003143| train set 3.629x speedup, test set 1.229x speedup, val set 3.944x speedup, step: 3
Epoch 9/300 |loss: 0.002476| train set 3.711x speedup, test set 1.260x speedup, val set 3.892x speedup, step: 4
Epoch 10/300 |loss: 0.002584| train set 5.201x speedup, test set 1.200x speedup, val set 5.445x speedup, step: 1
Epoch 11/300 |loss: 0.003077| train set 3.636x speedup, test set 0.920x speedup, val set 3.788x speedup, step: 2
Epoch 12/300 |loss: 0.003793| train set 4.574x speedup, test set 1.192x speedup, val set 4.968x speedup, step: 3
Epoch 13/300 |loss: 0.001971| train set 3.905x speedup, test set 1.169x speedup, val set 3.900x speedup, step: 4
Epoch 14/300 |loss: 0.001946| train set 5.132x speedup, test set 0.903x speedup, val set 5.346x speedup, step: 5
Epoch 15/300 |loss: 0.001845| train set 3.665x speedup, test set 0.685x speedup, val set 3.818x speedup, step: 6
Epoch 16/300 |loss: 0.001704| train set 5.121x speedup, test set 1.099x speedup, val set 5.376x speedup, step: 7
Epoch 17/300 |loss: 0.001594| train set 5.203x speedup, test set 1.099x speedup, val set 5.478x speedup, step: 1
Epoch 18/300 |loss: 0.001550| train set 5.201x speedup, test set 0.680x speedup, val set 5.381x speedup, step: 2
Epoch 19/300 |loss: 0.001387| train set 5.133x speedup, test set 0.790x speedup, val set 5.385x speedup, step: 3
Epoch 20/300 |loss: 0.001395| train set 5.081x speedup, test set 0.677x speedup, val set 5.314x speedup, step: 4
Epoch 21/300 |loss: 0.001500| train set 5.203x speedup, test set 0.662x speedup, val set 5.459x speedup, step: 5
Epoch 22/300 |loss: 0.001544| train set 5.226x speedup, test set 0.795x speedup, val set 5.456x speedup, step: 6
Epoch 23/300 |loss: 0.001320| train set 5.111x speedup, test set 0.657x speedup, val set 5.358x speedup, step: 7
Epoch 24/300 |loss: 0.001267| train set 5.121x speedup, test set 0.676x speedup, val set 5.313x speedup, step: 8
Epoch 25/300 |loss: 0.000897| train set 5.165x speedup, test set 0.808x speedup, val set 5.419x speedup, step: 9
Epoch 26/300 |loss: 0.000850| train set 5.247x speedup, test set 0.657x speedup, val set 5.484x speedup, step: 1
Epoch 27/300 |loss: 0.000864| train set 5.247x speedup, test set 0.816x speedup, val set 5.485x speedup, step: 1
Epoch 28/300 |loss: 0.000896| train set 5.243x speedup, test set 0.657x speedup, val set 5.488x speedup, step: 1
Epoch 29/300 |loss: 0.001025| train set 5.247x speedup, test set 0.657x speedup, val set 5.487x speedup, step: 2
Epoch 30/300 |loss: 0.000801| train set 5.239x speedup, test set 0.649x speedup, val set 5.479x speedup, step: 3
Epoch 31/300 |loss: 0.001033| train set 5.093x speedup, test set 0.807x speedup, val set 5.409x speedup, step: 4
Epoch 32/300 |loss: 0.000904| train set 5.249x speedup, test set 0.650x speedup, val set 5.487x speedup, step: 5
Epoch 33/300 |loss: 0.000648| train set 5.247x speedup, test set 0.782x speedup, val set 5.487x speedup, step: 6
Epoch 34/300 |loss: 0.000643| train set 5.222x speedup, test set 0.634x speedup, val set 5.471x speedup, step: 7
Epoch 35/300 |loss: 0.000715| train set 5.248x speedup, test set 0.656x speedup, val set 5.490x speedup, step: 1
Epoch 36/300 |loss: 0.000685| train set 5.247x speedup, test set 0.651x speedup, val set 5.484x speedup, step: 2
Epoch 37/300 |loss: 0.001781| train set 5.244x speedup, test set 0.631x speedup, val set 5.473x speedup, step: 3
Epoch 38/300 |loss: 0.000773| train set 5.249x speedup, test set 0.634x speedup, val set 5.487x speedup, step: 4
Epoch 39/300 |loss: 0.000667| train set 5.141x speedup, test set 0.626x speedup, val set 5.457x speedup, step: 5
Epoch 40/300 |loss: 0.000663| train set 5.211x speedup, test set 0.631x speedup, val set 5.357x speedup, step: 6
Epoch 41/300 |loss: 0.000591| train set 5.249x speedup, test set 0.626x speedup, val set 5.487x speedup, step: 7
Epoch 42/300 |loss: 0.000662| train set 5.239x speedup, test set 0.626x speedup, val set 5.479x speedup, step: 8
Epoch 43/300 |loss: 0.000682| train set 5.247x speedup, test set 0.678x speedup, val set 5.484x speedup, step: 9
early stopping at epoch 43
Training per epoch cost 0.468 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.418s, pg runtime 0.354s, speedup 0.847x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 2.408s, pg runtime 2.389s, speedup 0.992x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 5.249, test speedup 0.634, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 35, train speedup 5.248, test speedup 0.656, val speedup 5.490
last model at epoch 43, train speedup 5.247, test speedup 0.678, val speedup 5.484
execution cost 0:00:49.141681
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.554630, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014866| train set 2.868x speedup, test set 0.846x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008700| train set 3.373x speedup, test set 0.895x speedup, val set 3.645x speedup, step: 1
Epoch 3/300 |loss: 0.006219| train set 3.633x speedup, test set 1.162x speedup, val set 3.943x speedup, step: 1
Epoch 4/300 |loss: 0.004422| train set 3.302x speedup, test set 1.246x speedup, val set 3.568x speedup, step: 2
Epoch 5/300 |loss: 0.004461| train set 3.594x speedup, test set 1.284x speedup, val set 3.892x speedup, step: 3
Epoch 6/300 |loss: 0.003346| train set 4.553x speedup, test set 1.150x speedup, val set 4.943x speedup, step: 1
Epoch 7/300 |loss: 0.005594| train set 3.965x speedup, test set 0.898x speedup, val set 4.195x speedup, step: 2
Epoch 8/300 |loss: 0.003076| train set 4.574x speedup, test set 1.285x speedup, val set 4.971x speedup, step: 1
Epoch 9/300 |loss: 0.002442| train set 3.963x speedup, test set 1.296x speedup, val set 4.200x speedup, step: 2
Epoch 10/300 |loss: 0.002547| train set 5.201x speedup, test set 1.008x speedup, val set 5.445x speedup, step: 1
Epoch 11/300 |loss: 0.003032| train set 3.624x speedup, test set 0.714x speedup, val set 3.782x speedup, step: 2
Epoch 12/300 |loss: 0.003703| train set 4.574x speedup, test set 0.873x speedup, val set 4.968x speedup, step: 3
Epoch 13/300 |loss: 0.001969| train set 5.153x speedup, test set 1.189x speedup, val set 5.371x speedup, step: 4
Epoch 14/300 |loss: 0.001938| train set 5.025x speedup, test set 0.841x speedup, val set 5.253x speedup, step: 5
Epoch 15/300 |loss: 0.001854| train set 3.716x speedup, test set 0.688x speedup, val set 3.982x speedup, step: 6
Epoch 16/300 |loss: 0.001715| train set 5.121x speedup, test set 1.446x speedup, val set 5.375x speedup, step: 7
Epoch 17/300 |loss: 0.001605| train set 5.092x speedup, test set 1.023x speedup, val set 5.287x speedup, step: 8
Epoch 18/300 |loss: 0.001557| train set 4.515x speedup, test set 0.678x speedup, val set 5.381x speedup, step: 9
Epoch 19/300 |loss: 0.001403| train set 5.132x speedup, test set 0.659x speedup, val set 5.376x speedup, step: 10
Epoch 20/300 |loss: 0.001461| train set 5.057x speedup, test set 0.687x speedup, val set 5.281x speedup, step: 11
Epoch 21/300 |loss: 0.001394| train set 5.227x speedup, test set 0.685x speedup, val set 5.471x speedup, step: 1
Epoch 22/300 |loss: 0.001335| train set 5.247x speedup, test set 0.824x speedup, val set 5.484x speedup, step: 1
Epoch 23/300 |loss: 0.001378| train set 5.075x speedup, test set 0.675x speedup, val set 5.260x speedup, step: 2
Epoch 24/300 |loss: 0.001367| train set 4.725x speedup, test set 0.703x speedup, val set 5.052x speedup, step: 3
Epoch 25/300 |loss: 0.000929| train set 5.165x speedup, test set 0.675x speedup, val set 5.419x speedup, step: 4
Epoch 26/300 |loss: 0.000894| train set 5.249x speedup, test set 0.675x speedup, val set 5.487x speedup, step: 1
Epoch 27/300 |loss: 0.001060| train set 5.240x speedup, test set 0.650x speedup, val set 5.479x speedup, step: 2
Epoch 28/300 |loss: 0.000784| train set 5.248x speedup, test set 0.674x speedup, val set 5.487x speedup, step: 1
Epoch 29/300 |loss: 0.000947| train set 5.159x speedup, test set 0.651x speedup, val set 5.378x speedup, step: 2
Epoch 30/300 |loss: 0.000836| train set 5.247x speedup, test set 0.673x speedup, val set 5.485x speedup, step: 3
Epoch 31/300 |loss: 0.001076| train set 5.213x speedup, test set 0.650x speedup, val set 5.444x speedup, step: 4
Epoch 32/300 |loss: 0.000824| train set 5.249x speedup, test set 0.650x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000635| train set 5.225x speedup, test set 0.644x speedup, val set 5.456x speedup, step: 2
Epoch 34/300 |loss: 0.000659| train set 5.247x speedup, test set 0.644x speedup, val set 5.485x speedup, step: 3
Epoch 35/300 |loss: 0.000696| train set 5.248x speedup, test set 0.649x speedup, val set 5.490x speedup, step: 1
Epoch 36/300 |loss: 0.000698| train set 5.249x speedup, test set 0.650x speedup, val set 5.487x speedup, step: 2
Epoch 37/300 |loss: 0.001767| train set 5.209x speedup, test set 0.680x speedup, val set 5.389x speedup, step: 3
Epoch 38/300 |loss: 0.000789| train set 5.219x speedup, test set 0.650x speedup, val set 5.460x speedup, step: 4
Epoch 39/300 |loss: 0.000707| train set 5.247x speedup, test set 0.650x speedup, val set 5.484x speedup, step: 5
Epoch 40/300 |loss: 0.000669| train set 5.208x speedup, test set 0.651x speedup, val set 5.387x speedup, step: 6
Epoch 41/300 |loss: 0.000604| train set 5.249x speedup, test set 0.653x speedup, val set 5.487x speedup, step: 7
Epoch 42/300 |loss: 0.000612| train set 5.244x speedup, test set 0.650x speedup, val set 5.475x speedup, step: 8
Epoch 43/300 |loss: 0.000640| train set 5.209x speedup, test set 0.650x speedup, val set 5.386x speedup, step: 9
Epoch 44/300 |loss: 0.000592| train set 5.247x speedup, test set 0.644x speedup, val set 5.484x speedup, step: 10
Epoch 45/300 |loss: 0.000613| train set 5.248x speedup, test set 0.650x speedup, val set 5.487x speedup, step: 11
Epoch 46/300 |loss: 0.000644| train set 5.239x speedup, test set 0.650x speedup, val set 5.480x speedup, step: 12
Epoch 47/300 |loss: 0.000656| train set 5.244x speedup, test set 0.658x speedup, val set 5.473x speedup, step: 13
Epoch 48/300 |loss: 0.000674| train set 5.249x speedup, test set 0.754x speedup, val set 5.487x speedup, step: 14
Epoch 49/300 |loss: 0.000633| train set 5.249x speedup, test set 0.651x speedup, val set 5.487x speedup, step: 15
Epoch 50/300 |loss: 0.001471| train set 5.219x speedup, test set 0.658x speedup, val set 5.459x speedup, step: 16
early stopping at epoch 50
Training per epoch cost 0.483 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.885s, pg runtime 2.718s, speedup 0.942x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.083s, pg runtime 0.089s, speedup 1.083x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 26, train speedup 5.249, test speedup 0.675, val speedup 5.487
best test speedup epoch: 16, train speedup 5.121, test speedup 1.446, val speedup 5.375
best validation speedup epoch: 35, train speedup 5.248, test speedup 0.649, val speedup 5.490
last model at epoch 50, train speedup 5.219, test speedup 0.658, val speedup 5.459
execution cost 0:00:56.863685
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.508731, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014859| train set 2.871x speedup, test set 0.984x speedup, val set 2.899x speedup, step: 1
Epoch 2/300 |loss: 0.008731| train set 3.568x speedup, test set 0.911x speedup, val set 3.737x speedup, step: 1
Epoch 3/300 |loss: 0.006176| train set 3.359x speedup, test set 1.141x speedup, val set 3.580x speedup, step: 2
Epoch 4/300 |loss: 0.004440| train set 3.299x speedup, test set 1.145x speedup, val set 3.516x speedup, step: 3
Epoch 5/300 |loss: 0.004648| train set 3.594x speedup, test set 0.901x speedup, val set 3.892x speedup, step: 1
Epoch 6/300 |loss: 0.003516| train set 4.555x speedup, test set 1.108x speedup, val set 4.945x speedup, step: 1
Epoch 7/300 |loss: 0.005002| train set 3.955x speedup, test set 1.271x speedup, val set 4.154x speedup, step: 2
Epoch 8/300 |loss: 0.003252| train set 3.633x speedup, test set 1.318x speedup, val set 3.946x speedup, step: 3
Epoch 9/300 |loss: 0.002553| train set 3.372x speedup, test set 1.123x speedup, val set 3.625x speedup, step: 4
Epoch 10/300 |loss: 0.002589| train set 4.640x speedup, test set 1.211x speedup, val set 5.025x speedup, step: 1
Epoch 11/300 |loss: 0.002761| train set 3.655x speedup, test set 0.753x speedup, val set 3.836x speedup, step: 2
Epoch 12/300 |loss: 0.003979| train set 5.103x speedup, test set 0.874x speedup, val set 5.371x speedup, step: 1
Epoch 13/300 |loss: 0.001996| train set 5.226x speedup, test set 0.721x speedup, val set 5.459x speedup, step: 1
Epoch 14/300 |loss: 0.001952| train set 5.052x speedup, test set 0.734x speedup, val set 5.289x speedup, step: 2
Epoch 15/300 |loss: 0.001915| train set 3.662x speedup, test set 0.715x speedup, val set 3.815x speedup, step: 3
Epoch 16/300 |loss: 0.001776| train set 5.121x speedup, test set 0.894x speedup, val set 5.376x speedup, step: 4
Epoch 17/300 |loss: 0.001703| train set 5.178x speedup, test set 0.717x speedup, val set 5.367x speedup, step: 5
Epoch 18/300 |loss: 0.001684| train set 5.141x speedup, test set 0.676x speedup, val set 5.457x speedup, step: 6
Epoch 19/300 |loss: 0.001464| train set 5.135x speedup, test set 0.684x speedup, val set 5.387x speedup, step: 7
Epoch 20/300 |loss: 0.001528| train set 5.062x speedup, test set 0.676x speedup, val set 5.287x speedup, step: 8
Epoch 21/300 |loss: 0.001516| train set 5.249x speedup, test set 0.678x speedup, val set 5.487x speedup, step: 1
Epoch 22/300 |loss: 0.001564| train set 5.227x speedup, test set 0.692x speedup, val set 5.457x speedup, step: 2
Epoch 23/300 |loss: 0.001360| train set 5.141x speedup, test set 0.692x speedup, val set 5.381x speedup, step: 3
Epoch 24/300 |loss: 0.001333| train set 4.456x speedup, test set 0.703x speedup, val set 5.315x speedup, step: 4
Epoch 25/300 |loss: 0.000940| train set 5.128x speedup, test set 0.687x speedup, val set 5.321x speedup, step: 5
Epoch 26/300 |loss: 0.000846| train set 5.249x speedup, test set 0.669x speedup, val set 5.487x speedup, step: 1
Epoch 27/300 |loss: 0.001256| train set 5.240x speedup, test set 0.677x speedup, val set 5.479x speedup, step: 2
Epoch 28/300 |loss: 0.000885| train set 5.166x speedup, test set 0.677x speedup, val set 5.416x speedup, step: 3
Epoch 29/300 |loss: 0.001020| train set 5.172x speedup, test set 0.683x speedup, val set 5.387x speedup, step: 4
Epoch 30/300 |loss: 0.000820| train set 5.244x speedup, test set 0.680x speedup, val set 5.482x speedup, step: 5
Epoch 31/300 |loss: 0.000944| train set 5.206x speedup, test set 0.655x speedup, val set 5.381x speedup, step: 6
Epoch 32/300 |loss: 0.000729| train set 5.249x speedup, test set 0.650x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000614| train set 5.245x speedup, test set 0.646x speedup, val set 5.487x speedup, step: 2
Epoch 34/300 |loss: 0.000654| train set 5.222x speedup, test set 0.647x speedup, val set 5.471x speedup, step: 3
Epoch 35/300 |loss: 0.000717| train set 5.211x speedup, test set 0.649x speedup, val set 5.389x speedup, step: 4
Epoch 36/300 |loss: 0.000741| train set 5.248x speedup, test set 0.650x speedup, val set 5.487x speedup, step: 1
Epoch 37/300 |loss: 0.001586| train set 5.209x speedup, test set 0.679x speedup, val set 5.386x speedup, step: 2
Epoch 38/300 |loss: 0.000720| train set 5.249x speedup, test set 0.648x speedup, val set 5.487x speedup, step: 3
Epoch 39/300 |loss: 0.000630| train set 5.245x speedup, test set 0.647x speedup, val set 5.481x speedup, step: 4
Epoch 40/300 |loss: 0.000621| train set 5.211x speedup, test set 0.658x speedup, val set 5.372x speedup, step: 5
Epoch 41/300 |loss: 0.000582| train set 5.249x speedup, test set 0.651x speedup, val set 5.487x speedup, step: 1
Epoch 42/300 |loss: 0.000636| train set 5.244x speedup, test set 0.651x speedup, val set 5.475x speedup, step: 2
Epoch 43/300 |loss: 0.000620| train set 5.209x speedup, test set 0.647x speedup, val set 5.386x speedup, step: 3
Epoch 44/300 |loss: 0.000594| train set 5.247x speedup, test set 0.652x speedup, val set 5.485x speedup, step: 4
Epoch 45/300 |loss: 0.000629| train set 5.249x speedup, test set 0.653x speedup, val set 5.487x speedup, step: 5
Epoch 46/300 |loss: 0.000630| train set 5.239x speedup, test set 0.650x speedup, val set 5.480x speedup, step: 6
Epoch 47/300 |loss: 0.000621| train set 5.246x speedup, test set 0.649x speedup, val set 5.485x speedup, step: 7
Epoch 48/300 |loss: 0.000647| train set 5.244x speedup, test set 0.648x speedup, val set 5.473x speedup, step: 8
Epoch 49/300 |loss: 0.000633| train set 5.241x speedup, test set 0.676x speedup, val set 5.479x speedup, step: 9
early stopping at epoch 49
Training per epoch cost 0.479 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.441s, pg runtime 0.453s, speedup 1.028x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.938s, pg runtime 3.112s, speedup 1.059x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 21, train speedup 5.249, test speedup 0.678, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 41, train speedup 5.249, test speedup 0.651, val speedup 5.487
last model at epoch 49, train speedup 5.241, test speedup 0.676, val speedup 5.479
execution cost 0:00:56.738689
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.537606, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014866| train set 2.868x speedup, test set 0.846x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008700| train set 3.373x speedup, test set 0.895x speedup, val set 3.645x speedup, step: 1
Epoch 3/300 |loss: 0.006219| train set 3.633x speedup, test set 1.162x speedup, val set 3.943x speedup, step: 1
Epoch 4/300 |loss: 0.004423| train set 3.302x speedup, test set 1.246x speedup, val set 3.568x speedup, step: 2
Epoch 5/300 |loss: 0.004465| train set 3.253x speedup, test set 1.338x speedup, val set 3.546x speedup, step: 3
Epoch 6/300 |loss: 0.003375| train set 4.641x speedup, test set 1.180x speedup, val set 5.025x speedup, step: 1
Epoch 7/300 |loss: 0.005520| train set 3.977x speedup, test set 0.891x speedup, val set 4.212x speedup, step: 2
Epoch 8/300 |loss: 0.003030| train set 3.756x speedup, test set 1.281x speedup, val set 4.390x speedup, step: 3
Epoch 9/300 |loss: 0.002438| train set 3.966x speedup, test set 1.186x speedup, val set 4.191x speedup, step: 4
Epoch 10/300 |loss: 0.002505| train set 5.203x speedup, test set 1.603x speedup, val set 5.448x speedup, step: 1
Epoch 11/300 |loss: 0.002999| train set 3.658x speedup, test set 0.857x speedup, val set 3.787x speedup, step: 2
Epoch 12/300 |loss: 0.003653| train set 5.136x speedup, test set 1.064x speedup, val set 5.347x speedup, step: 3
Epoch 13/300 |loss: 0.001872| train set 5.227x speedup, test set 0.927x speedup, val set 5.457x speedup, step: 1
Epoch 14/300 |loss: 0.001882| train set 5.042x speedup, test set 0.873x speedup, val set 5.268x speedup, step: 2
Epoch 15/300 |loss: 0.001882| train set 4.121x speedup, test set 0.715x speedup, val set 4.658x speedup, step: 3
Epoch 16/300 |loss: 0.001733| train set 5.121x speedup, test set 1.041x speedup, val set 5.376x speedup, step: 4
Epoch 17/300 |loss: 0.001589| train set 5.092x speedup, test set 0.984x speedup, val set 5.287x speedup, step: 5
Epoch 18/300 |loss: 0.001564| train set 5.211x speedup, test set 0.703x speedup, val set 5.389x speedup, step: 6
Epoch 19/300 |loss: 0.001344| train set 5.096x speedup, test set 0.854x speedup, val set 5.282x speedup, step: 7
Epoch 20/300 |loss: 0.001381| train set 5.055x speedup, test set 0.703x speedup, val set 5.275x speedup, step: 8
Epoch 21/300 |loss: 0.001373| train set 5.249x speedup, test set 0.658x speedup, val set 5.487x speedup, step: 1
Epoch 22/300 |loss: 0.001442| train set 5.218x speedup, test set 0.819x speedup, val set 5.452x speedup, step: 2
Epoch 23/300 |loss: 0.001253| train set 5.073x speedup, test set 0.676x speedup, val set 5.265x speedup, step: 3
Epoch 24/300 |loss: 0.001099| train set 5.211x speedup, test set 0.682x speedup, val set 5.389x speedup, step: 4
Epoch 25/300 |loss: 0.000856| train set 5.164x speedup, test set 0.680x speedup, val set 5.413x speedup, step: 5
Epoch 26/300 |loss: 0.000796| train set 5.247x speedup, test set 0.678x speedup, val set 5.485x speedup, step: 6
Epoch 27/300 |loss: 0.000777| train set 5.247x speedup, test set 0.673x speedup, val set 5.485x speedup, step: 7
Epoch 28/300 |loss: 0.000950| train set 5.249x speedup, test set 0.680x speedup, val set 5.487x speedup, step: 1
Epoch 29/300 |loss: 0.000974| train set 5.247x speedup, test set 0.688x speedup, val set 5.484x speedup, step: 2
Epoch 30/300 |loss: 0.000739| train set 5.239x speedup, test set 0.810x speedup, val set 5.479x speedup, step: 3
Epoch 31/300 |loss: 0.001103| train set 5.223x speedup, test set 0.796x speedup, val set 5.451x speedup, step: 4
Epoch 32/300 |loss: 0.000784| train set 5.249x speedup, test set 0.678x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000625| train set 5.247x speedup, test set 0.807x speedup, val set 5.484x speedup, step: 2
Epoch 34/300 |loss: 0.000651| train set 5.239x speedup, test set 0.663x speedup, val set 5.480x speedup, step: 3
Epoch 35/300 |loss: 0.000695| train set 5.248x speedup, test set 0.669x speedup, val set 5.490x speedup, step: 1
Epoch 36/300 |loss: 0.000684| train set 5.239x speedup, test set 0.663x speedup, val set 5.479x speedup, step: 2
Epoch 37/300 |loss: 0.001547| train set 5.244x speedup, test set 0.685x speedup, val set 5.475x speedup, step: 3
Epoch 38/300 |loss: 0.000749| train set 5.244x speedup, test set 0.665x speedup, val set 5.475x speedup, step: 4
Epoch 39/300 |loss: 0.000683| train set 5.140x speedup, test set 0.679x speedup, val set 5.455x speedup, step: 5
Epoch 40/300 |loss: 0.000654| train set 5.249x speedup, test set 0.665x speedup, val set 5.469x speedup, step: 6
Epoch 41/300 |loss: 0.000583| train set 5.249x speedup, test set 0.657x speedup, val set 5.487x speedup, step: 7
Epoch 42/300 |loss: 0.000650| train set 5.240x speedup, test set 0.678x speedup, val set 5.473x speedup, step: 8
Epoch 43/300 |loss: 0.000642| train set 5.247x speedup, test set 0.655x speedup, val set 5.484x speedup, step: 9
Epoch 44/300 |loss: 0.000608| train set 5.246x speedup, test set 0.665x speedup, val set 5.485x speedup, step: 10
Epoch 45/300 |loss: 0.000651| train set 5.248x speedup, test set 0.667x speedup, val set 5.490x speedup, step: 1
Epoch 46/300 |loss: 0.000679| train set 5.239x speedup, test set 0.668x speedup, val set 5.480x speedup, step: 2
Epoch 47/300 |loss: 0.000714| train set 5.244x speedup, test set 0.668x speedup, val set 5.473x speedup, step: 3
Epoch 48/300 |loss: 0.000655| train set 5.226x speedup, test set 0.667x speedup, val set 5.456x speedup, step: 4
Epoch 49/300 |loss: 0.000632| train set 5.249x speedup, test set 0.665x speedup, val set 5.487x speedup, step: 5
Epoch 50/300 |loss: 0.001396| train set 5.222x speedup, test set 0.679x speedup, val set 5.474x speedup, step: 6
early stopping at epoch 50
Training per epoch cost 0.449 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.885s, pg runtime 2.718s, speedup 0.942x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.083s, pg runtime 0.089s, speedup 1.083x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 40, train speedup 5.249, test speedup 0.665, val speedup 5.469
best test speedup epoch: 10, train speedup 5.203, test speedup 1.603, val speedup 5.448
best validation speedup epoch: 45, train speedup 5.248, test speedup 0.667, val speedup 5.490
last model at epoch 50, train speedup 5.222, test speedup 0.679, val speedup 5.474
execution cost 0:00:55.493866
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.509539, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014859| train set 2.871x speedup, test set 0.984x speedup, val set 2.899x speedup, step: 1
Epoch 2/300 |loss: 0.008731| train set 3.568x speedup, test set 0.911x speedup, val set 3.737x speedup, step: 1
Epoch 3/300 |loss: 0.006176| train set 3.359x speedup, test set 1.141x speedup, val set 3.580x speedup, step: 2
Epoch 4/300 |loss: 0.004437| train set 3.299x speedup, test set 1.166x speedup, val set 3.516x speedup, step: 3
Epoch 5/300 |loss: 0.004641| train set 3.594x speedup, test set 1.164x speedup, val set 3.892x speedup, step: 1
Epoch 6/300 |loss: 0.003467| train set 4.553x speedup, test set 1.108x speedup, val set 4.943x speedup, step: 1
Epoch 7/300 |loss: 0.005433| train set 3.955x speedup, test set 0.941x speedup, val set 4.154x speedup, step: 2
Epoch 8/300 |loss: 0.003161| train set 3.632x speedup, test set 1.278x speedup, val set 3.945x speedup, step: 3
Epoch 9/300 |loss: 0.002547| train set 3.364x speedup, test set 0.925x speedup, val set 3.621x speedup, step: 4
Epoch 10/300 |loss: 0.002618| train set 5.088x speedup, test set 1.213x speedup, val set 5.412x speedup, step: 1
Epoch 11/300 |loss: 0.002909| train set 3.692x speedup, test set 0.700x speedup, val set 3.836x speedup, step: 2
Epoch 12/300 |loss: 0.003837| train set 4.572x speedup, test set 0.858x speedup, val set 4.959x speedup, step: 3
Epoch 13/300 |loss: 0.002017| train set 5.240x speedup, test set 0.931x speedup, val set 5.481x speedup, step: 1
Epoch 14/300 |loss: 0.001963| train set 5.043x speedup, test set 0.906x speedup, val set 5.279x speedup, step: 2
Epoch 15/300 |loss: 0.001913| train set 3.652x speedup, test set 0.732x speedup, val set 3.802x speedup, step: 3
Epoch 16/300 |loss: 0.001733| train set 5.121x speedup, test set 0.883x speedup, val set 5.376x speedup, step: 4
Epoch 17/300 |loss: 0.001676| train set 5.202x speedup, test set 0.686x speedup, val set 5.381x speedup, step: 5
Epoch 18/300 |loss: 0.001687| train set 5.141x speedup, test set 0.686x speedup, val set 5.457x speedup, step: 6
Epoch 19/300 |loss: 0.001451| train set 5.132x speedup, test set 0.678x speedup, val set 5.376x speedup, step: 7
Epoch 20/300 |loss: 0.001514| train set 4.752x speedup, test set 0.689x speedup, val set 5.133x speedup, step: 8
Epoch 21/300 |loss: 0.001526| train set 5.228x speedup, test set 0.678x speedup, val set 5.459x speedup, step: 9
Epoch 22/300 |loss: 0.001619| train set 5.218x speedup, test set 0.657x speedup, val set 5.451x speedup, step: 10
Epoch 23/300 |loss: 0.001416| train set 4.735x speedup, test set 0.682x speedup, val set 5.109x speedup, step: 11
Epoch 24/300 |loss: 0.001410| train set 3.723x speedup, test set 0.704x speedup, val set 3.995x speedup, step: 12
Epoch 25/300 |loss: 0.000973| train set 5.122x speedup, test set 0.681x speedup, val set 5.315x speedup, step: 13
Epoch 26/300 |loss: 0.000897| train set 5.141x speedup, test set 0.676x speedup, val set 5.457x speedup, step: 14
Epoch 27/300 |loss: 0.001169| train set 5.215x speedup, test set 0.676x speedup, val set 5.465x speedup, step: 15
Epoch 28/300 |loss: 0.000990| train set 5.160x speedup, test set 0.674x speedup, val set 5.413x speedup, step: 16
Epoch 29/300 |loss: 0.001092| train set 5.247x speedup, test set 0.653x speedup, val set 5.485x speedup, step: 1
Epoch 30/300 |loss: 0.000870| train set 5.239x speedup, test set 0.677x speedup, val set 5.479x speedup, step: 2
Epoch 31/300 |loss: 0.000901| train set 5.219x speedup, test set 0.653x speedup, val set 5.465x speedup, step: 3
Epoch 32/300 |loss: 0.000865| train set 5.237x speedup, test set 0.646x speedup, val set 5.467x speedup, step: 4
Epoch 33/300 |loss: 0.000677| train set 5.249x speedup, test set 0.651x speedup, val set 5.487x speedup, step: 1
Epoch 34/300 |loss: 0.000660| train set 5.247x speedup, test set 0.646x speedup, val set 5.485x speedup, step: 2
Epoch 35/300 |loss: 0.000724| train set 5.209x speedup, test set 0.654x speedup, val set 5.387x speedup, step: 3
Epoch 36/300 |loss: 0.000737| train set 5.160x speedup, test set 0.649x speedup, val set 5.377x speedup, step: 4
Epoch 37/300 |loss: 0.001498| train set 5.249x speedup, test set 0.653x speedup, val set 5.487x speedup, step: 1
Epoch 38/300 |loss: 0.000691| train set 5.244x speedup, test set 0.646x speedup, val set 5.473x speedup, step: 2
Epoch 39/300 |loss: 0.000642| train set 5.239x speedup, test set 0.649x speedup, val set 5.479x speedup, step: 3
Epoch 40/300 |loss: 0.000633| train set 5.210x speedup, test set 0.650x speedup, val set 5.372x speedup, step: 4
Epoch 41/300 |loss: 0.000576| train set 5.248x speedup, test set 0.649x speedup, val set 5.490x speedup, step: 1
Epoch 42/300 |loss: 0.000643| train set 5.244x speedup, test set 0.650x speedup, val set 5.473x speedup, step: 2
Epoch 43/300 |loss: 0.000647| train set 5.247x speedup, test set 0.645x speedup, val set 5.484x speedup, step: 3
Epoch 44/300 |loss: 0.000628| train set 5.247x speedup, test set 0.649x speedup, val set 5.485x speedup, step: 4
Epoch 45/300 |loss: 0.000850| train set 5.248x speedup, test set 0.646x speedup, val set 5.490x speedup, step: 1
Epoch 46/300 |loss: 0.000655| train set 5.239x speedup, test set 0.645x speedup, val set 5.482x speedup, step: 2
Epoch 47/300 |loss: 0.000651| train set 5.245x speedup, test set 0.657x speedup, val set 5.482x speedup, step: 3
Epoch 48/300 |loss: 0.000621| train set 5.249x speedup, test set 0.646x speedup, val set 5.487x speedup, step: 4
Epoch 49/300 |loss: 0.000674| train set 5.242x speedup, test set 0.650x speedup, val set 5.481x speedup, step: 5
Epoch 50/300 |loss: 0.001633| train set 5.219x speedup, test set 0.653x speedup, val set 5.469x speedup, step: 6
early stopping at epoch 50
Training per epoch cost 0.488 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 13.534s, pg runtime 3.507s, speedup 0.259x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.441s, pg runtime 0.453s, speedup 1.028x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 33, train speedup 5.249, test speedup 0.651, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 45, train speedup 5.248, test speedup 0.646, val speedup 5.490
last model at epoch 50, train speedup 5.219, test speedup 0.653, val speedup 5.469
execution cost 0:00:57.656926
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.507095, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014864| train set 2.868x speedup, test set 0.984x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008820| train set 3.281x speedup, test set 0.895x speedup, val set 3.476x speedup, step: 1
Epoch 3/300 |loss: 0.005955| train set 3.567x speedup, test set 1.141x speedup, val set 3.913x speedup, step: 1
Epoch 4/300 |loss: 0.004536| train set 3.317x speedup, test set 0.890x speedup, val set 3.565x speedup, step: 2
Epoch 5/300 |loss: 0.004233| train set 3.584x speedup, test set 1.283x speedup, val set 3.909x speedup, step: 3
Epoch 6/300 |loss: 0.003502| train set 4.553x speedup, test set 1.100x speedup, val set 4.943x speedup, step: 1
Epoch 7/300 |loss: 0.005646| train set 3.710x speedup, test set 0.757x speedup, val set 3.987x speedup, step: 2
Epoch 8/300 |loss: 0.003194| train set 3.752x speedup, test set 1.311x speedup, val set 3.945x speedup, step: 3
Epoch 9/300 |loss: 0.002483| train set 3.645x speedup, test set 1.302x speedup, val set 3.955x speedup, step: 4
Epoch 10/300 |loss: 0.002475| train set 5.165x speedup, test set 0.928x speedup, val set 5.446x speedup, step: 1
Epoch 11/300 |loss: 0.003020| train set 4.026x speedup, test set 0.711x speedup, val set 4.243x speedup, step: 2
Epoch 12/300 |loss: 0.003649| train set 5.111x speedup, test set 1.094x speedup, val set 5.373x speedup, step: 3
Epoch 13/300 |loss: 0.001958| train set 4.192x speedup, test set 0.941x speedup, val set 4.783x speedup, step: 4
Epoch 14/300 |loss: 0.001932| train set 5.119x speedup, test set 0.924x speedup, val set 5.374x speedup, step: 5
Epoch 15/300 |loss: 0.001888| train set 3.723x speedup, test set 0.699x speedup, val set 3.993x speedup, step: 6
Epoch 16/300 |loss: 0.001742| train set 5.121x speedup, test set 1.099x speedup, val set 5.376x speedup, step: 7
Epoch 17/300 |loss: 0.001633| train set 5.209x speedup, test set 0.781x speedup, val set 5.386x speedup, step: 8
Epoch 18/300 |loss: 0.001527| train set 5.211x speedup, test set 0.688x speedup, val set 5.389x speedup, step: 9
Epoch 19/300 |loss: 0.001309| train set 5.089x speedup, test set 0.692x speedup, val set 5.277x speedup, step: 10
Epoch 20/300 |loss: 0.001396| train set 5.034x speedup, test set 0.665x speedup, val set 5.260x speedup, step: 11
Epoch 21/300 |loss: 0.001356| train set 5.247x speedup, test set 0.663x speedup, val set 5.484x speedup, step: 1
Epoch 22/300 |loss: 0.001453| train set 5.218x speedup, test set 0.835x speedup, val set 5.452x speedup, step: 2
Epoch 23/300 |loss: 0.001358| train set 5.104x speedup, test set 0.716x speedup, val set 5.345x speedup, step: 3
Epoch 24/300 |loss: 0.001171| train set 5.128x speedup, test set 0.710x speedup, val set 5.323x speedup, step: 4
Epoch 25/300 |loss: 0.000860| train set 5.210x speedup, test set 0.692x speedup, val set 5.390x speedup, step: 5
Epoch 26/300 |loss: 0.000926| train set 5.224x speedup, test set 0.669x speedup, val set 5.473x speedup, step: 6
Epoch 27/300 |loss: 0.000928| train set 5.222x speedup, test set 0.668x speedup, val set 5.471x speedup, step: 7
Epoch 28/300 |loss: 0.000788| train set 5.211x speedup, test set 0.701x speedup, val set 5.389x speedup, step: 8
Epoch 29/300 |loss: 0.000936| train set 5.206x speedup, test set 0.696x speedup, val set 5.385x speedup, step: 9
Epoch 30/300 |loss: 0.000788| train set 5.247x speedup, test set 0.669x speedup, val set 5.487x speedup, step: 1
Epoch 31/300 |loss: 0.001053| train set 5.214x speedup, test set 0.695x speedup, val set 5.468x speedup, step: 2
Epoch 32/300 |loss: 0.000875| train set 5.247x speedup, test set 0.669x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000687| train set 5.244x speedup, test set 0.669x speedup, val set 5.473x speedup, step: 2
Epoch 34/300 |loss: 0.000676| train set 5.219x speedup, test set 0.669x speedup, val set 5.460x speedup, step: 3
Epoch 35/300 |loss: 0.000694| train set 5.248x speedup, test set 0.670x speedup, val set 5.490x speedup, step: 1
Epoch 36/300 |loss: 0.000697| train set 5.249x speedup, test set 0.667x speedup, val set 5.487x speedup, step: 2
Epoch 37/300 |loss: 0.001666| train set 5.244x speedup, test set 0.697x speedup, val set 5.475x speedup, step: 3
Epoch 38/300 |loss: 0.000812| train set 5.222x speedup, test set 0.664x speedup, val set 5.474x speedup, step: 4
Epoch 39/300 |loss: 0.000650| train set 5.247x speedup, test set 0.538x speedup, val set 5.484x speedup, step: 5
Epoch 40/300 |loss: 0.000592| train set 5.246x speedup, test set 0.693x speedup, val set 5.485x speedup, step: 6
Epoch 41/300 |loss: 0.000611| train set 5.221x speedup, test set 0.692x speedup, val set 5.454x speedup, step: 7
Epoch 42/300 |loss: 0.000605| train set 5.239x speedup, test set 0.664x speedup, val set 5.482x speedup, step: 8
Epoch 43/300 |loss: 0.000619| train set 5.247x speedup, test set 0.664x speedup, val set 5.484x speedup, step: 9
Epoch 44/300 |loss: 0.000582| train set 5.242x speedup, test set 0.666x speedup, val set 5.473x speedup, step: 10
Epoch 45/300 |loss: 0.000640| train set 5.248x speedup, test set 0.536x speedup, val set 5.489x speedup, step: 11
Epoch 46/300 |loss: 0.000647| train set 5.239x speedup, test set 0.664x speedup, val set 5.479x speedup, step: 12
Epoch 47/300 |loss: 0.000681| train set 5.247x speedup, test set 0.666x speedup, val set 5.487x speedup, step: 13
Epoch 48/300 |loss: 0.000680| train set 5.227x speedup, test set 0.541x speedup, val set 5.456x speedup, step: 14
early stopping at epoch 48
Training per epoch cost 0.457 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.885s, pg runtime 2.718s, speedup 0.942x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.418s, pg runtime 0.354s, speedup 0.847x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.083s, pg runtime 0.089s, speedup 1.083x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 2.408s, pg runtime 2.389s, speedup 0.992x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 36, train speedup 5.249, test speedup 0.667, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 35, train speedup 5.248, test speedup 0.670, val speedup 5.490
last model at epoch 48, train speedup 5.227, test speedup 0.541, val speedup 5.456
execution cost 0:00:53.670942
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.524430, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.046761| train set 2.269x speedup, test set 1.363x speedup, val set 2.230x speedup, step: 1
Epoch 1/300 |loss: 0.014866| train set 2.868x speedup, test set 0.846x speedup, val set 2.903x speedup, step: 1
Epoch 2/300 |loss: 0.008700| train set 3.373x speedup, test set 0.895x speedup, val set 3.645x speedup, step: 1
Epoch 3/300 |loss: 0.006219| train set 3.633x speedup, test set 1.162x speedup, val set 3.943x speedup, step: 1
Epoch 4/300 |loss: 0.004427| train set 3.302x speedup, test set 1.246x speedup, val set 3.568x speedup, step: 2
Epoch 5/300 |loss: 0.004491| train set 3.594x speedup, test set 1.196x speedup, val set 3.892x speedup, step: 3
Epoch 6/300 |loss: 0.003355| train set 3.996x speedup, test set 1.199x speedup, val set 4.322x speedup, step: 1
Epoch 7/300 |loss: 0.005272| train set 3.965x speedup, test set 0.944x speedup, val set 4.195x speedup, step: 2
Epoch 8/300 |loss: 0.003038| train set 4.664x speedup, test set 1.211x speedup, val set 5.056x speedup, step: 1
Epoch 9/300 |loss: 0.002480| train set 4.433x speedup, test set 1.203x speedup, val set 5.352x speedup, step: 1
Epoch 10/300 |loss: 0.002504| train set 4.647x speedup, test set 0.866x speedup, val set 5.029x speedup, step: 2
Epoch 11/300 |loss: 0.002868| train set 3.715x speedup, test set 0.715x speedup, val set 3.889x speedup, step: 3
Epoch 12/300 |loss: 0.003830| train set 5.185x speedup, test set 0.860x speedup, val set 5.470x speedup, step: 1
Epoch 13/300 |loss: 0.001914| train set 5.220x speedup, test set 0.918x speedup, val set 5.450x speedup, step: 2
Epoch 14/300 |loss: 0.001944| train set 5.049x speedup, test set 0.931x speedup, val set 5.283x speedup, step: 3
Epoch 15/300 |loss: 0.001865| train set 3.726x speedup, test set 0.720x speedup, val set 3.998x speedup, step: 4
Epoch 16/300 |loss: 0.001775| train set 5.121x speedup, test set 0.996x speedup, val set 5.376x speedup, step: 5
Epoch 17/300 |loss: 0.001614| train set 5.240x speedup, test set 0.798x speedup, val set 5.479x speedup, step: 1
Epoch 18/300 |loss: 0.001566| train set 5.201x speedup, test set 0.706x speedup, val set 5.382x speedup, step: 2
Epoch 19/300 |loss: 0.001391| train set 5.132x speedup, test set 0.686x speedup, val set 5.376x speedup, step: 3
Epoch 20/300 |loss: 0.001435| train set 5.076x speedup, test set 0.660x speedup, val set 5.307x speedup, step: 4
Epoch 21/300 |loss: 0.001383| train set 5.156x speedup, test set 0.685x speedup, val set 5.408x speedup, step: 5
Epoch 22/300 |loss: 0.001429| train set 5.218x speedup, test set 0.681x speedup, val set 5.451x speedup, step: 6
Epoch 23/300 |loss: 0.001315| train set 5.099x speedup, test set 0.683x speedup, val set 5.331x speedup, step: 7
Epoch 24/300 |loss: 0.001243| train set 5.122x speedup, test set 0.675x speedup, val set 5.314x speedup, step: 8
Epoch 25/300 |loss: 0.000833| train set 5.165x speedup, test set 0.681x speedup, val set 5.413x speedup, step: 9
Epoch 26/300 |loss: 0.000937| train set 5.249x speedup, test set 0.678x speedup, val set 5.487x speedup, step: 1
Epoch 27/300 |loss: 0.001006| train set 5.240x speedup, test set 0.679x speedup, val set 5.479x speedup, step: 2
Epoch 28/300 |loss: 0.000773| train set 5.210x speedup, test set 0.673x speedup, val set 5.389x speedup, step: 3
Epoch 29/300 |loss: 0.000945| train set 5.206x speedup, test set 0.656x speedup, val set 5.385x speedup, step: 4
Epoch 30/300 |loss: 0.000805| train set 5.244x speedup, test set 0.672x speedup, val set 5.473x speedup, step: 5
Epoch 31/300 |loss: 0.000890| train set 5.184x speedup, test set 0.664x speedup, val set 5.352x speedup, step: 6
Epoch 32/300 |loss: 0.000750| train set 5.249x speedup, test set 0.671x speedup, val set 5.487x speedup, step: 1
Epoch 33/300 |loss: 0.000673| train set 5.247x speedup, test set 0.657x speedup, val set 5.484x speedup, step: 2
Epoch 34/300 |loss: 0.000610| train set 5.244x speedup, test set 0.655x speedup, val set 5.473x speedup, step: 3
Epoch 35/300 |loss: 0.000702| train set 5.247x speedup, test set 0.662x speedup, val set 5.487x speedup, step: 1
Epoch 36/300 |loss: 0.000709| train set 5.249x speedup, test set 0.663x speedup, val set 5.487x speedup, step: 2
Epoch 37/300 |loss: 0.001406| train set 5.248x speedup, test set 0.664x speedup, val set 5.489x speedup, step: 1
Epoch 38/300 |loss: 0.000708| train set 5.244x speedup, test set 0.663x speedup, val set 5.473x speedup, step: 2
Epoch 39/300 |loss: 0.000633| train set 5.247x speedup, test set 0.664x speedup, val set 5.484x speedup, step: 3
Epoch 40/300 |loss: 0.000629| train set 5.212x speedup, test set 0.663x speedup, val set 5.374x speedup, step: 4
Epoch 41/300 |loss: 0.000583| train set 5.249x speedup, test set 0.663x speedup, val set 5.487x speedup, step: 5
Epoch 42/300 |loss: 0.000651| train set 5.244x speedup, test set 0.663x speedup, val set 5.473x speedup, step: 6
Epoch 43/300 |loss: 0.000650| train set 5.208x speedup, test set 0.665x speedup, val set 5.360x speedup, step: 7
early stopping at epoch 43
Training per epoch cost 0.488 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 2.104s, pg runtime 1.680s, speedup 0.798x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 46.250s, pg runtime 6.444s, speedup 0.139x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 26, train speedup 5.249, test speedup 0.678, val speedup 5.487
best test speedup epoch: 0, train speedup 2.269, test speedup 1.363, val speedup 2.230
best validation speedup epoch: 37, train speedup 5.248, test speedup 0.664, val speedup 5.489
last model at epoch 43, train speedup 5.208, test speedup 0.665, val speedup 5.360
execution cost 0:00:52.057113
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.485558, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019860| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010608| train set 2.916x speedup, test set 0.677x speedup, val set 3.089x speedup, step: 1
Epoch 3/300 |loss: 0.007167| train set 3.268x speedup, test set 0.986x speedup, val set 3.571x speedup, step: 1
Epoch 4/300 |loss: 0.005641| train set 3.347x speedup, test set 1.373x speedup, val set 3.638x speedup, step: 1
Epoch 5/300 |loss: 0.003804| train set 3.117x speedup, test set 0.963x speedup, val set 3.395x speedup, step: 2
Epoch 6/300 |loss: 0.003834| train set 3.646x speedup, test set 1.008x speedup, val set 3.919x speedup, step: 1
Epoch 7/300 |loss: 0.003192| train set 3.282x speedup, test set 0.995x speedup, val set 3.576x speedup, step: 2
Epoch 8/300 |loss: 0.002650| train set 3.767x speedup, test set 0.916x speedup, val set 4.129x speedup, step: 1
Epoch 9/300 |loss: 0.002351| train set 5.154x speedup, test set 1.030x speedup, val set 5.433x speedup, step: 1
Epoch 10/300 |loss: 0.002109| train set 3.707x speedup, test set 0.882x speedup, val set 4.015x speedup, step: 2
Epoch 11/300 |loss: 0.001919| train set 5.184x speedup, test set 0.942x speedup, val set 5.457x speedup, step: 1
Epoch 12/300 |loss: 0.002004| train set 5.255x speedup, test set 0.869x speedup, val set 5.530x speedup, step: 1
Epoch 13/300 |loss: 0.002508| train set 5.260x speedup, test set 0.892x speedup, val set 5.541x speedup, step: 1
Epoch 14/300 |loss: 0.002601| train set 3.312x speedup, test set 0.733x speedup, val set 3.648x speedup, step: 2
Epoch 15/300 |loss: 0.002771| train set 5.152x speedup, test set 0.882x speedup, val set 5.521x speedup, step: 3
Epoch 16/300 |loss: 0.001560| train set 5.262x speedup, test set 0.715x speedup, val set 5.638x speedup, step: 1
Epoch 17/300 |loss: 0.001382| train set 3.950x speedup, test set 0.672x speedup, val set 4.346x speedup, step: 2
Epoch 18/300 |loss: 0.001576| train set 5.160x speedup, test set 0.686x speedup, val set 5.556x speedup, step: 3
Epoch 19/300 |loss: 0.001483| train set 5.152x speedup, test set 0.684x speedup, val set 5.423x speedup, step: 4
Epoch 20/300 |loss: 0.001379| train set 5.177x speedup, test set 0.681x speedup, val set 5.680x speedup, step: 1
Epoch 21/300 |loss: 0.000970| train set 5.259x speedup, test set 0.680x speedup, val set 5.638x speedup, step: 2
Epoch 22/300 |loss: 0.001520| train set 5.153x speedup, test set 0.684x speedup, val set 5.517x speedup, step: 3
Epoch 23/300 |loss: 0.001256| train set 5.262x speedup, test set 0.684x speedup, val set 5.638x speedup, step: 4
Epoch 24/300 |loss: 0.000894| train set 4.682x speedup, test set 0.682x speedup, val set 4.938x speedup, step: 5
Epoch 25/300 |loss: 0.000781| train set 5.258x speedup, test set 0.684x speedup, val set 5.529x speedup, step: 6
Epoch 26/300 |loss: 0.000722| train set 5.179x speedup, test set 0.683x speedup, val set 5.679x speedup, step: 7
Epoch 27/300 |loss: 0.000745| train set 5.259x speedup, test set 0.683x speedup, val set 5.625x speedup, step: 8
Epoch 28/300 |loss: 0.000730| train set 5.263x speedup, test set 0.683x speedup, val set 5.539x speedup, step: 9
Epoch 29/300 |loss: 0.000817| train set 5.156x speedup, test set 0.683x speedup, val set 5.526x speedup, step: 10
Epoch 30/300 |loss: 0.000713| train set 5.256x speedup, test set 0.686x speedup, val set 5.627x speedup, step: 11
Epoch 31/300 |loss: 0.000709| train set 5.259x speedup, test set 0.686x speedup, val set 5.638x speedup, step: 12
Epoch 32/300 |loss: 0.000695| train set 5.262x speedup, test set 0.674x speedup, val set 5.537x speedup, step: 13
Epoch 33/300 |loss: 0.000680| train set 5.235x speedup, test set 0.674x speedup, val set 5.612x speedup, step: 14
Epoch 34/300 |loss: 0.000672| train set 5.262x speedup, test set 0.674x speedup, val set 5.637x speedup, step: 15
Epoch 35/300 |loss: 0.000733| train set 5.259x speedup, test set 0.674x speedup, val set 5.638x speedup, step: 16
Epoch 36/300 |loss: 0.000723| train set 5.170x speedup, test set 0.683x speedup, val set 5.668x speedup, step: 17
Epoch 37/300 |loss: 0.000826| train set 5.264x speedup, test set 0.684x speedup, val set 5.539x speedup, step: 18
Epoch 38/300 |loss: 0.000732| train set 5.256x speedup, test set 0.684x speedup, val set 5.626x speedup, step: 19
Epoch 39/300 |loss: 0.000704| train set 5.253x speedup, test set 0.684x speedup, val set 5.637x speedup, step: 20
Epoch 40/300 |loss: 0.000651| train set 5.141x speedup, test set 0.674x speedup, val set 5.664x speedup, step: 21
Epoch 41/300 |loss: 0.000685| train set 5.262x speedup, test set 0.674x speedup, val set 5.638x speedup, step: 22
Epoch 42/300 |loss: 0.000693| train set 5.239x speedup, test set 0.680x speedup, val set 5.613x speedup, step: 23
early stopping at epoch 42
Training per epoch cost 0.437 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 7.065s, pg runtime 5.855s, speedup 0.829x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.087s, pg runtime 0.089s, speedup 1.024x
21, opt runtime 0.953s, model runtime 8.321s, pg runtime 4.730s, speedup 0.568x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.218s, pg runtime 0.158s, speedup 0.728x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 37, train speedup 5.264, test speedup 0.684, val speedup 5.539
best test speedup epoch: 4, train speedup 3.347, test speedup 1.373, val speedup 3.638
best validation speedup epoch: 20, train speedup 5.177, test speedup 0.681, val speedup 5.680
last model at epoch 42, train speedup 5.239, test speedup 0.680, val speedup 5.613
execution cost 0:00:45.682322
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.506776, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019868| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010596| train set 3.168x speedup, test set 0.677x speedup, val set 3.408x speedup, step: 1
Epoch 3/300 |loss: 0.007215| train set 3.269x speedup, test set 0.882x speedup, val set 3.570x speedup, step: 1
Epoch 4/300 |loss: 0.005759| train set 3.647x speedup, test set 1.455x speedup, val set 3.921x speedup, step: 1
Epoch 5/300 |loss: 0.003857| train set 3.117x speedup, test set 0.977x speedup, val set 3.395x speedup, step: 2
Epoch 6/300 |loss: 0.003644| train set 3.364x speedup, test set 1.008x speedup, val set 3.591x speedup, step: 3
Epoch 7/300 |loss: 0.003099| train set 3.322x speedup, test set 0.951x speedup, val set 3.312x speedup, step: 4
Epoch 8/300 |loss: 0.002605| train set 3.880x speedup, test set 0.913x speedup, val set 4.315x speedup, step: 1
Epoch 9/300 |loss: 0.002323| train set 5.263x speedup, test set 0.982x speedup, val set 5.539x speedup, step: 1
Epoch 10/300 |loss: 0.002101| train set 3.672x speedup, test set 0.920x speedup, val set 3.978x speedup, step: 2
Epoch 11/300 |loss: 0.002019| train set 5.162x speedup, test set 0.991x speedup, val set 5.434x speedup, step: 3
Epoch 12/300 |loss: 0.002192| train set 5.169x speedup, test set 0.855x speedup, val set 5.336x speedup, step: 4
Epoch 13/300 |loss: 0.002182| train set 5.249x speedup, test set 0.900x speedup, val set 5.520x speedup, step: 5
Epoch 14/300 |loss: 0.002296| train set 3.314x speedup, test set 0.722x speedup, val set 3.653x speedup, step: 6
Epoch 15/300 |loss: 0.002136| train set 5.188x speedup, test set 0.726x speedup, val set 5.563x speedup, step: 1
Epoch 16/300 |loss: 0.001644| train set 5.189x speedup, test set 0.722x speedup, val set 5.468x speedup, step: 2
Epoch 17/300 |loss: 0.001482| train set 3.974x speedup, test set 0.693x speedup, val set 4.371x speedup, step: 3
Epoch 18/300 |loss: 0.001790| train set 5.074x speedup, test set 0.691x speedup, val set 5.567x speedup, step: 1
Epoch 19/300 |loss: 0.001702| train set 5.157x speedup, test set 0.701x speedup, val set 5.434x speedup, step: 2
Epoch 20/300 |loss: 0.001532| train set 4.082x speedup, test set 0.676x speedup, val set 4.324x speedup, step: 3
Epoch 21/300 |loss: 0.001215| train set 5.253x speedup, test set 0.680x speedup, val set 5.628x speedup, step: 1
Epoch 22/300 |loss: 0.001385| train set 5.079x speedup, test set 0.680x speedup, val set 5.566x speedup, step: 2
Epoch 23/300 |loss: 0.001024| train set 5.262x speedup, test set 0.685x speedup, val set 5.638x speedup, step: 1
Epoch 24/300 |loss: 0.000844| train set 3.990x speedup, test set 0.672x speedup, val set 4.384x speedup, step: 2
Epoch 25/300 |loss: 0.000956| train set 5.256x speedup, test set 0.692x speedup, val set 5.627x speedup, step: 3
Epoch 26/300 |loss: 0.000858| train set 5.251x speedup, test set 0.693x speedup, val set 5.625x speedup, step: 4
Epoch 27/300 |loss: 0.000726| train set 5.177x speedup, test set 0.696x speedup, val set 5.678x speedup, step: 1
Epoch 28/300 |loss: 0.000783| train set 5.159x speedup, test set 0.685x speedup, val set 5.557x speedup, step: 2
Epoch 29/300 |loss: 0.000766| train set 5.258x speedup, test set 0.690x speedup, val set 5.528x speedup, step: 3
Epoch 30/300 |loss: 0.000725| train set 5.254x speedup, test set 0.692x speedup, val set 5.617x speedup, step: 4
Epoch 31/300 |loss: 0.000734| train set 5.255x speedup, test set 0.685x speedup, val set 5.620x speedup, step: 5
Epoch 32/300 |loss: 0.000736| train set 5.262x speedup, test set 0.693x speedup, val set 5.638x speedup, step: 6
Epoch 33/300 |loss: 0.000701| train set 5.264x speedup, test set 0.684x speedup, val set 5.539x speedup, step: 7
Epoch 34/300 |loss: 0.000822| train set 5.251x speedup, test set 0.696x speedup, val set 5.612x speedup, step: 8
Epoch 35/300 |loss: 0.000700| train set 5.257x speedup, test set 0.694x speedup, val set 5.528x speedup, step: 9
Epoch 36/300 |loss: 0.000727| train set 5.247x speedup, test set 0.693x speedup, val set 5.617x speedup, step: 10
Epoch 37/300 |loss: 0.000739| train set 5.256x speedup, test set 0.693x speedup, val set 5.627x speedup, step: 11
Epoch 38/300 |loss: 0.000680| train set 5.259x speedup, test set 0.685x speedup, val set 5.627x speedup, step: 12
Epoch 39/300 |loss: 0.000692| train set 5.252x speedup, test set 0.691x speedup, val set 5.638x speedup, step: 13
Epoch 40/300 |loss: 0.000663| train set 5.153x speedup, test set 0.683x speedup, val set 5.640x speedup, step: 14
Epoch 41/300 |loss: 0.000722| train set 5.259x speedup, test set 0.682x speedup, val set 5.624x speedup, step: 15
Epoch 42/300 |loss: 0.000751| train set 5.255x speedup, test set 0.684x speedup, val set 5.638x speedup, step: 16
early stopping at epoch 42
Training per epoch cost 0.433 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 0.920s, pg runtime 1.680s, speedup 1.825x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.087s, pg runtime 0.089s, speedup 1.024x
21, opt runtime 0.953s, model runtime 8.290s, pg runtime 4.730s, speedup 0.571x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 2.847s, pg runtime 3.112s, speedup 1.093x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.204s, pg runtime 0.239s, speedup 1.170x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.218s, pg runtime 0.158s, speedup 0.728x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 33, train speedup 5.264, test speedup 0.684, val speedup 5.539
best test speedup epoch: 4, train speedup 3.647, test speedup 1.455, val speedup 3.921
best validation speedup epoch: 27, train speedup 5.177, test speedup 0.696, val speedup 5.678
last model at epoch 42, train speedup 5.255, test speedup 0.684, val speedup 5.638
execution cost 0:00:45.810796
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.507523, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019868| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010596| train set 3.168x speedup, test set 0.677x speedup, val set 3.408x speedup, step: 1
Epoch 3/300 |loss: 0.007215| train set 3.269x speedup, test set 0.882x speedup, val set 3.570x speedup, step: 1
Epoch 4/300 |loss: 0.005759| train set 3.647x speedup, test set 1.455x speedup, val set 3.921x speedup, step: 1
Epoch 5/300 |loss: 0.003858| train set 3.117x speedup, test set 0.977x speedup, val set 3.395x speedup, step: 2
Epoch 6/300 |loss: 0.003641| train set 3.375x speedup, test set 0.975x speedup, val set 3.639x speedup, step: 3
Epoch 7/300 |loss: 0.003097| train set 3.320x speedup, test set 0.960x speedup, val set 3.308x speedup, step: 4
Epoch 8/300 |loss: 0.002599| train set 3.672x speedup, test set 0.926x speedup, val set 3.979x speedup, step: 1
Epoch 9/300 |loss: 0.002316| train set 5.163x speedup, test set 0.975x speedup, val set 5.443x speedup, step: 1
Epoch 10/300 |loss: 0.002091| train set 3.631x speedup, test set 0.920x speedup, val set 3.999x speedup, step: 2
Epoch 11/300 |loss: 0.002067| train set 5.160x speedup, test set 0.983x speedup, val set 5.436x speedup, step: 3
Epoch 12/300 |loss: 0.002374| train set 5.169x speedup, test set 0.899x speedup, val set 5.336x speedup, step: 4
Epoch 13/300 |loss: 0.002077| train set 5.248x speedup, test set 0.900x speedup, val set 5.520x speedup, step: 1
Epoch 14/300 |loss: 0.002262| train set 3.314x speedup, test set 0.725x speedup, val set 3.653x speedup, step: 2
Epoch 15/300 |loss: 0.002225| train set 5.100x speedup, test set 0.757x speedup, val set 5.358x speedup, step: 3
Epoch 16/300 |loss: 0.001667| train set 5.185x speedup, test set 0.704x speedup, val set 5.565x speedup, step: 1
Epoch 17/300 |loss: 0.001534| train set 3.974x speedup, test set 0.673x speedup, val set 4.371x speedup, step: 2
Epoch 18/300 |loss: 0.001819| train set 5.077x speedup, test set 0.692x speedup, val set 5.567x speedup, step: 1
Epoch 19/300 |loss: 0.001705| train set 5.157x speedup, test set 0.717x speedup, val set 5.423x speedup, step: 2
Epoch 20/300 |loss: 0.001450| train set 3.989x speedup, test set 0.673x speedup, val set 4.378x speedup, step: 3
Epoch 21/300 |loss: 0.001041| train set 5.261x speedup, test set 0.684x speedup, val set 5.536x speedup, step: 4
Epoch 22/300 |loss: 0.001344| train set 5.100x speedup, test set 0.682x speedup, val set 5.581x speedup, step: 1
Epoch 23/300 |loss: 0.001007| train set 5.261x speedup, test set 0.689x speedup, val set 5.638x speedup, step: 1
Epoch 24/300 |loss: 0.000781| train set 3.984x speedup, test set 0.675x speedup, val set 4.389x speedup, step: 2
Epoch 25/300 |loss: 0.000954| train set 5.256x speedup, test set 0.680x speedup, val set 5.626x speedup, step: 3
Epoch 26/300 |loss: 0.000819| train set 5.174x speedup, test set 0.689x speedup, val set 5.657x speedup, step: 1
Epoch 27/300 |loss: 0.000763| train set 5.178x speedup, test set 0.676x speedup, val set 5.677x speedup, step: 1
Epoch 28/300 |loss: 0.000950| train set 5.091x speedup, test set 0.682x speedup, val set 5.465x speedup, step: 2
Epoch 29/300 |loss: 0.000829| train set 5.238x speedup, test set 0.687x speedup, val set 5.614x speedup, step: 3
Epoch 30/300 |loss: 0.000818| train set 5.259x speedup, test set 0.693x speedup, val set 5.638x speedup, step: 4
Epoch 31/300 |loss: 0.000772| train set 5.238x speedup, test set 0.675x speedup, val set 5.598x speedup, step: 5
Epoch 32/300 |loss: 0.000705| train set 5.262x speedup, test set 0.693x speedup, val set 5.637x speedup, step: 6
Epoch 33/300 |loss: 0.000704| train set 5.264x speedup, test set 0.693x speedup, val set 5.539x speedup, step: 7
Epoch 34/300 |loss: 0.000715| train set 5.262x speedup, test set 0.680x speedup, val set 5.638x speedup, step: 8
Epoch 35/300 |loss: 0.000679| train set 5.254x speedup, test set 0.678x speedup, val set 5.628x speedup, step: 9
Epoch 36/300 |loss: 0.000725| train set 5.260x speedup, test set 0.692x speedup, val set 5.539x speedup, step: 10
Epoch 37/300 |loss: 0.000766| train set 5.256x speedup, test set 0.695x speedup, val set 5.628x speedup, step: 11
Epoch 38/300 |loss: 0.000670| train set 5.254x speedup, test set 0.684x speedup, val set 5.614x speedup, step: 12
Epoch 39/300 |loss: 0.000684| train set 5.253x speedup, test set 0.694x speedup, val set 5.637x speedup, step: 13
Epoch 40/300 |loss: 0.000641| train set 5.226x speedup, test set 0.678x speedup, val set 5.619x speedup, step: 14
Epoch 41/300 |loss: 0.000668| train set 5.259x speedup, test set 0.682x speedup, val set 5.625x speedup, step: 15
Epoch 42/300 |loss: 0.000681| train set 5.262x speedup, test set 0.676x speedup, val set 5.637x speedup, step: 16
Epoch 43/300 |loss: 0.000736| train set 5.256x speedup, test set 0.683x speedup, val set 5.628x speedup, step: 17
Epoch 44/300 |loss: 0.001950| train set 5.130x speedup, test set 0.670x speedup, val set 5.585x speedup, step: 18
early stopping at epoch 44
Training per epoch cost 0.436 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 7.065s, pg runtime 5.855s, speedup 0.829x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.237s, pg runtime 1.680s, speedup 1.358x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 8.290s, pg runtime 4.730s, speedup 0.571x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 2.847s, pg runtime 3.112s, speedup 1.093x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.204s, pg runtime 0.239s, speedup 1.170x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 0.218s, pg runtime 0.158s, speedup 0.728x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 33, train speedup 5.264, test speedup 0.693, val speedup 5.539
best test speedup epoch: 4, train speedup 3.647, test speedup 1.455, val speedup 3.921
best validation speedup epoch: 27, train speedup 5.178, test speedup 0.676, val speedup 5.677
last model at epoch 44, train speedup 5.130, test speedup 0.670, val speedup 5.585
execution cost 0:00:47.497071
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.485932, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019868| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010596| train set 3.168x speedup, test set 0.677x speedup, val set 3.408x speedup, step: 1
Epoch 3/300 |loss: 0.007215| train set 3.269x speedup, test set 0.882x speedup, val set 3.570x speedup, step: 1
Epoch 4/300 |loss: 0.005759| train set 3.647x speedup, test set 1.455x speedup, val set 3.921x speedup, step: 1
Epoch 5/300 |loss: 0.003859| train set 3.117x speedup, test set 1.003x speedup, val set 3.395x speedup, step: 2
Epoch 6/300 |loss: 0.003660| train set 3.415x speedup, test set 1.004x speedup, val set 3.677x speedup, step: 3
Epoch 7/300 |loss: 0.003095| train set 3.054x speedup, test set 0.947x speedup, val set 3.299x speedup, step: 4
Epoch 8/300 |loss: 0.002655| train set 3.661x speedup, test set 0.925x speedup, val set 3.967x speedup, step: 1
Epoch 9/300 |loss: 0.002324| train set 5.253x speedup, test set 0.950x speedup, val set 5.539x speedup, step: 1
Epoch 10/300 |loss: 0.002072| train set 3.672x speedup, test set 0.890x speedup, val set 3.979x speedup, step: 2
Epoch 11/300 |loss: 0.002078| train set 5.184x speedup, test set 0.951x speedup, val set 5.458x speedup, step: 3
Epoch 12/300 |loss: 0.002217| train set 5.170x speedup, test set 0.867x speedup, val set 5.337x speedup, step: 4
Epoch 13/300 |loss: 0.002335| train set 5.251x speedup, test set 0.860x speedup, val set 5.527x speedup, step: 5
Epoch 14/300 |loss: 0.002110| train set 4.606x speedup, test set 0.714x speedup, val set 5.146x speedup, step: 6
Epoch 15/300 |loss: 0.002107| train set 5.135x speedup, test set 0.721x speedup, val set 5.358x speedup, step: 7
Epoch 16/300 |loss: 0.001607| train set 5.188x speedup, test set 0.729x speedup, val set 5.564x speedup, step: 1
Epoch 17/300 |loss: 0.001563| train set 3.993x speedup, test set 0.718x speedup, val set 4.392x speedup, step: 2
Epoch 18/300 |loss: 0.001881| train set 5.076x speedup, test set 0.706x speedup, val set 5.568x speedup, step: 1
Epoch 19/300 |loss: 0.001718| train set 5.177x speedup, test set 0.703x speedup, val set 5.543x speedup, step: 2
Epoch 20/300 |loss: 0.001439| train set 4.298x speedup, test set 0.672x speedup, val set 4.384x speedup, step: 3
Epoch 21/300 |loss: 0.001114| train set 5.179x speedup, test set 0.678x speedup, val set 5.553x speedup, step: 4
Epoch 22/300 |loss: 0.002037| train set 5.066x speedup, test set 0.668x speedup, val set 5.392x speedup, step: 5
Epoch 23/300 |loss: 0.001723| train set 5.258x speedup, test set 0.693x speedup, val set 5.635x speedup, step: 1
Epoch 24/300 |loss: 0.000948| train set 3.984x speedup, test set 0.690x speedup, val set 4.379x speedup, step: 2
Epoch 25/300 |loss: 0.000812| train set 5.260x speedup, test set 0.684x speedup, val set 5.539x speedup, step: 3
Epoch 26/300 |loss: 0.000766| train set 5.174x speedup, test set 0.693x speedup, val set 5.668x speedup, step: 1
Epoch 27/300 |loss: 0.000786| train set 5.260x speedup, test set 0.687x speedup, val set 5.635x speedup, step: 2
Epoch 28/300 |loss: 0.000891| train set 4.818x speedup, test set 0.693x speedup, val set 5.215x speedup, step: 3
Epoch 29/300 |loss: 0.001026| train set 5.259x speedup, test set 0.689x speedup, val set 5.627x speedup, step: 4
Epoch 30/300 |loss: 0.000801| train set 5.254x speedup, test set 0.688x speedup, val set 5.628x speedup, step: 5
Epoch 31/300 |loss: 0.000738| train set 5.259x speedup, test set 0.687x speedup, val set 5.638x speedup, step: 6
Epoch 32/300 |loss: 0.000765| train set 5.263x speedup, test set 0.693x speedup, val set 5.540x speedup, step: 7
Epoch 33/300 |loss: 0.000784| train set 5.264x speedup, test set 0.693x speedup, val set 5.528x speedup, step: 8
Epoch 34/300 |loss: 0.000712| train set 5.256x speedup, test set 0.694x speedup, val set 5.627x speedup, step: 9
Epoch 35/300 |loss: 0.000723| train set 5.259x speedup, test set 0.694x speedup, val set 5.638x speedup, step: 10
Epoch 36/300 |loss: 0.000725| train set 5.179x speedup, test set 0.694x speedup, val set 5.678x speedup, step: 1
Epoch 37/300 |loss: 0.000887| train set 5.253x speedup, test set 0.693x speedup, val set 5.627x speedup, step: 2
Epoch 38/300 |loss: 0.000778| train set 5.256x speedup, test set 0.690x speedup, val set 5.626x speedup, step: 3
Epoch 39/300 |loss: 0.001034| train set 5.254x speedup, test set 0.681x speedup, val set 5.529x speedup, step: 4
Epoch 40/300 |loss: 0.000680| train set 5.238x speedup, test set 0.693x speedup, val set 5.598x speedup, step: 5
Epoch 41/300 |loss: 0.000692| train set 5.254x speedup, test set 0.690x speedup, val set 5.628x speedup, step: 6
Epoch 42/300 |loss: 0.000671| train set 5.237x speedup, test set 0.688x speedup, val set 5.614x speedup, step: 7
Epoch 43/300 |loss: 0.000635| train set 5.259x speedup, test set 0.693x speedup, val set 5.626x speedup, step: 8
Epoch 44/300 |loss: 0.001710| train set 5.163x speedup, test set 0.690x speedup, val set 5.496x speedup, step: 9
Epoch 45/300 |loss: 0.000895| train set 5.259x speedup, test set 0.693x speedup, val set 5.625x speedup, step: 10
early stopping at epoch 45
Training per epoch cost 0.425 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.237s, pg runtime 1.680s, speedup 1.358x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 8.321s, pg runtime 4.730s, speedup 0.568x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.204s, pg runtime 0.239s, speedup 1.170x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.218s, pg runtime 0.158s, speedup 0.728x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 33, train speedup 5.264, test speedup 0.693, val speedup 5.528
best test speedup epoch: 4, train speedup 3.647, test speedup 1.455, val speedup 3.921
best validation speedup epoch: 36, train speedup 5.179, test speedup 0.694, val speedup 5.678
last model at epoch 45, train speedup 5.259, test speedup 0.693, val speedup 5.625
execution cost 0:00:48.310235
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.497229, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019860| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010608| train set 2.916x speedup, test set 0.677x speedup, val set 3.089x speedup, step: 1
Epoch 3/300 |loss: 0.007167| train set 3.268x speedup, test set 0.986x speedup, val set 3.571x speedup, step: 1
Epoch 4/300 |loss: 0.005641| train set 3.347x speedup, test set 1.373x speedup, val set 3.638x speedup, step: 1
Epoch 5/300 |loss: 0.003803| train set 3.117x speedup, test set 0.963x speedup, val set 3.395x speedup, step: 2
Epoch 6/300 |loss: 0.003809| train set 3.649x speedup, test set 0.994x speedup, val set 3.920x speedup, step: 1
Epoch 7/300 |loss: 0.003182| train set 3.282x speedup, test set 0.961x speedup, val set 3.576x speedup, step: 2
Epoch 8/300 |loss: 0.002589| train set 3.667x speedup, test set 0.908x speedup, val set 3.974x speedup, step: 1
Epoch 9/300 |loss: 0.002413| train set 5.263x speedup, test set 0.952x speedup, val set 5.538x speedup, step: 1
Epoch 10/300 |loss: 0.002121| train set 3.666x speedup, test set 0.859x speedup, val set 4.036x speedup, step: 2
Epoch 11/300 |loss: 0.001949| train set 5.184x speedup, test set 0.937x speedup, val set 5.457x speedup, step: 3
Epoch 12/300 |loss: 0.002098| train set 5.261x speedup, test set 0.883x speedup, val set 5.540x speedup, step: 1
Epoch 13/300 |loss: 0.002520| train set 5.253x speedup, test set 0.882x speedup, val set 5.628x speedup, step: 1
Epoch 14/300 |loss: 0.002436| train set 3.353x speedup, test set 0.730x speedup, val set 3.710x speedup, step: 2
Epoch 15/300 |loss: 0.002626| train set 5.165x speedup, test set 0.862x speedup, val set 5.434x speedup, step: 3
Epoch 16/300 |loss: 0.001636| train set 5.088x speedup, test set 0.871x speedup, val set 5.484x speedup, step: 4
Epoch 17/300 |loss: 0.001526| train set 3.987x speedup, test set 0.668x speedup, val set 4.386x speedup, step: 5
Epoch 18/300 |loss: 0.001668| train set 5.177x speedup, test set 0.731x speedup, val set 5.680x speedup, step: 1
Epoch 19/300 |loss: 0.001512| train set 5.158x speedup, test set 0.833x speedup, val set 5.527x speedup, step: 2
Epoch 20/300 |loss: 0.001477| train set 5.105x speedup, test set 0.673x speedup, val set 5.593x speedup, step: 3
Epoch 21/300 |loss: 0.001029| train set 5.262x speedup, test set 0.673x speedup, val set 5.638x speedup, step: 4
Epoch 22/300 |loss: 0.002115| train set 5.165x speedup, test set 0.685x speedup, val set 5.446x speedup, step: 5
Epoch 23/300 |loss: 0.002102| train set 5.108x speedup, test set 0.675x speedup, val set 5.604x speedup, step: 6
Epoch 24/300 |loss: 0.000937| train set 4.461x speedup, test set 0.671x speedup, val set 4.939x speedup, step: 7
Epoch 25/300 |loss: 0.000832| train set 5.264x speedup, test set 0.678x speedup, val set 5.539x speedup, step: 8
Epoch 26/300 |loss: 0.000732| train set 5.177x speedup, test set 0.675x speedup, val set 5.680x speedup, step: 9
Epoch 27/300 |loss: 0.000746| train set 5.179x speedup, test set 0.675x speedup, val set 5.679x speedup, step: 10
Epoch 28/300 |loss: 0.000758| train set 5.263x speedup, test set 0.678x speedup, val set 5.539x speedup, step: 11
Epoch 29/300 |loss: 0.000818| train set 5.158x speedup, test set 0.675x speedup, val set 5.433x speedup, step: 12
Epoch 30/300 |loss: 0.001068| train set 5.254x speedup, test set 0.674x speedup, val set 5.628x speedup, step: 13
Epoch 31/300 |loss: 0.000819| train set 5.253x speedup, test set 0.675x speedup, val set 5.637x speedup, step: 14
Epoch 32/300 |loss: 0.000673| train set 5.262x speedup, test set 0.677x speedup, val set 5.637x speedup, step: 15
Epoch 33/300 |loss: 0.000705| train set 5.179x speedup, test set 0.674x speedup, val set 5.679x speedup, step: 16
Epoch 34/300 |loss: 0.000697| train set 5.262x speedup, test set 0.679x speedup, val set 5.637x speedup, step: 17
Epoch 35/300 |loss: 0.000694| train set 5.259x speedup, test set 0.675x speedup, val set 5.638x speedup, step: 18
Epoch 36/300 |loss: 0.000650| train set 5.247x speedup, test set 0.675x speedup, val set 5.617x speedup, step: 19
Epoch 37/300 |loss: 0.000820| train set 5.256x speedup, test set 0.675x speedup, val set 5.626x speedup, step: 20
Epoch 38/300 |loss: 0.000673| train set 5.262x speedup, test set 0.674x speedup, val set 5.637x speedup, step: 21
Epoch 39/300 |loss: 0.000758| train set 5.253x speedup, test set 0.678x speedup, val set 5.637x speedup, step: 22
Epoch 40/300 |loss: 0.000679| train set 5.174x speedup, test set 0.674x speedup, val set 5.668x speedup, step: 23
Epoch 41/300 |loss: 0.000663| train set 5.262x speedup, test set 0.679x speedup, val set 5.637x speedup, step: 24
Epoch 42/300 |loss: 0.000637| train set 5.259x speedup, test set 0.675x speedup, val set 5.638x speedup, step: 25
Epoch 43/300 |loss: 0.000631| train set 5.253x speedup, test set 0.675x speedup, val set 5.616x speedup, step: 26
Epoch 44/300 |loss: 0.001639| train set 5.230x speedup, test set 0.679x speedup, val set 5.605x speedup, step: 27
Epoch 45/300 |loss: 0.000820| train set 5.254x speedup, test set 0.674x speedup, val set 5.615x speedup, step: 28
early stopping at epoch 45
Training per epoch cost 0.440 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 7.470s, pg runtime 5.855s, speedup 0.784x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 2.846s, pg runtime 3.507s, speedup 1.232x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 2.962s, pg runtime 6.876s, speedup 2.321x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.087s, pg runtime 0.089s, speedup 1.024x
21, opt runtime 0.953s, model runtime 8.321s, pg runtime 4.730s, speedup 0.568x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
25, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.167s, pg runtime 0.158s, speedup 0.947x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 25, train speedup 5.264, test speedup 0.678, val speedup 5.539
best test speedup epoch: 4, train speedup 3.347, test speedup 1.373, val speedup 3.638
best validation speedup epoch: 18, train speedup 5.177, test speedup 0.731, val speedup 5.680
last model at epoch 45, train speedup 5.254, test speedup 0.674, val speedup 5.615
execution cost 0:00:48.858327
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.553675, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019868| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010613| train set 3.168x speedup, test set 0.676x speedup, val set 3.408x speedup, step: 1
Epoch 3/300 |loss: 0.007273| train set 3.482x speedup, test set 0.911x speedup, val set 3.740x speedup, step: 1
Epoch 4/300 |loss: 0.005736| train set 3.644x speedup, test set 1.456x speedup, val set 3.916x speedup, step: 1
Epoch 5/300 |loss: 0.003851| train set 3.116x speedup, test set 1.013x speedup, val set 3.394x speedup, step: 2
Epoch 6/300 |loss: 0.003671| train set 3.646x speedup, test set 1.008x speedup, val set 3.919x speedup, step: 1
Epoch 7/300 |loss: 0.003175| train set 4.156x speedup, test set 0.966x speedup, val set 4.492x speedup, step: 1
Epoch 8/300 |loss: 0.002629| train set 3.671x speedup, test set 0.903x speedup, val set 3.928x speedup, step: 2
Epoch 9/300 |loss: 0.002542| train set 5.160x speedup, test set 1.153x speedup, val set 5.442x speedup, step: 1
Epoch 10/300 |loss: 0.002338| train set 3.621x speedup, test set 0.762x speedup, val set 3.987x speedup, step: 2
Epoch 11/300 |loss: 0.001965| train set 5.162x speedup, test set 1.144x speedup, val set 5.434x speedup, step: 3
Epoch 12/300 |loss: 0.002377| train set 5.238x speedup, test set 0.920x speedup, val set 5.516x speedup, step: 1
Epoch 13/300 |loss: 0.001979| train set 5.170x speedup, test set 1.130x speedup, val set 5.337x speedup, step: 2
Epoch 14/300 |loss: 0.002441| train set 3.349x speedup, test set 0.747x speedup, val set 3.710x speedup, step: 3
Epoch 15/300 |loss: 0.002565| train set 5.164x speedup, test set 0.744x speedup, val set 5.540x speedup, step: 1
Epoch 16/300 |loss: 0.001625| train set 5.241x speedup, test set 0.784x speedup, val set 5.517x speedup, step: 2
Epoch 17/300 |loss: 0.001396| train set 3.934x speedup, test set 0.673x speedup, val set 4.326x speedup, step: 3
Epoch 18/300 |loss: 0.001694| train set 5.153x speedup, test set 0.706x speedup, val set 5.517x speedup, step: 4
Epoch 19/300 |loss: 0.001467| train set 5.180x speedup, test set 0.765x speedup, val set 5.540x speedup, step: 5
Epoch 20/300 |loss: 0.001263| train set 5.177x speedup, test set 0.682x speedup, val set 5.680x speedup, step: 1
Epoch 21/300 |loss: 0.000969| train set 5.174x speedup, test set 0.720x speedup, val set 5.553x speedup, step: 2
Epoch 22/300 |loss: 0.002007| train set 5.249x speedup, test set 0.681x speedup, val set 5.529x speedup, step: 3
Epoch 23/300 |loss: 0.001322| train set 5.262x speedup, test set 0.689x speedup, val set 5.637x speedup, step: 4
Epoch 24/300 |loss: 0.000893| train set 4.685x speedup, test set 0.673x speedup, val set 4.937x speedup, step: 5
Epoch 25/300 |loss: 0.000781| train set 5.255x speedup, test set 0.681x speedup, val set 5.529x speedup, step: 6
Epoch 26/300 |loss: 0.000739| train set 5.177x speedup, test set 0.679x speedup, val set 5.680x speedup, step: 1
Epoch 27/300 |loss: 0.000765| train set 5.179x speedup, test set 0.688x speedup, val set 5.680x speedup, step: 2
Epoch 28/300 |loss: 0.000786| train set 5.241x speedup, test set 0.688x speedup, val set 5.516x speedup, step: 3
Epoch 29/300 |loss: 0.000786| train set 5.256x speedup, test set 0.688x speedup, val set 5.626x speedup, step: 4
Epoch 30/300 |loss: 0.000833| train set 5.250x speedup, test set 0.688x speedup, val set 5.615x speedup, step: 5
Epoch 31/300 |loss: 0.000861| train set 5.262x speedup, test set 0.679x speedup, val set 5.637x speedup, step: 6
Epoch 32/300 |loss: 0.000807| train set 5.262x speedup, test set 0.679x speedup, val set 5.637x speedup, step: 7
Epoch 33/300 |loss: 0.000732| train set 5.262x speedup, test set 0.679x speedup, val set 5.637x speedup, step: 8
Epoch 34/300 |loss: 0.000667| train set 5.256x speedup, test set 0.674x speedup, val set 5.626x speedup, step: 9
Epoch 35/300 |loss: 0.000704| train set 5.259x speedup, test set 0.676x speedup, val set 5.638x speedup, step: 10
Epoch 36/300 |loss: 0.000702| train set 5.262x speedup, test set 0.679x speedup, val set 5.637x speedup, step: 11
Epoch 37/300 |loss: 0.000852| train set 5.256x speedup, test set 0.679x speedup, val set 5.627x speedup, step: 12
Epoch 38/300 |loss: 0.000701| train set 5.259x speedup, test set 0.679x speedup, val set 5.638x speedup, step: 13
Epoch 39/300 |loss: 0.000709| train set 5.253x speedup, test set 0.671x speedup, val set 5.637x speedup, step: 14
Epoch 40/300 |loss: 0.000637| train set 5.240x speedup, test set 0.682x speedup, val set 5.614x speedup, step: 15
Epoch 41/300 |loss: 0.000687| train set 5.254x speedup, test set 0.670x speedup, val set 5.628x speedup, step: 16
Epoch 42/300 |loss: 0.000683| train set 5.262x speedup, test set 0.677x speedup, val set 5.637x speedup, step: 17
Epoch 43/300 |loss: 0.000709| train set 5.256x speedup, test set 0.676x speedup, val set 5.627x speedup, step: 18
early stopping at epoch 43
Training per epoch cost 0.449 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 4.760s, pg runtime 5.855s, speedup 1.230x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.651s, pg runtime 1.680s, speedup 1.018x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.087s, pg runtime 0.089s, speedup 1.024x
21, opt runtime 0.953s, model runtime 8.321s, pg runtime 4.730s, speedup 0.568x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 0.167s, pg runtime 0.158s, speedup 0.947x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 23, train speedup 5.262, test speedup 0.689, val speedup 5.637
best test speedup epoch: 4, train speedup 3.644, test speedup 1.456, val speedup 3.916
best validation speedup epoch: 26, train speedup 5.177, test speedup 0.679, val speedup 5.680
last model at epoch 43, train speedup 5.256, test speedup 0.676, val speedup 5.627
execution cost 0:00:47.732849
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.465747, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019868| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010596| train set 3.168x speedup, test set 0.677x speedup, val set 3.408x speedup, step: 1
Epoch 3/300 |loss: 0.007215| train set 3.269x speedup, test set 0.882x speedup, val set 3.570x speedup, step: 1
Epoch 4/300 |loss: 0.005759| train set 3.647x speedup, test set 1.455x speedup, val set 3.921x speedup, step: 1
Epoch 5/300 |loss: 0.003856| train set 3.117x speedup, test set 1.001x speedup, val set 3.395x speedup, step: 2
Epoch 6/300 |loss: 0.003649| train set 3.376x speedup, test set 1.008x speedup, val set 3.641x speedup, step: 3
Epoch 7/300 |loss: 0.003150| train set 3.320x speedup, test set 0.947x speedup, val set 3.307x speedup, step: 4
Epoch 8/300 |loss: 0.002718| train set 3.672x speedup, test set 0.927x speedup, val set 3.979x speedup, step: 1
Epoch 9/300 |loss: 0.002317| train set 5.075x speedup, test set 0.975x speedup, val set 5.247x speedup, step: 1
Epoch 10/300 |loss: 0.002063| train set 3.671x speedup, test set 0.891x speedup, val set 3.977x speedup, step: 2
Epoch 11/300 |loss: 0.002050| train set 5.085x speedup, test set 0.905x speedup, val set 5.391x speedup, step: 1
Epoch 12/300 |loss: 0.002211| train set 5.263x speedup, test set 0.867x speedup, val set 5.538x speedup, step: 1
Epoch 13/300 |loss: 0.002156| train set 5.247x speedup, test set 0.861x speedup, val set 5.617x speedup, step: 1
Epoch 14/300 |loss: 0.002322| train set 3.314x speedup, test set 0.729x speedup, val set 3.653x speedup, step: 2
Epoch 15/300 |loss: 0.002335| train set 5.079x speedup, test set 0.729x speedup, val set 5.337x speedup, step: 3
Epoch 16/300 |loss: 0.001669| train set 5.167x speedup, test set 0.703x speedup, val set 5.444x speedup, step: 4
Epoch 17/300 |loss: 0.001556| train set 3.975x speedup, test set 0.673x speedup, val set 4.377x speedup, step: 5
Epoch 18/300 |loss: 0.001768| train set 5.076x speedup, test set 0.680x speedup, val set 5.568x speedup, step: 6
Epoch 19/300 |loss: 0.001648| train set 5.157x speedup, test set 0.717x speedup, val set 5.434x speedup, step: 7
Epoch 20/300 |loss: 0.001428| train set 3.949x speedup, test set 0.684x speedup, val set 4.339x speedup, step: 8
Epoch 21/300 |loss: 0.001092| train set 5.262x speedup, test set 0.685x speedup, val set 5.637x speedup, step: 1
Epoch 22/300 |loss: 0.001593| train set 5.100x speedup, test set 0.688x speedup, val set 5.581x speedup, step: 2
Epoch 23/300 |loss: 0.001158| train set 5.262x speedup, test set 0.677x speedup, val set 5.638x speedup, step: 1
Epoch 24/300 |loss: 0.000831| train set 3.985x speedup, test set 0.675x speedup, val set 4.396x speedup, step: 2
Epoch 25/300 |loss: 0.000959| train set 5.253x speedup, test set 0.666x speedup, val set 5.614x speedup, step: 3
Epoch 26/300 |loss: 0.000845| train set 5.245x speedup, test set 0.684x speedup, val set 5.624x speedup, step: 4
Epoch 27/300 |loss: 0.000761| train set 5.178x speedup, test set 0.688x speedup, val set 5.677x speedup, step: 1
Epoch 28/300 |loss: 0.000783| train set 5.179x speedup, test set 0.689x speedup, val set 5.577x speedup, step: 2
Epoch 29/300 |loss: 0.000771| train set 5.258x speedup, test set 0.681x speedup, val set 5.528x speedup, step: 3
Epoch 30/300 |loss: 0.000774| train set 5.256x speedup, test set 0.679x speedup, val set 5.627x speedup, step: 4
Epoch 31/300 |loss: 0.000813| train set 5.261x speedup, test set 0.679x speedup, val set 5.637x speedup, step: 5
Epoch 32/300 |loss: 0.000715| train set 5.260x speedup, test set 0.679x speedup, val set 5.528x speedup, step: 6
Epoch 33/300 |loss: 0.000709| train set 5.259x speedup, test set 0.693x speedup, val set 5.638x speedup, step: 7
Epoch 34/300 |loss: 0.000725| train set 5.254x speedup, test set 0.669x speedup, val set 5.530x speedup, step: 8
Epoch 35/300 |loss: 0.000704| train set 5.253x speedup, test set 0.688x speedup, val set 5.517x speedup, step: 9
Epoch 36/300 |loss: 0.000733| train set 5.262x speedup, test set 0.681x speedup, val set 5.638x speedup, step: 10
Epoch 37/300 |loss: 0.000758| train set 5.256x speedup, test set 0.686x speedup, val set 5.627x speedup, step: 11
Epoch 38/300 |loss: 0.000708| train set 5.256x speedup, test set 0.688x speedup, val set 5.626x speedup, step: 12
Epoch 39/300 |loss: 0.000701| train set 5.262x speedup, test set 0.681x speedup, val set 5.637x speedup, step: 13
Epoch 40/300 |loss: 0.000664| train set 5.153x speedup, test set 0.688x speedup, val set 5.639x speedup, step: 14
Epoch 41/300 |loss: 0.000682| train set 5.256x speedup, test set 0.687x speedup, val set 5.626x speedup, step: 15
Epoch 42/300 |loss: 0.000670| train set 5.179x speedup, test set 0.689x speedup, val set 5.678x speedup, step: 1
Epoch 43/300 |loss: 0.000768| train set 5.262x speedup, test set 0.689x speedup, val set 5.638x speedup, step: 2
Epoch 44/300 |loss: 0.002082| train set 5.022x speedup, test set 0.679x speedup, val set 5.388x speedup, step: 3
early stopping at epoch 44
Training per epoch cost 0.430 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 7.065s, pg runtime 5.855s, speedup 0.829x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.651s, pg runtime 1.680s, speedup 1.018x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 8.290s, pg runtime 4.730s, speedup 0.571x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 2.847s, pg runtime 3.112s, speedup 1.093x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.204s, pg runtime 0.239s, speedup 1.170x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.167s, pg runtime 0.158s, speedup 0.947x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 12, train speedup 5.263, test speedup 0.867, val speedup 5.538
best test speedup epoch: 4, train speedup 3.647, test speedup 1.455, val speedup 3.921
best validation speedup epoch: 42, train speedup 5.179, test speedup 0.689, val speedup 5.678
last model at epoch 44, train speedup 5.022, test speedup 0.679, val speedup 5.388
execution cost 0:00:46.789292
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.485220, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019860| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010608| train set 2.916x speedup, test set 0.677x speedup, val set 3.089x speedup, step: 1
Epoch 3/300 |loss: 0.007167| train set 3.268x speedup, test set 0.986x speedup, val set 3.571x speedup, step: 1
Epoch 4/300 |loss: 0.005644| train set 3.347x speedup, test set 0.981x speedup, val set 3.638x speedup, step: 1
Epoch 5/300 |loss: 0.003811| train set 3.054x speedup, test set 0.985x speedup, val set 3.304x speedup, step: 2
Epoch 6/300 |loss: 0.003837| train set 3.549x speedup, test set 0.996x speedup, val set 3.920x speedup, step: 1
Epoch 7/300 |loss: 0.003228| train set 3.282x speedup, test set 0.958x speedup, val set 3.576x speedup, step: 2
Epoch 8/300 |loss: 0.002628| train set 3.937x speedup, test set 0.918x speedup, val set 4.315x speedup, step: 1
Epoch 9/300 |loss: 0.002395| train set 5.263x speedup, test set 1.050x speedup, val set 5.538x speedup, step: 1
Epoch 10/300 |loss: 0.002136| train set 3.671x speedup, test set 0.883x speedup, val set 3.977x speedup, step: 2
Epoch 11/300 |loss: 0.001928| train set 5.162x speedup, test set 1.097x speedup, val set 5.434x speedup, step: 3
Epoch 12/300 |loss: 0.002185| train set 5.170x speedup, test set 0.889x speedup, val set 5.336x speedup, step: 4
Epoch 13/300 |loss: 0.002692| train set 5.258x speedup, test set 0.883x speedup, val set 5.537x speedup, step: 5
Epoch 14/300 |loss: 0.002055| train set 3.412x speedup, test set 0.748x speedup, val set 3.823x speedup, step: 6
Epoch 15/300 |loss: 0.002137| train set 5.188x speedup, test set 0.901x speedup, val set 5.563x speedup, step: 1
Epoch 16/300 |loss: 0.001633| train set 5.241x speedup, test set 0.913x speedup, val set 5.517x speedup, step: 2
Epoch 17/300 |loss: 0.001553| train set 3.987x speedup, test set 0.714x speedup, val set 4.386x speedup, step: 3
Epoch 18/300 |loss: 0.001664| train set 5.162x speedup, test set 0.702x speedup, val set 5.656x speedup, step: 1
Epoch 19/300 |loss: 0.001547| train set 5.158x speedup, test set 0.873x speedup, val set 5.433x speedup, step: 2
Epoch 20/300 |loss: 0.001423| train set 5.177x speedup, test set 0.672x speedup, val set 5.680x speedup, step: 1
Epoch 21/300 |loss: 0.000961| train set 5.190x speedup, test set 0.677x speedup, val set 5.467x speedup, step: 2
Epoch 22/300 |loss: 0.002151| train set 5.188x speedup, test set 0.684x speedup, val set 5.497x speedup, step: 3
Epoch 23/300 |loss: 0.001705| train set 5.061x speedup, test set 0.664x speedup, val set 5.555x speedup, step: 4
Epoch 24/300 |loss: 0.000975| train set 3.993x speedup, test set 0.671x speedup, val set 4.391x speedup, step: 5
Epoch 25/300 |loss: 0.000898| train set 5.256x speedup, test set 0.671x speedup, val set 5.627x speedup, step: 6
Epoch 26/300 |loss: 0.000691| train set 5.175x speedup, test set 0.674x speedup, val set 5.678x speedup, step: 7
Epoch 27/300 |loss: 0.000731| train set 5.179x speedup, test set 0.680x speedup, val set 5.680x speedup, step: 8
Epoch 28/300 |loss: 0.000692| train set 5.263x speedup, test set 0.682x speedup, val set 5.538x speedup, step: 9
Epoch 29/300 |loss: 0.000753| train set 5.255x speedup, test set 0.686x speedup, val set 5.530x speedup, step: 10
Epoch 30/300 |loss: 0.000703| train set 5.261x speedup, test set 0.686x speedup, val set 5.637x speedup, step: 11
Epoch 31/300 |loss: 0.000700| train set 5.259x speedup, test set 0.674x speedup, val set 5.638x speedup, step: 12
Epoch 32/300 |loss: 0.000718| train set 5.262x speedup, test set 0.677x speedup, val set 5.637x speedup, step: 13
Epoch 33/300 |loss: 0.000728| train set 5.263x speedup, test set 0.674x speedup, val set 5.539x speedup, step: 14
Epoch 34/300 |loss: 0.000697| train set 5.256x speedup, test set 0.668x speedup, val set 5.527x speedup, step: 15
Epoch 35/300 |loss: 0.000706| train set 5.259x speedup, test set 0.686x speedup, val set 5.638x speedup, step: 16
early stopping at epoch 35
Training per epoch cost 0.433 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 7.065s, pg runtime 5.855s, speedup 0.829x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.458s, pg runtime 0.453s, speedup 0.991x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.087s, pg runtime 0.089s, speedup 1.024x
21, opt runtime 0.953s, model runtime 8.321s, pg runtime 4.730s, speedup 0.568x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.847s, pg runtime 3.112s, speedup 1.093x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.218s, pg runtime 0.158s, speedup 0.728x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 33, train speedup 5.263, test speedup 0.674, val speedup 5.539
best test speedup epoch: 11, train speedup 5.162, test speedup 1.097, val speedup 5.434
best validation speedup epoch: 20, train speedup 5.177, test speedup 0.672, val speedup 5.680
last model at epoch 35, train speedup 5.259, test speedup 0.686, val speedup 5.638
execution cost 0:00:39.013957
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.568887, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019860| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010608| train set 2.916x speedup, test set 0.677x speedup, val set 3.089x speedup, step: 1
Epoch 3/300 |loss: 0.007167| train set 3.268x speedup, test set 0.986x speedup, val set 3.571x speedup, step: 1
Epoch 4/300 |loss: 0.005641| train set 3.347x speedup, test set 1.373x speedup, val set 3.638x speedup, step: 1
Epoch 5/300 |loss: 0.003803| train set 3.117x speedup, test set 0.963x speedup, val set 3.395x speedup, step: 2
Epoch 6/300 |loss: 0.003810| train set 3.459x speedup, test set 0.994x speedup, val set 3.769x speedup, step: 1
Epoch 7/300 |loss: 0.003192| train set 3.282x speedup, test set 0.961x speedup, val set 3.576x speedup, step: 2
Epoch 8/300 |loss: 0.002617| train set 3.990x speedup, test set 0.916x speedup, val set 4.310x speedup, step: 1
Epoch 9/300 |loss: 0.002390| train set 5.163x speedup, test set 1.014x speedup, val set 5.443x speedup, step: 1
Epoch 10/300 |loss: 0.002120| train set 3.665x speedup, test set 0.866x speedup, val set 3.977x speedup, step: 2
Epoch 11/300 |loss: 0.001975| train set 5.184x speedup, test set 0.875x speedup, val set 5.457x speedup, step: 1
Epoch 12/300 |loss: 0.002113| train set 5.200x speedup, test set 0.869x speedup, val set 5.327x speedup, step: 2
Epoch 13/300 |loss: 0.002597| train set 5.199x speedup, test set 0.878x speedup, val set 5.327x speedup, step: 3
Epoch 14/300 |loss: 0.002186| train set 3.409x speedup, test set 0.901x speedup, val set 3.826x speedup, step: 4
Epoch 15/300 |loss: 0.002235| train set 5.186x speedup, test set 0.881x speedup, val set 5.564x speedup, step: 1
Epoch 16/300 |loss: 0.001701| train set 5.263x speedup, test set 0.886x speedup, val set 5.540x speedup, step: 2
Epoch 17/300 |loss: 0.001597| train set 3.949x speedup, test set 0.666x speedup, val set 4.347x speedup, step: 3
Epoch 18/300 |loss: 0.001729| train set 5.167x speedup, test set 0.696x speedup, val set 5.658x speedup, step: 1
Epoch 19/300 |loss: 0.001604| train set 5.187x speedup, test set 0.812x speedup, val set 5.455x speedup, step: 2
Epoch 20/300 |loss: 0.001425| train set 5.176x speedup, test set 0.684x speedup, val set 5.669x speedup, step: 1
Epoch 21/300 |loss: 0.001046| train set 5.253x speedup, test set 0.683x speedup, val set 5.628x speedup, step: 2
Epoch 22/300 |loss: 0.001815| train set 5.158x speedup, test set 0.684x speedup, val set 5.518x speedup, step: 3
Epoch 23/300 |loss: 0.001191| train set 5.262x speedup, test set 0.681x speedup, val set 5.638x speedup, step: 4
Epoch 24/300 |loss: 0.000797| train set 3.988x speedup, test set 0.671x speedup, val set 4.386x speedup, step: 5
Epoch 25/300 |loss: 0.000915| train set 5.255x speedup, test set 0.687x speedup, val set 5.517x speedup, step: 6
Epoch 26/300 |loss: 0.000785| train set 5.174x speedup, test set 0.684x speedup, val set 5.667x speedup, step: 7
Epoch 27/300 |loss: 0.000697| train set 5.178x speedup, test set 0.684x speedup, val set 5.677x speedup, step: 1
Epoch 28/300 |loss: 0.000821| train set 5.179x speedup, test set 0.684x speedup, val set 5.668x speedup, step: 2
Epoch 29/300 |loss: 0.000764| train set 5.261x speedup, test set 0.687x speedup, val set 5.540x speedup, step: 3
Epoch 30/300 |loss: 0.000756| train set 5.254x speedup, test set 0.684x speedup, val set 5.628x speedup, step: 4
Epoch 31/300 |loss: 0.000705| train set 5.262x speedup, test set 0.682x speedup, val set 5.638x speedup, step: 5
Epoch 32/300 |loss: 0.000703| train set 5.263x speedup, test set 0.687x speedup, val set 5.539x speedup, step: 6
Epoch 33/300 |loss: 0.000723| train set 5.263x speedup, test set 0.684x speedup, val set 5.540x speedup, step: 7
Epoch 34/300 |loss: 0.000800| train set 5.164x speedup, test set 0.675x speedup, val set 5.658x speedup, step: 8
Epoch 35/300 |loss: 0.000730| train set 5.264x speedup, test set 0.687x speedup, val set 5.539x speedup, step: 9
Epoch 36/300 |loss: 0.000813| train set 5.259x speedup, test set 0.680x speedup, val set 5.638x speedup, step: 10
early stopping at epoch 36
Training per epoch cost 0.441 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 7.065s, pg runtime 5.855s, speedup 0.829x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 8.321s, pg runtime 4.730s, speedup 0.568x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 2.847s, pg runtime 3.112s, speedup 1.093x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.218s, pg runtime 0.158s, speedup 0.728x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 35, train speedup 5.264, test speedup 0.687, val speedup 5.539
best test speedup epoch: 4, train speedup 3.347, test speedup 1.373, val speedup 3.638
best validation speedup epoch: 27, train speedup 5.178, test speedup 0.684, val speedup 5.677
last model at epoch 36, train speedup 5.259, test speedup 0.680, val speedup 5.638
execution cost 0:00:41.091221
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/point
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.512460, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.048859| train set 2.499x speedup, test set 0.887x speedup, val set 2.708x speedup, step: 1
Epoch 1/300 |loss: 0.019868| train set 2.561x speedup, test set 0.813x speedup, val set 2.683x speedup, step: 2
Epoch 2/300 |loss: 0.010596| train set 3.168x speedup, test set 0.677x speedup, val set 3.408x speedup, step: 1
Epoch 3/300 |loss: 0.007215| train set 3.269x speedup, test set 0.882x speedup, val set 3.570x speedup, step: 1
Epoch 4/300 |loss: 0.005759| train set 3.647x speedup, test set 1.455x speedup, val set 3.921x speedup, step: 1
Epoch 5/300 |loss: 0.003859| train set 3.117x speedup, test set 0.977x speedup, val set 3.395x speedup, step: 2
Epoch 6/300 |loss: 0.003624| train set 3.418x speedup, test set 0.975x speedup, val set 3.682x speedup, step: 3
Epoch 7/300 |loss: 0.003073| train set 3.054x speedup, test set 0.947x speedup, val set 3.299x speedup, step: 4
Epoch 8/300 |loss: 0.002537| train set 3.879x speedup, test set 0.913x speedup, val set 4.315x speedup, step: 1
Epoch 9/300 |loss: 0.002278| train set 5.162x speedup, test set 0.998x speedup, val set 5.443x speedup, step: 1
Epoch 10/300 |loss: 0.002101| train set 3.657x speedup, test set 0.920x speedup, val set 3.965x speedup, step: 2
Epoch 11/300 |loss: 0.002148| train set 5.162x speedup, test set 0.990x speedup, val set 5.434x speedup, step: 3
Epoch 12/300 |loss: 0.002486| train set 5.173x speedup, test set 0.896x speedup, val set 5.336x speedup, step: 4
Epoch 13/300 |loss: 0.001905| train set 5.247x speedup, test set 0.900x speedup, val set 5.617x speedup, step: 1
Epoch 14/300 |loss: 0.002401| train set 3.263x speedup, test set 0.721x speedup, val set 3.598x speedup, step: 2
Epoch 15/300 |loss: 0.002430| train set 5.070x speedup, test set 0.725x speedup, val set 5.336x speedup, step: 3
Epoch 16/300 |loss: 0.001678| train set 5.166x speedup, test set 0.722x speedup, val set 5.539x speedup, step: 4
Epoch 17/300 |loss: 0.001512| train set 3.974x speedup, test set 0.673x speedup, val set 4.371x speedup, step: 5
Epoch 18/300 |loss: 0.001727| train set 5.150x speedup, test set 0.694x speedup, val set 5.527x speedup, step: 6
Epoch 19/300 |loss: 0.001599| train set 5.187x speedup, test set 0.703x speedup, val set 5.468x speedup, step: 7
Epoch 20/300 |loss: 0.001346| train set 3.947x speedup, test set 0.673x speedup, val set 4.339x speedup, step: 8
Epoch 21/300 |loss: 0.000995| train set 5.254x speedup, test set 0.685x speedup, val set 5.530x speedup, step: 9
Epoch 22/300 |loss: 0.001449| train set 5.100x speedup, test set 0.681x speedup, val set 5.581x speedup, step: 10
Epoch 23/300 |loss: 0.001016| train set 5.179x speedup, test set 0.684x speedup, val set 5.669x speedup, step: 1
Epoch 24/300 |loss: 0.000750| train set 4.298x speedup, test set 0.675x speedup, val set 4.384x speedup, step: 2
Epoch 25/300 |loss: 0.000929| train set 5.256x speedup, test set 0.678x speedup, val set 5.627x speedup, step: 3
Epoch 26/300 |loss: 0.000910| train set 5.259x speedup, test set 0.681x speedup, val set 5.627x speedup, step: 4
Epoch 27/300 |loss: 0.000754| train set 5.177x speedup, test set 0.680x speedup, val set 5.678x speedup, step: 1
Epoch 28/300 |loss: 0.000829| train set 5.070x speedup, test set 0.684x speedup, val set 5.349x speedup, step: 2
Epoch 29/300 |loss: 0.000782| train set 5.256x speedup, test set 0.677x speedup, val set 5.626x speedup, step: 3
Epoch 30/300 |loss: 0.000767| train set 5.256x speedup, test set 0.676x speedup, val set 5.627x speedup, step: 4
Epoch 31/300 |loss: 0.000765| train set 5.259x speedup, test set 0.675x speedup, val set 5.638x speedup, step: 5
Epoch 32/300 |loss: 0.000717| train set 5.262x speedup, test set 0.689x speedup, val set 5.637x speedup, step: 6
Epoch 33/300 |loss: 0.000734| train set 5.259x speedup, test set 0.686x speedup, val set 5.638x speedup, step: 7
Epoch 34/300 |loss: 0.000774| train set 5.262x speedup, test set 0.665x speedup, val set 5.638x speedup, step: 8
Epoch 35/300 |loss: 0.000698| train set 5.255x speedup, test set 0.685x speedup, val set 5.519x speedup, step: 9
Epoch 36/300 |loss: 0.000686| train set 5.257x speedup, test set 0.687x speedup, val set 5.528x speedup, step: 10
Epoch 37/300 |loss: 0.000761| train set 5.256x speedup, test set 0.692x speedup, val set 5.627x speedup, step: 11
Epoch 38/300 |loss: 0.000704| train set 5.254x speedup, test set 0.667x speedup, val set 5.614x speedup, step: 12
Epoch 39/300 |loss: 0.000681| train set 5.259x speedup, test set 0.673x speedup, val set 5.634x speedup, step: 13
Epoch 40/300 |loss: 0.000660| train set 5.153x speedup, test set 0.684x speedup, val set 5.640x speedup, step: 14
Epoch 41/300 |loss: 0.000705| train set 5.256x speedup, test set 0.692x speedup, val set 5.626x speedup, step: 15
Epoch 42/300 |loss: 0.000705| train set 5.259x speedup, test set 0.686x speedup, val set 5.638x speedup, step: 16
Epoch 43/300 |loss: 0.000773| train set 5.256x speedup, test set 0.689x speedup, val set 5.627x speedup, step: 17
Epoch 44/300 |loss: 0.001894| train set 5.086x speedup, test set 0.678x speedup, val set 5.482x speedup, step: 18
early stopping at epoch 44
Training per epoch cost 0.427 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 7.065s, pg runtime 5.855s, speedup 0.829x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 8.290s, pg runtime 4.730s, speedup 0.571x
22, opt runtime 0.093s, model runtime 9.644s, pg runtime 2.389s, speedup 0.248x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 2.847s, pg runtime 3.112s, speedup 1.093x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.204s, pg runtime 0.239s, speedup 1.170x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.218s, pg runtime 0.158s, speedup 0.728x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 34.643s, pg runtime 6.444s, speedup 0.186x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 32, train speedup 5.262, test speedup 0.689, val speedup 5.637
best test speedup epoch: 4, train speedup 3.647, test speedup 1.455, val speedup 3.921
best validation speedup epoch: 27, train speedup 5.177, test speedup 0.680, val speedup 5.678
last model at epoch 44, train speedup 5.086, test speedup 0.678, val speedup 5.482
execution cost 0:00:46.891794
==================================================
