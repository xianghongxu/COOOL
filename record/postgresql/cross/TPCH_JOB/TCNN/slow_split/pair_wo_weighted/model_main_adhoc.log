all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.107157, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345694| train set 1.762x speedup, test set 1.136x speedup, val set 0.477x speedup, step: 1, train time 9.92 s
Epoch 1/50 |loss: 0.228725| train set 1.663x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 2, train time 7.39 s
Epoch 2/50 |loss: 0.203823| train set 1.791x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 3, train time 7.40 s
Epoch 3/50 |loss: 0.188644| train set 1.776x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 4, train time 7.41 s
Epoch 4/50 |loss: 0.173653| train set 1.809x speedup, test set 0.892x speedup, val set 0.437x speedup, step: 1, train time 7.40 s
Epoch 5/50 |loss: 0.166486| train set 1.680x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 2, train time 7.21 s
Epoch 6/50 |loss: 0.164695| train set 1.733x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 3, train time 7.41 s
Epoch 7/50 |loss: 0.162048| train set 1.810x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 4, train time 7.28 s
Epoch 8/50 |loss: 0.156687| train set 1.757x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 5, train time 7.43 s
Epoch 9/50 |loss: 0.151142| train set 1.663x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 1, train time 7.60 s
Epoch 10/50 |loss: 0.156462| train set 1.790x speedup, test set 1.045x speedup, val set 0.296x speedup, step: 2, train time 7.39 s
Epoch 11/50 |loss: 0.154047| train set 1.679x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 3, train time 7.33 s
Epoch 12/50 |loss: 0.153450| train set 1.776x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 4, train time 7.28 s
Epoch 13/50 |loss: 0.148789| train set 1.810x speedup, test set 1.016x speedup, val set 0.437x speedup, step: 5, train time 7.44 s
Epoch 14/50 |loss: 0.148740| train set 1.810x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 1, train time 7.50 s
Epoch 15/50 |loss: 0.147173| train set 1.757x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 2, train time 7.30 s
Epoch 16/50 |loss: 0.144746| train set 1.810x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 3, train time 7.42 s
Epoch 17/50 |loss: 0.146382| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 4, train time 7.50 s
Epoch 18/50 |loss: 0.142795| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 5, train time 7.40 s
Epoch 19/50 |loss: 0.145096| train set 1.790x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 1, train time 7.41 s
Epoch 20/50 |loss: 0.143611| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 2, train time 7.48 s
Epoch 21/50 |loss: 0.144589| train set 1.775x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 3, train time 7.42 s
Epoch 22/50 |loss: 0.142972| train set 1.775x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 4, train time 7.42 s
Epoch 23/50 |loss: 0.143040| train set 1.810x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 5, train time 7.43 s
Epoch 24/50 |loss: 0.143826| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 1, train time 8.43 s
Epoch 25/50 |loss: 0.143422| train set 1.810x speedup, test set 0.898x speedup, val set 0.437x speedup, step: 2, train time 7.39 s
Epoch 26/50 |loss: 0.143871| train set 1.810x speedup, test set 0.893x speedup, val set 0.496x speedup, step: 3, train time 7.44 s
Epoch 27/50 |loss: 0.140399| train set 1.757x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 4, train time 7.52 s
Epoch 28/50 |loss: 0.139223| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 5, train time 7.51 s
Epoch 29/50 |loss: 0.140349| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 1, train time 7.50 s
Epoch 30/50 |loss: 0.139306| train set 1.790x speedup, test set 0.877x speedup, val set 0.437x speedup, step: 2, train time 7.39 s
Epoch 31/50 |loss: 0.138658| train set 1.776x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 3, train time 7.49 s
Epoch 32/50 |loss: 0.138003| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 4, train time 7.49 s
Epoch 33/50 |loss: 0.138552| train set 1.809x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 5, train time 7.42 s
Epoch 34/50 |loss: 0.140204| train set 1.810x speedup, test set 1.014x speedup, val set 0.437x speedup, step: 1, train time 7.51 s
Epoch 35/50 |loss: 0.138869| train set 1.810x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 2, train time 7.48 s
Epoch 36/50 |loss: 0.139804| train set 1.810x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 3, train time 7.41 s
Epoch 37/50 |loss: 0.136761| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 4, train time 7.50 s
Epoch 38/50 |loss: 0.138304| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 5, train time 7.41 s
Epoch 39/50 |loss: 0.136442| train set 1.790x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 1, train time 7.49 s
Epoch 40/50 |loss: 0.136903| train set 1.810x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 2, train time 7.50 s
Epoch 41/50 |loss: 0.138958| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 3, train time 7.30 s
Epoch 42/50 |loss: 0.139050| train set 1.810x speedup, test set 1.019x speedup, val set 0.437x speedup, step: 4, train time 7.42 s
early stopping at epoch 42
Training per epoch cost 7.507 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
02, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
03, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.875s, pg runtime 2.352s, speedup 2.688x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.487s, pg runtime 10.685s, speedup 0.930x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 18, train speedup 1.810, test speedup 1.041, val speedup 0.437
best test speedup epoch: 0, train speedup 1.762, test speedup 1.136, val speedup 0.477
best validation speedup epoch: 39, train speedup 1.790, test speedup 1.040, val speedup 0.437
last model at epoch 42, train speedup 1.810, test speedup 1.019, val speedup 0.437
execution cost 0:06:41.494067
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.084585, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 9.86 s
Epoch 1/50 |loss: 0.229276| train set 1.655x speedup, test set 1.075x speedup, val set 0.477x speedup, step: 2, train time 7.74 s
Epoch 2/50 |loss: 0.203535| train set 1.790x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 3, train time 7.45 s
Epoch 3/50 |loss: 0.191297| train set 1.776x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 4, train time 7.40 s
Epoch 4/50 |loss: 0.178048| train set 1.809x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 1, train time 7.59 s
Epoch 5/50 |loss: 0.169924| train set 1.733x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 2, train time 7.39 s
Epoch 6/50 |loss: 0.167136| train set 1.734x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 3, train time 7.39 s
Epoch 7/50 |loss: 0.164733| train set 1.810x speedup, test set 1.067x speedup, val set 0.437x speedup, step: 4, train time 7.41 s
Epoch 8/50 |loss: 0.155657| train set 1.757x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 5, train time 7.34 s
Epoch 9/50 |loss: 0.152895| train set 1.663x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 1, train time 7.58 s
Epoch 10/50 |loss: 0.156527| train set 1.791x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 2, train time 7.58 s
Epoch 11/50 |loss: 0.154037| train set 1.790x speedup, test set 1.060x speedup, val set 0.437x speedup, step: 3, train time 7.41 s
Epoch 12/50 |loss: 0.154132| train set 1.776x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 4, train time 7.48 s
Epoch 13/50 |loss: 0.151606| train set 1.790x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 5, train time 7.38 s
Epoch 14/50 |loss: 0.148644| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 1, train time 7.33 s
Epoch 15/50 |loss: 0.148615| train set 1.776x speedup, test set 0.891x speedup, val set 0.437x speedup, step: 2, train time 7.40 s
Epoch 16/50 |loss: 0.146841| train set 1.776x speedup, test set 1.076x speedup, val set 0.437x speedup, step: 3, train time 7.42 s
Epoch 17/50 |loss: 0.147585| train set 1.810x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 4, train time 7.49 s
Epoch 18/50 |loss: 0.144927| train set 1.696x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 7.42 s
Epoch 19/50 |loss: 0.148273| train set 1.790x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 1, train time 7.43 s
Epoch 20/50 |loss: 0.145460| train set 1.810x speedup, test set 1.103x speedup, val set 0.437x speedup, step: 2, train time 7.61 s
Epoch 21/50 |loss: 0.146300| train set 1.775x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 3, train time 7.32 s
Epoch 22/50 |loss: 0.144101| train set 1.776x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 4, train time 7.59 s
Epoch 23/50 |loss: 0.144691| train set 1.809x speedup, test set 1.109x speedup, val set 0.437x speedup, step: 5, train time 7.41 s
Epoch 24/50 |loss: 0.145891| train set 1.810x speedup, test set 1.059x speedup, val set 0.437x speedup, step: 1, train time 8.37 s
Epoch 25/50 |loss: 0.143984| train set 1.810x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 2, train time 7.39 s
Epoch 26/50 |loss: 0.146032| train set 1.810x speedup, test set 1.066x speedup, val set 0.437x speedup, step: 3, train time 7.49 s
Epoch 27/50 |loss: 0.142374| train set 1.757x speedup, test set 1.090x speedup, val set 0.437x speedup, step: 4, train time 7.29 s
Epoch 28/50 |loss: 0.139626| train set 1.810x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 5, train time 7.49 s
Epoch 29/50 |loss: 0.142713| train set 1.810x speedup, test set 1.090x speedup, val set 0.437x speedup, step: 1, train time 7.41 s
Epoch 30/50 |loss: 0.140546| train set 1.790x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 2, train time 7.32 s
Epoch 31/50 |loss: 0.142455| train set 1.809x speedup, test set 0.886x speedup, val set 0.437x speedup, step: 3, train time 7.41 s
Epoch 32/50 |loss: 0.141425| train set 1.810x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 4, train time 7.40 s
Epoch 33/50 |loss: 0.140372| train set 1.775x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 5, train time 7.50 s
Epoch 34/50 |loss: 0.141867| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 1, train time 7.51 s
Epoch 35/50 |loss: 0.140412| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 7.51 s
Epoch 36/50 |loss: 0.142425| train set 1.810x speedup, test set 1.074x speedup, val set 0.437x speedup, step: 3, train time 7.50 s
Epoch 37/50 |loss: 0.138674| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 4, train time 7.33 s
Epoch 38/50 |loss: 0.139253| train set 1.810x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 5, train time 7.42 s
Epoch 39/50 |loss: 0.137711| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 1, train time 7.69 s
Epoch 40/50 |loss: 0.138875| train set 1.810x speedup, test set 1.060x speedup, val set 0.437x speedup, step: 2, train time 7.40 s
Epoch 41/50 |loss: 0.138309| train set 1.765x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 3, train time 7.51 s
Epoch 42/50 |loss: 0.140720| train set 1.810x speedup, test set 1.095x speedup, val set 0.437x speedup, step: 4, train time 7.50 s
Epoch 43/50 |loss: 0.140077| train set 1.776x speedup, test set 1.244x speedup, val set 0.437x speedup, step: 5, train time 7.53 s
Epoch 44/50 |loss: 0.140228| train set 1.810x speedup, test set 1.167x speedup, val set 0.437x speedup, step: 1, train time 7.49 s
Epoch 45/50 |loss: 0.137806| train set 1.757x speedup, test set 1.160x speedup, val set 0.437x speedup, step: 2, train time 7.49 s
Epoch 46/50 |loss: 0.139161| train set 1.757x speedup, test set 1.296x speedup, val set 0.437x speedup, step: 3, train time 7.67 s
Epoch 47/50 |loss: 0.137630| train set 1.810x speedup, test set 1.100x speedup, val set 0.437x speedup, step: 4, train time 7.57 s
Epoch 48/50 |loss: 0.135434| train set 1.776x speedup, test set 1.089x speedup, val set 0.437x speedup, step: 5, train time 7.49 s
Epoch 49/50 |loss: 0.137116| train set 1.810x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 1, train time 7.50 s
Training per epoch cost 7.532 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.875s, pg runtime 2.352s, speedup 2.688x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 35, train speedup 1.810, test speedup 1.049, val speedup 0.437
best test speedup epoch: 46, train speedup 1.757, test speedup 1.296, val speedup 0.437
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.141, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.141, val speedup 0.437
execution cost 0:07:46.967817
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.082030, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345790| train set 1.762x speedup, test set 1.172x speedup, val set 0.477x speedup, step: 1, train time 9.92 s
Epoch 1/50 |loss: 0.228608| train set 1.660x speedup, test set 0.983x speedup, val set 0.296x speedup, step: 2, train time 7.42 s
Epoch 2/50 |loss: 0.202505| train set 1.715x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 3, train time 7.41 s
Epoch 3/50 |loss: 0.190116| train set 1.776x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 7.45 s
Epoch 4/50 |loss: 0.173751| train set 1.809x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 1, train time 7.42 s
Epoch 5/50 |loss: 0.167786| train set 1.680x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 2, train time 7.63 s
Epoch 6/50 |loss: 0.164945| train set 1.734x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 3, train time 7.43 s
Epoch 7/50 |loss: 0.162420| train set 1.810x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 4, train time 7.41 s
Epoch 8/50 |loss: 0.157362| train set 1.776x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 5, train time 7.32 s
Epoch 9/50 |loss: 0.153201| train set 1.791x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 1, train time 7.40 s
Epoch 10/50 |loss: 0.156242| train set 1.791x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 2, train time 7.42 s
Epoch 11/50 |loss: 0.154146| train set 1.790x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 3, train time 7.42 s
Epoch 12/50 |loss: 0.155741| train set 1.776x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 4, train time 7.40 s
Epoch 13/50 |loss: 0.150864| train set 1.790x speedup, test set 1.005x speedup, val set 0.437x speedup, step: 5, train time 7.24 s
Epoch 14/50 |loss: 0.149157| train set 1.810x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 1, train time 7.39 s
Epoch 15/50 |loss: 0.147744| train set 1.757x speedup, test set 1.062x speedup, val set 0.437x speedup, step: 2, train time 7.42 s
Epoch 16/50 |loss: 0.146414| train set 1.776x speedup, test set 1.073x speedup, val set 0.437x speedup, step: 3, train time 7.31 s
Epoch 17/50 |loss: 0.148143| train set 1.810x speedup, test set 1.062x speedup, val set 0.437x speedup, step: 4, train time 7.26 s
Epoch 18/50 |loss: 0.143472| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 5, train time 7.29 s
Epoch 19/50 |loss: 0.145850| train set 1.790x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 1, train time 7.30 s
Epoch 20/50 |loss: 0.145075| train set 1.810x speedup, test set 1.062x speedup, val set 0.437x speedup, step: 2, train time 7.21 s
Epoch 21/50 |loss: 0.145434| train set 1.775x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 3, train time 7.23 s
Epoch 22/50 |loss: 0.143616| train set 1.776x speedup, test set 1.096x speedup, val set 0.437x speedup, step: 4, train time 7.21 s
Epoch 23/50 |loss: 0.143602| train set 1.776x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 5, train time 7.21 s
Epoch 24/50 |loss: 0.144823| train set 1.810x speedup, test set 1.075x speedup, val set 0.437x speedup, step: 1, train time 8.90 s
Epoch 25/50 |loss: 0.143665| train set 1.810x speedup, test set 1.075x speedup, val set 0.437x speedup, step: 2, train time 7.35 s
Epoch 26/50 |loss: 0.145329| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 3, train time 7.31 s
Epoch 27/50 |loss: 0.140869| train set 1.757x speedup, test set 1.086x speedup, val set 0.437x speedup, step: 4, train time 7.39 s
Epoch 28/50 |loss: 0.139566| train set 1.810x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 5, train time 7.29 s
Epoch 29/50 |loss: 0.141773| train set 1.810x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 1, train time 7.41 s
Epoch 30/50 |loss: 0.139438| train set 1.790x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 7.28 s
Epoch 31/50 |loss: 0.139931| train set 1.809x speedup, test set 1.075x speedup, val set 0.437x speedup, step: 3, train time 7.33 s
Epoch 32/50 |loss: 0.138784| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 4, train time 7.53 s
Epoch 33/50 |loss: 0.138894| train set 1.775x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 5, train time 7.29 s
Epoch 34/50 |loss: 0.140604| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 1, train time 7.28 s
Epoch 35/50 |loss: 0.140392| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 2, train time 7.11 s
Epoch 36/50 |loss: 0.139943| train set 1.810x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 3, train time 7.13 s
Epoch 37/50 |loss: 0.137987| train set 1.810x speedup, test set 1.117x speedup, val set 0.437x speedup, step: 4, train time 7.11 s
Epoch 38/50 |loss: 0.139247| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 5, train time 7.10 s
Epoch 39/50 |loss: 0.137506| train set 1.810x speedup, test set 1.019x speedup, val set 0.437x speedup, step: 1, train time 7.20 s
Epoch 40/50 |loss: 0.138429| train set 1.776x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 2, train time 7.08 s
Epoch 41/50 |loss: 0.139320| train set 1.766x speedup, test set 1.090x speedup, val set 0.437x speedup, step: 3, train time 7.13 s
Epoch 42/50 |loss: 0.138381| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 4, train time 7.19 s
Epoch 43/50 |loss: 0.139494| train set 1.776x speedup, test set 1.209x speedup, val set 0.437x speedup, step: 5, train time 7.22 s
Epoch 44/50 |loss: 0.139150| train set 1.810x speedup, test set 1.102x speedup, val set 0.437x speedup, step: 1, train time 7.33 s
Epoch 45/50 |loss: 0.138070| train set 1.775x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 2, train time 7.21 s
Epoch 46/50 |loss: 0.138898| train set 1.790x speedup, test set 1.228x speedup, val set 0.437x speedup, step: 3, train time 7.11 s
early stopping at epoch 46
Training per epoch cost 7.392 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
03, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 18, train speedup 1.810, test speedup 1.045, val speedup 0.437
best test speedup epoch: 46, train speedup 1.790, test speedup 1.228, val speedup 0.437
best validation speedup epoch: 44, train speedup 1.810, test speedup 1.102, val speedup 0.437
last model at epoch 46, train speedup 1.790, test speedup 1.228, val speedup 0.437
execution cost 0:07:09.175121
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.138743, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 10.00 s
Epoch 1/50 |loss: 0.229276| train set 1.655x speedup, test set 1.075x speedup, val set 0.477x speedup, step: 2, train time 7.48 s
Epoch 2/50 |loss: 0.202344| train set 1.791x speedup, test set 1.009x speedup, val set 0.296x speedup, step: 3, train time 7.41 s
Epoch 3/50 |loss: 0.193315| train set 1.757x speedup, test set 0.903x speedup, val set 0.437x speedup, step: 4, train time 7.42 s
Epoch 4/50 |loss: 0.177372| train set 1.775x speedup, test set 0.902x speedup, val set 0.437x speedup, step: 1, train time 7.43 s
Epoch 5/50 |loss: 0.169669| train set 1.775x speedup, test set 0.894x speedup, val set 0.437x speedup, step: 2, train time 7.28 s
Epoch 6/50 |loss: 0.165922| train set 1.775x speedup, test set 0.906x speedup, val set 0.437x speedup, step: 3, train time 7.38 s
Epoch 7/50 |loss: 0.164726| train set 1.711x speedup, test set 0.862x speedup, val set 0.416x speedup, step: 4, train time 7.35 s
Epoch 8/50 |loss: 0.157115| train set 1.790x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 5, train time 7.42 s
Epoch 9/50 |loss: 0.154014| train set 1.809x speedup, test set 0.860x speedup, val set 0.437x speedup, step: 1, train time 7.40 s
Epoch 10/50 |loss: 0.157296| train set 1.791x speedup, test set 0.861x speedup, val set 0.437x speedup, step: 2, train time 7.42 s
Epoch 11/50 |loss: 0.153996| train set 1.790x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 3, train time 7.39 s
Epoch 12/50 |loss: 0.152676| train set 1.776x speedup, test set 1.037x speedup, val set 0.437x speedup, step: 4, train time 7.41 s
Epoch 13/50 |loss: 0.150364| train set 1.810x speedup, test set 1.010x speedup, val set 0.437x speedup, step: 5, train time 7.88 s
Epoch 14/50 |loss: 0.149088| train set 1.810x speedup, test set 1.013x speedup, val set 0.437x speedup, step: 1, train time 7.44 s
Epoch 15/50 |loss: 0.149384| train set 1.776x speedup, test set 0.860x speedup, val set 0.437x speedup, step: 2, train time 7.39 s
Epoch 16/50 |loss: 0.147392| train set 1.776x speedup, test set 1.021x speedup, val set 0.437x speedup, step: 3, train time 7.41 s
Epoch 17/50 |loss: 0.148330| train set 1.810x speedup, test set 0.881x speedup, val set 0.437x speedup, step: 4, train time 7.29 s
Epoch 18/50 |loss: 0.145328| train set 1.696x speedup, test set 0.859x speedup, val set 0.437x speedup, step: 5, train time 7.30 s
Epoch 19/50 |loss: 0.147237| train set 1.790x speedup, test set 0.840x speedup, val set 0.437x speedup, step: 1, train time 7.42 s
Epoch 20/50 |loss: 0.145415| train set 1.810x speedup, test set 0.841x speedup, val set 0.437x speedup, step: 2, train time 7.33 s
Epoch 21/50 |loss: 0.146187| train set 1.776x speedup, test set 1.017x speedup, val set 0.437x speedup, step: 3, train time 7.38 s
Epoch 22/50 |loss: 0.143071| train set 1.775x speedup, test set 1.007x speedup, val set 0.437x speedup, step: 4, train time 7.46 s
Epoch 23/50 |loss: 0.143860| train set 1.809x speedup, test set 1.147x speedup, val set 0.437x speedup, step: 5, train time 7.49 s
Epoch 24/50 |loss: 0.145597| train set 1.810x speedup, test set 0.876x speedup, val set 0.437x speedup, step: 1, train time 8.39 s
Epoch 25/50 |loss: 0.143932| train set 1.809x speedup, test set 0.881x speedup, val set 0.437x speedup, step: 2, train time 7.33 s
Epoch 26/50 |loss: 0.144201| train set 1.810x speedup, test set 0.858x speedup, val set 0.437x speedup, step: 3, train time 7.41 s
Epoch 27/50 |loss: 0.141659| train set 1.757x speedup, test set 0.858x speedup, val set 0.437x speedup, step: 4, train time 7.30 s
Epoch 28/50 |loss: 0.140440| train set 1.810x speedup, test set 1.143x speedup, val set 0.437x speedup, step: 5, train time 7.35 s
Epoch 29/50 |loss: 0.142359| train set 1.810x speedup, test set 1.145x speedup, val set 0.437x speedup, step: 1, train time 7.61 s
Epoch 30/50 |loss: 0.139778| train set 1.790x speedup, test set 0.883x speedup, val set 0.437x speedup, step: 2, train time 7.50 s
Epoch 31/50 |loss: 0.141294| train set 1.809x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 3, train time 7.50 s
Epoch 32/50 |loss: 0.140020| train set 1.810x speedup, test set 1.149x speedup, val set 0.437x speedup, step: 4, train time 7.77 s
Epoch 33/50 |loss: 0.139722| train set 1.775x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 5, train time 7.54 s
Epoch 34/50 |loss: 0.141175| train set 1.810x speedup, test set 1.017x speedup, val set 0.437x speedup, step: 1, train time 7.69 s
Epoch 35/50 |loss: 0.140190| train set 1.810x speedup, test set 0.990x speedup, val set 0.437x speedup, step: 2, train time 7.31 s
Epoch 36/50 |loss: 0.142557| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 3, train time 7.41 s
Epoch 37/50 |loss: 0.139689| train set 1.810x speedup, test set 1.143x speedup, val set 0.437x speedup, step: 4, train time 7.50 s
Epoch 38/50 |loss: 0.138901| train set 1.810x speedup, test set 1.142x speedup, val set 0.437x speedup, step: 5, train time 7.40 s
Epoch 39/50 |loss: 0.138303| train set 1.790x speedup, test set 1.029x speedup, val set 0.437x speedup, step: 1, train time 7.42 s
Epoch 40/50 |loss: 0.138480| train set 1.776x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 2, train time 7.40 s
Epoch 41/50 |loss: 0.138727| train set 1.765x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 3, train time 7.50 s
Epoch 42/50 |loss: 0.139852| train set 1.810x speedup, test set 1.026x speedup, val set 0.437x speedup, step: 4, train time 7.51 s
Epoch 43/50 |loss: 0.140007| train set 1.776x speedup, test set 1.146x speedup, val set 0.437x speedup, step: 5, train time 7.49 s
Epoch 44/50 |loss: 0.139886| train set 1.776x speedup, test set 1.125x speedup, val set 0.437x speedup, step: 1, train time 7.49 s
Epoch 45/50 |loss: 0.137882| train set 1.776x speedup, test set 1.128x speedup, val set 0.437x speedup, step: 2, train time 7.46 s
Epoch 46/50 |loss: 0.139516| train set 1.790x speedup, test set 1.231x speedup, val set 0.437x speedup, step: 3, train time 7.51 s
Epoch 47/50 |loss: 0.136992| train set 1.810x speedup, test set 1.121x speedup, val set 0.437x speedup, step: 4, train time 7.62 s
Epoch 48/50 |loss: 0.135861| train set 1.776x speedup, test set 1.108x speedup, val set 0.437x speedup, step: 5, train time 7.52 s
Epoch 49/50 |loss: 0.136230| train set 1.810x speedup, test set 1.118x speedup, val set 0.437x speedup, step: 1, train time 7.50 s
Training per epoch cost 7.520 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 13.370s, pg runtime 10.605s, speedup 0.793x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.487s, pg runtime 10.685s, speedup 0.930x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 1.412s, pg runtime 3.645s, speedup 2.582x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 1.128s, pg runtime 0.965s, speedup 0.856x
====================
best train speedup epoch: 42, train speedup 1.810, test speedup 1.026, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.118, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.118, val speedup 0.437
execution cost 0:07:45.493827
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.909433, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 10.40 s
Epoch 1/50 |loss: 0.229052| train set 1.655x speedup, test set 1.012x speedup, val set 0.477x speedup, step: 2, train time 7.60 s
Epoch 2/50 |loss: 0.202256| train set 1.790x speedup, test set 1.075x speedup, val set 0.296x speedup, step: 3, train time 7.53 s
Epoch 3/50 |loss: 0.189740| train set 1.517x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 4, train time 7.44 s
Epoch 4/50 |loss: 0.175521| train set 1.809x speedup, test set 0.905x speedup, val set 0.437x speedup, step: 1, train time 7.50 s
Epoch 5/50 |loss: 0.170498| train set 1.681x speedup, test set 0.896x speedup, val set 0.437x speedup, step: 2, train time 7.39 s
Epoch 6/50 |loss: 0.166420| train set 1.733x speedup, test set 0.902x speedup, val set 0.437x speedup, step: 3, train time 7.52 s
Epoch 7/50 |loss: 0.164465| train set 1.810x speedup, test set 0.892x speedup, val set 0.437x speedup, step: 4, train time 7.49 s
Epoch 8/50 |loss: 0.157137| train set 1.757x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 5, train time 7.50 s
Epoch 9/50 |loss: 0.154068| train set 1.809x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 1, train time 7.40 s
Epoch 10/50 |loss: 0.157101| train set 1.791x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 2, train time 7.58 s
Epoch 11/50 |loss: 0.155170| train set 1.790x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 3, train time 7.51 s
Epoch 12/50 |loss: 0.154172| train set 1.776x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 4, train time 7.43 s
Epoch 13/50 |loss: 0.151079| train set 1.810x speedup, test set 0.873x speedup, val set 0.437x speedup, step: 5, train time 7.50 s
Epoch 14/50 |loss: 0.149829| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 1, train time 7.49 s
Epoch 15/50 |loss: 0.149159| train set 1.776x speedup, test set 0.891x speedup, val set 0.437x speedup, step: 2, train time 7.44 s
Epoch 16/50 |loss: 0.147327| train set 1.776x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 3, train time 7.50 s
Epoch 17/50 |loss: 0.147663| train set 1.810x speedup, test set 0.896x speedup, val set 0.437x speedup, step: 4, train time 7.74 s
Epoch 18/50 |loss: 0.143933| train set 1.696x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 5, train time 7.49 s
Epoch 19/50 |loss: 0.147639| train set 1.790x speedup, test set 0.880x speedup, val set 0.437x speedup, step: 1, train time 7.61 s
Epoch 20/50 |loss: 0.145695| train set 1.809x speedup, test set 1.013x speedup, val set 0.437x speedup, step: 2, train time 7.49 s
Epoch 21/50 |loss: 0.145534| train set 1.775x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 3, train time 7.37 s
Epoch 22/50 |loss: 0.144630| train set 1.776x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 4, train time 7.49 s
Epoch 23/50 |loss: 0.144805| train set 1.809x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 5, train time 7.48 s
Epoch 24/50 |loss: 0.144918| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 1, train time 8.71 s
Epoch 25/50 |loss: 0.143653| train set 1.810x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 2, train time 7.40 s
Epoch 26/50 |loss: 0.144411| train set 1.810x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 3, train time 7.61 s
Epoch 27/50 |loss: 0.141374| train set 1.757x speedup, test set 1.152x speedup, val set 0.437x speedup, step: 4, train time 7.50 s
Epoch 28/50 |loss: 0.138983| train set 1.810x speedup, test set 1.147x speedup, val set 0.437x speedup, step: 5, train time 7.51 s
Epoch 29/50 |loss: 0.141890| train set 1.810x speedup, test set 1.147x speedup, val set 0.437x speedup, step: 1, train time 7.61 s
Epoch 30/50 |loss: 0.140221| train set 1.790x speedup, test set 0.883x speedup, val set 0.437x speedup, step: 2, train time 7.51 s
Epoch 31/50 |loss: 0.141596| train set 1.810x speedup, test set 0.883x speedup, val set 0.437x speedup, step: 3, train time 7.44 s
Epoch 32/50 |loss: 0.139333| train set 1.810x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 4, train time 7.57 s
Epoch 33/50 |loss: 0.139230| train set 1.775x speedup, test set 0.954x speedup, val set 0.437x speedup, step: 5, train time 7.54 s
Epoch 34/50 |loss: 0.140791| train set 1.810x speedup, test set 0.881x speedup, val set 0.437x speedup, step: 1, train time 7.58 s
Epoch 35/50 |loss: 0.140364| train set 1.810x speedup, test set 0.863x speedup, val set 0.437x speedup, step: 2, train time 7.53 s
Epoch 36/50 |loss: 0.141548| train set 1.810x speedup, test set 0.883x speedup, val set 0.437x speedup, step: 3, train time 7.75 s
Epoch 37/50 |loss: 0.138867| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 4, train time 7.61 s
Epoch 38/50 |loss: 0.139016| train set 1.810x speedup, test set 0.877x speedup, val set 0.437x speedup, step: 5, train time 7.52 s
Epoch 39/50 |loss: 0.137512| train set 1.810x speedup, test set 1.143x speedup, val set 0.437x speedup, step: 1, train time 7.59 s
Epoch 40/50 |loss: 0.138515| train set 1.776x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 2, train time 7.59 s
Epoch 41/50 |loss: 0.138800| train set 1.765x speedup, test set 0.877x speedup, val set 0.437x speedup, step: 3, train time 7.52 s
Epoch 42/50 |loss: 0.139916| train set 1.810x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 4, train time 7.58 s
Epoch 43/50 |loss: 0.139772| train set 1.776x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 5, train time 7.59 s
Epoch 44/50 |loss: 0.140276| train set 1.776x speedup, test set 1.079x speedup, val set 0.437x speedup, step: 1, train time 7.44 s
Epoch 45/50 |loss: 0.137710| train set 1.790x speedup, test set 0.858x speedup, val set 0.437x speedup, step: 2, train time 7.60 s
Epoch 46/50 |loss: 0.139010| train set 1.790x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 3, train time 7.54 s
Epoch 47/50 |loss: 0.136764| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 4, train time 7.48 s
Epoch 48/50 |loss: 0.135696| train set 1.810x speedup, test set 0.879x speedup, val set 0.437x speedup, step: 5, train time 7.42 s
Epoch 49/50 |loss: 0.135910| train set 1.810x speedup, test set 1.140x speedup, val set 0.437x speedup, step: 1, train time 7.39 s
Training per epoch cost 7.601 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.369s, pg runtime 0.206s, speedup 0.560x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 28, train speedup 1.810, test speedup 1.147, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.140, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.140, val speedup 0.437
execution cost 0:07:50.254822
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.061134, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 10.07 s
Epoch 1/50 |loss: 0.229473| train set 1.694x speedup, test set 1.068x speedup, val set 0.477x speedup, step: 2, train time 7.52 s
Epoch 2/50 |loss: 0.202980| train set 1.790x speedup, test set 1.008x speedup, val set 0.296x speedup, step: 3, train time 7.61 s
Epoch 3/50 |loss: 0.191812| train set 1.517x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 4, train time 7.38 s
Epoch 4/50 |loss: 0.177636| train set 1.809x speedup, test set 0.901x speedup, val set 0.437x speedup, step: 1, train time 7.53 s
Epoch 5/50 |loss: 0.170694| train set 1.775x speedup, test set 0.893x speedup, val set 0.437x speedup, step: 2, train time 7.39 s
Epoch 6/50 |loss: 0.168000| train set 1.734x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 3, train time 7.40 s
Epoch 7/50 |loss: 0.164417| train set 1.810x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 4, train time 7.39 s
Epoch 8/50 |loss: 0.156981| train set 1.790x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 5, train time 7.32 s
Epoch 9/50 |loss: 0.154060| train set 1.663x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 1, train time 7.31 s
Epoch 10/50 |loss: 0.157171| train set 1.791x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 7.35 s
Epoch 11/50 |loss: 0.155204| train set 1.679x speedup, test set 1.075x speedup, val set 0.437x speedup, step: 3, train time 7.44 s
Epoch 12/50 |loss: 0.155241| train set 1.776x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 4, train time 7.41 s
Epoch 13/50 |loss: 0.150426| train set 1.810x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 5, train time 7.21 s
Epoch 14/50 |loss: 0.149991| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 1, train time 7.29 s
Epoch 15/50 |loss: 0.149553| train set 1.757x speedup, test set 0.892x speedup, val set 0.437x speedup, step: 2, train time 7.16 s
Epoch 16/50 |loss: 0.146997| train set 1.776x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 3, train time 7.21 s
Epoch 17/50 |loss: 0.147857| train set 1.810x speedup, test set 0.894x speedup, val set 0.437x speedup, step: 4, train time 7.20 s
Epoch 18/50 |loss: 0.144978| train set 1.696x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 5, train time 7.15 s
Epoch 19/50 |loss: 0.148168| train set 1.759x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 1, train time 7.11 s
Epoch 20/50 |loss: 0.146076| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 2, train time 7.20 s
Epoch 21/50 |loss: 0.145857| train set 1.775x speedup, test set 1.070x speedup, val set 0.437x speedup, step: 3, train time 7.41 s
Epoch 22/50 |loss: 0.144968| train set 1.776x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 4, train time 7.22 s
Epoch 23/50 |loss: 0.145510| train set 1.776x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 5, train time 7.20 s
Epoch 24/50 |loss: 0.146126| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 1, train time 8.64 s
Epoch 25/50 |loss: 0.144417| train set 1.711x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 2, train time 7.32 s
Epoch 26/50 |loss: 0.145434| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 3, train time 7.30 s
Epoch 27/50 |loss: 0.142091| train set 1.776x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 7.42 s
Epoch 28/50 |loss: 0.139939| train set 1.810x speedup, test set 1.055x speedup, val set 0.887x speedup, step: 5, train time 7.44 s
Epoch 29/50 |loss: 0.142685| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 1, train time 7.40 s
Epoch 30/50 |loss: 0.140892| train set 1.790x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 2, train time 7.29 s
Epoch 31/50 |loss: 0.140850| train set 1.810x speedup, test set 1.070x speedup, val set 0.437x speedup, step: 3, train time 7.19 s
Epoch 32/50 |loss: 0.139905| train set 1.810x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 4, train time 7.19 s
Epoch 33/50 |loss: 0.139951| train set 1.775x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 5, train time 7.12 s
Epoch 34/50 |loss: 0.141219| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 1, train time 7.30 s
Epoch 35/50 |loss: 0.140091| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 2, train time 7.21 s
Epoch 36/50 |loss: 0.141775| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 3, train time 7.22 s
Epoch 37/50 |loss: 0.139164| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 7.21 s
Epoch 38/50 |loss: 0.139263| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 5, train time 7.20 s
Epoch 39/50 |loss: 0.137709| train set 1.790x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 1, train time 7.22 s
Epoch 40/50 |loss: 0.139366| train set 1.776x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 2, train time 7.30 s
Epoch 41/50 |loss: 0.138496| train set 1.765x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 3, train time 7.28 s
Epoch 42/50 |loss: 0.139820| train set 1.810x speedup, test set 1.109x speedup, val set 0.437x speedup, step: 4, train time 7.20 s
Epoch 43/50 |loss: 0.139860| train set 1.776x speedup, test set 1.091x speedup, val set 0.437x speedup, step: 5, train time 7.19 s
Epoch 44/50 |loss: 0.140045| train set 1.810x speedup, test set 1.111x speedup, val set 0.437x speedup, step: 1, train time 7.19 s
Epoch 45/50 |loss: 0.137690| train set 1.809x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 2, train time 7.17 s
Epoch 46/50 |loss: 0.138962| train set 1.790x speedup, test set 1.151x speedup, val set 0.437x speedup, step: 3, train time 7.18 s
Epoch 47/50 |loss: 0.137132| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 4, train time 7.29 s
Epoch 48/50 |loss: 0.135998| train set 1.776x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 5, train time 7.20 s
Epoch 49/50 |loss: 0.136752| train set 1.810x speedup, test set 1.145x speedup, val set 0.437x speedup, step: 1, train time 7.21 s
Training per epoch cost 7.368 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 1.128s, pg runtime 0.965s, speedup 0.856x
====================
best train speedup epoch: 28, train speedup 1.810, test speedup 1.055, val speedup 0.887
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.145, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.145, val speedup 0.437
execution cost 0:07:33.051275
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.023057, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345694| train set 1.762x speedup, test set 1.136x speedup, val set 0.477x speedup, step: 1, train time 10.18 s
Epoch 1/50 |loss: 0.228784| train set 1.663x speedup, test set 1.211x speedup, val set 0.296x speedup, step: 2, train time 7.41 s
Epoch 2/50 |loss: 0.206170| train set 1.791x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 3, train time 7.37 s
Epoch 3/50 |loss: 0.189779| train set 1.776x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 4, train time 7.40 s
Epoch 4/50 |loss: 0.173895| train set 1.809x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 1, train time 7.31 s
Epoch 5/50 |loss: 0.168166| train set 1.776x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 2, train time 7.41 s
Epoch 6/50 |loss: 0.164681| train set 1.733x speedup, test set 1.074x speedup, val set 0.437x speedup, step: 3, train time 7.42 s
Epoch 7/50 |loss: 0.162842| train set 1.776x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 4, train time 7.62 s
Epoch 8/50 |loss: 0.157267| train set 1.790x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 5, train time 7.42 s
Epoch 9/50 |loss: 0.152126| train set 1.790x speedup, test set 1.073x speedup, val set 0.437x speedup, step: 1, train time 7.49 s
Epoch 10/50 |loss: 0.156008| train set 1.790x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 2, train time 7.38 s
Epoch 11/50 |loss: 0.153741| train set 1.679x speedup, test set 1.080x speedup, val set 0.437x speedup, step: 3, train time 7.40 s
Epoch 12/50 |loss: 0.154547| train set 1.776x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 4, train time 7.50 s
Epoch 13/50 |loss: 0.149653| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 5, train time 7.42 s
Epoch 14/50 |loss: 0.149045| train set 1.810x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 1, train time 7.63 s
Epoch 15/50 |loss: 0.148148| train set 1.757x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 2, train time 7.49 s
Epoch 16/50 |loss: 0.146565| train set 1.776x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 3, train time 7.50 s
Epoch 17/50 |loss: 0.146067| train set 1.810x speedup, test set 1.073x speedup, val set 0.437x speedup, step: 4, train time 7.51 s
Epoch 18/50 |loss: 0.143766| train set 1.696x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 5, train time 7.50 s
Epoch 19/50 |loss: 0.146377| train set 1.747x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 1, train time 7.59 s
Epoch 20/50 |loss: 0.144542| train set 1.810x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 2, train time 7.48 s
Epoch 21/50 |loss: 0.145520| train set 1.775x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 3, train time 7.39 s
Epoch 22/50 |loss: 0.143347| train set 1.776x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 4, train time 7.52 s
Epoch 23/50 |loss: 0.144245| train set 1.776x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 5, train time 7.51 s
Epoch 24/50 |loss: 0.144465| train set 1.810x speedup, test set 1.076x speedup, val set 0.437x speedup, step: 1, train time 8.88 s
Epoch 25/50 |loss: 0.143416| train set 1.810x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 2, train time 7.52 s
Epoch 26/50 |loss: 0.144085| train set 1.810x speedup, test set 1.066x speedup, val set 0.437x speedup, step: 3, train time 7.74 s
Epoch 27/50 |loss: 0.141176| train set 1.757x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 4, train time 7.59 s
Epoch 28/50 |loss: 0.140212| train set 1.810x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 5, train time 7.32 s
Epoch 29/50 |loss: 0.142153| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 1, train time 7.50 s
Epoch 30/50 |loss: 0.139859| train set 1.790x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 2, train time 7.32 s
Epoch 31/50 |loss: 0.140226| train set 1.776x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 3, train time 7.49 s
Epoch 32/50 |loss: 0.139451| train set 1.810x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 4, train time 7.39 s
Epoch 33/50 |loss: 0.139228| train set 1.775x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 5, train time 7.30 s
Epoch 34/50 |loss: 0.140786| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 1, train time 7.34 s
Epoch 35/50 |loss: 0.139924| train set 1.810x speedup, test set 1.022x speedup, val set 0.437x speedup, step: 2, train time 7.19 s
Epoch 36/50 |loss: 0.140454| train set 1.810x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 3, train time 7.20 s
Epoch 37/50 |loss: 0.138485| train set 1.810x speedup, test set 1.113x speedup, val set 0.437x speedup, step: 4, train time 7.12 s
Epoch 38/50 |loss: 0.138683| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 5, train time 7.10 s
Epoch 39/50 |loss: 0.137316| train set 1.810x speedup, test set 1.112x speedup, val set 0.437x speedup, step: 1, train time 7.13 s
Epoch 40/50 |loss: 0.138975| train set 1.776x speedup, test set 1.074x speedup, val set 0.437x speedup, step: 2, train time 7.10 s
Epoch 41/50 |loss: 0.138632| train set 1.810x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 3, train time 7.14 s
Epoch 42/50 |loss: 0.139265| train set 1.810x speedup, test set 1.013x speedup, val set 0.437x speedup, step: 4, train time 7.13 s
Epoch 43/50 |loss: 0.139677| train set 1.776x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 5, train time 7.20 s
Epoch 44/50 |loss: 0.139881| train set 1.776x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 1, train time 7.12 s
Epoch 45/50 |loss: 0.138429| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 2, train time 7.47 s
Epoch 46/50 |loss: 0.138843| train set 1.790x speedup, test set 1.165x speedup, val set 0.437x speedup, step: 3, train time 7.30 s
Epoch 47/50 |loss: 0.137785| train set 1.810x speedup, test set 1.118x speedup, val set 0.437x speedup, step: 4, train time 7.19 s
Epoch 48/50 |loss: 0.134782| train set 1.776x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 5, train time 7.12 s
Epoch 49/50 |loss: 0.136309| train set 1.810x speedup, test set 1.128x speedup, val set 0.437x speedup, step: 1, train time 7.11 s
Training per epoch cost 7.457 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 28, train speedup 1.810, test speedup 1.056, val speedup 0.437
best test speedup epoch: 1, train speedup 1.663, test speedup 1.211, val speedup 0.296
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.128, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.128, val speedup 0.437
execution cost 0:07:39.985634
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.024629, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 9.75 s
Epoch 1/50 |loss: 0.229276| train set 1.655x speedup, test set 1.075x speedup, val set 0.477x speedup, step: 2, train time 7.29 s
Epoch 2/50 |loss: 0.202271| train set 1.664x speedup, test set 0.970x speedup, val set 0.296x speedup, step: 3, train time 7.11 s
Epoch 3/50 |loss: 0.192171| train set 1.810x speedup, test set 1.073x speedup, val set 0.437x speedup, step: 4, train time 7.19 s
Epoch 4/50 |loss: 0.175041| train set 1.809x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 1, train time 7.15 s
Epoch 5/50 |loss: 0.169029| train set 1.775x speedup, test set 0.880x speedup, val set 0.437x speedup, step: 2, train time 7.18 s
Epoch 6/50 |loss: 0.165788| train set 1.733x speedup, test set 1.081x speedup, val set 0.437x speedup, step: 3, train time 7.01 s
Epoch 7/50 |loss: 0.165039| train set 1.790x speedup, test set 1.017x speedup, val set 0.296x speedup, step: 4, train time 7.12 s
Epoch 8/50 |loss: 0.156215| train set 1.810x speedup, test set 1.013x speedup, val set 0.437x speedup, step: 5, train time 7.12 s
Epoch 9/50 |loss: 0.153133| train set 1.790x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 1, train time 7.12 s
Epoch 10/50 |loss: 0.156602| train set 1.791x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 2, train time 7.20 s
Epoch 11/50 |loss: 0.153363| train set 1.790x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 3, train time 7.29 s
Epoch 12/50 |loss: 0.152877| train set 1.776x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 4, train time 7.43 s
Epoch 13/50 |loss: 0.150466| train set 1.810x speedup, test set 0.990x speedup, val set 0.437x speedup, step: 5, train time 7.15 s
Epoch 14/50 |loss: 0.149843| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 1, train time 7.13 s
Epoch 15/50 |loss: 0.149121| train set 1.757x speedup, test set 1.062x speedup, val set 0.437x speedup, step: 2, train time 7.08 s
Epoch 16/50 |loss: 0.146505| train set 1.776x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 3, train time 7.21 s
Epoch 17/50 |loss: 0.147918| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 7.12 s
Epoch 18/50 |loss: 0.145698| train set 1.810x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 5, train time 7.23 s
Epoch 19/50 |loss: 0.146518| train set 1.790x speedup, test set 0.998x speedup, val set 0.437x speedup, step: 1, train time 7.13 s
Epoch 20/50 |loss: 0.146086| train set 1.810x speedup, test set 0.989x speedup, val set 0.437x speedup, step: 2, train time 7.19 s
Epoch 21/50 |loss: 0.147178| train set 1.775x speedup, test set 1.023x speedup, val set 0.437x speedup, step: 3, train time 7.22 s
Epoch 22/50 |loss: 0.144826| train set 1.775x speedup, test set 1.116x speedup, val set 0.437x speedup, step: 4, train time 7.21 s
Epoch 23/50 |loss: 0.145544| train set 1.809x speedup, test set 1.144x speedup, val set 0.437x speedup, step: 5, train time 7.23 s
Epoch 24/50 |loss: 0.147354| train set 1.810x speedup, test set 0.990x speedup, val set 0.437x speedup, step: 1, train time 8.42 s
Epoch 25/50 |loss: 0.144574| train set 1.810x speedup, test set 0.989x speedup, val set 0.437x speedup, step: 2, train time 7.29 s
Epoch 26/50 |loss: 0.144595| train set 1.810x speedup, test set 1.018x speedup, val set 0.437x speedup, step: 3, train time 7.30 s
Epoch 27/50 |loss: 0.142585| train set 1.757x speedup, test set 1.148x speedup, val set 0.437x speedup, step: 4, train time 7.12 s
Epoch 28/50 |loss: 0.140689| train set 1.810x speedup, test set 1.118x speedup, val set 0.437x speedup, step: 5, train time 7.19 s
Epoch 29/50 |loss: 0.142739| train set 1.810x speedup, test set 1.144x speedup, val set 0.437x speedup, step: 1, train time 7.19 s
Epoch 30/50 |loss: 0.142050| train set 1.790x speedup, test set 0.989x speedup, val set 0.437x speedup, step: 2, train time 7.12 s
Epoch 31/50 |loss: 0.142371| train set 1.775x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 3, train time 7.24 s
Epoch 32/50 |loss: 0.140245| train set 1.810x speedup, test set 1.125x speedup, val set 0.437x speedup, step: 4, train time 7.34 s
Epoch 33/50 |loss: 0.139787| train set 1.775x speedup, test set 1.149x speedup, val set 0.437x speedup, step: 5, train time 7.04 s
Epoch 34/50 |loss: 0.141466| train set 1.791x speedup, test set 1.012x speedup, val set 0.437x speedup, step: 1, train time 7.10 s
Epoch 35/50 |loss: 0.140231| train set 1.810x speedup, test set 1.020x speedup, val set 0.437x speedup, step: 2, train time 7.02 s
Epoch 36/50 |loss: 0.142029| train set 1.810x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 3, train time 7.11 s
Epoch 37/50 |loss: 0.139077| train set 1.810x speedup, test set 1.144x speedup, val set 0.437x speedup, step: 4, train time 7.28 s
Epoch 38/50 |loss: 0.138137| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 7.13 s
Epoch 39/50 |loss: 0.138125| train set 1.790x speedup, test set 1.144x speedup, val set 0.437x speedup, step: 1, train time 7.17 s
Epoch 40/50 |loss: 0.139249| train set 1.776x speedup, test set 1.142x speedup, val set 0.437x speedup, step: 2, train time 7.19 s
Epoch 41/50 |loss: 0.138444| train set 1.765x speedup, test set 1.095x speedup, val set 0.437x speedup, step: 3, train time 7.19 s
Epoch 42/50 |loss: 0.140175| train set 1.810x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 4, train time 7.23 s
Epoch 43/50 |loss: 0.140979| train set 1.776x speedup, test set 1.164x speedup, val set 0.437x speedup, step: 5, train time 7.11 s
Epoch 44/50 |loss: 0.141127| train set 1.776x speedup, test set 1.143x speedup, val set 0.437x speedup, step: 1, train time 7.12 s
early stopping at epoch 44
Training per epoch cost 7.261 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.243s, pg runtime 0.206s, speedup 0.850x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.408s, pg runtime 1.386s, speedup 0.985x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.373s, pg runtime 10.605s, speedup 1.022x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.984s, pg runtime 3.645s, speedup 3.705x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 42, train speedup 1.810, test speedup 1.141, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 44, train speedup 1.776, test speedup 1.143, val speedup 0.437
last model at epoch 44, train speedup 1.776, test speedup 1.143, val speedup 0.437
execution cost 0:06:41.742714
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.045143, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 9.93 s
Epoch 1/50 |loss: 0.229718| train set 1.655x speedup, test set 1.037x speedup, val set 0.477x speedup, step: 2, train time 7.35 s
Epoch 2/50 |loss: 0.203983| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 3, train time 7.40 s
Epoch 3/50 |loss: 0.190152| train set 1.518x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 4, train time 7.64 s
Epoch 4/50 |loss: 0.177615| train set 1.810x speedup, test set 0.901x speedup, val set 0.437x speedup, step: 1, train time 7.53 s
Epoch 5/50 |loss: 0.169808| train set 1.776x speedup, test set 0.888x speedup, val set 0.437x speedup, step: 2, train time 7.58 s
Epoch 6/50 |loss: 0.168516| train set 1.733x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 3, train time 7.53 s
Epoch 7/50 |loss: 0.164758| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 4, train time 7.43 s
Epoch 8/50 |loss: 0.157824| train set 1.790x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 7.50 s
Epoch 9/50 |loss: 0.154037| train set 1.790x speedup, test set 0.874x speedup, val set 0.437x speedup, step: 1, train time 7.43 s
Epoch 10/50 |loss: 0.157813| train set 1.791x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 7.48 s
Epoch 11/50 |loss: 0.154198| train set 1.679x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 3, train time 7.49 s
Epoch 12/50 |loss: 0.154623| train set 1.776x speedup, test set 0.880x speedup, val set 0.437x speedup, step: 4, train time 7.40 s
Epoch 13/50 |loss: 0.151082| train set 1.790x speedup, test set 0.874x speedup, val set 0.437x speedup, step: 5, train time 7.41 s
Epoch 14/50 |loss: 0.150086| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 1, train time 7.40 s
Epoch 15/50 |loss: 0.149788| train set 1.776x speedup, test set 0.887x speedup, val set 0.437x speedup, step: 2, train time 7.32 s
Epoch 16/50 |loss: 0.147930| train set 1.776x speedup, test set 1.067x speedup, val set 0.437x speedup, step: 3, train time 7.40 s
Epoch 17/50 |loss: 0.148994| train set 1.810x speedup, test set 0.888x speedup, val set 0.437x speedup, step: 4, train time 7.43 s
Epoch 18/50 |loss: 0.144471| train set 1.696x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 5, train time 7.40 s
Epoch 19/50 |loss: 0.146435| train set 1.790x speedup, test set 0.872x speedup, val set 0.437x speedup, step: 1, train time 7.30 s
Epoch 20/50 |loss: 0.146221| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 2, train time 7.41 s
Epoch 21/50 |loss: 0.146748| train set 1.775x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 3, train time 7.49 s
Epoch 22/50 |loss: 0.144172| train set 1.775x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 4, train time 7.68 s
Epoch 23/50 |loss: 0.145433| train set 1.810x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 5, train time 7.41 s
Epoch 24/50 |loss: 0.145856| train set 1.810x speedup, test set 1.059x speedup, val set 0.437x speedup, step: 1, train time 8.44 s
Epoch 25/50 |loss: 0.144262| train set 1.810x speedup, test set 0.893x speedup, val set 0.437x speedup, step: 2, train time 7.28 s
Epoch 26/50 |loss: 0.144552| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 3, train time 7.50 s
Epoch 27/50 |loss: 0.142173| train set 1.776x speedup, test set 0.885x speedup, val set 0.437x speedup, step: 4, train time 7.41 s
Epoch 28/50 |loss: 0.140053| train set 1.810x speedup, test set 1.059x speedup, val set 0.437x speedup, step: 5, train time 7.43 s
Epoch 29/50 |loss: 0.142913| train set 1.809x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 1, train time 7.41 s
Epoch 30/50 |loss: 0.141333| train set 1.790x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 2, train time 7.40 s
Epoch 31/50 |loss: 0.141854| train set 1.776x speedup, test set 1.060x speedup, val set 0.437x speedup, step: 3, train time 7.43 s
Epoch 32/50 |loss: 0.139938| train set 1.810x speedup, test set 1.077x speedup, val set 0.437x speedup, step: 4, train time 7.44 s
Epoch 33/50 |loss: 0.139985| train set 1.775x speedup, test set 1.074x speedup, val set 0.437x speedup, step: 5, train time 7.41 s
Epoch 34/50 |loss: 0.141157| train set 1.810x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 1, train time 7.49 s
Epoch 35/50 |loss: 0.140694| train set 1.810x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 2, train time 7.40 s
Epoch 36/50 |loss: 0.142147| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 3, train time 7.50 s
Epoch 37/50 |loss: 0.139270| train set 1.810x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 4, train time 7.31 s
Epoch 38/50 |loss: 0.139567| train set 1.790x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 5, train time 7.58 s
Epoch 39/50 |loss: 0.138246| train set 1.790x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 1, train time 7.47 s
Epoch 40/50 |loss: 0.138986| train set 1.776x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 2, train time 7.38 s
Epoch 41/50 |loss: 0.138760| train set 1.765x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 3, train time 7.81 s
Epoch 42/50 |loss: 0.140709| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 4, train time 7.65 s
Epoch 43/50 |loss: 0.140564| train set 1.776x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 7.43 s
Epoch 44/50 |loss: 0.141242| train set 1.810x speedup, test set 1.190x speedup, val set 0.437x speedup, step: 1, train time 7.53 s
Epoch 45/50 |loss: 0.139558| train set 1.809x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 2, train time 7.50 s
Epoch 46/50 |loss: 0.138819| train set 1.790x speedup, test set 1.146x speedup, val set 0.437x speedup, step: 3, train time 7.49 s
Epoch 47/50 |loss: 0.136997| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 4, train time 7.39 s
Epoch 48/50 |loss: 0.136131| train set 1.776x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 5, train time 7.34 s
Epoch 49/50 |loss: 0.137075| train set 1.810x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 1, train time 7.41 s
Training per epoch cost 7.524 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.984s, pg runtime 3.645s, speedup 3.705x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 1.128s, pg runtime 0.965s, speedup 0.856x
====================
best train speedup epoch: 25, train speedup 1.810, test speedup 0.893, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.141, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.141, val speedup 0.437
execution cost 0:07:45.838550
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.662859, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345694| train set 1.762x speedup, test set 1.136x speedup, val set 0.477x speedup, step: 1, train time 8.93 s
Epoch 1/50 |loss: 0.229068| train set 1.790x speedup, test set 1.115x speedup, val set 0.477x speedup, step: 2, train time 7.21 s
Epoch 2/50 |loss: 0.204496| train set 1.776x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 3, train time 7.29 s
Epoch 3/50 |loss: 0.187288| train set 1.776x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 4, train time 7.39 s
Epoch 4/50 |loss: 0.173532| train set 1.680x speedup, test set 1.033x speedup, val set 0.437x speedup, step: 1, train time 7.20 s
Epoch 5/50 |loss: 0.166678| train set 1.775x speedup, test set 1.034x speedup, val set 0.437x speedup, step: 2, train time 7.11 s
Epoch 6/50 |loss: 0.165286| train set 1.733x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 3, train time 7.30 s
Epoch 7/50 |loss: 0.163145| train set 1.810x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 4, train time 7.21 s
Epoch 8/50 |loss: 0.156741| train set 1.776x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 5, train time 7.32 s
Epoch 9/50 |loss: 0.153497| train set 1.809x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 1, train time 7.30 s
Epoch 10/50 |loss: 0.155144| train set 1.790x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 2, train time 7.22 s
Epoch 11/50 |loss: 0.152028| train set 1.679x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 3, train time 7.31 s
Epoch 12/50 |loss: 0.153764| train set 1.776x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 4, train time 7.19 s
Epoch 13/50 |loss: 0.150393| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 5, train time 7.38 s
Epoch 14/50 |loss: 0.149385| train set 1.810x speedup, test set 1.046x speedup, val set 0.367x speedup, step: 6, train time 7.23 s
Epoch 15/50 |loss: 0.149138| train set 1.776x speedup, test set 0.888x speedup, val set 0.437x speedup, step: 7, train time 7.20 s
Epoch 16/50 |loss: 0.146191| train set 1.776x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 8, train time 7.20 s
Epoch 17/50 |loss: 0.146550| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 9, train time 7.24 s
Epoch 18/50 |loss: 0.143789| train set 1.810x speedup, test set 1.018x speedup, val set 0.437x speedup, step: 10, train time 7.31 s
Epoch 19/50 |loss: 0.145952| train set 1.790x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 1, train time 7.30 s
Epoch 20/50 |loss: 0.143897| train set 1.776x speedup, test set 1.112x speedup, val set 0.437x speedup, step: 2, train time 7.23 s
Epoch 21/50 |loss: 0.145782| train set 1.775x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 3, train time 7.29 s
Epoch 22/50 |loss: 0.143518| train set 1.775x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 4, train time 7.19 s
Epoch 23/50 |loss: 0.143684| train set 1.775x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 5, train time 7.30 s
Epoch 24/50 |loss: 0.144960| train set 1.810x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 1, train time 7.22 s
Epoch 25/50 |loss: 0.143189| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 2, train time 7.20 s
Epoch 26/50 |loss: 0.143990| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 3, train time 7.24 s
Epoch 27/50 |loss: 0.141169| train set 1.757x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 4, train time 7.21 s
Epoch 28/50 |loss: 0.139487| train set 1.810x speedup, test set 1.115x speedup, val set 0.437x speedup, step: 5, train time 7.39 s
Epoch 29/50 |loss: 0.140524| train set 1.810x speedup, test set 1.118x speedup, val set 0.437x speedup, step: 1, train time 7.19 s
Epoch 30/50 |loss: 0.139161| train set 1.790x speedup, test set 1.007x speedup, val set 0.437x speedup, step: 2, train time 7.28 s
Epoch 31/50 |loss: 0.140625| train set 1.775x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 3, train time 7.37 s
Epoch 32/50 |loss: 0.138689| train set 1.810x speedup, test set 1.156x speedup, val set 0.437x speedup, step: 4, train time 7.21 s
Epoch 33/50 |loss: 0.139304| train set 1.775x speedup, test set 1.122x speedup, val set 0.437x speedup, step: 5, train time 7.40 s
Epoch 34/50 |loss: 0.140293| train set 1.810x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 1, train time 7.38 s
Epoch 35/50 |loss: 0.139813| train set 1.810x speedup, test set 1.014x speedup, val set 0.437x speedup, step: 2, train time 7.29 s
Epoch 36/50 |loss: 0.141009| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 3, train time 7.21 s
Epoch 37/50 |loss: 0.138064| train set 1.810x speedup, test set 1.111x speedup, val set 0.437x speedup, step: 4, train time 7.29 s
Epoch 38/50 |loss: 0.138739| train set 1.810x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 5, train time 7.22 s
Epoch 39/50 |loss: 0.137445| train set 1.790x speedup, test set 1.132x speedup, val set 0.437x speedup, step: 1, train time 7.19 s
Epoch 40/50 |loss: 0.138554| train set 1.810x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 2, train time 7.30 s
Epoch 41/50 |loss: 0.139843| train set 1.765x speedup, test set 1.105x speedup, val set 0.437x speedup, step: 3, train time 7.29 s
Epoch 42/50 |loss: 0.139107| train set 1.810x speedup, test set 1.132x speedup, val set 0.437x speedup, step: 4, train time 7.22 s
Epoch 43/50 |loss: 0.139528| train set 1.776x speedup, test set 1.195x speedup, val set 0.437x speedup, step: 5, train time 7.39 s
Epoch 44/50 |loss: 0.139716| train set 1.776x speedup, test set 1.174x speedup, val set 0.437x speedup, step: 1, train time 7.38 s
Epoch 45/50 |loss: 0.137576| train set 1.810x speedup, test set 1.124x speedup, val set 0.437x speedup, step: 2, train time 7.20 s
Epoch 46/50 |loss: 0.138369| train set 1.791x speedup, test set 1.197x speedup, val set 0.437x speedup, step: 3, train time 7.09 s
Epoch 47/50 |loss: 0.137063| train set 1.810x speedup, test set 1.125x speedup, val set 0.437x speedup, step: 4, train time 7.31 s
Epoch 48/50 |loss: 0.134708| train set 1.810x speedup, test set 1.115x speedup, val set 0.437x speedup, step: 5, train time 7.31 s
Epoch 49/50 |loss: 0.136231| train set 1.810x speedup, test set 1.132x speedup, val set 0.437x speedup, step: 1, train time 7.21 s
Training per epoch cost 7.297 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.487s, pg runtime 10.685s, speedup 0.930x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 34, train speedup 1.810, test speedup 1.015, val speedup 0.437
best test speedup epoch: 46, train speedup 1.791, test speedup 1.197, val speedup 0.437
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.132, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.132, val speedup 0.437
execution cost 0:07:25.936588
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.612357, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.32 s
Epoch 1/50 |loss: 0.229180| train set 1.546x speedup, test set 1.023x speedup, val set 0.477x speedup, step: 2, train time 4.01 s
Epoch 2/50 |loss: 0.201288| train set 1.664x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 3, train time 3.99 s
Epoch 3/50 |loss: 0.191565| train set 1.517x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 4, train time 4.00 s
Epoch 4/50 |loss: 0.175372| train set 1.809x speedup, test set 0.902x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 5/50 |loss: 0.168962| train set 1.775x speedup, test set 0.903x speedup, val set 0.437x speedup, step: 2, train time 3.98 s
Epoch 6/50 |loss: 0.165630| train set 1.734x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 3, train time 4.20 s
Epoch 7/50 |loss: 0.162956| train set 1.803x speedup, test set 1.060x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 8/50 |loss: 0.157573| train set 1.790x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 3.91 s
Epoch 9/50 |loss: 0.153667| train set 1.790x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 1, train time 4.08 s
Epoch 10/50 |loss: 0.157857| train set 1.791x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 11/50 |loss: 0.154742| train set 1.790x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.02 s
Epoch 12/50 |loss: 0.153679| train set 1.776x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 4, train time 4.00 s
Epoch 13/50 |loss: 0.152557| train set 1.790x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 5, train time 4.08 s
Epoch 14/50 |loss: 0.149334| train set 1.810x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 15/50 |loss: 0.149200| train set 1.757x speedup, test set 0.895x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 16/50 |loss: 0.148061| train set 1.776x speedup, test set 1.077x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 17/50 |loss: 0.148162| train set 1.810x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 4, train time 4.18 s
Epoch 18/50 |loss: 0.144960| train set 1.696x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 19/50 |loss: 0.148692| train set 1.790x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 1, train time 3.98 s
Epoch 20/50 |loss: 0.146608| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 21/50 |loss: 0.146090| train set 1.775x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 3, train time 4.04 s
Epoch 22/50 |loss: 0.144854| train set 1.776x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 23/50 |loss: 0.145205| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 24/50 |loss: 0.145990| train set 1.810x speedup, test set 1.060x speedup, val set 0.437x speedup, step: 1, train time 4.78 s
Epoch 25/50 |loss: 0.144111| train set 1.711x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 2, train time 4.01 s
Epoch 26/50 |loss: 0.145797| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 3, train time 3.91 s
Epoch 27/50 |loss: 0.142275| train set 1.757x speedup, test set 1.112x speedup, val set 0.437x speedup, step: 4, train time 4.22 s
Epoch 28/50 |loss: 0.140817| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 29/50 |loss: 0.143424| train set 1.810x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 30/50 |loss: 0.142071| train set 1.790x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 31/50 |loss: 0.141286| train set 1.775x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 32/50 |loss: 0.141080| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 4, train time 4.17 s
Epoch 33/50 |loss: 0.140818| train set 1.775x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 5, train time 4.00 s
Epoch 34/50 |loss: 0.141654| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 1, train time 4.02 s
Epoch 35/50 |loss: 0.141013| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 2, train time 3.89 s
Epoch 36/50 |loss: 0.142713| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 37/50 |loss: 0.139723| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 38/50 |loss: 0.139811| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 39/50 |loss: 0.138441| train set 1.790x speedup, test set 1.129x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 40/50 |loss: 0.140605| train set 1.776x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 2, train time 4.08 s
Epoch 41/50 |loss: 0.138880| train set 1.765x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 3, train time 4.30 s
Epoch 42/50 |loss: 0.141436| train set 1.810x speedup, test set 1.080x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 43/50 |loss: 0.140954| train set 1.776x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 5, train time 4.03 s
Epoch 44/50 |loss: 0.141409| train set 1.776x speedup, test set 1.180x speedup, val set 0.437x speedup, step: 1, train time 4.08 s
Epoch 45/50 |loss: 0.139259| train set 1.809x speedup, test set 1.105x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 46/50 |loss: 0.139535| train set 1.790x speedup, test set 1.168x speedup, val set 0.437x speedup, step: 3, train time 4.26 s
Epoch 47/50 |loss: 0.137861| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 48/50 |loss: 0.136260| train set 1.810x speedup, test set 1.105x speedup, val set 0.437x speedup, step: 5, train time 4.28 s
Epoch 49/50 |loss: 0.136733| train set 1.810x speedup, test set 1.136x speedup, val set 0.437x speedup, step: 1, train time 4.21 s
Training per epoch cost 4.137 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 28, train speedup 1.810, test speedup 1.055, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.136, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.136, val speedup 0.437
execution cost 0:04:00.276567
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.565220, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.38 s
Epoch 1/50 |loss: 0.229817| train set 1.655x speedup, test set 1.065x speedup, val set 0.477x speedup, step: 2, train time 4.20 s
Epoch 2/50 |loss: 0.203237| train set 1.791x speedup, test set 1.001x speedup, val set 0.296x speedup, step: 3, train time 4.10 s
Epoch 3/50 |loss: 0.191287| train set 1.517x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 4, train time 4.10 s
Epoch 4/50 |loss: 0.176907| train set 1.809x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 5/50 |loss: 0.170103| train set 1.775x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 2, train time 4.01 s
Epoch 6/50 |loss: 0.167207| train set 1.734x speedup, test set 0.898x speedup, val set 0.437x speedup, step: 3, train time 3.97 s
Epoch 7/50 |loss: 0.164016| train set 1.810x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 4, train time 4.29 s
Epoch 8/50 |loss: 0.159090| train set 1.776x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 5, train time 4.19 s
Epoch 9/50 |loss: 0.153918| train set 1.757x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 1, train time 4.29 s
Epoch 10/50 |loss: 0.157596| train set 1.791x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 11/50 |loss: 0.154754| train set 1.790x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 12/50 |loss: 0.154023| train set 1.776x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 4.12 s
Epoch 13/50 |loss: 0.151208| train set 1.810x speedup, test set 1.006x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 14/50 |loss: 0.149560| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 1, train time 4.18 s
Epoch 15/50 |loss: 0.148658| train set 1.776x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 16/50 |loss: 0.146999| train set 1.776x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 17/50 |loss: 0.148780| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 18/50 |loss: 0.145006| train set 1.696x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 19/50 |loss: 0.146952| train set 1.790x speedup, test set 1.035x speedup, val set 0.437x speedup, step: 1, train time 4.18 s
Epoch 20/50 |loss: 0.145749| train set 1.776x speedup, test set 1.109x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 21/50 |loss: 0.146611| train set 1.775x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 3, train time 3.99 s
Epoch 22/50 |loss: 0.144587| train set 1.776x speedup, test set 1.182x speedup, val set 0.437x speedup, step: 4, train time 4.02 s
Epoch 23/50 |loss: 0.144713| train set 1.810x speedup, test set 1.093x speedup, val set 0.437x speedup, step: 5, train time 4.33 s
Epoch 24/50 |loss: 0.145141| train set 1.810x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 1, train time 4.97 s
Epoch 25/50 |loss: 0.144412| train set 1.810x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 2, train time 4.08 s
Epoch 26/50 |loss: 0.144640| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 27/50 |loss: 0.141972| train set 1.776x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 4, train time 4.21 s
Epoch 28/50 |loss: 0.140249| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 5, train time 4.13 s
Epoch 29/50 |loss: 0.142768| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 30/50 |loss: 0.140544| train set 1.791x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 2, train time 3.93 s
Epoch 31/50 |loss: 0.141797| train set 1.810x speedup, test set 1.060x speedup, val set 0.437x speedup, step: 3, train time 4.13 s
Epoch 32/50 |loss: 0.140651| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 4, train time 4.12 s
Epoch 33/50 |loss: 0.140267| train set 1.775x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 34/50 |loss: 0.141239| train set 1.774x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 35/50 |loss: 0.139616| train set 1.810x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 36/50 |loss: 0.140717| train set 1.810x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 37/50 |loss: 0.139373| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 38/50 |loss: 0.140459| train set 1.810x speedup, test set 1.036x speedup, val set 0.437x speedup, step: 5, train time 4.19 s
Epoch 39/50 |loss: 0.138197| train set 1.810x speedup, test set 1.098x speedup, val set 0.437x speedup, step: 1, train time 4.12 s
Epoch 40/50 |loss: 0.138130| train set 1.776x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 2, train time 4.02 s
Epoch 41/50 |loss: 0.139394| train set 1.765x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 3, train time 3.96 s
Epoch 42/50 |loss: 0.140522| train set 1.810x speedup, test set 1.036x speedup, val set 0.437x speedup, step: 4, train time 3.97 s
Epoch 43/50 |loss: 0.139581| train set 1.776x speedup, test set 1.240x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 44/50 |loss: 0.141390| train set 1.776x speedup, test set 1.184x speedup, val set 0.437x speedup, step: 1, train time 4.14 s
Epoch 45/50 |loss: 0.140441| train set 1.810x speedup, test set 1.113x speedup, val set 0.437x speedup, step: 2, train time 4.11 s
Epoch 46/50 |loss: 0.138600| train set 1.757x speedup, test set 1.129x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 47/50 |loss: 0.137187| train set 1.810x speedup, test set 1.067x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 48/50 |loss: 0.136444| train set 1.776x speedup, test set 1.075x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 49/50 |loss: 0.137136| train set 1.810x speedup, test set 1.096x speedup, val set 0.437x speedup, step: 1, train time 4.29 s
Training per epoch cost 4.162 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.487s, pg runtime 10.685s, speedup 0.930x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 28, train speedup 1.810, test speedup 1.048, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.096, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.096, val speedup 0.437
execution cost 0:04:00.313822
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.658958, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344966| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.70 s
Epoch 1/50 |loss: 0.231188| train set 1.434x speedup, test set 0.983x speedup, val set 0.477x speedup, step: 2, train time 3.99 s
Epoch 2/50 |loss: 0.203508| train set 1.791x speedup, test set 1.006x speedup, val set 0.296x speedup, step: 3, train time 4.09 s
Epoch 3/50 |loss: 0.192248| train set 1.776x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 4, train time 4.03 s
Epoch 4/50 |loss: 0.177384| train set 1.775x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 1, train time 4.09 s
Epoch 5/50 |loss: 0.169574| train set 1.776x speedup, test set 0.902x speedup, val set 0.437x speedup, step: 2, train time 4.03 s
Epoch 6/50 |loss: 0.167444| train set 1.733x speedup, test set 0.905x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 7/50 |loss: 0.164227| train set 1.810x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 8/50 |loss: 0.156872| train set 1.791x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 9/50 |loss: 0.153569| train set 1.679x speedup, test set 1.062x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 10/50 |loss: 0.156977| train set 1.791x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 2, train time 3.93 s
Epoch 11/50 |loss: 0.154239| train set 1.724x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 12/50 |loss: 0.153909| train set 1.776x speedup, test set 0.898x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 13/50 |loss: 0.150381| train set 1.790x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 14/50 |loss: 0.149218| train set 1.810x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 1, train time 4.08 s
Epoch 15/50 |loss: 0.149225| train set 1.810x speedup, test set 0.905x speedup, val set 0.437x speedup, step: 2, train time 4.01 s
Epoch 16/50 |loss: 0.146539| train set 1.776x speedup, test set 0.902x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 17/50 |loss: 0.147939| train set 1.810x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 18/50 |loss: 0.143748| train set 1.696x speedup, test set 0.889x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 19/50 |loss: 0.148611| train set 1.790x speedup, test set 0.881x speedup, val set 0.437x speedup, step: 1, train time 3.92 s
Epoch 20/50 |loss: 0.145875| train set 1.810x speedup, test set 0.890x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 21/50 |loss: 0.145989| train set 1.775x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 22/50 |loss: 0.144452| train set 1.776x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 4, train time 4.29 s
Epoch 23/50 |loss: 0.145512| train set 1.809x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 24/50 |loss: 0.145776| train set 1.810x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 1, train time 4.71 s
Epoch 25/50 |loss: 0.143907| train set 1.810x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 2, train time 3.93 s
Epoch 26/50 |loss: 0.143700| train set 1.810x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 27/50 |loss: 0.141351| train set 1.757x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 28/50 |loss: 0.139437| train set 1.810x speedup, test set 1.081x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 29/50 |loss: 0.142089| train set 1.810x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 1, train time 4.02 s
Epoch 30/50 |loss: 0.140992| train set 1.790x speedup, test set 0.896x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 31/50 |loss: 0.140622| train set 1.809x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 32/50 |loss: 0.139606| train set 1.810x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 4, train time 3.92 s
Epoch 33/50 |loss: 0.139456| train set 1.775x speedup, test set 0.905x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 34/50 |loss: 0.140346| train set 1.810x speedup, test set 1.070x speedup, val set 0.437x speedup, step: 1, train time 4.08 s
Epoch 35/50 |loss: 0.139681| train set 1.810x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 2, train time 4.23 s
Epoch 36/50 |loss: 0.142332| train set 1.810x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 37/50 |loss: 0.138796| train set 1.810x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 4, train time 4.03 s
Epoch 38/50 |loss: 0.139193| train set 1.810x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 5, train time 3.99 s
Epoch 39/50 |loss: 0.137453| train set 1.790x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 40/50 |loss: 0.138771| train set 1.810x speedup, test set 0.892x speedup, val set 0.437x speedup, step: 2, train time 4.08 s
Epoch 41/50 |loss: 0.137726| train set 1.765x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 3, train time 3.99 s
Epoch 42/50 |loss: 0.139563| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 4, train time 4.17 s
Epoch 43/50 |loss: 0.140267| train set 1.776x speedup, test set 1.099x speedup, val set 0.437x speedup, step: 5, train time 4.19 s
Epoch 44/50 |loss: 0.139677| train set 1.776x speedup, test set 1.163x speedup, val set 0.437x speedup, step: 1, train time 3.83 s
Epoch 45/50 |loss: 0.138363| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 46/50 |loss: 0.139645| train set 1.790x speedup, test set 1.171x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 47/50 |loss: 0.136613| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 48/50 |loss: 0.135772| train set 1.776x speedup, test set 1.082x speedup, val set 0.437x speedup, step: 5, train time 4.32 s
Epoch 49/50 |loss: 0.136535| train set 1.810x speedup, test set 1.117x speedup, val set 0.437x speedup, step: 1, train time 4.14 s
Training per epoch cost 4.116 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 35, train speedup 1.810, test speedup 0.897, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.117, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.117, val speedup 0.437
execution cost 0:03:58.265592
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.704905, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.36 s
Epoch 1/50 |loss: 0.229472| train set 1.387x speedup, test set 1.053x speedup, val set 0.477x speedup, step: 2, train time 3.98 s
Epoch 2/50 |loss: 0.204264| train set 1.663x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 3, train time 3.92 s
Epoch 3/50 |loss: 0.189480| train set 1.517x speedup, test set 1.076x speedup, val set 0.437x speedup, step: 4, train time 4.39 s
Epoch 4/50 |loss: 0.174506| train set 1.809x speedup, test set 1.067x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 5/50 |loss: 0.170273| train set 1.680x speedup, test set 0.901x speedup, val set 0.437x speedup, step: 2, train time 4.08 s
Epoch 6/50 |loss: 0.167806| train set 1.733x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 7/50 |loss: 0.164712| train set 1.810x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 4, train time 3.93 s
Epoch 8/50 |loss: 0.157287| train set 1.790x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 5, train time 3.93 s
Epoch 9/50 |loss: 0.154005| train set 1.790x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 1, train time 4.15 s
Epoch 10/50 |loss: 0.157203| train set 1.791x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 2, train time 4.01 s
Epoch 11/50 |loss: 0.153569| train set 1.790x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 3, train time 4.22 s
Epoch 12/50 |loss: 0.155386| train set 1.776x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 4, train time 3.93 s
Epoch 13/50 |loss: 0.151342| train set 1.790x speedup, test set 0.875x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 14/50 |loss: 0.149801| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 1, train time 4.12 s
Epoch 15/50 |loss: 0.148709| train set 1.776x speedup, test set 0.889x speedup, val set 0.437x speedup, step: 2, train time 3.82 s
Epoch 16/50 |loss: 0.147074| train set 1.776x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 17/50 |loss: 0.148979| train set 1.810x speedup, test set 0.895x speedup, val set 0.437x speedup, step: 4, train time 3.91 s
Epoch 18/50 |loss: 0.144945| train set 1.679x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 19/50 |loss: 0.147515| train set 1.790x speedup, test set 0.858x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 20/50 |loss: 0.146605| train set 1.810x speedup, test set 1.016x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 21/50 |loss: 0.145986| train set 1.775x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 3, train time 3.92 s
Epoch 22/50 |loss: 0.145265| train set 1.776x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 23/50 |loss: 0.145632| train set 1.810x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 24/50 |loss: 0.145600| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 1, train time 4.88 s
Epoch 25/50 |loss: 0.144354| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 2, train time 4.08 s
Epoch 26/50 |loss: 0.145544| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 27/50 |loss: 0.142055| train set 1.757x speedup, test set 1.144x speedup, val set 0.437x speedup, step: 4, train time 4.18 s
Epoch 28/50 |loss: 0.141227| train set 1.810x speedup, test set 1.107x speedup, val set 0.437x speedup, step: 5, train time 3.89 s
Epoch 29/50 |loss: 0.142850| train set 1.810x speedup, test set 1.108x speedup, val set 0.437x speedup, step: 1, train time 3.89 s
Epoch 30/50 |loss: 0.142085| train set 1.790x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 31/50 |loss: 0.142660| train set 1.775x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.30 s
Epoch 32/50 |loss: 0.141449| train set 1.810x speedup, test set 1.145x speedup, val set 0.437x speedup, step: 4, train time 4.13 s
Epoch 33/50 |loss: 0.140378| train set 1.775x speedup, test set 1.137x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 34/50 |loss: 0.141611| train set 1.810x speedup, test set 1.099x speedup, val set 0.437x speedup, step: 1, train time 4.01 s
Epoch 35/50 |loss: 0.140893| train set 1.810x speedup, test set 1.036x speedup, val set 0.437x speedup, step: 2, train time 4.02 s
Epoch 36/50 |loss: 0.142975| train set 1.810x speedup, test set 1.037x speedup, val set 0.437x speedup, step: 3, train time 4.12 s
Epoch 37/50 |loss: 0.140021| train set 1.810x speedup, test set 1.102x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 38/50 |loss: 0.139906| train set 1.790x speedup, test set 1.100x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 39/50 |loss: 0.138706| train set 1.790x speedup, test set 1.134x speedup, val set 0.437x speedup, step: 1, train time 4.18 s
Epoch 40/50 |loss: 0.140725| train set 1.776x speedup, test set 1.183x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 41/50 |loss: 0.138740| train set 1.765x speedup, test set 1.183x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 42/50 |loss: 0.142230| train set 1.810x speedup, test set 1.176x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 43/50 |loss: 0.140688| train set 1.776x speedup, test set 1.207x speedup, val set 0.437x speedup, step: 5, train time 4.08 s
Epoch 44/50 |loss: 0.140602| train set 1.776x speedup, test set 1.247x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
Epoch 45/50 |loss: 0.139862| train set 1.810x speedup, test set 1.183x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 46/50 |loss: 0.140048| train set 1.790x speedup, test set 1.228x speedup, val set 0.437x speedup, step: 3, train time 3.92 s
Epoch 47/50 |loss: 0.138188| train set 1.810x speedup, test set 1.182x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 48/50 |loss: 0.136524| train set 1.776x speedup, test set 1.097x speedup, val set 0.437x speedup, step: 5, train time 3.99 s
Epoch 49/50 |loss: 0.137613| train set 1.810x speedup, test set 1.192x speedup, val set 0.437x speedup, step: 1, train time 3.90 s
Training per epoch cost 4.100 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 25, train speedup 1.810, test speedup 1.044, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.192, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.192, val speedup 0.437
execution cost 0:03:57.878450
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.567322, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345791| train set 1.762x speedup, test set 1.176x speedup, val set 0.477x speedup, step: 1, train time 5.34 s
Epoch 1/50 |loss: 0.228780| train set 1.434x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 2, train time 4.22 s
Epoch 2/50 |loss: 0.203104| train set 1.791x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 3, train time 3.99 s
Epoch 3/50 |loss: 0.188982| train set 1.810x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 4, train time 4.28 s
Epoch 4/50 |loss: 0.175211| train set 1.775x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 1, train time 4.31 s
Epoch 5/50 |loss: 0.169404| train set 1.680x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 2, train time 3.96 s
Epoch 6/50 |loss: 0.163395| train set 1.776x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.22 s
Epoch 7/50 |loss: 0.162478| train set 1.810x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 8/50 |loss: 0.156840| train set 1.790x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 5, train time 4.08 s
Epoch 9/50 |loss: 0.152621| train set 1.663x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 1, train time 4.28 s
Epoch 10/50 |loss: 0.155379| train set 1.790x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 2, train time 4.40 s
Epoch 11/50 |loss: 0.153474| train set 1.679x speedup, test set 1.102x speedup, val set 0.296x speedup, step: 3, train time 4.57 s
Epoch 12/50 |loss: 0.153871| train set 1.757x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 4, train time 4.29 s
Epoch 13/50 |loss: 0.149854| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 14/50 |loss: 0.149278| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 15/50 |loss: 0.149156| train set 1.776x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 16/50 |loss: 0.146137| train set 1.776x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 3, train time 4.28 s
Epoch 17/50 |loss: 0.146999| train set 1.810x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 18/50 |loss: 0.143529| train set 1.696x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 19/50 |loss: 0.146536| train set 1.790x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 20/50 |loss: 0.145037| train set 1.809x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 2, train time 4.11 s
Epoch 21/50 |loss: 0.145879| train set 1.775x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 22/50 |loss: 0.144167| train set 1.776x speedup, test set 1.066x speedup, val set 0.437x speedup, step: 4, train time 4.12 s
Epoch 23/50 |loss: 0.144150| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 5, train time 3.92 s
Epoch 24/50 |loss: 0.144682| train set 1.810x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 1, train time 4.89 s
Epoch 25/50 |loss: 0.142386| train set 1.791x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 2, train time 4.20 s
Epoch 26/50 |loss: 0.144125| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 27/50 |loss: 0.141222| train set 1.776x speedup, test set 1.087x speedup, val set 0.437x speedup, step: 4, train time 4.00 s
Epoch 28/50 |loss: 0.139956| train set 1.810x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 5, train time 4.31 s
Epoch 29/50 |loss: 0.141813| train set 1.810x speedup, test set 1.092x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 30/50 |loss: 0.140045| train set 1.790x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 2, train time 4.22 s
Epoch 31/50 |loss: 0.140257| train set 1.810x speedup, test set 0.898x speedup, val set 0.437x speedup, step: 3, train time 4.61 s
Epoch 32/50 |loss: 0.138813| train set 1.810x speedup, test set 1.084x speedup, val set 0.437x speedup, step: 4, train time 4.12 s
Epoch 33/50 |loss: 0.139305| train set 1.775x speedup, test set 1.084x speedup, val set 0.437x speedup, step: 5, train time 4.41 s
Epoch 34/50 |loss: 0.140547| train set 1.810x speedup, test set 1.027x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 35/50 |loss: 0.139800| train set 1.810x speedup, test set 1.092x speedup, val set 0.437x speedup, step: 2, train time 4.21 s
Epoch 36/50 |loss: 0.141426| train set 1.810x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 3, train time 4.02 s
Epoch 37/50 |loss: 0.138495| train set 1.810x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 38/50 |loss: 0.138437| train set 1.810x speedup, test set 1.086x speedup, val set 0.437x speedup, step: 5, train time 3.97 s
Epoch 39/50 |loss: 0.137412| train set 1.810x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 1, train time 4.49 s
Epoch 40/50 |loss: 0.139242| train set 1.776x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 41/50 |loss: 0.139391| train set 1.810x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 3, train time 4.03 s
early stopping at epoch 41
Training per epoch cost 4.226 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.243s, pg runtime 0.206s, speedup 0.850x
02, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
03, opt runtime 1.763s, model runtime 1.804s, pg runtime 1.763s, speedup 0.977x
04, opt runtime 1.386s, model runtime 1.408s, pg runtime 1.386s, speedup 0.985x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.373s, pg runtime 10.605s, speedup 1.022x
10, opt runtime 3.248s, model runtime 10.020s, pg runtime 10.538s, speedup 1.052x
11, opt runtime 0.294s, model runtime 0.875s, pg runtime 2.352s, speedup 2.688x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 14.577s, pg runtime 10.685s, speedup 0.733x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 23, train speedup 1.810, test speedup 1.063, val speedup 0.437
best test speedup epoch: 0, train speedup 1.762, test speedup 1.176, val speedup 0.477
best validation speedup epoch: 39, train speedup 1.810, test speedup 1.039, val speedup 0.437
last model at epoch 41, train speedup 1.810, test speedup 1.141, val speedup 0.437
execution cost 0:03:27.588269
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.621579, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345694| train set 1.762x speedup, test set 1.136x speedup, val set 0.477x speedup, step: 1, train time 5.30 s
Epoch 1/50 |loss: 0.229125| train set 1.784x speedup, test set 1.072x speedup, val set 0.296x speedup, step: 2, train time 4.21 s
Epoch 2/50 |loss: 0.200355| train set 1.757x speedup, test set 0.989x speedup, val set 0.296x speedup, step: 3, train time 3.92 s
Epoch 3/50 |loss: 0.189560| train set 1.776x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 4, train time 3.99 s
Epoch 4/50 |loss: 0.173696| train set 1.809x speedup, test set 0.885x speedup, val set 0.437x speedup, step: 1, train time 4.12 s
Epoch 5/50 |loss: 0.166566| train set 1.775x speedup, test set 0.871x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 6/50 |loss: 0.164830| train set 1.734x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 3, train time 4.13 s
Epoch 7/50 |loss: 0.165448| train set 1.810x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 4, train time 4.30 s
Epoch 8/50 |loss: 0.155723| train set 1.757x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 5, train time 4.02 s
Epoch 9/50 |loss: 0.152059| train set 1.790x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 1, train time 4.06 s
Epoch 10/50 |loss: 0.156518| train set 1.791x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 2, train time 4.20 s
Epoch 11/50 |loss: 0.152928| train set 1.679x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 3, train time 4.09 s
Epoch 12/50 |loss: 0.154553| train set 1.776x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 13/50 |loss: 0.149549| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 14/50 |loss: 0.149135| train set 1.810x speedup, test set 1.024x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 15/50 |loss: 0.147857| train set 1.757x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 16/50 |loss: 0.146133| train set 1.776x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 3, train time 4.02 s
Epoch 17/50 |loss: 0.147004| train set 1.810x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 4, train time 4.18 s
Epoch 18/50 |loss: 0.145226| train set 1.696x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 19/50 |loss: 0.146338| train set 1.790x speedup, test set 1.014x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 20/50 |loss: 0.146159| train set 1.810x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 21/50 |loss: 0.146213| train set 1.775x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 3, train time 4.02 s
Epoch 22/50 |loss: 0.143656| train set 1.776x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 4, train time 4.03 s
Epoch 23/50 |loss: 0.144948| train set 1.776x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 24/50 |loss: 0.145600| train set 1.810x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 1, train time 4.59 s
Epoch 25/50 |loss: 0.143372| train set 1.810x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 2, train time 4.08 s
Epoch 26/50 |loss: 0.144925| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 3, train time 4.02 s
Epoch 27/50 |loss: 0.140891| train set 1.757x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 4, train time 3.99 s
Epoch 28/50 |loss: 0.139698| train set 1.810x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 5, train time 4.08 s
Epoch 29/50 |loss: 0.142411| train set 1.810x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 30/50 |loss: 0.140337| train set 1.790x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 2, train time 3.97 s
Epoch 31/50 |loss: 0.141089| train set 1.810x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 32/50 |loss: 0.139498| train set 1.810x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 4, train time 4.04 s
Epoch 33/50 |loss: 0.139883| train set 1.775x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 5, train time 4.08 s
Epoch 34/50 |loss: 0.141909| train set 1.776x speedup, test set 1.024x speedup, val set 0.437x speedup, step: 1, train time 4.03 s
Epoch 35/50 |loss: 0.139600| train set 1.810x speedup, test set 1.019x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 36/50 |loss: 0.141717| train set 1.790x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 37/50 |loss: 0.138646| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 38/50 |loss: 0.139278| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 39/50 |loss: 0.138116| train set 1.810x speedup, test set 1.018x speedup, val set 0.437x speedup, step: 1, train time 4.21 s
Epoch 40/50 |loss: 0.139116| train set 1.776x speedup, test set 1.062x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 41/50 |loss: 0.138416| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 3, train time 3.91 s
Epoch 42/50 |loss: 0.139787| train set 1.810x speedup, test set 1.007x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 43/50 |loss: 0.141167| train set 1.776x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 5, train time 4.08 s
Epoch 44/50 |loss: 0.139342| train set 1.776x speedup, test set 1.059x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 45/50 |loss: 0.138124| train set 1.810x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 2, train time 4.17 s
Epoch 46/50 |loss: 0.139150| train set 1.757x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 47/50 |loss: 0.137337| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 48/50 |loss: 0.135577| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 49/50 |loss: 0.136530| train set 1.810x speedup, test set 1.104x speedup, val set 0.437x speedup, step: 1, train time 3.91 s
Training per epoch cost 4.106 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.487s, pg runtime 10.685s, speedup 0.930x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 25, train speedup 1.810, test speedup 1.068, val speedup 0.437
best test speedup epoch: 0, train speedup 1.762, test speedup 1.136, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.104, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.104, val speedup 0.437
execution cost 0:03:58.729834
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.580105, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.25 s
Epoch 1/50 |loss: 0.229276| train set 1.655x speedup, test set 1.075x speedup, val set 0.477x speedup, step: 2, train time 4.11 s
Epoch 2/50 |loss: 0.202642| train set 1.663x speedup, test set 0.955x speedup, val set 0.296x speedup, step: 3, train time 4.10 s
Epoch 3/50 |loss: 0.192660| train set 1.776x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 4/50 |loss: 0.177123| train set 1.810x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 5/50 |loss: 0.170142| train set 1.776x speedup, test set 1.059x speedup, val set 0.437x speedup, step: 2, train time 3.99 s
Epoch 6/50 |loss: 0.166439| train set 1.734x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 7/50 |loss: 0.164718| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 8/50 |loss: 0.156837| train set 1.810x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 9/50 |loss: 0.153822| train set 1.663x speedup, test set 0.998x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 10/50 |loss: 0.156000| train set 1.790x speedup, test set 1.020x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 11/50 |loss: 0.153362| train set 1.790x speedup, test set 1.059x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 12/50 |loss: 0.153224| train set 1.776x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 13/50 |loss: 0.151309| train set 1.810x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 5, train time 4.29 s
Epoch 14/50 |loss: 0.149755| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 1, train time 3.88 s
Epoch 15/50 |loss: 0.148775| train set 1.757x speedup, test set 1.060x speedup, val set 0.437x speedup, step: 2, train time 3.92 s
Epoch 16/50 |loss: 0.146696| train set 1.776x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 17/50 |loss: 0.147385| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 4, train time 4.03 s
Epoch 18/50 |loss: 0.145429| train set 1.696x speedup, test set 1.019x speedup, val set 0.437x speedup, step: 5, train time 3.99 s
Epoch 19/50 |loss: 0.147623| train set 1.790x speedup, test set 0.991x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 20/50 |loss: 0.145513| train set 1.776x speedup, test set 0.990x speedup, val set 0.437x speedup, step: 2, train time 4.13 s
Epoch 21/50 |loss: 0.145839| train set 1.775x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 3, train time 4.31 s
Epoch 22/50 |loss: 0.144098| train set 1.775x speedup, test set 1.114x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 23/50 |loss: 0.144629| train set 1.810x speedup, test set 1.127x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 24/50 |loss: 0.144867| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 1, train time 4.68 s
Epoch 25/50 |loss: 0.143862| train set 1.810x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 2, train time 3.99 s
Epoch 26/50 |loss: 0.144721| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 27/50 |loss: 0.141944| train set 1.757x speedup, test set 1.147x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 28/50 |loss: 0.140216| train set 1.810x speedup, test set 1.136x speedup, val set 0.437x speedup, step: 5, train time 3.93 s
Epoch 29/50 |loss: 0.141991| train set 1.810x speedup, test set 1.104x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 30/50 |loss: 0.140265| train set 1.791x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 31/50 |loss: 0.141713| train set 1.775x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 32/50 |loss: 0.139607| train set 1.810x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 33/50 |loss: 0.139594| train set 1.775x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 34/50 |loss: 0.140470| train set 1.810x speedup, test set 1.014x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 35/50 |loss: 0.139846| train set 1.810x speedup, test set 1.011x speedup, val set 0.437x speedup, step: 2, train time 4.18 s
Epoch 36/50 |loss: 0.140022| train set 1.810x speedup, test set 1.107x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 37/50 |loss: 0.138645| train set 1.810x speedup, test set 1.107x speedup, val set 0.437x speedup, step: 4, train time 4.03 s
Epoch 38/50 |loss: 0.138272| train set 1.810x speedup, test set 1.013x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 39/50 |loss: 0.136865| train set 1.790x speedup, test set 1.139x speedup, val set 0.437x speedup, step: 1, train time 4.22 s
Epoch 40/50 |loss: 0.139057| train set 1.776x speedup, test set 1.009x speedup, val set 0.437x speedup, step: 2, train time 4.02 s
Epoch 41/50 |loss: 0.138131| train set 1.765x speedup, test set 1.104x speedup, val set 0.437x speedup, step: 3, train time 4.13 s
Epoch 42/50 |loss: 0.139621| train set 1.810x speedup, test set 1.014x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 43/50 |loss: 0.139656| train set 1.776x speedup, test set 1.178x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 44/50 |loss: 0.139945| train set 1.810x speedup, test set 1.178x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 45/50 |loss: 0.137642| train set 1.809x speedup, test set 1.007x speedup, val set 0.437x speedup, step: 2, train time 4.02 s
Epoch 46/50 |loss: 0.139066| train set 1.791x speedup, test set 1.223x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 47/50 |loss: 0.137372| train set 1.810x speedup, test set 1.009x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 48/50 |loss: 0.136366| train set 1.810x speedup, test set 1.089x speedup, val set 0.437x speedup, step: 5, train time 4.08 s
Epoch 49/50 |loss: 0.135985| train set 1.810x speedup, test set 1.121x speedup, val set 0.437x speedup, step: 1, train time 3.93 s
Training per epoch cost 4.108 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.487s, pg runtime 10.685s, speedup 0.930x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 23, train speedup 1.810, test speedup 1.127, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.121, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.121, val speedup 0.437
execution cost 0:03:57.883643
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.547556, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.22 s
Epoch 1/50 |loss: 0.229062| train set 1.433x speedup, test set 0.981x speedup, val set 0.477x speedup, step: 2, train time 4.02 s
Epoch 2/50 |loss: 0.206330| train set 1.663x speedup, test set 1.019x speedup, val set 0.296x speedup, step: 3, train time 4.12 s
Epoch 3/50 |loss: 0.191697| train set 1.504x speedup, test set 1.081x speedup, val set 0.437x speedup, step: 4, train time 4.21 s
Epoch 4/50 |loss: 0.178174| train set 1.775x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 1, train time 4.12 s
Epoch 5/50 |loss: 0.170300| train set 1.775x speedup, test set 0.890x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 6/50 |loss: 0.166574| train set 1.734x speedup, test set 1.079x speedup, val set 0.437x speedup, step: 3, train time 4.21 s
Epoch 7/50 |loss: 0.165050| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 8/50 |loss: 0.157705| train set 1.790x speedup, test set 1.067x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 9/50 |loss: 0.153452| train set 1.662x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 10/50 |loss: 0.156798| train set 1.790x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 2, train time 4.27 s
Epoch 11/50 |loss: 0.154245| train set 1.679x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 3, train time 4.21 s
Epoch 12/50 |loss: 0.152788| train set 1.776x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 4, train time 4.08 s
Epoch 13/50 |loss: 0.150190| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 14/50 |loss: 0.149270| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 15/50 |loss: 0.148642| train set 1.776x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 16/50 |loss: 0.146515| train set 1.776x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 17/50 |loss: 0.148842| train set 1.810x speedup, test set 1.070x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 18/50 |loss: 0.144276| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 19/50 |loss: 0.146173| train set 1.789x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 1, train time 4.09 s
Epoch 20/50 |loss: 0.144749| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 2, train time 4.00 s
Epoch 21/50 |loss: 0.145328| train set 1.775x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 3, train time 3.99 s
Epoch 22/50 |loss: 0.144175| train set 1.776x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 23/50 |loss: 0.144339| train set 1.810x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 24/50 |loss: 0.145400| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 1, train time 4.61 s
Epoch 25/50 |loss: 0.144080| train set 1.810x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 26/50 |loss: 0.143794| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 27/50 |loss: 0.141856| train set 1.757x speedup, test set 1.070x speedup, val set 0.437x speedup, step: 4, train time 3.97 s
Epoch 28/50 |loss: 0.140638| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 29/50 |loss: 0.142406| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 1, train time 4.18 s
Epoch 30/50 |loss: 0.140469| train set 1.790x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 4.02 s
Epoch 31/50 |loss: 0.140860| train set 1.775x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 3, train time 3.93 s
Epoch 32/50 |loss: 0.139927| train set 1.810x speedup, test set 1.084x speedup, val set 0.437x speedup, step: 4, train time 3.93 s
Epoch 33/50 |loss: 0.140719| train set 1.775x speedup, test set 1.161x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 34/50 |loss: 0.140523| train set 1.776x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 1, train time 4.12 s
Epoch 35/50 |loss: 0.140684| train set 1.810x speedup, test set 1.020x speedup, val set 1.000x speedup, step: 2, train time 4.11 s
Epoch 36/50 |loss: 0.141596| train set 1.810x speedup, test set 1.075x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 37/50 |loss: 0.138751| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 4, train time 4.02 s
Epoch 38/50 |loss: 0.138741| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 5, train time 3.91 s
Epoch 39/50 |loss: 0.138405| train set 1.790x speedup, test set 1.149x speedup, val set 0.437x speedup, step: 1, train time 3.91 s
Epoch 40/50 |loss: 0.138365| train set 1.776x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 41/50 |loss: 0.139173| train set 1.765x speedup, test set 1.032x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 42/50 |loss: 0.140032| train set 1.810x speedup, test set 0.993x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 43/50 |loss: 0.139865| train set 1.776x speedup, test set 1.134x speedup, val set 0.437x speedup, step: 5, train time 4.08 s
Epoch 44/50 |loss: 0.140215| train set 1.776x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
Epoch 45/50 |loss: 0.138315| train set 1.809x speedup, test set 1.037x speedup, val set 0.437x speedup, step: 2, train time 4.02 s
Epoch 46/50 |loss: 0.138782| train set 1.790x speedup, test set 1.132x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 47/50 |loss: 0.136435| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 48/50 |loss: 0.135534| train set 1.776x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 49/50 |loss: 0.136019| train set 1.791x speedup, test set 1.137x speedup, val set 0.437x speedup, step: 1, train time 4.07 s
Training per epoch cost 4.114 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 1.412s, pg runtime 3.645s, speedup 2.582x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 18, train speedup 1.810, test speedup 1.049, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.791, test speedup 1.137, val speedup 0.437
last model at epoch 49, train speedup 1.791, test speedup 1.137, val speedup 0.437
execution cost 0:03:56.271325
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.597254, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.26 s
Epoch 1/50 |loss: 0.229507| train set 1.414x speedup, test set 1.154x speedup, val set 0.477x speedup, step: 2, train time 4.29 s
Epoch 2/50 |loss: 0.204929| train set 1.791x speedup, test set 1.039x speedup, val set 0.296x speedup, step: 3, train time 3.98 s
Epoch 3/50 |loss: 0.190912| train set 1.776x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 4, train time 4.08 s
Epoch 4/50 |loss: 0.175306| train set 1.809x speedup, test set 0.901x speedup, val set 0.437x speedup, step: 1, train time 4.30 s
Epoch 5/50 |loss: 0.168155| train set 1.680x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 2, train time 3.91 s
Epoch 6/50 |loss: 0.168932| train set 1.733x speedup, test set 0.902x speedup, val set 0.437x speedup, step: 3, train time 4.13 s
Epoch 7/50 |loss: 0.164401| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 8/50 |loss: 0.157414| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 9/50 |loss: 0.153125| train set 1.663x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 10/50 |loss: 0.157807| train set 1.790x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 2, train time 4.12 s
Epoch 11/50 |loss: 0.155470| train set 1.790x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 3, train time 4.20 s
Epoch 12/50 |loss: 0.154550| train set 1.776x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 4, train time 4.04 s
Epoch 13/50 |loss: 0.150433| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 14/50 |loss: 0.149332| train set 1.810x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 1, train time 3.91 s
Epoch 15/50 |loss: 0.148295| train set 1.757x speedup, test set 0.896x speedup, val set 0.437x speedup, step: 2, train time 4.08 s
Epoch 16/50 |loss: 0.146777| train set 1.776x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 17/50 |loss: 0.148362| train set 1.810x speedup, test set 0.895x speedup, val set 0.437x speedup, step: 4, train time 4.02 s
Epoch 18/50 |loss: 0.143885| train set 1.696x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 19/50 |loss: 0.146851| train set 1.790x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 20/50 |loss: 0.145542| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 2, train time 3.93 s
Epoch 21/50 |loss: 0.145463| train set 1.809x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 3, train time 3.98 s
Epoch 22/50 |loss: 0.144285| train set 1.776x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 4, train time 3.93 s
Epoch 23/50 |loss: 0.144925| train set 1.776x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 24/50 |loss: 0.145489| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 1, train time 4.70 s
Epoch 25/50 |loss: 0.143275| train set 1.810x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 2, train time 4.20 s
Epoch 26/50 |loss: 0.144530| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 3, train time 3.93 s
Epoch 27/50 |loss: 0.141583| train set 1.757x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 28/50 |loss: 0.139776| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 29/50 |loss: 0.142129| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
Epoch 30/50 |loss: 0.140945| train set 1.790x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 2, train time 4.20 s
Epoch 31/50 |loss: 0.140613| train set 1.810x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 32/50 |loss: 0.139301| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 33/50 |loss: 0.140276| train set 1.775x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 34/50 |loss: 0.140668| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 1, train time 3.98 s
Epoch 35/50 |loss: 0.140875| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 2, train time 3.96 s
Epoch 36/50 |loss: 0.141379| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 37/50 |loss: 0.138755| train set 1.810x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 38/50 |loss: 0.138371| train set 1.810x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 5, train time 3.90 s
Epoch 39/50 |loss: 0.137835| train set 1.790x speedup, test set 1.138x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 40/50 |loss: 0.139597| train set 1.776x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 2, train time 3.99 s
Epoch 41/50 |loss: 0.138993| train set 1.765x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 3, train time 4.20 s
Epoch 42/50 |loss: 0.139980| train set 1.810x speedup, test set 1.129x speedup, val set 0.437x speedup, step: 4, train time 4.00 s
Epoch 43/50 |loss: 0.139744| train set 1.776x speedup, test set 1.132x speedup, val set 0.437x speedup, step: 5, train time 3.99 s
Epoch 44/50 |loss: 0.140915| train set 1.810x speedup, test set 1.172x speedup, val set 0.437x speedup, step: 1, train time 4.08 s
Epoch 45/50 |loss: 0.138696| train set 1.809x speedup, test set 1.032x speedup, val set 0.437x speedup, step: 2, train time 3.90 s
Epoch 46/50 |loss: 0.138794| train set 1.757x speedup, test set 1.172x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 47/50 |loss: 0.137021| train set 1.810x speedup, test set 1.032x speedup, val set 0.437x speedup, step: 4, train time 3.99 s
Epoch 48/50 |loss: 0.135282| train set 1.810x speedup, test set 1.140x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 49/50 |loss: 0.135628| train set 1.810x speedup, test set 1.131x speedup, val set 0.437x speedup, step: 1, train time 3.93 s
Training per epoch cost 4.105 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.487s, pg runtime 10.685s, speedup 0.930x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 28, train speedup 1.810, test speedup 1.044, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.131, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.131, val speedup 0.437
execution cost 0:03:56.584902
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.560906, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344966| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.37 s
Epoch 1/50 |loss: 0.230456| train set 1.428x speedup, test set 0.994x speedup, val set 0.477x speedup, step: 2, train time 4.20 s
Epoch 2/50 |loss: 0.205210| train set 1.791x speedup, test set 1.043x speedup, val set 0.296x speedup, step: 3, train time 4.01 s
Epoch 3/50 |loss: 0.190610| train set 1.776x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 4/50 |loss: 0.177034| train set 1.809x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 5/50 |loss: 0.170565| train set 1.775x speedup, test set 0.883x speedup, val set 0.437x speedup, step: 2, train time 4.11 s
Epoch 6/50 |loss: 0.166617| train set 1.776x speedup, test set 1.073x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 7/50 |loss: 0.164372| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 8/50 |loss: 0.158779| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 9/50 |loss: 0.152879| train set 1.789x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 1, train time 4.21 s
Epoch 10/50 |loss: 0.157045| train set 1.791x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 2, train time 4.12 s
Epoch 11/50 |loss: 0.154612| train set 1.679x speedup, test set 1.059x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 12/50 |loss: 0.154710| train set 1.776x speedup, test set 1.060x speedup, val set 0.437x speedup, step: 4, train time 4.02 s
Epoch 13/50 |loss: 0.151302| train set 1.790x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 5, train time 4.00 s
Epoch 14/50 |loss: 0.149279| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 1, train time 3.91 s
Epoch 15/50 |loss: 0.149099| train set 1.776x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 2, train time 3.96 s
Epoch 16/50 |loss: 0.147146| train set 1.776x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 3, train time 3.90 s
Epoch 17/50 |loss: 0.147743| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 18/50 |loss: 0.145168| train set 1.696x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.04 s
Epoch 19/50 |loss: 0.147475| train set 1.790x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 20/50 |loss: 0.145511| train set 1.810x speedup, test set 1.019x speedup, val set 0.437x speedup, step: 2, train time 4.12 s
Epoch 21/50 |loss: 0.145885| train set 1.775x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.20 s
Epoch 22/50 |loss: 0.145013| train set 1.775x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 4, train time 3.99 s
Epoch 23/50 |loss: 0.146425| train set 1.776x speedup, test set 1.077x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 24/50 |loss: 0.145636| train set 1.810x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 1, train time 4.59 s
Epoch 25/50 |loss: 0.144022| train set 1.810x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 2, train time 3.96 s
Epoch 26/50 |loss: 0.144821| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 27/50 |loss: 0.141838| train set 1.776x speedup, test set 1.142x speedup, val set 0.437x speedup, step: 4, train time 4.18 s
Epoch 28/50 |loss: 0.140955| train set 1.810x speedup, test set 1.128x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 29/50 |loss: 0.143260| train set 1.809x speedup, test set 1.142x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 30/50 |loss: 0.141860| train set 1.790x speedup, test set 0.881x speedup, val set 0.437x speedup, step: 2, train time 3.91 s
Epoch 31/50 |loss: 0.140851| train set 1.775x speedup, test set 0.941x speedup, val set 0.437x speedup, step: 3, train time 4.02 s
Epoch 32/50 |loss: 0.140901| train set 1.810x speedup, test set 1.149x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 33/50 |loss: 0.140135| train set 1.775x speedup, test set 1.118x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 34/50 |loss: 0.141031| train set 1.810x speedup, test set 1.114x speedup, val set 0.437x speedup, step: 1, train time 4.10 s
Epoch 35/50 |loss: 0.140430| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 36/50 |loss: 0.140937| train set 1.810x speedup, test set 1.121x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 37/50 |loss: 0.139456| train set 1.810x speedup, test set 1.105x speedup, val set 0.437x speedup, step: 4, train time 4.30 s
Epoch 38/50 |loss: 0.138943| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 39/50 |loss: 0.137249| train set 1.790x speedup, test set 1.140x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 40/50 |loss: 0.139703| train set 1.776x speedup, test set 1.103x speedup, val set 0.437x speedup, step: 2, train time 4.02 s
Epoch 41/50 |loss: 0.138210| train set 1.810x speedup, test set 1.185x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 42/50 |loss: 0.140398| train set 1.810x speedup, test set 1.140x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 43/50 |loss: 0.140418| train set 1.776x speedup, test set 1.180x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 44/50 |loss: 0.141249| train set 1.810x speedup, test set 1.185x speedup, val set 0.437x speedup, step: 1, train time 3.98 s
Epoch 45/50 |loss: 0.139540| train set 1.809x speedup, test set 1.142x speedup, val set 0.437x speedup, step: 2, train time 4.11 s
Epoch 46/50 |loss: 0.138787| train set 1.791x speedup, test set 1.173x speedup, val set 0.437x speedup, step: 3, train time 4.09 s
Epoch 47/50 |loss: 0.137630| train set 1.810x speedup, test set 1.138x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 48/50 |loss: 0.135174| train set 1.776x speedup, test set 1.180x speedup, val set 0.437x speedup, step: 5, train time 4.09 s
Epoch 49/50 |loss: 0.137186| train set 1.810x speedup, test set 1.179x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Training per epoch cost 4.134 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 1.412s, pg runtime 3.645s, speedup 2.582x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 25, train speedup 1.810, test speedup 1.065, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.179, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.179, val speedup 0.437
execution cost 0:03:57.691085
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.611486, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 6.12 s
Epoch 1/50 |loss: 0.229272| train set 1.655x speedup, test set 1.075x speedup, val set 0.477x speedup, step: 2, train time 4.20 s
Epoch 2/50 |loss: 0.201797| train set 1.790x speedup, test set 1.001x speedup, val set 0.296x speedup, step: 3, train time 4.39 s
Epoch 3/50 |loss: 0.189919| train set 1.517x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 4, train time 3.92 s
Epoch 4/50 |loss: 0.175071| train set 1.809x speedup, test set 0.902x speedup, val set 0.437x speedup, step: 1, train time 4.14 s
Epoch 5/50 |loss: 0.171789| train set 1.775x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 2, train time 4.12 s
Epoch 6/50 |loss: 0.166242| train set 1.734x speedup, test set 0.893x speedup, val set 0.437x speedup, step: 3, train time 4.29 s
Epoch 7/50 |loss: 0.164535| train set 1.776x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 4.49 s
Epoch 8/50 |loss: 0.156413| train set 1.757x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 9/50 |loss: 0.153696| train set 1.790x speedup, test set 0.896x speedup, val set 0.437x speedup, step: 1, train time 4.28 s
Epoch 10/50 |loss: 0.156864| train set 1.791x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 2, train time 4.11 s
Epoch 11/50 |loss: 0.154411| train set 1.790x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 3, train time 4.30 s
Epoch 12/50 |loss: 0.153545| train set 1.776x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 13/50 |loss: 0.150216| train set 1.790x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 5, train time 4.19 s
Epoch 14/50 |loss: 0.149707| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 1, train time 4.31 s
Epoch 15/50 |loss: 0.148310| train set 1.757x speedup, test set 0.892x speedup, val set 0.437x speedup, step: 2, train time 4.60 s
Epoch 16/50 |loss: 0.147782| train set 1.810x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 17/50 |loss: 0.147313| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 4, train time 4.21 s
Epoch 18/50 |loss: 0.144708| train set 1.696x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.32 s
Epoch 19/50 |loss: 0.147559| train set 1.790x speedup, test set 0.883x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 20/50 |loss: 0.145291| train set 1.776x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 2, train time 4.38 s
Epoch 21/50 |loss: 0.145920| train set 1.775x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 3, train time 4.30 s
Epoch 22/50 |loss: 0.145005| train set 1.776x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 23/50 |loss: 0.144914| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 24/50 |loss: 0.145517| train set 1.810x speedup, test set 0.890x speedup, val set 0.437x speedup, step: 1, train time 4.81 s
Epoch 25/50 |loss: 0.143747| train set 1.810x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 2, train time 4.07 s
Epoch 26/50 |loss: 0.144011| train set 1.810x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 3, train time 4.38 s
Epoch 27/50 |loss: 0.141469| train set 1.757x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 4, train time 4.14 s
Epoch 28/50 |loss: 0.139916| train set 1.810x speedup, test set 1.066x speedup, val set 0.795x speedup, step: 5, train time 4.11 s
Epoch 29/50 |loss: 0.142389| train set 1.810x speedup, test set 1.107x speedup, val set 0.437x speedup, step: 1, train time 4.29 s
Epoch 30/50 |loss: 0.141422| train set 1.757x speedup, test set 0.879x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 31/50 |loss: 0.140145| train set 1.775x speedup, test set 0.879x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 32/50 |loss: 0.139323| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 4, train time 4.40 s
Epoch 33/50 |loss: 0.140105| train set 1.775x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 5, train time 4.19 s
Epoch 34/50 |loss: 0.141095| train set 1.810x speedup, test set 1.018x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 35/50 |loss: 0.140331| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 36/50 |loss: 0.140295| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 3, train time 4.39 s
Epoch 37/50 |loss: 0.138304| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 4, train time 4.41 s
Epoch 38/50 |loss: 0.139431| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 39/50 |loss: 0.137822| train set 1.790x speedup, test set 1.111x speedup, val set 0.437x speedup, step: 1, train time 4.40 s
Epoch 40/50 |loss: 0.139471| train set 1.776x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 41/50 |loss: 0.138654| train set 1.765x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 3, train time 4.28 s
Epoch 42/50 |loss: 0.139450| train set 1.810x speedup, test set 0.986x speedup, val set 0.437x speedup, step: 4, train time 4.18 s
Epoch 43/50 |loss: 0.140402| train set 1.776x speedup, test set 1.062x speedup, val set 0.437x speedup, step: 5, train time 4.31 s
Epoch 44/50 |loss: 0.140599| train set 1.776x speedup, test set 1.113x speedup, val set 0.437x speedup, step: 1, train time 4.69 s
early stopping at epoch 44
Training per epoch cost 4.301 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 42, train speedup 1.810, test speedup 0.986, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 44, train speedup 1.776, test speedup 1.113, val speedup 0.437
last model at epoch 44, train speedup 1.776, test speedup 1.113, val speedup 0.437
execution cost 0:03:44.028735
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.561969, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.39 s
Epoch 1/50 |loss: 0.229012| train set 1.546x speedup, test set 1.061x speedup, val set 0.477x speedup, step: 2, train time 4.13 s
Epoch 2/50 |loss: 0.202030| train set 1.663x speedup, test set 1.002x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 3/50 |loss: 0.191965| train set 1.776x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 4, train time 4.29 s
Epoch 4/50 |loss: 0.176530| train set 1.810x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 5/50 |loss: 0.169168| train set 1.680x speedup, test set 0.886x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 6/50 |loss: 0.165436| train set 1.734x speedup, test set 0.903x speedup, val set 0.437x speedup, step: 3, train time 4.53 s
Epoch 7/50 |loss: 0.163243| train set 1.810x speedup, test set 0.892x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 8/50 |loss: 0.158384| train set 1.791x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 5, train time 4.52 s
Epoch 9/50 |loss: 0.154714| train set 1.663x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 1, train time 4.21 s
Epoch 10/50 |loss: 0.157461| train set 1.791x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 2, train time 4.20 s
Epoch 11/50 |loss: 0.155354| train set 1.790x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 12/50 |loss: 0.154176| train set 1.776x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 4, train time 4.21 s
Epoch 13/50 |loss: 0.150239| train set 1.810x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 5, train time 4.48 s
Epoch 14/50 |loss: 0.149900| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 1, train time 4.40 s
Epoch 15/50 |loss: 0.148577| train set 1.776x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 2, train time 4.59 s
Epoch 16/50 |loss: 0.146426| train set 1.776x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.22 s
Epoch 17/50 |loss: 0.148135| train set 1.810x speedup, test set 0.894x speedup, val set 0.437x speedup, step: 4, train time 4.22 s
Epoch 18/50 |loss: 0.143610| train set 1.696x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 5, train time 4.31 s
Epoch 19/50 |loss: 0.146953| train set 1.790x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 1, train time 4.13 s
Epoch 20/50 |loss: 0.146067| train set 1.810x speedup, test set 1.125x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 21/50 |loss: 0.145965| train set 1.775x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 3, train time 4.31 s
Epoch 22/50 |loss: 0.144556| train set 1.776x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 23/50 |loss: 0.144186| train set 1.809x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 5, train time 4.60 s
Epoch 24/50 |loss: 0.145084| train set 1.810x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 1, train time 4.84 s
Epoch 25/50 |loss: 0.143847| train set 1.810x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 2, train time 4.20 s
Epoch 26/50 |loss: 0.144989| train set 1.810x speedup, test set 1.054x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 27/50 |loss: 0.142753| train set 1.776x speedup, test set 1.109x speedup, val set 0.437x speedup, step: 4, train time 4.01 s
Epoch 28/50 |loss: 0.139749| train set 1.810x speedup, test set 1.093x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 29/50 |loss: 0.142982| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 30/50 |loss: 0.142675| train set 1.810x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 2, train time 4.42 s
Epoch 31/50 |loss: 0.141413| train set 1.775x speedup, test set 0.893x speedup, val set 0.437x speedup, step: 3, train time 4.52 s
Epoch 32/50 |loss: 0.139520| train set 1.810x speedup, test set 1.152x speedup, val set 0.437x speedup, step: 4, train time 4.38 s
Epoch 33/50 |loss: 0.139760| train set 1.775x speedup, test set 1.144x speedup, val set 0.437x speedup, step: 5, train time 4.78 s
Epoch 34/50 |loss: 0.140660| train set 1.810x speedup, test set 1.108x speedup, val set 0.437x speedup, step: 1, train time 4.71 s
Epoch 35/50 |loss: 0.139940| train set 1.810x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 2, train time 4.39 s
Epoch 36/50 |loss: 0.141835| train set 1.810x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 3, train time 4.48 s
Epoch 37/50 |loss: 0.138415| train set 1.810x speedup, test set 1.190x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 38/50 |loss: 0.138725| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 5, train time 4.63 s
Epoch 39/50 |loss: 0.137724| train set 1.810x speedup, test set 1.139x speedup, val set 0.437x speedup, step: 1, train time 3.99 s
Epoch 40/50 |loss: 0.139597| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 2, train time 4.31 s
Epoch 41/50 |loss: 0.138043| train set 1.765x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 3, train time 4.25 s
Epoch 42/50 |loss: 0.139604| train set 1.810x speedup, test set 1.113x speedup, val set 0.437x speedup, step: 4, train time 4.42 s
Epoch 43/50 |loss: 0.140425| train set 1.776x speedup, test set 1.221x speedup, val set 0.437x speedup, step: 5, train time 4.39 s
Epoch 44/50 |loss: 0.140583| train set 1.776x speedup, test set 1.161x speedup, val set 0.437x speedup, step: 1, train time 4.59 s
early stopping at epoch 44
Training per epoch cost 4.352 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.487s, pg runtime 10.685s, speedup 0.930x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 29, train speedup 1.810, test speedup 1.052, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 44, train speedup 1.776, test speedup 1.161, val speedup 0.437
last model at epoch 44, train speedup 1.776, test speedup 1.161, val speedup 0.437
execution cost 0:03:46.668669
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.558139, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.59 s
Epoch 1/50 |loss: 0.229233| train set 1.655x speedup, test set 1.016x speedup, val set 0.477x speedup, step: 2, train time 4.18 s
Epoch 2/50 |loss: 0.203326| train set 1.790x speedup, test set 1.016x speedup, val set 0.437x speedup, step: 3, train time 4.39 s
Epoch 3/50 |loss: 0.190809| train set 1.776x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 4, train time 4.50 s
Epoch 4/50 |loss: 0.177170| train set 1.775x speedup, test set 0.902x speedup, val set 0.437x speedup, step: 1, train time 4.53 s
Epoch 5/50 |loss: 0.170307| train set 1.775x speedup, test set 0.895x speedup, val set 0.437x speedup, step: 2, train time 4.22 s
Epoch 6/50 |loss: 0.167247| train set 1.775x speedup, test set 0.904x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 7/50 |loss: 0.164557| train set 1.711x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 4, train time 4.21 s
Epoch 8/50 |loss: 0.157283| train set 1.757x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.01 s
Epoch 9/50 |loss: 0.154762| train set 1.662x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 10/50 |loss: 0.156689| train set 1.791x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 11/50 |loss: 0.154307| train set 1.679x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 3, train time 4.38 s
Epoch 12/50 |loss: 0.154687| train set 1.776x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 4, train time 4.44 s
Epoch 13/50 |loss: 0.150925| train set 1.810x speedup, test set 0.859x speedup, val set 0.437x speedup, step: 5, train time 4.40 s
Epoch 14/50 |loss: 0.150955| train set 1.810x speedup, test set 1.045x speedup, val set 0.296x speedup, step: 6, train time 4.21 s
Epoch 15/50 |loss: 0.148914| train set 1.757x speedup, test set 0.894x speedup, val set 0.437x speedup, step: 7, train time 4.39 s
Epoch 16/50 |loss: 0.146934| train set 1.776x speedup, test set 1.075x speedup, val set 0.437x speedup, step: 8, train time 4.51 s
Epoch 17/50 |loss: 0.148091| train set 1.711x speedup, test set 0.886x speedup, val set 0.437x speedup, step: 9, train time 4.67 s
Epoch 18/50 |loss: 0.145177| train set 1.696x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 10, train time 4.38 s
Epoch 19/50 |loss: 0.147920| train set 1.790x speedup, test set 0.877x speedup, val set 0.437x speedup, step: 1, train time 4.30 s
Epoch 20/50 |loss: 0.146261| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 2, train time 4.07 s
Epoch 21/50 |loss: 0.146895| train set 1.775x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 3, train time 4.38 s
Epoch 22/50 |loss: 0.144772| train set 1.775x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 23/50 |loss: 0.145224| train set 1.775x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 5, train time 4.19 s
Epoch 24/50 |loss: 0.145678| train set 1.810x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 1, train time 4.13 s
Epoch 25/50 |loss: 0.144785| train set 1.810x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 2, train time 4.39 s
Epoch 26/50 |loss: 0.145454| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 3, train time 4.51 s
Epoch 27/50 |loss: 0.142134| train set 1.776x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 4, train time 4.13 s
Epoch 28/50 |loss: 0.139917| train set 1.810x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 5, train time 4.02 s
Epoch 29/50 |loss: 0.143137| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 1, train time 4.60 s
Epoch 30/50 |loss: 0.142882| train set 1.790x speedup, test set 0.887x speedup, val set 0.437x speedup, step: 2, train time 4.20 s
Epoch 31/50 |loss: 0.141995| train set 1.776x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 3, train time 4.49 s
Epoch 32/50 |loss: 0.140258| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 4, train time 4.38 s
Epoch 33/50 |loss: 0.140446| train set 1.775x speedup, test set 1.119x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 34/50 |loss: 0.140721| train set 1.776x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 1, train time 4.50 s
Epoch 35/50 |loss: 0.140761| train set 1.810x speedup, test set 1.017x speedup, val set 0.437x speedup, step: 2, train time 4.30 s
Epoch 36/50 |loss: 0.142177| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 3, train time 4.38 s
Epoch 37/50 |loss: 0.138691| train set 1.810x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 4, train time 4.30 s
Epoch 38/50 |loss: 0.138871| train set 1.810x speedup, test set 1.019x speedup, val set 0.437x speedup, step: 5, train time 4.33 s
Epoch 39/50 |loss: 0.137873| train set 1.790x speedup, test set 0.992x speedup, val set 0.437x speedup, step: 1, train time 4.31 s
Epoch 40/50 |loss: 0.139722| train set 1.776x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 41/50 |loss: 0.139025| train set 1.765x speedup, test set 1.089x speedup, val set 0.437x speedup, step: 3, train time 4.23 s
Epoch 42/50 |loss: 0.140116| train set 1.810x speedup, test set 0.992x speedup, val set 0.437x speedup, step: 4, train time 4.89 s
Epoch 43/50 |loss: 0.140705| train set 1.776x speedup, test set 1.149x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 44/50 |loss: 0.140888| train set 1.810x speedup, test set 1.190x speedup, val set 0.437x speedup, step: 1, train time 4.40 s
Epoch 45/50 |loss: 0.139084| train set 1.809x speedup, test set 1.114x speedup, val set 0.437x speedup, step: 2, train time 4.12 s
Epoch 46/50 |loss: 0.139365| train set 1.757x speedup, test set 1.208x speedup, val set 0.437x speedup, step: 3, train time 4.38 s
early stopping at epoch 46
Training per epoch cost 4.343 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 42, train speedup 1.810, test speedup 0.992, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 44, train speedup 1.810, test speedup 1.190, val speedup 0.437
last model at epoch 46, train speedup 1.757, test speedup 1.208, val speedup 0.437
execution cost 0:03:55.669032
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.577546, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.68 s
Epoch 1/50 |loss: 0.229626| train set 1.694x speedup, test set 1.204x speedup, val set 0.477x speedup, step: 2, train time 4.20 s
Epoch 2/50 |loss: 0.203134| train set 1.790x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 3, train time 4.12 s
Epoch 3/50 |loss: 0.191193| train set 1.776x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 4/50 |loss: 0.177597| train set 1.775x speedup, test set 0.901x speedup, val set 0.437x speedup, step: 1, train time 4.03 s
Epoch 5/50 |loss: 0.168688| train set 1.680x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 6/50 |loss: 0.166600| train set 1.734x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 3, train time 4.20 s
Epoch 7/50 |loss: 0.164153| train set 1.776x speedup, test set 0.890x speedup, val set 0.437x speedup, step: 4, train time 4.22 s
Epoch 8/50 |loss: 0.157959| train set 1.810x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 5, train time 4.31 s
Epoch 9/50 |loss: 0.154683| train set 1.790x speedup, test set 0.857x speedup, val set 0.437x speedup, step: 1, train time 4.31 s
Epoch 10/50 |loss: 0.157893| train set 1.791x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 4.31 s
Epoch 11/50 |loss: 0.153748| train set 1.790x speedup, test set 0.874x speedup, val set 0.437x speedup, step: 3, train time 4.23 s
Epoch 12/50 |loss: 0.155057| train set 1.776x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 13/50 |loss: 0.150996| train set 1.810x speedup, test set 0.838x speedup, val set 0.437x speedup, step: 5, train time 4.62 s
Epoch 14/50 |loss: 0.149438| train set 1.810x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 15/50 |loss: 0.149036| train set 1.776x speedup, test set 0.876x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 16/50 |loss: 0.146893| train set 1.776x speedup, test set 1.058x speedup, val set 0.437x speedup, step: 3, train time 4.31 s
Epoch 17/50 |loss: 0.148231| train set 1.810x speedup, test set 0.880x speedup, val set 0.437x speedup, step: 4, train time 4.62 s
Epoch 18/50 |loss: 0.143770| train set 1.696x speedup, test set 0.880x speedup, val set 0.437x speedup, step: 5, train time 4.45 s
Epoch 19/50 |loss: 0.146391| train set 1.790x speedup, test set 0.875x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 20/50 |loss: 0.144930| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 2, train time 4.49 s
Epoch 21/50 |loss: 0.145395| train set 1.775x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 3, train time 4.24 s
Epoch 22/50 |loss: 0.143900| train set 1.776x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 23/50 |loss: 0.145167| train set 1.809x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 5, train time 4.49 s
Epoch 24/50 |loss: 0.145392| train set 1.810x speedup, test set 0.879x speedup, val set 0.437x speedup, step: 1, train time 5.08 s
Epoch 25/50 |loss: 0.144461| train set 1.810x speedup, test set 0.874x speedup, val set 0.437x speedup, step: 2, train time 4.69 s
Epoch 26/50 |loss: 0.145496| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 27/50 |loss: 0.142133| train set 1.757x speedup, test set 0.946x speedup, val set 0.437x speedup, step: 4, train time 4.30 s
Epoch 28/50 |loss: 0.140125| train set 1.810x speedup, test set 1.117x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 29/50 |loss: 0.141934| train set 1.810x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1, train time 4.08 s
Epoch 30/50 |loss: 0.139925| train set 1.790x speedup, test set 0.877x speedup, val set 0.437x speedup, step: 2, train time 4.22 s
Epoch 31/50 |loss: 0.141708| train set 1.810x speedup, test set 0.889x speedup, val set 0.437x speedup, step: 3, train time 4.28 s
Epoch 32/50 |loss: 0.139392| train set 1.810x speedup, test set 0.950x speedup, val set 0.437x speedup, step: 4, train time 4.29 s
Epoch 33/50 |loss: 0.140304| train set 1.775x speedup, test set 0.883x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 34/50 |loss: 0.140817| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 35/50 |loss: 0.140112| train set 1.810x speedup, test set 0.876x speedup, val set 0.437x speedup, step: 2, train time 3.99 s
Epoch 36/50 |loss: 0.140797| train set 1.810x speedup, test set 0.879x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 37/50 |loss: 0.138665| train set 1.810x speedup, test set 1.102x speedup, val set 0.437x speedup, step: 4, train time 4.40 s
Epoch 38/50 |loss: 0.138457| train set 1.810x speedup, test set 0.881x speedup, val set 0.437x speedup, step: 5, train time 4.69 s
Epoch 39/50 |loss: 0.137345| train set 1.790x speedup, test set 1.074x speedup, val set 0.437x speedup, step: 1, train time 4.42 s
Epoch 40/50 |loss: 0.138680| train set 1.776x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 2, train time 4.12 s
Epoch 41/50 |loss: 0.138165| train set 1.765x speedup, test set 0.880x speedup, val set 0.437x speedup, step: 3, train time 4.32 s
Epoch 42/50 |loss: 0.138865| train set 1.810x speedup, test set 1.129x speedup, val set 0.437x speedup, step: 4, train time 4.38 s
Epoch 43/50 |loss: 0.139828| train set 1.776x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 5, train time 4.31 s
Epoch 44/50 |loss: 0.139406| train set 1.776x speedup, test set 1.147x speedup, val set 0.437x speedup, step: 1, train time 4.09 s
Epoch 45/50 |loss: 0.138567| train set 1.810x speedup, test set 0.837x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 46/50 |loss: 0.139292| train set 1.791x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 3, train time 4.49 s
Epoch 47/50 |loss: 0.136327| train set 1.810x speedup, test set 0.883x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 48/50 |loss: 0.135695| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 49/50 |loss: 0.136618| train set 1.810x speedup, test set 1.003x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Training per epoch cost 4.316 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
02, opt runtime 4.223s, model runtime 24.532s, pg runtime 18.741s, speedup 0.764x
03, opt runtime 1.763s, model runtime 2.314s, pg runtime 1.763s, speedup 0.762x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 13.370s, pg runtime 10.605s, speedup 0.793x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 1.128s, pg runtime 0.965s, speedup 0.856x
====================
best train speedup epoch: 8, train speedup 1.810, test speedup 1.051, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.003, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.003, val speedup 0.437
execution cost 0:04:07.998327
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.557642, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.87 s
Epoch 1/50 |loss: 0.229240| train set 1.428x speedup, test set 1.001x speedup, val set 0.477x speedup, step: 2, train time 4.49 s
Epoch 2/50 |loss: 0.203063| train set 1.791x speedup, test set 0.987x speedup, val set 0.296x speedup, step: 3, train time 4.19 s
Epoch 3/50 |loss: 0.189610| train set 1.776x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 4, train time 4.31 s
Epoch 4/50 |loss: 0.177096| train set 1.809x speedup, test set 0.903x speedup, val set 0.437x speedup, step: 1, train time 4.29 s
Epoch 5/50 |loss: 0.169938| train set 1.776x speedup, test set 0.892x speedup, val set 0.437x speedup, step: 2, train time 4.28 s
Epoch 6/50 |loss: 0.166449| train set 1.733x speedup, test set 0.903x speedup, val set 0.437x speedup, step: 3, train time 4.30 s
Epoch 7/50 |loss: 0.165465| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 8/50 |loss: 0.157371| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 5, train time 4.29 s
Epoch 9/50 |loss: 0.153721| train set 1.789x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 10/50 |loss: 0.156693| train set 1.791x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 2, train time 4.18 s
Epoch 11/50 |loss: 0.153755| train set 1.790x speedup, test set 1.060x speedup, val set 0.437x speedup, step: 3, train time 4.41 s
Epoch 12/50 |loss: 0.153577| train set 1.776x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 4, train time 3.99 s
Epoch 13/50 |loss: 0.150923| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.53 s
Epoch 14/50 |loss: 0.149123| train set 1.810x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 15/50 |loss: 0.148739| train set 1.757x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 2, train time 4.39 s
Epoch 16/50 |loss: 0.147208| train set 1.776x speedup, test set 1.070x speedup, val set 0.437x speedup, step: 3, train time 4.21 s
Epoch 17/50 |loss: 0.148156| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 4, train time 4.32 s
Epoch 18/50 |loss: 0.145026| train set 1.696x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 5, train time 4.13 s
Epoch 19/50 |loss: 0.147161| train set 1.790x speedup, test set 0.839x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 20/50 |loss: 0.145213| train set 1.810x speedup, test set 1.018x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 21/50 |loss: 0.145740| train set 1.775x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 3, train time 4.40 s
Epoch 22/50 |loss: 0.144162| train set 1.776x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 4, train time 4.21 s
Epoch 23/50 |loss: 0.144888| train set 1.776x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 24/50 |loss: 0.145884| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 1, train time 5.18 s
Epoch 25/50 |loss: 0.144435| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 2, train time 4.48 s
Epoch 26/50 |loss: 0.144923| train set 1.810x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 3, train time 4.21 s
Epoch 27/50 |loss: 0.140952| train set 1.776x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 4, train time 4.21 s
Epoch 28/50 |loss: 0.141145| train set 1.810x speedup, test set 1.108x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 29/50 |loss: 0.142411| train set 1.810x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 1, train time 4.69 s
Epoch 30/50 |loss: 0.140797| train set 1.790x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 2, train time 4.17 s
Epoch 31/50 |loss: 0.141272| train set 1.809x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 3, train time 4.30 s
Epoch 32/50 |loss: 0.139873| train set 1.810x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 33/50 |loss: 0.139974| train set 1.775x speedup, test set 1.142x speedup, val set 0.437x speedup, step: 5, train time 4.22 s
Epoch 34/50 |loss: 0.141146| train set 1.810x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 35/50 |loss: 0.140253| train set 1.810x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 2, train time 4.37 s
Epoch 36/50 |loss: 0.141392| train set 1.790x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 37/50 |loss: 0.139085| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 4, train time 4.18 s
Epoch 38/50 |loss: 0.139087| train set 1.810x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 39/50 |loss: 0.138251| train set 1.790x speedup, test set 1.136x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 40/50 |loss: 0.139307| train set 1.776x speedup, test set 1.140x speedup, val set 0.437x speedup, step: 2, train time 4.20 s
Epoch 41/50 |loss: 0.138535| train set 1.810x speedup, test set 1.140x speedup, val set 0.437x speedup, step: 3, train time 4.29 s
Epoch 42/50 |loss: 0.140082| train set 1.810x speedup, test set 1.080x speedup, val set 0.437x speedup, step: 4, train time 4.41 s
Epoch 43/50 |loss: 0.139975| train set 1.776x speedup, test set 1.198x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 44/50 |loss: 0.142085| train set 1.810x speedup, test set 1.180x speedup, val set 0.437x speedup, step: 1, train time 4.31 s
Epoch 45/50 |loss: 0.139986| train set 1.809x speedup, test set 1.079x speedup, val set 0.437x speedup, step: 2, train time 4.11 s
Epoch 46/50 |loss: 0.139849| train set 1.791x speedup, test set 1.169x speedup, val set 0.437x speedup, step: 3, train time 4.51 s
early stopping at epoch 46
Training per epoch cost 4.321 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.487s, pg runtime 10.685s, speedup 0.930x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.384s, pg runtime 0.332s, speedup 0.865x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 1.128s, pg runtime 0.965s, speedup 0.856x
====================
best train speedup epoch: 42, train speedup 1.810, test speedup 1.080, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 44, train speedup 1.810, test speedup 1.180, val speedup 0.437
last model at epoch 46, train speedup 1.791, test speedup 1.169, val speedup 0.437
execution cost 0:03:53.369047
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.582876, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 6.00 s
Epoch 1/50 |loss: 0.229276| train set 1.655x speedup, test set 1.075x speedup, val set 0.477x speedup, step: 2, train time 4.12 s
Epoch 2/50 |loss: 0.203690| train set 1.790x speedup, test set 0.993x speedup, val set 0.296x speedup, step: 3, train time 4.10 s
Epoch 3/50 |loss: 0.194824| train set 1.810x speedup, test set 1.075x speedup, val set 0.437x speedup, step: 4, train time 4.38 s
Epoch 4/50 |loss: 0.176959| train set 1.775x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 1, train time 4.21 s
Epoch 5/50 |loss: 0.170617| train set 1.776x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 6/50 |loss: 0.168205| train set 1.734x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 3, train time 4.12 s
Epoch 7/50 |loss: 0.163892| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 8/50 |loss: 0.157548| train set 1.810x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 5, train time 4.12 s
Epoch 9/50 |loss: 0.154108| train set 1.663x speedup, test set 1.023x speedup, val set 0.437x speedup, step: 1, train time 4.31 s
Epoch 10/50 |loss: 0.157151| train set 1.790x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 2, train time 3.92 s
Epoch 11/50 |loss: 0.153837| train set 1.790x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 12/50 |loss: 0.153108| train set 1.776x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 4, train time 4.40 s
Epoch 13/50 |loss: 0.150101| train set 1.790x speedup, test set 0.877x speedup, val set 0.437x speedup, step: 5, train time 4.18 s
Epoch 14/50 |loss: 0.148896| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 1, train time 4.28 s
Epoch 15/50 |loss: 0.149839| train set 1.810x speedup, test set 0.895x speedup, val set 0.437x speedup, step: 2, train time 4.39 s
Epoch 16/50 |loss: 0.146202| train set 1.776x speedup, test set 0.905x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 17/50 |loss: 0.147882| train set 1.810x speedup, test set 0.890x speedup, val set 0.437x speedup, step: 4, train time 4.50 s
Epoch 18/50 |loss: 0.144317| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 5, train time 4.20 s
Epoch 19/50 |loss: 0.147765| train set 1.790x speedup, test set 0.859x speedup, val set 0.437x speedup, step: 1, train time 4.29 s
Epoch 20/50 |loss: 0.145732| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 2, train time 4.18 s
Epoch 21/50 |loss: 0.146197| train set 1.775x speedup, test set 1.057x speedup, val set 0.437x speedup, step: 3, train time 4.29 s
Epoch 22/50 |loss: 0.143701| train set 1.776x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 4.28 s
Epoch 23/50 |loss: 0.144459| train set 1.809x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 5, train time 4.42 s
Epoch 24/50 |loss: 0.145710| train set 1.810x speedup, test set 0.889x speedup, val set 0.437x speedup, step: 1, train time 5.32 s
Epoch 25/50 |loss: 0.143069| train set 1.809x speedup, test set 0.889x speedup, val set 0.437x speedup, step: 2, train time 4.31 s
Epoch 26/50 |loss: 0.144225| train set 1.810x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 3, train time 4.39 s
Epoch 27/50 |loss: 0.141876| train set 1.757x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 4, train time 4.60 s
Epoch 28/50 |loss: 0.139961| train set 1.810x speedup, test set 1.098x speedup, val set 0.437x speedup, step: 5, train time 4.19 s
Epoch 29/50 |loss: 0.142447| train set 1.810x speedup, test set 1.088x speedup, val set 0.437x speedup, step: 1, train time 4.59 s
Epoch 30/50 |loss: 0.140988| train set 1.790x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 2, train time 4.16 s
Epoch 31/50 |loss: 0.140979| train set 1.776x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 3, train time 4.50 s
Epoch 32/50 |loss: 0.139247| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 4, train time 4.49 s
Epoch 33/50 |loss: 0.139979| train set 1.775x speedup, test set 1.088x speedup, val set 0.437x speedup, step: 5, train time 4.42 s
Epoch 34/50 |loss: 0.140348| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 1, train time 3.93 s
Epoch 35/50 |loss: 0.140271| train set 1.810x speedup, test set 1.077x speedup, val set 0.437x speedup, step: 2, train time 4.78 s
Epoch 36/50 |loss: 0.142512| train set 1.810x speedup, test set 1.077x speedup, val set 0.437x speedup, step: 3, train time 4.21 s
Epoch 37/50 |loss: 0.138955| train set 1.810x speedup, test set 1.084x speedup, val set 0.437x speedup, step: 4, train time 4.39 s
Epoch 38/50 |loss: 0.139428| train set 1.790x speedup, test set 1.074x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 39/50 |loss: 0.137691| train set 1.790x speedup, test set 1.177x speedup, val set 0.437x speedup, step: 1, train time 4.49 s
Epoch 40/50 |loss: 0.138775| train set 1.776x speedup, test set 1.081x speedup, val set 0.437x speedup, step: 2, train time 4.21 s
Epoch 41/50 |loss: 0.138166| train set 1.765x speedup, test set 1.076x speedup, val set 0.437x speedup, step: 3, train time 4.12 s
Epoch 42/50 |loss: 0.139362| train set 1.810x speedup, test set 1.181x speedup, val set 0.437x speedup, step: 4, train time 4.69 s
Epoch 43/50 |loss: 0.139722| train set 1.776x speedup, test set 1.242x speedup, val set 0.437x speedup, step: 5, train time 4.51 s
Epoch 44/50 |loss: 0.139473| train set 1.776x speedup, test set 1.265x speedup, val set 0.437x speedup, step: 1, train time 4.30 s
Epoch 45/50 |loss: 0.139926| train set 1.758x speedup, test set 1.112x speedup, val set 0.437x speedup, step: 2, train time 4.37 s
Epoch 46/50 |loss: 0.139685| train set 1.757x speedup, test set 1.318x speedup, val set 0.437x speedup, step: 3, train time 4.57 s
early stopping at epoch 46
Training per epoch cost 4.362 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 3, train speedup 1.810, test speedup 1.075, val speedup 0.437
best test speedup epoch: 46, train speedup 1.757, test speedup 1.318, val speedup 0.437
best validation speedup epoch: 44, train speedup 1.776, test speedup 1.265, val speedup 0.437
last model at epoch 46, train speedup 1.757, test speedup 1.318, val speedup 0.437
execution cost 0:03:56.135878
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.598713, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.345791| train set 1.762x speedup, test set 1.176x speedup, val set 0.477x speedup, step: 1, train time 5.39 s
Epoch 1/50 |loss: 0.228673| train set 1.790x speedup, test set 1.001x speedup, val set 0.296x speedup, step: 2, train time 4.39 s
Epoch 2/50 |loss: 0.202105| train set 1.790x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 3, train time 4.14 s
Epoch 3/50 |loss: 0.187592| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 4, train time 4.31 s
Epoch 4/50 |loss: 0.174552| train set 1.809x speedup, test set 1.035x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 5/50 |loss: 0.168900| train set 1.680x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 6/50 |loss: 0.164008| train set 1.776x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.18 s
Epoch 7/50 |loss: 0.163382| train set 1.810x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 4, train time 4.18 s
Epoch 8/50 |loss: 0.155254| train set 1.790x speedup, test set 1.075x speedup, val set 0.437x speedup, step: 5, train time 4.38 s
Epoch 9/50 |loss: 0.152236| train set 1.680x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 1, train time 4.21 s
Epoch 10/50 |loss: 0.155956| train set 1.790x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 11/50 |loss: 0.153078| train set 1.679x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 3, train time 4.30 s
Epoch 12/50 |loss: 0.153330| train set 1.776x speedup, test set 1.074x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 13/50 |loss: 0.149115| train set 1.810x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 14/50 |loss: 0.148845| train set 1.810x speedup, test set 1.053x speedup, val set 0.437x speedup, step: 1, train time 4.50 s
Epoch 15/50 |loss: 0.147225| train set 1.776x speedup, test set 1.077x speedup, val set 0.437x speedup, step: 2, train time 4.30 s
Epoch 16/50 |loss: 0.145322| train set 1.776x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 3, train time 4.40 s
Epoch 17/50 |loss: 0.146174| train set 1.810x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 4, train time 4.61 s
Epoch 18/50 |loss: 0.142655| train set 1.810x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 5, train time 4.29 s
Epoch 19/50 |loss: 0.146275| train set 1.790x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 1, train time 4.31 s
Epoch 20/50 |loss: 0.144370| train set 1.810x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 2, train time 4.43 s
Epoch 21/50 |loss: 0.145016| train set 1.775x speedup, test set 1.077x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 22/50 |loss: 0.142547| train set 1.776x speedup, test set 1.077x speedup, val set 0.437x speedup, step: 4, train time 4.40 s
Epoch 23/50 |loss: 0.143077| train set 1.809x speedup, test set 1.078x speedup, val set 0.437x speedup, step: 5, train time 4.11 s
Epoch 24/50 |loss: 0.144155| train set 1.810x speedup, test set 1.070x speedup, val set 0.437x speedup, step: 1, train time 5.81 s
Epoch 25/50 |loss: 0.142104| train set 1.810x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 2, train time 4.21 s
Epoch 26/50 |loss: 0.144438| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 27/50 |loss: 0.140540| train set 1.776x speedup, test set 1.073x speedup, val set 0.437x speedup, step: 4, train time 4.10 s
Epoch 28/50 |loss: 0.139353| train set 1.810x speedup, test set 1.129x speedup, val set 0.437x speedup, step: 5, train time 4.49 s
Epoch 29/50 |loss: 0.141171| train set 1.810x speedup, test set 1.133x speedup, val set 0.437x speedup, step: 1, train time 4.29 s
Epoch 30/50 |loss: 0.139344| train set 1.810x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 31/50 |loss: 0.140614| train set 1.775x speedup, test set 1.074x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 32/50 |loss: 0.138894| train set 1.810x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 4, train time 4.22 s
Epoch 33/50 |loss: 0.139900| train set 1.775x speedup, test set 1.062x speedup, val set 0.437x speedup, step: 5, train time 4.50 s
Epoch 34/50 |loss: 0.140395| train set 1.810x speedup, test set 1.018x speedup, val set 0.437x speedup, step: 1, train time 4.21 s
Epoch 35/50 |loss: 0.139471| train set 1.810x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 2, train time 4.89 s
Epoch 36/50 |loss: 0.140227| train set 1.810x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 3, train time 4.40 s
Epoch 37/50 |loss: 0.138165| train set 1.810x speedup, test set 1.133x speedup, val set 0.437x speedup, step: 4, train time 4.30 s
Epoch 38/50 |loss: 0.138228| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 5, train time 4.13 s
Epoch 39/50 |loss: 0.137179| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 1, train time 4.48 s
Epoch 40/50 |loss: 0.138090| train set 1.776x speedup, test set 1.062x speedup, val set 0.437x speedup, step: 2, train time 4.33 s
Epoch 41/50 |loss: 0.138427| train set 1.810x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 3, train time 4.40 s
Epoch 42/50 |loss: 0.139237| train set 1.810x speedup, test set 1.019x speedup, val set 0.437x speedup, step: 4, train time 4.53 s
Epoch 43/50 |loss: 0.139412| train set 1.776x speedup, test set 1.064x speedup, val set 0.437x speedup, step: 5, train time 4.88 s
Epoch 44/50 |loss: 0.140344| train set 1.810x speedup, test set 1.152x speedup, val set 0.437x speedup, step: 1, train time 4.38 s
Epoch 45/50 |loss: 0.139057| train set 1.790x speedup, test set 1.133x speedup, val set 0.437x speedup, step: 2, train time 4.23 s
Epoch 46/50 |loss: 0.138245| train set 1.790x speedup, test set 1.246x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
early stopping at epoch 46
Training per epoch cost 4.358 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 35, train speedup 1.810, test speedup 1.061, val speedup 0.437
best test speedup epoch: 46, train speedup 1.790, test speedup 1.246, val speedup 0.437
best validation speedup epoch: 44, train speedup 1.810, test speedup 1.152, val speedup 0.437
last model at epoch 46, train speedup 1.790, test speedup 1.246, val speedup 0.437
execution cost 0:03:56.793959
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.571862, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.52 s
Epoch 1/50 |loss: 0.229276| train set 1.655x speedup, test set 1.075x speedup, val set 0.477x speedup, step: 2, train time 4.18 s
Epoch 2/50 |loss: 0.202218| train set 1.663x speedup, test set 0.991x speedup, val set 0.296x speedup, step: 3, train time 4.03 s
Epoch 3/50 |loss: 0.192742| train set 1.776x speedup, test set 1.072x speedup, val set 0.437x speedup, step: 4, train time 4.48 s
Epoch 4/50 |loss: 0.178237| train set 1.809x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 1, train time 4.28 s
Epoch 5/50 |loss: 0.172429| train set 1.775x speedup, test set 0.885x speedup, val set 0.437x speedup, step: 2, train time 4.17 s
Epoch 6/50 |loss: 0.167886| train set 1.734x speedup, test set 0.893x speedup, val set 0.437x speedup, step: 3, train time 4.08 s
Epoch 7/50 |loss: 0.163543| train set 1.810x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 4, train time 4.13 s
Epoch 8/50 |loss: 0.157503| train set 1.791x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 5, train time 4.00 s
Epoch 9/50 |loss: 0.153672| train set 1.790x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 1, train time 4.13 s
Epoch 10/50 |loss: 0.156568| train set 1.791x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 2, train time 4.50 s
Epoch 11/50 |loss: 0.154118| train set 1.790x speedup, test set 1.061x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 12/50 |loss: 0.153383| train set 1.776x speedup, test set 1.043x speedup, val set 0.437x speedup, step: 4, train time 4.30 s
Epoch 13/50 |loss: 0.151685| train set 1.810x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.18 s
Epoch 14/50 |loss: 0.149567| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 1, train time 4.18 s
Epoch 15/50 |loss: 0.148681| train set 1.776x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 2, train time 4.08 s
Epoch 16/50 |loss: 0.146751| train set 1.776x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 3, train time 4.01 s
Epoch 17/50 |loss: 0.147102| train set 1.810x speedup, test set 1.051x speedup, val set 0.437x speedup, step: 4, train time 4.02 s
Epoch 18/50 |loss: 0.143978| train set 1.810x speedup, test set 1.041x speedup, val set 0.437x speedup, step: 5, train time 4.58 s
Epoch 19/50 |loss: 0.146758| train set 1.790x speedup, test set 1.017x speedup, val set 0.437x speedup, step: 1, train time 4.32 s
Epoch 20/50 |loss: 0.145186| train set 1.810x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 2, train time 4.30 s
Epoch 21/50 |loss: 0.146214| train set 1.775x speedup, test set 1.042x speedup, val set 0.437x speedup, step: 3, train time 4.28 s
Epoch 22/50 |loss: 0.144727| train set 1.776x speedup, test set 1.117x speedup, val set 0.437x speedup, step: 4, train time 4.09 s
Epoch 23/50 |loss: 0.145719| train set 1.776x speedup, test set 1.068x speedup, val set 0.437x speedup, step: 5, train time 4.44 s
Epoch 24/50 |loss: 0.145023| train set 1.810x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 1, train time 4.99 s
Epoch 25/50 |loss: 0.143540| train set 1.711x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 26/50 |loss: 0.144475| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 3, train time 4.32 s
Epoch 27/50 |loss: 0.141720| train set 1.757x speedup, test set 1.111x speedup, val set 0.437x speedup, step: 4, train time 4.42 s
Epoch 28/50 |loss: 0.140399| train set 1.810x speedup, test set 1.110x speedup, val set 0.437x speedup, step: 5, train time 4.39 s
Epoch 29/50 |loss: 0.143120| train set 1.810x speedup, test set 1.117x speedup, val set 0.437x speedup, step: 1, train time 4.13 s
Epoch 30/50 |loss: 0.141764| train set 1.790x speedup, test set 1.038x speedup, val set 0.437x speedup, step: 2, train time 4.21 s
Epoch 31/50 |loss: 0.141821| train set 1.810x speedup, test set 1.052x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 32/50 |loss: 0.140830| train set 1.810x speedup, test set 1.102x speedup, val set 0.437x speedup, step: 4, train time 4.22 s
Epoch 33/50 |loss: 0.140527| train set 1.775x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 5, train time 4.28 s
Epoch 34/50 |loss: 0.141153| train set 1.810x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 1, train time 4.39 s
Epoch 35/50 |loss: 0.140687| train set 1.810x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 2, train time 4.10 s
Epoch 36/50 |loss: 0.141807| train set 1.810x speedup, test set 1.105x speedup, val set 0.437x speedup, step: 3, train time 4.50 s
Epoch 37/50 |loss: 0.139183| train set 1.810x speedup, test set 1.028x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 38/50 |loss: 0.138682| train set 1.810x speedup, test set 1.103x speedup, val set 0.437x speedup, step: 5, train time 4.34 s
Epoch 39/50 |loss: 0.137985| train set 1.790x speedup, test set 1.133x speedup, val set 0.437x speedup, step: 1, train time 4.00 s
Epoch 40/50 |loss: 0.139907| train set 1.776x speedup, test set 1.040x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 41/50 |loss: 0.139254| train set 1.765x speedup, test set 1.110x speedup, val set 0.437x speedup, step: 3, train time 4.00 s
Epoch 42/50 |loss: 0.140941| train set 1.810x speedup, test set 1.136x speedup, val set 0.437x speedup, step: 4, train time 4.39 s
Epoch 43/50 |loss: 0.139955| train set 1.776x speedup, test set 1.192x speedup, val set 0.437x speedup, step: 5, train time 4.39 s
Epoch 44/50 |loss: 0.141280| train set 1.810x speedup, test set 1.144x speedup, val set 0.437x speedup, step: 1, train time 4.59 s
Epoch 45/50 |loss: 0.138800| train set 1.810x speedup, test set 1.100x speedup, val set 0.437x speedup, step: 2, train time 4.20 s
Epoch 46/50 |loss: 0.138988| train set 1.790x speedup, test set 1.218x speedup, val set 0.437x speedup, step: 3, train time 4.30 s
Epoch 47/50 |loss: 0.136970| train set 1.809x speedup, test set 1.158x speedup, val set 0.437x speedup, step: 4, train time 4.21 s
Epoch 48/50 |loss: 0.135544| train set 1.776x speedup, test set 1.132x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 49/50 |loss: 0.136957| train set 1.790x speedup, test set 1.155x speedup, val set 0.437x speedup, step: 1, train time 4.61 s
Training per epoch cost 4.286 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 13.370s, pg runtime 10.605s, speedup 0.793x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.875s, pg runtime 2.352s, speedup 2.688x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 11.471s, pg runtime 10.685s, speedup 0.931x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 20, train speedup 1.810, test speedup 1.015, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 49, train speedup 1.790, test speedup 1.155, val speedup 0.437
last model at epoch 49, train speedup 1.790, test speedup 1.155, val speedup 0.437
execution cost 0:04:05.609639
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.597717, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.54 s
Epoch 1/50 |loss: 0.229185| train set 1.694x speedup, test set 1.072x speedup, val set 0.477x speedup, step: 2, train time 4.29 s
Epoch 2/50 |loss: 0.204647| train set 1.790x speedup, test set 0.991x speedup, val set 0.296x speedup, step: 3, train time 4.18 s
Epoch 3/50 |loss: 0.193278| train set 1.518x speedup, test set 1.071x speedup, val set 0.437x speedup, step: 4, train time 4.50 s
Epoch 4/50 |loss: 0.177869| train set 1.775x speedup, test set 0.901x speedup, val set 0.437x speedup, step: 1, train time 4.33 s
Epoch 5/50 |loss: 0.171352| train set 1.776x speedup, test set 1.063x speedup, val set 0.437x speedup, step: 2, train time 4.17 s
Epoch 6/50 |loss: 0.166524| train set 1.733x speedup, test set 0.902x speedup, val set 0.437x speedup, step: 3, train time 4.53 s
Epoch 7/50 |loss: 0.164476| train set 1.776x speedup, test set 1.017x speedup, val set 0.437x speedup, step: 4, train time 4.39 s
Epoch 8/50 |loss: 0.158668| train set 1.790x speedup, test set 1.018x speedup, val set 0.437x speedup, step: 5, train time 4.12 s
Epoch 9/50 |loss: 0.153629| train set 1.789x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 1, train time 4.30 s
Epoch 10/50 |loss: 0.157442| train set 1.791x speedup, test set 1.018x speedup, val set 0.437x speedup, step: 2, train time 4.50 s
Epoch 11/50 |loss: 0.153853| train set 1.790x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 3, train time 4.29 s
Epoch 12/50 |loss: 0.153936| train set 1.776x speedup, test set 1.015x speedup, val set 0.437x speedup, step: 4, train time 4.62 s
Epoch 13/50 |loss: 0.151588| train set 1.790x speedup, test set 1.010x speedup, val set 0.437x speedup, step: 5, train time 4.18 s
Epoch 14/50 |loss: 0.149820| train set 1.810x speedup, test set 1.016x speedup, val set 0.437x speedup, step: 1, train time 4.40 s
Epoch 15/50 |loss: 0.147992| train set 1.776x speedup, test set 0.880x speedup, val set 0.437x speedup, step: 2, train time 4.71 s
Epoch 16/50 |loss: 0.147439| train set 1.776x speedup, test set 1.069x speedup, val set 0.437x speedup, step: 3, train time 4.23 s
Epoch 17/50 |loss: 0.147607| train set 1.810x speedup, test set 0.887x speedup, val set 0.437x speedup, step: 4, train time 4.49 s
Epoch 18/50 |loss: 0.144697| train set 1.810x speedup, test set 1.021x speedup, val set 0.437x speedup, step: 5, train time 4.40 s
Epoch 19/50 |loss: 0.147008| train set 1.790x speedup, test set 1.008x speedup, val set 0.437x speedup, step: 1, train time 4.69 s
Epoch 20/50 |loss: 0.145355| train set 1.810x speedup, test set 1.108x speedup, val set 0.437x speedup, step: 2, train time 4.17 s
Epoch 21/50 |loss: 0.145091| train set 1.775x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 3, train time 4.39 s
Epoch 22/50 |loss: 0.144857| train set 1.776x speedup, test set 1.114x speedup, val set 0.437x speedup, step: 4, train time 4.48 s
Epoch 23/50 |loss: 0.144236| train set 1.775x speedup, test set 1.153x speedup, val set 0.437x speedup, step: 5, train time 4.60 s
Epoch 24/50 |loss: 0.145929| train set 1.810x speedup, test set 1.115x speedup, val set 0.437x speedup, step: 1, train time 5.20 s
Epoch 25/50 |loss: 0.143067| train set 1.791x speedup, test set 1.047x speedup, val set 0.437x speedup, step: 2, train time 4.19 s
Epoch 26/50 |loss: 0.144200| train set 1.810x speedup, test set 1.046x speedup, val set 0.437x speedup, step: 3, train time 4.32 s
Epoch 27/50 |loss: 0.141476| train set 1.776x speedup, test set 1.143x speedup, val set 0.437x speedup, step: 4, train time 4.50 s
Epoch 28/50 |loss: 0.140207| train set 1.810x speedup, test set 1.120x speedup, val set 0.437x speedup, step: 5, train time 4.41 s
Epoch 29/50 |loss: 0.142453| train set 1.810x speedup, test set 1.146x speedup, val set 0.437x speedup, step: 1, train time 4.11 s
Epoch 30/50 |loss: 0.140610| train set 1.810x speedup, test set 1.021x speedup, val set 0.437x speedup, step: 2, train time 4.71 s
Epoch 31/50 |loss: 0.141243| train set 1.810x speedup, test set 0.932x speedup, val set 0.437x speedup, step: 3, train time 4.43 s
Epoch 32/50 |loss: 0.139425| train set 1.810x speedup, test set 1.153x speedup, val set 0.437x speedup, step: 4, train time 4.40 s
Epoch 33/50 |loss: 0.140250| train set 1.775x speedup, test set 1.118x speedup, val set 0.437x speedup, step: 5, train time 4.60 s
Epoch 34/50 |loss: 0.141489| train set 1.810x speedup, test set 1.019x speedup, val set 0.437x speedup, step: 1, train time 4.30 s
Epoch 35/50 |loss: 0.140039| train set 1.810x speedup, test set 1.114x speedup, val set 0.437x speedup, step: 2, train time 4.39 s
Epoch 36/50 |loss: 0.141756| train set 1.810x speedup, test set 1.161x speedup, val set 0.437x speedup, step: 3, train time 4.40 s
Epoch 37/50 |loss: 0.138786| train set 1.810x speedup, test set 1.185x speedup, val set 0.437x speedup, step: 4, train time 4.50 s
Epoch 38/50 |loss: 0.138699| train set 1.790x speedup, test set 1.137x speedup, val set 0.437x speedup, step: 5, train time 4.39 s
Epoch 39/50 |loss: 0.137537| train set 1.810x speedup, test set 1.144x speedup, val set 0.437x speedup, step: 1, train time 4.29 s
Epoch 40/50 |loss: 0.139435| train set 1.776x speedup, test set 1.155x speedup, val set 0.437x speedup, step: 2, train time 4.39 s
Epoch 41/50 |loss: 0.137946| train set 1.765x speedup, test set 1.132x speedup, val set 0.437x speedup, step: 3, train time 4.32 s
Epoch 42/50 |loss: 0.140062| train set 1.810x speedup, test set 1.141x speedup, val set 0.437x speedup, step: 4, train time 4.68 s
Epoch 43/50 |loss: 0.140293| train set 1.776x speedup, test set 1.166x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 44/50 |loss: 0.140685| train set 1.776x speedup, test set 1.182x speedup, val set 0.437x speedup, step: 1, train time 4.18 s
early stopping at epoch 44
Training per epoch cost 4.432 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 42, train speedup 1.810, test speedup 1.141, val speedup 0.437
best test speedup epoch: 0, train speedup 1.620, test speedup 1.255, val speedup 0.477
best validation speedup epoch: 44, train speedup 1.776, test speedup 1.182, val speedup 0.437
last model at epoch 44, train speedup 1.776, test speedup 1.182, val speedup 0.437
execution cost 0:03:49.838696
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.593206, and there are 11730 training samples
in channel 9
Epoch 0/50 |loss: 0.344972| train set 1.620x speedup, test set 1.255x speedup, val set 0.477x speedup, step: 1, train time 5.49 s
Epoch 1/50 |loss: 0.229276| train set 1.655x speedup, test set 1.075x speedup, val set 0.477x speedup, step: 2, train time 4.42 s
Epoch 2/50 |loss: 0.200869| train set 1.663x speedup, test set 1.009x speedup, val set 0.296x speedup, step: 3, train time 4.23 s
Epoch 3/50 |loss: 0.191451| train set 1.517x speedup, test set 1.081x speedup, val set 0.437x speedup, step: 4, train time 4.13 s
Epoch 4/50 |loss: 0.177607| train set 1.775x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 5/50 |loss: 0.169582| train set 1.680x speedup, test set 0.898x speedup, val set 0.437x speedup, step: 2, train time 4.39 s
Epoch 6/50 |loss: 0.165571| train set 1.734x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 3, train time 4.40 s
Epoch 7/50 |loss: 0.164881| train set 1.711x speedup, test set 0.987x speedup, val set 0.437x speedup, step: 4, train time 4.21 s
Epoch 8/50 |loss: 0.157823| train set 1.790x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 5, train time 4.29 s
Epoch 9/50 |loss: 0.153626| train set 1.790x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 1, train time 4.02 s
Epoch 10/50 |loss: 0.156672| train set 1.791x speedup, test set 1.020x speedup, val set 0.437x speedup, step: 2, train time 4.48 s
Epoch 11/50 |loss: 0.154267| train set 1.790x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.10 s
Epoch 12/50 |loss: 0.153752| train set 1.776x speedup, test set 1.056x speedup, val set 0.437x speedup, step: 4, train time 4.30 s
Epoch 13/50 |loss: 0.150575| train set 1.791x speedup, test set 1.014x speedup, val set 0.437x speedup, step: 5, train time 4.30 s
Epoch 14/50 |loss: 0.149182| train set 1.810x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 1, train time 4.09 s
Epoch 15/50 |loss: 0.148488| train set 1.757x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 2, train time 4.11 s
Epoch 16/50 |loss: 0.146804| train set 1.776x speedup, test set 1.065x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 17/50 |loss: 0.148227| train set 1.810x speedup, test set 1.048x speedup, val set 0.437x speedup, step: 4, train time 4.29 s
Epoch 18/50 |loss: 0.145575| train set 1.696x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 19/50 |loss: 0.146769| train set 1.790x speedup, test set 1.045x speedup, val set 0.437x speedup, step: 1, train time 4.20 s
Epoch 20/50 |loss: 0.146070| train set 1.810x speedup, test set 1.107x speedup, val set 0.437x speedup, step: 2, train time 4.28 s
Epoch 21/50 |loss: 0.145881| train set 1.775x speedup, test set 1.049x speedup, val set 0.437x speedup, step: 3, train time 4.32 s
Epoch 22/50 |loss: 0.144106| train set 1.776x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 4, train time 4.29 s
Epoch 23/50 |loss: 0.143204| train set 1.811x speedup, test set 1.171x speedup, val set 0.437x speedup, step: 5, train time 4.38 s
Epoch 24/50 |loss: 0.144837| train set 1.810x speedup, test set 1.076x speedup, val set 0.437x speedup, step: 1, train time 4.80 s
Epoch 25/50 |loss: 0.144820| train set 1.711x speedup, test set 1.055x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 26/50 |loss: 0.144190| train set 1.810x speedup, test set 1.050x speedup, val set 0.437x speedup, step: 3, train time 4.41 s
Epoch 27/50 |loss: 0.141374| train set 1.757x speedup, test set 1.146x speedup, val set 0.437x speedup, step: 4, train time 4.11 s
Epoch 28/50 |loss: 0.139844| train set 1.810x speedup, test set 1.153x speedup, val set 0.437x speedup, step: 5, train time 4.12 s
Epoch 29/50 |loss: 0.142220| train set 1.810x speedup, test set 1.138x speedup, val set 0.437x speedup, step: 1, train time 4.19 s
Epoch 30/50 |loss: 0.140250| train set 1.791x speedup, test set 1.044x speedup, val set 0.437x speedup, step: 2, train time 4.09 s
Epoch 31/50 |loss: 0.140834| train set 1.775x speedup, test set 1.039x speedup, val set 0.437x speedup, step: 3, train time 4.19 s
Epoch 32/50 |loss: 0.139820| train set 1.810x speedup, test set 1.139x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 33/50 |loss: 0.139947| train set 1.775x speedup, test set 1.230x speedup, val set 0.437x speedup, step: 5, train time 4.40 s
Epoch 34/50 |loss: 0.140282| train set 1.791x speedup, test set 1.138x speedup, val set 0.437x speedup, step: 1, train time 4.41 s
Epoch 35/50 |loss: 0.140864| train set 1.810x speedup, test set 1.126x speedup, val set 1.000x speedup, step: 2, train time 4.18 s
Epoch 36/50 |loss: 0.141784| train set 1.810x speedup, test set 1.094x speedup, val set 0.437x speedup, step: 3, train time 4.11 s
Epoch 37/50 |loss: 0.138355| train set 1.810x speedup, test set 1.170x speedup, val set 0.437x speedup, step: 4, train time 4.39 s
Epoch 38/50 |loss: 0.138174| train set 1.810x speedup, test set 1.130x speedup, val set 0.437x speedup, step: 5, train time 4.10 s
Epoch 39/50 |loss: 0.137047| train set 1.790x speedup, test set 1.139x speedup, val set 0.437x speedup, step: 1, train time 4.08 s
Epoch 40/50 |loss: 0.139226| train set 1.776x speedup, test set 1.171x speedup, val set 0.437x speedup, step: 2, train time 4.57 s
Epoch 41/50 |loss: 0.139095| train set 1.765x speedup, test set 1.178x speedup, val set 0.437x speedup, step: 3, train time 4.22 s
Epoch 42/50 |loss: 0.139765| train set 1.810x speedup, test set 1.114x speedup, val set 0.437x speedup, step: 4, train time 4.19 s
Epoch 43/50 |loss: 0.139845| train set 1.776x speedup, test set 1.230x speedup, val set 0.437x speedup, step: 5, train time 4.21 s
Epoch 44/50 |loss: 0.139690| train set 1.810x speedup, test set 1.254x speedup, val set 0.437x speedup, step: 1, train time 4.40 s
Epoch 45/50 |loss: 0.138258| train set 1.775x speedup, test set 1.218x speedup, val set 0.437x speedup, step: 2, train time 4.29 s
Epoch 46/50 |loss: 0.138320| train set 1.757x speedup, test set 1.283x speedup, val set 0.437x speedup, step: 3, train time 4.60 s
Epoch 47/50 |loss: 0.136794| train set 1.810x speedup, test set 1.229x speedup, val set 0.437x speedup, step: 4, train time 4.20 s
Epoch 48/50 |loss: 0.135028| train set 1.810x speedup, test set 1.170x speedup, val set 0.437x speedup, step: 5, train time 4.19 s
Epoch 49/50 |loss: 0.136953| train set 1.810x speedup, test set 1.279x speedup, val set 0.437x speedup, step: 1, train time 4.18 s
Training per epoch cost 4.289 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 1.765s, pg runtime 1.386s, speedup 0.785x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.671s, pg runtime 4.730s, speedup 1.771x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 9.625s, pg runtime 8.605s, speedup 0.894x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 23, train speedup 1.811, test speedup 1.171, val speedup 0.437
best test speedup epoch: 46, train speedup 1.757, test speedup 1.283, val speedup 0.437
best validation speedup epoch: 49, train speedup 1.810, test speedup 1.279, val speedup 0.437
last model at epoch 49, train speedup 1.810, test speedup 1.279, val speedup 0.437
execution cost 0:04:05.787191
==================================================
