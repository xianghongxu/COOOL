all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:01.003779, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.390721| train set 4.608x speedup, test set 1.147x speedup, val set 4.731x speedup, step: 1, train time 16.54 s
Epoch 1/50 |loss: 0.246673| train set 4.577x speedup, test set 1.116x speedup, val set 4.624x speedup, step: 2, train time 13.91 s
Epoch 2/50 |loss: 0.205612| train set 5.249x speedup, test set 1.066x speedup, val set 5.487x speedup, step: 3, train time 13.62 s
Epoch 3/50 |loss: 0.190184| train set 5.029x speedup, test set 1.016x speedup, val set 5.112x speedup, step: 4, train time 13.61 s
Epoch 4/50 |loss: 0.176248| train set 5.224x speedup, test set 1.013x speedup, val set 5.473x speedup, step: 1, train time 13.72 s
Epoch 5/50 |loss: 0.172515| train set 4.803x speedup, test set 1.038x speedup, val set 5.004x speedup, step: 2, train time 13.60 s
Epoch 6/50 |loss: 0.161033| train set 5.223x speedup, test set 0.795x speedup, val set 5.476x speedup, step: 3, train time 13.52 s
Epoch 7/50 |loss: 0.158748| train set 5.224x speedup, test set 1.048x speedup, val set 5.473x speedup, step: 4, train time 13.71 s
Epoch 8/50 |loss: 0.155844| train set 5.224x speedup, test set 1.026x speedup, val set 5.473x speedup, step: 5, train time 13.60 s
Epoch 9/50 |loss: 0.147638| train set 5.249x speedup, test set 1.056x speedup, val set 5.487x speedup, step: 1, train time 13.72 s
Epoch 10/50 |loss: 0.145284| train set 5.251x speedup, test set 0.804x speedup, val set 5.471x speedup, step: 2, train time 13.62 s
Epoch 11/50 |loss: 0.144132| train set 5.186x speedup, test set 1.060x speedup, val set 5.375x speedup, step: 3, train time 13.72 s
Epoch 12/50 |loss: 0.144599| train set 5.224x speedup, test set 1.085x speedup, val set 5.473x speedup, step: 4, train time 13.62 s
Epoch 13/50 |loss: 0.141251| train set 5.249x speedup, test set 1.061x speedup, val set 5.487x speedup, step: 5, train time 13.62 s
Epoch 14/50 |loss: 0.135731| train set 5.213x speedup, test set 0.844x speedup, val set 5.373x speedup, step: 6, train time 13.60 s
Epoch 15/50 |loss: 0.136728| train set 4.978x speedup, test set 0.836x speedup, val set 5.213x speedup, step: 7, train time 13.61 s
Epoch 16/50 |loss: 0.136700| train set 5.224x speedup, test set 0.847x speedup, val set 5.473x speedup, step: 8, train time 13.54 s
Epoch 17/50 |loss: 0.132459| train set 5.222x speedup, test set 0.817x speedup, val set 5.470x speedup, step: 9, train time 13.74 s
Epoch 18/50 |loss: 0.132298| train set 5.210x speedup, test set 0.827x speedup, val set 5.391x speedup, step: 10, train time 13.72 s
Epoch 19/50 |loss: 0.136440| train set 5.249x speedup, test set 0.800x speedup, val set 5.487x speedup, step: 1, train time 13.62 s
Epoch 20/50 |loss: 0.135826| train set 5.249x speedup, test set 0.839x speedup, val set 5.487x speedup, step: 2, train time 13.51 s
Epoch 21/50 |loss: 0.133417| train set 5.186x speedup, test set 0.809x speedup, val set 5.375x speedup, step: 3, train time 14.52 s
Epoch 22/50 |loss: 0.131008| train set 5.211x speedup, test set 0.838x speedup, val set 5.389x speedup, step: 4, train time 13.72 s
Epoch 23/50 |loss: 0.131243| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 5, train time 13.72 s
Epoch 24/50 |loss: 0.130787| train set 5.213x speedup, test set 0.826x speedup, val set 5.373x speedup, step: 6, train time 13.71 s
Epoch 25/50 |loss: 0.130983| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 7, train time 13.65 s
Epoch 26/50 |loss: 0.128785| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 8, train time 13.51 s
Epoch 27/50 |loss: 0.129138| train set 5.244x speedup, test set 0.826x speedup, val set 5.479x speedup, step: 9, train time 13.53 s
Epoch 28/50 |loss: 0.128126| train set 5.249x speedup, test set 0.787x speedup, val set 5.487x speedup, step: 10, train time 13.65 s
Epoch 29/50 |loss: 0.124231| train set 5.186x speedup, test set 0.814x speedup, val set 5.375x speedup, step: 11, train time 13.71 s
Epoch 30/50 |loss: 0.125461| train set 5.251x speedup, test set 0.815x speedup, val set 5.471x speedup, step: 12, train time 13.62 s
Epoch 31/50 |loss: 0.124532| train set 5.211x speedup, test set 0.833x speedup, val set 5.389x speedup, step: 13, train time 13.63 s
Epoch 32/50 |loss: 0.127390| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 14, train time 13.54 s
Epoch 33/50 |loss: 0.127116| train set 5.185x speedup, test set 0.823x speedup, val set 5.373x speedup, step: 15, train time 13.84 s
Epoch 34/50 |loss: 0.124167| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1, train time 13.63 s
Epoch 35/50 |loss: 0.126202| train set 5.249x speedup, test set 0.837x speedup, val set 5.487x speedup, step: 2, train time 13.70 s
Epoch 36/50 |loss: 0.127746| train set 5.186x speedup, test set 0.833x speedup, val set 5.375x speedup, step: 3, train time 13.70 s
Epoch 37/50 |loss: 0.128781| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 4, train time 13.72 s
Epoch 38/50 |loss: 0.125965| train set 5.249x speedup, test set 0.839x speedup, val set 5.487x speedup, step: 5, train time 13.80 s
early stopping at epoch 38
Training per epoch cost 13.753 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 10, train speedup 5.251, test speedup 0.804, val speedup 5.471
best test speedup epoch: 0, train speedup 4.608, test speedup 1.147, val speedup 4.731
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.803, val speedup 5.487
last model at epoch 38, train speedup 5.249, test speedup 0.839, val speedup 5.487
execution cost 0:10:02.398671
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.765630, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.392190| train set 4.611x speedup, test set 1.037x speedup, val set 4.766x speedup, step: 1, train time 15.28 s
Epoch 1/50 |loss: 0.246238| train set 4.804x speedup, test set 1.070x speedup, val set 4.844x speedup, step: 2, train time 13.72 s
Epoch 2/50 |loss: 0.201824| train set 4.952x speedup, test set 1.020x speedup, val set 5.259x speedup, step: 3, train time 13.62 s
Epoch 3/50 |loss: 0.187090| train set 4.988x speedup, test set 1.106x speedup, val set 5.076x speedup, step: 4, train time 13.61 s
Epoch 4/50 |loss: 0.181200| train set 5.146x speedup, test set 1.089x speedup, val set 5.394x speedup, step: 1, train time 13.61 s
Epoch 5/50 |loss: 0.173587| train set 5.224x speedup, test set 1.037x speedup, val set 5.473x speedup, step: 2, train time 13.71 s
Epoch 6/50 |loss: 0.161729| train set 5.223x speedup, test set 1.037x speedup, val set 5.476x speedup, step: 3, train time 13.78 s
Epoch 7/50 |loss: 0.159172| train set 5.222x speedup, test set 1.175x speedup, val set 5.470x speedup, step: 4, train time 13.60 s
Epoch 8/50 |loss: 0.158054| train set 5.224x speedup, test set 1.012x speedup, val set 5.473x speedup, step: 5, train time 13.60 s
Epoch 9/50 |loss: 0.148422| train set 5.249x speedup, test set 1.036x speedup, val set 5.487x speedup, step: 1, train time 13.61 s
Epoch 10/50 |loss: 0.143747| train set 5.226x speedup, test set 0.810x speedup, val set 5.457x speedup, step: 2, train time 13.62 s
Epoch 11/50 |loss: 0.144195| train set 5.186x speedup, test set 1.165x speedup, val set 5.375x speedup, step: 3, train time 13.72 s
Epoch 12/50 |loss: 0.141301| train set 5.224x speedup, test set 1.165x speedup, val set 5.473x speedup, step: 4, train time 13.63 s
Epoch 13/50 |loss: 0.140606| train set 5.133x speedup, test set 1.217x speedup, val set 5.313x speedup, step: 5, train time 13.72 s
Epoch 14/50 |loss: 0.137891| train set 5.213x speedup, test set 0.825x speedup, val set 5.373x speedup, step: 6, train time 13.53 s
Epoch 15/50 |loss: 0.138548| train set 5.000x speedup, test set 0.828x speedup, val set 5.231x speedup, step: 7, train time 13.52 s
Epoch 16/50 |loss: 0.136910| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 8, train time 13.51 s
Epoch 17/50 |loss: 0.132743| train set 5.224x speedup, test set 1.037x speedup, val set 5.473x speedup, step: 9, train time 13.71 s
Epoch 18/50 |loss: 0.132340| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 10, train time 13.62 s
Epoch 19/50 |loss: 0.136016| train set 5.249x speedup, test set 1.043x speedup, val set 5.487x speedup, step: 1, train time 13.61 s
Epoch 20/50 |loss: 0.135426| train set 5.249x speedup, test set 1.043x speedup, val set 5.487x speedup, step: 2, train time 13.60 s
Epoch 21/50 |loss: 0.132011| train set 5.186x speedup, test set 0.812x speedup, val set 5.375x speedup, step: 3, train time 14.34 s
Epoch 22/50 |loss: 0.129449| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 4, train time 13.69 s
Epoch 23/50 |loss: 0.130821| train set 5.224x speedup, test set 0.813x speedup, val set 5.473x speedup, step: 5, train time 13.62 s
Epoch 24/50 |loss: 0.130126| train set 5.251x speedup, test set 0.826x speedup, val set 5.471x speedup, step: 6, train time 13.71 s
Epoch 25/50 |loss: 0.131260| train set 5.211x speedup, test set 0.817x speedup, val set 5.389x speedup, step: 7, train time 13.73 s
Epoch 26/50 |loss: 0.129372| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 8, train time 13.54 s
Epoch 27/50 |loss: 0.129548| train set 5.244x speedup, test set 0.823x speedup, val set 5.479x speedup, step: 9, train time 13.70 s
Epoch 28/50 |loss: 0.127284| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 10, train time 13.62 s
Epoch 29/50 |loss: 0.124131| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 11, train time 13.69 s
Epoch 30/50 |loss: 0.126159| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 12, train time 13.63 s
Epoch 31/50 |loss: 0.124010| train set 5.211x speedup, test set 1.038x speedup, val set 5.389x speedup, step: 13, train time 13.71 s
Epoch 32/50 |loss: 0.127965| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 14, train time 13.53 s
Epoch 33/50 |loss: 0.128142| train set 5.185x speedup, test set 0.821x speedup, val set 5.373x speedup, step: 15, train time 13.69 s
Epoch 34/50 |loss: 0.124762| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1, train time 13.52 s
Epoch 35/50 |loss: 0.126189| train set 5.210x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 2, train time 13.54 s
Epoch 36/50 |loss: 0.126031| train set 5.188x speedup, test set 0.823x speedup, val set 5.360x speedup, step: 3, train time 13.70 s
Epoch 37/50 |loss: 0.128724| train set 5.249x speedup, test set 1.038x speedup, val set 5.487x speedup, step: 4, train time 13.71 s
Epoch 38/50 |loss: 0.124236| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 5, train time 13.63 s
early stopping at epoch 38
Training per epoch cost 13.698 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.089s, pg runtime 0.089s, speedup 1.000x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 24, train speedup 5.251, test speedup 0.826, val speedup 5.471
best test speedup epoch: 13, train speedup 5.133, test speedup 1.217, val speedup 5.313
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.829, val speedup 5.487
last model at epoch 38, train speedup 5.249, test speedup 0.812, val speedup 5.487
execution cost 0:09:57.225920
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.560542, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.392537| train set 4.181x speedup, test set 1.051x speedup, val set 4.252x speedup, step: 1, train time 15.40 s
Epoch 1/50 |loss: 0.242785| train set 4.577x speedup, test set 1.059x speedup, val set 4.624x speedup, step: 2, train time 13.73 s
Epoch 2/50 |loss: 0.202320| train set 4.991x speedup, test set 1.109x speedup, val set 5.318x speedup, step: 3, train time 13.60 s
Epoch 3/50 |loss: 0.185904| train set 5.010x speedup, test set 1.104x speedup, val set 5.088x speedup, step: 4, train time 13.70 s
Epoch 4/50 |loss: 0.178701| train set 5.224x speedup, test set 1.051x speedup, val set 5.473x speedup, step: 1, train time 13.62 s
Epoch 5/50 |loss: 0.170608| train set 4.871x speedup, test set 1.014x speedup, val set 5.072x speedup, step: 2, train time 13.52 s
Epoch 6/50 |loss: 0.162079| train set 5.223x speedup, test set 1.030x speedup, val set 5.476x speedup, step: 3, train time 13.72 s
Epoch 7/50 |loss: 0.158057| train set 5.222x speedup, test set 1.040x speedup, val set 5.470x speedup, step: 4, train time 13.80 s
Epoch 8/50 |loss: 0.158675| train set 5.224x speedup, test set 1.032x speedup, val set 5.473x speedup, step: 5, train time 13.80 s
Epoch 9/50 |loss: 0.147892| train set 5.249x speedup, test set 1.043x speedup, val set 5.487x speedup, step: 1, train time 13.80 s
Epoch 10/50 |loss: 0.145428| train set 5.226x speedup, test set 0.802x speedup, val set 5.457x speedup, step: 2, train time 13.70 s
Epoch 11/50 |loss: 0.142191| train set 5.186x speedup, test set 1.108x speedup, val set 5.375x speedup, step: 3, train time 13.82 s
Epoch 12/50 |loss: 0.140226| train set 5.224x speedup, test set 1.079x speedup, val set 5.473x speedup, step: 4, train time 13.83 s
Epoch 13/50 |loss: 0.142420| train set 5.170x speedup, test set 0.835x speedup, val set 5.408x speedup, step: 5, train time 13.81 s
Epoch 14/50 |loss: 0.136353| train set 5.212x speedup, test set 0.835x speedup, val set 5.376x speedup, step: 6, train time 13.91 s
Epoch 15/50 |loss: 0.136532| train set 4.978x speedup, test set 0.843x speedup, val set 5.218x speedup, step: 7, train time 13.71 s
Epoch 16/50 |loss: 0.135248| train set 5.188x speedup, test set 0.834x speedup, val set 5.360x speedup, step: 8, train time 13.54 s
Epoch 17/50 |loss: 0.132593| train set 5.222x speedup, test set 0.840x speedup, val set 5.470x speedup, step: 9, train time 13.74 s
Epoch 18/50 |loss: 0.131269| train set 5.243x speedup, test set 0.839x speedup, val set 5.473x speedup, step: 10, train time 13.80 s
Epoch 19/50 |loss: 0.134741| train set 5.249x speedup, test set 0.845x speedup, val set 5.487x speedup, step: 1, train time 13.82 s
Epoch 20/50 |loss: 0.133906| train set 5.247x speedup, test set 0.838x speedup, val set 5.484x speedup, step: 2, train time 13.81 s
Epoch 21/50 |loss: 0.132294| train set 5.018x speedup, test set 0.830x speedup, val set 5.312x speedup, step: 3, train time 14.39 s
Epoch 22/50 |loss: 0.129217| train set 5.211x speedup, test set 0.843x speedup, val set 5.389x speedup, step: 4, train time 13.75 s
Epoch 23/50 |loss: 0.128039| train set 5.224x speedup, test set 0.839x speedup, val set 5.473x speedup, step: 5, train time 13.62 s
Epoch 24/50 |loss: 0.129033| train set 5.249x speedup, test set 0.833x speedup, val set 5.455x speedup, step: 6, train time 13.81 s
Epoch 25/50 |loss: 0.131016| train set 5.211x speedup, test set 0.845x speedup, val set 5.389x speedup, step: 7, train time 13.90 s
Epoch 26/50 |loss: 0.128944| train set 5.249x speedup, test set 0.839x speedup, val set 5.487x speedup, step: 8, train time 13.89 s
Epoch 27/50 |loss: 0.127559| train set 5.219x speedup, test set 0.845x speedup, val set 5.465x speedup, step: 9, train time 13.81 s
Epoch 28/50 |loss: 0.126209| train set 5.249x speedup, test set 0.844x speedup, val set 5.487x speedup, step: 10, train time 13.71 s
Epoch 29/50 |loss: 0.125260| train set 5.185x speedup, test set 0.838x speedup, val set 5.373x speedup, step: 11, train time 13.52 s
Epoch 30/50 |loss: 0.126040| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 12, train time 13.51 s
Epoch 31/50 |loss: 0.123952| train set 5.186x speedup, test set 0.825x speedup, val set 5.375x speedup, step: 13, train time 13.61 s
Epoch 32/50 |loss: 0.128246| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 14, train time 13.81 s
Epoch 33/50 |loss: 0.125404| train set 5.185x speedup, test set 0.825x speedup, val set 5.373x speedup, step: 15, train time 13.82 s
Epoch 34/50 |loss: 0.123745| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 1, train time 13.83 s
Epoch 35/50 |loss: 0.125070| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2, train time 13.79 s
Epoch 36/50 |loss: 0.124912| train set 5.186x speedup, test set 0.825x speedup, val set 5.375x speedup, step: 3, train time 13.75 s
Epoch 37/50 |loss: 0.128282| train set 5.249x speedup, test set 0.838x speedup, val set 5.487x speedup, step: 4, train time 13.83 s
Epoch 38/50 |loss: 0.124160| train set 5.249x speedup, test set 0.838x speedup, val set 5.487x speedup, step: 5, train time 13.92 s
Epoch 39/50 |loss: 0.120989| train set 5.186x speedup, test set 0.836x speedup, val set 5.375x speedup, step: 6, train time 13.92 s
Epoch 40/50 |loss: 0.119986| train set 5.224x speedup, test set 1.061x speedup, val set 5.473x speedup, step: 7, train time 13.89 s
Epoch 41/50 |loss: 0.121287| train set 5.249x speedup, test set 0.843x speedup, val set 5.487x speedup, step: 8, train time 13.82 s
Epoch 42/50 |loss: 0.123469| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 9, train time 13.69 s
Epoch 43/50 |loss: 0.122966| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 10, train time 13.80 s
Epoch 44/50 |loss: 0.124035| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1, train time 13.91 s
Epoch 45/50 |loss: 0.122680| train set 5.211x speedup, test set 0.844x speedup, val set 5.389x speedup, step: 2, train time 13.73 s
Epoch 46/50 |loss: 0.119389| train set 5.251x speedup, test set 0.831x speedup, val set 5.471x speedup, step: 3, train time 13.62 s
Epoch 47/50 |loss: 0.121955| train set 5.211x speedup, test set 0.841x speedup, val set 5.389x speedup, step: 4, train time 13.63 s
Epoch 48/50 |loss: 0.120764| train set 5.249x speedup, test set 0.834x speedup, val set 5.487x speedup, step: 5, train time 13.70 s
Epoch 49/50 |loss: 0.121887| train set 5.249x speedup, test set 0.836x speedup, val set 5.487x speedup, step: 1, train time 13.71 s
early stopping at epoch 49
Training per epoch cost 13.797 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 46, train speedup 5.251, test speedup 0.831, val speedup 5.471
best test speedup epoch: 2, train speedup 4.991, test speedup 1.109, val speedup 5.318
best validation speedup epoch: 49, train speedup 5.249, test speedup 0.836, val speedup 5.487
last model at epoch 49, train speedup 5.249, test speedup 0.836, val speedup 5.487
execution cost 0:12:48.889736
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.971567, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.390757| train set 4.608x speedup, test set 1.045x speedup, val set 4.732x speedup, step: 1, train time 16.64 s
Epoch 1/50 |loss: 0.246833| train set 4.804x speedup, test set 1.113x speedup, val set 4.844x speedup, step: 2, train time 14.34 s
Epoch 2/50 |loss: 0.205309| train set 4.992x speedup, test set 1.061x speedup, val set 5.315x speedup, step: 3, train time 14.22 s
Epoch 3/50 |loss: 0.189010| train set 5.010x speedup, test set 1.093x speedup, val set 5.088x speedup, step: 4, train time 14.13 s
Epoch 4/50 |loss: 0.181120| train set 5.224x speedup, test set 1.051x speedup, val set 5.473x speedup, step: 1, train time 14.23 s
Epoch 5/50 |loss: 0.172700| train set 4.893x speedup, test set 0.838x speedup, val set 5.083x speedup, step: 2, train time 14.24 s
Epoch 6/50 |loss: 0.161332| train set 5.223x speedup, test set 0.815x speedup, val set 5.476x speedup, step: 3, train time 14.43 s
Epoch 7/50 |loss: 0.157804| train set 5.222x speedup, test set 0.844x speedup, val set 5.470x speedup, step: 4, train time 14.41 s
Epoch 8/50 |loss: 0.156869| train set 5.224x speedup, test set 1.060x speedup, val set 5.473x speedup, step: 5, train time 14.50 s
Epoch 9/50 |loss: 0.148227| train set 5.211x speedup, test set 0.836x speedup, val set 5.389x speedup, step: 6, train time 14.24 s
Epoch 10/50 |loss: 0.144411| train set 5.226x speedup, test set 0.827x speedup, val set 5.457x speedup, step: 7, train time 14.50 s
Epoch 11/50 |loss: 0.144761| train set 5.186x speedup, test set 0.840x speedup, val set 5.375x speedup, step: 8, train time 14.43 s
Epoch 12/50 |loss: 0.142537| train set 5.224x speedup, test set 1.101x speedup, val set 5.473x speedup, step: 9, train time 14.32 s
Epoch 13/50 |loss: 0.143084| train set 5.133x speedup, test set 0.827x speedup, val set 5.313x speedup, step: 10, train time 14.32 s
Epoch 14/50 |loss: 0.136927| train set 5.213x speedup, test set 0.838x speedup, val set 5.373x speedup, step: 11, train time 14.42 s
Epoch 15/50 |loss: 0.137610| train set 4.959x speedup, test set 0.831x speedup, val set 5.193x speedup, step: 12, train time 14.42 s
Epoch 16/50 |loss: 0.137190| train set 5.226x speedup, test set 0.845x speedup, val set 5.457x speedup, step: 13, train time 14.36 s
Epoch 17/50 |loss: 0.132771| train set 5.224x speedup, test set 0.845x speedup, val set 5.473x speedup, step: 14, train time 14.33 s
Epoch 18/50 |loss: 0.131832| train set 5.211x speedup, test set 0.830x speedup, val set 5.389x speedup, step: 15, train time 14.51 s
Epoch 19/50 |loss: 0.135250| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 1, train time 14.54 s
Epoch 20/50 |loss: 0.135327| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 2, train time 14.41 s
Epoch 21/50 |loss: 0.132350| train set 5.186x speedup, test set 0.838x speedup, val set 5.375x speedup, step: 3, train time 15.12 s
Epoch 22/50 |loss: 0.129044| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 4, train time 14.41 s
Epoch 23/50 |loss: 0.131489| train set 5.224x speedup, test set 0.832x speedup, val set 5.473x speedup, step: 5, train time 14.61 s
Epoch 24/50 |loss: 0.130230| train set 5.211x speedup, test set 0.830x speedup, val set 5.358x speedup, step: 6, train time 14.42 s
Epoch 25/50 |loss: 0.131783| train set 5.209x speedup, test set 0.826x speedup, val set 5.378x speedup, step: 7, train time 14.42 s
Epoch 26/50 |loss: 0.129840| train set 5.227x speedup, test set 0.827x speedup, val set 5.456x speedup, step: 8, train time 13.83 s
Epoch 27/50 |loss: 0.129110| train set 5.211x speedup, test set 0.832x speedup, val set 5.389x speedup, step: 9, train time 14.03 s
Epoch 28/50 |loss: 0.128000| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 10, train time 14.03 s
Epoch 29/50 |loss: 0.123929| train set 5.222x speedup, test set 0.825x speedup, val set 5.470x speedup, step: 11, train time 14.13 s
Epoch 30/50 |loss: 0.126779| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 12, train time 14.09 s
Epoch 31/50 |loss: 0.124068| train set 5.186x speedup, test set 0.824x speedup, val set 5.375x speedup, step: 13, train time 14.14 s
Epoch 32/50 |loss: 0.127453| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 14, train time 14.15 s
Epoch 33/50 |loss: 0.126606| train set 5.186x speedup, test set 0.825x speedup, val set 5.375x speedup, step: 15, train time 14.41 s
Epoch 34/50 |loss: 0.124036| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 1, train time 14.11 s
Epoch 35/50 |loss: 0.125111| train set 5.186x speedup, test set 0.820x speedup, val set 5.375x speedup, step: 2, train time 14.21 s
Epoch 36/50 |loss: 0.126304| train set 5.224x speedup, test set 0.825x speedup, val set 5.473x speedup, step: 3, train time 14.04 s
Epoch 37/50 |loss: 0.128069| train set 5.249x speedup, test set 0.805x speedup, val set 5.487x speedup, step: 4, train time 14.35 s
Epoch 38/50 |loss: 0.125196| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 5, train time 14.30 s
early stopping at epoch 38
Training per epoch cost 14.378 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 19, train speedup 5.249, test speedup 0.832, val speedup 5.487
best test speedup epoch: 1, train speedup 4.804, test speedup 1.113, val speedup 4.844
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.830, val speedup 5.487
last model at epoch 38, train speedup 5.249, test speedup 0.825, val speedup 5.487
execution cost 0:10:33.551578
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.707413, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.392036| train set 4.538x speedup, test set 1.089x speedup, val set 4.643x speedup, step: 1, train time 15.48 s
Epoch 1/50 |loss: 0.244484| train set 4.803x speedup, test set 1.082x speedup, val set 4.846x speedup, step: 2, train time 8.89 s
Epoch 2/50 |loss: 0.202195| train set 5.249x speedup, test set 1.062x speedup, val set 5.487x speedup, step: 3, train time 8.72 s
Epoch 3/50 |loss: 0.186226| train set 5.009x speedup, test set 1.025x speedup, val set 5.086x speedup, step: 4, train time 8.12 s
Epoch 4/50 |loss: 0.177360| train set 5.101x speedup, test set 0.984x speedup, val set 5.344x speedup, step: 1, train time 8.09 s
Epoch 5/50 |loss: 0.172640| train set 5.133x speedup, test set 1.024x speedup, val set 5.313x speedup, step: 2, train time 8.17 s
Epoch 6/50 |loss: 0.160758| train set 5.224x speedup, test set 0.836x speedup, val set 5.473x speedup, step: 3, train time 8.37 s
Epoch 7/50 |loss: 0.158673| train set 5.222x speedup, test set 1.039x speedup, val set 5.470x speedup, step: 4, train time 8.39 s
Epoch 8/50 |loss: 0.159034| train set 5.224x speedup, test set 1.076x speedup, val set 5.473x speedup, step: 5, train time 8.37 s
Epoch 9/50 |loss: 0.146367| train set 5.249x speedup, test set 1.054x speedup, val set 5.487x speedup, step: 1, train time 7.91 s
Epoch 10/50 |loss: 0.145039| train set 5.251x speedup, test set 1.038x speedup, val set 5.471x speedup, step: 2, train time 7.48 s
Epoch 11/50 |loss: 0.144764| train set 5.186x speedup, test set 1.012x speedup, val set 5.375x speedup, step: 3, train time 8.00 s
Epoch 12/50 |loss: 0.141036| train set 5.224x speedup, test set 1.031x speedup, val set 5.473x speedup, step: 4, train time 8.28 s
Epoch 13/50 |loss: 0.141618| train set 5.170x speedup, test set 1.052x speedup, val set 5.408x speedup, step: 5, train time 8.80 s
Epoch 14/50 |loss: 0.136709| train set 5.209x speedup, test set 0.808x speedup, val set 5.389x speedup, step: 6, train time 8.11 s
Epoch 15/50 |loss: 0.137260| train set 4.960x speedup, test set 0.816x speedup, val set 5.188x speedup, step: 7, train time 8.19 s
Epoch 16/50 |loss: 0.136476| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 8, train time 8.39 s
Epoch 17/50 |loss: 0.132934| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 9, train time 8.39 s
Epoch 18/50 |loss: 0.131641| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 10, train time 8.48 s
Epoch 19/50 |loss: 0.135195| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 1, train time 8.22 s
Epoch 20/50 |loss: 0.135056| train set 5.249x speedup, test set 1.086x speedup, val set 5.487x speedup, step: 2, train time 8.18 s
Epoch 21/50 |loss: 0.132632| train set 5.224x speedup, test set 0.810x speedup, val set 5.473x speedup, step: 3, train time 8.53 s
Epoch 22/50 |loss: 0.129842| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 4, train time 8.11 s
Epoch 23/50 |loss: 0.129580| train set 5.224x speedup, test set 0.817x speedup, val set 5.473x speedup, step: 5, train time 8.19 s
Epoch 24/50 |loss: 0.129487| train set 5.249x speedup, test set 0.827x speedup, val set 5.455x speedup, step: 6, train time 8.39 s
Epoch 25/50 |loss: 0.131698| train set 5.186x speedup, test set 0.815x speedup, val set 5.375x speedup, step: 7, train time 8.21 s
Epoch 26/50 |loss: 0.129421| train set 5.249x speedup, test set 1.031x speedup, val set 5.487x speedup, step: 8, train time 8.31 s
Epoch 27/50 |loss: 0.128232| train set 5.219x speedup, test set 1.030x speedup, val set 5.465x speedup, step: 9, train time 8.49 s
Epoch 28/50 |loss: 0.127620| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 10, train time 7.39 s
Epoch 29/50 |loss: 0.125736| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 11, train time 7.72 s
Epoch 30/50 |loss: 0.125153| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 12, train time 7.90 s
Epoch 31/50 |loss: 0.125094| train set 5.186x speedup, test set 0.809x speedup, val set 5.375x speedup, step: 13, train time 7.82 s
Epoch 32/50 |loss: 0.128103| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 14, train time 8.10 s
Epoch 33/50 |loss: 0.126854| train set 5.185x speedup, test set 0.819x speedup, val set 5.373x speedup, step: 15, train time 7.39 s
Epoch 34/50 |loss: 0.124701| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1, train time 7.59 s
Epoch 35/50 |loss: 0.124756| train set 5.224x speedup, test set 0.800x speedup, val set 5.473x speedup, step: 2, train time 7.50 s
Epoch 36/50 |loss: 0.125630| train set 5.186x speedup, test set 0.819x speedup, val set 5.375x speedup, step: 3, train time 7.91 s
Epoch 37/50 |loss: 0.127487| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 4, train time 7.88 s
Epoch 38/50 |loss: 0.123950| train set 5.213x speedup, test set 0.806x speedup, val set 5.373x speedup, step: 5, train time 7.88 s
Epoch 39/50 |loss: 0.122982| train set 5.186x speedup, test set 0.842x speedup, val set 5.375x speedup, step: 6, train time 7.61 s
Epoch 40/50 |loss: 0.120014| train set 5.258x speedup, test set 0.820x speedup, val set 5.473x speedup, step: 7, train time 7.58 s
Epoch 41/50 |loss: 0.122374| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 8, train time 7.79 s
Epoch 42/50 |loss: 0.124763| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 9, train time 7.91 s
Epoch 43/50 |loss: 0.124281| train set 5.247x speedup, test set 0.810x speedup, val set 5.484x speedup, step: 10, train time 7.81 s
Epoch 44/50 |loss: 0.123739| train set 5.249x speedup, test set 0.851x speedup, val set 5.487x speedup, step: 1, train time 7.39 s
Epoch 45/50 |loss: 0.121465| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2, train time 7.61 s
Epoch 46/50 |loss: 0.119505| train set 5.251x speedup, test set 0.823x speedup, val set 5.471x speedup, step: 3, train time 7.59 s
Epoch 47/50 |loss: 0.122715| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 4, train time 7.79 s
Epoch 48/50 |loss: 0.121504| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 5, train time 7.58 s
Epoch 49/50 |loss: 0.122547| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1, train time 7.32 s
early stopping at epoch 49
Training per epoch cost 8.166 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 40, train speedup 5.258, test speedup 0.820, val speedup 5.473
best test speedup epoch: 0, train speedup 4.538, test speedup 1.089, val speedup 4.643
best validation speedup epoch: 49, train speedup 5.249, test speedup 0.821, val speedup 5.487
last model at epoch 49, train speedup 5.249, test speedup 0.821, val speedup 5.487
execution cost 0:07:21.269796
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.532328, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.390546| train set 4.776x speedup, test set 1.119x speedup, val set 4.940x speedup, step: 1, train time 8.87 s
Epoch 1/50 |loss: 0.244594| train set 4.803x speedup, test set 1.068x speedup, val set 4.846x speedup, step: 2, train time 7.98 s
Epoch 2/50 |loss: 0.202508| train set 4.991x speedup, test set 1.034x speedup, val set 5.318x speedup, step: 3, train time 7.60 s
Epoch 3/50 |loss: 0.183259| train set 5.010x speedup, test set 1.061x speedup, val set 5.088x speedup, step: 4, train time 7.42 s
Epoch 4/50 |loss: 0.179471| train set 5.224x speedup, test set 1.103x speedup, val set 5.473x speedup, step: 1, train time 7.77 s
Epoch 5/50 |loss: 0.168487| train set 4.803x speedup, test set 1.021x speedup, val set 5.004x speedup, step: 2, train time 7.79 s
Epoch 6/50 |loss: 0.161681| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 3, train time 7.59 s
Epoch 7/50 |loss: 0.156241| train set 5.222x speedup, test set 1.197x speedup, val set 5.470x speedup, step: 4, train time 7.51 s
Epoch 8/50 |loss: 0.158505| train set 5.224x speedup, test set 1.057x speedup, val set 5.473x speedup, step: 5, train time 7.46 s
Epoch 9/50 |loss: 0.148652| train set 5.211x speedup, test set 1.065x speedup, val set 5.389x speedup, step: 6, train time 7.68 s
Epoch 10/50 |loss: 0.145496| train set 5.226x speedup, test set 0.816x speedup, val set 5.457x speedup, step: 7, train time 8.08 s
Epoch 11/50 |loss: 0.143907| train set 5.186x speedup, test set 1.061x speedup, val set 5.375x speedup, step: 8, train time 7.68 s
Epoch 12/50 |loss: 0.140932| train set 5.224x speedup, test set 1.042x speedup, val set 5.473x speedup, step: 9, train time 7.78 s
Epoch 13/50 |loss: 0.142511| train set 5.133x speedup, test set 1.078x speedup, val set 5.313x speedup, step: 10, train time 7.49 s
Epoch 14/50 |loss: 0.135139| train set 5.212x speedup, test set 0.840x speedup, val set 5.376x speedup, step: 11, train time 8.03 s
Epoch 15/50 |loss: 0.138138| train set 4.978x speedup, test set 0.827x speedup, val set 5.213x speedup, step: 12, train time 7.79 s
Epoch 16/50 |loss: 0.135791| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 13, train time 7.99 s
Epoch 17/50 |loss: 0.132785| train set 5.222x speedup, test set 0.835x speedup, val set 5.470x speedup, step: 14, train time 7.32 s
Epoch 18/50 |loss: 0.131394| train set 5.211x speedup, test set 0.840x speedup, val set 5.389x speedup, step: 15, train time 7.50 s
Epoch 19/50 |loss: 0.134707| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1, train time 7.81 s
Epoch 20/50 |loss: 0.134410| train set 5.249x speedup, test set 1.116x speedup, val set 5.487x speedup, step: 2, train time 7.97 s
Epoch 21/50 |loss: 0.131003| train set 5.224x speedup, test set 0.844x speedup, val set 5.473x speedup, step: 3, train time 8.31 s
Epoch 22/50 |loss: 0.129474| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 4, train time 7.52 s
Epoch 23/50 |loss: 0.131996| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 5, train time 7.58 s
Epoch 24/50 |loss: 0.128329| train set 5.211x speedup, test set 0.828x speedup, val set 5.358x speedup, step: 6, train time 7.82 s
Epoch 25/50 |loss: 0.132567| train set 5.186x speedup, test set 0.828x speedup, val set 5.375x speedup, step: 7, train time 7.79 s
Epoch 26/50 |loss: 0.128365| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 8, train time 7.71 s
Epoch 27/50 |loss: 0.128537| train set 5.219x speedup, test set 0.830x speedup, val set 5.465x speedup, step: 9, train time 7.70 s
Epoch 28/50 |loss: 0.127271| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 10, train time 7.29 s
Epoch 29/50 |loss: 0.124037| train set 5.222x speedup, test set 0.825x speedup, val set 5.470x speedup, step: 11, train time 9.41 s
Epoch 30/50 |loss: 0.126305| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 12, train time 10.11 s
Epoch 31/50 |loss: 0.123794| train set 5.186x speedup, test set 0.840x speedup, val set 5.375x speedup, step: 13, train time 9.71 s
Epoch 32/50 |loss: 0.128173| train set 5.249x speedup, test set 0.818x speedup, val set 5.487x speedup, step: 14, train time 9.58 s
Epoch 33/50 |loss: 0.127747| train set 5.185x speedup, test set 0.825x speedup, val set 5.373x speedup, step: 15, train time 9.08 s
Epoch 34/50 |loss: 0.123354| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 16, train time 9.39 s
Epoch 35/50 |loss: 0.124989| train set 5.224x speedup, test set 0.817x speedup, val set 5.473x speedup, step: 17, train time 9.08 s
Epoch 36/50 |loss: 0.125574| train set 5.186x speedup, test set 0.825x speedup, val set 5.375x speedup, step: 18, train time 8.99 s
Epoch 37/50 |loss: 0.127175| train set 5.249x speedup, test set 1.048x speedup, val set 5.487x speedup, step: 19, train time 9.29 s
Epoch 38/50 |loss: 0.124135| train set 5.211x speedup, test set 0.840x speedup, val set 5.389x speedup, step: 20, train time 9.29 s
early stopping at epoch 38
Training per epoch cost 8.173 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 20, train speedup 5.249, test speedup 1.116, val speedup 5.487
best test speedup epoch: 7, train speedup 5.222, test speedup 1.197, val speedup 5.470
best validation speedup epoch: 19, train speedup 5.249, test speedup 0.827, val speedup 5.487
last model at epoch 38, train speedup 5.211, test speedup 0.840, val speedup 5.389
execution cost 0:05:42.700538
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.518355, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.390737| train set 4.479x speedup, test set 1.058x speedup, val set 4.590x speedup, step: 1, train time 10.00 s
Epoch 1/50 |loss: 0.246084| train set 4.723x speedup, test set 1.095x speedup, val set 4.846x speedup, step: 2, train time 9.38 s
Epoch 2/50 |loss: 0.205163| train set 5.249x speedup, test set 1.042x speedup, val set 5.487x speedup, step: 3, train time 9.41 s
Epoch 3/50 |loss: 0.188286| train set 5.010x speedup, test set 1.111x speedup, val set 5.088x speedup, step: 4, train time 9.40 s
Epoch 4/50 |loss: 0.181113| train set 5.224x speedup, test set 1.061x speedup, val set 5.473x speedup, step: 1, train time 9.11 s
Epoch 5/50 |loss: 0.173501| train set 5.146x speedup, test set 1.065x speedup, val set 5.394x speedup, step: 2, train time 9.37 s
Epoch 6/50 |loss: 0.162038| train set 5.223x speedup, test set 0.844x speedup, val set 5.476x speedup, step: 3, train time 9.10 s
Epoch 7/50 |loss: 0.160424| train set 5.222x speedup, test set 1.139x speedup, val set 5.470x speedup, step: 4, train time 8.98 s
Epoch 8/50 |loss: 0.158426| train set 5.224x speedup, test set 1.034x speedup, val set 5.473x speedup, step: 5, train time 9.70 s
Epoch 9/50 |loss: 0.147757| train set 5.249x speedup, test set 1.043x speedup, val set 5.487x speedup, step: 1, train time 9.09 s
Epoch 10/50 |loss: 0.143751| train set 5.226x speedup, test set 0.862x speedup, val set 5.457x speedup, step: 2, train time 9.18 s
Epoch 11/50 |loss: 0.145369| train set 5.186x speedup, test set 1.091x speedup, val set 5.375x speedup, step: 3, train time 9.19 s
Epoch 12/50 |loss: 0.141892| train set 5.224x speedup, test set 1.024x speedup, val set 5.473x speedup, step: 4, train time 9.11 s
Epoch 13/50 |loss: 0.142668| train set 5.170x speedup, test set 1.091x speedup, val set 5.408x speedup, step: 5, train time 9.11 s
Epoch 14/50 |loss: 0.135795| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 6, train time 9.29 s
Epoch 15/50 |loss: 0.136612| train set 4.978x speedup, test set 0.845x speedup, val set 5.218x speedup, step: 7, train time 9.62 s
Epoch 16/50 |loss: 0.137586| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 8, train time 9.02 s
Epoch 17/50 |loss: 0.131824| train set 5.224x speedup, test set 0.832x speedup, val set 5.473x speedup, step: 9, train time 8.87 s
Epoch 18/50 |loss: 0.132216| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 10, train time 9.48 s
Epoch 19/50 |loss: 0.134021| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1, train time 9.21 s
Epoch 20/50 |loss: 0.134522| train set 5.249x speedup, test set 0.856x speedup, val set 5.487x speedup, step: 2, train time 9.09 s
Epoch 21/50 |loss: 0.131565| train set 5.018x speedup, test set 0.817x speedup, val set 5.312x speedup, step: 3, train time 9.98 s
Epoch 22/50 |loss: 0.128910| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 4, train time 9.51 s
Epoch 23/50 |loss: 0.131453| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 5, train time 9.31 s
Epoch 24/50 |loss: 0.128847| train set 5.249x speedup, test set 0.832x speedup, val set 5.455x speedup, step: 6, train time 9.22 s
Epoch 25/50 |loss: 0.129789| train set 5.211x speedup, test set 0.816x speedup, val set 5.389x speedup, step: 7, train time 9.18 s
Epoch 26/50 |loss: 0.130234| train set 5.247x speedup, test set 0.858x speedup, val set 5.484x speedup, step: 8, train time 9.10 s
Epoch 27/50 |loss: 0.128113| train set 5.244x speedup, test set 0.830x speedup, val set 5.479x speedup, step: 9, train time 9.38 s
Epoch 28/50 |loss: 0.126605| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 10, train time 9.22 s
Epoch 29/50 |loss: 0.123436| train set 5.222x speedup, test set 0.856x speedup, val set 5.470x speedup, step: 11, train time 8.98 s
Epoch 30/50 |loss: 0.126472| train set 5.251x speedup, test set 0.832x speedup, val set 5.471x speedup, step: 12, train time 9.30 s
Epoch 31/50 |loss: 0.123398| train set 5.224x speedup, test set 0.824x speedup, val set 5.473x speedup, step: 13, train time 8.99 s
Epoch 32/50 |loss: 0.126260| train set 5.211x speedup, test set 0.830x speedup, val set 5.389x speedup, step: 14, train time 9.46 s
Epoch 33/50 |loss: 0.127108| train set 5.185x speedup, test set 0.825x speedup, val set 5.373x speedup, step: 15, train time 9.38 s
Epoch 34/50 |loss: 0.122758| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 1, train time 9.18 s
Epoch 35/50 |loss: 0.124452| train set 5.224x speedup, test set 0.825x speedup, val set 5.473x speedup, step: 2, train time 9.07 s
Epoch 36/50 |loss: 0.125084| train set 5.186x speedup, test set 0.821x speedup, val set 5.375x speedup, step: 3, train time 9.28 s
Epoch 37/50 |loss: 0.126211| train set 5.249x speedup, test set 0.858x speedup, val set 5.487x speedup, step: 4, train time 9.09 s
Epoch 38/50 |loss: 0.123828| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 5, train time 9.21 s
early stopping at epoch 38
Training per epoch cost 9.270 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 30, train speedup 5.251, test speedup 0.832, val speedup 5.471
best test speedup epoch: 7, train speedup 5.222, test speedup 1.139, val speedup 5.470
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.832, val speedup 5.487
last model at epoch 38, train speedup 5.211, test speedup 0.825, val speedup 5.389
execution cost 0:06:26.867333
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.520016, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.392218| train set 4.536x speedup, test set 1.022x speedup, val set 4.651x speedup, step: 1, train time 10.00 s
Epoch 1/50 |loss: 0.243695| train set 4.803x speedup, test set 1.060x speedup, val set 4.846x speedup, step: 2, train time 9.61 s
Epoch 2/50 |loss: 0.202618| train set 4.992x speedup, test set 1.046x speedup, val set 5.315x speedup, step: 3, train time 9.30 s
Epoch 3/50 |loss: 0.188004| train set 5.010x speedup, test set 1.113x speedup, val set 5.088x speedup, step: 4, train time 9.11 s
Epoch 4/50 |loss: 0.174809| train set 5.224x speedup, test set 1.114x speedup, val set 5.473x speedup, step: 1, train time 8.69 s
Epoch 5/50 |loss: 0.170846| train set 5.133x speedup, test set 1.023x speedup, val set 5.313x speedup, step: 2, train time 8.78 s
Epoch 6/50 |loss: 0.160923| train set 5.223x speedup, test set 1.010x speedup, val set 5.476x speedup, step: 3, train time 9.09 s
Epoch 7/50 |loss: 0.154964| train set 5.222x speedup, test set 1.116x speedup, val set 5.470x speedup, step: 4, train time 9.08 s
Epoch 8/50 |loss: 0.158621| train set 5.224x speedup, test set 1.058x speedup, val set 5.473x speedup, step: 5, train time 8.99 s
Epoch 9/50 |loss: 0.146898| train set 5.211x speedup, test set 1.051x speedup, val set 5.389x speedup, step: 6, train time 9.08 s
Epoch 10/50 |loss: 0.145900| train set 5.251x speedup, test set 1.032x speedup, val set 5.471x speedup, step: 7, train time 9.18 s
Epoch 11/50 |loss: 0.144185| train set 5.186x speedup, test set 1.101x speedup, val set 5.375x speedup, step: 8, train time 9.71 s
Epoch 12/50 |loss: 0.139742| train set 5.224x speedup, test set 1.081x speedup, val set 5.473x speedup, step: 9, train time 9.02 s
Epoch 13/50 |loss: 0.140673| train set 5.170x speedup, test set 1.050x speedup, val set 5.408x speedup, step: 10, train time 9.00 s
Epoch 14/50 |loss: 0.136433| train set 5.213x speedup, test set 0.839x speedup, val set 5.373x speedup, step: 11, train time 9.09 s
Epoch 15/50 |loss: 0.135945| train set 4.978x speedup, test set 1.012x speedup, val set 5.218x speedup, step: 12, train time 9.08 s
Epoch 16/50 |loss: 0.135274| train set 5.188x speedup, test set 1.050x speedup, val set 5.361x speedup, step: 13, train time 8.78 s
Epoch 17/50 |loss: 0.133979| train set 5.222x speedup, test set 1.049x speedup, val set 5.470x speedup, step: 14, train time 9.41 s
Epoch 18/50 |loss: 0.130776| train set 5.248x speedup, test set 0.840x speedup, val set 5.489x speedup, step: 15, train time 9.39 s
Epoch 19/50 |loss: 0.134145| train set 5.249x speedup, test set 0.836x speedup, val set 5.487x speedup, step: 1, train time 8.89 s
Epoch 20/50 |loss: 0.134452| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 2, train time 9.67 s
Epoch 21/50 |loss: 0.131455| train set 5.224x speedup, test set 0.826x speedup, val set 5.473x speedup, step: 3, train time 10.08 s
Epoch 22/50 |loss: 0.128948| train set 5.211x speedup, test set 0.838x speedup, val set 5.389x speedup, step: 4, train time 8.79 s
Epoch 23/50 |loss: 0.129095| train set 5.224x speedup, test set 0.824x speedup, val set 5.473x speedup, step: 5, train time 8.89 s
Epoch 24/50 |loss: 0.128677| train set 5.242x speedup, test set 0.824x speedup, val set 5.449x speedup, step: 6, train time 9.11 s
Epoch 25/50 |loss: 0.130710| train set 5.211x speedup, test set 0.840x speedup, val set 5.389x speedup, step: 7, train time 8.99 s
Epoch 26/50 |loss: 0.128258| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 8, train time 9.50 s
Epoch 27/50 |loss: 0.127590| train set 5.183x speedup, test set 0.817x speedup, val set 5.353x speedup, step: 9, train time 9.32 s
Epoch 28/50 |loss: 0.127794| train set 5.211x speedup, test set 0.835x speedup, val set 5.389x speedup, step: 10, train time 8.88 s
Epoch 29/50 |loss: 0.124379| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 11, train time 8.97 s
Epoch 30/50 |loss: 0.124487| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 12, train time 9.21 s
Epoch 31/50 |loss: 0.122823| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 13, train time 8.81 s
Epoch 32/50 |loss: 0.127226| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 14, train time 8.89 s
Epoch 33/50 |loss: 0.125823| train set 5.185x speedup, test set 0.823x speedup, val set 5.373x speedup, step: 15, train time 9.30 s
Epoch 34/50 |loss: 0.123315| train set 5.249x speedup, test set 0.820x speedup, val set 5.487x speedup, step: 1, train time 8.98 s
Epoch 35/50 |loss: 0.124725| train set 5.211x speedup, test set 0.817x speedup, val set 5.389x speedup, step: 2, train time 8.90 s
Epoch 36/50 |loss: 0.124143| train set 5.186x speedup, test set 0.815x speedup, val set 5.375x speedup, step: 3, train time 8.88 s
Epoch 37/50 |loss: 0.127233| train set 5.224x speedup, test set 0.805x speedup, val set 5.473x speedup, step: 4, train time 9.10 s
Epoch 38/50 |loss: 0.122204| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 5, train time 8.92 s
Epoch 39/50 |loss: 0.122902| train set 5.186x speedup, test set 0.849x speedup, val set 5.375x speedup, step: 6, train time 9.38 s
Epoch 40/50 |loss: 0.119788| train set 5.224x speedup, test set 0.854x speedup, val set 5.473x speedup, step: 7, train time 7.58 s
Epoch 41/50 |loss: 0.120425| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 8, train time 8.41 s
Epoch 42/50 |loss: 0.122973| train set 5.224x speedup, test set 0.825x speedup, val set 5.473x speedup, step: 9, train time 9.29 s
Epoch 43/50 |loss: 0.123648| train set 5.209x speedup, test set 0.812x speedup, val set 5.386x speedup, step: 10, train time 10.10 s
Epoch 44/50 |loss: 0.122419| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1, train time 8.78 s
Epoch 45/50 |loss: 0.121578| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2, train time 8.91 s
Epoch 46/50 |loss: 0.119377| train set 5.213x speedup, test set 0.818x speedup, val set 5.373x speedup, step: 3, train time 9.18 s
Epoch 47/50 |loss: 0.121563| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 4, train time 8.88 s
Epoch 48/50 |loss: 0.120620| train set 5.211x speedup, test set 0.811x speedup, val set 5.389x speedup, step: 5, train time 9.19 s
Epoch 49/50 |loss: 0.120668| train set 5.249x speedup, test set 0.836x speedup, val set 5.487x speedup, step: 1, train time 9.21 s
early stopping at epoch 49
Training per epoch cost 9.108 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 10, train speedup 5.251, test speedup 1.032, val speedup 5.471
best test speedup epoch: 7, train speedup 5.222, test speedup 1.116, val speedup 5.470
best validation speedup epoch: 49, train speedup 5.249, test speedup 0.836, val speedup 5.487
last model at epoch 49, train speedup 5.249, test speedup 0.836, val speedup 5.487
execution cost 0:08:04.565187
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.554401, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.390546| train set 4.776x speedup, test set 1.119x speedup, val set 4.940x speedup, step: 1, train time 9.96 s
Epoch 1/50 |loss: 0.243716| train set 4.803x speedup, test set 1.093x speedup, val set 4.846x speedup, step: 2, train time 9.58 s
Epoch 2/50 |loss: 0.199127| train set 5.248x speedup, test set 1.118x speedup, val set 5.489x speedup, step: 3, train time 9.32 s
Epoch 3/50 |loss: 0.184605| train set 5.010x speedup, test set 1.092x speedup, val set 5.088x speedup, step: 4, train time 9.09 s
Epoch 4/50 |loss: 0.179732| train set 5.224x speedup, test set 1.031x speedup, val set 5.473x speedup, step: 1, train time 9.28 s
Epoch 5/50 |loss: 0.167163| train set 5.131x speedup, test set 1.022x speedup, val set 5.310x speedup, step: 2, train time 9.20 s
Epoch 6/50 |loss: 0.160428| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 3, train time 9.27 s
Epoch 7/50 |loss: 0.158336| train set 5.222x speedup, test set 1.082x speedup, val set 5.470x speedup, step: 4, train time 9.51 s
Epoch 8/50 |loss: 0.158425| train set 5.224x speedup, test set 1.049x speedup, val set 5.473x speedup, step: 5, train time 9.31 s
Epoch 9/50 |loss: 0.149020| train set 5.249x speedup, test set 1.064x speedup, val set 5.487x speedup, step: 1, train time 9.29 s
Epoch 10/50 |loss: 0.146147| train set 5.226x speedup, test set 1.022x speedup, val set 5.457x speedup, step: 2, train time 9.31 s
Epoch 11/50 |loss: 0.143507| train set 5.186x speedup, test set 1.092x speedup, val set 5.375x speedup, step: 3, train time 9.07 s
Epoch 12/50 |loss: 0.142606| train set 5.224x speedup, test set 1.059x speedup, val set 5.473x speedup, step: 4, train time 9.88 s
Epoch 13/50 |loss: 0.142736| train set 5.133x speedup, test set 1.099x speedup, val set 5.313x speedup, step: 5, train time 9.47 s
Epoch 14/50 |loss: 0.136272| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 6, train time 9.08 s
Epoch 15/50 |loss: 0.137536| train set 4.978x speedup, test set 0.845x speedup, val set 5.213x speedup, step: 7, train time 9.19 s
Epoch 16/50 |loss: 0.138404| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 8, train time 9.39 s
Epoch 17/50 |loss: 0.134217| train set 5.186x speedup, test set 0.830x speedup, val set 5.358x speedup, step: 9, train time 9.09 s
Epoch 18/50 |loss: 0.131977| train set 5.248x speedup, test set 0.833x speedup, val set 5.489x speedup, step: 10, train time 9.31 s
Epoch 19/50 |loss: 0.135502| train set 5.249x speedup, test set 0.840x speedup, val set 5.487x speedup, step: 1, train time 9.78 s
Epoch 20/50 |loss: 0.134916| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 2, train time 9.01 s
Epoch 21/50 |loss: 0.131879| train set 5.224x speedup, test set 0.812x speedup, val set 5.473x speedup, step: 3, train time 9.68 s
Epoch 22/50 |loss: 0.129996| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 4, train time 9.22 s
Epoch 23/50 |loss: 0.129682| train set 5.224x speedup, test set 0.825x speedup, val set 5.473x speedup, step: 5, train time 9.21 s
Epoch 24/50 |loss: 0.128922| train set 5.249x speedup, test set 0.818x speedup, val set 5.455x speedup, step: 6, train time 9.28 s
Epoch 25/50 |loss: 0.130409| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 7, train time 8.71 s
Epoch 26/50 |loss: 0.128648| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 8, train time 9.39 s
Epoch 27/50 |loss: 0.127704| train set 5.206x speedup, test set 0.838x speedup, val set 5.381x speedup, step: 9, train time 9.10 s
Epoch 28/50 |loss: 0.127005| train set 5.249x speedup, test set 0.841x speedup, val set 5.487x speedup, step: 10, train time 9.01 s
Epoch 29/50 |loss: 0.124048| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 11, train time 9.31 s
Epoch 30/50 |loss: 0.125441| train set 5.249x speedup, test set 0.843x speedup, val set 5.487x speedup, step: 12, train time 9.01 s
Epoch 31/50 |loss: 0.124143| train set 5.211x speedup, test set 0.834x speedup, val set 5.389x speedup, step: 13, train time 9.19 s
Epoch 32/50 |loss: 0.126632| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 14, train time 9.29 s
Epoch 33/50 |loss: 0.126643| train set 5.185x speedup, test set 0.834x speedup, val set 5.373x speedup, step: 15, train time 9.16 s
Epoch 34/50 |loss: 0.123262| train set 5.249x speedup, test set 0.839x speedup, val set 5.487x speedup, step: 16, train time 9.62 s
Epoch 35/50 |loss: 0.124867| train set 5.224x speedup, test set 0.836x speedup, val set 5.473x speedup, step: 17, train time 9.47 s
Epoch 36/50 |loss: 0.123740| train set 5.188x speedup, test set 0.834x speedup, val set 5.360x speedup, step: 18, train time 9.28 s
Epoch 37/50 |loss: 0.126771| train set 5.249x speedup, test set 0.839x speedup, val set 5.487x speedup, step: 19, train time 8.99 s
Epoch 38/50 |loss: 0.124768| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 20, train time 9.38 s
early stopping at epoch 38
Training per epoch cost 9.300 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.087s, pg runtime 0.089s, speedup 1.024x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
====================
best train speedup epoch: 24, train speedup 5.249, test speedup 0.818, val speedup 5.455
best test speedup epoch: 0, train speedup 4.776, test speedup 1.119, val speedup 4.940
best validation speedup epoch: 19, train speedup 5.249, test speedup 0.840, val speedup 5.487
last model at epoch 38, train speedup 5.211, test speedup 0.825, val speedup 5.389
execution cost 0:06:27.788038
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.531261, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.390776| train set 4.755x speedup, test set 1.055x speedup, val set 4.905x speedup, step: 1, train time 10.19 s
Epoch 1/50 |loss: 0.246545| train set 4.871x speedup, test set 1.044x speedup, val set 4.909x speedup, step: 2, train time 8.80 s
Epoch 2/50 |loss: 0.202338| train set 5.247x speedup, test set 1.097x speedup, val set 5.484x speedup, step: 3, train time 8.98 s
Epoch 3/50 |loss: 0.186855| train set 5.029x speedup, test set 1.053x speedup, val set 5.112x speedup, step: 4, train time 9.39 s
Epoch 4/50 |loss: 0.180851| train set 5.186x speedup, test set 1.048x speedup, val set 5.375x speedup, step: 1, train time 9.18 s
Epoch 5/50 |loss: 0.169392| train set 5.146x speedup, test set 0.850x speedup, val set 5.394x speedup, step: 2, train time 8.97 s
Epoch 6/50 |loss: 0.163383| train set 5.258x speedup, test set 0.812x speedup, val set 5.476x speedup, step: 3, train time 8.68 s
Epoch 7/50 |loss: 0.159757| train set 5.179x speedup, test set 1.086x speedup, val set 5.408x speedup, step: 4, train time 8.69 s
Epoch 8/50 |loss: 0.159731| train set 5.224x speedup, test set 0.843x speedup, val set 5.473x speedup, step: 5, train time 8.99 s
Epoch 9/50 |loss: 0.148304| train set 5.211x speedup, test set 0.838x speedup, val set 5.389x speedup, step: 1, train time 8.81 s
Epoch 10/50 |loss: 0.144749| train set 5.226x speedup, test set 0.836x speedup, val set 5.457x speedup, step: 2, train time 8.98 s
Epoch 11/50 |loss: 0.144325| train set 5.186x speedup, test set 0.822x speedup, val set 5.375x speedup, step: 3, train time 8.61 s
Epoch 12/50 |loss: 0.142596| train set 5.224x speedup, test set 1.108x speedup, val set 5.473x speedup, step: 4, train time 8.60 s
Epoch 13/50 |loss: 0.142796| train set 5.133x speedup, test set 0.833x speedup, val set 5.313x speedup, step: 5, train time 9.09 s
Epoch 14/50 |loss: 0.136451| train set 5.212x speedup, test set 0.818x speedup, val set 5.376x speedup, step: 6, train time 8.71 s
Epoch 15/50 |loss: 0.138063| train set 5.001x speedup, test set 0.831x speedup, val set 5.226x speedup, step: 7, train time 8.82 s
Epoch 16/50 |loss: 0.136342| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 8, train time 9.19 s
Epoch 17/50 |loss: 0.133187| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 9, train time 8.81 s
Epoch 18/50 |loss: 0.132524| train set 5.248x speedup, test set 0.820x speedup, val set 5.489x speedup, step: 10, train time 9.08 s
Epoch 19/50 |loss: 0.135513| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1, train time 8.89 s
Epoch 20/50 |loss: 0.133331| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 2, train time 8.80 s
Epoch 21/50 |loss: 0.132599| train set 5.017x speedup, test set 0.818x speedup, val set 5.314x speedup, step: 3, train time 9.48 s
Epoch 22/50 |loss: 0.130139| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 4, train time 8.68 s
Epoch 23/50 |loss: 0.131287| train set 5.224x speedup, test set 0.818x speedup, val set 5.473x speedup, step: 5, train time 9.41 s
Epoch 24/50 |loss: 0.129741| train set 5.247x speedup, test set 0.818x speedup, val set 5.453x speedup, step: 6, train time 9.39 s
Epoch 25/50 |loss: 0.131548| train set 5.186x speedup, test set 0.817x speedup, val set 5.375x speedup, step: 7, train time 9.09 s
Epoch 26/50 |loss: 0.129234| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 8, train time 9.28 s
Epoch 27/50 |loss: 0.129324| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 9, train time 9.09 s
Epoch 28/50 |loss: 0.127143| train set 5.249x speedup, test set 0.816x speedup, val set 5.487x speedup, step: 10, train time 8.88 s
Epoch 29/50 |loss: 0.124264| train set 5.222x speedup, test set 0.808x speedup, val set 5.470x speedup, step: 11, train time 9.38 s
Epoch 30/50 |loss: 0.126124| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 12, train time 8.81 s
Epoch 31/50 |loss: 0.125069| train set 5.186x speedup, test set 0.829x speedup, val set 5.375x speedup, step: 13, train time 8.91 s
Epoch 32/50 |loss: 0.127664| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 14, train time 9.49 s
Epoch 33/50 |loss: 0.128097| train set 5.222x speedup, test set 0.830x speedup, val set 5.470x speedup, step: 15, train time 8.89 s
Epoch 34/50 |loss: 0.123994| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1, train time 9.27 s
Epoch 35/50 |loss: 0.125062| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2, train time 9.10 s
Epoch 36/50 |loss: 0.126561| train set 5.186x speedup, test set 0.823x speedup, val set 5.375x speedup, step: 3, train time 9.17 s
Epoch 37/50 |loss: 0.127169| train set 5.249x speedup, test set 0.817x speedup, val set 5.487x speedup, step: 4, train time 9.08 s
Epoch 38/50 |loss: 0.123964| train set 5.213x speedup, test set 0.823x speedup, val set 5.373x speedup, step: 5, train time 9.11 s
Epoch 39/50 |loss: 0.122257| train set 5.188x speedup, test set 0.810x speedup, val set 5.360x speedup, step: 6, train time 9.01 s
Epoch 40/50 |loss: 0.120113| train set 5.224x speedup, test set 0.817x speedup, val set 5.473x speedup, step: 7, train time 8.81 s
Epoch 41/50 |loss: 0.121773| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 8, train time 9.20 s
Epoch 42/50 |loss: 0.124164| train set 5.224x speedup, test set 0.825x speedup, val set 5.473x speedup, step: 9, train time 9.00 s
Epoch 43/50 |loss: 0.122669| train set 5.211x speedup, test set 0.810x speedup, val set 5.371x speedup, step: 10, train time 9.02 s
Epoch 44/50 |loss: 0.125315| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1, train time 9.10 s
Epoch 45/50 |loss: 0.121598| train set 5.211x speedup, test set 0.804x speedup, val set 5.371x speedup, step: 2, train time 9.10 s
Epoch 46/50 |loss: 0.120431| train set 5.251x speedup, test set 0.810x speedup, val set 5.471x speedup, step: 3, train time 8.91 s
Epoch 47/50 |loss: 0.123225| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 4, train time 9.11 s
Epoch 48/50 |loss: 0.121028| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 5, train time 9.41 s
Epoch 49/50 |loss: 0.121781| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1, train time 8.88 s
early stopping at epoch 49
Training per epoch cost 9.047 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 6, train speedup 5.258, test speedup 0.812, val speedup 5.476
best test speedup epoch: 12, train speedup 5.224, test speedup 1.108, val speedup 5.473
best validation speedup epoch: 49, train speedup 5.249, test speedup 0.825, val speedup 5.487
last model at epoch 49, train speedup 5.249, test speedup 0.825, val speedup 5.487
execution cost 0:08:02.490840
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.594222, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.392218| train set 4.536x speedup, test set 1.022x speedup, val set 4.651x speedup, step: 1, train time 9.80 s
Epoch 1/50 |loss: 0.245388| train set 4.871x speedup, test set 1.054x speedup, val set 4.909x speedup, step: 2, train time 8.78 s
Epoch 2/50 |loss: 0.202917| train set 5.248x speedup, test set 1.044x speedup, val set 5.489x speedup, step: 3, train time 8.98 s
Epoch 3/50 |loss: 0.186907| train set 5.010x speedup, test set 1.091x speedup, val set 5.088x speedup, step: 4, train time 8.46 s
Epoch 4/50 |loss: 0.176676| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 1, train time 8.88 s
Epoch 5/50 |loss: 0.171565| train set 5.133x speedup, test set 1.008x speedup, val set 5.313x speedup, step: 2, train time 8.76 s
Epoch 6/50 |loss: 0.159665| train set 5.223x speedup, test set 0.826x speedup, val set 5.476x speedup, step: 3, train time 8.81 s
Epoch 7/50 |loss: 0.159063| train set 5.222x speedup, test set 1.187x speedup, val set 5.470x speedup, step: 4, train time 8.71 s
Epoch 8/50 |loss: 0.158251| train set 5.224x speedup, test set 1.116x speedup, val set 5.473x speedup, step: 5, train time 9.01 s
Epoch 9/50 |loss: 0.145929| train set 5.249x speedup, test set 1.029x speedup, val set 5.487x speedup, step: 1, train time 8.59 s
Epoch 10/50 |loss: 0.145695| train set 5.251x speedup, test set 0.837x speedup, val set 5.471x speedup, step: 2, train time 8.78 s
Epoch 11/50 |loss: 0.144630| train set 5.186x speedup, test set 1.078x speedup, val set 5.375x speedup, step: 3, train time 8.80 s
Epoch 12/50 |loss: 0.141192| train set 5.224x speedup, test set 1.088x speedup, val set 5.473x speedup, step: 4, train time 8.51 s
Epoch 13/50 |loss: 0.142426| train set 5.170x speedup, test set 0.843x speedup, val set 5.408x speedup, step: 5, train time 8.71 s
Epoch 14/50 |loss: 0.135550| train set 5.213x speedup, test set 0.832x speedup, val set 5.373x speedup, step: 6, train time 9.05 s
Epoch 15/50 |loss: 0.136788| train set 4.978x speedup, test set 0.819x speedup, val set 5.218x speedup, step: 7, train time 8.77 s
Epoch 16/50 |loss: 0.136220| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 8, train time 8.51 s
Epoch 17/50 |loss: 0.132374| train set 5.224x speedup, test set 0.805x speedup, val set 5.473x speedup, step: 9, train time 8.80 s
Epoch 18/50 |loss: 0.131258| train set 5.249x speedup, test set 0.833x speedup, val set 5.487x speedup, step: 10, train time 8.61 s
Epoch 19/50 |loss: 0.133032| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1, train time 8.88 s
Epoch 20/50 |loss: 0.135093| train set 5.249x speedup, test set 0.835x speedup, val set 5.487x speedup, step: 2, train time 8.61 s
Epoch 21/50 |loss: 0.131933| train set 5.018x speedup, test set 0.824x speedup, val set 5.312x speedup, step: 3, train time 9.31 s
Epoch 22/50 |loss: 0.129930| train set 5.211x speedup, test set 0.840x speedup, val set 5.389x speedup, step: 4, train time 8.98 s
Epoch 23/50 |loss: 0.130534| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 5, train time 8.79 s
Epoch 24/50 |loss: 0.128641| train set 5.249x speedup, test set 0.816x speedup, val set 5.455x speedup, step: 6, train time 8.79 s
Epoch 25/50 |loss: 0.131430| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 7, train time 8.98 s
Epoch 26/50 |loss: 0.128636| train set 5.247x speedup, test set 0.814x speedup, val set 5.484x speedup, step: 8, train time 8.59 s
Epoch 27/50 |loss: 0.128308| train set 5.251x speedup, test set 0.827x speedup, val set 5.471x speedup, step: 9, train time 8.59 s
Epoch 28/50 |loss: 0.127068| train set 5.249x speedup, test set 0.806x speedup, val set 5.487x speedup, step: 10, train time 8.92 s
Epoch 29/50 |loss: 0.124757| train set 5.224x speedup, test set 0.825x speedup, val set 5.473x speedup, step: 11, train time 8.69 s
Epoch 30/50 |loss: 0.125269| train set 5.251x speedup, test set 0.810x speedup, val set 5.471x speedup, step: 12, train time 9.00 s
Epoch 31/50 |loss: 0.125107| train set 5.247x speedup, test set 0.820x speedup, val set 5.484x speedup, step: 13, train time 8.58 s
Epoch 32/50 |loss: 0.128005| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 14, train time 8.90 s
Epoch 33/50 |loss: 0.126620| train set 5.185x speedup, test set 0.823x speedup, val set 5.373x speedup, step: 15, train time 8.80 s
Epoch 34/50 |loss: 0.125191| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1, train time 8.78 s
Epoch 35/50 |loss: 0.125044| train set 5.186x speedup, test set 0.823x speedup, val set 5.375x speedup, step: 2, train time 8.71 s
Epoch 36/50 |loss: 0.126030| train set 5.188x speedup, test set 0.827x speedup, val set 5.360x speedup, step: 3, train time 8.78 s
Epoch 37/50 |loss: 0.128366| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 4, train time 8.69 s
Epoch 38/50 |loss: 0.124814| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 5, train time 8.49 s
early stopping at epoch 38
Training per epoch cost 8.800 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 10, train speedup 5.251, test speedup 0.837, val speedup 5.471
best test speedup epoch: 7, train speedup 5.222, test speedup 1.187, val speedup 5.470
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.827, val speedup 5.487
last model at epoch 38, train speedup 5.211, test speedup 0.827, val speedup 5.389
execution cost 0:06:09.671111
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.563359, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.392606| train set 4.608x speedup, test set 0.847x speedup, val set 4.731x speedup, step: 1, train time 10.40 s
Epoch 1/50 |loss: 0.248290| train set 4.792x speedup, test set 1.092x speedup, val set 4.832x speedup, step: 2, train time 9.21 s
Epoch 2/50 |loss: 0.205264| train set 4.992x speedup, test set 1.039x speedup, val set 5.315x speedup, step: 3, train time 9.18 s
Epoch 3/50 |loss: 0.184874| train set 5.249x speedup, test set 1.179x speedup, val set 5.487x speedup, step: 4, train time 9.40 s
Epoch 4/50 |loss: 0.173137| train set 5.186x speedup, test set 1.106x speedup, val set 5.376x speedup, step: 1, train time 8.71 s
Epoch 5/50 |loss: 0.170153| train set 4.835x speedup, test set 1.053x speedup, val set 5.088x speedup, step: 2, train time 8.95 s
Epoch 6/50 |loss: 0.160805| train set 5.224x speedup, test set 0.839x speedup, val set 5.473x speedup, step: 3, train time 9.13 s
Epoch 7/50 |loss: 0.156443| train set 5.222x speedup, test set 1.060x speedup, val set 5.470x speedup, step: 4, train time 9.00 s
Epoch 8/50 |loss: 0.156558| train set 5.224x speedup, test set 1.041x speedup, val set 5.473x speedup, step: 5, train time 9.26 s
Epoch 9/50 |loss: 0.147232| train set 5.249x speedup, test set 1.063x speedup, val set 5.487x speedup, step: 1, train time 8.89 s
Epoch 10/50 |loss: 0.143360| train set 5.251x speedup, test set 0.816x speedup, val set 5.471x speedup, step: 2, train time 9.20 s
Epoch 11/50 |loss: 0.142457| train set 5.186x speedup, test set 1.048x speedup, val set 5.375x speedup, step: 3, train time 8.90 s
Epoch 12/50 |loss: 0.139557| train set 5.224x speedup, test set 1.024x speedup, val set 5.473x speedup, step: 4, train time 9.02 s
Epoch 13/50 |loss: 0.141812| train set 5.249x speedup, test set 1.063x speedup, val set 5.487x speedup, step: 5, train time 8.98 s
Epoch 14/50 |loss: 0.135331| train set 5.213x speedup, test set 0.832x speedup, val set 5.373x speedup, step: 6, train time 9.01 s
Epoch 15/50 |loss: 0.136231| train set 5.000x speedup, test set 0.817x speedup, val set 5.231x speedup, step: 7, train time 9.19 s
Epoch 16/50 |loss: 0.136252| train set 5.251x speedup, test set 0.839x speedup, val set 5.471x speedup, step: 8, train time 8.99 s
Epoch 17/50 |loss: 0.131254| train set 5.224x speedup, test set 1.016x speedup, val set 5.473x speedup, step: 9, train time 9.10 s
Epoch 18/50 |loss: 0.130788| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 10, train time 9.21 s
Epoch 19/50 |loss: 0.134086| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1, train time 9.08 s
Epoch 20/50 |loss: 0.133445| train set 5.249x speedup, test set 1.056x speedup, val set 5.487x speedup, step: 2, train time 9.29 s
Epoch 21/50 |loss: 0.131051| train set 4.934x speedup, test set 0.828x speedup, val set 5.202x speedup, step: 3, train time 9.38 s
Epoch 22/50 |loss: 0.128804| train set 5.211x speedup, test set 0.816x speedup, val set 5.389x speedup, step: 4, train time 9.09 s
Epoch 23/50 |loss: 0.129537| train set 5.224x speedup, test set 0.805x speedup, val set 5.473x speedup, step: 5, train time 8.83 s
Epoch 24/50 |loss: 0.131218| train set 5.250x speedup, test set 0.816x speedup, val set 5.469x speedup, step: 6, train time 8.90 s
Epoch 25/50 |loss: 0.130753| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 7, train time 9.01 s
Epoch 26/50 |loss: 0.129339| train set 5.249x speedup, test set 0.816x speedup, val set 5.487x speedup, step: 8, train time 9.09 s
Epoch 27/50 |loss: 0.128666| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 9, train time 9.01 s
Epoch 28/50 |loss: 0.126857| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 10, train time 8.98 s
Epoch 29/50 |loss: 0.123450| train set 5.185x speedup, test set 0.799x speedup, val set 5.373x speedup, step: 11, train time 9.21 s
Epoch 30/50 |loss: 0.126200| train set 5.249x speedup, test set 0.807x speedup, val set 5.487x speedup, step: 12, train time 8.78 s
Epoch 31/50 |loss: 0.123550| train set 5.186x speedup, test set 0.802x speedup, val set 5.375x speedup, step: 13, train time 9.18 s
Epoch 32/50 |loss: 0.126667| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 14, train time 9.41 s
Epoch 33/50 |loss: 0.125787| train set 5.185x speedup, test set 0.822x speedup, val set 5.373x speedup, step: 15, train time 8.91 s
Epoch 34/50 |loss: 0.124135| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1, train time 9.02 s
Epoch 35/50 |loss: 0.124573| train set 5.186x speedup, test set 0.803x speedup, val set 5.375x speedup, step: 2, train time 9.28 s
Epoch 36/50 |loss: 0.126455| train set 5.186x speedup, test set 0.803x speedup, val set 5.375x speedup, step: 3, train time 9.18 s
Epoch 37/50 |loss: 0.128257| train set 5.249x speedup, test set 1.076x speedup, val set 5.487x speedup, step: 4, train time 9.30 s
Epoch 38/50 |loss: 0.123317| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 5, train time 9.00 s
Epoch 39/50 |loss: 0.123901| train set 5.188x speedup, test set 0.832x speedup, val set 5.360x speedup, step: 6, train time 8.91 s
Epoch 40/50 |loss: 0.120592| train set 5.233x speedup, test set 1.022x speedup, val set 5.473x speedup, step: 7, train time 9.08 s
Epoch 41/50 |loss: 0.122735| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 8, train time 9.27 s
Epoch 42/50 |loss: 0.125337| train set 5.224x speedup, test set 0.815x speedup, val set 5.473x speedup, step: 9, train time 9.41 s
Epoch 43/50 |loss: 0.123271| train set 5.251x speedup, test set 0.812x speedup, val set 5.471x speedup, step: 10, train time 9.09 s
Epoch 44/50 |loss: 0.124707| train set 5.211x speedup, test set 0.846x speedup, val set 5.389x speedup, step: 11, train time 8.99 s
Epoch 45/50 |loss: 0.122030| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 12, train time 9.28 s
Epoch 46/50 |loss: 0.120175| train set 5.251x speedup, test set 0.812x speedup, val set 5.471x speedup, step: 13, train time 8.80 s
Epoch 47/50 |loss: 0.122840| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 14, train time 9.49 s
Epoch 48/50 |loss: 0.123877| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 15, train time 9.19 s
Epoch 49/50 |loss: 0.123104| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1, train time 9.30 s
early stopping at epoch 49
Training per epoch cost 9.130 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 1.959s, pg runtime 0.239s, speedup 0.122x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 10, train speedup 5.251, test speedup 0.816, val speedup 5.471
best test speedup epoch: 3, train speedup 5.249, test speedup 1.179, val speedup 5.487
best validation speedup epoch: 49, train speedup 5.249, test speedup 0.812, val speedup 5.487
last model at epoch 49, train speedup 5.249, test speedup 0.812, val speedup 5.487
execution cost 0:08:08.396466
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.571959, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.390740| train set 4.608x speedup, test set 1.147x speedup, val set 4.731x speedup, step: 1, train time 10.19 s
Epoch 1/50 |loss: 0.245235| train set 4.577x speedup, test set 1.152x speedup, val set 4.625x speedup, step: 2, train time 9.12 s
Epoch 2/50 |loss: 0.204783| train set 5.248x speedup, test set 1.015x speedup, val set 5.489x speedup, step: 3, train time 9.27 s
Epoch 3/50 |loss: 0.184628| train set 5.029x speedup, test set 1.061x speedup, val set 5.112x speedup, step: 4, train time 9.01 s
Epoch 4/50 |loss: 0.177627| train set 5.224x speedup, test set 1.011x speedup, val set 5.473x speedup, step: 1, train time 9.29 s
Epoch 5/50 |loss: 0.170433| train set 5.249x speedup, test set 1.022x speedup, val set 5.487x speedup, step: 2, train time 9.29 s
Epoch 6/50 |loss: 0.161034| train set 5.248x speedup, test set 0.804x speedup, val set 5.489x speedup, step: 3, train time 9.10 s
Epoch 7/50 |loss: 0.156808| train set 5.224x speedup, test set 1.099x speedup, val set 5.473x speedup, step: 4, train time 8.98 s
Epoch 8/50 |loss: 0.156576| train set 5.224x speedup, test set 0.999x speedup, val set 5.473x speedup, step: 5, train time 9.00 s
Epoch 9/50 |loss: 0.147609| train set 5.249x speedup, test set 1.056x speedup, val set 5.487x speedup, step: 1, train time 8.86 s
Epoch 10/50 |loss: 0.144953| train set 5.251x speedup, test set 0.807x speedup, val set 5.471x speedup, step: 2, train time 9.41 s
Epoch 11/50 |loss: 0.144388| train set 5.186x speedup, test set 1.108x speedup, val set 5.375x speedup, step: 3, train time 8.62 s
Epoch 12/50 |loss: 0.142204| train set 5.224x speedup, test set 1.051x speedup, val set 5.473x speedup, step: 4, train time 8.90 s
Epoch 13/50 |loss: 0.142242| train set 5.249x speedup, test set 0.867x speedup, val set 5.487x speedup, step: 5, train time 9.11 s
Epoch 14/50 |loss: 0.136017| train set 5.211x speedup, test set 0.823x speedup, val set 5.371x speedup, step: 6, train time 9.18 s
Epoch 15/50 |loss: 0.135329| train set 4.978x speedup, test set 0.803x speedup, val set 5.213x speedup, step: 7, train time 9.02 s
Epoch 16/50 |loss: 0.135894| train set 5.249x speedup, test set 0.818x speedup, val set 5.487x speedup, step: 8, train time 9.00 s
Epoch 17/50 |loss: 0.132598| train set 5.222x speedup, test set 0.818x speedup, val set 5.470x speedup, step: 9, train time 8.98 s
Epoch 18/50 |loss: 0.131357| train set 5.249x speedup, test set 0.845x speedup, val set 5.487x speedup, step: 10, train time 9.10 s
Epoch 19/50 |loss: 0.133270| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1, train time 9.10 s
Epoch 20/50 |loss: 0.136042| train set 5.249x speedup, test set 0.849x speedup, val set 5.487x speedup, step: 2, train time 8.97 s
Epoch 21/50 |loss: 0.132191| train set 5.223x speedup, test set 0.858x speedup, val set 5.476x speedup, step: 3, train time 9.60 s
Epoch 22/50 |loss: 0.128369| train set 5.211x speedup, test set 0.852x speedup, val set 5.389x speedup, step: 4, train time 9.30 s
Epoch 23/50 |loss: 0.129013| train set 5.224x speedup, test set 0.854x speedup, val set 5.473x speedup, step: 5, train time 8.98 s
Epoch 24/50 |loss: 0.128942| train set 5.249x speedup, test set 0.808x speedup, val set 5.487x speedup, step: 1, train time 8.93 s
Epoch 25/50 |loss: 0.130393| train set 5.211x speedup, test set 0.811x speedup, val set 5.389x speedup, step: 2, train time 8.98 s
Epoch 26/50 |loss: 0.128469| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 3, train time 9.52 s
Epoch 27/50 |loss: 0.129314| train set 5.245x speedup, test set 0.807x speedup, val set 5.487x speedup, step: 4, train time 9.13 s
Epoch 28/50 |loss: 0.127583| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 5, train time 9.00 s
Epoch 29/50 |loss: 0.123716| train set 5.222x speedup, test set 0.854x speedup, val set 5.470x speedup, step: 6, train time 9.41 s
Epoch 30/50 |loss: 0.125467| train set 5.251x speedup, test set 0.844x speedup, val set 5.471x speedup, step: 7, train time 8.70 s
Epoch 31/50 |loss: 0.123470| train set 5.186x speedup, test set 0.837x speedup, val set 5.375x speedup, step: 8, train time 9.39 s
Epoch 32/50 |loss: 0.126819| train set 5.249x speedup, test set 0.844x speedup, val set 5.487x speedup, step: 9, train time 9.01 s
Epoch 33/50 |loss: 0.125519| train set 5.185x speedup, test set 0.849x speedup, val set 5.373x speedup, step: 10, train time 9.38 s
Epoch 34/50 |loss: 0.124669| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1, train time 9.48 s
Epoch 35/50 |loss: 0.125973| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2, train time 9.36 s
Epoch 36/50 |loss: 0.125444| train set 5.186x speedup, test set 0.854x speedup, val set 5.375x speedup, step: 3, train time 9.11 s
Epoch 37/50 |loss: 0.127723| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 4, train time 8.89 s
Epoch 38/50 |loss: 0.122447| train set 5.251x speedup, test set 0.854x speedup, val set 5.471x speedup, step: 5, train time 9.09 s
Epoch 39/50 |loss: 0.121688| train set 5.188x speedup, test set 0.854x speedup, val set 5.360x speedup, step: 6, train time 9.12 s
Epoch 40/50 |loss: 0.120809| train set 5.249x speedup, test set 0.843x speedup, val set 5.487x speedup, step: 7, train time 9.08 s
Epoch 41/50 |loss: 0.121967| train set 5.249x speedup, test set 0.854x speedup, val set 5.487x speedup, step: 8, train time 9.40 s
Epoch 42/50 |loss: 0.124136| train set 5.224x speedup, test set 0.854x speedup, val set 5.473x speedup, step: 9, train time 9.43 s
Epoch 43/50 |loss: 0.122533| train set 5.209x speedup, test set 0.854x speedup, val set 5.386x speedup, step: 10, train time 9.39 s
Epoch 44/50 |loss: 0.123335| train set 5.211x speedup, test set 0.843x speedup, val set 5.389x speedup, step: 11, train time 9.31 s
Epoch 45/50 |loss: 0.122310| train set 5.211x speedup, test set 0.854x speedup, val set 5.389x speedup, step: 12, train time 9.28 s
Epoch 46/50 |loss: 0.119037| train set 5.251x speedup, test set 0.843x speedup, val set 5.471x speedup, step: 13, train time 9.42 s
Epoch 47/50 |loss: 0.123271| train set 5.211x speedup, test set 0.839x speedup, val set 5.389x speedup, step: 14, train time 9.42 s
Epoch 48/50 |loss: 0.122083| train set 5.249x speedup, test set 0.837x speedup, val set 5.487x speedup, step: 15, train time 9.01 s
early stopping at epoch 48
Training per epoch cost 9.176 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 10, train speedup 5.251, test speedup 0.807, val speedup 5.471
best test speedup epoch: 1, train speedup 4.577, test speedup 1.152, val speedup 4.625
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.823, val speedup 5.487
last model at epoch 48, train speedup 5.249, test speedup 0.837, val speedup 5.487
execution cost 0:08:01.425528
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.540581, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.391824| train set 4.673x speedup, test set 1.018x speedup, val set 4.835x speedup, step: 1, train time 10.32 s
Epoch 1/50 |loss: 0.246831| train set 4.577x speedup, test set 1.106x speedup, val set 4.624x speedup, step: 2, train time 9.49 s
Epoch 2/50 |loss: 0.204769| train set 4.992x speedup, test set 1.131x speedup, val set 5.315x speedup, step: 3, train time 8.98 s
Epoch 3/50 |loss: 0.187491| train set 5.010x speedup, test set 1.158x speedup, val set 5.088x speedup, step: 4, train time 9.21 s
Epoch 4/50 |loss: 0.177175| train set 5.224x speedup, test set 1.063x speedup, val set 5.473x speedup, step: 1, train time 9.08 s
Epoch 5/50 |loss: 0.173549| train set 5.109x speedup, test set 1.062x speedup, val set 5.300x speedup, step: 2, train time 9.07 s
Epoch 6/50 |loss: 0.158757| train set 5.054x speedup, test set 0.872x speedup, val set 5.241x speedup, step: 3, train time 9.29 s
Epoch 7/50 |loss: 0.159354| train set 5.222x speedup, test set 1.120x speedup, val set 5.470x speedup, step: 4, train time 8.98 s
Epoch 8/50 |loss: 0.157287| train set 5.224x speedup, test set 0.843x speedup, val set 5.473x speedup, step: 5, train time 9.08 s
Epoch 9/50 |loss: 0.148593| train set 5.249x speedup, test set 0.870x speedup, val set 5.487x speedup, step: 1, train time 9.29 s
Epoch 10/50 |loss: 0.144881| train set 5.226x speedup, test set 0.870x speedup, val set 5.457x speedup, step: 2, train time 9.28 s
Epoch 11/50 |loss: 0.145220| train set 5.186x speedup, test set 0.841x speedup, val set 5.375x speedup, step: 3, train time 9.10 s
Epoch 12/50 |loss: 0.144149| train set 5.224x speedup, test set 1.062x speedup, val set 5.473x speedup, step: 4, train time 9.21 s
Epoch 13/50 |loss: 0.142247| train set 5.170x speedup, test set 0.839x speedup, val set 5.408x speedup, step: 5, train time 9.01 s
Epoch 14/50 |loss: 0.135812| train set 5.211x speedup, test set 0.868x speedup, val set 5.389x speedup, step: 6, train time 9.22 s
Epoch 15/50 |loss: 0.137470| train set 4.978x speedup, test set 0.841x speedup, val set 5.218x speedup, step: 7, train time 9.11 s
Epoch 16/50 |loss: 0.135937| train set 5.249x speedup, test set 0.843x speedup, val set 5.487x speedup, step: 8, train time 9.18 s
Epoch 17/50 |loss: 0.132803| train set 5.224x speedup, test set 0.841x speedup, val set 5.473x speedup, step: 9, train time 9.09 s
Epoch 18/50 |loss: 0.131796| train set 5.248x speedup, test set 0.841x speedup, val set 5.489x speedup, step: 10, train time 9.11 s
Epoch 19/50 |loss: 0.135221| train set 5.249x speedup, test set 0.869x speedup, val set 5.487x speedup, step: 1, train time 9.31 s
Epoch 20/50 |loss: 0.134937| train set 5.249x speedup, test set 0.869x speedup, val set 5.487x speedup, step: 2, train time 8.97 s
Epoch 21/50 |loss: 0.132033| train set 5.224x speedup, test set 0.843x speedup, val set 5.473x speedup, step: 3, train time 9.49 s
Epoch 22/50 |loss: 0.130395| train set 5.211x speedup, test set 0.841x speedup, val set 5.389x speedup, step: 4, train time 9.11 s
Epoch 23/50 |loss: 0.128720| train set 5.224x speedup, test set 0.843x speedup, val set 5.473x speedup, step: 5, train time 9.11 s
Epoch 24/50 |loss: 0.129385| train set 5.249x speedup, test set 0.830x speedup, val set 5.455x speedup, step: 6, train time 9.07 s
Epoch 25/50 |loss: 0.130660| train set 5.211x speedup, test set 0.838x speedup, val set 5.389x speedup, step: 7, train time 8.98 s
Epoch 26/50 |loss: 0.130124| train set 5.249x speedup, test set 0.843x speedup, val set 5.487x speedup, step: 8, train time 9.49 s
Epoch 27/50 |loss: 0.127861| train set 5.244x speedup, test set 0.843x speedup, val set 5.479x speedup, step: 9, train time 9.26 s
Epoch 28/50 |loss: 0.127874| train set 5.249x speedup, test set 0.843x speedup, val set 5.487x speedup, step: 10, train time 9.36 s
Epoch 29/50 |loss: 0.124823| train set 5.186x speedup, test set 0.830x speedup, val set 5.375x speedup, step: 11, train time 9.31 s
Epoch 30/50 |loss: 0.125936| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 12, train time 8.91 s
Epoch 31/50 |loss: 0.125315| train set 5.186x speedup, test set 0.830x speedup, val set 5.375x speedup, step: 13, train time 9.51 s
Epoch 32/50 |loss: 0.128765| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 14, train time 9.19 s
Epoch 33/50 |loss: 0.127053| train set 5.185x speedup, test set 0.830x speedup, val set 5.373x speedup, step: 15, train time 9.08 s
Epoch 34/50 |loss: 0.123689| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1, train time 9.01 s
Epoch 35/50 |loss: 0.126190| train set 5.186x speedup, test set 0.839x speedup, val set 5.375x speedup, step: 2, train time 8.99 s
Epoch 36/50 |loss: 0.127325| train set 5.188x speedup, test set 0.828x speedup, val set 5.360x speedup, step: 3, train time 9.39 s
Epoch 37/50 |loss: 0.127967| train set 5.249x speedup, test set 0.816x speedup, val set 5.487x speedup, step: 4, train time 9.48 s
Epoch 38/50 |loss: 0.123927| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 5, train time 9.31 s
Epoch 39/50 |loss: 0.121643| train set 5.186x speedup, test set 0.830x speedup, val set 5.375x speedup, step: 6, train time 9.30 s
Epoch 40/50 |loss: 0.120366| train set 5.224x speedup, test set 1.072x speedup, val set 5.473x speedup, step: 7, train time 9.30 s
Epoch 41/50 |loss: 0.121620| train set 5.249x speedup, test set 0.845x speedup, val set 5.487x speedup, step: 8, train time 9.12 s
Epoch 42/50 |loss: 0.124346| train set 5.224x speedup, test set 0.844x speedup, val set 5.473x speedup, step: 9, train time 9.48 s
Epoch 43/50 |loss: 0.124504| train set 5.247x speedup, test set 0.843x speedup, val set 5.484x speedup, step: 10, train time 9.31 s
early stopping at epoch 43
Training per epoch cost 9.226 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.738s, pg runtime 0.738s, speedup 1.000x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 24, train speedup 5.249, test speedup 0.830, val speedup 5.455
best test speedup epoch: 3, train speedup 5.010, test speedup 1.158, val speedup 5.088
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.829, val speedup 5.487
last model at epoch 43, train speedup 5.247, test speedup 0.843, val speedup 5.484
execution cost 0:07:14.371156
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.562949, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.390740| train set 4.608x speedup, test set 1.147x speedup, val set 4.731x speedup, step: 1, train time 10.15 s
Epoch 1/50 |loss: 0.246790| train set 4.957x speedup, test set 1.151x speedup, val set 5.044x speedup, step: 2, train time 8.76 s
Epoch 2/50 |loss: 0.201528| train set 5.228x speedup, test set 1.066x speedup, val set 5.461x speedup, step: 3, train time 8.50 s
Epoch 3/50 |loss: 0.188504| train set 5.029x speedup, test set 1.049x speedup, val set 5.112x speedup, step: 4, train time 8.99 s
Epoch 4/50 |loss: 0.176398| train set 5.101x speedup, test set 1.173x speedup, val set 5.344x speedup, step: 1, train time 8.59 s
Epoch 5/50 |loss: 0.169014| train set 5.224x speedup, test set 1.135x speedup, val set 5.473x speedup, step: 2, train time 8.69 s
Epoch 6/50 |loss: 0.162613| train set 5.223x speedup, test set 0.865x speedup, val set 5.476x speedup, step: 3, train time 9.00 s
Epoch 7/50 |loss: 0.156998| train set 5.222x speedup, test set 1.232x speedup, val set 5.470x speedup, step: 4, train time 8.71 s
Epoch 8/50 |loss: 0.157034| train set 5.224x speedup, test set 1.058x speedup, val set 5.473x speedup, step: 5, train time 8.67 s
Epoch 9/50 |loss: 0.149777| train set 5.249x speedup, test set 1.108x speedup, val set 5.487x speedup, step: 1, train time 8.80 s
Epoch 10/50 |loss: 0.144747| train set 5.226x speedup, test set 1.044x speedup, val set 5.457x speedup, step: 2, train time 8.68 s
Epoch 11/50 |loss: 0.143763| train set 5.186x speedup, test set 1.227x speedup, val set 5.375x speedup, step: 3, train time 8.57 s
Epoch 12/50 |loss: 0.143536| train set 5.224x speedup, test set 1.063x speedup, val set 5.473x speedup, step: 4, train time 9.02 s
Epoch 13/50 |loss: 0.142421| train set 5.249x speedup, test set 1.115x speedup, val set 5.487x speedup, step: 5, train time 8.88 s
Epoch 14/50 |loss: 0.136465| train set 5.209x speedup, test set 0.872x speedup, val set 5.389x speedup, step: 6, train time 8.69 s
Epoch 15/50 |loss: 0.136999| train set 4.978x speedup, test set 0.872x speedup, val set 5.213x speedup, step: 7, train time 8.79 s
Epoch 16/50 |loss: 0.136498| train set 5.249x speedup, test set 0.872x speedup, val set 5.487x speedup, step: 8, train time 9.00 s
Epoch 17/50 |loss: 0.133356| train set 5.222x speedup, test set 0.864x speedup, val set 5.470x speedup, step: 9, train time 8.37 s
Epoch 18/50 |loss: 0.131538| train set 5.210x speedup, test set 0.867x speedup, val set 5.391x speedup, step: 10, train time 8.81 s
Epoch 19/50 |loss: 0.134194| train set 5.249x speedup, test set 0.852x speedup, val set 5.487x speedup, step: 1, train time 8.79 s
Epoch 20/50 |loss: 0.133770| train set 5.247x speedup, test set 0.862x speedup, val set 5.484x speedup, step: 2, train time 8.61 s
Epoch 21/50 |loss: 0.132207| train set 5.224x speedup, test set 0.862x speedup, val set 5.473x speedup, step: 3, train time 9.00 s
Epoch 22/50 |loss: 0.129722| train set 5.211x speedup, test set 0.872x speedup, val set 5.389x speedup, step: 4, train time 8.62 s
Epoch 23/50 |loss: 0.129054| train set 5.224x speedup, test set 0.857x speedup, val set 5.473x speedup, step: 5, train time 8.70 s
Epoch 24/50 |loss: 0.129847| train set 5.249x speedup, test set 0.821x speedup, val set 5.455x speedup, step: 6, train time 8.61 s
Epoch 25/50 |loss: 0.131287| train set 5.186x speedup, test set 0.826x speedup, val set 5.375x speedup, step: 7, train time 8.60 s
Epoch 26/50 |loss: 0.129658| train set 5.249x speedup, test set 0.852x speedup, val set 5.487x speedup, step: 8, train time 8.82 s
Epoch 27/50 |loss: 0.128741| train set 5.206x speedup, test set 0.831x speedup, val set 5.381x speedup, step: 9, train time 8.68 s
Epoch 28/50 |loss: 0.128160| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 10, train time 8.61 s
Epoch 29/50 |loss: 0.124348| train set 5.185x speedup, test set 0.861x speedup, val set 5.373x speedup, step: 11, train time 8.81 s
Epoch 30/50 |loss: 0.125892| train set 5.249x speedup, test set 0.875x speedup, val set 5.487x speedup, step: 12, train time 8.71 s
Epoch 31/50 |loss: 0.124871| train set 5.211x speedup, test set 0.848x speedup, val set 5.389x speedup, step: 13, train time 8.99 s
Epoch 32/50 |loss: 0.127468| train set 5.211x speedup, test set 0.869x speedup, val set 5.389x speedup, step: 14, train time 8.69 s
Epoch 33/50 |loss: 0.126766| train set 5.185x speedup, test set 0.849x speedup, val set 5.373x speedup, step: 15, train time 8.57 s
Epoch 34/50 |loss: 0.125202| train set 5.249x speedup, test set 0.835x speedup, val set 5.487x speedup, step: 1, train time 8.78 s
Epoch 35/50 |loss: 0.124820| train set 5.186x speedup, test set 0.842x speedup, val set 5.375x speedup, step: 2, train time 8.70 s
Epoch 36/50 |loss: 0.126643| train set 5.186x speedup, test set 0.845x speedup, val set 5.375x speedup, step: 3, train time 8.88 s
Epoch 37/50 |loss: 0.128483| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 4, train time 8.80 s
Epoch 38/50 |loss: 0.124512| train set 5.249x speedup, test set 0.866x speedup, val set 5.487x speedup, step: 5, train time 8.59 s
early stopping at epoch 38
Training per epoch cost 8.775 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.603s, pg runtime 5.521s, speedup 0.985x
====================
best train speedup epoch: 24, train speedup 5.249, test speedup 0.821, val speedup 5.455
best test speedup epoch: 7, train speedup 5.222, test speedup 1.232, val speedup 5.470
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.835, val speedup 5.487
last model at epoch 38, train speedup 5.249, test speedup 0.866, val speedup 5.487
execution cost 0:06:09.094169
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.532600, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.392036| train set 4.538x speedup, test set 1.089x speedup, val set 4.643x speedup, step: 1, train time 10.11 s
Epoch 1/50 |loss: 0.244229| train set 4.577x speedup, test set 1.073x speedup, val set 4.624x speedup, step: 2, train time 9.10 s
Epoch 2/50 |loss: 0.205030| train set 5.249x speedup, test set 1.046x speedup, val set 5.487x speedup, step: 3, train time 9.00 s
Epoch 3/50 |loss: 0.187263| train set 4.935x speedup, test set 1.178x speedup, val set 5.032x speedup, step: 4, train time 9.08 s
Epoch 4/50 |loss: 0.178330| train set 5.101x speedup, test set 1.123x speedup, val set 5.344x speedup, step: 1, train time 9.28 s
Epoch 5/50 |loss: 0.169841| train set 4.803x speedup, test set 1.036x speedup, val set 5.004x speedup, step: 2, train time 8.88 s
Epoch 6/50 |loss: 0.160740| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 3, train time 9.08 s
Epoch 7/50 |loss: 0.156554| train set 5.222x speedup, test set 1.067x speedup, val set 5.470x speedup, step: 4, train time 8.88 s
Epoch 8/50 |loss: 0.158665| train set 5.224x speedup, test set 1.047x speedup, val set 5.473x speedup, step: 5, train time 9.38 s
Epoch 9/50 |loss: 0.147256| train set 5.249x speedup, test set 1.048x speedup, val set 5.487x speedup, step: 1, train time 9.31 s
Epoch 10/50 |loss: 0.147126| train set 5.226x speedup, test set 1.050x speedup, val set 5.457x speedup, step: 2, train time 9.28 s
Epoch 11/50 |loss: 0.142467| train set 5.186x speedup, test set 1.052x speedup, val set 5.375x speedup, step: 3, train time 9.08 s
Epoch 12/50 |loss: 0.142341| train set 5.224x speedup, test set 1.201x speedup, val set 5.473x speedup, step: 4, train time 9.18 s
Epoch 13/50 |loss: 0.141886| train set 5.170x speedup, test set 1.050x speedup, val set 5.408x speedup, step: 5, train time 9.26 s
Epoch 14/50 |loss: 0.137222| train set 5.212x speedup, test set 0.836x speedup, val set 5.376x speedup, step: 6, train time 9.08 s
Epoch 15/50 |loss: 0.137187| train set 4.978x speedup, test set 0.839x speedup, val set 5.213x speedup, step: 7, train time 9.29 s
Epoch 16/50 |loss: 0.136764| train set 5.224x speedup, test set 0.838x speedup, val set 5.473x speedup, step: 8, train time 9.28 s
Epoch 17/50 |loss: 0.133414| train set 5.224x speedup, test set 1.052x speedup, val set 5.473x speedup, step: 9, train time 9.20 s
Epoch 18/50 |loss: 0.132222| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 10, train time 9.19 s
Epoch 19/50 |loss: 0.134264| train set 5.249x speedup, test set 1.025x speedup, val set 5.487x speedup, step: 1, train time 9.29 s
Epoch 20/50 |loss: 0.134978| train set 5.249x speedup, test set 1.179x speedup, val set 5.487x speedup, step: 2, train time 9.01 s
Epoch 21/50 |loss: 0.131600| train set 5.018x speedup, test set 0.838x speedup, val set 5.312x speedup, step: 3, train time 9.59 s
Epoch 22/50 |loss: 0.130199| train set 5.211x speedup, test set 0.838x speedup, val set 5.389x speedup, step: 4, train time 9.30 s
Epoch 23/50 |loss: 0.130170| train set 5.224x speedup, test set 0.817x speedup, val set 5.473x speedup, step: 5, train time 9.32 s
Epoch 24/50 |loss: 0.129595| train set 5.211x speedup, test set 0.828x speedup, val set 5.358x speedup, step: 6, train time 9.60 s
Epoch 25/50 |loss: 0.131912| train set 5.186x speedup, test set 0.817x speedup, val set 5.375x speedup, step: 7, train time 9.11 s
Epoch 26/50 |loss: 0.130532| train set 5.249x speedup, test set 0.833x speedup, val set 5.487x speedup, step: 8, train time 8.90 s
Epoch 27/50 |loss: 0.128143| train set 5.219x speedup, test set 0.820x speedup, val set 5.465x speedup, step: 9, train time 9.18 s
Epoch 28/50 |loss: 0.128103| train set 5.249x speedup, test set 0.839x speedup, val set 5.487x speedup, step: 10, train time 8.99 s
Epoch 29/50 |loss: 0.124907| train set 5.224x speedup, test set 0.825x speedup, val set 5.473x speedup, step: 11, train time 8.99 s
Epoch 30/50 |loss: 0.126635| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 12, train time 9.09 s
Epoch 31/50 |loss: 0.124547| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 13, train time 9.28 s
Epoch 32/50 |loss: 0.128339| train set 5.211x speedup, test set 0.841x speedup, val set 5.389x speedup, step: 14, train time 9.08 s
Epoch 33/50 |loss: 0.126652| train set 5.185x speedup, test set 0.825x speedup, val set 5.373x speedup, step: 15, train time 9.28 s
Epoch 34/50 |loss: 0.125427| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1, train time 9.20 s
Epoch 35/50 |loss: 0.127029| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 2, train time 9.21 s
Epoch 36/50 |loss: 0.125993| train set 5.186x speedup, test set 0.821x speedup, val set 5.375x speedup, step: 3, train time 9.17 s
Epoch 37/50 |loss: 0.129041| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 4, train time 8.98 s
Epoch 38/50 |loss: 0.125624| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 5, train time 9.17 s
early stopping at epoch 38
Training per epoch cost 9.198 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 2, train speedup 5.249, test speedup 1.046, val speedup 5.487
best test speedup epoch: 12, train speedup 5.224, test speedup 1.201, val speedup 5.473
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.822, val speedup 5.487
last model at epoch 38, train speedup 5.211, test speedup 0.827, val speedup 5.389
execution cost 0:06:23.969724
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.535061, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.391027| train set 4.346x speedup, test set 1.214x speedup, val set 4.638x speedup, step: 1, train time 9.90 s
Epoch 1/50 |loss: 0.245560| train set 4.803x speedup, test set 1.240x speedup, val set 4.846x speedup, step: 2, train time 8.59 s
Epoch 2/50 |loss: 0.202274| train set 5.228x speedup, test set 1.115x speedup, val set 5.461x speedup, step: 3, train time 8.78 s
Epoch 3/50 |loss: 0.188916| train set 4.988x speedup, test set 1.104x speedup, val set 5.076x speedup, step: 4, train time 8.87 s
Epoch 4/50 |loss: 0.177881| train set 5.101x speedup, test set 1.126x speedup, val set 5.344x speedup, step: 1, train time 8.71 s
Epoch 5/50 |loss: 0.170839| train set 5.249x speedup, test set 0.817x speedup, val set 5.487x speedup, step: 2, train time 8.77 s
Epoch 6/50 |loss: 0.159416| train set 5.223x speedup, test set 0.821x speedup, val set 5.476x speedup, step: 3, train time 8.80 s
Epoch 7/50 |loss: 0.157604| train set 5.222x speedup, test set 1.113x speedup, val set 5.470x speedup, step: 4, train time 8.78 s
Epoch 8/50 |loss: 0.154409| train set 5.224x speedup, test set 1.005x speedup, val set 5.473x speedup, step: 5, train time 8.67 s
Epoch 9/50 |loss: 0.147162| train set 5.249x speedup, test set 1.033x speedup, val set 5.487x speedup, step: 1, train time 8.58 s
Epoch 10/50 |loss: 0.145832| train set 5.226x speedup, test set 0.823x speedup, val set 5.457x speedup, step: 2, train time 8.67 s
Epoch 11/50 |loss: 0.143813| train set 5.186x speedup, test set 1.108x speedup, val set 5.375x speedup, step: 3, train time 8.67 s
Epoch 12/50 |loss: 0.141766| train set 5.224x speedup, test set 1.138x speedup, val set 5.473x speedup, step: 4, train time 8.44 s
Epoch 13/50 |loss: 0.141322| train set 5.249x speedup, test set 1.067x speedup, val set 5.487x speedup, step: 5, train time 8.48 s
Epoch 14/50 |loss: 0.134998| train set 5.213x speedup, test set 0.838x speedup, val set 5.373x speedup, step: 6, train time 8.83 s
Epoch 15/50 |loss: 0.135506| train set 4.978x speedup, test set 0.811x speedup, val set 5.213x speedup, step: 7, train time 9.00 s
Epoch 16/50 |loss: 0.135798| train set 5.249x speedup, test set 0.818x speedup, val set 5.487x speedup, step: 8, train time 8.59 s
Epoch 17/50 |loss: 0.132101| train set 5.222x speedup, test set 0.816x speedup, val set 5.470x speedup, step: 9, train time 8.68 s
Epoch 18/50 |loss: 0.131819| train set 5.249x speedup, test set 0.831x speedup, val set 5.487x speedup, step: 10, train time 8.59 s
Epoch 19/50 |loss: 0.134974| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1, train time 8.79 s
Epoch 20/50 |loss: 0.133660| train set 5.249x speedup, test set 1.100x speedup, val set 5.487x speedup, step: 2, train time 8.69 s
Epoch 21/50 |loss: 0.132302| train set 5.224x speedup, test set 0.869x speedup, val set 5.473x speedup, step: 3, train time 9.30 s
Epoch 22/50 |loss: 0.130569| train set 5.213x speedup, test set 0.835x speedup, val set 5.373x speedup, step: 4, train time 8.79 s
Epoch 23/50 |loss: 0.131094| train set 5.224x speedup, test set 1.046x speedup, val set 5.473x speedup, step: 5, train time 8.79 s
Epoch 24/50 |loss: 0.129246| train set 5.247x speedup, test set 0.838x speedup, val set 5.453x speedup, step: 6, train time 8.79 s
Epoch 25/50 |loss: 0.129682| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 7, train time 8.93 s
Epoch 26/50 |loss: 0.128753| train set 5.249x speedup, test set 0.851x speedup, val set 5.487x speedup, step: 8, train time 8.61 s
Epoch 27/50 |loss: 0.130368| train set 5.186x speedup, test set 0.801x speedup, val set 5.375x speedup, step: 9, train time 8.69 s
Epoch 28/50 |loss: 0.126075| train set 5.249x speedup, test set 0.796x speedup, val set 5.487x speedup, step: 10, train time 8.82 s
Epoch 29/50 |loss: 0.123670| train set 5.185x speedup, test set 0.805x speedup, val set 5.373x speedup, step: 11, train time 8.82 s
Epoch 30/50 |loss: 0.124154| train set 5.249x speedup, test set 0.846x speedup, val set 5.487x speedup, step: 12, train time 8.68 s
Epoch 31/50 |loss: 0.123770| train set 5.186x speedup, test set 0.799x speedup, val set 5.375x speedup, step: 13, train time 8.78 s
Epoch 32/50 |loss: 0.126925| train set 5.211x speedup, test set 0.831x speedup, val set 5.389x speedup, step: 14, train time 8.52 s
Epoch 33/50 |loss: 0.126204| train set 5.185x speedup, test set 0.799x speedup, val set 5.373x speedup, step: 15, train time 8.72 s
Epoch 34/50 |loss: 0.123521| train set 5.249x speedup, test set 0.836x speedup, val set 5.487x speedup, step: 1, train time 8.58 s
Epoch 35/50 |loss: 0.123868| train set 5.186x speedup, test set 1.079x speedup, val set 5.375x speedup, step: 2, train time 8.76 s
Epoch 36/50 |loss: 0.124297| train set 5.186x speedup, test set 0.860x speedup, val set 5.375x speedup, step: 3, train time 8.69 s
Epoch 37/50 |loss: 0.126681| train set 5.249x speedup, test set 1.193x speedup, val set 5.487x speedup, step: 4, train time 8.88 s
Epoch 38/50 |loss: 0.124599| train set 5.211x speedup, test set 0.850x speedup, val set 5.389x speedup, step: 5, train time 8.69 s
early stopping at epoch 38
Training per epoch cost 8.762 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 5, train speedup 5.249, test speedup 0.817, val speedup 5.487
best test speedup epoch: 1, train speedup 4.803, test speedup 1.240, val speedup 4.846
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.836, val speedup 5.487
last model at epoch 38, train speedup 5.211, test speedup 0.850, val speedup 5.389
execution cost 0:06:08.492267
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.546322, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.390857| train set 4.608x speedup, test set 1.143x speedup, val set 4.731x speedup, step: 1, train time 10.31 s
Epoch 1/50 |loss: 0.247912| train set 4.577x speedup, test set 1.069x speedup, val set 4.626x speedup, step: 2, train time 9.19 s
Epoch 2/50 |loss: 0.206800| train set 5.248x speedup, test set 1.040x speedup, val set 5.489x speedup, step: 3, train time 9.26 s
Epoch 3/50 |loss: 0.188050| train set 5.029x speedup, test set 1.162x speedup, val set 5.115x speedup, step: 4, train time 9.38 s
Epoch 4/50 |loss: 0.179854| train set 5.224x speedup, test set 1.141x speedup, val set 5.473x speedup, step: 1, train time 9.16 s
Epoch 5/50 |loss: 0.172000| train set 5.186x speedup, test set 1.018x speedup, val set 5.375x speedup, step: 2, train time 9.20 s
Epoch 6/50 |loss: 0.165379| train set 5.223x speedup, test set 1.003x speedup, val set 5.476x speedup, step: 3, train time 9.22 s
Epoch 7/50 |loss: 0.156270| train set 5.222x speedup, test set 1.031x speedup, val set 5.470x speedup, step: 4, train time 9.18 s
Epoch 8/50 |loss: 0.158114| train set 5.224x speedup, test set 1.077x speedup, val set 5.473x speedup, step: 5, train time 9.19 s
Epoch 9/50 |loss: 0.149963| train set 5.249x speedup, test set 1.076x speedup, val set 5.487x speedup, step: 1, train time 9.39 s
Epoch 10/50 |loss: 0.145852| train set 5.251x speedup, test set 1.060x speedup, val set 5.471x speedup, step: 2, train time 9.08 s
Epoch 11/50 |loss: 0.145862| train set 5.186x speedup, test set 1.082x speedup, val set 5.375x speedup, step: 3, train time 9.41 s
Epoch 12/50 |loss: 0.144595| train set 5.224x speedup, test set 1.142x speedup, val set 5.473x speedup, step: 4, train time 9.31 s
Epoch 13/50 |loss: 0.141580| train set 5.211x speedup, test set 1.023x speedup, val set 5.389x speedup, step: 5, train time 9.11 s
Epoch 14/50 |loss: 0.137852| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 6, train time 8.80 s
Epoch 15/50 |loss: 0.137160| train set 4.978x speedup, test set 1.018x speedup, val set 5.213x speedup, step: 7, train time 9.39 s
Epoch 16/50 |loss: 0.137161| train set 5.224x speedup, test set 1.029x speedup, val set 5.473x speedup, step: 8, train time 9.11 s
Epoch 17/50 |loss: 0.132780| train set 5.185x speedup, test set 1.018x speedup, val set 5.373x speedup, step: 9, train time 9.00 s
Epoch 18/50 |loss: 0.133305| train set 5.249x speedup, test set 1.040x speedup, val set 5.487x speedup, step: 10, train time 9.30 s
Epoch 19/50 |loss: 0.135673| train set 5.249x speedup, test set 1.034x speedup, val set 5.487x speedup, step: 1, train time 9.37 s
Epoch 20/50 |loss: 0.135189| train set 5.249x speedup, test set 1.062x speedup, val set 5.487x speedup, step: 2, train time 8.84 s
Epoch 21/50 |loss: 0.134175| train set 5.018x speedup, test set 1.093x speedup, val set 5.312x speedup, step: 3, train time 9.41 s
Epoch 22/50 |loss: 0.130336| train set 5.211x speedup, test set 1.040x speedup, val set 5.389x speedup, step: 4, train time 9.51 s
Epoch 23/50 |loss: 0.130893| train set 5.224x speedup, test set 1.014x speedup, val set 5.473x speedup, step: 5, train time 9.41 s
Epoch 24/50 |loss: 0.129465| train set 5.213x speedup, test set 0.794x speedup, val set 5.373x speedup, step: 6, train time 8.90 s
Epoch 25/50 |loss: 0.131317| train set 5.186x speedup, test set 0.801x speedup, val set 5.375x speedup, step: 7, train time 9.01 s
Epoch 26/50 |loss: 0.129233| train set 5.249x speedup, test set 1.012x speedup, val set 5.487x speedup, step: 8, train time 9.20 s
Epoch 27/50 |loss: 0.128748| train set 5.219x speedup, test set 1.006x speedup, val set 5.465x speedup, step: 9, train time 9.29 s
Epoch 28/50 |loss: 0.129128| train set 5.249x speedup, test set 0.789x speedup, val set 5.487x speedup, step: 10, train time 8.89 s
Epoch 29/50 |loss: 0.124841| train set 5.222x speedup, test set 0.796x speedup, val set 5.470x speedup, step: 11, train time 9.18 s
Epoch 30/50 |loss: 0.126391| train set 5.249x speedup, test set 1.000x speedup, val set 5.487x speedup, step: 12, train time 9.18 s
Epoch 31/50 |loss: 0.124513| train set 5.186x speedup, test set 1.016x speedup, val set 5.375x speedup, step: 13, train time 9.00 s
Epoch 32/50 |loss: 0.128252| train set 5.211x speedup, test set 0.789x speedup, val set 5.389x speedup, step: 14, train time 8.98 s
Epoch 33/50 |loss: 0.126330| train set 5.185x speedup, test set 0.805x speedup, val set 5.373x speedup, step: 15, train time 9.19 s
Epoch 34/50 |loss: 0.124232| train set 5.249x speedup, test set 0.805x speedup, val set 5.487x speedup, step: 1, train time 9.12 s
Epoch 35/50 |loss: 0.124606| train set 5.211x speedup, test set 0.995x speedup, val set 5.389x speedup, step: 2, train time 9.09 s
Epoch 36/50 |loss: 0.125391| train set 5.186x speedup, test set 0.792x speedup, val set 5.375x speedup, step: 3, train time 9.31 s
Epoch 37/50 |loss: 0.128501| train set 5.249x speedup, test set 1.036x speedup, val set 5.487x speedup, step: 4, train time 9.51 s
Epoch 38/50 |loss: 0.124555| train set 5.211x speedup, test set 0.798x speedup, val set 5.389x speedup, step: 5, train time 9.11 s
Epoch 39/50 |loss: 0.121724| train set 5.186x speedup, test set 0.805x speedup, val set 5.375x speedup, step: 6, train time 9.17 s
Epoch 40/50 |loss: 0.120689| train set 5.224x speedup, test set 1.043x speedup, val set 5.473x speedup, step: 7, train time 9.09 s
Epoch 41/50 |loss: 0.122413| train set 5.249x speedup, test set 0.995x speedup, val set 5.487x speedup, step: 8, train time 9.21 s
Epoch 42/50 |loss: 0.122309| train set 5.224x speedup, test set 0.807x speedup, val set 5.473x speedup, step: 9, train time 9.16 s
Epoch 43/50 |loss: 0.121942| train set 5.209x speedup, test set 0.995x speedup, val set 5.386x speedup, step: 10, train time 8.77 s
Epoch 44/50 |loss: 0.122582| train set 5.249x speedup, test set 1.060x speedup, val set 5.487x speedup, step: 1, train time 9.21 s
Epoch 45/50 |loss: 0.121651| train set 5.211x speedup, test set 1.064x speedup, val set 5.389x speedup, step: 2, train time 8.91 s
Epoch 46/50 |loss: 0.118676| train set 5.251x speedup, test set 1.055x speedup, val set 5.471x speedup, step: 3, train time 9.21 s
Epoch 47/50 |loss: 0.122169| train set 5.211x speedup, test set 1.055x speedup, val set 5.389x speedup, step: 4, train time 9.08 s
Epoch 48/50 |loss: 0.122238| train set 5.249x speedup, test set 1.041x speedup, val set 5.487x speedup, step: 5, train time 9.30 s
early stopping at epoch 48
Training per epoch cost 9.196 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 10, train speedup 5.251, test speedup 1.060, val speedup 5.471
best test speedup epoch: 3, train speedup 5.029, test speedup 1.162, val speedup 5.115
best validation speedup epoch: 44, train speedup 5.249, test speedup 1.060, val speedup 5.487
last model at epoch 48, train speedup 5.249, test speedup 1.041, val speedup 5.487
execution cost 0:08:01.960731
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.550611, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.392190| train set 4.611x speedup, test set 1.037x speedup, val set 4.766x speedup, step: 1, train time 10.23 s
Epoch 1/50 |loss: 0.245349| train set 4.804x speedup, test set 1.022x speedup, val set 4.844x speedup, step: 2, train time 9.31 s
Epoch 2/50 |loss: 0.206856| train set 5.248x speedup, test set 1.023x speedup, val set 5.489x speedup, step: 3, train time 8.91 s
Epoch 3/50 |loss: 0.186869| train set 5.010x speedup, test set 1.147x speedup, val set 5.088x speedup, step: 4, train time 9.10 s
Epoch 4/50 |loss: 0.179207| train set 5.223x speedup, test set 1.142x speedup, val set 5.476x speedup, step: 1, train time 9.33 s
Epoch 5/50 |loss: 0.176457| train set 5.109x speedup, test set 1.029x speedup, val set 5.300x speedup, step: 2, train time 9.19 s
Epoch 6/50 |loss: 0.161154| train set 5.223x speedup, test set 0.830x speedup, val set 5.476x speedup, step: 3, train time 9.08 s
Epoch 7/50 |loss: 0.157875| train set 5.222x speedup, test set 0.855x speedup, val set 5.470x speedup, step: 4, train time 9.20 s
Epoch 8/50 |loss: 0.162023| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 5, train time 9.41 s
Epoch 9/50 |loss: 0.148824| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1, train time 9.38 s
Epoch 10/50 |loss: 0.144626| train set 5.226x speedup, test set 0.829x speedup, val set 5.457x speedup, step: 2, train time 9.17 s
Epoch 11/50 |loss: 0.143772| train set 5.186x speedup, test set 0.876x speedup, val set 5.375x speedup, step: 3, train time 9.08 s
Epoch 12/50 |loss: 0.141849| train set 5.224x speedup, test set 0.858x speedup, val set 5.473x speedup, step: 4, train time 9.30 s
Epoch 13/50 |loss: 0.141990| train set 5.133x speedup, test set 0.843x speedup, val set 5.313x speedup, step: 5, train time 9.11 s
Epoch 14/50 |loss: 0.137135| train set 5.213x speedup, test set 0.847x speedup, val set 5.373x speedup, step: 6, train time 9.38 s
Epoch 15/50 |loss: 0.136877| train set 4.959x speedup, test set 0.862x speedup, val set 5.193x speedup, step: 7, train time 9.11 s
Epoch 16/50 |loss: 0.136169| train set 5.224x speedup, test set 0.829x speedup, val set 5.473x speedup, step: 8, train time 9.09 s
Epoch 17/50 |loss: 0.132839| train set 5.224x speedup, test set 0.829x speedup, val set 5.473x speedup, step: 9, train time 9.19 s
Epoch 18/50 |loss: 0.131018| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 10, train time 9.19 s
Epoch 19/50 |loss: 0.134707| train set 5.249x speedup, test set 0.836x speedup, val set 5.487x speedup, step: 1, train time 8.99 s
Epoch 20/50 |loss: 0.134509| train set 5.249x speedup, test set 0.863x speedup, val set 5.487x speedup, step: 2, train time 8.90 s
Epoch 21/50 |loss: 0.131744| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 3, train time 9.78 s
Epoch 22/50 |loss: 0.129849| train set 5.211x speedup, test set 0.834x speedup, val set 5.389x speedup, step: 4, train time 9.42 s
Epoch 23/50 |loss: 0.131073| train set 5.224x speedup, test set 0.836x speedup, val set 5.473x speedup, step: 5, train time 8.89 s
Epoch 24/50 |loss: 0.128690| train set 5.249x speedup, test set 0.841x speedup, val set 5.455x speedup, step: 6, train time 9.19 s
Epoch 25/50 |loss: 0.131825| train set 5.211x speedup, test set 0.839x speedup, val set 5.389x speedup, step: 7, train time 9.32 s
Epoch 26/50 |loss: 0.129432| train set 5.247x speedup, test set 0.818x speedup, val set 5.484x speedup, step: 8, train time 9.31 s
Epoch 27/50 |loss: 0.128031| train set 5.244x speedup, test set 0.817x speedup, val set 5.479x speedup, step: 9, train time 9.10 s
Epoch 28/50 |loss: 0.127836| train set 5.249x speedup, test set 0.839x speedup, val set 5.487x speedup, step: 10, train time 8.90 s
Epoch 29/50 |loss: 0.124133| train set 5.224x speedup, test set 0.834x speedup, val set 5.473x speedup, step: 11, train time 9.29 s
Epoch 30/50 |loss: 0.124923| train set 5.249x speedup, test set 0.836x speedup, val set 5.487x speedup, step: 12, train time 9.47 s
Epoch 31/50 |loss: 0.124773| train set 5.211x speedup, test set 0.836x speedup, val set 5.389x speedup, step: 13, train time 9.09 s
Epoch 32/50 |loss: 0.128219| train set 5.249x speedup, test set 0.831x speedup, val set 5.487x speedup, step: 14, train time 9.19 s
Epoch 33/50 |loss: 0.126684| train set 5.185x speedup, test set 0.829x speedup, val set 5.373x speedup, step: 15, train time 9.00 s
Epoch 34/50 |loss: 0.123561| train set 5.249x speedup, test set 0.839x speedup, val set 5.487x speedup, step: 1, train time 9.18 s
Epoch 35/50 |loss: 0.125202| train set 5.186x speedup, test set 0.823x speedup, val set 5.375x speedup, step: 2, train time 9.29 s
Epoch 36/50 |loss: 0.125941| train set 5.186x speedup, test set 0.820x speedup, val set 5.375x speedup, step: 3, train time 9.09 s
Epoch 37/50 |loss: 0.127079| train set 5.249x speedup, test set 0.837x speedup, val set 5.487x speedup, step: 4, train time 9.12 s
Epoch 38/50 |loss: 0.124268| train set 5.251x speedup, test set 0.818x speedup, val set 5.471x speedup, step: 5, train time 9.01 s
early stopping at epoch 38
Training per epoch cost 9.212 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 1.481s, pg runtime 4.730s, speedup 3.195x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 5.251, test speedup 0.818, val speedup 5.471
best test speedup epoch: 3, train speedup 5.010, test speedup 1.147, val speedup 5.088
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.839, val speedup 5.487
last model at epoch 38, train speedup 5.251, test speedup 0.818, val speedup 5.471
execution cost 0:06:25.452425
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.536410, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.391823| train set 4.673x speedup, test set 1.018x speedup, val set 4.835x speedup, step: 1, train time 10.28 s
Epoch 1/50 |loss: 0.246307| train set 4.577x speedup, test set 1.029x speedup, val set 4.624x speedup, step: 2, train time 8.82 s
Epoch 2/50 |loss: 0.204462| train set 5.248x speedup, test set 1.072x speedup, val set 5.489x speedup, step: 3, train time 9.32 s
Epoch 3/50 |loss: 0.185800| train set 5.249x speedup, test set 1.093x speedup, val set 5.487x speedup, step: 4, train time 9.19 s
Epoch 4/50 |loss: 0.178239| train set 5.224x speedup, test set 1.155x speedup, val set 5.473x speedup, step: 1, train time 9.00 s
Epoch 5/50 |loss: 0.172834| train set 4.803x speedup, test set 1.066x speedup, val set 5.004x speedup, step: 2, train time 9.07 s
Epoch 6/50 |loss: 0.159901| train set 5.223x speedup, test set 0.828x speedup, val set 5.476x speedup, step: 3, train time 9.33 s
Epoch 7/50 |loss: 0.157279| train set 5.222x speedup, test set 1.070x speedup, val set 5.470x speedup, step: 4, train time 9.00 s
Epoch 8/50 |loss: 0.158077| train set 5.224x speedup, test set 1.037x speedup, val set 5.473x speedup, step: 5, train time 9.21 s
Epoch 9/50 |loss: 0.147564| train set 5.211x speedup, test set 1.030x speedup, val set 5.389x speedup, step: 6, train time 8.98 s
Epoch 10/50 |loss: 0.146042| train set 5.251x speedup, test set 0.836x speedup, val set 5.471x speedup, step: 7, train time 9.29 s
Epoch 11/50 |loss: 0.144433| train set 5.186x speedup, test set 1.026x speedup, val set 5.375x speedup, step: 8, train time 9.19 s
Epoch 12/50 |loss: 0.142127| train set 5.224x speedup, test set 1.043x speedup, val set 5.473x speedup, step: 9, train time 9.40 s
Epoch 13/50 |loss: 0.142272| train set 5.133x speedup, test set 0.830x speedup, val set 5.313x speedup, step: 10, train time 9.16 s
Epoch 14/50 |loss: 0.137055| train set 5.213x speedup, test set 0.826x speedup, val set 5.373x speedup, step: 11, train time 9.10 s
Epoch 15/50 |loss: 0.138536| train set 4.978x speedup, test set 0.828x speedup, val set 5.218x speedup, step: 12, train time 9.08 s
Epoch 16/50 |loss: 0.137303| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 13, train time 8.99 s
Epoch 17/50 |loss: 0.133799| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 14, train time 9.11 s
Epoch 18/50 |loss: 0.133315| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 15, train time 8.98 s
Epoch 19/50 |loss: 0.135955| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1, train time 9.17 s
Epoch 20/50 |loss: 0.136239| train set 5.249x speedup, test set 1.038x speedup, val set 5.487x speedup, step: 2, train time 9.17 s
Epoch 21/50 |loss: 0.133627| train set 5.224x speedup, test set 0.819x speedup, val set 5.473x speedup, step: 3, train time 9.71 s
Epoch 22/50 |loss: 0.129905| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 4, train time 9.21 s
Epoch 23/50 |loss: 0.130212| train set 5.224x speedup, test set 0.819x speedup, val set 5.473x speedup, step: 5, train time 9.20 s
Epoch 24/50 |loss: 0.130302| train set 5.249x speedup, test set 0.827x speedup, val set 5.455x speedup, step: 6, train time 9.28 s
Epoch 25/50 |loss: 0.132086| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 7, train time 9.08 s
Epoch 26/50 |loss: 0.131268| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 8, train time 9.18 s
Epoch 27/50 |loss: 0.127768| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 9, train time 9.28 s
Epoch 28/50 |loss: 0.128395| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 10, train time 9.22 s
Epoch 29/50 |loss: 0.125736| train set 5.186x speedup, test set 0.826x speedup, val set 5.375x speedup, step: 11, train time 8.81 s
Epoch 30/50 |loss: 0.126183| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 12, train time 9.58 s
Epoch 31/50 |loss: 0.124525| train set 5.186x speedup, test set 0.826x speedup, val set 5.375x speedup, step: 13, train time 8.98 s
Epoch 32/50 |loss: 0.128792| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 14, train time 8.88 s
Epoch 33/50 |loss: 0.127874| train set 5.185x speedup, test set 0.826x speedup, val set 5.373x speedup, step: 15, train time 9.38 s
Epoch 34/50 |loss: 0.126145| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1, train time 9.09 s
Epoch 35/50 |loss: 0.126779| train set 5.186x speedup, test set 0.818x speedup, val set 5.375x speedup, step: 2, train time 9.29 s
Epoch 36/50 |loss: 0.126621| train set 5.188x speedup, test set 0.807x speedup, val set 5.360x speedup, step: 3, train time 9.02 s
Epoch 37/50 |loss: 0.128549| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 4, train time 9.11 s
Epoch 38/50 |loss: 0.124813| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 5, train time 9.01 s
Epoch 39/50 |loss: 0.123962| train set 5.188x speedup, test set 0.819x speedup, val set 5.360x speedup, step: 6, train time 8.89 s
Epoch 40/50 |loss: 0.122528| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 7, train time 9.11 s
Epoch 41/50 |loss: 0.123202| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 8, train time 9.60 s
Epoch 42/50 |loss: 0.125244| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 9, train time 8.98 s
Epoch 43/50 |loss: 0.125112| train set 5.247x speedup, test set 0.828x speedup, val set 5.484x speedup, step: 10, train time 9.01 s
Epoch 44/50 |loss: 0.125078| train set 5.211x speedup, test set 0.854x speedup, val set 5.389x speedup, step: 11, train time 9.29 s
Epoch 45/50 |loss: 0.122184| train set 5.213x speedup, test set 0.819x speedup, val set 5.373x speedup, step: 12, train time 9.02 s
Epoch 46/50 |loss: 0.121578| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 13, train time 8.81 s
Epoch 47/50 |loss: 0.124403| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 14, train time 8.92 s
Epoch 48/50 |loss: 0.124713| train set 5.249x speedup, test set 0.816x speedup, val set 5.487x speedup, step: 15, train time 8.98 s
early stopping at epoch 48
Training per epoch cost 9.158 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 3.393s, pg runtime 5.855s, speedup 1.726x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 10, train speedup 5.251, test speedup 0.836, val speedup 5.471
best test speedup epoch: 4, train speedup 5.224, test speedup 1.155, val speedup 5.473
best validation speedup epoch: 34, train speedup 5.249, test speedup 0.828, val speedup 5.487
last model at epoch 48, train speedup 5.249, test speedup 0.816, val speedup 5.487
execution cost 0:07:59.315563
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.532697, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.398531| train set 4.940x speedup, test set 1.132x speedup, val set 5.167x speedup, step: 1, train time 8.95 s
Epoch 1/50 |loss: 0.241543| train set 4.577x speedup, test set 1.164x speedup, val set 4.849x speedup, step: 2, train time 7.69 s
Epoch 2/50 |loss: 0.205840| train set 5.241x speedup, test set 1.176x speedup, val set 5.517x speedup, step: 3, train time 8.02 s
Epoch 3/50 |loss: 0.182776| train set 5.192x speedup, test set 1.223x speedup, val set 5.562x speedup, step: 4, train time 7.88 s
Epoch 4/50 |loss: 0.178679| train set 5.263x speedup, test set 1.208x speedup, val set 5.539x speedup, step: 1, train time 8.18 s
Epoch 5/50 |loss: 0.168524| train set 5.241x speedup, test set 0.819x speedup, val set 5.516x speedup, step: 2, train time 7.77 s
Epoch 6/50 |loss: 0.160681| train set 5.262x speedup, test set 1.125x speedup, val set 5.637x speedup, step: 3, train time 7.69 s
Epoch 7/50 |loss: 0.156651| train set 5.263x speedup, test set 0.846x speedup, val set 5.540x speedup, step: 4, train time 7.87 s
Epoch 8/50 |loss: 0.150597| train set 5.261x speedup, test set 0.888x speedup, val set 5.527x speedup, step: 5, train time 7.48 s
Epoch 9/50 |loss: 0.149202| train set 5.262x speedup, test set 0.758x speedup, val set 5.638x speedup, step: 1, train time 8.07 s
Epoch 10/50 |loss: 0.146838| train set 5.262x speedup, test set 1.164x speedup, val set 5.638x speedup, step: 2, train time 7.57 s
Epoch 11/50 |loss: 0.142720| train set 5.263x speedup, test set 1.125x speedup, val set 5.540x speedup, step: 3, train time 7.86 s
Epoch 12/50 |loss: 0.137913| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 4, train time 7.97 s
Epoch 13/50 |loss: 0.138670| train set 5.263x speedup, test set 1.066x speedup, val set 5.539x speedup, step: 5, train time 7.68 s
Epoch 14/50 |loss: 0.137203| train set 5.263x speedup, test set 0.888x speedup, val set 5.540x speedup, step: 6, train time 7.88 s
Epoch 15/50 |loss: 0.136964| train set 5.262x speedup, test set 1.158x speedup, val set 5.638x speedup, step: 7, train time 8.01 s
Epoch 16/50 |loss: 0.133770| train set 5.262x speedup, test set 0.898x speedup, val set 5.638x speedup, step: 8, train time 7.58 s
Epoch 17/50 |loss: 0.132236| train set 5.263x speedup, test set 1.145x speedup, val set 5.540x speedup, step: 9, train time 7.62 s
Epoch 18/50 |loss: 0.135681| train set 5.263x speedup, test set 0.859x speedup, val set 5.539x speedup, step: 10, train time 7.62 s
Epoch 19/50 |loss: 0.132032| train set 5.262x speedup, test set 1.158x speedup, val set 5.638x speedup, step: 1, train time 7.97 s
Epoch 20/50 |loss: 0.132396| train set 5.263x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 2, train time 7.69 s
Epoch 21/50 |loss: 0.129538| train set 5.263x speedup, test set 1.118x speedup, val set 5.539x speedup, step: 3, train time 8.08 s
Epoch 22/50 |loss: 0.129464| train set 5.262x speedup, test set 1.146x speedup, val set 5.638x speedup, step: 4, train time 8.18 s
Epoch 23/50 |loss: 0.127316| train set 5.263x speedup, test set 1.150x speedup, val set 5.539x speedup, step: 5, train time 8.09 s
Epoch 24/50 |loss: 0.130017| train set 5.262x speedup, test set 0.892x speedup, val set 5.638x speedup, step: 1, train time 7.72 s
Epoch 25/50 |loss: 0.126972| train set 5.263x speedup, test set 0.892x speedup, val set 5.539x speedup, step: 2, train time 7.78 s
Epoch 26/50 |loss: 0.129789| train set 5.263x speedup, test set 1.137x speedup, val set 5.539x speedup, step: 3, train time 7.80 s
Epoch 27/50 |loss: 0.124382| train set 5.262x speedup, test set 0.880x speedup, val set 5.638x speedup, step: 4, train time 7.70 s
Epoch 28/50 |loss: 0.125548| train set 5.262x speedup, test set 1.114x speedup, val set 5.638x speedup, step: 5, train time 7.71 s
Epoch 29/50 |loss: 0.125344| train set 5.263x speedup, test set 1.145x speedup, val set 5.539x speedup, step: 6, train time 7.97 s
Epoch 30/50 |loss: 0.122483| train set 5.263x speedup, test set 0.884x speedup, val set 5.539x speedup, step: 7, train time 7.77 s
Epoch 31/50 |loss: 0.123633| train set 5.262x speedup, test set 0.887x speedup, val set 5.638x speedup, step: 8, train time 7.90 s
Epoch 32/50 |loss: 0.125023| train set 5.262x speedup, test set 0.856x speedup, val set 5.638x speedup, step: 9, train time 7.79 s
Epoch 33/50 |loss: 0.125060| train set 5.263x speedup, test set 0.894x speedup, val set 5.539x speedup, step: 10, train time 7.67 s
Epoch 34/50 |loss: 0.123897| train set 5.262x speedup, test set 1.133x speedup, val set 5.638x speedup, step: 1, train time 7.90 s
Epoch 35/50 |loss: 0.121761| train set 5.262x speedup, test set 1.133x speedup, val set 5.638x speedup, step: 2, train time 8.50 s
Epoch 36/50 |loss: 0.122685| train set 5.263x speedup, test set 1.128x speedup, val set 5.539x speedup, step: 3, train time 8.18 s
Epoch 37/50 |loss: 0.123696| train set 5.262x speedup, test set 0.888x speedup, val set 5.638x speedup, step: 4, train time 7.79 s
Epoch 38/50 |loss: 0.122313| train set 5.263x speedup, test set 0.879x speedup, val set 5.540x speedup, step: 5, train time 8.00 s
Epoch 39/50 |loss: 0.121369| train set 5.263x speedup, test set 0.873x speedup, val set 5.539x speedup, step: 6, train time 7.60 s
Epoch 40/50 |loss: 0.123436| train set 5.263x speedup, test set 0.879x speedup, val set 5.539x speedup, step: 7, train time 7.78 s
Epoch 41/50 |loss: 0.120590| train set 5.263x speedup, test set 0.894x speedup, val set 5.539x speedup, step: 8, train time 7.68 s
Epoch 42/50 |loss: 0.120641| train set 5.263x speedup, test set 0.883x speedup, val set 5.539x speedup, step: 9, train time 7.71 s
Epoch 43/50 |loss: 0.119946| train set 5.179x speedup, test set 0.873x speedup, val set 5.679x speedup, step: 10, train time 8.08 s
Epoch 44/50 |loss: 0.119535| train set 5.262x speedup, test set 0.882x speedup, val set 5.638x speedup, step: 1, train time 7.92 s
Epoch 45/50 |loss: 0.118540| train set 5.263x speedup, test set 1.126x speedup, val set 5.539x speedup, step: 2, train time 8.09 s
Epoch 46/50 |loss: 0.119759| train set 5.261x speedup, test set 0.878x speedup, val set 5.527x speedup, step: 3, train time 7.78 s
Epoch 47/50 |loss: 0.119537| train set 5.262x speedup, test set 0.864x speedup, val set 5.638x speedup, step: 4, train time 7.69 s
Epoch 48/50 |loss: 0.117326| train set 5.263x speedup, test set 0.870x speedup, val set 5.539x speedup, step: 5, train time 7.88 s
Epoch 49/50 |loss: 0.120829| train set 5.263x speedup, test set 0.898x speedup, val set 5.539x speedup, step: 6, train time 7.48 s
Training per epoch cost 7.865 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.484s, pg runtime 0.453s, speedup 0.936x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 1.959s, pg runtime 0.239s, speedup 0.122x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 4, train speedup 5.263, test speedup 1.208, val speedup 5.539
best test speedup epoch: 3, train speedup 5.192, test speedup 1.223, val speedup 5.562
best validation speedup epoch: 44, train speedup 5.262, test speedup 0.882, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 0.898, val speedup 5.539
execution cost 0:07:04.457687
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.514456, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.393387| train set 4.694x speedup, test set 1.134x speedup, val set 5.056x speedup, step: 1, train time 9.17 s
Epoch 1/50 |loss: 0.241110| train set 5.135x speedup, test set 1.698x speedup, val set 5.414x speedup, step: 2, train time 7.65 s
Epoch 2/50 |loss: 0.207852| train set 5.241x speedup, test set 1.066x speedup, val set 5.516x speedup, step: 3, train time 7.81 s
Epoch 3/50 |loss: 0.180907| train set 5.192x speedup, test set 1.649x speedup, val set 5.562x speedup, step: 4, train time 8.01 s
Epoch 4/50 |loss: 0.179917| train set 5.263x speedup, test set 1.092x speedup, val set 5.539x speedup, step: 1, train time 7.98 s
Epoch 5/50 |loss: 0.168063| train set 5.262x speedup, test set 1.038x speedup, val set 5.638x speedup, step: 2, train time 7.89 s
Epoch 6/50 |loss: 0.162779| train set 5.262x speedup, test set 1.041x speedup, val set 5.637x speedup, step: 3, train time 7.78 s
Epoch 7/50 |loss: 0.155342| train set 5.263x speedup, test set 0.986x speedup, val set 5.539x speedup, step: 4, train time 7.97 s
Epoch 8/50 |loss: 0.151212| train set 5.262x speedup, test set 1.057x speedup, val set 5.638x speedup, step: 5, train time 7.80 s
Epoch 9/50 |loss: 0.147353| train set 5.193x speedup, test set 0.995x speedup, val set 5.466x speedup, step: 6, train time 7.91 s
Epoch 10/50 |loss: 0.144839| train set 5.263x speedup, test set 1.023x speedup, val set 5.539x speedup, step: 7, train time 7.63 s
Epoch 11/50 |loss: 0.142801| train set 5.263x speedup, test set 0.998x speedup, val set 5.539x speedup, step: 8, train time 7.98 s
Epoch 12/50 |loss: 0.138403| train set 5.263x speedup, test set 0.777x speedup, val set 5.539x speedup, step: 9, train time 8.47 s
Epoch 13/50 |loss: 0.138788| train set 5.263x speedup, test set 0.988x speedup, val set 5.539x speedup, step: 10, train time 7.90 s
Epoch 14/50 |loss: 0.137370| train set 5.263x speedup, test set 1.004x speedup, val set 5.540x speedup, step: 1, train time 8.00 s
Epoch 15/50 |loss: 0.137222| train set 5.262x speedup, test set 1.017x speedup, val set 5.637x speedup, step: 2, train time 7.87 s
Epoch 16/50 |loss: 0.135135| train set 5.262x speedup, test set 0.996x speedup, val set 5.638x speedup, step: 3, train time 8.07 s
Epoch 17/50 |loss: 0.133222| train set 5.263x speedup, test set 1.019x speedup, val set 5.539x speedup, step: 4, train time 7.49 s
Epoch 18/50 |loss: 0.134130| train set 5.264x speedup, test set 0.994x speedup, val set 5.539x speedup, step: 5, train time 8.37 s
Epoch 19/50 |loss: 0.133063| train set 5.262x speedup, test set 0.993x speedup, val set 5.638x speedup, step: 1, train time 7.77 s
Epoch 20/50 |loss: 0.132730| train set 5.263x speedup, test set 1.014x speedup, val set 5.539x speedup, step: 2, train time 7.97 s
Epoch 21/50 |loss: 0.130007| train set 5.262x speedup, test set 1.059x speedup, val set 5.638x speedup, step: 3, train time 8.20 s
Epoch 22/50 |loss: 0.130138| train set 5.262x speedup, test set 0.991x speedup, val set 5.638x speedup, step: 4, train time 8.15 s
Epoch 23/50 |loss: 0.127736| train set 5.263x speedup, test set 0.992x speedup, val set 5.539x speedup, step: 5, train time 8.09 s
Epoch 24/50 |loss: 0.129705| train set 5.262x speedup, test set 0.793x speedup, val set 5.638x speedup, step: 1, train time 8.21 s
Epoch 25/50 |loss: 0.126409| train set 5.263x speedup, test set 0.795x speedup, val set 5.539x speedup, step: 2, train time 7.83 s
Epoch 26/50 |loss: 0.128569| train set 5.263x speedup, test set 1.109x speedup, val set 5.539x speedup, step: 3, train time 7.80 s
Epoch 27/50 |loss: 0.123926| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 4, train time 7.62 s
Epoch 28/50 |loss: 0.126263| train set 5.262x speedup, test set 1.106x speedup, val set 5.637x speedup, step: 5, train time 7.38 s
Epoch 29/50 |loss: 0.125767| train set 5.263x speedup, test set 1.016x speedup, val set 5.539x speedup, step: 6, train time 7.89 s
Epoch 30/50 |loss: 0.124214| train set 5.263x speedup, test set 1.017x speedup, val set 5.539x speedup, step: 7, train time 7.71 s
Epoch 31/50 |loss: 0.122498| train set 5.262x speedup, test set 0.990x speedup, val set 5.637x speedup, step: 8, train time 7.99 s
Epoch 32/50 |loss: 0.125079| train set 5.179x speedup, test set 0.810x speedup, val set 5.679x speedup, step: 9, train time 8.00 s
Epoch 33/50 |loss: 0.124753| train set 5.263x speedup, test set 0.809x speedup, val set 5.539x speedup, step: 10, train time 7.91 s
Epoch 34/50 |loss: 0.124233| train set 5.262x speedup, test set 1.000x speedup, val set 5.638x speedup, step: 1, train time 7.99 s
Epoch 35/50 |loss: 0.122091| train set 5.262x speedup, test set 1.078x speedup, val set 5.638x speedup, step: 2, train time 7.90 s
Epoch 36/50 |loss: 0.123384| train set 5.263x speedup, test set 0.985x speedup, val set 5.539x speedup, step: 3, train time 8.28 s
Epoch 37/50 |loss: 0.122697| train set 5.262x speedup, test set 1.090x speedup, val set 5.638x speedup, step: 4, train time 7.69 s
Epoch 38/50 |loss: 0.122452| train set 5.263x speedup, test set 0.795x speedup, val set 5.539x speedup, step: 5, train time 7.98 s
Epoch 39/50 |loss: 0.123296| train set 5.263x speedup, test set 0.795x speedup, val set 5.539x speedup, step: 6, train time 7.68 s
Epoch 40/50 |loss: 0.123116| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 7, train time 7.77 s
early stopping at epoch 40
Training per epoch cost 7.940 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.204s, pg runtime 0.239s, speedup 1.170x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.603s, pg runtime 5.521s, speedup 0.985x
====================
best train speedup epoch: 18, train speedup 5.264, test speedup 0.994, val speedup 5.539
best test speedup epoch: 1, train speedup 5.135, test speedup 1.698, val speedup 5.414
best validation speedup epoch: 34, train speedup 5.262, test speedup 1.000, val speedup 5.638
last model at epoch 40, train speedup 5.263, test speedup 0.810, val speedup 5.539
execution cost 0:05:52.146299
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.519472, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397517| train set 4.878x speedup, test set 0.855x speedup, val set 5.103x speedup, step: 1, train time 9.13 s
Epoch 1/50 |loss: 0.241683| train set 5.024x speedup, test set 1.615x speedup, val set 5.296x speedup, step: 2, train time 8.07 s
Epoch 2/50 |loss: 0.206828| train set 5.114x speedup, test set 1.637x speedup, val set 5.391x speedup, step: 3, train time 8.37 s
Epoch 3/50 |loss: 0.182802| train set 5.192x speedup, test set 1.753x speedup, val set 5.562x speedup, step: 4, train time 7.91 s
Epoch 4/50 |loss: 0.175742| train set 5.264x speedup, test set 1.146x speedup, val set 5.539x speedup, step: 1, train time 7.72 s
Epoch 5/50 |loss: 0.170888| train set 5.264x speedup, test set 0.814x speedup, val set 5.539x speedup, step: 2, train time 8.07 s
Epoch 6/50 |loss: 0.161844| train set 5.262x speedup, test set 1.123x speedup, val set 5.637x speedup, step: 3, train time 7.98 s
Epoch 7/50 |loss: 0.156009| train set 5.162x speedup, test set 0.798x speedup, val set 5.482x speedup, step: 4, train time 8.10 s
Epoch 8/50 |loss: 0.150748| train set 5.263x speedup, test set 1.112x speedup, val set 5.539x speedup, step: 5, train time 7.80 s
Epoch 9/50 |loss: 0.149384| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 1, train time 7.68 s
Epoch 10/50 |loss: 0.146949| train set 5.259x speedup, test set 1.010x speedup, val set 5.625x speedup, step: 2, train time 7.79 s
Epoch 11/50 |loss: 0.143600| train set 5.263x speedup, test set 1.050x speedup, val set 5.540x speedup, step: 3, train time 7.67 s
Epoch 12/50 |loss: 0.137634| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 4, train time 7.89 s
Epoch 13/50 |loss: 0.139445| train set 5.263x speedup, test set 0.896x speedup, val set 5.539x speedup, step: 5, train time 7.82 s
Epoch 14/50 |loss: 0.138381| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1, train time 7.78 s
Epoch 15/50 |loss: 0.137642| train set 5.192x speedup, test set 0.793x speedup, val set 5.563x speedup, step: 2, train time 7.90 s
Epoch 16/50 |loss: 0.134149| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 3, train time 7.72 s
Epoch 17/50 |loss: 0.133019| train set 5.263x speedup, test set 0.887x speedup, val set 5.539x speedup, step: 4, train time 7.69 s
Epoch 18/50 |loss: 0.136389| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 5, train time 7.70 s
Epoch 19/50 |loss: 0.131847| train set 5.262x speedup, test set 0.842x speedup, val set 5.638x speedup, step: 6, train time 7.78 s
Epoch 20/50 |loss: 0.132957| train set 5.263x speedup, test set 0.844x speedup, val set 5.539x speedup, step: 7, train time 8.07 s
Epoch 21/50 |loss: 0.128989| train set 5.262x speedup, test set 0.886x speedup, val set 5.638x speedup, step: 8, train time 7.58 s
Epoch 22/50 |loss: 0.129724| train set 5.262x speedup, test set 0.798x speedup, val set 5.638x speedup, step: 9, train time 8.47 s
Epoch 23/50 |loss: 0.128020| train set 5.263x speedup, test set 0.833x speedup, val set 5.539x speedup, step: 10, train time 7.77 s
Epoch 24/50 |loss: 0.129548| train set 5.262x speedup, test set 0.804x speedup, val set 5.638x speedup, step: 11, train time 7.59 s
Epoch 25/50 |loss: 0.127358| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 12, train time 7.48 s
Epoch 26/50 |loss: 0.128313| train set 5.264x speedup, test set 0.885x speedup, val set 5.539x speedup, step: 13, train time 7.70 s
Epoch 27/50 |loss: 0.124027| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 14, train time 7.87 s
Epoch 28/50 |loss: 0.126119| train set 5.262x speedup, test set 0.874x speedup, val set 5.638x speedup, step: 15, train time 7.69 s
Epoch 29/50 |loss: 0.123466| train set 5.263x speedup, test set 0.833x speedup, val set 5.539x speedup, step: 16, train time 8.12 s
Epoch 30/50 |loss: 0.123722| train set 5.263x speedup, test set 0.847x speedup, val set 5.539x speedup, step: 17, train time 8.12 s
Epoch 31/50 |loss: 0.123695| train set 5.262x speedup, test set 0.831x speedup, val set 5.638x speedup, step: 18, train time 7.61 s
Epoch 32/50 |loss: 0.124746| train set 5.253x speedup, test set 0.813x speedup, val set 5.657x speedup, step: 19, train time 7.49 s
Epoch 33/50 |loss: 0.125068| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 20, train time 7.77 s
Epoch 34/50 |loss: 0.122599| train set 5.262x speedup, test set 0.886x speedup, val set 5.638x speedup, step: 21, train time 7.79 s
Epoch 35/50 |loss: 0.121373| train set 5.262x speedup, test set 0.792x speedup, val set 5.638x speedup, step: 22, train time 7.60 s
Epoch 36/50 |loss: 0.124165| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 23, train time 8.28 s
Epoch 37/50 |loss: 0.122643| train set 5.263x speedup, test set 0.844x speedup, val set 5.539x speedup, step: 24, train time 8.08 s
Epoch 38/50 |loss: 0.122113| train set 5.263x speedup, test set 0.813x speedup, val set 5.539x speedup, step: 25, train time 7.68 s
Epoch 39/50 |loss: 0.121645| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 26, train time 7.79 s
Epoch 40/50 |loss: 0.123085| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 27, train time 7.58 s
Epoch 41/50 |loss: 0.120934| train set 5.263x speedup, test set 0.797x speedup, val set 5.539x speedup, step: 28, train time 8.02 s
Epoch 42/50 |loss: 0.121838| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 29, train time 7.70 s
Epoch 43/50 |loss: 0.118920| train set 5.179x speedup, test set 0.824x speedup, val set 5.679x speedup, step: 30, train time 8.17 s
Epoch 44/50 |loss: 0.118156| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 31, train time 7.38 s
Epoch 45/50 |loss: 0.118320| train set 5.263x speedup, test set 0.818x speedup, val set 5.539x speedup, step: 32, train time 7.82 s
Epoch 46/50 |loss: 0.119995| train set 5.259x speedup, test set 0.824x speedup, val set 5.625x speedup, step: 33, train time 7.31 s
Epoch 47/50 |loss: 0.120995| train set 5.262x speedup, test set 0.861x speedup, val set 5.638x speedup, step: 34, train time 8.09 s
Epoch 48/50 |loss: 0.118390| train set 5.263x speedup, test set 0.877x speedup, val set 5.539x speedup, step: 35, train time 7.69 s
Epoch 49/50 |loss: 0.120372| train set 5.264x speedup, test set 0.876x speedup, val set 5.539x speedup, step: 36, train time 8.18 s
Training per epoch cost 7.861 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 4, train speedup 5.264, test speedup 1.146, val speedup 5.539
best test speedup epoch: 3, train speedup 5.192, test speedup 1.753, val speedup 5.562
best validation speedup epoch: 14, train speedup 5.262, test speedup 0.802, val speedup 5.638
last model at epoch 49, train speedup 5.264, test speedup 0.876, val speedup 5.539
execution cost 0:07:04.594957
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.528193, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.398500| train set 4.940x speedup, test set 1.160x speedup, val set 5.167x speedup, step: 1, train time 9.06 s
Epoch 1/50 |loss: 0.238825| train set 4.717x speedup, test set 1.735x speedup, val set 4.991x speedup, step: 2, train time 7.51 s
Epoch 2/50 |loss: 0.205974| train set 5.114x speedup, test set 1.167x speedup, val set 5.392x speedup, step: 3, train time 7.98 s
Epoch 3/50 |loss: 0.181648| train set 5.192x speedup, test set 1.726x speedup, val set 5.562x speedup, step: 4, train time 7.68 s
Epoch 4/50 |loss: 0.180172| train set 5.264x speedup, test set 1.176x speedup, val set 5.539x speedup, step: 1, train time 7.79 s
Epoch 5/50 |loss: 0.169212| train set 5.240x speedup, test set 1.014x speedup, val set 5.614x speedup, step: 2, train time 7.91 s
Epoch 6/50 |loss: 0.162194| train set 5.054x speedup, test set 1.113x speedup, val set 5.454x speedup, step: 3, train time 8.20 s
Epoch 7/50 |loss: 0.154904| train set 5.263x speedup, test set 0.799x speedup, val set 5.539x speedup, step: 4, train time 7.79 s
Epoch 8/50 |loss: 0.147851| train set 5.054x speedup, test set 1.143x speedup, val set 5.454x speedup, step: 5, train time 7.78 s
Epoch 9/50 |loss: 0.148764| train set 5.263x speedup, test set 1.011x speedup, val set 5.539x speedup, step: 1, train time 7.58 s
Epoch 10/50 |loss: 0.147475| train set 5.262x speedup, test set 1.132x speedup, val set 5.638x speedup, step: 2, train time 7.71 s
Epoch 11/50 |loss: 0.143530| train set 5.263x speedup, test set 1.092x speedup, val set 5.540x speedup, step: 3, train time 8.01 s
Epoch 12/50 |loss: 0.137299| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 4, train time 7.68 s
Epoch 13/50 |loss: 0.138663| train set 5.263x speedup, test set 0.880x speedup, val set 5.539x speedup, step: 5, train time 7.67 s
Epoch 14/50 |loss: 0.136622| train set 5.263x speedup, test set 0.841x speedup, val set 5.540x speedup, step: 1, train time 8.29 s
Epoch 15/50 |loss: 0.136687| train set 5.262x speedup, test set 0.867x speedup, val set 5.638x speedup, step: 2, train time 7.69 s
Epoch 16/50 |loss: 0.133690| train set 5.240x speedup, test set 0.820x speedup, val set 5.614x speedup, step: 3, train time 7.78 s
Epoch 17/50 |loss: 0.130766| train set 5.263x speedup, test set 1.126x speedup, val set 5.540x speedup, step: 4, train time 7.88 s
Epoch 18/50 |loss: 0.135328| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 5, train time 7.69 s
Epoch 19/50 |loss: 0.132225| train set 5.262x speedup, test set 1.174x speedup, val set 5.638x speedup, step: 1, train time 7.60 s
Epoch 20/50 |loss: 0.131783| train set 5.263x speedup, test set 1.171x speedup, val set 5.539x speedup, step: 2, train time 7.95 s
Epoch 21/50 |loss: 0.128554| train set 5.262x speedup, test set 1.146x speedup, val set 5.638x speedup, step: 3, train time 7.98 s
Epoch 22/50 |loss: 0.130637| train set 5.262x speedup, test set 1.109x speedup, val set 5.638x speedup, step: 4, train time 8.27 s
Epoch 23/50 |loss: 0.127312| train set 5.263x speedup, test set 0.814x speedup, val set 5.539x speedup, step: 5, train time 7.78 s
Epoch 24/50 |loss: 0.128899| train set 5.262x speedup, test set 0.814x speedup, val set 5.638x speedup, step: 1, train time 7.87 s
Epoch 25/50 |loss: 0.127128| train set 5.263x speedup, test set 1.154x speedup, val set 5.539x speedup, step: 2, train time 7.62 s
Epoch 26/50 |loss: 0.129796| train set 5.263x speedup, test set 0.894x speedup, val set 5.539x speedup, step: 3, train time 7.70 s
Epoch 27/50 |loss: 0.124606| train set 5.262x speedup, test set 0.845x speedup, val set 5.638x speedup, step: 4, train time 7.61 s
Epoch 28/50 |loss: 0.125081| train set 5.262x speedup, test set 1.131x speedup, val set 5.638x speedup, step: 5, train time 8.30 s
Epoch 29/50 |loss: 0.123829| train set 5.263x speedup, test set 0.879x speedup, val set 5.539x speedup, step: 6, train time 7.69 s
Epoch 30/50 |loss: 0.124001| train set 5.263x speedup, test set 0.902x speedup, val set 5.539x speedup, step: 7, train time 7.69 s
Epoch 31/50 |loss: 0.121911| train set 5.262x speedup, test set 0.833x speedup, val set 5.638x speedup, step: 8, train time 7.62 s
Epoch 32/50 |loss: 0.124729| train set 5.253x speedup, test set 0.902x speedup, val set 5.657x speedup, step: 9, train time 8.17 s
Epoch 33/50 |loss: 0.123879| train set 5.263x speedup, test set 0.884x speedup, val set 5.539x speedup, step: 10, train time 8.11 s
Epoch 34/50 |loss: 0.123205| train set 5.262x speedup, test set 1.121x speedup, val set 5.638x speedup, step: 1, train time 7.97 s
Epoch 35/50 |loss: 0.121265| train set 5.262x speedup, test set 0.873x speedup, val set 5.638x speedup, step: 2, train time 7.87 s
Epoch 36/50 |loss: 0.123607| train set 5.263x speedup, test set 0.893x speedup, val set 5.539x speedup, step: 3, train time 8.27 s
Epoch 37/50 |loss: 0.122476| train set 5.262x speedup, test set 0.833x speedup, val set 5.638x speedup, step: 4, train time 7.70 s
Epoch 38/50 |loss: 0.121324| train set 5.259x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 5, train time 7.92 s
Epoch 39/50 |loss: 0.121026| train set 5.263x speedup, test set 0.850x speedup, val set 5.539x speedup, step: 6, train time 7.78 s
Epoch 40/50 |loss: 0.122822| train set 5.263x speedup, test set 0.809x speedup, val set 5.539x speedup, step: 7, train time 7.49 s
Epoch 41/50 |loss: 0.119656| train set 5.263x speedup, test set 0.809x speedup, val set 5.539x speedup, step: 8, train time 7.77 s
Epoch 42/50 |loss: 0.120431| train set 5.263x speedup, test set 0.804x speedup, val set 5.539x speedup, step: 9, train time 7.77 s
Epoch 43/50 |loss: 0.120120| train set 5.181x speedup, test set 0.878x speedup, val set 5.579x speedup, step: 10, train time 7.80 s
Epoch 44/50 |loss: 0.118594| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1, train time 7.77 s
Epoch 45/50 |loss: 0.119154| train set 5.262x speedup, test set 1.143x speedup, val set 5.638x speedup, step: 2, train time 7.47 s
Epoch 46/50 |loss: 0.119625| train set 5.178x speedup, test set 0.896x speedup, val set 5.663x speedup, step: 3, train time 7.90 s
Epoch 47/50 |loss: 0.119537| train set 5.262x speedup, test set 0.889x speedup, val set 5.638x speedup, step: 4, train time 7.61 s
Epoch 48/50 |loss: 0.117128| train set 5.263x speedup, test set 0.893x speedup, val set 5.539x speedup, step: 5, train time 7.80 s
Epoch 49/50 |loss: 0.119671| train set 5.263x speedup, test set 0.894x speedup, val set 5.539x speedup, step: 6, train time 7.67 s
Training per epoch cost 7.845 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 4, train speedup 5.264, test speedup 1.176, val speedup 5.539
best test speedup epoch: 1, train speedup 4.717, test speedup 1.735, val speedup 4.991
best validation speedup epoch: 44, train speedup 5.262, test speedup 0.810, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 0.894, val speedup 5.539
execution cost 0:07:02.866239
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.494114, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.393156| train set 3.959x speedup, test set 1.137x speedup, val set 4.053x speedup, step: 1, train time 8.67 s
Epoch 1/50 |loss: 0.242930| train set 4.898x speedup, test set 1.650x speedup, val set 5.123x speedup, step: 2, train time 7.70 s
Epoch 2/50 |loss: 0.205971| train set 5.239x speedup, test set 1.147x speedup, val set 5.614x speedup, step: 3, train time 8.08 s
Epoch 3/50 |loss: 0.184244| train set 5.192x speedup, test set 1.145x speedup, val set 5.562x speedup, step: 4, train time 7.79 s
Epoch 4/50 |loss: 0.177115| train set 5.263x speedup, test set 1.134x speedup, val set 5.539x speedup, step: 1, train time 7.67 s
Epoch 5/50 |loss: 0.169084| train set 5.262x speedup, test set 0.989x speedup, val set 5.638x speedup, step: 2, train time 7.87 s
Epoch 6/50 |loss: 0.163182| train set 5.262x speedup, test set 1.098x speedup, val set 5.638x speedup, step: 3, train time 8.08 s
Epoch 7/50 |loss: 0.155620| train set 5.263x speedup, test set 1.068x speedup, val set 5.540x speedup, step: 4, train time 7.67 s
Epoch 8/50 |loss: 0.154740| train set 5.263x speedup, test set 1.120x speedup, val set 5.539x speedup, step: 5, train time 7.89 s
Epoch 9/50 |loss: 0.152285| train set 5.263x speedup, test set 1.067x speedup, val set 5.540x speedup, step: 1, train time 7.99 s
Epoch 10/50 |loss: 0.147998| train set 5.262x speedup, test set 1.134x speedup, val set 5.638x speedup, step: 2, train time 7.88 s
Epoch 11/50 |loss: 0.143922| train set 5.263x speedup, test set 0.983x speedup, val set 5.540x speedup, step: 3, train time 8.20 s
Epoch 12/50 |loss: 0.137811| train set 5.264x speedup, test set 0.991x speedup, val set 5.539x speedup, step: 4, train time 7.89 s
Epoch 13/50 |loss: 0.138908| train set 5.263x speedup, test set 1.098x speedup, val set 5.539x speedup, step: 5, train time 8.00 s
Epoch 14/50 |loss: 0.138291| train set 5.262x speedup, test set 1.128x speedup, val set 5.638x speedup, step: 1, train time 8.10 s
Epoch 15/50 |loss: 0.138316| train set 5.262x speedup, test set 1.120x speedup, val set 5.638x speedup, step: 2, train time 7.79 s
Epoch 16/50 |loss: 0.134429| train set 5.262x speedup, test set 1.171x speedup, val set 5.638x speedup, step: 3, train time 7.89 s
Epoch 17/50 |loss: 0.133685| train set 5.263x speedup, test set 1.134x speedup, val set 5.540x speedup, step: 4, train time 8.17 s
Epoch 18/50 |loss: 0.135686| train set 5.263x speedup, test set 0.982x speedup, val set 5.540x speedup, step: 5, train time 7.60 s
Epoch 19/50 |loss: 0.133243| train set 5.262x speedup, test set 1.158x speedup, val set 5.638x speedup, step: 6, train time 7.97 s
Epoch 20/50 |loss: 0.132758| train set 5.263x speedup, test set 1.099x speedup, val set 5.539x speedup, step: 7, train time 7.91 s
Epoch 21/50 |loss: 0.128040| train set 5.262x speedup, test set 1.115x speedup, val set 5.638x speedup, step: 8, train time 8.00 s
Epoch 22/50 |loss: 0.130321| train set 5.262x speedup, test set 1.142x speedup, val set 5.638x speedup, step: 9, train time 8.28 s
Epoch 23/50 |loss: 0.127157| train set 5.263x speedup, test set 1.145x speedup, val set 5.539x speedup, step: 10, train time 7.81 s
Epoch 24/50 |loss: 0.131023| train set 5.262x speedup, test set 1.009x speedup, val set 5.638x speedup, step: 11, train time 8.09 s
Epoch 25/50 |loss: 0.127647| train set 5.263x speedup, test set 1.139x speedup, val set 5.539x speedup, step: 12, train time 7.97 s
Epoch 26/50 |loss: 0.128143| train set 5.263x speedup, test set 1.134x speedup, val set 5.539x speedup, step: 13, train time 7.68 s
Epoch 27/50 |loss: 0.125132| train set 5.262x speedup, test set 1.141x speedup, val set 5.638x speedup, step: 14, train time 7.57 s
Epoch 28/50 |loss: 0.126845| train set 5.262x speedup, test set 1.118x speedup, val set 5.638x speedup, step: 15, train time 8.32 s
Epoch 29/50 |loss: 0.126182| train set 5.263x speedup, test set 1.165x speedup, val set 5.539x speedup, step: 16, train time 8.31 s
Epoch 30/50 |loss: 0.125135| train set 5.263x speedup, test set 1.184x speedup, val set 5.539x speedup, step: 17, train time 7.78 s
Epoch 31/50 |loss: 0.124715| train set 5.262x speedup, test set 1.141x speedup, val set 5.638x speedup, step: 18, train time 7.78 s
Epoch 32/50 |loss: 0.124804| train set 5.253x speedup, test set 0.821x speedup, val set 5.657x speedup, step: 19, train time 7.60 s
Epoch 33/50 |loss: 0.125914| train set 5.263x speedup, test set 1.184x speedup, val set 5.539x speedup, step: 20, train time 7.58 s
Epoch 34/50 |loss: 0.124294| train set 5.262x speedup, test set 1.141x speedup, val set 5.638x speedup, step: 21, train time 7.80 s
Epoch 35/50 |loss: 0.123200| train set 5.262x speedup, test set 1.142x speedup, val set 5.638x speedup, step: 22, train time 7.58 s
Epoch 36/50 |loss: 0.123095| train set 5.263x speedup, test set 1.118x speedup, val set 5.539x speedup, step: 23, train time 7.98 s
Epoch 37/50 |loss: 0.125023| train set 5.263x speedup, test set 1.165x speedup, val set 5.539x speedup, step: 24, train time 7.47 s
Epoch 38/50 |loss: 0.122859| train set 5.254x speedup, test set 0.885x speedup, val set 5.558x speedup, step: 25, train time 8.28 s
Epoch 39/50 |loss: 0.123281| train set 5.263x speedup, test set 1.118x speedup, val set 5.539x speedup, step: 26, train time 7.67 s
Epoch 40/50 |loss: 0.124239| train set 5.263x speedup, test set 1.009x speedup, val set 5.539x speedup, step: 27, train time 7.87 s
Epoch 41/50 |loss: 0.120508| train set 5.263x speedup, test set 1.159x speedup, val set 5.539x speedup, step: 28, train time 7.78 s
Epoch 42/50 |loss: 0.122056| train set 5.263x speedup, test set 1.141x speedup, val set 5.539x speedup, step: 29, train time 8.00 s
Epoch 43/50 |loss: 0.120986| train set 5.177x speedup, test set 1.165x speedup, val set 5.667x speedup, step: 30, train time 7.91 s
Epoch 44/50 |loss: 0.120252| train set 5.240x speedup, test set 0.849x speedup, val set 5.614x speedup, step: 31, train time 7.92 s
Epoch 45/50 |loss: 0.119963| train set 5.263x speedup, test set 1.166x speedup, val set 5.539x speedup, step: 32, train time 7.89 s
Epoch 46/50 |loss: 0.120891| train set 5.259x speedup, test set 0.912x speedup, val set 5.625x speedup, step: 33, train time 8.38 s
Epoch 47/50 |loss: 0.121257| train set 5.262x speedup, test set 1.128x speedup, val set 5.638x speedup, step: 34, train time 7.81 s
Epoch 48/50 |loss: 0.119396| train set 5.263x speedup, test set 1.183x speedup, val set 5.539x speedup, step: 35, train time 8.09 s
Epoch 49/50 |loss: 0.121179| train set 5.263x speedup, test set 1.182x speedup, val set 5.539x speedup, step: 36, train time 8.00 s
Training per epoch cost 7.920 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 3.575s, pg runtime 0.389s, speedup 0.109x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.204s, pg runtime 0.239s, speedup 1.170x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 12, train speedup 5.264, test speedup 0.991, val speedup 5.539
best test speedup epoch: 1, train speedup 4.898, test speedup 1.650, val speedup 5.123
best validation speedup epoch: 14, train speedup 5.262, test speedup 1.128, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 1.182, val speedup 5.539
execution cost 0:07:06.703387
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.542026, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.395511| train set 4.683x speedup, test set 1.146x speedup, val set 4.795x speedup, step: 1, train time 9.05 s
Epoch 1/50 |loss: 0.241452| train set 5.171x speedup, test set 1.153x speedup, val set 5.444x speedup, step: 2, train time 8.08 s
Epoch 2/50 |loss: 0.207013| train set 5.241x speedup, test set 1.128x speedup, val set 5.517x speedup, step: 3, train time 7.96 s
Epoch 3/50 |loss: 0.181569| train set 4.972x speedup, test set 1.155x speedup, val set 5.198x speedup, step: 4, train time 8.20 s
Epoch 4/50 |loss: 0.175008| train set 5.262x speedup, test set 1.172x speedup, val set 5.638x speedup, step: 1, train time 7.79 s
Epoch 5/50 |loss: 0.171317| train set 5.263x speedup, test set 1.009x speedup, val set 5.539x speedup, step: 2, train time 7.77 s
Epoch 6/50 |loss: 0.159181| train set 5.054x speedup, test set 1.129x speedup, val set 5.454x speedup, step: 3, train time 7.98 s
Epoch 7/50 |loss: 0.155067| train set 5.263x speedup, test set 0.830x speedup, val set 5.540x speedup, step: 4, train time 8.10 s
Epoch 8/50 |loss: 0.150011| train set 5.263x speedup, test set 1.088x speedup, val set 5.539x speedup, step: 5, train time 8.10 s
Epoch 9/50 |loss: 0.150935| train set 5.263x speedup, test set 0.779x speedup, val set 5.539x speedup, step: 6, train time 7.63 s
Epoch 10/50 |loss: 0.143328| train set 5.262x speedup, test set 1.054x speedup, val set 5.638x speedup, step: 7, train time 7.97 s
Epoch 11/50 |loss: 0.142449| train set 5.263x speedup, test set 1.106x speedup, val set 5.539x speedup, step: 8, train time 7.79 s
Epoch 12/50 |loss: 0.137822| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 9, train time 8.00 s
Epoch 13/50 |loss: 0.138224| train set 5.263x speedup, test set 0.867x speedup, val set 5.539x speedup, step: 10, train time 7.88 s
Epoch 14/50 |loss: 0.136667| train set 5.262x speedup, test set 0.814x speedup, val set 5.638x speedup, step: 1, train time 7.59 s
Epoch 15/50 |loss: 0.135430| train set 5.262x speedup, test set 0.838x speedup, val set 5.638x speedup, step: 2, train time 7.81 s
Epoch 16/50 |loss: 0.133078| train set 5.262x speedup, test set 0.819x speedup, val set 5.638x speedup, step: 3, train time 7.70 s
Epoch 17/50 |loss: 0.131503| train set 5.263x speedup, test set 0.867x speedup, val set 5.540x speedup, step: 4, train time 8.01 s
Epoch 18/50 |loss: 0.134625| train set 5.254x speedup, test set 0.790x speedup, val set 5.559x speedup, step: 5, train time 7.52 s
Epoch 19/50 |loss: 0.131979| train set 5.262x speedup, test set 0.873x speedup, val set 5.638x speedup, step: 6, train time 7.62 s
Epoch 20/50 |loss: 0.131965| train set 5.263x speedup, test set 0.873x speedup, val set 5.539x speedup, step: 7, train time 7.80 s
Epoch 21/50 |loss: 0.129232| train set 5.267x speedup, test set 0.867x speedup, val set 5.638x speedup, step: 8, train time 7.81 s
Epoch 22/50 |loss: 0.128875| train set 5.262x speedup, test set 0.787x speedup, val set 5.638x speedup, step: 9, train time 8.37 s
Epoch 23/50 |loss: 0.125612| train set 5.263x speedup, test set 0.873x speedup, val set 5.539x speedup, step: 10, train time 7.88 s
Epoch 24/50 |loss: 0.130260| train set 5.262x speedup, test set 0.780x speedup, val set 5.638x speedup, step: 11, train time 7.72 s
Epoch 25/50 |loss: 0.127241| train set 5.263x speedup, test set 0.872x speedup, val set 5.539x speedup, step: 12, train time 8.01 s
Epoch 26/50 |loss: 0.128339| train set 5.263x speedup, test set 0.873x speedup, val set 5.539x speedup, step: 13, train time 7.77 s
Epoch 27/50 |loss: 0.122610| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 14, train time 7.69 s
Epoch 28/50 |loss: 0.125661| train set 5.262x speedup, test set 0.857x speedup, val set 5.638x speedup, step: 15, train time 7.88 s
Epoch 29/50 |loss: 0.124179| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 16, train time 7.72 s
Epoch 30/50 |loss: 0.124156| train set 5.263x speedup, test set 0.875x speedup, val set 5.539x speedup, step: 17, train time 8.01 s
Epoch 31/50 |loss: 0.122299| train set 5.262x speedup, test set 0.888x speedup, val set 5.637x speedup, step: 18, train time 7.85 s
Epoch 32/50 |loss: 0.124170| train set 5.254x speedup, test set 0.903x speedup, val set 5.558x speedup, step: 19, train time 7.62 s
Epoch 33/50 |loss: 0.122449| train set 5.263x speedup, test set 0.828x speedup, val set 5.539x speedup, step: 20, train time 7.50 s
Epoch 34/50 |loss: 0.123178| train set 5.262x speedup, test set 1.125x speedup, val set 5.638x speedup, step: 21, train time 8.10 s
Epoch 35/50 |loss: 0.119744| train set 5.262x speedup, test set 1.097x speedup, val set 5.638x speedup, step: 22, train time 7.87 s
Epoch 36/50 |loss: 0.123190| train set 5.263x speedup, test set 0.873x speedup, val set 5.539x speedup, step: 23, train time 7.89 s
Epoch 37/50 |loss: 0.122965| train set 5.263x speedup, test set 0.888x speedup, val set 5.539x speedup, step: 24, train time 7.97 s
Epoch 38/50 |loss: 0.120003| train set 5.263x speedup, test set 0.873x speedup, val set 5.539x speedup, step: 25, train time 8.00 s
Epoch 39/50 |loss: 0.123953| train set 5.263x speedup, test set 0.879x speedup, val set 5.539x speedup, step: 26, train time 7.67 s
Epoch 40/50 |loss: 0.121365| train set 5.263x speedup, test set 0.872x speedup, val set 5.539x speedup, step: 27, train time 7.95 s
Epoch 41/50 |loss: 0.119911| train set 5.263x speedup, test set 1.116x speedup, val set 5.539x speedup, step: 28, train time 7.78 s
Epoch 42/50 |loss: 0.119967| train set 5.263x speedup, test set 0.864x speedup, val set 5.539x speedup, step: 29, train time 7.89 s
Epoch 43/50 |loss: 0.119998| train set 5.179x speedup, test set 0.887x speedup, val set 5.679x speedup, step: 30, train time 7.67 s
Epoch 44/50 |loss: 0.118686| train set 5.262x speedup, test set 0.894x speedup, val set 5.638x speedup, step: 31, train time 7.79 s
Epoch 45/50 |loss: 0.118967| train set 5.262x speedup, test set 1.142x speedup, val set 5.638x speedup, step: 32, train time 7.62 s
Epoch 46/50 |loss: 0.119301| train set 5.259x speedup, test set 0.879x speedup, val set 5.625x speedup, step: 33, train time 8.26 s
Epoch 47/50 |loss: 0.119777| train set 5.262x speedup, test set 1.143x speedup, val set 5.638x speedup, step: 34, train time 7.77 s
Epoch 48/50 |loss: 0.118128| train set 5.262x speedup, test set 1.158x speedup, val set 5.638x speedup, step: 35, train time 7.93 s
Epoch 49/50 |loss: 0.120230| train set 5.263x speedup, test set 0.887x speedup, val set 5.539x speedup, step: 36, train time 7.40 s
Training per epoch cost 7.875 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 1.115s, pg runtime 0.081s, speedup 0.072x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 21, train speedup 5.267, test speedup 0.867, val speedup 5.638
best test speedup epoch: 4, train speedup 5.262, test speedup 1.172, val speedup 5.638
best validation speedup epoch: 14, train speedup 5.262, test speedup 0.814, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 0.887, val speedup 5.539
execution cost 0:07:06.249669
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.523053, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.396288| train set 4.990x speedup, test set 1.156x speedup, val set 5.187x speedup, step: 1, train time 8.97 s
Epoch 1/50 |loss: 0.242351| train set 4.717x speedup, test set 1.181x speedup, val set 4.991x speedup, step: 2, train time 7.90 s
Epoch 2/50 |loss: 0.206720| train set 5.114x speedup, test set 1.110x speedup, val set 5.392x speedup, step: 3, train time 8.41 s
Epoch 3/50 |loss: 0.184074| train set 5.192x speedup, test set 1.158x speedup, val set 5.562x speedup, step: 4, train time 7.80 s
Epoch 4/50 |loss: 0.179906| train set 5.262x speedup, test set 1.133x speedup, val set 5.638x speedup, step: 1, train time 8.30 s
Epoch 5/50 |loss: 0.169448| train set 5.263x speedup, test set 1.108x speedup, val set 5.539x speedup, step: 2, train time 7.69 s
Epoch 6/50 |loss: 0.163864| train set 5.262x speedup, test set 1.066x speedup, val set 5.637x speedup, step: 3, train time 7.89 s
Epoch 7/50 |loss: 0.153983| train set 5.263x speedup, test set 0.804x speedup, val set 5.539x speedup, step: 4, train time 8.10 s
Epoch 8/50 |loss: 0.149318| train set 5.263x speedup, test set 1.113x speedup, val set 5.539x speedup, step: 5, train time 8.11 s
Epoch 9/50 |loss: 0.151548| train set 5.193x speedup, test set 0.867x speedup, val set 5.466x speedup, step: 6, train time 7.87 s
Epoch 10/50 |loss: 0.145917| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 7, train time 7.79 s
Epoch 11/50 |loss: 0.142960| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 8, train time 7.50 s
Epoch 12/50 |loss: 0.136640| train set 5.262x speedup, test set 0.789x speedup, val set 5.638x speedup, step: 9, train time 7.79 s
Epoch 13/50 |loss: 0.137999| train set 5.263x speedup, test set 0.881x speedup, val set 5.538x speedup, step: 10, train time 7.67 s
Epoch 14/50 |loss: 0.136679| train set 5.263x speedup, test set 0.890x speedup, val set 5.540x speedup, step: 11, train time 7.52 s
Epoch 15/50 |loss: 0.135091| train set 5.262x speedup, test set 0.789x speedup, val set 5.638x speedup, step: 12, train time 7.77 s
Epoch 16/50 |loss: 0.133058| train set 5.262x speedup, test set 0.895x speedup, val set 5.638x speedup, step: 13, train time 8.12 s
Epoch 17/50 |loss: 0.132221| train set 5.263x speedup, test set 0.872x speedup, val set 5.539x speedup, step: 14, train time 7.72 s
Epoch 18/50 |loss: 0.134711| train set 5.263x speedup, test set 0.799x speedup, val set 5.539x speedup, step: 15, train time 7.79 s
Epoch 19/50 |loss: 0.132604| train set 5.262x speedup, test set 0.900x speedup, val set 5.638x speedup, step: 1, train time 7.81 s
Epoch 20/50 |loss: 0.132366| train set 5.263x speedup, test set 0.886x speedup, val set 5.539x speedup, step: 2, train time 7.62 s
Epoch 21/50 |loss: 0.128310| train set 5.262x speedup, test set 0.838x speedup, val set 5.638x speedup, step: 3, train time 7.57 s
Epoch 22/50 |loss: 0.128884| train set 5.262x speedup, test set 0.895x speedup, val set 5.638x speedup, step: 4, train time 8.36 s
Epoch 23/50 |loss: 0.126487| train set 5.263x speedup, test set 0.911x speedup, val set 5.539x speedup, step: 5, train time 7.70 s
Epoch 24/50 |loss: 0.130221| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1, train time 7.89 s
Epoch 25/50 |loss: 0.128055| train set 5.263x speedup, test set 0.877x speedup, val set 5.539x speedup, step: 2, train time 8.02 s
Epoch 26/50 |loss: 0.129139| train set 5.263x speedup, test set 0.884x speedup, val set 5.539x speedup, step: 3, train time 8.57 s
Epoch 27/50 |loss: 0.123584| train set 5.262x speedup, test set 0.858x speedup, val set 5.638x speedup, step: 4, train time 7.69 s
Epoch 28/50 |loss: 0.125968| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 5, train time 7.98 s
Epoch 29/50 |loss: 0.124505| train set 5.263x speedup, test set 0.868x speedup, val set 5.539x speedup, step: 6, train time 7.83 s
Epoch 30/50 |loss: 0.123382| train set 5.263x speedup, test set 0.887x speedup, val set 5.539x speedup, step: 7, train time 7.98 s
Epoch 31/50 |loss: 0.123389| train set 5.262x speedup, test set 0.892x speedup, val set 5.638x speedup, step: 8, train time 7.90 s
Epoch 32/50 |loss: 0.124857| train set 5.254x speedup, test set 0.904x speedup, val set 5.558x speedup, step: 9, train time 7.48 s
Epoch 33/50 |loss: 0.124703| train set 5.263x speedup, test set 0.885x speedup, val set 5.539x speedup, step: 10, train time 7.49 s
Epoch 34/50 |loss: 0.122809| train set 5.262x speedup, test set 0.890x speedup, val set 5.638x speedup, step: 1, train time 7.79 s
Epoch 35/50 |loss: 0.122196| train set 5.262x speedup, test set 0.851x speedup, val set 5.638x speedup, step: 2, train time 7.62 s
Epoch 36/50 |loss: 0.122321| train set 5.263x speedup, test set 0.875x speedup, val set 5.539x speedup, step: 3, train time 7.88 s
Epoch 37/50 |loss: 0.123247| train set 5.263x speedup, test set 0.893x speedup, val set 5.539x speedup, step: 4, train time 7.89 s
Epoch 38/50 |loss: 0.121059| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 5, train time 7.78 s
Epoch 39/50 |loss: 0.120804| train set 5.263x speedup, test set 0.869x speedup, val set 5.539x speedup, step: 6, train time 7.57 s
Epoch 40/50 |loss: 0.123814| train set 5.263x speedup, test set 0.833x speedup, val set 5.539x speedup, step: 7, train time 7.98 s
Epoch 41/50 |loss: 0.120793| train set 5.263x speedup, test set 0.800x speedup, val set 5.539x speedup, step: 8, train time 7.68 s
Epoch 42/50 |loss: 0.121696| train set 5.263x speedup, test set 0.871x speedup, val set 5.539x speedup, step: 9, train time 7.68 s
Epoch 43/50 |loss: 0.119535| train set 5.181x speedup, test set 0.855x speedup, val set 5.579x speedup, step: 10, train time 8.20 s
Epoch 44/50 |loss: 0.120130| train set 5.262x speedup, test set 0.894x speedup, val set 5.638x speedup, step: 1, train time 7.67 s
Epoch 45/50 |loss: 0.119815| train set 5.262x speedup, test set 0.904x speedup, val set 5.638x speedup, step: 2, train time 8.07 s
Epoch 46/50 |loss: 0.120775| train set 5.257x speedup, test set 0.884x speedup, val set 5.610x speedup, step: 3, train time 7.88 s
Epoch 47/50 |loss: 0.120018| train set 5.262x speedup, test set 0.849x speedup, val set 5.638x speedup, step: 4, train time 7.62 s
Epoch 48/50 |loss: 0.118235| train set 5.262x speedup, test set 0.910x speedup, val set 5.638x speedup, step: 5, train time 7.78 s
Epoch 49/50 |loss: 0.120668| train set 5.263x speedup, test set 0.901x speedup, val set 5.539x speedup, step: 6, train time 7.67 s
Training per epoch cost 7.867 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 5, train speedup 5.263, test speedup 1.108, val speedup 5.539
best test speedup epoch: 1, train speedup 4.717, test speedup 1.181, val speedup 4.991
best validation speedup epoch: 44, train speedup 5.262, test speedup 0.894, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 0.901, val speedup 5.539
execution cost 0:07:04.875492
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.553293, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397420| train set 4.898x speedup, test set 1.081x speedup, val set 5.123x speedup, step: 1, train time 8.94 s
Epoch 1/50 |loss: 0.238890| train set 4.577x speedup, test set 1.616x speedup, val set 4.849x speedup, step: 2, train time 7.71 s
Epoch 2/50 |loss: 0.207230| train set 5.241x speedup, test set 1.563x speedup, val set 5.517x speedup, step: 3, train time 7.89 s
Epoch 3/50 |loss: 0.180518| train set 5.192x speedup, test set 1.527x speedup, val set 5.562x speedup, step: 4, train time 7.96 s
Epoch 4/50 |loss: 0.179462| train set 5.263x speedup, test set 1.148x speedup, val set 5.539x speedup, step: 1, train time 7.91 s
Epoch 5/50 |loss: 0.168065| train set 5.262x speedup, test set 1.498x speedup, val set 5.638x speedup, step: 2, train time 7.87 s
Epoch 6/50 |loss: 0.162743| train set 5.262x speedup, test set 1.096x speedup, val set 5.637x speedup, step: 3, train time 8.27 s
Epoch 7/50 |loss: 0.155114| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 4, train time 7.87 s
Epoch 8/50 |loss: 0.151194| train set 5.263x speedup, test set 1.132x speedup, val set 5.539x speedup, step: 5, train time 7.97 s
Epoch 9/50 |loss: 0.151742| train set 5.263x speedup, test set 0.844x speedup, val set 5.539x speedup, step: 1, train time 7.79 s
Epoch 10/50 |loss: 0.146804| train set 5.262x speedup, test set 1.139x speedup, val set 5.638x speedup, step: 2, train time 7.77 s
Epoch 11/50 |loss: 0.142207| train set 5.263x speedup, test set 1.129x speedup, val set 5.540x speedup, step: 3, train time 7.69 s
Epoch 12/50 |loss: 0.137478| train set 5.262x speedup, test set 0.793x speedup, val set 5.638x speedup, step: 4, train time 7.99 s
Epoch 13/50 |loss: 0.138687| train set 5.263x speedup, test set 0.833x speedup, val set 5.539x speedup, step: 5, train time 7.67 s
Epoch 14/50 |loss: 0.136294| train set 5.263x speedup, test set 1.154x speedup, val set 5.540x speedup, step: 1, train time 8.10 s
Epoch 15/50 |loss: 0.135479| train set 5.262x speedup, test set 0.894x speedup, val set 5.638x speedup, step: 2, train time 7.77 s
Epoch 16/50 |loss: 0.133309| train set 5.262x speedup, test set 0.894x speedup, val set 5.638x speedup, step: 3, train time 7.77 s
Epoch 17/50 |loss: 0.132710| train set 5.263x speedup, test set 0.883x speedup, val set 5.540x speedup, step: 4, train time 7.60 s
Epoch 18/50 |loss: 0.133967| train set 5.263x speedup, test set 0.800x speedup, val set 5.539x speedup, step: 5, train time 7.88 s
Epoch 19/50 |loss: 0.131868| train set 5.262x speedup, test set 1.132x speedup, val set 5.638x speedup, step: 1, train time 7.81 s
Epoch 20/50 |loss: 0.131314| train set 5.263x speedup, test set 0.883x speedup, val set 5.528x speedup, step: 2, train time 7.59 s
Epoch 21/50 |loss: 0.129049| train set 5.262x speedup, test set 0.880x speedup, val set 5.638x speedup, step: 3, train time 8.07 s
Epoch 22/50 |loss: 0.129376| train set 5.262x speedup, test set 0.832x speedup, val set 5.638x speedup, step: 4, train time 8.29 s
Epoch 23/50 |loss: 0.129145| train set 5.263x speedup, test set 0.823x speedup, val set 5.539x speedup, step: 5, train time 7.59 s
Epoch 24/50 |loss: 0.128602| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1, train time 7.57 s
Epoch 25/50 |loss: 0.126852| train set 5.263x speedup, test set 0.877x speedup, val set 5.539x speedup, step: 2, train time 7.61 s
Epoch 26/50 |loss: 0.127958| train set 5.263x speedup, test set 1.136x speedup, val set 5.539x speedup, step: 3, train time 7.92 s
Epoch 27/50 |loss: 0.123533| train set 5.262x speedup, test set 0.816x speedup, val set 5.638x speedup, step: 4, train time 7.78 s
Epoch 28/50 |loss: 0.125171| train set 5.262x speedup, test set 1.140x speedup, val set 5.638x speedup, step: 5, train time 7.99 s
Epoch 29/50 |loss: 0.124222| train set 5.263x speedup, test set 0.882x speedup, val set 5.539x speedup, step: 6, train time 7.90 s
Epoch 30/50 |loss: 0.122336| train set 5.262x speedup, test set 0.883x speedup, val set 5.638x speedup, step: 7, train time 7.89 s
Epoch 31/50 |loss: 0.122772| train set 5.262x speedup, test set 0.884x speedup, val set 5.638x speedup, step: 8, train time 7.71 s
Epoch 32/50 |loss: 0.123178| train set 5.253x speedup, test set 0.788x speedup, val set 5.657x speedup, step: 9, train time 7.70 s
Epoch 33/50 |loss: 0.124382| train set 5.263x speedup, test set 0.895x speedup, val set 5.539x speedup, step: 10, train time 7.89 s
Epoch 34/50 |loss: 0.122948| train set 5.262x speedup, test set 0.875x speedup, val set 5.638x speedup, step: 1, train time 7.87 s
Epoch 35/50 |loss: 0.121830| train set 5.262x speedup, test set 0.873x speedup, val set 5.638x speedup, step: 2, train time 7.69 s
Epoch 36/50 |loss: 0.122478| train set 5.263x speedup, test set 0.881x speedup, val set 5.539x speedup, step: 3, train time 7.61 s
Epoch 37/50 |loss: 0.123062| train set 5.263x speedup, test set 0.869x speedup, val set 5.539x speedup, step: 4, train time 8.12 s
Epoch 38/50 |loss: 0.121008| train set 5.263x speedup, test set 0.832x speedup, val set 5.539x speedup, step: 5, train time 7.79 s
Epoch 39/50 |loss: 0.121917| train set 5.263x speedup, test set 0.886x speedup, val set 5.539x speedup, step: 6, train time 7.50 s
Epoch 40/50 |loss: 0.122775| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 7, train time 7.59 s
Epoch 41/50 |loss: 0.119455| train set 5.263x speedup, test set 0.886x speedup, val set 5.539x speedup, step: 8, train time 7.58 s
Epoch 42/50 |loss: 0.120664| train set 5.263x speedup, test set 0.883x speedup, val set 5.539x speedup, step: 9, train time 7.80 s
Epoch 43/50 |loss: 0.119596| train set 5.262x speedup, test set 0.878x speedup, val set 5.638x speedup, step: 10, train time 7.78 s
Epoch 44/50 |loss: 0.118751| train set 5.262x speedup, test set 0.884x speedup, val set 5.638x speedup, step: 1, train time 8.01 s
Epoch 45/50 |loss: 0.118524| train set 5.263x speedup, test set 0.883x speedup, val set 5.539x speedup, step: 2, train time 7.80 s
Epoch 46/50 |loss: 0.119686| train set 5.262x speedup, test set 0.886x speedup, val set 5.638x speedup, step: 3, train time 7.72 s
Epoch 47/50 |loss: 0.119029| train set 5.262x speedup, test set 0.846x speedup, val set 5.638x speedup, step: 4, train time 7.59 s
Epoch 48/50 |loss: 0.117901| train set 5.263x speedup, test set 1.128x speedup, val set 5.539x speedup, step: 5, train time 8.00 s
Epoch 49/50 |loss: 0.120973| train set 5.262x speedup, test set 0.898x speedup, val set 5.638x speedup, step: 1, train time 7.91 s
Training per epoch cost 7.842 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 1.959s, pg runtime 0.239s, speedup 0.122x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 4, train speedup 5.263, test speedup 1.148, val speedup 5.539
best test speedup epoch: 1, train speedup 4.577, test speedup 1.616, val speedup 4.849
best validation speedup epoch: 49, train speedup 5.262, test speedup 0.898, val speedup 5.638
last model at epoch 49, train speedup 5.262, test speedup 0.898, val speedup 5.638
execution cost 0:07:04.758427
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.517496, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.393764| train set 4.780x speedup, test set 1.151x speedup, val set 5.039x speedup, step: 1, train time 9.18 s
Epoch 1/50 |loss: 0.241777| train set 4.614x speedup, test set 1.650x speedup, val set 4.889x speedup, step: 2, train time 7.43 s
Epoch 2/50 |loss: 0.208154| train set 5.241x speedup, test set 1.115x speedup, val set 5.517x speedup, step: 3, train time 7.69 s
Epoch 3/50 |loss: 0.182653| train set 5.192x speedup, test set 1.148x speedup, val set 5.562x speedup, step: 4, train time 7.77 s
Epoch 4/50 |loss: 0.180623| train set 5.263x speedup, test set 1.163x speedup, val set 5.539x speedup, step: 1, train time 7.88 s
Epoch 5/50 |loss: 0.173487| train set 5.259x speedup, test set 1.030x speedup, val set 5.539x speedup, step: 2, train time 7.99 s
Epoch 6/50 |loss: 0.165669| train set 5.262x speedup, test set 0.975x speedup, val set 5.637x speedup, step: 3, train time 7.60 s
Epoch 7/50 |loss: 0.155735| train set 5.263x speedup, test set 0.848x speedup, val set 5.540x speedup, step: 4, train time 7.62 s
Epoch 8/50 |loss: 0.149534| train set 5.264x speedup, test set 1.091x speedup, val set 5.539x speedup, step: 5, train time 8.22 s
Epoch 9/50 |loss: 0.150960| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1, train time 7.86 s
Epoch 10/50 |loss: 0.145269| train set 5.262x speedup, test set 1.017x speedup, val set 5.638x speedup, step: 2, train time 7.71 s
Epoch 11/50 |loss: 0.143805| train set 5.263x speedup, test set 1.108x speedup, val set 5.540x speedup, step: 3, train time 8.06 s
Epoch 12/50 |loss: 0.137510| train set 5.263x speedup, test set 0.818x speedup, val set 5.539x speedup, step: 4, train time 7.69 s
Epoch 13/50 |loss: 0.138950| train set 5.263x speedup, test set 0.829x speedup, val set 5.539x speedup, step: 5, train time 7.88 s
Epoch 14/50 |loss: 0.137919| train set 5.262x speedup, test set 0.813x speedup, val set 5.638x speedup, step: 1, train time 7.80 s
Epoch 15/50 |loss: 0.136978| train set 5.214x speedup, test set 0.871x speedup, val set 5.562x speedup, step: 2, train time 7.76 s
Epoch 16/50 |loss: 0.133354| train set 5.262x speedup, test set 0.818x speedup, val set 5.638x speedup, step: 3, train time 7.79 s
Epoch 17/50 |loss: 0.132792| train set 5.263x speedup, test set 0.814x speedup, val set 5.540x speedup, step: 4, train time 7.91 s
Epoch 18/50 |loss: 0.136074| train set 5.263x speedup, test set 0.813x speedup, val set 5.540x speedup, step: 5, train time 7.79 s
Epoch 19/50 |loss: 0.131320| train set 5.262x speedup, test set 0.869x speedup, val set 5.638x speedup, step: 6, train time 7.72 s
Epoch 20/50 |loss: 0.133247| train set 5.263x speedup, test set 0.904x speedup, val set 5.539x speedup, step: 7, train time 7.78 s
Epoch 21/50 |loss: 0.129130| train set 5.263x speedup, test set 0.885x speedup, val set 5.539x speedup, step: 8, train time 8.07 s
Epoch 22/50 |loss: 0.131257| train set 5.262x speedup, test set 0.877x speedup, val set 5.638x speedup, step: 9, train time 8.27 s
Epoch 23/50 |loss: 0.126549| train set 5.263x speedup, test set 0.809x speedup, val set 5.539x speedup, step: 10, train time 7.77 s
Epoch 24/50 |loss: 0.130699| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 11, train time 7.62 s
Epoch 25/50 |loss: 0.127086| train set 5.263x speedup, test set 0.904x speedup, val set 5.539x speedup, step: 12, train time 8.10 s
Epoch 26/50 |loss: 0.127916| train set 5.263x speedup, test set 1.156x speedup, val set 5.539x speedup, step: 13, train time 7.90 s
Epoch 27/50 |loss: 0.124967| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 14, train time 7.79 s
Epoch 28/50 |loss: 0.126731| train set 5.262x speedup, test set 0.903x speedup, val set 5.638x speedup, step: 15, train time 7.63 s
Epoch 29/50 |loss: 0.125298| train set 5.263x speedup, test set 1.167x speedup, val set 5.539x speedup, step: 16, train time 7.69 s
Epoch 30/50 |loss: 0.124110| train set 5.263x speedup, test set 0.809x speedup, val set 5.539x speedup, step: 17, train time 7.70 s
Epoch 31/50 |loss: 0.123843| train set 5.262x speedup, test set 0.810x speedup, val set 5.637x speedup, step: 18, train time 8.07 s
Epoch 32/50 |loss: 0.124459| train set 5.253x speedup, test set 0.810x speedup, val set 5.657x speedup, step: 19, train time 8.37 s
Epoch 33/50 |loss: 0.126643| train set 5.263x speedup, test set 0.814x speedup, val set 5.539x speedup, step: 20, train time 7.99 s
Epoch 34/50 |loss: 0.123495| train set 5.262x speedup, test set 0.906x speedup, val set 5.638x speedup, step: 21, train time 7.78 s
Epoch 35/50 |loss: 0.122235| train set 5.262x speedup, test set 0.874x speedup, val set 5.638x speedup, step: 22, train time 8.19 s
Epoch 36/50 |loss: 0.124053| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 23, train time 8.09 s
Epoch 37/50 |loss: 0.123757| train set 5.263x speedup, test set 0.902x speedup, val set 5.539x speedup, step: 24, train time 7.61 s
Epoch 38/50 |loss: 0.122553| train set 5.263x speedup, test set 0.809x speedup, val set 5.539x speedup, step: 25, train time 7.60 s
Epoch 39/50 |loss: 0.122703| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 26, train time 8.00 s
Epoch 40/50 |loss: 0.124200| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 27, train time 8.07 s
Epoch 41/50 |loss: 0.121184| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 28, train time 8.09 s
Epoch 42/50 |loss: 0.121099| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 29, train time 7.91 s
Epoch 43/50 |loss: 0.120638| train set 5.177x speedup, test set 0.865x speedup, val set 5.667x speedup, step: 30, train time 7.85 s
Epoch 44/50 |loss: 0.119171| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 31, train time 7.98 s
Epoch 45/50 |loss: 0.118666| train set 5.263x speedup, test set 0.904x speedup, val set 5.539x speedup, step: 32, train time 8.17 s
Epoch 46/50 |loss: 0.119794| train set 5.259x speedup, test set 0.810x speedup, val set 5.625x speedup, step: 33, train time 7.71 s
Epoch 47/50 |loss: 0.119962| train set 5.262x speedup, test set 0.845x speedup, val set 5.638x speedup, step: 34, train time 7.89 s
Epoch 48/50 |loss: 0.116878| train set 5.263x speedup, test set 0.896x speedup, val set 5.539x speedup, step: 35, train time 7.69 s
Epoch 49/50 |loss: 0.121320| train set 5.263x speedup, test set 0.894x speedup, val set 5.539x speedup, step: 36, train time 8.00 s
Training per epoch cost 7.894 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 8, train speedup 5.264, test speedup 1.091, val speedup 5.539
best test speedup epoch: 1, train speedup 4.614, test speedup 1.650, val speedup 4.889
best validation speedup epoch: 14, train speedup 5.262, test speedup 0.813, val speedup 5.638
last model at epoch 49, train speedup 5.263, test speedup 0.894, val speedup 5.539
execution cost 0:07:07.292728
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.509673, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397081| train set 4.476x speedup, test set 1.042x speedup, val set 4.661x speedup, step: 1, train time 8.75 s
Epoch 1/50 |loss: 0.240887| train set 4.613x speedup, test set 1.781x speedup, val set 4.965x speedup, step: 2, train time 7.90 s
Epoch 2/50 |loss: 0.204246| train set 5.241x speedup, test set 1.007x speedup, val set 5.517x speedup, step: 3, train time 7.80 s
Epoch 3/50 |loss: 0.183786| train set 4.972x speedup, test set 1.159x speedup, val set 5.198x speedup, step: 4, train time 7.79 s
Epoch 4/50 |loss: 0.178163| train set 5.264x speedup, test set 1.119x speedup, val set 5.539x speedup, step: 1, train time 7.89 s
Epoch 5/50 |loss: 0.169349| train set 5.263x speedup, test set 1.014x speedup, val set 5.539x speedup, step: 2, train time 8.04 s
Epoch 6/50 |loss: 0.165762| train set 5.262x speedup, test set 1.195x speedup, val set 5.637x speedup, step: 3, train time 7.80 s
Epoch 7/50 |loss: 0.157417| train set 5.263x speedup, test set 1.014x speedup, val set 5.540x speedup, step: 4, train time 7.78 s
Epoch 8/50 |loss: 0.150993| train set 5.136x speedup, test set 1.051x speedup, val set 5.413x speedup, step: 5, train time 7.69 s
Epoch 9/50 |loss: 0.150929| train set 5.262x speedup, test set 0.979x speedup, val set 5.638x speedup, step: 1, train time 7.78 s
Epoch 10/50 |loss: 0.148888| train set 5.262x speedup, test set 1.012x speedup, val set 5.638x speedup, step: 2, train time 9.08 s
Epoch 11/50 |loss: 0.141804| train set 5.263x speedup, test set 1.013x speedup, val set 5.540x speedup, step: 3, train time 7.81 s
Epoch 12/50 |loss: 0.140550| train set 5.263x speedup, test set 0.798x speedup, val set 5.539x speedup, step: 4, train time 7.90 s
Epoch 13/50 |loss: 0.138484| train set 5.264x speedup, test set 1.104x speedup, val set 5.539x speedup, step: 5, train time 7.90 s
Epoch 14/50 |loss: 0.138781| train set 5.263x speedup, test set 1.006x speedup, val set 5.540x speedup, step: 6, train time 7.50 s
Epoch 15/50 |loss: 0.137953| train set 5.192x speedup, test set 1.018x speedup, val set 5.562x speedup, step: 7, train time 7.91 s
Epoch 16/50 |loss: 0.136810| train set 5.262x speedup, test set 0.818x speedup, val set 5.638x speedup, step: 8, train time 7.57 s
Epoch 17/50 |loss: 0.133991| train set 5.263x speedup, test set 1.131x speedup, val set 5.540x speedup, step: 9, train time 7.72 s
Epoch 18/50 |loss: 0.137913| train set 5.254x speedup, test set 1.008x speedup, val set 5.559x speedup, step: 10, train time 7.66 s
Epoch 19/50 |loss: 0.133868| train set 5.262x speedup, test set 1.054x speedup, val set 5.638x speedup, step: 1, train time 7.97 s
Epoch 20/50 |loss: 0.133995| train set 5.263x speedup, test set 1.162x speedup, val set 5.539x speedup, step: 2, train time 7.89 s
Epoch 21/50 |loss: 0.129210| train set 5.263x speedup, test set 1.131x speedup, val set 5.539x speedup, step: 3, train time 7.89 s
Epoch 22/50 |loss: 0.130331| train set 5.262x speedup, test set 1.014x speedup, val set 5.638x speedup, step: 4, train time 8.59 s
Epoch 23/50 |loss: 0.127955| train set 5.263x speedup, test set 1.022x speedup, val set 5.539x speedup, step: 5, train time 7.80 s
Epoch 24/50 |loss: 0.131394| train set 5.253x speedup, test set 0.793x speedup, val set 5.657x speedup, step: 1, train time 7.87 s
Epoch 25/50 |loss: 0.129180| train set 5.263x speedup, test set 1.030x speedup, val set 5.539x speedup, step: 2, train time 7.68 s
Epoch 26/50 |loss: 0.130674| train set 5.263x speedup, test set 1.139x speedup, val set 5.539x speedup, step: 3, train time 7.69 s
Epoch 27/50 |loss: 0.125914| train set 5.262x speedup, test set 1.009x speedup, val set 5.638x speedup, step: 4, train time 7.48 s
Epoch 28/50 |loss: 0.126146| train set 5.262x speedup, test set 1.148x speedup, val set 5.638x speedup, step: 5, train time 7.79 s
Epoch 29/50 |loss: 0.127521| train set 5.263x speedup, test set 1.021x speedup, val set 5.539x speedup, step: 6, train time 7.89 s
Epoch 30/50 |loss: 0.125226| train set 5.263x speedup, test set 1.046x speedup, val set 5.539x speedup, step: 7, train time 7.95 s
Epoch 31/50 |loss: 0.125661| train set 5.262x speedup, test set 1.005x speedup, val set 5.638x speedup, step: 8, train time 7.91 s
Epoch 32/50 |loss: 0.126884| train set 5.253x speedup, test set 0.812x speedup, val set 5.657x speedup, step: 9, train time 8.08 s
Epoch 33/50 |loss: 0.126325| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 10, train time 7.70 s
Epoch 34/50 |loss: 0.123314| train set 5.262x speedup, test set 1.102x speedup, val set 5.638x speedup, step: 11, train time 7.59 s
Epoch 35/50 |loss: 0.122267| train set 5.262x speedup, test set 1.092x speedup, val set 5.638x speedup, step: 12, train time 7.77 s
Epoch 36/50 |loss: 0.123908| train set 5.263x speedup, test set 1.144x speedup, val set 5.539x speedup, step: 13, train time 8.08 s
Epoch 37/50 |loss: 0.122871| train set 5.263x speedup, test set 1.154x speedup, val set 5.539x speedup, step: 14, train time 7.99 s
Epoch 38/50 |loss: 0.122431| train set 5.263x speedup, test set 0.773x speedup, val set 5.539x speedup, step: 15, train time 7.88 s
Epoch 39/50 |loss: 0.122704| train set 5.263x speedup, test set 0.823x speedup, val set 5.539x speedup, step: 16, train time 8.09 s
Epoch 40/50 |loss: 0.123868| train set 5.263x speedup, test set 0.796x speedup, val set 5.539x speedup, step: 17, train time 7.67 s
Epoch 41/50 |loss: 0.121688| train set 5.263x speedup, test set 1.030x speedup, val set 5.539x speedup, step: 18, train time 7.70 s
Epoch 42/50 |loss: 0.121081| train set 5.263x speedup, test set 0.870x speedup, val set 5.539x speedup, step: 19, train time 7.67 s
Epoch 43/50 |loss: 0.121783| train set 5.263x speedup, test set 0.867x speedup, val set 5.539x speedup, step: 20, train time 7.89 s
Epoch 44/50 |loss: 0.121198| train set 5.262x speedup, test set 0.876x speedup, val set 5.638x speedup, step: 21, train time 8.11 s
Epoch 45/50 |loss: 0.119162| train set 5.263x speedup, test set 1.081x speedup, val set 5.539x speedup, step: 22, train time 7.99 s
Epoch 46/50 |loss: 0.121364| train set 5.259x speedup, test set 0.855x speedup, val set 5.625x speedup, step: 23, train time 7.88 s
Epoch 47/50 |loss: 0.121046| train set 5.262x speedup, test set 0.862x speedup, val set 5.637x speedup, step: 24, train time 7.89 s
Epoch 48/50 |loss: 0.118415| train set 5.263x speedup, test set 0.864x speedup, val set 5.539x speedup, step: 25, train time 7.68 s
Epoch 49/50 |loss: 0.123060| train set 5.263x speedup, test set 0.874x speedup, val set 5.539x speedup, step: 26, train time 7.77 s
Training per epoch cost 7.882 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.933s, pg runtime 5.855s, speedup 0.987x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.675s, pg runtime 1.680s, speedup 1.003x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.603s, pg runtime 5.521s, speedup 0.985x
====================
best train speedup epoch: 4, train speedup 5.264, test speedup 1.119, val speedup 5.539
best test speedup epoch: 1, train speedup 4.613, test speedup 1.781, val speedup 4.965
best validation speedup epoch: 24, train speedup 5.253, test speedup 0.793, val speedup 5.657
last model at epoch 49, train speedup 5.263, test speedup 0.874, val speedup 5.539
execution cost 0:07:06.101753
==================================================
