all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.706013, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880975| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896385| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894742| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903337| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911717| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.918974| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918436| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921315| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.918860| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919265| train set 1.221x speedup, test set 2.068x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.919420| train set 1.221x speedup, test set 2.146x speedup, val set 0.388x speedup, step: 3
Epoch 26/200 |loss: -0.929409| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.928826| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 5
Epoch 28/200 |loss: -0.933084| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 6
Epoch 29/200 |loss: -0.931565| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 7
Epoch 30/200 |loss: -0.936776| train set 1.223x speedup, test set 2.251x speedup, val set 0.705x speedup, step: 1
Epoch 31/200 |loss: -0.933842| train set 1.235x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 2
Epoch 32/200 |loss: -0.939961| train set 1.221x speedup, test set 2.149x speedup, val set 0.887x speedup, step: 1
Epoch 33/200 |loss: -0.921487| train set 1.224x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 2
Epoch 34/200 |loss: -0.933014| train set 1.224x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 3
Epoch 35/200 |loss: -0.939491| train set 1.221x speedup, test set 2.289x speedup, val set 0.887x speedup, step: 1
Epoch 36/200 |loss: -0.927436| train set 1.221x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 2
Epoch 37/200 |loss: -0.932975| train set 1.221x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 3
early stopping at epoch 37
Training per epoch cost 0.997 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.829s, pg runtime 10.685s, speedup 1.087x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 8.117s, pg runtime 4.730s, speedup 0.583x
19, opt runtime 0.379s, model runtime 0.662s, pg runtime 3.645s, speedup 5.503x
20, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 3.136s, pg runtime 5.620s, speedup 1.792x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 2, train speedup 1.264, test speedup 0.953, val speedup 0.437
best test speedup epoch: 8, train speedup 1.103, test speedup 2.312, val speedup 0.361
best validation speedup epoch: 35, train speedup 1.221, test speedup 2.289, val speedup 0.887
last model at epoch 37, train speedup 1.221, test speedup 2.261, val speedup 0.437
execution cost 0:01:50.632522
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.097485, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880975| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896385| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894742| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903337| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911717| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.918972| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918427| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921344| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.919042| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919296| train set 1.221x speedup, test set 2.034x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.919670| train set 1.221x speedup, test set 2.146x speedup, val set 0.388x speedup, step: 3
Epoch 26/200 |loss: -0.929568| train set 1.221x speedup, test set 2.260x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.929094| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 5
Epoch 28/200 |loss: -0.933095| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 6
Epoch 29/200 |loss: -0.931683| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 7
Epoch 30/200 |loss: -0.937506| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 8
Epoch 31/200 |loss: -0.935756| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 9
Epoch 32/200 |loss: -0.941475| train set 1.224x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 10
Epoch 33/200 |loss: -0.922480| train set 1.224x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 11
Epoch 34/200 |loss: -0.938094| train set 1.221x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 12
Epoch 35/200 |loss: -0.936779| train set 1.221x speedup, test set 2.210x speedup, val set 0.437x speedup, step: 13
Epoch 36/200 |loss: -0.927360| train set 1.221x speedup, test set 2.289x speedup, val set 0.437x speedup, step: 14
Epoch 37/200 |loss: -0.933214| train set 1.221x speedup, test set 2.343x speedup, val set 0.437x speedup, step: 15
Epoch 38/200 |loss: -0.938333| train set 1.232x speedup, test set 2.343x speedup, val set 0.437x speedup, step: 16
Epoch 39/200 |loss: -0.934669| train set 1.232x speedup, test set 2.279x speedup, val set 0.437x speedup, step: 17
Epoch 40/200 |loss: -0.932416| train set 1.232x speedup, test set 2.289x speedup, val set 0.437x speedup, step: 18
early stopping at epoch 40
Training per epoch cost 1.006 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 5.271s, pg runtime 10.605s, speedup 2.012x
10, opt runtime 3.248s, model runtime 6.287s, pg runtime 10.538s, speedup 1.676x
11, opt runtime 0.294s, model runtime 8.200s, pg runtime 2.352s, speedup 0.287x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.887s, pg runtime 10.685s, speedup 1.081x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 5.597s, pg runtime 4.730s, speedup 0.845x
19, opt runtime 0.379s, model runtime 0.662s, pg runtime 3.645s, speedup 5.503x
20, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 7.012s, pg runtime 5.620s, speedup 0.801x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 8.456s, pg runtime 0.332s, speedup 0.039x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 2, train speedup 1.264, test speedup 0.953, val speedup 0.437
best test speedup epoch: 37, train speedup 1.221, test speedup 2.343, val speedup 0.437
best validation speedup epoch: 23, train speedup 1.221, test speedup 1.939, val speedup 0.676
last model at epoch 40, train speedup 1.232, test speedup 2.289, val speedup 0.437
execution cost 0:01:57.024950
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.601659, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880976| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896384| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894741| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903333| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911734| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.919027| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918711| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921459| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.918759| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919640| train set 1.221x speedup, test set 1.940x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.920053| train set 1.221x speedup, test set 2.146x speedup, val set 0.361x speedup, step: 3
Epoch 26/200 |loss: -0.930118| train set 1.221x speedup, test set 2.260x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.929742| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 5
Epoch 28/200 |loss: -0.934146| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 6
Epoch 29/200 |loss: -0.932652| train set 1.221x speedup, test set 2.261x speedup, val set 0.775x speedup, step: 1
Epoch 30/200 |loss: -0.936695| train set 1.221x speedup, test set 2.279x speedup, val set 0.705x speedup, step: 2
Epoch 31/200 |loss: -0.926483| train set 1.223x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 3
Epoch 32/200 |loss: -0.927159| train set 1.223x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 4
Epoch 33/200 |loss: -0.920520| train set 1.223x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 5
Epoch 34/200 |loss: -0.931746| train set 1.224x speedup, test set 2.136x speedup, val set 0.705x speedup, step: 6
Epoch 35/200 |loss: -0.932899| train set 1.223x speedup, test set 2.136x speedup, val set 0.887x speedup, step: 1
Epoch 36/200 |loss: -0.921179| train set 1.221x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 2
Epoch 37/200 |loss: -0.928768| train set 1.221x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 3
early stopping at epoch 37
Training per epoch cost 0.970 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.829s, pg runtime 10.685s, speedup 1.087x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 5.597s, pg runtime 4.730s, speedup 0.845x
19, opt runtime 0.379s, model runtime 0.662s, pg runtime 3.645s, speedup 5.503x
20, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 7.012s, pg runtime 5.620s, speedup 0.801x
23, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 2, train speedup 1.264, test speedup 0.953, val speedup 0.437
best test speedup epoch: 8, train speedup 1.103, test speedup 2.312, val speedup 0.361
best validation speedup epoch: 35, train speedup 1.223, test speedup 2.136, val speedup 0.887
last model at epoch 37, train speedup 1.221, test speedup 2.261, val speedup 0.437
execution cost 0:01:48.024392
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.669185, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880975| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896385| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894742| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903337| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911716| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.918974| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918456| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921327| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.918981| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919336| train set 1.221x speedup, test set 2.068x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.919333| train set 1.221x speedup, test set 2.146x speedup, val set 0.388x speedup, step: 3
Epoch 26/200 |loss: -0.929425| train set 1.221x speedup, test set 2.147x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.928603| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 5
Epoch 28/200 |loss: -0.932770| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 6
Epoch 29/200 |loss: -0.931469| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 7
Epoch 30/200 |loss: -0.936644| train set 1.223x speedup, test set 2.261x speedup, val set 0.611x speedup, step: 8
Epoch 31/200 |loss: -0.935527| train set 1.223x speedup, test set 2.261x speedup, val set 0.775x speedup, step: 1
Epoch 32/200 |loss: -0.941290| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 2
Epoch 33/200 |loss: -0.930671| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 3
Epoch 34/200 |loss: -0.941140| train set 1.224x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 4
Epoch 35/200 |loss: -0.943089| train set 1.224x speedup, test set 2.261x speedup, val set 0.395x speedup, step: 5
Epoch 36/200 |loss: -0.929700| train set 1.223x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 6
Epoch 37/200 |loss: -0.935731| train set 1.221x speedup, test set 2.279x speedup, val set 0.437x speedup, step: 7
Epoch 38/200 |loss: -0.942143| train set 1.221x speedup, test set 2.343x speedup, val set 0.437x speedup, step: 8
Epoch 39/200 |loss: -0.935803| train set 1.221x speedup, test set 2.289x speedup, val set 0.437x speedup, step: 9
Epoch 40/200 |loss: -0.933256| train set 1.232x speedup, test set 2.446x speedup, val set 0.437x speedup, step: 10
Epoch 41/200 |loss: -0.949153| train set 1.393x speedup, test set 2.388x speedup, val set 0.437x speedup, step: 11
Epoch 42/200 |loss: -0.941125| train set 1.232x speedup, test set 2.376x speedup, val set 0.437x speedup, step: 12
Epoch 43/200 |loss: -0.946093| train set 1.232x speedup, test set 2.526x speedup, val set 0.437x speedup, step: 13
Epoch 44/200 |loss: -0.946225| train set 1.232x speedup, test set 2.251x speedup, val set 0.437x speedup, step: 14
Epoch 45/200 |loss: -0.947775| train set 1.221x speedup, test set 2.359x speedup, val set 0.437x speedup, step: 15
Epoch 46/200 |loss: -0.944266| train set 1.221x speedup, test set 2.264x speedup, val set 0.437x speedup, step: 16
Epoch 47/200 |loss: -0.942681| train set 1.221x speedup, test set 2.264x speedup, val set 0.437x speedup, step: 17
Epoch 48/200 |loss: -0.936571| train set 1.221x speedup, test set 2.264x speedup, val set 0.437x speedup, step: 18
Epoch 49/200 |loss: -0.945121| train set 1.481x speedup, test set 2.490x speedup, val set 0.437x speedup, step: 19
Epoch 50/200 |loss: -0.940925| train set 1.233x speedup, test set 2.236x speedup, val set 0.437x speedup, step: 20
early stopping at epoch 50
Training per epoch cost 0.965 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.829s, pg runtime 10.685s, speedup 1.087x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 5.597s, pg runtime 4.730s, speedup 0.845x
19, opt runtime 0.379s, model runtime 0.662s, pg runtime 3.645s, speedup 5.503x
20, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 7.012s, pg runtime 5.620s, speedup 0.801x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 49, train speedup 1.481, test speedup 2.490, val speedup 0.437
best test speedup epoch: 43, train speedup 1.232, test speedup 2.526, val speedup 0.437
best validation speedup epoch: 31, train speedup 1.223, test speedup 2.261, val speedup 0.775
last model at epoch 50, train speedup 1.233, test speedup 2.236, val speedup 0.437
execution cost 0:02:20.287039
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.493877, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880976| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896384| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894741| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903333| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911734| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.919027| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918711| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921459| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.918760| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919640| train set 1.221x speedup, test set 1.940x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.920054| train set 1.221x speedup, test set 2.146x speedup, val set 0.361x speedup, step: 3
Epoch 26/200 |loss: -0.930120| train set 1.221x speedup, test set 2.260x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.929732| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 5
Epoch 28/200 |loss: -0.934136| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 6
Epoch 29/200 |loss: -0.932599| train set 1.223x speedup, test set 2.261x speedup, val set 0.775x speedup, step: 1
Epoch 30/200 |loss: -0.931814| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 2
Epoch 31/200 |loss: -0.927790| train set 1.224x speedup, test set 2.261x speedup, val set 0.887x speedup, step: 1
Epoch 32/200 |loss: -0.938362| train set 1.221x speedup, test set 2.279x speedup, val set 0.887x speedup, step: 1
Epoch 33/200 |loss: -0.920924| train set 1.221x speedup, test set 2.210x speedup, val set 0.887x speedup, step: 1
Epoch 34/200 |loss: -0.936095| train set 1.223x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 2
Epoch 35/200 |loss: -0.939088| train set 1.223x speedup, test set 1.981x speedup, val set 0.437x speedup, step: 3
Epoch 36/200 |loss: -0.926746| train set 1.223x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 4
Epoch 37/200 |loss: -0.933604| train set 1.221x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 5
early stopping at epoch 37
Training per epoch cost 0.976 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.829s, pg runtime 10.685s, speedup 1.087x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 8.117s, pg runtime 4.730s, speedup 0.583x
19, opt runtime 0.379s, model runtime 0.662s, pg runtime 3.645s, speedup 5.503x
20, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 7.012s, pg runtime 5.620s, speedup 0.801x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 2, train speedup 1.264, test speedup 0.953, val speedup 0.437
best test speedup epoch: 8, train speedup 1.103, test speedup 2.312, val speedup 0.361
best validation speedup epoch: 33, train speedup 1.221, test speedup 2.210, val speedup 0.887
last model at epoch 37, train speedup 1.221, test speedup 2.261, val speedup 0.437
execution cost 0:01:49.276006
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.739323, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880976| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896384| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894741| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903333| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911734| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.919027| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918711| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921459| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.918760| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919640| train set 1.221x speedup, test set 1.940x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.920054| train set 1.221x speedup, test set 2.146x speedup, val set 0.361x speedup, step: 3
Epoch 26/200 |loss: -0.930120| train set 1.221x speedup, test set 2.260x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.929732| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 5
Epoch 28/200 |loss: -0.934136| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 6
Epoch 29/200 |loss: -0.932599| train set 1.223x speedup, test set 2.261x speedup, val set 0.775x speedup, step: 1
Epoch 30/200 |loss: -0.931635| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 2
Epoch 31/200 |loss: -0.927699| train set 1.224x speedup, test set 2.261x speedup, val set 0.887x speedup, step: 1
Epoch 32/200 |loss: -0.938075| train set 1.221x speedup, test set 2.279x speedup, val set 0.887x speedup, step: 1
Epoch 33/200 |loss: -0.920881| train set 1.221x speedup, test set 2.210x speedup, val set 0.887x speedup, step: 1
Epoch 34/200 |loss: -0.935976| train set 1.223x speedup, test set 2.207x speedup, val set 0.437x speedup, step: 2
Epoch 35/200 |loss: -0.939000| train set 1.223x speedup, test set 1.981x speedup, val set 0.437x speedup, step: 3
Epoch 36/200 |loss: -0.926251| train set 1.223x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 4
Epoch 37/200 |loss: -0.933156| train set 1.221x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 5
early stopping at epoch 37
Training per epoch cost 0.902 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.829s, pg runtime 10.685s, speedup 1.087x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 8.117s, pg runtime 4.730s, speedup 0.583x
19, opt runtime 0.379s, model runtime 0.662s, pg runtime 3.645s, speedup 5.503x
20, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 7.012s, pg runtime 5.620s, speedup 0.801x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 2, train speedup 1.264, test speedup 0.953, val speedup 0.437
best test speedup epoch: 8, train speedup 1.103, test speedup 2.312, val speedup 0.361
best validation speedup epoch: 33, train speedup 1.221, test speedup 2.210, val speedup 0.887
last model at epoch 37, train speedup 1.221, test speedup 2.261, val speedup 0.437
execution cost 0:01:42.010037
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.743108, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880975| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896385| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894742| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903337| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911717| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.918974| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918436| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921338| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.918997| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919306| train set 1.221x speedup, test set 2.034x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.919737| train set 1.221x speedup, test set 2.146x speedup, val set 0.361x speedup, step: 3
Epoch 26/200 |loss: -0.929390| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.928394| train set 1.221x speedup, test set 2.212x speedup, val set 0.388x speedup, step: 5
Epoch 28/200 |loss: -0.931921| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 6
Epoch 29/200 |loss: -0.930871| train set 1.223x speedup, test set 2.343x speedup, val set 0.705x speedup, step: 1
Epoch 30/200 |loss: -0.936645| train set 1.223x speedup, test set 2.261x speedup, val set 0.705x speedup, step: 1
Epoch 31/200 |loss: -0.935227| train set 1.223x speedup, test set 2.261x speedup, val set 0.705x speedup, step: 1
Epoch 32/200 |loss: -0.941170| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 2
Epoch 33/200 |loss: -0.930370| train set 1.223x speedup, test set 2.251x speedup, val set 0.388x speedup, step: 3
Epoch 34/200 |loss: -0.940907| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 4
Epoch 35/200 |loss: -0.943198| train set 1.223x speedup, test set 2.251x speedup, val set 0.437x speedup, step: 5
Epoch 36/200 |loss: -0.933421| train set 1.223x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 6
Epoch 37/200 |loss: -0.936971| train set 1.221x speedup, test set 2.210x speedup, val set 0.437x speedup, step: 7
Epoch 38/200 |loss: -0.942210| train set 1.221x speedup, test set 2.201x speedup, val set 0.437x speedup, step: 8
Epoch 39/200 |loss: -0.936468| train set 1.232x speedup, test set 2.279x speedup, val set 0.437x speedup, step: 9
Epoch 40/200 |loss: -0.933818| train set 1.232x speedup, test set 2.377x speedup, val set 0.437x speedup, step: 10
Epoch 41/200 |loss: -0.948844| train set 1.232x speedup, test set 2.264x speedup, val set 0.437x speedup, step: 11
Epoch 42/200 |loss: -0.939450| train set 1.232x speedup, test set 2.416x speedup, val set 0.437x speedup, step: 12
Epoch 43/200 |loss: -0.945953| train set 1.232x speedup, test set 2.264x speedup, val set 0.437x speedup, step: 13
Epoch 44/200 |loss: -0.946312| train set 1.232x speedup, test set 2.429x speedup, val set 0.437x speedup, step: 14
Epoch 45/200 |loss: -0.949075| train set 1.232x speedup, test set 2.262x speedup, val set 0.437x speedup, step: 15
Epoch 46/200 |loss: -0.948904| train set 1.232x speedup, test set 2.264x speedup, val set 0.437x speedup, step: 16
Epoch 47/200 |loss: -0.939172| train set 1.393x speedup, test set 2.462x speedup, val set 0.437x speedup, step: 17
Epoch 48/200 |loss: -0.933262| train set 1.232x speedup, test set 2.264x speedup, val set 0.887x speedup, step: 1
Epoch 49/200 |loss: -0.938355| train set 1.233x speedup, test set 2.264x speedup, val set 0.887x speedup, step: 1
Epoch 50/200 |loss: -0.931978| train set 1.233x speedup, test set 2.289x speedup, val set 0.437x speedup, step: 2
early stopping at epoch 50
Training per epoch cost 0.944 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.829s, pg runtime 10.685s, speedup 1.087x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 8.117s, pg runtime 4.730s, speedup 0.583x
19, opt runtime 0.379s, model runtime 1.402s, pg runtime 3.645s, speedup 2.601x
20, opt runtime 0.626s, model runtime 1.879s, pg runtime 2.558s, speedup 1.362x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 3.136s, pg runtime 5.620s, speedup 1.792x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 47, train speedup 1.393, test speedup 2.462, val speedup 0.437
best test speedup epoch: 47, train speedup 1.393, test speedup 2.462, val speedup 0.437
best validation speedup epoch: 49, train speedup 1.233, test speedup 2.264, val speedup 0.887
last model at epoch 50, train speedup 1.233, test speedup 2.289, val speedup 0.437
execution cost 0:02:20.409815
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.671593, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880976| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896384| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894741| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903333| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911734| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.919027| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918711| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921459| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.918759| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919640| train set 1.221x speedup, test set 1.940x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.920054| train set 1.221x speedup, test set 2.146x speedup, val set 0.361x speedup, step: 3
Epoch 26/200 |loss: -0.930119| train set 1.221x speedup, test set 2.260x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.929733| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 5
Epoch 28/200 |loss: -0.934137| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 6
Epoch 29/200 |loss: -0.932600| train set 1.223x speedup, test set 2.261x speedup, val set 0.775x speedup, step: 1
Epoch 30/200 |loss: -0.932508| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 2
Epoch 31/200 |loss: -0.929127| train set 1.224x speedup, test set 2.261x speedup, val set 0.887x speedup, step: 1
Epoch 32/200 |loss: -0.940178| train set 1.221x speedup, test set 2.201x speedup, val set 0.887x speedup, step: 1
Epoch 33/200 |loss: -0.923788| train set 1.223x speedup, test set 2.210x speedup, val set 0.437x speedup, step: 2
Epoch 34/200 |loss: -0.940329| train set 1.223x speedup, test set 2.135x speedup, val set 0.437x speedup, step: 3
Epoch 35/200 |loss: -0.941907| train set 1.223x speedup, test set 2.036x speedup, val set 0.437x speedup, step: 4
Epoch 36/200 |loss: -0.931603| train set 1.223x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 5
Epoch 37/200 |loss: -0.935814| train set 1.223x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 6
Epoch 38/200 |loss: -0.942252| train set 1.232x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 7
Epoch 39/200 |loss: -0.938125| train set 1.232x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 8
Epoch 40/200 |loss: -0.936003| train set 1.232x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 9
Epoch 41/200 |loss: -0.951591| train set 1.232x speedup, test set 2.290x speedup, val set 0.437x speedup, step: 10
Epoch 42/200 |loss: -0.943565| train set 1.232x speedup, test set 2.238x speedup, val set 0.437x speedup, step: 11
Epoch 43/200 |loss: -0.947613| train set 1.232x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 12
Epoch 44/200 |loss: -0.947909| train set 1.232x speedup, test set 2.289x speedup, val set 0.437x speedup, step: 13
Epoch 45/200 |loss: -0.948983| train set 1.232x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 14
Epoch 46/200 |loss: -0.949887| train set 1.232x speedup, test set 2.356x speedup, val set 0.437x speedup, step: 15
Epoch 47/200 |loss: -0.947785| train set 1.232x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 16
Epoch 48/200 |loss: -0.942618| train set 1.232x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 17
Epoch 49/200 |loss: -0.951362| train set 1.232x speedup, test set 2.290x speedup, val set 0.437x speedup, step: 18
Epoch 50/200 |loss: -0.944959| train set 1.232x speedup, test set 2.290x speedup, val set 0.437x speedup, step: 19
early stopping at epoch 50
Training per epoch cost 0.962 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.829s, pg runtime 10.685s, speedup 1.087x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 8.117s, pg runtime 4.730s, speedup 0.583x
19, opt runtime 0.379s, model runtime 0.662s, pg runtime 3.645s, speedup 5.503x
20, opt runtime 0.626s, model runtime 1.879s, pg runtime 2.558s, speedup 1.362x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 7.012s, pg runtime 5.620s, speedup 0.801x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 2, train speedup 1.264, test speedup 0.953, val speedup 0.437
best test speedup epoch: 46, train speedup 1.232, test speedup 2.356, val speedup 0.437
best validation speedup epoch: 32, train speedup 1.221, test speedup 2.201, val speedup 0.887
last model at epoch 50, train speedup 1.232, test speedup 2.290, val speedup 0.437
execution cost 0:02:20.097680
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.731062, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880976| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896384| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894741| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903333| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911734| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.919027| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918711| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921459| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.918760| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919640| train set 1.221x speedup, test set 1.940x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.920054| train set 1.221x speedup, test set 2.146x speedup, val set 0.361x speedup, step: 3
Epoch 26/200 |loss: -0.930120| train set 1.221x speedup, test set 2.260x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.929732| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 5
Epoch 28/200 |loss: -0.934136| train set 1.221x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 6
Epoch 29/200 |loss: -0.932599| train set 1.223x speedup, test set 2.261x speedup, val set 0.775x speedup, step: 1
Epoch 30/200 |loss: -0.931814| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 2
Epoch 31/200 |loss: -0.927790| train set 1.224x speedup, test set 2.261x speedup, val set 0.887x speedup, step: 1
Epoch 32/200 |loss: -0.938362| train set 1.221x speedup, test set 2.279x speedup, val set 0.887x speedup, step: 1
Epoch 33/200 |loss: -0.920924| train set 1.221x speedup, test set 2.210x speedup, val set 0.887x speedup, step: 1
Epoch 34/200 |loss: -0.936095| train set 1.223x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 2
Epoch 35/200 |loss: -0.939088| train set 1.223x speedup, test set 1.981x speedup, val set 0.437x speedup, step: 3
Epoch 36/200 |loss: -0.926746| train set 1.223x speedup, test set 2.136x speedup, val set 0.437x speedup, step: 4
Epoch 37/200 |loss: -0.933604| train set 1.221x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 5
early stopping at epoch 37
Training per epoch cost 0.983 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.829s, pg runtime 10.685s, speedup 1.087x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 8.117s, pg runtime 4.730s, speedup 0.583x
19, opt runtime 0.379s, model runtime 0.662s, pg runtime 3.645s, speedup 5.503x
20, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 7.012s, pg runtime 5.620s, speedup 0.801x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 2, train speedup 1.264, test speedup 0.953, val speedup 0.437
best test speedup epoch: 8, train speedup 1.103, test speedup 2.312, val speedup 0.361
best validation speedup epoch: 33, train speedup 1.221, test speedup 2.210, val speedup 0.887
last model at epoch 37, train speedup 1.221, test speedup 2.261, val speedup 0.437
execution cost 0:01:49.722268
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
2.4746314717390394
-0.059129222292990787
construct training samples cost 0:00:01.076913, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.733497| train set 1.077x speedup, test set 0.850x speedup, val set 0.388x speedup, step: 1
Epoch 1/200 |loss: -0.750605| train set 0.977x speedup, test set 1.141x speedup, val set 0.388x speedup, step: 1
Epoch 2/200 |loss: -0.793691| train set 1.264x speedup, test set 0.953x speedup, val set 0.437x speedup, step: 1
Epoch 3/200 |loss: -0.791526| train set 1.131x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 1
Epoch 4/200 |loss: -0.830339| train set 1.063x speedup, test set 1.027x speedup, val set 0.282x speedup, step: 2
Epoch 5/200 |loss: -0.846982| train set 1.015x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 3
Epoch 6/200 |loss: -0.850857| train set 1.013x speedup, test set 1.475x speedup, val set 0.296x speedup, step: 4
Epoch 7/200 |loss: -0.856393| train set 1.013x speedup, test set 2.089x speedup, val set 0.296x speedup, step: 5
Epoch 8/200 |loss: -0.861420| train set 1.103x speedup, test set 2.312x speedup, val set 0.361x speedup, step: 6
Epoch 9/200 |loss: -0.867949| train set 1.062x speedup, test set 1.594x speedup, val set 0.361x speedup, step: 7
Epoch 10/200 |loss: -0.863042| train set 1.062x speedup, test set 1.367x speedup, val set 0.361x speedup, step: 8
Epoch 11/200 |loss: -0.877612| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 9
Epoch 12/200 |loss: -0.881179| train set 1.064x speedup, test set 1.419x speedup, val set 0.361x speedup, step: 10
Epoch 13/200 |loss: -0.880976| train set 0.967x speedup, test set 1.358x speedup, val set 0.361x speedup, step: 11
Epoch 14/200 |loss: -0.886747| train set 0.965x speedup, test set 1.342x speedup, val set 0.361x speedup, step: 12
Epoch 15/200 |loss: -0.899628| train set 1.064x speedup, test set 1.597x speedup, val set 0.361x speedup, step: 13
Epoch 16/200 |loss: -0.896384| train set 1.064x speedup, test set 1.541x speedup, val set 0.454x speedup, step: 1
Epoch 17/200 |loss: -0.894741| train set 0.967x speedup, test set 1.494x speedup, val set 0.454x speedup, step: 1
Epoch 18/200 |loss: -0.903333| train set 1.064x speedup, test set 1.540x speedup, val set 0.454x speedup, step: 1
Epoch 19/200 |loss: -0.911735| train set 1.223x speedup, test set 1.706x speedup, val set 0.454x speedup, step: 1
Epoch 20/200 |loss: -0.919028| train set 1.065x speedup, test set 1.785x speedup, val set 0.454x speedup, step: 1
Epoch 21/200 |loss: -0.918716| train set 1.221x speedup, test set 1.885x speedup, val set 0.676x speedup, step: 1
Epoch 22/200 |loss: -0.921458| train set 1.221x speedup, test set 2.086x speedup, val set 0.676x speedup, step: 1
Epoch 23/200 |loss: -0.918766| train set 1.221x speedup, test set 1.939x speedup, val set 0.676x speedup, step: 1
Epoch 24/200 |loss: -0.919641| train set 1.221x speedup, test set 1.940x speedup, val set 0.361x speedup, step: 2
Epoch 25/200 |loss: -0.920063| train set 1.221x speedup, test set 2.146x speedup, val set 0.361x speedup, step: 3
Epoch 26/200 |loss: -0.930181| train set 1.221x speedup, test set 2.260x speedup, val set 0.388x speedup, step: 4
Epoch 27/200 |loss: -0.929519| train set 1.221x speedup, test set 2.261x speedup, val set 0.383x speedup, step: 5
Epoch 28/200 |loss: -0.933884| train set 1.221x speedup, test set 2.261x speedup, val set 0.361x speedup, step: 6
Epoch 29/200 |loss: -0.932246| train set 1.223x speedup, test set 2.261x speedup, val set 0.775x speedup, step: 1
Epoch 30/200 |loss: -0.936955| train set 1.223x speedup, test set 2.261x speedup, val set 0.611x speedup, step: 2
Epoch 31/200 |loss: -0.935142| train set 1.223x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 3
Epoch 32/200 |loss: -0.940583| train set 1.224x speedup, test set 2.201x speedup, val set 0.388x speedup, step: 4
Epoch 33/200 |loss: -0.926842| train set 1.224x speedup, test set 2.261x speedup, val set 0.388x speedup, step: 5
Epoch 34/200 |loss: -0.938119| train set 1.221x speedup, test set 2.279x speedup, val set 0.887x speedup, step: 1
Epoch 35/200 |loss: -0.938200| train set 1.221x speedup, test set 2.261x speedup, val set 0.437x speedup, step: 2
Epoch 36/200 |loss: -0.930721| train set 1.224x speedup, test set 2.260x speedup, val set 0.437x speedup, step: 3
Epoch 37/200 |loss: -0.933134| train set 1.221x speedup, test set 2.343x speedup, val set 0.437x speedup, step: 4
early stopping at epoch 37
Training per epoch cost 0.938 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
02, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
03, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
04, opt runtime 1.386s, model runtime 5.844s, pg runtime 1.386s, speedup 0.237x
05, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
06, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
07, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
08, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
13, opt runtime 5.179s, model runtime 9.829s, pg runtime 10.685s, speedup 1.087x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
16, opt runtime 1.876s, model runtime 7.477s, pg runtime 6.089s, speedup 0.814x
17, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
18, opt runtime 0.953s, model runtime 8.117s, pg runtime 4.730s, speedup 0.583x
19, opt runtime 0.379s, model runtime 0.662s, pg runtime 3.645s, speedup 5.503x
20, opt runtime 0.626s, model runtime 1.879s, pg runtime 2.558s, speedup 1.362x
21, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
22, opt runtime 3.136s, model runtime 3.136s, pg runtime 5.620s, speedup 1.792x
23, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
24, opt runtime 0.332s, model runtime 2.055s, pg runtime 0.332s, speedup 0.162x
25, opt runtime 2.971s, model runtime 2.971s, pg runtime 8.605s, speedup 2.897x
26, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
====================
best train speedup epoch: 2, train speedup 1.264, test speedup 0.953, val speedup 0.437
best test speedup epoch: 37, train speedup 1.221, test speedup 2.343, val speedup 0.437
best validation speedup epoch: 34, train speedup 1.221, test speedup 2.279, val speedup 0.887
last model at epoch 37, train speedup 1.221, test speedup 2.343, val speedup 0.437
execution cost 0:01:42.499035
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.974717, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406723| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027796| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935153| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438593| train set 1.142x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477202| train set 1.306x speedup, test set 0.889x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149713| train set 1.306x speedup, test set 0.895x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990738| train set 1.383x speedup, test set 0.861x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259737| train set 1.225x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653825| train set 1.417x speedup, test set 1.072x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351105| train set 1.478x speedup, test set 0.881x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908953| train set 1.412x speedup, test set 0.888x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132760| train set 1.367x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.264368| train set 1.435x speedup, test set 1.234x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.361890| train set 1.550x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.800314| train set 1.623x speedup, test set 0.832x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.409030| train set 1.663x speedup, test set 0.821x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.500640| train set 1.663x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.381048| train set 1.790x speedup, test set 0.889x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.540546| train set 1.790x speedup, test set 0.831x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.197966| train set 1.806x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.768182| train set 1.810x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.523499| train set 1.810x speedup, test set 1.150x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.372113| train set 1.764x speedup, test set 1.033x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.359385| train set 1.766x speedup, test set 0.879x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.529855| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 11.218946| train set 1.809x speedup, test set 0.824x speedup, val set 0.296x speedup, step: 27
Epoch 27/200 |loss: 11.824827| train set 1.747x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.464472| train set 1.790x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.100592| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.428199| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.885533| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.740400| train set 1.766x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.181039| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.446459| train set 1.790x speedup, test set 0.854x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.035734| train set 1.810x speedup, test set 0.844x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.607118| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.450741| train set 1.791x speedup, test set 1.002x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.438807| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.503103| train set 1.776x speedup, test set 0.888x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.644651| train set 1.680x speedup, test set 0.978x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.312303| train set 1.808x speedup, test set 1.032x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.358510| train set 1.757x speedup, test set 0.832x speedup, val set 0.450x speedup, step: 43
Epoch 43/200 |loss: 11.780032| train set 1.747x speedup, test set 0.989x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.996202| train set 1.788x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.949403| train set 1.681x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.545512| train set 1.711x speedup, test set 0.828x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.863471| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.906682| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.141144| train set 1.810x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.959826| train set 1.791x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.359987| train set 1.747x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.819817| train set 1.716x speedup, test set 0.834x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.764937| train set 1.766x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.965213| train set 1.810x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.181875| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.470011| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.789783| train set 1.791x speedup, test set 1.013x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.089308| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.847378| train set 1.810x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.962674| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.986222| train set 1.791x speedup, test set 1.009x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.456504| train set 1.791x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.843607| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.782616| train set 1.651x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.096325| train set 1.810x speedup, test set 1.030x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.258775| train set 1.766x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.883597| train set 1.734x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.289067| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.708648| train set 1.680x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 8.890906| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.074053| train set 1.790x speedup, test set 0.857x speedup, val set 0.477x speedup, step: 72
Epoch 72/200 |loss: 9.701570| train set 1.790x speedup, test set 0.856x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.603343| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.255972| train set 1.810x speedup, test set 0.881x speedup, val set 0.477x speedup, step: 75
Epoch 75/200 |loss: 8.568705| train set 1.810x speedup, test set 0.888x speedup, val set 0.477x speedup, step: 76
Epoch 76/200 |loss: 8.277320| train set 1.696x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 8.119436| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.379076| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.972616| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.150497| train set 1.808x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.623589| train set 1.774x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.135731| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.818564| train set 1.810x speedup, test set 0.888x speedup, val set 0.450x speedup, step: 84
Epoch 84/200 |loss: 8.299555| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.068383| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.017137| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.676390| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.127047| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.016374| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.597145| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.112341| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.848436| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.066654| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.204610| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.226961| train set 1.791x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.413679| train set 1.757x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.992409| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.209425| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.072511| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.885331| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.246526| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.081684| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.995204| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 1
Epoch 104/200 |loss: 8.902967| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 1
Epoch 105/200 |loss: 8.470639| train set 1.680x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 1
Epoch 106/200 |loss: 8.750445| train set 1.809x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 107/200 |loss: 10.129280| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 1
Epoch 108/200 |loss: 9.850703| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 1
Epoch 109/200 |loss: 8.533986| train set 1.790x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 1
Epoch 110/200 |loss: 9.013771| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 1
Epoch 111/200 |loss: 8.639289| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 1
Epoch 112/200 |loss: 8.003438| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 1
Epoch 113/200 |loss: 9.889349| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 1
Epoch 114/200 |loss: 9.022006| train set 1.765x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 1
Epoch 115/200 |loss: 8.836651| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 1
Epoch 116/200 |loss: 8.231788| train set 1.791x speedup, test set 0.908x speedup, val set 0.296x speedup, step: 1
Epoch 117/200 |loss: 10.893975| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 1
Epoch 118/200 |loss: 8.551869| train set 1.810x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 1
Epoch 119/200 |loss: 8.305895| train set 1.810x speedup, test set 0.889x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.312438| train set 1.810x speedup, test set 0.889x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.463259| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 2
Epoch 122/200 |loss: 9.371514| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 3
Epoch 123/200 |loss: 8.830682| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 4
Epoch 124/200 |loss: 8.674404| train set 1.757x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 5
Epoch 125/200 |loss: 8.498199| train set 1.757x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 6
Epoch 126/200 |loss: 8.189974| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 7
Epoch 127/200 |loss: 7.754834| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 8
Epoch 128/200 |loss: 8.732095| train set 1.776x speedup, test set 0.885x speedup, val set 0.513x speedup, step: 1
Epoch 129/200 |loss: 8.316547| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 2
Epoch 130/200 |loss: 8.460402| train set 1.810x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 3
Epoch 131/200 |loss: 8.802965| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 4
Epoch 132/200 |loss: 7.968215| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 5
Epoch 133/200 |loss: 8.292969| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 6
Epoch 134/200 |loss: 8.793789| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 7
Epoch 135/200 |loss: 8.064637| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 8
Epoch 136/200 |loss: 7.772998| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 9
Epoch 137/200 |loss: 8.165014| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 10
Epoch 138/200 |loss: 6.742226| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 11
Epoch 139/200 |loss: 7.230499| train set 1.696x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 12
Epoch 140/200 |loss: 6.838614| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 13
Epoch 141/200 |loss: 10.410792| train set 1.776x speedup, test set 0.895x speedup, val set 0.477x speedup, step: 14
Epoch 142/200 |loss: 8.426432| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 15
Epoch 143/200 |loss: 8.545735| train set 1.791x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 16
Epoch 144/200 |loss: 9.396801| train set 1.791x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 17
Epoch 145/200 |loss: 9.730148| train set 1.757x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 18
Epoch 146/200 |loss: 7.328141| train set 1.757x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 19
Epoch 147/200 |loss: 9.656498| train set 1.791x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 20
Epoch 148/200 |loss: 7.045266| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 21
Epoch 149/200 |loss: 9.022268| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 22
Epoch 150/200 |loss: 8.543887| train set 1.776x speedup, test set 0.898x speedup, val set 0.513x speedup, step: 1
Epoch 151/200 |loss: 9.318686| train set 1.776x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 2
Epoch 152/200 |loss: 7.623425| train set 1.810x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 3
Epoch 153/200 |loss: 7.585518| train set 1.810x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 4
Epoch 154/200 |loss: 8.617979| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 5
Epoch 155/200 |loss: 7.546001| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 6
Epoch 156/200 |loss: 7.342512| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 7
Epoch 157/200 |loss: 7.704079| train set 1.790x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 8
Epoch 158/200 |loss: 10.014012| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 9
Epoch 159/200 |loss: 9.586660| train set 1.810x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 10
Epoch 160/200 |loss: 7.517719| train set 1.810x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 11
Epoch 161/200 |loss: 9.379198| train set 1.810x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 12
Epoch 162/200 |loss: 10.104303| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 13
Epoch 163/200 |loss: 7.688218| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 14
Epoch 164/200 |loss: 8.220033| train set 1.810x speedup, test set 0.908x speedup, val set 0.296x speedup, step: 15
Epoch 165/200 |loss: 7.685214| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 16
Epoch 166/200 |loss: 9.239101| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 17
Epoch 167/200 |loss: 7.901571| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 18
Epoch 168/200 |loss: 7.606973| train set 1.791x speedup, test set 0.907x speedup, val set 0.296x speedup, step: 19
Epoch 169/200 |loss: 8.643374| train set 1.757x speedup, test set 0.907x speedup, val set 0.296x speedup, step: 20
Epoch 170/200 |loss: 9.129466| train set 1.757x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 21
Epoch 171/200 |loss: 7.738807| train set 1.758x speedup, test set 0.907x speedup, val set 0.296x speedup, step: 22
Epoch 172/200 |loss: 8.407196| train set 1.791x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 23
Epoch 173/200 |loss: 7.939853| train set 1.790x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 24
Epoch 174/200 |loss: 7.807934| train set 1.775x speedup, test set 0.902x speedup, val set 0.513x speedup, step: 1
Epoch 175/200 |loss: 8.631828| train set 1.776x speedup, test set 0.903x speedup, val set 0.513x speedup, step: 1
Epoch 176/200 |loss: 9.046476| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 2
Epoch 177/200 |loss: 7.921157| train set 1.791x speedup, test set 1.075x speedup, val set 0.296x speedup, step: 3
Epoch 178/200 |loss: 7.853632| train set 1.760x speedup, test set 0.901x speedup, val set 0.513x speedup, step: 1
Epoch 179/200 |loss: 8.233305| train set 1.757x speedup, test set 0.901x speedup, val set 1.510x speedup, step: 1
Epoch 180/200 |loss: 9.032390| train set 1.791x speedup, test set 0.907x speedup, val set 0.513x speedup, step: 2
Epoch 181/200 |loss: 8.552536| train set 1.791x speedup, test set 0.907x speedup, val set 0.513x speedup, step: 3
Epoch 182/200 |loss: 8.628080| train set 1.791x speedup, test set 0.903x speedup, val set 0.513x speedup, step: 4
Epoch 183/200 |loss: 8.644403| train set 1.790x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 5
Epoch 184/200 |loss: 7.377204| train set 1.790x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 6
Epoch 185/200 |loss: 7.242779| train set 1.776x speedup, test set 0.895x speedup, val set 0.513x speedup, step: 7
Epoch 186/200 |loss: 9.277020| train set 1.810x speedup, test set 0.895x speedup, val set 0.513x speedup, step: 8
Epoch 187/200 |loss: 9.608790| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 9
Epoch 188/200 |loss: 6.951298| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 10
Epoch 189/200 |loss: 8.869775| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 11
Epoch 190/200 |loss: 7.729211| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 12
Epoch 191/200 |loss: 8.003299| train set 1.776x speedup, test set 0.895x speedup, val set 0.513x speedup, step: 13
Epoch 192/200 |loss: 9.988788| train set 1.776x speedup, test set 0.892x speedup, val set 0.513x speedup, step: 14
Epoch 193/200 |loss: 8.332266| train set 1.776x speedup, test set 0.887x speedup, val set 0.513x speedup, step: 15
Epoch 194/200 |loss: 9.208805| train set 1.776x speedup, test set 0.889x speedup, val set 0.513x speedup, step: 16
Epoch 195/200 |loss: 9.689005| train set 1.776x speedup, test set 0.905x speedup, val set 0.513x speedup, step: 17
Epoch 196/200 |loss: 8.193071| train set 1.776x speedup, test set 0.905x speedup, val set 0.513x speedup, step: 18
Epoch 197/200 |loss: 8.235017| train set 1.791x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 19
Epoch 198/200 |loss: 8.810838| train set 1.791x speedup, test set 0.901x speedup, val set 0.322x speedup, step: 20
Epoch 199/200 |loss: 8.392065| train set 1.791x speedup, test set 0.897x speedup, val set 0.513x speedup, step: 21
Training per epoch cost 0.346 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.220s, pg runtime 5.879s, speedup 0.945x
08, opt runtime 1.737s, model runtime 6.267s, pg runtime 5.994s, speedup 0.957x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.396s, pg runtime 8.605s, speedup 1.025x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 25, train speedup 1.810, test speedup 0.875, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 179, train speedup 1.757, test speedup 0.901, val speedup 1.510
last model at epoch 199, train speedup 1.791, test speedup 0.897, val speedup 0.513
execution cost 0:02:55.506652
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.046446, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406736| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027802| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936133| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435110| train set 1.200x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472636| train set 1.142x speedup, test set 0.864x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150184| train set 1.352x speedup, test set 0.869x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997282| train set 1.383x speedup, test set 0.865x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.314582| train set 1.225x speedup, test set 0.716x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.694269| train set 1.417x speedup, test set 0.726x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.350718| train set 1.390x speedup, test set 0.886x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.940967| train set 1.335x speedup, test set 0.869x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.159918| train set 1.367x speedup, test set 0.826x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.228292| train set 1.388x speedup, test set 0.816x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.491660| train set 1.550x speedup, test set 0.826x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.936077| train set 1.620x speedup, test set 0.852x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.514569| train set 1.664x speedup, test set 0.841x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.526724| train set 1.678x speedup, test set 0.836x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.302061| train set 1.747x speedup, test set 0.860x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.715588| train set 1.790x speedup, test set 0.835x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 12.392608| train set 1.679x speedup, test set 0.823x speedup, val set 0.390x speedup, step: 21
Epoch 21/200 |loss: 11.737821| train set 1.810x speedup, test set 0.833x speedup, val set 0.437x speedup, step: 22
Epoch 22/200 |loss: 11.711641| train set 1.810x speedup, test set 0.916x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.439894| train set 1.790x speedup, test set 0.846x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.162557| train set 1.810x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 25
Epoch 25/200 |loss: 9.441282| train set 1.810x speedup, test set 0.844x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 11.013280| train set 1.766x speedup, test set 0.843x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.983991| train set 1.790x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.783941| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.031206| train set 1.810x speedup, test set 0.834x speedup, val set 0.275x speedup, step: 30
Epoch 30/200 |loss: 11.738961| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.753724| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.614309| train set 1.694x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.238951| train set 1.790x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.256627| train set 1.790x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.050406| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.675902| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.460199| train set 1.680x speedup, test set 0.977x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.160360| train set 1.766x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.690937| train set 1.734x speedup, test set 0.831x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.528777| train set 1.680x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.332185| train set 1.664x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.213573| train set 1.757x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.520446| train set 1.716x speedup, test set 0.853x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.626178| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.510815| train set 1.810x speedup, test set 0.880x speedup, val set 0.275x speedup, step: 46
Epoch 46/200 |loss: 10.172554| train set 1.711x speedup, test set 0.837x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.403718| train set 1.711x speedup, test set 0.859x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.606682| train set 1.733x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.992532| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.551806| train set 1.790x speedup, test set 0.977x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.844571| train set 1.757x speedup, test set 0.990x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.647211| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.498786| train set 1.810x speedup, test set 0.840x speedup, val set 0.275x speedup, step: 54
Epoch 54/200 |loss: 10.053928| train set 1.696x speedup, test set 1.000x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.094754| train set 1.776x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.287086| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 10.157999| train set 1.810x speedup, test set 0.846x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.184520| train set 1.810x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.979697| train set 1.810x speedup, test set 0.849x speedup, val set 0.275x speedup, step: 60
Epoch 60/200 |loss: 9.595833| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.158027| train set 1.791x speedup, test set 0.915x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.192906| train set 1.758x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.678229| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.380569| train set 1.810x speedup, test set 0.849x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.037993| train set 1.810x speedup, test set 0.987x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.232630| train set 1.765x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 9.215763| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.414267| train set 1.680x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.616191| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.100905| train set 1.790x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.013676| train set 1.791x speedup, test set 0.848x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.632660| train set 1.810x speedup, test set 0.856x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.579694| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.317803| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.783072| train set 1.663x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.235301| train set 1.790x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.957148| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.484615| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.636298| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.174057| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.612997| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.267435| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.889725| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.468011| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.103291| train set 1.696x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.154171| train set 1.810x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.733932| train set 1.766x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.085311| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.044930| train set 1.743x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.769262| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.303060| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.926672| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.234652| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.504679| train set 1.804x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.618242| train set 1.791x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.772593| train set 1.790x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.006578| train set 1.791x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.428309| train set 1.791x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.715212| train set 1.810x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.061956| train set 1.734x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.008270| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 7.953660| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.747519| train set 1.810x speedup, test set 0.903x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.022924| train set 1.807x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.462003| train set 1.810x speedup, test set 1.072x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.396899| train set 1.810x speedup, test set 1.078x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.344805| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.586055| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.661200| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.206025| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.787377| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 7.913955| train set 1.680x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 10.073017| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 8.937700| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.785607| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.387785| train set 1.791x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 10.959826| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.645042| train set 1.810x speedup, test set 0.904x speedup, val set 0.477x speedup, step: 1
Epoch 119/200 |loss: 8.688057| train set 1.810x speedup, test set 0.904x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.445571| train set 1.810x speedup, test set 0.904x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.446126| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 2
Epoch 122/200 |loss: 9.543825| train set 1.790x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 3
Epoch 123/200 |loss: 9.286798| train set 1.790x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 4
Epoch 124/200 |loss: 9.033063| train set 1.757x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 5
Epoch 125/200 |loss: 8.906314| train set 1.776x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 6
Epoch 126/200 |loss: 8.461788| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 7
Epoch 127/200 |loss: 7.652263| train set 1.810x speedup, test set 0.904x speedup, val set 0.477x speedup, step: 1
Epoch 128/200 |loss: 9.366089| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 2
Epoch 129/200 |loss: 8.647600| train set 1.776x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 3
Epoch 130/200 |loss: 8.819557| train set 1.810x speedup, test set 0.903x speedup, val set 0.477x speedup, step: 1
Epoch 131/200 |loss: 8.901526| train set 1.791x speedup, test set 0.896x speedup, val set 0.477x speedup, step: 1
Epoch 132/200 |loss: 8.496832| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 2
Epoch 133/200 |loss: 8.285716| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 3
Epoch 134/200 |loss: 9.275372| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 4
Epoch 135/200 |loss: 8.085322| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 5
Epoch 136/200 |loss: 8.234730| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 6
Epoch 137/200 |loss: 8.031932| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 7
Epoch 138/200 |loss: 6.965036| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 8
Epoch 139/200 |loss: 7.326207| train set 1.696x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 9
Epoch 140/200 |loss: 6.932319| train set 1.791x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 10
Epoch 141/200 |loss: 10.740398| train set 1.776x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 11
Epoch 142/200 |loss: 7.673803| train set 1.776x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 12
Epoch 143/200 |loss: 8.747528| train set 1.791x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 13
Epoch 144/200 |loss: 9.149282| train set 1.790x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 14
Epoch 145/200 |loss: 10.156529| train set 1.757x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 15
Epoch 146/200 |loss: 7.104729| train set 1.757x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 16
Epoch 147/200 |loss: 9.905373| train set 1.757x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 17
Epoch 148/200 |loss: 7.028284| train set 1.790x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 18
Epoch 149/200 |loss: 9.542685| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 19
Epoch 150/200 |loss: 9.244540| train set 1.776x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 20
Epoch 151/200 |loss: 9.329330| train set 1.776x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 21
Epoch 152/200 |loss: 8.078339| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 22
Epoch 153/200 |loss: 7.739318| train set 1.776x speedup, test set 1.078x speedup, val set 0.296x speedup, step: 23
Epoch 154/200 |loss: 8.699934| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 24
Epoch 155/200 |loss: 7.808660| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 25
Epoch 156/200 |loss: 7.636455| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 26
Epoch 157/200 |loss: 7.751657| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 27
Epoch 158/200 |loss: 9.960511| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 28
Epoch 159/200 |loss: 9.822140| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 29
Epoch 160/200 |loss: 7.459227| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 30
Epoch 161/200 |loss: 9.326944| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 31
Epoch 162/200 |loss: 10.267180| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 32
Epoch 163/200 |loss: 7.681908| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 33
Epoch 164/200 |loss: 8.510995| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 34
Epoch 165/200 |loss: 7.728894| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 35
Epoch 166/200 |loss: 8.995310| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 36
Epoch 167/200 |loss: 7.924441| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 37
Epoch 168/200 |loss: 7.664293| train set 1.790x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 38
Epoch 169/200 |loss: 8.617364| train set 1.757x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 39
Epoch 170/200 |loss: 9.160089| train set 1.757x speedup, test set 1.074x speedup, val set 0.296x speedup, step: 40
Epoch 171/200 |loss: 7.859125| train set 1.757x speedup, test set 1.074x speedup, val set 0.296x speedup, step: 41
Epoch 172/200 |loss: 8.646972| train set 1.791x speedup, test set 1.077x speedup, val set 0.296x speedup, step: 42
Epoch 173/200 |loss: 7.839846| train set 1.791x speedup, test set 1.069x speedup, val set 0.477x speedup, step: 1
Epoch 174/200 |loss: 7.918909| train set 1.810x speedup, test set 0.896x speedup, val set 0.477x speedup, step: 1
Epoch 175/200 |loss: 8.511153| train set 1.775x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 2
Epoch 176/200 |loss: 9.402058| train set 1.696x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 3
Epoch 177/200 |loss: 7.975144| train set 1.791x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 4
Epoch 178/200 |loss: 7.947755| train set 1.791x speedup, test set 1.079x speedup, val set 0.477x speedup, step: 1
Epoch 179/200 |loss: 8.683452| train set 1.757x speedup, test set 1.078x speedup, val set 0.477x speedup, step: 1
Epoch 180/200 |loss: 9.245543| train set 1.758x speedup, test set 1.078x speedup, val set 0.296x speedup, step: 2
Epoch 181/200 |loss: 8.826025| train set 1.758x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 3
Epoch 182/200 |loss: 8.747913| train set 1.770x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 4
Epoch 183/200 |loss: 8.828623| train set 1.791x speedup, test set 0.896x speedup, val set 0.477x speedup, step: 1
Epoch 184/200 |loss: 7.480726| train set 1.810x speedup, test set 1.069x speedup, val set 0.477x speedup, step: 1
Epoch 185/200 |loss: 7.404509| train set 1.696x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 2
Epoch 186/200 |loss: 9.615106| train set 1.810x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 3
Epoch 187/200 |loss: 9.617069| train set 1.810x speedup, test set 0.904x speedup, val set 0.477x speedup, step: 1
Epoch 188/200 |loss: 6.974225| train set 1.810x speedup, test set 1.069x speedup, val set 0.329x speedup, step: 2
Epoch 189/200 |loss: 8.884089| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 3
Epoch 190/200 |loss: 7.802315| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 4
Epoch 191/200 |loss: 8.137535| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 5
Epoch 192/200 |loss: 9.973109| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 6
Epoch 193/200 |loss: 8.383648| train set 1.791x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 7
Epoch 194/200 |loss: 9.150622| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 8
Epoch 195/200 |loss: 9.805275| train set 1.776x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 9
Epoch 196/200 |loss: 8.231980| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 10
Epoch 197/200 |loss: 8.366775| train set 1.791x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 11
Epoch 198/200 |loss: 8.844276| train set 1.791x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 12
Epoch 199/200 |loss: 8.423211| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 13
Training per epoch cost 0.359 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.310s, pg runtime 2.352s, speedup 7.592x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.685s, pg runtime 10.685s, speedup 1.000x
14, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.393s, speedup 2.504x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 64, train speedup 1.810, test speedup 0.849, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 187, train speedup 1.810, test speedup 0.904, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 0.896, val speedup 0.296
execution cost 0:03:08.144951
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.956623, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406727| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027800| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935157| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438596| train set 1.142x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477204| train set 1.306x speedup, test set 0.889x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149716| train set 1.306x speedup, test set 0.895x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990746| train set 1.383x speedup, test set 0.861x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259749| train set 1.225x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653831| train set 1.417x speedup, test set 1.072x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351126| train set 1.478x speedup, test set 0.881x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908957| train set 1.416x speedup, test set 0.888x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132351| train set 1.367x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.264524| train set 1.435x speedup, test set 1.222x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.359132| train set 1.471x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.804525| train set 1.623x speedup, test set 0.832x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.406555| train set 1.663x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.552166| train set 1.663x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.451804| train set 1.790x speedup, test set 0.867x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.585694| train set 1.790x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.229923| train set 1.696x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.700200| train set 1.810x speedup, test set 0.821x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.643044| train set 1.810x speedup, test set 1.152x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.575514| train set 1.764x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.545647| train set 1.810x speedup, test set 0.843x speedup, val set 0.275x speedup, step: 25
Epoch 25/200 |loss: 9.523897| train set 1.542x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.872205| train set 1.810x speedup, test set 0.866x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.814821| train set 1.766x speedup, test set 0.829x speedup, val set 0.450x speedup, step: 28
Epoch 28/200 |loss: 10.563508| train set 1.790x speedup, test set 0.819x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.092717| train set 1.790x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.504134| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.751195| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.782486| train set 1.791x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.245028| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.243396| train set 1.790x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.885537| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.394152| train set 1.810x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.336321| train set 1.791x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.453295| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.803841| train set 1.776x speedup, test set 0.885x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.719348| train set 1.680x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.520959| train set 1.678x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.821357| train set 1.757x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.775603| train set 1.716x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.176610| train set 1.766x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.739620| train set 1.810x speedup, test set 0.862x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.485312| train set 1.542x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.579617| train set 1.680x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.652216| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.067504| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.577799| train set 1.791x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.025086| train set 1.791x speedup, test set 0.846x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.886899| train set 1.734x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.330903| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 10.158117| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.845283| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.502552| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.811025| train set 1.791x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.173500| train set 1.810x speedup, test set 0.834x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.622302| train set 1.810x speedup, test set 0.856x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.836430| train set 1.791x speedup, test set 0.863x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.867897| train set 1.791x speedup, test set 1.009x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.377360| train set 1.757x speedup, test set 0.866x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.702387| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.703144| train set 1.776x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.873809| train set 1.810x speedup, test set 1.040x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.614884| train set 1.810x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.697424| train set 1.734x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.692403| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.857614| train set 1.696x speedup, test set 0.857x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.220617| train set 1.679x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.147738| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.828293| train set 1.790x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.719710| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.632447| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.550808| train set 1.810x speedup, test set 0.854x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.010032| train set 1.810x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.926631| train set 1.810x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.559354| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.632184| train set 1.776x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.113540| train set 1.774x speedup, test set 0.863x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.419826| train set 1.808x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.298491| train set 1.776x speedup, test set 0.865x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.839639| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.639750| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.122128| train set 1.810x speedup, test set 0.861x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.352287| train set 1.696x speedup, test set 0.860x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.907026| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.169952| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.134387| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.796899| train set 1.790x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.040297| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.518114| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.013712| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.086501| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.120576| train set 1.790x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.298925| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.464246| train set 1.791x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.406723| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.735443| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.945015| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 8.835670| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.000971| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.455696| train set 1.810x speedup, test set 0.888x speedup, val set 0.450x speedup, step: 1
Epoch 104/200 |loss: 9.077836| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.429779| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.371141| train set 1.776x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.550887| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.808482| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.536321| train set 1.782x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.676734| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.867985| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 8.261280| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 10.171072| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.105071| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.651966| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.445682| train set 1.790x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 11.010617| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.737912| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.488675| train set 1.810x speedup, test set 0.892x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.506763| train set 1.810x speedup, test set 0.892x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.351403| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 2
Epoch 122/200 |loss: 9.509905| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 3
Epoch 123/200 |loss: 9.095285| train set 1.790x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 4
Epoch 124/200 |loss: 8.786889| train set 1.757x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 5
Epoch 125/200 |loss: 8.700769| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 6
Epoch 126/200 |loss: 8.022306| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 7
Epoch 127/200 |loss: 7.833155| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 8
Epoch 128/200 |loss: 8.767230| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 9
Epoch 129/200 |loss: 8.333638| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 10
Epoch 130/200 |loss: 8.383748| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 11
Epoch 131/200 |loss: 8.884992| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 12
Epoch 132/200 |loss: 8.008472| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 13
Epoch 133/200 |loss: 8.357885| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 14
Epoch 134/200 |loss: 8.934255| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 15
Epoch 135/200 |loss: 8.358491| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 16
Epoch 136/200 |loss: 8.008856| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 17
Epoch 137/200 |loss: 8.101887| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 18
Epoch 138/200 |loss: 6.987372| train set 1.776x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 19
Epoch 139/200 |loss: 7.284125| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 20
Epoch 140/200 |loss: 6.906951| train set 1.791x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 21
Epoch 141/200 |loss: 10.733154| train set 1.776x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 22
Epoch 142/200 |loss: 8.303761| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 23
Epoch 143/200 |loss: 8.284029| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 24
Epoch 144/200 |loss: 9.694560| train set 1.791x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 25
Epoch 145/200 |loss: 9.906421| train set 1.757x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 26
Epoch 146/200 |loss: 7.098779| train set 1.757x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 27
Epoch 147/200 |loss: 10.660245| train set 1.790x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 28
Epoch 148/200 |loss: 7.136971| train set 1.790x speedup, test set 0.982x speedup, val set 0.296x speedup, step: 29
Epoch 149/200 |loss: 10.774404| train set 1.810x speedup, test set 0.982x speedup, val set 0.296x speedup, step: 30
Epoch 150/200 |loss: 9.432977| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 31
Epoch 151/200 |loss: 9.918883| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 32
Epoch 152/200 |loss: 8.380347| train set 1.776x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 33
Epoch 153/200 |loss: 8.252990| train set 1.810x speedup, test set 0.857x speedup, val set 0.296x speedup, step: 34
Epoch 154/200 |loss: 8.957725| train set 1.810x speedup, test set 0.848x speedup, val set 0.296x speedup, step: 35
Epoch 155/200 |loss: 8.106575| train set 1.810x speedup, test set 0.844x speedup, val set 0.296x speedup, step: 36
Epoch 156/200 |loss: 7.890439| train set 1.810x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 37
Epoch 157/200 |loss: 7.881703| train set 1.810x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 38
Epoch 158/200 |loss: 9.982430| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 39
Epoch 159/200 |loss: 9.740490| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 40
Epoch 160/200 |loss: 7.495733| train set 1.810x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 41
Epoch 161/200 |loss: 9.087835| train set 1.810x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 42
Epoch 162/200 |loss: 10.161668| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 43
Epoch 163/200 |loss: 7.775837| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 44
Epoch 164/200 |loss: 8.269780| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 45
Epoch 165/200 |loss: 7.777692| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 46
Epoch 166/200 |loss: 8.998462| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 47
Epoch 167/200 |loss: 7.995252| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 48
Epoch 168/200 |loss: 7.677742| train set 1.791x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 49
Epoch 169/200 |loss: 8.652743| train set 1.757x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 50
Epoch 170/200 |loss: 9.381096| train set 1.757x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 51
Epoch 171/200 |loss: 7.855107| train set 1.758x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 52
Epoch 172/200 |loss: 8.527112| train set 1.791x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 53
Epoch 173/200 |loss: 7.951576| train set 1.791x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 54
Epoch 174/200 |loss: 8.069419| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 55
Epoch 175/200 |loss: 8.560595| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 56
Epoch 176/200 |loss: 9.469018| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 57
Epoch 177/200 |loss: 8.034047| train set 1.791x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 58
Epoch 178/200 |loss: 7.967053| train set 1.791x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 59
Epoch 179/200 |loss: 8.357221| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 60
Epoch 180/200 |loss: 9.122784| train set 1.791x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 61
Epoch 181/200 |loss: 8.676019| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 62
Epoch 182/200 |loss: 8.843739| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 63
Epoch 183/200 |loss: 9.063513| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 64
Epoch 184/200 |loss: 7.464190| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 65
Epoch 185/200 |loss: 7.415020| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 66
Epoch 186/200 |loss: 9.347117| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 67
Epoch 187/200 |loss: 9.598412| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 68
Epoch 188/200 |loss: 6.984397| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 69
Epoch 189/200 |loss: 8.803374| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 70
Epoch 190/200 |loss: 8.085675| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 71
Epoch 191/200 |loss: 8.257119| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 72
Epoch 192/200 |loss: 10.175860| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 73
Epoch 193/200 |loss: 8.624164| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 74
Epoch 194/200 |loss: 8.951392| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 75
Epoch 195/200 |loss: 10.059759| train set 1.810x speedup, test set 0.884x speedup, val set 0.513x speedup, step: 1
Epoch 196/200 |loss: 8.184423| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 2
Epoch 197/200 |loss: 8.325989| train set 1.791x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 3
Epoch 198/200 |loss: 8.827504| train set 1.791x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 4
Epoch 199/200 |loss: 8.568363| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 5
Training per epoch cost 0.341 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 11.471s, pg runtime 10.685s, speedup 0.931x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
19, opt runtime 0.379s, model runtime 3.645s, pg runtime 3.645s, speedup 1.000x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.396s, pg runtime 8.605s, speedup 1.025x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 35, train speedup 1.810, test speedup 0.839, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 195, train speedup 1.810, test speedup 0.884, val speedup 0.513
last model at epoch 199, train speedup 1.791, test speedup 0.897, val speedup 0.296
execution cost 0:02:55.684434
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.943957, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406737| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027807| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936135| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435112| train set 1.200x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472621| train set 1.142x speedup, test set 0.864x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150181| train set 1.352x speedup, test set 0.869x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.999661| train set 1.383x speedup, test set 0.861x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.322971| train set 1.225x speedup, test set 0.716x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.703623| train set 1.252x speedup, test set 0.742x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.363238| train set 1.342x speedup, test set 0.868x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 15.010820| train set 1.367x speedup, test set 0.907x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.210206| train set 1.367x speedup, test set 0.856x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.279821| train set 1.435x speedup, test set 0.819x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.479871| train set 1.550x speedup, test set 0.854x speedup, val set 0.437x speedup, step: 15
Epoch 15/200 |loss: 12.964066| train set 1.762x speedup, test set 0.894x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.626993| train set 1.550x speedup, test set 0.840x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.479916| train set 1.663x speedup, test set 0.859x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.463707| train set 1.766x speedup, test set 0.896x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.649000| train set 1.790x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 20
Epoch 20/200 |loss: 12.506420| train set 1.528x speedup, test set 0.830x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.933391| train set 1.810x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.836224| train set 1.810x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.464826| train set 1.790x speedup, test set 1.002x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.100573| train set 1.696x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.445092| train set 1.810x speedup, test set 0.833x speedup, val set 0.437x speedup, step: 26
Epoch 26/200 |loss: 10.880177| train set 1.810x speedup, test set 0.827x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.848884| train set 1.790x speedup, test set 0.821x speedup, val set 0.477x speedup, step: 28
Epoch 28/200 |loss: 10.682478| train set 1.810x speedup, test set 1.258x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.073087| train set 1.810x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 30
Epoch 30/200 |loss: 11.542638| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 10.044302| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.538571| train set 1.693x speedup, test set 0.840x speedup, val set 0.477x speedup, step: 33
Epoch 33/200 |loss: 8.462586| train set 1.593x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.559959| train set 1.790x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.212382| train set 1.810x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 9.159488| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.832335| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.045633| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.939285| train set 1.776x speedup, test set 0.829x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.664809| train set 1.776x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.532731| train set 1.788x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.494717| train set 1.791x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.607009| train set 1.757x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.679565| train set 1.810x speedup, test set 0.860x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.448843| train set 1.810x speedup, test set 0.829x speedup, val set 0.275x speedup, step: 46
Epoch 46/200 |loss: 9.967440| train set 1.711x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.393709| train set 1.711x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.607407| train set 1.681x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.944773| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.768321| train set 1.679x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.561753| train set 1.757x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.927734| train set 1.716x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.429135| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 10.078856| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.972447| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.597672| train set 1.810x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 10.010518| train set 1.810x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.062475| train set 1.810x speedup, test set 0.818x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.953112| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.491818| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.331150| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.365060| train set 1.650x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.774569| train set 1.666x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.586386| train set 1.810x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.208925| train set 1.810x speedup, test set 0.845x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.376856| train set 1.766x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 9.101282| train set 1.776x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.469074| train set 1.776x speedup, test set 0.857x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.811852| train set 1.696x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.018967| train set 1.790x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 8.930026| train set 1.790x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.770498| train set 1.766x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.665384| train set 1.810x speedup, test set 0.837x speedup, val set 0.477x speedup, step: 74
Epoch 74/200 |loss: 9.354157| train set 1.810x speedup, test set 0.828x speedup, val set 0.477x speedup, step: 75
Epoch 75/200 |loss: 8.389127| train set 1.696x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.103913| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 8.052791| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.454396| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.710096| train set 1.776x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.029248| train set 1.776x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.705812| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.146648| train set 1.810x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.916070| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.432191| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.172196| train set 1.696x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.243579| train set 1.696x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.799439| train set 1.776x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.060093| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.097393| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.658116| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.225171| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.691238| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.663034| train set 1.810x speedup, test set 0.882x speedup, val set 0.316x speedup, step: 94
Epoch 94/200 |loss: 8.376002| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.826159| train set 1.791x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.852904| train set 1.791x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.858931| train set 1.776x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.701654| train set 1.791x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.909286| train set 1.791x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.062362| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 8.846110| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.117554| train set 1.810x speedup, test set 0.882x speedup, val set 0.477x speedup, step: 1
Epoch 103/200 |loss: 9.577762| train set 1.810x speedup, test set 0.882x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 8.851188| train set 1.666x speedup, test set 0.868x speedup, val set 0.398x speedup, step: 2
Epoch 105/200 |loss: 8.239989| train set 1.651x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.153383| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.211547| train set 1.766x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.665516| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.734855| train set 1.696x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.306213| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 9.122303| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 8.165803| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 10.431620| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.172935| train set 1.766x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.866203| train set 1.791x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.962673| train set 1.791x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 11.090892| train set 1.807x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 9.368288| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.874184| train set 1.810x speedup, test set 0.881x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 9.070346| train set 1.810x speedup, test set 0.882x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.420430| train set 1.776x speedup, test set 0.882x speedup, val set 0.477x speedup, step: 1
Epoch 122/200 |loss: 10.272978| train set 1.679x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 2
Epoch 123/200 |loss: 9.459374| train set 1.663x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 3
Epoch 124/200 |loss: 9.294573| train set 1.757x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 4
Epoch 125/200 |loss: 8.833450| train set 1.776x speedup, test set 0.893x speedup, val set 0.513x speedup, step: 1
Epoch 126/200 |loss: 8.611553| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 2
Epoch 127/200 |loss: 7.903610| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 3
Epoch 128/200 |loss: 9.334195| train set 1.810x speedup, test set 0.858x speedup, val set 0.296x speedup, step: 4
Epoch 129/200 |loss: 8.306133| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 5
Epoch 130/200 |loss: 9.046176| train set 1.810x speedup, test set 0.851x speedup, val set 0.296x speedup, step: 6
Epoch 131/200 |loss: 8.750395| train set 1.664x speedup, test set 0.851x speedup, val set 0.296x speedup, step: 7
Epoch 132/200 |loss: 8.451563| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 8
Epoch 133/200 |loss: 8.573216| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 9
Epoch 134/200 |loss: 9.346626| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 10
Epoch 135/200 |loss: 8.461133| train set 1.810x speedup, test set 0.858x speedup, val set 0.296x speedup, step: 11
Epoch 136/200 |loss: 8.396266| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 12
Epoch 137/200 |loss: 8.186818| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 13
Epoch 138/200 |loss: 7.135281| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 14
Epoch 139/200 |loss: 7.314935| train set 1.696x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 15
Epoch 140/200 |loss: 7.051456| train set 1.791x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 16
Epoch 141/200 |loss: 10.308342| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 17
Epoch 142/200 |loss: 7.921272| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 18
Epoch 143/200 |loss: 8.305156| train set 1.791x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 19
Epoch 144/200 |loss: 9.310412| train set 1.790x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 20
Epoch 145/200 |loss: 9.521119| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 21
Epoch 146/200 |loss: 7.066291| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 22
Epoch 147/200 |loss: 9.472383| train set 1.757x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 23
Epoch 148/200 |loss: 7.025309| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 24
Epoch 149/200 |loss: 8.990050| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 25
Epoch 150/200 |loss: 8.633974| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 26
Epoch 151/200 |loss: 8.989558| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 27
Epoch 152/200 |loss: 7.630665| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 28
Epoch 153/200 |loss: 7.333849| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 29
Epoch 154/200 |loss: 8.478137| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 30
Epoch 155/200 |loss: 7.594475| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 31
Epoch 156/200 |loss: 7.356802| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 32
Epoch 157/200 |loss: 7.584096| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 33
Epoch 158/200 |loss: 9.757907| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 34
Epoch 159/200 |loss: 9.616436| train set 1.810x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 35
Epoch 160/200 |loss: 7.932770| train set 1.810x speedup, test set 1.042x speedup, val set 0.296x speedup, step: 36
Epoch 161/200 |loss: 9.699259| train set 1.810x speedup, test set 0.854x speedup, val set 0.296x speedup, step: 37
Epoch 162/200 |loss: 10.575168| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 38
Epoch 163/200 |loss: 7.985937| train set 1.776x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 39
Epoch 164/200 |loss: 8.817625| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 40
Epoch 165/200 |loss: 8.186771| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 41
Epoch 166/200 |loss: 9.108936| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 42
Epoch 167/200 |loss: 8.256875| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 43
Epoch 168/200 |loss: 7.858974| train set 1.791x speedup, test set 0.861x speedup, val set 0.296x speedup, step: 44
Epoch 169/200 |loss: 8.878743| train set 1.791x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 45
Epoch 170/200 |loss: 9.136064| train set 1.757x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 46
Epoch 171/200 |loss: 8.054901| train set 1.758x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 47
Epoch 172/200 |loss: 8.804410| train set 1.791x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 48
Epoch 173/200 |loss: 7.913753| train set 1.790x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 49
Epoch 174/200 |loss: 7.864938| train set 1.776x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 50
Epoch 175/200 |loss: 8.556226| train set 1.775x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 51
Epoch 176/200 |loss: 9.617626| train set 1.810x speedup, test set 0.861x speedup, val set 0.296x speedup, step: 52
Epoch 177/200 |loss: 8.111254| train set 1.790x speedup, test set 1.032x speedup, val set 0.296x speedup, step: 53
Epoch 178/200 |loss: 8.243329| train set 1.747x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 54
Epoch 179/200 |loss: 8.579012| train set 1.757x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 55
Epoch 180/200 |loss: 9.114582| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 56
Epoch 181/200 |loss: 8.753658| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 57
Epoch 182/200 |loss: 8.750037| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 58
Epoch 183/200 |loss: 8.613683| train set 1.810x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 59
Epoch 184/200 |loss: 7.346084| train set 1.810x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 60
Epoch 185/200 |loss: 7.429618| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 61
Epoch 186/200 |loss: 9.262172| train set 1.809x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 62
Epoch 187/200 |loss: 9.629199| train set 1.810x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 63
Epoch 188/200 |loss: 6.874437| train set 1.790x speedup, test set 0.857x speedup, val set 0.296x speedup, step: 64
Epoch 189/200 |loss: 9.089290| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 65
Epoch 190/200 |loss: 7.776951| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 66
Epoch 191/200 |loss: 8.167987| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 67
Epoch 192/200 |loss: 10.406089| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 68
Epoch 193/200 |loss: 8.500750| train set 1.757x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 69
Epoch 194/200 |loss: 9.349727| train set 1.810x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 70
Epoch 195/200 |loss: 10.191231| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 71
Epoch 196/200 |loss: 8.197976| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 72
Epoch 197/200 |loss: 8.610349| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 73
Epoch 198/200 |loss: 8.596017| train set 1.791x speedup, test set 0.854x speedup, val set 0.296x speedup, step: 74
Epoch 199/200 |loss: 8.490693| train set 1.791x speedup, test set 0.843x speedup, val set 0.296x speedup, step: 75
Training per epoch cost 0.351 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 11.471s, pg runtime 10.685s, speedup 0.931x
14, opt runtime 0.157s, model runtime 0.176s, pg runtime 0.393s, speedup 2.231x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 3.515s, pg runtime 3.645s, speedup 1.037x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 59, train speedup 1.810, test speedup 0.829, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 125, train speedup 1.776, test speedup 0.893, val speedup 0.513
last model at epoch 199, train speedup 1.791, test speedup 0.843, val speedup 0.296
execution cost 0:02:57.628459
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.978824, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406726| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027798| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935155| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438595| train set 1.142x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477203| train set 1.306x speedup, test set 0.889x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149715| train set 1.306x speedup, test set 0.895x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990742| train set 1.383x speedup, test set 0.861x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259741| train set 1.225x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653828| train set 1.417x speedup, test set 1.072x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351109| train set 1.478x speedup, test set 0.881x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908957| train set 1.412x speedup, test set 0.888x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132762| train set 1.367x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.264372| train set 1.435x speedup, test set 1.234x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.361893| train set 1.550x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.800317| train set 1.623x speedup, test set 0.832x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.409036| train set 1.663x speedup, test set 0.821x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.500669| train set 1.663x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.382492| train set 1.790x speedup, test set 0.889x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.541749| train set 1.790x speedup, test set 0.831x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.189957| train set 1.810x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.722180| train set 1.810x speedup, test set 0.823x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.474909| train set 1.810x speedup, test set 1.166x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.354980| train set 1.764x speedup, test set 1.012x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.275696| train set 1.766x speedup, test set 0.880x speedup, val set 0.513x speedup, step: 25
Epoch 25/200 |loss: 9.505816| train set 1.542x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 11.038413| train set 1.542x speedup, test set 0.823x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.974714| train set 1.790x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.273066| train set 1.790x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.006860| train set 1.810x speedup, test set 0.850x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.560208| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.784587| train set 1.791x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.837392| train set 1.655x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.189405| train set 1.791x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.195100| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.898127| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.509992| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.276183| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.169532| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.622018| train set 1.776x speedup, test set 0.883x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.564844| train set 1.680x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.396725| train set 1.649x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.542476| train set 1.776x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.840635| train set 1.747x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.335392| train set 1.791x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.538403| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.384671| train set 1.711x speedup, test set 0.823x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.848960| train set 1.711x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.567296| train set 1.776x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.285963| train set 1.766x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.633613| train set 1.791x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.280787| train set 1.791x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.797071| train set 1.734x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.227859| train set 1.810x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.974885| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.806586| train set 1.776x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.224030| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.632070| train set 1.810x speedup, test set 0.847x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 7.986708| train set 1.810x speedup, test set 0.819x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.662529| train set 1.810x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.485876| train set 1.790x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.997643| train set 1.790x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 9.939938| train set 1.757x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.535561| train set 1.776x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 8.834379| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.706234| train set 1.810x speedup, test set 0.980x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.128979| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.530149| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.524360| train set 1.810x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.537760| train set 1.810x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 8.938601| train set 1.791x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.051463| train set 1.791x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.374576| train set 1.810x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.432409| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.451190| train set 1.810x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.394982| train set 1.810x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.207450| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.959697| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.335304| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.332811| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 8.929442| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.324059| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.021233| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.823636| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.243636| train set 1.810x speedup, test set 0.889x speedup, val set 0.450x speedup, step: 85
Epoch 85/200 |loss: 9.079820| train set 1.696x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.334423| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.762973| train set 1.791x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.384627| train set 1.791x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.146544| train set 1.791x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.515320| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.211593| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.903795| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.289805| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.724810| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.376461| train set 1.791x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 10.306167| train set 1.757x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.308559| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.372266| train set 1.791x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.230246| train set 1.810x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.983747| train set 1.766x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.471461| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.181253| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.176423| train set 1.810x speedup, test set 0.878x speedup, val set 0.450x speedup, step: 1
Epoch 104/200 |loss: 8.885523| train set 1.810x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.718190| train set 1.776x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.257957| train set 1.776x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.446206| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.924143| train set 1.711x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.555354| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.235382| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.853281| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 7.774152| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 10.020114| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.259131| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.339531| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.284456| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 11.059664| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.694478| train set 1.810x speedup, test set 1.082x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.502982| train set 1.810x speedup, test set 0.906x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.520890| train set 1.776x speedup, test set 0.906x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.611335| train set 1.810x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 2
Epoch 122/200 |loss: 9.586744| train set 1.791x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 3
Epoch 123/200 |loss: 9.038682| train set 1.791x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 4
Epoch 124/200 |loss: 8.989599| train set 1.790x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 5
Epoch 125/200 |loss: 8.693732| train set 1.776x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 6
Epoch 126/200 |loss: 8.254528| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 7
Epoch 127/200 |loss: 7.642225| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 8
Epoch 128/200 |loss: 8.801455| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 9
Epoch 129/200 |loss: 8.425143| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 10
Epoch 130/200 |loss: 8.668115| train set 1.810x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 11
Epoch 131/200 |loss: 8.813523| train set 1.790x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 12
Epoch 132/200 |loss: 8.172095| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 13
Epoch 133/200 |loss: 8.379987| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 14
Epoch 134/200 |loss: 8.934534| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 15
Epoch 135/200 |loss: 8.119568| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 16
Epoch 136/200 |loss: 7.715400| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 17
Epoch 137/200 |loss: 8.081348| train set 1.776x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 18
Epoch 138/200 |loss: 6.912506| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 19
Epoch 139/200 |loss: 7.344165| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 20
Epoch 140/200 |loss: 6.767830| train set 1.791x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 21
Epoch 141/200 |loss: 10.297679| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 22
Epoch 142/200 |loss: 7.925006| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 23
Epoch 143/200 |loss: 8.542989| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 24
Epoch 144/200 |loss: 9.058304| train set 1.790x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 25
Epoch 145/200 |loss: 9.518938| train set 1.757x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 26
Epoch 146/200 |loss: 6.992955| train set 1.756x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 27
Epoch 147/200 |loss: 9.524911| train set 1.757x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 28
Epoch 148/200 |loss: 6.860541| train set 1.790x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 29
Epoch 149/200 |loss: 9.083844| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 30
Epoch 150/200 |loss: 8.566770| train set 1.776x speedup, test set 0.904x speedup, val set 0.337x speedup, step: 31
Epoch 151/200 |loss: 9.228657| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 32
Epoch 152/200 |loss: 7.708104| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 33
Epoch 153/200 |loss: 7.427059| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 34
Epoch 154/200 |loss: 8.524631| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 35
Epoch 155/200 |loss: 7.688324| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 36
Epoch 156/200 |loss: 7.540843| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 37
Epoch 157/200 |loss: 7.694235| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 38
Epoch 158/200 |loss: 9.847681| train set 1.776x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 39
Epoch 159/200 |loss: 9.567035| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 40
Epoch 160/200 |loss: 7.374021| train set 1.810x speedup, test set 1.111x speedup, val set 0.296x speedup, step: 41
Epoch 161/200 |loss: 9.163219| train set 1.810x speedup, test set 1.100x speedup, val set 0.296x speedup, step: 42
Epoch 162/200 |loss: 10.082172| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 43
Epoch 163/200 |loss: 7.623941| train set 1.776x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 44
Epoch 164/200 |loss: 8.543180| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 45
Epoch 165/200 |loss: 7.749276| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 46
Epoch 166/200 |loss: 8.995313| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 47
Epoch 167/200 |loss: 8.008941| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 48
Epoch 168/200 |loss: 7.613664| train set 1.791x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 49
Epoch 169/200 |loss: 8.518903| train set 1.757x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 50
Epoch 170/200 |loss: 9.098690| train set 1.757x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 51
Epoch 171/200 |loss: 7.718844| train set 1.758x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 52
Epoch 172/200 |loss: 8.561504| train set 1.791x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 53
Epoch 173/200 |loss: 7.686633| train set 1.810x speedup, test set 1.078x speedup, val set 0.450x speedup, step: 54
Epoch 174/200 |loss: 7.853801| train set 1.775x speedup, test set 1.078x speedup, val set 0.296x speedup, step: 55
Epoch 175/200 |loss: 8.683373| train set 1.775x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 56
Epoch 176/200 |loss: 9.409457| train set 1.810x speedup, test set 1.062x speedup, val set 0.296x speedup, step: 57
Epoch 177/200 |loss: 7.947239| train set 1.791x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 58
Epoch 178/200 |loss: 7.991806| train set 1.791x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 59
Epoch 179/200 |loss: 8.413962| train set 1.757x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 60
Epoch 180/200 |loss: 9.346331| train set 1.758x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 61
Epoch 181/200 |loss: 8.593051| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 62
Epoch 182/200 |loss: 8.740368| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 63
Epoch 183/200 |loss: 8.786068| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 64
Epoch 184/200 |loss: 7.287039| train set 1.810x speedup, test set 0.896x speedup, val set 0.477x speedup, step: 1
Epoch 185/200 |loss: 7.387606| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 2
Epoch 186/200 |loss: 9.239368| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 3
Epoch 187/200 |loss: 9.504423| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 4
Epoch 188/200 |loss: 6.933904| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 5
Epoch 189/200 |loss: 8.628561| train set 1.810x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 6
Epoch 190/200 |loss: 7.838280| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 7
Epoch 191/200 |loss: 8.075508| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 8
Epoch 192/200 |loss: 10.006941| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 9
Epoch 193/200 |loss: 8.475580| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 10
Epoch 194/200 |loss: 9.050516| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 11
Epoch 195/200 |loss: 9.706239| train set 1.776x speedup, test set 0.903x speedup, val set 0.513x speedup, step: 1
Epoch 196/200 |loss: 8.111063| train set 1.776x speedup, test set 0.903x speedup, val set 0.513x speedup, step: 1
Epoch 197/200 |loss: 8.286321| train set 1.791x speedup, test set 0.904x speedup, val set 0.337x speedup, step: 2
Epoch 198/200 |loss: 8.623719| train set 1.791x speedup, test set 0.902x speedup, val set 0.513x speedup, step: 1
Epoch 199/200 |loss: 8.372606| train set 1.791x speedup, test set 0.902x speedup, val set 0.513x speedup, step: 1
Training per epoch cost 0.358 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 6.220s, pg runtime 5.879s, speedup 0.945x
08, opt runtime 1.737s, model runtime 6.267s, pg runtime 5.994s, speedup 0.957x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 86, train speedup 1.810, test speedup 0.889, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 199, train speedup 1.791, test speedup 0.902, val speedup 0.513
last model at epoch 199, train speedup 1.791, test speedup 0.902, val speedup 0.513
execution cost 0:02:58.480427
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.950808, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406739| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027810| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936138| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435128| train set 1.200x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472644| train set 1.142x speedup, test set 0.864x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150186| train set 1.352x speedup, test set 0.866x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997662| train set 1.383x speedup, test set 0.865x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.319773| train set 1.225x speedup, test set 0.716x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.692729| train set 1.417x speedup, test set 0.721x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.363753| train set 1.342x speedup, test set 0.886x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.939047| train set 1.367x speedup, test set 0.867x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.187652| train set 1.367x speedup, test set 0.826x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.249045| train set 1.435x speedup, test set 0.830x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.445715| train set 1.550x speedup, test set 0.840x speedup, val set 0.437x speedup, step: 15
Epoch 15/200 |loss: 12.925378| train set 1.620x speedup, test set 0.852x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.560614| train set 1.663x speedup, test set 0.844x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.447130| train set 1.680x speedup, test set 0.827x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.392824| train set 1.765x speedup, test set 0.871x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.648242| train set 1.790x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 20
Epoch 20/200 |loss: 12.569559| train set 1.806x speedup, test set 0.823x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.897073| train set 1.680x speedup, test set 0.831x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.774990| train set 1.810x speedup, test set 0.967x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.247612| train set 1.790x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 11.888418| train set 1.810x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.398500| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.653720| train set 1.517x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 27
Epoch 27/200 |loss: 12.004736| train set 1.790x speedup, test set 0.860x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.653170| train set 1.790x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.854121| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.676404| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.660085| train set 1.791x speedup, test set 0.818x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.900426| train set 1.693x speedup, test set 0.823x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.217823| train set 1.810x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.488163| train set 1.810x speedup, test set 0.850x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.939843| train set 1.810x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.670060| train set 1.810x speedup, test set 0.819x speedup, val set 0.450x speedup, step: 37
Epoch 37/200 |loss: 9.637989| train set 1.791x speedup, test set 0.963x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.810995| train set 1.791x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 9.168882| train set 1.734x speedup, test set 0.818x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 9.197954| train set 1.651x speedup, test set 0.848x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 11.033145| train set 1.662x speedup, test set 1.168x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.998544| train set 1.747x speedup, test set 0.819x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.912758| train set 1.747x speedup, test set 0.827x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.228815| train set 1.766x speedup, test set 0.827x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 9.066554| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.657036| train set 1.711x speedup, test set 0.828x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.702021| train set 1.711x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.473437| train set 1.776x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.299084| train set 1.776x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.626229| train set 1.810x speedup, test set 0.820x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.320284| train set 1.791x speedup, test set 0.960x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.843160| train set 1.810x speedup, test set 0.975x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.522686| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 10.016440| train set 1.776x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.073883| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.489256| train set 1.791x speedup, test set 1.119x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.953963| train set 1.791x speedup, test set 1.025x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.138277| train set 1.810x speedup, test set 0.818x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.766682| train set 1.810x speedup, test set 0.836x speedup, val set 0.275x speedup, step: 60
Epoch 60/200 |loss: 9.859482| train set 1.810x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.952565| train set 1.791x speedup, test set 1.037x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.214039| train set 1.757x speedup, test set 1.020x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.736429| train set 1.666x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.446512| train set 1.680x speedup, test set 1.134x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.278687| train set 1.810x speedup, test set 1.134x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.259362| train set 1.734x speedup, test set 1.040x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.832203| train set 1.776x speedup, test set 1.072x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.442998| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.823709| train set 1.680x speedup, test set 0.826x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.184451| train set 1.810x speedup, test set 0.827x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.093835| train set 1.790x speedup, test set 0.827x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.773151| train set 1.790x speedup, test set 1.038x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.775387| train set 1.810x speedup, test set 0.997x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.317289| train set 1.810x speedup, test set 0.827x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.435872| train set 1.810x speedup, test set 0.847x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.085788| train set 1.810x speedup, test set 0.847x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.951765| train set 1.810x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.385613| train set 1.776x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.959260| train set 1.776x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.065376| train set 1.810x speedup, test set 0.858x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.384727| train set 1.810x speedup, test set 0.858x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.287358| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.963549| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.352091| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.201801| train set 1.696x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.286767| train set 1.810x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.921348| train set 1.776x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.354959| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.089327| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.528367| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 8.951238| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.700811| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.242509| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.247689| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.327481| train set 1.790x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.743175| train set 1.791x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.945099| train set 1.791x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.238940| train set 1.791x speedup, test set 1.017x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.885874| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.947988| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.338404| train set 1.810x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.110550| train set 1.810x speedup, test set 1.007x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.213991| train set 1.810x speedup, test set 0.876x speedup, val set 0.450x speedup, step: 1
Epoch 104/200 |loss: 9.075389| train set 1.810x speedup, test set 0.883x speedup, val set 0.425x speedup, step: 2
Epoch 105/200 |loss: 8.641198| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.235982| train set 1.810x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.247958| train set 1.711x speedup, test set 0.975x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 10.321222| train set 1.711x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.575675| train set 1.776x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.304834| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.922120| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 7.924126| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 10.029644| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 8.940450| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.399129| train set 1.790x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.287186| train set 1.790x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 11.183219| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.608758| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.523705| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 17
Epoch 120/200 |loss: 8.344930| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 18
Epoch 121/200 |loss: 9.536956| train set 1.776x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 19
Epoch 122/200 |loss: 9.790998| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 20
Epoch 123/200 |loss: 9.136682| train set 1.791x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 21
Epoch 124/200 |loss: 8.967881| train set 1.716x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 22
Epoch 125/200 |loss: 8.847724| train set 1.757x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 23
Epoch 126/200 |loss: 8.336820| train set 1.790x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 24
Epoch 127/200 |loss: 7.812183| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 25
Epoch 128/200 |loss: 8.835872| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 26
Epoch 129/200 |loss: 8.623104| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 27
Epoch 130/200 |loss: 8.714725| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 28
Epoch 131/200 |loss: 8.987536| train set 1.791x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 29
Epoch 132/200 |loss: 8.202141| train set 1.791x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 30
Epoch 133/200 |loss: 8.915237| train set 1.810x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 31
Epoch 134/200 |loss: 9.203196| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 32
Epoch 135/200 |loss: 8.472611| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 33
Epoch 136/200 |loss: 8.114088| train set 1.776x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 34
Epoch 137/200 |loss: 8.190790| train set 1.776x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 35
Epoch 138/200 |loss: 7.112825| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 36
Epoch 139/200 |loss: 7.219681| train set 1.680x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 37
Epoch 140/200 |loss: 7.059715| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 38
Epoch 141/200 |loss: 10.416804| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 39
Epoch 142/200 |loss: 8.163141| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 40
Epoch 143/200 |loss: 8.442623| train set 1.791x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 41
Epoch 144/200 |loss: 9.349391| train set 1.791x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 42
Epoch 145/200 |loss: 9.473815| train set 1.757x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 43
Epoch 146/200 |loss: 7.036486| train set 1.757x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 44
Epoch 147/200 |loss: 9.602176| train set 1.757x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 45
Epoch 148/200 |loss: 6.952202| train set 1.810x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 46
Epoch 149/200 |loss: 8.769940| train set 1.810x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 47
Epoch 150/200 |loss: 8.537394| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 48
Epoch 151/200 |loss: 9.143027| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 49
Epoch 152/200 |loss: 7.522345| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 50
Epoch 153/200 |loss: 7.275306| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 51
Epoch 154/200 |loss: 8.390802| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 52
Epoch 155/200 |loss: 7.562141| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 53
Epoch 156/200 |loss: 7.342534| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 54
Epoch 157/200 |loss: 7.698647| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 55
Epoch 158/200 |loss: 9.837539| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 56
Epoch 159/200 |loss: 9.749551| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 57
Epoch 160/200 |loss: 7.962708| train set 1.810x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 58
Epoch 161/200 |loss: 9.864867| train set 1.810x speedup, test set 1.082x speedup, val set 0.296x speedup, step: 59
Epoch 162/200 |loss: 10.554016| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 60
Epoch 163/200 |loss: 8.093846| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 61
Epoch 164/200 |loss: 8.771686| train set 1.776x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 62
Epoch 165/200 |loss: 8.422847| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 63
Epoch 166/200 |loss: 9.393009| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 64
Epoch 167/200 |loss: 8.229675| train set 1.810x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 65
Epoch 168/200 |loss: 7.978530| train set 1.790x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 66
Epoch 169/200 |loss: 9.036762| train set 1.790x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 67
Epoch 170/200 |loss: 9.406596| train set 1.757x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 68
Epoch 171/200 |loss: 8.164948| train set 1.757x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 69
Epoch 172/200 |loss: 8.712514| train set 1.791x speedup, test set 1.078x speedup, val set 0.296x speedup, step: 70
Epoch 173/200 |loss: 8.003408| train set 1.791x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 71
Epoch 174/200 |loss: 8.195393| train set 1.776x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 72
Epoch 175/200 |loss: 8.713651| train set 1.776x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 73
Epoch 176/200 |loss: 9.477595| train set 1.776x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 74
Epoch 177/200 |loss: 8.317889| train set 1.790x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 75
Epoch 178/200 |loss: 8.103612| train set 1.790x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 76
Epoch 179/200 |loss: 8.646555| train set 1.791x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 77
Epoch 180/200 |loss: 9.216852| train set 1.791x speedup, test set 1.077x speedup, val set 0.296x speedup, step: 78
Epoch 181/200 |loss: 8.774646| train set 1.810x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 79
Epoch 182/200 |loss: 8.818883| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 80
Epoch 183/200 |loss: 9.117034| train set 1.810x speedup, test set 1.067x speedup, val set 0.450x speedup, step: 1
Epoch 184/200 |loss: 7.577561| train set 1.810x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 2
Epoch 185/200 |loss: 7.451693| train set 1.810x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 3
Epoch 186/200 |loss: 9.721114| train set 1.711x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 4
Epoch 187/200 |loss: 9.690997| train set 1.810x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 5
Epoch 188/200 |loss: 7.079441| train set 1.790x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 6
Epoch 189/200 |loss: 8.881040| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 7
Epoch 190/200 |loss: 8.116470| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 8
Epoch 191/200 |loss: 8.285038| train set 1.776x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 9
Epoch 192/200 |loss: 10.012164| train set 1.776x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 10
Epoch 193/200 |loss: 8.663702| train set 1.776x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 11
Epoch 194/200 |loss: 9.157312| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 12
Epoch 195/200 |loss: 9.708363| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 13
Epoch 196/200 |loss: 8.290076| train set 1.810x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 14
Epoch 197/200 |loss: 8.201059| train set 1.791x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 15
Epoch 198/200 |loss: 8.668132| train set 1.791x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 16
Epoch 199/200 |loss: 8.501410| train set 1.791x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 17
Training per epoch cost 0.359 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.685s, pg runtime 10.685s, speedup 1.000x
14, opt runtime 0.157s, model runtime 0.176s, pg runtime 0.393s, speedup 2.231x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
19, opt runtime 0.379s, model runtime 1.412s, pg runtime 3.645s, speedup 2.582x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 83, train speedup 1.810, test speedup 0.885, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 183, train speedup 1.810, test speedup 1.067, val speedup 0.450
last model at epoch 199, train speedup 1.791, test speedup 1.080, val speedup 0.296
execution cost 0:02:59.026479
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.978506, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406739| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027802| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936133| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435112| train set 1.200x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472636| train set 1.142x speedup, test set 0.864x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150183| train set 1.352x speedup, test set 0.869x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997283| train set 1.383x speedup, test set 0.865x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.314613| train set 1.225x speedup, test set 0.716x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.694240| train set 1.417x speedup, test set 0.726x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.353046| train set 1.390x speedup, test set 0.886x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.945402| train set 1.335x speedup, test set 0.869x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.159711| train set 1.367x speedup, test set 0.824x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.216117| train set 1.388x speedup, test set 0.819x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.473474| train set 1.550x speedup, test set 0.859x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.953887| train set 1.620x speedup, test set 0.852x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.510540| train set 1.663x speedup, test set 0.820x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.507540| train set 1.663x speedup, test set 0.821x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.357061| train set 1.790x speedup, test set 0.856x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.646238| train set 1.790x speedup, test set 0.877x speedup, val set 0.477x speedup, step: 20
Epoch 20/200 |loss: 12.544526| train set 1.790x speedup, test set 0.843x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.851035| train set 1.680x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.651356| train set 1.810x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.333457| train set 1.790x speedup, test set 0.988x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.194876| train set 1.806x speedup, test set 0.831x speedup, val set 0.275x speedup, step: 25
Epoch 25/200 |loss: 9.647694| train set 1.810x speedup, test set 0.828x speedup, val set 0.437x speedup, step: 26
Epoch 26/200 |loss: 10.766263| train set 1.790x speedup, test set 0.830x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 12.052362| train set 1.790x speedup, test set 0.827x speedup, val set 0.477x speedup, step: 28
Epoch 28/200 |loss: 10.528133| train set 1.790x speedup, test set 0.827x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.001677| train set 1.810x speedup, test set 0.823x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.549580| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.730345| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.587728| train set 1.711x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.213808| train set 1.810x speedup, test set 0.844x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.442677| train set 1.790x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.888242| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.847161| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.400966| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.521781| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.813170| train set 1.776x speedup, test set 0.860x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.629108| train set 1.651x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.684238| train set 1.664x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.647835| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.525290| train set 1.747x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.740771| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.263511| train set 1.711x speedup, test set 0.834x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.196534| train set 1.711x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.177877| train set 1.810x speedup, test set 0.865x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.473837| train set 1.776x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.729189| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.372266| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.761995| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.257092| train set 1.734x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.421566| train set 1.810x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.741426| train set 1.696x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.164656| train set 1.810x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.165017| train set 1.757x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.819113| train set 1.791x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.321559| train set 1.810x speedup, test set 0.859x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.857430| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.742946| train set 1.810x speedup, test set 0.866x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.141552| train set 1.791x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.266420| train set 1.757x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.792697| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.722116| train set 1.664x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.077618| train set 1.810x speedup, test set 1.127x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.328157| train set 1.734x speedup, test set 0.909x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.927512| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.610300| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.636009| train set 1.696x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.188029| train set 1.790x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.141554| train set 1.790x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.568767| train set 1.748x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.721941| train set 1.810x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.180255| train set 1.810x speedup, test set 0.866x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.443226| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 7.993867| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.851488| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.372636| train set 1.776x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.635715| train set 1.776x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.132023| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.385490| train set 1.808x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.327327| train set 1.808x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 8.240381| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.603694| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.298268| train set 1.696x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.294458| train set 1.696x speedup, test set 0.863x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 9.238524| train set 1.810x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.254101| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.193406| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.615043| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.180992| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.813945| train set 1.810x speedup, test set 0.855x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.136091| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.333375| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.420844| train set 1.791x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.832744| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.094012| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.429487| train set 1.791x speedup, test set 1.032x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.057344| train set 1.791x speedup, test set 1.086x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.010249| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.371358| train set 1.810x speedup, test set 0.909x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.082082| train set 1.810x speedup, test set 0.908x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.027653| train set 1.810x speedup, test set 0.839x speedup, val set 0.450x speedup, step: 1
Epoch 104/200 |loss: 9.018681| train set 1.776x speedup, test set 0.873x speedup, val set 0.275x speedup, step: 2
Epoch 105/200 |loss: 8.884477| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 8.980801| train set 1.810x speedup, test set 0.913x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.661403| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.997895| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.645539| train set 1.810x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.265186| train set 1.791x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.826692| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 7.886621| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 9.969595| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.178467| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.439347| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.136112| train set 1.810x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 11.221435| train set 1.810x speedup, test set 1.084x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.577482| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.501132| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 17
Epoch 120/200 |loss: 8.406795| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 18
Epoch 121/200 |loss: 9.404323| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 19
Epoch 122/200 |loss: 9.444906| train set 1.791x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 20
Epoch 123/200 |loss: 9.021132| train set 1.791x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 21
Epoch 124/200 |loss: 8.755913| train set 1.757x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 22
Epoch 125/200 |loss: 8.853653| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 23
Epoch 126/200 |loss: 8.317078| train set 1.810x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 24
Epoch 127/200 |loss: 7.700338| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 25
Epoch 128/200 |loss: 8.937561| train set 1.776x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 26
Epoch 129/200 |loss: 8.623623| train set 1.776x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 27
Epoch 130/200 |loss: 8.653358| train set 1.791x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 28
Epoch 131/200 |loss: 8.856016| train set 1.791x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 29
Epoch 132/200 |loss: 8.204184| train set 1.791x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 30
Epoch 133/200 |loss: 8.275255| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 31
Epoch 134/200 |loss: 8.891640| train set 1.810x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 32
Epoch 135/200 |loss: 8.152680| train set 1.810x speedup, test set 1.031x speedup, val set 0.296x speedup, step: 33
Epoch 136/200 |loss: 7.845076| train set 1.810x speedup, test set 1.022x speedup, val set 0.296x speedup, step: 34
Epoch 137/200 |loss: 8.079308| train set 1.810x speedup, test set 1.022x speedup, val set 0.296x speedup, step: 35
Epoch 138/200 |loss: 7.097827| train set 1.810x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 36
Epoch 139/200 |loss: 7.238296| train set 1.810x speedup, test set 0.866x speedup, val set 0.296x speedup, step: 37
Epoch 140/200 |loss: 6.757794| train set 1.810x speedup, test set 0.860x speedup, val set 0.296x speedup, step: 38
Epoch 141/200 |loss: 10.387049| train set 1.776x speedup, test set 0.860x speedup, val set 0.296x speedup, step: 39
Epoch 142/200 |loss: 7.818626| train set 1.776x speedup, test set 0.861x speedup, val set 0.296x speedup, step: 40
Epoch 143/200 |loss: 8.389338| train set 1.791x speedup, test set 1.078x speedup, val set 0.296x speedup, step: 41
Epoch 144/200 |loss: 9.356484| train set 1.790x speedup, test set 1.022x speedup, val set 0.296x speedup, step: 42
Epoch 145/200 |loss: 9.517790| train set 1.776x speedup, test set 0.862x speedup, val set 0.296x speedup, step: 43
Epoch 146/200 |loss: 7.404846| train set 1.776x speedup, test set 0.862x speedup, val set 0.296x speedup, step: 44
Epoch 147/200 |loss: 9.293020| train set 1.790x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 45
Epoch 148/200 |loss: 7.021518| train set 1.776x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 46
Epoch 149/200 |loss: 8.774035| train set 1.776x speedup, test set 1.031x speedup, val set 0.296x speedup, step: 47
Epoch 150/200 |loss: 8.704111| train set 1.810x speedup, test set 1.031x speedup, val set 0.296x speedup, step: 48
Epoch 151/200 |loss: 9.134431| train set 1.810x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 49
Epoch 152/200 |loss: 7.664484| train set 1.810x speedup, test set 1.031x speedup, val set 0.296x speedup, step: 50
Epoch 153/200 |loss: 7.500356| train set 1.810x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 51
Epoch 154/200 |loss: 8.359284| train set 1.810x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 52
Epoch 155/200 |loss: 7.631631| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 53
Epoch 156/200 |loss: 7.401548| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 54
Epoch 157/200 |loss: 7.691837| train set 1.791x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 55
Epoch 158/200 |loss: 9.831256| train set 1.776x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 56
Epoch 159/200 |loss: 9.439540| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 57
Epoch 160/200 |loss: 8.038064| train set 1.810x speedup, test set 1.045x speedup, val set 0.296x speedup, step: 58
Epoch 161/200 |loss: 9.792591| train set 1.810x speedup, test set 1.045x speedup, val set 0.296x speedup, step: 59
Epoch 162/200 |loss: 10.602824| train set 1.810x speedup, test set 1.031x speedup, val set 0.296x speedup, step: 60
Epoch 163/200 |loss: 7.994775| train set 1.810x speedup, test set 1.036x speedup, val set 0.296x speedup, step: 61
Epoch 164/200 |loss: 8.484515| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 62
Epoch 165/200 |loss: 7.882599| train set 1.810x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 63
Epoch 166/200 |loss: 9.007561| train set 1.776x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 64
Epoch 167/200 |loss: 7.988109| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 65
Epoch 168/200 |loss: 7.697950| train set 1.791x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 66
Epoch 169/200 |loss: 8.900470| train set 1.791x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 67
Epoch 170/200 |loss: 9.074532| train set 1.757x speedup, test set 1.082x speedup, val set 0.296x speedup, step: 68
Epoch 171/200 |loss: 7.870370| train set 1.758x speedup, test set 1.083x speedup, val set 0.296x speedup, step: 69
Epoch 172/200 |loss: 8.870923| train set 1.791x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 70
Epoch 173/200 |loss: 7.850620| train set 1.810x speedup, test set 1.074x speedup, val set 0.450x speedup, step: 1
Epoch 174/200 |loss: 8.434332| train set 1.776x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 2
Epoch 175/200 |loss: 8.912021| train set 1.776x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 3
Epoch 176/200 |loss: 9.471808| train set 1.810x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 4
Epoch 177/200 |loss: 8.418795| train set 1.790x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 5
Epoch 178/200 |loss: 8.075275| train set 1.791x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 6
Epoch 179/200 |loss: 8.519238| train set 1.747x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 7
Epoch 180/200 |loss: 9.084109| train set 1.791x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 8
Epoch 181/200 |loss: 8.885979| train set 1.791x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 9
Epoch 182/200 |loss: 8.782508| train set 1.810x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 10
Epoch 183/200 |loss: 8.821981| train set 1.810x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 11
Epoch 184/200 |loss: 7.301348| train set 1.810x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 12
Epoch 185/200 |loss: 7.302155| train set 1.810x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 13
Epoch 186/200 |loss: 9.130081| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 14
Epoch 187/200 |loss: 9.504510| train set 1.810x speedup, test set 1.082x speedup, val set 0.296x speedup, step: 15
Epoch 188/200 |loss: 6.917358| train set 1.810x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 16
Epoch 189/200 |loss: 8.718657| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 17
Epoch 190/200 |loss: 7.638930| train set 1.810x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 18
Epoch 191/200 |loss: 8.071175| train set 1.776x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 19
Epoch 192/200 |loss: 9.861169| train set 1.776x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 20
Epoch 193/200 |loss: 8.351735| train set 1.776x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 21
Epoch 194/200 |loss: 9.284826| train set 1.776x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 22
Epoch 195/200 |loss: 9.727078| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 23
Epoch 196/200 |loss: 8.061074| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 24
Epoch 197/200 |loss: 8.252390| train set 1.791x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 25
Epoch 198/200 |loss: 8.843759| train set 1.791x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 26
Epoch 199/200 |loss: 8.485082| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 27
Training per epoch cost 0.355 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 6.220s, pg runtime 5.879s, speedup 0.945x
08, opt runtime 1.737s, model runtime 6.267s, pg runtime 5.994s, speedup 0.957x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
11, opt runtime 0.294s, model runtime 0.875s, pg runtime 2.352s, speedup 2.688x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.685s, pg runtime 10.685s, speedup 1.000x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
19, opt runtime 0.379s, model runtime 3.515s, pg runtime 3.645s, speedup 1.037x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 7.012s, pg runtime 5.620s, speedup 0.801x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.396s, pg runtime 8.605s, speedup 1.025x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 73, train speedup 1.810, test speedup 0.872, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 173, train speedup 1.810, test speedup 1.074, val speedup 0.450
last model at epoch 199, train speedup 1.791, test speedup 0.891, val speedup 0.296
execution cost 0:02:59.487674
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.945297, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406742| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027811| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936140| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435128| train set 1.200x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472645| train set 1.142x speedup, test set 0.864x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150184| train set 1.352x speedup, test set 0.866x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997646| train set 1.383x speedup, test set 0.865x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.318527| train set 1.225x speedup, test set 0.716x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.694680| train set 1.417x speedup, test set 0.736x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.352768| train set 1.342x speedup, test set 0.886x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.949079| train set 1.367x speedup, test set 0.845x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.179195| train set 1.367x speedup, test set 0.824x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.237158| train set 1.435x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.474937| train set 1.550x speedup, test set 0.836x speedup, val set 0.437x speedup, step: 15
Epoch 15/200 |loss: 12.922778| train set 1.620x speedup, test set 0.851x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.568321| train set 1.663x speedup, test set 0.840x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.462767| train set 1.680x speedup, test set 0.838x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.299936| train set 1.766x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 19
Epoch 19/200 |loss: 11.615940| train set 1.790x speedup, test set 0.998x speedup, val set 0.296x speedup, step: 20
Epoch 20/200 |loss: 12.529017| train set 1.458x speedup, test set 0.823x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.954397| train set 1.680x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.862361| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.279687| train set 1.790x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 11.922883| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.437804| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.629019| train set 1.517x speedup, test set 0.846x speedup, val set 0.296x speedup, step: 27
Epoch 27/200 |loss: 12.005225| train set 1.790x speedup, test set 0.819x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.652215| train set 1.790x speedup, test set 0.818x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.906629| train set 1.766x speedup, test set 0.836x speedup, val set 0.275x speedup, step: 30
Epoch 30/200 |loss: 11.488409| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.751575| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.831432| train set 1.711x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.244925| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.538994| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.089697| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.868727| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.549581| train set 1.791x speedup, test set 0.973x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.252568| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.876487| train set 1.776x speedup, test set 0.838x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.603026| train set 1.680x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.485175| train set 1.678x speedup, test set 0.976x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.422482| train set 1.791x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.776634| train set 1.746x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.281427| train set 1.791x speedup, test set 0.981x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.579144| train set 1.711x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.290490| train set 1.711x speedup, test set 0.829x speedup, val set 0.369x speedup, step: 47
Epoch 47/200 |loss: 9.437776| train set 1.594x speedup, test set 0.973x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.707426| train set 1.810x speedup, test set 1.005x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.853799| train set 1.733x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.841314| train set 1.766x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.730164| train set 1.790x speedup, test set 0.978x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.547521| train set 1.790x speedup, test set 0.978x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.129560| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.724757| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.022607| train set 1.776x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.030412| train set 1.790x speedup, test set 0.987x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.741745| train set 1.810x speedup, test set 0.974x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 7.796262| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.613303| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.253928| train set 1.790x speedup, test set 1.008x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.912564| train set 1.791x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.076102| train set 1.755x speedup, test set 1.022x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.654166| train set 1.776x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.027170| train set 1.696x speedup, test set 0.977x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.003914| train set 1.810x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.224607| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.702906| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.418638| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.738162| train set 1.696x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.099399| train set 1.810x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.029213| train set 1.810x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.565861| train set 1.810x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.514822| train set 1.810x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.269290| train set 1.810x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.650302| train set 1.679x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.143495| train set 1.790x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.892998| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.401556| train set 1.810x speedup, test set 0.853x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.658617| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.023407| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.552821| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.192876| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.901843| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.432733| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.127071| train set 1.696x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.139778| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.910972| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.245053| train set 1.791x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.145094| train set 1.791x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.624147| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.275075| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.755398| train set 1.810x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.537827| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.626078| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.649469| train set 1.791x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.942945| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.072052| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.414628| train set 1.764x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.958873| train set 1.783x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.080813| train set 1.776x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.122461| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 7.833808| train set 1.810x speedup, test set 1.043x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.342196| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 1
Epoch 104/200 |loss: 8.667297| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 1
Epoch 105/200 |loss: 8.379614| train set 1.776x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 1
Epoch 106/200 |loss: 9.000668| train set 1.776x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 1
Epoch 107/200 |loss: 10.414044| train set 1.810x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 1
Epoch 108/200 |loss: 9.320152| train set 1.810x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 1
Epoch 109/200 |loss: 8.649301| train set 1.791x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 1
Epoch 110/200 |loss: 9.067822| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 1
Epoch 111/200 |loss: 8.893829| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 1
Epoch 112/200 |loss: 8.174269| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 1
Epoch 113/200 |loss: 10.007252| train set 1.810x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 1
Epoch 114/200 |loss: 8.842479| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 1
Epoch 115/200 |loss: 8.755754| train set 1.810x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 1
Epoch 116/200 |loss: 8.391000| train set 1.791x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 1
Epoch 117/200 |loss: 11.008138| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 1
Epoch 118/200 |loss: 8.621576| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 1
Epoch 119/200 |loss: 8.494301| train set 1.810x speedup, test set 1.069x speedup, val set 0.450x speedup, step: 1
Epoch 120/200 |loss: 8.262383| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 2
Epoch 121/200 |loss: 9.186728| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 3
Epoch 122/200 |loss: 9.609747| train set 1.791x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 4
Epoch 123/200 |loss: 9.080350| train set 1.790x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 5
Epoch 124/200 |loss: 8.989511| train set 1.757x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 6
Epoch 125/200 |loss: 8.823646| train set 1.791x speedup, test set 1.035x speedup, val set 0.296x speedup, step: 7
Epoch 126/200 |loss: 8.108413| train set 1.810x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 8
Epoch 127/200 |loss: 7.714502| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 9
Epoch 128/200 |loss: 8.989881| train set 1.776x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 10
Epoch 129/200 |loss: 8.584497| train set 1.776x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 11
Epoch 130/200 |loss: 8.600097| train set 1.810x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 12
Epoch 131/200 |loss: 8.699060| train set 1.791x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 13
Epoch 132/200 |loss: 8.293934| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 14
Epoch 133/200 |loss: 8.777169| train set 1.791x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 15
Epoch 134/200 |loss: 9.357367| train set 1.810x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 16
Epoch 135/200 |loss: 8.532747| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 17
Epoch 136/200 |loss: 8.003545| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 18
Epoch 137/200 |loss: 8.139707| train set 1.776x speedup, test set 1.024x speedup, val set 0.296x speedup, step: 19
Epoch 138/200 |loss: 6.943201| train set 1.776x speedup, test set 1.026x speedup, val set 0.296x speedup, step: 20
Epoch 139/200 |loss: 7.517120| train set 1.696x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 21
Epoch 140/200 |loss: 7.123176| train set 1.810x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 22
Epoch 141/200 |loss: 10.293248| train set 1.810x speedup, test set 0.888x speedup, val set 0.450x speedup, step: 1
Epoch 142/200 |loss: 8.820984| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.196246| train set 1.791x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.413691| train set 1.791x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.461229| train set 1.757x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.077523| train set 1.757x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.589791| train set 1.757x speedup, test set 1.078x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 6.983955| train set 1.776x speedup, test set 1.077x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 8.903035| train set 1.810x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.545186| train set 1.810x speedup, test set 1.077x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.323808| train set 1.810x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 7.565201| train set 1.776x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.256621| train set 1.810x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.484232| train set 1.810x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 7.655133| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.440829| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.641889| train set 1.790x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 9.991935| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.420288| train set 1.810x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 8.255403| train set 1.810x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 9.963152| train set 1.810x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 10.201559| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 8.086508| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 23
Epoch 164/200 |loss: 8.696216| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 7.961056| train set 1.810x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 9.070914| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 26
Epoch 167/200 |loss: 8.385380| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 27
Epoch 168/200 |loss: 7.825331| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 28
Epoch 169/200 |loss: 8.743679| train set 1.790x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 29
Epoch 170/200 |loss: 9.137566| train set 1.757x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 30
Epoch 171/200 |loss: 7.954670| train set 1.757x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 31
Epoch 172/200 |loss: 8.764003| train set 1.791x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 32
Epoch 173/200 |loss: 7.927355| train set 1.790x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 33
Epoch 174/200 |loss: 7.984922| train set 1.776x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 34
Epoch 175/200 |loss: 8.628635| train set 1.775x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 35
Epoch 176/200 |loss: 9.574140| train set 1.776x speedup, test set 1.047x speedup, val set 0.296x speedup, step: 36
Epoch 177/200 |loss: 8.189666| train set 1.790x speedup, test set 1.047x speedup, val set 0.296x speedup, step: 37
Epoch 178/200 |loss: 8.148311| train set 1.790x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 38
Epoch 179/200 |loss: 8.312904| train set 1.757x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 39
Epoch 180/200 |loss: 9.345497| train set 1.791x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 40
Epoch 181/200 |loss: 8.795531| train set 1.791x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 41
Epoch 182/200 |loss: 8.890561| train set 1.810x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 42
Epoch 183/200 |loss: 8.869211| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 43
Epoch 184/200 |loss: 7.270946| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 44
Epoch 185/200 |loss: 7.382463| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 45
Epoch 186/200 |loss: 9.345025| train set 1.810x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 46
Epoch 187/200 |loss: 9.574513| train set 1.810x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 47
Epoch 188/200 |loss: 7.069516| train set 1.810x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 48
Epoch 189/200 |loss: 8.869789| train set 1.810x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 49
Epoch 190/200 |loss: 7.630486| train set 1.810x speedup, test set 1.082x speedup, val set 0.296x speedup, step: 50
Epoch 191/200 |loss: 8.112103| train set 1.776x speedup, test set 1.082x speedup, val set 0.296x speedup, step: 51
Epoch 192/200 |loss: 10.082301| train set 1.776x speedup, test set 1.082x speedup, val set 0.296x speedup, step: 52
Epoch 193/200 |loss: 8.326016| train set 1.776x speedup, test set 1.082x speedup, val set 0.296x speedup, step: 53
Epoch 194/200 |loss: 9.156718| train set 1.810x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 54
Epoch 195/200 |loss: 9.829726| train set 1.810x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 55
Epoch 196/200 |loss: 8.190088| train set 1.810x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 56
Epoch 197/200 |loss: 8.177997| train set 1.791x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 57
Epoch 198/200 |loss: 8.761913| train set 1.791x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 58
Epoch 199/200 |loss: 8.475308| train set 1.791x speedup, test set 1.072x speedup, val set 0.296x speedup, step: 59
Training per epoch cost 0.352 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.685s, pg runtime 10.685s, speedup 1.000x
14, opt runtime 0.157s, model runtime 0.176s, pg runtime 0.393s, speedup 2.231x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
19, opt runtime 0.379s, model runtime 3.515s, pg runtime 3.645s, speedup 1.037x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 31, train speedup 1.810, test speedup 0.831, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 141, train speedup 1.810, test speedup 0.888, val speedup 0.450
last model at epoch 199, train speedup 1.791, test speedup 1.072, val speedup 0.296
execution cost 0:02:58.545043
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.072027, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406739| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027806| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936136| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435121| train set 1.200x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472642| train set 1.142x speedup, test set 0.864x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150187| train set 1.352x speedup, test set 0.869x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997300| train set 1.383x speedup, test set 0.865x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.314605| train set 1.225x speedup, test set 0.716x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.694570| train set 1.417x speedup, test set 0.727x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351893| train set 1.390x speedup, test set 0.886x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.945488| train set 1.335x speedup, test set 0.869x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.160022| train set 1.367x speedup, test set 0.826x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.218973| train set 1.388x speedup, test set 0.816x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.471869| train set 1.550x speedup, test set 0.873x speedup, val set 0.437x speedup, step: 15
Epoch 15/200 |loss: 12.940352| train set 1.620x speedup, test set 0.851x speedup, val set 0.437x speedup, step: 16
Epoch 16/200 |loss: 12.556405| train set 1.663x speedup, test set 0.844x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.499412| train set 1.663x speedup, test set 0.841x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.367887| train set 1.765x speedup, test set 0.920x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.678495| train set 1.790x speedup, test set 0.897x speedup, val set 1.000x speedup, step: 20
Epoch 20/200 |loss: 12.506530| train set 1.679x speedup, test set 0.833x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 12.064680| train set 1.674x speedup, test set 0.836x speedup, val set 0.437x speedup, step: 22
Epoch 22/200 |loss: 11.756981| train set 1.810x speedup, test set 0.901x speedup, val set 0.437x speedup, step: 23
Epoch 23/200 |loss: 11.402247| train set 1.764x speedup, test set 0.833x speedup, val set 0.477x speedup, step: 24
Epoch 24/200 |loss: 12.201382| train set 1.790x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.494954| train set 1.810x speedup, test set 0.861x speedup, val set 0.437x speedup, step: 26
Epoch 26/200 |loss: 10.753789| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 27
Epoch 27/200 |loss: 11.720057| train set 1.790x speedup, test set 0.843x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.448813| train set 1.810x speedup, test set 0.819x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.841950| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.332161| train set 1.790x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.850892| train set 1.791x speedup, test set 0.834x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.625387| train set 1.790x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.254450| train set 1.663x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.399671| train set 1.810x speedup, test set 0.857x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.962019| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.932043| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.655003| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.108887| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.757022| train set 1.776x speedup, test set 0.885x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.524875| train set 1.651x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.475904| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.449924| train set 1.757x speedup, test set 0.829x speedup, val set 0.275x speedup, step: 43
Epoch 43/200 |loss: 12.013209| train set 1.747x speedup, test set 0.851x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.332017| train set 1.694x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.617406| train set 1.681x speedup, test set 0.884x speedup, val set 0.294x speedup, step: 46
Epoch 46/200 |loss: 10.962399| train set 1.810x speedup, test set 0.832x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.673211| train set 1.810x speedup, test set 1.018x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 10.011106| train set 1.810x speedup, test set 0.978x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.845160| train set 1.766x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.992809| train set 1.680x speedup, test set 0.988x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.117056| train set 1.747x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.855129| train set 1.747x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.458288| train set 1.810x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.818473| train set 1.776x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.974332| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.073987| train set 1.776x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.686079| train set 1.790x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 7.961398| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.524266| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.395339| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.626120| train set 1.788x speedup, test set 0.861x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 9.911315| train set 1.757x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.468952| train set 1.757x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.385079| train set 1.664x speedup, test set 1.035x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.988615| train set 1.810x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 8.992607| train set 1.776x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.762502| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.280967| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.540168| train set 1.696x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 8.992931| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.014729| train set 1.791x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.318032| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.453259| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.150336| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.343625| train set 1.679x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.092939| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.848730| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.353839| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.493970| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 8.994325| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.611682| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.151330| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 8.042258| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.384121| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.242206| train set 1.696x speedup, test set 1.049x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.311037| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.897092| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.221822| train set 1.747x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.119629| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.572754| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.323707| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.731363| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.409265| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.405520| train set 1.791x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.613195| train set 1.791x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.567561| train set 1.757x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.081502| train set 1.790x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.426035| train set 1.791x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.979098| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.908560| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.175252| train set 1.791x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.813171| train set 1.791x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.144193| train set 1.688x speedup, test set 0.897x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.669023| train set 1.729x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.728135| train set 1.696x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.675429| train set 1.810x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.624501| train set 1.776x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 10.129164| train set 1.776x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.720942| train set 1.810x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.337255| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.825193| train set 1.810x speedup, test set 0.898x speedup, val set 0.437x speedup, step: 9
Epoch 112/200 |loss: 8.132588| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 9.852352| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.155799| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.629616| train set 1.790x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.298171| train set 1.790x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 11.041667| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.581975| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.413199| train set 1.810x speedup, test set 0.886x speedup, val set 0.887x speedup, step: 1
Epoch 120/200 |loss: 8.238592| train set 1.776x speedup, test set 0.886x speedup, val set 0.437x speedup, step: 2
Epoch 121/200 |loss: 9.450084| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 3
Epoch 122/200 |loss: 9.529280| train set 1.679x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 4
Epoch 123/200 |loss: 9.109479| train set 1.790x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 5
Epoch 124/200 |loss: 8.959406| train set 1.757x speedup, test set 0.884x speedup, val set 0.326x speedup, step: 6
Epoch 125/200 |loss: 8.742346| train set 1.757x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 7
Epoch 126/200 |loss: 8.222983| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 8
Epoch 127/200 |loss: 7.778669| train set 1.810x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 9
Epoch 128/200 |loss: 8.873804| train set 1.810x speedup, test set 0.885x speedup, val set 0.437x speedup, step: 10
Epoch 129/200 |loss: 8.348530| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 11
Epoch 130/200 |loss: 8.520153| train set 1.810x speedup, test set 1.043x speedup, val set 0.296x speedup, step: 12
Epoch 131/200 |loss: 8.875048| train set 1.791x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 13
Epoch 132/200 |loss: 8.155699| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 14
Epoch 133/200 |loss: 8.429945| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 15
Epoch 134/200 |loss: 8.828828| train set 1.791x speedup, test set 1.043x speedup, val set 0.296x speedup, step: 16
Epoch 135/200 |loss: 8.105199| train set 1.810x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 17
Epoch 136/200 |loss: 7.763694| train set 1.810x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 18
Epoch 137/200 |loss: 8.129550| train set 1.776x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 19
Epoch 138/200 |loss: 7.006511| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 20
Epoch 139/200 |loss: 7.288664| train set 1.696x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 21
Epoch 140/200 |loss: 6.814726| train set 1.791x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 22
Epoch 141/200 |loss: 10.368872| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 23
Epoch 142/200 |loss: 8.229595| train set 1.791x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 24
Epoch 143/200 |loss: 8.333923| train set 1.791x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 25
Epoch 144/200 |loss: 9.529487| train set 1.790x speedup, test set 1.045x speedup, val set 0.296x speedup, step: 26
Epoch 145/200 |loss: 9.449016| train set 1.764x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 27
Epoch 146/200 |loss: 7.149003| train set 1.757x speedup, test set 1.074x speedup, val set 0.296x speedup, step: 28
Epoch 147/200 |loss: 9.544762| train set 1.757x speedup, test set 1.047x speedup, val set 0.296x speedup, step: 29
Epoch 148/200 |loss: 7.030154| train set 1.776x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 30
Epoch 149/200 |loss: 8.748075| train set 1.810x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 31
Epoch 150/200 |loss: 8.736766| train set 1.810x speedup, test set 1.047x speedup, val set 0.296x speedup, step: 32
Epoch 151/200 |loss: 9.218859| train set 1.776x speedup, test set 1.047x speedup, val set 0.296x speedup, step: 33
Epoch 152/200 |loss: 7.609920| train set 1.776x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 34
Epoch 153/200 |loss: 7.590450| train set 1.810x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 35
Epoch 154/200 |loss: 8.507053| train set 1.810x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 36
Epoch 155/200 |loss: 7.697487| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 37
Epoch 156/200 |loss: 7.714120| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 38
Epoch 157/200 |loss: 7.672712| train set 1.790x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 39
Epoch 158/200 |loss: 10.025374| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 40
Epoch 159/200 |loss: 9.928972| train set 1.810x speedup, test set 1.045x speedup, val set 0.296x speedup, step: 41
Epoch 160/200 |loss: 8.080896| train set 1.810x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 42
Epoch 161/200 |loss: 9.880934| train set 1.810x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 43
Epoch 162/200 |loss: 10.782999| train set 1.810x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 44
Epoch 163/200 |loss: 8.132751| train set 1.776x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 45
Epoch 164/200 |loss: 8.708959| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 46
Epoch 165/200 |loss: 8.069462| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 47
Epoch 166/200 |loss: 9.269862| train set 1.810x speedup, test set 1.040x speedup, val set 0.296x speedup, step: 48
Epoch 167/200 |loss: 8.125807| train set 1.810x speedup, test set 1.042x speedup, val set 0.296x speedup, step: 49
Epoch 168/200 |loss: 7.785469| train set 1.791x speedup, test set 1.039x speedup, val set 0.296x speedup, step: 50
Epoch 169/200 |loss: 8.790615| train set 1.790x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 51
Epoch 170/200 |loss: 9.351567| train set 1.757x speedup, test set 1.041x speedup, val set 0.296x speedup, step: 52
Epoch 171/200 |loss: 7.975503| train set 1.757x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 53
Epoch 172/200 |loss: 8.878299| train set 1.791x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 54
Epoch 173/200 |loss: 7.755880| train set 1.791x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 55
Epoch 174/200 |loss: 8.192174| train set 1.776x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 56
Epoch 175/200 |loss: 8.741663| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 57
Epoch 176/200 |loss: 9.290879| train set 1.810x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 58
Epoch 177/200 |loss: 7.947299| train set 1.790x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 59
Epoch 178/200 |loss: 8.123825| train set 1.791x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 60
Epoch 179/200 |loss: 8.411371| train set 1.728x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 61
Epoch 180/200 |loss: 9.140671| train set 1.791x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 62
Epoch 181/200 |loss: 8.748538| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 63
Epoch 182/200 |loss: 8.487742| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 64
Epoch 183/200 |loss: 8.721932| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 65
Epoch 184/200 |loss: 7.186378| train set 1.810x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 66
Epoch 185/200 |loss: 7.295710| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 67
Epoch 186/200 |loss: 9.306900| train set 1.810x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 68
Epoch 187/200 |loss: 9.427118| train set 1.810x speedup, test set 1.049x speedup, val set 0.296x speedup, step: 69
Epoch 188/200 |loss: 6.996959| train set 1.790x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 70
Epoch 189/200 |loss: 8.832595| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 71
Epoch 190/200 |loss: 7.592314| train set 1.776x speedup, test set 1.074x speedup, val set 0.296x speedup, step: 72
Epoch 191/200 |loss: 7.980452| train set 1.776x speedup, test set 1.074x speedup, val set 0.296x speedup, step: 73
Epoch 192/200 |loss: 9.968675| train set 1.776x speedup, test set 1.072x speedup, val set 0.296x speedup, step: 74
Epoch 193/200 |loss: 8.365469| train set 1.776x speedup, test set 1.036x speedup, val set 0.296x speedup, step: 75
Epoch 194/200 |loss: 9.406835| train set 1.776x speedup, test set 1.036x speedup, val set 0.296x speedup, step: 76
Epoch 195/200 |loss: 9.880467| train set 1.776x speedup, test set 0.880x speedup, val set 0.437x speedup, step: 77
Epoch 196/200 |loss: 8.242008| train set 1.776x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 78
Epoch 197/200 |loss: 8.149254| train set 1.791x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 79
Epoch 198/200 |loss: 8.893921| train set 1.791x speedup, test set 1.043x speedup, val set 0.296x speedup, step: 80
Epoch 199/200 |loss: 8.404286| train set 1.791x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 81
Training per epoch cost 0.359 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
08, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.176s, pg runtime 0.393s, speedup 2.231x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 6.089s, pg runtime 6.089s, speedup 1.000x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 8.490s, pg runtime 4.730s, speedup 0.557x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 47, train speedup 1.810, test speedup 1.018, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 119, train speedup 1.810, test speedup 0.886, val speedup 0.887
last model at epoch 199, train speedup 1.791, test speedup 0.895, val speedup 0.296
execution cost 0:02:58.834479
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.971777, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406723| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027793| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935151| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438587| train set 1.142x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477201| train set 1.306x speedup, test set 0.889x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149708| train set 1.306x speedup, test set 0.895x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990726| train set 1.383x speedup, test set 0.861x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259723| train set 1.225x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653811| train set 1.417x speedup, test set 1.072x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351090| train set 1.478x speedup, test set 0.881x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908925| train set 1.416x speedup, test set 0.888x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132354| train set 1.367x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.265409| train set 1.435x speedup, test set 0.996x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.359775| train set 1.471x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.804013| train set 1.537x speedup, test set 0.832x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.381402| train set 1.663x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.503600| train set 1.663x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.430756| train set 1.790x speedup, test set 0.835x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.526622| train set 1.790x speedup, test set 0.825x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.226392| train set 1.810x speedup, test set 1.237x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.747114| train set 1.810x speedup, test set 0.821x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.453599| train set 1.810x speedup, test set 1.155x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.176666| train set 1.764x speedup, test set 0.977x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.181259| train set 1.766x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.599477| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.684091| train set 1.810x speedup, test set 0.850x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 12.009811| train set 1.791x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.483397| train set 1.790x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.986217| train set 1.734x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.789986| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.932576| train set 1.790x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.897132| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.154633| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.384721| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.120243| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.830744| train set 1.810x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.428705| train set 1.791x speedup, test set 0.992x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.423212| train set 1.810x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.934067| train set 1.776x speedup, test set 0.896x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.866552| train set 1.680x speedup, test set 0.847x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.437890| train set 1.680x speedup, test set 0.848x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.911652| train set 1.776x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.787709| train set 1.747x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.091698| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.629890| train set 1.711x speedup, test set 0.848x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.350927| train set 1.810x speedup, test set 0.833x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.768178| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.652508| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.409724| train set 1.733x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.536630| train set 1.790x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.226810| train set 1.791x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.598250| train set 1.716x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.428165| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.603334| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.047523| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.409276| train set 1.776x speedup, test set 0.920x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.579573| train set 1.790x speedup, test set 1.031x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.062250| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.820954| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.952973| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.803126| train set 1.791x speedup, test set 1.125x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.511757| train set 1.757x speedup, test set 0.917x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.686946| train set 1.757x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.746312| train set 1.680x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.889610| train set 1.810x speedup, test set 1.136x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.491454| train set 1.734x speedup, test set 1.102x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.786335| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.631500| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.628685| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 8.922858| train set 1.791x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.239765| train set 1.791x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.516073| train set 1.791x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.709419| train set 1.810x speedup, test set 0.847x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.259450| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.497264| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 7.921859| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.746512| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.258932| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.469657| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 8.909596| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.410148| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.023895| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.902381| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.365040| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.059000| train set 1.696x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.218597| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.708354| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.251123| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.012345| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.606441| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.065474| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.609077| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.258558| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.373492| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.278269| train set 1.791x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.803576| train set 1.790x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.109126| train set 1.757x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.374037| train set 1.791x speedup, test set 1.073x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.014301| train set 1.810x speedup, test set 1.103x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.874333| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.439649| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.172299| train set 1.696x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.484116| train set 1.810x speedup, test set 0.895x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.025481| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.671797| train set 1.807x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.225939| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.155863| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.543838| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.427553| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.043335| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.958313| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 8.025465| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 9.798316| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 8.925647| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.686440| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.109628| train set 1.790x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 11.026986| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.523653| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.485641| train set 1.776x speedup, test set 0.895x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.231693| train set 1.776x speedup, test set 0.895x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.620882| train set 1.810x speedup, test set 0.895x speedup, val set 0.477x speedup, step: 1
Epoch 122/200 |loss: 9.387058| train set 1.791x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 2
Epoch 123/200 |loss: 8.878288| train set 1.790x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 3
Epoch 124/200 |loss: 8.912574| train set 1.790x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 4
Epoch 125/200 |loss: 8.479161| train set 1.790x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 5
Epoch 126/200 |loss: 8.241947| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 6
Epoch 127/200 |loss: 7.540006| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 7
Epoch 128/200 |loss: 8.943527| train set 1.776x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 8
Epoch 129/200 |loss: 8.356649| train set 1.776x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 9
Epoch 130/200 |loss: 8.566038| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 10
Epoch 131/200 |loss: 8.737012| train set 1.790x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 11
Epoch 132/200 |loss: 8.106820| train set 1.791x speedup, test set 0.896x speedup, val set 0.477x speedup, step: 1
Epoch 133/200 |loss: 8.313081| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 2
Epoch 134/200 |loss: 8.921068| train set 1.791x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 3
Epoch 135/200 |loss: 8.257162| train set 1.791x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 4
Epoch 136/200 |loss: 7.867805| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 5
Epoch 137/200 |loss: 8.129284| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 6
Epoch 138/200 |loss: 7.012534| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 7
Epoch 139/200 |loss: 7.272397| train set 1.696x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 8
Epoch 140/200 |loss: 6.900716| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 9
Epoch 141/200 |loss: 10.316600| train set 1.776x speedup, test set 0.890x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.155216| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.376216| train set 1.791x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.424189| train set 1.791x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.708005| train set 1.757x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.190921| train set 1.757x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.690183| train set 1.791x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.096935| train set 1.790x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 9.367023| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.674650| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.378182| train set 1.776x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 7.937177| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.370513| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.681477| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 7.832798| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.534827| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.626686| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 9.759071| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.344947| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 7.408385| train set 1.810x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 9.161979| train set 1.810x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 9.614652| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 7.496963| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 23
Epoch 164/200 |loss: 8.440276| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 7.744244| train set 1.810x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 9.018358| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 26
Epoch 167/200 |loss: 7.882539| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 27
Epoch 168/200 |loss: 7.605020| train set 1.790x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 28
Epoch 169/200 |loss: 8.607780| train set 1.757x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 29
Epoch 170/200 |loss: 9.310011| train set 1.757x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 30
Epoch 171/200 |loss: 7.756847| train set 1.757x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 31
Epoch 172/200 |loss: 8.500211| train set 1.791x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 32
Epoch 173/200 |loss: 7.929916| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 33
Epoch 174/200 |loss: 7.875598| train set 1.775x speedup, test set 0.899x speedup, val set 0.445x speedup, step: 34
Epoch 175/200 |loss: 8.631316| train set 1.775x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 35
Epoch 176/200 |loss: 9.253114| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 36
Epoch 177/200 |loss: 8.139570| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 37
Epoch 178/200 |loss: 8.013601| train set 1.791x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 38
Epoch 179/200 |loss: 8.460391| train set 1.791x speedup, test set 0.900x speedup, val set 0.477x speedup, step: 1
Epoch 180/200 |loss: 9.408056| train set 1.791x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 2
Epoch 181/200 |loss: 8.715455| train set 1.791x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 3
Epoch 182/200 |loss: 9.025038| train set 1.776x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 4
Epoch 183/200 |loss: 8.922647| train set 1.810x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 5
Epoch 184/200 |loss: 7.318003| train set 1.810x speedup, test set 0.898x speedup, val set 0.477x speedup, step: 1
Epoch 185/200 |loss: 7.594648| train set 1.810x speedup, test set 0.898x speedup, val set 0.477x speedup, step: 1
Epoch 186/200 |loss: 9.329441| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 2
Epoch 187/200 |loss: 9.611819| train set 1.680x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 3
Epoch 188/200 |loss: 6.992318| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 4
Epoch 189/200 |loss: 8.667290| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 5
Epoch 190/200 |loss: 7.727250| train set 1.776x speedup, test set 0.891x speedup, val set 0.477x speedup, step: 1
Epoch 191/200 |loss: 8.062645| train set 1.776x speedup, test set 0.896x speedup, val set 0.477x speedup, step: 1
Epoch 192/200 |loss: 10.131558| train set 1.776x speedup, test set 0.897x speedup, val set 0.477x speedup, step: 1
Epoch 193/200 |loss: 8.444070| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 2
Epoch 194/200 |loss: 9.110903| train set 1.776x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 3
Epoch 195/200 |loss: 9.594526| train set 1.776x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 4
Epoch 196/200 |loss: 8.292340| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 5
Epoch 197/200 |loss: 8.319810| train set 1.791x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 6
Epoch 198/200 |loss: 8.700275| train set 1.791x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 7
Epoch 199/200 |loss: 8.445622| train set 1.791x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 8
Training per epoch cost 0.345 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.220s, pg runtime 5.879s, speedup 0.945x
08, opt runtime 1.737s, model runtime 6.267s, pg runtime 5.994s, speedup 0.957x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.685s, pg runtime 10.685s, speedup 1.000x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.396s, pg runtime 8.605s, speedup 1.025x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 1.810, test speedup 0.841, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 192, train speedup 1.776, test speedup 0.897, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 0.900, val speedup 0.296
execution cost 0:02:55.256850
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.915458, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406729| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027798| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935155| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438596| train set 1.142x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477203| train set 1.306x speedup, test set 0.889x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149715| train set 1.306x speedup, test set 0.895x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990742| train set 1.383x speedup, test set 0.861x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259744| train set 1.225x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653829| train set 1.417x speedup, test set 1.072x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351120| train set 1.478x speedup, test set 0.881x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908976| train set 1.412x speedup, test set 0.888x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132876| train set 1.367x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.263930| train set 1.435x speedup, test set 1.222x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.356849| train set 1.550x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.794504| train set 1.623x speedup, test set 0.831x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.427609| train set 1.663x speedup, test set 0.821x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.493638| train set 1.663x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.413875| train set 1.790x speedup, test set 0.876x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.541566| train set 1.790x speedup, test set 0.831x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.174877| train set 1.786x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.725496| train set 1.810x speedup, test set 0.821x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.492359| train set 1.810x speedup, test set 0.921x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.199988| train set 1.764x speedup, test set 0.986x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.363466| train set 1.766x speedup, test set 0.879x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.594035| train set 1.542x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.993845| train set 1.517x speedup, test set 0.879x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.955500| train set 1.790x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.459463| train set 1.790x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.117884| train set 1.766x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.558842| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.954935| train set 1.791x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.798506| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.106059| train set 1.810x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.258911| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.929538| train set 1.776x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.850506| train set 1.810x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.401844| train set 1.791x speedup, test set 0.960x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.939392| train set 1.791x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 9.128258| train set 1.766x speedup, test set 0.826x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.989672| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.650505| train set 1.664x speedup, test set 0.858x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 10.228849| train set 1.758x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.390311| train set 1.715x speedup, test set 0.824x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.833982| train set 1.766x speedup, test set 0.823x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.544664| train set 1.810x speedup, test set 0.824x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 9.999580| train set 1.810x speedup, test set 0.820x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 8.941408| train set 1.810x speedup, test set 0.820x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.369677| train set 1.776x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.567302| train set 1.776x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.520225| train set 1.810x speedup, test set 0.824x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.667600| train set 1.790x speedup, test set 0.824x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.493694| train set 1.716x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.326455| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.744791| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.888306| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.053112| train set 1.776x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.791578| train set 1.810x speedup, test set 0.826x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.014996| train set 1.810x speedup, test set 0.819x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.749653| train set 1.810x speedup, test set 0.846x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.309525| train set 1.810x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.190664| train set 1.791x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 9.977177| train set 1.758x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.553303| train set 1.755x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.054417| train set 1.664x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.130297| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.243857| train set 1.733x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.822916| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.532008| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.359845| train set 1.791x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.110914| train set 1.810x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.034465| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.486242| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.475638| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.234235| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.534487| train set 1.679x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.239784| train set 1.791x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.823722| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.307379| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.535765| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.086248| train set 1.776x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.635927| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.097090| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.938262| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.419735| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.237339| train set 1.696x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.046728| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.937263| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.248371| train set 1.791x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.051377| train set 1.791x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.511642| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.277352| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.841455| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.265690| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.681191| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.496449| train set 1.791x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 10.114275| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.133394| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.572368| train set 1.791x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 10.008734| train set 1.791x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.071380| train set 1.779x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.360182| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 7.989048| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.257545| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 1
Epoch 104/200 |loss: 8.786171| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 1
Epoch 105/200 |loss: 8.494419| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 1
Epoch 106/200 |loss: 9.039819| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 1
Epoch 107/200 |loss: 10.310405| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 1
Epoch 108/200 |loss: 9.374001| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 1
Epoch 109/200 |loss: 8.544157| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 1
Epoch 110/200 |loss: 8.884103| train set 1.810x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 1
Epoch 111/200 |loss: 8.630383| train set 1.810x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 1
Epoch 112/200 |loss: 8.028651| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 1
Epoch 113/200 |loss: 9.886252| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 1
Epoch 114/200 |loss: 8.811941| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 1
Epoch 115/200 |loss: 8.411585| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 1
Epoch 116/200 |loss: 8.356084| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 1
Epoch 117/200 |loss: 10.865286| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 1
Epoch 118/200 |loss: 8.428329| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 1
Epoch 119/200 |loss: 8.459363| train set 1.810x speedup, test set 0.893x speedup, val set 0.450x speedup, step: 1
Epoch 120/200 |loss: 8.165619| train set 1.808x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 2
Epoch 121/200 |loss: 9.436453| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 3
Epoch 122/200 |loss: 9.573875| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 4
Epoch 123/200 |loss: 9.158851| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 5
Epoch 124/200 |loss: 9.042314| train set 1.757x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 6
Epoch 125/200 |loss: 8.609591| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 7
Epoch 126/200 |loss: 8.236270| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 8
Epoch 127/200 |loss: 7.670757| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 9
Epoch 128/200 |loss: 9.047962| train set 1.775x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 10
Epoch 129/200 |loss: 8.685179| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 11
Epoch 130/200 |loss: 8.603796| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 12
Epoch 131/200 |loss: 9.105443| train set 1.791x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 13
Epoch 132/200 |loss: 8.402475| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 14
Epoch 133/200 |loss: 8.736336| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 15
Epoch 134/200 |loss: 9.120353| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 16
Epoch 135/200 |loss: 8.201782| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 17
Epoch 136/200 |loss: 8.044990| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 18
Epoch 137/200 |loss: 8.182925| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 19
Epoch 138/200 |loss: 7.117305| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 20
Epoch 139/200 |loss: 7.450467| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 21
Epoch 140/200 |loss: 6.913167| train set 1.790x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 22
Epoch 141/200 |loss: 10.365149| train set 1.776x speedup, test set 0.897x speedup, val set 0.450x speedup, step: 1
Epoch 142/200 |loss: 8.252814| train set 1.775x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.871503| train set 1.790x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.222485| train set 1.790x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.974826| train set 1.790x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.016661| train set 1.756x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 10.232196| train set 1.790x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.125647| train set 1.790x speedup, test set 0.752x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 10.846591| train set 1.790x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 9.535443| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.917611| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 8.321538| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 8.227643| train set 1.776x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.876807| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 8.292438| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.777732| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.930617| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 10.216972| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.736412| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 7.394075| train set 1.810x speedup, test set 1.085x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 9.281847| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 10.019144| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 7.760258| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 23
Epoch 164/200 |loss: 8.226196| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 7.739079| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 8.963235| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 26
Epoch 167/200 |loss: 8.283843| train set 1.810x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 27
Epoch 168/200 |loss: 7.772468| train set 1.790x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 28
Epoch 169/200 |loss: 8.873495| train set 1.757x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 29
Epoch 170/200 |loss: 9.084660| train set 1.757x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 30
Epoch 171/200 |loss: 7.906077| train set 1.757x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 31
Epoch 172/200 |loss: 8.602274| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 32
Epoch 173/200 |loss: 7.870963| train set 1.791x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 33
Epoch 174/200 |loss: 7.949681| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 34
Epoch 175/200 |loss: 8.635202| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 35
Epoch 176/200 |loss: 9.161727| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 36
Epoch 177/200 |loss: 8.001366| train set 1.790x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 37
Epoch 178/200 |loss: 7.964853| train set 1.791x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 38
Epoch 179/200 |loss: 8.382152| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 39
Epoch 180/200 |loss: 9.011611| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 40
Epoch 181/200 |loss: 8.744955| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 41
Epoch 182/200 |loss: 8.615581| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 42
Epoch 183/200 |loss: 8.716096| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 43
Epoch 184/200 |loss: 7.295233| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 44
Epoch 185/200 |loss: 7.197980| train set 1.810x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 45
Epoch 186/200 |loss: 9.607862| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 46
Epoch 187/200 |loss: 9.424556| train set 1.810x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 47
Epoch 188/200 |loss: 6.858773| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 48
Epoch 189/200 |loss: 8.717904| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 49
Epoch 190/200 |loss: 7.754490| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 50
Epoch 191/200 |loss: 8.130827| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 51
Epoch 192/200 |loss: 10.059310| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 52
Epoch 193/200 |loss: 8.353944| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 53
Epoch 194/200 |loss: 8.970067| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 54
Epoch 195/200 |loss: 9.733656| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 55
Epoch 196/200 |loss: 8.136996| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 56
Epoch 197/200 |loss: 8.317084| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 57
Epoch 198/200 |loss: 8.776929| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 58
Epoch 199/200 |loss: 8.393743| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 59
Training per epoch cost 0.310 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.176s, pg runtime 0.393s, speedup 2.231x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 3.515s, pg runtime 3.645s, speedup 1.037x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.396s, pg runtime 8.605s, speedup 1.025x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 40, train speedup 1.810, test speedup 0.832, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 141, train speedup 1.776, test speedup 0.897, val speedup 0.450
last model at epoch 199, train speedup 1.791, test speedup 0.897, val speedup 0.296
execution cost 0:02:36.728758
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.942818, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406727| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027800| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935157| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438596| train set 1.142x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477204| train set 1.306x speedup, test set 0.889x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149719| train set 1.306x speedup, test set 0.895x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.990746| train set 1.383x speedup, test set 0.861x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.259751| train set 1.225x speedup, test set 0.983x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.653831| train set 1.417x speedup, test set 1.072x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351127| train set 1.478x speedup, test set 0.881x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.908958| train set 1.416x speedup, test set 0.888x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.132352| train set 1.367x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.264611| train set 1.435x speedup, test set 1.222x speedup, val set 0.275x speedup, step: 14
Epoch 14/200 |loss: 13.358308| train set 1.471x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.804265| train set 1.623x speedup, test set 0.832x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.389686| train set 1.663x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.528307| train set 1.663x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.418277| train set 1.790x speedup, test set 0.890x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.530112| train set 1.790x speedup, test set 0.823x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.211385| train set 1.810x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.726566| train set 1.810x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.425615| train set 1.810x speedup, test set 0.907x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.423520| train set 1.764x speedup, test set 1.021x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.411503| train set 1.766x speedup, test set 0.844x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.314097| train set 1.810x speedup, test set 0.882x speedup, val set 0.437x speedup, step: 26
Epoch 26/200 |loss: 10.803044| train set 1.810x speedup, test set 0.826x speedup, val set 0.296x speedup, step: 27
Epoch 27/200 |loss: 11.766153| train set 1.790x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.351124| train set 1.790x speedup, test set 0.819x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.819863| train set 1.810x speedup, test set 0.826x speedup, val set 0.294x speedup, step: 30
Epoch 30/200 |loss: 11.349092| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.908303| train set 1.791x speedup, test set 0.820x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.721134| train set 1.694x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.115868| train set 1.528x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.140913| train set 1.542x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.783607| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.755797| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.606181| train set 1.664x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.391327| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.848153| train set 1.734x speedup, test set 0.886x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.864990| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.621174| train set 1.678x speedup, test set 0.916x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 10.073184| train set 1.758x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.468032| train set 1.747x speedup, test set 0.854x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.046938| train set 1.747x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.731576| train set 1.711x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.407196| train set 1.711x speedup, test set 0.833x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.665535| train set 1.711x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.618639| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.412081| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.466402| train set 1.791x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.248715| train set 1.791x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 11.033016| train set 1.734x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.608959| train set 1.810x speedup, test set 0.848x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 10.189851| train set 1.810x speedup, test set 0.854x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.190991| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.628881| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.914079| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.011135| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.928061| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.727746| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.988321| train set 1.791x speedup, test set 0.998x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.338706| train set 1.757x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.720366| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.635469| train set 1.635x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.140612| train set 1.791x speedup, test set 1.018x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.373422| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.943148| train set 1.734x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 68
Epoch 68/200 |loss: 8.684935| train set 1.810x speedup, test set 0.897x speedup, val set 0.505x speedup, step: 69
Epoch 69/200 |loss: 8.729470| train set 1.696x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.076486| train set 1.810x speedup, test set 0.856x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.114182| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.396173| train set 1.790x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.563486| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.124800| train set 1.810x speedup, test set 0.855x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.559493| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.077016| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.791625| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.261636| train set 1.776x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.572156| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.124717| train set 1.774x speedup, test set 0.922x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.549043| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.016589| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.901535| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.322967| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.131486| train set 1.696x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.072169| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.705230| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.190271| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.043904| train set 1.791x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.609688| train set 1.790x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.178027| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.652891| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.273311| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.425429| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.430222| train set 1.791x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.797177| train set 1.791x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.116284| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.252576| train set 1.791x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.921141| train set 1.791x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.857942| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.525566| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.339406| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.191017| train set 1.810x speedup, test set 0.887x speedup, val set 0.450x speedup, step: 1
Epoch 104/200 |loss: 9.296568| train set 1.776x speedup, test set 0.888x speedup, val set 0.275x speedup, step: 2
Epoch 105/200 |loss: 8.471213| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.300742| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.400342| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.612676| train set 1.776x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.536720| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.126808| train set 1.791x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.738876| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 7.779530| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 9.420041| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 8.908645| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.172291| train set 1.790x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 7.934195| train set 1.790x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 10.862424| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.491384| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.247264| train set 1.810x speedup, test set 0.895x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.119027| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 2
Epoch 121/200 |loss: 9.633210| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 3
Epoch 122/200 |loss: 9.505805| train set 1.791x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 4
Epoch 123/200 |loss: 8.932609| train set 1.790x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 5
Epoch 124/200 |loss: 8.901537| train set 1.757x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 6
Epoch 125/200 |loss: 8.608400| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 7
Epoch 126/200 |loss: 8.187057| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 8
Epoch 127/200 |loss: 7.704605| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 9
Epoch 128/200 |loss: 8.916635| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 10
Epoch 129/200 |loss: 8.401686| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 11
Epoch 130/200 |loss: 8.544454| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 12
Epoch 131/200 |loss: 8.836552| train set 1.791x speedup, test set 0.899x speedup, val set 0.477x speedup, step: 1
Epoch 132/200 |loss: 8.245541| train set 1.791x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 2
Epoch 133/200 |loss: 8.393851| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 3
Epoch 134/200 |loss: 8.941929| train set 1.791x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 4
Epoch 135/200 |loss: 8.195376| train set 1.791x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 5
Epoch 136/200 |loss: 7.897221| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 6
Epoch 137/200 |loss: 8.141336| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 7
Epoch 138/200 |loss: 6.863158| train set 1.666x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 8
Epoch 139/200 |loss: 7.373695| train set 1.696x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 9
Epoch 140/200 |loss: 6.906433| train set 1.791x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 10
Epoch 141/200 |loss: 10.481754| train set 1.776x speedup, test set 0.893x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.667504| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.537532| train set 1.679x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.684126| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.702994| train set 1.757x speedup, test set 0.900x speedup, val set 0.437x speedup, step: 5
Epoch 146/200 |loss: 7.261448| train set 1.757x speedup, test set 0.896x speedup, val set 0.437x speedup, step: 6
Epoch 147/200 |loss: 9.908932| train set 1.790x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.208099| train set 1.790x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 9.671962| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.732028| train set 1.776x speedup, test set 0.892x speedup, val set 0.513x speedup, step: 1
Epoch 151/200 |loss: 9.582829| train set 1.776x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 152/200 |loss: 7.855389| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 2
Epoch 153/200 |loss: 7.575251| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 3
Epoch 154/200 |loss: 8.671663| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 4
Epoch 155/200 |loss: 7.819247| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 5
Epoch 156/200 |loss: 7.593070| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 6
Epoch 157/200 |loss: 7.697865| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 7
Epoch 158/200 |loss: 9.998010| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 8
Epoch 159/200 |loss: 9.244857| train set 1.810x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 9
Epoch 160/200 |loss: 7.344265| train set 1.810x speedup, test set 1.043x speedup, val set 0.296x speedup, step: 10
Epoch 161/200 |loss: 9.164015| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 11
Epoch 162/200 |loss: 9.482801| train set 1.810x speedup, test set 0.878x speedup, val set 0.437x speedup, step: 12
Epoch 163/200 |loss: 7.564501| train set 1.810x speedup, test set 0.885x speedup, val set 0.449x speedup, step: 13
Epoch 164/200 |loss: 8.520679| train set 1.810x speedup, test set 0.885x speedup, val set 0.437x speedup, step: 14
Epoch 165/200 |loss: 7.768434| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 15
Epoch 166/200 |loss: 8.929917| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 16
Epoch 167/200 |loss: 8.229632| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 17
Epoch 168/200 |loss: 7.715943| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 18
Epoch 169/200 |loss: 8.523256| train set 1.757x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 19
Epoch 170/200 |loss: 9.244762| train set 1.757x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 20
Epoch 171/200 |loss: 7.859676| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 21
Epoch 172/200 |loss: 8.774603| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 22
Epoch 173/200 |loss: 7.926763| train set 1.791x speedup, test set 0.876x speedup, val set 0.513x speedup, step: 1
Epoch 174/200 |loss: 7.991833| train set 1.775x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 175/200 |loss: 8.614685| train set 1.775x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 176/200 |loss: 9.444597| train set 1.696x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 177/200 |loss: 8.266001| train set 1.791x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 2
Epoch 178/200 |loss: 7.973299| train set 1.757x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 179/200 |loss: 8.522575| train set 1.757x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 180/200 |loss: 9.218543| train set 1.791x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 181/200 |loss: 8.866278| train set 1.791x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 182/200 |loss: 8.747878| train set 1.791x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 183/200 |loss: 8.921219| train set 1.791x speedup, test set 0.883x speedup, val set 0.513x speedup, step: 1
Epoch 184/200 |loss: 7.407059| train set 1.790x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 2
Epoch 185/200 |loss: 7.579466| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 3
Epoch 186/200 |loss: 9.029984| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 4
Epoch 187/200 |loss: 9.595587| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 5
Epoch 188/200 |loss: 6.920880| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 6
Epoch 189/200 |loss: 8.750103| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 7
Epoch 190/200 |loss: 7.791740| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 8
Epoch 191/200 |loss: 8.088252| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 9
Epoch 192/200 |loss: 10.036406| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 10
Epoch 193/200 |loss: 8.336072| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 11
Epoch 194/200 |loss: 9.223346| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 12
Epoch 195/200 |loss: 9.729391| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 13
Epoch 196/200 |loss: 8.362109| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 14
Epoch 197/200 |loss: 8.211967| train set 1.791x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 15
Epoch 198/200 |loss: 8.713102| train set 1.791x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 16
Epoch 199/200 |loss: 8.338732| train set 1.791x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 17
Training per epoch cost 0.310 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 6.220s, pg runtime 5.879s, speedup 0.945x
08, opt runtime 1.737s, model runtime 6.267s, pg runtime 5.994s, speedup 0.957x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.875s, pg runtime 2.352s, speedup 2.688x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 11.471s, pg runtime 10.685s, speedup 0.931x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 3.515s, pg runtime 3.645s, speedup 1.037x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 35, train speedup 1.810, test speedup 0.880, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 183, train speedup 1.791, test speedup 0.883, val speedup 0.513
last model at epoch 199, train speedup 1.791, test speedup 0.885, val speedup 0.296
execution cost 0:02:38.630238
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.050224, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406733| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027804| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936133| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435114| train set 1.200x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472637| train set 1.142x speedup, test set 0.864x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150179| train set 1.352x speedup, test set 0.866x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997664| train set 1.383x speedup, test set 0.865x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.317592| train set 1.225x speedup, test set 0.711x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.691856| train set 1.417x speedup, test set 0.846x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.373311| train set 1.370x speedup, test set 0.887x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.951880| train set 1.335x speedup, test set 0.885x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.190249| train set 1.367x speedup, test set 0.824x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.240930| train set 1.435x speedup, test set 0.819x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.427793| train set 1.550x speedup, test set 0.835x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.921144| train set 1.620x speedup, test set 0.854x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.567107| train set 1.664x speedup, test set 0.871x speedup, val set 0.437x speedup, step: 17
Epoch 17/200 |loss: 10.514443| train set 1.680x speedup, test set 0.874x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.410449| train set 1.766x speedup, test set 0.897x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.593675| train set 1.790x speedup, test set 0.889x speedup, val set 0.477x speedup, step: 20
Epoch 20/200 |loss: 12.510278| train set 1.679x speedup, test set 0.843x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.843976| train set 1.790x speedup, test set 0.843x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.614843| train set 1.790x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.380448| train set 1.790x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 11.891155| train set 1.806x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.571842| train set 1.810x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.752150| train set 1.733x speedup, test set 0.819x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.763174| train set 1.790x speedup, test set 0.818x speedup, val set 0.477x speedup, step: 28
Epoch 28/200 |loss: 10.779484| train set 1.790x speedup, test set 0.818x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.749926| train set 1.810x speedup, test set 0.829x speedup, val set 0.275x speedup, step: 30
Epoch 30/200 |loss: 11.579812| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.770677| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.839450| train set 1.694x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.113468| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.390621| train set 1.790x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.980374| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.976552| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.751788| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.338902| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.752568| train set 1.734x speedup, test set 0.839x speedup, val set 0.426x speedup, step: 40
Epoch 40/200 |loss: 8.813804| train set 1.810x speedup, test set 0.838x speedup, val set 0.477x speedup, step: 41
Epoch 41/200 |loss: 10.500172| train set 1.680x speedup, test set 0.861x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.322615| train set 1.758x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.521344| train set 1.757x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.775410| train set 1.791x speedup, test set 1.028x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.522574| train set 1.711x speedup, test set 0.829x speedup, val set 0.275x speedup, step: 46
Epoch 46/200 |loss: 10.500878| train set 1.711x speedup, test set 0.828x speedup, val set 0.275x speedup, step: 47
Epoch 47/200 |loss: 9.534245| train set 1.711x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.763977| train set 1.734x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.135141| train set 1.810x speedup, test set 0.829x speedup, val set 0.477x speedup, step: 50
Epoch 50/200 |loss: 8.846954| train set 1.791x speedup, test set 1.012x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.949106| train set 1.791x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.661796| train set 1.776x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.378494| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.765263| train set 1.776x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.943435| train set 1.776x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.209939| train set 1.790x speedup, test set 0.857x speedup, val set 0.477x speedup, step: 57
Epoch 57/200 |loss: 9.882060| train set 1.790x speedup, test set 1.013x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 7.950040| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.700805| train set 1.810x speedup, test set 0.828x speedup, val set 0.275x speedup, step: 60
Epoch 60/200 |loss: 9.695763| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.041897| train set 1.791x speedup, test set 1.013x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.220495| train set 1.757x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.974815| train set 1.757x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.489422| train set 1.664x speedup, test set 1.019x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.351404| train set 1.810x speedup, test set 1.018x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.478188| train set 1.766x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.874203| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.518729| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.833489| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.064956| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.225774| train set 1.790x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.745525| train set 1.790x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.665430| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.790298| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.639736| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.082953| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 8.071293| train set 1.790x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.465508| train set 1.733x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.772987| train set 1.776x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.152279| train set 1.775x speedup, test set 1.019x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.485358| train set 1.774x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.117376| train set 1.776x speedup, test set 0.844x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.998342| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.411707| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 8.993945| train set 1.696x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.223804| train set 1.810x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.806731| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.218254| train set 1.810x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.096395| train set 1.810x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.668666| train set 1.791x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.047278| train set 1.810x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.773025| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 9.891558| train set 1.810x speedup, test set 0.832x speedup, val set 0.450x speedup, step: 94
Epoch 94/200 |loss: 8.235843| train set 1.810x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.243056| train set 1.791x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.538026| train set 1.790x speedup, test set 0.861x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.017705| train set 1.791x speedup, test set 0.822x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.438134| train set 1.791x speedup, test set 1.019x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.992475| train set 1.766x speedup, test set 1.073x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.118198| train set 1.810x speedup, test set 1.038x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 8.947928| train set 1.810x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.610413| train set 1.696x speedup, test set 1.023x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.862711| train set 1.810x speedup, test set 0.830x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.353500| train set 1.810x speedup, test set 0.980x speedup, val set 0.477x speedup, step: 1
Epoch 105/200 |loss: 8.569423| train set 1.680x speedup, test set 0.980x speedup, val set 0.296x speedup, step: 2
Epoch 106/200 |loss: 9.389601| train set 1.810x speedup, test set 0.995x speedup, val set 0.296x speedup, step: 3
Epoch 107/200 |loss: 10.465480| train set 1.810x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 4
Epoch 108/200 |loss: 9.830659| train set 1.810x speedup, test set 1.078x speedup, val set 0.296x speedup, step: 5
Epoch 109/200 |loss: 8.523141| train set 1.810x speedup, test set 1.019x speedup, val set 0.296x speedup, step: 6
Epoch 110/200 |loss: 9.524461| train set 1.696x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 7
Epoch 111/200 |loss: 8.907972| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 8
Epoch 112/200 |loss: 8.082901| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 9
Epoch 113/200 |loss: 10.109264| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 10
Epoch 114/200 |loss: 9.047572| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 11
Epoch 115/200 |loss: 8.441804| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 12
Epoch 116/200 |loss: 8.339093| train set 1.810x speedup, test set 0.976x speedup, val set 0.296x speedup, step: 13
Epoch 117/200 |loss: 10.964161| train set 1.810x speedup, test set 1.040x speedup, val set 0.296x speedup, step: 14
Epoch 118/200 |loss: 8.581250| train set 1.810x speedup, test set 1.030x speedup, val set 0.296x speedup, step: 15
Epoch 119/200 |loss: 8.439505| train set 1.810x speedup, test set 0.887x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.164275| train set 1.776x speedup, test set 0.886x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.430860| train set 1.810x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 2
Epoch 122/200 |loss: 9.453670| train set 1.791x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 3
Epoch 123/200 |loss: 8.949382| train set 1.791x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 4
Epoch 124/200 |loss: 8.823226| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 5
Epoch 125/200 |loss: 8.751554| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 6
Epoch 126/200 |loss: 8.154446| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 7
Epoch 127/200 |loss: 7.852168| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 8
Epoch 128/200 |loss: 8.821490| train set 1.776x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 9
Epoch 129/200 |loss: 8.491095| train set 1.776x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 10
Epoch 130/200 |loss: 8.381084| train set 1.790x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 11
Epoch 131/200 |loss: 8.855994| train set 1.791x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 12
Epoch 132/200 |loss: 8.301444| train set 1.791x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 13
Epoch 133/200 |loss: 8.536790| train set 1.810x speedup, test set 0.859x speedup, val set 0.296x speedup, step: 14
Epoch 134/200 |loss: 9.191676| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 15
Epoch 135/200 |loss: 8.227156| train set 1.810x speedup, test set 0.990x speedup, val set 0.296x speedup, step: 16
Epoch 136/200 |loss: 8.000227| train set 1.776x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 17
Epoch 137/200 |loss: 8.254345| train set 1.776x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 18
Epoch 138/200 |loss: 7.055229| train set 1.666x speedup, test set 1.031x speedup, val set 0.296x speedup, step: 19
Epoch 139/200 |loss: 7.441331| train set 1.696x speedup, test set 0.990x speedup, val set 0.296x speedup, step: 20
Epoch 140/200 |loss: 6.968559| train set 1.791x speedup, test set 0.990x speedup, val set 0.296x speedup, step: 21
Epoch 141/200 |loss: 10.398028| train set 1.810x speedup, test set 0.880x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.020894| train set 1.776x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.516822| train set 1.790x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.355608| train set 1.790x speedup, test set 0.823x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.614984| train set 1.757x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 6.954505| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.795683| train set 1.757x speedup, test set 0.865x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.033830| train set 1.790x speedup, test set 0.990x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 9.529177| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.702689| train set 1.776x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.578949| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 7.866353| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.464200| train set 1.810x speedup, test set 1.031x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.838483| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 7.817201| train set 1.810x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.550936| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.903154| train set 1.810x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 10.101900| train set 1.776x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.753128| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 7.544115| train set 1.810x speedup, test set 1.031x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 9.419059| train set 1.810x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 9.946329| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 7.632051| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 23
Epoch 164/200 |loss: 8.385759| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 7.687022| train set 1.810x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 8.957220| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 26
Epoch 167/200 |loss: 8.069646| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 27
Epoch 168/200 |loss: 7.605267| train set 1.790x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 28
Epoch 169/200 |loss: 8.670441| train set 1.757x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 29
Epoch 170/200 |loss: 9.312616| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 30
Epoch 171/200 |loss: 7.869457| train set 1.758x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 31
Epoch 172/200 |loss: 8.648467| train set 1.791x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 32
Epoch 173/200 |loss: 8.086936| train set 1.791x speedup, test set 0.880x speedup, val set 0.450x speedup, step: 33
Epoch 174/200 |loss: 7.915494| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 34
Epoch 175/200 |loss: 8.796319| train set 1.775x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 35
Epoch 176/200 |loss: 9.448399| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 36
Epoch 177/200 |loss: 8.306180| train set 1.791x speedup, test set 0.858x speedup, val set 0.296x speedup, step: 37
Epoch 178/200 |loss: 8.118106| train set 1.746x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 38
Epoch 179/200 |loss: 8.537425| train set 1.747x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 39
Epoch 180/200 |loss: 9.079715| train set 1.791x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 40
Epoch 181/200 |loss: 8.839152| train set 1.791x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 41
Epoch 182/200 |loss: 8.384271| train set 1.791x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 42
Epoch 183/200 |loss: 8.587390| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 43
Epoch 184/200 |loss: 7.117437| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 44
Epoch 185/200 |loss: 7.307907| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 45
Epoch 186/200 |loss: 9.247257| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 46
Epoch 187/200 |loss: 9.469453| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 47
Epoch 188/200 |loss: 6.975830| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 48
Epoch 189/200 |loss: 8.823518| train set 1.810x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 49
Epoch 190/200 |loss: 7.686182| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 50
Epoch 191/200 |loss: 8.068900| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 51
Epoch 192/200 |loss: 9.860634| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 52
Epoch 193/200 |loss: 8.457519| train set 1.776x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 53
Epoch 194/200 |loss: 9.439301| train set 1.776x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 54
Epoch 195/200 |loss: 9.777843| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 55
Epoch 196/200 |loss: 8.220513| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 56
Epoch 197/200 |loss: 8.328177| train set 1.791x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 57
Epoch 198/200 |loss: 8.917437| train set 1.791x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 58
Epoch 199/200 |loss: 8.497659| train set 1.791x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 59
Training per epoch cost 0.310 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 7.352s, pg runtime 6.143s, speedup 0.836x
06, opt runtime 2.593s, model runtime 10.279s, pg runtime 8.283s, speedup 0.806x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.393s, pg runtime 0.393s, speedup 1.000x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 65, train speedup 1.810, test speedup 1.018, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 141, train speedup 1.810, test speedup 0.880, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 0.874, val speedup 0.296
execution cost 0:02:37.571534
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.921464, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406723| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027802| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935156| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438600| train set 1.142x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477455| train set 1.306x speedup, test set 0.889x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149270| train set 1.306x speedup, test set 0.898x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.989692| train set 1.383x speedup, test set 0.861x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.249152| train set 1.225x speedup, test set 0.996x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.658567| train set 1.417x speedup, test set 0.887x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.368621| train set 1.478x speedup, test set 0.881x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.942293| train set 1.367x speedup, test set 0.888x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.121958| train set 1.367x speedup, test set 0.828x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.255124| train set 1.435x speedup, test set 1.233x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.344703| train set 1.550x speedup, test set 0.822x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.824116| train set 1.744x speedup, test set 0.837x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.542258| train set 1.663x speedup, test set 0.709x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.430358| train set 1.680x speedup, test set 0.829x speedup, val set 0.437x speedup, step: 18
Epoch 18/200 |loss: 11.483726| train set 1.790x speedup, test set 0.881x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.552329| train set 1.790x speedup, test set 0.839x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.283881| train set 1.542x speedup, test set 1.238x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.778385| train set 1.810x speedup, test set 0.834x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.313342| train set 1.810x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.224534| train set 1.791x speedup, test set 0.998x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 11.804586| train set 1.510x speedup, test set 0.855x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.469425| train set 1.542x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.824634| train set 1.733x speedup, test set 0.830x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.986651| train set 1.790x speedup, test set 0.824x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.878786| train set 1.790x speedup, test set 0.823x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.449233| train set 1.810x speedup, test set 0.855x speedup, val set 0.437x speedup, step: 30
Epoch 30/200 |loss: 12.104357| train set 1.790x speedup, test set 0.824x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 10.241767| train set 1.790x speedup, test set 0.823x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 10.378232| train set 1.747x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.292920| train set 1.790x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.524439| train set 1.790x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.109900| train set 1.791x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.872480| train set 1.810x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.393373| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.031409| train set 1.810x speedup, test set 0.834x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.731388| train set 1.734x speedup, test set 0.884x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.489473| train set 1.680x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.113309| train set 1.664x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.583720| train set 1.757x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.650511| train set 1.747x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.321499| train set 1.810x speedup, test set 0.999x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.656306| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 11.058969| train set 1.711x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.422338| train set 1.694x speedup, test set 0.971x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.935064| train set 1.810x speedup, test set 1.040x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.886262| train set 1.734x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.932243| train set 1.791x speedup, test set 0.846x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.859870| train set 1.791x speedup, test set 0.989x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.687256| train set 1.791x speedup, test set 0.997x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.150625| train set 1.776x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.659093| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.119923| train set 1.776x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 9.880815| train set 1.791x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.750134| train set 1.790x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.068229| train set 1.810x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.527639| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.349680| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.695302| train set 1.791x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.065660| train set 1.757x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.560192| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.236868| train set 1.791x speedup, test set 1.099x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.018987| train set 1.810x speedup, test set 1.100x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.143107| train set 1.733x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.892722| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.738204| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.649652| train set 1.810x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.250271| train set 1.790x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.028127| train set 1.790x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.644569| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.619288| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.408422| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.479028| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 7.993740| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.788514| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.387316| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.479951| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.078888| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.494581| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.150955| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 8.033041| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.557648| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.158258| train set 1.696x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.165634| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.901529| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.277509| train set 1.766x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.237153| train set 1.791x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.626300| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.387390| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.714548| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.374470| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.529144| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.442285| train set 1.790x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 10.014483| train set 1.757x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.040802| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.459450| train set 1.791x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.770128| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.022983| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 8.884906| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.058168| train set 1.810x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.564599| train set 1.810x speedup, test set 0.894x speedup, val set 0.450x speedup, step: 1
Epoch 104/200 |loss: 8.813142| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.400706| train set 1.776x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.055278| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.295345| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.402223| train set 1.711x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.479572| train set 1.609x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.281227| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 9.001403| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 8.538445| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 10.241754| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.029322| train set 1.779x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 9.021213| train set 1.791x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.612459| train set 1.791x speedup, test set 1.045x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 11.053836| train set 1.810x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.267470| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.731582| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 17
Epoch 120/200 |loss: 8.223402| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 18
Epoch 121/200 |loss: 9.442111| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 19
Epoch 122/200 |loss: 9.602833| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 20
Epoch 123/200 |loss: 8.870565| train set 1.790x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 21
Epoch 124/200 |loss: 8.778739| train set 1.790x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 22
Epoch 125/200 |loss: 8.672884| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 23
Epoch 126/200 |loss: 8.244392| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 24
Epoch 127/200 |loss: 7.661542| train set 1.810x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 25
Epoch 128/200 |loss: 8.877350| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 26
Epoch 129/200 |loss: 8.505385| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 27
Epoch 130/200 |loss: 8.437498| train set 1.810x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 28
Epoch 131/200 |loss: 8.955783| train set 1.791x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 29
Epoch 132/200 |loss: 8.172944| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 30
Epoch 133/200 |loss: 8.576671| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 31
Epoch 134/200 |loss: 8.957455| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 32
Epoch 135/200 |loss: 8.074590| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 33
Epoch 136/200 |loss: 7.960477| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 34
Epoch 137/200 |loss: 8.044064| train set 1.776x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 35
Epoch 138/200 |loss: 6.910848| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 36
Epoch 139/200 |loss: 7.570284| train set 1.696x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 37
Epoch 140/200 |loss: 6.861806| train set 1.791x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 38
Epoch 141/200 |loss: 10.637484| train set 1.791x speedup, test set 0.893x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.526982| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.593100| train set 1.664x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.585991| train set 1.790x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.764861| train set 1.757x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.312460| train set 1.769x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 10.019090| train set 1.790x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.243669| train set 1.790x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 9.575940| train set 1.776x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.987474| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.442048| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 7.999709| train set 1.810x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.669458| train set 1.810x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.783438| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 7.885962| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.651796| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.594507| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 9.904248| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.636831| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 7.479522| train set 1.810x speedup, test set 1.047x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 9.279611| train set 1.810x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 10.182558| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 7.712836| train set 1.775x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 23
Epoch 164/200 |loss: 8.331512| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 7.868308| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 9.097083| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 26
Epoch 167/200 |loss: 7.988971| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 27
Epoch 168/200 |loss: 7.580649| train set 1.790x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 28
Epoch 169/200 |loss: 8.617501| train set 1.757x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 29
Epoch 170/200 |loss: 9.166761| train set 1.757x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 30
Epoch 171/200 |loss: 7.932751| train set 1.758x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 31
Epoch 172/200 |loss: 8.666907| train set 1.791x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 32
Epoch 173/200 |loss: 7.801942| train set 1.791x speedup, test set 0.893x speedup, val set 0.355x speedup, step: 33
Epoch 174/200 |loss: 8.044180| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 34
Epoch 175/200 |loss: 8.973494| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 35
Epoch 176/200 |loss: 9.321194| train set 1.790x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 36
Epoch 177/200 |loss: 8.150731| train set 1.790x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 37
Epoch 178/200 |loss: 7.964160| train set 1.758x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 38
Epoch 179/200 |loss: 8.450265| train set 1.757x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 39
Epoch 180/200 |loss: 9.250129| train set 1.791x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 40
Epoch 181/200 |loss: 8.709309| train set 1.791x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 41
Epoch 182/200 |loss: 8.578117| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 42
Epoch 183/200 |loss: 8.840957| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 43
Epoch 184/200 |loss: 7.185484| train set 1.810x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 44
Epoch 185/200 |loss: 7.389466| train set 1.810x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 45
Epoch 186/200 |loss: 9.447240| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 46
Epoch 187/200 |loss: 9.556726| train set 1.810x speedup, test set 1.062x speedup, val set 0.296x speedup, step: 47
Epoch 188/200 |loss: 6.942151| train set 1.810x speedup, test set 1.047x speedup, val set 0.296x speedup, step: 48
Epoch 189/200 |loss: 9.010774| train set 1.790x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 49
Epoch 190/200 |loss: 7.722338| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 50
Epoch 191/200 |loss: 8.066918| train set 1.776x speedup, test set 1.062x speedup, val set 0.296x speedup, step: 51
Epoch 192/200 |loss: 10.214914| train set 1.776x speedup, test set 1.062x speedup, val set 0.296x speedup, step: 52
Epoch 193/200 |loss: 8.466482| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 53
Epoch 194/200 |loss: 9.193335| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 54
Epoch 195/200 |loss: 9.879026| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 55
Epoch 196/200 |loss: 8.309465| train set 1.775x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 56
Epoch 197/200 |loss: 8.269897| train set 1.791x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 57
Epoch 198/200 |loss: 8.697238| train set 1.791x speedup, test set 0.758x speedup, val set 0.296x speedup, step: 58
Epoch 199/200 |loss: 8.575102| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 59
Training per epoch cost 0.309 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 6.057s, pg runtime 5.879s, speedup 0.971x
08, opt runtime 1.737s, model runtime 6.128s, pg runtime 5.994s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.875s, pg runtime 2.352s, speedup 2.688x
12, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
13, opt runtime 5.179s, model runtime 10.685s, pg runtime 10.685s, speedup 1.000x
14, opt runtime 0.157s, model runtime 0.176s, pg runtime 0.393s, speedup 2.231x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 3.515s, pg runtime 3.645s, speedup 1.037x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 44, train speedup 1.810, test speedup 0.999, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 141, train speedup 1.791, test speedup 0.893, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 0.893, val speedup 0.296
execution cost 0:02:36.839744
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.911705, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406736| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027803| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936133| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435114| train set 1.200x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472637| train set 1.142x speedup, test set 0.864x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150177| train set 1.352x speedup, test set 0.866x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997663| train set 1.383x speedup, test set 0.865x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.317591| train set 1.225x speedup, test set 0.711x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.691856| train set 1.417x speedup, test set 0.846x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.373311| train set 1.370x speedup, test set 0.887x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.951848| train set 1.335x speedup, test set 0.885x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.190224| train set 1.367x speedup, test set 0.824x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.241226| train set 1.435x speedup, test set 0.819x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.426995| train set 1.550x speedup, test set 0.831x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.920883| train set 1.620x speedup, test set 0.855x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.563562| train set 1.550x speedup, test set 0.866x speedup, val set 0.437x speedup, step: 17
Epoch 17/200 |loss: 10.501167| train set 1.680x speedup, test set 0.862x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.392107| train set 1.766x speedup, test set 0.920x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.596563| train set 1.790x speedup, test set 0.883x speedup, val set 0.477x speedup, step: 20
Epoch 20/200 |loss: 12.564264| train set 1.790x speedup, test set 0.844x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.778100| train set 1.810x speedup, test set 0.843x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.624549| train set 1.810x speedup, test set 0.932x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.255539| train set 1.790x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 11.965948| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 25
Epoch 25/200 |loss: 9.560325| train set 1.810x speedup, test set 0.845x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.788761| train set 1.810x speedup, test set 0.829x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.814993| train set 1.790x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.687547| train set 1.790x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 10.203559| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.653048| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 10.077783| train set 1.790x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.925983| train set 1.693x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.422133| train set 1.790x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.713797| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.118382| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.902874| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.369816| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.107715| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.741779| train set 1.810x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.487571| train set 1.810x speedup, test set 0.826x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.488337| train set 1.810x speedup, test set 0.973x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.519933| train set 1.716x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.728946| train set 1.716x speedup, test set 0.979x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.648173| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.342997| train set 1.711x speedup, test set 0.828x speedup, val set 0.275x speedup, step: 46
Epoch 46/200 |loss: 10.359329| train set 1.711x speedup, test set 0.828x speedup, val set 0.450x speedup, step: 47
Epoch 47/200 |loss: 9.516413| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.544046| train set 1.734x speedup, test set 0.861x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.054187| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.561363| train set 1.679x speedup, test set 0.990x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.066698| train set 1.757x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.237698| train set 1.734x speedup, test set 0.833x speedup, val set 0.477x speedup, step: 53
Epoch 53/200 |loss: 9.757444| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.831595| train set 1.696x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.224939| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.368717| train set 1.776x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.702044| train set 1.810x speedup, test set 1.017x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.257611| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.836595| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.448440| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.142220| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.157911| train set 1.757x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.626543| train set 1.776x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.194421| train set 1.810x speedup, test set 1.105x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.955913| train set 1.810x speedup, test set 1.008x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.189831| train set 1.734x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.638755| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.437295| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.617198| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.039319| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 8.922244| train set 1.790x speedup, test set 0.975x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.477657| train set 1.766x speedup, test set 0.829x speedup, val set 0.477x speedup, step: 73
Epoch 73/200 |loss: 7.560533| train set 1.766x speedup, test set 0.829x speedup, val set 0.477x speedup, step: 74
Epoch 74/200 |loss: 9.389016| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.312170| train set 1.663x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.327752| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 8.181438| train set 1.810x speedup, test set 0.850x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.533813| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.462224| train set 1.810x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.176972| train set 1.807x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.626669| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.106615| train set 1.810x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.901234| train set 1.776x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.416810| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.329531| train set 1.696x speedup, test set 0.974x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.190428| train set 1.810x speedup, test set 1.028x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.898718| train set 1.810x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.293114| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.286374| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.681591| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.248163| train set 1.810x speedup, test set 0.848x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.710882| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.408718| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.324907| train set 1.810x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.557451| train set 1.791x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.885999| train set 1.790x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.009597| train set 1.791x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.647720| train set 1.791x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.614330| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.904990| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 8.975655| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 7.960484| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.643512| train set 1.810x speedup, test set 0.886x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 8.754451| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.231052| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 8.896704| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.259491| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.624830| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.735618| train set 1.791x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.062814| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.880968| train set 1.810x speedup, test set 0.892x speedup, val set 0.437x speedup, step: 9
Epoch 112/200 |loss: 8.017957| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 10.043242| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 9.037556| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.676554| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.493469| train set 1.790x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 10.971209| train set 1.810x speedup, test set 1.068x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.352296| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.528213| train set 1.810x speedup, test set 0.897x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.130350| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 2
Epoch 121/200 |loss: 9.561043| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 3
Epoch 122/200 |loss: 9.548540| train set 1.791x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 4
Epoch 123/200 |loss: 9.081757| train set 1.790x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 5
Epoch 124/200 |loss: 9.151711| train set 1.757x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 6
Epoch 125/200 |loss: 8.994459| train set 1.761x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 7
Epoch 126/200 |loss: 8.323129| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 8
Epoch 127/200 |loss: 7.681971| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 9
Epoch 128/200 |loss: 8.861097| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 10
Epoch 129/200 |loss: 8.722049| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 11
Epoch 130/200 |loss: 8.525902| train set 1.791x speedup, test set 0.874x speedup, val set 0.477x speedup, step: 1
Epoch 131/200 |loss: 9.243090| train set 1.791x speedup, test set 0.897x speedup, val set 0.477x speedup, step: 1
Epoch 132/200 |loss: 8.191280| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 2
Epoch 133/200 |loss: 8.278230| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 3
Epoch 134/200 |loss: 9.232608| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 4
Epoch 135/200 |loss: 8.071059| train set 1.810x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 5
Epoch 136/200 |loss: 7.851917| train set 1.810x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 6
Epoch 137/200 |loss: 8.085691| train set 1.776x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 7
Epoch 138/200 |loss: 6.971323| train set 1.776x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 8
Epoch 139/200 |loss: 7.452665| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 9
Epoch 140/200 |loss: 6.918974| train set 1.791x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 10
Epoch 141/200 |loss: 10.457903| train set 1.776x speedup, test set 0.888x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.789434| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.830260| train set 1.679x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.790494| train set 1.791x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 10.110091| train set 1.757x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.399588| train set 1.757x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.859984| train set 1.757x speedup, test set 1.062x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.505881| train set 1.810x speedup, test set 1.074x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 8.944495| train set 1.810x speedup, test set 1.074x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.867655| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.522141| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 7.679901| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.553944| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.477126| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 7.587894| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.446061| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.647848| train set 1.791x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 9.976068| train set 1.776x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.746415| train set 1.810x speedup, test set 1.064x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 8.315841| train set 1.810x speedup, test set 1.146x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 10.112748| train set 1.810x speedup, test set 1.072x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 10.645063| train set 1.810x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 8.447005| train set 1.810x speedup, test set 1.066x speedup, val set 0.296x speedup, step: 23
Epoch 164/200 |loss: 8.785876| train set 1.810x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 8.321175| train set 1.810x speedup, test set 1.039x speedup, val set 0.477x speedup, step: 1
Epoch 166/200 |loss: 9.371271| train set 1.810x speedup, test set 1.011x speedup, val set 0.477x speedup, step: 1
Epoch 167/200 |loss: 8.364315| train set 1.810x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 2
Epoch 168/200 |loss: 7.902400| train set 1.790x speedup, test set 1.036x speedup, val set 0.296x speedup, step: 3
Epoch 169/200 |loss: 8.918004| train set 1.790x speedup, test set 1.066x speedup, val set 0.477x speedup, step: 1
Epoch 170/200 |loss: 9.397313| train set 1.757x speedup, test set 1.012x speedup, val set 0.477x speedup, step: 1
Epoch 171/200 |loss: 8.076435| train set 1.757x speedup, test set 1.021x speedup, val set 0.296x speedup, step: 2
Epoch 172/200 |loss: 8.663989| train set 1.791x speedup, test set 1.038x speedup, val set 0.296x speedup, step: 3
Epoch 173/200 |loss: 8.048293| train set 1.790x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 4
Epoch 174/200 |loss: 8.124975| train set 1.776x speedup, test set 1.055x speedup, val set 0.477x speedup, step: 1
Epoch 175/200 |loss: 8.678355| train set 1.776x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 2
Epoch 176/200 |loss: 9.471455| train set 1.810x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 3
Epoch 177/200 |loss: 8.236238| train set 1.791x speedup, test set 1.038x speedup, val set 0.296x speedup, step: 4
Epoch 178/200 |loss: 8.150047| train set 1.791x speedup, test set 0.868x speedup, val set 0.477x speedup, step: 1
Epoch 179/200 |loss: 8.493461| train set 1.757x speedup, test set 0.874x speedup, val set 0.477x speedup, step: 1
Epoch 180/200 |loss: 9.243098| train set 1.791x speedup, test set 0.874x speedup, val set 0.477x speedup, step: 1
Epoch 181/200 |loss: 8.885388| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 2
Epoch 182/200 |loss: 8.792785| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 3
Epoch 183/200 |loss: 8.909696| train set 1.810x speedup, test set 0.875x speedup, val set 0.477x speedup, step: 1
Epoch 184/200 |loss: 7.484509| train set 1.810x speedup, test set 1.038x speedup, val set 0.477x speedup, step: 1
Epoch 185/200 |loss: 7.420717| train set 1.810x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 2
Epoch 186/200 |loss: 9.210689| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 3
Epoch 187/200 |loss: 9.715829| train set 1.810x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 4
Epoch 188/200 |loss: 7.044616| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 5
Epoch 189/200 |loss: 8.871711| train set 1.810x speedup, test set 1.061x speedup, val set 0.445x speedup, step: 6
Epoch 190/200 |loss: 7.833049| train set 1.810x speedup, test set 1.065x speedup, val set 0.477x speedup, step: 1
Epoch 191/200 |loss: 7.981346| train set 1.776x speedup, test set 1.075x speedup, val set 0.477x speedup, step: 1
Epoch 192/200 |loss: 10.125290| train set 1.776x speedup, test set 0.905x speedup, val set 0.477x speedup, step: 1
Epoch 193/200 |loss: 8.406987| train set 1.776x speedup, test set 0.903x speedup, val set 0.477x speedup, step: 1
Epoch 194/200 |loss: 9.402158| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 2
Epoch 195/200 |loss: 9.962109| train set 1.776x speedup, test set 0.904x speedup, val set 0.477x speedup, step: 1
Epoch 196/200 |loss: 8.144753| train set 1.776x speedup, test set 1.080x speedup, val set 0.477x speedup, step: 1
Epoch 197/200 |loss: 8.132108| train set 1.791x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 2
Epoch 198/200 |loss: 8.902579| train set 1.791x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 3
Epoch 199/200 |loss: 8.492540| train set 1.791x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 4
Training per epoch cost 0.312 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.685s, pg runtime 10.685s, speedup 1.000x
14, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.393s, speedup 2.504x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 2.655s, pg runtime 4.730s, speedup 1.782x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 40, train speedup 1.810, test speedup 0.826, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 196, train speedup 1.776, test speedup 1.080, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 1.076, val speedup 0.296
execution cost 0:02:38.322061
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.941789, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406739| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027808| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.936136| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.435123| train set 1.200x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.472641| train set 1.142x speedup, test set 0.864x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.150189| train set 1.352x speedup, test set 0.869x speedup, val set 0.807x speedup, step: 7
Epoch 7/200 |loss: 18.997305| train set 1.383x speedup, test set 0.865x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.314610| train set 1.225x speedup, test set 0.716x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.694573| train set 1.417x speedup, test set 0.727x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.351895| train set 1.390x speedup, test set 0.886x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.945462| train set 1.335x speedup, test set 0.869x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.160276| train set 1.367x speedup, test set 0.826x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.217473| train set 1.388x speedup, test set 0.816x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.472037| train set 1.550x speedup, test set 0.861x speedup, val set 0.437x speedup, step: 15
Epoch 15/200 |loss: 12.948675| train set 1.620x speedup, test set 0.851x speedup, val set 0.437x speedup, step: 16
Epoch 16/200 |loss: 12.588134| train set 1.663x speedup, test set 0.820x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.431385| train set 1.663x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 18
Epoch 18/200 |loss: 11.357148| train set 1.680x speedup, test set 0.856x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.619999| train set 1.790x speedup, test set 0.847x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.378160| train set 1.679x speedup, test set 0.844x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.920392| train set 1.680x speedup, test set 0.852x speedup, val set 0.437x speedup, step: 22
Epoch 22/200 |loss: 11.699509| train set 1.810x speedup, test set 0.903x speedup, val set 0.437x speedup, step: 23
Epoch 23/200 |loss: 11.243804| train set 1.764x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.200245| train set 1.806x speedup, test set 0.853x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.780197| train set 1.680x speedup, test set 0.873x speedup, val set 0.437x speedup, step: 26
Epoch 26/200 |loss: 10.982369| train set 1.765x speedup, test set 0.844x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 12.195968| train set 1.765x speedup, test set 0.843x speedup, val set 0.477x speedup, step: 28
Epoch 28/200 |loss: 10.689096| train set 1.790x speedup, test set 0.843x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.860180| train set 1.810x speedup, test set 0.847x speedup, val set 0.437x speedup, step: 30
Epoch 30/200 |loss: 11.652211| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.808443| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 10.032794| train set 1.694x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.374640| train set 1.790x speedup, test set 0.862x speedup, val set 0.513x speedup, step: 34
Epoch 34/200 |loss: 10.416801| train set 1.790x speedup, test set 0.862x speedup, val set 0.513x speedup, step: 35
Epoch 35/200 |loss: 11.080691| train set 1.810x speedup, test set 0.854x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.802101| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.479453| train set 1.791x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.142992| train set 1.810x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.721499| train set 1.776x speedup, test set 0.848x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.673451| train set 1.810x speedup, test set 0.845x speedup, val set 0.294x speedup, step: 41
Epoch 41/200 |loss: 10.469157| train set 1.808x speedup, test set 0.845x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.766223| train set 1.757x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.598202| train set 1.747x speedup, test set 0.843x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.573828| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.439959| train set 1.681x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.364832| train set 1.694x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.767631| train set 1.810x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.900791| train set 1.810x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.850924| train set 1.810x speedup, test set 0.862x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.759620| train set 1.810x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.042864| train set 1.766x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.449459| train set 1.734x speedup, test set 0.849x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.278022| train set 1.776x speedup, test set 0.849x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.852246| train set 1.776x speedup, test set 0.866x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.057659| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.437637| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.703321| train set 1.790x speedup, test set 1.073x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.256818| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.630383| train set 1.810x speedup, test set 0.849x speedup, val set 0.275x speedup, step: 60
Epoch 60/200 |loss: 10.085538| train set 1.803x speedup, test set 0.857x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.010822| train set 1.791x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.478079| train set 1.757x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.789461| train set 1.758x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.898592| train set 1.679x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.206317| train set 1.810x speedup, test set 1.196x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.642140| train set 1.766x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.808609| train set 1.734x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.721088| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.886724| train set 1.680x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.170729| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.135673| train set 1.810x speedup, test set 0.856x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.943363| train set 1.790x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.463966| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.499794| train set 1.810x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.767619| train set 1.810x speedup, test set 0.850x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.125728| train set 1.810x speedup, test set 0.847x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 8.027822| train set 1.810x speedup, test set 0.846x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.545698| train set 1.776x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.830676| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.267245| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.594841| train set 1.776x speedup, test set 0.850x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.345367| train set 1.810x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 8.109987| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.450119| train set 1.810x speedup, test set 0.845x speedup, val set 0.477x speedup, step: 85
Epoch 85/200 |loss: 9.418556| train set 1.696x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.351812| train set 1.696x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.981143| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.403386| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.129801| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.719508| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.020101| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.678501| train set 1.810x speedup, test set 0.834x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.155691| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.231386| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.300001| train set 1.791x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.784174| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.741006| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.243208| train set 1.791x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.839290| train set 1.791x speedup, test set 1.037x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.918072| train set 1.766x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.007341| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.089512| train set 1.810x speedup, test set 0.852x speedup, val set 0.477x speedup, step: 1
Epoch 103/200 |loss: 9.586343| train set 1.810x speedup, test set 0.850x speedup, val set 0.426x speedup, step: 2
Epoch 104/200 |loss: 9.014127| train set 1.775x speedup, test set 0.850x speedup, val set 0.275x speedup, step: 3
Epoch 105/200 |loss: 8.569707| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 4
Epoch 106/200 |loss: 9.206937| train set 1.776x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 5
Epoch 107/200 |loss: 10.371439| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 6
Epoch 108/200 |loss: 9.993917| train set 1.711x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 7
Epoch 109/200 |loss: 8.595227| train set 1.810x speedup, test set 0.857x speedup, val set 0.296x speedup, step: 8
Epoch 110/200 |loss: 9.622043| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 9
Epoch 111/200 |loss: 8.741973| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 10
Epoch 112/200 |loss: 7.948456| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 11
Epoch 113/200 |loss: 10.136738| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 12
Epoch 114/200 |loss: 9.070963| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 13
Epoch 115/200 |loss: 8.677074| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 14
Epoch 116/200 |loss: 8.248138| train set 1.791x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 15
Epoch 117/200 |loss: 11.015668| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 16
Epoch 118/200 |loss: 8.364110| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 17
Epoch 119/200 |loss: 8.399536| train set 1.810x speedup, test set 0.886x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.361321| train set 1.810x speedup, test set 0.886x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.445599| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 2
Epoch 122/200 |loss: 9.622184| train set 1.790x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 3
Epoch 123/200 |loss: 9.009929| train set 1.790x speedup, test set 0.860x speedup, val set 0.296x speedup, step: 4
Epoch 124/200 |loss: 8.888189| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 5
Epoch 125/200 |loss: 8.575233| train set 1.757x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 6
Epoch 126/200 |loss: 8.365385| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 7
Epoch 127/200 |loss: 7.821589| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 8
Epoch 128/200 |loss: 8.948103| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 9
Epoch 129/200 |loss: 8.293574| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 10
Epoch 130/200 |loss: 8.565738| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 11
Epoch 131/200 |loss: 8.749664| train set 1.791x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 12
Epoch 132/200 |loss: 8.111485| train set 1.810x speedup, test set 0.874x speedup, val set 0.477x speedup, step: 1
Epoch 133/200 |loss: 8.425334| train set 1.810x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 2
Epoch 134/200 |loss: 8.927759| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 3
Epoch 135/200 |loss: 8.307703| train set 1.810x speedup, test set 1.041x speedup, val set 0.296x speedup, step: 4
Epoch 136/200 |loss: 8.140796| train set 1.810x speedup, test set 1.041x speedup, val set 0.296x speedup, step: 5
Epoch 137/200 |loss: 8.157145| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 6
Epoch 138/200 |loss: 6.906891| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 7
Epoch 139/200 |loss: 7.185842| train set 1.696x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 8
Epoch 140/200 |loss: 6.891702| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 9
Epoch 141/200 |loss: 10.583936| train set 1.776x speedup, test set 0.896x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.911630| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.403344| train set 1.696x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.661804| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.525364| train set 1.757x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.248003| train set 1.757x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.832857| train set 1.757x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.112538| train set 1.776x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 8.930169| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.551914| train set 1.810x speedup, test set 0.894x speedup, val set 0.437x speedup, step: 10
Epoch 151/200 |loss: 9.531969| train set 1.810x speedup, test set 0.898x speedup, val set 0.416x speedup, step: 11
Epoch 152/200 |loss: 7.530652| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.399509| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.693616| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 7.759096| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.496519| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.775406| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 9.807638| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.787179| train set 1.810x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 7.969440| train set 1.810x speedup, test set 1.032x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 10.139081| train set 1.810x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 10.550976| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 8.061480| train set 1.776x speedup, test set 0.886x speedup, val set 0.437x speedup, step: 23
Epoch 164/200 |loss: 8.779176| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 8.184640| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 9.136184| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 26
Epoch 167/200 |loss: 8.053419| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 27
Epoch 168/200 |loss: 7.891532| train set 1.791x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 28
Epoch 169/200 |loss: 8.802119| train set 1.791x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 29
Epoch 170/200 |loss: 9.309268| train set 1.757x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 30
Epoch 171/200 |loss: 7.874820| train set 1.758x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 31
Epoch 172/200 |loss: 8.700537| train set 1.758x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 32
Epoch 173/200 |loss: 7.867788| train set 1.791x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 33
Epoch 174/200 |loss: 8.153628| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 34
Epoch 175/200 |loss: 8.497699| train set 1.775x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 35
Epoch 176/200 |loss: 9.730601| train set 1.776x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 36
Epoch 177/200 |loss: 8.148817| train set 1.791x speedup, test set 1.069x speedup, val set 0.296x speedup, step: 37
Epoch 178/200 |loss: 8.211825| train set 1.790x speedup, test set 1.073x speedup, val set 0.296x speedup, step: 38
Epoch 179/200 |loss: 8.587520| train set 1.790x speedup, test set 0.903x speedup, val set 0.477x speedup, step: 1
Epoch 180/200 |loss: 9.280212| train set 1.791x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 2
Epoch 181/200 |loss: 8.871615| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 3
Epoch 182/200 |loss: 9.104029| train set 1.810x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 4
Epoch 183/200 |loss: 8.857274| train set 1.810x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 5
Epoch 184/200 |loss: 7.638463| train set 1.810x speedup, test set 1.046x speedup, val set 0.477x speedup, step: 1
Epoch 185/200 |loss: 7.583939| train set 1.776x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 2
Epoch 186/200 |loss: 9.389246| train set 1.680x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 3
Epoch 187/200 |loss: 9.787637| train set 1.680x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 4
Epoch 188/200 |loss: 7.122560| train set 1.810x speedup, test set 1.014x speedup, val set 0.296x speedup, step: 5
Epoch 189/200 |loss: 8.743696| train set 1.810x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 6
Epoch 190/200 |loss: 7.838808| train set 1.810x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 7
Epoch 191/200 |loss: 8.074574| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 8
Epoch 192/200 |loss: 10.091263| train set 1.776x speedup, test set 1.078x speedup, val set 0.296x speedup, step: 9
Epoch 193/200 |loss: 8.338867| train set 1.776x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 10
Epoch 194/200 |loss: 9.150885| train set 1.776x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 11
Epoch 195/200 |loss: 9.730969| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 12
Epoch 196/200 |loss: 8.257287| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 13
Epoch 197/200 |loss: 8.225727| train set 1.791x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 14
Epoch 198/200 |loss: 8.823191| train set 1.791x speedup, test set 1.059x speedup, val set 0.296x speedup, step: 15
Epoch 199/200 |loss: 8.447373| train set 1.791x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 16
Training per epoch cost 0.308 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 7.027s, pg runtime 5.879s, speedup 0.837x
08, opt runtime 1.737s, model runtime 7.022s, pg runtime 5.994s, speedup 0.854x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.685s, pg runtime 10.685s, speedup 1.000x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
19, opt runtime 0.379s, model runtime 3.515s, pg runtime 3.645s, speedup 1.037x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 1.810, test speedup 0.842, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 184, train speedup 1.810, test speedup 1.046, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 0.889, val speedup 0.296
execution cost 0:02:36.490593
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.043870, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406746| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027813| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935484| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.433886| train set 1.200x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.469719| train set 1.142x speedup, test set 0.877x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.159600| train set 1.306x speedup, test set 0.898x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.976252| train set 1.383x speedup, test set 1.325x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.316822| train set 1.225x speedup, test set 0.991x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.719491| train set 1.417x speedup, test set 0.748x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.423558| train set 1.478x speedup, test set 0.893x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 15.045389| train set 1.311x speedup, test set 0.854x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.222705| train set 1.417x speedup, test set 0.826x speedup, val set 1.000x speedup, step: 13
Epoch 13/200 |loss: 11.263649| train set 1.417x speedup, test set 0.828x speedup, val set 1.000x speedup, step: 14
Epoch 14/200 |loss: 13.450989| train set 1.550x speedup, test set 0.820x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 13.118454| train set 1.620x speedup, test set 0.851x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.595325| train set 1.663x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.626560| train set 1.551x speedup, test set 0.834x speedup, val set 0.437x speedup, step: 18
Epoch 18/200 |loss: 11.633955| train set 1.660x speedup, test set 0.886x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.704091| train set 1.791x speedup, test set 0.894x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.581225| train set 1.747x speedup, test set 0.823x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 12.092854| train set 1.810x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.913977| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.661014| train set 1.664x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 12.141722| train set 1.810x speedup, test set 0.838x speedup, val set 0.275x speedup, step: 25
Epoch 25/200 |loss: 9.331483| train set 1.766x speedup, test set 0.878x speedup, val set 0.513x speedup, step: 26
Epoch 26/200 |loss: 11.072762| train set 1.810x speedup, test set 0.839x speedup, val set 0.450x speedup, step: 27
Epoch 27/200 |loss: 11.938467| train set 1.790x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.722693| train set 1.791x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.926184| train set 1.765x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.681495| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.939562| train set 1.791x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.876740| train set 1.790x speedup, test set 0.840x speedup, val set 0.275x speedup, step: 33
Epoch 33/200 |loss: 8.209492| train set 1.790x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.164424| train set 1.790x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.188856| train set 1.690x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.885624| train set 1.790x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.445672| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.190569| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.903726| train set 1.810x speedup, test set 0.884x speedup, val set 0.426x speedup, step: 40
Epoch 40/200 |loss: 8.801129| train set 1.680x speedup, test set 0.835x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.399350| train set 1.776x speedup, test set 0.986x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.541309| train set 1.757x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.559942| train set 1.791x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.199843| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.233263| train set 1.711x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 9.809003| train set 1.711x speedup, test set 0.828x speedup, val set 0.477x speedup, step: 47
Epoch 47/200 |loss: 9.414993| train set 1.810x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.426489| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.068021| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.781628| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.568937| train set 1.791x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.975141| train set 1.770x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.350664| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 10.165244| train set 1.666x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.352301| train set 1.776x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.527234| train set 1.791x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 10.052763| train set 1.791x speedup, test set 0.853x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.192717| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.813186| train set 1.810x speedup, test set 0.846x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.397438| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 10.175632| train set 1.791x speedup, test set 1.083x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.453791| train set 1.758x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.718686| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.342185| train set 1.790x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.172286| train set 1.810x speedup, test set 1.015x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.514400| train set 1.765x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 9.324144| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.464687| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.838782| train set 1.696x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.377474| train set 1.791x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.181695| train set 1.790x speedup, test set 1.016x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.634653| train set 1.765x speedup, test set 0.987x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.839372| train set 1.810x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.295923| train set 1.810x speedup, test set 0.859x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.356255| train set 1.680x speedup, test set 0.984x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.198362| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.978528| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.425257| train set 1.810x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.540716| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.146856| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.701350| train set 1.810x speedup, test set 0.855x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.275542| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 8.013547| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.511863| train set 1.810x speedup, test set 0.895x speedup, val set 0.477x speedup, step: 85
Epoch 85/200 |loss: 9.197781| train set 1.696x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.432820| train set 1.696x speedup, test set 1.036x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.839326| train set 1.810x speedup, test set 0.895x speedup, val set 0.477x speedup, step: 88
Epoch 88/200 |loss: 7.354813| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 8.954605| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.868569| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.059020| train set 1.810x speedup, test set 0.892x speedup, val set 0.477x speedup, step: 92
Epoch 92/200 |loss: 7.808521| train set 1.810x speedup, test set 0.892x speedup, val set 0.477x speedup, step: 93
Epoch 93/200 |loss: 9.966732| train set 1.810x speedup, test set 0.892x speedup, val set 0.477x speedup, step: 94
Epoch 94/200 |loss: 8.105750| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.410242| train set 1.791x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.452034| train set 1.790x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.627388| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.264952| train set 1.791x speedup, test set 1.040x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.604260| train set 1.810x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.771524| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 8.682206| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.253987| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.571393| train set 1.810x speedup, test set 0.888x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.056723| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.269500| train set 1.651x speedup, test set 1.065x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.316327| train set 1.776x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.210849| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 9.813168| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.517541| train set 1.696x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.429938| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.578790| train set 1.810x speedup, test set 0.886x speedup, val set 0.477x speedup, step: 1
Epoch 112/200 |loss: 8.141778| train set 1.810x speedup, test set 0.896x speedup, val set 0.477x speedup, step: 1
Epoch 113/200 |loss: 9.824307| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 2
Epoch 114/200 |loss: 8.923204| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 3
Epoch 115/200 |loss: 8.732183| train set 1.791x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 4
Epoch 116/200 |loss: 8.518058| train set 1.791x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 5
Epoch 117/200 |loss: 10.640227| train set 1.810x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 6
Epoch 118/200 |loss: 8.400094| train set 1.810x speedup, test set 0.906x speedup, val set 0.296x speedup, step: 7
Epoch 119/200 |loss: 8.275701| train set 1.810x speedup, test set 0.906x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.105928| train set 1.810x speedup, test set 0.906x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.142962| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 2
Epoch 122/200 |loss: 9.276954| train set 1.791x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 3
Epoch 123/200 |loss: 8.996462| train set 1.791x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 4
Epoch 124/200 |loss: 8.731884| train set 1.757x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 5
Epoch 125/200 |loss: 8.858187| train set 1.790x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 6
Epoch 126/200 |loss: 8.123932| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 7
Epoch 127/200 |loss: 7.853743| train set 1.776x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 8
Epoch 128/200 |loss: 8.964359| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 9
Epoch 129/200 |loss: 8.260322| train set 1.810x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 10
Epoch 130/200 |loss: 8.676015| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 11
Epoch 131/200 |loss: 8.687852| train set 1.791x speedup, test set 0.888x speedup, val set 0.477x speedup, step: 1
Epoch 132/200 |loss: 8.163620| train set 1.791x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 2
Epoch 133/200 |loss: 8.032222| train set 1.791x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 3
Epoch 134/200 |loss: 8.651020| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 4
Epoch 135/200 |loss: 8.193221| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 5
Epoch 136/200 |loss: 8.064885| train set 1.810x speedup, test set 1.067x speedup, val set 0.296x speedup, step: 6
Epoch 137/200 |loss: 7.997894| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 7
Epoch 138/200 |loss: 7.040296| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 8
Epoch 139/200 |loss: 7.197204| train set 1.810x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 9
Epoch 140/200 |loss: 7.070099| train set 1.791x speedup, test set 1.061x speedup, val set 0.477x speedup, step: 1
Epoch 141/200 |loss: 10.714753| train set 1.791x speedup, test set 0.902x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.457501| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 9.004563| train set 1.791x speedup, test set 0.902x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.480289| train set 1.790x speedup, test set 1.079x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 10.481888| train set 1.757x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.309685| train set 1.775x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 10.621929| train set 1.757x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 7.565682| train set 1.790x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 10.372460| train set 1.790x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 9.396499| train set 1.776x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 10.302466| train set 1.776x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 8.126184| train set 1.776x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.937206| train set 1.810x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 9.204375| train set 1.810x speedup, test set 1.051x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 8.312017| train set 1.810x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.918986| train set 1.810x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.812931| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 10.204916| train set 1.810x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.368202| train set 1.810x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 7.418174| train set 1.810x speedup, test set 1.091x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 9.002620| train set 1.810x speedup, test set 1.061x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 10.046036| train set 1.810x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 7.514952| train set 1.810x speedup, test set 1.070x speedup, val set 0.296x speedup, step: 23
Epoch 164/200 |loss: 8.237261| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 7.764637| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 8.980430| train set 1.810x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 26
Epoch 167/200 |loss: 8.192948| train set 1.810x speedup, test set 1.081x speedup, val set 0.296x speedup, step: 27
Epoch 168/200 |loss: 7.717549| train set 1.790x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 28
Epoch 169/200 |loss: 8.506768| train set 1.757x speedup, test set 1.080x speedup, val set 0.296x speedup, step: 29
Epoch 170/200 |loss: 9.386649| train set 1.757x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 30
Epoch 171/200 |loss: 7.933927| train set 1.791x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 31
Epoch 172/200 |loss: 8.828514| train set 1.791x speedup, test set 1.054x speedup, val set 0.296x speedup, step: 32
Epoch 173/200 |loss: 7.955237| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 33
Epoch 174/200 |loss: 7.906069| train set 1.775x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 34
Epoch 175/200 |loss: 8.592037| train set 1.775x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 35
Epoch 176/200 |loss: 9.236670| train set 1.810x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 36
Epoch 177/200 |loss: 8.087238| train set 1.791x speedup, test set 1.071x speedup, val set 0.296x speedup, step: 37
Epoch 178/200 |loss: 8.045946| train set 1.791x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 38
Epoch 179/200 |loss: 8.278985| train set 1.757x speedup, test set 0.886x speedup, val set 0.360x speedup, step: 39
Epoch 180/200 |loss: 9.211045| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 40
Epoch 181/200 |loss: 8.737832| train set 1.791x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 41
Epoch 182/200 |loss: 8.603045| train set 1.791x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 42
Epoch 183/200 |loss: 8.699441| train set 1.791x speedup, test set 0.898x speedup, val set 0.477x speedup, step: 1
Epoch 184/200 |loss: 7.440358| train set 1.791x speedup, test set 1.071x speedup, val set 0.477x speedup, step: 1
Epoch 185/200 |loss: 7.378905| train set 1.810x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 2
Epoch 186/200 |loss: 9.341186| train set 1.810x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 3
Epoch 187/200 |loss: 9.568454| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 4
Epoch 188/200 |loss: 6.886861| train set 1.810x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 5
Epoch 189/200 |loss: 9.034267| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 6
Epoch 190/200 |loss: 7.735332| train set 1.810x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 7
Epoch 191/200 |loss: 8.111521| train set 1.776x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 8
Epoch 192/200 |loss: 10.224102| train set 1.776x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 9
Epoch 193/200 |loss: 8.487315| train set 1.757x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 10
Epoch 194/200 |loss: 9.416049| train set 1.810x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 11
Epoch 195/200 |loss: 9.762518| train set 1.776x speedup, test set 0.905x speedup, val set 0.296x speedup, step: 12
Epoch 196/200 |loss: 8.428899| train set 1.776x speedup, test set 0.903x speedup, val set 0.296x speedup, step: 13
Epoch 197/200 |loss: 8.500194| train set 1.791x speedup, test set 0.904x speedup, val set 0.296x speedup, step: 14
Epoch 198/200 |loss: 8.660104| train set 1.791x speedup, test set 0.765x speedup, val set 0.296x speedup, step: 15
Epoch 199/200 |loss: 8.540081| train set 1.810x speedup, test set 0.765x speedup, val set 0.296x speedup, step: 16
Training per epoch cost 0.310 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 4.443s, pg runtime 13.945s, speedup 3.139x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.558s, pg runtime 2.558s, speedup 1.000x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 1.810, test speedup 0.828, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 184, train speedup 1.791, test speedup 1.071, val speedup 0.477
last model at epoch 199, train speedup 1.810, test speedup 0.765, val speedup 0.296
execution cost 0:02:35.698251
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.914609, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406720| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027794| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935148| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438725| train set 1.142x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.476390| train set 1.306x speedup, test set 0.889x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.148701| train set 1.306x speedup, test set 0.884x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.983321| train set 1.383x speedup, test set 0.851x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.271218| train set 1.225x speedup, test set 0.991x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.693680| train set 1.417x speedup, test set 0.858x speedup, val set 0.426x speedup, step: 10
Epoch 10/200 |loss: 13.387538| train set 1.475x speedup, test set 0.894x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 15.000839| train set 1.367x speedup, test set 0.859x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.189432| train set 1.367x speedup, test set 0.828x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.248424| train set 1.435x speedup, test set 1.231x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.345009| train set 1.550x speedup, test set 0.821x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.912819| train set 1.620x speedup, test set 0.832x speedup, val set 1.000x speedup, step: 16
Epoch 16/200 |loss: 12.414865| train set 1.663x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.448246| train set 1.550x speedup, test set 0.850x speedup, val set 0.437x speedup, step: 18
Epoch 18/200 |loss: 11.247317| train set 1.790x speedup, test set 0.899x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.685351| train set 1.790x speedup, test set 0.837x speedup, val set 1.510x speedup, step: 20
Epoch 20/200 |loss: 12.437665| train set 1.790x speedup, test set 0.822x speedup, val set 0.513x speedup, step: 21
Epoch 21/200 |loss: 11.831526| train set 1.810x speedup, test set 0.832x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.602566| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.006945| train set 1.790x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 11.849837| train set 1.762x speedup, test set 0.885x speedup, val set 0.438x speedup, step: 25
Epoch 25/200 |loss: 9.737816| train set 1.810x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.835117| train set 1.486x speedup, test set 0.885x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 11.899609| train set 1.663x speedup, test set 0.838x speedup, val set 0.450x speedup, step: 28
Epoch 28/200 |loss: 10.726511| train set 1.790x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.944461| train set 1.766x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 30
Epoch 30/200 |loss: 11.574789| train set 1.791x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 10.007856| train set 1.791x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.688547| train set 1.791x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.313902| train set 1.790x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.304011| train set 1.810x speedup, test set 0.860x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.033957| train set 1.810x speedup, test set 0.843x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.868100| train set 1.810x speedup, test set 0.864x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.420417| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.086328| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 9.001359| train set 1.734x speedup, test set 0.897x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.641661| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.555931| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.388627| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.630347| train set 1.791x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.199451| train set 1.791x speedup, test set 0.839x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.164864| train set 1.810x speedup, test set 0.881x speedup, val set 0.275x speedup, step: 46
Epoch 46/200 |loss: 10.823171| train set 1.711x speedup, test set 0.838x speedup, val set 0.426x speedup, step: 47
Epoch 47/200 |loss: 9.554261| train set 1.680x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.745177| train set 1.766x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.200616| train set 1.766x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 9.045688| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.961499| train set 1.679x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.570715| train set 1.757x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.383442| train set 1.776x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.619389| train set 1.696x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.442288| train set 1.776x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.093208| train set 1.734x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.726999| train set 1.790x speedup, test set 0.848x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.123760| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.598878| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.540481| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.691210| train set 1.791x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.255904| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.724046| train set 1.757x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.652077| train set 1.791x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.107809| train set 1.810x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.481778| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 9.014108| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.643523| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.696817| train set 1.696x speedup, test set 0.858x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.262728| train set 1.791x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.154674| train set 1.791x speedup, test set 0.830x speedup, val set 0.477x speedup, step: 72
Epoch 72/200 |loss: 9.674570| train set 1.766x speedup, test set 0.830x speedup, val set 0.477x speedup, step: 73
Epoch 73/200 |loss: 7.833908| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.140769| train set 1.810x speedup, test set 0.830x speedup, val set 0.477x speedup, step: 75
Epoch 75/200 |loss: 8.564745| train set 1.696x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.162167| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.993777| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.301889| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.711161| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.283420| train set 1.808x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.491689| train set 1.810x speedup, test set 0.886x speedup, val set 0.477x speedup, step: 82
Epoch 82/200 |loss: 9.109932| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.950419| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.380951| train set 1.761x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.104378| train set 1.696x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.171368| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.871706| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.293958| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.065657| train set 1.791x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.573210| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.080984| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.852748| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.455832| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.351262| train set 1.791x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.594361| train set 1.664x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 10.032096| train set 1.757x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.091860| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.578050| train set 1.791x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.999764| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.929381| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.455883| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.271957| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.454375| train set 1.810x speedup, test set 0.884x speedup, val set 0.477x speedup, step: 1
Epoch 104/200 |loss: 9.110461| train set 1.810x speedup, test set 0.886x speedup, val set 0.477x speedup, step: 1
Epoch 105/200 |loss: 8.603129| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 2
Epoch 106/200 |loss: 9.495085| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 3
Epoch 107/200 |loss: 10.517925| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 4
Epoch 108/200 |loss: 9.990125| train set 1.776x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 5
Epoch 109/200 |loss: 8.638989| train set 1.776x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 6
Epoch 110/200 |loss: 9.346141| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 7
Epoch 111/200 |loss: 8.919681| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 8
Epoch 112/200 |loss: 7.905328| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 9
Epoch 113/200 |loss: 9.822028| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 10
Epoch 114/200 |loss: 8.969548| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 11
Epoch 115/200 |loss: 8.361336| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 12
Epoch 116/200 |loss: 8.025468| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 13
Epoch 117/200 |loss: 10.902548| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 14
Epoch 118/200 |loss: 8.322211| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 15
Epoch 119/200 |loss: 8.338369| train set 1.810x speedup, test set 0.888x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.118000| train set 1.776x speedup, test set 0.889x speedup, val set 0.477x speedup, step: 1
Epoch 121/200 |loss: 9.413822| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 2
Epoch 122/200 |loss: 9.379023| train set 1.679x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 3
Epoch 123/200 |loss: 9.027824| train set 1.791x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 4
Epoch 124/200 |loss: 8.741067| train set 1.757x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 5
Epoch 125/200 |loss: 8.893825| train set 1.810x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 6
Epoch 126/200 |loss: 8.257133| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 7
Epoch 127/200 |loss: 7.687019| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 8
Epoch 128/200 |loss: 8.889247| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 9
Epoch 129/200 |loss: 8.333715| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 10
Epoch 130/200 |loss: 8.640469| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 11
Epoch 131/200 |loss: 8.778736| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 12
Epoch 132/200 |loss: 8.013550| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 13
Epoch 133/200 |loss: 8.378968| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 14
Epoch 134/200 |loss: 8.936348| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 15
Epoch 135/200 |loss: 8.339341| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 16
Epoch 136/200 |loss: 7.883495| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 17
Epoch 137/200 |loss: 8.336728| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 18
Epoch 138/200 |loss: 7.167212| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 19
Epoch 139/200 |loss: 7.209553| train set 1.810x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 20
Epoch 140/200 |loss: 6.865857| train set 1.791x speedup, test set 0.853x speedup, val set 0.296x speedup, step: 21
Epoch 141/200 |loss: 10.500129| train set 1.776x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 22
Epoch 142/200 |loss: 7.950050| train set 1.776x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 23
Epoch 143/200 |loss: 8.458292| train set 1.790x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 24
Epoch 144/200 |loss: 9.481952| train set 1.790x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 25
Epoch 145/200 |loss: 9.786191| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 26
Epoch 146/200 |loss: 7.270334| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 27
Epoch 147/200 |loss: 9.650608| train set 1.757x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 28
Epoch 148/200 |loss: 7.122203| train set 1.790x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 29
Epoch 149/200 |loss: 9.319467| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 30
Epoch 150/200 |loss: 8.692363| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 31
Epoch 151/200 |loss: 9.069068| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 32
Epoch 152/200 |loss: 7.857589| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 33
Epoch 153/200 |loss: 7.394833| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 34
Epoch 154/200 |loss: 8.600512| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 35
Epoch 155/200 |loss: 7.814267| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 36
Epoch 156/200 |loss: 7.391897| train set 1.810x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 37
Epoch 157/200 |loss: 7.763723| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 38
Epoch 158/200 |loss: 9.876785| train set 1.776x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 39
Epoch 159/200 |loss: 9.150783| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 40
Epoch 160/200 |loss: 7.541558| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 41
Epoch 161/200 |loss: 9.098539| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 42
Epoch 162/200 |loss: 9.686541| train set 1.810x speedup, test set 0.893x speedup, val set 0.296x speedup, step: 43
Epoch 163/200 |loss: 7.374604| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 44
Epoch 164/200 |loss: 8.417965| train set 1.810x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 45
Epoch 165/200 |loss: 7.658878| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 46
Epoch 166/200 |loss: 9.003919| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 47
Epoch 167/200 |loss: 8.394274| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 48
Epoch 168/200 |loss: 7.808512| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 49
Epoch 169/200 |loss: 8.606356| train set 1.757x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 50
Epoch 170/200 |loss: 9.532523| train set 1.757x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 51
Epoch 171/200 |loss: 7.793401| train set 1.791x speedup, test set 0.894x speedup, val set 0.296x speedup, step: 52
Epoch 172/200 |loss: 8.779820| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 53
Epoch 173/200 |loss: 7.875218| train set 1.757x speedup, test set 0.891x speedup, val set 0.450x speedup, step: 54
Epoch 174/200 |loss: 8.063516| train set 1.775x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 55
Epoch 175/200 |loss: 8.804527| train set 1.774x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 56
Epoch 176/200 |loss: 9.119617| train set 1.810x speedup, test set 0.860x speedup, val set 0.296x speedup, step: 57
Epoch 177/200 |loss: 8.207772| train set 1.790x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 58
Epoch 178/200 |loss: 7.900996| train set 1.776x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 59
Epoch 179/200 |loss: 8.523480| train set 1.757x speedup, test set 0.893x speedup, val set 0.477x speedup, step: 1
Epoch 180/200 |loss: 9.042314| train set 1.791x speedup, test set 0.863x speedup, val set 0.296x speedup, step: 2
Epoch 181/200 |loss: 9.005795| train set 1.791x speedup, test set 0.859x speedup, val set 0.296x speedup, step: 3
Epoch 182/200 |loss: 8.947697| train set 1.758x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 4
Epoch 183/200 |loss: 9.017421| train set 1.791x speedup, test set 0.867x speedup, val set 0.477x speedup, step: 1
Epoch 184/200 |loss: 7.601676| train set 1.791x speedup, test set 0.850x speedup, val set 0.477x speedup, step: 1
Epoch 185/200 |loss: 7.727252| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 2
Epoch 186/200 |loss: 9.858654| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 3
Epoch 187/200 |loss: 9.750788| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 4
Epoch 188/200 |loss: 7.206349| train set 1.810x speedup, test set 0.851x speedup, val set 0.296x speedup, step: 5
Epoch 189/200 |loss: 9.173222| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 6
Epoch 190/200 |loss: 7.871080| train set 1.776x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 7
Epoch 191/200 |loss: 8.503530| train set 1.776x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 8
Epoch 192/200 |loss: 10.325208| train set 1.776x speedup, test set 0.880x speedup, val set 0.477x speedup, step: 1
Epoch 193/200 |loss: 8.639171| train set 1.776x speedup, test set 0.880x speedup, val set 0.457x speedup, step: 2
Epoch 194/200 |loss: 9.427944| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 3
Epoch 195/200 |loss: 9.693271| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 4
Epoch 196/200 |loss: 8.402511| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 5
Epoch 197/200 |loss: 8.217849| train set 1.791x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 6
Epoch 198/200 |loss: 8.822850| train set 1.791x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 7
Epoch 199/200 |loss: 8.466070| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 8
Training per epoch cost 0.307 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
07, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
08, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 11.471s, pg runtime 10.685s, speedup 0.931x
14, opt runtime 0.157s, model runtime 0.398s, pg runtime 0.393s, speedup 0.987x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
19, opt runtime 0.379s, model runtime 3.515s, pg runtime 3.645s, speedup 1.037x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 65, train speedup 1.810, test speedup 0.870, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 192, train speedup 1.776, test speedup 0.880, val speedup 0.477
last model at epoch 199, train speedup 1.810, test speedup 0.890, val speedup 0.296
execution cost 0:02:35.691882
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.916733, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406744| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027809| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935594| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.433537| train set 1.200x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.469997| train set 1.142x speedup, test set 0.877x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.160742| train set 1.306x speedup, test set 0.898x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.968453| train set 1.383x speedup, test set 1.344x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.307711| train set 1.295x speedup, test set 1.004x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.708875| train set 1.417x speedup, test set 0.741x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 13.367713| train set 1.418x speedup, test set 0.892x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.998731| train set 1.335x speedup, test set 0.848x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.168982| train set 1.417x speedup, test set 0.826x speedup, val set 1.000x speedup, step: 13
Epoch 13/200 |loss: 11.246684| train set 1.417x speedup, test set 0.820x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.487071| train set 1.550x speedup, test set 0.821x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 13.091995| train set 1.620x speedup, test set 0.831x speedup, val set 0.437x speedup, step: 16
Epoch 16/200 |loss: 12.738313| train set 1.550x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 17
Epoch 17/200 |loss: 10.555974| train set 1.550x speedup, test set 0.831x speedup, val set 0.437x speedup, step: 18
Epoch 18/200 |loss: 11.678552| train set 1.550x speedup, test set 0.888x speedup, val set 0.437x speedup, step: 19
Epoch 19/200 |loss: 11.810128| train set 1.747x speedup, test set 0.884x speedup, val set 0.437x speedup, step: 20
Epoch 20/200 |loss: 12.744300| train set 1.790x speedup, test set 0.822x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 12.007456| train set 1.810x speedup, test set 0.831x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.751847| train set 1.810x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.244317| train set 1.764x speedup, test set 0.977x speedup, val set 0.450x speedup, step: 24
Epoch 24/200 |loss: 12.516052| train set 1.696x speedup, test set 0.828x speedup, val set 0.275x speedup, step: 25
Epoch 25/200 |loss: 9.776646| train set 1.696x speedup, test set 0.829x speedup, val set 0.437x speedup, step: 26
Epoch 26/200 |loss: 11.054873| train set 1.765x speedup, test set 0.819x speedup, val set 0.477x speedup, step: 27
Epoch 27/200 |loss: 12.068200| train set 1.790x speedup, test set 0.818x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.806608| train set 1.790x speedup, test set 0.818x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.958315| train set 1.765x speedup, test set 0.856x speedup, val set 0.437x speedup, step: 30
Epoch 30/200 |loss: 11.486623| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.947291| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 32
Epoch 32/200 |loss: 9.987130| train set 1.790x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.266522| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.699969| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 11.100763| train set 1.810x speedup, test set 0.836x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 9.212196| train set 1.810x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.418144| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 10.327606| train set 1.657x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.890686| train set 1.766x speedup, test set 0.886x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.430064| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.456947| train set 1.791x speedup, test set 0.830x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 9.570715| train set 1.758x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 11.453428| train set 1.747x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 11.851735| train set 1.791x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.456825| train set 1.810x speedup, test set 0.821x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.308435| train set 1.810x speedup, test set 0.819x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.484591| train set 1.810x speedup, test set 0.818x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.744022| train set 1.776x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 8.907707| train set 1.810x speedup, test set 0.829x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.672361| train set 1.810x speedup, test set 0.828x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 9.950876| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.475268| train set 1.734x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.474036| train set 1.810x speedup, test set 0.851x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.668944| train set 1.696x speedup, test set 0.855x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 9.095051| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.245621| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.711078| train set 1.791x speedup, test set 1.016x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.083452| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.696334| train set 1.810x speedup, test set 0.837x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.763704| train set 1.810x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.723699| train set 1.788x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.095085| train set 1.758x speedup, test set 0.826x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.636988| train set 1.757x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.614074| train set 1.810x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 7.083487| train set 1.810x speedup, test set 1.018x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.301394| train set 1.734x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.816207| train set 1.776x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.683638| train set 1.776x speedup, test set 0.895x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.881270| train set 1.696x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.103131| train set 1.810x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.161411| train set 1.791x speedup, test set 0.841x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.509478| train set 1.790x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.698413| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.579423| train set 1.810x speedup, test set 0.832x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.519932| train set 1.696x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.076202| train set 1.810x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.865631| train set 1.810x speedup, test set 0.834x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.421449| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.584070| train set 1.810x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.009269| train set 1.810x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.358525| train set 1.810x speedup, test set 0.870x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.115693| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.931478| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.291403| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 8.979249| train set 1.696x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.214974| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.920363| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.445581| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.107000| train set 1.791x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.863010| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.110778| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.919892| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.435009| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.332166| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.502532| train set 1.790x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.671158| train set 1.790x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 9.186050| train set 1.810x speedup, test set 0.869x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.395396| train set 1.791x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.970204| train set 1.810x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 9.110670| train set 1.776x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 9.403604| train set 1.810x speedup, test set 0.900x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.577606| train set 1.679x speedup, test set 0.862x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 10.527476| train set 1.728x speedup, test set 0.862x speedup, val set 0.450x speedup, step: 1
Epoch 104/200 |loss: 9.693093| train set 1.726x speedup, test set 0.825x speedup, val set 0.296x speedup, step: 2
Epoch 105/200 |loss: 8.715062| train set 1.810x speedup, test set 1.018x speedup, val set 0.296x speedup, step: 3
Epoch 106/200 |loss: 9.617668| train set 1.809x speedup, test set 1.042x speedup, val set 0.296x speedup, step: 4
Epoch 107/200 |loss: 10.665098| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 5
Epoch 108/200 |loss: 10.178880| train set 1.776x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 6
Epoch 109/200 |loss: 8.758176| train set 1.682x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 7
Epoch 110/200 |loss: 9.496615| train set 1.791x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 8
Epoch 111/200 |loss: 8.876142| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 9
Epoch 112/200 |loss: 8.185338| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 10
Epoch 113/200 |loss: 9.972419| train set 1.810x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 11
Epoch 114/200 |loss: 8.981160| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 12
Epoch 115/200 |loss: 8.674418| train set 1.810x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 13
Epoch 116/200 |loss: 8.152843| train set 1.791x speedup, test set 1.075x speedup, val set 0.296x speedup, step: 14
Epoch 117/200 |loss: 10.940322| train set 1.810x speedup, test set 1.085x speedup, val set 0.296x speedup, step: 15
Epoch 118/200 |loss: 8.336292| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 16
Epoch 119/200 |loss: 8.464734| train set 1.810x speedup, test set 0.887x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.125093| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 2
Epoch 121/200 |loss: 9.353846| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 3
Epoch 122/200 |loss: 9.540373| train set 1.790x speedup, test set 0.875x speedup, val set 0.296x speedup, step: 4
Epoch 123/200 |loss: 8.959808| train set 1.790x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 5
Epoch 124/200 |loss: 8.678146| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 6
Epoch 125/200 |loss: 8.707859| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 7
Epoch 126/200 |loss: 8.238060| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 8
Epoch 127/200 |loss: 7.684844| train set 1.810x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 9
Epoch 128/200 |loss: 9.016556| train set 1.776x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 10
Epoch 129/200 |loss: 8.681631| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 11
Epoch 130/200 |loss: 8.355558| train set 1.791x speedup, test set 1.046x speedup, val set 0.296x speedup, step: 12
Epoch 131/200 |loss: 8.956602| train set 1.791x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 13
Epoch 132/200 |loss: 8.158326| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 14
Epoch 133/200 |loss: 8.594069| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 15
Epoch 134/200 |loss: 9.065192| train set 1.810x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 16
Epoch 135/200 |loss: 8.025303| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 17
Epoch 136/200 |loss: 7.827085| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 18
Epoch 137/200 |loss: 7.909547| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 19
Epoch 138/200 |loss: 6.858878| train set 1.776x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 20
Epoch 139/200 |loss: 7.386843| train set 1.810x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 21
Epoch 140/200 |loss: 6.730175| train set 1.791x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 22
Epoch 141/200 |loss: 10.742600| train set 1.791x speedup, test set 0.887x speedup, val set 0.450x speedup, step: 23
Epoch 142/200 |loss: 8.486563| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 24
Epoch 143/200 |loss: 8.812081| train set 1.791x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 25
Epoch 144/200 |loss: 9.630318| train set 1.790x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 26
Epoch 145/200 |loss: 9.632889| train set 1.776x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 27
Epoch 146/200 |loss: 7.380055| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 28
Epoch 147/200 |loss: 9.532160| train set 1.790x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 29
Epoch 148/200 |loss: 7.208542| train set 1.790x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 30
Epoch 149/200 |loss: 9.093678| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 31
Epoch 150/200 |loss: 8.561433| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 32
Epoch 151/200 |loss: 9.480965| train set 1.776x speedup, test set 0.896x speedup, val set 0.296x speedup, step: 33
Epoch 152/200 |loss: 7.562098| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 34
Epoch 153/200 |loss: 7.480526| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 35
Epoch 154/200 |loss: 8.716588| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 36
Epoch 155/200 |loss: 7.835948| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 37
Epoch 156/200 |loss: 7.509130| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 38
Epoch 157/200 |loss: 7.823643| train set 1.791x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 39
Epoch 158/200 |loss: 9.936331| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 40
Epoch 159/200 |loss: 9.688059| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 41
Epoch 160/200 |loss: 7.435881| train set 1.810x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 42
Epoch 161/200 |loss: 9.477232| train set 1.810x speedup, test set 1.076x speedup, val set 0.296x speedup, step: 43
Epoch 162/200 |loss: 10.328890| train set 1.810x speedup, test set 0.892x speedup, val set 0.296x speedup, step: 44
Epoch 163/200 |loss: 7.688339| train set 1.776x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 45
Epoch 164/200 |loss: 8.558250| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 46
Epoch 165/200 |loss: 7.794189| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 47
Epoch 166/200 |loss: 9.059298| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 48
Epoch 167/200 |loss: 7.758254| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 49
Epoch 168/200 |loss: 7.660922| train set 1.757x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 50
Epoch 169/200 |loss: 8.518550| train set 1.757x speedup, test set 0.867x speedup, val set 0.296x speedup, step: 51
Epoch 170/200 |loss: 9.420205| train set 1.757x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 52
Epoch 171/200 |loss: 7.743605| train set 1.757x speedup, test set 0.871x speedup, val set 0.296x speedup, step: 53
Epoch 172/200 |loss: 8.731351| train set 1.791x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 54
Epoch 173/200 |loss: 7.739086| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 55
Epoch 174/200 |loss: 8.037605| train set 1.776x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 56
Epoch 175/200 |loss: 8.655066| train set 1.775x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 57
Epoch 176/200 |loss: 9.440155| train set 1.810x speedup, test set 0.909x speedup, val set 0.296x speedup, step: 58
Epoch 177/200 |loss: 7.900045| train set 1.791x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 59
Epoch 178/200 |loss: 8.073266| train set 1.791x speedup, test set 0.899x speedup, val set 0.296x speedup, step: 60
Epoch 179/200 |loss: 8.390498| train set 1.757x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 61
Epoch 180/200 |loss: 9.074733| train set 1.758x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 62
Epoch 181/200 |loss: 8.715451| train set 1.791x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 63
Epoch 182/200 |loss: 8.594789| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 64
Epoch 183/200 |loss: 8.590361| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 65
Epoch 184/200 |loss: 7.294303| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 66
Epoch 185/200 |loss: 7.215062| train set 1.810x speedup, test set 0.898x speedup, val set 0.296x speedup, step: 67
Epoch 186/200 |loss: 9.334754| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 68
Epoch 187/200 |loss: 9.464327| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 69
Epoch 188/200 |loss: 6.985985| train set 1.810x speedup, test set 0.901x speedup, val set 0.296x speedup, step: 70
Epoch 189/200 |loss: 8.926615| train set 1.810x speedup, test set 0.897x speedup, val set 0.296x speedup, step: 71
Epoch 190/200 |loss: 7.678520| train set 1.810x speedup, test set 0.908x speedup, val set 0.296x speedup, step: 72
Epoch 191/200 |loss: 8.177168| train set 1.776x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 73
Epoch 192/200 |loss: 10.174911| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 74
Epoch 193/200 |loss: 8.482515| train set 1.757x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 75
Epoch 194/200 |loss: 9.651559| train set 1.776x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 76
Epoch 195/200 |loss: 9.707811| train set 1.776x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 77
Epoch 196/200 |loss: 8.390286| train set 1.776x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 78
Epoch 197/200 |loss: 8.297706| train set 1.791x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 79
Epoch 198/200 |loss: 8.800474| train set 1.791x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 80
Epoch 199/200 |loss: 8.451411| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 81
Training per epoch cost 0.307 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
06, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
07, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
08, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.176s, pg runtime 0.393s, speedup 2.231x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 8.490s, pg runtime 4.730s, speedup 0.557x
19, opt runtime 0.379s, model runtime 0.739s, pg runtime 3.645s, speedup 4.936x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 88, train speedup 1.810, test speedup 0.889, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 119, train speedup 1.810, test speedup 0.887, val speedup 0.477
last model at epoch 199, train speedup 1.810, test speedup 0.891, val speedup 0.296
execution cost 0:02:35.504629
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['7', '28', '31', '16', '19', '17', '20']
test queries:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
test query:  ['16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '19a.sql' '19d.sql' '19c.sql' '19b.sql'
 '20b.sql' '20a.sql' '20c.sql' '28c.sql' '28b.sql' '28a.sql' '31b.sql'
 '31a.sql' '31c.sql' '7b.sql' '7c.sql' '7a.sql']
load JOB succ
load TPCH...
TPCH test template [17, 20, 3, 9]
load TPCH succ
load TPCH_Skew...
TPCH test template [17, 20, 3, 9]
load TPCH Skew succ
train, test, validation (140, 49) (26, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.913691, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 21.758492| train set 1.013x speedup, test set 1.613x speedup, val set 0.355x speedup, step: 1
Epoch 1/200 |loss: 20.406727| train set 1.013x speedup, test set 1.032x speedup, val set 0.580x speedup, step: 2
Epoch 2/200 |loss: 19.027803| train set 0.882x speedup, test set 1.011x speedup, val set 0.719x speedup, step: 3
Epoch 3/200 |loss: 17.935160| train set 0.965x speedup, test set 0.878x speedup, val set 1.501x speedup, step: 4
Epoch 4/200 |loss: 20.438603| train set 1.142x speedup, test set 0.877x speedup, val set 1.501x speedup, step: 5
Epoch 5/200 |loss: 18.477461| train set 1.306x speedup, test set 0.889x speedup, val set 1.000x speedup, step: 6
Epoch 6/200 |loss: 15.149292| train set 1.306x speedup, test set 0.898x speedup, val set 1.000x speedup, step: 7
Epoch 7/200 |loss: 18.989529| train set 1.383x speedup, test set 0.861x speedup, val set 0.807x speedup, step: 8
Epoch 8/200 |loss: 16.247051| train set 1.225x speedup, test set 0.996x speedup, val set 0.807x speedup, step: 9
Epoch 9/200 |loss: 16.656696| train set 1.417x speedup, test set 0.861x speedup, val set 1.000x speedup, step: 10
Epoch 10/200 |loss: 13.362001| train set 1.423x speedup, test set 0.888x speedup, val set 1.000x speedup, step: 11
Epoch 11/200 |loss: 14.973285| train set 1.452x speedup, test set 0.887x speedup, val set 1.000x speedup, step: 12
Epoch 12/200 |loss: 14.133321| train set 1.367x speedup, test set 0.824x speedup, val set 0.437x speedup, step: 13
Epoch 13/200 |loss: 11.282294| train set 1.418x speedup, test set 1.231x speedup, val set 0.437x speedup, step: 14
Epoch 14/200 |loss: 13.299655| train set 1.550x speedup, test set 0.816x speedup, val set 1.000x speedup, step: 15
Epoch 15/200 |loss: 12.802355| train set 1.537x speedup, test set 0.821x speedup, val set 0.437x speedup, step: 16
Epoch 16/200 |loss: 12.345173| train set 1.663x speedup, test set 0.714x speedup, val set 0.275x speedup, step: 17
Epoch 17/200 |loss: 10.475121| train set 1.663x speedup, test set 0.822x speedup, val set 0.437x speedup, step: 18
Epoch 18/200 |loss: 11.311999| train set 1.791x speedup, test set 0.874x speedup, val set 0.296x speedup, step: 19
Epoch 19/200 |loss: 11.524177| train set 1.790x speedup, test set 0.842x speedup, val set 0.296x speedup, step: 20
Epoch 20/200 |loss: 12.257853| train set 1.810x speedup, test set 1.236x speedup, val set 0.275x speedup, step: 21
Epoch 21/200 |loss: 11.605402| train set 1.810x speedup, test set 0.839x speedup, val set 0.275x speedup, step: 22
Epoch 22/200 |loss: 11.343967| train set 1.810x speedup, test set 1.088x speedup, val set 0.296x speedup, step: 23
Epoch 23/200 |loss: 11.033941| train set 1.764x speedup, test set 0.717x speedup, val set 0.296x speedup, step: 24
Epoch 24/200 |loss: 11.911223| train set 1.762x speedup, test set 0.833x speedup, val set 0.437x speedup, step: 25
Epoch 25/200 |loss: 9.266737| train set 1.810x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 26
Epoch 26/200 |loss: 10.784969| train set 1.733x speedup, test set 0.851x speedup, val set 0.296x speedup, step: 27
Epoch 27/200 |loss: 11.887701| train set 1.790x speedup, test set 0.823x speedup, val set 0.296x speedup, step: 28
Epoch 28/200 |loss: 10.502911| train set 1.790x speedup, test set 0.823x speedup, val set 0.296x speedup, step: 29
Epoch 29/200 |loss: 9.745783| train set 1.734x speedup, test set 0.843x speedup, val set 0.437x speedup, step: 30
Epoch 30/200 |loss: 11.607229| train set 1.810x speedup, test set 0.840x speedup, val set 0.296x speedup, step: 31
Epoch 31/200 |loss: 9.685554| train set 1.791x speedup, test set 0.833x speedup, val set 0.450x speedup, step: 32
Epoch 32/200 |loss: 9.683503| train set 1.747x speedup, test set 0.866x speedup, val set 0.296x speedup, step: 33
Epoch 33/200 |loss: 8.291340| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 34
Epoch 34/200 |loss: 10.502965| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 35
Epoch 35/200 |loss: 10.932535| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 36
Epoch 36/200 |loss: 8.680981| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 37
Epoch 37/200 |loss: 9.540665| train set 1.791x speedup, test set 0.833x speedup, val set 0.296x speedup, step: 38
Epoch 38/200 |loss: 9.999955| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 39
Epoch 39/200 |loss: 8.553074| train set 1.776x speedup, test set 0.889x speedup, val set 0.275x speedup, step: 40
Epoch 40/200 |loss: 8.866077| train set 1.680x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 41
Epoch 41/200 |loss: 10.207992| train set 1.664x speedup, test set 1.088x speedup, val set 0.296x speedup, step: 42
Epoch 42/200 |loss: 10.130781| train set 1.791x speedup, test set 0.863x speedup, val set 0.296x speedup, step: 43
Epoch 43/200 |loss: 12.139079| train set 1.747x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 44
Epoch 44/200 |loss: 12.474771| train set 1.747x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 45
Epoch 45/200 |loss: 8.963929| train set 1.681x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 46
Epoch 46/200 |loss: 10.763789| train set 1.711x speedup, test set 0.853x speedup, val set 0.296x speedup, step: 47
Epoch 47/200 |loss: 9.756295| train set 1.810x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 48
Epoch 48/200 |loss: 9.581330| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 49
Epoch 49/200 |loss: 9.094535| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 50
Epoch 50/200 |loss: 8.333643| train set 1.791x speedup, test set 0.838x speedup, val set 0.296x speedup, step: 51
Epoch 51/200 |loss: 10.323061| train set 1.791x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 52
Epoch 52/200 |loss: 10.644731| train set 1.734x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 53
Epoch 53/200 |loss: 9.349193| train set 1.776x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 54
Epoch 54/200 |loss: 9.667760| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 55
Epoch 55/200 |loss: 8.939136| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 56
Epoch 56/200 |loss: 10.640353| train set 1.776x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 57
Epoch 57/200 |loss: 9.644176| train set 1.791x speedup, test set 1.016x speedup, val set 0.296x speedup, step: 58
Epoch 58/200 |loss: 8.046208| train set 1.810x speedup, test set 0.831x speedup, val set 0.296x speedup, step: 59
Epoch 59/200 |loss: 7.704168| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 60
Epoch 60/200 |loss: 9.808153| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 61
Epoch 61/200 |loss: 9.749311| train set 1.791x speedup, test set 1.025x speedup, val set 0.296x speedup, step: 62
Epoch 62/200 |loss: 10.580611| train set 1.757x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 63
Epoch 63/200 |loss: 8.761168| train set 1.757x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 64
Epoch 64/200 |loss: 9.904973| train set 1.664x speedup, test set 1.077x speedup, val set 0.296x speedup, step: 65
Epoch 65/200 |loss: 6.968054| train set 1.810x speedup, test set 1.147x speedup, val set 0.296x speedup, step: 66
Epoch 66/200 |loss: 9.728662| train set 1.766x speedup, test set 1.077x speedup, val set 0.296x speedup, step: 67
Epoch 67/200 |loss: 8.835557| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 68
Epoch 68/200 |loss: 8.980084| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 69
Epoch 69/200 |loss: 8.889868| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 70
Epoch 70/200 |loss: 9.399278| train set 1.791x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 71
Epoch 71/200 |loss: 9.325549| train set 1.791x speedup, test set 0.857x speedup, val set 0.296x speedup, step: 72
Epoch 72/200 |loss: 9.872888| train set 1.810x speedup, test set 0.848x speedup, val set 0.296x speedup, step: 73
Epoch 73/200 |loss: 7.756992| train set 1.810x speedup, test set 0.887x speedup, val set 0.296x speedup, step: 74
Epoch 74/200 |loss: 9.631054| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 75
Epoch 75/200 |loss: 8.617842| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 76
Epoch 76/200 |loss: 8.121747| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 77
Epoch 77/200 |loss: 7.849615| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 78
Epoch 78/200 |loss: 8.416172| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 79
Epoch 79/200 |loss: 9.609528| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 80
Epoch 80/200 |loss: 9.084490| train set 1.807x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 81
Epoch 81/200 |loss: 7.410995| train set 1.807x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 82
Epoch 82/200 |loss: 9.117197| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 83
Epoch 83/200 |loss: 7.892809| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 84
Epoch 84/200 |loss: 8.382691| train set 1.797x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 85
Epoch 85/200 |loss: 9.293034| train set 1.696x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 86
Epoch 86/200 |loss: 8.427582| train set 1.776x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 87
Epoch 87/200 |loss: 8.821171| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 88
Epoch 88/200 |loss: 7.376684| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 89
Epoch 89/200 |loss: 9.119759| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 90
Epoch 90/200 |loss: 8.478973| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 91
Epoch 91/200 |loss: 9.160726| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 92
Epoch 92/200 |loss: 7.774231| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 93
Epoch 93/200 |loss: 10.145042| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 94
Epoch 94/200 |loss: 8.443178| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 95
Epoch 95/200 |loss: 8.381372| train set 1.791x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 96
Epoch 96/200 |loss: 9.856047| train set 1.790x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 97
Epoch 97/200 |loss: 8.761855| train set 1.776x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 98
Epoch 98/200 |loss: 7.492562| train set 1.791x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 99
Epoch 99/200 |loss: 9.720843| train set 1.773x speedup, test set 0.911x speedup, val set 0.296x speedup, step: 100
Epoch 100/200 |loss: 8.917173| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 101/200 |loss: 8.974888| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 102/200 |loss: 8.150160| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 103/200 |loss: 9.852647| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 104/200 |loss: 9.021620| train set 1.807x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 1
Epoch 105/200 |loss: 8.552445| train set 1.776x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 1
Epoch 106/200 |loss: 9.058385| train set 1.810x speedup, test set 1.039x speedup, val set 0.296x speedup, step: 1
Epoch 107/200 |loss: 10.206362| train set 1.810x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 1
Epoch 108/200 |loss: 9.770003| train set 1.776x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 1
Epoch 109/200 |loss: 8.329013| train set 1.810x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 1
Epoch 110/200 |loss: 8.985926| train set 1.791x speedup, test set 0.889x speedup, val set 0.296x speedup, step: 1
Epoch 111/200 |loss: 8.529291| train set 1.791x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 112/200 |loss: 7.762933| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 113/200 |loss: 9.511855| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 114/200 |loss: 8.829519| train set 1.810x speedup, test set 0.891x speedup, val set 0.296x speedup, step: 1
Epoch 115/200 |loss: 8.469335| train set 1.790x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 116/200 |loss: 8.133184| train set 1.790x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 1
Epoch 117/200 |loss: 10.891243| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 1
Epoch 118/200 |loss: 8.478736| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 1
Epoch 119/200 |loss: 8.271946| train set 1.810x speedup, test set 0.890x speedup, val set 0.477x speedup, step: 1
Epoch 120/200 |loss: 8.315940| train set 1.810x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 2
Epoch 121/200 |loss: 9.327259| train set 1.776x speedup, test set 0.890x speedup, val set 0.296x speedup, step: 3
Epoch 122/200 |loss: 9.615975| train set 1.791x speedup, test set 0.886x speedup, val set 0.296x speedup, step: 4
Epoch 123/200 |loss: 9.091228| train set 1.790x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 5
Epoch 124/200 |loss: 8.794005| train set 1.757x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 6
Epoch 125/200 |loss: 8.807935| train set 1.776x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 7
Epoch 126/200 |loss: 8.122810| train set 1.810x speedup, test set 0.872x speedup, val set 0.296x speedup, step: 8
Epoch 127/200 |loss: 7.896824| train set 1.810x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 9
Epoch 128/200 |loss: 8.834635| train set 1.776x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 10
Epoch 129/200 |loss: 8.386218| train set 1.776x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 11
Epoch 130/200 |loss: 8.571531| train set 1.810x speedup, test set 1.060x speedup, val set 0.296x speedup, step: 12
Epoch 131/200 |loss: 8.875961| train set 1.810x speedup, test set 0.868x speedup, val set 0.296x speedup, step: 13
Epoch 132/200 |loss: 8.066172| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 14
Epoch 133/200 |loss: 8.523982| train set 1.810x speedup, test set 0.888x speedup, val set 0.296x speedup, step: 15
Epoch 134/200 |loss: 9.044022| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 16
Epoch 135/200 |loss: 8.351273| train set 1.810x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 17
Epoch 136/200 |loss: 8.016181| train set 1.810x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 18
Epoch 137/200 |loss: 8.262224| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 19
Epoch 138/200 |loss: 6.891560| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 20
Epoch 139/200 |loss: 7.305196| train set 1.696x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 21
Epoch 140/200 |loss: 7.071527| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 22
Epoch 141/200 |loss: 10.279500| train set 1.776x speedup, test set 0.876x speedup, val set 0.477x speedup, step: 1
Epoch 142/200 |loss: 8.464601| train set 1.776x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 2
Epoch 143/200 |loss: 8.497176| train set 1.791x speedup, test set 0.873x speedup, val set 0.296x speedup, step: 3
Epoch 144/200 |loss: 9.536011| train set 1.791x speedup, test set 0.863x speedup, val set 0.296x speedup, step: 4
Epoch 145/200 |loss: 9.722981| train set 1.757x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 5
Epoch 146/200 |loss: 7.179740| train set 1.757x speedup, test set 0.878x speedup, val set 0.296x speedup, step: 6
Epoch 147/200 |loss: 9.877895| train set 1.790x speedup, test set 0.881x speedup, val set 0.296x speedup, step: 7
Epoch 148/200 |loss: 6.971283| train set 1.790x speedup, test set 1.037x speedup, val set 0.296x speedup, step: 8
Epoch 149/200 |loss: 9.400333| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 9
Epoch 150/200 |loss: 8.596686| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 10
Epoch 151/200 |loss: 9.744796| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 11
Epoch 152/200 |loss: 7.689951| train set 1.810x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 12
Epoch 153/200 |loss: 7.498610| train set 1.810x speedup, test set 1.077x speedup, val set 0.296x speedup, step: 13
Epoch 154/200 |loss: 8.793834| train set 1.810x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 14
Epoch 155/200 |loss: 7.733417| train set 1.810x speedup, test set 0.884x speedup, val set 0.296x speedup, step: 15
Epoch 156/200 |loss: 7.616300| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 16
Epoch 157/200 |loss: 7.783908| train set 1.810x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 17
Epoch 158/200 |loss: 9.938226| train set 1.810x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 18
Epoch 159/200 |loss: 9.289813| train set 1.810x speedup, test set 1.034x speedup, val set 0.296x speedup, step: 19
Epoch 160/200 |loss: 7.448110| train set 1.810x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 20
Epoch 161/200 |loss: 9.204167| train set 1.810x speedup, test set 1.063x speedup, val set 0.296x speedup, step: 21
Epoch 162/200 |loss: 9.822713| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 22
Epoch 163/200 |loss: 7.626907| train set 1.810x speedup, test set 0.885x speedup, val set 0.296x speedup, step: 23
Epoch 164/200 |loss: 8.435320| train set 1.810x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 24
Epoch 165/200 |loss: 7.850835| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 25
Epoch 166/200 |loss: 8.985703| train set 1.810x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 26
Epoch 167/200 |loss: 8.227152| train set 1.810x speedup, test set 0.879x speedup, val set 0.296x speedup, step: 27
Epoch 168/200 |loss: 7.698091| train set 1.810x speedup, test set 1.037x speedup, val set 0.296x speedup, step: 28
Epoch 169/200 |loss: 8.544981| train set 1.757x speedup, test set 1.037x speedup, val set 0.296x speedup, step: 29
Epoch 170/200 |loss: 9.195678| train set 1.757x speedup, test set 1.037x speedup, val set 0.296x speedup, step: 30
Epoch 171/200 |loss: 7.811822| train set 1.758x speedup, test set 1.037x speedup, val set 0.296x speedup, step: 31
Epoch 172/200 |loss: 8.662519| train set 1.791x speedup, test set 1.042x speedup, val set 0.296x speedup, step: 32
Epoch 173/200 |loss: 7.881180| train set 1.790x speedup, test set 0.876x speedup, val set 0.296x speedup, step: 33
Epoch 174/200 |loss: 7.856698| train set 1.775x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 34
Epoch 175/200 |loss: 8.508195| train set 1.775x speedup, test set 0.877x speedup, val set 0.296x speedup, step: 35
Epoch 176/200 |loss: 9.416138| train set 1.810x speedup, test set 1.053x speedup, val set 0.296x speedup, step: 36
Epoch 177/200 |loss: 8.076036| train set 1.791x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 37
Epoch 178/200 |loss: 7.914057| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 38
Epoch 179/200 |loss: 8.543446| train set 1.790x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 39
Epoch 180/200 |loss: 9.112678| train set 1.791x speedup, test set 1.057x speedup, val set 0.296x speedup, step: 40
Epoch 181/200 |loss: 8.813178| train set 1.791x speedup, test set 0.883x speedup, val set 0.296x speedup, step: 41
Epoch 182/200 |loss: 8.752683| train set 1.791x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 42
Epoch 183/200 |loss: 8.719773| train set 1.791x speedup, test set 1.050x speedup, val set 0.296x speedup, step: 43
Epoch 184/200 |loss: 7.475484| train set 1.791x speedup, test set 1.048x speedup, val set 0.296x speedup, step: 44
Epoch 185/200 |loss: 7.536697| train set 1.810x speedup, test set 1.047x speedup, val set 0.296x speedup, step: 45
Epoch 186/200 |loss: 9.211265| train set 1.810x speedup, test set 0.880x speedup, val set 0.296x speedup, step: 46
Epoch 187/200 |loss: 9.644056| train set 1.810x speedup, test set 1.047x speedup, val set 0.296x speedup, step: 47
Epoch 188/200 |loss: 6.933813| train set 1.810x speedup, test set 1.033x speedup, val set 0.296x speedup, step: 48
Epoch 189/200 |loss: 8.865784| train set 1.810x speedup, test set 1.033x speedup, val set 0.296x speedup, step: 49
Epoch 190/200 |loss: 7.764553| train set 1.810x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 50
Epoch 191/200 |loss: 8.049140| train set 1.776x speedup, test set 1.056x speedup, val set 0.296x speedup, step: 51
Epoch 192/200 |loss: 10.142026| train set 1.776x speedup, test set 1.058x speedup, val set 0.296x speedup, step: 52
Epoch 193/200 |loss: 8.342070| train set 1.776x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 53
Epoch 194/200 |loss: 9.353251| train set 1.810x speedup, test set 1.055x speedup, val set 0.296x speedup, step: 54
Epoch 195/200 |loss: 10.018026| train set 1.776x speedup, test set 1.043x speedup, val set 0.296x speedup, step: 55
Epoch 196/200 |loss: 8.245022| train set 1.776x speedup, test set 0.882x speedup, val set 0.296x speedup, step: 56
Epoch 197/200 |loss: 8.360147| train set 1.810x speedup, test set 1.052x speedup, val set 0.296x speedup, step: 57
Epoch 198/200 |loss: 8.803462| train set 1.791x speedup, test set 1.043x speedup, val set 0.296x speedup, step: 58
Epoch 199/200 |loss: 8.571917| train set 1.791x speedup, test set 1.044x speedup, val set 0.296x speedup, step: 59
Training per epoch cost 0.312 s
Optimal speedup on test set is 4.686x
01, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
02, opt runtime 4.223s, model runtime 19.080s, pg runtime 18.741s, speedup 0.982x
03, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
04, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
05, opt runtime 3.504s, model runtime 6.368s, pg runtime 6.143s, speedup 0.965x
06, opt runtime 2.593s, model runtime 9.387s, pg runtime 8.283s, speedup 0.882x
07, opt runtime 2.046s, model runtime 6.220s, pg runtime 5.879s, speedup 0.945x
08, opt runtime 1.737s, model runtime 6.267s, pg runtime 5.994s, speedup 0.957x
09, opt runtime 2.324s, model runtime 10.829s, pg runtime 10.605s, speedup 0.979x
10, opt runtime 3.248s, model runtime 10.638s, pg runtime 10.538s, speedup 0.991x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
13, opt runtime 5.179s, model runtime 10.240s, pg runtime 10.685s, speedup 1.043x
14, opt runtime 0.157s, model runtime 0.176s, pg runtime 0.393s, speedup 2.231x
15, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
16, opt runtime 1.876s, model runtime 5.928s, pg runtime 6.089s, speedup 1.027x
17, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
18, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
19, opt runtime 0.379s, model runtime 3.515s, pg runtime 3.645s, speedup 1.037x
20, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
21, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
22, opt runtime 3.136s, model runtime 5.620s, pg runtime 5.620s, speedup 1.000x
23, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
24, opt runtime 0.332s, model runtime 0.332s, pg runtime 0.332s, speedup 1.000x
25, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
26, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
====================
best train speedup epoch: 35, train speedup 1.810, test speedup 0.891, val speedup 0.296
best test speedup epoch: 0, train speedup 1.013, test speedup 1.613, val speedup 0.355
best validation speedup epoch: 141, train speedup 1.776, test speedup 0.876, val speedup 0.477
last model at epoch 199, train speedup 1.791, test speedup 1.044, val speedup 0.296
execution cost 0:02:37.742027
==================================================
