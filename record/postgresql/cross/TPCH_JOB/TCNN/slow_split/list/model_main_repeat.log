all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:01.665476, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824186| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.832015| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837404| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841878| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846056| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850130| train set 2.942x speedup, test set 2.184x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853543| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856704| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.860040| train set 2.748x speedup, test set 2.078x speedup, val set 2.718x speedup, step: 2
Epoch 15/200 |loss: -0.861606| train set 2.783x speedup, test set 2.105x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866165| train set 2.801x speedup, test set 1.835x speedup, val set 2.770x speedup, step: 4
Epoch 17/200 |loss: -0.869730| train set 2.801x speedup, test set 1.709x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.873850| train set 2.645x speedup, test set 1.709x speedup, val set 2.620x speedup, step: 6
Epoch 19/200 |loss: -0.876486| train set 2.773x speedup, test set 1.733x speedup, val set 2.761x speedup, step: 7
Epoch 20/200 |loss: -0.878882| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 8
Epoch 21/200 |loss: -0.880054| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 9
Epoch 22/200 |loss: -0.881749| train set 3.047x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 23/200 |loss: -0.882729| train set 2.986x speedup, test set 1.653x speedup, val set 3.021x speedup, step: 2
Epoch 24/200 |loss: -0.883750| train set 3.047x speedup, test set 1.654x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.885082| train set 3.047x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.887088| train set 2.986x speedup, test set 1.674x speedup, val set 3.021x speedup, step: 2
Epoch 27/200 |loss: -0.890891| train set 3.034x speedup, test set 1.615x speedup, val set 3.073x speedup, step: 3
Epoch 28/200 |loss: -0.894455| train set 2.772x speedup, test set 1.615x speedup, val set 2.797x speedup, step: 4
Epoch 29/200 |loss: -0.896474| train set 2.508x speedup, test set 1.615x speedup, val set 2.548x speedup, step: 5
Epoch 30/200 |loss: -0.897496| train set 2.508x speedup, test set 1.632x speedup, val set 2.548x speedup, step: 6
Epoch 31/200 |loss: -0.898326| train set 2.508x speedup, test set 1.632x speedup, val set 2.548x speedup, step: 7
Epoch 32/200 |loss: -0.898878| train set 2.492x speedup, test set 1.638x speedup, val set 2.498x speedup, step: 8
Epoch 33/200 |loss: -0.899257| train set 2.516x speedup, test set 1.638x speedup, val set 2.552x speedup, step: 9
Epoch 34/200 |loss: -0.899911| train set 2.568x speedup, test set 1.643x speedup, val set 2.714x speedup, step: 10
Epoch 35/200 |loss: -0.900631| train set 2.861x speedup, test set 1.643x speedup, val set 2.887x speedup, step: 11
Epoch 36/200 |loss: -0.901458| train set 2.861x speedup, test set 1.643x speedup, val set 2.887x speedup, step: 12
Epoch 37/200 |loss: -0.902197| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 13
Epoch 38/200 |loss: -0.902841| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 14
Epoch 39/200 |loss: -0.903385| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 15
Epoch 40/200 |loss: -0.903958| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 16
Epoch 41/200 |loss: -0.904456| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 17
Epoch 42/200 |loss: -0.904825| train set 2.677x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 18
Epoch 43/200 |loss: -0.905100| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 19
Epoch 44/200 |loss: -0.905376| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 20
Epoch 45/200 |loss: -0.905651| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 21
Epoch 46/200 |loss: -0.905988| train set 2.568x speedup, test set 1.587x speedup, val set 2.552x speedup, step: 22
Epoch 47/200 |loss: -0.906280| train set 2.516x speedup, test set 1.587x speedup, val set 2.552x speedup, step: 23
Epoch 48/200 |loss: -0.906570| train set 2.516x speedup, test set 1.587x speedup, val set 2.552x speedup, step: 24
Epoch 49/200 |loss: -0.906827| train set 2.516x speedup, test set 1.587x speedup, val set 2.552x speedup, step: 25
Epoch 50/200 |loss: -0.907076| train set 2.516x speedup, test set 1.587x speedup, val set 2.552x speedup, step: 26
Epoch 51/200 |loss: -0.907321| train set 2.516x speedup, test set 1.587x speedup, val set 2.552x speedup, step: 27
Epoch 52/200 |loss: -0.907607| train set 2.730x speedup, test set 1.587x speedup, val set 2.780x speedup, step: 28
Epoch 53/200 |loss: -0.907970| train set 2.730x speedup, test set 1.587x speedup, val set 2.780x speedup, step: 29
Epoch 54/200 |loss: -0.908245| train set 2.741x speedup, test set 1.587x speedup, val set 2.802x speedup, step: 30
Epoch 55/200 |loss: -0.908545| train set 2.741x speedup, test set 1.587x speedup, val set 2.802x speedup, step: 31
Epoch 56/200 |loss: -0.908877| train set 2.741x speedup, test set 1.587x speedup, val set 2.802x speedup, step: 32
Epoch 57/200 |loss: -0.909286| train set 2.730x speedup, test set 1.587x speedup, val set 2.780x speedup, step: 33
Epoch 58/200 |loss: -0.909647| train set 2.713x speedup, test set 1.587x speedup, val set 2.757x speedup, step: 34
Epoch 59/200 |loss: -0.910127| train set 2.713x speedup, test set 1.668x speedup, val set 2.757x speedup, step: 35
Epoch 60/200 |loss: -0.910534| train set 2.773x speedup, test set 1.668x speedup, val set 2.757x speedup, step: 36
Epoch 61/200 |loss: -0.911125| train set 3.120x speedup, test set 1.645x speedup, val set 3.153x speedup, step: 1
Epoch 62/200 |loss: -0.911630| train set 3.120x speedup, test set 1.644x speedup, val set 3.153x speedup, step: 1
Epoch 63/200 |loss: -0.911953| train set 3.120x speedup, test set 1.644x speedup, val set 3.153x speedup, step: 1
Epoch 64/200 |loss: -0.912513| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 2
Epoch 65/200 |loss: -0.913089| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 3
Epoch 66/200 |loss: -0.913835| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 4
Epoch 67/200 |loss: -0.914012| train set 3.040x speedup, test set 1.644x speedup, val set 3.078x speedup, step: 5
Epoch 68/200 |loss: -0.915075| train set 2.969x speedup, test set 1.644x speedup, val set 3.037x speedup, step: 6
Epoch 69/200 |loss: -0.916070| train set 3.040x speedup, test set 1.644x speedup, val set 3.078x speedup, step: 7
Epoch 70/200 |loss: -0.915590| train set 2.969x speedup, test set 1.644x speedup, val set 3.037x speedup, step: 8
Epoch 71/200 |loss: -0.918253| train set 2.969x speedup, test set 1.654x speedup, val set 3.037x speedup, step: 9
Epoch 72/200 |loss: -0.918873| train set 3.119x speedup, test set 1.602x speedup, val set 3.151x speedup, step: 10
Epoch 73/200 |loss: -0.923149| train set 3.133x speedup, test set 1.152x speedup, val set 3.169x speedup, step: 1
Epoch 74/200 |loss: -0.925207| train set 2.785x speedup, test set 1.162x speedup, val set 2.771x speedup, step: 2
Epoch 75/200 |loss: -0.930237| train set 1.844x speedup, test set 1.160x speedup, val set 1.853x speedup, step: 3
Epoch 76/200 |loss: -0.916270| train set 1.844x speedup, test set 1.158x speedup, val set 1.853x speedup, step: 4
Epoch 77/200 |loss: -0.916270| train set 1.844x speedup, test set 1.150x speedup, val set 1.853x speedup, step: 5
Epoch 78/200 |loss: -0.922633| train set 1.994x speedup, test set 1.113x speedup, val set 1.991x speedup, step: 6
Epoch 79/200 |loss: -0.924974| train set 1.994x speedup, test set 1.143x speedup, val set 1.991x speedup, step: 7
Epoch 80/200 |loss: -0.925609| train set 1.994x speedup, test set 1.143x speedup, val set 1.991x speedup, step: 8
Epoch 81/200 |loss: -0.928109| train set 1.994x speedup, test set 1.143x speedup, val set 1.991x speedup, step: 9
Epoch 82/200 |loss: -0.929335| train set 1.994x speedup, test set 1.143x speedup, val set 1.991x speedup, step: 10
Epoch 83/200 |loss: -0.928893| train set 3.020x speedup, test set 1.115x speedup, val set 3.049x speedup, step: 11
Epoch 84/200 |loss: -0.929743| train set 3.020x speedup, test set 1.115x speedup, val set 3.049x speedup, step: 12
early stopping at epoch 84
Training per epoch cost 0.592 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.502s, pg runtime 0.207s, speedup 0.412x
04, opt runtime 0.920s, model runtime 0.920s, pg runtime 1.680s, speedup 1.825x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 3.507s, pg runtime 3.507s, speedup 1.000x
11, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 2.238s, model runtime 3.296s, pg runtime 2.718s, speedup 0.825x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 3.353s, pg runtime 0.354s, speedup 0.106x
18, opt runtime 2.962s, model runtime 2.962s, pg runtime 6.876s, speedup 2.321x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 1.666s, pg runtime 0.089s, speedup 0.054x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 0.216s, pg runtime 2.389s, speedup 11.054x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.167s, pg runtime 0.158s, speedup 0.947x
30, opt runtime 1.646s, model runtime 1.646s, pg runtime 4.855s, speedup 2.949x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
====================
best train speedup epoch: 73, train speedup 3.133, test speedup 1.152, val speedup 3.169
best test speedup epoch: 11, train speedup 2.942, test speedup 2.184, val speedup 2.923
best validation speedup epoch: 73, train speedup 3.133, test speedup 1.152, val speedup 3.169
last model at epoch 84, train speedup 3.020, test speedup 1.115, val speedup 3.049
execution cost 0:03:04.597711
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:00.982049, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824188| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.831995| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837396| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841876| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846135| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850253| train set 2.942x speedup, test set 2.035x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853781| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856846| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.860058| train set 2.783x speedup, test set 2.077x speedup, val set 2.751x speedup, step: 2
Epoch 15/200 |loss: -0.862432| train set 2.783x speedup, test set 2.113x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866534| train set 2.783x speedup, test set 1.835x speedup, val set 2.751x speedup, step: 4
Epoch 17/200 |loss: -0.869640| train set 2.801x speedup, test set 1.709x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.874251| train set 2.801x speedup, test set 1.709x speedup, val set 2.770x speedup, step: 6
Epoch 19/200 |loss: -0.876141| train set 2.850x speedup, test set 1.733x speedup, val set 2.842x speedup, step: 7
Epoch 20/200 |loss: -0.879051| train set 2.850x speedup, test set 1.808x speedup, val set 2.842x speedup, step: 8
Epoch 21/200 |loss: -0.879803| train set 2.918x speedup, test set 1.768x speedup, val set 2.936x speedup, step: 9
Epoch 22/200 |loss: -0.881591| train set 3.047x speedup, test set 1.661x speedup, val set 3.100x speedup, step: 1
Epoch 23/200 |loss: -0.882340| train set 3.047x speedup, test set 1.654x speedup, val set 3.100x speedup, step: 1
Epoch 24/200 |loss: -0.883823| train set 3.047x speedup, test set 1.654x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.884557| train set 3.047x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.885234| train set 2.783x speedup, test set 1.674x speedup, val set 2.819x speedup, step: 2
Epoch 27/200 |loss: -0.886985| train set 2.783x speedup, test set 1.674x speedup, val set 2.819x speedup, step: 3
Epoch 28/200 |loss: -0.891388| train set 2.772x speedup, test set 1.674x speedup, val set 2.797x speedup, step: 4
Epoch 29/200 |loss: -0.895172| train set 2.772x speedup, test set 1.651x speedup, val set 2.797x speedup, step: 5
Epoch 30/200 |loss: -0.897436| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 6
Epoch 31/200 |loss: -0.898448| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 7
Epoch 32/200 |loss: -0.899104| train set 2.772x speedup, test set 1.595x speedup, val set 2.797x speedup, step: 8
Epoch 33/200 |loss: -0.899757| train set 2.850x speedup, test set 1.634x speedup, val set 2.881x speedup, step: 9
Epoch 34/200 |loss: -0.900230| train set 3.128x speedup, test set 1.638x speedup, val set 3.176x speedup, step: 1
Epoch 35/200 |loss: -0.900797| train set 3.075x speedup, test set 1.643x speedup, val set 3.152x speedup, step: 2
Epoch 36/200 |loss: -0.901461| train set 2.806x speedup, test set 1.642x speedup, val set 2.862x speedup, step: 3
Epoch 37/200 |loss: -0.902428| train set 2.806x speedup, test set 1.587x speedup, val set 2.862x speedup, step: 4
Epoch 38/200 |loss: -0.903009| train set 2.861x speedup, test set 1.596x speedup, val set 2.887x speedup, step: 5
Epoch 39/200 |loss: -0.903448| train set 2.807x speedup, test set 1.596x speedup, val set 2.818x speedup, step: 6
Epoch 40/200 |loss: -0.903832| train set 2.807x speedup, test set 1.596x speedup, val set 2.818x speedup, step: 7
Epoch 41/200 |loss: -0.904149| train set 2.807x speedup, test set 1.587x speedup, val set 2.818x speedup, step: 8
Epoch 42/200 |loss: -0.904672| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 9
Epoch 43/200 |loss: -0.905022| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 10
Epoch 44/200 |loss: -0.905293| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 11
Epoch 45/200 |loss: -0.905631| train set 2.578x speedup, test set 1.587x speedup, val set 2.735x speedup, step: 12
Epoch 46/200 |loss: -0.905988| train set 2.525x speedup, test set 1.587x speedup, val set 2.570x speedup, step: 13
Epoch 47/200 |loss: -0.906353| train set 2.483x speedup, test set 1.587x speedup, val set 2.516x speedup, step: 14
Epoch 48/200 |loss: -0.906626| train set 2.483x speedup, test set 1.587x speedup, val set 2.516x speedup, step: 15
Epoch 49/200 |loss: -0.906837| train set 2.468x speedup, test set 1.586x speedup, val set 2.496x speedup, step: 16
Epoch 50/200 |loss: -0.907195| train set 2.510x speedup, test set 1.586x speedup, val set 2.550x speedup, step: 17
Epoch 51/200 |loss: -0.907493| train set 2.510x speedup, test set 1.586x speedup, val set 2.550x speedup, step: 18
Epoch 52/200 |loss: -0.907751| train set 2.510x speedup, test set 1.586x speedup, val set 2.550x speedup, step: 19
Epoch 53/200 |loss: -0.908171| train set 2.510x speedup, test set 1.586x speedup, val set 2.550x speedup, step: 20
Epoch 54/200 |loss: -0.908139| train set 2.723x speedup, test set 1.583x speedup, val set 2.778x speedup, step: 21
Epoch 55/200 |loss: -0.908199| train set 2.733x speedup, test set 1.583x speedup, val set 2.791x speedup, step: 22
Epoch 56/200 |loss: -0.908936| train set 2.733x speedup, test set 1.583x speedup, val set 2.791x speedup, step: 23
Epoch 57/200 |loss: -0.909198| train set 3.147x speedup, test set 1.645x speedup, val set 3.198x speedup, step: 1
Epoch 58/200 |loss: -0.909608| train set 3.147x speedup, test set 1.643x speedup, val set 3.198x speedup, step: 1
Epoch 59/200 |loss: -0.910317| train set 3.147x speedup, test set 1.643x speedup, val set 3.198x speedup, step: 1
Epoch 60/200 |loss: -0.910775| train set 3.147x speedup, test set 1.643x speedup, val set 3.198x speedup, step: 1
Epoch 61/200 |loss: -0.911527| train set 3.147x speedup, test set 1.643x speedup, val set 3.198x speedup, step: 1
Epoch 62/200 |loss: -0.912072| train set 3.098x speedup, test set 1.643x speedup, val set 3.179x speedup, step: 2
Epoch 63/200 |loss: -0.912796| train set 3.054x speedup, test set 1.644x speedup, val set 3.104x speedup, step: 3
Epoch 64/200 |loss: -0.913656| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 4
Epoch 65/200 |loss: -0.914587| train set 3.068x speedup, test set 1.620x speedup, val set 3.096x speedup, step: 5
Epoch 66/200 |loss: -0.915353| train set 3.133x speedup, test set 1.577x speedup, val set 3.179x speedup, step: 6
Epoch 67/200 |loss: -0.916164| train set 3.133x speedup, test set 1.621x speedup, val set 3.179x speedup, step: 7
Epoch 68/200 |loss: -0.916508| train set 3.057x speedup, test set 1.577x speedup, val set 3.136x speedup, step: 8
Epoch 69/200 |loss: -0.917202| train set 3.057x speedup, test set 1.559x speedup, val set 3.136x speedup, step: 9
Epoch 70/200 |loss: -0.917877| train set 3.057x speedup, test set 1.560x speedup, val set 3.136x speedup, step: 10
Epoch 71/200 |loss: -0.919018| train set 3.133x speedup, test set 1.580x speedup, val set 3.179x speedup, step: 11
Epoch 72/200 |loss: -0.919301| train set 3.133x speedup, test set 1.625x speedup, val set 3.179x speedup, step: 12
Epoch 73/200 |loss: -0.918644| train set 2.982x speedup, test set 1.624x speedup, val set 3.063x speedup, step: 13
Epoch 74/200 |loss: -0.920572| train set 3.066x speedup, test set 1.689x speedup, val set 3.121x speedup, step: 14
Epoch 75/200 |loss: -0.911629| train set 3.134x speedup, test set 1.625x speedup, val set 3.181x speedup, step: 15
Epoch 76/200 |loss: -0.913879| train set 3.147x speedup, test set 1.645x speedup, val set 3.198x speedup, step: 1
early stopping at epoch 76
Training per epoch cost 0.561 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.502s, pg runtime 0.207s, speedup 0.412x
04, opt runtime 0.920s, model runtime 0.920s, pg runtime 1.680s, speedup 1.825x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 4.298s, pg runtime 3.507s, speedup 0.816x
11, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 2.238s, model runtime 3.296s, pg runtime 2.718s, speedup 0.825x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.327s, pg runtime 0.354s, speedup 1.083x
18, opt runtime 2.962s, model runtime 2.962s, pg runtime 6.876s, speedup 2.321x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.064s, model runtime 0.093s, pg runtime 0.089s, speedup 0.956x
21, opt runtime 0.953s, model runtime 5.597s, pg runtime 4.730s, speedup 0.845x
22, opt runtime 0.093s, model runtime 0.216s, pg runtime 2.389s, speedup 11.054x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
30, opt runtime 1.646s, model runtime 1.646s, pg runtime 4.855s, speedup 2.949x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 6.444s, pg runtime 6.444s, speedup 1.000x
33, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
====================
best train speedup epoch: 57, train speedup 3.147, test speedup 1.645, val speedup 3.198
best test speedup epoch: 12, train speedup 2.930, test speedup 2.184, val speedup 2.907
best validation speedup epoch: 76, train speedup 3.147, test speedup 1.645, val speedup 3.198
last model at epoch 76, train speedup 3.147, test speedup 1.645, val speedup 3.198
execution cost 0:02:39.287415
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:01.600215, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824188| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.832001| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837393| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841863| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846046| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850130| train set 2.942x speedup, test set 2.181x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853566| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856640| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.859961| train set 2.748x speedup, test set 2.077x speedup, val set 2.718x speedup, step: 2
Epoch 15/200 |loss: -0.861511| train set 2.783x speedup, test set 2.113x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866091| train set 2.801x speedup, test set 1.835x speedup, val set 2.770x speedup, step: 4
Epoch 17/200 |loss: -0.869830| train set 2.801x speedup, test set 1.733x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.873820| train set 2.946x speedup, test set 1.709x speedup, val set 2.928x speedup, step: 6
Epoch 19/200 |loss: -0.876280| train set 3.033x speedup, test set 1.709x speedup, val set 3.020x speedup, step: 1
Epoch 20/200 |loss: -0.878669| train set 2.850x speedup, test set 1.874x speedup, val set 2.842x speedup, step: 2
Epoch 21/200 |loss: -0.880154| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 3
Epoch 22/200 |loss: -0.881891| train set 2.918x speedup, test set 1.661x speedup, val set 2.936x speedup, step: 4
Epoch 23/200 |loss: -0.882894| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 24/200 |loss: -0.883895| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.885492| train set 3.046x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.888799| train set 3.034x speedup, test set 1.674x speedup, val set 3.073x speedup, step: 2
Epoch 27/200 |loss: -0.893039| train set 2.772x speedup, test set 1.651x speedup, val set 2.797x speedup, step: 3
Epoch 28/200 |loss: -0.895718| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 4
Epoch 29/200 |loss: -0.897014| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 5
Epoch 30/200 |loss: -0.897847| train set 2.772x speedup, test set 1.590x speedup, val set 2.797x speedup, step: 6
Epoch 31/200 |loss: -0.898513| train set 2.850x speedup, test set 1.607x speedup, val set 2.881x speedup, step: 7
Epoch 32/200 |loss: -0.899026| train set 2.850x speedup, test set 1.612x speedup, val set 2.881x speedup, step: 8
Epoch 33/200 |loss: -0.899587| train set 2.861x speedup, test set 1.612x speedup, val set 2.887x speedup, step: 9
Epoch 34/200 |loss: -0.900234| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 10
Epoch 35/200 |loss: -0.900889| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 11
Epoch 36/200 |loss: -0.901719| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 12
Epoch 37/200 |loss: -0.902506| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 13
Epoch 38/200 |loss: -0.903175| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 14
Epoch 39/200 |loss: -0.903696| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 15
Epoch 40/200 |loss: -0.904190| train set 2.861x speedup, test set 1.672x speedup, val set 2.887x speedup, step: 16
Epoch 41/200 |loss: -0.904690| train set 2.861x speedup, test set 1.672x speedup, val set 2.887x speedup, step: 17
Epoch 42/200 |loss: -0.905020| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 18
Epoch 43/200 |loss: -0.905318| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 19
Epoch 44/200 |loss: -0.905629| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 20
Epoch 45/200 |loss: -0.905951| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 21
Epoch 46/200 |loss: -0.906229| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 22
Epoch 47/200 |loss: -0.906558| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 23
Epoch 48/200 |loss: -0.906867| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 24
Epoch 49/200 |loss: -0.907181| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 25
Epoch 50/200 |loss: -0.907527| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 26
Epoch 51/200 |loss: -0.907872| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 27
Epoch 52/200 |loss: -0.908224| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 28
Epoch 53/200 |loss: -0.908618| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 29
Epoch 54/200 |loss: -0.909033| train set 3.156x speedup, test set 1.585x speedup, val set 3.211x speedup, step: 1
Epoch 55/200 |loss: -0.909455| train set 3.170x speedup, test set 1.583x speedup, val set 3.230x speedup, step: 1
Epoch 56/200 |loss: -0.909919| train set 3.170x speedup, test set 1.582x speedup, val set 3.230x speedup, step: 1
Epoch 57/200 |loss: -0.910413| train set 3.147x speedup, test set 1.562x speedup, val set 3.198x speedup, step: 2
Epoch 58/200 |loss: -0.910840| train set 3.147x speedup, test set 1.562x speedup, val set 3.198x speedup, step: 3
Epoch 59/200 |loss: -0.911317| train set 3.147x speedup, test set 1.643x speedup, val set 3.198x speedup, step: 4
Epoch 60/200 |loss: -0.911963| train set 3.147x speedup, test set 1.643x speedup, val set 3.198x speedup, step: 5
Epoch 61/200 |loss: -0.912695| train set 3.146x speedup, test set 1.643x speedup, val set 3.196x speedup, step: 6
Epoch 62/200 |loss: -0.913340| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 7
Epoch 63/200 |loss: -0.913796| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 8
Epoch 64/200 |loss: -0.914538| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 9
Epoch 65/200 |loss: -0.915759| train set 2.647x speedup, test set 1.644x speedup, val set 2.668x speedup, step: 10
Epoch 66/200 |loss: -0.917026| train set 2.647x speedup, test set 1.644x speedup, val set 2.668x speedup, step: 11
Epoch 67/200 |loss: -0.917795| train set 2.593x speedup, test set 1.644x speedup, val set 2.637x speedup, step: 12
Epoch 68/200 |loss: -0.917987| train set 2.647x speedup, test set 1.587x speedup, val set 2.668x speedup, step: 13
Epoch 69/200 |loss: -0.912862| train set 2.591x speedup, test set 1.587x speedup, val set 2.615x speedup, step: 14
Epoch 70/200 |loss: -0.915892| train set 2.661x speedup, test set 1.461x speedup, val set 2.723x speedup, step: 15
Epoch 71/200 |loss: -0.909377| train set 2.591x speedup, test set 1.672x speedup, val set 2.615x speedup, step: 16
Epoch 72/200 |loss: -0.918776| train set 2.647x speedup, test set 1.609x speedup, val set 2.668x speedup, step: 17
Epoch 73/200 |loss: -0.926079| train set 3.146x speedup, test set 1.081x speedup, val set 3.196x speedup, step: 18
Epoch 74/200 |loss: -0.929004| train set 3.335x speedup, test set 1.110x speedup, val set 3.410x speedup, step: 1
Epoch 75/200 |loss: -0.931543| train set 3.413x speedup, test set 1.151x speedup, val set 3.494x speedup, step: 1
Epoch 76/200 |loss: -0.933244| train set 3.413x speedup, test set 1.158x speedup, val set 3.494x speedup, step: 1
Epoch 77/200 |loss: -0.934785| train set 3.406x speedup, test set 1.190x speedup, val set 3.499x speedup, step: 1
Epoch 78/200 |loss: -0.937266| train set 3.329x speedup, test set 1.157x speedup, val set 3.414x speedup, step: 2
Epoch 79/200 |loss: -0.937729| train set 3.329x speedup, test set 1.157x speedup, val set 3.414x speedup, step: 3
Epoch 80/200 |loss: -0.938816| train set 3.331x speedup, test set 1.160x speedup, val set 3.416x speedup, step: 4
Epoch 81/200 |loss: -0.939367| train set 3.331x speedup, test set 1.115x speedup, val set 3.416x speedup, step: 5
Epoch 82/200 |loss: -0.939838| train set 3.331x speedup, test set 1.143x speedup, val set 3.416x speedup, step: 6
Epoch 83/200 |loss: -0.940611| train set 3.331x speedup, test set 1.123x speedup, val set 3.416x speedup, step: 7
Epoch 84/200 |loss: -0.940797| train set 3.331x speedup, test set 1.137x speedup, val set 3.416x speedup, step: 8
Epoch 85/200 |loss: -0.941115| train set 3.331x speedup, test set 1.137x speedup, val set 3.416x speedup, step: 9
Epoch 86/200 |loss: -0.941969| train set 3.331x speedup, test set 1.137x speedup, val set 3.416x speedup, step: 10
Epoch 87/200 |loss: -0.942551| train set 3.141x speedup, test set 1.148x speedup, val set 3.202x speedup, step: 11
Epoch 88/200 |loss: -0.943399| train set 3.141x speedup, test set 1.138x speedup, val set 3.202x speedup, step: 12
Epoch 89/200 |loss: -0.943891| train set 3.141x speedup, test set 1.138x speedup, val set 3.202x speedup, step: 13
Epoch 90/200 |loss: -0.944520| train set 3.141x speedup, test set 1.135x speedup, val set 3.202x speedup, step: 14
Epoch 91/200 |loss: -0.945036| train set 3.141x speedup, test set 1.123x speedup, val set 3.202x speedup, step: 15
Epoch 92/200 |loss: -0.945573| train set 3.141x speedup, test set 1.107x speedup, val set 3.202x speedup, step: 16
Epoch 93/200 |loss: -0.946020| train set 3.141x speedup, test set 1.107x speedup, val set 3.202x speedup, step: 17
Epoch 94/200 |loss: -0.946458| train set 3.241x speedup, test set 1.107x speedup, val set 3.263x speedup, step: 18
Epoch 95/200 |loss: -0.946728| train set 3.141x speedup, test set 1.108x speedup, val set 3.202x speedup, step: 19
Epoch 96/200 |loss: -0.947061| train set 3.141x speedup, test set 1.108x speedup, val set 3.202x speedup, step: 20
Epoch 97/200 |loss: -0.947314| train set 3.141x speedup, test set 1.108x speedup, val set 3.202x speedup, step: 21
Epoch 98/200 |loss: -0.947610| train set 3.141x speedup, test set 1.121x speedup, val set 3.202x speedup, step: 22
Epoch 99/200 |loss: -0.948068| train set 3.141x speedup, test set 1.149x speedup, val set 3.202x speedup, step: 23
Epoch 100/200 |loss: -0.948404| train set 3.241x speedup, test set 1.149x speedup, val set 3.263x speedup, step: 24
Epoch 101/200 |loss: -0.948487| train set 3.241x speedup, test set 1.149x speedup, val set 3.263x speedup, step: 25
Epoch 102/200 |loss: -0.948583| train set 3.241x speedup, test set 1.126x speedup, val set 3.263x speedup, step: 26
Epoch 103/200 |loss: -0.949323| train set 3.241x speedup, test set 1.126x speedup, val set 3.263x speedup, step: 27
Epoch 104/200 |loss: -0.949588| train set 3.241x speedup, test set 1.117x speedup, val set 3.263x speedup, step: 28
Epoch 105/200 |loss: -0.950178| train set 3.241x speedup, test set 1.126x speedup, val set 3.263x speedup, step: 29
Epoch 106/200 |loss: -0.950288| train set 3.241x speedup, test set 1.156x speedup, val set 3.263x speedup, step: 30
Epoch 107/200 |loss: -0.950623| train set 3.241x speedup, test set 1.156x speedup, val set 3.263x speedup, step: 31
Epoch 108/200 |loss: -0.950931| train set 3.241x speedup, test set 0.985x speedup, val set 3.263x speedup, step: 32
Epoch 109/200 |loss: -0.951036| train set 3.241x speedup, test set 0.977x speedup, val set 3.263x speedup, step: 33
Epoch 110/200 |loss: -0.951345| train set 3.241x speedup, test set 0.957x speedup, val set 3.263x speedup, step: 34
Epoch 111/200 |loss: -0.951653| train set 3.241x speedup, test set 0.957x speedup, val set 3.263x speedup, step: 35
Epoch 112/200 |loss: -0.951057| train set 3.455x speedup, test set 0.972x speedup, val set 3.453x speedup, step: 36
Epoch 113/200 |loss: -0.950367| train set 3.455x speedup, test set 0.972x speedup, val set 3.453x speedup, step: 37
Epoch 114/200 |loss: -0.951362| train set 3.538x speedup, test set 0.953x speedup, val set 3.557x speedup, step: 1
Epoch 115/200 |loss: -0.949834| train set 3.538x speedup, test set 0.953x speedup, val set 3.557x speedup, step: 1
Epoch 116/200 |loss: -0.951428| train set 3.401x speedup, test set 0.802x speedup, val set 3.401x speedup, step: 2
Epoch 117/200 |loss: -0.949239| train set 3.401x speedup, test set 0.802x speedup, val set 3.401x speedup, step: 3
Epoch 118/200 |loss: -0.949538| train set 3.455x speedup, test set 0.864x speedup, val set 3.453x speedup, step: 4
early stopping at epoch 118
Training per epoch cost 0.637 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 3.507s, pg runtime 3.507s, speedup 1.000x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 2.238s, model runtime 3.296s, pg runtime 2.718s, speedup 0.825x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 3.353s, pg runtime 0.354s, speedup 0.106x
18, opt runtime 2.962s, model runtime 2.962s, pg runtime 6.876s, speedup 2.321x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 1.666s, pg runtime 0.089s, speedup 0.054x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.421s, pg runtime 0.389s, speedup 0.924x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 4.173s, pg runtime 8.279s, speedup 1.984x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
30, opt runtime 1.646s, model runtime 4.938s, pg runtime 4.855s, speedup 0.983x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 5.350s, pg runtime 6.444s, speedup 1.204x
33, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
====================
best train speedup epoch: 114, train speedup 3.538, test speedup 0.953, val speedup 3.557
best test speedup epoch: 12, train speedup 2.930, test speedup 2.184, val speedup 2.907
best validation speedup epoch: 115, train speedup 3.538, test speedup 0.953, val speedup 3.557
last model at epoch 118, train speedup 3.455, test speedup 0.864, val speedup 3.453
execution cost 0:04:29.953882
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:01.662449, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824186| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.832015| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837404| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841878| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846056| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850130| train set 2.942x speedup, test set 2.184x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853543| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856704| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.860041| train set 2.748x speedup, test set 2.078x speedup, val set 2.718x speedup, step: 2
Epoch 15/200 |loss: -0.861594| train set 2.783x speedup, test set 2.078x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866186| train set 2.801x speedup, test set 1.835x speedup, val set 2.770x speedup, step: 4
Epoch 17/200 |loss: -0.869748| train set 2.801x speedup, test set 1.709x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.873895| train set 2.645x speedup, test set 1.709x speedup, val set 2.620x speedup, step: 6
Epoch 19/200 |loss: -0.876739| train set 2.773x speedup, test set 1.733x speedup, val set 2.761x speedup, step: 7
Epoch 20/200 |loss: -0.878795| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 8
Epoch 21/200 |loss: -0.880200| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 9
Epoch 22/200 |loss: -0.881802| train set 3.047x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 23/200 |loss: -0.882779| train set 2.986x speedup, test set 1.653x speedup, val set 3.021x speedup, step: 2
Epoch 24/200 |loss: -0.883803| train set 3.047x speedup, test set 1.654x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.884999| train set 3.047x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.887214| train set 3.047x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 27/200 |loss: -0.891092| train set 2.783x speedup, test set 1.615x speedup, val set 2.819x speedup, step: 2
Epoch 28/200 |loss: -0.894467| train set 2.446x speedup, test set 1.615x speedup, val set 2.481x speedup, step: 3
Epoch 29/200 |loss: -0.896626| train set 2.446x speedup, test set 1.615x speedup, val set 2.482x speedup, step: 4
Epoch 30/200 |loss: -0.897274| train set 2.508x speedup, test set 1.612x speedup, val set 2.548x speedup, step: 5
Epoch 31/200 |loss: -0.898115| train set 2.517x speedup, test set 1.612x speedup, val set 2.553x speedup, step: 6
Epoch 32/200 |loss: -0.898764| train set 2.517x speedup, test set 1.638x speedup, val set 2.553x speedup, step: 7
Epoch 33/200 |loss: -0.899461| train set 2.517x speedup, test set 1.643x speedup, val set 2.553x speedup, step: 8
Epoch 34/200 |loss: -0.899905| train set 2.862x speedup, test set 1.643x speedup, val set 2.888x speedup, step: 9
Epoch 35/200 |loss: -0.900909| train set 2.862x speedup, test set 1.643x speedup, val set 2.888x speedup, step: 10
Epoch 36/200 |loss: -0.901657| train set 2.861x speedup, test set 1.560x speedup, val set 2.887x speedup, step: 11
Epoch 37/200 |loss: -0.902196| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 12
Epoch 38/200 |loss: -0.902960| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 13
Epoch 39/200 |loss: -0.903425| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 14
Epoch 40/200 |loss: -0.903913| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 15
Epoch 41/200 |loss: -0.904368| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 16
Epoch 42/200 |loss: -0.904726| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 17
Epoch 43/200 |loss: -0.905104| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 18
Epoch 44/200 |loss: -0.905371| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 19
Epoch 45/200 |loss: -0.905692| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 20
Epoch 46/200 |loss: -0.906033| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 21
Epoch 47/200 |loss: -0.906389| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 22
Epoch 48/200 |loss: -0.906684| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 23
Epoch 49/200 |loss: -0.906991| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 50/200 |loss: -0.907308| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 51/200 |loss: -0.907622| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 52/200 |loss: -0.907971| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 53/200 |loss: -0.908316| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 54/200 |loss: -0.908787| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 55/200 |loss: -0.909034| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 56/200 |loss: -0.909362| train set 3.157x speedup, test set 1.587x speedup, val set 3.212x speedup, step: 1
Epoch 57/200 |loss: -0.909626| train set 3.157x speedup, test set 1.583x speedup, val set 3.212x speedup, step: 1
Epoch 58/200 |loss: -0.910491| train set 3.147x speedup, test set 1.645x speedup, val set 3.198x speedup, step: 2
Epoch 59/200 |loss: -0.911086| train set 3.147x speedup, test set 1.645x speedup, val set 3.198x speedup, step: 3
Epoch 60/200 |loss: -0.911543| train set 3.146x speedup, test set 1.644x speedup, val set 3.196x speedup, step: 4
Epoch 61/200 |loss: -0.912126| train set 3.146x speedup, test set 1.644x speedup, val set 3.196x speedup, step: 5
Epoch 62/200 |loss: -0.912858| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 6
Epoch 63/200 |loss: -0.913831| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 7
Epoch 64/200 |loss: -0.914671| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 8
Epoch 65/200 |loss: -0.915189| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 9
Epoch 66/200 |loss: -0.915903| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 10
Epoch 67/200 |loss: -0.916802| train set 2.637x speedup, test set 1.644x speedup, val set 2.648x speedup, step: 11
Epoch 68/200 |loss: -0.917544| train set 2.637x speedup, test set 1.644x speedup, val set 2.648x speedup, step: 12
Epoch 69/200 |loss: -0.918320| train set 2.646x speedup, test set 1.625x speedup, val set 2.660x speedup, step: 13
Epoch 70/200 |loss: -0.918932| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 14
Epoch 71/200 |loss: -0.918184| train set 3.146x speedup, test set 1.625x speedup, val set 3.196x speedup, step: 15
Epoch 72/200 |loss: -0.921248| train set 3.057x speedup, test set 1.689x speedup, val set 3.136x speedup, step: 16
Epoch 73/200 |loss: -0.913717| train set 3.069x speedup, test set 1.628x speedup, val set 3.097x speedup, step: 17
Epoch 74/200 |loss: -0.916877| train set 3.104x speedup, test set 1.109x speedup, val set 3.144x speedup, step: 18
Epoch 75/200 |loss: -0.920359| train set 3.080x speedup, test set 1.106x speedup, val set 3.112x speedup, step: 19
Epoch 76/200 |loss: -0.926548| train set 3.132x speedup, test set 1.146x speedup, val set 3.168x speedup, step: 20
Epoch 77/200 |loss: -0.928433| train set 1.842x speedup, test set 1.121x speedup, val set 1.854x speedup, step: 21
Epoch 78/200 |loss: -0.920128| train set 1.842x speedup, test set 1.134x speedup, val set 1.854x speedup, step: 22
Epoch 79/200 |loss: -0.929235| train set 1.842x speedup, test set 1.122x speedup, val set 1.854x speedup, step: 23
Epoch 80/200 |loss: -0.933230| train set 3.133x speedup, test set 1.096x speedup, val set 3.169x speedup, step: 24
Epoch 81/200 |loss: -0.934824| train set 3.337x speedup, test set 1.094x speedup, val set 3.411x speedup, step: 1
Epoch 82/200 |loss: -0.934742| train set 3.263x speedup, test set 1.140x speedup, val set 3.316x speedup, step: 2
Epoch 83/200 |loss: -0.936072| train set 3.263x speedup, test set 1.125x speedup, val set 3.316x speedup, step: 3
Epoch 84/200 |loss: -0.937227| train set 3.068x speedup, test set 1.034x speedup, val set 3.087x speedup, step: 4
Epoch 85/200 |loss: -0.937589| train set 3.068x speedup, test set 1.006x speedup, val set 3.087x speedup, step: 5
Epoch 86/200 |loss: -0.938345| train set 3.068x speedup, test set 1.059x speedup, val set 3.087x speedup, step: 6
Epoch 87/200 |loss: -0.939145| train set 3.068x speedup, test set 1.063x speedup, val set 3.087x speedup, step: 7
Epoch 88/200 |loss: -0.939614| train set 3.068x speedup, test set 1.064x speedup, val set 3.087x speedup, step: 8
Epoch 89/200 |loss: -0.940021| train set 3.068x speedup, test set 1.071x speedup, val set 3.087x speedup, step: 9
Epoch 90/200 |loss: -0.940748| train set 3.063x speedup, test set 1.060x speedup, val set 3.090x speedup, step: 10
Epoch 91/200 |loss: -0.941279| train set 3.063x speedup, test set 0.991x speedup, val set 3.090x speedup, step: 11
Epoch 92/200 |loss: -0.941649| train set 3.063x speedup, test set 1.065x speedup, val set 3.090x speedup, step: 12
Epoch 93/200 |loss: -0.942195| train set 3.062x speedup, test set 1.088x speedup, val set 3.089x speedup, step: 13
Epoch 94/200 |loss: -0.942739| train set 3.062x speedup, test set 1.083x speedup, val set 3.089x speedup, step: 14
Epoch 95/200 |loss: -0.943111| train set 3.063x speedup, test set 1.093x speedup, val set 3.090x speedup, step: 15
Epoch 96/200 |loss: -0.943541| train set 3.063x speedup, test set 1.093x speedup, val set 3.090x speedup, step: 16
Epoch 97/200 |loss: -0.943895| train set 3.063x speedup, test set 1.087x speedup, val set 3.090x speedup, step: 17
Epoch 98/200 |loss: -0.944200| train set 3.063x speedup, test set 1.087x speedup, val set 3.090x speedup, step: 18
Epoch 99/200 |loss: -0.944482| train set 3.063x speedup, test set 1.087x speedup, val set 3.090x speedup, step: 19
Epoch 100/200 |loss: -0.944734| train set 3.063x speedup, test set 1.097x speedup, val set 3.090x speedup, step: 20
Epoch 101/200 |loss: -0.945003| train set 3.063x speedup, test set 1.101x speedup, val set 3.090x speedup, step: 21
Epoch 102/200 |loss: -0.945305| train set 3.063x speedup, test set 1.101x speedup, val set 3.090x speedup, step: 22
Epoch 103/200 |loss: -0.945543| train set 3.063x speedup, test set 1.151x speedup, val set 3.090x speedup, step: 23
Epoch 104/200 |loss: -0.945745| train set 3.063x speedup, test set 1.149x speedup, val set 3.090x speedup, step: 24
Epoch 105/200 |loss: -0.945957| train set 3.063x speedup, test set 1.149x speedup, val set 3.090x speedup, step: 25
Epoch 106/200 |loss: -0.946136| train set 3.063x speedup, test set 1.144x speedup, val set 3.090x speedup, step: 26
Epoch 107/200 |loss: -0.946309| train set 3.063x speedup, test set 1.064x speedup, val set 3.090x speedup, step: 27
Epoch 108/200 |loss: -0.946484| train set 3.063x speedup, test set 1.064x speedup, val set 3.090x speedup, step: 28
Epoch 109/200 |loss: -0.946637| train set 3.063x speedup, test set 1.059x speedup, val set 3.090x speedup, step: 29
Epoch 110/200 |loss: -0.946771| train set 3.158x speedup, test set 1.059x speedup, val set 3.148x speedup, step: 30
Epoch 111/200 |loss: -0.946888| train set 3.158x speedup, test set 1.048x speedup, val set 3.148x speedup, step: 31
Epoch 112/200 |loss: -0.947011| train set 3.158x speedup, test set 1.048x speedup, val set 3.148x speedup, step: 32
Epoch 113/200 |loss: -0.947127| train set 3.158x speedup, test set 1.125x speedup, val set 3.148x speedup, step: 33
Epoch 114/200 |loss: -0.947233| train set 3.158x speedup, test set 1.125x speedup, val set 3.148x speedup, step: 34
Epoch 115/200 |loss: -0.947331| train set 3.158x speedup, test set 1.125x speedup, val set 3.148x speedup, step: 35
Epoch 116/200 |loss: -0.947431| train set 3.365x speedup, test set 1.121x speedup, val set 3.386x speedup, step: 36
Epoch 117/200 |loss: -0.947525| train set 3.365x speedup, test set 1.034x speedup, val set 3.386x speedup, step: 37
Epoch 118/200 |loss: -0.947613| train set 3.365x speedup, test set 1.034x speedup, val set 3.386x speedup, step: 38
Epoch 119/200 |loss: -0.947705| train set 3.365x speedup, test set 0.873x speedup, val set 3.386x speedup, step: 39
Epoch 120/200 |loss: -0.947796| train set 3.365x speedup, test set 0.913x speedup, val set 3.386x speedup, step: 40
Epoch 121/200 |loss: -0.947891| train set 3.365x speedup, test set 0.913x speedup, val set 3.386x speedup, step: 41
Epoch 122/200 |loss: -0.947990| train set 3.365x speedup, test set 0.913x speedup, val set 3.386x speedup, step: 42
Epoch 123/200 |loss: -0.948086| train set 3.365x speedup, test set 0.913x speedup, val set 3.386x speedup, step: 43
Epoch 124/200 |loss: -0.948177| train set 3.717x speedup, test set 0.910x speedup, val set 3.804x speedup, step: 1
Epoch 125/200 |loss: -0.948261| train set 3.717x speedup, test set 0.910x speedup, val set 3.804x speedup, step: 1
Epoch 126/200 |loss: -0.948341| train set 3.717x speedup, test set 0.910x speedup, val set 3.804x speedup, step: 1
Epoch 127/200 |loss: -0.948418| train set 3.717x speedup, test set 0.910x speedup, val set 3.804x speedup, step: 1
Epoch 128/200 |loss: -0.948487| train set 3.717x speedup, test set 0.910x speedup, val set 3.804x speedup, step: 1
Epoch 129/200 |loss: -0.948547| train set 3.717x speedup, test set 0.910x speedup, val set 3.804x speedup, step: 1
Epoch 130/200 |loss: -0.948608| train set 3.483x speedup, test set 0.910x speedup, val set 3.540x speedup, step: 2
Epoch 131/200 |loss: -0.948680| train set 3.483x speedup, test set 0.910x speedup, val set 3.540x speedup, step: 3
Epoch 132/200 |loss: -0.948782| train set 3.483x speedup, test set 0.923x speedup, val set 3.540x speedup, step: 4
Epoch 133/200 |loss: -0.948850| train set 3.483x speedup, test set 0.923x speedup, val set 3.540x speedup, step: 5
Epoch 134/200 |loss: -0.948903| train set 3.483x speedup, test set 0.923x speedup, val set 3.540x speedup, step: 6
Epoch 135/200 |loss: -0.948968| train set 3.483x speedup, test set 0.923x speedup, val set 3.540x speedup, step: 7
Epoch 136/200 |loss: -0.949034| train set 3.483x speedup, test set 0.928x speedup, val set 3.540x speedup, step: 8
Epoch 137/200 |loss: -0.949100| train set 3.483x speedup, test set 0.928x speedup, val set 3.540x speedup, step: 9
Epoch 138/200 |loss: -0.949161| train set 3.483x speedup, test set 0.928x speedup, val set 3.540x speedup, step: 10
Epoch 139/200 |loss: -0.949222| train set 3.483x speedup, test set 0.928x speedup, val set 3.540x speedup, step: 11
Epoch 140/200 |loss: -0.949280| train set 3.483x speedup, test set 0.889x speedup, val set 3.540x speedup, step: 12
Epoch 141/200 |loss: -0.949336| train set 3.717x speedup, test set 0.894x speedup, val set 3.804x speedup, step: 1
Epoch 142/200 |loss: -0.949388| train set 3.717x speedup, test set 0.894x speedup, val set 3.804x speedup, step: 1
Epoch 143/200 |loss: -0.949429| train set 3.483x speedup, test set 0.894x speedup, val set 3.540x speedup, step: 2
Epoch 144/200 |loss: -0.949473| train set 3.483x speedup, test set 0.886x speedup, val set 3.540x speedup, step: 3
Epoch 145/200 |loss: -0.949517| train set 3.483x speedup, test set 0.924x speedup, val set 3.540x speedup, step: 4
Epoch 146/200 |loss: -0.949561| train set 3.483x speedup, test set 0.924x speedup, val set 3.540x speedup, step: 5
Epoch 147/200 |loss: -0.949601| train set 3.483x speedup, test set 0.924x speedup, val set 3.540x speedup, step: 6
Epoch 148/200 |loss: -0.949642| train set 3.483x speedup, test set 0.924x speedup, val set 3.540x speedup, step: 7
Epoch 149/200 |loss: -0.949679| train set 3.483x speedup, test set 0.924x speedup, val set 3.540x speedup, step: 8
Epoch 150/200 |loss: -0.949718| train set 3.483x speedup, test set 0.924x speedup, val set 3.540x speedup, step: 9
Epoch 151/200 |loss: -0.949759| train set 3.870x speedup, test set 0.924x speedup, val set 3.733x speedup, step: 10
Epoch 152/200 |loss: -0.949799| train set 3.870x speedup, test set 0.924x speedup, val set 3.934x speedup, step: 1
Epoch 153/200 |loss: -0.949838| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 154/200 |loss: -0.949878| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 155/200 |loss: -0.949926| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 156/200 |loss: -0.949974| train set 3.870x speedup, test set 0.936x speedup, val set 3.934x speedup, step: 1
Epoch 157/200 |loss: -0.950014| train set 3.870x speedup, test set 0.936x speedup, val set 3.934x speedup, step: 1
Epoch 158/200 |loss: -0.950051| train set 3.870x speedup, test set 0.936x speedup, val set 3.934x speedup, step: 1
Epoch 159/200 |loss: -0.950088| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 160/200 |loss: -0.950128| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 161/200 |loss: -0.950168| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 162/200 |loss: -0.950207| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 163/200 |loss: -0.950245| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 164/200 |loss: -0.950279| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 165/200 |loss: -0.950310| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 166/200 |loss: -0.950344| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 167/200 |loss: -0.950377| train set 3.870x speedup, test set 0.925x speedup, val set 3.934x speedup, step: 1
Epoch 168/200 |loss: -0.950411| train set 3.973x speedup, test set 0.931x speedup, val set 4.069x speedup, step: 1
Epoch 169/200 |loss: -0.950445| train set 3.973x speedup, test set 0.931x speedup, val set 4.069x speedup, step: 1
Epoch 170/200 |loss: -0.950477| train set 3.973x speedup, test set 0.892x speedup, val set 4.069x speedup, step: 1
Epoch 171/200 |loss: -0.950505| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 2
Epoch 172/200 |loss: -0.950533| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 3
Epoch 173/200 |loss: -0.950559| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 4
Epoch 174/200 |loss: -0.950588| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 5
Epoch 175/200 |loss: -0.950626| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 6
Epoch 176/200 |loss: -0.950660| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 7
Epoch 177/200 |loss: -0.950681| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 8
Epoch 178/200 |loss: -0.950698| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 9
Epoch 179/200 |loss: -0.950719| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 10
Epoch 180/200 |loss: -0.950744| train set 3.973x speedup, test set 0.892x speedup, val set 4.068x speedup, step: 11
Epoch 181/200 |loss: -0.950769| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 12
Epoch 182/200 |loss: -0.950798| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 13
Epoch 183/200 |loss: -0.950851| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 14
Epoch 184/200 |loss: -0.950893| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 15
Epoch 185/200 |loss: -0.950909| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 16
Epoch 186/200 |loss: -0.950930| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 17
Epoch 187/200 |loss: -0.950950| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 18
Epoch 188/200 |loss: -0.950973| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 19
Epoch 189/200 |loss: -0.950997| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 20
Epoch 190/200 |loss: -0.951018| train set 3.973x speedup, test set 0.891x speedup, val set 4.068x speedup, step: 21
Epoch 191/200 |loss: -0.951038| train set 4.176x speedup, test set 0.885x speedup, val set 4.068x speedup, step: 22
Epoch 192/200 |loss: -0.951056| train set 4.573x speedup, test set 0.885x speedup, val set 4.739x speedup, step: 1
Epoch 193/200 |loss: -0.951071| train set 4.573x speedup, test set 0.885x speedup, val set 4.739x speedup, step: 1
Epoch 194/200 |loss: -0.951086| train set 4.573x speedup, test set 0.885x speedup, val set 4.739x speedup, step: 1
Epoch 195/200 |loss: -0.951101| train set 4.573x speedup, test set 0.885x speedup, val set 4.739x speedup, step: 1
Epoch 196/200 |loss: -0.951117| train set 4.573x speedup, test set 0.885x speedup, val set 4.739x speedup, step: 1
Epoch 197/200 |loss: -0.951132| train set 4.573x speedup, test set 0.885x speedup, val set 4.739x speedup, step: 1
Epoch 198/200 |loss: -0.951145| train set 4.764x speedup, test set 0.885x speedup, val set 4.909x speedup, step: 1
Epoch 199/200 |loss: -0.951157| train set 4.914x speedup, test set 0.885x speedup, val set 5.114x speedup, step: 1
Training per epoch cost 0.566 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.007s, pg runtime 0.081s, speedup 11.534x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.846s, model runtime 3.507s, pg runtime 3.507s, speedup 1.000x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 1.666s, pg runtime 0.089s, speedup 0.054x
21, opt runtime 0.953s, model runtime 2.495s, pg runtime 4.730s, speedup 1.896x
22, opt runtime 0.093s, model runtime 3.355s, pg runtime 2.389s, speedup 0.712x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.765s, pg runtime 3.112s, speedup 0.826x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 5.350s, pg runtime 6.444s, speedup 1.204x
33, opt runtime 2.755s, model runtime 2.755s, pg runtime 5.521s, speedup 2.004x
====================
best train speedup epoch: 199, train speedup 4.914, test speedup 0.885, val speedup 5.114
best test speedup epoch: 11, train speedup 2.942, test speedup 2.184, val speedup 2.923
best validation speedup epoch: 199, train speedup 4.914, test speedup 0.885, val speedup 5.114
last model at epoch 199, train speedup 4.914, test speedup 0.885, val speedup 5.114
execution cost 0:06:45.773920
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:01.216473, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824188| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.832001| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837393| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841863| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846046| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850130| train set 2.942x speedup, test set 2.181x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853566| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856640| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.859961| train set 2.748x speedup, test set 2.077x speedup, val set 2.718x speedup, step: 2
Epoch 15/200 |loss: -0.861511| train set 2.783x speedup, test set 2.113x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866091| train set 2.801x speedup, test set 1.835x speedup, val set 2.770x speedup, step: 4
Epoch 17/200 |loss: -0.869830| train set 2.801x speedup, test set 1.733x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.873820| train set 2.946x speedup, test set 1.709x speedup, val set 2.928x speedup, step: 6
Epoch 19/200 |loss: -0.876280| train set 3.033x speedup, test set 1.709x speedup, val set 3.020x speedup, step: 1
Epoch 20/200 |loss: -0.878669| train set 2.850x speedup, test set 1.874x speedup, val set 2.842x speedup, step: 2
Epoch 21/200 |loss: -0.880154| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 3
Epoch 22/200 |loss: -0.881891| train set 2.918x speedup, test set 1.661x speedup, val set 2.936x speedup, step: 4
Epoch 23/200 |loss: -0.882894| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 24/200 |loss: -0.883895| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.885492| train set 3.046x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.888799| train set 3.034x speedup, test set 1.674x speedup, val set 3.073x speedup, step: 2
Epoch 27/200 |loss: -0.893039| train set 2.772x speedup, test set 1.651x speedup, val set 2.797x speedup, step: 3
Epoch 28/200 |loss: -0.895718| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 4
Epoch 29/200 |loss: -0.897014| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 5
Epoch 30/200 |loss: -0.897847| train set 2.772x speedup, test set 1.590x speedup, val set 2.797x speedup, step: 6
Epoch 31/200 |loss: -0.898513| train set 2.850x speedup, test set 1.607x speedup, val set 2.881x speedup, step: 7
Epoch 32/200 |loss: -0.899026| train set 2.850x speedup, test set 1.612x speedup, val set 2.881x speedup, step: 8
Epoch 33/200 |loss: -0.899587| train set 2.861x speedup, test set 1.612x speedup, val set 2.887x speedup, step: 9
Epoch 34/200 |loss: -0.900234| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 10
Epoch 35/200 |loss: -0.900889| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 11
Epoch 36/200 |loss: -0.901719| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 12
Epoch 37/200 |loss: -0.902506| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 13
Epoch 38/200 |loss: -0.903175| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 14
Epoch 39/200 |loss: -0.903696| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 15
Epoch 40/200 |loss: -0.904190| train set 2.861x speedup, test set 1.672x speedup, val set 2.887x speedup, step: 16
Epoch 41/200 |loss: -0.904690| train set 2.861x speedup, test set 1.672x speedup, val set 2.887x speedup, step: 17
Epoch 42/200 |loss: -0.905020| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 18
Epoch 43/200 |loss: -0.905318| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 19
Epoch 44/200 |loss: -0.905629| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 20
Epoch 45/200 |loss: -0.905951| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 21
Epoch 46/200 |loss: -0.906229| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 22
Epoch 47/200 |loss: -0.906558| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 23
Epoch 48/200 |loss: -0.906867| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 24
Epoch 49/200 |loss: -0.907181| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 25
Epoch 50/200 |loss: -0.907527| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 26
Epoch 51/200 |loss: -0.907872| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 27
Epoch 52/200 |loss: -0.908224| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 28
Epoch 53/200 |loss: -0.908619| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 29
Epoch 54/200 |loss: -0.909033| train set 3.156x speedup, test set 1.585x speedup, val set 3.211x speedup, step: 1
Epoch 55/200 |loss: -0.909456| train set 3.170x speedup, test set 1.584x speedup, val set 3.230x speedup, step: 1
Epoch 56/200 |loss: -0.909920| train set 3.170x speedup, test set 1.582x speedup, val set 3.230x speedup, step: 1
Epoch 57/200 |loss: -0.910404| train set 3.147x speedup, test set 1.562x speedup, val set 3.198x speedup, step: 2
Epoch 58/200 |loss: -0.910800| train set 3.147x speedup, test set 1.562x speedup, val set 3.198x speedup, step: 3
Epoch 59/200 |loss: -0.911293| train set 3.146x speedup, test set 1.561x speedup, val set 3.196x speedup, step: 4
Epoch 60/200 |loss: -0.911992| train set 3.146x speedup, test set 1.561x speedup, val set 3.196x speedup, step: 5
Epoch 61/200 |loss: -0.912682| train set 3.146x speedup, test set 1.561x speedup, val set 3.196x speedup, step: 6
Epoch 62/200 |loss: -0.913485| train set 3.133x speedup, test set 1.561x speedup, val set 3.179x speedup, step: 7
Epoch 63/200 |loss: -0.913950| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 8
Epoch 64/200 |loss: -0.915145| train set 3.057x speedup, test set 1.644x speedup, val set 3.136x speedup, step: 9
Epoch 65/200 |loss: -0.916133| train set 2.647x speedup, test set 1.644x speedup, val set 2.668x speedup, step: 10
Epoch 66/200 |loss: -0.916441| train set 3.057x speedup, test set 1.644x speedup, val set 3.136x speedup, step: 11
Epoch 67/200 |loss: -0.917358| train set 2.647x speedup, test set 1.645x speedup, val set 2.668x speedup, step: 12
Epoch 68/200 |loss: -0.918468| train set 2.647x speedup, test set 1.645x speedup, val set 2.668x speedup, step: 13
Epoch 69/200 |loss: -0.919317| train set 2.593x speedup, test set 1.624x speedup, val set 2.637x speedup, step: 14
Epoch 70/200 |loss: -0.922905| train set 2.648x speedup, test set 1.625x speedup, val set 2.669x speedup, step: 15
Epoch 71/200 |loss: -0.921153| train set 3.146x speedup, test set 1.118x speedup, val set 3.196x speedup, step: 16
Epoch 72/200 |loss: -0.931067| train set 3.146x speedup, test set 1.157x speedup, val set 3.196x speedup, step: 17
Epoch 73/200 |loss: -0.927311| train set 3.146x speedup, test set 1.157x speedup, val set 3.196x speedup, step: 18
Epoch 74/200 |loss: -0.932638| train set 3.146x speedup, test set 1.129x speedup, val set 3.196x speedup, step: 19
Epoch 75/200 |loss: -0.932710| train set 3.146x speedup, test set 1.132x speedup, val set 3.196x speedup, step: 20
Epoch 76/200 |loss: -0.934802| train set 3.146x speedup, test set 1.111x speedup, val set 3.196x speedup, step: 21
Epoch 77/200 |loss: -0.935471| train set 3.146x speedup, test set 1.147x speedup, val set 3.196x speedup, step: 22
Epoch 78/200 |loss: -0.936325| train set 3.146x speedup, test set 1.097x speedup, val set 3.196x speedup, step: 23
Epoch 79/200 |loss: -0.937222| train set 3.145x speedup, test set 1.052x speedup, val set 3.196x speedup, step: 24
Epoch 80/200 |loss: -0.939029| train set 3.146x speedup, test set 1.053x speedup, val set 3.196x speedup, step: 25
Epoch 81/200 |loss: -0.940267| train set 3.146x speedup, test set 1.055x speedup, val set 3.196x speedup, step: 26
Epoch 82/200 |loss: -0.941210| train set 3.140x speedup, test set 1.042x speedup, val set 3.200x speedup, step: 27
Epoch 83/200 |loss: -0.942286| train set 3.140x speedup, test set 1.025x speedup, val set 3.200x speedup, step: 28
Epoch 84/200 |loss: -0.943052| train set 3.156x speedup, test set 1.018x speedup, val set 3.211x speedup, step: 29
Epoch 85/200 |loss: -0.943356| train set 3.127x speedup, test set 1.056x speedup, val set 3.183x speedup, step: 30
Epoch 86/200 |loss: -0.944550| train set 2.949x speedup, test set 1.052x speedup, val set 2.921x speedup, step: 31
Epoch 87/200 |loss: -0.944651| train set 2.949x speedup, test set 1.052x speedup, val set 2.921x speedup, step: 32
Epoch 88/200 |loss: -0.945495| train set 2.949x speedup, test set 1.087x speedup, val set 2.921x speedup, step: 33
Epoch 89/200 |loss: -0.945793| train set 2.986x speedup, test set 1.095x speedup, val set 2.959x speedup, step: 34
Epoch 90/200 |loss: -0.946875| train set 2.986x speedup, test set 1.095x speedup, val set 2.959x speedup, step: 35
Epoch 91/200 |loss: -0.946853| train set 2.960x speedup, test set 1.095x speedup, val set 2.935x speedup, step: 36
Epoch 92/200 |loss: -0.947285| train set 2.949x speedup, test set 1.095x speedup, val set 2.921x speedup, step: 37
Epoch 93/200 |loss: -0.948041| train set 2.974x speedup, test set 1.095x speedup, val set 2.944x speedup, step: 38
Epoch 94/200 |loss: -0.948384| train set 2.974x speedup, test set 1.100x speedup, val set 2.944x speedup, step: 39
Epoch 95/200 |loss: -0.948934| train set 2.916x speedup, test set 1.099x speedup, val set 2.873x speedup, step: 40
Epoch 96/200 |loss: -0.947972| train set 2.949x speedup, test set 1.036x speedup, val set 2.921x speedup, step: 41
Epoch 97/200 |loss: -0.934373| train set 2.891x speedup, test set 1.119x speedup, val set 2.851x speedup, step: 42
Epoch 98/200 |loss: -0.947178| train set 2.917x speedup, test set 1.152x speedup, val set 2.874x speedup, step: 43
Epoch 99/200 |loss: -0.943770| train set 2.892x speedup, test set 1.158x speedup, val set 2.852x speedup, step: 44
Epoch 100/200 |loss: -0.946362| train set 2.892x speedup, test set 1.144x speedup, val set 2.851x speedup, step: 45
early stopping at epoch 100
Training per epoch cost 0.643 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.502s, pg runtime 0.207s, speedup 0.412x
04, opt runtime 0.920s, model runtime 0.920s, pg runtime 1.680s, speedup 1.825x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 4.298s, pg runtime 3.507s, speedup 0.816x
11, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
14, opt runtime 0.113s, model runtime 0.198s, pg runtime 0.153s, speedup 0.772x
15, opt runtime 2.238s, model runtime 3.296s, pg runtime 2.718s, speedup 0.825x
16, opt runtime 0.441s, model runtime 0.507s, pg runtime 0.453s, speedup 0.895x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.064s, model runtime 0.077s, pg runtime 0.089s, speedup 1.158x
21, opt runtime 0.953s, model runtime 5.597s, pg runtime 4.730s, speedup 0.845x
22, opt runtime 0.093s, model runtime 0.216s, pg runtime 2.389s, speedup 11.054x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.167s, pg runtime 0.158s, speedup 0.947x
30, opt runtime 1.646s, model runtime 1.646s, pg runtime 4.855s, speedup 2.949x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 6.444s, pg runtime 6.444s, speedup 1.000x
33, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
====================
best train speedup epoch: 55, train speedup 3.170, test speedup 1.584, val speedup 3.230
best test speedup epoch: 12, train speedup 2.930, test speedup 2.184, val speedup 2.907
best validation speedup epoch: 56, train speedup 3.170, test speedup 1.582, val speedup 3.230
last model at epoch 100, train speedup 2.892, test speedup 1.144, val speedup 2.851
execution cost 0:03:49.319101
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:01.524047, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824188| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.832001| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837393| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841863| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846046| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850130| train set 2.942x speedup, test set 2.181x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853566| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856640| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.859961| train set 2.748x speedup, test set 2.077x speedup, val set 2.718x speedup, step: 2
Epoch 15/200 |loss: -0.861511| train set 2.783x speedup, test set 2.113x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866091| train set 2.801x speedup, test set 1.835x speedup, val set 2.770x speedup, step: 4
Epoch 17/200 |loss: -0.869830| train set 2.801x speedup, test set 1.733x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.873820| train set 2.946x speedup, test set 1.709x speedup, val set 2.928x speedup, step: 6
Epoch 19/200 |loss: -0.876280| train set 3.033x speedup, test set 1.709x speedup, val set 3.020x speedup, step: 1
Epoch 20/200 |loss: -0.878669| train set 2.850x speedup, test set 1.874x speedup, val set 2.842x speedup, step: 2
Epoch 21/200 |loss: -0.880154| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 3
Epoch 22/200 |loss: -0.881891| train set 2.918x speedup, test set 1.661x speedup, val set 2.936x speedup, step: 4
Epoch 23/200 |loss: -0.882894| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 24/200 |loss: -0.883895| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.885492| train set 3.046x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.888799| train set 3.034x speedup, test set 1.674x speedup, val set 3.073x speedup, step: 2
Epoch 27/200 |loss: -0.893039| train set 2.772x speedup, test set 1.651x speedup, val set 2.797x speedup, step: 3
Epoch 28/200 |loss: -0.895718| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 4
Epoch 29/200 |loss: -0.897014| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 5
Epoch 30/200 |loss: -0.897847| train set 2.772x speedup, test set 1.590x speedup, val set 2.797x speedup, step: 6
Epoch 31/200 |loss: -0.898513| train set 2.850x speedup, test set 1.607x speedup, val set 2.881x speedup, step: 7
Epoch 32/200 |loss: -0.899026| train set 2.850x speedup, test set 1.612x speedup, val set 2.881x speedup, step: 8
Epoch 33/200 |loss: -0.899587| train set 2.861x speedup, test set 1.612x speedup, val set 2.887x speedup, step: 9
Epoch 34/200 |loss: -0.900234| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 10
Epoch 35/200 |loss: -0.900889| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 11
Epoch 36/200 |loss: -0.901719| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 12
Epoch 37/200 |loss: -0.902506| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 13
Epoch 38/200 |loss: -0.903175| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 14
Epoch 39/200 |loss: -0.903696| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 15
Epoch 40/200 |loss: -0.904190| train set 2.861x speedup, test set 1.672x speedup, val set 2.887x speedup, step: 16
Epoch 41/200 |loss: -0.904690| train set 2.861x speedup, test set 1.672x speedup, val set 2.887x speedup, step: 17
Epoch 42/200 |loss: -0.905020| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 18
Epoch 43/200 |loss: -0.905318| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 19
Epoch 44/200 |loss: -0.905629| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 20
Epoch 45/200 |loss: -0.905951| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 21
Epoch 46/200 |loss: -0.906229| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 22
Epoch 47/200 |loss: -0.906558| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 23
Epoch 48/200 |loss: -0.906867| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 24
Epoch 49/200 |loss: -0.907181| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 25
Epoch 50/200 |loss: -0.907531| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 26
Epoch 51/200 |loss: -0.907873| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 27
Epoch 52/200 |loss: -0.908227| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 28
Epoch 53/200 |loss: -0.908617| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 29
Epoch 54/200 |loss: -0.909033| train set 3.169x speedup, test set 1.585x speedup, val set 3.228x speedup, step: 1
Epoch 55/200 |loss: -0.909451| train set 3.170x speedup, test set 1.583x speedup, val set 3.230x speedup, step: 1
Epoch 56/200 |loss: -0.909914| train set 3.170x speedup, test set 1.583x speedup, val set 3.230x speedup, step: 1
Epoch 57/200 |loss: -0.910411| train set 3.147x speedup, test set 1.562x speedup, val set 3.198x speedup, step: 2
Epoch 58/200 |loss: -0.910887| train set 3.147x speedup, test set 1.644x speedup, val set 3.198x speedup, step: 3
Epoch 59/200 |loss: -0.911362| train set 3.147x speedup, test set 1.644x speedup, val set 3.198x speedup, step: 4
Epoch 60/200 |loss: -0.912059| train set 3.146x speedup, test set 1.562x speedup, val set 3.196x speedup, step: 5
Epoch 61/200 |loss: -0.912761| train set 3.146x speedup, test set 1.643x speedup, val set 3.196x speedup, step: 6
Epoch 62/200 |loss: -0.913463| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 7
Epoch 63/200 |loss: -0.913980| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 8
Epoch 64/200 |loss: -0.914958| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 9
Epoch 65/200 |loss: -0.916023| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 10
Epoch 66/200 |loss: -0.916514| train set 3.057x speedup, test set 1.645x speedup, val set 3.136x speedup, step: 11
Epoch 67/200 |loss: -0.920709| train set 3.057x speedup, test set 1.625x speedup, val set 3.136x speedup, step: 12
Epoch 68/200 |loss: -0.926011| train set 3.133x speedup, test set 1.115x speedup, val set 3.179x speedup, step: 13
Epoch 69/200 |loss: -0.921376| train set 3.133x speedup, test set 1.108x speedup, val set 3.179x speedup, step: 14
Epoch 70/200 |loss: -0.924563| train set 3.146x speedup, test set 1.073x speedup, val set 3.196x speedup, step: 15
Epoch 71/200 |loss: -0.927982| train set 3.146x speedup, test set 1.138x speedup, val set 3.196x speedup, step: 16
Epoch 72/200 |loss: -0.918677| train set 1.849x speedup, test set 1.176x speedup, val set 1.862x speedup, step: 17
Epoch 73/200 |loss: -0.917464| train set 3.147x speedup, test set 1.119x speedup, val set 3.198x speedup, step: 18
Epoch 74/200 |loss: -0.929690| train set 3.080x speedup, test set 1.090x speedup, val set 3.112x speedup, step: 19
Epoch 75/200 |loss: -0.923107| train set 3.024x speedup, test set 1.080x speedup, val set 3.044x speedup, step: 20
Epoch 76/200 |loss: -0.919324| train set 2.755x speedup, test set 1.087x speedup, val set 2.797x speedup, step: 21
Epoch 77/200 |loss: -0.920974| train set 2.736x speedup, test set 1.047x speedup, val set 2.774x speedup, step: 22
early stopping at epoch 77
Training per epoch cost 0.572 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.502s, pg runtime 0.207s, speedup 0.412x
04, opt runtime 0.920s, model runtime 0.920s, pg runtime 1.680s, speedup 1.825x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 4.298s, pg runtime 3.507s, speedup 0.816x
11, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
14, opt runtime 0.113s, model runtime 0.198s, pg runtime 0.153s, speedup 0.772x
15, opt runtime 2.238s, model runtime 3.296s, pg runtime 2.718s, speedup 0.825x
16, opt runtime 0.441s, model runtime 0.507s, pg runtime 0.453s, speedup 0.895x
17, opt runtime 0.327s, model runtime 0.327s, pg runtime 0.354s, speedup 1.083x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.064s, model runtime 0.077s, pg runtime 0.089s, speedup 1.158x
21, opt runtime 0.953s, model runtime 5.597s, pg runtime 4.730s, speedup 0.845x
22, opt runtime 0.093s, model runtime 0.216s, pg runtime 2.389s, speedup 11.054x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.167s, pg runtime 0.158s, speedup 0.947x
30, opt runtime 1.646s, model runtime 1.646s, pg runtime 4.855s, speedup 2.949x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 6.444s, pg runtime 6.444s, speedup 1.000x
33, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
====================
best train speedup epoch: 55, train speedup 3.170, test speedup 1.583, val speedup 3.230
best test speedup epoch: 12, train speedup 2.930, test speedup 2.184, val speedup 2.907
best validation speedup epoch: 56, train speedup 3.170, test speedup 1.583, val speedup 3.230
last model at epoch 77, train speedup 2.736, test speedup 1.047, val speedup 2.774
execution cost 0:02:46.901109
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:01.624923, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824188| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.832001| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837393| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841863| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846046| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850130| train set 2.942x speedup, test set 2.181x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853566| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856640| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.859961| train set 2.748x speedup, test set 2.077x speedup, val set 2.718x speedup, step: 2
Epoch 15/200 |loss: -0.861511| train set 2.783x speedup, test set 2.113x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866091| train set 2.801x speedup, test set 1.835x speedup, val set 2.770x speedup, step: 4
Epoch 17/200 |loss: -0.869830| train set 2.801x speedup, test set 1.733x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.873820| train set 2.946x speedup, test set 1.709x speedup, val set 2.928x speedup, step: 6
Epoch 19/200 |loss: -0.876280| train set 3.033x speedup, test set 1.709x speedup, val set 3.020x speedup, step: 1
Epoch 20/200 |loss: -0.878669| train set 2.850x speedup, test set 1.874x speedup, val set 2.842x speedup, step: 2
Epoch 21/200 |loss: -0.880154| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 3
Epoch 22/200 |loss: -0.881891| train set 2.918x speedup, test set 1.661x speedup, val set 2.936x speedup, step: 4
Epoch 23/200 |loss: -0.882894| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 24/200 |loss: -0.883895| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.885492| train set 3.046x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.888799| train set 3.034x speedup, test set 1.674x speedup, val set 3.073x speedup, step: 2
Epoch 27/200 |loss: -0.893039| train set 2.772x speedup, test set 1.651x speedup, val set 2.797x speedup, step: 3
Epoch 28/200 |loss: -0.895718| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 4
Epoch 29/200 |loss: -0.897014| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 5
Epoch 30/200 |loss: -0.897847| train set 2.772x speedup, test set 1.590x speedup, val set 2.797x speedup, step: 6
Epoch 31/200 |loss: -0.898513| train set 2.850x speedup, test set 1.607x speedup, val set 2.881x speedup, step: 7
Epoch 32/200 |loss: -0.899026| train set 2.850x speedup, test set 1.612x speedup, val set 2.881x speedup, step: 8
Epoch 33/200 |loss: -0.899587| train set 2.861x speedup, test set 1.612x speedup, val set 2.887x speedup, step: 9
Epoch 34/200 |loss: -0.900234| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 10
Epoch 35/200 |loss: -0.900889| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 11
Epoch 36/200 |loss: -0.901719| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 12
Epoch 37/200 |loss: -0.902506| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 13
Epoch 38/200 |loss: -0.903175| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 14
Epoch 39/200 |loss: -0.903696| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 15
Epoch 40/200 |loss: -0.904190| train set 2.861x speedup, test set 1.672x speedup, val set 2.887x speedup, step: 16
Epoch 41/200 |loss: -0.904685| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 17
Epoch 42/200 |loss: -0.905021| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 18
Epoch 43/200 |loss: -0.905324| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 19
Epoch 44/200 |loss: -0.905641| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 20
Epoch 45/200 |loss: -0.905953| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 21
Epoch 46/200 |loss: -0.906243| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 22
Epoch 47/200 |loss: -0.906563| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 23
Epoch 48/200 |loss: -0.906868| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 24
Epoch 49/200 |loss: -0.907209| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 25
Epoch 50/200 |loss: -0.907563| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 26
Epoch 51/200 |loss: -0.907898| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 27
Epoch 52/200 |loss: -0.908256| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 28
Epoch 53/200 |loss: -0.908646| train set 3.156x speedup, test set 1.588x speedup, val set 3.211x speedup, step: 1
Epoch 54/200 |loss: -0.909063| train set 3.156x speedup, test set 1.583x speedup, val set 3.211x speedup, step: 1
Epoch 55/200 |loss: -0.909489| train set 3.156x speedup, test set 1.583x speedup, val set 3.211x speedup, step: 1
Epoch 56/200 |loss: -0.909980| train set 3.157x speedup, test set 1.582x speedup, val set 3.212x speedup, step: 1
Epoch 57/200 |loss: -0.910470| train set 3.134x speedup, test set 1.582x speedup, val set 3.181x speedup, step: 2
Epoch 58/200 |loss: -0.910946| train set 3.134x speedup, test set 1.562x speedup, val set 3.181x speedup, step: 3
Epoch 59/200 |loss: -0.911562| train set 3.134x speedup, test set 1.561x speedup, val set 3.181x speedup, step: 4
Epoch 60/200 |loss: -0.912178| train set 3.133x speedup, test set 1.561x speedup, val set 3.179x speedup, step: 5
Epoch 61/200 |loss: -0.912732| train set 3.133x speedup, test set 1.561x speedup, val set 3.179x speedup, step: 6
Epoch 62/200 |loss: -0.913363| train set 3.133x speedup, test set 1.561x speedup, val set 3.179x speedup, step: 7
Epoch 63/200 |loss: -0.913693| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 8
Epoch 64/200 |loss: -0.914473| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 9
Epoch 65/200 |loss: -0.915527| train set 2.647x speedup, test set 1.562x speedup, val set 2.668x speedup, step: 10
Epoch 66/200 |loss: -0.916133| train set 2.594x speedup, test set 1.644x speedup, val set 2.638x speedup, step: 11
Epoch 67/200 |loss: -0.917834| train set 3.057x speedup, test set 1.580x speedup, val set 3.136x speedup, step: 12
Epoch 68/200 |loss: -0.921947| train set 3.134x speedup, test set 1.622x speedup, val set 3.181x speedup, step: 13
Epoch 69/200 |loss: -0.917518| train set 3.069x speedup, test set 1.116x speedup, val set 3.097x speedup, step: 14
Epoch 70/200 |loss: -0.920272| train set 3.147x speedup, test set 1.092x speedup, val set 3.198x speedup, step: 15
Epoch 71/200 |loss: -0.925747| train set 3.147x speedup, test set 1.123x speedup, val set 3.198x speedup, step: 16
Epoch 72/200 |loss: -0.927401| train set 3.147x speedup, test set 1.136x speedup, val set 3.198x speedup, step: 17
Epoch 73/200 |loss: -0.919487| train set 1.871x speedup, test set 1.188x speedup, val set 1.889x speedup, step: 18
Epoch 74/200 |loss: -0.911526| train set 3.076x speedup, test set 1.129x speedup, val set 3.117x speedup, step: 19
Epoch 75/200 |loss: -0.924862| train set 3.081x speedup, test set 1.105x speedup, val set 3.114x speedup, step: 20
Epoch 76/200 |loss: -0.925505| train set 3.000x speedup, test set 1.118x speedup, val set 3.044x speedup, step: 21
Epoch 77/200 |loss: -0.924864| train set 2.988x speedup, test set 1.078x speedup, val set 3.019x speedup, step: 22
Epoch 78/200 |loss: -0.925657| train set 2.737x speedup, test set 1.066x speedup, val set 2.775x speedup, step: 23
Epoch 79/200 |loss: -0.925982| train set 2.737x speedup, test set 1.061x speedup, val set 2.775x speedup, step: 24
Epoch 80/200 |loss: -0.926706| train set 2.839x speedup, test set 1.087x speedup, val set 2.851x speedup, step: 25
Epoch 81/200 |loss: -0.928046| train set 2.839x speedup, test set 1.073x speedup, val set 2.851x speedup, step: 26
Epoch 82/200 |loss: -0.929347| train set 2.839x speedup, test set 1.073x speedup, val set 2.851x speedup, step: 27
Epoch 83/200 |loss: -0.931042| train set 2.931x speedup, test set 1.073x speedup, val set 2.937x speedup, step: 28
Epoch 84/200 |loss: -0.931347| train set 3.008x speedup, test set 1.067x speedup, val set 3.045x speedup, step: 29
Epoch 85/200 |loss: -0.932959| train set 3.008x speedup, test set 1.053x speedup, val set 3.045x speedup, step: 30
Epoch 86/200 |loss: -0.933637| train set 3.008x speedup, test set 1.050x speedup, val set 3.045x speedup, step: 31
Epoch 87/200 |loss: -0.934681| train set 3.008x speedup, test set 1.009x speedup, val set 3.045x speedup, step: 32
Epoch 88/200 |loss: -0.935707| train set 3.008x speedup, test set 1.009x speedup, val set 3.045x speedup, step: 33
Epoch 89/200 |loss: -0.936382| train set 3.008x speedup, test set 1.016x speedup, val set 3.045x speedup, step: 34
Epoch 90/200 |loss: -0.937309| train set 3.008x speedup, test set 1.016x speedup, val set 3.045x speedup, step: 35
Epoch 91/200 |loss: -0.937988| train set 3.008x speedup, test set 1.014x speedup, val set 3.045x speedup, step: 36
Epoch 92/200 |loss: -0.938680| train set 3.198x speedup, test set 1.015x speedup, val set 3.233x speedup, step: 1
Epoch 93/200 |loss: -0.939571| train set 3.198x speedup, test set 1.012x speedup, val set 3.233x speedup, step: 1
Epoch 94/200 |loss: -0.940014| train set 3.198x speedup, test set 1.006x speedup, val set 3.233x speedup, step: 1
Epoch 95/200 |loss: -0.940405| train set 3.198x speedup, test set 0.998x speedup, val set 3.233x speedup, step: 1
Epoch 96/200 |loss: -0.941062| train set 3.170x speedup, test set 0.989x speedup, val set 3.207x speedup, step: 2
Epoch 97/200 |loss: -0.942338| train set 3.170x speedup, test set 1.028x speedup, val set 3.207x speedup, step: 3
Epoch 98/200 |loss: -0.943641| train set 2.995x speedup, test set 1.024x speedup, val set 3.047x speedup, step: 4
Epoch 99/200 |loss: -0.944453| train set 2.995x speedup, test set 1.048x speedup, val set 3.047x speedup, step: 5
Epoch 100/200 |loss: -0.945360| train set 2.995x speedup, test set 1.074x speedup, val set 3.047x speedup, step: 6
Epoch 101/200 |loss: -0.946068| train set 3.075x speedup, test set 1.078x speedup, val set 3.116x speedup, step: 7
Epoch 102/200 |loss: -0.947060| train set 3.075x speedup, test set 1.078x speedup, val set 3.116x speedup, step: 8
Epoch 103/200 |loss: -0.947872| train set 3.075x speedup, test set 1.067x speedup, val set 3.116x speedup, step: 9
Epoch 104/200 |loss: -0.948492| train set 3.075x speedup, test set 1.067x speedup, val set 3.116x speedup, step: 10
Epoch 105/200 |loss: -0.949184| train set 3.075x speedup, test set 1.075x speedup, val set 3.116x speedup, step: 11
Epoch 106/200 |loss: -0.949771| train set 3.075x speedup, test set 1.113x speedup, val set 3.116x speedup, step: 12
Epoch 107/200 |loss: -0.950331| train set 3.075x speedup, test set 1.111x speedup, val set 3.116x speedup, step: 13
Epoch 108/200 |loss: -0.950796| train set 3.075x speedup, test set 1.105x speedup, val set 3.116x speedup, step: 14
Epoch 109/200 |loss: -0.951276| train set 3.075x speedup, test set 1.111x speedup, val set 3.116x speedup, step: 15
Epoch 110/200 |loss: -0.951065| train set 3.075x speedup, test set 1.117x speedup, val set 3.116x speedup, step: 16
Epoch 111/200 |loss: -0.950529| train set 3.075x speedup, test set 1.016x speedup, val set 3.116x speedup, step: 17
Epoch 112/200 |loss: -0.942657| train set 2.995x speedup, test set 1.033x speedup, val set 3.047x speedup, step: 18
Epoch 113/200 |loss: -0.941193| train set 2.995x speedup, test set 0.986x speedup, val set 3.047x speedup, step: 19
early stopping at epoch 113
Training per epoch cost 0.582 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.502s, pg runtime 0.207s, speedup 0.412x
04, opt runtime 0.920s, model runtime 0.920s, pg runtime 1.680s, speedup 1.825x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 3.063s, pg runtime 0.153s, speedup 0.050x
15, opt runtime 2.238s, model runtime 3.296s, pg runtime 2.718s, speedup 0.825x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.733s, pg runtime 0.354s, speedup 0.482x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 1.666s, pg runtime 0.089s, speedup 0.054x
21, opt runtime 0.953s, model runtime 2.495s, pg runtime 4.730s, speedup 1.896x
22, opt runtime 0.093s, model runtime 3.355s, pg runtime 2.389s, speedup 0.712x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.765s, pg runtime 3.112s, speedup 0.826x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 6.208s, pg runtime 5.521s, speedup 0.889x
====================
best train speedup epoch: 92, train speedup 3.198, test speedup 1.015, val speedup 3.233
best test speedup epoch: 12, train speedup 2.930, test speedup 2.184, val speedup 2.907
best validation speedup epoch: 95, train speedup 3.198, test speedup 0.998, val speedup 3.233
last model at epoch 113, train speedup 2.995, test speedup 0.986, val speedup 3.047
execution cost 0:03:59.805276
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:01.066816, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824188| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.832001| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837393| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841863| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846046| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850130| train set 2.942x speedup, test set 2.181x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853566| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856640| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.859961| train set 2.748x speedup, test set 2.077x speedup, val set 2.718x speedup, step: 2
Epoch 15/200 |loss: -0.861511| train set 2.783x speedup, test set 2.113x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866091| train set 2.801x speedup, test set 1.835x speedup, val set 2.770x speedup, step: 4
Epoch 17/200 |loss: -0.869830| train set 2.801x speedup, test set 1.733x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.873820| train set 2.946x speedup, test set 1.709x speedup, val set 2.928x speedup, step: 6
Epoch 19/200 |loss: -0.876281| train set 3.033x speedup, test set 1.709x speedup, val set 3.020x speedup, step: 1
Epoch 20/200 |loss: -0.878669| train set 2.850x speedup, test set 1.874x speedup, val set 2.842x speedup, step: 2
Epoch 21/200 |loss: -0.880154| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 3
Epoch 22/200 |loss: -0.881891| train set 2.918x speedup, test set 1.661x speedup, val set 2.936x speedup, step: 4
Epoch 23/200 |loss: -0.882894| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 24/200 |loss: -0.883895| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.885492| train set 3.046x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.888798| train set 3.034x speedup, test set 1.674x speedup, val set 3.073x speedup, step: 2
Epoch 27/200 |loss: -0.893039| train set 2.772x speedup, test set 1.651x speedup, val set 2.797x speedup, step: 3
Epoch 28/200 |loss: -0.895718| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 4
Epoch 29/200 |loss: -0.897014| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 5
Epoch 30/200 |loss: -0.897847| train set 2.772x speedup, test set 1.590x speedup, val set 2.797x speedup, step: 6
Epoch 31/200 |loss: -0.898514| train set 2.850x speedup, test set 1.607x speedup, val set 2.881x speedup, step: 7
Epoch 32/200 |loss: -0.899026| train set 2.850x speedup, test set 1.612x speedup, val set 2.881x speedup, step: 8
Epoch 33/200 |loss: -0.899587| train set 2.861x speedup, test set 1.612x speedup, val set 2.887x speedup, step: 9
Epoch 34/200 |loss: -0.900233| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 10
Epoch 35/200 |loss: -0.900889| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 11
Epoch 36/200 |loss: -0.901716| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 12
Epoch 37/200 |loss: -0.902504| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 13
Epoch 38/200 |loss: -0.903174| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 14
Epoch 39/200 |loss: -0.903698| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 15
Epoch 40/200 |loss: -0.904185| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 16
Epoch 41/200 |loss: -0.904676| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 17
Epoch 42/200 |loss: -0.905022| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 18
Epoch 43/200 |loss: -0.905329| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 19
Epoch 44/200 |loss: -0.905659| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 20
Epoch 45/200 |loss: -0.905990| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 21
Epoch 46/200 |loss: -0.906321| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 22
Epoch 47/200 |loss: -0.906648| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 23
Epoch 48/200 |loss: -0.906951| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 24
Epoch 49/200 |loss: -0.907335| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 25
Epoch 50/200 |loss: -0.907675| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 26
Epoch 51/200 |loss: -0.908011| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 27
Epoch 52/200 |loss: -0.908385| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 28
Epoch 53/200 |loss: -0.908747| train set 3.156x speedup, test set 1.585x speedup, val set 3.211x speedup, step: 1
Epoch 54/200 |loss: -0.909227| train set 3.157x speedup, test set 1.583x speedup, val set 3.212x speedup, step: 1
Epoch 55/200 |loss: -0.909693| train set 3.134x speedup, test set 1.583x speedup, val set 3.181x speedup, step: 2
Epoch 56/200 |loss: -0.910190| train set 3.134x speedup, test set 1.563x speedup, val set 3.181x speedup, step: 3
Epoch 57/200 |loss: -0.910665| train set 3.134x speedup, test set 1.562x speedup, val set 3.181x speedup, step: 4
Epoch 58/200 |loss: -0.910741| train set 3.134x speedup, test set 1.562x speedup, val set 3.181x speedup, step: 5
Epoch 59/200 |loss: -0.911612| train set 3.134x speedup, test set 1.561x speedup, val set 3.181x speedup, step: 6
Epoch 60/200 |loss: -0.912204| train set 3.134x speedup, test set 1.562x speedup, val set 3.181x speedup, step: 7
Epoch 61/200 |loss: -0.912950| train set 3.147x speedup, test set 1.643x speedup, val set 3.198x speedup, step: 8
Epoch 62/200 |loss: -0.913635| train set 3.147x speedup, test set 1.620x speedup, val set 3.198x speedup, step: 9
Epoch 63/200 |loss: -0.914569| train set 3.147x speedup, test set 1.601x speedup, val set 3.198x speedup, step: 10
Epoch 64/200 |loss: -0.915346| train set 3.147x speedup, test set 1.621x speedup, val set 3.198x speedup, step: 11
Epoch 65/200 |loss: -0.916477| train set 3.147x speedup, test set 1.621x speedup, val set 3.198x speedup, step: 12
Epoch 66/200 |loss: -0.917431| train set 3.058x speedup, test set 1.644x speedup, val set 3.137x speedup, step: 13
Epoch 67/200 |loss: -0.918210| train set 2.594x speedup, test set 1.646x speedup, val set 2.638x speedup, step: 14
Epoch 68/200 |loss: -0.918475| train set 2.594x speedup, test set 1.668x speedup, val set 2.638x speedup, step: 15
Epoch 69/200 |loss: -0.914203| train set 2.648x speedup, test set 1.646x speedup, val set 2.669x speedup, step: 16
Epoch 70/200 |loss: -0.913607| train set 2.647x speedup, test set 1.377x speedup, val set 2.669x speedup, step: 17
Epoch 71/200 |loss: -0.907896| train set 2.648x speedup, test set 1.398x speedup, val set 2.669x speedup, step: 18
early stopping at epoch 71
Training per epoch cost 0.570 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.502s, pg runtime 0.207s, speedup 0.412x
04, opt runtime 0.920s, model runtime 0.920s, pg runtime 1.680s, speedup 1.825x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 4.298s, pg runtime 3.507s, speedup 0.816x
11, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 5.597s, pg runtime 57.198s, speedup 10.219x
14, opt runtime 0.113s, model runtime 0.198s, pg runtime 0.153s, speedup 0.772x
15, opt runtime 2.238s, model runtime 3.296s, pg runtime 2.718s, speedup 0.825x
16, opt runtime 0.441s, model runtime 0.507s, pg runtime 0.453s, speedup 0.895x
17, opt runtime 0.327s, model runtime 0.349s, pg runtime 0.354s, speedup 1.012x
18, opt runtime 2.962s, model runtime 8.622s, pg runtime 6.876s, speedup 0.798x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.064s, model runtime 0.077s, pg runtime 0.089s, speedup 1.158x
21, opt runtime 0.953s, model runtime 5.597s, pg runtime 4.730s, speedup 0.845x
22, opt runtime 0.093s, model runtime 0.216s, pg runtime 2.389s, speedup 11.054x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
25, opt runtime 4.173s, model runtime 10.634s, pg runtime 8.279s, speedup 0.778x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.077s, pg runtime 0.239s, speedup 3.099x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
30, opt runtime 1.646s, model runtime 1.646s, pg runtime 4.855s, speedup 2.949x
31, opt runtime 2.971s, model runtime 10.045s, pg runtime 8.605s, speedup 0.857x
32, opt runtime 4.513s, model runtime 6.444s, pg runtime 6.444s, speedup 1.000x
33, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
====================
best train speedup epoch: 54, train speedup 3.157, test speedup 1.583, val speedup 3.212
best test speedup epoch: 12, train speedup 2.930, test speedup 2.184, val speedup 2.907
best validation speedup epoch: 54, train speedup 3.157, test speedup 1.583, val speedup 3.212
last model at epoch 71, train speedup 2.648, test speedup 1.398, val speedup 2.669
execution cost 0:02:30.135432
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:01.672599, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824186| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.832015| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837404| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841878| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846056| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850130| train set 2.942x speedup, test set 2.184x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853543| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856704| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.860041| train set 2.748x speedup, test set 2.077x speedup, val set 2.718x speedup, step: 2
Epoch 15/200 |loss: -0.861594| train set 2.783x speedup, test set 2.078x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866186| train set 2.801x speedup, test set 1.835x speedup, val set 2.770x speedup, step: 4
Epoch 17/200 |loss: -0.869748| train set 2.801x speedup, test set 1.709x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.873895| train set 2.645x speedup, test set 1.709x speedup, val set 2.620x speedup, step: 6
Epoch 19/200 |loss: -0.876739| train set 2.773x speedup, test set 1.733x speedup, val set 2.761x speedup, step: 7
Epoch 20/200 |loss: -0.878795| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 8
Epoch 21/200 |loss: -0.880200| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 9
Epoch 22/200 |loss: -0.881802| train set 3.047x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 23/200 |loss: -0.882779| train set 2.986x speedup, test set 1.653x speedup, val set 3.021x speedup, step: 2
Epoch 24/200 |loss: -0.883803| train set 3.047x speedup, test set 1.654x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.884999| train set 3.047x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.887214| train set 3.047x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 27/200 |loss: -0.891092| train set 2.783x speedup, test set 1.615x speedup, val set 2.819x speedup, step: 2
Epoch 28/200 |loss: -0.894467| train set 2.446x speedup, test set 1.615x speedup, val set 2.481x speedup, step: 3
Epoch 29/200 |loss: -0.896626| train set 2.446x speedup, test set 1.615x speedup, val set 2.482x speedup, step: 4
Epoch 30/200 |loss: -0.897274| train set 2.508x speedup, test set 1.612x speedup, val set 2.548x speedup, step: 5
Epoch 31/200 |loss: -0.898115| train set 2.517x speedup, test set 1.612x speedup, val set 2.553x speedup, step: 6
Epoch 32/200 |loss: -0.898764| train set 2.517x speedup, test set 1.638x speedup, val set 2.553x speedup, step: 7
Epoch 33/200 |loss: -0.899461| train set 2.517x speedup, test set 1.643x speedup, val set 2.553x speedup, step: 8
Epoch 34/200 |loss: -0.899905| train set 2.862x speedup, test set 1.643x speedup, val set 2.888x speedup, step: 9
Epoch 35/200 |loss: -0.900910| train set 2.862x speedup, test set 1.643x speedup, val set 2.888x speedup, step: 10
Epoch 36/200 |loss: -0.901657| train set 2.861x speedup, test set 1.560x speedup, val set 2.887x speedup, step: 11
Epoch 37/200 |loss: -0.902196| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 12
Epoch 38/200 |loss: -0.902961| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 13
Epoch 39/200 |loss: -0.903425| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 14
Epoch 40/200 |loss: -0.903914| train set 2.861x speedup, test set 1.586x speedup, val set 2.887x speedup, step: 15
Epoch 41/200 |loss: -0.904368| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 16
Epoch 42/200 |loss: -0.904726| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 17
Epoch 43/200 |loss: -0.905104| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 18
Epoch 44/200 |loss: -0.905370| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 19
Epoch 45/200 |loss: -0.905693| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 20
Epoch 46/200 |loss: -0.906033| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 21
Epoch 47/200 |loss: -0.906382| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 22
Epoch 48/200 |loss: -0.906692| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 23
Epoch 49/200 |loss: -0.906993| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 50/200 |loss: -0.907306| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 51/200 |loss: -0.907621| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 52/200 |loss: -0.907976| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 53/200 |loss: -0.908349| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 54/200 |loss: -0.908749| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 55/200 |loss: -0.909196| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 56/200 |loss: -0.909330| train set 3.156x speedup, test set 1.587x speedup, val set 3.211x speedup, step: 1
Epoch 57/200 |loss: -0.909684| train set 3.134x speedup, test set 1.587x speedup, val set 3.181x speedup, step: 2
Epoch 58/200 |loss: -0.909999| train set 3.147x speedup, test set 1.584x speedup, val set 3.198x speedup, step: 3
Epoch 59/200 |loss: -0.911093| train set 3.147x speedup, test set 1.645x speedup, val set 3.198x speedup, step: 4
Epoch 60/200 |loss: -0.911542| train set 3.146x speedup, test set 1.644x speedup, val set 3.196x speedup, step: 5
Epoch 61/200 |loss: -0.912082| train set 3.146x speedup, test set 1.644x speedup, val set 3.196x speedup, step: 6
Epoch 62/200 |loss: -0.912591| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 7
Epoch 63/200 |loss: -0.913283| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 8
Epoch 64/200 |loss: -0.914286| train set 3.054x speedup, test set 1.644x speedup, val set 3.069x speedup, step: 9
Epoch 65/200 |loss: -0.914900| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 10
Epoch 66/200 |loss: -0.915677| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 11
Epoch 67/200 |loss: -0.916469| train set 3.119x speedup, test set 1.644x speedup, val set 3.151x speedup, step: 12
Epoch 68/200 |loss: -0.917081| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 13
Epoch 69/200 |loss: -0.918000| train set 3.146x speedup, test set 1.602x speedup, val set 3.196x speedup, step: 14
Epoch 70/200 |loss: -0.922316| train set 3.146x speedup, test set 1.571x speedup, val set 3.196x speedup, step: 15
Epoch 71/200 |loss: -0.924805| train set 3.146x speedup, test set 1.123x speedup, val set 3.196x speedup, step: 16
Epoch 72/200 |loss: -0.929215| train set 3.080x speedup, test set 1.123x speedup, val set 3.112x speedup, step: 17
Epoch 73/200 |loss: -0.929687| train set 3.146x speedup, test set 1.104x speedup, val set 3.196x speedup, step: 18
Epoch 74/200 |loss: -0.932927| train set 3.132x speedup, test set 1.145x speedup, val set 3.168x speedup, step: 19
Epoch 75/200 |loss: -0.932971| train set 3.067x speedup, test set 1.114x speedup, val set 3.085x speedup, step: 20
Epoch 76/200 |loss: -0.931248| train set 3.132x speedup, test set 1.176x speedup, val set 3.168x speedup, step: 21
Epoch 77/200 |loss: -0.936939| train set 3.126x speedup, test set 1.195x speedup, val set 3.172x speedup, step: 22
Epoch 78/200 |loss: -0.931403| train set 3.126x speedup, test set 1.202x speedup, val set 3.172x speedup, step: 23
Epoch 79/200 |loss: -0.937848| train set 3.061x speedup, test set 1.161x speedup, val set 3.089x speedup, step: 24
Epoch 80/200 |loss: -0.937032| train set 3.061x speedup, test set 1.205x speedup, val set 3.089x speedup, step: 25
Epoch 81/200 |loss: -0.938110| train set 3.062x speedup, test set 1.205x speedup, val set 3.090x speedup, step: 26
Epoch 82/200 |loss: -0.938160| train set 3.062x speedup, test set 1.138x speedup, val set 3.090x speedup, step: 27
Epoch 83/200 |loss: -0.938812| train set 3.061x speedup, test set 1.110x speedup, val set 3.089x speedup, step: 28
Epoch 84/200 |loss: -0.938215| train set 3.256x speedup, test set 1.108x speedup, val set 3.318x speedup, step: 1
Epoch 85/200 |loss: -0.940533| train set 3.256x speedup, test set 1.126x speedup, val set 3.318x speedup, step: 1
Epoch 86/200 |loss: -0.941551| train set 3.258x speedup, test set 1.125x speedup, val set 3.320x speedup, step: 1
Epoch 87/200 |loss: -0.942032| train set 3.258x speedup, test set 1.090x speedup, val set 3.320x speedup, step: 1
Epoch 88/200 |loss: -0.943583| train set 3.256x speedup, test set 1.115x speedup, val set 3.318x speedup, step: 2
Epoch 89/200 |loss: -0.944720| train set 3.063x speedup, test set 1.115x speedup, val set 3.090x speedup, step: 3
Epoch 90/200 |loss: -0.945775| train set 3.063x speedup, test set 1.105x speedup, val set 3.090x speedup, step: 4
Epoch 91/200 |loss: -0.946644| train set 3.063x speedup, test set 1.083x speedup, val set 3.090x speedup, step: 5
Epoch 92/200 |loss: -0.947477| train set 3.063x speedup, test set 1.085x speedup, val set 3.090x speedup, step: 6
Epoch 93/200 |loss: -0.947185| train set 3.062x speedup, test set 1.108x speedup, val set 3.089x speedup, step: 7
Epoch 94/200 |loss: -0.948159| train set 3.062x speedup, test set 1.098x speedup, val set 3.089x speedup, step: 8
Epoch 95/200 |loss: -0.947318| train set 3.063x speedup, test set 1.098x speedup, val set 3.090x speedup, step: 9
Epoch 96/200 |loss: -0.949504| train set 3.063x speedup, test set 1.098x speedup, val set 3.090x speedup, step: 10
Epoch 97/200 |loss: -0.949753| train set 2.891x speedup, test set 1.052x speedup, val set 2.843x speedup, step: 11
Epoch 98/200 |loss: -0.950060| train set 2.902x speedup, test set 1.052x speedup, val set 2.864x speedup, step: 12
Epoch 99/200 |loss: -0.950190| train set 2.903x speedup, test set 1.097x speedup, val set 2.865x speedup, step: 13
Epoch 100/200 |loss: -0.950672| train set 2.903x speedup, test set 1.097x speedup, val set 2.865x speedup, step: 14
Epoch 101/200 |loss: -0.951385| train set 2.903x speedup, test set 1.097x speedup, val set 2.865x speedup, step: 15
Epoch 102/200 |loss: -0.951955| train set 2.903x speedup, test set 1.095x speedup, val set 2.865x speedup, step: 16
Epoch 103/200 |loss: -0.952230| train set 3.076x speedup, test set 1.095x speedup, val set 3.117x speedup, step: 17
Epoch 104/200 |loss: -0.952364| train set 3.076x speedup, test set 1.104x speedup, val set 3.117x speedup, step: 18
Epoch 105/200 |loss: -0.952547| train set 3.076x speedup, test set 1.105x speedup, val set 3.117x speedup, step: 19
Epoch 106/200 |loss: -0.952831| train set 2.988x speedup, test set 1.105x speedup, val set 2.915x speedup, step: 20
Epoch 107/200 |loss: -0.953078| train set 2.988x speedup, test set 1.105x speedup, val set 2.915x speedup, step: 21
Epoch 108/200 |loss: -0.953246| train set 2.988x speedup, test set 1.118x speedup, val set 2.915x speedup, step: 22
Epoch 109/200 |loss: -0.953433| train set 2.988x speedup, test set 1.118x speedup, val set 2.915x speedup, step: 23
Epoch 110/200 |loss: -0.953609| train set 2.988x speedup, test set 1.028x speedup, val set 2.915x speedup, step: 24
Epoch 111/200 |loss: -0.953725| train set 3.239x speedup, test set 1.028x speedup, val set 3.147x speedup, step: 25
Epoch 112/200 |loss: -0.953848| train set 3.239x speedup, test set 1.028x speedup, val set 3.147x speedup, step: 26
Epoch 113/200 |loss: -0.953975| train set 3.239x speedup, test set 1.028x speedup, val set 3.147x speedup, step: 27
Epoch 114/200 |loss: -0.954115| train set 3.239x speedup, test set 1.017x speedup, val set 3.147x speedup, step: 28
Epoch 115/200 |loss: -0.954217| train set 3.281x speedup, test set 1.017x speedup, val set 3.185x speedup, step: 29
Epoch 116/200 |loss: -0.954302| train set 3.281x speedup, test set 1.034x speedup, val set 3.185x speedup, step: 30
Epoch 117/200 |loss: -0.954380| train set 3.281x speedup, test set 1.034x speedup, val set 3.185x speedup, step: 31
Epoch 118/200 |loss: -0.954449| train set 3.281x speedup, test set 0.860x speedup, val set 3.185x speedup, step: 32
Epoch 119/200 |loss: -0.954527| train set 3.281x speedup, test set 0.860x speedup, val set 3.185x speedup, step: 33
Epoch 120/200 |loss: -0.954588| train set 3.281x speedup, test set 0.860x speedup, val set 3.185x speedup, step: 34
Epoch 121/200 |loss: -0.954664| train set 3.509x speedup, test set 0.827x speedup, val set 3.391x speedup, step: 1
Epoch 122/200 |loss: -0.954757| train set 3.509x speedup, test set 0.827x speedup, val set 3.391x speedup, step: 1
Epoch 123/200 |loss: -0.954841| train set 3.509x speedup, test set 0.827x speedup, val set 3.391x speedup, step: 1
Epoch 124/200 |loss: -0.954911| train set 3.509x speedup, test set 0.827x speedup, val set 3.391x speedup, step: 1
Epoch 125/200 |loss: -0.954966| train set 3.509x speedup, test set 0.827x speedup, val set 3.391x speedup, step: 1
Epoch 126/200 |loss: -0.955025| train set 3.509x speedup, test set 0.827x speedup, val set 3.391x speedup, step: 1
Epoch 127/200 |loss: -0.955090| train set 3.509x speedup, test set 0.830x speedup, val set 3.391x speedup, step: 1
Epoch 128/200 |loss: -0.955149| train set 3.509x speedup, test set 0.831x speedup, val set 3.391x speedup, step: 1
Epoch 129/200 |loss: -0.955204| train set 3.509x speedup, test set 0.831x speedup, val set 3.391x speedup, step: 1
Epoch 130/200 |loss: -0.955257| train set 3.509x speedup, test set 0.831x speedup, val set 3.391x speedup, step: 1
Epoch 131/200 |loss: -0.955306| train set 3.509x speedup, test set 0.831x speedup, val set 3.391x speedup, step: 1
Epoch 132/200 |loss: -0.955360| train set 3.509x speedup, test set 0.831x speedup, val set 3.391x speedup, step: 1
Epoch 133/200 |loss: -0.955420| train set 3.614x speedup, test set 0.831x speedup, val set 3.552x speedup, step: 1
Epoch 134/200 |loss: -0.955481| train set 3.614x speedup, test set 0.831x speedup, val set 3.552x speedup, step: 1
Epoch 135/200 |loss: -0.955537| train set 3.614x speedup, test set 0.831x speedup, val set 3.552x speedup, step: 1
Epoch 136/200 |loss: -0.955592| train set 3.614x speedup, test set 0.831x speedup, val set 3.552x speedup, step: 1
Epoch 137/200 |loss: -0.955648| train set 3.614x speedup, test set 0.831x speedup, val set 3.552x speedup, step: 1
Epoch 138/200 |loss: -0.955693| train set 3.614x speedup, test set 0.831x speedup, val set 3.552x speedup, step: 1
Epoch 139/200 |loss: -0.955729| train set 3.614x speedup, test set 0.831x speedup, val set 3.552x speedup, step: 1
Epoch 140/200 |loss: -0.955764| train set 3.614x speedup, test set 0.830x speedup, val set 3.552x speedup, step: 1
Epoch 141/200 |loss: -0.955800| train set 3.614x speedup, test set 0.830x speedup, val set 3.552x speedup, step: 1
Epoch 142/200 |loss: -0.955839| train set 3.614x speedup, test set 0.832x speedup, val set 3.552x speedup, step: 1
Epoch 143/200 |loss: -0.955880| train set 3.614x speedup, test set 0.832x speedup, val set 3.552x speedup, step: 1
Epoch 144/200 |loss: -0.955921| train set 3.615x speedup, test set 0.832x speedup, val set 3.551x speedup, step: 2
Epoch 145/200 |loss: -0.955966| train set 3.615x speedup, test set 0.832x speedup, val set 3.551x speedup, step: 3
Epoch 146/200 |loss: -0.956016| train set 3.615x speedup, test set 0.832x speedup, val set 3.551x speedup, step: 4
Epoch 147/200 |loss: -0.956058| train set 3.615x speedup, test set 0.832x speedup, val set 3.551x speedup, step: 5
Epoch 148/200 |loss: -0.956091| train set 3.615x speedup, test set 0.822x speedup, val set 3.551x speedup, step: 6
Epoch 149/200 |loss: -0.956120| train set 3.615x speedup, test set 0.818x speedup, val set 3.551x speedup, step: 7
Epoch 150/200 |loss: -0.956148| train set 3.615x speedup, test set 0.822x speedup, val set 3.551x speedup, step: 8
Epoch 151/200 |loss: -0.956178| train set 3.652x speedup, test set 0.827x speedup, val set 3.589x speedup, step: 1
Epoch 152/200 |loss: -0.956209| train set 3.652x speedup, test set 0.827x speedup, val set 3.589x speedup, step: 1
Epoch 153/200 |loss: -0.956241| train set 3.652x speedup, test set 0.827x speedup, val set 3.589x speedup, step: 1
Epoch 154/200 |loss: -0.956273| train set 3.652x speedup, test set 0.827x speedup, val set 3.589x speedup, step: 1
Epoch 155/200 |loss: -0.956300| train set 3.652x speedup, test set 0.827x speedup, val set 3.589x speedup, step: 1
Epoch 156/200 |loss: -0.956324| train set 3.652x speedup, test set 0.827x speedup, val set 3.589x speedup, step: 1
Epoch 157/200 |loss: -0.956347| train set 3.652x speedup, test set 0.827x speedup, val set 3.589x speedup, step: 1
Epoch 158/200 |loss: -0.956370| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 159/200 |loss: -0.956392| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 160/200 |loss: -0.956412| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 161/200 |loss: -0.956432| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 162/200 |loss: -0.956451| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 163/200 |loss: -0.956471| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 164/200 |loss: -0.956491| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 165/200 |loss: -0.956511| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 166/200 |loss: -0.956534| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 167/200 |loss: -0.956557| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 168/200 |loss: -0.956580| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 169/200 |loss: -0.956601| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 170/200 |loss: -0.956619| train set 3.652x speedup, test set 0.822x speedup, val set 3.589x speedup, step: 1
Epoch 171/200 |loss: -0.956634| train set 3.652x speedup, test set 0.819x speedup, val set 3.589x speedup, step: 1
Epoch 172/200 |loss: -0.956650| train set 3.652x speedup, test set 0.831x speedup, val set 3.589x speedup, step: 1
Epoch 173/200 |loss: -0.956668| train set 3.652x speedup, test set 0.828x speedup, val set 3.589x speedup, step: 1
Epoch 174/200 |loss: -0.956686| train set 3.652x speedup, test set 0.828x speedup, val set 3.589x speedup, step: 1
Epoch 175/200 |loss: -0.956704| train set 3.652x speedup, test set 0.824x speedup, val set 3.589x speedup, step: 1
Epoch 176/200 |loss: -0.956721| train set 3.652x speedup, test set 0.816x speedup, val set 3.589x speedup, step: 1
Epoch 177/200 |loss: -0.956736| train set 3.652x speedup, test set 0.816x speedup, val set 3.589x speedup, step: 1
Epoch 178/200 |loss: -0.956751| train set 3.652x speedup, test set 0.847x speedup, val set 3.589x speedup, step: 1
Epoch 179/200 |loss: -0.956766| train set 3.652x speedup, test set 0.847x speedup, val set 3.589x speedup, step: 1
Epoch 180/200 |loss: -0.956781| train set 3.652x speedup, test set 0.847x speedup, val set 3.589x speedup, step: 1
Epoch 181/200 |loss: -0.956796| train set 3.652x speedup, test set 0.847x speedup, val set 3.589x speedup, step: 1
Epoch 182/200 |loss: -0.956812| train set 3.745x speedup, test set 0.847x speedup, val set 3.683x speedup, step: 1
Epoch 183/200 |loss: -0.956826| train set 3.745x speedup, test set 0.847x speedup, val set 3.683x speedup, step: 1
Epoch 184/200 |loss: -0.956841| train set 3.745x speedup, test set 0.847x speedup, val set 3.683x speedup, step: 1
Epoch 185/200 |loss: -0.956855| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 186/200 |loss: -0.956869| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 187/200 |loss: -0.956884| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 188/200 |loss: -0.956901| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 189/200 |loss: -0.956919| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 190/200 |loss: -0.956933| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 191/200 |loss: -0.956946| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 192/200 |loss: -0.956958| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 193/200 |loss: -0.956973| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 194/200 |loss: -0.956997| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 195/200 |loss: -0.957020| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 196/200 |loss: -0.957033| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 197/200 |loss: -0.957050| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 198/200 |loss: -0.957068| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Epoch 199/200 |loss: -0.957077| train set 3.745x speedup, test set 0.848x speedup, val set 3.683x speedup, step: 1
Training per epoch cost 0.571 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 2.310s, pg runtime 0.207s, speedup 0.090x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 3.507s, pg runtime 3.507s, speedup 1.000x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 3.867s, pg runtime 2.718s, speedup 0.703x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.366s, pg runtime 0.354s, speedup 0.966x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 1.666s, pg runtime 0.089s, speedup 0.054x
21, opt runtime 0.953s, model runtime 1.892s, pg runtime 4.730s, speedup 2.500x
22, opt runtime 0.093s, model runtime 3.355s, pg runtime 2.389s, speedup 0.712x
23, opt runtime 0.389s, model runtime 0.421s, pg runtime 0.389s, speedup 0.924x
24, opt runtime 2.719s, model runtime 3.765s, pg runtime 3.112s, speedup 0.826x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.365s, pg runtime 5.521s, speedup 1.029x
====================
best train speedup epoch: 182, train speedup 3.745, test speedup 0.847, val speedup 3.683
best test speedup epoch: 11, train speedup 2.942, test speedup 2.184, val speedup 2.923
best validation speedup epoch: 199, train speedup 3.745, test speedup 0.848, val speedup 3.683
last model at epoch 199, train speedup 3.745, test speedup 0.848, val speedup 3.683
execution cost 0:06:51.037469
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.901861947866242
-0.059129222292990787
construct training samples cost 0:00:01.556464, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.718116| train set 1.248x speedup, test set 0.796x speedup, val set 1.253x speedup, step: 1
Epoch 1/200 |loss: -0.726791| train set 1.132x speedup, test set 0.728x speedup, val set 1.119x speedup, step: 2
Epoch 2/200 |loss: -0.745480| train set 1.601x speedup, test set 0.993x speedup, val set 1.600x speedup, step: 1
Epoch 3/200 |loss: -0.773295| train set 1.454x speedup, test set 1.244x speedup, val set 1.450x speedup, step: 2
Epoch 4/200 |loss: -0.795644| train set 1.089x speedup, test set 1.233x speedup, val set 1.069x speedup, step: 3
Epoch 5/200 |loss: -0.812147| train set 1.078x speedup, test set 1.084x speedup, val set 1.067x speedup, step: 4
Epoch 6/200 |loss: -0.824188| train set 1.048x speedup, test set 1.128x speedup, val set 1.022x speedup, step: 5
Epoch 7/200 |loss: -0.832001| train set 1.638x speedup, test set 1.232x speedup, val set 1.587x speedup, step: 6
Epoch 8/200 |loss: -0.837393| train set 1.726x speedup, test set 1.608x speedup, val set 1.672x speedup, step: 1
Epoch 9/200 |loss: -0.841863| train set 2.846x speedup, test set 1.270x speedup, val set 2.828x speedup, step: 1
Epoch 10/200 |loss: -0.846046| train set 2.930x speedup, test set 2.044x speedup, val set 2.899x speedup, step: 1
Epoch 11/200 |loss: -0.850130| train set 2.942x speedup, test set 2.181x speedup, val set 2.923x speedup, step: 1
Epoch 12/200 |loss: -0.853566| train set 2.930x speedup, test set 2.184x speedup, val set 2.907x speedup, step: 2
Epoch 13/200 |loss: -0.856640| train set 3.032x speedup, test set 2.023x speedup, val set 2.992x speedup, step: 1
Epoch 14/200 |loss: -0.859961| train set 2.748x speedup, test set 2.077x speedup, val set 2.718x speedup, step: 2
Epoch 15/200 |loss: -0.861511| train set 2.783x speedup, test set 2.113x speedup, val set 2.751x speedup, step: 3
Epoch 16/200 |loss: -0.866091| train set 2.801x speedup, test set 1.835x speedup, val set 2.770x speedup, step: 4
Epoch 17/200 |loss: -0.869830| train set 2.801x speedup, test set 1.733x speedup, val set 2.770x speedup, step: 5
Epoch 18/200 |loss: -0.873820| train set 2.946x speedup, test set 1.709x speedup, val set 2.928x speedup, step: 6
Epoch 19/200 |loss: -0.876280| train set 3.033x speedup, test set 1.709x speedup, val set 3.020x speedup, step: 1
Epoch 20/200 |loss: -0.878669| train set 2.850x speedup, test set 1.874x speedup, val set 2.842x speedup, step: 2
Epoch 21/200 |loss: -0.880154| train set 2.850x speedup, test set 1.768x speedup, val set 2.842x speedup, step: 3
Epoch 22/200 |loss: -0.881891| train set 2.918x speedup, test set 1.661x speedup, val set 2.936x speedup, step: 4
Epoch 23/200 |loss: -0.882894| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 24/200 |loss: -0.883895| train set 3.046x speedup, test set 1.708x speedup, val set 3.100x speedup, step: 1
Epoch 25/200 |loss: -0.885492| train set 3.046x speedup, test set 1.674x speedup, val set 3.100x speedup, step: 1
Epoch 26/200 |loss: -0.888799| train set 3.034x speedup, test set 1.674x speedup, val set 3.073x speedup, step: 2
Epoch 27/200 |loss: -0.893039| train set 2.772x speedup, test set 1.651x speedup, val set 2.797x speedup, step: 3
Epoch 28/200 |loss: -0.895718| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 4
Epoch 29/200 |loss: -0.897014| train set 2.772x speedup, test set 1.594x speedup, val set 2.797x speedup, step: 5
Epoch 30/200 |loss: -0.897847| train set 2.772x speedup, test set 1.590x speedup, val set 2.797x speedup, step: 6
Epoch 31/200 |loss: -0.898513| train set 2.850x speedup, test set 1.607x speedup, val set 2.881x speedup, step: 7
Epoch 32/200 |loss: -0.899026| train set 2.850x speedup, test set 1.612x speedup, val set 2.881x speedup, step: 8
Epoch 33/200 |loss: -0.899587| train set 2.861x speedup, test set 1.612x speedup, val set 2.887x speedup, step: 9
Epoch 34/200 |loss: -0.900234| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 10
Epoch 35/200 |loss: -0.900889| train set 2.861x speedup, test set 1.642x speedup, val set 2.887x speedup, step: 11
Epoch 36/200 |loss: -0.901719| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 12
Epoch 37/200 |loss: -0.902506| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 13
Epoch 38/200 |loss: -0.903175| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 14
Epoch 39/200 |loss: -0.903696| train set 2.861x speedup, test set 1.671x speedup, val set 2.887x speedup, step: 15
Epoch 40/200 |loss: -0.904190| train set 2.861x speedup, test set 1.672x speedup, val set 2.887x speedup, step: 16
Epoch 41/200 |loss: -0.904685| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 17
Epoch 42/200 |loss: -0.905021| train set 2.861x speedup, test set 1.587x speedup, val set 2.887x speedup, step: 18
Epoch 43/200 |loss: -0.905324| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 19
Epoch 44/200 |loss: -0.905641| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 20
Epoch 45/200 |loss: -0.905953| train set 2.873x speedup, test set 1.587x speedup, val set 2.910x speedup, step: 21
Epoch 46/200 |loss: -0.906243| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 22
Epoch 47/200 |loss: -0.906563| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 23
Epoch 48/200 |loss: -0.906868| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 24
Epoch 49/200 |loss: -0.907209| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 25
Epoch 50/200 |loss: -0.907563| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 26
Epoch 51/200 |loss: -0.907898| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 27
Epoch 52/200 |loss: -0.908256| train set 2.873x speedup, test set 1.588x speedup, val set 2.910x speedup, step: 28
Epoch 53/200 |loss: -0.908646| train set 3.156x speedup, test set 1.588x speedup, val set 3.211x speedup, step: 1
Epoch 54/200 |loss: -0.909061| train set 3.156x speedup, test set 1.583x speedup, val set 3.211x speedup, step: 1
Epoch 55/200 |loss: -0.909490| train set 3.156x speedup, test set 1.583x speedup, val set 3.211x speedup, step: 1
Epoch 56/200 |loss: -0.909980| train set 3.157x speedup, test set 1.582x speedup, val set 3.212x speedup, step: 1
Epoch 57/200 |loss: -0.910423| train set 3.134x speedup, test set 1.562x speedup, val set 3.181x speedup, step: 2
Epoch 58/200 |loss: -0.910993| train set 3.133x speedup, test set 1.562x speedup, val set 3.179x speedup, step: 3
Epoch 59/200 |loss: -0.911508| train set 3.133x speedup, test set 1.561x speedup, val set 3.179x speedup, step: 4
Epoch 60/200 |loss: -0.912122| train set 3.133x speedup, test set 1.561x speedup, val set 3.179x speedup, step: 5
Epoch 61/200 |loss: -0.912609| train set 3.133x speedup, test set 1.561x speedup, val set 3.179x speedup, step: 6
Epoch 62/200 |loss: -0.913179| train set 3.133x speedup, test set 1.643x speedup, val set 3.179x speedup, step: 7
Epoch 63/200 |loss: -0.913937| train set 3.133x speedup, test set 1.644x speedup, val set 3.179x speedup, step: 8
Epoch 64/200 |loss: -0.914819| train set 3.057x speedup, test set 1.644x speedup, val set 3.136x speedup, step: 9
Epoch 65/200 |loss: -0.915970| train set 2.593x speedup, test set 1.644x speedup, val set 2.637x speedup, step: 10
Epoch 66/200 |loss: -0.916367| train set 2.647x speedup, test set 1.646x speedup, val set 2.668x speedup, step: 11
Epoch 67/200 |loss: -0.916254| train set 2.593x speedup, test set 1.646x speedup, val set 2.637x speedup, step: 12
Epoch 68/200 |loss: -0.922678| train set 2.591x speedup, test set 1.497x speedup, val set 2.636x speedup, step: 13
Epoch 69/200 |loss: -0.914548| train set 2.647x speedup, test set 1.628x speedup, val set 2.668x speedup, step: 14
Epoch 70/200 |loss: -0.926717| train set 2.647x speedup, test set 1.643x speedup, val set 2.668x speedup, step: 15
Epoch 71/200 |loss: -0.928211| train set 3.133x speedup, test set 1.081x speedup, val set 3.179x speedup, step: 16
Epoch 72/200 |loss: -0.931346| train set 3.066x speedup, test set 1.117x speedup, val set 3.121x speedup, step: 17
Epoch 73/200 |loss: -0.932609| train set 3.066x speedup, test set 1.167x speedup, val set 3.121x speedup, step: 18
Epoch 74/200 |loss: -0.933907| train set 3.066x speedup, test set 1.167x speedup, val set 3.121x speedup, step: 19
Epoch 75/200 |loss: -0.935157| train set 2.925x speedup, test set 1.167x speedup, val set 3.196x speedup, step: 20
Epoch 76/200 |loss: -0.936857| train set 2.795x speedup, test set 1.164x speedup, val set 2.791x speedup, step: 21
Epoch 77/200 |loss: -0.936872| train set 3.335x speedup, test set 1.133x speedup, val set 3.410x speedup, step: 1
Epoch 78/200 |loss: -0.937608| train set 3.335x speedup, test set 1.133x speedup, val set 3.410x speedup, step: 1
Epoch 79/200 |loss: -0.939365| train set 3.337x speedup, test set 1.133x speedup, val set 3.411x speedup, step: 1
Epoch 80/200 |loss: -0.940171| train set 3.337x speedup, test set 1.130x speedup, val set 3.411x speedup, step: 1
Epoch 81/200 |loss: -0.941207| train set 3.337x speedup, test set 1.133x speedup, val set 3.411x speedup, step: 1
Epoch 82/200 |loss: -0.942628| train set 3.337x speedup, test set 1.088x speedup, val set 3.411x speedup, step: 1
Epoch 83/200 |loss: -0.942661| train set 3.273x speedup, test set 1.078x speedup, val set 3.329x speedup, step: 2
Epoch 84/200 |loss: -0.935078| train set 3.248x speedup, test set 1.130x speedup, val set 3.296x speedup, step: 3
Epoch 85/200 |loss: -0.943856| train set 3.274x speedup, test set 1.090x speedup, val set 3.392x speedup, step: 4
Epoch 86/200 |loss: -0.935993| train set 3.133x speedup, test set 1.119x speedup, val set 3.110x speedup, step: 5
Epoch 87/200 |loss: -0.941187| train set 2.916x speedup, test set 1.080x speedup, val set 2.873x speedup, step: 6
Epoch 88/200 |loss: -0.936367| train set 3.107x speedup, test set 1.121x speedup, val set 3.054x speedup, step: 7
Epoch 89/200 |loss: -0.937212| train set 3.123x speedup, test set 1.118x speedup, val set 3.030x speedup, step: 8
early stopping at epoch 89
Training per epoch cost 0.659 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.502s, pg runtime 0.207s, speedup 0.412x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.846s, model runtime 3.507s, pg runtime 3.507s, speedup 1.000x
11, opt runtime 4.443s, model runtime 23.116s, pg runtime 13.945s, speedup 0.603x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 2.238s, model runtime 3.296s, pg runtime 2.718s, speedup 0.825x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.366s, pg runtime 0.354s, speedup 0.966x
18, opt runtime 2.962s, model runtime 2.962s, pg runtime 6.876s, speedup 2.321x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.064s, model runtime 1.666s, pg runtime 0.089s, speedup 0.054x
21, opt runtime 0.953s, model runtime 4.730s, pg runtime 4.730s, speedup 1.000x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.872s, pg runtime 0.161s, speedup 0.185x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 5.350s, pg runtime 6.444s, speedup 1.204x
33, opt runtime 2.755s, model runtime 2.923s, pg runtime 5.521s, speedup 1.889x
====================
best train speedup epoch: 79, train speedup 3.337, test speedup 1.133, val speedup 3.411
best test speedup epoch: 12, train speedup 2.930, test speedup 2.184, val speedup 2.907
best validation speedup epoch: 82, train speedup 3.337, test speedup 1.088, val speedup 3.411
last model at epoch 89, train speedup 3.123, test speedup 1.118, val speedup 3.030
execution cost 0:03:33.549501
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.898171, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146669| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705244| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.174875| train set 3.535x speedup, test set 1.093x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701828| train set 3.514x speedup, test set 0.890x speedup, val set 3.526x speedup, step: 6
Epoch 6/200 |loss: 21.222294| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.778355| train set 3.923x speedup, test set 0.862x speedup, val set 3.931x speedup, step: 8
Epoch 8/200 |loss: 20.327324| train set 4.246x speedup, test set 0.742x speedup, val set 4.414x speedup, step: 9
Epoch 9/200 |loss: 19.875595| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.373310| train set 3.819x speedup, test set 0.697x speedup, val set 3.942x speedup, step: 11
Epoch 11/200 |loss: 18.869989| train set 4.319x speedup, test set 0.679x speedup, val set 4.491x speedup, step: 12
Epoch 12/200 |loss: 18.298655| train set 4.092x speedup, test set 0.601x speedup, val set 4.196x speedup, step: 13
Epoch 13/200 |loss: 17.786674| train set 4.370x speedup, test set 0.586x speedup, val set 4.469x speedup, step: 14
Epoch 14/200 |loss: 17.317814| train set 4.370x speedup, test set 0.831x speedup, val set 4.469x speedup, step: 15
Epoch 15/200 |loss: 16.807980| train set 4.368x speedup, test set 0.821x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.323109| train set 4.368x speedup, test set 0.818x speedup, val set 4.468x speedup, step: 17
Epoch 17/200 |loss: 15.837697| train set 4.370x speedup, test set 0.826x speedup, val set 4.469x speedup, step: 18
Epoch 18/200 |loss: 15.397895| train set 4.436x speedup, test set 0.825x speedup, val set 4.536x speedup, step: 19
Epoch 19/200 |loss: 14.951514| train set 4.545x speedup, test set 0.795x speedup, val set 4.767x speedup, step: 20
Epoch 20/200 |loss: 14.524313| train set 4.606x speedup, test set 0.852x speedup, val set 4.828x speedup, step: 21
Epoch 21/200 |loss: 14.131148| train set 4.987x speedup, test set 0.793x speedup, val set 5.151x speedup, step: 22
Epoch 22/200 |loss: 13.755424| train set 5.160x speedup, test set 0.844x speedup, val set 5.386x speedup, step: 23
Epoch 23/200 |loss: 13.464385| train set 5.021x speedup, test set 0.779x speedup, val set 5.301x speedup, step: 24
Epoch 24/200 |loss: 13.203989| train set 5.160x speedup, test set 0.823x speedup, val set 5.386x speedup, step: 25
Epoch 25/200 |loss: 13.084279| train set 5.046x speedup, test set 1.082x speedup, val set 5.233x speedup, step: 26
Epoch 26/200 |loss: 12.936353| train set 5.150x speedup, test set 0.804x speedup, val set 5.383x speedup, step: 27
Epoch 27/200 |loss: 12.653063| train set 5.203x speedup, test set 0.876x speedup, val set 5.448x speedup, step: 28
Epoch 28/200 |loss: 12.170230| train set 5.223x speedup, test set 1.129x speedup, val set 5.476x speedup, step: 29
Epoch 29/200 |loss: 12.171788| train set 5.150x speedup, test set 0.849x speedup, val set 5.383x speedup, step: 30
Epoch 30/200 |loss: 11.495061| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 31
Epoch 31/200 |loss: 11.485295| train set 5.248x speedup, test set 1.075x speedup, val set 5.489x speedup, step: 32
Epoch 32/200 |loss: 11.136312| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 33
Epoch 33/200 |loss: 10.931078| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 34
Epoch 34/200 |loss: 10.712331| train set 5.248x speedup, test set 0.844x speedup, val set 5.489x speedup, step: 35
Epoch 35/200 |loss: 10.638402| train set 5.248x speedup, test set 0.844x speedup, val set 5.489x speedup, step: 36
Epoch 36/200 |loss: 10.107134| train set 5.248x speedup, test set 0.852x speedup, val set 5.489x speedup, step: 37
Epoch 37/200 |loss: 10.275696| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 38
Epoch 38/200 |loss: 10.406798| train set 5.248x speedup, test set 0.844x speedup, val set 5.489x speedup, step: 39
Epoch 39/200 |loss: 10.438557| train set 5.170x speedup, test set 0.840x speedup, val set 5.410x speedup, step: 40
Epoch 40/200 |loss: 10.207524| train set 5.248x speedup, test set 1.067x speedup, val set 5.489x speedup, step: 41
Epoch 41/200 |loss: 10.038445| train set 5.248x speedup, test set 0.845x speedup, val set 5.489x speedup, step: 42
Epoch 42/200 |loss: 9.650861| train set 5.248x speedup, test set 0.840x speedup, val set 5.489x speedup, step: 43
Epoch 43/200 |loss: 9.464734| train set 5.248x speedup, test set 1.060x speedup, val set 5.489x speedup, step: 44
Epoch 44/200 |loss: 9.560353| train set 5.248x speedup, test set 1.060x speedup, val set 5.489x speedup, step: 45
Epoch 45/200 |loss: 8.995010| train set 5.248x speedup, test set 0.841x speedup, val set 5.489x speedup, step: 46
Epoch 46/200 |loss: 9.418159| train set 5.223x speedup, test set 1.060x speedup, val set 5.476x speedup, step: 47
Epoch 47/200 |loss: 9.006932| train set 5.223x speedup, test set 1.061x speedup, val set 5.476x speedup, step: 48
Epoch 48/200 |loss: 8.901359| train set 5.248x speedup, test set 0.832x speedup, val set 5.489x speedup, step: 49
Epoch 49/200 |loss: 8.829022| train set 5.248x speedup, test set 0.827x speedup, val set 5.489x speedup, step: 50
Epoch 50/200 |loss: 8.683275| train set 5.248x speedup, test set 1.060x speedup, val set 5.489x speedup, step: 51
Epoch 51/200 |loss: 8.605147| train set 5.248x speedup, test set 0.836x speedup, val set 5.489x speedup, step: 52
Epoch 52/200 |loss: 8.467803| train set 5.248x speedup, test set 0.832x speedup, val set 5.489x speedup, step: 53
Epoch 53/200 |loss: 8.522990| train set 5.248x speedup, test set 1.046x speedup, val set 5.489x speedup, step: 54
Epoch 54/200 |loss: 8.391149| train set 5.211x speedup, test set 0.832x speedup, val set 5.389x speedup, step: 55
Epoch 55/200 |loss: 8.535956| train set 5.224x speedup, test set 1.046x speedup, val set 5.473x speedup, step: 56
Epoch 56/200 |loss: 8.868086| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 57
Epoch 57/200 |loss: 8.858639| train set 5.249x speedup, test set 1.047x speedup, val set 5.487x speedup, step: 58
Epoch 58/200 |loss: 8.765662| train set 5.248x speedup, test set 1.047x speedup, val set 5.489x speedup, step: 59
Epoch 59/200 |loss: 8.175696| train set 5.210x speedup, test set 1.047x speedup, val set 5.391x speedup, step: 60
Epoch 60/200 |loss: 8.553330| train set 5.249x speedup, test set 1.047x speedup, val set 5.487x speedup, step: 61
Epoch 61/200 |loss: 8.351645| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 62
Epoch 62/200 |loss: 8.144031| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 63
Epoch 63/200 |loss: 8.108696| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 64
Epoch 64/200 |loss: 8.112584| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 65
Epoch 65/200 |loss: 7.982691| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 66
Epoch 66/200 |loss: 7.798946| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 67
Epoch 67/200 |loss: 7.902036| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 68
Epoch 68/200 |loss: 7.721418| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 69
Epoch 69/200 |loss: 7.732284| train set 5.249x speedup, test set 1.047x speedup, val set 5.487x speedup, step: 70
Epoch 70/200 |loss: 7.641981| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 71
Epoch 71/200 |loss: 7.629401| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 72
Epoch 72/200 |loss: 7.597230| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 73
Epoch 73/200 |loss: 7.534380| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 74
Epoch 74/200 |loss: 7.490516| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 75
Epoch 75/200 |loss: 7.452289| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 76
Epoch 76/200 |loss: 7.509974| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 77
Epoch 77/200 |loss: 7.617624| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 78
Epoch 78/200 |loss: 8.318481| train set 5.224x speedup, test set 1.041x speedup, val set 5.473x speedup, step: 79
Epoch 79/200 |loss: 10.178529| train set 5.249x speedup, test set 1.017x speedup, val set 5.487x speedup, step: 80
Epoch 80/200 |loss: 9.082852| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 81
Epoch 81/200 |loss: 9.297806| train set 5.249x speedup, test set 1.041x speedup, val set 5.487x speedup, step: 82
Epoch 82/200 |loss: 8.669305| train set 5.249x speedup, test set 1.041x speedup, val set 5.487x speedup, step: 83
Epoch 83/200 |loss: 8.619472| train set 5.249x speedup, test set 1.017x speedup, val set 5.487x speedup, step: 84
Epoch 84/200 |loss: 8.366171| train set 5.249x speedup, test set 1.041x speedup, val set 5.487x speedup, step: 85
Epoch 85/200 |loss: 8.277864| train set 5.249x speedup, test set 1.041x speedup, val set 5.487x speedup, step: 86
Epoch 86/200 |loss: 8.167271| train set 5.224x speedup, test set 1.003x speedup, val set 5.473x speedup, step: 87
Epoch 87/200 |loss: 7.992116| train set 5.249x speedup, test set 1.003x speedup, val set 5.487x speedup, step: 88
Epoch 88/200 |loss: 7.947811| train set 5.211x speedup, test set 1.041x speedup, val set 5.389x speedup, step: 89
Epoch 89/200 |loss: 7.925099| train set 5.211x speedup, test set 1.048x speedup, val set 5.389x speedup, step: 90
Epoch 90/200 |loss: 7.858388| train set 5.249x speedup, test set 1.033x speedup, val set 5.487x speedup, step: 91
Epoch 91/200 |loss: 7.702643| train set 5.249x speedup, test set 1.012x speedup, val set 5.487x speedup, step: 92
Epoch 92/200 |loss: 7.728965| train set 5.211x speedup, test set 1.050x speedup, val set 5.389x speedup, step: 93
Epoch 93/200 |loss: 7.648368| train set 5.211x speedup, test set 1.051x speedup, val set 5.389x speedup, step: 94
Epoch 94/200 |loss: 7.569332| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 95
Epoch 95/200 |loss: 7.566836| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 96
Epoch 96/200 |loss: 7.478766| train set 5.249x speedup, test set 1.048x speedup, val set 5.487x speedup, step: 97
Epoch 97/200 |loss: 7.491223| train set 5.249x speedup, test set 1.048x speedup, val set 5.487x speedup, step: 98
Epoch 98/200 |loss: 7.404981| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 99
Epoch 99/200 |loss: 7.422809| train set 5.249x speedup, test set 1.048x speedup, val set 5.487x speedup, step: 100
Epoch 100/200 |loss: 7.349841| train set 5.249x speedup, test set 1.041x speedup, val set 5.487x speedup, step: 1
Epoch 101/200 |loss: 7.341552| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 102/200 |loss: 7.319791| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 3
Epoch 103/200 |loss: 7.417642| train set 5.186x speedup, test set 0.828x speedup, val set 5.375x speedup, step: 4
Epoch 104/200 |loss: 7.824607| train set 5.224x speedup, test set 0.830x speedup, val set 5.473x speedup, step: 5
Epoch 105/200 |loss: 7.922132| train set 5.186x speedup, test set 0.828x speedup, val set 5.375x speedup, step: 6
Epoch 106/200 |loss: 8.095773| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 107/200 |loss: 7.385189| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 108/200 |loss: 7.712896| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 109/200 |loss: 7.991193| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 110/200 |loss: 7.439105| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 1
Epoch 111/200 |loss: 7.769601| train set 5.224x speedup, test set 0.825x speedup, val set 5.473x speedup, step: 2
Epoch 112/200 |loss: 7.355092| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 3
Epoch 113/200 |loss: 7.512510| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 114/200 |loss: 7.459789| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 115/200 |loss: 7.249403| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 116/200 |loss: 7.363249| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 117/200 |loss: 7.193107| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 118/200 |loss: 7.313082| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 119/200 |loss: 7.193635| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 2
Epoch 120/200 |loss: 7.240511| train set 5.224x speedup, test set 0.824x speedup, val set 5.473x speedup, step: 3
Epoch 121/200 |loss: 7.425913| train set 5.213x speedup, test set 0.830x speedup, val set 5.373x speedup, step: 4
Epoch 122/200 |loss: 7.474078| train set 5.224x speedup, test set 1.041x speedup, val set 5.473x speedup, step: 5
Epoch 123/200 |loss: 7.720670| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 6
Epoch 124/200 |loss: 7.168431| train set 5.213x speedup, test set 0.825x speedup, val set 5.373x speedup, step: 7
Epoch 125/200 |loss: 7.759599| train set 5.224x speedup, test set 1.041x speedup, val set 5.473x speedup, step: 8
Epoch 126/200 |loss: 8.170141| train set 5.249x speedup, test set 0.808x speedup, val set 5.487x speedup, step: 1
Epoch 127/200 |loss: 7.750952| train set 5.211x speedup, test set 0.808x speedup, val set 5.389x speedup, step: 2
Epoch 128/200 |loss: 7.922029| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 3
Epoch 129/200 |loss: 7.580539| train set 5.224x speedup, test set 1.041x speedup, val set 5.473x speedup, step: 4
Epoch 130/200 |loss: 7.585469| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 131/200 |loss: 7.488810| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 132/200 |loss: 7.433413| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 3
Epoch 133/200 |loss: 7.369994| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 134/200 |loss: 7.300697| train set 5.249x speedup, test set 0.808x speedup, val set 5.487x speedup, step: 1
Epoch 135/200 |loss: 7.275575| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 136/200 |loss: 7.282360| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 3
Epoch 137/200 |loss: 7.185350| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 138/200 |loss: 7.205448| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 139/200 |loss: 7.160257| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 140/200 |loss: 7.101957| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 141/200 |loss: 7.151986| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 142/200 |loss: 7.050392| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 143/200 |loss: 7.079174| train set 5.186x speedup, test set 0.825x speedup, val set 5.375x speedup, step: 3
Epoch 144/200 |loss: 7.048459| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 4
Epoch 145/200 |loss: 7.025200| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 146/200 |loss: 7.014397| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 147/200 |loss: 7.007382| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 148/200 |loss: 6.981289| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 149/200 |loss: 6.981086| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 150/200 |loss: 6.968617| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 2
Epoch 151/200 |loss: 6.964754| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 152/200 |loss: 6.952881| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Epoch 153/200 |loss: 6.940458| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 154/200 |loss: 6.942451| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 155/200 |loss: 6.964383| train set 5.224x speedup, test set 0.813x speedup, val set 5.473x speedup, step: 3
Epoch 156/200 |loss: 7.097887| train set 5.213x speedup, test set 0.819x speedup, val set 5.373x speedup, step: 4
Epoch 157/200 |loss: 7.394938| train set 5.224x speedup, test set 0.813x speedup, val set 5.473x speedup, step: 5
Epoch 158/200 |loss: 8.103134| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 159/200 |loss: 7.250544| train set 5.213x speedup, test set 0.819x speedup, val set 5.373x speedup, step: 2
Epoch 160/200 |loss: 8.141111| train set 5.224x speedup, test set 0.813x speedup, val set 5.473x speedup, step: 3
Epoch 161/200 |loss: 7.799983| train set 5.224x speedup, test set 0.815x speedup, val set 5.473x speedup, step: 4
Epoch 162/200 |loss: 7.576560| train set 5.211x speedup, test set 0.789x speedup, val set 5.389x speedup, step: 5
Epoch 163/200 |loss: 7.519928| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 6
Epoch 164/200 |loss: 7.565571| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 7
Epoch 165/200 |loss: 7.395476| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 1
Epoch 166/200 |loss: 7.445450| train set 5.211x speedup, test set 0.808x speedup, val set 5.389x speedup, step: 2
Epoch 167/200 |loss: 7.274310| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 168/200 |loss: 7.322235| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 169/200 |loss: 7.254961| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 170/200 |loss: 7.165324| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 171/200 |loss: 7.217309| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 2
Epoch 172/200 |loss: 7.099065| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 173/200 |loss: 7.148463| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 174/200 |loss: 7.058079| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 175/200 |loss: 7.088221| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 2
Epoch 176/200 |loss: 7.005661| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 177/200 |loss: 7.048882| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 178/200 |loss: 6.969782| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 179/200 |loss: 7.007561| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 2
Epoch 180/200 |loss: 6.943298| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 3
Epoch 181/200 |loss: 6.963603| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 182/200 |loss: 6.923868| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 183/200 |loss: 6.927236| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 184/200 |loss: 6.916461| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 185/200 |loss: 6.899055| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 186/200 |loss: 6.888590| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 187/200 |loss: 6.885885| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 188/200 |loss: 6.869779| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 189/200 |loss: 6.874725| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 1
Epoch 190/200 |loss: 6.869558| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 2
Epoch 191/200 |loss: 6.918167| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 3
Epoch 192/200 |loss: 6.993766| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 1
Epoch 193/200 |loss: 7.367279| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 1
Epoch 194/200 |loss: 7.051206| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 1
Epoch 195/200 |loss: 6.861114| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 2
Epoch 196/200 |loss: 6.938411| train set 5.211x speedup, test set 0.816x speedup, val set 5.389x speedup, step: 3
Epoch 197/200 |loss: 7.122136| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 1
Epoch 198/200 |loss: 7.608443| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 199/200 |loss: 7.015535| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 1
Training per epoch cost 0.261 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 51.645s, pg runtime 13.945s, speedup 0.270x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.373s, pg runtime 0.354s, speedup 0.949x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 57, train speedup 5.249, test speedup 1.047, val speedup 5.487
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 199, train speedup 5.249, test speedup 0.815, val speedup 5.487
last model at epoch 199, train speedup 5.249, test speedup 0.815, val speedup 5.487
execution cost 0:02:42.442764
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.933273, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146671| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705244| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.174879| train set 3.535x speedup, test set 1.093x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701832| train set 3.514x speedup, test set 0.890x speedup, val set 3.526x speedup, step: 6
Epoch 6/200 |loss: 21.222298| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.778355| train set 3.923x speedup, test set 0.862x speedup, val set 3.931x speedup, step: 8
Epoch 8/200 |loss: 20.327322| train set 4.246x speedup, test set 0.742x speedup, val set 4.414x speedup, step: 9
Epoch 9/200 |loss: 19.875662| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.373657| train set 3.785x speedup, test set 0.697x speedup, val set 3.895x speedup, step: 11
Epoch 11/200 |loss: 18.873270| train set 4.319x speedup, test set 0.688x speedup, val set 4.491x speedup, step: 12
Epoch 12/200 |loss: 18.301670| train set 4.092x speedup, test set 0.588x speedup, val set 4.196x speedup, step: 13
Epoch 13/200 |loss: 17.792246| train set 4.370x speedup, test set 0.674x speedup, val set 4.469x speedup, step: 14
Epoch 14/200 |loss: 17.326065| train set 4.370x speedup, test set 0.832x speedup, val set 4.469x speedup, step: 15
Epoch 15/200 |loss: 16.783930| train set 4.368x speedup, test set 0.821x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.282610| train set 4.368x speedup, test set 0.822x speedup, val set 4.468x speedup, step: 17
Epoch 17/200 |loss: 15.814488| train set 4.436x speedup, test set 0.822x speedup, val set 4.534x speedup, step: 18
Epoch 18/200 |loss: 15.399792| train set 4.370x speedup, test set 0.862x speedup, val set 4.469x speedup, step: 19
Epoch 19/200 |loss: 15.018905| train set 4.648x speedup, test set 0.832x speedup, val set 4.834x speedup, step: 20
Epoch 20/200 |loss: 14.650532| train set 4.824x speedup, test set 0.833x speedup, val set 4.969x speedup, step: 21
Epoch 21/200 |loss: 14.211794| train set 4.915x speedup, test set 0.789x speedup, val set 5.082x speedup, step: 22
Epoch 22/200 |loss: 13.799324| train set 4.754x speedup, test set 0.873x speedup, val set 5.000x speedup, step: 23
Epoch 23/200 |loss: 13.474491| train set 5.150x speedup, test set 0.847x speedup, val set 5.383x speedup, step: 24
Epoch 24/200 |loss: 13.100662| train set 5.248x speedup, test set 0.858x speedup, val set 5.489x speedup, step: 25
Epoch 25/200 |loss: 12.934295| train set 5.027x speedup, test set 0.884x speedup, val set 5.208x speedup, step: 26
Epoch 26/200 |loss: 12.745325| train set 5.228x speedup, test set 0.830x speedup, val set 5.461x speedup, step: 27
Epoch 27/200 |loss: 12.266780| train set 5.248x speedup, test set 0.820x speedup, val set 5.489x speedup, step: 28
Epoch 28/200 |loss: 12.138080| train set 5.228x speedup, test set 0.882x speedup, val set 5.461x speedup, step: 29
Epoch 29/200 |loss: 11.569444| train set 5.228x speedup, test set 0.865x speedup, val set 5.461x speedup, step: 30
Epoch 30/200 |loss: 11.468994| train set 5.228x speedup, test set 0.849x speedup, val set 5.461x speedup, step: 31
Epoch 31/200 |loss: 11.214497| train set 5.248x speedup, test set 1.129x speedup, val set 5.489x speedup, step: 32
Epoch 32/200 |loss: 11.152063| train set 5.228x speedup, test set 0.834x speedup, val set 5.461x speedup, step: 33
Epoch 33/200 |loss: 11.450258| train set 5.248x speedup, test set 0.845x speedup, val set 5.489x speedup, step: 34
Epoch 34/200 |loss: 10.810244| train set 5.248x speedup, test set 1.128x speedup, val set 5.489x speedup, step: 35
Epoch 35/200 |loss: 10.516109| train set 5.248x speedup, test set 0.882x speedup, val set 5.489x speedup, step: 36
Epoch 36/200 |loss: 10.265846| train set 5.170x speedup, test set 0.833x speedup, val set 5.410x speedup, step: 37
Epoch 37/200 |loss: 10.346985| train set 5.248x speedup, test set 1.075x speedup, val set 5.489x speedup, step: 38
Epoch 38/200 |loss: 10.017177| train set 5.248x speedup, test set 0.851x speedup, val set 5.489x speedup, step: 39
Epoch 39/200 |loss: 10.019658| train set 5.223x speedup, test set 1.176x speedup, val set 5.476x speedup, step: 40
Epoch 40/200 |loss: 10.188216| train set 5.248x speedup, test set 1.057x speedup, val set 5.489x speedup, step: 41
Epoch 41/200 |loss: 9.652280| train set 5.170x speedup, test set 0.842x speedup, val set 5.410x speedup, step: 42
Epoch 42/200 |loss: 9.909803| train set 5.223x speedup, test set 1.170x speedup, val set 5.476x speedup, step: 43
Epoch 43/200 |loss: 9.758286| train set 5.039x speedup, test set 1.176x speedup, val set 5.325x speedup, step: 44
Epoch 44/200 |loss: 9.571247| train set 5.249x speedup, test set 0.878x speedup, val set 5.487x speedup, step: 45
Epoch 45/200 |loss: 9.365575| train set 5.249x speedup, test set 0.868x speedup, val set 5.487x speedup, step: 46
Epoch 46/200 |loss: 9.233922| train set 5.249x speedup, test set 1.170x speedup, val set 5.487x speedup, step: 47
Epoch 47/200 |loss: 8.996316| train set 5.249x speedup, test set 0.908x speedup, val set 5.487x speedup, step: 48
Epoch 48/200 |loss: 9.135054| train set 5.249x speedup, test set 0.863x speedup, val set 5.487x speedup, step: 49
Epoch 49/200 |loss: 8.663151| train set 5.249x speedup, test set 1.155x speedup, val set 5.487x speedup, step: 50
Epoch 50/200 |loss: 8.864260| train set 5.249x speedup, test set 0.862x speedup, val set 5.487x speedup, step: 51
Epoch 51/200 |loss: 8.462327| train set 5.249x speedup, test set 0.862x speedup, val set 5.487x speedup, step: 52
Epoch 52/200 |loss: 8.619911| train set 5.249x speedup, test set 1.122x speedup, val set 5.487x speedup, step: 53
Epoch 53/200 |loss: 8.334470| train set 5.211x speedup, test set 0.843x speedup, val set 5.389x speedup, step: 54
Epoch 54/200 |loss: 8.622822| train set 5.224x speedup, test set 1.114x speedup, val set 5.473x speedup, step: 55
Epoch 55/200 |loss: 8.855070| train set 5.249x speedup, test set 0.864x speedup, val set 5.487x speedup, step: 56
Epoch 56/200 |loss: 8.464300| train set 5.211x speedup, test set 0.866x speedup, val set 5.389x speedup, step: 57
Epoch 57/200 |loss: 8.428907| train set 5.249x speedup, test set 1.098x speedup, val set 5.487x speedup, step: 58
Epoch 58/200 |loss: 8.425973| train set 5.249x speedup, test set 0.839x speedup, val set 5.487x speedup, step: 59
Epoch 59/200 |loss: 8.239207| train set 5.211x speedup, test set 0.861x speedup, val set 5.389x speedup, step: 60
Epoch 60/200 |loss: 8.548984| train set 5.249x speedup, test set 1.084x speedup, val set 5.487x speedup, step: 61
Epoch 61/200 |loss: 8.558414| train set 5.249x speedup, test set 0.844x speedup, val set 5.487x speedup, step: 62
Epoch 62/200 |loss: 8.133100| train set 5.211x speedup, test set 0.856x speedup, val set 5.389x speedup, step: 63
Epoch 63/200 |loss: 8.405192| train set 5.210x speedup, test set 1.095x speedup, val set 5.389x speedup, step: 64
Epoch 64/200 |loss: 8.256505| train set 5.041x speedup, test set 1.095x speedup, val set 5.325x speedup, step: 65
Epoch 65/200 |loss: 8.091552| train set 5.211x speedup, test set 0.845x speedup, val set 5.389x speedup, step: 66
Epoch 66/200 |loss: 7.987074| train set 5.211x speedup, test set 0.866x speedup, val set 5.389x speedup, step: 67
Epoch 67/200 |loss: 8.021623| train set 5.249x speedup, test set 1.095x speedup, val set 5.487x speedup, step: 68
Epoch 68/200 |loss: 7.915258| train set 5.249x speedup, test set 0.843x speedup, val set 5.487x speedup, step: 69
Epoch 69/200 |loss: 7.942239| train set 5.249x speedup, test set 0.860x speedup, val set 5.487x speedup, step: 70
Epoch 70/200 |loss: 7.737964| train set 5.211x speedup, test set 0.858x speedup, val set 5.389x speedup, step: 71
Epoch 71/200 |loss: 7.755017| train set 5.211x speedup, test set 0.858x speedup, val set 5.389x speedup, step: 72
Epoch 72/200 |loss: 7.650245| train set 5.249x speedup, test set 0.840x speedup, val set 5.487x speedup, step: 73
Epoch 73/200 |loss: 7.691697| train set 5.211x speedup, test set 0.845x speedup, val set 5.389x speedup, step: 74
Epoch 74/200 |loss: 7.693423| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 75
Epoch 75/200 |loss: 7.775091| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 76
Epoch 76/200 |loss: 7.678018| train set 5.224x speedup, test set 0.829x speedup, val set 5.473x speedup, step: 77
Epoch 77/200 |loss: 7.765122| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 78
Epoch 78/200 |loss: 7.532065| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 79
Epoch 79/200 |loss: 7.399616| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 80
Epoch 80/200 |loss: 7.411733| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 81
Epoch 81/200 |loss: 7.463181| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 82
Epoch 82/200 |loss: 7.679268| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 83
Epoch 83/200 |loss: 7.545053| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 84
Epoch 84/200 |loss: 7.393240| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 85
Epoch 85/200 |loss: 7.310350| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 86
Epoch 86/200 |loss: 7.245280| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 87
Epoch 87/200 |loss: 7.318515| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 88
Epoch 88/200 |loss: 7.483424| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 89
Epoch 89/200 |loss: 8.320236| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 90
Epoch 90/200 |loss: 7.591950| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 91
Epoch 91/200 |loss: 8.578100| train set 5.117x speedup, test set 1.050x speedup, val set 5.444x speedup, step: 92
Epoch 92/200 |loss: 9.032812| train set 5.018x speedup, test set 1.026x speedup, val set 5.312x speedup, step: 93
Epoch 93/200 |loss: 8.748809| train set 5.211x speedup, test set 0.816x speedup, val set 5.389x speedup, step: 94
Epoch 94/200 |loss: 8.456185| train set 5.249x speedup, test set 0.850x speedup, val set 5.487x speedup, step: 95
Epoch 95/200 |loss: 8.154151| train set 5.247x speedup, test set 1.057x speedup, val set 5.484x speedup, step: 96
Epoch 96/200 |loss: 8.059382| train set 5.249x speedup, test set 0.835x speedup, val set 5.487x speedup, step: 97
Epoch 97/200 |loss: 7.924826| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 98
Epoch 98/200 |loss: 7.798950| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 99
Epoch 99/200 |loss: 7.943913| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 100
Epoch 100/200 |loss: 7.666811| train set 5.186x speedup, test set 0.822x speedup, val set 5.375x speedup, step: 1
Epoch 101/200 |loss: 7.675496| train set 5.186x speedup, test set 0.821x speedup, val set 5.375x speedup, step: 1
Epoch 102/200 |loss: 7.691370| train set 5.186x speedup, test set 0.822x speedup, val set 5.375x speedup, step: 1
Epoch 103/200 |loss: 7.569647| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 104/200 |loss: 7.468915| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 105/200 |loss: 7.500305| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 106/200 |loss: 7.433336| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 2
Epoch 107/200 |loss: 7.385964| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 108/200 |loss: 7.341387| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 109/200 |loss: 7.316055| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 110/200 |loss: 7.294554| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 111/200 |loss: 7.220349| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 112/200 |loss: 7.227078| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 2
Epoch 113/200 |loss: 7.169920| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 114/200 |loss: 7.161626| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 115/200 |loss: 7.169142| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 2
Epoch 116/200 |loss: 7.136843| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 3
Epoch 117/200 |loss: 7.187387| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 4
Epoch 118/200 |loss: 7.238213| train set 5.224x speedup, test set 0.798x speedup, val set 5.473x speedup, step: 5
Epoch 119/200 |loss: 7.520250| train set 5.211x speedup, test set 0.804x speedup, val set 5.389x speedup, step: 6
Epoch 120/200 |loss: 7.386305| train set 5.249x speedup, test set 0.799x speedup, val set 5.487x speedup, step: 1
Epoch 121/200 |loss: 7.286339| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 2
Epoch 122/200 |loss: 7.098487| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 3
Epoch 123/200 |loss: 7.180039| train set 5.249x speedup, test set 0.798x speedup, val set 5.487x speedup, step: 1
Epoch 124/200 |loss: 7.375257| train set 5.249x speedup, test set 0.799x speedup, val set 5.487x speedup, step: 1
Epoch 125/200 |loss: 7.084206| train set 5.211x speedup, test set 0.798x speedup, val set 5.389x speedup, step: 2
Epoch 126/200 |loss: 7.191791| train set 5.224x speedup, test set 0.813x speedup, val set 5.473x speedup, step: 3
Epoch 127/200 |loss: 7.414226| train set 5.249x speedup, test set 0.798x speedup, val set 5.487x speedup, step: 1
Epoch 128/200 |loss: 7.062050| train set 5.213x speedup, test set 0.799x speedup, val set 5.373x speedup, step: 2
Epoch 129/200 |loss: 7.418948| train set 5.224x speedup, test set 0.813x speedup, val set 5.473x speedup, step: 3
Epoch 130/200 |loss: 7.475157| train set 5.249x speedup, test set 0.798x speedup, val set 5.487x speedup, step: 1
Epoch 131/200 |loss: 7.231560| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 2
Epoch 132/200 |loss: 7.487590| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 133/200 |loss: 7.221811| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 134/200 |loss: 7.199508| train set 5.211x speedup, test set 0.807x speedup, val set 5.389x speedup, step: 2
Epoch 135/200 |loss: 7.217807| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 3
Epoch 136/200 |loss: 7.156230| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 4
Epoch 137/200 |loss: 7.300802| train set 5.249x speedup, test set 0.798x speedup, val set 5.487x speedup, step: 1
Epoch 138/200 |loss: 7.123599| train set 5.211x speedup, test set 0.808x speedup, val set 5.389x speedup, step: 2
Epoch 139/200 |loss: 7.163766| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 140/200 |loss: 7.088061| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 141/200 |loss: 7.054471| train set 5.249x speedup, test set 0.798x speedup, val set 5.487x speedup, step: 1
Epoch 142/200 |loss: 7.119593| train set 5.211x speedup, test set 0.798x speedup, val set 5.389x speedup, step: 2
Epoch 143/200 |loss: 7.026852| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 3
Epoch 144/200 |loss: 7.080202| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 4
Epoch 145/200 |loss: 7.015627| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 5
Epoch 146/200 |loss: 7.023595| train set 5.249x speedup, test set 0.798x speedup, val set 5.487x speedup, step: 1
Epoch 147/200 |loss: 6.962084| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 2
Epoch 148/200 |loss: 7.043169| train set 5.249x speedup, test set 0.798x speedup, val set 5.487x speedup, step: 1
Epoch 149/200 |loss: 6.976057| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 2
Epoch 150/200 |loss: 7.005458| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 151/200 |loss: 6.989954| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 152/200 |loss: 6.981159| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 2
Epoch 153/200 |loss: 6.937077| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 3
Epoch 154/200 |loss: 6.933748| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 155/200 |loss: 6.944121| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 2
Epoch 156/200 |loss: 6.927601| train set 5.249x speedup, test set 0.785x speedup, val set 5.487x speedup, step: 1
Epoch 157/200 |loss: 6.953470| train set 5.249x speedup, test set 0.798x speedup, val set 5.487x speedup, step: 1
Epoch 158/200 |loss: 6.939773| train set 5.211x speedup, test set 0.785x speedup, val set 5.389x speedup, step: 2
Epoch 159/200 |loss: 7.021141| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 160/200 |loss: 7.090322| train set 5.211x speedup, test set 0.783x speedup, val set 5.389x speedup, step: 2
Epoch 161/200 |loss: 7.202369| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 3
Epoch 162/200 |loss: 7.191025| train set 5.211x speedup, test set 0.783x speedup, val set 5.389x speedup, step: 4
Epoch 163/200 |loss: 7.042509| train set 5.249x speedup, test set 0.785x speedup, val set 5.487x speedup, step: 1
Epoch 164/200 |loss: 6.908109| train set 5.249x speedup, test set 0.800x speedup, val set 5.487x speedup, step: 1
Epoch 165/200 |loss: 6.930327| train set 5.211x speedup, test set 0.797x speedup, val set 5.389x speedup, step: 2
Epoch 166/200 |loss: 7.076619| train set 5.249x speedup, test set 0.800x speedup, val set 5.487x speedup, step: 1
Epoch 167/200 |loss: 7.046978| train set 5.249x speedup, test set 0.775x speedup, val set 5.487x speedup, step: 1
Epoch 168/200 |loss: 6.920548| train set 5.211x speedup, test set 0.789x speedup, val set 5.389x speedup, step: 2
Epoch 169/200 |loss: 6.913048| train set 5.224x speedup, test set 0.805x speedup, val set 5.473x speedup, step: 3
Epoch 170/200 |loss: 7.004112| train set 5.213x speedup, test set 0.775x speedup, val set 5.373x speedup, step: 4
Epoch 171/200 |loss: 6.965482| train set 5.249x speedup, test set 0.777x speedup, val set 5.487x speedup, step: 1
Epoch 172/200 |loss: 6.916731| train set 5.249x speedup, test set 0.805x speedup, val set 5.487x speedup, step: 1
Epoch 173/200 |loss: 6.870934| train set 5.211x speedup, test set 0.791x speedup, val set 5.389x speedup, step: 2
Epoch 174/200 |loss: 6.925326| train set 5.249x speedup, test set 0.805x speedup, val set 5.487x speedup, step: 1
Epoch 175/200 |loss: 6.933542| train set 5.211x speedup, test set 0.791x speedup, val set 5.389x speedup, step: 2
Epoch 176/200 |loss: 6.903780| train set 5.249x speedup, test set 0.777x speedup, val set 5.487x speedup, step: 1
Epoch 177/200 |loss: 6.855575| train set 5.249x speedup, test set 0.791x speedup, val set 5.487x speedup, step: 1
Epoch 178/200 |loss: 6.886216| train set 5.211x speedup, test set 0.775x speedup, val set 5.389x speedup, step: 2
Epoch 179/200 |loss: 6.912735| train set 5.249x speedup, test set 0.777x speedup, val set 5.487x speedup, step: 1
Epoch 180/200 |loss: 6.887710| train set 5.249x speedup, test set 0.783x speedup, val set 5.487x speedup, step: 1
Epoch 181/200 |loss: 6.853854| train set 5.213x speedup, test set 0.783x speedup, val set 5.373x speedup, step: 2
Epoch 182/200 |loss: 6.906974| train set 5.249x speedup, test set 0.785x speedup, val set 5.487x speedup, step: 1
Epoch 183/200 |loss: 7.211343| train set 5.213x speedup, test set 0.783x speedup, val set 5.373x speedup, step: 2
Epoch 184/200 |loss: 7.438305| train set 5.249x speedup, test set 0.778x speedup, val set 5.487x speedup, step: 1
Epoch 185/200 |loss: 8.263948| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 186/200 |loss: 7.104048| train set 5.213x speedup, test set 0.783x speedup, val set 5.373x speedup, step: 2
Epoch 187/200 |loss: 8.180235| train set 5.249x speedup, test set 0.777x speedup, val set 5.487x speedup, step: 1
Epoch 188/200 |loss: 8.095285| train set 5.249x speedup, test set 0.792x speedup, val set 5.487x speedup, step: 1
Epoch 189/200 |loss: 7.774775| train set 5.213x speedup, test set 0.790x speedup, val set 5.373x speedup, step: 2
Epoch 190/200 |loss: 7.846301| train set 5.249x speedup, test set 0.778x speedup, val set 5.487x speedup, step: 1
Epoch 191/200 |loss: 7.558074| train set 5.249x speedup, test set 0.785x speedup, val set 5.487x speedup, step: 1
Epoch 192/200 |loss: 7.469757| train set 5.211x speedup, test set 0.797x speedup, val set 5.389x speedup, step: 2
Epoch 193/200 |loss: 7.464619| train set 5.211x speedup, test set 0.806x speedup, val set 5.389x speedup, step: 3
Epoch 194/200 |loss: 7.371634| train set 5.211x speedup, test set 0.782x speedup, val set 5.389x speedup, step: 4
Epoch 195/200 |loss: 7.379781| train set 5.249x speedup, test set 0.783x speedup, val set 5.487x speedup, step: 1
Epoch 196/200 |loss: 7.217314| train set 5.249x speedup, test set 0.783x speedup, val set 5.487x speedup, step: 1
Epoch 197/200 |loss: 7.282525| train set 5.249x speedup, test set 0.797x speedup, val set 5.487x speedup, step: 1
Epoch 198/200 |loss: 7.177668| train set 5.211x speedup, test set 0.802x speedup, val set 5.389x speedup, step: 2
Epoch 199/200 |loss: 7.148647| train set 5.211x speedup, test set 0.787x speedup, val set 5.389x speedup, step: 3
Training per epoch cost 0.258 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.204s, pg runtime 0.239s, speedup 1.170x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 44, train speedup 5.249, test speedup 0.878, val speedup 5.487
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 197, train speedup 5.249, test speedup 0.797, val speedup 5.487
last model at epoch 199, train speedup 5.211, test speedup 0.787, val speedup 5.389
execution cost 0:02:44.784898
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.984937, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146671| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705292| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.175203| train set 3.535x speedup, test set 1.092x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701210| train set 3.947x speedup, test set 0.890x speedup, val set 3.977x speedup, step: 6
Epoch 6/200 |loss: 21.219828| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.772020| train set 4.074x speedup, test set 0.862x speedup, val set 4.190x speedup, step: 8
Epoch 8/200 |loss: 20.309597| train set 4.128x speedup, test set 0.742x speedup, val set 4.255x speedup, step: 9
Epoch 9/200 |loss: 19.851427| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.351755| train set 3.817x speedup, test set 0.684x speedup, val set 3.941x speedup, step: 11
Epoch 11/200 |loss: 18.840254| train set 4.021x speedup, test set 0.691x speedup, val set 4.124x speedup, step: 12
Epoch 12/200 |loss: 18.278048| train set 4.023x speedup, test set 0.655x speedup, val set 4.125x speedup, step: 13
Epoch 13/200 |loss: 17.774141| train set 4.370x speedup, test set 0.685x speedup, val set 4.469x speedup, step: 14
Epoch 14/200 |loss: 17.279646| train set 4.370x speedup, test set 0.832x speedup, val set 4.469x speedup, step: 15
Epoch 15/200 |loss: 16.766829| train set 4.368x speedup, test set 0.844x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.276306| train set 4.450x speedup, test set 0.815x speedup, val set 4.552x speedup, step: 17
Epoch 17/200 |loss: 15.765733| train set 4.370x speedup, test set 0.848x speedup, val set 4.470x speedup, step: 18
Epoch 18/200 |loss: 15.310211| train set 4.436x speedup, test set 0.824x speedup, val set 4.536x speedup, step: 19
Epoch 19/200 |loss: 15.014012| train set 4.436x speedup, test set 0.825x speedup, val set 4.536x speedup, step: 20
Epoch 20/200 |loss: 14.795269| train set 4.606x speedup, test set 0.794x speedup, val set 4.828x speedup, step: 21
Epoch 21/200 |loss: 14.199165| train set 4.754x speedup, test set 0.794x speedup, val set 5.000x speedup, step: 22
Epoch 22/200 |loss: 13.714581| train set 4.987x speedup, test set 0.873x speedup, val set 5.151x speedup, step: 23
Epoch 23/200 |loss: 13.620460| train set 5.021x speedup, test set 0.816x speedup, val set 5.301x speedup, step: 24
Epoch 24/200 |loss: 13.199064| train set 5.150x speedup, test set 0.829x speedup, val set 5.383x speedup, step: 25
Epoch 25/200 |loss: 12.711620| train set 5.027x speedup, test set 0.869x speedup, val set 5.208x speedup, step: 26
Epoch 26/200 |loss: 12.680654| train set 5.228x speedup, test set 0.816x speedup, val set 5.459x speedup, step: 27
Epoch 27/200 |loss: 12.357665| train set 5.228x speedup, test set 0.830x speedup, val set 5.461x speedup, step: 28
Epoch 28/200 |loss: 11.875287| train set 5.228x speedup, test set 0.875x speedup, val set 5.461x speedup, step: 29
Epoch 29/200 |loss: 11.615207| train set 5.228x speedup, test set 0.866x speedup, val set 5.461x speedup, step: 30
Epoch 30/200 |loss: 11.575490| train set 5.228x speedup, test set 0.882x speedup, val set 5.461x speedup, step: 31
Epoch 31/200 |loss: 11.571791| train set 5.228x speedup, test set 0.877x speedup, val set 5.461x speedup, step: 32
Epoch 32/200 |loss: 11.018954| train set 5.228x speedup, test set 0.821x speedup, val set 5.461x speedup, step: 33
Epoch 33/200 |loss: 11.058819| train set 5.223x speedup, test set 1.179x speedup, val set 5.476x speedup, step: 34
Epoch 34/200 |loss: 11.066388| train set 5.248x speedup, test set 0.876x speedup, val set 5.489x speedup, step: 35
Epoch 35/200 |loss: 10.291021| train set 5.228x speedup, test set 0.851x speedup, val set 5.461x speedup, step: 36
Epoch 36/200 |loss: 10.766999| train set 5.248x speedup, test set 1.161x speedup, val set 5.489x speedup, step: 37
Epoch 37/200 |loss: 10.402533| train set 5.248x speedup, test set 1.179x speedup, val set 5.489x speedup, step: 38
Epoch 38/200 |loss: 9.904595| train set 5.165x speedup, test set 0.880x speedup, val set 5.418x speedup, step: 39
Epoch 39/200 |loss: 10.125661| train set 5.248x speedup, test set 1.173x speedup, val set 5.489x speedup, step: 40
Epoch 40/200 |loss: 9.519631| train set 5.248x speedup, test set 1.161x speedup, val set 5.489x speedup, step: 41
Epoch 41/200 |loss: 9.769246| train set 5.248x speedup, test set 0.883x speedup, val set 5.489x speedup, step: 42
Epoch 42/200 |loss: 10.074650| train set 5.248x speedup, test set 1.102x speedup, val set 5.489x speedup, step: 43
Epoch 43/200 |loss: 10.518119| train set 5.248x speedup, test set 1.115x speedup, val set 5.489x speedup, step: 44
Epoch 44/200 |loss: 9.409406| train set 5.248x speedup, test set 0.873x speedup, val set 5.489x speedup, step: 45
Epoch 45/200 |loss: 9.887416| train set 5.247x speedup, test set 0.865x speedup, val set 5.487x speedup, step: 46
Epoch 46/200 |loss: 9.947205| train set 5.248x speedup, test set 1.099x speedup, val set 5.489x speedup, step: 47
Epoch 47/200 |loss: 9.484621| train set 5.249x speedup, test set 0.871x speedup, val set 5.487x speedup, step: 48
Epoch 48/200 |loss: 9.562111| train set 5.249x speedup, test set 0.880x speedup, val set 5.487x speedup, step: 49
Epoch 49/200 |loss: 9.125846| train set 5.249x speedup, test set 1.115x speedup, val set 5.487x speedup, step: 50
Epoch 50/200 |loss: 9.093990| train set 5.247x speedup, test set 1.099x speedup, val set 5.484x speedup, step: 51
Epoch 51/200 |loss: 8.967770| train set 5.249x speedup, test set 0.865x speedup, val set 5.487x speedup, step: 52
Epoch 52/200 |loss: 8.718296| train set 5.249x speedup, test set 0.870x speedup, val set 5.487x speedup, step: 53
Epoch 53/200 |loss: 8.729748| train set 5.249x speedup, test set 0.865x speedup, val set 5.487x speedup, step: 54
Epoch 54/200 |loss: 8.523530| train set 5.249x speedup, test set 0.865x speedup, val set 5.487x speedup, step: 55
Epoch 55/200 |loss: 8.483082| train set 5.249x speedup, test set 1.092x speedup, val set 5.487x speedup, step: 56
Epoch 56/200 |loss: 8.384150| train set 5.211x speedup, test set 0.854x speedup, val set 5.389x speedup, step: 57
Epoch 57/200 |loss: 8.275406| train set 5.249x speedup, test set 0.862x speedup, val set 5.487x speedup, step: 58
Epoch 58/200 |loss: 8.173955| train set 5.249x speedup, test set 0.862x speedup, val set 5.487x speedup, step: 59
Epoch 59/200 |loss: 8.099641| train set 5.249x speedup, test set 0.852x speedup, val set 5.487x speedup, step: 60
Epoch 60/200 |loss: 8.051394| train set 5.249x speedup, test set 0.862x speedup, val set 5.487x speedup, step: 61
Epoch 61/200 |loss: 7.948925| train set 5.211x speedup, test set 0.852x speedup, val set 5.389x speedup, step: 62
Epoch 62/200 |loss: 7.995938| train set 5.249x speedup, test set 0.862x speedup, val set 5.487x speedup, step: 63
Epoch 63/200 |loss: 8.040257| train set 5.211x speedup, test set 0.852x speedup, val set 5.389x speedup, step: 64
Epoch 64/200 |loss: 7.938350| train set 5.249x speedup, test set 0.862x speedup, val set 5.487x speedup, step: 65
Epoch 65/200 |loss: 7.927845| train set 5.211x speedup, test set 0.836x speedup, val set 5.389x speedup, step: 66
Epoch 66/200 |loss: 7.816608| train set 5.211x speedup, test set 0.852x speedup, val set 5.389x speedup, step: 67
Epoch 67/200 |loss: 7.796238| train set 5.249x speedup, test set 0.862x speedup, val set 5.487x speedup, step: 68
Epoch 68/200 |loss: 7.982733| train set 5.211x speedup, test set 0.836x speedup, val set 5.389x speedup, step: 69
Epoch 69/200 |loss: 8.809217| train set 5.224x speedup, test set 0.862x speedup, val set 5.473x speedup, step: 70
Epoch 70/200 |loss: 8.486255| train set 5.211x speedup, test set 0.837x speedup, val set 5.389x speedup, step: 71
Epoch 71/200 |loss: 7.921211| train set 5.039x speedup, test set 0.836x speedup, val set 5.322x speedup, step: 72
Epoch 72/200 |loss: 8.793211| train set 5.249x speedup, test set 0.853x speedup, val set 5.487x speedup, step: 73
Epoch 73/200 |loss: 7.855490| train set 5.249x speedup, test set 0.850x speedup, val set 5.487x speedup, step: 74
Epoch 74/200 |loss: 8.117949| train set 5.249x speedup, test set 0.837x speedup, val set 5.487x speedup, step: 75
Epoch 75/200 |loss: 8.142728| train set 5.211x speedup, test set 0.852x speedup, val set 5.389x speedup, step: 76
Epoch 76/200 |loss: 7.861254| train set 5.249x speedup, test set 0.861x speedup, val set 5.487x speedup, step: 77
Epoch 77/200 |loss: 8.486214| train set 5.211x speedup, test set 0.853x speedup, val set 5.389x speedup, step: 78
Epoch 78/200 |loss: 7.675755| train set 5.211x speedup, test set 0.853x speedup, val set 5.389x speedup, step: 79
Epoch 79/200 |loss: 7.964866| train set 5.224x speedup, test set 0.853x speedup, val set 5.473x speedup, step: 80
Epoch 80/200 |loss: 7.775643| train set 5.249x speedup, test set 0.836x speedup, val set 5.487x speedup, step: 81
Epoch 81/200 |loss: 7.862626| train set 5.211x speedup, test set 0.853x speedup, val set 5.389x speedup, step: 82
Epoch 82/200 |loss: 7.588998| train set 5.249x speedup, test set 0.853x speedup, val set 5.487x speedup, step: 83
Epoch 83/200 |loss: 7.750036| train set 5.249x speedup, test set 0.853x speedup, val set 5.487x speedup, step: 84
Epoch 84/200 |loss: 7.569851| train set 5.249x speedup, test set 0.853x speedup, val set 5.487x speedup, step: 85
Epoch 85/200 |loss: 7.563950| train set 5.186x speedup, test set 0.853x speedup, val set 5.375x speedup, step: 86
Epoch 86/200 |loss: 7.469928| train set 5.211x speedup, test set 0.853x speedup, val set 5.389x speedup, step: 87
Epoch 87/200 |loss: 7.526010| train set 5.224x speedup, test set 0.853x speedup, val set 5.473x speedup, step: 88
Epoch 88/200 |loss: 7.686991| train set 5.211x speedup, test set 0.853x speedup, val set 5.389x speedup, step: 89
Epoch 89/200 |loss: 7.533547| train set 5.249x speedup, test set 0.853x speedup, val set 5.487x speedup, step: 90
Epoch 90/200 |loss: 7.466046| train set 5.249x speedup, test set 0.853x speedup, val set 5.487x speedup, step: 91
Epoch 91/200 |loss: 7.337974| train set 5.249x speedup, test set 0.853x speedup, val set 5.487x speedup, step: 92
Epoch 92/200 |loss: 7.309053| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 93
Epoch 93/200 |loss: 7.364673| train set 5.211x speedup, test set 0.853x speedup, val set 5.389x speedup, step: 94
Epoch 94/200 |loss: 7.366535| train set 5.224x speedup, test set 0.853x speedup, val set 5.473x speedup, step: 95
Epoch 95/200 |loss: 7.768982| train set 5.249x speedup, test set 0.853x speedup, val set 5.487x speedup, step: 96
Epoch 96/200 |loss: 7.331926| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 97
Epoch 97/200 |loss: 7.274752| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 98
Epoch 98/200 |loss: 7.395535| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 99
Epoch 99/200 |loss: 7.319229| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 100
Epoch 100/200 |loss: 7.192860| train set 5.211x speedup, test set 0.810x speedup, val set 5.389x speedup, step: 1
Epoch 101/200 |loss: 7.183420| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 102/200 |loss: 7.150810| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 103/200 |loss: 7.250179| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 2
Epoch 104/200 |loss: 7.179746| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 105/200 |loss: 7.172890| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 2
Epoch 106/200 |loss: 7.117139| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 107/200 |loss: 7.090942| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 2
Epoch 108/200 |loss: 7.063177| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 109/200 |loss: 7.056612| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 110/200 |loss: 7.057442| train set 5.210x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 111/200 |loss: 7.108176| train set 5.213x speedup, test set 0.810x speedup, val set 5.373x speedup, step: 2
Epoch 112/200 |loss: 7.310675| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 3
Epoch 113/200 |loss: 8.224379| train set 5.211x speedup, test set 0.806x speedup, val set 5.389x speedup, step: 4
Epoch 114/200 |loss: 7.262511| train set 5.213x speedup, test set 0.825x speedup, val set 5.373x speedup, step: 5
Epoch 115/200 |loss: 8.374684| train set 5.224x speedup, test set 0.813x speedup, val set 5.473x speedup, step: 6
Epoch 116/200 |loss: 8.471026| train set 5.249x speedup, test set 0.815x speedup, val set 5.487x speedup, step: 1
Epoch 117/200 |loss: 8.343582| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 118/200 |loss: 8.227259| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 119/200 |loss: 7.992249| train set 5.247x speedup, test set 0.797x speedup, val set 5.484x speedup, step: 2
Epoch 120/200 |loss: 8.015136| train set 5.249x speedup, test set 0.797x speedup, val set 5.487x speedup, step: 1
Epoch 121/200 |loss: 7.596072| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 122/200 |loss: 7.674552| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 123/200 |loss: 7.646373| train set 5.224x speedup, test set 0.799x speedup, val set 5.473x speedup, step: 2
Epoch 124/200 |loss: 7.563891| train set 5.184x speedup, test set 0.814x speedup, val set 5.373x speedup, step: 3
Epoch 125/200 |loss: 7.443169| train set 5.209x speedup, test set 0.812x speedup, val set 5.386x speedup, step: 4
Epoch 126/200 |loss: 7.549023| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 5
Epoch 127/200 |loss: 7.359273| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 6
Epoch 128/200 |loss: 7.353212| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 129/200 |loss: 7.347359| train set 5.211x speedup, test set 0.817x speedup, val set 5.389x speedup, step: 2
Epoch 130/200 |loss: 7.257267| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 3
Epoch 131/200 |loss: 7.232474| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 132/200 |loss: 7.239270| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 133/200 |loss: 7.169459| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 2
Epoch 134/200 |loss: 7.179554| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 135/200 |loss: 7.128655| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 1
Epoch 136/200 |loss: 7.120682| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 137/200 |loss: 7.094714| train set 5.205x speedup, test set 0.826x speedup, val set 5.375x speedup, step: 2
Epoch 138/200 |loss: 7.069963| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 3
Epoch 139/200 |loss: 7.072421| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 4
Epoch 140/200 |loss: 7.047668| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 5
Epoch 141/200 |loss: 7.042394| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 142/200 |loss: 7.103565| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 143/200 |loss: 7.352267| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 144/200 |loss: 7.516949| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 145/200 |loss: 7.908808| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 1
Epoch 146/200 |loss: 7.095541| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 147/200 |loss: 7.563051| train set 5.186x speedup, test set 0.821x speedup, val set 5.375x speedup, step: 3
Epoch 148/200 |loss: 8.125845| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 4
Epoch 149/200 |loss: 7.229909| train set 5.251x speedup, test set 0.811x speedup, val set 5.471x speedup, step: 5
Epoch 150/200 |loss: 8.045315| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 151/200 |loss: 7.289174| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 152/200 |loss: 7.525238| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 153/200 |loss: 7.250773| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 154/200 |loss: 7.435488| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 155/200 |loss: 7.215330| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 156/200 |loss: 7.288227| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 157/200 |loss: 7.140460| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 158/200 |loss: 7.247035| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 159/200 |loss: 7.081230| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 160/200 |loss: 7.172016| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 3
Epoch 161/200 |loss: 7.021788| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 162/200 |loss: 7.147068| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 163/200 |loss: 6.975753| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 164/200 |loss: 7.090372| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 165/200 |loss: 6.956901| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 166/200 |loss: 7.032092| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 167/200 |loss: 6.964151| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 168/200 |loss: 6.980253| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 169/200 |loss: 6.952721| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 170/200 |loss: 6.945396| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 171/200 |loss: 6.947902| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 3
Epoch 172/200 |loss: 6.925710| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 173/200 |loss: 6.947021| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 174/200 |loss: 6.937880| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 175/200 |loss: 7.041514| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 2
Epoch 176/200 |loss: 7.046652| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 3
Epoch 177/200 |loss: 7.262989| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 4
Epoch 178/200 |loss: 6.933934| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 5
Epoch 179/200 |loss: 6.983366| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 6
Epoch 180/200 |loss: 7.155146| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 181/200 |loss: 6.920941| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 2
Epoch 182/200 |loss: 7.091985| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 3
Epoch 183/200 |loss: 7.152869| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 184/200 |loss: 7.003223| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 2
Epoch 185/200 |loss: 7.131954| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 3
Epoch 186/200 |loss: 7.058807| train set 5.249x speedup, test set 0.808x speedup, val set 5.487x speedup, step: 1
Epoch 187/200 |loss: 6.990197| train set 5.213x speedup, test set 0.812x speedup, val set 5.373x speedup, step: 2
Epoch 188/200 |loss: 7.005387| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 189/200 |loss: 6.970462| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 190/200 |loss: 6.912332| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 191/200 |loss: 6.972145| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 192/200 |loss: 6.874478| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 193/200 |loss: 6.960434| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 194/200 |loss: 6.873423| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 195/200 |loss: 6.888230| train set 5.186x speedup, test set 0.823x speedup, val set 5.375x speedup, step: 3
Epoch 196/200 |loss: 6.883662| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 4
Epoch 197/200 |loss: 6.848225| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 198/200 |loss: 6.872789| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 199/200 |loss: 6.832919| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Training per epoch cost 0.257 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 8.556s, pg runtime 6.444s, speedup 0.753x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 149, train speedup 5.251, test speedup 0.811, val speedup 5.471
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 198, train speedup 5.249, test speedup 0.803, val speedup 5.487
last model at epoch 199, train speedup 5.211, test speedup 0.827, val speedup 5.389
execution cost 0:02:40.235547
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.935009, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146669| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705244| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.174875| train set 3.535x speedup, test set 1.093x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701832| train set 3.514x speedup, test set 0.890x speedup, val set 3.526x speedup, step: 6
Epoch 6/200 |loss: 21.222296| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.778355| train set 3.923x speedup, test set 0.862x speedup, val set 3.931x speedup, step: 8
Epoch 8/200 |loss: 20.327324| train set 4.246x speedup, test set 0.742x speedup, val set 4.414x speedup, step: 9
Epoch 9/200 |loss: 19.875662| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.373657| train set 3.785x speedup, test set 0.697x speedup, val set 3.895x speedup, step: 11
Epoch 11/200 |loss: 18.873276| train set 4.319x speedup, test set 0.688x speedup, val set 4.491x speedup, step: 12
Epoch 12/200 |loss: 18.302097| train set 4.092x speedup, test set 0.588x speedup, val set 4.163x speedup, step: 13
Epoch 13/200 |loss: 17.793098| train set 4.451x speedup, test set 0.671x speedup, val set 4.553x speedup, step: 14
Epoch 14/200 |loss: 17.328718| train set 4.368x speedup, test set 0.831x speedup, val set 4.468x speedup, step: 15
Epoch 15/200 |loss: 16.794867| train set 4.368x speedup, test set 0.821x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.305067| train set 4.368x speedup, test set 0.823x speedup, val set 4.468x speedup, step: 17
Epoch 17/200 |loss: 15.838117| train set 4.436x speedup, test set 0.819x speedup, val set 4.536x speedup, step: 18
Epoch 18/200 |loss: 15.392319| train set 4.370x speedup, test set 0.831x speedup, val set 4.469x speedup, step: 19
Epoch 19/200 |loss: 14.956112| train set 4.606x speedup, test set 0.825x speedup, val set 4.826x speedup, step: 20
Epoch 20/200 |loss: 14.508800| train set 4.912x speedup, test set 0.825x speedup, val set 4.990x speedup, step: 21
Epoch 21/200 |loss: 14.085460| train set 4.987x speedup, test set 0.785x speedup, val set 5.151x speedup, step: 22
Epoch 22/200 |loss: 13.656830| train set 5.027x speedup, test set 0.848x speedup, val set 5.208x speedup, step: 23
Epoch 23/200 |loss: 13.275868| train set 5.228x speedup, test set 0.803x speedup, val set 5.461x speedup, step: 24
Epoch 24/200 |loss: 13.054028| train set 5.027x speedup, test set 0.879x speedup, val set 5.208x speedup, step: 25
Epoch 25/200 |loss: 13.684718| train set 5.228x speedup, test set 0.793x speedup, val set 5.461x speedup, step: 26
Epoch 26/200 |loss: 12.983651| train set 5.228x speedup, test set 0.836x speedup, val set 5.461x speedup, step: 27
Epoch 27/200 |loss: 12.502272| train set 5.203x speedup, test set 0.918x speedup, val set 5.448x speedup, step: 28
Epoch 28/200 |loss: 12.438362| train set 5.203x speedup, test set 0.876x speedup, val set 5.448x speedup, step: 29
Epoch 29/200 |loss: 11.862525| train set 5.228x speedup, test set 0.826x speedup, val set 5.461x speedup, step: 30
Epoch 30/200 |loss: 11.901197| train set 5.228x speedup, test set 0.882x speedup, val set 5.461x speedup, step: 31
Epoch 31/200 |loss: 11.255195| train set 5.228x speedup, test set 0.872x speedup, val set 5.461x speedup, step: 32
Epoch 32/200 |loss: 11.283035| train set 5.248x speedup, test set 1.119x speedup, val set 5.489x speedup, step: 33
Epoch 33/200 |loss: 10.924616| train set 5.248x speedup, test set 0.840x speedup, val set 5.489x speedup, step: 34
Epoch 34/200 |loss: 10.796833| train set 5.248x speedup, test set 1.118x speedup, val set 5.489x speedup, step: 35
Epoch 35/200 |loss: 10.363822| train set 5.248x speedup, test set 1.073x speedup, val set 5.489x speedup, step: 36
Epoch 36/200 |loss: 10.243374| train set 5.248x speedup, test set 1.067x speedup, val set 5.489x speedup, step: 37
Epoch 37/200 |loss: 10.002937| train set 5.248x speedup, test set 1.082x speedup, val set 5.489x speedup, step: 38
Epoch 38/200 |loss: 9.756903| train set 5.248x speedup, test set 1.074x speedup, val set 5.489x speedup, step: 39
Epoch 39/200 |loss: 9.715224| train set 5.248x speedup, test set 1.068x speedup, val set 5.489x speedup, step: 40
Epoch 40/200 |loss: 10.092651| train set 5.170x speedup, test set 0.840x speedup, val set 5.410x speedup, step: 41
Epoch 41/200 |loss: 10.476420| train set 5.223x speedup, test set 1.120x speedup, val set 5.476x speedup, step: 42
Epoch 42/200 |loss: 10.535278| train set 5.248x speedup, test set 0.842x speedup, val set 5.489x speedup, step: 43
Epoch 43/200 |loss: 9.663247| train set 5.137x speedup, test set 1.060x speedup, val set 5.369x speedup, step: 44
Epoch 44/200 |loss: 10.225401| train set 5.224x speedup, test set 1.120x speedup, val set 5.473x speedup, step: 45
Epoch 45/200 |loss: 9.470449| train set 5.170x speedup, test set 0.832x speedup, val set 5.408x speedup, step: 46
Epoch 46/200 |loss: 9.680769| train set 5.249x speedup, test set 1.055x speedup, val set 5.487x speedup, step: 47
Epoch 47/200 |loss: 9.332918| train set 5.249x speedup, test set 1.162x speedup, val set 5.487x speedup, step: 48
Epoch 48/200 |loss: 9.127341| train set 5.249x speedup, test set 1.060x speedup, val set 5.487x speedup, step: 49
Epoch 49/200 |loss: 9.161024| train set 5.249x speedup, test set 1.046x speedup, val set 5.487x speedup, step: 50
Epoch 50/200 |loss: 8.808641| train set 5.249x speedup, test set 1.046x speedup, val set 5.487x speedup, step: 51
Epoch 51/200 |loss: 8.812942| train set 5.249x speedup, test set 1.046x speedup, val set 5.487x speedup, step: 52
Epoch 52/200 |loss: 8.527830| train set 5.249x speedup, test set 0.835x speedup, val set 5.487x speedup, step: 53
Epoch 53/200 |loss: 8.620581| train set 5.249x speedup, test set 1.046x speedup, val set 5.487x speedup, step: 54
Epoch 54/200 |loss: 8.369720| train set 5.249x speedup, test set 1.046x speedup, val set 5.487x speedup, step: 55
Epoch 55/200 |loss: 8.368983| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 56
Epoch 56/200 |loss: 8.297547| train set 5.258x speedup, test set 1.046x speedup, val set 5.473x speedup, step: 57
Epoch 57/200 |loss: 8.219293| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 58
Epoch 58/200 |loss: 8.233284| train set 5.249x speedup, test set 1.047x speedup, val set 5.487x speedup, step: 59
Epoch 59/200 |loss: 8.307924| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 60
Epoch 60/200 |loss: 8.189001| train set 5.249x speedup, test set 1.047x speedup, val set 5.487x speedup, step: 61
Epoch 61/200 |loss: 8.115746| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 62
Epoch 62/200 |loss: 7.951540| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 63
Epoch 63/200 |loss: 7.764387| train set 5.249x speedup, test set 1.047x speedup, val set 5.487x speedup, step: 64
Epoch 64/200 |loss: 7.815242| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 65
Epoch 65/200 |loss: 7.815557| train set 5.224x speedup, test set 0.812x speedup, val set 5.473x speedup, step: 66
Epoch 66/200 |loss: 8.309742| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 67
Epoch 67/200 |loss: 8.042433| train set 5.224x speedup, test set 1.047x speedup, val set 5.473x speedup, step: 68
Epoch 68/200 |loss: 7.977139| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 69
Epoch 69/200 |loss: 7.682449| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 70
Epoch 70/200 |loss: 7.931067| train set 5.224x speedup, test set 1.042x speedup, val set 5.473x speedup, step: 71
Epoch 71/200 |loss: 8.371125| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 72
Epoch 72/200 |loss: 8.013348| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 73
Epoch 73/200 |loss: 8.231676| train set 5.224x speedup, test set 1.040x speedup, val set 5.473x speedup, step: 74
Epoch 74/200 |loss: 8.345578| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 75
Epoch 75/200 |loss: 7.888184| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 76
Epoch 76/200 |loss: 8.165516| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 77
Epoch 77/200 |loss: 8.253199| train set 5.224x speedup, test set 1.040x speedup, val set 5.473x speedup, step: 78
Epoch 78/200 |loss: 7.956120| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 79
Epoch 79/200 |loss: 8.002858| train set 5.211x speedup, test set 0.815x speedup, val set 5.389x speedup, step: 80
Epoch 80/200 |loss: 7.614556| train set 5.224x speedup, test set 0.831x speedup, val set 5.473x speedup, step: 81
Epoch 81/200 |loss: 7.900221| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 82
Epoch 82/200 |loss: 7.555910| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 83
Epoch 83/200 |loss: 7.770534| train set 5.224x speedup, test set 0.812x speedup, val set 5.473x speedup, step: 84
Epoch 84/200 |loss: 7.630817| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 85
Epoch 85/200 |loss: 7.504882| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 86
Epoch 86/200 |loss: 7.652604| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 87
Epoch 87/200 |loss: 7.620454| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 88
Epoch 88/200 |loss: 7.451362| train set 5.211x speedup, test set 0.811x speedup, val set 5.389x speedup, step: 89
Epoch 89/200 |loss: 7.639070| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 90
Epoch 90/200 |loss: 7.544251| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 91
Epoch 91/200 |loss: 7.372108| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 92
Epoch 92/200 |loss: 7.557782| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 93
Epoch 93/200 |loss: 7.378284| train set 5.186x speedup, test set 0.812x speedup, val set 5.375x speedup, step: 94
Epoch 94/200 |loss: 7.340096| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 95
Epoch 95/200 |loss: 7.431523| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 96
Epoch 96/200 |loss: 7.271326| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 97
Epoch 97/200 |loss: 7.285047| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 98
Epoch 98/200 |loss: 7.354760| train set 5.224x speedup, test set 0.812x speedup, val set 5.473x speedup, step: 99
Epoch 99/200 |loss: 7.420816| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 100
Epoch 100/200 |loss: 7.192213| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 1
Epoch 101/200 |loss: 7.566611| train set 5.224x speedup, test set 0.808x speedup, val set 5.473x speedup, step: 1
Epoch 102/200 |loss: 7.566885| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 103/200 |loss: 7.409319| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 2
Epoch 104/200 |loss: 7.448382| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 105/200 |loss: 7.347130| train set 5.224x speedup, test set 0.812x speedup, val set 5.473x speedup, step: 2
Epoch 106/200 |loss: 7.240837| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 3
Epoch 107/200 |loss: 7.370555| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 4
Epoch 108/200 |loss: 7.210864| train set 5.224x speedup, test set 0.812x speedup, val set 5.473x speedup, step: 5
Epoch 109/200 |loss: 7.291943| train set 5.209x speedup, test set 0.812x speedup, val set 5.386x speedup, step: 6
Epoch 110/200 |loss: 7.285344| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 111/200 |loss: 7.220335| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 2
Epoch 112/200 |loss: 7.287024| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 3
Epoch 113/200 |loss: 7.214132| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 114/200 |loss: 7.094292| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 115/200 |loss: 7.164515| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 116/200 |loss: 7.166283| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 117/200 |loss: 7.262208| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 118/200 |loss: 7.041391| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 119/200 |loss: 7.133403| train set 5.224x speedup, test set 0.812x speedup, val set 5.473x speedup, step: 2
Epoch 120/200 |loss: 7.246716| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 3
Epoch 121/200 |loss: 7.246775| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 122/200 |loss: 7.038575| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 123/200 |loss: 7.056531| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 2
Epoch 124/200 |loss: 7.146525| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 125/200 |loss: 7.268134| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 2
Epoch 126/200 |loss: 7.053981| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 127/200 |loss: 7.043930| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 128/200 |loss: 7.219640| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 129/200 |loss: 7.135410| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 130/200 |loss: 7.019955| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 2
Epoch 131/200 |loss: 7.024105| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 132/200 |loss: 7.121015| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 133/200 |loss: 7.165228| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 134/200 |loss: 6.985513| train set 5.243x speedup, test set 0.803x speedup, val set 5.473x speedup, step: 3
Epoch 135/200 |loss: 7.074899| train set 5.211x speedup, test set 0.802x speedup, val set 5.389x speedup, step: 4
Epoch 136/200 |loss: 7.217887| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 137/200 |loss: 7.053632| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 138/200 |loss: 7.052604| train set 5.249x speedup, test set 0.802x speedup, val set 5.487x speedup, step: 1
Epoch 139/200 |loss: 7.228232| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 2
Epoch 140/200 |loss: 7.072053| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 141/200 |loss: 6.975503| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 142/200 |loss: 6.993533| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 3
Epoch 143/200 |loss: 6.959692| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 144/200 |loss: 6.955186| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 145/200 |loss: 6.939247| train set 5.243x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 146/200 |loss: 6.994510| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 147/200 |loss: 6.974634| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 148/200 |loss: 6.958138| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 149/200 |loss: 6.897804| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 150/200 |loss: 6.893130| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 151/200 |loss: 6.888800| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 152/200 |loss: 6.909749| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 153/200 |loss: 6.908309| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 154/200 |loss: 6.914716| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 155/200 |loss: 6.898329| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 156/200 |loss: 6.905863| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 157/200 |loss: 6.887922| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 158/200 |loss: 6.885964| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 159/200 |loss: 6.889686| train set 5.213x speedup, test set 0.795x speedup, val set 5.373x speedup, step: 2
Epoch 160/200 |loss: 6.922785| train set 5.224x speedup, test set 0.795x speedup, val set 5.473x speedup, step: 3
Epoch 161/200 |loss: 7.092228| train set 5.213x speedup, test set 0.795x speedup, val set 5.373x speedup, step: 4
Epoch 162/200 |loss: 7.280007| train set 5.224x speedup, test set 0.805x speedup, val set 5.473x speedup, step: 5
Epoch 163/200 |loss: 8.189917| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 164/200 |loss: 7.592610| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 165/200 |loss: 8.843866| train set 5.224x speedup, test set 1.025x speedup, val set 5.473x speedup, step: 3
Epoch 166/200 |loss: 8.356756| train set 5.249x speedup, test set 0.791x speedup, val set 5.487x speedup, step: 1
Epoch 167/200 |loss: 8.371381| train set 5.210x speedup, test set 0.802x speedup, val set 5.387x speedup, step: 2
Epoch 168/200 |loss: 7.968664| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 3
Epoch 169/200 |loss: 7.898968| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 170/200 |loss: 7.804020| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 171/200 |loss: 7.660262| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 172/200 |loss: 7.525119| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 3
Epoch 173/200 |loss: 7.608580| train set 5.224x speedup, test set 0.807x speedup, val set 5.473x speedup, step: 4
Epoch 174/200 |loss: 7.339246| train set 5.224x speedup, test set 0.803x speedup, val set 5.473x speedup, step: 5
Epoch 175/200 |loss: 7.516092| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 6
Epoch 176/200 |loss: 7.250840| train set 5.186x speedup, test set 0.799x speedup, val set 5.375x speedup, step: 7
Epoch 177/200 |loss: 7.300186| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 8
Epoch 178/200 |loss: 7.223450| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 179/200 |loss: 7.229455| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 180/200 |loss: 7.139185| train set 5.249x speedup, test set 0.799x speedup, val set 5.487x speedup, step: 1
Epoch 181/200 |loss: 7.157988| train set 5.211x speedup, test set 0.799x speedup, val set 5.389x speedup, step: 2
Epoch 182/200 |loss: 7.067608| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 3
Epoch 183/200 |loss: 7.081549| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 184/200 |loss: 7.064102| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 185/200 |loss: 7.026139| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 186/200 |loss: 7.010139| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 187/200 |loss: 7.000225| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 188/200 |loss: 6.977577| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 3
Epoch 189/200 |loss: 6.974069| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 4
Epoch 190/200 |loss: 6.951617| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 191/200 |loss: 6.937175| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 192/200 |loss: 6.933260| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 193/200 |loss: 6.921690| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 194/200 |loss: 6.924589| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 195/200 |loss: 6.931802| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 196/200 |loss: 6.961687| train set 5.249x speedup, test set 0.791x speedup, val set 5.487x speedup, step: 1
Epoch 197/200 |loss: 7.085022| train set 5.213x speedup, test set 0.795x speedup, val set 5.373x speedup, step: 2
Epoch 198/200 |loss: 7.153286| train set 5.224x speedup, test set 0.791x speedup, val set 5.473x speedup, step: 3
Epoch 199/200 |loss: 7.482948| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 4
Training per epoch cost 0.262 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 51.645s, pg runtime 13.945s, speedup 0.270x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 8.556s, pg runtime 6.444s, speedup 0.753x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 56, train speedup 5.258, test speedup 1.046, val speedup 5.473
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 196, train speedup 5.249, test speedup 0.791, val speedup 5.487
last model at epoch 199, train speedup 5.211, test speedup 0.795, val speedup 5.389
execution cost 0:02:40.508220
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.913565, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146671| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705244| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.174879| train set 3.535x speedup, test set 1.093x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701832| train set 3.514x speedup, test set 0.890x speedup, val set 3.526x speedup, step: 6
Epoch 6/200 |loss: 21.222296| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.778355| train set 3.923x speedup, test set 0.862x speedup, val set 3.931x speedup, step: 8
Epoch 8/200 |loss: 20.327322| train set 4.246x speedup, test set 0.742x speedup, val set 4.414x speedup, step: 9
Epoch 9/200 |loss: 19.875662| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.373657| train set 3.785x speedup, test set 0.697x speedup, val set 3.895x speedup, step: 11
Epoch 11/200 |loss: 18.873281| train set 4.319x speedup, test set 0.688x speedup, val set 4.491x speedup, step: 12
Epoch 12/200 |loss: 18.301863| train set 4.092x speedup, test set 0.588x speedup, val set 4.196x speedup, step: 13
Epoch 13/200 |loss: 17.791424| train set 4.370x speedup, test set 0.671x speedup, val set 4.469x speedup, step: 14
Epoch 14/200 |loss: 17.326508| train set 4.370x speedup, test set 0.831x speedup, val set 4.469x speedup, step: 15
Epoch 15/200 |loss: 16.779516| train set 4.368x speedup, test set 0.821x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.275797| train set 4.368x speedup, test set 0.822x speedup, val set 4.468x speedup, step: 17
Epoch 17/200 |loss: 15.806418| train set 4.436x speedup, test set 0.819x speedup, val set 4.534x speedup, step: 18
Epoch 18/200 |loss: 15.354459| train set 4.370x speedup, test set 0.822x speedup, val set 4.469x speedup, step: 19
Epoch 19/200 |loss: 14.946918| train set 4.606x speedup, test set 0.819x speedup, val set 4.828x speedup, step: 20
Epoch 20/200 |loss: 14.603884| train set 4.824x speedup, test set 0.833x speedup, val set 4.969x speedup, step: 21
Epoch 21/200 |loss: 14.364360| train set 4.955x speedup, test set 0.807x speedup, val set 5.136x speedup, step: 22
Epoch 22/200 |loss: 14.115498| train set 4.754x speedup, test set 0.888x speedup, val set 5.000x speedup, step: 23
Epoch 23/200 |loss: 13.428472| train set 5.027x speedup, test set 0.883x speedup, val set 5.208x speedup, step: 24
Epoch 24/200 |loss: 13.301977| train set 5.228x speedup, test set 0.876x speedup, val set 5.461x speedup, step: 25
Epoch 25/200 |loss: 13.030176| train set 5.228x speedup, test set 0.882x speedup, val set 5.461x speedup, step: 26
Epoch 26/200 |loss: 12.525426| train set 5.228x speedup, test set 0.864x speedup, val set 5.461x speedup, step: 27
Epoch 27/200 |loss: 12.313636| train set 5.248x speedup, test set 0.876x speedup, val set 5.489x speedup, step: 28
Epoch 28/200 |loss: 11.940362| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 29
Epoch 29/200 |loss: 11.735078| train set 5.248x speedup, test set 0.876x speedup, val set 5.489x speedup, step: 30
Epoch 30/200 |loss: 11.368924| train set 5.248x speedup, test set 0.882x speedup, val set 5.489x speedup, step: 31
Epoch 31/200 |loss: 11.108545| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 32
Epoch 32/200 |loss: 10.846275| train set 5.248x speedup, test set 1.127x speedup, val set 5.489x speedup, step: 33
Epoch 33/200 |loss: 10.647376| train set 5.248x speedup, test set 0.864x speedup, val set 5.489x speedup, step: 34
Epoch 34/200 |loss: 10.913924| train set 5.223x speedup, test set 1.176x speedup, val set 5.476x speedup, step: 35
Epoch 35/200 |loss: 11.401757| train set 5.248x speedup, test set 0.851x speedup, val set 5.489x speedup, step: 36
Epoch 36/200 |loss: 10.808432| train set 5.248x speedup, test set 0.880x speedup, val set 5.489x speedup, step: 37
Epoch 37/200 |loss: 10.640655| train set 5.223x speedup, test set 1.113x speedup, val set 5.476x speedup, step: 38
Epoch 38/200 |loss: 10.399065| train set 5.248x speedup, test set 1.098x speedup, val set 5.489x speedup, step: 39
Epoch 39/200 |loss: 9.933158| train set 5.170x speedup, test set 0.869x speedup, val set 5.410x speedup, step: 40
Epoch 40/200 |loss: 9.965631| train set 5.248x speedup, test set 1.113x speedup, val set 5.489x speedup, step: 41
Epoch 41/200 |loss: 9.716270| train set 5.248x speedup, test set 1.113x speedup, val set 5.489x speedup, step: 42
Epoch 42/200 |loss: 9.701857| train set 5.248x speedup, test set 1.106x speedup, val set 5.489x speedup, step: 43
Epoch 43/200 |loss: 9.383793| train set 5.248x speedup, test set 1.121x speedup, val set 5.489x speedup, step: 44
Epoch 44/200 |loss: 9.691978| train set 5.222x speedup, test set 1.084x speedup, val set 5.473x speedup, step: 45
Epoch 45/200 |loss: 10.011238| train set 5.248x speedup, test set 0.869x speedup, val set 5.489x speedup, step: 46
Epoch 46/200 |loss: 9.657843| train set 5.248x speedup, test set 0.864x speedup, val set 5.489x speedup, step: 47
Epoch 47/200 |loss: 9.185007| train set 5.248x speedup, test set 1.101x speedup, val set 5.489x speedup, step: 48
Epoch 48/200 |loss: 9.346747| train set 5.248x speedup, test set 1.152x speedup, val set 5.489x speedup, step: 49
Epoch 49/200 |loss: 8.908863| train set 5.248x speedup, test set 0.832x speedup, val set 5.489x speedup, step: 50
Epoch 50/200 |loss: 8.973008| train set 5.040x speedup, test set 0.831x speedup, val set 5.327x speedup, step: 51
Epoch 51/200 |loss: 8.825282| train set 5.248x speedup, test set 1.046x speedup, val set 5.489x speedup, step: 52
Epoch 52/200 |loss: 8.645128| train set 5.248x speedup, test set 0.827x speedup, val set 5.489x speedup, step: 53
Epoch 53/200 |loss: 8.585089| train set 5.249x speedup, test set 0.854x speedup, val set 5.487x speedup, step: 54
Epoch 54/200 |loss: 8.510280| train set 5.249x speedup, test set 1.088x speedup, val set 5.487x speedup, step: 55
Epoch 55/200 |loss: 8.367322| train set 5.249x speedup, test set 1.088x speedup, val set 5.487x speedup, step: 56
Epoch 56/200 |loss: 8.257206| train set 5.249x speedup, test set 1.092x speedup, val set 5.487x speedup, step: 57
Epoch 57/200 |loss: 8.263582| train set 5.249x speedup, test set 1.047x speedup, val set 5.487x speedup, step: 58
Epoch 58/200 |loss: 8.186414| train set 5.249x speedup, test set 1.045x speedup, val set 5.487x speedup, step: 59
Epoch 59/200 |loss: 8.122209| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 60
Epoch 60/200 |loss: 7.996416| train set 5.249x speedup, test set 1.037x speedup, val set 5.487x speedup, step: 61
Epoch 61/200 |loss: 8.087548| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 62
Epoch 62/200 |loss: 8.570985| train set 5.224x speedup, test set 1.053x speedup, val set 5.473x speedup, step: 63
Epoch 63/200 |loss: 9.602098| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 64
Epoch 64/200 |loss: 8.369951| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 65
Epoch 65/200 |loss: 9.314984| train set 5.224x speedup, test set 1.096x speedup, val set 5.473x speedup, step: 66
Epoch 66/200 |loss: 8.596018| train set 5.249x speedup, test set 1.050x speedup, val set 5.487x speedup, step: 67
Epoch 67/200 |loss: 8.690471| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 68
Epoch 68/200 |loss: 8.233799| train set 5.211x speedup, test set 1.036x speedup, val set 5.389x speedup, step: 69
Epoch 69/200 |loss: 8.515224| train set 5.249x speedup, test set 1.037x speedup, val set 5.487x speedup, step: 70
Epoch 70/200 |loss: 7.966929| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 71
Epoch 71/200 |loss: 8.388126| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 72
Epoch 72/200 |loss: 7.867478| train set 5.211x speedup, test set 1.036x speedup, val set 5.389x speedup, step: 73
Epoch 73/200 |loss: 8.159352| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 74
Epoch 74/200 |loss: 7.744606| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 75
Epoch 75/200 |loss: 7.974352| train set 5.211x speedup, test set 0.811x speedup, val set 5.389x speedup, step: 76
Epoch 76/200 |loss: 7.727091| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 77
Epoch 77/200 |loss: 7.790763| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 78
Epoch 78/200 |loss: 7.615965| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 79
Epoch 79/200 |loss: 7.679137| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 80
Epoch 80/200 |loss: 7.600004| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 81
Epoch 81/200 |loss: 7.545829| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 82
Epoch 82/200 |loss: 7.517757| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 83
Epoch 83/200 |loss: 7.450871| train set 5.249x speedup, test set 0.817x speedup, val set 5.487x speedup, step: 84
Epoch 84/200 |loss: 7.453070| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 85
Epoch 85/200 |loss: 7.419370| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 86
Epoch 86/200 |loss: 7.454770| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 87
Epoch 87/200 |loss: 7.487161| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 88
Epoch 88/200 |loss: 7.931190| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 89
Epoch 89/200 |loss: 7.775885| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 90
Epoch 90/200 |loss: 7.769118| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 91
Epoch 91/200 |loss: 7.309984| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 92
Epoch 92/200 |loss: 7.612402| train set 5.224x speedup, test set 1.040x speedup, val set 5.473x speedup, step: 93
Epoch 93/200 |loss: 7.699023| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 94
Epoch 94/200 |loss: 7.316149| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 95
Epoch 95/200 |loss: 7.489394| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 96
Epoch 96/200 |loss: 7.731888| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 97
Epoch 97/200 |loss: 7.214542| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 98
Epoch 98/200 |loss: 7.647953| train set 5.224x speedup, test set 1.039x speedup, val set 5.473x speedup, step: 99
Epoch 99/200 |loss: 7.898410| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 100
Epoch 100/200 |loss: 7.385829| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 1
Epoch 101/200 |loss: 7.942991| train set 5.224x speedup, test set 1.040x speedup, val set 5.473x speedup, step: 1
Epoch 102/200 |loss: 7.487676| train set 5.224x speedup, test set 1.040x speedup, val set 5.473x speedup, step: 1
Epoch 103/200 |loss: 7.584338| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 2
Epoch 104/200 |loss: 7.502223| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 105/200 |loss: 7.353412| train set 5.224x speedup, test set 1.040x speedup, val set 5.473x speedup, step: 1
Epoch 106/200 |loss: 7.457419| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 107/200 |loss: 7.285512| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 108/200 |loss: 7.368326| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 109/200 |loss: 7.199121| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 4
Epoch 110/200 |loss: 7.252491| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 111/200 |loss: 7.184169| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 112/200 |loss: 7.223383| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 3
Epoch 113/200 |loss: 7.174840| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 114/200 |loss: 7.216786| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 115/200 |loss: 7.096497| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 116/200 |loss: 7.179215| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Epoch 117/200 |loss: 7.129992| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 118/200 |loss: 7.112088| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 119/200 |loss: 7.231255| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 120/200 |loss: 7.051817| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 121/200 |loss: 7.095614| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 122/200 |loss: 7.057373| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 123/200 |loss: 7.095829| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 124/200 |loss: 7.063388| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 125/200 |loss: 7.008916| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 126/200 |loss: 7.025123| train set 5.211x speedup, test set 0.804x speedup, val set 5.389x speedup, step: 2
Epoch 127/200 |loss: 7.008302| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 128/200 |loss: 7.035267| train set 5.211x speedup, test set 0.810x speedup, val set 5.389x speedup, step: 2
Epoch 129/200 |loss: 7.043900| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 130/200 |loss: 7.029057| train set 5.211x speedup, test set 0.796x speedup, val set 5.389x speedup, step: 2
Epoch 131/200 |loss: 7.054892| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 3
Epoch 132/200 |loss: 7.245911| train set 5.213x speedup, test set 0.828x speedup, val set 5.373x speedup, step: 4
Epoch 133/200 |loss: 7.233243| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 134/200 |loss: 7.478239| train set 5.211x speedup, test set 0.804x speedup, val set 5.389x speedup, step: 2
Epoch 135/200 |loss: 7.018733| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 3
Epoch 136/200 |loss: 7.326399| train set 5.224x speedup, test set 1.026x speedup, val set 5.473x speedup, step: 4
Epoch 137/200 |loss: 7.669686| train set 5.249x speedup, test set 0.799x speedup, val set 5.487x speedup, step: 1
Epoch 138/200 |loss: 7.204467| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 2
Epoch 139/200 |loss: 7.680781| train set 5.224x speedup, test set 1.026x speedup, val set 5.473x speedup, step: 3
Epoch 140/200 |loss: 7.503891| train set 5.249x speedup, test set 0.799x speedup, val set 5.487x speedup, step: 1
Epoch 141/200 |loss: 7.345082| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 142/200 |loss: 7.515277| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 143/200 |loss: 7.429990| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 4
Epoch 144/200 |loss: 7.385032| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 145/200 |loss: 7.315620| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 146/200 |loss: 7.388754| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 3
Epoch 147/200 |loss: 7.282391| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 148/200 |loss: 7.199284| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 149/200 |loss: 7.202805| train set 5.249x speedup, test set 0.799x speedup, val set 5.487x speedup, step: 1
Epoch 150/200 |loss: 7.173479| train set 5.186x speedup, test set 0.814x speedup, val set 5.375x speedup, step: 2
Epoch 151/200 |loss: 7.166940| train set 5.211x speedup, test set 0.804x speedup, val set 5.389x speedup, step: 3
Epoch 152/200 |loss: 7.105437| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 4
Epoch 153/200 |loss: 7.102913| train set 5.249x speedup, test set 0.799x speedup, val set 5.487x speedup, step: 1
Epoch 154/200 |loss: 7.064973| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 2
Epoch 155/200 |loss: 7.035070| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 3
Epoch 156/200 |loss: 7.060920| train set 5.249x speedup, test set 0.804x speedup, val set 5.487x speedup, step: 1
Epoch 157/200 |loss: 7.007480| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 158/200 |loss: 6.993685| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 159/200 |loss: 6.984809| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 3
Epoch 160/200 |loss: 6.954219| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 161/200 |loss: 6.960510| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 162/200 |loss: 6.941686| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 3
Epoch 163/200 |loss: 6.937456| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 164/200 |loss: 6.910748| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 165/200 |loss: 6.918489| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 166/200 |loss: 6.903785| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 167/200 |loss: 6.898524| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 168/200 |loss: 6.881141| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 169/200 |loss: 6.884905| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 170/200 |loss: 6.869737| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 2
Epoch 171/200 |loss: 6.877728| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 3
Epoch 172/200 |loss: 6.864428| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 173/200 |loss: 6.890419| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 174/200 |loss: 6.935106| train set 5.211x speedup, test set 0.795x speedup, val set 5.389x speedup, step: 2
Epoch 175/200 |loss: 7.103677| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 1
Epoch 176/200 |loss: 7.178507| train set 5.211x speedup, test set 0.796x speedup, val set 5.389x speedup, step: 2
Epoch 177/200 |loss: 7.394824| train set 5.258x speedup, test set 0.795x speedup, val set 5.473x speedup, step: 3
Epoch 178/200 |loss: 6.993894| train set 5.214x speedup, test set 0.795x speedup, val set 5.383x speedup, step: 4
Epoch 179/200 |loss: 6.952339| train set 5.249x speedup, test set 0.796x speedup, val set 5.487x speedup, step: 1
Epoch 180/200 |loss: 7.353600| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 1
Epoch 181/200 |loss: 7.143605| train set 5.249x speedup, test set 0.796x speedup, val set 5.487x speedup, step: 1
Epoch 182/200 |loss: 6.884491| train set 5.249x speedup, test set 0.794x speedup, val set 5.487x speedup, step: 1
Epoch 183/200 |loss: 7.130335| train set 5.220x speedup, test set 0.796x speedup, val set 5.375x speedup, step: 2
Epoch 184/200 |loss: 7.026556| train set 5.249x speedup, test set 0.796x speedup, val set 5.487x speedup, step: 1
Epoch 185/200 |loss: 6.934398| train set 5.211x speedup, test set 0.794x speedup, val set 5.389x speedup, step: 2
Epoch 186/200 |loss: 6.975955| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 187/200 |loss: 6.986394| train set 5.249x speedup, test set 0.794x speedup, val set 5.487x speedup, step: 1
Epoch 188/200 |loss: 6.937882| train set 5.211x speedup, test set 0.794x speedup, val set 5.389x speedup, step: 2
Epoch 189/200 |loss: 6.898033| train set 5.249x speedup, test set 0.794x speedup, val set 5.487x speedup, step: 1
Epoch 190/200 |loss: 7.009113| train set 5.249x speedup, test set 0.794x speedup, val set 5.487x speedup, step: 1
Epoch 191/200 |loss: 6.897376| train set 5.211x speedup, test set 0.794x speedup, val set 5.389x speedup, step: 2
Epoch 192/200 |loss: 6.887229| train set 5.249x speedup, test set 0.794x speedup, val set 5.487x speedup, step: 1
Epoch 193/200 |loss: 6.921079| train set 5.249x speedup, test set 0.794x speedup, val set 5.487x speedup, step: 1
Epoch 194/200 |loss: 6.939783| train set 5.249x speedup, test set 0.809x speedup, val set 5.487x speedup, step: 1
Epoch 195/200 |loss: 6.834800| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 1
Epoch 196/200 |loss: 6.886024| train set 5.211x speedup, test set 0.794x speedup, val set 5.389x speedup, step: 2
Epoch 197/200 |loss: 6.892819| train set 5.249x speedup, test set 0.809x speedup, val set 5.487x speedup, step: 1
Epoch 198/200 |loss: 6.844748| train set 5.211x speedup, test set 0.809x speedup, val set 5.389x speedup, step: 2
Epoch 199/200 |loss: 6.822285| train set 5.211x speedup, test set 0.794x speedup, val set 5.389x speedup, step: 3
Training per epoch cost 0.261 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 51.645s, pg runtime 13.945s, speedup 0.270x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.715s, pg runtime 0.354s, speedup 0.495x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 177, train speedup 5.258, test speedup 0.795, val speedup 5.473
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 197, train speedup 5.249, test speedup 0.809, val speedup 5.487
last model at epoch 199, train speedup 5.211, test speedup 0.794, val speedup 5.389
execution cost 0:02:40.189404
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.895532, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146671| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705244| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.174879| train set 3.535x speedup, test set 1.093x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701838| train set 3.514x speedup, test set 0.890x speedup, val set 3.526x speedup, step: 6
Epoch 6/200 |loss: 21.222298| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.778355| train set 3.923x speedup, test set 0.862x speedup, val set 3.931x speedup, step: 8
Epoch 8/200 |loss: 20.327290| train set 4.246x speedup, test set 0.742x speedup, val set 4.414x speedup, step: 9
Epoch 9/200 |loss: 19.874861| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.379852| train set 3.785x speedup, test set 0.685x speedup, val set 3.895x speedup, step: 11
Epoch 11/200 |loss: 18.881346| train set 4.276x speedup, test set 0.679x speedup, val set 4.392x speedup, step: 12
Epoch 12/200 |loss: 18.310993| train set 4.023x speedup, test set 0.588x speedup, val set 4.125x speedup, step: 13
Epoch 13/200 |loss: 17.806952| train set 4.071x speedup, test set 0.702x speedup, val set 4.125x speedup, step: 14
Epoch 14/200 |loss: 17.331211| train set 4.370x speedup, test set 0.830x speedup, val set 4.469x speedup, step: 15
Epoch 15/200 |loss: 16.823078| train set 4.368x speedup, test set 0.821x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.375362| train set 4.368x speedup, test set 0.820x speedup, val set 4.468x speedup, step: 17
Epoch 17/200 |loss: 15.876523| train set 4.436x speedup, test set 0.827x speedup, val set 4.536x speedup, step: 18
Epoch 18/200 |loss: 15.407819| train set 4.436x speedup, test set 0.856x speedup, val set 4.536x speedup, step: 19
Epoch 19/200 |loss: 14.965520| train set 4.606x speedup, test set 0.854x speedup, val set 4.828x speedup, step: 20
Epoch 20/200 |loss: 14.536239| train set 4.586x speedup, test set 0.785x speedup, val set 4.775x speedup, step: 21
Epoch 21/200 |loss: 14.105832| train set 4.799x speedup, test set 0.855x speedup, val set 5.008x speedup, step: 22
Epoch 22/200 |loss: 13.708462| train set 4.836x speedup, test set 0.779x speedup, val set 5.062x speedup, step: 23
Epoch 23/200 |loss: 13.379942| train set 4.791x speedup, test set 0.888x speedup, val set 5.053x speedup, step: 24
Epoch 24/200 |loss: 13.384050| train set 5.228x speedup, test set 0.793x speedup, val set 5.461x speedup, step: 25
Epoch 25/200 |loss: 13.559281| train set 5.228x speedup, test set 0.858x speedup, val set 5.461x speedup, step: 26
Epoch 26/200 |loss: 12.956373| train set 5.223x speedup, test set 1.318x speedup, val set 5.476x speedup, step: 27
Epoch 27/200 |loss: 12.807579| train set 5.228x speedup, test set 0.829x speedup, val set 5.461x speedup, step: 28
Epoch 28/200 |loss: 12.144399| train set 5.150x speedup, test set 0.789x speedup, val set 5.383x speedup, step: 29
Epoch 29/200 |loss: 12.290919| train set 5.203x speedup, test set 1.142x speedup, val set 5.448x speedup, step: 30
Epoch 30/200 |loss: 11.608419| train set 5.223x speedup, test set 1.186x speedup, val set 5.476x speedup, step: 31
Epoch 31/200 |loss: 11.700238| train set 5.248x speedup, test set 0.852x speedup, val set 5.489x speedup, step: 32
Epoch 32/200 |loss: 11.060974| train set 5.191x speedup, test set 0.843x speedup, val set 5.410x speedup, step: 33
Epoch 33/200 |loss: 11.085317| train set 5.248x speedup, test set 1.119x speedup, val set 5.489x speedup, step: 34
Epoch 34/200 |loss: 10.760263| train set 5.248x speedup, test set 1.180x speedup, val set 5.489x speedup, step: 35
Epoch 35/200 |loss: 10.688220| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 36
Epoch 36/200 |loss: 10.458316| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 37
Epoch 37/200 |loss: 10.384380| train set 5.248x speedup, test set 1.137x speedup, val set 5.489x speedup, step: 38
Epoch 38/200 |loss: 10.114611| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 39
Epoch 39/200 |loss: 9.706995| train set 5.248x speedup, test set 0.840x speedup, val set 5.489x speedup, step: 40
Epoch 40/200 |loss: 9.758780| train set 5.248x speedup, test set 1.068x speedup, val set 5.489x speedup, step: 41
Epoch 41/200 |loss: 9.622765| train set 5.223x speedup, test set 1.067x speedup, val set 5.476x speedup, step: 42
Epoch 42/200 |loss: 9.395881| train set 5.248x speedup, test set 0.840x speedup, val set 5.489x speedup, step: 43
Epoch 43/200 |loss: 9.304922| train set 5.248x speedup, test set 0.869x speedup, val set 5.489x speedup, step: 44
Epoch 44/200 |loss: 9.162411| train set 5.248x speedup, test set 1.096x speedup, val set 5.489x speedup, step: 45
Epoch 45/200 |loss: 8.996308| train set 5.248x speedup, test set 0.869x speedup, val set 5.489x speedup, step: 46
Epoch 46/200 |loss: 8.966915| train set 5.248x speedup, test set 0.831x speedup, val set 5.489x speedup, step: 47
Epoch 47/200 |loss: 9.274869| train set 5.248x speedup, test set 0.868x speedup, val set 5.489x speedup, step: 48
Epoch 48/200 |loss: 9.542059| train set 5.248x speedup, test set 0.831x speedup, val set 5.489x speedup, step: 49
Epoch 49/200 |loss: 8.905051| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 50
Epoch 50/200 |loss: 8.915056| train set 5.249x speedup, test set 0.869x speedup, val set 5.487x speedup, step: 51
Epoch 51/200 |loss: 8.819703| train set 5.249x speedup, test set 1.045x speedup, val set 5.487x speedup, step: 52
Epoch 52/200 |loss: 8.626744| train set 5.249x speedup, test set 1.054x speedup, val set 5.487x speedup, step: 53
Epoch 53/200 |loss: 8.618934| train set 5.249x speedup, test set 0.831x speedup, val set 5.487x speedup, step: 54
Epoch 54/200 |loss: 8.467725| train set 5.249x speedup, test set 1.054x speedup, val set 5.487x speedup, step: 55
Epoch 55/200 |loss: 8.339832| train set 5.211x speedup, test set 0.832x speedup, val set 5.389x speedup, step: 56
Epoch 56/200 |loss: 8.206230| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 57
Epoch 57/200 |loss: 8.157851| train set 5.249x speedup, test set 1.046x speedup, val set 5.487x speedup, step: 58
Epoch 58/200 |loss: 8.230068| train set 5.249x speedup, test set 0.832x speedup, val set 5.487x speedup, step: 59
Epoch 59/200 |loss: 8.232195| train set 5.224x speedup, test set 1.060x speedup, val set 5.473x speedup, step: 60
Epoch 60/200 |loss: 8.802073| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 61
Epoch 61/200 |loss: 8.126729| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 62
Epoch 62/200 |loss: 8.563362| train set 5.224x speedup, test set 1.039x speedup, val set 5.473x speedup, step: 63
Epoch 63/200 |loss: 8.424818| train set 5.249x speedup, test set 1.039x speedup, val set 5.487x speedup, step: 64
Epoch 64/200 |loss: 8.260636| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 65
Epoch 65/200 |loss: 8.488539| train set 5.249x speedup, test set 1.080x speedup, val set 5.487x speedup, step: 66
Epoch 66/200 |loss: 8.092699| train set 5.249x speedup, test set 1.081x speedup, val set 5.487x speedup, step: 67
Epoch 67/200 |loss: 8.123525| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 68
Epoch 68/200 |loss: 7.957953| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 69
Epoch 69/200 |loss: 7.883343| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 70
Epoch 70/200 |loss: 8.014942| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 71
Epoch 71/200 |loss: 7.740990| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 72
Epoch 72/200 |loss: 7.943181| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 73
Epoch 73/200 |loss: 7.717604| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 74
Epoch 74/200 |loss: 7.797935| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 75
Epoch 75/200 |loss: 7.777605| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 76
Epoch 76/200 |loss: 7.750964| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 77
Epoch 77/200 |loss: 7.730951| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 78
Epoch 78/200 |loss: 7.614629| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 79
Epoch 79/200 |loss: 7.532600| train set 5.186x speedup, test set 0.823x speedup, val set 5.375x speedup, step: 80
Epoch 80/200 |loss: 7.538278| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 81
Epoch 81/200 |loss: 7.412109| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 82
Epoch 82/200 |loss: 7.632903| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 83
Epoch 83/200 |loss: 7.573294| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 84
Epoch 84/200 |loss: 7.520726| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 85
Epoch 85/200 |loss: 7.704068| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 86
Epoch 86/200 |loss: 7.787038| train set 5.209x speedup, test set 0.823x speedup, val set 5.386x speedup, step: 87
Epoch 87/200 |loss: 7.578270| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 88
Epoch 88/200 |loss: 7.607402| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 89
Epoch 89/200 |loss: 7.360540| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 90
Epoch 90/200 |loss: 7.456628| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 91
Epoch 91/200 |loss: 7.489603| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 92
Epoch 92/200 |loss: 7.346567| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 93
Epoch 93/200 |loss: 7.309380| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 94
Epoch 94/200 |loss: 7.271586| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 95
Epoch 95/200 |loss: 7.307432| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 96
Epoch 96/200 |loss: 7.658745| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 97
Epoch 97/200 |loss: 7.214284| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 98
Epoch 98/200 |loss: 7.265960| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 99
Epoch 99/200 |loss: 7.322599| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 100
Epoch 100/200 |loss: 7.326093| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 1
Epoch 101/200 |loss: 7.300107| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 102/200 |loss: 7.125115| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 103/200 |loss: 7.245916| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 104/200 |loss: 7.404242| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 105/200 |loss: 7.764705| train set 5.213x speedup, test set 0.826x speedup, val set 5.373x speedup, step: 2
Epoch 106/200 |loss: 7.688035| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 3
Epoch 107/200 |loss: 8.198771| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 108/200 |loss: 7.573518| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 109/200 |loss: 8.178922| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 110/200 |loss: 7.493125| train set 5.222x speedup, test set 1.037x speedup, val set 5.470x speedup, step: 2
Epoch 111/200 |loss: 7.720510| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 112/200 |loss: 7.338496| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 113/200 |loss: 7.592565| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 114/200 |loss: 7.396245| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 115/200 |loss: 7.403565| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 116/200 |loss: 7.410927| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 3
Epoch 117/200 |loss: 7.432570| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 4
Epoch 118/200 |loss: 7.275212| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 119/200 |loss: 7.386061| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 120/200 |loss: 7.283930| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 3
Epoch 121/200 |loss: 7.247381| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 122/200 |loss: 7.196974| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 123/200 |loss: 7.232270| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 3
Epoch 124/200 |loss: 7.153673| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 125/200 |loss: 7.102066| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 126/200 |loss: 7.169045| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 3
Epoch 127/200 |loss: 7.113817| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 4
Epoch 128/200 |loss: 7.054527| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 5
Epoch 129/200 |loss: 7.086569| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 130/200 |loss: 7.053320| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 131/200 |loss: 7.042702| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 3
Epoch 132/200 |loss: 6.996692| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 133/200 |loss: 7.039458| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 134/200 |loss: 7.013390| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 135/200 |loss: 6.985583| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 136/200 |loss: 6.973403| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 137/200 |loss: 6.951440| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 138/200 |loss: 6.978973| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 139/200 |loss: 6.944019| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 140/200 |loss: 6.954739| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 141/200 |loss: 6.945683| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 142/200 |loss: 7.011350| train set 5.213x speedup, test set 0.821x speedup, val set 5.373x speedup, step: 2
Epoch 143/200 |loss: 7.112165| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 3
Epoch 144/200 |loss: 7.398073| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 4
Epoch 145/200 |loss: 7.073168| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 146/200 |loss: 6.965198| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 2
Epoch 147/200 |loss: 7.104676| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 3
Epoch 148/200 |loss: 7.034307| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 149/200 |loss: 6.971059| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 150/200 |loss: 6.956935| train set 5.213x speedup, test set 0.821x speedup, val set 5.373x speedup, step: 2
Epoch 151/200 |loss: 6.986033| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 152/200 |loss: 7.003922| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 153/200 |loss: 6.941456| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 3
Epoch 154/200 |loss: 6.934661| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 155/200 |loss: 7.020779| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 156/200 |loss: 6.995831| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 157/200 |loss: 6.970689| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 158/200 |loss: 6.973475| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 159/200 |loss: 7.005327| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 160/200 |loss: 7.027943| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 161/200 |loss: 6.918202| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 3
Epoch 162/200 |loss: 6.906828| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 163/200 |loss: 6.909726| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 164/200 |loss: 6.883198| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 165/200 |loss: 6.876184| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 166/200 |loss: 6.864778| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 167/200 |loss: 6.905532| train set 5.254x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 3
Epoch 168/200 |loss: 6.992433| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 4
Epoch 169/200 |loss: 7.172556| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 170/200 |loss: 7.135470| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 171/200 |loss: 7.158951| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 2
Epoch 172/200 |loss: 6.920992| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 173/200 |loss: 6.880347| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 174/200 |loss: 6.945889| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 3
Epoch 175/200 |loss: 6.966608| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 176/200 |loss: 7.047278| train set 5.213x speedup, test set 0.822x speedup, val set 5.373x speedup, step: 2
Epoch 177/200 |loss: 6.957648| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 178/200 |loss: 6.940447| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 179/200 |loss: 6.907050| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 3
Epoch 180/200 |loss: 6.983334| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 181/200 |loss: 7.152809| train set 5.213x speedup, test set 0.822x speedup, val set 5.373x speedup, step: 2
Epoch 182/200 |loss: 6.902272| train set 5.172x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 3
Epoch 183/200 |loss: 6.932884| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 184/200 |loss: 7.119680| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 185/200 |loss: 6.946196| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 186/200 |loss: 6.888074| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 187/200 |loss: 6.899365| train set 5.213x speedup, test set 0.823x speedup, val set 5.373x speedup, step: 2
Epoch 188/200 |loss: 6.965597| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 189/200 |loss: 6.913579| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 190/200 |loss: 6.868166| train set 5.213x speedup, test set 0.823x speedup, val set 5.373x speedup, step: 2
Epoch 191/200 |loss: 6.877687| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 192/200 |loss: 6.865296| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 2
Epoch 193/200 |loss: 6.912529| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 194/200 |loss: 6.993705| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 195/200 |loss: 6.898612| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 2
Epoch 196/200 |loss: 6.910403| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 197/200 |loss: 6.894330| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 4
Epoch 198/200 |loss: 6.929337| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 199/200 |loss: 6.992392| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Training per epoch cost 0.252 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.271s, pg runtime 2.718s, speedup 1.197x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.715s, pg runtime 0.354s, speedup 0.495x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 167, train speedup 5.254, test speedup 0.821, val speedup 5.473
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 199, train speedup 5.249, test speedup 0.823, val speedup 5.487
last model at epoch 199, train speedup 5.249, test speedup 0.823, val speedup 5.487
execution cost 0:02:36.254582
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.944948, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146671| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705244| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.174875| train set 3.535x speedup, test set 1.093x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701824| train set 3.514x speedup, test set 0.890x speedup, val set 3.526x speedup, step: 6
Epoch 6/200 |loss: 21.222294| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.778355| train set 3.923x speedup, test set 0.862x speedup, val set 3.931x speedup, step: 8
Epoch 8/200 |loss: 20.327322| train set 4.246x speedup, test set 0.742x speedup, val set 4.414x speedup, step: 9
Epoch 9/200 |loss: 19.875719| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.373444| train set 3.819x speedup, test set 0.697x speedup, val set 3.942x speedup, step: 11
Epoch 11/200 |loss: 18.868801| train set 4.319x speedup, test set 0.691x speedup, val set 4.491x speedup, step: 12
Epoch 12/200 |loss: 18.295362| train set 4.092x speedup, test set 0.601x speedup, val set 4.163x speedup, step: 13
Epoch 13/200 |loss: 17.786522| train set 4.370x speedup, test set 0.831x speedup, val set 4.469x speedup, step: 14
Epoch 14/200 |loss: 17.317532| train set 4.370x speedup, test set 0.831x speedup, val set 4.469x speedup, step: 15
Epoch 15/200 |loss: 16.772764| train set 4.368x speedup, test set 0.830x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.258099| train set 4.368x speedup, test set 0.826x speedup, val set 4.468x speedup, step: 17
Epoch 17/200 |loss: 15.791944| train set 4.436x speedup, test set 0.837x speedup, val set 4.536x speedup, step: 18
Epoch 18/200 |loss: 15.349196| train set 4.380x speedup, test set 0.834x speedup, val set 4.482x speedup, step: 19
Epoch 19/200 |loss: 14.943321| train set 4.586x speedup, test set 0.834x speedup, val set 4.775x speedup, step: 20
Epoch 20/200 |loss: 14.593686| train set 4.757x speedup, test set 0.791x speedup, val set 4.904x speedup, step: 21
Epoch 21/200 |loss: 14.196556| train set 4.915x speedup, test set 0.796x speedup, val set 5.082x speedup, step: 22
Epoch 22/200 |loss: 13.747123| train set 4.987x speedup, test set 0.844x speedup, val set 5.151x speedup, step: 23
Epoch 23/200 |loss: 13.398095| train set 5.228x speedup, test set 0.800x speedup, val set 5.461x speedup, step: 24
Epoch 24/200 |loss: 13.049581| train set 5.248x speedup, test set 0.844x speedup, val set 5.489x speedup, step: 25
Epoch 25/200 |loss: 12.673410| train set 5.228x speedup, test set 0.834x speedup, val set 5.461x speedup, step: 26
Epoch 26/200 |loss: 12.428435| train set 5.223x speedup, test set 0.850x speedup, val set 5.476x speedup, step: 27
Epoch 27/200 |loss: 12.261828| train set 5.040x speedup, test set 0.829x speedup, val set 5.327x speedup, step: 28
Epoch 28/200 |loss: 12.579735| train set 5.248x speedup, test set 0.882x speedup, val set 5.474x speedup, step: 29
Epoch 29/200 |loss: 12.282264| train set 5.248x speedup, test set 0.876x speedup, val set 5.489x speedup, step: 30
Epoch 30/200 |loss: 11.683158| train set 5.248x speedup, test set 0.879x speedup, val set 5.489x speedup, step: 31
Epoch 31/200 |loss: 11.502095| train set 5.248x speedup, test set 0.871x speedup, val set 5.489x speedup, step: 32
Epoch 32/200 |loss: 11.243612| train set 5.248x speedup, test set 0.844x speedup, val set 5.489x speedup, step: 33
Epoch 33/200 |loss: 10.821997| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 34
Epoch 34/200 |loss: 10.707744| train set 5.248x speedup, test set 1.074x speedup, val set 5.489x speedup, step: 35
Epoch 35/200 |loss: 10.532620| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 36
Epoch 36/200 |loss: 10.249232| train set 5.248x speedup, test set 0.844x speedup, val set 5.489x speedup, step: 37
Epoch 37/200 |loss: 10.055328| train set 5.248x speedup, test set 0.844x speedup, val set 5.489x speedup, step: 38
Epoch 38/200 |loss: 9.991040| train set 5.223x speedup, test set 1.066x speedup, val set 5.476x speedup, step: 39
Epoch 39/200 |loss: 9.722178| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 40
Epoch 40/200 |loss: 9.449424| train set 5.248x speedup, test set 1.074x speedup, val set 5.489x speedup, step: 41
Epoch 41/200 |loss: 9.280022| train set 5.248x speedup, test set 0.836x speedup, val set 5.489x speedup, step: 42
Epoch 42/200 |loss: 9.233532| train set 5.248x speedup, test set 1.059x speedup, val set 5.489x speedup, step: 43
Epoch 43/200 |loss: 9.525624| train set 5.210x speedup, test set 0.828x speedup, val set 5.391x speedup, step: 44
Epoch 44/200 |loss: 9.823571| train set 5.223x speedup, test set 1.052x speedup, val set 5.476x speedup, step: 45
Epoch 45/200 |loss: 9.625903| train set 5.248x speedup, test set 0.840x speedup, val set 5.489x speedup, step: 46
Epoch 46/200 |loss: 9.456916| train set 5.210x speedup, test set 0.827x speedup, val set 5.391x speedup, step: 47
Epoch 47/200 |loss: 9.899179| train set 5.248x speedup, test set 1.082x speedup, val set 5.489x speedup, step: 48
Epoch 48/200 |loss: 8.879794| train set 5.248x speedup, test set 0.863x speedup, val set 5.489x speedup, step: 49
Epoch 49/200 |loss: 9.792370| train set 5.248x speedup, test set 1.091x speedup, val set 5.489x speedup, step: 50
Epoch 50/200 |loss: 8.656728| train set 5.210x speedup, test set 1.090x speedup, val set 5.391x speedup, step: 51
Epoch 51/200 |loss: 9.154489| train set 5.249x speedup, test set 0.854x speedup, val set 5.487x speedup, step: 52
Epoch 52/200 |loss: 8.400934| train set 5.249x speedup, test set 0.820x speedup, val set 5.487x speedup, step: 53
Epoch 53/200 |loss: 8.826454| train set 5.249x speedup, test set 1.046x speedup, val set 5.487x speedup, step: 54
Epoch 54/200 |loss: 8.352179| train set 5.248x speedup, test set 1.045x speedup, val set 5.489x speedup, step: 55
Epoch 55/200 |loss: 8.522520| train set 5.248x speedup, test set 1.091x speedup, val set 5.489x speedup, step: 56
Epoch 56/200 |loss: 8.213710| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 57
Epoch 57/200 |loss: 8.267950| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 58
Epoch 58/200 |loss: 8.103510| train set 5.249x speedup, test set 1.046x speedup, val set 5.487x speedup, step: 59
Epoch 59/200 |loss: 8.107701| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 60
Epoch 60/200 |loss: 8.017959| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 61
Epoch 61/200 |loss: 7.985790| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 62
Epoch 62/200 |loss: 7.896284| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 63
Epoch 63/200 |loss: 7.854841| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 64
Epoch 64/200 |loss: 7.815964| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 65
Epoch 65/200 |loss: 7.872123| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 66
Epoch 66/200 |loss: 7.919890| train set 5.249x speedup, test set 1.047x speedup, val set 5.487x speedup, step: 67
Epoch 67/200 |loss: 8.147667| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 68
Epoch 68/200 |loss: 8.241150| train set 5.224x speedup, test set 1.051x speedup, val set 5.473x speedup, step: 69
Epoch 69/200 |loss: 9.020612| train set 5.249x speedup, test set 0.830x speedup, val set 5.487x speedup, step: 70
Epoch 70/200 |loss: 8.575416| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 71
Epoch 71/200 |loss: 8.574228| train set 5.249x speedup, test set 1.038x speedup, val set 5.487x speedup, step: 72
Epoch 72/200 |loss: 8.521577| train set 5.249x speedup, test set 1.038x speedup, val set 5.487x speedup, step: 73
Epoch 73/200 |loss: 7.910213| train set 5.211x speedup, test set 0.811x speedup, val set 5.389x speedup, step: 74
Epoch 74/200 |loss: 8.346404| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 75
Epoch 75/200 |loss: 7.953632| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 76
Epoch 76/200 |loss: 8.032041| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 77
Epoch 77/200 |loss: 8.110118| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 78
Epoch 78/200 |loss: 7.680959| train set 5.249x speedup, test set 1.038x speedup, val set 5.487x speedup, step: 79
Epoch 79/200 |loss: 7.979368| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 80
Epoch 80/200 |loss: 7.619490| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 81
Epoch 81/200 |loss: 7.714847| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 82
Epoch 82/200 |loss: 7.752597| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 83
Epoch 83/200 |loss: 7.512734| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 84
Epoch 84/200 |loss: 7.619349| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 85
Epoch 85/200 |loss: 7.494228| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 86
Epoch 86/200 |loss: 7.474401| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 87
Epoch 87/200 |loss: 7.468274| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 88
Epoch 88/200 |loss: 7.360974| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 89
Epoch 89/200 |loss: 7.377792| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 90
Epoch 90/200 |loss: 7.317072| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 91
Epoch 91/200 |loss: 7.294624| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 92
Epoch 92/200 |loss: 7.239484| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 93
Epoch 93/200 |loss: 7.261405| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 94
Epoch 94/200 |loss: 7.218354| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 95
Epoch 95/200 |loss: 7.328523| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 96
Epoch 96/200 |loss: 7.900932| train set 5.213x speedup, test set 0.829x speedup, val set 5.373x speedup, step: 97
Epoch 97/200 |loss: 8.034810| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 98
Epoch 98/200 |loss: 8.138403| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 99
Epoch 99/200 |loss: 7.574926| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 100
Epoch 100/200 |loss: 8.123701| train set 5.249x speedup, test set 1.037x speedup, val set 5.487x speedup, step: 1
Epoch 101/200 |loss: 7.550163| train set 5.249x speedup, test set 0.808x speedup, val set 5.487x speedup, step: 1
Epoch 102/200 |loss: 7.748453| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 2
Epoch 103/200 |loss: 7.536522| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 104/200 |loss: 7.440335| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 4
Epoch 105/200 |loss: 7.483956| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 106/200 |loss: 7.334013| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 2
Epoch 107/200 |loss: 7.410128| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 3
Epoch 108/200 |loss: 7.356757| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 109/200 |loss: 7.257485| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 110/200 |loss: 7.318094| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 3
Epoch 111/200 |loss: 7.313685| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 4
Epoch 112/200 |loss: 7.217896| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 5
Epoch 113/200 |loss: 7.265173| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 114/200 |loss: 7.184992| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 115/200 |loss: 7.198729| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 116/200 |loss: 7.287347| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 117/200 |loss: 7.222579| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 118/200 |loss: 7.091514| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 119/200 |loss: 7.201074| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 120/200 |loss: 7.266042| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 121/200 |loss: 7.059276| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 122/200 |loss: 7.200743| train set 5.224x speedup, test set 0.829x speedup, val set 5.473x speedup, step: 2
Epoch 123/200 |loss: 7.286960| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 3
Epoch 124/200 |loss: 7.169460| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 125/200 |loss: 7.153187| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 126/200 |loss: 7.230869| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 3
Epoch 127/200 |loss: 7.197657| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 4
Epoch 128/200 |loss: 7.127573| train set 5.247x speedup, test set 0.828x speedup, val set 5.484x speedup, step: 5
Epoch 129/200 |loss: 7.279175| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 6
Epoch 130/200 |loss: 7.116333| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 131/200 |loss: 7.029376| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 132/200 |loss: 7.120313| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 133/200 |loss: 7.051397| train set 5.224x speedup, test set 0.824x speedup, val set 5.473x speedup, step: 3
Epoch 134/200 |loss: 7.044497| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 4
Epoch 135/200 |loss: 7.169769| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 136/200 |loss: 7.169165| train set 5.213x speedup, test set 0.828x speedup, val set 5.373x speedup, step: 2
Epoch 137/200 |loss: 7.124131| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 138/200 |loss: 7.055366| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 139/200 |loss: 6.989024| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 140/200 |loss: 6.996476| train set 5.224x speedup, test set 0.824x speedup, val set 5.473x speedup, step: 3
Epoch 141/200 |loss: 7.099203| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 4
Epoch 142/200 |loss: 7.041404| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 143/200 |loss: 6.993863| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 144/200 |loss: 6.923167| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 3
Epoch 145/200 |loss: 6.994559| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 4
Epoch 146/200 |loss: 6.997492| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 5
Epoch 147/200 |loss: 6.995382| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 148/200 |loss: 6.994517| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 149/200 |loss: 6.932831| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 3
Epoch 150/200 |loss: 6.938983| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 151/200 |loss: 6.932748| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 152/200 |loss: 6.950139| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 3
Epoch 153/200 |loss: 6.995129| train set 5.211x speedup, test set 0.811x speedup, val set 5.389x speedup, step: 4
Epoch 154/200 |loss: 6.989084| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 155/200 |loss: 6.946962| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 156/200 |loss: 6.904678| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 3
Epoch 157/200 |loss: 6.869832| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 158/200 |loss: 6.899293| train set 5.213x speedup, test set 0.822x speedup, val set 5.373x speedup, step: 2
Epoch 159/200 |loss: 6.922952| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 160/200 |loss: 6.948249| train set 5.213x speedup, test set 0.811x speedup, val set 5.373x speedup, step: 2
Epoch 161/200 |loss: 6.957475| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 162/200 |loss: 7.074471| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 163/200 |loss: 7.084091| train set 5.249x speedup, test set 0.807x speedup, val set 5.487x speedup, step: 1
Epoch 164/200 |loss: 7.371301| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 165/200 |loss: 7.080701| train set 5.211x speedup, test set 0.807x speedup, val set 5.389x speedup, step: 2
Epoch 166/200 |loss: 7.043344| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 167/200 |loss: 7.288525| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 168/200 |loss: 7.165568| train set 5.213x speedup, test set 0.822x speedup, val set 5.373x speedup, step: 3
Epoch 169/200 |loss: 7.063919| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 170/200 |loss: 7.238344| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 2
Epoch 171/200 |loss: 7.017191| train set 5.213x speedup, test set 0.822x speedup, val set 5.373x speedup, step: 3
Epoch 172/200 |loss: 7.099647| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 173/200 |loss: 7.374268| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 174/200 |loss: 7.001331| train set 5.213x speedup, test set 0.822x speedup, val set 5.373x speedup, step: 2
Epoch 175/200 |loss: 7.336916| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 176/200 |loss: 7.280560| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 177/200 |loss: 7.073882| train set 5.213x speedup, test set 0.824x speedup, val set 5.373x speedup, step: 2
Epoch 178/200 |loss: 7.255972| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 179/200 |loss: 7.063916| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 180/200 |loss: 7.141505| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 181/200 |loss: 7.065102| train set 5.213x speedup, test set 0.824x speedup, val set 5.373x speedup, step: 3
Epoch 182/200 |loss: 7.115102| train set 5.258x speedup, test set 0.824x speedup, val set 5.473x speedup, step: 4
Epoch 183/200 |loss: 6.988621| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 184/200 |loss: 7.031577| train set 5.213x speedup, test set 0.824x speedup, val set 5.373x speedup, step: 2
Epoch 185/200 |loss: 6.958430| train set 5.186x speedup, test set 0.824x speedup, val set 5.375x speedup, step: 3
Epoch 186/200 |loss: 7.035367| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 4
Epoch 187/200 |loss: 6.909764| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 188/200 |loss: 6.964943| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 2
Epoch 189/200 |loss: 6.962631| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 3
Epoch 190/200 |loss: 6.889552| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 4
Epoch 191/200 |loss: 6.908135| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 192/200 |loss: 6.880990| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 193/200 |loss: 6.880555| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 194/200 |loss: 6.856228| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 195/200 |loss: 6.872475| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 196/200 |loss: 6.875607| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 197/200 |loss: 6.889796| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 2
Epoch 198/200 |loss: 6.915813| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 3
Epoch 199/200 |loss: 7.080918| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Training per epoch cost 0.253 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 182, train speedup 5.258, test speedup 0.824, val speedup 5.473
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 199, train speedup 5.249, test speedup 0.822, val speedup 5.487
last model at epoch 199, train speedup 5.249, test speedup 0.822, val speedup 5.487
execution cost 0:02:39.057146
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.968347, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146671| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705244| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.174875| train set 3.535x speedup, test set 1.093x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701828| train set 3.514x speedup, test set 0.890x speedup, val set 3.526x speedup, step: 6
Epoch 6/200 |loss: 21.222296| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.778355| train set 3.923x speedup, test set 0.862x speedup, val set 3.931x speedup, step: 8
Epoch 8/200 |loss: 20.327322| train set 4.246x speedup, test set 0.742x speedup, val set 4.414x speedup, step: 9
Epoch 9/200 |loss: 19.875719| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.373444| train set 3.819x speedup, test set 0.697x speedup, val set 3.942x speedup, step: 11
Epoch 11/200 |loss: 18.868801| train set 4.319x speedup, test set 0.691x speedup, val set 4.491x speedup, step: 12
Epoch 12/200 |loss: 18.295364| train set 4.092x speedup, test set 0.601x speedup, val set 4.163x speedup, step: 13
Epoch 13/200 |loss: 17.786522| train set 4.370x speedup, test set 0.831x speedup, val set 4.469x speedup, step: 14
Epoch 14/200 |loss: 17.317532| train set 4.370x speedup, test set 0.831x speedup, val set 4.469x speedup, step: 15
Epoch 15/200 |loss: 16.772768| train set 4.368x speedup, test set 0.830x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.258116| train set 4.368x speedup, test set 0.826x speedup, val set 4.468x speedup, step: 17
Epoch 17/200 |loss: 15.791952| train set 4.436x speedup, test set 0.837x speedup, val set 4.536x speedup, step: 18
Epoch 18/200 |loss: 15.349211| train set 4.380x speedup, test set 0.834x speedup, val set 4.482x speedup, step: 19
Epoch 19/200 |loss: 14.943342| train set 4.586x speedup, test set 0.834x speedup, val set 4.775x speedup, step: 20
Epoch 20/200 |loss: 14.593722| train set 4.757x speedup, test set 0.791x speedup, val set 4.904x speedup, step: 21
Epoch 21/200 |loss: 14.195725| train set 4.915x speedup, test set 0.794x speedup, val set 5.082x speedup, step: 22
Epoch 22/200 |loss: 13.742646| train set 4.987x speedup, test set 0.844x speedup, val set 5.151x speedup, step: 23
Epoch 23/200 |loss: 13.372835| train set 5.228x speedup, test set 0.780x speedup, val set 5.461x speedup, step: 24
Epoch 24/200 |loss: 13.060920| train set 5.046x speedup, test set 0.850x speedup, val set 5.233x speedup, step: 25
Epoch 25/200 |loss: 12.725572| train set 5.228x speedup, test set 0.834x speedup, val set 5.461x speedup, step: 26
Epoch 26/200 |loss: 12.401193| train set 5.223x speedup, test set 0.820x speedup, val set 5.476x speedup, step: 27
Epoch 27/200 |loss: 12.329855| train set 5.040x speedup, test set 0.829x speedup, val set 5.327x speedup, step: 28
Epoch 28/200 |loss: 12.551141| train set 5.228x speedup, test set 0.882x speedup, val set 5.461x speedup, step: 29
Epoch 29/200 |loss: 12.237549| train set 5.248x speedup, test set 0.873x speedup, val set 5.489x speedup, step: 30
Epoch 30/200 |loss: 11.606738| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 31
Epoch 31/200 |loss: 11.503397| train set 5.248x speedup, test set 0.847x speedup, val set 5.489x speedup, step: 32
Epoch 32/200 |loss: 11.166772| train set 5.248x speedup, test set 0.847x speedup, val set 5.489x speedup, step: 33
Epoch 33/200 |loss: 10.732896| train set 5.248x speedup, test set 0.849x speedup, val set 5.474x speedup, step: 34
Epoch 34/200 |loss: 10.717977| train set 5.248x speedup, test set 1.074x speedup, val set 5.489x speedup, step: 35
Epoch 35/200 |loss: 10.529846| train set 5.228x speedup, test set 0.849x speedup, val set 5.461x speedup, step: 36
Epoch 36/200 |loss: 10.208457| train set 5.248x speedup, test set 0.849x speedup, val set 5.489x speedup, step: 37
Epoch 37/200 |loss: 9.902764| train set 5.248x speedup, test set 1.074x speedup, val set 5.489x speedup, step: 38
Epoch 38/200 |loss: 9.800234| train set 5.248x speedup, test set 0.845x speedup, val set 5.489x speedup, step: 39
Epoch 39/200 |loss: 9.759304| train set 5.223x speedup, test set 1.075x speedup, val set 5.476x speedup, step: 40
Epoch 40/200 |loss: 9.879928| train set 5.248x speedup, test set 0.842x speedup, val set 5.489x speedup, step: 41
Epoch 41/200 |loss: 9.809751| train set 5.223x speedup, test set 1.069x speedup, val set 5.476x speedup, step: 42
Epoch 42/200 |loss: 9.320296| train set 5.248x speedup, test set 0.846x speedup, val set 5.489x speedup, step: 43
Epoch 43/200 |loss: 9.659625| train set 5.207x speedup, test set 1.063x speedup, val set 5.432x speedup, step: 44
Epoch 44/200 |loss: 9.838324| train set 5.248x speedup, test set 1.063x speedup, val set 5.489x speedup, step: 45
Epoch 45/200 |loss: 9.418892| train set 5.248x speedup, test set 0.846x speedup, val set 5.489x speedup, step: 46
Epoch 46/200 |loss: 9.403690| train set 5.248x speedup, test set 1.067x speedup, val set 5.489x speedup, step: 47
Epoch 47/200 |loss: 9.098192| train set 5.248x speedup, test set 1.048x speedup, val set 5.489x speedup, step: 48
Epoch 48/200 |loss: 8.953770| train set 5.248x speedup, test set 1.074x speedup, val set 5.489x speedup, step: 49
Epoch 49/200 |loss: 8.903358| train set 5.210x speedup, test set 0.837x speedup, val set 5.391x speedup, step: 50
Epoch 50/200 |loss: 8.729695| train set 5.248x speedup, test set 1.060x speedup, val set 5.489x speedup, step: 51
Epoch 51/200 |loss: 8.735723| train set 5.248x speedup, test set 0.828x speedup, val set 5.489x speedup, step: 52
Epoch 52/200 |loss: 8.685948| train set 5.223x speedup, test set 1.060x speedup, val set 5.476x speedup, step: 53
Epoch 53/200 |loss: 8.965566| train set 5.211x speedup, test set 1.048x speedup, val set 5.389x speedup, step: 54
Epoch 54/200 |loss: 8.368130| train set 5.210x speedup, test set 0.854x speedup, val set 5.391x speedup, step: 55
Epoch 55/200 |loss: 8.579138| train set 5.248x speedup, test set 1.097x speedup, val set 5.489x speedup, step: 56
Epoch 56/200 |loss: 8.899355| train set 5.249x speedup, test set 1.091x speedup, val set 5.487x speedup, step: 57
Epoch 57/200 |loss: 8.361543| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 58
Epoch 58/200 |loss: 8.868788| train set 5.224x speedup, test set 1.097x speedup, val set 5.473x speedup, step: 59
Epoch 59/200 |loss: 8.483948| train set 5.041x speedup, test set 1.078x speedup, val set 5.325x speedup, step: 60
Epoch 60/200 |loss: 8.718084| train set 5.211x speedup, test set 1.083x speedup, val set 5.389x speedup, step: 61
Epoch 61/200 |loss: 8.244869| train set 5.211x speedup, test set 1.038x speedup, val set 5.389x speedup, step: 62
Epoch 62/200 |loss: 8.410832| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 63
Epoch 63/200 |loss: 8.306620| train set 5.249x speedup, test set 0.836x speedup, val set 5.487x speedup, step: 64
Epoch 64/200 |loss: 8.038235| train set 5.249x speedup, test set 1.039x speedup, val set 5.487x speedup, step: 65
Epoch 65/200 |loss: 8.162576| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 66
Epoch 66/200 |loss: 7.972630| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 67
Epoch 67/200 |loss: 7.982677| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 68
Epoch 68/200 |loss: 7.821667| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 69
Epoch 69/200 |loss: 7.875525| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 70
Epoch 70/200 |loss: 7.784065| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 71
Epoch 71/200 |loss: 7.728314| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 72
Epoch 72/200 |loss: 7.646511| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 73
Epoch 73/200 |loss: 7.685812| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 74
Epoch 74/200 |loss: 7.610163| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 75
Epoch 75/200 |loss: 7.554152| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 76
Epoch 76/200 |loss: 7.517851| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 77
Epoch 77/200 |loss: 7.489790| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 78
Epoch 78/200 |loss: 7.574149| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 79
Epoch 79/200 |loss: 7.547987| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 80
Epoch 80/200 |loss: 7.554355| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 81
Epoch 81/200 |loss: 7.539024| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 82
Epoch 82/200 |loss: 7.769159| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 83
Epoch 83/200 |loss: 7.496293| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 84
Epoch 84/200 |loss: 7.322571| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 85
Epoch 85/200 |loss: 7.486287| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 86
Epoch 86/200 |loss: 7.713784| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 87
Epoch 87/200 |loss: 8.250592| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 88
Epoch 88/200 |loss: 7.572256| train set 5.209x speedup, test set 0.827x speedup, val set 5.386x speedup, step: 89
Epoch 89/200 |loss: 8.224133| train set 5.222x speedup, test set 1.037x speedup, val set 5.470x speedup, step: 90
Epoch 90/200 |loss: 8.349702| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 91
Epoch 91/200 |loss: 7.952708| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 92
Epoch 92/200 |loss: 8.486282| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 93
Epoch 93/200 |loss: 7.720436| train set 5.249x speedup, test set 1.038x speedup, val set 5.487x speedup, step: 94
Epoch 94/200 |loss: 7.868670| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 95
Epoch 95/200 |loss: 7.784827| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 96
Epoch 96/200 |loss: 7.712617| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 97
Epoch 97/200 |loss: 7.836152| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 98
Epoch 98/200 |loss: 7.527510| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 99
Epoch 99/200 |loss: 7.592360| train set 5.211x speedup, test set 0.806x speedup, val set 5.389x speedup, step: 100
Epoch 100/200 |loss: 7.491438| train set 5.249x speedup, test set 1.010x speedup, val set 5.487x speedup, step: 1
Epoch 101/200 |loss: 7.464866| train set 5.211x speedup, test set 0.810x speedup, val set 5.389x speedup, step: 2
Epoch 102/200 |loss: 7.363379| train set 5.211x speedup, test set 0.810x speedup, val set 5.389x speedup, step: 3
Epoch 103/200 |loss: 7.442623| train set 5.224x speedup, test set 0.810x speedup, val set 5.473x speedup, step: 4
Epoch 104/200 |loss: 7.315160| train set 5.224x speedup, test set 0.810x speedup, val set 5.473x speedup, step: 5
Epoch 105/200 |loss: 7.289515| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 6
Epoch 106/200 |loss: 7.304300| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 7
Epoch 107/200 |loss: 7.306645| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 108/200 |loss: 7.176223| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 2
Epoch 109/200 |loss: 7.211929| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 3
Epoch 110/200 |loss: 7.257738| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 111/200 |loss: 7.237940| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 112/200 |loss: 7.300636| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 113/200 |loss: 7.195006| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 3
Epoch 114/200 |loss: 7.140062| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 115/200 |loss: 7.162905| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 116/200 |loss: 7.126348| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 3
Epoch 117/200 |loss: 7.132494| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 118/200 |loss: 7.056300| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 2
Epoch 119/200 |loss: 7.036263| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 120/200 |loss: 7.118375| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 2
Epoch 121/200 |loss: 7.128137| train set 5.224x speedup, test set 0.827x speedup, val set 5.473x speedup, step: 3
Epoch 122/200 |loss: 7.331612| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 4
Epoch 123/200 |loss: 7.119846| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 124/200 |loss: 7.055103| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 125/200 |loss: 7.171941| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 126/200 |loss: 7.189855| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 127/200 |loss: 7.204975| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 128/200 |loss: 6.996746| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 3
Epoch 129/200 |loss: 7.019033| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 130/200 |loss: 7.200185| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 131/200 |loss: 7.035742| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 132/200 |loss: 6.957695| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 133/200 |loss: 6.992620| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 134/200 |loss: 7.012783| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 135/200 |loss: 7.003999| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 136/200 |loss: 6.943731| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 137/200 |loss: 6.941260| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 138/200 |loss: 6.986737| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 139/200 |loss: 7.000164| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 140/200 |loss: 7.089331| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 141/200 |loss: 7.119655| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 142/200 |loss: 7.180742| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 143/200 |loss: 7.399397| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 144/200 |loss: 6.990291| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 145/200 |loss: 7.012249| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 146/200 |loss: 7.273095| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 147/200 |loss: 7.084696| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 148/200 |loss: 6.970649| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 149/200 |loss: 7.095503| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 150/200 |loss: 7.090298| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 151/200 |loss: 6.937188| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 152/200 |loss: 7.050534| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 3
Epoch 153/200 |loss: 7.110600| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 154/200 |loss: 6.920854| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 2
Epoch 155/200 |loss: 7.064405| train set 5.258x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 3
Epoch 156/200 |loss: 7.083130| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 4
Epoch 157/200 |loss: 7.066179| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 158/200 |loss: 7.055381| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 159/200 |loss: 7.077473| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 160/200 |loss: 7.360689| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 3
Epoch 161/200 |loss: 6.938659| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 162/200 |loss: 7.380524| train set 5.186x speedup, test set 0.829x speedup, val set 5.375x speedup, step: 2
Epoch 163/200 |loss: 7.384169| train set 5.213x speedup, test set 0.829x speedup, val set 5.373x speedup, step: 3
Epoch 164/200 |loss: 7.218143| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 165/200 |loss: 7.387752| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 166/200 |loss: 7.066696| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 167/200 |loss: 7.152000| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 168/200 |loss: 7.114841| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 169/200 |loss: 7.039181| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 170/200 |loss: 7.077957| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 1
Epoch 171/200 |loss: 7.059731| train set 5.213x speedup, test set 0.828x speedup, val set 5.373x speedup, step: 2
Epoch 172/200 |loss: 7.017873| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 173/200 |loss: 7.058607| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 174/200 |loss: 6.944361| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 3
Epoch 175/200 |loss: 7.002711| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 176/200 |loss: 6.965060| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 177/200 |loss: 7.010400| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 178/200 |loss: 6.890874| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 179/200 |loss: 6.936429| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 3
Epoch 180/200 |loss: 6.898192| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 181/200 |loss: 6.983379| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 182/200 |loss: 6.916650| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 183/200 |loss: 6.929793| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 2
Epoch 184/200 |loss: 6.856288| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 3
Epoch 185/200 |loss: 6.897024| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 186/200 |loss: 6.913838| train set 5.213x speedup, test set 0.829x speedup, val set 5.373x speedup, step: 2
Epoch 187/200 |loss: 6.961587| train set 5.249x speedup, test set 0.808x speedup, val set 5.487x speedup, step: 1
Epoch 188/200 |loss: 7.005196| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 2
Epoch 189/200 |loss: 6.922612| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 3
Epoch 190/200 |loss: 6.996220| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 191/200 |loss: 6.899967| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 192/200 |loss: 6.975450| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 193/200 |loss: 7.053967| train set 5.213x speedup, test set 0.809x speedup, val set 5.373x speedup, step: 2
Epoch 194/200 |loss: 7.003543| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 195/200 |loss: 6.874145| train set 5.249x speedup, test set 0.808x speedup, val set 5.487x speedup, step: 1
Epoch 196/200 |loss: 6.920822| train set 5.211x speedup, test set 0.809x speedup, val set 5.389x speedup, step: 2
Epoch 197/200 |loss: 6.880363| train set 5.249x speedup, test set 0.809x speedup, val set 5.487x speedup, step: 1
Epoch 198/200 |loss: 6.999147| train set 5.213x speedup, test set 0.809x speedup, val set 5.373x speedup, step: 2
Epoch 199/200 |loss: 6.837241| train set 5.249x speedup, test set 0.809x speedup, val set 5.487x speedup, step: 1
Training per epoch cost 0.264 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.651s, pg runtime 1.680s, speedup 1.018x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.373s, pg runtime 0.354s, speedup 0.949x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 155, train speedup 5.258, test speedup 0.823, val speedup 5.473
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 199, train speedup 5.249, test speedup 0.809, val speedup 5.487
last model at epoch 199, train speedup 5.249, test speedup 0.809, val speedup 5.487
execution cost 0:02:48.640024
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.984641, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146671| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705244| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.174879| train set 3.535x speedup, test set 1.093x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701832| train set 3.514x speedup, test set 0.890x speedup, val set 3.526x speedup, step: 6
Epoch 6/200 |loss: 21.222298| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.778355| train set 3.923x speedup, test set 0.862x speedup, val set 3.931x speedup, step: 8
Epoch 8/200 |loss: 20.327322| train set 4.246x speedup, test set 0.742x speedup, val set 4.414x speedup, step: 9
Epoch 9/200 |loss: 19.875662| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.373657| train set 3.785x speedup, test set 0.697x speedup, val set 3.895x speedup, step: 11
Epoch 11/200 |loss: 18.873270| train set 4.319x speedup, test set 0.688x speedup, val set 4.491x speedup, step: 12
Epoch 12/200 |loss: 18.301670| train set 4.092x speedup, test set 0.588x speedup, val set 4.196x speedup, step: 13
Epoch 13/200 |loss: 17.792246| train set 4.370x speedup, test set 0.674x speedup, val set 4.469x speedup, step: 14
Epoch 14/200 |loss: 17.326065| train set 4.370x speedup, test set 0.832x speedup, val set 4.469x speedup, step: 15
Epoch 15/200 |loss: 16.783930| train set 4.368x speedup, test set 0.821x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.282610| train set 4.368x speedup, test set 0.822x speedup, val set 4.468x speedup, step: 17
Epoch 17/200 |loss: 15.814487| train set 4.436x speedup, test set 0.822x speedup, val set 4.534x speedup, step: 18
Epoch 18/200 |loss: 15.399792| train set 4.370x speedup, test set 0.862x speedup, val set 4.469x speedup, step: 19
Epoch 19/200 |loss: 15.018905| train set 4.648x speedup, test set 0.832x speedup, val set 4.834x speedup, step: 20
Epoch 20/200 |loss: 14.650532| train set 4.824x speedup, test set 0.833x speedup, val set 4.969x speedup, step: 21
Epoch 21/200 |loss: 14.211793| train set 4.915x speedup, test set 0.789x speedup, val set 5.082x speedup, step: 22
Epoch 22/200 |loss: 13.799323| train set 4.754x speedup, test set 0.873x speedup, val set 5.000x speedup, step: 23
Epoch 23/200 |loss: 13.474885| train set 5.150x speedup, test set 0.847x speedup, val set 5.383x speedup, step: 24
Epoch 24/200 |loss: 13.099582| train set 5.248x speedup, test set 0.858x speedup, val set 5.489x speedup, step: 25
Epoch 25/200 |loss: 12.937748| train set 5.027x speedup, test set 0.866x speedup, val set 5.208x speedup, step: 26
Epoch 26/200 |loss: 12.752586| train set 5.228x speedup, test set 0.830x speedup, val set 5.461x speedup, step: 27
Epoch 27/200 |loss: 12.254991| train set 5.248x speedup, test set 0.877x speedup, val set 5.489x speedup, step: 28
Epoch 28/200 |loss: 12.130965| train set 5.228x speedup, test set 0.865x speedup, val set 5.461x speedup, step: 29
Epoch 29/200 |loss: 11.576029| train set 5.228x speedup, test set 0.864x speedup, val set 5.461x speedup, step: 30
Epoch 30/200 |loss: 11.449173| train set 5.228x speedup, test set 0.882x speedup, val set 5.461x speedup, step: 31
Epoch 31/200 |loss: 11.370984| train set 5.248x speedup, test set 1.129x speedup, val set 5.489x speedup, step: 32
Epoch 32/200 |loss: 11.306313| train set 5.248x speedup, test set 0.836x speedup, val set 5.489x speedup, step: 33
Epoch 33/200 |loss: 11.103885| train set 5.248x speedup, test set 0.850x speedup, val set 5.489x speedup, step: 34
Epoch 34/200 |loss: 10.344015| train set 5.248x speedup, test set 1.128x speedup, val set 5.489x speedup, step: 35
Epoch 35/200 |loss: 10.329921| train set 5.248x speedup, test set 0.882x speedup, val set 5.489x speedup, step: 36
Epoch 36/200 |loss: 10.127006| train set 5.248x speedup, test set 0.850x speedup, val set 5.489x speedup, step: 37
Epoch 37/200 |loss: 10.220896| train set 5.248x speedup, test set 1.128x speedup, val set 5.489x speedup, step: 38
Epoch 38/200 |loss: 9.830639| train set 5.248x speedup, test set 0.850x speedup, val set 5.489x speedup, step: 39
Epoch 39/200 |loss: 10.020806| train set 5.223x speedup, test set 1.176x speedup, val set 5.476x speedup, step: 40
Epoch 40/200 |loss: 10.599109| train set 5.248x speedup, test set 1.171x speedup, val set 5.489x speedup, step: 41
Epoch 41/200 |loss: 9.776488| train set 5.210x speedup, test set 0.881x speedup, val set 5.391x speedup, step: 42
Epoch 42/200 |loss: 9.849269| train set 5.247x speedup, test set 1.171x speedup, val set 5.487x speedup, step: 43
Epoch 43/200 |loss: 9.777822| train set 5.039x speedup, test set 1.171x speedup, val set 5.325x speedup, step: 44
Epoch 44/200 |loss: 9.426329| train set 5.248x speedup, test set 0.836x speedup, val set 5.489x speedup, step: 45
Epoch 45/200 |loss: 9.332169| train set 5.249x speedup, test set 1.075x speedup, val set 5.487x speedup, step: 46
Epoch 46/200 |loss: 9.113554| train set 5.249x speedup, test set 1.128x speedup, val set 5.487x speedup, step: 47
Epoch 47/200 |loss: 9.010242| train set 5.249x speedup, test set 0.836x speedup, val set 5.472x speedup, step: 48
Epoch 48/200 |loss: 8.878531| train set 5.249x speedup, test set 0.836x speedup, val set 5.487x speedup, step: 49
Epoch 49/200 |loss: 8.688820| train set 5.223x speedup, test set 0.864x speedup, val set 5.476x speedup, step: 50
Epoch 50/200 |loss: 8.716436| train set 5.249x speedup, test set 0.866x speedup, val set 5.487x speedup, step: 51
Epoch 51/200 |loss: 8.518826| train set 5.249x speedup, test set 0.857x speedup, val set 5.487x speedup, step: 52
Epoch 52/200 |loss: 8.474416| train set 5.249x speedup, test set 0.866x speedup, val set 5.487x speedup, step: 53
Epoch 53/200 |loss: 8.440270| train set 5.247x speedup, test set 0.845x speedup, val set 5.484x speedup, step: 54
Epoch 54/200 |loss: 8.463844| train set 5.249x speedup, test set 0.856x speedup, val set 5.487x speedup, step: 55
Epoch 55/200 |loss: 8.428441| train set 5.211x speedup, test set 0.856x speedup, val set 5.389x speedup, step: 56
Epoch 56/200 |loss: 8.312118| train set 5.249x speedup, test set 0.856x speedup, val set 5.487x speedup, step: 57
Epoch 57/200 |loss: 8.092140| train set 5.249x speedup, test set 1.166x speedup, val set 5.487x speedup, step: 58
Epoch 58/200 |loss: 8.097507| train set 5.211x speedup, test set 0.862x speedup, val set 5.389x speedup, step: 59
Epoch 59/200 |loss: 8.000562| train set 5.249x speedup, test set 0.864x speedup, val set 5.487x speedup, step: 60
Epoch 60/200 |loss: 8.226455| train set 5.211x speedup, test set 0.855x speedup, val set 5.389x speedup, step: 61
Epoch 61/200 |loss: 7.925309| train set 5.249x speedup, test set 0.857x speedup, val set 5.487x speedup, step: 62
Epoch 62/200 |loss: 7.822449| train set 5.249x speedup, test set 0.858x speedup, val set 5.487x speedup, step: 63
Epoch 63/200 |loss: 7.961362| train set 5.249x speedup, test set 0.858x speedup, val set 5.487x speedup, step: 64
Epoch 64/200 |loss: 8.093085| train set 5.224x speedup, test set 1.042x speedup, val set 5.473x speedup, step: 65
Epoch 65/200 |loss: 8.841588| train set 5.249x speedup, test set 0.862x speedup, val set 5.487x speedup, step: 66
Epoch 66/200 |loss: 8.113005| train set 5.211x speedup, test set 0.856x speedup, val set 5.389x speedup, step: 67
Epoch 67/200 |loss: 8.301276| train set 5.224x speedup, test set 1.142x speedup, val set 5.473x speedup, step: 68
Epoch 68/200 |loss: 8.721997| train set 5.249x speedup, test set 0.851x speedup, val set 5.487x speedup, step: 69
Epoch 69/200 |loss: 7.997196| train set 5.133x speedup, test set 0.829x speedup, val set 5.313x speedup, step: 70
Epoch 70/200 |loss: 8.650432| train set 5.249x speedup, test set 1.083x speedup, val set 5.487x speedup, step: 71
Epoch 71/200 |loss: 7.915863| train set 5.016x speedup, test set 1.039x speedup, val set 5.309x speedup, step: 72
Epoch 72/200 |loss: 8.209380| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 73
Epoch 73/200 |loss: 8.000079| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 74
Epoch 74/200 |loss: 8.245539| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 75
Epoch 75/200 |loss: 8.028285| train set 5.249x speedup, test set 0.857x speedup, val set 5.487x speedup, step: 76
Epoch 76/200 |loss: 7.991856| train set 5.211x speedup, test set 0.840x speedup, val set 5.389x speedup, step: 77
Epoch 77/200 |loss: 7.716156| train set 5.211x speedup, test set 0.857x speedup, val set 5.389x speedup, step: 78
Epoch 78/200 |loss: 7.979940| train set 5.249x speedup, test set 0.857x speedup, val set 5.487x speedup, step: 79
Epoch 79/200 |loss: 7.638887| train set 5.249x speedup, test set 0.840x speedup, val set 5.487x speedup, step: 80
Epoch 80/200 |loss: 7.760041| train set 5.211x speedup, test set 0.856x speedup, val set 5.389x speedup, step: 81
Epoch 81/200 |loss: 7.575573| train set 5.211x speedup, test set 0.856x speedup, val set 5.389x speedup, step: 82
Epoch 82/200 |loss: 7.673221| train set 5.249x speedup, test set 0.838x speedup, val set 5.487x speedup, step: 83
Epoch 83/200 |loss: 7.491258| train set 5.249x speedup, test set 0.838x speedup, val set 5.487x speedup, step: 84
Epoch 84/200 |loss: 7.482164| train set 5.211x speedup, test set 0.856x speedup, val set 5.389x speedup, step: 85
Epoch 85/200 |loss: 7.427745| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 86
Epoch 86/200 |loss: 7.467467| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 87
Epoch 87/200 |loss: 7.425587| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 88
Epoch 88/200 |loss: 7.396479| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 89
Epoch 89/200 |loss: 7.387301| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 90
Epoch 90/200 |loss: 7.292530| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 91
Epoch 91/200 |loss: 7.271295| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 92
Epoch 92/200 |loss: 7.234499| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 93
Epoch 93/200 |loss: 7.240082| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 94
Epoch 94/200 |loss: 7.282590| train set 5.249x speedup, test set 0.829x speedup, val set 5.487x speedup, step: 95
Epoch 95/200 |loss: 7.357110| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 96
Epoch 96/200 |loss: 7.587708| train set 5.211x speedup, test set 0.829x speedup, val set 5.389x speedup, step: 97
Epoch 97/200 |loss: 7.364324| train set 5.224x speedup, test set 0.826x speedup, val set 5.473x speedup, step: 98
Epoch 98/200 |loss: 7.470788| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 99
Epoch 99/200 |loss: 7.309040| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 100
Epoch 100/200 |loss: 7.599601| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 1
Epoch 101/200 |loss: 7.756740| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 102/200 |loss: 7.335662| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 103/200 |loss: 7.229864| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 1
Epoch 104/200 |loss: 7.481371| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 105/200 |loss: 7.214795| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 2
Epoch 106/200 |loss: 7.254155| train set 5.224x speedup, test set 0.820x speedup, val set 5.473x speedup, step: 3
Epoch 107/200 |loss: 7.594942| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 4
Epoch 108/200 |loss: 7.151404| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 5
Epoch 109/200 |loss: 7.318473| train set 5.224x speedup, test set 0.821x speedup, val set 5.473x speedup, step: 6
Epoch 110/200 |loss: 7.793120| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 111/200 |loss: 7.222652| train set 5.213x speedup, test set 0.825x speedup, val set 5.373x speedup, step: 2
Epoch 112/200 |loss: 8.023193| train set 5.224x speedup, test set 1.080x speedup, val set 5.473x speedup, step: 3
Epoch 113/200 |loss: 7.883510| train set 5.249x speedup, test set 1.037x speedup, val set 5.487x speedup, step: 1
Epoch 114/200 |loss: 7.858901| train set 5.211x speedup, test set 0.836x speedup, val set 5.389x speedup, step: 2
Epoch 115/200 |loss: 7.735898| train set 5.211x speedup, test set 0.821x speedup, val set 5.389x speedup, step: 3
Epoch 116/200 |loss: 7.609397| train set 5.249x speedup, test set 1.052x speedup, val set 5.487x speedup, step: 1
Epoch 117/200 |loss: 7.495054| train set 5.249x speedup, test set 0.801x speedup, val set 5.487x speedup, step: 1
Epoch 118/200 |loss: 7.489408| train set 5.224x speedup, test set 0.823x speedup, val set 5.473x speedup, step: 2
Epoch 119/200 |loss: 7.341678| train set 5.186x speedup, test set 0.818x speedup, val set 5.375x speedup, step: 3
Epoch 120/200 |loss: 7.415921| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 4
Epoch 121/200 |loss: 7.287172| train set 5.210x speedup, test set 0.810x speedup, val set 5.387x speedup, step: 5
Epoch 122/200 |loss: 7.342659| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 6
Epoch 123/200 |loss: 7.209894| train set 5.249x speedup, test set 0.818x speedup, val set 5.487x speedup, step: 1
Epoch 124/200 |loss: 7.255297| train set 5.211x speedup, test set 0.823x speedup, val set 5.389x speedup, step: 2
Epoch 125/200 |loss: 7.159235| train set 5.211x speedup, test set 0.810x speedup, val set 5.389x speedup, step: 3
Epoch 126/200 |loss: 7.200399| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 127/200 |loss: 7.125245| train set 5.249x speedup, test set 0.821x speedup, val set 5.487x speedup, step: 1
Epoch 128/200 |loss: 7.123062| train set 5.249x speedup, test set 0.817x speedup, val set 5.487x speedup, step: 1
Epoch 129/200 |loss: 7.105017| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 130/200 |loss: 7.053896| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 2
Epoch 131/200 |loss: 7.068737| train set 5.249x speedup, test set 0.820x speedup, val set 5.487x speedup, step: 1
Epoch 132/200 |loss: 7.039279| train set 5.211x speedup, test set 0.825x speedup, val set 5.389x speedup, step: 2
Epoch 133/200 |loss: 7.031446| train set 5.249x speedup, test set 0.825x speedup, val set 5.487x speedup, step: 1
Epoch 134/200 |loss: 7.006437| train set 5.249x speedup, test set 0.820x speedup, val set 5.487x speedup, step: 1
Epoch 135/200 |loss: 7.019844| train set 5.211x speedup, test set 0.820x speedup, val set 5.389x speedup, step: 2
Epoch 136/200 |loss: 7.038989| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 1
Epoch 137/200 |loss: 7.169671| train set 5.211x speedup, test set 0.824x speedup, val set 5.389x speedup, step: 2
Epoch 138/200 |loss: 7.249940| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 1
Epoch 139/200 |loss: 7.515314| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 1
Epoch 140/200 |loss: 7.068754| train set 5.211x speedup, test set 0.809x speedup, val set 5.389x speedup, step: 2
Epoch 141/200 |loss: 7.099766| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 1
Epoch 142/200 |loss: 7.379507| train set 5.211x speedup, test set 0.809x speedup, val set 5.389x speedup, step: 2
Epoch 143/200 |loss: 7.047083| train set 5.213x speedup, test set 0.809x speedup, val set 5.373x speedup, step: 3
Epoch 144/200 |loss: 7.240477| train set 5.249x speedup, test set 0.802x speedup, val set 5.487x speedup, step: 1
Epoch 145/200 |loss: 7.581941| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 146/200 |loss: 7.130186| train set 5.213x speedup, test set 0.812x speedup, val set 5.373x speedup, step: 2
Epoch 147/200 |loss: 7.754144| train set 5.258x speedup, test set 0.812x speedup, val set 5.473x speedup, step: 3
Epoch 148/200 |loss: 7.223500| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 149/200 |loss: 7.418651| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 2
Epoch 150/200 |loss: 7.118089| train set 5.211x speedup, test set 0.811x speedup, val set 5.389x speedup, step: 3
Epoch 151/200 |loss: 7.286888| train set 5.249x speedup, test set 0.802x speedup, val set 5.487x speedup, step: 1
Epoch 152/200 |loss: 7.136254| train set 5.224x speedup, test set 0.803x speedup, val set 5.473x speedup, step: 2
Epoch 153/200 |loss: 7.169277| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 3
Epoch 154/200 |loss: 7.111444| train set 5.213x speedup, test set 0.812x speedup, val set 5.373x speedup, step: 4
Epoch 155/200 |loss: 7.118181| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 156/200 |loss: 7.114175| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 157/200 |loss: 7.047060| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 2
Epoch 158/200 |loss: 7.017450| train set 5.211x speedup, test set 0.805x speedup, val set 5.389x speedup, step: 3
Epoch 159/200 |loss: 7.014571| train set 5.249x speedup, test set 0.804x speedup, val set 5.487x speedup, step: 1
Epoch 160/200 |loss: 6.987968| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 1
Epoch 161/200 |loss: 6.975335| train set 5.211x speedup, test set 0.804x speedup, val set 5.389x speedup, step: 2
Epoch 162/200 |loss: 6.963105| train set 5.249x speedup, test set 0.804x speedup, val set 5.487x speedup, step: 1
Epoch 163/200 |loss: 6.955313| train set 5.249x speedup, test set 0.804x speedup, val set 5.487x speedup, step: 1
Epoch 164/200 |loss: 6.940334| train set 5.211x speedup, test set 0.804x speedup, val set 5.389x speedup, step: 2
Epoch 165/200 |loss: 6.926807| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 3
Epoch 166/200 |loss: 6.913783| train set 5.249x speedup, test set 0.806x speedup, val set 5.487x speedup, step: 1
Epoch 167/200 |loss: 6.914159| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 168/200 |loss: 6.892466| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 2
Epoch 169/200 |loss: 6.894756| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 3
Epoch 170/200 |loss: 6.871833| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 171/200 |loss: 6.884427| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 172/200 |loss: 6.855835| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 173/200 |loss: 6.891156| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 174/200 |loss: 6.911661| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 2
Epoch 175/200 |loss: 7.227678| train set 5.224x speedup, test set 0.814x speedup, val set 5.473x speedup, step: 3
Epoch 176/200 |loss: 7.490713| train set 5.211x speedup, test set 0.810x speedup, val set 5.389x speedup, step: 4
Epoch 177/200 |loss: 7.907808| train set 5.249x speedup, test set 0.823x speedup, val set 5.487x speedup, step: 1
Epoch 178/200 |loss: 7.112813| train set 5.251x speedup, test set 0.815x speedup, val set 5.471x speedup, step: 2
Epoch 179/200 |loss: 7.628608| train set 5.211x speedup, test set 0.806x speedup, val set 5.389x speedup, step: 3
Epoch 180/200 |loss: 7.932400| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 181/200 |loss: 7.536387| train set 5.249x speedup, test set 0.824x speedup, val set 5.487x speedup, step: 1
Epoch 182/200 |loss: 7.660456| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 183/200 |loss: 7.273239| train set 5.247x speedup, test set 0.814x speedup, val set 5.484x speedup, step: 2
Epoch 184/200 |loss: 7.502846| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 185/200 |loss: 7.220332| train set 5.213x speedup, test set 0.819x speedup, val set 5.373x speedup, step: 2
Epoch 186/200 |loss: 7.459955| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 3
Epoch 187/200 |loss: 7.171304| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 188/200 |loss: 7.280910| train set 5.211x speedup, test set 0.820x speedup, val set 5.389x speedup, step: 2
Epoch 189/200 |loss: 7.081657| train set 5.211x speedup, test set 0.816x speedup, val set 5.389x speedup, step: 3
Epoch 190/200 |loss: 7.219715| train set 5.249x speedup, test set 0.816x speedup, val set 5.487x speedup, step: 1
Epoch 191/200 |loss: 7.060807| train set 5.249x speedup, test set 0.816x speedup, val set 5.487x speedup, step: 1
Epoch 192/200 |loss: 7.123628| train set 5.211x speedup, test set 0.820x speedup, val set 5.389x speedup, step: 2
Epoch 193/200 |loss: 7.034506| train set 5.224x speedup, test set 0.816x speedup, val set 5.473x speedup, step: 3
Epoch 194/200 |loss: 7.081800| train set 5.224x speedup, test set 0.820x speedup, val set 5.473x speedup, step: 4
Epoch 195/200 |loss: 6.988606| train set 5.249x speedup, test set 0.820x speedup, val set 5.487x speedup, step: 1
Epoch 196/200 |loss: 7.016959| train set 5.249x speedup, test set 0.816x speedup, val set 5.487x speedup, step: 1
Epoch 197/200 |loss: 6.985456| train set 5.211x speedup, test set 0.816x speedup, val set 5.389x speedup, step: 2
Epoch 198/200 |loss: 6.952214| train set 5.211x speedup, test set 0.820x speedup, val set 5.389x speedup, step: 3
Epoch 199/200 |loss: 6.971757| train set 5.249x speedup, test set 0.820x speedup, val set 5.487x speedup, step: 1
Training per epoch cost 0.263 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.373s, pg runtime 0.354s, speedup 0.949x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 147, train speedup 5.258, test speedup 0.812, val speedup 5.473
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 199, train speedup 5.249, test speedup 0.820, val speedup 5.487
last model at epoch 199, train speedup 5.249, test speedup 0.820, val speedup 5.487
execution cost 0:02:47.304331
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.923054, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.343586| train set 1.452x speedup, test set 1.582x speedup, val set 1.411x speedup, step: 1
Epoch 1/200 |loss: 23.662661| train set 2.894x speedup, test set 1.065x speedup, val set 2.969x speedup, step: 2
Epoch 2/200 |loss: 23.146671| train set 3.439x speedup, test set 1.154x speedup, val set 3.457x speedup, step: 3
Epoch 3/200 |loss: 22.705244| train set 3.314x speedup, test set 1.073x speedup, val set 3.328x speedup, step: 4
Epoch 4/200 |loss: 22.174879| train set 3.535x speedup, test set 1.093x speedup, val set 3.576x speedup, step: 5
Epoch 5/200 |loss: 21.701838| train set 3.514x speedup, test set 0.890x speedup, val set 3.526x speedup, step: 6
Epoch 6/200 |loss: 21.222298| train set 3.924x speedup, test set 0.861x speedup, val set 3.933x speedup, step: 7
Epoch 7/200 |loss: 20.778355| train set 3.923x speedup, test set 0.862x speedup, val set 3.931x speedup, step: 8
Epoch 8/200 |loss: 20.327326| train set 4.246x speedup, test set 0.742x speedup, val set 4.414x speedup, step: 9
Epoch 9/200 |loss: 19.875668| train set 3.817x speedup, test set 0.699x speedup, val set 3.941x speedup, step: 10
Epoch 10/200 |loss: 19.373472| train set 3.785x speedup, test set 0.697x speedup, val set 3.895x speedup, step: 11
Epoch 11/200 |loss: 18.872002| train set 4.319x speedup, test set 0.685x speedup, val set 4.491x speedup, step: 12
Epoch 12/200 |loss: 18.301512| train set 4.092x speedup, test set 0.588x speedup, val set 4.196x speedup, step: 13
Epoch 13/200 |loss: 17.793690| train set 4.370x speedup, test set 0.680x speedup, val set 4.469x speedup, step: 14
Epoch 14/200 |loss: 17.317371| train set 4.370x speedup, test set 0.832x speedup, val set 4.469x speedup, step: 15
Epoch 15/200 |loss: 16.790306| train set 4.368x speedup, test set 0.832x speedup, val set 4.468x speedup, step: 16
Epoch 16/200 |loss: 16.278273| train set 4.368x speedup, test set 0.818x speedup, val set 4.468x speedup, step: 17
Epoch 17/200 |loss: 15.761872| train set 4.436x speedup, test set 0.828x speedup, val set 4.534x speedup, step: 18
Epoch 18/200 |loss: 15.317374| train set 4.436x speedup, test set 0.825x speedup, val set 4.534x speedup, step: 19
Epoch 19/200 |loss: 14.857955| train set 4.606x speedup, test set 0.834x speedup, val set 4.826x speedup, step: 20
Epoch 20/200 |loss: 14.412469| train set 4.757x speedup, test set 0.830x speedup, val set 4.904x speedup, step: 21
Epoch 21/200 |loss: 13.986614| train set 4.836x speedup, test set 0.755x speedup, val set 5.062x speedup, step: 22
Epoch 22/200 |loss: 13.721603| train set 4.987x speedup, test set 0.848x speedup, val set 5.151x speedup, step: 23
Epoch 23/200 |loss: 14.491407| train set 4.836x speedup, test set 0.785x speedup, val set 5.062x speedup, step: 24
Epoch 24/200 |loss: 13.482870| train set 5.248x speedup, test set 0.792x speedup, val set 5.489x speedup, step: 25
Epoch 25/200 |loss: 13.345448| train set 5.223x speedup, test set 1.139x speedup, val set 5.476x speedup, step: 26
Epoch 26/200 |loss: 12.790349| train set 4.955x speedup, test set 0.863x speedup, val set 5.136x speedup, step: 27
Epoch 27/200 |loss: 12.793650| train set 5.248x speedup, test set 1.099x speedup, val set 5.489x speedup, step: 28
Epoch 28/200 |loss: 12.110922| train set 5.248x speedup, test set 0.820x speedup, val set 5.489x speedup, step: 29
Epoch 29/200 |loss: 12.213707| train set 5.248x speedup, test set 0.852x speedup, val set 5.489x speedup, step: 30
Epoch 30/200 |loss: 11.521131| train set 5.223x speedup, test set 1.121x speedup, val set 5.476x speedup, step: 31
Epoch 31/200 |loss: 11.586724| train set 5.248x speedup, test set 1.079x speedup, val set 5.489x speedup, step: 32
Epoch 32/200 |loss: 11.095102| train set 5.248x speedup, test set 0.843x speedup, val set 5.489x speedup, step: 33
Epoch 33/200 |loss: 11.030623| train set 5.248x speedup, test set 1.079x speedup, val set 5.489x speedup, step: 34
Epoch 34/200 |loss: 10.636963| train set 5.248x speedup, test set 0.836x speedup, val set 5.489x speedup, step: 35
Epoch 35/200 |loss: 10.528698| train set 5.248x speedup, test set 1.071x speedup, val set 5.489x speedup, step: 36
Epoch 36/200 |loss: 10.227962| train set 5.228x speedup, test set 0.849x speedup, val set 5.461x speedup, step: 37
Epoch 37/200 |loss: 10.091180| train set 5.248x speedup, test set 1.067x speedup, val set 5.489x speedup, step: 38
Epoch 38/200 |loss: 9.937354| train set 5.248x speedup, test set 0.834x speedup, val set 5.489x speedup, step: 39
Epoch 39/200 |loss: 9.911553| train set 5.248x speedup, test set 1.075x speedup, val set 5.489x speedup, step: 40
Epoch 40/200 |loss: 9.852695| train set 5.248x speedup, test set 1.061x speedup, val set 5.489x speedup, step: 41
Epoch 41/200 |loss: 9.792484| train set 5.248x speedup, test set 0.850x speedup, val set 5.489x speedup, step: 42
Epoch 42/200 |loss: 9.487799| train set 5.248x speedup, test set 1.122x speedup, val set 5.489x speedup, step: 43
Epoch 43/200 |loss: 9.271664| train set 5.210x speedup, test set 0.870x speedup, val set 5.391x speedup, step: 44
Epoch 44/200 |loss: 9.256362| train set 5.223x speedup, test set 1.113x speedup, val set 5.476x speedup, step: 45
Epoch 45/200 |loss: 9.464583| train set 5.248x speedup, test set 0.869x speedup, val set 5.489x speedup, step: 46
Epoch 46/200 |loss: 8.907542| train set 5.210x speedup, test set 1.107x speedup, val set 5.391x speedup, step: 47
Epoch 47/200 |loss: 9.055431| train set 5.223x speedup, test set 1.170x speedup, val set 5.476x speedup, step: 48
Epoch 48/200 |loss: 9.272733| train set 5.248x speedup, test set 0.852x speedup, val set 5.489x speedup, step: 49
Epoch 49/200 |loss: 9.080652| train set 5.248x speedup, test set 0.870x speedup, val set 5.489x speedup, step: 50
Epoch 50/200 |loss: 8.784520| train set 5.223x speedup, test set 1.171x speedup, val set 5.476x speedup, step: 51
Epoch 51/200 |loss: 9.034955| train set 5.248x speedup, test set 0.847x speedup, val set 5.489x speedup, step: 52
Epoch 52/200 |loss: 8.541858| train set 5.040x speedup, test set 0.852x speedup, val set 5.327x speedup, step: 53
Epoch 53/200 |loss: 8.669111| train set 5.248x speedup, test set 1.106x speedup, val set 5.489x speedup, step: 54
Epoch 54/200 |loss: 8.581642| train set 5.248x speedup, test set 1.091x speedup, val set 5.489x speedup, step: 55
Epoch 55/200 |loss: 8.329805| train set 5.209x speedup, test set 0.847x speedup, val set 5.389x speedup, step: 56
Epoch 56/200 |loss: 8.314456| train set 5.249x speedup, test set 0.847x speedup, val set 5.487x speedup, step: 57
Epoch 57/200 |loss: 8.365634| train set 5.249x speedup, test set 0.855x speedup, val set 5.487x speedup, step: 58
Epoch 58/200 |loss: 8.105299| train set 5.249x speedup, test set 0.855x speedup, val set 5.487x speedup, step: 59
Epoch 59/200 |loss: 8.086096| train set 5.249x speedup, test set 1.093x speedup, val set 5.487x speedup, step: 60
Epoch 60/200 |loss: 8.084797| train set 5.211x speedup, test set 0.838x speedup, val set 5.389x speedup, step: 61
Epoch 61/200 |loss: 8.079744| train set 5.224x speedup, test set 1.080x speedup, val set 5.473x speedup, step: 62
Epoch 62/200 |loss: 8.113105| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 63
Epoch 63/200 |loss: 8.015718| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 64
Epoch 64/200 |loss: 7.999287| train set 5.249x speedup, test set 1.107x speedup, val set 5.487x speedup, step: 65
Epoch 65/200 |loss: 8.181140| train set 5.211x speedup, test set 0.813x speedup, val set 5.389x speedup, step: 66
Epoch 66/200 |loss: 7.989841| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 67
Epoch 67/200 |loss: 7.863548| train set 5.224x speedup, test set 1.048x speedup, val set 5.473x speedup, step: 68
Epoch 68/200 |loss: 7.998528| train set 5.249x speedup, test set 0.813x speedup, val set 5.487x speedup, step: 69
Epoch 69/200 |loss: 7.795071| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 70
Epoch 70/200 |loss: 7.701244| train set 5.211x speedup, test set 1.048x speedup, val set 5.389x speedup, step: 71
Epoch 71/200 |loss: 7.616553| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 72
Epoch 72/200 |loss: 7.627861| train set 5.224x speedup, test set 1.048x speedup, val set 5.473x speedup, step: 73
Epoch 73/200 |loss: 7.814079| train set 5.211x speedup, test set 0.854x speedup, val set 5.389x speedup, step: 74
Epoch 74/200 |loss: 7.680258| train set 5.224x speedup, test set 1.093x speedup, val set 5.473x speedup, step: 75
Epoch 75/200 |loss: 7.798852| train set 5.211x speedup, test set 0.854x speedup, val set 5.389x speedup, step: 76
Epoch 76/200 |loss: 7.579847| train set 5.211x speedup, test set 0.856x speedup, val set 5.389x speedup, step: 77
Epoch 77/200 |loss: 7.723606| train set 5.249x speedup, test set 1.093x speedup, val set 5.487x speedup, step: 78
Epoch 78/200 |loss: 7.826907| train set 5.211x speedup, test set 0.854x speedup, val set 5.389x speedup, step: 79
Epoch 79/200 |loss: 7.535208| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 80
Epoch 80/200 |loss: 7.474001| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 81
Epoch 81/200 |loss: 7.539145| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 82
Epoch 82/200 |loss: 7.576674| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 83
Epoch 83/200 |loss: 7.530630| train set 5.249x speedup, test set 0.853x speedup, val set 5.487x speedup, step: 84
Epoch 84/200 |loss: 7.320897| train set 5.247x speedup, test set 0.826x speedup, val set 5.484x speedup, step: 85
Epoch 85/200 |loss: 7.511427| train set 5.224x speedup, test set 0.826x speedup, val set 5.473x speedup, step: 86
Epoch 86/200 |loss: 7.334161| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 87
Epoch 87/200 |loss: 7.378156| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 88
Epoch 88/200 |loss: 7.317059| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 89
Epoch 89/200 |loss: 7.199567| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 90
Epoch 90/200 |loss: 7.239599| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 91
Epoch 91/200 |loss: 7.167667| train set 5.213x speedup, test set 0.826x speedup, val set 5.373x speedup, step: 92
Epoch 92/200 |loss: 7.458786| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 93
Epoch 93/200 |loss: 9.296622| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 94
Epoch 94/200 |loss: 8.221655| train set 5.209x speedup, test set 0.853x speedup, val set 5.386x speedup, step: 95
Epoch 95/200 |loss: 9.238731| train set 4.969x speedup, test set 1.038x speedup, val set 5.302x speedup, step: 96
Epoch 96/200 |loss: 8.379633| train set 5.224x speedup, test set 1.051x speedup, val set 5.473x speedup, step: 97
Epoch 97/200 |loss: 8.644462| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 98
Epoch 98/200 |loss: 8.287537| train set 5.211x speedup, test set 1.038x speedup, val set 5.389x speedup, step: 99
Epoch 99/200 |loss: 8.099935| train set 5.249x speedup, test set 1.038x speedup, val set 5.487x speedup, step: 100
Epoch 100/200 |loss: 8.062264| train set 5.247x speedup, test set 0.813x speedup, val set 5.484x speedup, step: 1
Epoch 101/200 |loss: 7.842465| train set 5.209x speedup, test set 0.813x speedup, val set 5.386x speedup, step: 2
Epoch 102/200 |loss: 7.930543| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 3
Epoch 103/200 |loss: 7.664272| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 4
Epoch 104/200 |loss: 7.721445| train set 5.224x speedup, test set 0.828x speedup, val set 5.473x speedup, step: 5
Epoch 105/200 |loss: 7.585004| train set 5.211x speedup, test set 0.804x speedup, val set 5.389x speedup, step: 6
Epoch 106/200 |loss: 7.595683| train set 5.211x speedup, test set 0.805x speedup, val set 5.389x speedup, step: 7
Epoch 107/200 |loss: 7.457071| train set 5.211x speedup, test set 0.814x speedup, val set 5.389x speedup, step: 8
Epoch 108/200 |loss: 7.472065| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 109/200 |loss: 7.379691| train set 5.249x speedup, test set 0.814x speedup, val set 5.487x speedup, step: 1
Epoch 110/200 |loss: 7.414262| train set 5.249x speedup, test set 0.811x speedup, val set 5.487x speedup, step: 1
Epoch 111/200 |loss: 7.302954| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 112/200 |loss: 7.283855| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 113/200 |loss: 7.290906| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 2
Epoch 114/200 |loss: 7.222682| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 3
Epoch 115/200 |loss: 7.186531| train set 5.224x speedup, test set 0.826x speedup, val set 5.473x speedup, step: 4
Epoch 116/200 |loss: 7.196013| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 5
Epoch 117/200 |loss: 7.150607| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 118/200 |loss: 7.151339| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 119/200 |loss: 7.123588| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 120/200 |loss: 7.201050| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 121/200 |loss: 7.199677| train set 5.211x speedup, test set 0.828x speedup, val set 5.389x speedup, step: 2
Epoch 122/200 |loss: 7.341553| train set 5.213x speedup, test set 0.827x speedup, val set 5.373x speedup, step: 3
Epoch 123/200 |loss: 7.455442| train set 5.224x speedup, test set 0.829x speedup, val set 5.473x speedup, step: 4
Epoch 124/200 |loss: 7.774060| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 125/200 |loss: 7.151096| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 2
Epoch 126/200 |loss: 7.311401| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 3
Epoch 127/200 |loss: 7.739176| train set 5.249x speedup, test set 0.827x speedup, val set 5.487x speedup, step: 1
Epoch 128/200 |loss: 7.229166| train set 5.213x speedup, test set 0.812x speedup, val set 5.373x speedup, step: 2
Epoch 129/200 |loss: 7.740298| train set 5.224x speedup, test set 0.822x speedup, val set 5.473x speedup, step: 3
Epoch 130/200 |loss: 7.391236| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 4
Epoch 131/200 |loss: 7.552668| train set 5.211x speedup, test set 0.822x speedup, val set 5.389x speedup, step: 5
Epoch 132/200 |loss: 7.177659| train set 5.211x speedup, test set 0.827x speedup, val set 5.389x speedup, step: 6
Epoch 133/200 |loss: 7.456044| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 7
Epoch 134/200 |loss: 7.282126| train set 5.224x speedup, test set 1.038x speedup, val set 5.473x speedup, step: 8
Epoch 135/200 |loss: 7.321795| train set 5.211x speedup, test set 0.811x speedup, val set 5.389x speedup, step: 9
Epoch 136/200 |loss: 7.154319| train set 5.213x speedup, test set 0.826x speedup, val set 5.373x speedup, step: 10
Epoch 137/200 |loss: 7.282314| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 138/200 |loss: 7.189152| train set 5.249x speedup, test set 0.817x speedup, val set 5.487x speedup, step: 1
Epoch 139/200 |loss: 7.149158| train set 5.211x speedup, test set 0.789x speedup, val set 5.389x speedup, step: 2
Epoch 140/200 |loss: 7.133080| train set 5.211x speedup, test set 0.797x speedup, val set 5.389x speedup, step: 3
Epoch 141/200 |loss: 7.117054| train set 5.249x speedup, test set 0.822x speedup, val set 5.487x speedup, step: 1
Epoch 142/200 |loss: 7.107591| train set 5.224x speedup, test set 0.818x speedup, val set 5.473x speedup, step: 2
Epoch 143/200 |loss: 7.047204| train set 5.211x speedup, test set 0.789x speedup, val set 5.389x speedup, step: 3
Epoch 144/200 |loss: 7.081577| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 4
Epoch 145/200 |loss: 7.024901| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 146/200 |loss: 7.031748| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 147/200 |loss: 7.006180| train set 5.211x speedup, test set 0.797x speedup, val set 5.389x speedup, step: 2
Epoch 148/200 |loss: 7.010723| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 149/200 |loss: 7.045276| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 150/200 |loss: 6.962589| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 2
Epoch 151/200 |loss: 7.007266| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 152/200 |loss: 6.944257| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 153/200 |loss: 6.996457| train set 5.211x speedup, test set 0.812x speedup, val set 5.389x speedup, step: 2
Epoch 154/200 |loss: 6.971149| train set 5.211x speedup, test set 0.818x speedup, val set 5.389x speedup, step: 3
Epoch 155/200 |loss: 6.988251| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 156/200 |loss: 6.948131| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 2
Epoch 157/200 |loss: 6.949754| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 158/200 |loss: 6.903294| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 159/200 |loss: 6.930933| train set 5.211x speedup, test set 0.826x speedup, val set 5.389x speedup, step: 2
Epoch 160/200 |loss: 6.878442| train set 5.249x speedup, test set 0.826x speedup, val set 5.487x speedup, step: 1
Epoch 161/200 |loss: 6.909565| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 162/200 |loss: 6.907777| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 163/200 |loss: 6.946144| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Epoch 164/200 |loss: 7.007150| train set 5.249x speedup, test set 0.828x speedup, val set 5.487x speedup, step: 1
Epoch 165/200 |loss: 7.153933| train set 5.213x speedup, test set 0.819x speedup, val set 5.373x speedup, step: 2
Epoch 166/200 |loss: 7.165770| train set 5.249x speedup, test set 0.812x speedup, val set 5.487x speedup, step: 1
Epoch 167/200 |loss: 7.206831| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Epoch 168/200 |loss: 6.896851| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 169/200 |loss: 7.035870| train set 5.249x speedup, test set 0.795x speedup, val set 5.487x speedup, step: 1
Epoch 170/200 |loss: 7.387311| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 171/200 |loss: 7.032254| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 172/200 |loss: 7.108957| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 173/200 |loss: 7.386850| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Epoch 174/200 |loss: 7.202179| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 175/200 |loss: 7.108815| train set 5.247x speedup, test set 0.810x speedup, val set 5.484x speedup, step: 2
Epoch 176/200 |loss: 7.377244| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 3
Epoch 177/200 |loss: 6.937335| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 4
Epoch 178/200 |loss: 7.238581| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 1
Epoch 179/200 |loss: 7.016763| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 180/200 |loss: 7.060265| train set 5.224x speedup, test set 0.818x speedup, val set 5.473x speedup, step: 2
Epoch 181/200 |loss: 7.036293| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 182/200 |loss: 7.018081| train set 5.211x speedup, test set 0.802x speedup, val set 5.389x speedup, step: 2
Epoch 183/200 |loss: 6.987137| train set 5.249x speedup, test set 0.803x speedup, val set 5.487x speedup, step: 1
Epoch 184/200 |loss: 6.997396| train set 5.224x speedup, test set 0.818x speedup, val set 5.473x speedup, step: 2
Epoch 185/200 |loss: 6.907866| train set 5.211x speedup, test set 0.803x speedup, val set 5.389x speedup, step: 3
Epoch 186/200 |loss: 6.960604| train set 5.211x speedup, test set 0.809x speedup, val set 5.389x speedup, step: 4
Epoch 187/200 |loss: 6.915923| train set 5.249x speedup, test set 0.818x speedup, val set 5.487x speedup, step: 1
Epoch 188/200 |loss: 6.879190| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Epoch 189/200 |loss: 6.933143| train set 5.249x speedup, test set 0.809x speedup, val set 5.487x speedup, step: 1
Epoch 190/200 |loss: 6.861486| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 1
Epoch 191/200 |loss: 6.902350| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Epoch 192/200 |loss: 6.870655| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 193/200 |loss: 6.854882| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Epoch 194/200 |loss: 6.856823| train set 5.211x speedup, test set 0.810x speedup, val set 5.389x speedup, step: 3
Epoch 195/200 |loss: 6.903080| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 4
Epoch 196/200 |loss: 6.830625| train set 5.249x speedup, test set 0.819x speedup, val set 5.487x speedup, step: 1
Epoch 197/200 |loss: 6.858410| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Epoch 198/200 |loss: 6.842923| train set 5.249x speedup, test set 0.810x speedup, val set 5.487x speedup, step: 1
Epoch 199/200 |loss: 6.816073| train set 5.211x speedup, test set 0.819x speedup, val set 5.389x speedup, step: 2
Training per epoch cost 0.272 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 51.645s, pg runtime 13.945s, speedup 0.270x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.482s, pg runtime 8.605s, speedup 1.015x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 56, train speedup 5.249, test speedup 0.847, val speedup 5.487
best test speedup epoch: 0, train speedup 1.452, test speedup 1.582, val speedup 1.411
best validation speedup epoch: 198, train speedup 5.249, test speedup 0.810, val speedup 5.487
last model at epoch 199, train speedup 5.211, test speedup 0.819, val speedup 5.389
execution cost 0:02:55.649918
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.855937, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563330| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087482| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642033| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135206| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629988| train set 4.166x speedup, test set 0.973x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.116011| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.593994| train set 4.401x speedup, test set 0.859x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.063534| train set 4.388x speedup, test set 0.794x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.591366| train set 4.401x speedup, test set 0.862x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.149645| train set 4.463x speedup, test set 1.099x speedup, val set 4.640x speedup, step: 18
Epoch 18/200 |loss: 15.731858| train set 4.613x speedup, test set 0.867x speedup, val set 4.852x speedup, step: 19
Epoch 19/200 |loss: 15.341887| train set 4.447x speedup, test set 0.864x speedup, val set 4.623x speedup, step: 20
Epoch 20/200 |loss: 14.874214| train set 4.640x speedup, test set 0.858x speedup, val set 4.927x speedup, step: 21
Epoch 21/200 |loss: 14.458373| train set 4.825x speedup, test set 0.868x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.068266| train set 4.825x speedup, test set 0.897x speedup, val set 5.077x speedup, step: 23
Epoch 23/200 |loss: 13.723773| train set 4.551x speedup, test set 0.850x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.361729| train set 5.058x speedup, test set 1.198x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.197178| train set 4.885x speedup, test set 1.284x speedup, val set 5.141x speedup, step: 26
Epoch 26/200 |loss: 13.463371| train set 5.058x speedup, test set 0.876x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.585296| train set 5.079x speedup, test set 1.154x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.505034| train set 5.079x speedup, test set 1.129x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.248187| train set 5.079x speedup, test set 1.120x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.718540| train set 5.263x speedup, test set 1.165x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.739821| train set 5.263x speedup, test set 1.261x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.161642| train set 5.262x speedup, test set 1.157x speedup, val set 5.638x speedup, step: 33
Epoch 33/200 |loss: 11.020085| train set 5.263x speedup, test set 1.180x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.910357| train set 5.262x speedup, test set 1.123x speedup, val set 5.637x speedup, step: 35
Epoch 35/200 |loss: 10.375703| train set 5.264x speedup, test set 1.145x speedup, val set 5.539x speedup, step: 36
Epoch 36/200 |loss: 10.567211| train set 5.264x speedup, test set 1.171x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.191117| train set 5.262x speedup, test set 1.121x speedup, val set 5.637x speedup, step: 38
Epoch 38/200 |loss: 9.965969| train set 5.262x speedup, test set 1.141x speedup, val set 5.637x speedup, step: 39
Epoch 39/200 |loss: 9.754161| train set 5.264x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 9.752273| train set 5.267x speedup, test set 1.112x speedup, val set 5.637x speedup, step: 41
Epoch 41/200 |loss: 9.607756| train set 5.264x speedup, test set 1.114x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.289568| train set 5.262x speedup, test set 1.168x speedup, val set 5.637x speedup, step: 43
Epoch 43/200 |loss: 9.299379| train set 5.264x speedup, test set 1.155x speedup, val set 5.539x speedup, step: 44
Epoch 44/200 |loss: 9.293397| train set 5.262x speedup, test set 1.117x speedup, val set 5.637x speedup, step: 45
Epoch 45/200 |loss: 9.632427| train set 5.264x speedup, test set 1.234x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 10.820382| train set 5.190x speedup, test set 1.051x speedup, val set 5.467x speedup, step: 47
Epoch 47/200 |loss: 10.913505| train set 5.192x speedup, test set 0.870x speedup, val set 5.562x speedup, step: 48
Epoch 48/200 |loss: 9.509966| train set 5.264x speedup, test set 1.155x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 10.066462| train set 5.054x speedup, test set 1.126x speedup, val set 5.454x speedup, step: 50
Epoch 50/200 |loss: 9.385289| train set 5.262x speedup, test set 1.119x speedup, val set 5.637x speedup, step: 51
Epoch 51/200 |loss: 9.109976| train set 5.262x speedup, test set 1.137x speedup, val set 5.638x speedup, step: 52
Epoch 52/200 |loss: 9.321886| train set 5.262x speedup, test set 1.064x speedup, val set 5.638x speedup, step: 53
Epoch 53/200 |loss: 9.014049| train set 5.262x speedup, test set 1.064x speedup, val set 5.637x speedup, step: 54
Epoch 54/200 |loss: 8.726388| train set 5.262x speedup, test set 0.864x speedup, val set 5.637x speedup, step: 55
Epoch 55/200 |loss: 8.802397| train set 5.264x speedup, test set 0.866x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 9.044898| train set 5.262x speedup, test set 0.865x speedup, val set 5.637x speedup, step: 57
Epoch 57/200 |loss: 8.589411| train set 5.264x speedup, test set 0.865x speedup, val set 5.539x speedup, step: 58
Epoch 58/200 |loss: 8.498140| train set 5.264x speedup, test set 1.117x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.481002| train set 5.264x speedup, test set 0.871x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.313558| train set 5.264x speedup, test set 0.871x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 8.340029| train set 5.263x speedup, test set 1.041x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.266531| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 63
Epoch 63/200 |loss: 7.977931| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 64
Epoch 64/200 |loss: 8.107407| train set 5.263x speedup, test set 1.038x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 8.264648| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 66
Epoch 66/200 |loss: 7.956748| train set 5.262x speedup, test set 0.826x speedup, val set 5.637x speedup, step: 67
Epoch 67/200 |loss: 8.073606| train set 5.264x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 8.159278| train set 5.262x speedup, test set 0.827x speedup, val set 5.637x speedup, step: 69
Epoch 69/200 |loss: 7.829512| train set 5.262x speedup, test set 0.834x speedup, val set 5.637x speedup, step: 70
Epoch 70/200 |loss: 7.935775| train set 5.263x speedup, test set 1.045x speedup, val set 5.539x speedup, step: 71
Epoch 71/200 |loss: 7.844817| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 72
Epoch 72/200 |loss: 7.901683| train set 5.263x speedup, test set 0.839x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 7.919699| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 7.629327| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.852591| train set 5.263x speedup, test set 0.835x speedup, val set 5.539x speedup, step: 76
Epoch 76/200 |loss: 7.865791| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 7.630856| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.773561| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 79
Epoch 79/200 |loss: 7.823618| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 7.589782| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.585551| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 82
Epoch 82/200 |loss: 7.833284| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.417255| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 84
Epoch 84/200 |loss: 7.718995| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 7.732025| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.389027| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.725435| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 88
Epoch 88/200 |loss: 7.446259| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 7.465249| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 90
Epoch 90/200 |loss: 7.559974| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.537428| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 92
Epoch 92/200 |loss: 7.675105| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 7.612368| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 94
Epoch 94/200 |loss: 7.257838| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.331332| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 96
Epoch 96/200 |loss: 7.344492| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 7.451742| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.457447| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 99
Epoch 99/200 |loss: 7.197812| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.333686| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 1
Epoch 101/200 |loss: 7.387382| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.248341| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.355489| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 2
Epoch 104/200 |loss: 7.437783| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.158983| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 106/200 |loss: 7.547631| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 2
Epoch 107/200 |loss: 7.477890| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 108/200 |loss: 7.246557| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.451433| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 110/200 |loss: 7.195237| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 111/200 |loss: 7.265105| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.189532| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 113/200 |loss: 7.113853| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 114/200 |loss: 7.178600| train set 5.262x speedup, test set 0.806x speedup, val set 5.638x speedup, step: 1
Epoch 115/200 |loss: 7.074834| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.166548| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 117/200 |loss: 7.209383| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 3
Epoch 118/200 |loss: 7.040982| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 119/200 |loss: 7.235338| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 120/200 |loss: 7.271799| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 121/200 |loss: 7.075613| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 122/200 |loss: 7.268507| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 123/200 |loss: 7.119716| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 3
Epoch 124/200 |loss: 7.064660| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 125/200 |loss: 7.156887| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 126/200 |loss: 7.045490| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 127/200 |loss: 7.114541| train set 5.262x speedup, test set 0.806x speedup, val set 5.638x speedup, step: 1
Epoch 128/200 |loss: 7.148365| train set 5.262x speedup, test set 0.806x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.237664| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 130/200 |loss: 7.372612| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 3
Epoch 131/200 |loss: 7.118985| train set 5.262x speedup, test set 0.806x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.038007| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 133/200 |loss: 7.045940| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 2
Epoch 134/200 |loss: 7.007856| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 135/200 |loss: 7.132040| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 136/200 |loss: 7.129193| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 137/200 |loss: 7.115860| train set 5.263x speedup, test set 0.800x speedup, val set 5.539x speedup, step: 2
Epoch 138/200 |loss: 7.076353| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 139/200 |loss: 6.978152| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 140/200 |loss: 6.964371| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 7.034014| train set 5.263x speedup, test set 0.800x speedup, val set 5.539x speedup, step: 2
Epoch 142/200 |loss: 7.078863| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 143/200 |loss: 6.970018| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 144/200 |loss: 6.988744| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 145/200 |loss: 6.977570| train set 5.263x speedup, test set 0.800x speedup, val set 5.539x speedup, step: 3
Epoch 146/200 |loss: 6.944716| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 147/200 |loss: 7.016790| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 148/200 |loss: 7.039778| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 7.012318| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 150/200 |loss: 6.947949| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 151/200 |loss: 6.970778| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 152/200 |loss: 6.889050| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 6.910738| train set 5.263x speedup, test set 0.800x speedup, val set 5.539x speedup, step: 2
Epoch 154/200 |loss: 6.955007| train set 5.263x speedup, test set 0.800x speedup, val set 5.539x speedup, step: 3
Epoch 155/200 |loss: 6.934341| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 4
Epoch 156/200 |loss: 6.966258| train set 5.263x speedup, test set 0.805x speedup, val set 5.539x speedup, step: 5
Epoch 157/200 |loss: 6.996614| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 158/200 |loss: 7.041032| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 159/200 |loss: 6.973301| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 160/200 |loss: 6.985657| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 6.887876| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 6.867806| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 3
Epoch 163/200 |loss: 6.900687| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 164/200 |loss: 6.975805| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 165/200 |loss: 7.170125| train set 5.263x speedup, test set 0.805x speedup, val set 5.539x speedup, step: 2
Epoch 166/200 |loss: 6.972708| train set 5.256x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 6.920091| train set 5.263x speedup, test set 0.805x speedup, val set 5.539x speedup, step: 2
Epoch 168/200 |loss: 6.948368| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 169/200 |loss: 7.012851| train set 5.262x speedup, test set 0.795x speedup, val set 5.638x speedup, step: 1
Epoch 170/200 |loss: 7.067864| train set 5.263x speedup, test set 0.805x speedup, val set 5.539x speedup, step: 2
Epoch 171/200 |loss: 6.978875| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 172/200 |loss: 6.880836| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 173/200 |loss: 6.940357| train set 5.252x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 174/200 |loss: 6.966914| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 175/200 |loss: 7.018938| train set 5.263x speedup, test set 0.805x speedup, val set 5.570x speedup, step: 2
Epoch 176/200 |loss: 6.935884| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 6.867460| train set 5.263x speedup, test set 0.795x speedup, val set 5.539x speedup, step: 2
Epoch 178/200 |loss: 6.923076| train set 5.263x speedup, test set 0.795x speedup, val set 5.539x speedup, step: 3
Epoch 179/200 |loss: 6.963668| train set 5.262x speedup, test set 0.795x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 6.988403| train set 5.263x speedup, test set 0.805x speedup, val set 5.539x speedup, step: 2
Epoch 181/200 |loss: 6.900956| train set 5.262x speedup, test set 0.803x speedup, val set 5.638x speedup, step: 1
Epoch 182/200 |loss: 6.871593| train set 5.262x speedup, test set 0.789x speedup, val set 5.638x speedup, step: 1
Epoch 183/200 |loss: 6.864034| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 2
Epoch 184/200 |loss: 6.910958| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 3
Epoch 185/200 |loss: 6.944689| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 186/200 |loss: 6.888484| train set 5.222x speedup, test set 0.793x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.879761| train set 5.262x speedup, test set 0.793x speedup, val set 5.638x speedup, step: 1
Epoch 188/200 |loss: 6.830927| train set 5.263x speedup, test set 0.793x speedup, val set 5.539x speedup, step: 2
Epoch 189/200 |loss: 6.874616| train set 5.263x speedup, test set 0.793x speedup, val set 5.539x speedup, step: 3
Epoch 190/200 |loss: 6.877715| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 4
Epoch 191/200 |loss: 6.853648| train set 5.262x speedup, test set 0.789x speedup, val set 5.638x speedup, step: 1
Epoch 192/200 |loss: 6.916568| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 193/200 |loss: 6.878481| train set 5.263x speedup, test set 0.780x speedup, val set 5.539x speedup, step: 2
Epoch 194/200 |loss: 6.972011| train set 5.262x speedup, test set 0.793x speedup, val set 5.638x speedup, step: 1
Epoch 195/200 |loss: 6.912279| train set 5.263x speedup, test set 0.793x speedup, val set 5.539x speedup, step: 2
Epoch 196/200 |loss: 6.903371| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 197/200 |loss: 6.848693| train set 5.262x speedup, test set 0.789x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 6.913178| train set 5.263x speedup, test set 0.793x speedup, val set 5.539x speedup, step: 2
Epoch 199/200 |loss: 6.930454| train set 5.262x speedup, test set 0.781x speedup, val set 5.638x speedup, step: 1
Training per epoch cost 0.225 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.675s, pg runtime 1.680s, speedup 1.003x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 50.837s, pg runtime 13.945s, speedup 0.274x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.715s, pg runtime 0.354s, speedup 0.495x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 4.846s, pg runtime 4.730s, speedup 0.976x
22, opt runtime 0.093s, model runtime 3.047s, pg runtime 2.389s, speedup 0.784x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 40, train speedup 5.267, test speedup 1.112, val speedup 5.637
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 199, train speedup 5.262, test speedup 0.781, val speedup 5.638
last model at epoch 199, train speedup 5.262, test speedup 0.781, val speedup 5.638
execution cost 0:02:22.391812
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.852172, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963154| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563328| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087482| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642033| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135204| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629988| train set 4.166x speedup, test set 0.973x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.116011| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.593994| train set 4.401x speedup, test set 0.859x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.063534| train set 4.388x speedup, test set 0.794x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.591368| train set 4.401x speedup, test set 0.862x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.149645| train set 4.463x speedup, test set 1.099x speedup, val set 4.640x speedup, step: 18
Epoch 18/200 |loss: 15.731858| train set 4.613x speedup, test set 0.867x speedup, val set 4.852x speedup, step: 19
Epoch 19/200 |loss: 15.341889| train set 4.447x speedup, test set 0.864x speedup, val set 4.623x speedup, step: 20
Epoch 20/200 |loss: 14.874122| train set 4.640x speedup, test set 0.858x speedup, val set 4.927x speedup, step: 21
Epoch 21/200 |loss: 14.457945| train set 4.825x speedup, test set 0.868x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.067558| train set 4.825x speedup, test set 0.897x speedup, val set 5.077x speedup, step: 23
Epoch 23/200 |loss: 13.723135| train set 4.551x speedup, test set 0.850x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.361244| train set 5.058x speedup, test set 1.198x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.150887| train set 4.885x speedup, test set 1.284x speedup, val set 5.141x speedup, step: 26
Epoch 26/200 |loss: 13.453950| train set 5.058x speedup, test set 0.866x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.592227| train set 5.079x speedup, test set 1.165x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.378214| train set 5.079x speedup, test set 1.150x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.274248| train set 5.079x speedup, test set 1.119x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.692495| train set 5.263x speedup, test set 1.142x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.726904| train set 5.263x speedup, test set 1.144x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.270302| train set 5.263x speedup, test set 1.167x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 10.866080| train set 5.263x speedup, test set 1.168x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.964130| train set 5.262x speedup, test set 1.108x speedup, val set 5.638x speedup, step: 35
Epoch 35/200 |loss: 10.380776| train set 5.263x speedup, test set 1.095x speedup, val set 5.540x speedup, step: 36
Epoch 36/200 |loss: 10.430509| train set 5.263x speedup, test set 1.168x speedup, val set 5.540x speedup, step: 37
Epoch 37/200 |loss: 10.354481| train set 5.262x speedup, test set 1.074x speedup, val set 5.637x speedup, step: 38
Epoch 38/200 |loss: 10.012841| train set 5.264x speedup, test set 1.141x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 9.911065| train set 5.262x speedup, test set 1.123x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 9.851734| train set 5.264x speedup, test set 1.144x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 10.191332| train set 5.262x speedup, test set 0.859x speedup, val set 5.637x speedup, step: 42
Epoch 42/200 |loss: 10.090714| train set 5.264x speedup, test set 1.155x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 9.600515| train set 5.264x speedup, test set 1.161x speedup, val set 5.539x speedup, step: 44
Epoch 44/200 |loss: 9.533336| train set 5.262x speedup, test set 1.118x speedup, val set 5.637x speedup, step: 45
Epoch 45/200 |loss: 9.627684| train set 5.264x speedup, test set 1.125x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.122692| train set 5.264x speedup, test set 1.120x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 9.305404| train set 5.264x speedup, test set 1.130x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 9.296908| train set 5.262x speedup, test set 0.879x speedup, val set 5.637x speedup, step: 49
Epoch 49/200 |loss: 9.141747| train set 5.264x speedup, test set 1.019x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 9.435521| train set 5.264x speedup, test set 1.103x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.828219| train set 5.262x speedup, test set 1.089x speedup, val set 5.637x speedup, step: 52
Epoch 52/200 |loss: 9.325281| train set 5.263x speedup, test set 1.137x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.826913| train set 5.263x speedup, test set 1.112x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.785716| train set 5.262x speedup, test set 0.851x speedup, val set 5.638x speedup, step: 55
Epoch 55/200 |loss: 8.763731| train set 5.264x speedup, test set 1.153x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.649573| train set 5.264x speedup, test set 1.154x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.408895| train set 5.262x speedup, test set 0.848x speedup, val set 5.637x speedup, step: 58
Epoch 58/200 |loss: 8.422443| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.461814| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.208074| train set 5.262x speedup, test set 0.847x speedup, val set 5.637x speedup, step: 61
Epoch 61/200 |loss: 8.249399| train set 5.264x speedup, test set 1.027x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.325506| train set 5.262x speedup, test set 0.852x speedup, val set 5.637x speedup, step: 63
Epoch 63/200 |loss: 8.134500| train set 5.262x speedup, test set 0.852x speedup, val set 5.638x speedup, step: 64
Epoch 64/200 |loss: 7.900790| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 7.981335| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 7.952158| train set 5.263x speedup, test set 0.846x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 7.871418| train set 5.262x speedup, test set 0.852x speedup, val set 5.638x speedup, step: 68
Epoch 68/200 |loss: 7.737506| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 7.703867| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 7.622355| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 7.692907| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 8.041329| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 73
Epoch 73/200 |loss: 7.744343| train set 5.263x speedup, test set 0.857x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 7.720316| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.669063| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.896861| train set 5.263x speedup, test set 0.857x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 8.396582| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.843143| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.784634| train set 5.263x speedup, test set 0.891x speedup, val set 5.540x speedup, step: 80
Epoch 80/200 |loss: 7.873415| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.847178| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 82
Epoch 82/200 |loss: 7.812362| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.637152| train set 5.179x speedup, test set 0.842x speedup, val set 5.679x speedup, step: 84
Epoch 84/200 |loss: 7.892535| train set 5.263x speedup, test set 0.857x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 7.753034| train set 5.262x speedup, test set 0.855x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.607556| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.458942| train set 5.263x speedup, test set 0.857x speedup, val set 5.539x speedup, step: 88
Epoch 88/200 |loss: 7.581379| train set 5.263x speedup, test set 0.857x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 7.510509| train set 5.262x speedup, test set 0.861x speedup, val set 5.638x speedup, step: 90
Epoch 90/200 |loss: 7.539649| train set 5.263x speedup, test set 0.857x speedup, val set 5.539x speedup, step: 91
Epoch 91/200 |loss: 7.978893| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.512013| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 93
Epoch 93/200 |loss: 7.332744| train set 5.263x speedup, test set 0.857x speedup, val set 5.539x speedup, step: 94
Epoch 94/200 |loss: 7.340272| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.433881| train set 5.263x speedup, test set 0.813x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.570904| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 7.370568| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.230259| train set 5.262x speedup, test set 0.857x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.254504| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.360420| train set 5.263x speedup, test set 0.813x speedup, val set 5.539x speedup, step: 1
Epoch 101/200 |loss: 7.426828| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.274067| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.124591| train set 5.263x speedup, test set 0.839x speedup, val set 5.539x speedup, step: 2
Epoch 104/200 |loss: 7.226740| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 3
Epoch 105/200 |loss: 7.286766| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 4
Epoch 106/200 |loss: 7.339558| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 7.269718| train set 5.263x speedup, test set 0.829x speedup, val set 5.539x speedup, step: 2
Epoch 108/200 |loss: 7.245237| train set 5.262x speedup, test set 0.842x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.363488| train set 5.263x speedup, test set 0.829x speedup, val set 5.539x speedup, step: 2
Epoch 110/200 |loss: 7.235650| train set 5.263x speedup, test set 0.842x speedup, val set 5.570x speedup, step: 3
Epoch 111/200 |loss: 7.080337| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 4
Epoch 112/200 |loss: 7.078452| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 5
Epoch 113/200 |loss: 7.097129| train set 5.262x speedup, test set 0.816x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.181804| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 115/200 |loss: 7.231364| train set 5.262x speedup, test set 0.855x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.165715| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 117/200 |loss: 7.301852| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.178004| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 119/200 |loss: 7.150723| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 120/200 |loss: 7.051258| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 121/200 |loss: 7.168266| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 122/200 |loss: 7.344591| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 123/200 |loss: 7.057336| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 124/200 |loss: 7.118335| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 125/200 |loss: 7.232091| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 126/200 |loss: 7.206199| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 127/200 |loss: 7.192832| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 128/200 |loss: 7.130852| train set 5.262x speedup, test set 0.843x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.201098| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 130/200 |loss: 7.097457| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.191432| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 132/200 |loss: 7.069643| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 133/200 |loss: 7.056939| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 6.953133| train set 5.263x speedup, test set 0.847x speedup, val set 5.539x speedup, step: 2
Epoch 135/200 |loss: 7.022884| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 6.998975| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 2
Epoch 137/200 |loss: 6.964473| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 138/200 |loss: 6.952225| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 6.957460| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 2
Epoch 140/200 |loss: 6.959757| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 6.952334| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 142/200 |loss: 6.952499| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 2
Epoch 143/200 |loss: 7.063543| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 144/200 |loss: 7.170610| train set 5.263x speedup, test set 0.839x speedup, val set 5.539x speedup, step: 2
Epoch 145/200 |loss: 7.529838| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 6.993279| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 147/200 |loss: 7.260979| train set 5.263x speedup, test set 0.839x speedup, val set 5.539x speedup, step: 2
Epoch 148/200 |loss: 7.701798| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 7.201955| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 150/200 |loss: 7.604771| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 2
Epoch 151/200 |loss: 7.520692| train set 5.262x speedup, test set 0.839x speedup, val set 5.638x speedup, step: 1
Epoch 152/200 |loss: 7.290718| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 7.437291| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 2
Epoch 154/200 |loss: 7.384754| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 155/200 |loss: 7.167094| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 156/200 |loss: 7.283942| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 157/200 |loss: 7.117612| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 3
Epoch 158/200 |loss: 7.193157| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 159/200 |loss: 7.050033| train set 5.262x speedup, test set 0.796x speedup, val set 5.638x speedup, step: 1
Epoch 160/200 |loss: 7.110607| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 161/200 |loss: 7.033807| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 3
Epoch 162/200 |loss: 7.048505| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 163/200 |loss: 6.975355| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 164/200 |loss: 7.032875| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 165/200 |loss: 6.922502| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 3
Epoch 166/200 |loss: 6.988703| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 4
Epoch 167/200 |loss: 6.925234| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 168/200 |loss: 6.947779| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 169/200 |loss: 6.923100| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 170/200 |loss: 6.968924| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 171/200 |loss: 6.995193| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 172/200 |loss: 7.120389| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 3
Epoch 173/200 |loss: 7.665340| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 4
Epoch 174/200 |loss: 7.136817| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 175/200 |loss: 7.045066| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 176/200 |loss: 7.294890| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 7.065629| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 178/200 |loss: 7.050774| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 179/200 |loss: 7.071503| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 7.023867| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 181/200 |loss: 7.063062| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 182/200 |loss: 6.966136| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 183/200 |loss: 6.953182| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 184/200 |loss: 7.077171| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 185/200 |loss: 6.914680| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 186/200 |loss: 6.962290| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 7.051010| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 188/200 |loss: 6.957557| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 189/200 |loss: 6.895281| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 190/200 |loss: 6.943683| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 4
Epoch 191/200 |loss: 6.879464| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 5
Epoch 192/200 |loss: 6.941849| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 193/200 |loss: 6.898024| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 194/200 |loss: 6.892490| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 195/200 |loss: 6.829476| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 196/200 |loss: 6.850404| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 197/200 |loss: 6.853202| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 198/200 |loss: 6.853307| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 4
Epoch 199/200 |loss: 6.936481| train set 5.262x speedup, test set 0.813x speedup, val set 5.638x speedup, step: 1
Training per epoch cost 0.233 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 50.837s, pg runtime 13.945s, speedup 0.274x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.354s, pg runtime 0.354s, speedup 1.000x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 38, train speedup 5.264, test speedup 1.141, val speedup 5.539
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 199, train speedup 5.262, test speedup 0.813, val speedup 5.638
last model at epoch 199, train speedup 5.262, test speedup 0.813, val speedup 5.638
execution cost 0:02:22.975767
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.919463, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442947| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563328| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087481| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613005| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114954| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642033| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135202| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629986| train set 4.166x speedup, test set 0.973x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.116009| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.593994| train set 4.401x speedup, test set 0.859x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.063532| train set 4.388x speedup, test set 0.794x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.591364| train set 4.401x speedup, test set 0.862x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.149641| train set 4.463x speedup, test set 1.099x speedup, val set 4.640x speedup, step: 18
Epoch 18/200 |loss: 15.731857| train set 4.613x speedup, test set 0.867x speedup, val set 4.852x speedup, step: 19
Epoch 19/200 |loss: 15.341886| train set 4.447x speedup, test set 0.864x speedup, val set 4.623x speedup, step: 20
Epoch 20/200 |loss: 14.874207| train set 4.640x speedup, test set 0.858x speedup, val set 4.927x speedup, step: 21
Epoch 21/200 |loss: 14.458358| train set 4.825x speedup, test set 0.868x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.068156| train set 4.825x speedup, test set 0.897x speedup, val set 5.077x speedup, step: 23
Epoch 23/200 |loss: 13.723843| train set 4.551x speedup, test set 0.850x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.360319| train set 5.058x speedup, test set 1.198x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.187403| train set 4.885x speedup, test set 1.284x speedup, val set 5.141x speedup, step: 26
Epoch 26/200 |loss: 13.460941| train set 5.058x speedup, test set 0.879x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.564541| train set 5.079x speedup, test set 1.154x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.480434| train set 5.079x speedup, test set 1.140x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.209392| train set 5.079x speedup, test set 1.120x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.704763| train set 5.263x speedup, test set 1.152x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.745593| train set 5.263x speedup, test set 1.145x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.179963| train set 5.262x speedup, test set 1.141x speedup, val set 5.638x speedup, step: 33
Epoch 33/200 |loss: 10.977135| train set 5.262x speedup, test set 1.177x speedup, val set 5.638x speedup, step: 34
Epoch 34/200 |loss: 10.895767| train set 5.262x speedup, test set 1.119x speedup, val set 5.638x speedup, step: 35
Epoch 35/200 |loss: 10.355048| train set 5.263x speedup, test set 1.145x speedup, val set 5.540x speedup, step: 36
Epoch 36/200 |loss: 10.456880| train set 5.264x speedup, test set 1.122x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.278123| train set 5.264x speedup, test set 1.168x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.114466| train set 5.262x speedup, test set 1.113x speedup, val set 5.637x speedup, step: 39
Epoch 39/200 |loss: 9.792331| train set 5.264x speedup, test set 1.278x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 9.747952| train set 5.262x speedup, test set 1.129x speedup, val set 5.637x speedup, step: 41
Epoch 41/200 |loss: 10.004926| train set 5.264x speedup, test set 1.156x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 10.264982| train set 5.264x speedup, test set 1.110x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 9.486674| train set 5.262x speedup, test set 1.085x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.713357| train set 5.264x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.596151| train set 5.264x speedup, test set 1.120x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.325723| train set 5.262x speedup, test set 1.119x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.155540| train set 5.262x speedup, test set 1.157x speedup, val set 5.637x speedup, step: 48
Epoch 48/200 |loss: 9.262183| train set 5.262x speedup, test set 1.124x speedup, val set 5.637x speedup, step: 49
Epoch 49/200 |loss: 8.846194| train set 5.262x speedup, test set 0.871x speedup, val set 5.637x speedup, step: 50
Epoch 50/200 |loss: 8.835368| train set 5.262x speedup, test set 1.164x speedup, val set 5.637x speedup, step: 51
Epoch 51/200 |loss: 8.787102| train set 5.262x speedup, test set 1.079x speedup, val set 5.637x speedup, step: 52
Epoch 52/200 |loss: 8.582023| train set 5.262x speedup, test set 1.101x speedup, val set 5.637x speedup, step: 53
Epoch 53/200 |loss: 8.504856| train set 5.264x speedup, test set 1.081x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.444915| train set 5.262x speedup, test set 1.078x speedup, val set 5.637x speedup, step: 55
Epoch 55/200 |loss: 8.192471| train set 5.263x speedup, test set 1.078x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.321756| train set 5.264x speedup, test set 0.846x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.158778| train set 5.263x speedup, test set 1.075x speedup, val set 5.539x speedup, step: 58
Epoch 58/200 |loss: 8.168489| train set 5.263x speedup, test set 0.851x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.103156| train set 5.263x speedup, test set 1.100x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.234248| train set 5.264x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 9.154448| train set 5.263x speedup, test set 1.014x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 9.777233| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 63
Epoch 63/200 |loss: 8.196774| train set 5.264x speedup, test set 0.865x speedup, val set 5.539x speedup, step: 64
Epoch 64/200 |loss: 9.541448| train set 5.263x speedup, test set 1.108x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 8.486958| train set 5.262x speedup, test set 1.056x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 8.842762| train set 5.263x speedup, test set 0.846x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 8.441279| train set 5.262x speedup, test set 0.846x speedup, val set 5.638x speedup, step: 68
Epoch 68/200 |loss: 8.333010| train set 5.054x speedup, test set 0.881x speedup, val set 5.454x speedup, step: 69
Epoch 69/200 |loss: 8.234617| train set 5.262x speedup, test set 1.081x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 8.182760| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 8.165167| train set 5.263x speedup, test set 0.857x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 7.898809| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 8.019239| train set 5.263x speedup, test set 0.840x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 7.764053| train set 5.263x speedup, test set 0.857x speedup, val set 5.539x speedup, step: 75
Epoch 75/200 |loss: 7.810084| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.779779| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 7.745023| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.798280| train set 5.263x speedup, test set 0.830x speedup, val set 5.539x speedup, step: 79
Epoch 79/200 |loss: 7.682574| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 80
Epoch 80/200 |loss: 7.643118| train set 5.263x speedup, test set 1.050x speedup, val set 5.539x speedup, step: 81
Epoch 81/200 |loss: 7.677784| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.527273| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 83
Epoch 83/200 |loss: 7.627858| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 84
Epoch 84/200 |loss: 7.427996| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 7.425961| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 86
Epoch 86/200 |loss: 7.360073| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 87
Epoch 87/200 |loss: 7.346626| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.377037| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 7.508523| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 90
Epoch 90/200 |loss: 7.380961| train set 5.263x speedup, test set 0.830x speedup, val set 5.539x speedup, step: 91
Epoch 91/200 |loss: 7.462830| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.369770| train set 5.263x speedup, test set 0.830x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 7.257642| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 7.156726| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 95
Epoch 95/200 |loss: 7.172482| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.154803| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 7.235004| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.524098| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.390113| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 100
Epoch 100/200 |loss: 7.255810| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.101531| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.111383| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 103/200 |loss: 7.102426| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.162696| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 105/200 |loss: 7.377254| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 106/200 |loss: 7.151923| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 7.052342| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 108/200 |loss: 7.135902| train set 5.262x speedup, test set 0.806x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.224675| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 110/200 |loss: 7.411520| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.139125| train set 5.262x speedup, test set 0.833x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.339679| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 2
Epoch 113/200 |loss: 7.725757| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.573216| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 115/200 |loss: 7.941963| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 116/200 |loss: 7.812650| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.778582| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.742347| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 119/200 |loss: 7.615514| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 120/200 |loss: 7.595789| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 121/200 |loss: 7.374314| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 122/200 |loss: 7.539979| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 123/200 |loss: 7.261523| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 124/200 |loss: 7.340187| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 125/200 |loss: 7.252176| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 126/200 |loss: 7.289452| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 127/200 |loss: 7.157229| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 4
Epoch 128/200 |loss: 7.212131| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 5
Epoch 129/200 |loss: 7.098449| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 6
Epoch 130/200 |loss: 7.180666| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.053264| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.087995| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 133/200 |loss: 7.057002| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 134/200 |loss: 7.034299| train set 5.263x speedup, test set 0.799x speedup, val set 5.539x speedup, step: 3
Epoch 135/200 |loss: 7.015704| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 4
Epoch 136/200 |loss: 7.051988| train set 5.262x speedup, test set 0.799x speedup, val set 5.638x speedup, step: 1
Epoch 137/200 |loss: 7.011608| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 138/200 |loss: 7.063152| train set 5.262x speedup, test set 0.800x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 7.105394| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 140/200 |loss: 7.303634| train set 5.262x speedup, test set 0.803x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 7.130425| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 142/200 |loss: 7.008969| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 3
Epoch 143/200 |loss: 6.975482| train set 5.262x speedup, test set 0.803x speedup, val set 5.638x speedup, step: 1
Epoch 144/200 |loss: 6.966581| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 145/200 |loss: 7.044206| train set 5.262x speedup, test set 0.794x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 6.958839| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 2
Epoch 147/200 |loss: 6.962931| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 3
Epoch 148/200 |loss: 7.009261| train set 5.262x speedup, test set 0.792x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 7.045197| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 150/200 |loss: 7.022782| train set 5.262x speedup, test set 0.794x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 6.911264| train set 5.262x speedup, test set 0.792x speedup, val set 5.638x speedup, step: 1
Epoch 152/200 |loss: 6.930799| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 153/200 |loss: 6.997056| train set 5.262x speedup, test set 0.794x speedup, val set 5.638x speedup, step: 1
Epoch 154/200 |loss: 6.950260| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 2
Epoch 155/200 |loss: 6.900286| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 3
Epoch 156/200 |loss: 6.906353| train set 5.267x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 1
Epoch 157/200 |loss: 6.899702| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 158/200 |loss: 7.016053| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 1
Epoch 159/200 |loss: 7.064494| train set 5.262x speedup, test set 0.794x speedup, val set 5.638x speedup, step: 1
Epoch 160/200 |loss: 7.501184| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 7.060504| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 6.927193| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 3
Epoch 163/200 |loss: 7.050194| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 1
Epoch 164/200 |loss: 7.100842| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 2
Epoch 165/200 |loss: 7.086348| train set 5.262x speedup, test set 0.806x speedup, val set 5.638x speedup, step: 1
Epoch 166/200 |loss: 6.972095| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 6.976137| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 168/200 |loss: 7.068752| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 169/200 |loss: 6.956658| train set 5.263x speedup, test set 0.805x speedup, val set 5.539x speedup, step: 2
Epoch 170/200 |loss: 6.972826| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 171/200 |loss: 6.973654| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 172/200 |loss: 6.881160| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 173/200 |loss: 6.897586| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 174/200 |loss: 6.929155| train set 5.263x speedup, test set 0.805x speedup, val set 5.539x speedup, step: 3
Epoch 175/200 |loss: 6.914934| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 176/200 |loss: 6.882356| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 2
Epoch 177/200 |loss: 6.867978| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 178/200 |loss: 6.860863| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 179/200 |loss: 6.867463| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 180/200 |loss: 6.871491| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 3
Epoch 181/200 |loss: 6.913122| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 182/200 |loss: 6.927363| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 2
Epoch 183/200 |loss: 7.155310| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 184/200 |loss: 7.008892| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 2
Epoch 185/200 |loss: 6.990440| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 186/200 |loss: 6.856389| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.853709| train set 5.263x speedup, test set 0.792x speedup, val set 5.539x speedup, step: 2
Epoch 188/200 |loss: 6.918275| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 189/200 |loss: 6.865486| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 190/200 |loss: 6.823194| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 2
Epoch 191/200 |loss: 6.841832| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 192/200 |loss: 6.926128| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 193/200 |loss: 6.977234| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 194/200 |loss: 7.123689| train set 5.222x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 195/200 |loss: 6.999738| train set 5.263x speedup, test set 0.796x speedup, val set 5.539x speedup, step: 2
Epoch 196/200 |loss: 7.026886| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 197/200 |loss: 6.916691| train set 5.263x speedup, test set 0.796x speedup, val set 5.539x speedup, step: 2
Epoch 198/200 |loss: 7.015045| train set 5.262x speedup, test set 0.794x speedup, val set 5.638x speedup, step: 1
Epoch 199/200 |loss: 7.095120| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Training per epoch cost 0.231 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 50.837s, pg runtime 13.945s, speedup 0.274x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.715s, pg runtime 0.354s, speedup 0.495x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 156, train speedup 5.267, test speedup 0.808, val speedup 5.638
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 199, train speedup 5.262, test speedup 0.820, val speedup 5.638
last model at epoch 199, train speedup 5.262, test speedup 0.820, val speedup 5.638
execution cost 0:02:23.384608
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.930300, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449986| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442947| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563328| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087481| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613005| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114954| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642033| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135202| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629986| train set 4.166x speedup, test set 0.973x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.116009| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.593994| train set 4.401x speedup, test set 0.859x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.063532| train set 4.388x speedup, test set 0.794x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.591364| train set 4.401x speedup, test set 0.862x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.149641| train set 4.463x speedup, test set 1.099x speedup, val set 4.640x speedup, step: 18
Epoch 18/200 |loss: 15.731856| train set 4.613x speedup, test set 0.867x speedup, val set 4.852x speedup, step: 19
Epoch 19/200 |loss: 15.341886| train set 4.447x speedup, test set 0.864x speedup, val set 4.623x speedup, step: 20
Epoch 20/200 |loss: 14.874207| train set 4.640x speedup, test set 0.858x speedup, val set 4.927x speedup, step: 21
Epoch 21/200 |loss: 14.458358| train set 4.825x speedup, test set 0.868x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.068156| train set 4.825x speedup, test set 0.897x speedup, val set 5.077x speedup, step: 23
Epoch 23/200 |loss: 13.723843| train set 4.551x speedup, test set 0.850x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.360317| train set 5.058x speedup, test set 1.198x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.187399| train set 4.885x speedup, test set 1.284x speedup, val set 5.141x speedup, step: 26
Epoch 26/200 |loss: 13.460942| train set 5.058x speedup, test set 0.879x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.564544| train set 5.079x speedup, test set 1.154x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.480429| train set 5.079x speedup, test set 1.140x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.209397| train set 5.079x speedup, test set 1.120x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.704760| train set 5.263x speedup, test set 1.152x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.745596| train set 5.263x speedup, test set 1.145x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.179965| train set 5.262x speedup, test set 1.141x speedup, val set 5.638x speedup, step: 33
Epoch 33/200 |loss: 10.977135| train set 5.262x speedup, test set 1.177x speedup, val set 5.638x speedup, step: 34
Epoch 34/200 |loss: 10.895771| train set 5.262x speedup, test set 1.119x speedup, val set 5.638x speedup, step: 35
Epoch 35/200 |loss: 10.355048| train set 5.263x speedup, test set 1.145x speedup, val set 5.540x speedup, step: 36
Epoch 36/200 |loss: 10.456882| train set 5.264x speedup, test set 1.122x speedup, val set 5.539x speedup, step: 37
Epoch 37/200 |loss: 10.278121| train set 5.264x speedup, test set 1.168x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.114431| train set 5.262x speedup, test set 1.113x speedup, val set 5.637x speedup, step: 39
Epoch 39/200 |loss: 9.792715| train set 5.264x speedup, test set 1.278x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 9.749388| train set 5.262x speedup, test set 1.129x speedup, val set 5.637x speedup, step: 41
Epoch 41/200 |loss: 10.010383| train set 5.264x speedup, test set 1.156x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 10.264826| train set 5.264x speedup, test set 1.110x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 9.473432| train set 5.262x speedup, test set 1.085x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.728024| train set 5.264x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.606721| train set 5.264x speedup, test set 1.120x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.331838| train set 5.262x speedup, test set 1.120x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.184211| train set 5.262x speedup, test set 1.158x speedup, val set 5.637x speedup, step: 48
Epoch 48/200 |loss: 9.237733| train set 5.262x speedup, test set 1.125x speedup, val set 5.637x speedup, step: 49
Epoch 49/200 |loss: 8.861933| train set 5.262x speedup, test set 0.871x speedup, val set 5.637x speedup, step: 50
Epoch 50/200 |loss: 8.823443| train set 5.262x speedup, test set 1.168x speedup, val set 5.637x speedup, step: 51
Epoch 51/200 |loss: 8.772534| train set 5.262x speedup, test set 1.111x speedup, val set 5.637x speedup, step: 52
Epoch 52/200 |loss: 8.551418| train set 5.262x speedup, test set 1.102x speedup, val set 5.637x speedup, step: 53
Epoch 53/200 |loss: 8.487486| train set 5.264x speedup, test set 1.079x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.437881| train set 5.264x speedup, test set 1.078x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.290763| train set 5.264x speedup, test set 0.849x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.342775| train set 5.264x speedup, test set 1.070x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.428312| train set 5.264x speedup, test set 0.849x speedup, val set 5.539x speedup, step: 58
Epoch 58/200 |loss: 8.822362| train set 5.263x speedup, test set 1.119x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 9.129206| train set 5.216x speedup, test set 0.852x speedup, val set 5.467x speedup, step: 60
Epoch 60/200 |loss: 8.575557| train set 5.264x speedup, test set 1.090x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 9.082922| train set 5.264x speedup, test set 1.108x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.914454| train set 5.262x speedup, test set 0.838x speedup, val set 5.638x speedup, step: 63
Epoch 63/200 |loss: 8.339699| train set 5.262x speedup, test set 0.819x speedup, val set 5.638x speedup, step: 64
Epoch 64/200 |loss: 8.784014| train set 5.262x speedup, test set 1.101x speedup, val set 5.638x speedup, step: 65
Epoch 65/200 |loss: 8.236811| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 8.415430| train set 5.263x speedup, test set 1.028x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 8.565243| train set 5.263x speedup, test set 0.846x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 8.150433| train set 5.262x speedup, test set 0.838x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 8.379477| train set 5.263x speedup, test set 1.151x speedup, val set 5.539x speedup, step: 70
Epoch 70/200 |loss: 8.066487| train set 5.262x speedup, test set 1.095x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 8.072869| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 72
Epoch 72/200 |loss: 7.969481| train set 5.263x speedup, test set 0.830x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 7.900287| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 74
Epoch 74/200 |loss: 7.789811| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.828314| train set 5.262x speedup, test set 0.830x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.769588| train set 5.262x speedup, test set 0.830x speedup, val set 5.638x speedup, step: 77
Epoch 77/200 |loss: 7.615783| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.664990| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 79
Epoch 79/200 |loss: 7.725437| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 7.473615| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.603886| train set 5.263x speedup, test set 1.050x speedup, val set 5.539x speedup, step: 82
Epoch 82/200 |loss: 7.831216| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.507576| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 84
Epoch 84/200 |loss: 7.495396| train set 5.263x speedup, test set 1.050x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 7.752846| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.555500| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.398244| train set 5.263x speedup, test set 0.830x speedup, val set 5.539x speedup, step: 88
Epoch 88/200 |loss: 7.490695| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 89
Epoch 89/200 |loss: 7.472004| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.272635| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.263206| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.327407| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 7.410121| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 7.323864| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.178277| train set 5.263x speedup, test set 0.829x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.153387| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 7.177097| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.287858| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.167696| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 100
Epoch 100/200 |loss: 7.162992| train set 5.262x speedup, test set 0.857x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.079065| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.088747| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.074279| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.058409| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 2
Epoch 105/200 |loss: 7.086631| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 3
Epoch 106/200 |loss: 7.289594| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 4
Epoch 107/200 |loss: 7.395135| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 5
Epoch 108/200 |loss: 7.674700| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.282471| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 2
Epoch 110/200 |loss: 7.799258| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.635053| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.529057| train set 5.263x speedup, test set 0.829x speedup, val set 5.539x speedup, step: 2
Epoch 113/200 |loss: 7.483150| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.689495| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 115/200 |loss: 7.368470| train set 5.263x speedup, test set 0.829x speedup, val set 5.539x speedup, step: 2
Epoch 116/200 |loss: 7.385898| train set 5.262x speedup, test set 0.831x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.444078| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.157533| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 119/200 |loss: 7.370103| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 120/200 |loss: 7.186911| train set 5.263x speedup, test set 0.813x speedup, val set 5.539x speedup, step: 2
Epoch 121/200 |loss: 7.371119| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 122/200 |loss: 7.266021| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 123/200 |loss: 7.399563| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 124/200 |loss: 7.177300| train set 5.263x speedup, test set 0.856x speedup, val set 5.539x speedup, step: 2
Epoch 125/200 |loss: 7.147773| train set 5.262x speedup, test set 0.816x speedup, val set 5.638x speedup, step: 1
Epoch 126/200 |loss: 7.219921| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.178065| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 2
Epoch 128/200 |loss: 7.257005| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 3
Epoch 129/200 |loss: 7.086856| train set 5.263x speedup, test set 0.847x speedup, val set 5.539x speedup, step: 4
Epoch 130/200 |loss: 7.110678| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 5
Epoch 131/200 |loss: 7.233642| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.067652| train set 5.263x speedup, test set 0.847x speedup, val set 5.539x speedup, step: 2
Epoch 133/200 |loss: 7.076986| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 134/200 |loss: 7.262550| train set 5.263x speedup, test set 0.847x speedup, val set 5.570x speedup, step: 4
Epoch 135/200 |loss: 7.026340| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 7.104737| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 137/200 |loss: 7.132124| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 138/200 |loss: 7.063801| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 7.236879| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 2
Epoch 140/200 |loss: 7.047931| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 7.098720| train set 5.262x speedup, test set 0.816x speedup, val set 5.638x speedup, step: 1
Epoch 142/200 |loss: 7.389411| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 143/200 |loss: 6.955891| train set 5.263x speedup, test set 0.847x speedup, val set 5.539x speedup, step: 2
Epoch 144/200 |loss: 7.352535| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 3
Epoch 145/200 |loss: 7.508687| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 7.297121| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 2
Epoch 147/200 |loss: 7.606809| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 3
Epoch 148/200 |loss: 7.035115| train set 5.262x speedup, test set 0.849x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 7.634647| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 2
Epoch 150/200 |loss: 7.522717| train set 5.263x speedup, test set 0.828x speedup, val set 5.539x speedup, step: 3
Epoch 151/200 |loss: 7.535218| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 152/200 |loss: 7.382814| train set 5.262x speedup, test set 0.816x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 7.312063| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 2
Epoch 154/200 |loss: 7.279388| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 3
Epoch 155/200 |loss: 7.217739| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 4
Epoch 156/200 |loss: 7.249901| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 1
Epoch 157/200 |loss: 7.164402| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 158/200 |loss: 7.191144| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 2
Epoch 159/200 |loss: 7.058109| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 160/200 |loss: 7.156349| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 7.023731| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 7.077378| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 3
Epoch 163/200 |loss: 6.988426| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 4
Epoch 164/200 |loss: 7.021166| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 165/200 |loss: 7.003549| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 166/200 |loss: 6.985904| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 6.989643| train set 5.262x speedup, test set 0.815x speedup, val set 5.638x speedup, step: 1
Epoch 168/200 |loss: 6.935318| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 2
Epoch 169/200 |loss: 6.950833| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 3
Epoch 170/200 |loss: 6.921196| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 4
Epoch 171/200 |loss: 6.940477| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 172/200 |loss: 6.989193| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 173/200 |loss: 6.996400| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 174/200 |loss: 7.095427| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 3
Epoch 175/200 |loss: 6.956948| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 4
Epoch 176/200 |loss: 6.897376| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 6.876657| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 178/200 |loss: 6.878060| train set 5.263x speedup, test set 0.814x speedup, val set 5.539x speedup, step: 2
Epoch 179/200 |loss: 6.939675| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 6.927381| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 181/200 |loss: 6.922284| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 182/200 |loss: 6.868614| train set 5.267x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 183/200 |loss: 6.830990| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 184/200 |loss: 6.842720| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 185/200 |loss: 6.868764| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 186/200 |loss: 6.965874| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.928452| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 188/200 |loss: 6.922646| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 3
Epoch 189/200 |loss: 6.823221| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 4
Epoch 190/200 |loss: 6.822878| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 5
Epoch 191/200 |loss: 6.862648| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 192/200 |loss: 6.913679| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 193/200 |loss: 7.095988| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 194/200 |loss: 6.877176| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 2
Epoch 195/200 |loss: 6.848730| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 196/200 |loss: 6.932047| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 197/200 |loss: 6.982203| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 7.102417| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 199/200 |loss: 6.881785| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Training per epoch cost 0.226 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.675s, pg runtime 1.680s, speedup 1.003x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.733s, pg runtime 0.354s, speedup 0.482x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.433s, pg runtime 0.389s, speedup 0.898x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 182, train speedup 5.267, test speedup 0.821, val speedup 5.638
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 198, train speedup 5.262, test speedup 0.826, val speedup 5.638
last model at epoch 199, train speedup 5.263, test speedup 0.821, val speedup 5.539
execution cost 0:02:23.749382
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.856795, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963154| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563330| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087482| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642033| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135206| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629990| train set 4.166x speedup, test set 0.973x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.116011| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.593994| train set 4.401x speedup, test set 0.859x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.063536| train set 4.388x speedup, test set 0.794x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.591368| train set 4.401x speedup, test set 0.862x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.149645| train set 4.463x speedup, test set 1.099x speedup, val set 4.640x speedup, step: 18
Epoch 18/200 |loss: 15.731859| train set 4.613x speedup, test set 0.867x speedup, val set 4.852x speedup, step: 19
Epoch 19/200 |loss: 15.341889| train set 4.447x speedup, test set 0.864x speedup, val set 4.623x speedup, step: 20
Epoch 20/200 |loss: 14.874223| train set 4.640x speedup, test set 0.858x speedup, val set 4.927x speedup, step: 21
Epoch 21/200 |loss: 14.457072| train set 4.825x speedup, test set 0.868x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.065010| train set 4.824x speedup, test set 0.897x speedup, val set 5.078x speedup, step: 23
Epoch 23/200 |loss: 13.724463| train set 4.551x speedup, test set 0.850x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.387545| train set 5.058x speedup, test set 0.908x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.245714| train set 4.835x speedup, test set 1.273x speedup, val set 5.140x speedup, step: 26
Epoch 26/200 |loss: 13.422874| train set 5.074x speedup, test set 0.876x speedup, val set 5.304x speedup, step: 27
Epoch 27/200 |loss: 12.553440| train set 5.079x speedup, test set 1.165x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.578540| train set 5.079x speedup, test set 1.129x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.254145| train set 5.079x speedup, test set 1.120x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.790788| train set 5.263x speedup, test set 1.152x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.771171| train set 5.263x speedup, test set 1.256x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.196290| train set 5.262x speedup, test set 1.129x speedup, val set 5.638x speedup, step: 33
Epoch 33/200 |loss: 11.126927| train set 5.263x speedup, test set 1.176x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.884541| train set 5.262x speedup, test set 1.122x speedup, val set 5.638x speedup, step: 35
Epoch 35/200 |loss: 10.530962| train set 5.263x speedup, test set 1.140x speedup, val set 5.540x speedup, step: 36
Epoch 36/200 |loss: 10.880547| train set 5.262x speedup, test set 1.123x speedup, val set 5.637x speedup, step: 37
Epoch 37/200 |loss: 10.169200| train set 5.264x speedup, test set 1.176x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.026557| train set 5.264x speedup, test set 1.141x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 9.960036| train set 5.264x speedup, test set 1.156x speedup, val set 5.539x speedup, step: 40
Epoch 40/200 |loss: 9.625350| train set 5.262x speedup, test set 1.129x speedup, val set 5.637x speedup, step: 41
Epoch 41/200 |loss: 9.584463| train set 5.264x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.847867| train set 5.189x speedup, test set 1.128x speedup, val set 5.563x speedup, step: 43
Epoch 43/200 |loss: 9.980435| train set 5.264x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 44
Epoch 44/200 |loss: 9.442869| train set 5.264x speedup, test set 1.117x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.543318| train set 5.264x speedup, test set 1.122x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.248343| train set 5.264x speedup, test set 1.117x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 9.030560| train set 5.262x speedup, test set 1.073x speedup, val set 5.637x speedup, step: 48
Epoch 48/200 |loss: 8.812049| train set 5.264x speedup, test set 1.116x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 9.081524| train set 5.262x speedup, test set 1.071x speedup, val set 5.637x speedup, step: 50
Epoch 50/200 |loss: 8.749578| train set 5.264x speedup, test set 1.118x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.547678| train set 5.262x speedup, test set 1.081x speedup, val set 5.637x speedup, step: 52
Epoch 52/200 |loss: 8.516606| train set 5.262x speedup, test set 1.053x speedup, val set 5.637x speedup, step: 53
Epoch 53/200 |loss: 8.623529| train set 5.264x speedup, test set 1.103x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.369380| train set 5.262x speedup, test set 0.876x speedup, val set 5.637x speedup, step: 55
Epoch 55/200 |loss: 8.362573| train set 5.263x speedup, test set 1.055x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.305496| train set 5.262x speedup, test set 1.118x speedup, val set 5.638x speedup, step: 57
Epoch 57/200 |loss: 8.358739| train set 5.263x speedup, test set 1.109x speedup, val set 5.539x speedup, step: 58
Epoch 58/200 |loss: 8.215413| train set 5.262x speedup, test set 1.100x speedup, val set 5.638x speedup, step: 59
Epoch 59/200 |loss: 8.047742| train set 5.263x speedup, test set 1.100x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.050872| train set 5.262x speedup, test set 0.868x speedup, val set 5.637x speedup, step: 61
Epoch 61/200 |loss: 8.660492| train set 5.263x speedup, test set 1.103x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 9.737434| train set 5.263x speedup, test set 0.839x speedup, val set 5.539x speedup, step: 63
Epoch 63/200 |loss: 8.723530| train set 5.262x speedup, test set 0.839x speedup, val set 5.638x speedup, step: 64
Epoch 64/200 |loss: 8.965863| train set 5.263x speedup, test set 1.136x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 8.801948| train set 5.262x speedup, test set 1.058x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 8.539173| train set 5.262x speedup, test set 0.868x speedup, val set 5.638x speedup, step: 67
Epoch 67/200 |loss: 8.928348| train set 5.263x speedup, test set 1.112x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 8.600977| train set 5.263x speedup, test set 1.100x speedup, val set 5.539x speedup, step: 69
Epoch 69/200 |loss: 8.432814| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 8.430158| train set 5.262x speedup, test set 1.045x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 8.201132| train set 5.162x speedup, test set 1.063x speedup, val set 5.482x speedup, step: 72
Epoch 72/200 |loss: 8.206695| train set 5.262x speedup, test set 1.056x speedup, val set 5.638x speedup, step: 73
Epoch 73/200 |loss: 8.163894| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 7.946327| train set 5.262x speedup, test set 0.834x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.979794| train set 5.263x speedup, test set 1.069x speedup, val set 5.539x speedup, step: 76
Epoch 76/200 |loss: 7.885891| train set 5.263x speedup, test set 0.839x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 7.858092| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.721087| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.716805| train set 5.262x speedup, test set 0.839x speedup, val set 5.638x speedup, step: 80
Epoch 80/200 |loss: 7.686297| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.716366| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.773912| train set 5.263x speedup, test set 1.045x speedup, val set 5.539x speedup, step: 83
Epoch 83/200 |loss: 7.694854| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 7.637998| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 7.453090| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 86
Epoch 86/200 |loss: 7.448694| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.471466| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.539374| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 89
Epoch 89/200 |loss: 7.534860| train set 5.263x speedup, test set 0.834x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.451001| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.371425| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 92
Epoch 92/200 |loss: 7.267733| train set 5.263x speedup, test set 0.831x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 7.311800| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 7.384603| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.432618| train set 5.267x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 96
Epoch 96/200 |loss: 7.380378| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 97
Epoch 97/200 |loss: 7.193656| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.218694| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 99
Epoch 99/200 |loss: 7.218589| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 100
Epoch 100/200 |loss: 7.232294| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.516440| train set 5.263x speedup, test set 0.835x speedup, val set 5.539x speedup, step: 2
Epoch 102/200 |loss: 8.166213| train set 5.262x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.420238| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.856840| train set 5.263x speedup, test set 1.058x speedup, val set 5.539x speedup, step: 2
Epoch 105/200 |loss: 8.502942| train set 5.263x speedup, test set 0.836x speedup, val set 5.539x speedup, step: 3
Epoch 106/200 |loss: 7.700328| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 8.000759| train set 5.262x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.731049| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 2
Epoch 109/200 |loss: 7.588784| train set 5.256x speedup, test set 0.816x speedup, val set 5.638x speedup, step: 1
Epoch 110/200 |loss: 7.656952| train set 5.262x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.432975| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.559791| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 113/200 |loss: 7.337770| train set 5.262x speedup, test set 0.818x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.414699| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 115/200 |loss: 7.303194| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.278255| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.282305| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 2
Epoch 118/200 |loss: 7.188440| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 119/200 |loss: 7.186879| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 120/200 |loss: 7.188822| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 2
Epoch 121/200 |loss: 7.197585| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 122/200 |loss: 7.214902| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 123/200 |loss: 7.261955| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 124/200 |loss: 7.249135| train set 5.262x speedup, test set 0.818x speedup, val set 5.638x speedup, step: 1
Epoch 125/200 |loss: 7.236989| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 126/200 |loss: 7.280919| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 2
Epoch 127/200 |loss: 7.299503| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 128/200 |loss: 7.122637| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.074296| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 130/200 |loss: 7.120162| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.068482| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 132/200 |loss: 7.150164| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 133/200 |loss: 7.149655| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 7.007209| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 135/200 |loss: 6.982320| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 7.021574| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 137/200 |loss: 7.016139| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 138/200 |loss: 7.016537| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 139/200 |loss: 7.033382| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 140/200 |loss: 7.060146| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 141/200 |loss: 7.171388| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 142/200 |loss: 7.040378| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 143/200 |loss: 7.003637| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 144/200 |loss: 6.980982| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 145/200 |loss: 6.975852| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 6.992230| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 147/200 |loss: 7.032504| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 148/200 |loss: 7.103226| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 7.010109| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 150/200 |loss: 6.907850| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 151/200 |loss: 6.919518| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 152/200 |loss: 6.958862| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 4
Epoch 153/200 |loss: 6.984365| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 154/200 |loss: 6.966462| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 155/200 |loss: 6.999025| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 156/200 |loss: 6.992617| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 157/200 |loss: 6.996330| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 158/200 |loss: 6.896245| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 159/200 |loss: 6.893696| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 160/200 |loss: 6.928324| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 6.902187| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 162/200 |loss: 6.878376| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 163/200 |loss: 6.884642| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 164/200 |loss: 6.989970| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 165/200 |loss: 7.057112| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 3
Epoch 166/200 |loss: 7.234851| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 7.067599| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 2
Epoch 168/200 |loss: 7.150708| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 169/200 |loss: 6.944984| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 170/200 |loss: 6.924619| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 171/200 |loss: 7.158434| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 172/200 |loss: 6.988757| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 173/200 |loss: 6.864565| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 174/200 |loss: 6.939749| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 175/200 |loss: 6.986061| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 176/200 |loss: 7.066401| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 6.930284| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 178/200 |loss: 6.899872| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 2
Epoch 179/200 |loss: 6.997352| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 6.961796| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 181/200 |loss: 7.099461| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 182/200 |loss: 7.000954| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 183/200 |loss: 6.924766| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 184/200 |loss: 7.063716| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 185/200 |loss: 7.112478| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 186/200 |loss: 7.101751| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.934528| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 2
Epoch 188/200 |loss: 6.964648| train set 5.262x speedup, test set 0.796x speedup, val set 5.638x speedup, step: 1
Epoch 189/200 |loss: 7.089100| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 190/200 |loss: 6.972416| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 2
Epoch 191/200 |loss: 7.039743| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 192/200 |loss: 6.977349| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 193/200 |loss: 6.892656| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 194/200 |loss: 6.934612| train set 5.262x speedup, test set 0.796x speedup, val set 5.638x speedup, step: 1
Epoch 195/200 |loss: 7.001356| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 2
Epoch 196/200 |loss: 7.012255| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 197/200 |loss: 6.919311| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 6.923008| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 199/200 |loss: 6.948145| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Training per epoch cost 0.235 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 95, train speedup 5.267, test speedup 0.822, val speedup 5.638
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 197, train speedup 5.262, test speedup 0.817, val speedup 5.638
last model at epoch 199, train speedup 5.263, test speedup 0.811, val speedup 5.539
execution cost 0:02:25.346424
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.846007, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449986| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963154| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563328| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087482| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642014| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135256| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629999| train set 4.218x speedup, test set 0.982x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115276| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589630| train set 4.401x speedup, test set 0.842x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067345| train set 4.319x speedup, test set 0.827x speedup, val set 4.515x speedup, step: 16
Epoch 16/200 |loss: 16.607136| train set 4.400x speedup, test set 1.150x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.138931| train set 4.401x speedup, test set 1.090x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.685968| train set 4.696x speedup, test set 0.864x speedup, val set 4.826x speedup, step: 19
Epoch 19/200 |loss: 15.307281| train set 4.464x speedup, test set 0.865x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.014215| train set 4.682x speedup, test set 0.839x speedup, val set 4.928x speedup, step: 21
Epoch 21/200 |loss: 14.644541| train set 4.766x speedup, test set 0.875x speedup, val set 5.016x speedup, step: 22
Epoch 22/200 |loss: 14.151733| train set 4.844x speedup, test set 1.160x speedup, val set 5.097x speedup, step: 23
Epoch 23/200 |loss: 13.781749| train set 4.997x speedup, test set 0.877x speedup, val set 5.236x speedup, step: 24
Epoch 24/200 |loss: 13.524522| train set 5.079x speedup, test set 0.899x speedup, val set 5.303x speedup, step: 25
Epoch 25/200 |loss: 13.246021| train set 5.079x speedup, test set 1.305x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.814987| train set 5.079x speedup, test set 0.847x speedup, val set 5.303x speedup, step: 27
Epoch 27/200 |loss: 12.454645| train set 5.079x speedup, test set 1.190x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.164922| train set 5.079x speedup, test set 1.155x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.000055| train set 5.079x speedup, test set 1.122x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.749633| train set 5.079x speedup, test set 1.148x speedup, val set 5.304x speedup, step: 31
Epoch 31/200 |loss: 11.303478| train set 5.263x speedup, test set 1.257x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.057856| train set 5.262x speedup, test set 0.860x speedup, val set 5.637x speedup, step: 33
Epoch 33/200 |loss: 11.313394| train set 5.263x speedup, test set 1.232x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 11.556189| train set 5.264x speedup, test set 1.138x speedup, val set 5.539x speedup, step: 35
Epoch 35/200 |loss: 10.556445| train set 5.192x speedup, test set 1.128x speedup, val set 5.562x speedup, step: 36
Epoch 36/200 |loss: 11.283021| train set 5.263x speedup, test set 1.255x speedup, val set 5.540x speedup, step: 37
Epoch 37/200 |loss: 10.125622| train set 5.263x speedup, test set 1.224x speedup, val set 5.540x speedup, step: 38
Epoch 38/200 |loss: 10.434500| train set 5.262x speedup, test set 1.175x speedup, val set 5.637x speedup, step: 39
Epoch 39/200 |loss: 9.931800| train set 5.262x speedup, test set 1.119x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 10.367153| train set 5.264x speedup, test set 1.249x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 10.310185| train set 5.264x speedup, test set 1.139x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.775476| train set 5.264x speedup, test set 1.116x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 9.696308| train set 5.262x speedup, test set 1.158x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 9.517348| train set 5.262x speedup, test set 1.119x speedup, val set 5.637x speedup, step: 45
Epoch 45/200 |loss: 9.316225| train set 5.262x speedup, test set 1.081x speedup, val set 5.637x speedup, step: 46
Epoch 46/200 |loss: 9.215625| train set 5.262x speedup, test set 1.081x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.127633| train set 5.262x speedup, test set 1.038x speedup, val set 5.638x speedup, step: 48
Epoch 48/200 |loss: 9.323582| train set 5.264x speedup, test set 1.090x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 8.823611| train set 5.264x speedup, test set 1.081x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 8.814075| train set 5.264x speedup, test set 1.073x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.573050| train set 5.264x speedup, test set 1.090x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.623430| train set 5.264x speedup, test set 1.090x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.466148| train set 5.264x speedup, test set 1.085x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.372008| train set 5.264x speedup, test set 1.081x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.283148| train set 5.264x speedup, test set 1.090x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.307845| train set 5.264x speedup, test set 1.090x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.451861| train set 5.264x speedup, test set 0.856x speedup, val set 5.539x speedup, step: 58
Epoch 58/200 |loss: 8.700484| train set 5.262x speedup, test set 0.849x speedup, val set 5.637x speedup, step: 59
Epoch 59/200 |loss: 8.289896| train set 5.264x speedup, test set 1.077x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.249682| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 61
Epoch 61/200 |loss: 8.168043| train set 5.263x speedup, test set 1.082x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.050819| train set 5.264x speedup, test set 1.081x speedup, val set 5.539x speedup, step: 63
Epoch 63/200 |loss: 8.087464| train set 5.262x speedup, test set 0.846x speedup, val set 5.637x speedup, step: 64
Epoch 64/200 |loss: 7.977297| train set 5.263x speedup, test set 1.108x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 8.216620| train set 5.262x speedup, test set 0.846x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 7.835121| train set 5.263x speedup, test set 1.074x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 7.875038| train set 5.262x speedup, test set 0.846x speedup, val set 5.638x speedup, step: 68
Epoch 68/200 |loss: 7.848215| train set 5.262x speedup, test set 0.837x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 7.953962| train set 5.263x speedup, test set 1.111x speedup, val set 5.539x speedup, step: 70
Epoch 70/200 |loss: 8.023352| train set 5.262x speedup, test set 0.857x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 7.642604| train set 5.262x speedup, test set 1.069x speedup, val set 5.638x speedup, step: 72
Epoch 72/200 |loss: 7.635914| train set 5.262x speedup, test set 0.865x speedup, val set 5.638x speedup, step: 73
Epoch 73/200 |loss: 7.608624| train set 5.262x speedup, test set 1.080x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 7.742229| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 75
Epoch 75/200 |loss: 7.603386| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.521939| train set 5.263x speedup, test set 1.050x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 7.708474| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 8.058651| train set 5.263x speedup, test set 1.108x speedup, val set 5.539x speedup, step: 79
Epoch 79/200 |loss: 8.651847| train set 5.263x speedup, test set 0.867x speedup, val set 5.539x speedup, step: 80
Epoch 80/200 |loss: 7.614993| train set 5.262x speedup, test set 0.846x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 8.430497| train set 5.263x speedup, test set 1.082x speedup, val set 5.539x speedup, step: 82
Epoch 82/200 |loss: 8.100624| train set 5.262x speedup, test set 1.082x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.919264| train set 5.262x speedup, test set 0.837x speedup, val set 5.638x speedup, step: 84
Epoch 84/200 |loss: 8.073780| train set 5.262x speedup, test set 1.055x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 7.785752| train set 5.263x speedup, test set 1.055x speedup, val set 5.539x speedup, step: 86
Epoch 86/200 |loss: 7.808864| train set 5.262x speedup, test set 1.063x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.589174| train set 5.262x speedup, test set 1.056x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.744250| train set 5.262x speedup, test set 1.055x speedup, val set 5.638x speedup, step: 89
Epoch 89/200 |loss: 7.507537| train set 5.263x speedup, test set 1.055x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.579120| train set 5.262x speedup, test set 1.055x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.438523| train set 5.263x speedup, test set 1.055x speedup, val set 5.539x speedup, step: 92
Epoch 92/200 |loss: 7.479434| train set 5.263x speedup, test set 1.055x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 7.484135| train set 5.263x speedup, test set 1.051x speedup, val set 5.539x speedup, step: 94
Epoch 94/200 |loss: 7.424602| train set 5.263x speedup, test set 1.059x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.480092| train set 5.263x speedup, test set 1.051x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.311505| train set 5.263x speedup, test set 1.044x speedup, val set 5.539x speedup, step: 97
Epoch 97/200 |loss: 7.313396| train set 5.262x speedup, test set 0.837x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.260017| train set 5.263x speedup, test set 1.080x speedup, val set 5.539x speedup, step: 99
Epoch 99/200 |loss: 7.287240| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.234433| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.199483| train set 5.263x speedup, test set 1.088x speedup, val set 5.539x speedup, step: 2
Epoch 102/200 |loss: 7.260830| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.208455| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.391033| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.368158| train set 5.263x speedup, test set 0.853x speedup, val set 5.539x speedup, step: 2
Epoch 106/200 |loss: 7.344100| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 107/200 |loss: 7.387791| train set 5.263x speedup, test set 0.853x speedup, val set 5.539x speedup, step: 2
Epoch 108/200 |loss: 7.172798| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.060792| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 110/200 |loss: 7.092591| train set 5.263x speedup, test set 0.853x speedup, val set 5.539x speedup, step: 2
Epoch 111/200 |loss: 7.115887| train set 5.263x speedup, test set 0.853x speedup, val set 5.539x speedup, step: 3
Epoch 112/200 |loss: 7.153544| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 4
Epoch 113/200 |loss: 7.056113| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.052749| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 115/200 |loss: 7.117505| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.145610| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 117/200 |loss: 7.360394| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.055049| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 119/200 |loss: 7.007239| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 120/200 |loss: 7.110996| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 121/200 |loss: 7.076581| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 122/200 |loss: 7.086445| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 123/200 |loss: 7.000362| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 124/200 |loss: 7.001069| train set 5.267x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 125/200 |loss: 7.153324| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 126/200 |loss: 7.029068| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 6.960618| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 128/200 |loss: 6.990795| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.043270| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 2
Epoch 130/200 |loss: 7.275887| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.041622| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 6.963177| train set 5.256x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 133/200 |loss: 7.094315| train set 5.263x speedup, test set 0.830x speedup, val set 5.539x speedup, step: 2
Epoch 134/200 |loss: 7.137076| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 3
Epoch 135/200 |loss: 7.114023| train set 5.262x speedup, test set 0.830x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 6.929162| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 137/200 |loss: 7.079470| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 138/200 |loss: 7.279687| train set 5.263x speedup, test set 0.830x speedup, val set 5.539x speedup, step: 2
Epoch 139/200 |loss: 6.985026| train set 5.267x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 140/200 |loss: 6.978043| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 141/200 |loss: 7.098561| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 142/200 |loss: 6.992765| train set 5.263x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 143/200 |loss: 6.920232| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 144/200 |loss: 6.919482| train set 5.263x speedup, test set 0.830x speedup, val set 5.539x speedup, step: 3
Epoch 145/200 |loss: 6.977405| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 6.979021| train set 5.262x speedup, test set 0.825x speedup, val set 5.638x speedup, step: 1
Epoch 147/200 |loss: 6.885027| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 148/200 |loss: 6.924780| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 6.945133| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 2
Epoch 150/200 |loss: 7.024755| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 7.196786| train set 5.263x speedup, test set 0.830x speedup, val set 5.539x speedup, step: 2
Epoch 152/200 |loss: 7.745178| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 7.161058| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 1
Epoch 154/200 |loss: 7.437325| train set 5.263x speedup, test set 1.045x speedup, val set 5.539x speedup, step: 2
Epoch 155/200 |loss: 7.976233| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 156/200 |loss: 7.501703| train set 5.179x speedup, test set 0.826x speedup, val set 5.679x speedup, step: 1
Epoch 157/200 |loss: 7.798813| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 2
Epoch 158/200 |loss: 7.572260| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 3
Epoch 159/200 |loss: 7.621497| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 4
Epoch 160/200 |loss: 7.226068| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 5
Epoch 161/200 |loss: 7.383911| train set 5.267x speedup, test set 0.830x speedup, val set 5.638x speedup, step: 6
Epoch 162/200 |loss: 7.245572| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 7
Epoch 163/200 |loss: 7.182846| train set 5.263x speedup, test set 0.847x speedup, val set 5.539x speedup, step: 8
Epoch 164/200 |loss: 7.234490| train set 5.263x speedup, test set 1.064x speedup, val set 5.539x speedup, step: 9
Epoch 165/200 |loss: 7.249874| train set 5.262x speedup, test set 0.842x speedup, val set 5.638x speedup, step: 10
Epoch 166/200 |loss: 7.107707| train set 5.262x speedup, test set 0.844x speedup, val set 5.638x speedup, step: 11
Epoch 167/200 |loss: 7.168612| train set 5.263x speedup, test set 0.843x speedup, val set 5.539x speedup, step: 12
Epoch 168/200 |loss: 6.978794| train set 5.263x speedup, test set 0.844x speedup, val set 5.539x speedup, step: 13
Epoch 169/200 |loss: 7.119040| train set 5.263x speedup, test set 0.849x speedup, val set 5.539x speedup, step: 14
Epoch 170/200 |loss: 7.101057| train set 5.262x speedup, test set 0.849x speedup, val set 5.638x speedup, step: 15
Epoch 171/200 |loss: 7.086380| train set 5.262x speedup, test set 0.844x speedup, val set 5.638x speedup, step: 16
Epoch 172/200 |loss: 6.987590| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 17
Epoch 173/200 |loss: 7.014904| train set 5.262x speedup, test set 0.843x speedup, val set 5.638x speedup, step: 18
Epoch 174/200 |loss: 6.931367| train set 5.262x speedup, test set 0.843x speedup, val set 5.638x speedup, step: 19
Epoch 175/200 |loss: 6.946378| train set 5.263x speedup, test set 0.853x speedup, val set 5.539x speedup, step: 20
Epoch 176/200 |loss: 6.932719| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 21
Epoch 177/200 |loss: 7.009192| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 22
Epoch 178/200 |loss: 6.987329| train set 5.262x speedup, test set 0.842x speedup, val set 5.638x speedup, step: 23
Epoch 179/200 |loss: 7.105911| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 24
Epoch 180/200 |loss: 7.052037| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 25
Epoch 181/200 |loss: 7.159253| train set 5.262x speedup, test set 0.843x speedup, val set 5.638x speedup, step: 26
Epoch 182/200 |loss: 6.915174| train set 5.262x speedup, test set 0.843x speedup, val set 5.638x speedup, step: 27
Epoch 183/200 |loss: 6.891681| train set 5.263x speedup, test set 0.843x speedup, val set 5.539x speedup, step: 28
Epoch 184/200 |loss: 6.979183| train set 5.263x speedup, test set 0.843x speedup, val set 5.539x speedup, step: 29
Epoch 185/200 |loss: 6.978739| train set 5.263x speedup, test set 0.843x speedup, val set 5.539x speedup, step: 30
Epoch 186/200 |loss: 6.990438| train set 5.262x speedup, test set 0.842x speedup, val set 5.638x speedup, step: 31
Epoch 187/200 |loss: 6.874394| train set 5.262x speedup, test set 0.843x speedup, val set 5.638x speedup, step: 32
Epoch 188/200 |loss: 6.869429| train set 5.262x speedup, test set 0.843x speedup, val set 5.638x speedup, step: 33
Epoch 189/200 |loss: 6.897749| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 34
Epoch 190/200 |loss: 6.917660| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 35
Epoch 191/200 |loss: 6.963977| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 36
Epoch 192/200 |loss: 6.913376| train set 5.262x speedup, test set 0.842x speedup, val set 5.638x speedup, step: 37
Epoch 193/200 |loss: 6.888684| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 38
Epoch 194/200 |loss: 6.962631| train set 5.262x speedup, test set 0.843x speedup, val set 5.638x speedup, step: 39
Epoch 195/200 |loss: 6.962332| train set 5.263x speedup, test set 0.843x speedup, val set 5.539x speedup, step: 40
Epoch 196/200 |loss: 7.063694| train set 5.262x speedup, test set 0.843x speedup, val set 5.638x speedup, step: 41
Epoch 197/200 |loss: 6.893925| train set 5.262x speedup, test set 0.842x speedup, val set 5.638x speedup, step: 42
Epoch 198/200 |loss: 6.890790| train set 5.263x speedup, test set 0.842x speedup, val set 5.539x speedup, step: 43
Epoch 199/200 |loss: 7.124644| train set 5.262x speedup, test set 0.842x speedup, val set 5.638x speedup, step: 44
Training per epoch cost 0.232 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.715s, pg runtime 0.354s, speedup 0.495x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.239s, pg runtime 0.239s, speedup 1.000x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 124, train speedup 5.267, test speedup 0.825, val speedup 5.638
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 156, train speedup 5.179, test speedup 0.826, val speedup 5.679
last model at epoch 199, train speedup 5.262, test speedup 0.842, val speedup 5.638
execution cost 0:02:23.968266
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.845064, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449986| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442951| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563332| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087486| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613012| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114962| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642017| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135260| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.630003| train set 4.218x speedup, test set 0.982x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115280| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589659| train set 4.401x speedup, test set 0.842x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067188| train set 4.388x speedup, test set 0.827x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.605207| train set 4.400x speedup, test set 1.150x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.135443| train set 4.401x speedup, test set 1.090x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.671431| train set 4.548x speedup, test set 0.864x speedup, val set 4.675x speedup, step: 19
Epoch 19/200 |loss: 15.270933| train set 4.464x speedup, test set 0.865x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.021620| train set 4.600x speedup, test set 0.839x speedup, val set 4.863x speedup, step: 21
Epoch 21/200 |loss: 14.705939| train set 4.825x speedup, test set 0.868x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.115808| train set 5.030x speedup, test set 0.891x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 13.800063| train set 4.993x speedup, test set 0.890x speedup, val set 5.215x speedup, step: 24
Epoch 24/200 |loss: 13.560281| train set 5.079x speedup, test set 0.898x speedup, val set 5.303x speedup, step: 25
Epoch 25/200 |loss: 13.168664| train set 5.079x speedup, test set 1.158x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.675073| train set 5.058x speedup, test set 0.874x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.562732| train set 5.079x speedup, test set 1.203x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.268287| train set 5.079x speedup, test set 1.191x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.737926| train set 5.079x speedup, test set 1.116x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.649724| train set 5.263x speedup, test set 1.159x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.208559| train set 5.262x speedup, test set 1.129x speedup, val set 5.638x speedup, step: 32
Epoch 32/200 |loss: 11.182660| train set 5.263x speedup, test set 1.241x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 11.464997| train set 5.264x speedup, test set 1.166x speedup, val set 5.539x speedup, step: 34
Epoch 34/200 |loss: 11.095109| train set 5.262x speedup, test set 1.181x speedup, val set 5.637x speedup, step: 35
Epoch 35/200 |loss: 11.123115| train set 5.264x speedup, test set 1.262x speedup, val set 5.539x speedup, step: 36
Epoch 36/200 |loss: 11.386560| train set 5.241x speedup, test set 1.090x speedup, val set 5.516x speedup, step: 37
Epoch 37/200 |loss: 10.588367| train set 5.263x speedup, test set 1.109x speedup, val set 5.540x speedup, step: 38
Epoch 38/200 |loss: 10.503818| train set 5.263x speedup, test set 1.240x speedup, val set 5.540x speedup, step: 39
Epoch 39/200 |loss: 10.357859| train set 5.262x speedup, test set 1.123x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 10.151354| train set 5.262x speedup, test set 1.177x speedup, val set 5.637x speedup, step: 41
Epoch 41/200 |loss: 9.697447| train set 5.264x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 10.154309| train set 5.262x speedup, test set 1.155x speedup, val set 5.637x speedup, step: 43
Epoch 43/200 |loss: 9.955120| train set 5.262x speedup, test set 1.118x speedup, val set 5.637x speedup, step: 44
Epoch 44/200 |loss: 10.162547| train set 5.262x speedup, test set 1.137x speedup, val set 5.637x speedup, step: 45
Epoch 45/200 |loss: 9.573515| train set 5.264x speedup, test set 1.126x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.701321| train set 5.262x speedup, test set 1.095x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.241024| train set 5.262x speedup, test set 1.079x speedup, val set 5.637x speedup, step: 48
Epoch 48/200 |loss: 9.095016| train set 5.263x speedup, test set 1.142x speedup, val set 5.539x speedup, step: 49
Epoch 49/200 |loss: 9.219175| train set 5.262x speedup, test set 1.095x speedup, val set 5.638x speedup, step: 50
Epoch 50/200 |loss: 8.872914| train set 5.263x speedup, test set 1.087x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.811096| train set 5.264x speedup, test set 1.142x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.701577| train set 5.262x speedup, test set 1.109x speedup, val set 5.637x speedup, step: 53
Epoch 53/200 |loss: 8.661833| train set 5.264x speedup, test set 1.091x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.482042| train set 5.264x speedup, test set 1.117x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.428457| train set 5.264x speedup, test set 1.089x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.339065| train set 5.264x speedup, test set 1.083x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.336289| train set 5.264x speedup, test set 1.109x speedup, val set 5.539x speedup, step: 58
Epoch 58/200 |loss: 8.115139| train set 5.264x speedup, test set 1.109x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.120272| train set 5.264x speedup, test set 1.100x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.080828| train set 5.262x speedup, test set 0.855x speedup, val set 5.637x speedup, step: 61
Epoch 61/200 |loss: 8.285008| train set 5.264x speedup, test set 1.100x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.782219| train set 5.262x speedup, test set 1.089x speedup, val set 5.637x speedup, step: 63
Epoch 63/200 |loss: 8.591736| train set 5.262x speedup, test set 1.103x speedup, val set 5.637x speedup, step: 64
Epoch 64/200 |loss: 8.357816| train set 5.264x speedup, test set 1.095x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 8.506955| train set 5.262x speedup, test set 1.089x speedup, val set 5.637x speedup, step: 66
Epoch 66/200 |loss: 8.075383| train set 5.263x speedup, test set 1.117x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 8.435781| train set 5.263x speedup, test set 1.081x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 8.083657| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 8.109469| train set 5.263x speedup, test set 1.097x speedup, val set 5.539x speedup, step: 70
Epoch 70/200 |loss: 7.961613| train set 5.263x speedup, test set 1.083x speedup, val set 5.539x speedup, step: 71
Epoch 71/200 |loss: 7.834495| train set 5.262x speedup, test set 1.089x speedup, val set 5.638x speedup, step: 72
Epoch 72/200 |loss: 7.798088| train set 5.263x speedup, test set 1.089x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 7.738825| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 7.710116| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.619830| train set 5.263x speedup, test set 1.089x speedup, val set 5.539x speedup, step: 76
Epoch 76/200 |loss: 7.572275| train set 5.263x speedup, test set 0.853x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 7.557349| train set 5.263x speedup, test set 0.854x speedup, val set 5.539x speedup, step: 78
Epoch 78/200 |loss: 7.516624| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.577909| train set 5.263x speedup, test set 1.091x speedup, val set 5.539x speedup, step: 80
Epoch 80/200 |loss: 7.707627| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.743837| train set 5.263x speedup, test set 1.083x speedup, val set 5.539x speedup, step: 82
Epoch 82/200 |loss: 7.825262| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.477689| train set 5.267x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 84
Epoch 84/200 |loss: 7.349669| train set 5.263x speedup, test set 1.089x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 7.533858| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.529859| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 87
Epoch 87/200 |loss: 7.452613| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.286835| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 89
Epoch 89/200 |loss: 7.344866| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.551307| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 7.431545| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.384473| train set 5.263x speedup, test set 0.848x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 7.444199| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 7.453663| train set 5.263x speedup, test set 1.081x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.557023| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 96
Epoch 96/200 |loss: 7.191170| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 7.444996| train set 5.263x speedup, test set 1.066x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.684432| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.292676| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.390150| train set 5.263x speedup, test set 1.066x speedup, val set 5.539x speedup, step: 1
Epoch 101/200 |loss: 7.518879| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.264441| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.345153| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 2
Epoch 104/200 |loss: 7.340158| train set 5.262x speedup, test set 0.818x speedup, val set 5.638x speedup, step: 1
Epoch 105/200 |loss: 7.377903| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 106/200 |loss: 7.145919| train set 5.263x speedup, test set 0.854x speedup, val set 5.539x speedup, step: 2
Epoch 107/200 |loss: 7.234002| train set 5.262x speedup, test set 0.845x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.286681| train set 5.263x speedup, test set 0.818x speedup, val set 5.539x speedup, step: 2
Epoch 109/200 |loss: 7.071787| train set 5.263x speedup, test set 0.854x speedup, val set 5.539x speedup, step: 3
Epoch 110/200 |loss: 7.232253| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.072625| train set 5.262x speedup, test set 0.818x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.158744| train set 5.267x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 113/200 |loss: 7.069177| train set 5.263x speedup, test set 0.854x speedup, val set 5.539x speedup, step: 2
Epoch 114/200 |loss: 7.040740| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 3
Epoch 115/200 |loss: 7.045269| train set 5.263x speedup, test set 0.854x speedup, val set 5.539x speedup, step: 4
Epoch 116/200 |loss: 7.023673| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.033324| train set 5.262x speedup, test set 0.845x speedup, val set 5.638x speedup, step: 1
Epoch 118/200 |loss: 7.036870| train set 5.263x speedup, test set 0.818x speedup, val set 5.539x speedup, step: 2
Epoch 119/200 |loss: 7.072001| train set 5.263x speedup, test set 0.854x speedup, val set 5.539x speedup, step: 3
Epoch 120/200 |loss: 7.313104| train set 5.253x speedup, test set 0.838x speedup, val set 5.657x speedup, step: 1
Epoch 121/200 |loss: 7.795886| train set 5.263x speedup, test set 0.831x speedup, val set 5.539x speedup, step: 2
Epoch 122/200 |loss: 8.797968| train set 5.262x speedup, test set 0.824x speedup, val set 5.638x speedup, step: 3
Epoch 123/200 |loss: 7.595346| train set 5.179x speedup, test set 0.845x speedup, val set 5.679x speedup, step: 1
Epoch 124/200 |loss: 8.861443| train set 5.263x speedup, test set 1.065x speedup, val set 5.540x speedup, step: 2
Epoch 125/200 |loss: 8.683692| train set 5.263x speedup, test set 0.823x speedup, val set 5.539x speedup, step: 3
Epoch 126/200 |loss: 8.073831| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 4
Epoch 127/200 |loss: 8.764677| train set 5.263x speedup, test set 1.025x speedup, val set 5.539x speedup, step: 5
Epoch 128/200 |loss: 7.887809| train set 5.054x speedup, test set 1.040x speedup, val set 5.454x speedup, step: 6
Epoch 129/200 |loss: 8.182421| train set 5.262x speedup, test set 1.032x speedup, val set 5.638x speedup, step: 7
Epoch 130/200 |loss: 7.747170| train set 5.262x speedup, test set 1.032x speedup, val set 5.638x speedup, step: 8
Epoch 131/200 |loss: 7.998843| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 9
Epoch 132/200 |loss: 7.788208| train set 5.263x speedup, test set 1.018x speedup, val set 5.539x speedup, step: 10
Epoch 133/200 |loss: 7.698021| train set 5.263x speedup, test set 1.075x speedup, val set 5.539x speedup, step: 11
Epoch 134/200 |loss: 7.578235| train set 5.263x speedup, test set 1.084x speedup, val set 5.539x speedup, step: 12
Epoch 135/200 |loss: 7.533290| train set 5.263x speedup, test set 1.068x speedup, val set 5.539x speedup, step: 13
Epoch 136/200 |loss: 7.499465| train set 5.262x speedup, test set 1.073x speedup, val set 5.638x speedup, step: 14
Epoch 137/200 |loss: 7.448215| train set 5.262x speedup, test set 1.073x speedup, val set 5.638x speedup, step: 15
Epoch 138/200 |loss: 7.384474| train set 5.262x speedup, test set 1.030x speedup, val set 5.638x speedup, step: 16
Epoch 139/200 |loss: 7.318641| train set 5.263x speedup, test set 1.030x speedup, val set 5.539x speedup, step: 17
Epoch 140/200 |loss: 7.288660| train set 5.263x speedup, test set 1.030x speedup, val set 5.539x speedup, step: 18
Epoch 141/200 |loss: 7.216938| train set 5.262x speedup, test set 1.030x speedup, val set 5.638x speedup, step: 19
Epoch 142/200 |loss: 7.229159| train set 5.262x speedup, test set 1.030x speedup, val set 5.638x speedup, step: 20
Epoch 143/200 |loss: 7.139943| train set 5.263x speedup, test set 1.030x speedup, val set 5.539x speedup, step: 21
Epoch 144/200 |loss: 7.186588| train set 5.263x speedup, test set 1.012x speedup, val set 5.539x speedup, step: 22
Epoch 145/200 |loss: 7.084707| train set 5.262x speedup, test set 1.012x speedup, val set 5.638x speedup, step: 23
Epoch 146/200 |loss: 7.137812| train set 5.262x speedup, test set 1.012x speedup, val set 5.638x speedup, step: 24
Epoch 147/200 |loss: 7.059998| train set 5.263x speedup, test set 1.012x speedup, val set 5.539x speedup, step: 25
Epoch 148/200 |loss: 7.084109| train set 5.263x speedup, test set 1.012x speedup, val set 5.539x speedup, step: 26
Epoch 149/200 |loss: 7.031599| train set 5.263x speedup, test set 0.805x speedup, val set 5.539x speedup, step: 27
Epoch 150/200 |loss: 7.030406| train set 5.263x speedup, test set 1.030x speedup, val set 5.539x speedup, step: 28
Epoch 151/200 |loss: 6.999830| train set 5.263x speedup, test set 1.030x speedup, val set 5.539x speedup, step: 29
Epoch 152/200 |loss: 6.992561| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 30
Epoch 153/200 |loss: 6.984843| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 31
Epoch 154/200 |loss: 6.961931| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 32
Epoch 155/200 |loss: 6.954765| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 33
Epoch 156/200 |loss: 6.955241| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 34
Epoch 157/200 |loss: 6.962978| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 35
Epoch 158/200 |loss: 6.980649| train set 5.263x speedup, test set 1.012x speedup, val set 5.539x speedup, step: 36
Epoch 159/200 |loss: 7.084218| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 37
Epoch 160/200 |loss: 7.144475| train set 5.263x speedup, test set 0.989x speedup, val set 5.539x speedup, step: 38
Epoch 161/200 |loss: 7.442025| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 39
Epoch 162/200 |loss: 7.172298| train set 5.263x speedup, test set 1.012x speedup, val set 5.539x speedup, step: 40
Epoch 163/200 |loss: 6.961817| train set 5.262x speedup, test set 0.791x speedup, val set 5.638x speedup, step: 41
Epoch 164/200 |loss: 6.916855| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 42
Epoch 165/200 |loss: 7.062990| train set 5.263x speedup, test set 1.003x speedup, val set 5.539x speedup, step: 43
Epoch 166/200 |loss: 7.358967| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 44
Epoch 167/200 |loss: 6.950388| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 45
Epoch 168/200 |loss: 7.060179| train set 5.263x speedup, test set 1.004x speedup, val set 5.539x speedup, step: 46
Epoch 169/200 |loss: 7.400638| train set 5.262x speedup, test set 1.030x speedup, val set 5.638x speedup, step: 47
Epoch 170/200 |loss: 7.026999| train set 5.262x speedup, test set 0.803x speedup, val set 5.638x speedup, step: 48
Epoch 171/200 |loss: 7.148932| train set 5.263x speedup, test set 1.004x speedup, val set 5.539x speedup, step: 49
Epoch 172/200 |loss: 7.576395| train set 5.262x speedup, test set 1.032x speedup, val set 5.638x speedup, step: 50
Epoch 173/200 |loss: 7.053036| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 51
Epoch 174/200 |loss: 7.379490| train set 5.263x speedup, test set 1.004x speedup, val set 5.539x speedup, step: 52
Epoch 175/200 |loss: 7.331787| train set 5.263x speedup, test set 1.008x speedup, val set 5.539x speedup, step: 53
Epoch 176/200 |loss: 7.031305| train set 5.262x speedup, test set 0.818x speedup, val set 5.638x speedup, step: 54
Epoch 177/200 |loss: 7.540931| train set 5.263x speedup, test set 1.003x speedup, val set 5.539x speedup, step: 55
Epoch 178/200 |loss: 7.157557| train set 5.263x speedup, test set 1.004x speedup, val set 5.539x speedup, step: 56
Epoch 179/200 |loss: 7.249760| train set 5.262x speedup, test set 1.008x speedup, val set 5.638x speedup, step: 57
Epoch 180/200 |loss: 7.139178| train set 5.262x speedup, test set 1.032x speedup, val set 5.638x speedup, step: 58
Epoch 181/200 |loss: 7.061150| train set 5.263x speedup, test set 1.004x speedup, val set 5.539x speedup, step: 59
Epoch 182/200 |loss: 7.138668| train set 5.263x speedup, test set 0.990x speedup, val set 5.539x speedup, step: 60
Epoch 183/200 |loss: 7.024553| train set 5.263x speedup, test set 1.007x speedup, val set 5.539x speedup, step: 61
Epoch 184/200 |loss: 7.155132| train set 5.263x speedup, test set 1.032x speedup, val set 5.539x speedup, step: 62
Epoch 185/200 |loss: 7.020902| train set 5.262x speedup, test set 1.008x speedup, val set 5.638x speedup, step: 63
Epoch 186/200 |loss: 7.060022| train set 5.262x speedup, test set 1.008x speedup, val set 5.638x speedup, step: 64
Epoch 187/200 |loss: 6.969383| train set 5.262x speedup, test set 1.008x speedup, val set 5.638x speedup, step: 65
Epoch 188/200 |loss: 7.000709| train set 5.263x speedup, test set 1.032x speedup, val set 5.539x speedup, step: 66
Epoch 189/200 |loss: 7.016171| train set 5.263x speedup, test set 1.008x speedup, val set 5.539x speedup, step: 67
Epoch 190/200 |loss: 6.929068| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 68
Epoch 191/200 |loss: 7.036109| train set 5.263x speedup, test set 1.008x speedup, val set 5.539x speedup, step: 69
Epoch 192/200 |loss: 6.894661| train set 5.262x speedup, test set 1.032x speedup, val set 5.638x speedup, step: 70
Epoch 193/200 |loss: 6.937354| train set 5.262x speedup, test set 1.032x speedup, val set 5.638x speedup, step: 71
Epoch 194/200 |loss: 6.910095| train set 5.262x speedup, test set 0.803x speedup, val set 5.638x speedup, step: 72
Epoch 195/200 |loss: 6.880576| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 73
Epoch 196/200 |loss: 6.907682| train set 5.263x speedup, test set 0.818x speedup, val set 5.539x speedup, step: 74
Epoch 197/200 |loss: 6.850367| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 75
Epoch 198/200 |loss: 6.888628| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 76
Epoch 199/200 |loss: 6.881650| train set 5.262x speedup, test set 0.818x speedup, val set 5.638x speedup, step: 77
Training per epoch cost 0.225 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 3.507s, pg runtime 3.507s, speedup 1.000x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.157s, pg runtime 0.239s, speedup 1.525x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 112, train speedup 5.267, test speedup 0.854, val speedup 5.638
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 123, train speedup 5.179, test speedup 0.845, val speedup 5.679
last model at epoch 199, train speedup 5.262, test speedup 0.818, val speedup 5.638
execution cost 0:02:21.537921
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.879058, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039595| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442949| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963154| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563328| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087482| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613008| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114954| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642033| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135202| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.629986| train set 4.166x speedup, test set 0.973x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.116009| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.593994| train set 4.401x speedup, test set 0.859x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.063532| train set 4.388x speedup, test set 0.794x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.591364| train set 4.401x speedup, test set 0.862x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.149643| train set 4.463x speedup, test set 1.099x speedup, val set 4.640x speedup, step: 18
Epoch 18/200 |loss: 15.731857| train set 4.613x speedup, test set 0.867x speedup, val set 4.852x speedup, step: 19
Epoch 19/200 |loss: 15.341886| train set 4.447x speedup, test set 0.864x speedup, val set 4.623x speedup, step: 20
Epoch 20/200 |loss: 14.874213| train set 4.640x speedup, test set 0.858x speedup, val set 4.927x speedup, step: 21
Epoch 21/200 |loss: 14.458373| train set 4.825x speedup, test set 0.868x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.068265| train set 4.825x speedup, test set 0.897x speedup, val set 5.077x speedup, step: 23
Epoch 23/200 |loss: 13.723762| train set 4.551x speedup, test set 0.850x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.361712| train set 5.058x speedup, test set 1.198x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.197133| train set 4.885x speedup, test set 1.284x speedup, val set 5.141x speedup, step: 26
Epoch 26/200 |loss: 13.463355| train set 5.058x speedup, test set 0.876x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.585244| train set 5.079x speedup, test set 1.154x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.505137| train set 5.079x speedup, test set 1.129x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 12.247057| train set 5.079x speedup, test set 1.120x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.715055| train set 5.263x speedup, test set 1.152x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.735886| train set 5.263x speedup, test set 1.261x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.157563| train set 5.263x speedup, test set 1.157x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 10.992882| train set 5.263x speedup, test set 1.181x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.899604| train set 5.264x speedup, test set 1.114x speedup, val set 5.539x speedup, step: 35
Epoch 35/200 |loss: 10.370017| train set 5.264x speedup, test set 1.090x speedup, val set 5.539x speedup, step: 36
Epoch 36/200 |loss: 10.526359| train set 5.263x speedup, test set 1.162x speedup, val set 5.540x speedup, step: 37
Epoch 37/200 |loss: 10.206682| train set 5.262x speedup, test set 1.129x speedup, val set 5.637x speedup, step: 38
Epoch 38/200 |loss: 9.922523| train set 5.264x speedup, test set 1.141x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 9.882225| train set 5.262x speedup, test set 1.122x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 10.209523| train set 5.264x speedup, test set 1.189x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 10.482551| train set 5.262x speedup, test set 1.082x speedup, val set 5.637x speedup, step: 42
Epoch 42/200 |loss: 9.518785| train set 5.264x speedup, test set 1.108x speedup, val set 5.539x speedup, step: 43
Epoch 43/200 |loss: 10.156901| train set 5.264x speedup, test set 1.098x speedup, val set 5.539x speedup, step: 44
Epoch 44/200 |loss: 9.855177| train set 5.264x speedup, test set 1.108x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.468394| train set 5.264x speedup, test set 1.125x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.474293| train set 5.264x speedup, test set 1.102x speedup, val set 5.539x speedup, step: 47
Epoch 47/200 |loss: 8.997149| train set 5.264x speedup, test set 1.159x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 9.184486| train set 5.262x speedup, test set 1.108x speedup, val set 5.637x speedup, step: 49
Epoch 49/200 |loss: 8.821642| train set 5.264x speedup, test set 1.116x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 8.925847| train set 5.262x speedup, test set 1.103x speedup, val set 5.637x speedup, step: 51
Epoch 51/200 |loss: 8.666909| train set 5.264x speedup, test set 1.095x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.648007| train set 5.262x speedup, test set 1.103x speedup, val set 5.637x speedup, step: 53
Epoch 53/200 |loss: 8.567143| train set 5.264x speedup, test set 1.103x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.494330| train set 5.262x speedup, test set 1.104x speedup, val set 5.637x speedup, step: 55
Epoch 55/200 |loss: 8.526220| train set 5.264x speedup, test set 1.109x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.588247| train set 5.262x speedup, test set 1.078x speedup, val set 5.637x speedup, step: 57
Epoch 57/200 |loss: 8.439038| train set 5.262x speedup, test set 1.070x speedup, val set 5.637x speedup, step: 58
Epoch 58/200 |loss: 8.275541| train set 5.264x speedup, test set 1.069x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 8.131063| train set 5.264x speedup, test set 0.846x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.173260| train set 5.264x speedup, test set 1.077x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 8.214539| train set 5.262x speedup, test set 1.077x speedup, val set 5.637x speedup, step: 62
Epoch 62/200 |loss: 8.137106| train set 5.264x speedup, test set 1.081x speedup, val set 5.539x speedup, step: 63
Epoch 63/200 |loss: 8.031685| train set 5.262x speedup, test set 1.063x speedup, val set 5.637x speedup, step: 64
Epoch 64/200 |loss: 7.992584| train set 5.264x speedup, test set 1.069x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 7.713390| train set 5.262x speedup, test set 1.069x speedup, val set 5.637x speedup, step: 66
Epoch 66/200 |loss: 7.757280| train set 5.262x speedup, test set 0.832x speedup, val set 5.638x speedup, step: 67
Epoch 67/200 |loss: 7.812893| train set 5.263x speedup, test set 1.077x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 7.764733| train set 5.262x speedup, test set 0.829x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 8.038612| train set 5.263x speedup, test set 1.050x speedup, val set 5.539x speedup, step: 70
Epoch 70/200 |loss: 8.613597| train set 5.262x speedup, test set 0.841x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 7.843092| train set 5.262x speedup, test set 0.832x speedup, val set 5.638x speedup, step: 72
Epoch 72/200 |loss: 8.127228| train set 5.162x speedup, test set 1.160x speedup, val set 5.482x speedup, step: 73
Epoch 73/200 |loss: 8.792129| train set 5.262x speedup, test set 0.840x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 8.040843| train set 5.262x speedup, test set 0.832x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 8.506888| train set 5.263x speedup, test set 1.151x speedup, val set 5.539x speedup, step: 76
Epoch 76/200 |loss: 8.493829| train set 5.263x speedup, test set 1.103x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 8.175532| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 8.200285| train set 5.262x speedup, test set 0.846x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.926924| train set 5.263x speedup, test set 1.103x speedup, val set 5.539x speedup, step: 80
Epoch 80/200 |loss: 8.033273| train set 5.263x speedup, test set 1.103x speedup, val set 5.539x speedup, step: 81
Epoch 81/200 |loss: 7.843923| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.926013| train set 5.262x speedup, test set 0.855x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.618709| train set 5.263x speedup, test set 1.021x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 7.652960| train set 5.262x speedup, test set 1.063x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 7.584819| train set 5.262x speedup, test set 0.832x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.604362| train set 5.262x speedup, test set 0.846x speedup, val set 5.638x speedup, step: 87
Epoch 87/200 |loss: 7.457159| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 88
Epoch 88/200 |loss: 7.485945| train set 5.263x speedup, test set 0.847x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 7.405736| train set 5.262x speedup, test set 0.847x speedup, val set 5.638x speedup, step: 90
Epoch 90/200 |loss: 7.470570| train set 5.263x speedup, test set 0.847x speedup, val set 5.539x speedup, step: 91
Epoch 91/200 |loss: 7.421043| train set 5.262x speedup, test set 0.832x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.479553| train set 5.262x speedup, test set 0.831x speedup, val set 5.638x speedup, step: 93
Epoch 93/200 |loss: 7.443421| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 7.407859| train set 5.263x speedup, test set 0.847x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.377738| train set 5.263x speedup, test set 0.832x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.227109| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 97
Epoch 97/200 |loss: 7.251626| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.150446| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.229885| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.243850| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.341858| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 2
Epoch 102/200 |loss: 7.545292| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 103/200 |loss: 7.270110| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.283648| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 105/200 |loss: 7.307883| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 106/200 |loss: 7.314445| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 4
Epoch 107/200 |loss: 7.253767| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 108/200 |loss: 7.167547| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.140647| train set 5.263x speedup, test set 0.816x speedup, val set 5.539x speedup, step: 2
Epoch 110/200 |loss: 7.135920| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 111/200 |loss: 7.163021| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.108597| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 113/200 |loss: 7.049081| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 114/200 |loss: 7.019122| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 3
Epoch 115/200 |loss: 7.038401| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.035841| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 117/200 |loss: 7.011505| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 3
Epoch 118/200 |loss: 7.089795| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 4
Epoch 119/200 |loss: 7.339537| train set 5.262x speedup, test set 0.848x speedup, val set 5.638x speedup, step: 1
Epoch 120/200 |loss: 7.306369| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 121/200 |loss: 7.190021| train set 5.263x speedup, test set 0.819x speedup, val set 5.539x speedup, step: 3
Epoch 122/200 |loss: 7.032439| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 123/200 |loss: 7.119921| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 124/200 |loss: 7.225682| train set 5.262x speedup, test set 0.819x speedup, val set 5.638x speedup, step: 1
Epoch 125/200 |loss: 7.002597| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 126/200 |loss: 7.114216| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 127/200 |loss: 7.333758| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 128/200 |loss: 7.020038| train set 5.262x speedup, test set 0.819x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.191700| train set 5.263x speedup, test set 0.805x speedup, val set 5.539x speedup, step: 2
Epoch 130/200 |loss: 7.362807| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 131/200 |loss: 7.084529| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.328161| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 133/200 |loss: 7.279743| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 3
Epoch 134/200 |loss: 7.140910| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 135/200 |loss: 7.208597| train set 5.262x speedup, test set 0.819x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 7.065517| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 137/200 |loss: 7.107885| train set 5.262x speedup, test set 0.795x speedup, val set 5.638x speedup, step: 1
Epoch 138/200 |loss: 7.050117| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 7.041502| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 2
Epoch 140/200 |loss: 7.038729| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 141/200 |loss: 6.974473| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 142/200 |loss: 7.018565| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 143/200 |loss: 6.977862| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 144/200 |loss: 7.017536| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 3
Epoch 145/200 |loss: 7.146021| train set 5.262x speedup, test set 0.820x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 7.176268| train set 5.263x speedup, test set 0.795x speedup, val set 5.539x speedup, step: 2
Epoch 147/200 |loss: 7.397309| train set 5.263x speedup, test set 0.820x speedup, val set 5.539x speedup, step: 3
Epoch 148/200 |loss: 7.160651| train set 5.262x speedup, test set 0.821x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 7.031386| train set 5.262x speedup, test set 0.795x speedup, val set 5.638x speedup, step: 1
Epoch 150/200 |loss: 6.993194| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 151/200 |loss: 7.101305| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 3
Epoch 152/200 |loss: 7.236948| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 153/200 |loss: 6.988080| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 154/200 |loss: 7.104263| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 3
Epoch 155/200 |loss: 7.210598| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 156/200 |loss: 7.048059| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 157/200 |loss: 7.143316| train set 5.263x speedup, test set 0.796x speedup, val set 5.539x speedup, step: 2
Epoch 158/200 |loss: 7.285865| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 159/200 |loss: 7.079437| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 4
Epoch 160/200 |loss: 7.160136| train set 5.262x speedup, test set 0.796x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 7.228940| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 162/200 |loss: 6.964517| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 163/200 |loss: 7.171260| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 3
Epoch 164/200 |loss: 7.063596| train set 5.262x speedup, test set 0.795x speedup, val set 5.638x speedup, step: 1
Epoch 165/200 |loss: 6.992133| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 166/200 |loss: 7.118624| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 3
Epoch 167/200 |loss: 7.032849| train set 5.262x speedup, test set 0.796x speedup, val set 5.638x speedup, step: 1
Epoch 168/200 |loss: 7.082966| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 169/200 |loss: 7.086001| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 3
Epoch 170/200 |loss: 6.986715| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 171/200 |loss: 7.154901| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 172/200 |loss: 7.099068| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 3
Epoch 173/200 |loss: 6.974256| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 174/200 |loss: 7.112182| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 175/200 |loss: 6.890549| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 176/200 |loss: 7.011046| train set 5.262x speedup, test set 0.797x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 6.890460| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 178/200 |loss: 6.954542| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 179/200 |loss: 6.893782| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 6.908236| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 181/200 |loss: 6.892327| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 182/200 |loss: 6.887463| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 183/200 |loss: 6.861829| train set 5.263x speedup, test set 0.796x speedup, val set 5.638x speedup, step: 1
Epoch 184/200 |loss: 6.867958| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 185/200 |loss: 6.839121| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 186/200 |loss: 6.872590| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.868209| train set 5.262x speedup, test set 0.797x speedup, val set 5.638x speedup, step: 1
Epoch 188/200 |loss: 7.040992| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 189/200 |loss: 7.196619| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 190/200 |loss: 7.737510| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 191/200 |loss: 7.052218| train set 5.267x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 192/200 |loss: 7.727826| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 193/200 |loss: 8.361464| train set 5.256x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 194/200 |loss: 7.591832| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 195/200 |loss: 8.020554| train set 5.262x speedup, test set 1.021x speedup, val set 5.638x speedup, step: 1
Epoch 196/200 |loss: 7.509435| train set 5.262x speedup, test set 1.021x speedup, val set 5.638x speedup, step: 1
Epoch 197/200 |loss: 7.468544| train set 5.262x speedup, test set 0.810x speedup, val set 5.638x speedup, step: 1
Epoch 198/200 |loss: 7.551919| train set 5.263x speedup, test set 0.810x speedup, val set 5.539x speedup, step: 2
Epoch 199/200 |loss: 7.284601| train set 5.263x speedup, test set 1.029x speedup, val set 5.539x speedup, step: 3
Training per epoch cost 0.231 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.081s, pg runtime 0.081s, speedup 1.000x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.675s, pg runtime 1.680s, speedup 1.003x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 50.837s, pg runtime 13.945s, speedup 0.274x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.715s, pg runtime 0.354s, speedup 0.495x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 191, train speedup 5.267, test speedup 0.810, val speedup 5.638
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 197, train speedup 5.262, test speedup 0.810, val speedup 5.638
last model at epoch 199, train speedup 5.263, test speedup 1.029, val speedup 5.539
execution cost 0:02:25.979651
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.856151, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449986| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442951| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563330| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087484| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642014| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135260| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.630001| train set 4.218x speedup, test set 0.982x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115280| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589657| train set 4.401x speedup, test set 0.842x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067184| train set 4.388x speedup, test set 0.827x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.605206| train set 4.400x speedup, test set 1.150x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.135441| train set 4.401x speedup, test set 1.090x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.671430| train set 4.548x speedup, test set 0.864x speedup, val set 4.675x speedup, step: 19
Epoch 19/200 |loss: 15.270950| train set 4.464x speedup, test set 0.865x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.021660| train set 4.600x speedup, test set 0.839x speedup, val set 4.863x speedup, step: 21
Epoch 21/200 |loss: 14.706024| train set 4.825x speedup, test set 0.868x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.118240| train set 5.034x speedup, test set 0.897x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 13.794868| train set 4.551x speedup, test set 0.879x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.565215| train set 5.058x speedup, test set 0.897x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.185258| train set 5.079x speedup, test set 1.191x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.654357| train set 5.058x speedup, test set 0.859x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.604790| train set 5.079x speedup, test set 1.203x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.279458| train set 5.079x speedup, test set 1.200x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.794063| train set 5.079x speedup, test set 1.116x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.672776| train set 5.263x speedup, test set 1.159x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.235309| train set 5.263x speedup, test set 1.128x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.380909| train set 5.263x speedup, test set 1.146x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 11.302748| train set 5.263x speedup, test set 1.166x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.862326| train set 5.262x speedup, test set 1.180x speedup, val set 5.637x speedup, step: 35
Epoch 35/200 |loss: 10.734509| train set 5.252x speedup, test set 1.277x speedup, val set 5.638x speedup, step: 36
Epoch 36/200 |loss: 10.817009| train set 5.262x speedup, test set 1.116x speedup, val set 5.638x speedup, step: 37
Epoch 37/200 |loss: 10.607980| train set 5.264x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.317711| train set 5.264x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 39
Epoch 39/200 |loss: 10.591333| train set 5.262x speedup, test set 1.129x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 10.053115| train set 5.264x speedup, test set 1.158x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 9.991664| train set 5.264x speedup, test set 1.167x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 10.104253| train set 5.262x speedup, test set 1.178x speedup, val set 5.637x speedup, step: 43
Epoch 43/200 |loss: 9.452602| train set 5.264x speedup, test set 1.117x speedup, val set 5.539x speedup, step: 44
Epoch 44/200 |loss: 9.370737| train set 5.264x speedup, test set 1.107x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.293114| train set 5.264x speedup, test set 1.085x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.077532| train set 5.262x speedup, test set 1.046x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 8.890245| train set 5.264x speedup, test set 1.039x speedup, val set 5.539x speedup, step: 48
Epoch 48/200 |loss: 8.856636| train set 5.262x speedup, test set 1.063x speedup, val set 5.637x speedup, step: 49
Epoch 49/200 |loss: 8.741711| train set 5.264x speedup, test set 1.063x speedup, val set 5.539x speedup, step: 50
Epoch 50/200 |loss: 8.590283| train set 5.264x speedup, test set 1.035x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.431851| train set 5.264x speedup, test set 1.038x speedup, val set 5.539x speedup, step: 52
Epoch 52/200 |loss: 8.418368| train set 5.264x speedup, test set 1.046x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.453829| train set 5.264x speedup, test set 1.038x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.506151| train set 5.264x speedup, test set 1.039x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.972998| train set 5.262x speedup, test set 0.849x speedup, val set 5.637x speedup, step: 56
Epoch 56/200 |loss: 8.660182| train set 5.264x speedup, test set 1.128x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 9.287805| train set 5.262x speedup, test set 0.852x speedup, val set 5.637x speedup, step: 58
Epoch 58/200 |loss: 8.896439| train set 5.262x speedup, test set 1.022x speedup, val set 5.637x speedup, step: 59
Epoch 59/200 |loss: 8.560390| train set 5.264x speedup, test set 1.015x speedup, val set 5.539x speedup, step: 60
Epoch 60/200 |loss: 8.490124| train set 5.262x speedup, test set 1.074x speedup, val set 5.637x speedup, step: 61
Epoch 61/200 |loss: 8.704389| train set 5.263x speedup, test set 1.022x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.038915| train set 5.263x speedup, test set 1.064x speedup, val set 5.539x speedup, step: 63
Epoch 63/200 |loss: 8.325739| train set 5.262x speedup, test set 1.064x speedup, val set 5.638x speedup, step: 64
Epoch 64/200 |loss: 7.961433| train set 5.263x speedup, test set 1.058x speedup, val set 5.539x speedup, step: 65
Epoch 65/200 |loss: 8.107086| train set 5.262x speedup, test set 1.045x speedup, val set 5.638x speedup, step: 66
Epoch 66/200 |loss: 7.907121| train set 5.262x speedup, test set 0.828x speedup, val set 5.638x speedup, step: 67
Epoch 67/200 |loss: 8.042053| train set 5.263x speedup, test set 1.045x speedup, val set 5.539x speedup, step: 68
Epoch 68/200 |loss: 8.073437| train set 5.262x speedup, test set 1.045x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 8.008324| train set 5.262x speedup, test set 1.089x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 7.913241| train set 5.263x speedup, test set 1.089x speedup, val set 5.539x speedup, step: 71
Epoch 71/200 |loss: 7.862414| train set 5.262x speedup, test set 0.855x speedup, val set 5.638x speedup, step: 72
Epoch 72/200 |loss: 7.806990| train set 5.262x speedup, test set 1.104x speedup, val set 5.638x speedup, step: 73
Epoch 73/200 |loss: 7.871437| train set 5.262x speedup, test set 1.089x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 7.566270| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 75
Epoch 75/200 |loss: 7.629210| train set 5.263x speedup, test set 1.089x speedup, val set 5.539x speedup, step: 76
Epoch 76/200 |loss: 7.636063| train set 5.263x speedup, test set 0.853x speedup, val set 5.539x speedup, step: 77
Epoch 77/200 |loss: 7.635684| train set 5.263x speedup, test set 0.862x speedup, val set 5.539x speedup, step: 78
Epoch 78/200 |loss: 7.609437| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 79
Epoch 79/200 |loss: 7.580334| train set 5.263x speedup, test set 1.045x speedup, val set 5.539x speedup, step: 80
Epoch 80/200 |loss: 7.685472| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.412588| train set 5.262x speedup, test set 0.862x speedup, val set 5.638x speedup, step: 82
Epoch 82/200 |loss: 7.471519| train set 5.267x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 83
Epoch 83/200 |loss: 7.489755| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 7.285211| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 85
Epoch 85/200 |loss: 7.383250| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 7.512912| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 87
Epoch 87/200 |loss: 7.307818| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 7.747113| train set 5.263x speedup, test set 1.050x speedup, val set 5.539x speedup, step: 89
Epoch 89/200 |loss: 9.056175| train set 5.263x speedup, test set 1.045x speedup, val set 5.539x speedup, step: 90
Epoch 90/200 |loss: 7.729074| train set 5.262x speedup, test set 0.853x speedup, val set 5.638x speedup, step: 91
Epoch 91/200 |loss: 9.153240| train set 5.161x speedup, test set 1.021x speedup, val set 5.483x speedup, step: 92
Epoch 92/200 |loss: 8.672786| train set 5.263x speedup, test set 1.045x speedup, val set 5.539x speedup, step: 93
Epoch 93/200 |loss: 8.390186| train set 5.262x speedup, test set 1.045x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 8.880604| train set 5.263x speedup, test set 1.110x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 8.268092| train set 5.056x speedup, test set 1.091x speedup, val set 5.362x speedup, step: 96
Epoch 96/200 |loss: 8.225098| train set 5.262x speedup, test set 1.039x speedup, val set 5.638x speedup, step: 97
Epoch 97/200 |loss: 8.163839| train set 5.262x speedup, test set 1.098x speedup, val set 5.638x speedup, step: 98
Epoch 98/200 |loss: 7.975603| train set 5.262x speedup, test set 1.090x speedup, val set 5.638x speedup, step: 99
Epoch 99/200 |loss: 7.966498| train set 5.262x speedup, test set 1.037x speedup, val set 5.638x speedup, step: 100
Epoch 100/200 |loss: 7.707940| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 1
Epoch 101/200 |loss: 7.812385| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 1
Epoch 102/200 |loss: 7.613030| train set 5.263x speedup, test set 1.088x speedup, val set 5.539x speedup, step: 1
Epoch 103/200 |loss: 7.608339| train set 5.263x speedup, test set 1.088x speedup, val set 5.539x speedup, step: 1
Epoch 104/200 |loss: 7.560113| train set 5.263x speedup, test set 1.097x speedup, val set 5.539x speedup, step: 1
Epoch 105/200 |loss: 7.528702| train set 5.263x speedup, test set 1.091x speedup, val set 5.539x speedup, step: 1
Epoch 106/200 |loss: 7.439735| train set 5.263x speedup, test set 1.091x speedup, val set 5.539x speedup, step: 1
Epoch 107/200 |loss: 7.442569| train set 5.263x speedup, test set 0.856x speedup, val set 5.539x speedup, step: 1
Epoch 108/200 |loss: 7.348301| train set 5.263x speedup, test set 0.856x speedup, val set 5.539x speedup, step: 1
Epoch 109/200 |loss: 7.346892| train set 5.263x speedup, test set 1.091x speedup, val set 5.539x speedup, step: 1
Epoch 110/200 |loss: 7.296404| train set 5.262x speedup, test set 1.091x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.232807| train set 5.262x speedup, test set 0.856x speedup, val set 5.638x speedup, step: 1
Epoch 112/200 |loss: 7.237391| train set 5.262x speedup, test set 0.856x speedup, val set 5.638x speedup, step: 1
Epoch 113/200 |loss: 7.175634| train set 5.262x speedup, test set 0.856x speedup, val set 5.638x speedup, step: 1
Epoch 114/200 |loss: 7.183918| train set 5.263x speedup, test set 0.855x speedup, val set 5.539x speedup, step: 2
Epoch 115/200 |loss: 7.146661| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.152413| train set 5.262x speedup, test set 0.827x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.148681| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 118/200 |loss: 7.246902| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 3
Epoch 119/200 |loss: 7.343470| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 120/200 |loss: 7.499444| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 121/200 |loss: 7.413900| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 122/200 |loss: 7.143329| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 123/200 |loss: 7.170082| train set 5.263x speedup, test set 0.813x speedup, val set 5.539x speedup, step: 3
Epoch 124/200 |loss: 7.185435| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 125/200 |loss: 7.184155| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 126/200 |loss: 7.129711| train set 5.262x speedup, test set 0.813x speedup, val set 5.638x speedup, step: 1
Epoch 127/200 |loss: 7.126919| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 128/200 |loss: 7.205175| train set 5.262x speedup, test set 0.813x speedup, val set 5.638x speedup, step: 1
Epoch 129/200 |loss: 7.062823| train set 5.262x speedup, test set 0.813x speedup, val set 5.638x speedup, step: 1
Epoch 130/200 |loss: 6.996900| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 131/200 |loss: 7.098418| train set 5.262x speedup, test set 0.813x speedup, val set 5.638x speedup, step: 1
Epoch 132/200 |loss: 7.057648| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 133/200 |loss: 6.998346| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 134/200 |loss: 6.958894| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 135/200 |loss: 6.992126| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 136/200 |loss: 7.008472| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 137/200 |loss: 6.937638| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 138/200 |loss: 6.925342| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 139/200 |loss: 6.963764| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 140/200 |loss: 7.005427| train set 5.262x speedup, test set 0.813x speedup, val set 5.638x speedup, step: 1
Epoch 141/200 |loss: 7.055906| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 142/200 |loss: 7.211316| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 143/200 |loss: 7.200352| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 144/200 |loss: 7.499001| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 145/200 |loss: 7.044174| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 146/200 |loss: 7.062132| train set 5.263x speedup, test set 0.824x speedup, val set 5.539x speedup, step: 2
Epoch 147/200 |loss: 7.350367| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 148/200 |loss: 7.040312| train set 5.262x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 1
Epoch 149/200 |loss: 7.049384| train set 5.263x speedup, test set 0.832x speedup, val set 5.539x speedup, step: 2
Epoch 150/200 |loss: 7.257332| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 1
Epoch 151/200 |loss: 6.962196| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 1
Epoch 152/200 |loss: 7.073825| train set 5.263x speedup, test set 0.832x speedup, val set 5.539x speedup, step: 2
Epoch 153/200 |loss: 7.218627| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 3
Epoch 154/200 |loss: 6.905824| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 155/200 |loss: 7.142416| train set 5.263x speedup, test set 0.831x speedup, val set 5.539x speedup, step: 2
Epoch 156/200 |loss: 7.110333| train set 5.263x speedup, test set 0.831x speedup, val set 5.539x speedup, step: 3
Epoch 157/200 |loss: 6.927277| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 158/200 |loss: 7.140222| train set 5.263x speedup, test set 0.815x speedup, val set 5.539x speedup, step: 2
Epoch 159/200 |loss: 7.038340| train set 5.263x speedup, test set 0.831x speedup, val set 5.539x speedup, step: 3
Epoch 160/200 |loss: 6.998476| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 161/200 |loss: 7.095592| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 162/200 |loss: 6.956459| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 2
Epoch 163/200 |loss: 7.019643| train set 5.262x speedup, test set 0.805x speedup, val set 5.638x speedup, step: 1
Epoch 164/200 |loss: 6.948612| train set 5.262x speedup, test set 0.793x speedup, val set 5.638x speedup, step: 1
Epoch 165/200 |loss: 7.067339| train set 5.263x speedup, test set 0.826x speedup, val set 5.539x speedup, step: 2
Epoch 166/200 |loss: 7.073188| train set 5.262x speedup, test set 0.806x speedup, val set 5.638x speedup, step: 1
Epoch 167/200 |loss: 7.154120| train set 5.262x speedup, test set 0.806x speedup, val set 5.638x speedup, step: 1
Epoch 168/200 |loss: 7.033126| train set 5.263x speedup, test set 0.803x speedup, val set 5.539x speedup, step: 2
Epoch 169/200 |loss: 6.945864| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 3
Epoch 170/200 |loss: 6.908715| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 171/200 |loss: 6.922945| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 172/200 |loss: 7.017726| train set 5.263x speedup, test set 0.827x speedup, val set 5.539x speedup, step: 2
Epoch 173/200 |loss: 6.976768| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 174/200 |loss: 7.013354| train set 5.267x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 175/200 |loss: 6.912086| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 176/200 |loss: 6.846539| train set 5.262x speedup, test set 0.803x speedup, val set 5.638x speedup, step: 1
Epoch 177/200 |loss: 6.869701| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 178/200 |loss: 6.871451| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 2
Epoch 179/200 |loss: 6.926258| train set 5.267x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 180/200 |loss: 6.915043| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 2
Epoch 181/200 |loss: 6.947432| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 182/200 |loss: 6.860897| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 2
Epoch 183/200 |loss: 6.826380| train set 5.263x speedup, test set 0.811x speedup, val set 5.539x speedup, step: 3
Epoch 184/200 |loss: 6.808525| train set 5.262x speedup, test set 0.812x speedup, val set 5.638x speedup, step: 1
Epoch 185/200 |loss: 6.832347| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 2
Epoch 186/200 |loss: 6.878252| train set 5.262x speedup, test set 0.811x speedup, val set 5.638x speedup, step: 1
Epoch 187/200 |loss: 6.923335| train set 5.262x speedup, test set 0.801x speedup, val set 5.638x speedup, step: 1
Epoch 188/200 |loss: 7.189080| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 2
Epoch 189/200 |loss: 6.931678| train set 5.263x speedup, test set 0.806x speedup, val set 5.539x speedup, step: 3
Epoch 190/200 |loss: 6.844051| train set 5.263x speedup, test set 0.796x speedup, val set 5.539x speedup, step: 4
Epoch 191/200 |loss: 6.848846| train set 5.263x speedup, test set 0.801x speedup, val set 5.539x speedup, step: 5
Epoch 192/200 |loss: 6.962540| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 6
Epoch 193/200 |loss: 7.358010| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 1
Epoch 194/200 |loss: 6.938874| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 195/200 |loss: 7.089101| train set 5.263x speedup, test set 0.794x speedup, val set 5.539x speedup, step: 2
Epoch 196/200 |loss: 7.621817| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 3
Epoch 197/200 |loss: 6.871300| train set 5.263x speedup, test set 0.812x speedup, val set 5.539x speedup, step: 4
Epoch 198/200 |loss: 7.745553| train set 5.263x speedup, test set 0.809x speedup, val set 5.539x speedup, step: 5
Epoch 199/200 |loss: 8.194518| train set 5.262x speedup, test set 0.824x speedup, val set 5.638x speedup, step: 1
Training per epoch cost 0.220 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 48.924s, pg runtime 13.945s, speedup 0.285x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.072s, pg runtime 0.089s, speedup 1.239x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 3.523s, pg runtime 2.389s, speedup 0.678x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.179s, pg runtime 0.157s, speedup 0.875x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 4.513s, pg runtime 6.444s, speedup 1.428x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 82, train speedup 5.267, test speedup 0.826, val speedup 5.638
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 199, train speedup 5.262, test speedup 0.824, val speedup 5.638
last model at epoch 199, train speedup 5.262, test speedup 0.824, val speedup 5.638
execution cost 0:02:21.894087
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.850660, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719934| train set 3.074x speedup, test set 1.286x speedup, val set 3.289x speedup, step: 1
Epoch 1/200 |loss: 24.039597| train set 3.095x speedup, test set 1.633x speedup, val set 3.310x speedup, step: 2
Epoch 2/200 |loss: 23.449984| train set 3.414x speedup, test set 1.170x speedup, val set 3.571x speedup, step: 3
Epoch 3/200 |loss: 23.036068| train set 3.304x speedup, test set 1.135x speedup, val set 3.453x speedup, step: 4
Epoch 4/200 |loss: 22.442951| train set 3.594x speedup, test set 0.926x speedup, val set 3.724x speedup, step: 5
Epoch 5/200 |loss: 21.963156| train set 3.936x speedup, test set 1.033x speedup, val set 4.090x speedup, step: 6
Epoch 6/200 |loss: 21.563330| train set 3.650x speedup, test set 1.574x speedup, val set 3.778x speedup, step: 7
Epoch 7/200 |loss: 21.087484| train set 3.529x speedup, test set 1.510x speedup, val set 3.691x speedup, step: 8
Epoch 8/200 |loss: 20.613010| train set 3.434x speedup, test set 1.004x speedup, val set 3.631x speedup, step: 9
Epoch 9/200 |loss: 20.114958| train set 3.775x speedup, test set 0.780x speedup, val set 3.984x speedup, step: 10
Epoch 10/200 |loss: 19.642014| train set 3.878x speedup, test set 1.008x speedup, val set 4.030x speedup, step: 11
Epoch 11/200 |loss: 19.135260| train set 3.943x speedup, test set 0.981x speedup, val set 4.096x speedup, step: 12
Epoch 12/200 |loss: 18.630001| train set 4.218x speedup, test set 0.982x speedup, val set 4.456x speedup, step: 13
Epoch 13/200 |loss: 18.115280| train set 4.054x speedup, test set 0.828x speedup, val set 4.215x speedup, step: 14
Epoch 14/200 |loss: 17.589657| train set 4.401x speedup, test set 0.842x speedup, val set 4.598x speedup, step: 15
Epoch 15/200 |loss: 17.067184| train set 4.388x speedup, test set 0.827x speedup, val set 4.598x speedup, step: 16
Epoch 16/200 |loss: 16.605206| train set 4.400x speedup, test set 1.150x speedup, val set 4.598x speedup, step: 17
Epoch 17/200 |loss: 16.135439| train set 4.401x speedup, test set 1.090x speedup, val set 4.598x speedup, step: 18
Epoch 18/200 |loss: 15.671427| train set 4.548x speedup, test set 0.864x speedup, val set 4.675x speedup, step: 19
Epoch 19/200 |loss: 15.270950| train set 4.464x speedup, test set 0.865x speedup, val set 4.639x speedup, step: 20
Epoch 20/200 |loss: 15.021666| train set 4.600x speedup, test set 0.839x speedup, val set 4.863x speedup, step: 21
Epoch 21/200 |loss: 14.706026| train set 4.825x speedup, test set 0.868x speedup, val set 5.077x speedup, step: 22
Epoch 22/200 |loss: 14.118226| train set 5.034x speedup, test set 0.897x speedup, val set 5.256x speedup, step: 23
Epoch 23/200 |loss: 13.795016| train set 4.551x speedup, test set 0.879x speedup, val set 4.781x speedup, step: 24
Epoch 24/200 |loss: 13.564336| train set 5.058x speedup, test set 0.897x speedup, val set 5.282x speedup, step: 25
Epoch 25/200 |loss: 13.179976| train set 5.079x speedup, test set 1.179x speedup, val set 5.304x speedup, step: 26
Epoch 26/200 |loss: 12.654531| train set 5.058x speedup, test set 0.852x speedup, val set 5.282x speedup, step: 27
Epoch 27/200 |loss: 12.595661| train set 5.079x speedup, test set 1.190x speedup, val set 5.304x speedup, step: 28
Epoch 28/200 |loss: 12.283731| train set 5.079x speedup, test set 1.200x speedup, val set 5.304x speedup, step: 29
Epoch 29/200 |loss: 11.789272| train set 5.074x speedup, test set 1.116x speedup, val set 5.304x speedup, step: 30
Epoch 30/200 |loss: 11.656716| train set 5.263x speedup, test set 1.167x speedup, val set 5.540x speedup, step: 31
Epoch 31/200 |loss: 11.242517| train set 5.263x speedup, test set 1.128x speedup, val set 5.540x speedup, step: 32
Epoch 32/200 |loss: 11.287446| train set 5.263x speedup, test set 1.256x speedup, val set 5.540x speedup, step: 33
Epoch 33/200 |loss: 11.216232| train set 5.263x speedup, test set 1.176x speedup, val set 5.540x speedup, step: 34
Epoch 34/200 |loss: 10.739060| train set 5.262x speedup, test set 1.178x speedup, val set 5.637x speedup, step: 35
Epoch 35/200 |loss: 10.631473| train set 5.263x speedup, test set 1.163x speedup, val set 5.540x speedup, step: 36
Epoch 36/200 |loss: 10.193607| train set 5.241x speedup, test set 1.115x speedup, val set 5.517x speedup, step: 37
Epoch 37/200 |loss: 10.404365| train set 5.264x speedup, test set 1.157x speedup, val set 5.539x speedup, step: 38
Epoch 38/200 |loss: 10.150800| train set 5.262x speedup, test set 1.114x speedup, val set 5.637x speedup, step: 39
Epoch 39/200 |loss: 10.411599| train set 5.262x speedup, test set 0.873x speedup, val set 5.637x speedup, step: 40
Epoch 40/200 |loss: 10.268418| train set 5.264x speedup, test set 1.225x speedup, val set 5.539x speedup, step: 41
Epoch 41/200 |loss: 10.833550| train set 5.264x speedup, test set 1.108x speedup, val set 5.539x speedup, step: 42
Epoch 42/200 |loss: 9.745289| train set 5.262x speedup, test set 1.126x speedup, val set 5.637x speedup, step: 43
Epoch 43/200 |loss: 10.385914| train set 5.264x speedup, test set 1.155x speedup, val set 5.539x speedup, step: 44
Epoch 44/200 |loss: 9.585763| train set 5.264x speedup, test set 1.138x speedup, val set 5.539x speedup, step: 45
Epoch 45/200 |loss: 9.611302| train set 5.264x speedup, test set 1.092x speedup, val set 5.539x speedup, step: 46
Epoch 46/200 |loss: 9.509162| train set 5.262x speedup, test set 1.116x speedup, val set 5.637x speedup, step: 47
Epoch 47/200 |loss: 9.182366| train set 5.262x speedup, test set 1.141x speedup, val set 5.637x speedup, step: 48
Epoch 48/200 |loss: 9.214265| train set 5.262x speedup, test set 1.117x speedup, val set 5.637x speedup, step: 49
Epoch 49/200 |loss: 8.946404| train set 5.262x speedup, test set 1.107x speedup, val set 5.637x speedup, step: 50
Epoch 50/200 |loss: 8.866331| train set 5.264x speedup, test set 1.155x speedup, val set 5.539x speedup, step: 51
Epoch 51/200 |loss: 8.666942| train set 5.262x speedup, test set 1.075x speedup, val set 5.637x speedup, step: 52
Epoch 52/200 |loss: 8.776011| train set 5.264x speedup, test set 1.079x speedup, val set 5.539x speedup, step: 53
Epoch 53/200 |loss: 8.426717| train set 5.264x speedup, test set 1.111x speedup, val set 5.539x speedup, step: 54
Epoch 54/200 |loss: 8.492683| train set 5.264x speedup, test set 1.039x speedup, val set 5.539x speedup, step: 55
Epoch 55/200 |loss: 8.362979| train set 5.264x speedup, test set 1.047x speedup, val set 5.539x speedup, step: 56
Epoch 56/200 |loss: 8.319258| train set 5.264x speedup, test set 1.094x speedup, val set 5.539x speedup, step: 57
Epoch 57/200 |loss: 8.687584| train set 5.262x speedup, test set 1.029x speedup, val set 5.638x speedup, step: 58
Epoch 58/200 |loss: 9.583175| train set 5.264x speedup, test set 1.070x speedup, val set 5.539x speedup, step: 59
Epoch 59/200 |loss: 9.244727| train set 5.262x speedup, test set 0.827x speedup, val set 5.637x speedup, step: 60
Epoch 60/200 |loss: 8.802254| train set 5.263x speedup, test set 1.029x speedup, val set 5.539x speedup, step: 61
Epoch 61/200 |loss: 8.811438| train set 5.263x speedup, test set 1.043x speedup, val set 5.539x speedup, step: 62
Epoch 62/200 |loss: 8.429715| train set 5.262x speedup, test set 1.086x speedup, val set 5.638x speedup, step: 63
Epoch 63/200 |loss: 8.845823| train set 5.262x speedup, test set 1.018x speedup, val set 5.638x speedup, step: 64
Epoch 64/200 |loss: 8.650472| train set 5.262x speedup, test set 0.809x speedup, val set 5.638x speedup, step: 65
Epoch 65/200 |loss: 8.418067| train set 5.263x speedup, test set 0.825x speedup, val set 5.539x speedup, step: 66
Epoch 66/200 |loss: 8.531176| train set 5.263x speedup, test set 1.035x speedup, val set 5.539x speedup, step: 67
Epoch 67/200 |loss: 8.214008| train set 5.262x speedup, test set 1.045x speedup, val set 5.638x speedup, step: 68
Epoch 68/200 |loss: 8.295971| train set 5.262x speedup, test set 1.053x speedup, val set 5.638x speedup, step: 69
Epoch 69/200 |loss: 8.103117| train set 5.262x speedup, test set 1.063x speedup, val set 5.638x speedup, step: 70
Epoch 70/200 |loss: 8.040354| train set 5.262x speedup, test set 1.053x speedup, val set 5.638x speedup, step: 71
Epoch 71/200 |loss: 7.987619| train set 5.263x speedup, test set 1.053x speedup, val set 5.539x speedup, step: 72
Epoch 72/200 |loss: 7.886376| train set 5.263x speedup, test set 1.045x speedup, val set 5.539x speedup, step: 73
Epoch 73/200 |loss: 7.835006| train set 5.262x speedup, test set 1.045x speedup, val set 5.638x speedup, step: 74
Epoch 74/200 |loss: 7.763755| train set 5.263x speedup, test set 1.045x speedup, val set 5.539x speedup, step: 75
Epoch 75/200 |loss: 7.829024| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 76
Epoch 76/200 |loss: 7.721808| train set 5.262x speedup, test set 1.045x speedup, val set 5.638x speedup, step: 77
Epoch 77/200 |loss: 7.621051| train set 5.267x speedup, test set 1.045x speedup, val set 5.638x speedup, step: 78
Epoch 78/200 |loss: 7.563354| train set 5.263x speedup, test set 1.053x speedup, val set 5.539x speedup, step: 79
Epoch 79/200 |loss: 7.534880| train set 5.263x speedup, test set 0.831x speedup, val set 5.539x speedup, step: 80
Epoch 80/200 |loss: 7.438813| train set 5.262x speedup, test set 0.826x speedup, val set 5.638x speedup, step: 81
Epoch 81/200 |loss: 7.521496| train set 5.263x speedup, test set 1.066x speedup, val set 5.539x speedup, step: 82
Epoch 82/200 |loss: 7.723586| train set 5.179x speedup, test set 0.826x speedup, val set 5.679x speedup, step: 83
Epoch 83/200 |loss: 8.198024| train set 5.263x speedup, test set 1.099x speedup, val set 5.539x speedup, step: 84
Epoch 84/200 |loss: 9.641023| train set 5.263x speedup, test set 0.850x speedup, val set 5.539x speedup, step: 85
Epoch 85/200 |loss: 8.442452| train set 5.262x speedup, test set 0.854x speedup, val set 5.638x speedup, step: 86
Epoch 86/200 |loss: 8.749676| train set 5.055x speedup, test set 1.160x speedup, val set 5.363x speedup, step: 87
Epoch 87/200 |loss: 8.382385| train set 5.262x speedup, test set 1.105x speedup, val set 5.638x speedup, step: 88
Epoch 88/200 |loss: 8.069023| train set 5.262x speedup, test set 0.841x speedup, val set 5.638x speedup, step: 89
Epoch 89/200 |loss: 7.979769| train set 5.262x speedup, test set 0.831x speedup, val set 5.638x speedup, step: 90
Epoch 90/200 |loss: 7.884202| train set 5.263x speedup, test set 1.071x speedup, val set 5.539x speedup, step: 91
Epoch 91/200 |loss: 7.962265| train set 5.262x speedup, test set 1.102x speedup, val set 5.638x speedup, step: 92
Epoch 92/200 |loss: 7.749778| train set 5.262x speedup, test set 0.844x speedup, val set 5.638x speedup, step: 93
Epoch 93/200 |loss: 7.713829| train set 5.262x speedup, test set 1.088x speedup, val set 5.638x speedup, step: 94
Epoch 94/200 |loss: 7.606818| train set 5.263x speedup, test set 1.088x speedup, val set 5.539x speedup, step: 95
Epoch 95/200 |loss: 7.649739| train set 5.263x speedup, test set 0.853x speedup, val set 5.539x speedup, step: 96
Epoch 96/200 |loss: 7.467556| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 97
Epoch 97/200 |loss: 7.516201| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 98
Epoch 98/200 |loss: 7.462850| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 99
Epoch 99/200 |loss: 7.370837| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 100
Epoch 100/200 |loss: 7.353085| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 101/200 |loss: 7.319127| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 102/200 |loss: 7.311597| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 103/200 |loss: 7.280711| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 104/200 |loss: 7.325032| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 2
Epoch 105/200 |loss: 7.305460| train set 5.263x speedup, test set 0.789x speedup, val set 5.539x speedup, step: 3
Epoch 106/200 |loss: 7.288708| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 4
Epoch 107/200 |loss: 7.180493| train set 5.263x speedup, test set 0.817x speedup, val set 5.539x speedup, step: 5
Epoch 108/200 |loss: 7.167084| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 109/200 |loss: 7.191723| train set 5.262x speedup, test set 0.817x speedup, val set 5.638x speedup, step: 1
Epoch 110/200 |loss: 7.296444| train set 5.262x speedup, test set 0.786x speedup, val set 5.638x speedup, step: 1
Epoch 111/200 |loss: 7.182720| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 2
Epoch 112/200 |loss: 7.098302| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 3
Epoch 113/200 |loss: 7.072814| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 4
Epoch 114/200 |loss: 7.122025| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 5
Epoch 115/200 |loss: 7.223341| train set 5.262x speedup, test set 0.789x speedup, val set 5.638x speedup, step: 1
Epoch 116/200 |loss: 7.556609| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 1
Epoch 117/200 |loss: 7.432235| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 2
Epoch 118/200 |loss: 7.490877| train set 5.253x speedup, test set 0.802x speedup, val set 5.657x speedup, step: 1
Epoch 119/200 |loss: 7.539786| train set 5.263x speedup, test set 1.027x speedup, val set 5.539x speedup, step: 2
Epoch 120/200 |loss: 8.312266| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 3
Epoch 121/200 |loss: 7.566363| train set 5.179x speedup, test set 0.812x speedup, val set 5.679x speedup, step: 1
Epoch 122/200 |loss: 8.219558| train set 5.263x speedup, test set 1.031x speedup, val set 5.540x speedup, step: 2
Epoch 123/200 |loss: 7.661667| train set 5.263x speedup, test set 1.014x speedup, val set 5.539x speedup, step: 3
Epoch 124/200 |loss: 7.612801| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 4
Epoch 125/200 |loss: 7.528216| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 5
Epoch 126/200 |loss: 7.491923| train set 5.262x speedup, test set 1.031x speedup, val set 5.638x speedup, step: 6
Epoch 127/200 |loss: 7.477118| train set 5.262x speedup, test set 1.007x speedup, val set 5.638x speedup, step: 7
Epoch 128/200 |loss: 7.397367| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 8
Epoch 129/200 |loss: 7.321149| train set 5.263x speedup, test set 0.823x speedup, val set 5.539x speedup, step: 9
Epoch 130/200 |loss: 7.326212| train set 5.263x speedup, test set 1.038x speedup, val set 5.539x speedup, step: 10
Epoch 131/200 |loss: 7.282909| train set 5.263x speedup, test set 0.807x speedup, val set 5.539x speedup, step: 11
Epoch 132/200 |loss: 7.258714| train set 5.262x speedup, test set 0.807x speedup, val set 5.638x speedup, step: 12
Epoch 133/200 |loss: 7.214978| train set 5.262x speedup, test set 1.030x speedup, val set 5.638x speedup, step: 13
Epoch 134/200 |loss: 7.192988| train set 5.263x speedup, test set 1.037x speedup, val set 5.539x speedup, step: 14
Epoch 135/200 |loss: 7.164077| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 15
Epoch 136/200 |loss: 7.151134| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 16
Epoch 137/200 |loss: 7.112597| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 17
Epoch 138/200 |loss: 7.063836| train set 5.262x speedup, test set 0.823x speedup, val set 5.638x speedup, step: 18
Epoch 139/200 |loss: 7.095684| train set 5.262x speedup, test set 0.823x speedup, val set 5.638x speedup, step: 19
Epoch 140/200 |loss: 7.022677| train set 5.262x speedup, test set 0.823x speedup, val set 5.638x speedup, step: 20
Epoch 141/200 |loss: 7.040402| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 21
Epoch 142/200 |loss: 7.031844| train set 5.263x speedup, test set 0.821x speedup, val set 5.539x speedup, step: 22
Epoch 143/200 |loss: 6.993917| train set 5.262x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 23
Epoch 144/200 |loss: 7.001515| train set 5.262x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 24
Epoch 145/200 |loss: 6.974560| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 25
Epoch 146/200 |loss: 6.980777| train set 5.263x speedup, test set 0.822x speedup, val set 5.539x speedup, step: 26
Epoch 147/200 |loss: 6.967919| train set 5.262x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 27
Epoch 148/200 |loss: 6.936614| train set 5.262x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 28
Epoch 149/200 |loss: 6.944347| train set 5.262x speedup, test set 0.823x speedup, val set 5.638x speedup, step: 29
Epoch 150/200 |loss: 6.926285| train set 5.262x speedup, test set 0.822x speedup, val set 5.638x speedup, step: 30
Epoch 151/200 |loss: 6.919427| train set 5.263x speedup, test set 0.823x speedup, val set 5.539x speedup, step: 31
Epoch 152/200 |loss: 6.921273| train set 5.263x speedup, test set 0.823x speedup, val set 5.539x speedup, step: 32
Epoch 153/200 |loss: 6.908345| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 33
Epoch 154/200 |loss: 6.942634| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 34
Epoch 155/200 |loss: 7.016848| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 35
Epoch 156/200 |loss: 7.064806| train set 5.263x speedup, test set 0.823x speedup, val set 5.539x speedup, step: 36
Epoch 157/200 |loss: 7.353051| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 37
Epoch 158/200 |loss: 7.026314| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 38
Epoch 159/200 |loss: 6.959627| train set 5.263x speedup, test set 0.823x speedup, val set 5.539x speedup, step: 39
Epoch 160/200 |loss: 6.961657| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 40
Epoch 161/200 |loss: 7.055618| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 41
Epoch 162/200 |loss: 7.177943| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 42
Epoch 163/200 |loss: 6.927921| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 43
Epoch 164/200 |loss: 7.010133| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 44
Epoch 165/200 |loss: 7.127984| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 45
Epoch 166/200 |loss: 6.966733| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 46
Epoch 167/200 |loss: 7.008909| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 47
Epoch 168/200 |loss: 7.026253| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 48
Epoch 169/200 |loss: 6.937078| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 49
Epoch 170/200 |loss: 6.990765| train set 5.263x speedup, test set 0.804x speedup, val set 5.539x speedup, step: 50
Epoch 171/200 |loss: 7.043258| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 51
Epoch 172/200 |loss: 6.999671| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 52
Epoch 173/200 |loss: 6.918651| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 53
Epoch 174/200 |loss: 7.013367| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 54
Epoch 175/200 |loss: 6.945814| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 55
Epoch 176/200 |loss: 6.926903| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 56
Epoch 177/200 |loss: 7.052803| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 57
Epoch 178/200 |loss: 6.881322| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 58
Epoch 179/200 |loss: 6.930868| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 59
Epoch 180/200 |loss: 6.925819| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 60
Epoch 181/200 |loss: 6.946507| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 61
Epoch 182/200 |loss: 6.979815| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 62
Epoch 183/200 |loss: 6.985768| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 63
Epoch 184/200 |loss: 7.046411| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 64
Epoch 185/200 |loss: 6.879385| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 65
Epoch 186/200 |loss: 6.898899| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 66
Epoch 187/200 |loss: 6.961726| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 67
Epoch 188/200 |loss: 7.009807| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 68
Epoch 189/200 |loss: 7.067142| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 69
Epoch 190/200 |loss: 6.903392| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 70
Epoch 191/200 |loss: 6.891132| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 71
Epoch 192/200 |loss: 6.957553| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 72
Epoch 193/200 |loss: 6.967399| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 73
Epoch 194/200 |loss: 7.020237| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 74
Epoch 195/200 |loss: 6.902903| train set 5.262x speedup, test set 0.808x speedup, val set 5.638x speedup, step: 75
Epoch 196/200 |loss: 6.928367| train set 5.263x speedup, test set 0.802x speedup, val set 5.539x speedup, step: 76
Epoch 197/200 |loss: 7.070637| train set 5.263x speedup, test set 0.799x speedup, val set 5.539x speedup, step: 77
Epoch 198/200 |loss: 6.903643| train set 5.263x speedup, test set 0.808x speedup, val set 5.539x speedup, step: 78
Epoch 199/200 |loss: 6.843099| train set 5.262x speedup, test set 0.802x speedup, val set 5.638x speedup, step: 79
Training per epoch cost 0.231 s
Optimal speedup on test set is 3.408x
01, opt runtime 0.007s, model runtime 0.084s, pg runtime 0.081s, speedup 0.961x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.207s, model runtime 0.207s, pg runtime 0.207s, speedup 1.000x
04, opt runtime 0.920s, model runtime 1.680s, pg runtime 1.680s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.846s, model runtime 10.406s, pg runtime 3.507s, speedup 0.337x
11, opt runtime 4.443s, model runtime 49.329s, pg runtime 13.945s, speedup 0.283x
12, opt runtime 0.517s, model runtime 0.517s, pg runtime 0.738s, speedup 1.427x
13, opt runtime 2.413s, model runtime 57.198s, pg runtime 57.198s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 2.238s, model runtime 2.718s, pg runtime 2.718s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.962s, model runtime 6.876s, pg runtime 6.876s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.064s, model runtime 0.064s, pg runtime 0.089s, speedup 1.393x
21, opt runtime 0.953s, model runtime 1.038s, pg runtime 4.730s, speedup 4.558x
22, opt runtime 0.093s, model runtime 2.389s, pg runtime 2.389s, speedup 1.000x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
25, opt runtime 4.173s, model runtime 8.279s, pg runtime 8.279s, speedup 1.000x
26, opt runtime 0.161s, model runtime 0.161s, pg runtime 0.161s, speedup 1.000x
27, opt runtime 0.068s, model runtime 0.089s, pg runtime 0.239s, speedup 2.681x
28, opt runtime 0.157s, model runtime 0.157s, pg runtime 0.157s, speedup 1.000x
29, opt runtime 0.158s, model runtime 1.434s, pg runtime 0.158s, speedup 0.110x
30, opt runtime 1.646s, model runtime 4.855s, pg runtime 4.855s, speedup 1.000x
31, opt runtime 2.971s, model runtime 8.605s, pg runtime 8.605s, speedup 1.000x
32, opt runtime 4.513s, model runtime 8.556s, pg runtime 6.444s, speedup 0.753x
33, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
====================
best train speedup epoch: 77, train speedup 5.267, test speedup 1.045, val speedup 5.638
best test speedup epoch: 1, train speedup 3.095, test speedup 1.633, val speedup 3.310
best validation speedup epoch: 121, train speedup 5.179, test speedup 0.812, val speedup 5.679
last model at epoch 199, train speedup 5.262, test speedup 0.802, val speedup 5.638
execution cost 0:02:22.835386
==================================================
