all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.599200, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.380688| train set 4.822x speedup, test set 0.936x speedup, val set 4.820x speedup, step: 1, train time 17.01 s
Epoch 1/50 |loss: 0.248690| train set 5.091x speedup, test set 0.814x speedup, val set 5.110x speedup, step: 2, train time 14.22 s
Epoch 2/50 |loss: 0.204601| train set 5.305x speedup, test set 0.888x speedup, val set 5.336x speedup, step: 3, train time 14.12 s
Epoch 3/50 |loss: 0.185247| train set 5.297x speedup, test set 1.043x speedup, val set 5.316x speedup, step: 4, train time 14.39 s
Epoch 4/50 |loss: 0.180342| train set 5.295x speedup, test set 0.888x speedup, val set 5.323x speedup, step: 1, train time 14.12 s
Epoch 5/50 |loss: 0.169980| train set 5.231x speedup, test set 0.937x speedup, val set 5.256x speedup, step: 2, train time 14.29 s
Epoch 6/50 |loss: 0.165626| train set 5.295x speedup, test set 0.876x speedup, val set 5.323x speedup, step: 3, train time 14.24 s
Epoch 7/50 |loss: 0.158834| train set 5.297x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 4, train time 14.29 s
Epoch 8/50 |loss: 0.157015| train set 5.305x speedup, test set 0.931x speedup, val set 5.323x speedup, step: 5, train time 14.13 s
Epoch 9/50 |loss: 0.153499| train set 5.306x speedup, test set 0.930x speedup, val set 5.336x speedup, step: 1, train time 14.11 s
Epoch 10/50 |loss: 0.149006| train set 5.220x speedup, test set 0.898x speedup, val set 5.250x speedup, step: 2, train time 14.10 s
Epoch 11/50 |loss: 0.145246| train set 5.297x speedup, test set 0.777x speedup, val set 5.317x speedup, step: 3, train time 14.13 s
Epoch 12/50 |loss: 0.142852| train set 5.295x speedup, test set 0.909x speedup, val set 5.321x speedup, step: 4, train time 14.12 s
Epoch 13/50 |loss: 0.144438| train set 5.221x speedup, test set 0.898x speedup, val set 5.243x speedup, step: 5, train time 14.21 s
Epoch 14/50 |loss: 0.137632| train set 5.218x speedup, test set 0.908x speedup, val set 5.254x speedup, step: 6, train time 14.12 s
Epoch 15/50 |loss: 0.139687| train set 5.078x speedup, test set 0.909x speedup, val set 5.067x speedup, step: 7, train time 14.13 s
Epoch 16/50 |loss: 0.138794| train set 5.295x speedup, test set 0.872x speedup, val set 5.310x speedup, step: 8, train time 14.19 s
Epoch 17/50 |loss: 0.137877| train set 5.297x speedup, test set 0.824x speedup, val set 5.317x speedup, step: 9, train time 14.27 s
Epoch 18/50 |loss: 0.133344| train set 5.204x speedup, test set 0.872x speedup, val set 5.227x speedup, step: 10, train time 14.22 s
Epoch 19/50 |loss: 0.134180| train set 5.305x speedup, test set 0.860x speedup, val set 5.334x speedup, step: 11, train time 14.03 s
Epoch 20/50 |loss: 0.132983| train set 5.305x speedup, test set 0.824x speedup, val set 5.334x speedup, step: 12, train time 14.22 s
Epoch 21/50 |loss: 0.135879| train set 5.305x speedup, test set 0.872x speedup, val set 5.334x speedup, step: 13, train time 14.90 s
Epoch 22/50 |loss: 0.131464| train set 5.308x speedup, test set 0.870x speedup, val set 5.330x speedup, step: 14, train time 14.13 s
Epoch 23/50 |loss: 0.130922| train set 5.306x speedup, test set 0.869x speedup, val set 5.336x speedup, step: 15, train time 14.02 s
Epoch 24/50 |loss: 0.130697| train set 5.256x speedup, test set 0.811x speedup, val set 5.270x speedup, step: 16, train time 14.30 s
Epoch 25/50 |loss: 0.132949| train set 5.254x speedup, test set 0.801x speedup, val set 5.267x speedup, step: 17, train time 14.24 s
Epoch 26/50 |loss: 0.127590| train set 5.308x speedup, test set 0.799x speedup, val set 5.330x speedup, step: 18, train time 14.15 s
Epoch 27/50 |loss: 0.128822| train set 5.303x speedup, test set 0.853x speedup, val set 5.322x speedup, step: 19, train time 14.22 s
Epoch 28/50 |loss: 0.126878| train set 5.305x speedup, test set 0.830x speedup, val set 5.323x speedup, step: 20, train time 14.31 s
Epoch 29/50 |loss: 0.127078| train set 5.308x speedup, test set 0.850x speedup, val set 5.332x speedup, step: 21, train time 14.42 s
Epoch 30/50 |loss: 0.127194| train set 5.306x speedup, test set 0.821x speedup, val set 5.336x speedup, step: 22, train time 14.14 s
Epoch 31/50 |loss: 0.125517| train set 5.252x speedup, test set 0.872x speedup, val set 5.263x speedup, step: 23, train time 14.32 s
Epoch 32/50 |loss: 0.126926| train set 5.308x speedup, test set 0.833x speedup, val set 5.330x speedup, step: 24, train time 14.20 s
Epoch 33/50 |loss: 0.126341| train set 5.308x speedup, test set 0.821x speedup, val set 5.330x speedup, step: 25, train time 14.23 s
Epoch 34/50 |loss: 0.123656| train set 5.308x speedup, test set 0.856x speedup, val set 5.330x speedup, step: 26, train time 14.52 s
Epoch 35/50 |loss: 0.124876| train set 5.305x speedup, test set 0.816x speedup, val set 5.334x speedup, step: 27, train time 14.60 s
Epoch 36/50 |loss: 0.124658| train set 5.141x speedup, test set 0.850x speedup, val set 5.155x speedup, step: 28, train time 14.91 s
Epoch 37/50 |loss: 0.127873| train set 5.308x speedup, test set 0.799x speedup, val set 5.337x speedup, step: 29, train time 14.98 s
Epoch 38/50 |loss: 0.122491| train set 5.252x speedup, test set 0.860x speedup, val set 5.273x speedup, step: 30, train time 14.70 s
Epoch 39/50 |loss: 0.124357| train set 5.257x speedup, test set 0.796x speedup, val set 5.267x speedup, step: 31, train time 14.64 s
Epoch 40/50 |loss: 0.123385| train set 5.295x speedup, test set 0.763x speedup, val set 5.321x speedup, step: 32, train time 14.63 s
Epoch 41/50 |loss: 0.123205| train set 5.308x speedup, test set 0.853x speedup, val set 5.334x speedup, step: 33, train time 14.82 s
Epoch 42/50 |loss: 0.121806| train set 5.295x speedup, test set 0.847x speedup, val set 5.321x speedup, step: 34, train time 14.75 s
Epoch 43/50 |loss: 0.121376| train set 5.303x speedup, test set 0.910x speedup, val set 5.326x speedup, step: 35, train time 14.66 s
Epoch 44/50 |loss: 0.122617| train set 5.308x speedup, test set 0.883x speedup, val set 5.330x speedup, step: 36, train time 14.64 s
Epoch 45/50 |loss: 0.123524| train set 5.257x speedup, test set 0.853x speedup, val set 5.267x speedup, step: 37, train time 14.72 s
Epoch 46/50 |loss: 0.121320| train set 5.305x speedup, test set 0.867x speedup, val set 5.334x speedup, step: 38, train time 14.71 s
Epoch 47/50 |loss: 0.121855| train set 5.254x speedup, test set 0.855x speedup, val set 5.267x speedup, step: 39, train time 14.83 s
Epoch 48/50 |loss: 0.122371| train set 5.305x speedup, test set 0.920x speedup, val set 5.323x speedup, step: 40, train time 14.59 s
Epoch 49/50 |loss: 0.121300| train set 5.305x speedup, test set 0.856x speedup, val set 5.334x speedup, step: 41, train time 14.73 s
Training per epoch cost 14.433 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 29, train speedup 5.308, test speedup 0.850, val speedup 5.332
best test speedup epoch: 3, train speedup 5.297, test speedup 1.043, val speedup 5.316
best validation speedup epoch: 9, train speedup 5.306, test speedup 0.930, val speedup 5.336
last model at epoch 49, train speedup 5.305, test speedup 0.856, val speedup 5.334
execution cost 0:13:30.286317
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.991259, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.385785| train set 4.822x speedup, test set 0.959x speedup, val set 4.820x speedup, step: 1, train time 16.95 s
Epoch 1/50 |loss: 0.250130| train set 4.819x speedup, test set 2.152x speedup, val set 4.797x speedup, step: 2, train time 14.42 s
Epoch 2/50 |loss: 0.206690| train set 5.100x speedup, test set 0.810x speedup, val set 5.105x speedup, step: 3, train time 14.50 s
Epoch 3/50 |loss: 0.190466| train set 5.070x speedup, test set 0.876x speedup, val set 4.963x speedup, step: 4, train time 14.39 s
Epoch 4/50 |loss: 0.181971| train set 5.295x speedup, test set 0.755x speedup, val set 5.323x speedup, step: 1, train time 14.62 s
Epoch 5/50 |loss: 0.171982| train set 5.231x speedup, test set 0.744x speedup, val set 5.258x speedup, step: 2, train time 14.71 s
Epoch 6/50 |loss: 0.168149| train set 5.306x speedup, test set 0.718x speedup, val set 5.336x speedup, step: 3, train time 14.43 s
Epoch 7/50 |loss: 0.157486| train set 5.297x speedup, test set 0.732x speedup, val set 5.317x speedup, step: 4, train time 14.60 s
Epoch 8/50 |loss: 0.156018| train set 5.307x speedup, test set 0.905x speedup, val set 5.331x speedup, step: 5, train time 14.22 s
Epoch 9/50 |loss: 0.154333| train set 5.295x speedup, test set 0.756x speedup, val set 5.321x speedup, step: 6, train time 14.40 s
Epoch 10/50 |loss: 0.148137| train set 5.297x speedup, test set 0.738x speedup, val set 5.317x speedup, step: 7, train time 14.59 s
Epoch 11/50 |loss: 0.143654| train set 5.244x speedup, test set 0.810x speedup, val set 5.254x speedup, step: 8, train time 14.53 s
Epoch 12/50 |loss: 0.143785| train set 5.295x speedup, test set 0.727x speedup, val set 5.321x speedup, step: 9, train time 14.61 s
Epoch 13/50 |loss: 0.142614| train set 5.297x speedup, test set 0.775x speedup, val set 5.317x speedup, step: 10, train time 14.62 s
Epoch 14/50 |loss: 0.137877| train set 5.220x speedup, test set 0.830x speedup, val set 5.251x speedup, step: 11, train time 14.52 s
Epoch 15/50 |loss: 0.140499| train set 5.074x speedup, test set 0.746x speedup, val set 5.060x speedup, step: 12, train time 14.61 s
Epoch 16/50 |loss: 0.137687| train set 5.295x speedup, test set 0.725x speedup, val set 5.310x speedup, step: 13, train time 14.44 s
Epoch 17/50 |loss: 0.136267| train set 5.297x speedup, test set 0.752x speedup, val set 5.317x speedup, step: 14, train time 14.72 s
Epoch 18/50 |loss: 0.130840| train set 5.204x speedup, test set 0.796x speedup, val set 5.227x speedup, step: 15, train time 14.52 s
Epoch 19/50 |loss: 0.133807| train set 5.229x speedup, test set 0.801x speedup, val set 5.260x speedup, step: 16, train time 14.52 s
Epoch 20/50 |loss: 0.133128| train set 5.308x speedup, test set 0.858x speedup, val set 5.332x speedup, step: 17, train time 14.51 s
Epoch 21/50 |loss: 0.135979| train set 5.306x speedup, test set 0.738x speedup, val set 5.336x speedup, step: 18, train time 15.40 s
Epoch 22/50 |loss: 0.130339| train set 5.254x speedup, test set 0.792x speedup, val set 5.267x speedup, step: 19, train time 14.89 s
Epoch 23/50 |loss: 0.130760| train set 5.308x speedup, test set 0.862x speedup, val set 5.330x speedup, step: 20, train time 14.53 s
Epoch 24/50 |loss: 0.129300| train set 5.256x speedup, test set 0.788x speedup, val set 5.270x speedup, step: 21, train time 14.62 s
Epoch 25/50 |loss: 0.132139| train set 5.254x speedup, test set 0.759x speedup, val set 5.267x speedup, step: 22, train time 14.62 s
Epoch 26/50 |loss: 0.128596| train set 5.308x speedup, test set 0.815x speedup, val set 5.330x speedup, step: 23, train time 14.53 s
Epoch 27/50 |loss: 0.128760| train set 5.305x speedup, test set 0.966x speedup, val set 5.334x speedup, step: 24, train time 14.68 s
Epoch 28/50 |loss: 0.126860| train set 5.305x speedup, test set 0.803x speedup, val set 5.323x speedup, step: 25, train time 14.56 s
Epoch 29/50 |loss: 0.127996| train set 5.308x speedup, test set 0.733x speedup, val set 5.330x speedup, step: 1, train time 14.72 s
Epoch 30/50 |loss: 0.127449| train set 5.305x speedup, test set 0.770x speedup, val set 5.334x speedup, step: 2, train time 14.62 s
Epoch 31/50 |loss: 0.126885| train set 5.255x speedup, test set 0.855x speedup, val set 5.269x speedup, step: 3, train time 14.81 s
Epoch 32/50 |loss: 0.126869| train set 5.308x speedup, test set 0.760x speedup, val set 5.330x speedup, step: 4, train time 14.62 s
Epoch 33/50 |loss: 0.125733| train set 5.297x speedup, test set 0.767x speedup, val set 5.317x speedup, step: 5, train time 14.84 s
Epoch 34/50 |loss: 0.123296| train set 5.308x speedup, test set 0.768x speedup, val set 5.330x speedup, step: 1, train time 14.82 s
Epoch 35/50 |loss: 0.123921| train set 5.252x speedup, test set 0.739x speedup, val set 5.270x speedup, step: 2, train time 14.21 s
Epoch 36/50 |loss: 0.125089| train set 5.145x speedup, test set 0.738x speedup, val set 5.152x speedup, step: 3, train time 14.60 s
Epoch 37/50 |loss: 0.128807| train set 5.309x speedup, test set 0.760x speedup, val set 5.340x speedup, step: 4, train time 14.63 s
Epoch 38/50 |loss: 0.122584| train set 5.255x speedup, test set 0.920x speedup, val set 5.274x speedup, step: 5, train time 14.75 s
Epoch 39/50 |loss: 0.123383| train set 5.300x speedup, test set 0.707x speedup, val set 5.318x speedup, step: 6, train time 14.65 s
Epoch 40/50 |loss: 0.122817| train set 5.295x speedup, test set 0.783x speedup, val set 5.321x speedup, step: 7, train time 14.70 s
Epoch 41/50 |loss: 0.123126| train set 5.305x speedup, test set 0.758x speedup, val set 5.334x speedup, step: 8, train time 14.71 s
Epoch 42/50 |loss: 0.121327| train set 5.297x speedup, test set 0.876x speedup, val set 5.317x speedup, step: 9, train time 14.71 s
Epoch 43/50 |loss: 0.120394| train set 5.308x speedup, test set 0.747x speedup, val set 5.332x speedup, step: 10, train time 14.82 s
Epoch 44/50 |loss: 0.121901| train set 5.254x speedup, test set 0.774x speedup, val set 5.269x speedup, step: 11, train time 14.61 s
Epoch 45/50 |loss: 0.123678| train set 5.254x speedup, test set 0.785x speedup, val set 5.267x speedup, step: 12, train time 14.73 s
Epoch 46/50 |loss: 0.121286| train set 5.305x speedup, test set 0.736x speedup, val set 5.334x speedup, step: 13, train time 14.60 s
Epoch 47/50 |loss: 0.121570| train set 5.244x speedup, test set 0.756x speedup, val set 5.254x speedup, step: 14, train time 14.73 s
Epoch 48/50 |loss: 0.122134| train set 5.308x speedup, test set 0.779x speedup, val set 5.330x speedup, step: 15, train time 14.71 s
Epoch 49/50 |loss: 0.120946| train set 5.306x speedup, test set 0.784x speedup, val set 5.336x speedup, step: 1, train time 14.59 s
Training per epoch cost 14.669 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.230s, pg runtime 0.014s, speedup 0.062x
04, opt runtime 0.348s, model runtime 2.801s, pg runtime 0.348s, speedup 0.124x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 12.697s, pg runtime 2.959s, speedup 0.233x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 2.986s, pg runtime 0.313s, speedup 0.105x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 5.636s, pg runtime 0.434s, speedup 0.077x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.089s, pg runtime 0.112s, speedup 1.262x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 6.391s, pg runtime 0.023s, speedup 0.004x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 37, train speedup 5.309, test speedup 0.760, val speedup 5.340
best test speedup epoch: 1, train speedup 4.819, test speedup 2.152, val speedup 4.797
best validation speedup epoch: 49, train speedup 5.306, test speedup 0.784, val speedup 5.336
last model at epoch 49, train speedup 5.306, test speedup 0.784, val speedup 5.336
execution cost 0:13:43.624108
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.989116, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.381575| train set 4.887x speedup, test set 0.960x speedup, val set 4.882x speedup, step: 1, train time 16.99 s
Epoch 1/50 |loss: 0.251755| train set 5.229x speedup, test set 0.899x speedup, val set 5.260x speedup, step: 2, train time 14.72 s
Epoch 2/50 |loss: 0.206421| train set 5.110x speedup, test set 0.912x speedup, val set 5.127x speedup, step: 3, train time 14.61 s
Epoch 3/50 |loss: 0.188776| train set 4.725x speedup, test set 0.942x speedup, val set 4.581x speedup, step: 4, train time 14.45 s
Epoch 4/50 |loss: 0.182298| train set 5.295x speedup, test set 0.819x speedup, val set 5.323x speedup, step: 1, train time 14.82 s
Epoch 5/50 |loss: 0.172250| train set 5.221x speedup, test set 0.898x speedup, val set 5.246x speedup, step: 2, train time 14.71 s
Epoch 6/50 |loss: 0.166837| train set 5.295x speedup, test set 0.834x speedup, val set 5.323x speedup, step: 3, train time 14.63 s
Epoch 7/50 |loss: 0.158402| train set 5.276x speedup, test set 0.878x speedup, val set 5.291x speedup, step: 4, train time 14.62 s
Epoch 8/50 |loss: 0.156906| train set 5.310x speedup, test set 0.937x speedup, val set 5.317x speedup, step: 5, train time 14.74 s
Epoch 9/50 |loss: 0.154419| train set 5.295x speedup, test set 0.943x speedup, val set 5.321x speedup, step: 6, train time 14.54 s
Epoch 10/50 |loss: 0.148551| train set 5.223x speedup, test set 0.863x speedup, val set 5.244x speedup, step: 7, train time 14.34 s
Epoch 11/50 |loss: 0.144372| train set 5.244x speedup, test set 0.879x speedup, val set 5.254x speedup, step: 8, train time 13.92 s
Epoch 12/50 |loss: 0.142231| train set 5.295x speedup, test set 0.894x speedup, val set 5.321x speedup, step: 9, train time 14.22 s
Epoch 13/50 |loss: 0.144752| train set 5.121x speedup, test set 0.940x speedup, val set 5.141x speedup, step: 10, train time 14.01 s
Epoch 14/50 |loss: 0.138888| train set 5.306x speedup, test set 0.944x speedup, val set 5.336x speedup, step: 1, train time 13.81 s
Epoch 15/50 |loss: 0.139860| train set 5.074x speedup, test set 0.877x speedup, val set 5.060x speedup, step: 2, train time 13.62 s
Epoch 16/50 |loss: 0.139091| train set 5.295x speedup, test set 0.879x speedup, val set 5.310x speedup, step: 3, train time 13.71 s
Epoch 17/50 |loss: 0.136524| train set 5.297x speedup, test set 0.914x speedup, val set 5.317x speedup, step: 4, train time 13.71 s
Epoch 18/50 |loss: 0.133273| train set 5.204x speedup, test set 0.944x speedup, val set 5.227x speedup, step: 5, train time 13.77 s
Epoch 19/50 |loss: 0.133090| train set 5.305x speedup, test set 0.853x speedup, val set 5.334x speedup, step: 6, train time 13.69 s
Epoch 20/50 |loss: 0.133917| train set 5.305x speedup, test set 0.939x speedup, val set 5.334x speedup, step: 7, train time 13.84 s
Epoch 21/50 |loss: 0.137099| train set 5.305x speedup, test set 0.902x speedup, val set 5.334x speedup, step: 8, train time 14.74 s
Epoch 22/50 |loss: 0.130769| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 9, train time 13.81 s
Epoch 23/50 |loss: 0.130343| train set 5.308x speedup, test set 0.879x speedup, val set 5.330x speedup, step: 10, train time 13.82 s
Epoch 24/50 |loss: 0.129859| train set 5.309x speedup, test set 0.833x speedup, val set 5.333x speedup, step: 11, train time 13.71 s
Epoch 25/50 |loss: 0.132548| train set 5.254x speedup, test set 0.848x speedup, val set 5.267x speedup, step: 12, train time 13.82 s
Epoch 26/50 |loss: 0.127129| train set 5.308x speedup, test set 0.853x speedup, val set 5.330x speedup, step: 13, train time 13.92 s
Epoch 27/50 |loss: 0.128046| train set 5.254x speedup, test set 0.902x speedup, val set 5.267x speedup, step: 14, train time 13.72 s
Epoch 28/50 |loss: 0.126401| train set 5.308x speedup, test set 0.863x speedup, val set 5.330x speedup, step: 15, train time 13.74 s
Epoch 29/50 |loss: 0.127598| train set 5.297x speedup, test set 0.863x speedup, val set 5.317x speedup, step: 16, train time 13.69 s
Epoch 30/50 |loss: 0.128134| train set 5.306x speedup, test set 0.842x speedup, val set 5.336x speedup, step: 17, train time 13.90 s
Epoch 31/50 |loss: 0.125575| train set 5.305x speedup, test set 0.879x speedup, val set 5.326x speedup, step: 18, train time 13.71 s
Epoch 32/50 |loss: 0.127624| train set 5.308x speedup, test set 0.863x speedup, val set 5.330x speedup, step: 19, train time 13.82 s
Epoch 33/50 |loss: 0.125064| train set 5.297x speedup, test set 0.863x speedup, val set 5.320x speedup, step: 20, train time 13.62 s
Epoch 34/50 |loss: 0.124829| train set 5.308x speedup, test set 0.850x speedup, val set 5.330x speedup, step: 21, train time 13.80 s
Epoch 35/50 |loss: 0.124370| train set 5.252x speedup, test set 0.854x speedup, val set 5.270x speedup, step: 22, train time 13.72 s
Epoch 36/50 |loss: 0.125157| train set 5.145x speedup, test set 0.830x speedup, val set 5.152x speedup, step: 23, train time 13.89 s
Epoch 37/50 |loss: 0.127051| train set 5.307x speedup, test set 0.822x speedup, val set 5.336x speedup, step: 24, train time 13.81 s
Epoch 38/50 |loss: 0.122610| train set 5.252x speedup, test set 0.839x speedup, val set 5.273x speedup, step: 25, train time 13.80 s
Epoch 39/50 |loss: 0.124514| train set 5.308x speedup, test set 0.822x speedup, val set 5.330x speedup, step: 26, train time 13.84 s
Epoch 40/50 |loss: 0.122866| train set 5.289x speedup, test set 0.844x speedup, val set 5.319x speedup, step: 27, train time 13.92 s
Epoch 41/50 |loss: 0.122652| train set 5.305x speedup, test set 0.822x speedup, val set 5.334x speedup, step: 28, train time 13.82 s
Epoch 42/50 |loss: 0.122289| train set 5.295x speedup, test set 0.822x speedup, val set 5.321x speedup, step: 29, train time 13.71 s
Epoch 43/50 |loss: 0.120093| train set 5.296x speedup, test set 0.818x speedup, val set 5.316x speedup, step: 30, train time 13.71 s
Epoch 44/50 |loss: 0.120954| train set 5.254x speedup, test set 0.854x speedup, val set 5.266x speedup, step: 31, train time 13.72 s
Epoch 45/50 |loss: 0.123105| train set 5.257x speedup, test set 0.850x speedup, val set 5.267x speedup, step: 32, train time 13.72 s
Epoch 46/50 |loss: 0.122441| train set 5.305x speedup, test set 0.850x speedup, val set 5.334x speedup, step: 33, train time 13.80 s
Epoch 47/50 |loss: 0.122054| train set 5.244x speedup, test set 0.854x speedup, val set 5.254x speedup, step: 34, train time 14.00 s
Epoch 48/50 |loss: 0.121883| train set 5.308x speedup, test set 0.854x speedup, val set 5.330x speedup, step: 35, train time 13.91 s
Epoch 49/50 |loss: 0.120658| train set 5.306x speedup, test set 0.850x speedup, val set 5.336x speedup, step: 1, train time 13.83 s
Training per epoch cost 14.050 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 12.697s, pg runtime 2.959s, speedup 0.233x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 8, train speedup 5.310, test speedup 0.937, val speedup 5.317
best test speedup epoch: 0, train speedup 4.887, test speedup 0.960, val speedup 4.882
best validation speedup epoch: 49, train speedup 5.306, test speedup 0.850, val speedup 5.336
last model at epoch 49, train speedup 5.306, test speedup 0.850, val speedup 5.336
execution cost 0:13:06.413990
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:01.006348, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.384553| train set 4.886x speedup, test set 1.028x speedup, val set 4.881x speedup, step: 1, train time 16.93 s
Epoch 1/50 |loss: 0.244734| train set 4.830x speedup, test set 0.846x speedup, val set 4.808x speedup, step: 2, train time 14.62 s
Epoch 2/50 |loss: 0.208397| train set 5.110x speedup, test set 0.902x speedup, val set 5.127x speedup, step: 3, train time 14.23 s
Epoch 3/50 |loss: 0.190112| train set 5.295x speedup, test set 0.918x speedup, val set 5.310x speedup, step: 4, train time 14.32 s
Epoch 4/50 |loss: 0.184633| train set 5.297x speedup, test set 0.930x speedup, val set 5.320x speedup, step: 1, train time 14.43 s
Epoch 5/50 |loss: 0.172970| train set 5.180x speedup, test set 0.934x speedup, val set 5.197x speedup, step: 2, train time 14.09 s
Epoch 6/50 |loss: 0.166633| train set 5.295x speedup, test set 0.837x speedup, val set 5.323x speedup, step: 3, train time 14.31 s
Epoch 7/50 |loss: 0.158114| train set 5.297x speedup, test set 0.905x speedup, val set 5.317x speedup, step: 4, train time 14.13 s
Epoch 8/50 |loss: 0.160035| train set 5.308x speedup, test set 0.875x speedup, val set 5.330x speedup, step: 5, train time 14.51 s
Epoch 9/50 |loss: 0.153812| train set 5.295x speedup, test set 0.777x speedup, val set 5.321x speedup, step: 1, train time 14.20 s
Epoch 10/50 |loss: 0.150844| train set 5.300x speedup, test set 0.814x speedup, val set 5.318x speedup, step: 2, train time 14.42 s
Epoch 11/50 |loss: 0.145523| train set 5.244x speedup, test set 0.931x speedup, val set 5.254x speedup, step: 3, train time 14.41 s
Epoch 12/50 |loss: 0.141395| train set 5.295x speedup, test set 0.825x speedup, val set 5.321x speedup, step: 4, train time 14.11 s
Epoch 13/50 |loss: 0.142147| train set 5.221x speedup, test set 0.905x speedup, val set 5.243x speedup, step: 5, train time 14.40 s
Epoch 14/50 |loss: 0.138764| train set 5.080x speedup, test set 0.815x speedup, val set 4.981x speedup, step: 6, train time 14.13 s
Epoch 15/50 |loss: 0.139572| train set 5.074x speedup, test set 0.832x speedup, val set 5.060x speedup, step: 7, train time 14.34 s
Epoch 16/50 |loss: 0.138158| train set 5.295x speedup, test set 0.913x speedup, val set 5.310x speedup, step: 8, train time 14.13 s
Epoch 17/50 |loss: 0.134252| train set 5.297x speedup, test set 0.741x speedup, val set 5.317x speedup, step: 9, train time 14.22 s
Epoch 18/50 |loss: 0.131670| train set 5.204x speedup, test set 0.949x speedup, val set 5.227x speedup, step: 10, train time 14.14 s
Epoch 19/50 |loss: 0.131675| train set 5.305x speedup, test set 0.981x speedup, val set 5.334x speedup, step: 1, train time 14.32 s
Epoch 20/50 |loss: 0.131177| train set 5.297x speedup, test set 0.899x speedup, val set 5.320x speedup, step: 2, train time 14.29 s
Epoch 21/50 |loss: 0.132443| train set 5.305x speedup, test set 0.913x speedup, val set 5.334x speedup, step: 3, train time 15.32 s
Epoch 22/50 |loss: 0.129221| train set 5.254x speedup, test set 0.757x speedup, val set 5.267x speedup, step: 4, train time 14.34 s
Epoch 23/50 |loss: 0.129307| train set 5.308x speedup, test set 0.981x speedup, val set 5.330x speedup, step: 5, train time 14.29 s
Epoch 24/50 |loss: 0.129027| train set 5.256x speedup, test set 0.913x speedup, val set 5.270x speedup, step: 6, train time 14.29 s
Epoch 25/50 |loss: 0.130546| train set 5.254x speedup, test set 0.775x speedup, val set 5.267x speedup, step: 7, train time 14.62 s
Epoch 26/50 |loss: 0.127777| train set 5.305x speedup, test set 0.926x speedup, val set 5.334x speedup, step: 8, train time 14.43 s
Epoch 27/50 |loss: 0.128966| train set 5.300x speedup, test set 1.005x speedup, val set 5.326x speedup, step: 9, train time 14.51 s
Epoch 28/50 |loss: 0.125436| train set 5.305x speedup, test set 0.867x speedup, val set 5.323x speedup, step: 10, train time 14.63 s
Epoch 29/50 |loss: 0.126489| train set 5.297x speedup, test set 0.842x speedup, val set 5.320x speedup, step: 11, train time 14.60 s
Epoch 30/50 |loss: 0.126083| train set 5.305x speedup, test set 0.841x speedup, val set 5.334x speedup, step: 12, train time 14.61 s
Epoch 31/50 |loss: 0.125058| train set 5.305x speedup, test set 0.910x speedup, val set 5.326x speedup, step: 13, train time 14.70 s
Epoch 32/50 |loss: 0.125554| train set 5.308x speedup, test set 0.855x speedup, val set 5.330x speedup, step: 14, train time 14.50 s
Epoch 33/50 |loss: 0.124215| train set 5.310x speedup, test set 0.860x speedup, val set 5.331x speedup, step: 15, train time 14.40 s
Epoch 34/50 |loss: 0.122458| train set 5.305x speedup, test set 0.877x speedup, val set 5.334x speedup, step: 1, train time 14.44 s
Epoch 35/50 |loss: 0.124437| train set 5.305x speedup, test set 0.836x speedup, val set 5.334x speedup, step: 2, train time 14.50 s
Epoch 36/50 |loss: 0.125138| train set 5.242x speedup, test set 0.921x speedup, val set 5.258x speedup, step: 3, train time 14.54 s
Epoch 37/50 |loss: 0.126484| train set 5.308x speedup, test set 0.836x speedup, val set 5.337x speedup, step: 4, train time 14.72 s
Epoch 38/50 |loss: 0.121505| train set 5.092x speedup, test set 0.973x speedup, val set 5.175x speedup, step: 5, train time 14.63 s
Epoch 39/50 |loss: 0.123373| train set 5.297x speedup, test set 0.823x speedup, val set 5.317x speedup, step: 6, train time 14.62 s
Epoch 40/50 |loss: 0.121283| train set 5.295x speedup, test set 0.872x speedup, val set 5.321x speedup, step: 7, train time 14.62 s
Epoch 41/50 |loss: 0.122763| train set 5.309x speedup, test set 0.836x speedup, val set 5.337x speedup, step: 8, train time 14.64 s
Epoch 42/50 |loss: 0.121088| train set 5.305x speedup, test set 0.899x speedup, val set 5.334x speedup, step: 9, train time 14.60 s
Epoch 43/50 |loss: 0.119551| train set 5.305x speedup, test set 0.869x speedup, val set 5.326x speedup, step: 10, train time 14.70 s
Epoch 44/50 |loss: 0.120467| train set 5.308x speedup, test set 0.836x speedup, val set 5.332x speedup, step: 11, train time 14.72 s
Epoch 45/50 |loss: 0.122684| train set 5.254x speedup, test set 0.855x speedup, val set 5.267x speedup, step: 12, train time 14.63 s
Epoch 46/50 |loss: 0.120664| train set 5.295x speedup, test set 0.813x speedup, val set 5.321x speedup, step: 13, train time 14.54 s
Epoch 47/50 |loss: 0.121235| train set 5.246x speedup, test set 0.830x speedup, val set 5.255x speedup, step: 14, train time 14.80 s
Epoch 48/50 |loss: 0.120640| train set 5.305x speedup, test set 0.916x speedup, val set 5.323x speedup, step: 15, train time 14.70 s
Epoch 49/50 |loss: 0.120122| train set 5.305x speedup, test set 0.916x speedup, val set 5.334x speedup, step: 1, train time 14.74 s
Training per epoch cost 14.521 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 8.146s, pg runtime 2.959s, speedup 0.363x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.115s, pg runtime 0.112s, speedup 0.974x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 33, train speedup 5.310, test speedup 0.860, val speedup 5.331
best test speedup epoch: 0, train speedup 4.886, test speedup 1.028, val speedup 4.881
best validation speedup epoch: 49, train speedup 5.305, test speedup 0.916, val speedup 5.334
last model at epoch 49, train speedup 5.305, test speedup 0.916, val speedup 5.334
execution cost 0:13:35.201565
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.970906, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.382942| train set 4.821x speedup, test set 0.948x speedup, val set 4.819x speedup, step: 1, train time 16.40 s
Epoch 1/50 |loss: 0.244960| train set 5.059x speedup, test set 0.900x speedup, val set 5.044x speedup, step: 2, train time 14.11 s
Epoch 2/50 |loss: 0.203268| train set 5.110x speedup, test set 0.860x speedup, val set 5.126x speedup, step: 3, train time 14.22 s
Epoch 3/50 |loss: 0.184439| train set 5.295x speedup, test set 0.895x speedup, val set 5.310x speedup, step: 4, train time 14.32 s
Epoch 4/50 |loss: 0.179689| train set 5.295x speedup, test set 0.801x speedup, val set 5.323x speedup, step: 1, train time 14.20 s
Epoch 5/50 |loss: 0.171866| train set 5.221x speedup, test set 0.863x speedup, val set 5.246x speedup, step: 2, train time 14.10 s
Epoch 6/50 |loss: 0.164422| train set 5.295x speedup, test set 0.863x speedup, val set 5.323x speedup, step: 3, train time 14.31 s
Epoch 7/50 |loss: 0.158668| train set 5.297x speedup, test set 0.863x speedup, val set 5.317x speedup, step: 4, train time 14.33 s
Epoch 8/50 |loss: 0.155846| train set 5.308x speedup, test set 0.961x speedup, val set 5.330x speedup, step: 5, train time 14.23 s
Epoch 9/50 |loss: 0.155022| train set 5.306x speedup, test set 0.926x speedup, val set 5.336x speedup, step: 1, train time 14.31 s
Epoch 10/50 |loss: 0.149802| train set 5.297x speedup, test set 0.906x speedup, val set 5.321x speedup, step: 2, train time 14.20 s
Epoch 11/50 |loss: 0.143276| train set 5.244x speedup, test set 0.895x speedup, val set 5.254x speedup, step: 3, train time 14.23 s
Epoch 12/50 |loss: 0.142360| train set 5.295x speedup, test set 0.906x speedup, val set 5.321x speedup, step: 4, train time 14.26 s
Epoch 13/50 |loss: 0.143605| train set 5.221x speedup, test set 0.927x speedup, val set 5.243x speedup, step: 5, train time 14.53 s
Epoch 14/50 |loss: 0.138454| train set 5.082x speedup, test set 0.927x speedup, val set 4.980x speedup, step: 6, train time 14.69 s
Epoch 15/50 |loss: 0.140638| train set 5.252x speedup, test set 0.889x speedup, val set 5.270x speedup, step: 7, train time 14.35 s
Epoch 16/50 |loss: 0.141058| train set 5.295x speedup, test set 0.906x speedup, val set 5.310x speedup, step: 8, train time 14.51 s
Epoch 17/50 |loss: 0.136558| train set 5.295x speedup, test set 0.938x speedup, val set 5.321x speedup, step: 9, train time 14.53 s
Epoch 18/50 |loss: 0.133425| train set 5.034x speedup, test set 0.938x speedup, val set 5.027x speedup, step: 10, train time 14.52 s
Epoch 19/50 |loss: 0.132351| train set 5.140x speedup, test set 0.905x speedup, val set 5.235x speedup, step: 11, train time 14.52 s
Epoch 20/50 |loss: 0.135046| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 12, train time 14.51 s
Epoch 21/50 |loss: 0.135963| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 13, train time 15.23 s
Epoch 22/50 |loss: 0.130406| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 14, train time 14.51 s
Epoch 23/50 |loss: 0.130281| train set 5.308x speedup, test set 0.899x speedup, val set 5.330x speedup, step: 15, train time 14.44 s
Epoch 24/50 |loss: 0.130449| train set 5.309x speedup, test set 0.855x speedup, val set 5.333x speedup, step: 16, train time 14.54 s
Epoch 25/50 |loss: 0.132663| train set 5.254x speedup, test set 0.504x speedup, val set 5.267x speedup, step: 17, train time 14.72 s
Epoch 26/50 |loss: 0.128065| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 18, train time 14.64 s
Epoch 27/50 |loss: 0.128689| train set 5.305x speedup, test set 0.516x speedup, val set 5.334x speedup, step: 19, train time 14.71 s
Epoch 28/50 |loss: 0.124958| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 20, train time 14.13 s
Epoch 29/50 |loss: 0.128167| train set 5.297x speedup, test set 0.876x speedup, val set 5.317x speedup, step: 21, train time 14.43 s
Epoch 30/50 |loss: 0.127598| train set 5.305x speedup, test set 0.836x speedup, val set 5.334x speedup, step: 22, train time 14.32 s
Epoch 31/50 |loss: 0.126603| train set 5.305x speedup, test set 0.920x speedup, val set 5.323x speedup, step: 23, train time 14.51 s
Epoch 32/50 |loss: 0.126523| train set 5.308x speedup, test set 0.860x speedup, val set 5.330x speedup, step: 24, train time 14.25 s
Epoch 33/50 |loss: 0.125953| train set 5.308x speedup, test set 0.876x speedup, val set 5.330x speedup, step: 25, train time 14.51 s
Epoch 34/50 |loss: 0.124264| train set 5.308x speedup, test set 0.896x speedup, val set 5.330x speedup, step: 26, train time 14.23 s
Epoch 35/50 |loss: 0.125415| train set 5.252x speedup, test set 0.836x speedup, val set 5.270x speedup, step: 27, train time 14.62 s
Epoch 36/50 |loss: 0.125797| train set 5.141x speedup, test set 0.839x speedup, val set 5.155x speedup, step: 28, train time 14.61 s
Epoch 37/50 |loss: 0.128534| train set 5.305x speedup, test set 0.857x speedup, val set 5.336x speedup, step: 29, train time 14.53 s
early stopping at epoch 37
Training per epoch cost 14.482 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.076s, pg runtime 0.086s, speedup 1.124x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.203s, pg runtime 0.154s, speedup 0.761x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 24, train speedup 5.309, test speedup 0.855, val speedup 5.333
best test speedup epoch: 8, train speedup 5.308, test speedup 0.961, val speedup 5.330
best validation speedup epoch: 9, train speedup 5.306, test speedup 0.926, val speedup 5.336
last model at epoch 37, train speedup 5.305, test speedup 0.857, val speedup 5.336
execution cost 0:10:21.949281
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.601006, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.383154| train set 4.855x speedup, test set 0.887x speedup, val set 4.846x speedup, step: 1, train time 16.70 s
Epoch 1/50 |loss: 0.245761| train set 5.059x speedup, test set 0.946x speedup, val set 5.044x speedup, step: 2, train time 14.44 s
Epoch 2/50 |loss: 0.208329| train set 5.110x speedup, test set 0.885x speedup, val set 5.126x speedup, step: 3, train time 14.31 s
Epoch 3/50 |loss: 0.189087| train set 5.070x speedup, test set 0.900x speedup, val set 4.960x speedup, step: 4, train time 14.03 s
Epoch 4/50 |loss: 0.181074| train set 5.295x speedup, test set 0.803x speedup, val set 5.321x speedup, step: 1, train time 14.13 s
Epoch 5/50 |loss: 0.170176| train set 5.232x speedup, test set 0.876x speedup, val set 5.258x speedup, step: 2, train time 14.30 s
Epoch 6/50 |loss: 0.166033| train set 5.151x speedup, test set 0.902x speedup, val set 5.119x speedup, step: 3, train time 14.32 s
Epoch 7/50 |loss: 0.155735| train set 5.297x speedup, test set 0.807x speedup, val set 5.317x speedup, step: 4, train time 14.42 s
Epoch 8/50 |loss: 0.159338| train set 5.305x speedup, test set 0.843x speedup, val set 5.323x speedup, step: 5, train time 14.42 s
Epoch 9/50 |loss: 0.151681| train set 5.305x speedup, test set 0.714x speedup, val set 5.336x speedup, step: 1, train time 14.32 s
Epoch 10/50 |loss: 0.148214| train set 5.224x speedup, test set 0.743x speedup, val set 5.246x speedup, step: 2, train time 14.19 s
Epoch 11/50 |loss: 0.145300| train set 5.244x speedup, test set 0.758x speedup, val set 5.254x speedup, step: 3, train time 14.33 s
Epoch 12/50 |loss: 0.141315| train set 5.295x speedup, test set 0.753x speedup, val set 5.321x speedup, step: 4, train time 14.42 s
Epoch 13/50 |loss: 0.141600| train set 5.297x speedup, test set 0.785x speedup, val set 5.317x speedup, step: 5, train time 14.62 s
Epoch 14/50 |loss: 0.137145| train set 5.033x speedup, test set 0.937x speedup, val set 4.925x speedup, step: 6, train time 14.43 s
Epoch 15/50 |loss: 0.139278| train set 5.252x speedup, test set 0.785x speedup, val set 5.270x speedup, step: 7, train time 14.33 s
Epoch 16/50 |loss: 0.137343| train set 5.295x speedup, test set 0.784x speedup, val set 5.310x speedup, step: 8, train time 14.43 s
Epoch 17/50 |loss: 0.134191| train set 5.295x speedup, test set 0.755x speedup, val set 5.323x speedup, step: 9, train time 14.03 s
Epoch 18/50 |loss: 0.130894| train set 5.308x speedup, test set 0.863x speedup, val set 5.332x speedup, step: 10, train time 14.15 s
Epoch 19/50 |loss: 0.132069| train set 5.140x speedup, test set 0.837x speedup, val set 5.235x speedup, step: 11, train time 14.10 s
Epoch 20/50 |loss: 0.135260| train set 5.306x speedup, test set 0.884x speedup, val set 5.336x speedup, step: 12, train time 14.05 s
Epoch 21/50 |loss: 0.133667| train set 5.305x speedup, test set 0.843x speedup, val set 5.334x speedup, step: 13, train time 15.13 s
Epoch 22/50 |loss: 0.129156| train set 5.308x speedup, test set 0.871x speedup, val set 5.330x speedup, step: 14, train time 14.12 s
Epoch 23/50 |loss: 0.128820| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 15, train time 14.02 s
Epoch 24/50 |loss: 0.128721| train set 5.309x speedup, test set 0.857x speedup, val set 5.333x speedup, step: 16, train time 14.11 s
Epoch 25/50 |loss: 0.131605| train set 5.254x speedup, test set 0.789x speedup, val set 5.267x speedup, step: 17, train time 14.01 s
Epoch 26/50 |loss: 0.127582| train set 5.308x speedup, test set 0.889x speedup, val set 5.330x speedup, step: 18, train time 14.01 s
Epoch 27/50 |loss: 0.127538| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 19, train time 14.03 s
Epoch 28/50 |loss: 0.126694| train set 5.305x speedup, test set 0.892x speedup, val set 5.326x speedup, step: 20, train time 14.35 s
Epoch 29/50 |loss: 0.127201| train set 5.308x speedup, test set 0.840x speedup, val set 5.330x speedup, step: 21, train time 14.64 s
Epoch 30/50 |loss: 0.125946| train set 5.305x speedup, test set 0.800x speedup, val set 5.334x speedup, step: 22, train time 14.51 s
Epoch 31/50 |loss: 0.125019| train set 5.252x speedup, test set 0.923x speedup, val set 5.263x speedup, step: 23, train time 14.41 s
Epoch 32/50 |loss: 0.124944| train set 5.308x speedup, test set 0.889x speedup, val set 5.330x speedup, step: 24, train time 13.94 s
Epoch 33/50 |loss: 0.124603| train set 5.300x speedup, test set 0.848x speedup, val set 5.318x speedup, step: 25, train time 14.32 s
Epoch 34/50 |loss: 0.122910| train set 5.309x speedup, test set 0.916x speedup, val set 5.333x speedup, step: 26, train time 14.50 s
Epoch 35/50 |loss: 0.124203| train set 5.252x speedup, test set 0.788x speedup, val set 5.270x speedup, step: 27, train time 14.41 s
Epoch 36/50 |loss: 0.124034| train set 5.244x speedup, test set 0.841x speedup, val set 5.254x speedup, step: 28, train time 14.52 s
Epoch 37/50 |loss: 0.126993| train set 5.309x speedup, test set 0.779x speedup, val set 5.340x speedup, step: 29, train time 14.61 s
Epoch 38/50 |loss: 0.121216| train set 5.255x speedup, test set 0.933x speedup, val set 5.274x speedup, step: 30, train time 14.72 s
Epoch 39/50 |loss: 0.122447| train set 5.246x speedup, test set 0.832x speedup, val set 5.255x speedup, step: 31, train time 14.72 s
Epoch 40/50 |loss: 0.121397| train set 5.297x speedup, test set 0.852x speedup, val set 5.317x speedup, step: 32, train time 14.71 s
Epoch 41/50 |loss: 0.122269| train set 5.307x speedup, test set 0.749x speedup, val set 5.339x speedup, step: 33, train time 14.73 s
Epoch 42/50 |loss: 0.120223| train set 5.295x speedup, test set 0.827x speedup, val set 5.321x speedup, step: 34, train time 14.80 s
Epoch 43/50 |loss: 0.119663| train set 5.305x speedup, test set 0.834x speedup, val set 5.323x speedup, step: 35, train time 14.75 s
Epoch 44/50 |loss: 0.121117| train set 5.308x speedup, test set 0.797x speedup, val set 5.332x speedup, step: 36, train time 14.81 s
Epoch 45/50 |loss: 0.123011| train set 5.308x speedup, test set 0.776x speedup, val set 5.330x speedup, step: 37, train time 14.69 s
Epoch 46/50 |loss: 0.120763| train set 5.305x speedup, test set 0.830x speedup, val set 5.334x speedup, step: 38, train time 14.72 s
Epoch 47/50 |loss: 0.122285| train set 5.254x speedup, test set 0.787x speedup, val set 5.267x speedup, step: 39, train time 14.72 s
Epoch 48/50 |loss: 0.122104| train set 5.305x speedup, test set 0.864x speedup, val set 5.323x speedup, step: 40, train time 14.53 s
Epoch 49/50 |loss: 0.120531| train set 5.305x speedup, test set 0.878x speedup, val set 5.334x speedup, step: 41, train time 14.71 s
Training per epoch cost 14.455 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.836s, pg runtime 3.549s, speedup 0.734x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 12.697s, pg runtime 2.959s, speedup 0.233x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 2.986s, pg runtime 0.313s, speedup 0.105x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 4.177s, pg runtime 0.354s, speedup 0.085x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 2.523s, pg runtime 0.189s, speedup 0.075x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 6.391s, pg runtime 0.023s, speedup 0.004x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 37, train speedup 5.309, test speedup 0.779, val speedup 5.340
best test speedup epoch: 1, train speedup 5.059, test speedup 0.946, val speedup 5.044
best validation speedup epoch: 9, train speedup 5.305, test speedup 0.714, val speedup 5.336
last model at epoch 49, train speedup 5.305, test speedup 0.878, val speedup 5.334
execution cost 0:13:32.501131
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.989422, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.382830| train set 4.886x speedup, test set 1.920x speedup, val set 4.881x speedup, step: 1, train time 17.01 s
Epoch 1/50 |loss: 0.248564| train set 4.830x speedup, test set 0.979x speedup, val set 4.808x speedup, step: 2, train time 14.51 s
Epoch 2/50 |loss: 0.203720| train set 5.110x speedup, test set 0.937x speedup, val set 5.127x speedup, step: 3, train time 14.54 s
Epoch 3/50 |loss: 0.189621| train set 4.910x speedup, test set 0.781x speedup, val set 4.768x speedup, step: 4, train time 14.50 s
Epoch 4/50 |loss: 0.187022| train set 5.295x speedup, test set 0.794x speedup, val set 5.323x speedup, step: 1, train time 14.43 s
Epoch 5/50 |loss: 0.171575| train set 5.232x speedup, test set 0.912x speedup, val set 5.258x speedup, step: 2, train time 14.52 s
Epoch 6/50 |loss: 0.167844| train set 5.295x speedup, test set 0.836x speedup, val set 5.323x speedup, step: 3, train time 14.53 s
Epoch 7/50 |loss: 0.157212| train set 5.297x speedup, test set 0.863x speedup, val set 5.317x speedup, step: 4, train time 14.44 s
Epoch 8/50 |loss: 0.159054| train set 5.295x speedup, test set 0.927x speedup, val set 5.310x speedup, step: 5, train time 14.62 s
Epoch 9/50 |loss: 0.153356| train set 5.305x speedup, test set 0.927x speedup, val set 5.333x speedup, step: 1, train time 14.54 s
Epoch 10/50 |loss: 0.149753| train set 5.297x speedup, test set 0.921x speedup, val set 5.321x speedup, step: 2, train time 14.70 s
Epoch 11/50 |loss: 0.146529| train set 5.244x speedup, test set 0.921x speedup, val set 5.254x speedup, step: 3, train time 14.72 s
Epoch 12/50 |loss: 0.143218| train set 5.295x speedup, test set 0.912x speedup, val set 5.321x speedup, step: 4, train time 14.62 s
Epoch 13/50 |loss: 0.143056| train set 5.231x speedup, test set 0.876x speedup, val set 5.256x speedup, step: 5, train time 14.72 s
Epoch 14/50 |loss: 0.138514| train set 5.306x speedup, test set 0.927x speedup, val set 5.336x speedup, step: 1, train time 14.53 s
Epoch 15/50 |loss: 0.140326| train set 5.079x speedup, test set 0.907x speedup, val set 5.068x speedup, step: 2, train time 14.55 s
Epoch 16/50 |loss: 0.138738| train set 5.295x speedup, test set 0.851x speedup, val set 5.310x speedup, step: 3, train time 14.52 s
Epoch 17/50 |loss: 0.136362| train set 5.297x speedup, test set 0.909x speedup, val set 5.320x speedup, step: 4, train time 14.22 s
Epoch 18/50 |loss: 0.133591| train set 5.204x speedup, test set 0.873x speedup, val set 5.227x speedup, step: 5, train time 14.22 s
Epoch 19/50 |loss: 0.133583| train set 5.305x speedup, test set 0.850x speedup, val set 5.334x speedup, step: 6, train time 14.31 s
Epoch 20/50 |loss: 0.133959| train set 5.306x speedup, test set 0.848x speedup, val set 5.336x speedup, step: 7, train time 14.31 s
Epoch 21/50 |loss: 0.135361| train set 5.305x speedup, test set 0.914x speedup, val set 5.334x speedup, step: 8, train time 15.09 s
Epoch 22/50 |loss: 0.129663| train set 5.308x speedup, test set 0.942x speedup, val set 5.332x speedup, step: 9, train time 14.13 s
Epoch 23/50 |loss: 0.130718| train set 5.308x speedup, test set 0.961x speedup, val set 5.330x speedup, step: 10, train time 14.10 s
Epoch 24/50 |loss: 0.128742| train set 5.311x speedup, test set 0.893x speedup, val set 5.334x speedup, step: 11, train time 14.39 s
Epoch 25/50 |loss: 0.131142| train set 5.254x speedup, test set 0.859x speedup, val set 5.267x speedup, step: 12, train time 14.21 s
Epoch 26/50 |loss: 0.127931| train set 5.308x speedup, test set 0.806x speedup, val set 5.330x speedup, step: 13, train time 14.19 s
Epoch 27/50 |loss: 0.129289| train set 5.303x speedup, test set 0.917x speedup, val set 5.322x speedup, step: 14, train time 14.13 s
Epoch 28/50 |loss: 0.127195| train set 5.305x speedup, test set 0.880x speedup, val set 5.326x speedup, step: 15, train time 14.21 s
Epoch 29/50 |loss: 0.127703| train set 5.308x speedup, test set 0.876x speedup, val set 5.332x speedup, step: 16, train time 14.03 s
Epoch 30/50 |loss: 0.127858| train set 5.308x speedup, test set 0.876x speedup, val set 5.332x speedup, step: 17, train time 14.22 s
Epoch 31/50 |loss: 0.124915| train set 5.252x speedup, test set 0.894x speedup, val set 5.263x speedup, step: 18, train time 14.10 s
Epoch 32/50 |loss: 0.125234| train set 5.308x speedup, test set 0.724x speedup, val set 5.330x speedup, step: 19, train time 14.21 s
Epoch 33/50 |loss: 0.124976| train set 5.308x speedup, test set 0.833x speedup, val set 5.330x speedup, step: 20, train time 14.13 s
Epoch 34/50 |loss: 0.123611| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 21, train time 14.30 s
Epoch 35/50 |loss: 0.123975| train set 5.252x speedup, test set 0.807x speedup, val set 5.270x speedup, step: 22, train time 14.12 s
Epoch 36/50 |loss: 0.124970| train set 5.141x speedup, test set 0.889x speedup, val set 5.155x speedup, step: 23, train time 14.33 s
Epoch 37/50 |loss: 0.128118| train set 5.202x speedup, test set 0.730x speedup, val set 5.231x speedup, step: 24, train time 14.12 s
Epoch 38/50 |loss: 0.121729| train set 5.252x speedup, test set 0.917x speedup, val set 5.270x speedup, step: 25, train time 14.15 s
Epoch 39/50 |loss: 0.123873| train set 5.300x speedup, test set 0.824x speedup, val set 5.318x speedup, step: 26, train time 14.12 s
Epoch 40/50 |loss: 0.121937| train set 5.295x speedup, test set 0.827x speedup, val set 5.321x speedup, step: 27, train time 14.31 s
Epoch 41/50 |loss: 0.122919| train set 5.308x speedup, test set 0.834x speedup, val set 5.334x speedup, step: 28, train time 14.22 s
Epoch 42/50 |loss: 0.121616| train set 5.295x speedup, test set 0.807x speedup, val set 5.321x speedup, step: 29, train time 14.40 s
Epoch 43/50 |loss: 0.119698| train set 5.252x speedup, test set 0.893x speedup, val set 5.263x speedup, step: 30, train time 14.25 s
Epoch 44/50 |loss: 0.121226| train set 5.255x speedup, test set 0.823x speedup, val set 5.269x speedup, step: 31, train time 14.23 s
Epoch 45/50 |loss: 0.123011| train set 5.257x speedup, test set 0.830x speedup, val set 5.267x speedup, step: 32, train time 14.42 s
Epoch 46/50 |loss: 0.121679| train set 5.305x speedup, test set 0.832x speedup, val set 5.334x speedup, step: 33, train time 14.32 s
Epoch 47/50 |loss: 0.120480| train set 5.254x speedup, test set 0.818x speedup, val set 5.267x speedup, step: 34, train time 14.32 s
Epoch 48/50 |loss: 0.121087| train set 5.305x speedup, test set 0.919x speedup, val set 5.323x speedup, step: 35, train time 13.94 s
Epoch 49/50 |loss: 0.120355| train set 5.306x speedup, test set 0.920x speedup, val set 5.336x speedup, step: 1, train time 14.10 s
Training per epoch cost 14.397 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 12.697s, pg runtime 2.959s, speedup 0.233x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.089s, pg runtime 0.112s, speedup 1.262x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 24, train speedup 5.311, test speedup 0.893, val speedup 5.334
best test speedup epoch: 0, train speedup 4.886, test speedup 1.920, val speedup 4.881
best validation speedup epoch: 49, train speedup 5.306, test speedup 0.920, val speedup 5.336
last model at epoch 49, train speedup 5.306, test speedup 0.920, val speedup 5.336
execution cost 0:13:28.009407
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.908671, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.380644| train set 4.822x speedup, test set 0.988x speedup, val set 4.817x speedup, step: 1, train time 17.12 s
Epoch 1/50 |loss: 0.244443| train set 5.229x speedup, test set 0.917x speedup, val set 5.260x speedup, step: 2, train time 14.20 s
Epoch 2/50 |loss: 0.205019| train set 4.956x speedup, test set 0.959x speedup, val set 5.035x speedup, step: 3, train time 14.14 s
Epoch 3/50 |loss: 0.187420| train set 5.110x speedup, test set 0.869x speedup, val set 5.078x speedup, step: 4, train time 14.23 s
Epoch 4/50 |loss: 0.182740| train set 5.295x speedup, test set 0.780x speedup, val set 5.321x speedup, step: 1, train time 14.32 s
Epoch 5/50 |loss: 0.168313| train set 5.221x speedup, test set 0.892x speedup, val set 5.246x speedup, step: 2, train time 14.20 s
Epoch 6/50 |loss: 0.164917| train set 5.141x speedup, test set 0.928x speedup, val set 5.107x speedup, step: 3, train time 13.93 s
Epoch 7/50 |loss: 0.156614| train set 5.297x speedup, test set 0.830x speedup, val set 5.317x speedup, step: 4, train time 13.63 s
Epoch 8/50 |loss: 0.157777| train set 5.295x speedup, test set 0.932x speedup, val set 5.310x speedup, step: 5, train time 13.63 s
Epoch 9/50 |loss: 0.150259| train set 5.305x speedup, test set 0.862x speedup, val set 5.334x speedup, step: 1, train time 13.72 s
Epoch 10/50 |loss: 0.146314| train set 5.300x speedup, test set 0.831x speedup, val set 5.318x speedup, step: 2, train time 13.70 s
Epoch 11/50 |loss: 0.144027| train set 5.082x speedup, test set 0.847x speedup, val set 5.158x speedup, step: 3, train time 13.81 s
Epoch 12/50 |loss: 0.141815| train set 5.295x speedup, test set 0.862x speedup, val set 5.321x speedup, step: 4, train time 13.70 s
Epoch 13/50 |loss: 0.140761| train set 5.121x speedup, test set 0.850x speedup, val set 5.141x speedup, step: 5, train time 13.93 s
Epoch 14/50 |loss: 0.138953| train set 5.220x speedup, test set 0.872x speedup, val set 5.248x speedup, step: 6, train time 13.93 s
Epoch 15/50 |loss: 0.141005| train set 5.129x speedup, test set 0.862x speedup, val set 5.126x speedup, step: 7, train time 13.91 s
Epoch 16/50 |loss: 0.138593| train set 5.295x speedup, test set 0.860x speedup, val set 5.310x speedup, step: 8, train time 13.93 s
Epoch 17/50 |loss: 0.135261| train set 5.295x speedup, test set 0.826x speedup, val set 5.323x speedup, step: 9, train time 14.02 s
Epoch 18/50 |loss: 0.132843| train set 5.308x speedup, test set 0.853x speedup, val set 5.332x speedup, step: 10, train time 13.99 s
Epoch 19/50 |loss: 0.132955| train set 5.305x speedup, test set 0.841x speedup, val set 5.334x speedup, step: 1, train time 13.84 s
Epoch 20/50 |loss: 0.133592| train set 5.306x speedup, test set 0.820x speedup, val set 5.336x speedup, step: 2, train time 13.81 s
Epoch 21/50 |loss: 0.136390| train set 5.305x speedup, test set 0.892x speedup, val set 5.334x speedup, step: 3, train time 14.99 s
Epoch 22/50 |loss: 0.129685| train set 5.308x speedup, test set 0.854x speedup, val set 5.332x speedup, step: 4, train time 14.65 s
Epoch 23/50 |loss: 0.129886| train set 5.306x speedup, test set 0.870x speedup, val set 5.336x speedup, step: 5, train time 14.93 s
Epoch 24/50 |loss: 0.131132| train set 5.309x speedup, test set 0.825x speedup, val set 5.333x speedup, step: 6, train time 14.84 s
Epoch 25/50 |loss: 0.131396| train set 5.254x speedup, test set 0.735x speedup, val set 5.267x speedup, step: 7, train time 15.06 s
Epoch 26/50 |loss: 0.128149| train set 5.308x speedup, test set 0.835x speedup, val set 5.330x speedup, step: 8, train time 14.19 s
Epoch 27/50 |loss: 0.128378| train set 5.254x speedup, test set 0.866x speedup, val set 5.267x speedup, step: 9, train time 14.31 s
Epoch 28/50 |loss: 0.125202| train set 5.307x speedup, test set 0.792x speedup, val set 5.330x speedup, step: 10, train time 13.69 s
Epoch 29/50 |loss: 0.125981| train set 5.308x speedup, test set 0.830x speedup, val set 5.330x speedup, step: 11, train time 13.52 s
Epoch 30/50 |loss: 0.127531| train set 5.305x speedup, test set 0.715x speedup, val set 5.334x speedup, step: 12, train time 13.60 s
Epoch 31/50 |loss: 0.126305| train set 5.255x speedup, test set 0.778x speedup, val set 5.269x speedup, step: 13, train time 13.61 s
Epoch 32/50 |loss: 0.127323| train set 5.308x speedup, test set 0.704x speedup, val set 5.330x speedup, step: 14, train time 13.64 s
Epoch 33/50 |loss: 0.125503| train set 5.308x speedup, test set 0.834x speedup, val set 5.330x speedup, step: 15, train time 13.62 s
Epoch 34/50 |loss: 0.124175| train set 5.308x speedup, test set 0.831x speedup, val set 5.330x speedup, step: 16, train time 13.52 s
Epoch 35/50 |loss: 0.124398| train set 5.252x speedup, test set 0.730x speedup, val set 5.270x speedup, step: 17, train time 13.70 s
Epoch 36/50 |loss: 0.124462| train set 5.143x speedup, test set 0.859x speedup, val set 5.152x speedup, step: 18, train time 13.53 s
Epoch 37/50 |loss: 0.128290| train set 5.308x speedup, test set 0.756x speedup, val set 5.349x speedup, step: 19, train time 13.80 s
Epoch 38/50 |loss: 0.121732| train set 5.305x speedup, test set 0.827x speedup, val set 5.334x speedup, step: 20, train time 13.61 s
Epoch 39/50 |loss: 0.124071| train set 5.310x speedup, test set 0.762x speedup, val set 5.331x speedup, step: 21, train time 13.50 s
Epoch 40/50 |loss: 0.122345| train set 5.295x speedup, test set 0.760x speedup, val set 5.321x speedup, step: 22, train time 13.32 s
Epoch 41/50 |loss: 0.122419| train set 5.306x speedup, test set 0.752x speedup, val set 5.334x speedup, step: 23, train time 13.70 s
Epoch 42/50 |loss: 0.120783| train set 5.295x speedup, test set 0.763x speedup, val set 5.323x speedup, step: 24, train time 13.52 s
Epoch 43/50 |loss: 0.120834| train set 5.309x speedup, test set 0.696x speedup, val set 5.335x speedup, step: 25, train time 13.52 s
Epoch 44/50 |loss: 0.120984| train set 5.308x speedup, test set 0.684x speedup, val set 5.332x speedup, step: 26, train time 13.34 s
Epoch 45/50 |loss: 0.123132| train set 5.257x speedup, test set 0.788x speedup, val set 5.267x speedup, step: 27, train time 13.61 s
Epoch 46/50 |loss: 0.121553| train set 5.305x speedup, test set 0.801x speedup, val set 5.334x speedup, step: 28, train time 13.53 s
Epoch 47/50 |loss: 0.121005| train set 5.244x speedup, test set 0.804x speedup, val set 5.254x speedup, step: 29, train time 13.71 s
Epoch 48/50 |loss: 0.121263| train set 5.305x speedup, test set 0.781x speedup, val set 5.323x speedup, step: 30, train time 13.54 s
Epoch 49/50 |loss: 0.120666| train set 5.306x speedup, test set 0.785x speedup, val set 5.336x speedup, step: 1, train time 13.52 s
Training per epoch cost 13.946 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 2.801s, pg runtime 0.348s, speedup 0.124x
05, opt runtime 2.262s, model runtime 4.836s, pg runtime 3.549s, speedup 0.734x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 12.697s, pg runtime 2.959s, speedup 0.233x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 2.986s, pg runtime 0.313s, speedup 0.105x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 0.527s, pg runtime 0.891s, speedup 1.692x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 2.042s, pg runtime 0.154s, speedup 0.076x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 39, train speedup 5.310, test speedup 0.762, val speedup 5.331
best test speedup epoch: 0, train speedup 4.822, test speedup 0.988, val speedup 4.817
best validation speedup epoch: 49, train speedup 5.306, test speedup 0.785, val speedup 5.336
last model at epoch 49, train speedup 5.306, test speedup 0.785, val speedup 5.336
execution cost 0:12:59.880940
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.928933, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.383733| train set 4.695x speedup, test set 1.087x speedup, val set 4.585x speedup, step: 1, train time 16.54 s
Epoch 1/50 |loss: 0.249997| train set 4.830x speedup, test set 0.875x speedup, val set 4.808x speedup, step: 2, train time 13.91 s
Epoch 2/50 |loss: 0.206167| train set 5.110x speedup, test set 0.912x speedup, val set 5.127x speedup, step: 3, train time 13.63 s
Epoch 3/50 |loss: 0.192029| train set 4.725x speedup, test set 0.827x speedup, val set 4.581x speedup, step: 4, train time 13.62 s
Epoch 4/50 |loss: 0.182157| train set 5.219x speedup, test set 0.813x speedup, val set 5.249x speedup, step: 1, train time 13.62 s
Epoch 5/50 |loss: 0.169921| train set 5.231x speedup, test set 0.802x speedup, val set 5.256x speedup, step: 2, train time 13.62 s
Epoch 6/50 |loss: 0.168291| train set 5.295x speedup, test set 0.880x speedup, val set 5.323x speedup, step: 3, train time 13.60 s
Epoch 7/50 |loss: 0.157593| train set 5.297x speedup, test set 0.779x speedup, val set 5.317x speedup, step: 4, train time 13.63 s
Epoch 8/50 |loss: 0.158693| train set 5.297x speedup, test set 0.952x speedup, val set 5.317x speedup, step: 5, train time 13.60 s
Epoch 9/50 |loss: 0.151883| train set 5.295x speedup, test set 0.789x speedup, val set 5.321x speedup, step: 1, train time 13.61 s
Epoch 10/50 |loss: 0.147882| train set 5.298x speedup, test set 0.829x speedup, val set 5.318x speedup, step: 2, train time 13.72 s
Epoch 11/50 |loss: 0.143636| train set 5.244x speedup, test set 0.820x speedup, val set 5.254x speedup, step: 3, train time 13.64 s
Epoch 12/50 |loss: 0.140772| train set 5.295x speedup, test set 0.759x speedup, val set 5.321x speedup, step: 4, train time 13.60 s
Epoch 13/50 |loss: 0.141016| train set 5.154x speedup, test set 0.862x speedup, val set 5.141x speedup, step: 5, train time 13.62 s
Epoch 14/50 |loss: 0.137941| train set 5.308x speedup, test set 0.882x speedup, val set 5.330x speedup, step: 1, train time 13.62 s
Epoch 15/50 |loss: 0.139314| train set 5.074x speedup, test set 0.829x speedup, val set 5.066x speedup, step: 2, train time 13.61 s
Epoch 16/50 |loss: 0.135864| train set 5.295x speedup, test set 0.885x speedup, val set 5.310x speedup, step: 3, train time 13.72 s
Epoch 17/50 |loss: 0.133123| train set 5.295x speedup, test set 0.879x speedup, val set 5.321x speedup, step: 4, train time 13.62 s
Epoch 18/50 |loss: 0.131487| train set 5.194x speedup, test set 0.850x speedup, val set 5.215x speedup, step: 5, train time 13.70 s
Epoch 19/50 |loss: 0.132564| train set 5.305x speedup, test set 0.829x speedup, val set 5.334x speedup, step: 1, train time 13.62 s
Epoch 20/50 |loss: 0.130935| train set 5.297x speedup, test set 0.870x speedup, val set 5.317x speedup, step: 2, train time 13.60 s
Epoch 21/50 |loss: 0.134268| train set 5.305x speedup, test set 0.928x speedup, val set 5.334x speedup, step: 3, train time 14.51 s
Epoch 22/50 |loss: 0.129470| train set 5.254x speedup, test set 0.781x speedup, val set 5.267x speedup, step: 4, train time 14.03 s
Epoch 23/50 |loss: 0.129972| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 5, train time 13.99 s
Epoch 24/50 |loss: 0.128367| train set 5.309x speedup, test set 0.852x speedup, val set 5.333x speedup, step: 6, train time 13.80 s
Epoch 25/50 |loss: 0.129972| train set 5.254x speedup, test set 0.769x speedup, val set 5.267x speedup, step: 7, train time 13.52 s
Epoch 26/50 |loss: 0.126730| train set 5.308x speedup, test set 0.847x speedup, val set 5.330x speedup, step: 8, train time 13.53 s
Epoch 27/50 |loss: 0.127044| train set 5.308x speedup, test set 0.942x speedup, val set 5.330x speedup, step: 9, train time 13.72 s
Epoch 28/50 |loss: 0.124720| train set 5.305x speedup, test set 0.890x speedup, val set 5.323x speedup, step: 10, train time 13.51 s
Epoch 29/50 |loss: 0.125621| train set 5.308x speedup, test set 0.861x speedup, val set 5.332x speedup, step: 11, train time 13.60 s
Epoch 30/50 |loss: 0.126595| train set 5.307x speedup, test set 0.797x speedup, val set 5.339x speedup, step: 12, train time 13.51 s
Epoch 31/50 |loss: 0.124811| train set 5.252x speedup, test set 0.880x speedup, val set 5.263x speedup, step: 13, train time 13.61 s
Epoch 32/50 |loss: 0.126400| train set 5.308x speedup, test set 0.891x speedup, val set 5.330x speedup, step: 14, train time 13.62 s
Epoch 33/50 |loss: 0.123981| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 15, train time 13.53 s
Epoch 34/50 |loss: 0.122043| train set 5.309x speedup, test set 0.873x speedup, val set 5.333x speedup, step: 16, train time 13.60 s
Epoch 35/50 |loss: 0.123305| train set 5.252x speedup, test set 0.873x speedup, val set 5.270x speedup, step: 17, train time 13.73 s
Epoch 36/50 |loss: 0.125184| train set 5.143x speedup, test set 0.883x speedup, val set 5.156x speedup, step: 18, train time 13.43 s
Epoch 37/50 |loss: 0.127652| train set 5.305x speedup, test set 0.807x speedup, val set 5.334x speedup, step: 19, train time 13.61 s
early stopping at epoch 37
Training per epoch cost 13.745 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 8.146s, pg runtime 2.959s, speedup 0.363x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 2.986s, pg runtime 0.313s, speedup 0.105x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 2.523s, pg runtime 0.189s, speedup 0.075x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.115s, pg runtime 0.112s, speedup 0.974x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 12.105s, pg runtime 0.023s, speedup 0.002x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 24, train speedup 5.309, test speedup 0.852, val speedup 5.333
best test speedup epoch: 0, train speedup 4.695, test speedup 1.087, val speedup 4.585
best validation speedup epoch: 19, train speedup 5.305, test speedup 0.829, val speedup 5.334
last model at epoch 37, train speedup 5.305, test speedup 0.807, val speedup 5.334
execution cost 0:09:46.593691
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.997912, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.382928| train set 4.821x speedup, test set 0.948x speedup, val set 4.819x speedup, step: 1, train time 17.03 s
Epoch 1/50 |loss: 0.247397| train set 4.830x speedup, test set 0.785x speedup, val set 4.810x speedup, step: 2, train time 14.04 s
Epoch 2/50 |loss: 0.204101| train set 4.929x speedup, test set 0.850x speedup, val set 5.001x speedup, step: 3, train time 14.00 s
Epoch 3/50 |loss: 0.186695| train set 5.295x speedup, test set 0.848x speedup, val set 5.310x speedup, step: 4, train time 13.78 s
Epoch 4/50 |loss: 0.181510| train set 5.295x speedup, test set 0.860x speedup, val set 5.321x speedup, step: 1, train time 13.52 s
Epoch 5/50 |loss: 0.172979| train set 5.012x speedup, test set 0.869x speedup, val set 4.915x speedup, step: 2, train time 13.73 s
Epoch 6/50 |loss: 0.163991| train set 5.295x speedup, test set 0.868x speedup, val set 5.323x speedup, step: 3, train time 13.55 s
Epoch 7/50 |loss: 0.155326| train set 5.297x speedup, test set 0.854x speedup, val set 5.317x speedup, step: 4, train time 13.71 s
Epoch 8/50 |loss: 0.155558| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 5, train time 13.52 s
Epoch 9/50 |loss: 0.152633| train set 5.306x speedup, test set 0.868x speedup, val set 5.336x speedup, step: 1, train time 13.50 s
Epoch 10/50 |loss: 0.147907| train set 5.300x speedup, test set 0.869x speedup, val set 5.318x speedup, step: 2, train time 13.69 s
Epoch 11/50 |loss: 0.143210| train set 5.244x speedup, test set 0.848x speedup, val set 5.254x speedup, step: 3, train time 13.51 s
Epoch 12/50 |loss: 0.139930| train set 5.295x speedup, test set 0.891x speedup, val set 5.321x speedup, step: 4, train time 13.71 s
Epoch 13/50 |loss: 0.143230| train set 5.297x speedup, test set 0.892x speedup, val set 5.317x speedup, step: 5, train time 13.43 s
Epoch 14/50 |loss: 0.137262| train set 5.308x speedup, test set 0.854x speedup, val set 5.330x speedup, step: 6, train time 13.62 s
Epoch 15/50 |loss: 0.138793| train set 5.079x speedup, test set 0.916x speedup, val set 5.068x speedup, step: 7, train time 13.62 s
Epoch 16/50 |loss: 0.139001| train set 5.295x speedup, test set 0.895x speedup, val set 5.310x speedup, step: 8, train time 13.72 s
Epoch 17/50 |loss: 0.134886| train set 5.297x speedup, test set 0.891x speedup, val set 5.317x speedup, step: 9, train time 13.52 s
Epoch 18/50 |loss: 0.131859| train set 5.308x speedup, test set 0.915x speedup, val set 5.332x speedup, step: 10, train time 13.72 s
Epoch 19/50 |loss: 0.132678| train set 5.305x speedup, test set 0.891x speedup, val set 5.334x speedup, step: 11, train time 13.69 s
Epoch 20/50 |loss: 0.134064| train set 5.305x speedup, test set 0.891x speedup, val set 5.334x speedup, step: 12, train time 13.71 s
Epoch 21/50 |loss: 0.134995| train set 5.308x speedup, test set 0.934x speedup, val set 5.330x speedup, step: 13, train time 14.43 s
Epoch 22/50 |loss: 0.130499| train set 5.308x speedup, test set 0.891x speedup, val set 5.330x speedup, step: 14, train time 13.93 s
Epoch 23/50 |loss: 0.129984| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 15, train time 14.21 s
Epoch 24/50 |loss: 0.129459| train set 5.255x speedup, test set 0.869x speedup, val set 5.269x speedup, step: 16, train time 14.21 s
Epoch 25/50 |loss: 0.130564| train set 5.254x speedup, test set 0.829x speedup, val set 5.267x speedup, step: 17, train time 14.04 s
Epoch 26/50 |loss: 0.126896| train set 5.297x speedup, test set 0.829x speedup, val set 5.317x speedup, step: 18, train time 14.24 s
Epoch 27/50 |loss: 0.129020| train set 5.307x speedup, test set 0.875x speedup, val set 5.331x speedup, step: 19, train time 14.21 s
Epoch 28/50 |loss: 0.125782| train set 5.305x speedup, test set 0.908x speedup, val set 5.323x speedup, step: 20, train time 14.22 s
Epoch 29/50 |loss: 0.126962| train set 5.308x speedup, test set 0.829x speedup, val set 5.330x speedup, step: 21, train time 14.03 s
Epoch 30/50 |loss: 0.126014| train set 5.305x speedup, test set 0.865x speedup, val set 5.334x speedup, step: 22, train time 14.13 s
Epoch 31/50 |loss: 0.125529| train set 5.252x speedup, test set 0.916x speedup, val set 5.263x speedup, step: 23, train time 14.12 s
Epoch 32/50 |loss: 0.127743| train set 5.308x speedup, test set 0.854x speedup, val set 5.330x speedup, step: 24, train time 14.13 s
Epoch 33/50 |loss: 0.125361| train set 5.297x speedup, test set 0.895x speedup, val set 5.317x speedup, step: 25, train time 14.04 s
Epoch 34/50 |loss: 0.123851| train set 5.305x speedup, test set 0.890x speedup, val set 5.330x speedup, step: 26, train time 13.93 s
Epoch 35/50 |loss: 0.124701| train set 5.252x speedup, test set 0.807x speedup, val set 5.260x speedup, step: 27, train time 14.11 s
Epoch 36/50 |loss: 0.123449| train set 5.246x speedup, test set 0.892x speedup, val set 5.255x speedup, step: 28, train time 14.22 s
Epoch 37/50 |loss: 0.126098| train set 5.306x speedup, test set 0.865x speedup, val set 5.336x speedup, step: 29, train time 14.00 s
Epoch 38/50 |loss: 0.121506| train set 5.252x speedup, test set 0.960x speedup, val set 5.270x speedup, step: 30, train time 13.81 s
Epoch 39/50 |loss: 0.124055| train set 5.310x speedup, test set 0.865x speedup, val set 5.331x speedup, step: 31, train time 13.63 s
Epoch 40/50 |loss: 0.122250| train set 5.295x speedup, test set 0.865x speedup, val set 5.321x speedup, step: 32, train time 13.73 s
Epoch 41/50 |loss: 0.122977| train set 5.307x speedup, test set 0.938x speedup, val set 5.337x speedup, step: 33, train time 13.85 s
Epoch 42/50 |loss: 0.119989| train set 5.297x speedup, test set 0.888x speedup, val set 5.317x speedup, step: 34, train time 13.64 s
Epoch 43/50 |loss: 0.120566| train set 5.298x speedup, test set 0.934x speedup, val set 5.320x speedup, step: 35, train time 13.72 s
Epoch 44/50 |loss: 0.120269| train set 5.308x speedup, test set 0.851x speedup, val set 5.332x speedup, step: 36, train time 13.53 s
Epoch 45/50 |loss: 0.124534| train set 5.247x speedup, test set 0.938x speedup, val set 5.258x speedup, step: 37, train time 13.73 s
Epoch 46/50 |loss: 0.120531| train set 5.305x speedup, test set 0.934x speedup, val set 5.334x speedup, step: 38, train time 13.51 s
Epoch 47/50 |loss: 0.121253| train set 5.247x speedup, test set 0.929x speedup, val set 5.258x speedup, step: 39, train time 13.81 s
Epoch 48/50 |loss: 0.120427| train set 5.309x speedup, test set 0.912x speedup, val set 5.337x speedup, step: 40, train time 13.65 s
Epoch 49/50 |loss: 0.120406| train set 5.306x speedup, test set 0.888x speedup, val set 5.336x speedup, step: 1, train time 13.63 s
Training per epoch cost 13.895 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 12.697s, pg runtime 2.959s, speedup 0.233x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 0.527s, pg runtime 0.891s, speedup 1.692x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.124s, pg runtime 0.112s, speedup 0.907x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 39, train speedup 5.310, test speedup 0.865, val speedup 5.331
best test speedup epoch: 38, train speedup 5.252, test speedup 0.960, val speedup 5.270
best validation speedup epoch: 49, train speedup 5.306, test speedup 0.888, val speedup 5.336
last model at epoch 49, train speedup 5.306, test speedup 0.888, val speedup 5.336
execution cost 0:12:59.302850
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.557235, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.380687| train set 4.822x speedup, test set 0.936x speedup, val set 4.820x speedup, step: 1, train time 10.34 s
Epoch 1/50 |loss: 0.247540| train set 5.229x speedup, test set 0.903x speedup, val set 5.262x speedup, step: 2, train time 9.07 s
Epoch 2/50 |loss: 0.204007| train set 5.110x speedup, test set 0.892x speedup, val set 5.126x speedup, step: 3, train time 8.88 s
Epoch 3/50 |loss: 0.189987| train set 4.910x speedup, test set 0.898x speedup, val set 4.768x speedup, step: 4, train time 9.01 s
Epoch 4/50 |loss: 0.183787| train set 5.295x speedup, test set 0.905x speedup, val set 5.321x speedup, step: 1, train time 9.17 s
Epoch 5/50 |loss: 0.172310| train set 5.232x speedup, test set 0.912x speedup, val set 5.258x speedup, step: 2, train time 9.09 s
Epoch 6/50 |loss: 0.165713| train set 5.295x speedup, test set 0.912x speedup, val set 5.323x speedup, step: 3, train time 9.01 s
Epoch 7/50 |loss: 0.159839| train set 5.083x speedup, test set 0.915x speedup, val set 5.085x speedup, step: 4, train time 8.98 s
Epoch 8/50 |loss: 0.155940| train set 5.307x speedup, test set 0.919x speedup, val set 5.326x speedup, step: 5, train time 9.49 s
Epoch 9/50 |loss: 0.154333| train set 5.305x speedup, test set 0.915x speedup, val set 5.334x speedup, step: 1, train time 9.01 s
Epoch 10/50 |loss: 0.149942| train set 5.297x speedup, test set 0.919x speedup, val set 5.317x speedup, step: 2, train time 9.00 s
Epoch 11/50 |loss: 0.145180| train set 5.244x speedup, test set 0.898x speedup, val set 5.254x speedup, step: 3, train time 8.88 s
Epoch 12/50 |loss: 0.142360| train set 5.295x speedup, test set 0.881x speedup, val set 5.321x speedup, step: 4, train time 8.81 s
Epoch 13/50 |loss: 0.147043| train set 5.221x speedup, test set 0.912x speedup, val set 5.243x speedup, step: 5, train time 8.90 s
Epoch 14/50 |loss: 0.139604| train set 5.220x speedup, test set 0.930x speedup, val set 5.251x speedup, step: 6, train time 8.82 s
Epoch 15/50 |loss: 0.140867| train set 5.074x speedup, test set 0.894x speedup, val set 5.060x speedup, step: 7, train time 9.11 s
Epoch 16/50 |loss: 0.138472| train set 5.295x speedup, test set 0.894x speedup, val set 5.310x speedup, step: 8, train time 9.10 s
Epoch 17/50 |loss: 0.137122| train set 5.297x speedup, test set 0.880x speedup, val set 5.317x speedup, step: 9, train time 9.26 s
Epoch 18/50 |loss: 0.133337| train set 5.194x speedup, test set 0.915x speedup, val set 5.215x speedup, step: 10, train time 8.98 s
Epoch 19/50 |loss: 0.132891| train set 5.305x speedup, test set 0.909x speedup, val set 5.334x speedup, step: 1, train time 9.06 s
Epoch 20/50 |loss: 0.133381| train set 5.305x speedup, test set 0.915x speedup, val set 5.334x speedup, step: 2, train time 8.81 s
Epoch 21/50 |loss: 0.135936| train set 5.305x speedup, test set 0.909x speedup, val set 5.334x speedup, step: 3, train time 9.58 s
Epoch 22/50 |loss: 0.131405| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 4, train time 8.79 s
Epoch 23/50 |loss: 0.130329| train set 5.308x speedup, test set 0.863x speedup, val set 5.330x speedup, step: 5, train time 9.12 s
Epoch 24/50 |loss: 0.130089| train set 5.309x speedup, test set 0.807x speedup, val set 5.333x speedup, step: 6, train time 9.10 s
Epoch 25/50 |loss: 0.132446| train set 5.254x speedup, test set 0.882x speedup, val set 5.267x speedup, step: 7, train time 9.19 s
Epoch 26/50 |loss: 0.127789| train set 5.308x speedup, test set 0.884x speedup, val set 5.330x speedup, step: 8, train time 9.31 s
Epoch 27/50 |loss: 0.129371| train set 5.303x speedup, test set 0.868x speedup, val set 5.322x speedup, step: 9, train time 9.13 s
Epoch 28/50 |loss: 0.127455| train set 5.305x speedup, test set 0.859x speedup, val set 5.326x speedup, step: 10, train time 9.06 s
Epoch 29/50 |loss: 0.127575| train set 5.297x speedup, test set 0.849x speedup, val set 5.317x speedup, step: 11, train time 8.70 s
Epoch 30/50 |loss: 0.127934| train set 5.308x speedup, test set 0.798x speedup, val set 5.330x speedup, step: 12, train time 9.00 s
Epoch 31/50 |loss: 0.126591| train set 5.305x speedup, test set 0.882x speedup, val set 5.326x speedup, step: 13, train time 8.89 s
Epoch 32/50 |loss: 0.127835| train set 5.308x speedup, test set 0.820x speedup, val set 5.330x speedup, step: 14, train time 9.10 s
Epoch 33/50 |loss: 0.126417| train set 5.297x speedup, test set 0.859x speedup, val set 5.317x speedup, step: 15, train time 8.96 s
Epoch 34/50 |loss: 0.124310| train set 5.308x speedup, test set 0.855x speedup, val set 5.330x speedup, step: 16, train time 9.02 s
Epoch 35/50 |loss: 0.125213| train set 5.305x speedup, test set 0.820x speedup, val set 5.334x speedup, step: 17, train time 8.91 s
Epoch 36/50 |loss: 0.124882| train set 5.141x speedup, test set 0.863x speedup, val set 5.155x speedup, step: 18, train time 8.88 s
Epoch 37/50 |loss: 0.128952| train set 5.306x speedup, test set 0.820x speedup, val set 5.336x speedup, step: 19, train time 8.88 s
Epoch 38/50 |loss: 0.122075| train set 5.252x speedup, test set 0.878x speedup, val set 5.270x speedup, step: 20, train time 9.01 s
Epoch 39/50 |loss: 0.127166| train set 5.258x speedup, test set 0.859x speedup, val set 5.270x speedup, step: 21, train time 9.42 s
Epoch 40/50 |loss: 0.125164| train set 5.295x speedup, test set 0.801x speedup, val set 5.321x speedup, step: 22, train time 8.81 s
Epoch 41/50 |loss: 0.123992| train set 5.305x speedup, test set 0.824x speedup, val set 5.334x speedup, step: 23, train time 8.92 s
Epoch 42/50 |loss: 0.121263| train set 5.295x speedup, test set 0.824x speedup, val set 5.321x speedup, step: 24, train time 9.11 s
Epoch 43/50 |loss: 0.121041| train set 5.309x speedup, test set 0.852x speedup, val set 5.333x speedup, step: 25, train time 9.37 s
Epoch 44/50 |loss: 0.122870| train set 5.308x speedup, test set 0.824x speedup, val set 5.330x speedup, step: 26, train time 8.68 s
Epoch 45/50 |loss: 0.124478| train set 5.257x speedup, test set 0.815x speedup, val set 5.267x speedup, step: 27, train time 8.90 s
Epoch 46/50 |loss: 0.122103| train set 5.305x speedup, test set 0.863x speedup, val set 5.334x speedup, step: 28, train time 8.88 s
Epoch 47/50 |loss: 0.122283| train set 5.254x speedup, test set 0.863x speedup, val set 5.267x speedup, step: 29, train time 8.91 s
early stopping at epoch 47
Training per epoch cost 9.050 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 24, train speedup 5.309, test speedup 0.807, val speedup 5.333
best test speedup epoch: 0, train speedup 4.822, test speedup 0.936, val speedup 4.820
best validation speedup epoch: 19, train speedup 5.305, test speedup 0.909, val speedup 5.334
last model at epoch 47, train speedup 5.254, test speedup 0.863, val speedup 5.267
execution cost 0:07:46.301749
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.555127, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.382783| train set 4.745x speedup, test set 1.090x speedup, val set 4.798x speedup, step: 1, train time 10.49 s
Epoch 1/50 |loss: 0.251671| train set 4.854x speedup, test set 0.906x speedup, val set 4.729x speedup, step: 2, train time 9.18 s
Epoch 2/50 |loss: 0.206314| train set 5.110x speedup, test set 0.859x speedup, val set 5.126x speedup, step: 3, train time 9.08 s
Epoch 3/50 |loss: 0.190003| train set 5.070x speedup, test set 0.866x speedup, val set 4.963x speedup, step: 4, train time 9.22 s
Epoch 4/50 |loss: 0.184140| train set 5.295x speedup, test set 0.814x speedup, val set 5.321x speedup, step: 1, train time 9.16 s
Epoch 5/50 |loss: 0.170432| train set 5.297x speedup, test set 0.905x speedup, val set 5.320x speedup, step: 2, train time 9.37 s
Epoch 6/50 |loss: 0.165737| train set 5.294x speedup, test set 0.898x speedup, val set 5.323x speedup, step: 3, train time 9.18 s
Epoch 7/50 |loss: 0.158150| train set 5.297x speedup, test set 0.926x speedup, val set 5.317x speedup, step: 4, train time 9.01 s
Epoch 8/50 |loss: 0.158113| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 5, train time 8.88 s
Epoch 9/50 |loss: 0.153202| train set 5.306x speedup, test set 0.909x speedup, val set 5.336x speedup, step: 1, train time 8.99 s
Epoch 10/50 |loss: 0.148467| train set 5.224x speedup, test set 0.909x speedup, val set 5.246x speedup, step: 2, train time 9.08 s
Epoch 11/50 |loss: 0.145180| train set 5.244x speedup, test set 0.906x speedup, val set 5.254x speedup, step: 3, train time 9.30 s
Epoch 12/50 |loss: 0.142265| train set 5.295x speedup, test set 0.859x speedup, val set 5.321x speedup, step: 4, train time 9.11 s
Epoch 13/50 |loss: 0.142465| train set 5.305x speedup, test set 0.930x speedup, val set 5.323x speedup, step: 5, train time 9.11 s
Epoch 14/50 |loss: 0.137381| train set 5.305x speedup, test set 0.919x speedup, val set 5.334x speedup, step: 6, train time 8.68 s
Epoch 15/50 |loss: 0.139428| train set 5.074x speedup, test set 0.886x speedup, val set 5.060x speedup, step: 7, train time 9.38 s
Epoch 16/50 |loss: 0.137844| train set 5.295x speedup, test set 0.906x speedup, val set 5.310x speedup, step: 8, train time 8.78 s
Epoch 17/50 |loss: 0.134456| train set 5.103x speedup, test set 0.909x speedup, val set 5.109x speedup, step: 9, train time 8.99 s
Epoch 18/50 |loss: 0.132387| train set 5.204x speedup, test set 0.906x speedup, val set 5.227x speedup, step: 10, train time 9.01 s
Epoch 19/50 |loss: 0.134326| train set 5.305x speedup, test set 0.909x speedup, val set 5.334x speedup, step: 11, train time 8.77 s
Epoch 20/50 |loss: 0.132670| train set 5.307x speedup, test set 0.896x speedup, val set 5.331x speedup, step: 12, train time 9.11 s
Epoch 21/50 |loss: 0.134882| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 13, train time 9.76 s
Epoch 22/50 |loss: 0.130114| train set 5.254x speedup, test set 0.961x speedup, val set 5.267x speedup, step: 14, train time 9.56 s
Epoch 23/50 |loss: 0.130565| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 15, train time 9.31 s
Epoch 24/50 |loss: 0.128186| train set 5.309x speedup, test set 0.940x speedup, val set 5.333x speedup, step: 16, train time 9.08 s
Epoch 25/50 |loss: 0.132118| train set 5.254x speedup, test set 0.952x speedup, val set 5.267x speedup, step: 17, train time 8.99 s
Epoch 26/50 |loss: 0.128583| train set 5.308x speedup, test set 0.940x speedup, val set 5.330x speedup, step: 18, train time 9.00 s
Epoch 27/50 |loss: 0.128034| train set 5.254x speedup, test set 0.965x speedup, val set 5.267x speedup, step: 19, train time 9.07 s
Epoch 28/50 |loss: 0.125801| train set 5.308x speedup, test set 0.902x speedup, val set 5.332x speedup, step: 20, train time 9.19 s
Epoch 29/50 |loss: 0.126959| train set 5.297x speedup, test set 0.860x speedup, val set 5.320x speedup, step: 21, train time 8.98 s
Epoch 30/50 |loss: 0.127471| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 22, train time 9.08 s
Epoch 31/50 |loss: 0.125592| train set 5.252x speedup, test set 0.940x speedup, val set 5.263x speedup, step: 23, train time 8.79 s
Epoch 32/50 |loss: 0.126551| train set 5.308x speedup, test set 0.940x speedup, val set 5.330x speedup, step: 24, train time 9.09 s
Epoch 33/50 |loss: 0.125416| train set 5.308x speedup, test set 0.940x speedup, val set 5.330x speedup, step: 25, train time 9.01 s
Epoch 34/50 |loss: 0.123790| train set 5.309x speedup, test set 0.870x speedup, val set 5.333x speedup, step: 26, train time 9.00 s
Epoch 35/50 |loss: 0.125354| train set 5.252x speedup, test set 0.943x speedup, val set 5.270x speedup, step: 27, train time 9.22 s
Epoch 36/50 |loss: 0.126102| train set 5.143x speedup, test set 0.909x speedup, val set 5.152x speedup, step: 28, train time 8.89 s
Epoch 37/50 |loss: 0.127974| train set 5.306x speedup, test set 0.940x speedup, val set 5.336x speedup, step: 29, train time 8.97 s
early stopping at epoch 37
Training per epoch cost 9.128 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 24, train speedup 5.309, test speedup 0.940, val speedup 5.333
best test speedup epoch: 0, train speedup 4.745, test speedup 1.090, val speedup 4.798
best validation speedup epoch: 9, train speedup 5.306, test speedup 0.909, val speedup 5.336
last model at epoch 37, train speedup 5.306, test speedup 0.940, val speedup 5.336
execution cost 0:06:12.672450
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.545216, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.380595| train set 4.822x speedup, test set 0.911x speedup, val set 4.820x speedup, step: 1, train time 10.26 s
Epoch 1/50 |loss: 0.250282| train set 4.830x speedup, test set 0.929x speedup, val set 4.808x speedup, step: 2, train time 9.11 s
Epoch 2/50 |loss: 0.207049| train set 5.110x speedup, test set 0.891x speedup, val set 5.127x speedup, step: 3, train time 8.99 s
Epoch 3/50 |loss: 0.186471| train set 4.939x speedup, test set 0.962x speedup, val set 4.899x speedup, step: 4, train time 9.01 s
Epoch 4/50 |loss: 0.179991| train set 5.295x speedup, test set 0.908x speedup, val set 5.321x speedup, step: 1, train time 8.92 s
Epoch 5/50 |loss: 0.172367| train set 5.232x speedup, test set 0.909x speedup, val set 5.258x speedup, step: 2, train time 8.99 s
Epoch 6/50 |loss: 0.165311| train set 5.295x speedup, test set 0.862x speedup, val set 5.323x speedup, step: 3, train time 9.08 s
Epoch 7/50 |loss: 0.157592| train set 5.297x speedup, test set 0.915x speedup, val set 5.317x speedup, step: 4, train time 8.58 s
Epoch 8/50 |loss: 0.154319| train set 5.297x speedup, test set 0.916x speedup, val set 5.317x speedup, step: 5, train time 8.88 s
Epoch 9/50 |loss: 0.153944| train set 5.306x speedup, test set 0.929x speedup, val set 5.336x speedup, step: 1, train time 8.88 s
Epoch 10/50 |loss: 0.149232| train set 5.300x speedup, test set 0.889x speedup, val set 5.318x speedup, step: 2, train time 8.87 s
Epoch 11/50 |loss: 0.143765| train set 5.244x speedup, test set 0.889x speedup, val set 5.254x speedup, step: 3, train time 9.09 s
Epoch 12/50 |loss: 0.141628| train set 5.295x speedup, test set 0.887x speedup, val set 5.321x speedup, step: 4, train time 9.11 s
Epoch 13/50 |loss: 0.142547| train set 5.121x speedup, test set 0.888x speedup, val set 5.141x speedup, step: 5, train time 9.07 s
Epoch 14/50 |loss: 0.138630| train set 5.220x speedup, test set 0.926x speedup, val set 5.248x speedup, step: 6, train time 9.09 s
Epoch 15/50 |loss: 0.139638| train set 5.079x speedup, test set 0.867x speedup, val set 5.068x speedup, step: 7, train time 8.90 s
Epoch 16/50 |loss: 0.139469| train set 5.295x speedup, test set 0.875x speedup, val set 5.310x speedup, step: 8, train time 8.99 s
Epoch 17/50 |loss: 0.136680| train set 5.297x speedup, test set 0.829x speedup, val set 5.317x speedup, step: 9, train time 8.81 s
Epoch 18/50 |loss: 0.133148| train set 5.308x speedup, test set 0.892x speedup, val set 5.332x speedup, step: 10, train time 8.88 s
Epoch 19/50 |loss: 0.133163| train set 5.305x speedup, test set 0.888x speedup, val set 5.334x speedup, step: 11, train time 9.29 s
Epoch 20/50 |loss: 0.135048| train set 5.306x speedup, test set 0.857x speedup, val set 5.336x speedup, step: 12, train time 8.78 s
Epoch 21/50 |loss: 0.136178| train set 5.308x speedup, test set 0.896x speedup, val set 5.330x speedup, step: 13, train time 9.41 s
Epoch 22/50 |loss: 0.130542| train set 5.308x speedup, test set 0.871x speedup, val set 5.330x speedup, step: 14, train time 8.98 s
Epoch 23/50 |loss: 0.129473| train set 5.308x speedup, test set 0.858x speedup, val set 5.330x speedup, step: 15, train time 9.30 s
Epoch 24/50 |loss: 0.129921| train set 5.309x speedup, test set 0.857x speedup, val set 5.337x speedup, step: 1, train time 9.01 s
Epoch 25/50 |loss: 0.131895| train set 5.254x speedup, test set 0.829x speedup, val set 5.267x speedup, step: 2, train time 9.31 s
Epoch 26/50 |loss: 0.127787| train set 5.308x speedup, test set 0.833x speedup, val set 5.330x speedup, step: 3, train time 8.99 s
Epoch 27/50 |loss: 0.128989| train set 5.308x speedup, test set 0.875x speedup, val set 5.330x speedup, step: 4, train time 9.53 s
Epoch 28/50 |loss: 0.127561| train set 5.305x speedup, test set 0.854x speedup, val set 5.326x speedup, step: 5, train time 9.27 s
Epoch 29/50 |loss: 0.126501| train set 5.308x speedup, test set 0.860x speedup, val set 5.332x speedup, step: 6, train time 8.91 s
Epoch 30/50 |loss: 0.127603| train set 5.308x speedup, test set 0.837x speedup, val set 5.330x speedup, step: 7, train time 8.82 s
Epoch 31/50 |loss: 0.125543| train set 5.305x speedup, test set 0.857x speedup, val set 5.326x speedup, step: 8, train time 8.81 s
Epoch 32/50 |loss: 0.128251| train set 5.308x speedup, test set 0.816x speedup, val set 5.330x speedup, step: 9, train time 8.86 s
Epoch 33/50 |loss: 0.126387| train set 5.308x speedup, test set 0.857x speedup, val set 5.332x speedup, step: 10, train time 8.89 s
Epoch 34/50 |loss: 0.124504| train set 5.308x speedup, test set 0.857x speedup, val set 5.330x speedup, step: 11, train time 9.50 s
Epoch 35/50 |loss: 0.125381| train set 5.252x speedup, test set 0.857x speedup, val set 5.270x speedup, step: 12, train time 9.38 s
Epoch 36/50 |loss: 0.125341| train set 5.141x speedup, test set 0.919x speedup, val set 5.155x speedup, step: 13, train time 8.98 s
Epoch 37/50 |loss: 0.127248| train set 5.305x speedup, test set 0.854x speedup, val set 5.336x speedup, step: 14, train time 9.38 s
Epoch 38/50 |loss: 0.122100| train set 5.252x speedup, test set 0.879x speedup, val set 5.273x speedup, step: 15, train time 9.41 s
Epoch 39/50 |loss: 0.124051| train set 5.301x speedup, test set 0.816x speedup, val set 5.321x speedup, step: 16, train time 8.92 s
Epoch 40/50 |loss: 0.123441| train set 5.295x speedup, test set 0.857x speedup, val set 5.321x speedup, step: 17, train time 9.09 s
Epoch 41/50 |loss: 0.123005| train set 5.308x speedup, test set 0.816x speedup, val set 5.334x speedup, step: 18, train time 9.00 s
Epoch 42/50 |loss: 0.121567| train set 5.295x speedup, test set 0.858x speedup, val set 5.321x speedup, step: 19, train time 9.17 s
Epoch 43/50 |loss: 0.120785| train set 5.309x speedup, test set 0.816x speedup, val set 5.335x speedup, step: 20, train time 9.01 s
Epoch 44/50 |loss: 0.120915| train set 5.308x speedup, test set 0.764x speedup, val set 5.332x speedup, step: 21, train time 8.81 s
Epoch 45/50 |loss: 0.123291| train set 5.254x speedup, test set 0.816x speedup, val set 5.267x speedup, step: 22, train time 9.20 s
Epoch 46/50 |loss: 0.121128| train set 5.305x speedup, test set 0.798x speedup, val set 5.334x speedup, step: 23, train time 9.48 s
Epoch 47/50 |loss: 0.121927| train set 5.246x speedup, test set 0.762x speedup, val set 5.255x speedup, step: 24, train time 9.27 s
Epoch 48/50 |loss: 0.121155| train set 5.305x speedup, test set 0.817x speedup, val set 5.323x speedup, step: 25, train time 8.82 s
Epoch 49/50 |loss: 0.120147| train set 5.305x speedup, test set 0.813x speedup, val set 5.334x speedup, step: 26, train time 9.00 s
Training per epoch cost 9.081 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 1.311s, pg runtime 0.965s, speedup 0.736x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 43, train speedup 5.309, test speedup 0.816, val speedup 5.335
best test speedup epoch: 3, train speedup 4.939, test speedup 0.962, val speedup 4.899
best validation speedup epoch: 24, train speedup 5.309, test speedup 0.857, val speedup 5.337
last model at epoch 49, train speedup 5.305, test speedup 0.813, val speedup 5.334
execution cost 0:08:05.793139
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.535979, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.381841| train set 4.822x speedup, test set 0.960x speedup, val set 4.820x speedup, step: 1, train time 9.92 s
Epoch 1/50 |loss: 0.249507| train set 5.060x speedup, test set 0.938x speedup, val set 5.046x speedup, step: 2, train time 8.96 s
Epoch 2/50 |loss: 0.205036| train set 5.305x speedup, test set 0.929x speedup, val set 5.336x speedup, step: 3, train time 9.02 s
Epoch 3/50 |loss: 0.189201| train set 4.910x speedup, test set 1.031x speedup, val set 4.768x speedup, step: 4, train time 9.21 s
Epoch 4/50 |loss: 0.182793| train set 5.295x speedup, test set 0.755x speedup, val set 5.321x speedup, step: 1, train time 8.92 s
Epoch 5/50 |loss: 0.171250| train set 5.003x speedup, test set 0.762x speedup, val set 4.902x speedup, step: 2, train time 9.00 s
Epoch 6/50 |loss: 0.166898| train set 5.141x speedup, test set 0.788x speedup, val set 5.107x speedup, step: 3, train time 9.02 s
Epoch 7/50 |loss: 0.158934| train set 5.297x speedup, test set 0.795x speedup, val set 5.317x speedup, step: 4, train time 8.88 s
Epoch 8/50 |loss: 0.157163| train set 5.305x speedup, test set 0.811x speedup, val set 5.323x speedup, step: 5, train time 9.08 s
Epoch 9/50 |loss: 0.154415| train set 5.306x speedup, test set 0.827x speedup, val set 5.336x speedup, step: 1, train time 8.91 s
Epoch 10/50 |loss: 0.150095| train set 5.221x speedup, test set 0.802x speedup, val set 5.237x speedup, step: 2, train time 9.02 s
Epoch 11/50 |loss: 0.147098| train set 5.297x speedup, test set 0.865x speedup, val set 5.317x speedup, step: 3, train time 9.00 s
Epoch 12/50 |loss: 0.142494| train set 5.295x speedup, test set 0.728x speedup, val set 5.321x speedup, step: 4, train time 8.91 s
Epoch 13/50 |loss: 0.145230| train set 5.297x speedup, test set 0.891x speedup, val set 5.317x speedup, step: 5, train time 8.80 s
Epoch 14/50 |loss: 0.139042| train set 5.220x speedup, test set 0.901x speedup, val set 5.248x speedup, step: 6, train time 9.09 s
Epoch 15/50 |loss: 0.140088| train set 5.079x speedup, test set 0.773x speedup, val set 5.068x speedup, step: 7, train time 9.09 s
Epoch 16/50 |loss: 0.140075| train set 5.295x speedup, test set 0.858x speedup, val set 5.310x speedup, step: 8, train time 9.09 s
Epoch 17/50 |loss: 0.137739| train set 5.297x speedup, test set 0.770x speedup, val set 5.317x speedup, step: 9, train time 9.29 s
Epoch 18/50 |loss: 0.133685| train set 5.204x speedup, test set 0.891x speedup, val set 5.227x speedup, step: 10, train time 8.98 s
Epoch 19/50 |loss: 0.134883| train set 5.305x speedup, test set 0.852x speedup, val set 5.334x speedup, step: 11, train time 9.01 s
Epoch 20/50 |loss: 0.135267| train set 5.295x speedup, test set 0.884x speedup, val set 5.321x speedup, step: 12, train time 9.00 s
Epoch 21/50 |loss: 0.136823| train set 5.305x speedup, test set 0.856x speedup, val set 5.334x speedup, step: 13, train time 9.70 s
Epoch 22/50 |loss: 0.131902| train set 5.308x speedup, test set 0.856x speedup, val set 5.332x speedup, step: 14, train time 8.88 s
Epoch 23/50 |loss: 0.130460| train set 5.308x speedup, test set 0.850x speedup, val set 5.330x speedup, step: 15, train time 9.18 s
Epoch 24/50 |loss: 0.130505| train set 5.256x speedup, test set 0.816x speedup, val set 5.270x speedup, step: 16, train time 9.21 s
Epoch 25/50 |loss: 0.133490| train set 5.254x speedup, test set 0.816x speedup, val set 5.267x speedup, step: 17, train time 9.18 s
Epoch 26/50 |loss: 0.129001| train set 5.308x speedup, test set 0.778x speedup, val set 5.330x speedup, step: 18, train time 9.10 s
Epoch 27/50 |loss: 0.129008| train set 5.308x speedup, test set 0.853x speedup, val set 5.330x speedup, step: 19, train time 9.09 s
Epoch 28/50 |loss: 0.126357| train set 5.305x speedup, test set 0.778x speedup, val set 5.326x speedup, step: 20, train time 9.18 s
Epoch 29/50 |loss: 0.128217| train set 5.297x speedup, test set 0.816x speedup, val set 5.317x speedup, step: 21, train time 9.29 s
Epoch 30/50 |loss: 0.128076| train set 5.305x speedup, test set 0.818x speedup, val set 5.334x speedup, step: 22, train time 9.08 s
Epoch 31/50 |loss: 0.126110| train set 5.252x speedup, test set 0.836x speedup, val set 5.263x speedup, step: 23, train time 9.21 s
Epoch 32/50 |loss: 0.127140| train set 5.308x speedup, test set 0.816x speedup, val set 5.330x speedup, step: 24, train time 9.01 s
Epoch 33/50 |loss: 0.126264| train set 5.300x speedup, test set 0.818x speedup, val set 5.318x speedup, step: 25, train time 9.28 s
Epoch 34/50 |loss: 0.125193| train set 5.308x speedup, test set 0.852x speedup, val set 5.330x speedup, step: 26, train time 9.11 s
Epoch 35/50 |loss: 0.125689| train set 5.252x speedup, test set 0.778x speedup, val set 5.270x speedup, step: 27, train time 8.92 s
Epoch 36/50 |loss: 0.125137| train set 5.242x speedup, test set 0.818x speedup, val set 5.258x speedup, step: 28, train time 9.19 s
Epoch 37/50 |loss: 0.129070| train set 5.306x speedup, test set 0.776x speedup, val set 5.336x speedup, step: 29, train time 8.79 s
Epoch 38/50 |loss: 0.123693| train set 5.252x speedup, test set 0.875x speedup, val set 5.270x speedup, step: 30, train time 9.10 s
Epoch 39/50 |loss: 0.125357| train set 5.246x speedup, test set 0.778x speedup, val set 5.255x speedup, step: 31, train time 9.10 s
Epoch 40/50 |loss: 0.124028| train set 5.295x speedup, test set 0.816x speedup, val set 5.321x speedup, step: 32, train time 8.88 s
Epoch 41/50 |loss: 0.123881| train set 5.305x speedup, test set 0.802x speedup, val set 5.334x speedup, step: 33, train time 9.17 s
Epoch 42/50 |loss: 0.121693| train set 5.295x speedup, test set 0.816x speedup, val set 5.321x speedup, step: 34, train time 9.38 s
Epoch 43/50 |loss: 0.121084| train set 5.306x speedup, test set 0.871x speedup, val set 5.328x speedup, step: 35, train time 9.00 s
Epoch 44/50 |loss: 0.122016| train set 5.254x speedup, test set 0.816x speedup, val set 5.267x speedup, step: 36, train time 9.28 s
Epoch 45/50 |loss: 0.125150| train set 5.257x speedup, test set 0.834x speedup, val set 5.267x speedup, step: 37, train time 8.78 s
Epoch 46/50 |loss: 0.121987| train set 5.305x speedup, test set 0.924x speedup, val set 5.334x speedup, step: 38, train time 9.09 s
Epoch 47/50 |loss: 0.122998| train set 5.244x speedup, test set 0.879x speedup, val set 5.254x speedup, step: 39, train time 9.01 s
Epoch 48/50 |loss: 0.122055| train set 5.308x speedup, test set 0.877x speedup, val set 5.330x speedup, step: 40, train time 9.12 s
Epoch 49/50 |loss: 0.121178| train set 5.306x speedup, test set 0.779x speedup, val set 5.336x speedup, step: 1, train time 9.08 s
Training per epoch cost 9.091 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 12.697s, pg runtime 2.959s, speedup 0.233x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 22, train speedup 5.308, test speedup 0.856, val speedup 5.332
best test speedup epoch: 3, train speedup 4.910, test speedup 1.031, val speedup 4.768
best validation speedup epoch: 49, train speedup 5.306, test speedup 0.779, val speedup 5.336
last model at epoch 49, train speedup 5.306, test speedup 0.779, val speedup 5.336
execution cost 0:08:06.206948
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.600028, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.380604| train set 4.822x speedup, test set 0.911x speedup, val set 4.820x speedup, step: 1, train time 10.08 s
Epoch 1/50 |loss: 0.249295| train set 5.119x speedup, test set 0.880x speedup, val set 5.142x speedup, step: 2, train time 8.73 s
Epoch 2/50 |loss: 0.205145| train set 4.842x speedup, test set 0.909x speedup, val set 4.933x speedup, step: 3, train time 8.82 s
Epoch 3/50 |loss: 0.187743| train set 5.070x speedup, test set 0.889x speedup, val set 4.961x speedup, step: 4, train time 8.61 s
Epoch 4/50 |loss: 0.183462| train set 5.295x speedup, test set 0.788x speedup, val set 5.321x speedup, step: 1, train time 8.69 s
Epoch 5/50 |loss: 0.171301| train set 5.231x speedup, test set 0.786x speedup, val set 5.256x speedup, step: 2, train time 8.61 s
Epoch 6/50 |loss: 0.163414| train set 5.141x speedup, test set 0.847x speedup, val set 5.107x speedup, step: 3, train time 8.80 s
Epoch 7/50 |loss: 0.155960| train set 5.297x speedup, test set 0.890x speedup, val set 5.317x speedup, step: 4, train time 8.79 s
Epoch 8/50 |loss: 0.157126| train set 5.308x speedup, test set 0.915x speedup, val set 5.330x speedup, step: 5, train time 8.61 s
Epoch 9/50 |loss: 0.151896| train set 5.294x speedup, test set 0.908x speedup, val set 5.323x speedup, step: 1, train time 8.79 s
Epoch 10/50 |loss: 0.148439| train set 5.301x speedup, test set 0.893x speedup, val set 5.321x speedup, step: 2, train time 8.56 s
Epoch 11/50 |loss: 0.143220| train set 5.244x speedup, test set 0.892x speedup, val set 5.254x speedup, step: 3, train time 8.80 s
Epoch 12/50 |loss: 0.140241| train set 5.295x speedup, test set 0.888x speedup, val set 5.321x speedup, step: 4, train time 8.51 s
Epoch 13/50 |loss: 0.142899| train set 5.297x speedup, test set 0.892x speedup, val set 5.317x speedup, step: 5, train time 9.03 s
Epoch 14/50 |loss: 0.136872| train set 5.220x speedup, test set 0.916x speedup, val set 5.251x speedup, step: 6, train time 9.01 s
Epoch 15/50 |loss: 0.139654| train set 5.074x speedup, test set 0.894x speedup, val set 5.060x speedup, step: 7, train time 8.68 s
Epoch 16/50 |loss: 0.140248| train set 5.295x speedup, test set 0.848x speedup, val set 5.310x speedup, step: 8, train time 8.72 s
Epoch 17/50 |loss: 0.135872| train set 5.297x speedup, test set 0.888x speedup, val set 5.317x speedup, step: 9, train time 8.81 s
Epoch 18/50 |loss: 0.130608| train set 5.308x speedup, test set 0.888x speedup, val set 5.332x speedup, step: 10, train time 9.01 s
Epoch 19/50 |loss: 0.132117| train set 5.305x speedup, test set 0.912x speedup, val set 5.334x speedup, step: 1, train time 8.67 s
Epoch 20/50 |loss: 0.132183| train set 5.305x speedup, test set 0.888x speedup, val set 5.334x speedup, step: 2, train time 8.58 s
Epoch 21/50 |loss: 0.135704| train set 5.305x speedup, test set 0.893x speedup, val set 5.334x speedup, step: 3, train time 9.12 s
Epoch 22/50 |loss: 0.129772| train set 5.308x speedup, test set 0.889x speedup, val set 5.332x speedup, step: 4, train time 8.69 s
Epoch 23/50 |loss: 0.129696| train set 5.308x speedup, test set 0.912x speedup, val set 5.332x speedup, step: 5, train time 9.09 s
Epoch 24/50 |loss: 0.129748| train set 5.256x speedup, test set 0.889x speedup, val set 5.270x speedup, step: 6, train time 8.49 s
Epoch 25/50 |loss: 0.131616| train set 5.254x speedup, test set 0.769x speedup, val set 5.267x speedup, step: 7, train time 8.59 s
Epoch 26/50 |loss: 0.126172| train set 5.308x speedup, test set 0.854x speedup, val set 5.330x speedup, step: 8, train time 8.51 s
Epoch 27/50 |loss: 0.127179| train set 5.254x speedup, test set 0.879x speedup, val set 5.267x speedup, step: 9, train time 8.68 s
Epoch 28/50 |loss: 0.125769| train set 5.305x speedup, test set 0.858x speedup, val set 5.323x speedup, step: 10, train time 8.71 s
Epoch 29/50 |loss: 0.127313| train set 5.308x speedup, test set 0.848x speedup, val set 5.330x speedup, step: 11, train time 8.78 s
Epoch 30/50 |loss: 0.126241| train set 5.308x speedup, test set 0.808x speedup, val set 5.330x speedup, step: 12, train time 8.72 s
Epoch 31/50 |loss: 0.125047| train set 5.308x speedup, test set 0.893x speedup, val set 5.332x speedup, step: 13, train time 9.00 s
Epoch 32/50 |loss: 0.125350| train set 5.308x speedup, test set 0.740x speedup, val set 5.330x speedup, step: 14, train time 8.60 s
Epoch 33/50 |loss: 0.126044| train set 5.297x speedup, test set 0.810x speedup, val set 5.317x speedup, step: 15, train time 8.80 s
Epoch 34/50 |loss: 0.123436| train set 5.308x speedup, test set 0.854x speedup, val set 5.330x speedup, step: 16, train time 8.77 s
Epoch 35/50 |loss: 0.124333| train set 5.252x speedup, test set 0.779x speedup, val set 5.270x speedup, step: 17, train time 8.96 s
Epoch 36/50 |loss: 0.124766| train set 5.140x speedup, test set 0.851x speedup, val set 5.145x speedup, step: 18, train time 8.79 s
Epoch 37/50 |loss: 0.127352| train set 5.305x speedup, test set 0.854x speedup, val set 5.334x speedup, step: 19, train time 8.71 s
Epoch 38/50 |loss: 0.121442| train set 5.140x speedup, test set 0.875x speedup, val set 5.237x speedup, step: 20, train time 8.66 s
Epoch 39/50 |loss: 0.123921| train set 5.257x speedup, test set 0.704x speedup, val set 5.267x speedup, step: 21, train time 8.79 s
Epoch 40/50 |loss: 0.122113| train set 5.295x speedup, test set 0.704x speedup, val set 5.321x speedup, step: 22, train time 8.80 s
Epoch 41/50 |loss: 0.122014| train set 5.305x speedup, test set 0.854x speedup, val set 5.334x speedup, step: 23, train time 8.62 s
Epoch 42/50 |loss: 0.119804| train set 5.295x speedup, test set 0.854x speedup, val set 5.323x speedup, step: 24, train time 8.59 s
Epoch 43/50 |loss: 0.119999| train set 5.256x speedup, test set 0.784x speedup, val set 5.272x speedup, step: 25, train time 8.80 s
Epoch 44/50 |loss: 0.121653| train set 5.308x speedup, test set 0.779x speedup, val set 5.332x speedup, step: 26, train time 8.59 s
Epoch 45/50 |loss: 0.122993| train set 5.257x speedup, test set 0.810x speedup, val set 5.267x speedup, step: 27, train time 8.90 s
Epoch 46/50 |loss: 0.120140| train set 5.305x speedup, test set 0.816x speedup, val set 5.334x speedup, step: 28, train time 8.79 s
Epoch 47/50 |loss: 0.121476| train set 5.257x speedup, test set 0.834x speedup, val set 5.267x speedup, step: 29, train time 8.77 s
Epoch 48/50 |loss: 0.120427| train set 5.305x speedup, test set 0.874x speedup, val set 5.323x speedup, step: 30, train time 8.57 s
Epoch 49/50 |loss: 0.121251| train set 5.306x speedup, test set 0.775x speedup, val set 5.336x speedup, step: 1, train time 9.00 s
Training per epoch cost 8.776 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.230s, pg runtime 0.014s, speedup 0.062x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 12.697s, pg runtime 2.959s, speedup 0.233x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 1.311s, pg runtime 0.965s, speedup 0.736x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 18, train speedup 5.308, test speedup 0.888, val speedup 5.332
best test speedup epoch: 14, train speedup 5.220, test speedup 0.916, val speedup 5.251
best validation speedup epoch: 49, train speedup 5.306, test speedup 0.775, val speedup 5.336
last model at epoch 49, train speedup 5.306, test speedup 0.775, val speedup 5.336
execution cost 0:07:51.649977
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.537060, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.380687| train set 4.822x speedup, test set 0.936x speedup, val set 4.820x speedup, step: 1, train time 9.85 s
Epoch 1/50 |loss: 0.246900| train set 4.830x speedup, test set 0.919x speedup, val set 4.808x speedup, step: 2, train time 8.87 s
Epoch 2/50 |loss: 0.205202| train set 5.175x speedup, test set 0.929x speedup, val set 5.221x speedup, step: 3, train time 9.39 s
Epoch 3/50 |loss: 0.185056| train set 5.273x speedup, test set 0.933x speedup, val set 5.284x speedup, step: 4, train time 9.17 s
Epoch 4/50 |loss: 0.185245| train set 5.295x speedup, test set 0.911x speedup, val set 5.321x speedup, step: 1, train time 9.30 s
Epoch 5/50 |loss: 0.170417| train set 5.297x speedup, test set 0.912x speedup, val set 5.317x speedup, step: 2, train time 8.98 s
Epoch 6/50 |loss: 0.165155| train set 5.192x speedup, test set 0.781x speedup, val set 5.376x speedup, step: 3, train time 8.87 s
Epoch 7/50 |loss: 0.157225| train set 5.297x speedup, test set 0.903x speedup, val set 5.317x speedup, step: 4, train time 9.41 s
Epoch 8/50 |loss: 0.156675| train set 5.308x speedup, test set 0.895x speedup, val set 5.330x speedup, step: 5, train time 9.21 s
Epoch 9/50 |loss: 0.153848| train set 5.294x speedup, test set 0.803x speedup, val set 5.323x speedup, step: 1, train time 8.99 s
Epoch 10/50 |loss: 0.148090| train set 5.297x speedup, test set 0.803x speedup, val set 5.321x speedup, step: 2, train time 9.27 s
Epoch 11/50 |loss: 0.144184| train set 5.244x speedup, test set 0.873x speedup, val set 5.254x speedup, step: 3, train time 9.21 s
Epoch 12/50 |loss: 0.142493| train set 5.295x speedup, test set 0.799x speedup, val set 5.321x speedup, step: 4, train time 9.09 s
Epoch 13/50 |loss: 0.143315| train set 5.220x speedup, test set 0.887x speedup, val set 5.243x speedup, step: 5, train time 8.96 s
Epoch 14/50 |loss: 0.139054| train set 5.220x speedup, test set 0.906x speedup, val set 5.251x speedup, step: 6, train time 8.97 s
Epoch 15/50 |loss: 0.140458| train set 5.074x speedup, test set 0.853x speedup, val set 5.060x speedup, step: 7, train time 9.28 s
Epoch 16/50 |loss: 0.139648| train set 5.295x speedup, test set 0.915x speedup, val set 5.310x speedup, step: 8, train time 9.08 s
Epoch 17/50 |loss: 0.136001| train set 5.297x speedup, test set 0.869x speedup, val set 5.317x speedup, step: 9, train time 8.96 s
Epoch 18/50 |loss: 0.133311| train set 5.308x speedup, test set 0.891x speedup, val set 5.332x speedup, step: 10, train time 8.91 s
Epoch 19/50 |loss: 0.132931| train set 5.305x speedup, test set 0.892x speedup, val set 5.334x speedup, step: 1, train time 9.21 s
Epoch 20/50 |loss: 0.133744| train set 5.305x speedup, test set 0.874x speedup, val set 5.334x speedup, step: 2, train time 9.11 s
Epoch 21/50 |loss: 0.135329| train set 5.305x speedup, test set 0.863x speedup, val set 5.334x speedup, step: 3, train time 9.71 s
Epoch 22/50 |loss: 0.131509| train set 5.255x speedup, test set 0.851x speedup, val set 5.269x speedup, step: 4, train time 9.28 s
Epoch 23/50 |loss: 0.131423| train set 5.308x speedup, test set 0.870x speedup, val set 5.330x speedup, step: 5, train time 9.29 s
Epoch 24/50 |loss: 0.130425| train set 5.256x speedup, test set 0.830x speedup, val set 5.270x speedup, step: 6, train time 9.19 s
Epoch 25/50 |loss: 0.133033| train set 5.254x speedup, test set 0.751x speedup, val set 5.267x speedup, step: 7, train time 9.08 s
Epoch 26/50 |loss: 0.128284| train set 5.308x speedup, test set 0.838x speedup, val set 5.330x speedup, step: 8, train time 9.30 s
Epoch 27/50 |loss: 0.128882| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 9, train time 8.91 s
Epoch 28/50 |loss: 0.127497| train set 5.305x speedup, test set 0.803x speedup, val set 5.326x speedup, step: 10, train time 9.08 s
Epoch 29/50 |loss: 0.129802| train set 5.308x speedup, test set 0.723x speedup, val set 5.332x speedup, step: 11, train time 9.18 s
Epoch 30/50 |loss: 0.127648| train set 5.308x speedup, test set 0.788x speedup, val set 5.330x speedup, step: 12, train time 8.89 s
Epoch 31/50 |loss: 0.127256| train set 5.305x speedup, test set 0.857x speedup, val set 5.326x speedup, step: 13, train time 9.10 s
Epoch 32/50 |loss: 0.127522| train set 5.308x speedup, test set 0.847x speedup, val set 5.330x speedup, step: 14, train time 8.92 s
Epoch 33/50 |loss: 0.125669| train set 5.308x speedup, test set 0.882x speedup, val set 5.330x speedup, step: 15, train time 8.89 s
Epoch 34/50 |loss: 0.125004| train set 5.308x speedup, test set 0.875x speedup, val set 5.330x speedup, step: 16, train time 9.08 s
Epoch 35/50 |loss: 0.124222| train set 5.305x speedup, test set 0.798x speedup, val set 5.334x speedup, step: 17, train time 9.18 s
Epoch 36/50 |loss: 0.126178| train set 5.140x speedup, test set 0.875x speedup, val set 5.145x speedup, step: 18, train time 9.19 s
Epoch 37/50 |loss: 0.128570| train set 5.308x speedup, test set 0.794x speedup, val set 5.337x speedup, step: 19, train time 9.28 s
Epoch 38/50 |loss: 0.122934| train set 5.252x speedup, test set 0.872x speedup, val set 5.273x speedup, step: 20, train time 9.30 s
Epoch 39/50 |loss: 0.125317| train set 5.310x speedup, test set 0.864x speedup, val set 5.331x speedup, step: 21, train time 9.39 s
Epoch 40/50 |loss: 0.123384| train set 5.295x speedup, test set 0.838x speedup, val set 5.321x speedup, step: 22, train time 8.90 s
Epoch 41/50 |loss: 0.123312| train set 5.305x speedup, test set 0.798x speedup, val set 5.334x speedup, step: 23, train time 8.81 s
Epoch 42/50 |loss: 0.120912| train set 5.295x speedup, test set 0.816x speedup, val set 5.321x speedup, step: 24, train time 9.70 s
Epoch 43/50 |loss: 0.121540| train set 5.298x speedup, test set 0.845x speedup, val set 5.320x speedup, step: 25, train time 9.41 s
Epoch 44/50 |loss: 0.122432| train set 5.308x speedup, test set 0.825x speedup, val set 5.332x speedup, step: 26, train time 8.89 s
Epoch 45/50 |loss: 0.125456| train set 5.257x speedup, test set 0.804x speedup, val set 5.267x speedup, step: 27, train time 9.19 s
Epoch 46/50 |loss: 0.121597| train set 5.305x speedup, test set 0.849x speedup, val set 5.334x speedup, step: 28, train time 9.21 s
Epoch 47/50 |loss: 0.122052| train set 5.244x speedup, test set 0.797x speedup, val set 5.254x speedup, step: 29, train time 9.09 s
Epoch 48/50 |loss: 0.123280| train set 5.305x speedup, test set 0.867x speedup, val set 5.323x speedup, step: 30, train time 9.20 s
Epoch 49/50 |loss: 0.121043| train set 5.305x speedup, test set 0.813x speedup, val set 5.334x speedup, step: 1, train time 8.89 s
Training per epoch cost 9.153 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.012s, pg runtime 0.072s, speedup 6.102x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 12.697s, pg runtime 2.959s, speedup 0.233x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 39, train speedup 5.310, test speedup 0.864, val speedup 5.331
best test speedup epoch: 0, train speedup 4.822, test speedup 0.936, val speedup 4.820
best validation speedup epoch: 49, train speedup 5.305, test speedup 0.813, val speedup 5.334
last model at epoch 49, train speedup 5.305, test speedup 0.813, val speedup 5.334
execution cost 0:08:09.148952
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.532272, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.382873| train set 4.757x speedup, test set 0.935x speedup, val set 4.785x speedup, step: 1, train time 10.02 s
Epoch 1/50 |loss: 0.251331| train set 4.830x speedup, test set 0.925x speedup, val set 4.806x speedup, step: 2, train time 8.62 s
Epoch 2/50 |loss: 0.205708| train set 5.089x speedup, test set 0.894x speedup, val set 5.100x speedup, step: 3, train time 9.28 s
Epoch 3/50 |loss: 0.187838| train set 5.070x speedup, test set 0.813x speedup, val set 4.961x speedup, step: 4, train time 8.88 s
Epoch 4/50 |loss: 0.182238| train set 5.295x speedup, test set 0.704x speedup, val set 5.321x speedup, step: 1, train time 8.89 s
Epoch 5/50 |loss: 0.167607| train set 5.231x speedup, test set 0.811x speedup, val set 5.256x speedup, step: 2, train time 9.06 s
Epoch 6/50 |loss: 0.166604| train set 5.295x speedup, test set 0.926x speedup, val set 5.323x speedup, step: 3, train time 9.42 s
Epoch 7/50 |loss: 0.156076| train set 5.297x speedup, test set 0.786x speedup, val set 5.317x speedup, step: 4, train time 9.01 s
Epoch 8/50 |loss: 0.157421| train set 5.305x speedup, test set 0.808x speedup, val set 5.323x speedup, step: 5, train time 9.23 s
Epoch 9/50 |loss: 0.155449| train set 5.305x speedup, test set 0.789x speedup, val set 5.334x speedup, step: 1, train time 9.08 s
Epoch 10/50 |loss: 0.148108| train set 5.295x speedup, test set 0.773x speedup, val set 5.321x speedup, step: 2, train time 8.88 s
Epoch 11/50 |loss: 0.142505| train set 5.082x speedup, test set 0.789x speedup, val set 5.158x speedup, step: 3, train time 9.58 s
Epoch 12/50 |loss: 0.142183| train set 5.295x speedup, test set 0.714x speedup, val set 5.321x speedup, step: 4, train time 9.11 s
Epoch 13/50 |loss: 0.140445| train set 5.219x speedup, test set 0.757x speedup, val set 5.237x speedup, step: 5, train time 8.89 s
Epoch 14/50 |loss: 0.136245| train set 5.207x speedup, test set 0.792x speedup, val set 5.239x speedup, step: 6, train time 8.98 s
Epoch 15/50 |loss: 0.140022| train set 5.074x speedup, test set 0.748x speedup, val set 5.060x speedup, step: 7, train time 8.98 s
Epoch 16/50 |loss: 0.136120| train set 5.295x speedup, test set 0.709x speedup, val set 5.310x speedup, step: 8, train time 9.41 s
Epoch 17/50 |loss: 0.134894| train set 5.100x speedup, test set 0.758x speedup, val set 5.113x speedup, step: 9, train time 9.09 s
Epoch 18/50 |loss: 0.131958| train set 5.204x speedup, test set 0.756x speedup, val set 5.227x speedup, step: 10, train time 9.22 s
Epoch 19/50 |loss: 0.133031| train set 5.305x speedup, test set 0.792x speedup, val set 5.334x speedup, step: 1, train time 8.79 s
Epoch 20/50 |loss: 0.132048| train set 5.297x speedup, test set 0.851x speedup, val set 5.317x speedup, step: 2, train time 8.87 s
Epoch 21/50 |loss: 0.131710| train set 5.305x speedup, test set 0.885x speedup, val set 5.334x speedup, step: 3, train time 9.38 s
Epoch 22/50 |loss: 0.128991| train set 5.308x speedup, test set 0.774x speedup, val set 5.330x speedup, step: 4, train time 9.09 s
Epoch 23/50 |loss: 0.129577| train set 5.308x speedup, test set 0.885x speedup, val set 5.330x speedup, step: 5, train time 8.68 s
Epoch 24/50 |loss: 0.128692| train set 5.256x speedup, test set 0.740x speedup, val set 5.270x speedup, step: 6, train time 9.01 s
Epoch 25/50 |loss: 0.131004| train set 5.254x speedup, test set 0.735x speedup, val set 5.267x speedup, step: 7, train time 9.18 s
Epoch 26/50 |loss: 0.125500| train set 5.308x speedup, test set 0.721x speedup, val set 5.330x speedup, step: 8, train time 9.22 s
Epoch 27/50 |loss: 0.127032| train set 5.308x speedup, test set 0.879x speedup, val set 5.330x speedup, step: 9, train time 8.90 s
Epoch 28/50 |loss: 0.125877| train set 5.308x speedup, test set 0.828x speedup, val set 5.330x speedup, step: 10, train time 9.38 s
Epoch 29/50 |loss: 0.126435| train set 5.308x speedup, test set 0.850x speedup, val set 5.330x speedup, step: 11, train time 9.16 s
Epoch 30/50 |loss: 0.125286| train set 5.308x speedup, test set 0.850x speedup, val set 5.330x speedup, step: 12, train time 8.98 s
Epoch 31/50 |loss: 0.124841| train set 5.305x speedup, test set 0.841x speedup, val set 5.323x speedup, step: 13, train time 9.08 s
Epoch 32/50 |loss: 0.125216| train set 5.308x speedup, test set 0.795x speedup, val set 5.330x speedup, step: 14, train time 8.90 s
Epoch 33/50 |loss: 0.124148| train set 5.310x speedup, test set 0.742x speedup, val set 5.331x speedup, step: 15, train time 9.30 s
Epoch 34/50 |loss: 0.123969| train set 5.308x speedup, test set 0.781x speedup, val set 5.330x speedup, step: 16, train time 9.12 s
Epoch 35/50 |loss: 0.122945| train set 5.252x speedup, test set 0.744x speedup, val set 5.270x speedup, step: 17, train time 9.08 s
Epoch 36/50 |loss: 0.124708| train set 5.141x speedup, test set 0.853x speedup, val set 5.155x speedup, step: 18, train time 9.02 s
Epoch 37/50 |loss: 0.126707| train set 5.307x speedup, test set 0.835x speedup, val set 5.337x speedup, step: 19, train time 9.61 s
Epoch 38/50 |loss: 0.120215| train set 5.142x speedup, test set 0.871x speedup, val set 5.236x speedup, step: 20, train time 9.00 s
Epoch 39/50 |loss: 0.123457| train set 5.300x speedup, test set 0.761x speedup, val set 5.318x speedup, step: 21, train time 9.31 s
Epoch 40/50 |loss: 0.122281| train set 5.295x speedup, test set 0.835x speedup, val set 5.321x speedup, step: 22, train time 8.98 s
Epoch 41/50 |loss: 0.123264| train set 5.307x speedup, test set 0.786x speedup, val set 5.337x speedup, step: 23, train time 8.92 s
Epoch 42/50 |loss: 0.120040| train set 5.295x speedup, test set 0.903x speedup, val set 5.321x speedup, step: 24, train time 9.00 s
Epoch 43/50 |loss: 0.119788| train set 5.310x speedup, test set 0.927x speedup, val set 5.331x speedup, step: 25, train time 8.87 s
Epoch 44/50 |loss: 0.120785| train set 5.308x speedup, test set 0.818x speedup, val set 5.332x speedup, step: 26, train time 9.11 s
Epoch 45/50 |loss: 0.122985| train set 5.310x speedup, test set 0.804x speedup, val set 5.331x speedup, step: 27, train time 9.21 s
Epoch 46/50 |loss: 0.121401| train set 5.305x speedup, test set 0.867x speedup, val set 5.334x speedup, step: 28, train time 9.19 s
Epoch 47/50 |loss: 0.121148| train set 5.246x speedup, test set 0.790x speedup, val set 5.255x speedup, step: 29, train time 9.08 s
early stopping at epoch 47
Training per epoch cost 9.105 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 2.986s, pg runtime 0.313s, speedup 0.105x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.089s, pg runtime 0.112s, speedup 1.262x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 12.105s, pg runtime 0.023s, speedup 0.002x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 33, train speedup 5.310, test speedup 0.742, val speedup 5.331
best test speedup epoch: 0, train speedup 4.757, test speedup 0.935, val speedup 4.785
best validation speedup epoch: 19, train speedup 5.305, test speedup 0.792, val speedup 5.334
last model at epoch 47, train speedup 5.246, test speedup 0.790, val speedup 5.255
execution cost 0:07:47.848267
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.563673, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.384313| train set 4.666x speedup, test set 1.043x speedup, val set 4.553x speedup, step: 1, train time 10.28 s
Epoch 1/50 |loss: 0.251424| train set 5.060x speedup, test set 1.690x speedup, val set 5.046x speedup, step: 2, train time 8.73 s
Epoch 2/50 |loss: 0.208188| train set 4.852x speedup, test set 1.966x speedup, val set 4.945x speedup, step: 3, train time 8.81 s
Epoch 3/50 |loss: 0.191280| train set 5.060x speedup, test set 1.478x speedup, val set 4.949x speedup, step: 4, train time 9.08 s
Epoch 4/50 |loss: 0.183476| train set 5.295x speedup, test set 2.017x speedup, val set 5.323x speedup, step: 1, train time 8.87 s
Epoch 5/50 |loss: 0.173010| train set 5.231x speedup, test set 0.801x speedup, val set 5.256x speedup, step: 2, train time 8.98 s
Epoch 6/50 |loss: 0.166591| train set 5.295x speedup, test set 1.862x speedup, val set 5.323x speedup, step: 3, train time 9.31 s
Epoch 7/50 |loss: 0.159299| train set 5.297x speedup, test set 0.871x speedup, val set 5.320x speedup, step: 4, train time 8.91 s
Epoch 8/50 |loss: 0.159109| train set 5.305x speedup, test set 0.881x speedup, val set 5.323x speedup, step: 5, train time 8.93 s
Epoch 9/50 |loss: 0.154779| train set 5.306x speedup, test set 0.836x speedup, val set 5.336x speedup, step: 1, train time 9.01 s
Epoch 10/50 |loss: 0.148775| train set 5.297x speedup, test set 0.766x speedup, val set 5.317x speedup, step: 2, train time 9.18 s
Epoch 11/50 |loss: 0.144366| train set 5.297x speedup, test set 0.829x speedup, val set 5.317x speedup, step: 3, train time 9.21 s
Epoch 12/50 |loss: 0.143139| train set 5.295x speedup, test set 0.788x speedup, val set 5.321x speedup, step: 4, train time 8.79 s
Epoch 13/50 |loss: 0.142659| train set 5.297x speedup, test set 0.884x speedup, val set 5.317x speedup, step: 5, train time 9.08 s
Epoch 14/50 |loss: 0.136116| train set 5.220x speedup, test set 0.985x speedup, val set 5.251x speedup, step: 6, train time 8.92 s
Epoch 15/50 |loss: 0.140519| train set 5.074x speedup, test set 0.842x speedup, val set 5.066x speedup, step: 7, train time 9.08 s
Epoch 16/50 |loss: 0.138241| train set 5.295x speedup, test set 0.945x speedup, val set 5.310x speedup, step: 8, train time 9.40 s
Epoch 17/50 |loss: 0.134252| train set 5.296x speedup, test set 0.742x speedup, val set 5.317x speedup, step: 9, train time 9.10 s
Epoch 18/50 |loss: 0.133045| train set 5.204x speedup, test set 0.902x speedup, val set 5.227x speedup, step: 10, train time 8.51 s
Epoch 19/50 |loss: 0.134100| train set 5.140x speedup, test set 0.884x speedup, val set 5.235x speedup, step: 11, train time 9.19 s
Epoch 20/50 |loss: 0.133818| train set 5.306x speedup, test set 0.916x speedup, val set 5.336x speedup, step: 12, train time 9.19 s
Epoch 21/50 |loss: 0.133858| train set 5.305x speedup, test set 0.872x speedup, val set 5.334x speedup, step: 13, train time 9.42 s
Epoch 22/50 |loss: 0.130853| train set 5.308x speedup, test set 0.856x speedup, val set 5.330x speedup, step: 14, train time 8.90 s
Epoch 23/50 |loss: 0.129701| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 15, train time 9.28 s
Epoch 24/50 |loss: 0.128682| train set 5.256x speedup, test set 0.954x speedup, val set 5.270x speedup, step: 16, train time 8.80 s
Epoch 25/50 |loss: 0.131311| train set 5.254x speedup, test set 0.833x speedup, val set 5.267x speedup, step: 17, train time 9.10 s
Epoch 26/50 |loss: 0.128186| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 18, train time 9.20 s
Epoch 27/50 |loss: 0.129415| train set 5.303x speedup, test set 0.938x speedup, val set 5.322x speedup, step: 19, train time 9.30 s
Epoch 28/50 |loss: 0.126411| train set 5.305x speedup, test set 0.837x speedup, val set 5.323x speedup, step: 20, train time 8.99 s
Epoch 29/50 |loss: 0.126396| train set 5.297x speedup, test set 0.845x speedup, val set 5.317x speedup, step: 21, train time 8.92 s
Epoch 30/50 |loss: 0.125475| train set 5.305x speedup, test set 0.845x speedup, val set 5.334x speedup, step: 22, train time 8.89 s
Epoch 31/50 |loss: 0.124685| train set 5.252x speedup, test set 0.826x speedup, val set 5.263x speedup, step: 23, train time 9.10 s
Epoch 32/50 |loss: 0.126311| train set 5.308x speedup, test set 0.786x speedup, val set 5.330x speedup, step: 24, train time 9.19 s
Epoch 33/50 |loss: 0.125402| train set 5.310x speedup, test set 0.823x speedup, val set 5.331x speedup, step: 25, train time 9.49 s
Epoch 34/50 |loss: 0.123694| train set 5.308x speedup, test set 0.919x speedup, val set 5.330x speedup, step: 26, train time 9.08 s
Epoch 35/50 |loss: 0.124266| train set 5.252x speedup, test set 0.779x speedup, val set 5.270x speedup, step: 27, train time 9.20 s
Epoch 36/50 |loss: 0.124702| train set 5.141x speedup, test set 0.843x speedup, val set 5.155x speedup, step: 28, train time 8.99 s
Epoch 37/50 |loss: 0.126681| train set 5.308x speedup, test set 0.755x speedup, val set 5.334x speedup, step: 29, train time 8.93 s
Epoch 38/50 |loss: 0.121831| train set 5.252x speedup, test set 0.942x speedup, val set 5.270x speedup, step: 30, train time 8.93 s
Epoch 39/50 |loss: 0.123307| train set 5.300x speedup, test set 0.758x speedup, val set 5.318x speedup, step: 31, train time 9.39 s
Epoch 40/50 |loss: 0.122035| train set 5.295x speedup, test set 0.775x speedup, val set 5.321x speedup, step: 32, train time 9.31 s
Epoch 41/50 |loss: 0.122751| train set 5.305x speedup, test set 0.777x speedup, val set 5.334x speedup, step: 33, train time 9.16 s
Epoch 42/50 |loss: 0.120802| train set 5.295x speedup, test set 0.853x speedup, val set 5.321x speedup, step: 34, train time 8.88 s
Epoch 43/50 |loss: 0.119781| train set 5.305x speedup, test set 0.783x speedup, val set 5.323x speedup, step: 35, train time 9.08 s
Epoch 44/50 |loss: 0.120776| train set 5.308x speedup, test set 0.747x speedup, val set 5.332x speedup, step: 36, train time 8.98 s
Epoch 45/50 |loss: 0.123407| train set 5.297x speedup, test set 0.785x speedup, val set 5.317x speedup, step: 37, train time 8.89 s
Epoch 46/50 |loss: 0.120991| train set 5.305x speedup, test set 0.825x speedup, val set 5.334x speedup, step: 38, train time 9.30 s
Epoch 47/50 |loss: 0.121108| train set 5.254x speedup, test set 0.764x speedup, val set 5.267x speedup, step: 39, train time 8.91 s
Epoch 48/50 |loss: 0.121631| train set 5.305x speedup, test set 0.873x speedup, val set 5.323x speedup, step: 40, train time 8.89 s
Epoch 49/50 |loss: 0.119553| train set 5.306x speedup, test set 0.740x speedup, val set 5.336x speedup, step: 1, train time 8.90 s
Training per epoch cost 9.080 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 2.801s, pg runtime 0.348s, speedup 0.124x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 2.986s, pg runtime 0.313s, speedup 0.105x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 4.177s, pg runtime 0.354s, speedup 0.085x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 1.338s, pg runtime 0.086s, speedup 0.064x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 3.575s, pg runtime 0.389s, speedup 0.109x
24, opt runtime 0.189s, model runtime 2.523s, pg runtime 0.189s, speedup 0.075x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 6.391s, pg runtime 0.023s, speedup 0.004x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 33, train speedup 5.310, test speedup 0.823, val speedup 5.331
best test speedup epoch: 4, train speedup 5.295, test speedup 2.017, val speedup 5.323
best validation speedup epoch: 49, train speedup 5.306, test speedup 0.740, val speedup 5.336
last model at epoch 49, train speedup 5.306, test speedup 0.740, val speedup 5.336
execution cost 0:08:06.412137
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.578825, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.384551| train set 4.886x speedup, test set 1.028x speedup, val set 4.881x speedup, step: 1, train time 9.95 s
Epoch 1/50 |loss: 0.246661| train set 4.830x speedup, test set 0.828x speedup, val set 4.808x speedup, step: 2, train time 8.80 s
Epoch 2/50 |loss: 0.204339| train set 5.090x speedup, test set 0.916x speedup, val set 5.102x speedup, step: 3, train time 8.77 s
Epoch 3/50 |loss: 0.189239| train set 5.283x speedup, test set 1.002x speedup, val set 5.297x speedup, step: 4, train time 8.61 s
Epoch 4/50 |loss: 0.180343| train set 5.295x speedup, test set 0.926x speedup, val set 5.321x speedup, step: 1, train time 8.81 s
Epoch 5/50 |loss: 0.168383| train set 5.221x speedup, test set 0.930x speedup, val set 5.246x speedup, step: 2, train time 8.61 s
Epoch 6/50 |loss: 0.165641| train set 5.306x speedup, test set 0.919x speedup, val set 5.336x speedup, step: 3, train time 8.80 s
Epoch 7/50 |loss: 0.159183| train set 5.297x speedup, test set 0.953x speedup, val set 5.317x speedup, step: 4, train time 8.75 s
Epoch 8/50 |loss: 0.158537| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 5, train time 8.80 s
Epoch 9/50 |loss: 0.154529| train set 5.306x speedup, test set 0.915x speedup, val set 5.336x speedup, step: 1, train time 9.37 s
Epoch 10/50 |loss: 0.149197| train set 5.297x speedup, test set 0.894x speedup, val set 5.324x speedup, step: 2, train time 8.87 s
Epoch 11/50 |loss: 0.146273| train set 5.297x speedup, test set 1.014x speedup, val set 5.317x speedup, step: 3, train time 8.61 s
Epoch 12/50 |loss: 0.143298| train set 5.295x speedup, test set 0.984x speedup, val set 5.310x speedup, step: 4, train time 8.80 s
Epoch 13/50 |loss: 0.143917| train set 5.121x speedup, test set 0.872x speedup, val set 5.141x speedup, step: 5, train time 8.78 s
Epoch 14/50 |loss: 0.137947| train set 5.306x speedup, test set 0.954x speedup, val set 5.336x speedup, step: 1, train time 8.99 s
Epoch 15/50 |loss: 0.141177| train set 5.079x speedup, test set 0.954x speedup, val set 5.068x speedup, step: 2, train time 8.69 s
Epoch 16/50 |loss: 0.138886| train set 5.295x speedup, test set 0.980x speedup, val set 5.310x speedup, step: 3, train time 8.66 s
Epoch 17/50 |loss: 0.135352| train set 5.297x speedup, test set 0.983x speedup, val set 5.320x speedup, step: 4, train time 8.69 s
Epoch 18/50 |loss: 0.133155| train set 5.204x speedup, test set 0.916x speedup, val set 5.227x speedup, step: 5, train time 8.80 s
Epoch 19/50 |loss: 0.132189| train set 5.305x speedup, test set 0.872x speedup, val set 5.334x speedup, step: 6, train time 8.85 s
Epoch 20/50 |loss: 0.133206| train set 5.306x speedup, test set 0.973x speedup, val set 5.336x speedup, step: 7, train time 8.87 s
Epoch 21/50 |loss: 0.135147| train set 5.305x speedup, test set 1.046x speedup, val set 5.334x speedup, step: 8, train time 9.55 s
Epoch 22/50 |loss: 0.132131| train set 5.308x speedup, test set 0.973x speedup, val set 5.330x speedup, step: 9, train time 8.72 s
Epoch 23/50 |loss: 0.129634| train set 5.308x speedup, test set 0.956x speedup, val set 5.330x speedup, step: 10, train time 8.61 s
Epoch 24/50 |loss: 0.131217| train set 5.306x speedup, test set 0.968x speedup, val set 5.330x speedup, step: 11, train time 8.61 s
Epoch 25/50 |loss: 0.133567| train set 5.254x speedup, test set 0.993x speedup, val set 5.267x speedup, step: 12, train time 8.59 s
Epoch 26/50 |loss: 0.126868| train set 5.308x speedup, test set 0.942x speedup, val set 5.330x speedup, step: 13, train time 8.69 s
Epoch 27/50 |loss: 0.128609| train set 5.306x speedup, test set 0.968x speedup, val set 5.336x speedup, step: 14, train time 8.76 s
Epoch 28/50 |loss: 0.126351| train set 5.305x speedup, test set 1.018x speedup, val set 5.326x speedup, step: 15, train time 8.59 s
Epoch 29/50 |loss: 0.126599| train set 5.308x speedup, test set 0.968x speedup, val set 5.330x speedup, step: 16, train time 8.81 s
Epoch 30/50 |loss: 0.127503| train set 5.308x speedup, test set 0.968x speedup, val set 5.330x speedup, step: 17, train time 8.46 s
Epoch 31/50 |loss: 0.125751| train set 5.255x speedup, test set 0.968x speedup, val set 5.269x speedup, step: 18, train time 8.79 s
Epoch 32/50 |loss: 0.127169| train set 5.308x speedup, test set 0.949x speedup, val set 5.330x speedup, step: 19, train time 8.49 s
Epoch 33/50 |loss: 0.127047| train set 5.308x speedup, test set 0.968x speedup, val set 5.330x speedup, step: 20, train time 8.90 s
Epoch 34/50 |loss: 0.124467| train set 5.308x speedup, test set 0.993x speedup, val set 5.330x speedup, step: 21, train time 8.81 s
Epoch 35/50 |loss: 0.124799| train set 5.252x speedup, test set 0.945x speedup, val set 5.270x speedup, step: 22, train time 8.72 s
Epoch 36/50 |loss: 0.125871| train set 5.141x speedup, test set 1.010x speedup, val set 5.155x speedup, step: 23, train time 8.78 s
Epoch 37/50 |loss: 0.128984| train set 5.307x speedup, test set 0.968x speedup, val set 5.339x speedup, step: 24, train time 8.50 s
Epoch 38/50 |loss: 0.122103| train set 5.252x speedup, test set 0.998x speedup, val set 5.270x speedup, step: 25, train time 8.78 s
Epoch 39/50 |loss: 0.124527| train set 5.254x speedup, test set 0.949x speedup, val set 5.267x speedup, step: 26, train time 8.76 s
Epoch 40/50 |loss: 0.123521| train set 5.295x speedup, test set 1.004x speedup, val set 5.321x speedup, step: 27, train time 8.53 s
Epoch 41/50 |loss: 0.122564| train set 5.305x speedup, test set 0.989x speedup, val set 5.334x speedup, step: 28, train time 8.58 s
Epoch 42/50 |loss: 0.122488| train set 5.295x speedup, test set 0.994x speedup, val set 5.323x speedup, step: 29, train time 8.91 s
Epoch 43/50 |loss: 0.120497| train set 5.305x speedup, test set 0.969x speedup, val set 5.323x speedup, step: 30, train time 9.12 s
Epoch 44/50 |loss: 0.122721| train set 5.255x speedup, test set 0.949x speedup, val set 5.269x speedup, step: 31, train time 8.69 s
Epoch 45/50 |loss: 0.124534| train set 5.254x speedup, test set 0.903x speedup, val set 5.267x speedup, step: 32, train time 8.92 s
Epoch 46/50 |loss: 0.120468| train set 5.305x speedup, test set 0.997x speedup, val set 5.334x speedup, step: 33, train time 8.80 s
Epoch 47/50 |loss: 0.122163| train set 5.246x speedup, test set 0.933x speedup, val set 5.255x speedup, step: 34, train time 8.99 s
Epoch 48/50 |loss: 0.122024| train set 5.305x speedup, test set 0.945x speedup, val set 5.323x speedup, step: 35, train time 8.60 s
Epoch 49/50 |loss: 0.121591| train set 5.305x speedup, test set 0.945x speedup, val set 5.334x speedup, step: 36, train time 8.90 s
Training per epoch cost 8.796 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 8.146s, pg runtime 2.959s, speedup 0.363x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 5.204s, pg runtime 2.599s, speedup 0.499x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 2.523s, pg runtime 0.189s, speedup 0.075x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.115s, pg runtime 0.112s, speedup 0.974x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 8, train speedup 5.308, test speedup 0.929, val speedup 5.330
best test speedup epoch: 21, train speedup 5.305, test speedup 1.046, val speedup 5.334
best validation speedup epoch: 14, train speedup 5.306, test speedup 0.954, val speedup 5.336
last model at epoch 49, train speedup 5.305, test speedup 0.945, val speedup 5.334
execution cost 0:07:52.462223
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
(124, 49)
(124, 49)
construct training samples cost 0:00:00.540969, and there are 11810 training samples
in channel 9
Epoch 0/50 |loss: 0.380608| train set 4.822x speedup, test set 0.981x speedup, val set 4.817x speedup, step: 1, train time 9.99 s
Epoch 1/50 |loss: 0.246250| train set 5.305x speedup, test set 0.886x speedup, val set 5.334x speedup, step: 2, train time 8.89 s
Epoch 2/50 |loss: 0.203830| train set 4.860x speedup, test set 0.952x speedup, val set 4.956x speedup, step: 3, train time 9.01 s
Epoch 3/50 |loss: 0.188151| train set 4.891x speedup, test set 0.881x speedup, val set 4.747x speedup, step: 4, train time 9.50 s
Epoch 4/50 |loss: 0.181383| train set 5.295x speedup, test set 0.910x speedup, val set 5.321x speedup, step: 1, train time 9.08 s
Epoch 5/50 |loss: 0.171764| train set 5.232x speedup, test set 0.892x speedup, val set 5.258x speedup, step: 2, train time 9.27 s
Epoch 6/50 |loss: 0.164231| train set 5.295x speedup, test set 0.846x speedup, val set 5.323x speedup, step: 3, train time 9.00 s
Epoch 7/50 |loss: 0.157552| train set 5.297x speedup, test set 0.945x speedup, val set 5.317x speedup, step: 4, train time 8.96 s
Epoch 8/50 |loss: 0.154906| train set 5.308x speedup, test set 0.953x speedup, val set 5.326x speedup, step: 5, train time 8.91 s
Epoch 9/50 |loss: 0.153558| train set 5.306x speedup, test set 0.885x speedup, val set 5.336x speedup, step: 1, train time 8.61 s
Epoch 10/50 |loss: 0.150386| train set 5.301x speedup, test set 0.845x speedup, val set 5.321x speedup, step: 2, train time 8.92 s
Epoch 11/50 |loss: 0.145472| train set 5.244x speedup, test set 0.786x speedup, val set 5.254x speedup, step: 3, train time 8.72 s
Epoch 12/50 |loss: 0.142295| train set 5.295x speedup, test set 0.816x speedup, val set 5.321x speedup, step: 4, train time 9.52 s
Epoch 13/50 |loss: 0.144215| train set 5.221x speedup, test set 0.882x speedup, val set 5.243x speedup, step: 5, train time 8.83 s
Epoch 14/50 |loss: 0.139207| train set 5.002x speedup, test set 0.879x speedup, val set 4.909x speedup, step: 6, train time 9.12 s
Epoch 15/50 |loss: 0.140105| train set 5.074x speedup, test set 0.878x speedup, val set 5.060x speedup, step: 7, train time 9.37 s
Epoch 16/50 |loss: 0.139298| train set 5.295x speedup, test set 0.857x speedup, val set 5.310x speedup, step: 8, train time 8.61 s
Epoch 17/50 |loss: 0.135835| train set 5.297x speedup, test set 0.819x speedup, val set 5.317x speedup, step: 9, train time 9.08 s
Epoch 18/50 |loss: 0.132631| train set 5.308x speedup, test set 0.877x speedup, val set 5.332x speedup, step: 10, train time 9.28 s
Epoch 19/50 |loss: 0.133536| train set 5.252x speedup, test set 0.730x speedup, val set 5.270x speedup, step: 11, train time 8.81 s
Epoch 20/50 |loss: 0.132243| train set 5.305x speedup, test set 0.838x speedup, val set 5.334x speedup, step: 12, train time 9.08 s
Epoch 21/50 |loss: 0.134838| train set 5.305x speedup, test set 0.825x speedup, val set 5.334x speedup, step: 13, train time 9.60 s
Epoch 22/50 |loss: 0.132368| train set 5.308x speedup, test set 0.863x speedup, val set 5.330x speedup, step: 14, train time 9.11 s
Epoch 23/50 |loss: 0.130054| train set 5.308x speedup, test set 0.902x speedup, val set 5.330x speedup, step: 15, train time 9.00 s
Epoch 24/50 |loss: 0.129585| train set 5.309x speedup, test set 0.806x speedup, val set 5.333x speedup, step: 16, train time 8.96 s
Epoch 25/50 |loss: 0.131533| train set 5.256x speedup, test set 0.806x speedup, val set 5.270x speedup, step: 17, train time 8.78 s
Epoch 26/50 |loss: 0.127235| train set 5.308x speedup, test set 0.819x speedup, val set 5.330x speedup, step: 18, train time 9.17 s
Epoch 27/50 |loss: 0.127036| train set 5.308x speedup, test set 0.901x speedup, val set 5.330x speedup, step: 19, train time 9.37 s
Epoch 28/50 |loss: 0.127519| train set 5.305x speedup, test set 0.825x speedup, val set 5.323x speedup, step: 20, train time 8.76 s
Epoch 29/50 |loss: 0.126631| train set 5.308x speedup, test set 0.869x speedup, val set 5.330x speedup, step: 21, train time 9.18 s
Epoch 30/50 |loss: 0.126081| train set 5.303x speedup, test set 0.800x speedup, val set 5.334x speedup, step: 22, train time 9.08 s
Epoch 31/50 |loss: 0.125283| train set 5.255x speedup, test set 0.879x speedup, val set 5.273x speedup, step: 23, train time 8.91 s
Epoch 32/50 |loss: 0.128845| train set 5.308x speedup, test set 0.771x speedup, val set 5.330x speedup, step: 24, train time 9.22 s
Epoch 33/50 |loss: 0.126425| train set 5.297x speedup, test set 0.831x speedup, val set 5.317x speedup, step: 25, train time 9.42 s
Epoch 34/50 |loss: 0.124066| train set 5.309x speedup, test set 0.831x speedup, val set 5.333x speedup, step: 26, train time 9.41 s
Epoch 35/50 |loss: 0.124808| train set 5.252x speedup, test set 0.797x speedup, val set 5.270x speedup, step: 27, train time 9.20 s
Epoch 36/50 |loss: 0.124399| train set 5.143x speedup, test set 0.893x speedup, val set 5.152x speedup, step: 28, train time 9.50 s
Epoch 37/50 |loss: 0.127177| train set 5.305x speedup, test set 0.831x speedup, val set 5.336x speedup, step: 29, train time 8.78 s
Epoch 38/50 |loss: 0.123101| train set 5.254x speedup, test set 0.852x speedup, val set 5.271x speedup, step: 30, train time 8.88 s
Epoch 39/50 |loss: 0.124465| train set 5.311x speedup, test set 0.721x speedup, val set 5.334x speedup, step: 31, train time 8.90 s
Epoch 40/50 |loss: 0.121844| train set 5.297x speedup, test set 0.864x speedup, val set 5.317x speedup, step: 32, train time 9.11 s
Epoch 41/50 |loss: 0.123631| train set 5.307x speedup, test set 0.825x speedup, val set 5.337x speedup, step: 33, train time 9.19 s
Epoch 42/50 |loss: 0.120020| train set 5.295x speedup, test set 0.839x speedup, val set 5.321x speedup, step: 34, train time 9.07 s
Epoch 43/50 |loss: 0.121065| train set 5.309x speedup, test set 0.831x speedup, val set 5.333x speedup, step: 35, train time 9.19 s
Epoch 44/50 |loss: 0.121779| train set 5.254x speedup, test set 0.824x speedup, val set 5.267x speedup, step: 36, train time 9.20 s
Epoch 45/50 |loss: 0.121844| train set 5.254x speedup, test set 0.759x speedup, val set 5.267x speedup, step: 37, train time 9.11 s
Epoch 46/50 |loss: 0.120946| train set 5.305x speedup, test set 0.841x speedup, val set 5.334x speedup, step: 38, train time 9.31 s
Epoch 47/50 |loss: 0.121015| train set 5.256x speedup, test set 0.797x speedup, val set 5.270x speedup, step: 39, train time 8.87 s
Epoch 48/50 |loss: 0.121348| train set 5.305x speedup, test set 0.848x speedup, val set 5.323x speedup, step: 40, train time 8.89 s
Epoch 49/50 |loss: 0.120819| train set 5.305x speedup, test set 0.831x speedup, val set 5.334x speedup, step: 41, train time 8.79 s
Training per epoch cost 9.091 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.445s, pg runtime 0.453s, speedup 1.020x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 5.204s, pg runtime 2.599s, speedup 0.499x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.433s, pg runtime 0.389s, speedup 0.898x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.115s, pg runtime 0.112s, speedup 0.974x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 39, train speedup 5.311, test speedup 0.721, val speedup 5.334
best test speedup epoch: 0, train speedup 4.822, test speedup 0.981, val speedup 4.817
best validation speedup epoch: 9, train speedup 5.306, test speedup 0.885, val speedup 5.336
last model at epoch 49, train speedup 5.305, test speedup 0.831, val speedup 5.334
execution cost 0:08:06.847805
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.512718, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394582| train set 5.254x speedup, test set 0.904x speedup, val set 4.919x speedup, step: 1, train time 9.00 s
Epoch 1/50 |loss: 0.244280| train set 4.946x speedup, test set 0.968x speedup, val set 4.690x speedup, step: 2, train time 8.09 s
Epoch 2/50 |loss: 0.208412| train set 5.450x speedup, test set 0.908x speedup, val set 5.193x speedup, step: 3, train time 7.79 s
Epoch 3/50 |loss: 0.187339| train set 4.722x speedup, test set 0.706x speedup, val set 4.424x speedup, step: 4, train time 8.07 s
Epoch 4/50 |loss: 0.180457| train set 5.424x speedup, test set 0.740x speedup, val set 5.040x speedup, step: 1, train time 8.58 s
Epoch 5/50 |loss: 0.170891| train set 5.423x speedup, test set 0.755x speedup, val set 5.040x speedup, step: 2, train time 7.98 s
Epoch 6/50 |loss: 0.158862| train set 5.497x speedup, test set 0.806x speedup, val set 5.106x speedup, step: 3, train time 7.98 s
Epoch 7/50 |loss: 0.155510| train set 5.403x speedup, test set 0.873x speedup, val set 5.141x speedup, step: 4, train time 7.70 s
Epoch 8/50 |loss: 0.151267| train set 5.450x speedup, test set 0.823x speedup, val set 5.193x speedup, step: 5, train time 8.00 s
Epoch 9/50 |loss: 0.153553| train set 5.448x speedup, test set 0.808x speedup, val set 5.068x speedup, step: 1, train time 8.47 s
Epoch 10/50 |loss: 0.151501| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 2, train time 8.16 s
Epoch 11/50 |loss: 0.148652| train set 5.401x speedup, test set 0.968x speedup, val set 5.154x speedup, step: 3, train time 8.00 s
Epoch 12/50 |loss: 0.140252| train set 5.450x speedup, test set 0.858x speedup, val set 5.195x speedup, step: 4, train time 8.11 s
Epoch 13/50 |loss: 0.138311| train set 5.499x speedup, test set 0.911x speedup, val set 5.107x speedup, step: 5, train time 8.02 s
Epoch 14/50 |loss: 0.137679| train set 5.496x speedup, test set 0.931x speedup, val set 5.105x speedup, step: 1, train time 7.70 s
Epoch 15/50 |loss: 0.136489| train set 5.451x speedup, test set 0.909x speedup, val set 5.069x speedup, step: 2, train time 7.79 s
Epoch 16/50 |loss: 0.136327| train set 5.450x speedup, test set 1.006x speedup, val set 5.069x speedup, step: 3, train time 7.59 s
Epoch 17/50 |loss: 0.133738| train set 5.449x speedup, test set 1.006x speedup, val set 5.194x speedup, step: 4, train time 7.82 s
Epoch 18/50 |loss: 0.135077| train set 5.452x speedup, test set 0.795x speedup, val set 5.196x speedup, step: 5, train time 7.97 s
Epoch 19/50 |loss: 0.130703| train set 5.496x speedup, test set 0.973x speedup, val set 5.107x speedup, step: 1, train time 8.10 s
Epoch 20/50 |loss: 0.137197| train set 5.497x speedup, test set 0.984x speedup, val set 5.106x speedup, step: 2, train time 7.76 s
Epoch 21/50 |loss: 0.132191| train set 5.496x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 3, train time 7.80 s
Epoch 22/50 |loss: 0.130901| train set 5.497x speedup, test set 0.985x speedup, val set 5.106x speedup, step: 4, train time 8.49 s
Epoch 23/50 |loss: 0.130854| train set 5.493x speedup, test set 0.985x speedup, val set 5.117x speedup, step: 5, train time 7.98 s
Epoch 24/50 |loss: 0.132344| train set 5.497x speedup, test set 0.984x speedup, val set 5.106x speedup, step: 6, train time 7.99 s
Epoch 25/50 |loss: 0.130142| train set 5.450x speedup, test set 0.986x speedup, val set 5.195x speedup, step: 7, train time 7.87 s
Epoch 26/50 |loss: 0.130925| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 8, train time 8.00 s
Epoch 27/50 |loss: 0.128562| train set 5.450x speedup, test set 0.959x speedup, val set 5.070x speedup, step: 9, train time 8.10 s
Epoch 28/50 |loss: 0.126574| train set 5.446x speedup, test set 0.930x speedup, val set 5.206x speedup, step: 10, train time 8.20 s
Epoch 29/50 |loss: 0.126739| train set 5.450x speedup, test set 0.975x speedup, val set 5.193x speedup, step: 1, train time 7.62 s
Epoch 30/50 |loss: 0.129051| train set 5.448x speedup, test set 0.981x speedup, val set 5.068x speedup, step: 2, train time 8.17 s
Epoch 31/50 |loss: 0.125768| train set 5.496x speedup, test set 0.981x speedup, val set 5.105x speedup, step: 3, train time 8.07 s
Epoch 32/50 |loss: 0.124677| train set 5.448x speedup, test set 0.985x speedup, val set 5.068x speedup, step: 4, train time 8.10 s
Epoch 33/50 |loss: 0.126012| train set 5.497x speedup, test set 0.979x speedup, val set 5.106x speedup, step: 5, train time 7.90 s
Epoch 34/50 |loss: 0.125480| train set 5.496x speedup, test set 0.984x speedup, val set 5.107x speedup, step: 6, train time 7.59 s
Epoch 35/50 |loss: 0.127566| train set 5.496x speedup, test set 0.928x speedup, val set 5.107x speedup, step: 7, train time 7.79 s
Epoch 36/50 |loss: 0.126583| train set 5.449x speedup, test set 0.984x speedup, val set 5.194x speedup, step: 8, train time 7.39 s
Epoch 37/50 |loss: 0.127143| train set 5.450x speedup, test set 0.981x speedup, val set 5.195x speedup, step: 9, train time 8.22 s
early stopping at epoch 37
Training per epoch cost 7.998 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 2.523s, pg runtime 0.189s, speedup 0.075x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.087s, pg runtime 0.112s, speedup 1.295x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 0.911, val speedup 5.107
best test speedup epoch: 16, train speedup 5.450, test speedup 1.006, val speedup 5.069
best validation speedup epoch: 29, train speedup 5.450, test speedup 0.975, val speedup 5.193
last model at epoch 37, train speedup 5.450, test speedup 0.981, val speedup 5.195
execution cost 0:05:30.694382
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.521100, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394106| train set 5.047x speedup, test set 0.936x speedup, val set 4.913x speedup, step: 1, train time 8.87 s
Epoch 1/50 |loss: 0.243845| train set 5.423x speedup, test set 0.950x speedup, val set 5.040x speedup, step: 2, train time 7.98 s
Epoch 2/50 |loss: 0.209725| train set 5.424x speedup, test set 0.891x speedup, val set 5.040x speedup, step: 3, train time 7.78 s
Epoch 3/50 |loss: 0.184290| train set 5.168x speedup, test set 1.300x speedup, val set 4.875x speedup, step: 4, train time 8.08 s
Epoch 4/50 |loss: 0.178757| train set 5.378x speedup, test set 0.953x speedup, val set 5.126x speedup, step: 1, train time 7.99 s
Epoch 5/50 |loss: 0.169272| train set 5.424x speedup, test set 0.923x speedup, val set 5.040x speedup, step: 2, train time 7.60 s
Epoch 6/50 |loss: 0.160449| train set 5.376x speedup, test set 0.811x speedup, val set 5.004x speedup, step: 3, train time 8.07 s
Epoch 7/50 |loss: 0.156459| train set 5.450x speedup, test set 0.831x speedup, val set 5.195x speedup, step: 4, train time 8.30 s
Epoch 8/50 |loss: 0.151562| train set 5.450x speedup, test set 0.835x speedup, val set 5.195x speedup, step: 5, train time 7.88 s
Epoch 9/50 |loss: 0.150425| train set 5.448x speedup, test set 0.819x speedup, val set 5.068x speedup, step: 6, train time 8.29 s
Epoch 10/50 |loss: 0.149437| train set 5.496x speedup, test set 0.889x speedup, val set 5.105x speedup, step: 7, train time 8.00 s
Epoch 11/50 |loss: 0.145729| train set 5.402x speedup, test set 0.956x speedup, val set 5.153x speedup, step: 8, train time 8.27 s
Epoch 12/50 |loss: 0.138088| train set 5.450x speedup, test set 0.885x speedup, val set 5.195x speedup, step: 9, train time 8.09 s
Epoch 13/50 |loss: 0.136846| train set 5.499x speedup, test set 0.829x speedup, val set 5.107x speedup, step: 10, train time 7.99 s
Epoch 14/50 |loss: 0.137111| train set 5.496x speedup, test set 0.926x speedup, val set 5.105x speedup, step: 11, train time 8.07 s
Epoch 15/50 |loss: 0.135726| train set 5.451x speedup, test set 0.926x speedup, val set 5.069x speedup, step: 12, train time 7.70 s
Epoch 16/50 |loss: 0.134300| train set 5.450x speedup, test set 0.926x speedup, val set 5.069x speedup, step: 13, train time 8.38 s
Epoch 17/50 |loss: 0.133224| train set 5.496x speedup, test set 0.915x speedup, val set 5.106x speedup, step: 14, train time 7.78 s
Epoch 18/50 |loss: 0.134426| train set 5.336x speedup, test set 0.927x speedup, val set 5.014x speedup, step: 15, train time 7.90 s
Epoch 19/50 |loss: 0.129096| train set 5.494x speedup, test set 0.931x speedup, val set 5.100x speedup, step: 16, train time 7.47 s
Epoch 20/50 |loss: 0.133872| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 17, train time 7.78 s
Epoch 21/50 |loss: 0.131694| train set 5.336x speedup, test set 0.969x speedup, val set 5.015x speedup, step: 18, train time 7.71 s
Epoch 22/50 |loss: 0.129830| train set 5.497x speedup, test set 0.911x speedup, val set 5.106x speedup, step: 19, train time 8.70 s
Epoch 23/50 |loss: 0.130646| train set 5.446x speedup, test set 0.916x speedup, val set 5.206x speedup, step: 20, train time 8.00 s
Epoch 24/50 |loss: 0.131679| train set 5.495x speedup, test set 0.940x speedup, val set 5.099x speedup, step: 21, train time 7.71 s
Epoch 25/50 |loss: 0.128004| train set 5.496x speedup, test set 0.960x speedup, val set 5.107x speedup, step: 22, train time 8.51 s
Epoch 26/50 |loss: 0.129596| train set 5.496x speedup, test set 0.968x speedup, val set 5.105x speedup, step: 23, train time 7.77 s
Epoch 27/50 |loss: 0.126583| train set 5.448x speedup, test set 1.006x speedup, val set 5.067x speedup, step: 24, train time 8.07 s
Epoch 28/50 |loss: 0.124784| train set 5.452x speedup, test set 0.911x speedup, val set 5.195x speedup, step: 25, train time 7.88 s
Epoch 29/50 |loss: 0.126325| train set 5.450x speedup, test set 0.944x speedup, val set 5.193x speedup, step: 1, train time 7.72 s
Epoch 30/50 |loss: 0.128025| train set 5.448x speedup, test set 0.922x speedup, val set 5.068x speedup, step: 2, train time 8.07 s
Epoch 31/50 |loss: 0.125381| train set 5.496x speedup, test set 1.006x speedup, val set 5.105x speedup, step: 3, train time 8.07 s
Epoch 32/50 |loss: 0.124494| train set 5.448x speedup, test set 0.969x speedup, val set 5.068x speedup, step: 4, train time 7.88 s
Epoch 33/50 |loss: 0.124654| train set 5.497x speedup, test set 0.978x speedup, val set 5.106x speedup, step: 5, train time 8.19 s
Epoch 34/50 |loss: 0.122722| train set 5.497x speedup, test set 0.981x speedup, val set 5.106x speedup, step: 6, train time 8.18 s
Epoch 35/50 |loss: 0.125910| train set 5.496x speedup, test set 1.006x speedup, val set 5.107x speedup, step: 7, train time 8.49 s
Epoch 36/50 |loss: 0.126001| train set 5.449x speedup, test set 0.895x speedup, val set 5.194x speedup, step: 8, train time 8.11 s
Epoch 37/50 |loss: 0.124992| train set 5.450x speedup, test set 0.969x speedup, val set 5.195x speedup, step: 9, train time 8.15 s
early stopping at epoch 37
Training per epoch cost 8.040 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.012s, pg runtime 0.072s, speedup 6.102x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.909s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 0.829, val speedup 5.107
best test speedup epoch: 3, train speedup 5.168, test speedup 1.300, val speedup 4.875
best validation speedup epoch: 29, train speedup 5.450, test speedup 0.944, val speedup 5.193
last model at epoch 37, train speedup 5.450, test speedup 0.969, val speedup 5.195
execution cost 0:05:31.118611
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.519451, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.393848| train set 5.122x speedup, test set 0.930x speedup, val set 4.844x speedup, step: 1, train time 8.96 s
Epoch 1/50 |loss: 0.245073| train set 5.497x speedup, test set 0.807x speedup, val set 5.106x speedup, step: 2, train time 8.20 s
Epoch 2/50 |loss: 0.209538| train set 5.424x speedup, test set 0.908x speedup, val set 5.040x speedup, step: 3, train time 7.91 s
Epoch 3/50 |loss: 0.185087| train set 5.455x speedup, test set 0.704x speedup, val set 5.073x speedup, step: 4, train time 8.11 s
Epoch 4/50 |loss: 0.176275| train set 5.229x speedup, test set 0.873x speedup, val set 5.062x speedup, step: 1, train time 7.79 s
Epoch 5/50 |loss: 0.167048| train set 5.424x speedup, test set 0.943x speedup, val set 5.040x speedup, step: 2, train time 8.00 s
Epoch 6/50 |loss: 0.158968| train set 5.424x speedup, test set 0.720x speedup, val set 5.040x speedup, step: 3, train time 7.59 s
Epoch 7/50 |loss: 0.158151| train set 5.450x speedup, test set 0.834x speedup, val set 5.193x speedup, step: 4, train time 8.21 s
Epoch 8/50 |loss: 0.151301| train set 5.496x speedup, test set 0.793x speedup, val set 5.107x speedup, step: 5, train time 7.89 s
Epoch 9/50 |loss: 0.155503| train set 5.447x speedup, test set 0.849x speedup, val set 5.068x speedup, step: 1, train time 8.08 s
Epoch 10/50 |loss: 0.148057| train set 5.446x speedup, test set 0.886x speedup, val set 5.060x speedup, step: 2, train time 8.00 s
Epoch 11/50 |loss: 0.145534| train set 5.402x speedup, test set 0.913x speedup, val set 5.153x speedup, step: 3, train time 7.77 s
Epoch 12/50 |loss: 0.136486| train set 5.450x speedup, test set 0.855x speedup, val set 5.195x speedup, step: 4, train time 7.72 s
Epoch 13/50 |loss: 0.136440| train set 5.499x speedup, test set 0.829x speedup, val set 5.107x speedup, step: 5, train time 7.68 s
Epoch 14/50 |loss: 0.137448| train set 5.496x speedup, test set 0.920x speedup, val set 5.105x speedup, step: 1, train time 7.97 s
Epoch 15/50 |loss: 0.135721| train set 5.448x speedup, test set 0.922x speedup, val set 5.067x speedup, step: 2, train time 7.96 s
Epoch 16/50 |loss: 0.134489| train set 5.450x speedup, test set 0.809x speedup, val set 5.069x speedup, step: 3, train time 7.88 s
Epoch 17/50 |loss: 0.132869| train set 5.265x speedup, test set 0.848x speedup, val set 4.981x speedup, step: 4, train time 7.48 s
Epoch 18/50 |loss: 0.133297| train set 5.496x speedup, test set 0.853x speedup, val set 5.107x speedup, step: 5, train time 8.07 s
Epoch 19/50 |loss: 0.129205| train set 5.496x speedup, test set 0.823x speedup, val set 5.107x speedup, step: 1, train time 7.67 s
Epoch 20/50 |loss: 0.136082| train set 5.267x speedup, test set 0.892x speedup, val set 4.952x speedup, step: 2, train time 8.20 s
Epoch 21/50 |loss: 0.132166| train set 5.290x speedup, test set 0.832x speedup, val set 4.977x speedup, step: 3, train time 8.11 s
Epoch 22/50 |loss: 0.131920| train set 5.497x speedup, test set 0.863x speedup, val set 5.106x speedup, step: 4, train time 8.98 s
Epoch 23/50 |loss: 0.131230| train set 5.446x speedup, test set 0.491x speedup, val set 5.206x speedup, step: 5, train time 7.99 s
Epoch 24/50 |loss: 0.132046| train set 5.494x speedup, test set 0.841x speedup, val set 5.100x speedup, step: 6, train time 7.50 s
Epoch 25/50 |loss: 0.128150| train set 5.493x speedup, test set 0.849x speedup, val set 5.100x speedup, step: 7, train time 8.37 s
Epoch 26/50 |loss: 0.129377| train set 5.497x speedup, test set 0.874x speedup, val set 5.106x speedup, step: 8, train time 7.90 s
Epoch 27/50 |loss: 0.127308| train set 5.448x speedup, test set 0.476x speedup, val set 5.068x speedup, step: 9, train time 7.91 s
Epoch 28/50 |loss: 0.124945| train set 5.452x speedup, test set 0.501x speedup, val set 5.195x speedup, step: 10, train time 7.69 s
Epoch 29/50 |loss: 0.125904| train set 5.450x speedup, test set 0.479x speedup, val set 5.193x speedup, step: 1, train time 8.40 s
Epoch 30/50 |loss: 0.129217| train set 5.496x speedup, test set 0.510x speedup, val set 5.107x speedup, step: 2, train time 7.98 s
Epoch 31/50 |loss: 0.125736| train set 5.496x speedup, test set 0.524x speedup, val set 5.105x speedup, step: 3, train time 7.87 s
Epoch 32/50 |loss: 0.124093| train set 5.448x speedup, test set 0.512x speedup, val set 5.068x speedup, step: 4, train time 8.08 s
Epoch 33/50 |loss: 0.124524| train set 5.497x speedup, test set 0.511x speedup, val set 5.106x speedup, step: 5, train time 8.02 s
Epoch 34/50 |loss: 0.124330| train set 5.496x speedup, test set 0.505x speedup, val set 5.107x speedup, step: 6, train time 7.58 s
Epoch 35/50 |loss: 0.125700| train set 5.496x speedup, test set 0.491x speedup, val set 5.107x speedup, step: 7, train time 7.69 s
Epoch 36/50 |loss: 0.125003| train set 5.449x speedup, test set 0.473x speedup, val set 5.193x speedup, step: 8, train time 8.30 s
Epoch 37/50 |loss: 0.125874| train set 5.450x speedup, test set 0.506x speedup, val set 5.195x speedup, step: 9, train time 7.81 s
early stopping at epoch 37
Training per epoch cost 7.982 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 2.801s, pg runtime 0.348s, speedup 0.124x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 2.986s, pg runtime 0.313s, speedup 0.105x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 1.290s, pg runtime 0.086s, speedup 0.066x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 2.523s, pg runtime 0.189s, speedup 0.075x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 0.829, val speedup 5.107
best test speedup epoch: 5, train speedup 5.424, test speedup 0.943, val speedup 5.040
best validation speedup epoch: 29, train speedup 5.450, test speedup 0.479, val speedup 5.193
last model at epoch 37, train speedup 5.450, test speedup 0.506, val speedup 5.195
execution cost 0:05:29.685451
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.504424, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397835| train set 5.008x speedup, test set 0.944x speedup, val set 4.743x speedup, step: 1, train time 9.31 s
Epoch 1/50 |loss: 0.243187| train set 5.449x speedup, test set 1.920x speedup, val set 5.193x speedup, step: 2, train time 7.70 s
Epoch 2/50 |loss: 0.212001| train set 5.424x speedup, test set 0.848x speedup, val set 5.040x speedup, step: 3, train time 8.20 s
Epoch 3/50 |loss: 0.190588| train set 5.455x speedup, test set 0.728x speedup, val set 5.073x speedup, step: 4, train time 8.05 s
Epoch 4/50 |loss: 0.179608| train set 5.424x speedup, test set 0.842x speedup, val set 5.040x speedup, step: 1, train time 7.77 s
Epoch 5/50 |loss: 0.170947| train set 5.424x speedup, test set 0.932x speedup, val set 5.040x speedup, step: 2, train time 7.58 s
Epoch 6/50 |loss: 0.158505| train set 5.496x speedup, test set 0.807x speedup, val set 5.106x speedup, step: 3, train time 8.49 s
Epoch 7/50 |loss: 0.155947| train set 5.403x speedup, test set 0.882x speedup, val set 5.141x speedup, step: 4, train time 8.00 s
Epoch 8/50 |loss: 0.151250| train set 5.496x speedup, test set 0.785x speedup, val set 5.107x speedup, step: 5, train time 7.81 s
Epoch 9/50 |loss: 0.153319| train set 5.447x speedup, test set 0.915x speedup, val set 5.068x speedup, step: 1, train time 8.00 s
Epoch 10/50 |loss: 0.150689| train set 5.448x speedup, test set 0.906x speedup, val set 5.066x speedup, step: 2, train time 8.01 s
Epoch 11/50 |loss: 0.146759| train set 5.449x speedup, test set 0.906x speedup, val set 5.193x speedup, step: 3, train time 8.45 s
Epoch 12/50 |loss: 0.140456| train set 5.450x speedup, test set 0.906x speedup, val set 5.195x speedup, step: 4, train time 7.67 s
Epoch 13/50 |loss: 0.137350| train set 5.499x speedup, test set 0.904x speedup, val set 5.107x speedup, step: 5, train time 7.88 s
Epoch 14/50 |loss: 0.139615| train set 5.496x speedup, test set 0.915x speedup, val set 5.105x speedup, step: 1, train time 7.50 s
Epoch 15/50 |loss: 0.136910| train set 5.264x speedup, test set 0.890x speedup, val set 4.864x speedup, step: 2, train time 8.19 s
Epoch 16/50 |loss: 0.136637| train set 5.450x speedup, test set 0.896x speedup, val set 5.069x speedup, step: 3, train time 7.58 s
Epoch 17/50 |loss: 0.136069| train set 5.449x speedup, test set 0.890x speedup, val set 5.193x speedup, step: 4, train time 7.52 s
Epoch 18/50 |loss: 0.133948| train set 5.496x speedup, test set 0.932x speedup, val set 5.107x speedup, step: 5, train time 8.21 s
Epoch 19/50 |loss: 0.129505| train set 5.496x speedup, test set 0.924x speedup, val set 5.107x speedup, step: 1, train time 8.09 s
Epoch 20/50 |loss: 0.137674| train set 5.497x speedup, test set 0.937x speedup, val set 5.106x speedup, step: 2, train time 7.67 s
Epoch 21/50 |loss: 0.132046| train set 5.290x speedup, test set 0.916x speedup, val set 4.977x speedup, step: 3, train time 7.81 s
Epoch 22/50 |loss: 0.132272| train set 5.496x speedup, test set 0.924x speedup, val set 5.107x speedup, step: 4, train time 8.77 s
Epoch 23/50 |loss: 0.131752| train set 5.452x speedup, test set 0.875x speedup, val set 5.195x speedup, step: 5, train time 7.90 s
Epoch 24/50 |loss: 0.131752| train set 5.494x speedup, test set 0.894x speedup, val set 5.100x speedup, step: 6, train time 7.99 s
Epoch 25/50 |loss: 0.129120| train set 5.493x speedup, test set 0.868x speedup, val set 5.100x speedup, step: 7, train time 7.79 s
Epoch 26/50 |loss: 0.129652| train set 5.496x speedup, test set 0.967x speedup, val set 5.105x speedup, step: 8, train time 8.28 s
Epoch 27/50 |loss: 0.128647| train set 5.448x speedup, test set 0.920x speedup, val set 5.067x speedup, step: 9, train time 7.90 s
Epoch 28/50 |loss: 0.126910| train set 5.452x speedup, test set 0.928x speedup, val set 5.195x speedup, step: 10, train time 8.80 s
Epoch 29/50 |loss: 0.127669| train set 5.450x speedup, test set 0.933x speedup, val set 5.195x speedup, step: 1, train time 7.79 s
Epoch 30/50 |loss: 0.129109| train set 5.448x speedup, test set 0.912x speedup, val set 5.068x speedup, step: 2, train time 8.19 s
Epoch 31/50 |loss: 0.126753| train set 5.496x speedup, test set 0.912x speedup, val set 5.106x speedup, step: 3, train time 7.87 s
Epoch 32/50 |loss: 0.124748| train set 5.450x speedup, test set 0.920x speedup, val set 5.070x speedup, step: 4, train time 8.00 s
Epoch 33/50 |loss: 0.126977| train set 5.497x speedup, test set 0.911x speedup, val set 5.106x speedup, step: 5, train time 7.89 s
Epoch 34/50 |loss: 0.124480| train set 5.497x speedup, test set 0.991x speedup, val set 5.106x speedup, step: 6, train time 7.82 s
Epoch 35/50 |loss: 0.128225| train set 5.496x speedup, test set 0.869x speedup, val set 5.107x speedup, step: 7, train time 7.80 s
Epoch 36/50 |loss: 0.125574| train set 5.496x speedup, test set 0.930x speedup, val set 5.105x speedup, step: 8, train time 7.69 s
Epoch 37/50 |loss: 0.126406| train set 5.450x speedup, test set 0.912x speedup, val set 5.195x speedup, step: 9, train time 7.87 s
Epoch 38/50 |loss: 0.125026| train set 5.402x speedup, test set 0.884x speedup, val set 5.154x speedup, step: 10, train time 8.00 s
Epoch 39/50 |loss: 0.123583| train set 5.402x speedup, test set 0.872x speedup, val set 5.154x speedup, step: 11, train time 7.91 s
Epoch 40/50 |loss: 0.123546| train set 5.450x speedup, test set 0.912x speedup, val set 5.193x speedup, step: 12, train time 8.21 s
Epoch 41/50 |loss: 0.122405| train set 5.496x speedup, test set 0.979x speedup, val set 5.107x speedup, step: 13, train time 7.80 s
Epoch 42/50 |loss: 0.121345| train set 5.450x speedup, test set 0.994x speedup, val set 5.195x speedup, step: 14, train time 7.90 s
Epoch 43/50 |loss: 0.121923| train set 5.448x speedup, test set 0.930x speedup, val set 5.068x speedup, step: 15, train time 8.07 s
Epoch 44/50 |loss: 0.124428| train set 5.496x speedup, test set 0.875x speedup, val set 5.107x speedup, step: 16, train time 7.54 s
Epoch 45/50 |loss: 0.122020| train set 5.499x speedup, test set 0.891x speedup, val set 5.107x speedup, step: 17, train time 8.27 s
Epoch 46/50 |loss: 0.125323| train set 5.448x speedup, test set 0.904x speedup, val set 5.067x speedup, step: 18, train time 8.17 s
Epoch 47/50 |loss: 0.121173| train set 5.499x speedup, test set 0.968x speedup, val set 5.107x speedup, step: 19, train time 8.48 s
Epoch 48/50 |loss: 0.119989| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 20, train time 7.88 s
Epoch 49/50 |loss: 0.120593| train set 5.496x speedup, test set 0.862x speedup, val set 5.105x speedup, step: 21, train time 7.89 s
Training per epoch cost 7.999 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.441s, pg runtime 0.453s, speedup 1.028x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 45, train speedup 5.499, test speedup 0.891, val speedup 5.107
best test speedup epoch: 1, train speedup 5.449, test speedup 1.920, val speedup 5.193
best validation speedup epoch: 29, train speedup 5.450, test speedup 0.933, val speedup 5.195
last model at epoch 49, train speedup 5.496, test speedup 0.862, val speedup 5.105
execution cost 0:07:12.259854
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.530991, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394347| train set 4.486x speedup, test set 0.963x speedup, val set 4.243x speedup, step: 1, train time 9.08 s
Epoch 1/50 |loss: 0.241508| train set 4.738x speedup, test set 0.986x speedup, val set 4.475x speedup, step: 2, train time 8.02 s
Epoch 2/50 |loss: 0.207607| train set 5.275x speedup, test set 0.823x speedup, val set 4.913x speedup, step: 3, train time 8.19 s
Epoch 3/50 |loss: 0.186962| train set 5.455x speedup, test set 1.061x speedup, val set 5.073x speedup, step: 4, train time 7.97 s
Epoch 4/50 |loss: 0.176796| train set 5.424x speedup, test set 0.747x speedup, val set 5.040x speedup, step: 1, train time 7.90 s
Epoch 5/50 |loss: 0.169491| train set 5.423x speedup, test set 0.899x speedup, val set 5.040x speedup, step: 2, train time 7.86 s
Epoch 6/50 |loss: 0.163348| train set 5.492x speedup, test set 0.726x speedup, val set 5.099x speedup, step: 3, train time 8.28 s
Epoch 7/50 |loss: 0.155647| train set 5.450x speedup, test set 0.893x speedup, val set 5.195x speedup, step: 4, train time 7.90 s
Epoch 8/50 |loss: 0.151455| train set 5.450x speedup, test set 0.806x speedup, val set 5.193x speedup, step: 5, train time 8.24 s
Epoch 9/50 |loss: 0.152976| train set 5.448x speedup, test set 0.905x speedup, val set 5.068x speedup, step: 1, train time 7.88 s
Epoch 10/50 |loss: 0.148624| train set 5.496x speedup, test set 0.859x speedup, val set 5.105x speedup, step: 2, train time 8.19 s
Epoch 11/50 |loss: 0.146280| train set 5.402x speedup, test set 0.926x speedup, val set 5.153x speedup, step: 3, train time 8.49 s
Epoch 12/50 |loss: 0.140579| train set 5.450x speedup, test set 0.816x speedup, val set 5.195x speedup, step: 4, train time 7.69 s
Epoch 13/50 |loss: 0.138074| train set 5.497x speedup, test set 0.754x speedup, val set 5.106x speedup, step: 5, train time 8.31 s
Epoch 14/50 |loss: 0.138323| train set 5.496x speedup, test set 0.926x speedup, val set 5.105x speedup, step: 1, train time 7.79 s
Epoch 15/50 |loss: 0.136230| train set 5.451x speedup, test set 0.915x speedup, val set 5.069x speedup, step: 2, train time 8.11 s
Epoch 16/50 |loss: 0.135515| train set 5.450x speedup, test set 0.864x speedup, val set 5.069x speedup, step: 3, train time 7.82 s
Epoch 17/50 |loss: 0.133304| train set 5.308x speedup, test set 0.874x speedup, val set 4.900x speedup, step: 4, train time 8.51 s
Epoch 18/50 |loss: 0.133128| train set 5.290x speedup, test set 0.900x speedup, val set 4.978x speedup, step: 5, train time 7.97 s
Epoch 19/50 |loss: 0.129681| train set 5.496x speedup, test set 0.900x speedup, val set 5.107x speedup, step: 1, train time 7.68 s
Epoch 20/50 |loss: 0.136442| train set 5.497x speedup, test set 0.915x speedup, val set 5.106x speedup, step: 2, train time 8.07 s
Epoch 21/50 |loss: 0.131060| train set 5.290x speedup, test set 0.835x speedup, val set 4.977x speedup, step: 3, train time 8.71 s
Epoch 22/50 |loss: 0.131379| train set 5.496x speedup, test set 0.930x speedup, val set 5.107x speedup, step: 4, train time 8.48 s
Epoch 23/50 |loss: 0.131089| train set 5.493x speedup, test set 0.923x speedup, val set 5.117x speedup, step: 5, train time 7.91 s
Epoch 24/50 |loss: 0.132727| train set 5.496x speedup, test set 0.874x speedup, val set 5.107x speedup, step: 1, train time 8.08 s
Epoch 25/50 |loss: 0.129729| train set 5.496x speedup, test set 0.787x speedup, val set 5.107x speedup, step: 2, train time 7.88 s
Epoch 26/50 |loss: 0.130938| train set 5.497x speedup, test set 0.919x speedup, val set 5.106x speedup, step: 3, train time 8.09 s
Epoch 27/50 |loss: 0.127603| train set 5.448x speedup, test set 0.787x speedup, val set 5.068x speedup, step: 4, train time 7.69 s
Epoch 28/50 |loss: 0.127702| train set 5.452x speedup, test set 0.857x speedup, val set 5.195x speedup, step: 5, train time 7.79 s
Epoch 29/50 |loss: 0.126249| train set 5.450x speedup, test set 0.860x speedup, val set 5.195x speedup, step: 1, train time 7.82 s
Epoch 30/50 |loss: 0.129033| train set 5.448x speedup, test set 0.888x speedup, val set 5.068x speedup, step: 2, train time 8.05 s
Epoch 31/50 |loss: 0.125974| train set 5.496x speedup, test set 0.930x speedup, val set 5.106x speedup, step: 3, train time 7.94 s
Epoch 32/50 |loss: 0.123236| train set 5.448x speedup, test set 0.906x speedup, val set 5.068x speedup, step: 4, train time 7.87 s
Epoch 33/50 |loss: 0.126254| train set 5.496x speedup, test set 0.906x speedup, val set 5.105x speedup, step: 5, train time 8.37 s
Epoch 34/50 |loss: 0.125416| train set 5.496x speedup, test set 0.907x speedup, val set 5.107x speedup, step: 6, train time 7.78 s
Epoch 35/50 |loss: 0.126087| train set 5.496x speedup, test set 0.788x speedup, val set 5.107x speedup, step: 7, train time 7.92 s
Epoch 36/50 |loss: 0.124450| train set 5.449x speedup, test set 0.817x speedup, val set 5.194x speedup, step: 8, train time 7.89 s
Epoch 37/50 |loss: 0.125810| train set 5.450x speedup, test set 0.872x speedup, val set 5.195x speedup, step: 9, train time 7.89 s
Epoch 38/50 |loss: 0.126369| train set 5.404x speedup, test set 0.911x speedup, val set 5.157x speedup, step: 10, train time 8.02 s
Epoch 39/50 |loss: 0.123407| train set 5.448x speedup, test set 0.915x speedup, val set 5.068x speedup, step: 11, train time 7.88 s
Epoch 40/50 |loss: 0.122691| train set 5.450x speedup, test set 0.866x speedup, val set 5.193x speedup, step: 12, train time 8.17 s
Epoch 41/50 |loss: 0.121172| train set 5.496x speedup, test set 0.812x speedup, val set 5.107x speedup, step: 13, train time 7.57 s
Epoch 42/50 |loss: 0.121075| train set 5.450x speedup, test set 0.859x speedup, val set 5.193x speedup, step: 14, train time 7.68 s
Epoch 43/50 |loss: 0.121337| train set 5.447x speedup, test set 0.789x speedup, val set 5.068x speedup, step: 15, train time 8.09 s
Epoch 44/50 |loss: 0.125909| train set 5.497x speedup, test set 0.911x speedup, val set 5.106x speedup, step: 16, train time 7.89 s
Epoch 45/50 |loss: 0.121951| train set 5.499x speedup, test set 0.833x speedup, val set 5.107x speedup, step: 17, train time 7.78 s
Epoch 46/50 |loss: 0.124559| train set 5.448x speedup, test set 0.855x speedup, val set 5.067x speedup, step: 18, train time 8.37 s
Epoch 47/50 |loss: 0.120231| train set 5.496x speedup, test set 0.940x speedup, val set 5.105x speedup, step: 19, train time 8.19 s
Epoch 48/50 |loss: 0.119122| train set 5.497x speedup, test set 0.943x speedup, val set 5.106x speedup, step: 20, train time 8.12 s
Epoch 49/50 |loss: 0.123124| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 21, train time 8.22 s
Training per epoch cost 8.042 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.087s, pg runtime 0.112s, speedup 1.295x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 45, train speedup 5.499, test speedup 0.833, val speedup 5.107
best test speedup epoch: 3, train speedup 5.455, test speedup 1.061, val speedup 5.073
best validation speedup epoch: 29, train speedup 5.450, test speedup 0.860, val speedup 5.195
last model at epoch 49, train speedup 5.497, test speedup 0.944, val speedup 5.106
execution cost 0:07:14.375019
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.537841, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394051| train set 5.047x speedup, test set 0.937x speedup, val set 4.913x speedup, step: 1, train time 9.65 s
Epoch 1/50 |loss: 0.246765| train set 5.314x speedup, test set 0.829x speedup, val set 5.068x speedup, step: 2, train time 8.30 s
Epoch 2/50 |loss: 0.205774| train set 5.497x speedup, test set 0.790x speedup, val set 5.106x speedup, step: 3, train time 8.20 s
Epoch 3/50 |loss: 0.188483| train set 5.455x speedup, test set 0.649x speedup, val set 5.073x speedup, step: 4, train time 7.92 s
Epoch 4/50 |loss: 0.176163| train set 5.450x speedup, test set 0.758x speedup, val set 5.195x speedup, step: 1, train time 7.60 s
Epoch 5/50 |loss: 0.172200| train set 5.424x speedup, test set 0.875x speedup, val set 5.040x speedup, step: 2, train time 8.16 s
Epoch 6/50 |loss: 0.162636| train set 5.496x speedup, test set 0.802x speedup, val set 5.107x speedup, step: 3, train time 8.10 s
Epoch 7/50 |loss: 0.156343| train set 5.450x speedup, test set 0.864x speedup, val set 5.195x speedup, step: 4, train time 7.98 s
Epoch 8/50 |loss: 0.151763| train set 5.496x speedup, test set 0.844x speedup, val set 5.106x speedup, step: 5, train time 7.89 s
Epoch 9/50 |loss: 0.152060| train set 5.447x speedup, test set 0.817x speedup, val set 5.068x speedup, step: 6, train time 8.09 s
Epoch 10/50 |loss: 0.151331| train set 5.448x speedup, test set 0.832x speedup, val set 5.066x speedup, step: 7, train time 7.92 s
Epoch 11/50 |loss: 0.146090| train set 5.402x speedup, test set 0.875x speedup, val set 5.153x speedup, step: 8, train time 7.87 s
Epoch 12/50 |loss: 0.138011| train set 5.496x speedup, test set 0.878x speedup, val set 5.107x speedup, step: 9, train time 8.38 s
Epoch 13/50 |loss: 0.137163| train set 5.451x speedup, test set 0.835x speedup, val set 5.069x speedup, step: 10, train time 8.17 s
Epoch 14/50 |loss: 0.137303| train set 5.448x speedup, test set 0.931x speedup, val set 5.066x speedup, step: 11, train time 8.97 s
Epoch 15/50 |loss: 0.137307| train set 5.450x speedup, test set 0.921x speedup, val set 5.068x speedup, step: 12, train time 8.28 s
Epoch 16/50 |loss: 0.137154| train set 5.450x speedup, test set 0.853x speedup, val set 5.069x speedup, step: 13, train time 7.88 s
Epoch 17/50 |loss: 0.133969| train set 5.265x speedup, test set 0.878x speedup, val set 4.981x speedup, step: 14, train time 8.19 s
Epoch 18/50 |loss: 0.134280| train set 5.291x speedup, test set 0.921x speedup, val set 4.977x speedup, step: 15, train time 7.80 s
Epoch 19/50 |loss: 0.130265| train set 5.496x speedup, test set 0.859x speedup, val set 5.107x speedup, step: 16, train time 7.87 s
Epoch 20/50 |loss: 0.136814| train set 5.496x speedup, test set 0.851x speedup, val set 5.107x speedup, step: 17, train time 8.37 s
Epoch 21/50 |loss: 0.133364| train set 5.496x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 18, train time 7.88 s
Epoch 22/50 |loss: 0.131237| train set 5.496x speedup, test set 0.921x speedup, val set 5.107x speedup, step: 19, train time 8.60 s
Epoch 23/50 |loss: 0.130583| train set 5.446x speedup, test set 0.911x speedup, val set 5.206x speedup, step: 20, train time 7.81 s
Epoch 24/50 |loss: 0.132549| train set 5.496x speedup, test set 0.922x speedup, val set 5.107x speedup, step: 21, train time 8.18 s
Epoch 25/50 |loss: 0.128561| train set 5.496x speedup, test set 0.810x speedup, val set 5.107x speedup, step: 22, train time 7.62 s
Epoch 26/50 |loss: 0.129603| train set 5.497x speedup, test set 0.887x speedup, val set 5.106x speedup, step: 23, train time 7.59 s
Epoch 27/50 |loss: 0.129145| train set 5.402x speedup, test set 0.877x speedup, val set 5.153x speedup, step: 24, train time 8.10 s
Epoch 28/50 |loss: 0.126153| train set 5.452x speedup, test set 0.910x speedup, val set 5.195x speedup, step: 25, train time 8.09 s
Epoch 29/50 |loss: 0.125885| train set 5.404x speedup, test set 0.835x speedup, val set 5.156x speedup, step: 26, train time 7.90 s
Epoch 30/50 |loss: 0.128070| train set 5.496x speedup, test set 0.910x speedup, val set 5.107x speedup, step: 27, train time 8.02 s
Epoch 31/50 |loss: 0.125583| train set 5.496x speedup, test set 0.911x speedup, val set 5.105x speedup, step: 28, train time 8.38 s
Epoch 32/50 |loss: 0.123850| train set 5.448x speedup, test set 0.889x speedup, val set 5.068x speedup, step: 29, train time 8.19 s
Epoch 33/50 |loss: 0.124835| train set 5.497x speedup, test set 0.910x speedup, val set 5.106x speedup, step: 30, train time 8.21 s
Epoch 34/50 |loss: 0.124378| train set 5.497x speedup, test set 0.876x speedup, val set 5.106x speedup, step: 31, train time 8.20 s
Epoch 35/50 |loss: 0.126271| train set 5.496x speedup, test set 0.823x speedup, val set 5.107x speedup, step: 32, train time 7.70 s
Epoch 36/50 |loss: 0.124667| train set 5.449x speedup, test set 0.878x speedup, val set 5.194x speedup, step: 33, train time 7.98 s
Epoch 37/50 |loss: 0.125730| train set 5.450x speedup, test set 0.891x speedup, val set 5.195x speedup, step: 34, train time 7.72 s
Epoch 38/50 |loss: 0.124363| train set 5.406x speedup, test set 0.911x speedup, val set 5.152x speedup, step: 35, train time 7.91 s
Epoch 39/50 |loss: 0.121747| train set 5.402x speedup, test set 0.890x speedup, val set 5.154x speedup, step: 36, train time 7.96 s
Epoch 40/50 |loss: 0.123970| train set 5.450x speedup, test set 0.911x speedup, val set 5.193x speedup, step: 37, train time 7.88 s
Epoch 41/50 |loss: 0.120858| train set 5.496x speedup, test set 0.776x speedup, val set 5.107x speedup, step: 38, train time 7.67 s
Epoch 42/50 |loss: 0.120971| train set 5.450x speedup, test set 0.835x speedup, val set 5.193x speedup, step: 39, train time 8.47 s
Epoch 43/50 |loss: 0.119914| train set 5.448x speedup, test set 0.859x speedup, val set 5.068x speedup, step: 40, train time 7.89 s
Epoch 44/50 |loss: 0.125648| train set 5.497x speedup, test set 0.806x speedup, val set 5.106x speedup, step: 41, train time 7.77 s
Epoch 45/50 |loss: 0.121642| train set 5.499x speedup, test set 0.868x speedup, val set 5.107x speedup, step: 42, train time 8.18 s
Epoch 46/50 |loss: 0.125129| train set 5.444x speedup, test set 0.835x speedup, val set 5.060x speedup, step: 43, train time 7.79 s
Epoch 47/50 |loss: 0.121320| train set 5.497x speedup, test set 0.901x speedup, val set 5.106x speedup, step: 44, train time 7.97 s
Epoch 48/50 |loss: 0.119118| train set 5.497x speedup, test set 0.897x speedup, val set 5.106x speedup, step: 45, train time 8.00 s
Epoch 49/50 |loss: 0.119076| train set 5.448x speedup, test set 1.308x speedup, val set 5.067x speedup, step: 46, train time 8.00 s
Training per epoch cost 8.064 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 2.986s, pg runtime 0.313s, speedup 0.105x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 8.456s, pg runtime 0.891s, speedup 0.105x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 2.523s, pg runtime 0.189s, speedup 0.075x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 6.391s, pg runtime 0.023s, speedup 0.004x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 45, train speedup 5.499, test speedup 0.868, val speedup 5.107
best test speedup epoch: 49, train speedup 5.448, test speedup 1.308, val speedup 5.067
best validation speedup epoch: 4, train speedup 5.450, test speedup 0.758, val speedup 5.195
last model at epoch 49, train speedup 5.448, test speedup 1.308, val speedup 5.067
execution cost 0:07:14.692577
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.532003, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.397594| train set 5.109x speedup, test set 0.908x speedup, val set 4.836x speedup, step: 1, train time 9.32 s
Epoch 1/50 |loss: 0.241084| train set 5.456x speedup, test set 0.889x speedup, val set 5.072x speedup, step: 2, train time 7.67 s
Epoch 2/50 |loss: 0.211702| train set 5.402x speedup, test set 0.903x speedup, val set 5.022x speedup, step: 3, train time 8.17 s
Epoch 3/50 |loss: 0.187629| train set 5.168x speedup, test set 0.766x speedup, val set 4.875x speedup, step: 4, train time 8.43 s
Epoch 4/50 |loss: 0.179674| train set 5.424x speedup, test set 0.759x speedup, val set 5.040x speedup, step: 1, train time 8.17 s
Epoch 5/50 |loss: 0.172801| train set 5.424x speedup, test set 0.880x speedup, val set 5.040x speedup, step: 2, train time 7.75 s
Epoch 6/50 |loss: 0.161554| train set 5.497x speedup, test set 0.751x speedup, val set 5.106x speedup, step: 3, train time 7.69 s
Epoch 7/50 |loss: 0.154074| train set 5.450x speedup, test set 0.881x speedup, val set 5.193x speedup, step: 4, train time 7.99 s
Epoch 8/50 |loss: 0.152173| train set 5.450x speedup, test set 0.802x speedup, val set 5.193x speedup, step: 5, train time 7.89 s
Epoch 9/50 |loss: 0.151287| train set 5.448x speedup, test set 0.766x speedup, val set 5.068x speedup, step: 1, train time 7.87 s
Epoch 10/50 |loss: 0.148068| train set 5.446x speedup, test set 0.909x speedup, val set 5.060x speedup, step: 2, train time 7.99 s
Epoch 11/50 |loss: 0.145859| train set 5.449x speedup, test set 0.886x speedup, val set 5.194x speedup, step: 3, train time 7.80 s
Epoch 12/50 |loss: 0.139378| train set 5.450x speedup, test set 0.874x speedup, val set 5.195x speedup, step: 4, train time 7.80 s
Epoch 13/50 |loss: 0.137266| train set 5.499x speedup, test set 0.881x speedup, val set 5.107x speedup, step: 5, train time 8.20 s
Epoch 14/50 |loss: 0.135770| train set 5.494x speedup, test set 0.915x speedup, val set 5.099x speedup, step: 1, train time 8.09 s
Epoch 15/50 |loss: 0.134186| train set 5.378x speedup, test set 0.911x speedup, val set 5.004x speedup, step: 2, train time 7.81 s
Epoch 16/50 |loss: 0.134583| train set 5.450x speedup, test set 0.888x speedup, val set 5.069x speedup, step: 3, train time 7.68 s
Epoch 17/50 |loss: 0.134169| train set 5.449x speedup, test set 0.901x speedup, val set 5.194x speedup, step: 4, train time 7.97 s
Epoch 18/50 |loss: 0.134203| train set 5.499x speedup, test set 0.907x speedup, val set 5.107x speedup, step: 5, train time 8.21 s
Epoch 19/50 |loss: 0.128868| train set 5.496x speedup, test set 0.911x speedup, val set 5.107x speedup, step: 1, train time 7.81 s
Epoch 20/50 |loss: 0.136142| train set 5.422x speedup, test set 0.911x speedup, val set 5.034x speedup, step: 2, train time 7.81 s
Epoch 21/50 |loss: 0.132343| train set 5.290x speedup, test set 0.859x speedup, val set 4.977x speedup, step: 3, train time 7.81 s
Epoch 22/50 |loss: 0.132439| train set 5.497x speedup, test set 0.877x speedup, val set 5.106x speedup, step: 4, train time 8.69 s
Epoch 23/50 |loss: 0.131337| train set 5.446x speedup, test set 0.898x speedup, val set 5.206x speedup, step: 5, train time 7.91 s
Epoch 24/50 |loss: 0.131467| train set 5.447x speedup, test set 0.898x speedup, val set 5.188x speedup, step: 1, train time 7.91 s
Epoch 25/50 |loss: 0.128192| train set 5.446x speedup, test set 0.893x speedup, val set 5.187x speedup, step: 2, train time 7.91 s
Epoch 26/50 |loss: 0.129599| train set 5.497x speedup, test set 0.869x speedup, val set 5.106x speedup, step: 3, train time 7.88 s
Epoch 27/50 |loss: 0.127221| train set 5.379x speedup, test set 0.887x speedup, val set 4.923x speedup, step: 4, train time 7.90 s
Epoch 28/50 |loss: 0.126219| train set 5.452x speedup, test set 0.911x speedup, val set 5.195x speedup, step: 5, train time 8.49 s
Epoch 29/50 |loss: 0.125455| train set 5.450x speedup, test set 0.890x speedup, val set 5.193x speedup, step: 1, train time 7.90 s
Epoch 30/50 |loss: 0.127762| train set 5.447x speedup, test set 0.878x speedup, val set 5.068x speedup, step: 2, train time 7.89 s
Epoch 31/50 |loss: 0.125249| train set 5.448x speedup, test set 0.921x speedup, val set 5.066x speedup, step: 3, train time 7.60 s
Epoch 32/50 |loss: 0.122802| train set 5.450x speedup, test set 0.888x speedup, val set 5.070x speedup, step: 4, train time 8.12 s
Epoch 33/50 |loss: 0.125460| train set 5.496x speedup, test set 0.886x speedup, val set 5.105x speedup, step: 5, train time 8.21 s
Epoch 34/50 |loss: 0.125582| train set 5.496x speedup, test set 0.886x speedup, val set 5.107x speedup, step: 6, train time 7.87 s
Epoch 35/50 |loss: 0.126077| train set 5.496x speedup, test set 0.875x speedup, val set 5.107x speedup, step: 7, train time 7.68 s
Epoch 36/50 |loss: 0.124270| train set 5.496x speedup, test set 0.951x speedup, val set 5.106x speedup, step: 8, train time 7.98 s
Epoch 37/50 |loss: 0.125813| train set 5.450x speedup, test set 0.953x speedup, val set 5.195x speedup, step: 9, train time 8.36 s
Epoch 38/50 |loss: 0.125793| train set 5.452x speedup, test set 0.853x speedup, val set 5.197x speedup, step: 10, train time 7.88 s
early stopping at epoch 38
Training per epoch cost 8.003 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 0.881, val speedup 5.107
best test speedup epoch: 37, train speedup 5.450, test speedup 0.953, val speedup 5.195
best validation speedup epoch: 29, train speedup 5.450, test speedup 0.890, val speedup 5.193
last model at epoch 38, train speedup 5.452, test speedup 0.853, val speedup 5.197
execution cost 0:05:39.432967
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.582243, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.394479| train set 4.762x speedup, test set 0.975x speedup, val set 4.444x speedup, step: 1, train time 9.07 s
Epoch 1/50 |loss: 0.242606| train set 5.105x speedup, test set 0.844x speedup, val set 4.943x speedup, step: 2, train time 8.18 s
Epoch 2/50 |loss: 0.210563| train set 5.424x speedup, test set 0.842x speedup, val set 5.040x speedup, step: 3, train time 7.87 s
Epoch 3/50 |loss: 0.187484| train set 5.456x speedup, test set 1.150x speedup, val set 5.072x speedup, step: 4, train time 7.89 s
Epoch 4/50 |loss: 0.179289| train set 5.450x speedup, test set 1.252x speedup, val set 5.195x speedup, step: 1, train time 7.68 s
Epoch 5/50 |loss: 0.168411| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 2, train time 7.70 s
Epoch 6/50 |loss: 0.160577| train set 5.496x speedup, test set 0.729x speedup, val set 5.105x speedup, step: 3, train time 7.77 s
Epoch 7/50 |loss: 0.160559| train set 5.450x speedup, test set 0.882x speedup, val set 5.193x speedup, step: 4, train time 8.06 s
Epoch 8/50 |loss: 0.151686| train set 5.496x speedup, test set 0.883x speedup, val set 5.107x speedup, step: 5, train time 8.18 s
Epoch 9/50 |loss: 0.151979| train set 5.447x speedup, test set 0.908x speedup, val set 5.068x speedup, step: 6, train time 8.20 s
Epoch 10/50 |loss: 0.150009| train set 5.494x speedup, test set 0.908x speedup, val set 5.099x speedup, step: 7, train time 7.81 s
Epoch 11/50 |loss: 0.146981| train set 5.402x speedup, test set 0.925x speedup, val set 5.153x speedup, step: 8, train time 7.98 s
Epoch 12/50 |loss: 0.137697| train set 5.450x speedup, test set 0.794x speedup, val set 5.195x speedup, step: 9, train time 7.78 s
Epoch 13/50 |loss: 0.137543| train set 5.499x speedup, test set 0.849x speedup, val set 5.107x speedup, step: 10, train time 7.58 s
Epoch 14/50 |loss: 0.138259| train set 5.496x speedup, test set 0.911x speedup, val set 5.105x speedup, step: 11, train time 7.50 s
Epoch 15/50 |loss: 0.136893| train set 5.451x speedup, test set 0.911x speedup, val set 5.069x speedup, step: 12, train time 7.69 s
Epoch 16/50 |loss: 0.136453| train set 5.450x speedup, test set 0.911x speedup, val set 5.069x speedup, step: 13, train time 7.59 s
Epoch 17/50 |loss: 0.134337| train set 5.496x speedup, test set 0.891x speedup, val set 5.106x speedup, step: 14, train time 7.68 s
Epoch 18/50 |loss: 0.134500| train set 5.450x speedup, test set 0.894x speedup, val set 5.193x speedup, step: 15, train time 8.20 s
Epoch 19/50 |loss: 0.129724| train set 5.496x speedup, test set 0.887x speedup, val set 5.107x speedup, step: 16, train time 7.81 s
Epoch 20/50 |loss: 0.137349| train set 5.497x speedup, test set 0.915x speedup, val set 5.106x speedup, step: 17, train time 7.88 s
Epoch 21/50 |loss: 0.130744| train set 5.334x speedup, test set 0.865x speedup, val set 5.009x speedup, step: 18, train time 7.98 s
Epoch 22/50 |loss: 0.130011| train set 5.496x speedup, test set 0.924x speedup, val set 5.107x speedup, step: 19, train time 8.38 s
Epoch 23/50 |loss: 0.132278| train set 5.493x speedup, test set 0.911x speedup, val set 5.117x speedup, step: 20, train time 7.99 s
Epoch 24/50 |loss: 0.131738| train set 5.494x speedup, test set 0.915x speedup, val set 5.100x speedup, step: 21, train time 7.70 s
Epoch 25/50 |loss: 0.128536| train set 5.496x speedup, test set 0.819x speedup, val set 5.107x speedup, step: 22, train time 7.78 s
Epoch 26/50 |loss: 0.128966| train set 5.497x speedup, test set 0.877x speedup, val set 5.106x speedup, step: 23, train time 7.91 s
Epoch 27/50 |loss: 0.127530| train set 5.448x speedup, test set 0.911x speedup, val set 5.068x speedup, step: 24, train time 7.79 s
Epoch 28/50 |loss: 0.126743| train set 5.452x speedup, test set 0.915x speedup, val set 5.195x speedup, step: 25, train time 7.80 s
Epoch 29/50 |loss: 0.126723| train set 5.450x speedup, test set 0.911x speedup, val set 5.193x speedup, step: 26, train time 7.78 s
Epoch 30/50 |loss: 0.128118| train set 5.448x speedup, test set 0.911x speedup, val set 5.068x speedup, step: 27, train time 7.88 s
Epoch 31/50 |loss: 0.124677| train set 5.496x speedup, test set 0.915x speedup, val set 5.106x speedup, step: 28, train time 7.77 s
Epoch 32/50 |loss: 0.125941| train set 5.448x speedup, test set 0.892x speedup, val set 5.068x speedup, step: 29, train time 7.79 s
Epoch 33/50 |loss: 0.124512| train set 5.497x speedup, test set 0.911x speedup, val set 5.106x speedup, step: 30, train time 7.77 s
Epoch 34/50 |loss: 0.123922| train set 5.497x speedup, test set 0.857x speedup, val set 5.106x speedup, step: 31, train time 7.49 s
Epoch 35/50 |loss: 0.125790| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 32, train time 8.38 s
Epoch 36/50 |loss: 0.125959| train set 5.496x speedup, test set 0.791x speedup, val set 5.106x speedup, step: 33, train time 7.70 s
Epoch 37/50 |loss: 0.126127| train set 5.450x speedup, test set 0.895x speedup, val set 5.195x speedup, step: 34, train time 7.60 s
Epoch 38/50 |loss: 0.124064| train set 5.452x speedup, test set 0.911x speedup, val set 5.196x speedup, step: 35, train time 8.09 s
Epoch 39/50 |loss: 0.122896| train set 5.448x speedup, test set 0.911x speedup, val set 5.068x speedup, step: 36, train time 7.77 s
Epoch 40/50 |loss: 0.122643| train set 5.450x speedup, test set 0.911x speedup, val set 5.193x speedup, step: 37, train time 7.77 s
Epoch 41/50 |loss: 0.122016| train set 5.496x speedup, test set 0.858x speedup, val set 5.107x speedup, step: 38, train time 7.89 s
Epoch 42/50 |loss: 0.119951| train set 5.450x speedup, test set 0.907x speedup, val set 5.193x speedup, step: 39, train time 8.00 s
Epoch 43/50 |loss: 0.121181| train set 5.496x speedup, test set 0.859x speedup, val set 5.106x speedup, step: 40, train time 7.90 s
Epoch 44/50 |loss: 0.125424| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 41, train time 7.98 s
Epoch 45/50 |loss: 0.121467| train set 5.497x speedup, test set 0.900x speedup, val set 5.106x speedup, step: 42, train time 7.70 s
Epoch 46/50 |loss: 0.124002| train set 5.448x speedup, test set 0.859x speedup, val set 5.067x speedup, step: 43, train time 8.07 s
Epoch 47/50 |loss: 0.121735| train set 5.499x speedup, test set 0.961x speedup, val set 5.107x speedup, step: 44, train time 7.68 s
Epoch 48/50 |loss: 0.119364| train set 5.497x speedup, test set 0.904x speedup, val set 5.106x speedup, step: 45, train time 7.85 s
Epoch 49/50 |loss: 0.121895| train set 5.496x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 46, train time 7.57 s
Training per epoch cost 7.877 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 1.314s, pg runtime 0.189s, speedup 0.144x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 2.143s, pg runtime 0.348s, speedup 0.162x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 1.290s, pg runtime 0.086s, speedup 0.066x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 8.456s, pg runtime 0.891s, speedup 0.105x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 2.523s, pg runtime 0.189s, speedup 0.075x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.823s, pg runtime 0.112s, speedup 0.137x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 12.105s, pg runtime 0.023s, speedup 0.002x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 0.849, val speedup 5.107
best test speedup epoch: 4, train speedup 5.450, test speedup 1.252, val speedup 5.195
best validation speedup epoch: 4, train speedup 5.450, test speedup 1.252, val speedup 5.195
last model at epoch 49, train speedup 5.496, test speedup 0.865, val speedup 5.106
execution cost 0:07:04.995024
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.571396, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.395996| train set 5.049x speedup, test set 0.952x speedup, val set 4.777x speedup, step: 1, train time 9.19 s
Epoch 1/50 |loss: 0.242197| train set 4.940x speedup, test set 0.750x speedup, val set 4.640x speedup, step: 2, train time 7.81 s
Epoch 2/50 |loss: 0.207310| train set 5.424x speedup, test set 0.743x speedup, val set 5.040x speedup, step: 3, train time 7.52 s
Epoch 3/50 |loss: 0.188577| train set 5.456x speedup, test set 0.761x speedup, val set 5.072x speedup, step: 4, train time 7.87 s
Epoch 4/50 |loss: 0.178402| train set 5.378x speedup, test set 0.867x speedup, val set 5.126x speedup, step: 1, train time 8.07 s
Epoch 5/50 |loss: 0.171706| train set 5.424x speedup, test set 0.882x speedup, val set 5.040x speedup, step: 2, train time 7.57 s
Epoch 6/50 |loss: 0.159367| train set 5.423x speedup, test set 0.765x speedup, val set 5.040x speedup, step: 3, train time 7.79 s
Epoch 7/50 |loss: 0.157783| train set 5.404x speedup, test set 0.770x speedup, val set 5.140x speedup, step: 4, train time 8.08 s
Epoch 8/50 |loss: 0.149258| train set 5.497x speedup, test set 0.764x speedup, val set 5.106x speedup, step: 5, train time 7.87 s
Epoch 9/50 |loss: 0.153410| train set 5.447x speedup, test set 0.892x speedup, val set 5.068x speedup, step: 6, train time 7.69 s
Epoch 10/50 |loss: 0.150680| train set 5.448x speedup, test set 0.868x speedup, val set 5.066x speedup, step: 7, train time 8.07 s
Epoch 11/50 |loss: 0.147382| train set 5.449x speedup, test set 0.922x speedup, val set 5.193x speedup, step: 8, train time 7.79 s
Epoch 12/50 |loss: 0.139163| train set 5.450x speedup, test set 0.852x speedup, val set 5.195x speedup, step: 9, train time 7.89 s
Epoch 13/50 |loss: 0.137948| train set 5.499x speedup, test set 0.903x speedup, val set 5.107x speedup, step: 10, train time 8.09 s
Epoch 14/50 |loss: 0.136655| train set 5.494x speedup, test set 0.915x speedup, val set 5.099x speedup, step: 11, train time 7.69 s
Epoch 15/50 |loss: 0.136296| train set 5.450x speedup, test set 0.926x speedup, val set 5.068x speedup, step: 12, train time 8.41 s
Epoch 16/50 |loss: 0.134534| train set 5.450x speedup, test set 0.926x speedup, val set 5.068x speedup, step: 13, train time 7.70 s
Epoch 17/50 |loss: 0.134920| train set 5.265x speedup, test set 0.911x speedup, val set 4.981x speedup, step: 14, train time 8.87 s
Epoch 18/50 |loss: 0.133408| train set 5.293x speedup, test set 0.922x speedup, val set 4.979x speedup, step: 15, train time 8.50 s
Epoch 19/50 |loss: 0.129740| train set 5.496x speedup, test set 0.915x speedup, val set 5.107x speedup, step: 16, train time 8.82 s
Epoch 20/50 |loss: 0.136819| train set 5.496x speedup, test set 0.919x speedup, val set 5.106x speedup, step: 17, train time 7.71 s
Epoch 21/50 |loss: 0.132878| train set 5.336x speedup, test set 0.888x speedup, val set 5.015x speedup, step: 18, train time 8.18 s
Epoch 22/50 |loss: 0.131755| train set 5.497x speedup, test set 0.940x speedup, val set 5.106x speedup, step: 19, train time 8.41 s
Epoch 23/50 |loss: 0.132895| train set 5.332x speedup, test set 0.911x speedup, val set 5.025x speedup, step: 20, train time 7.88 s
Epoch 24/50 |loss: 0.133280| train set 5.494x speedup, test set 0.926x speedup, val set 5.100x speedup, step: 21, train time 7.70 s
Epoch 25/50 |loss: 0.128808| train set 5.450x speedup, test set 0.998x speedup, val set 5.195x speedup, step: 22, train time 8.08 s
Epoch 26/50 |loss: 0.130189| train set 5.497x speedup, test set 0.915x speedup, val set 5.106x speedup, step: 23, train time 7.90 s
Epoch 27/50 |loss: 0.128328| train set 5.450x speedup, test set 0.847x speedup, val set 5.070x speedup, step: 24, train time 8.11 s
Epoch 28/50 |loss: 0.125299| train set 5.446x speedup, test set 0.933x speedup, val set 5.206x speedup, step: 25, train time 7.79 s
Epoch 29/50 |loss: 0.126706| train set 5.402x speedup, test set 0.911x speedup, val set 5.154x speedup, step: 1, train time 7.90 s
Epoch 30/50 |loss: 0.129724| train set 5.448x speedup, test set 0.888x speedup, val set 5.068x speedup, step: 2, train time 7.46 s
Epoch 31/50 |loss: 0.125706| train set 5.496x speedup, test set 0.911x speedup, val set 5.106x speedup, step: 3, train time 7.80 s
Epoch 32/50 |loss: 0.124596| train set 5.448x speedup, test set 0.911x speedup, val set 5.068x speedup, step: 4, train time 7.81 s
Epoch 33/50 |loss: 0.125213| train set 5.497x speedup, test set 0.888x speedup, val set 5.106x speedup, step: 5, train time 7.88 s
Epoch 34/50 |loss: 0.125358| train set 5.497x speedup, test set 0.994x speedup, val set 5.106x speedup, step: 6, train time 7.87 s
Epoch 35/50 |loss: 0.126489| train set 5.496x speedup, test set 0.844x speedup, val set 5.107x speedup, step: 7, train time 7.58 s
Epoch 36/50 |loss: 0.125276| train set 5.449x speedup, test set 0.966x speedup, val set 5.193x speedup, step: 8, train time 7.50 s
Epoch 37/50 |loss: 0.127328| train set 5.450x speedup, test set 0.888x speedup, val set 5.195x speedup, step: 9, train time 8.07 s
Epoch 38/50 |loss: 0.125846| train set 5.450x speedup, test set 0.911x speedup, val set 5.195x speedup, step: 10, train time 7.68 s
Epoch 39/50 |loss: 0.123080| train set 5.448x speedup, test set 0.888x speedup, val set 5.068x speedup, step: 11, train time 8.07 s
Epoch 40/50 |loss: 0.123256| train set 5.450x speedup, test set 0.888x speedup, val set 5.193x speedup, step: 12, train time 7.58 s
Epoch 41/50 |loss: 0.122287| train set 5.496x speedup, test set 0.888x speedup, val set 5.107x speedup, step: 13, train time 7.68 s
Epoch 42/50 |loss: 0.121269| train set 5.450x speedup, test set 0.888x speedup, val set 5.195x speedup, step: 14, train time 7.69 s
Epoch 43/50 |loss: 0.121468| train set 5.496x speedup, test set 0.844x speedup, val set 5.106x speedup, step: 15, train time 7.48 s
Epoch 44/50 |loss: 0.125234| train set 5.496x speedup, test set 0.888x speedup, val set 5.107x speedup, step: 16, train time 7.87 s
Epoch 45/50 |loss: 0.120324| train set 5.499x speedup, test set 0.888x speedup, val set 5.107x speedup, step: 17, train time 7.90 s
Epoch 46/50 |loss: 0.123376| train set 5.448x speedup, test set 0.966x speedup, val set 5.067x speedup, step: 18, train time 7.88 s
Epoch 47/50 |loss: 0.121564| train set 5.499x speedup, test set 0.911x speedup, val set 5.107x speedup, step: 19, train time 7.39 s
Epoch 48/50 |loss: 0.120533| train set 5.497x speedup, test set 0.966x speedup, val set 5.106x speedup, step: 20, train time 7.49 s
Epoch 49/50 |loss: 0.120972| train set 5.496x speedup, test set 0.914x speedup, val set 5.105x speedup, step: 21, train time 7.69 s
Training per epoch cost 7.906 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.012s, pg runtime 0.072s, speedup 6.102x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.459s, pg runtime 0.354s, speedup 0.771x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 0.903, val speedup 5.107
best test speedup epoch: 25, train speedup 5.450, test speedup 0.998, val speedup 5.195
best validation speedup epoch: 29, train speedup 5.402, test speedup 0.911, val speedup 5.154
last model at epoch 49, train speedup 5.496, test speedup 0.914, val speedup 5.105
execution cost 0:07:07.417777
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
(120, 49)
(120, 49)
construct training samples cost 0:00:00.516235, and there are 11622 training samples
in channel 9
Epoch 0/50 |loss: 0.395484| train set 4.902x speedup, test set 0.987x speedup, val set 4.668x speedup, step: 1, train time 8.86 s
Epoch 1/50 |loss: 0.241568| train set 5.419x speedup, test set 0.686x speedup, val set 5.182x speedup, step: 2, train time 7.89 s
Epoch 2/50 |loss: 0.209846| train set 5.423x speedup, test set 0.846x speedup, val set 5.040x speedup, step: 3, train time 7.91 s
Epoch 3/50 |loss: 0.184596| train set 5.144x speedup, test set 0.692x speedup, val set 4.741x speedup, step: 4, train time 7.97 s
Epoch 4/50 |loss: 0.176444| train set 5.423x speedup, test set 0.760x speedup, val set 5.040x speedup, step: 1, train time 7.90 s
Epoch 5/50 |loss: 0.172431| train set 5.424x speedup, test set 0.913x speedup, val set 5.040x speedup, step: 2, train time 7.72 s
Epoch 6/50 |loss: 0.157597| train set 5.424x speedup, test set 0.758x speedup, val set 5.040x speedup, step: 3, train time 7.78 s
Epoch 7/50 |loss: 0.157738| train set 5.450x speedup, test set 0.855x speedup, val set 5.193x speedup, step: 4, train time 7.88 s
Epoch 8/50 |loss: 0.150399| train set 5.496x speedup, test set 0.738x speedup, val set 5.107x speedup, step: 5, train time 7.98 s
Epoch 9/50 |loss: 0.152555| train set 5.446x speedup, test set 0.883x speedup, val set 5.061x speedup, step: 1, train time 7.76 s
Epoch 10/50 |loss: 0.148008| train set 5.446x speedup, test set 0.917x speedup, val set 5.060x speedup, step: 2, train time 7.79 s
Epoch 11/50 |loss: 0.146823| train set 5.401x speedup, test set 0.917x speedup, val set 5.154x speedup, step: 3, train time 7.87 s
Epoch 12/50 |loss: 0.137863| train set 5.450x speedup, test set 0.798x speedup, val set 5.195x speedup, step: 4, train time 7.88 s
Epoch 13/50 |loss: 0.137106| train set 5.499x speedup, test set 0.768x speedup, val set 5.107x speedup, step: 5, train time 8.00 s
Epoch 14/50 |loss: 0.137033| train set 5.497x speedup, test set 0.935x speedup, val set 5.106x speedup, step: 1, train time 7.98 s
Epoch 15/50 |loss: 0.136669| train set 5.451x speedup, test set 0.953x speedup, val set 5.069x speedup, step: 2, train time 7.99 s
Epoch 16/50 |loss: 0.134562| train set 5.450x speedup, test set 0.935x speedup, val set 5.069x speedup, step: 3, train time 7.68 s
Epoch 17/50 |loss: 0.132716| train set 5.449x speedup, test set 0.829x speedup, val set 5.194x speedup, step: 4, train time 7.98 s
Epoch 18/50 |loss: 0.133397| train set 5.291x speedup, test set 0.885x speedup, val set 4.977x speedup, step: 5, train time 7.69 s
Epoch 19/50 |loss: 0.128547| train set 5.496x speedup, test set 0.918x speedup, val set 5.107x speedup, step: 1, train time 7.88 s
Epoch 20/50 |loss: 0.136713| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 2, train time 8.08 s
Epoch 21/50 |loss: 0.130973| train set 5.496x speedup, test set 0.932x speedup, val set 5.106x speedup, step: 3, train time 8.38 s
Epoch 22/50 |loss: 0.131446| train set 5.497x speedup, test set 0.924x speedup, val set 5.106x speedup, step: 4, train time 8.22 s
Epoch 23/50 |loss: 0.129700| train set 5.336x speedup, test set 0.985x speedup, val set 5.014x speedup, step: 5, train time 7.51 s
Epoch 24/50 |loss: 0.131532| train set 5.494x speedup, test set 0.829x speedup, val set 5.100x speedup, step: 6, train time 7.77 s
Epoch 25/50 |loss: 0.127743| train set 5.450x speedup, test set 0.893x speedup, val set 5.195x speedup, step: 7, train time 7.58 s
Epoch 26/50 |loss: 0.129517| train set 5.497x speedup, test set 0.844x speedup, val set 5.106x speedup, step: 8, train time 7.59 s
Epoch 27/50 |loss: 0.128036| train set 5.448x speedup, test set 0.852x speedup, val set 5.067x speedup, step: 9, train time 7.87 s
Epoch 28/50 |loss: 0.124844| train set 5.452x speedup, test set 0.929x speedup, val set 5.195x speedup, step: 10, train time 7.78 s
Epoch 29/50 |loss: 0.125663| train set 5.452x speedup, test set 0.840x speedup, val set 5.195x speedup, step: 1, train time 7.58 s
Epoch 30/50 |loss: 0.128794| train set 5.447x speedup, test set 0.904x speedup, val set 5.068x speedup, step: 2, train time 7.57 s
Epoch 31/50 |loss: 0.126029| train set 5.448x speedup, test set 0.969x speedup, val set 5.066x speedup, step: 3, train time 7.60 s
Epoch 32/50 |loss: 0.125037| train set 5.448x speedup, test set 0.831x speedup, val set 5.068x speedup, step: 4, train time 7.60 s
Epoch 33/50 |loss: 0.125313| train set 5.496x speedup, test set 0.898x speedup, val set 5.105x speedup, step: 5, train time 7.73 s
Epoch 34/50 |loss: 0.124019| train set 5.497x speedup, test set 0.896x speedup, val set 5.106x speedup, step: 6, train time 7.98 s
Epoch 35/50 |loss: 0.125222| train set 5.496x speedup, test set 0.858x speedup, val set 5.107x speedup, step: 7, train time 8.00 s
Epoch 36/50 |loss: 0.124889| train set 5.449x speedup, test set 0.906x speedup, val set 5.194x speedup, step: 8, train time 7.39 s
Epoch 37/50 |loss: 0.125273| train set 5.450x speedup, test set 0.846x speedup, val set 5.195x speedup, step: 9, train time 8.00 s
early stopping at epoch 37
Training per epoch cost 7.858 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 2.523s, pg runtime 0.189s, speedup 0.075x
25, opt runtime 0.434s, model runtime 5.794s, pg runtime 0.434s, speedup 0.075x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.087s, pg runtime 0.112s, speedup 1.295x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 13, train speedup 5.499, test speedup 0.768, val speedup 5.107
best test speedup epoch: 0, train speedup 4.902, test speedup 0.987, val speedup 4.668
best validation speedup epoch: 29, train speedup 5.452, test speedup 0.840, val speedup 5.195
last model at epoch 37, train speedup 5.450, test speedup 0.846, val speedup 5.195
execution cost 0:05:24.134295
==================================================
