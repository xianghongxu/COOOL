all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.239001, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 15.36 s
Epoch 1/50 |loss: 0.205733| train set 5.007x speedup, test set 1.018x speedup, val set 1.033x speedup, step: 2, train time 11.62 s
Epoch 2/50 |loss: 0.181324| train set 4.638x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 3, train time 15.44 s
Epoch 3/50 |loss: 0.171076| train set 5.008x speedup, test set 0.998x speedup, val set 1.000x speedup, step: 4, train time 15.21 s
Epoch 4/50 |loss: 0.161008| train set 5.008x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 1, train time 15.34 s
Epoch 5/50 |loss: 0.157016| train set 4.958x speedup, test set 0.997x speedup, val set 0.729x speedup, step: 2, train time 15.00 s
Epoch 6/50 |loss: 0.153376| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 3, train time 15.40 s
Epoch 7/50 |loss: 0.146778| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 15.02 s
Epoch 8/50 |loss: 0.149615| train set 5.008x speedup, test set 0.994x speedup, val set 0.983x speedup, step: 5, train time 15.34 s
Epoch 9/50 |loss: 0.148309| train set 4.987x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 1, train time 15.12 s
Epoch 10/50 |loss: 0.142848| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 2, train time 15.12 s
Epoch 11/50 |loss: 0.137656| train set 5.007x speedup, test set 1.021x speedup, val set 1.000x speedup, step: 3, train time 15.21 s
Epoch 12/50 |loss: 0.141619| train set 5.007x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 4, train time 15.11 s
Epoch 13/50 |loss: 0.138142| train set 5.008x speedup, test set 0.971x speedup, val set 0.742x speedup, step: 5, train time 15.04 s
Epoch 14/50 |loss: 0.137026| train set 4.873x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 1, train time 15.21 s
Epoch 15/50 |loss: 0.136145| train set 4.921x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 2, train time 15.20 s
Epoch 16/50 |loss: 0.135733| train set 4.921x speedup, test set 0.976x speedup, val set 0.786x speedup, step: 3, train time 15.03 s
Epoch 17/50 |loss: 0.136024| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 15.22 s
Epoch 18/50 |loss: 0.133636| train set 5.008x speedup, test set 0.977x speedup, val set 0.762x speedup, step: 5, train time 15.10 s
Epoch 19/50 |loss: 0.135975| train set 4.958x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 1, train time 15.14 s
Epoch 20/50 |loss: 0.134489| train set 4.921x speedup, test set 1.003x speedup, val set 0.742x speedup, step: 2, train time 16.42 s
Epoch 21/50 |loss: 0.133492| train set 4.873x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 3, train time 15.70 s
Epoch 22/50 |loss: 0.137055| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 4, train time 15.22 s
Epoch 23/50 |loss: 0.131925| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 5, train time 15.23 s
Epoch 24/50 |loss: 0.130037| train set 4.921x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 1, train time 15.31 s
Epoch 25/50 |loss: 0.131481| train set 4.958x speedup, test set 0.976x speedup, val set 0.742x speedup, step: 2, train time 15.29 s
Epoch 26/50 |loss: 0.131551| train set 5.007x speedup, test set 1.003x speedup, val set 0.746x speedup, step: 3, train time 15.11 s
Epoch 27/50 |loss: 0.132063| train set 4.873x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 4, train time 15.04 s
Epoch 28/50 |loss: 0.129188| train set 5.008x speedup, test set 0.977x speedup, val set 0.775x speedup, step: 5, train time 15.02 s
Epoch 29/50 |loss: 0.131394| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 15.29 s
Epoch 30/50 |loss: 0.131164| train set 5.008x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 2, train time 15.12 s
Epoch 31/50 |loss: 0.129116| train set 4.958x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 3, train time 15.11 s
Epoch 32/50 |loss: 0.126425| train set 5.008x speedup, test set 0.976x speedup, val set 0.742x speedup, step: 4, train time 15.12 s
Epoch 33/50 |loss: 0.129278| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 5, train time 15.11 s
Epoch 34/50 |loss: 0.127217| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 1, train time 15.12 s
Epoch 35/50 |loss: 0.128173| train set 4.958x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 2, train time 15.01 s
Epoch 36/50 |loss: 0.128842| train set 5.008x speedup, test set 0.975x speedup, val set 0.775x speedup, step: 3, train time 15.01 s
Epoch 37/50 |loss: 0.127768| train set 4.958x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 4, train time 15.04 s
Epoch 38/50 |loss: 0.129746| train set 4.958x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 5, train time 15.01 s
Epoch 39/50 |loss: 0.127770| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 15.20 s
Epoch 40/50 |loss: 0.124835| train set 5.008x speedup, test set 0.937x speedup, val set 0.746x speedup, step: 2, train time 15.09 s
Epoch 41/50 |loss: 0.126058| train set 5.008x speedup, test set 0.939x speedup, val set 0.729x speedup, step: 3, train time 15.13 s
Epoch 42/50 |loss: 0.126685| train set 4.958x speedup, test set 0.918x speedup, val set 0.729x speedup, step: 4, train time 14.94 s
Epoch 43/50 |loss: 0.127284| train set 4.917x speedup, test set 0.924x speedup, val set 0.809x speedup, step: 5, train time 15.19 s
Epoch 44/50 |loss: 0.126964| train set 4.958x speedup, test set 0.935x speedup, val set 0.733x speedup, step: 1, train time 15.20 s
Epoch 45/50 |loss: 0.128686| train set 5.008x speedup, test set 0.974x speedup, val set 0.733x speedup, step: 2, train time 15.00 s
Epoch 46/50 |loss: 0.127471| train set 4.921x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 3, train time 15.11 s
Epoch 47/50 |loss: 0.126016| train set 5.008x speedup, test set 0.979x speedup, val set 0.733x speedup, step: 4, train time 15.02 s
Epoch 48/50 |loss: 0.127175| train set 4.958x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 5, train time 15.31 s
Epoch 49/50 |loss: 0.126950| train set 4.958x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 1, train time 15.14 s
early stopping at epoch 49
Training per epoch cost 15.117 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
13, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 11, train speedup 5.007, test speedup 1.021, val speedup 1.000
best validation speedup epoch: 49, train speedup 4.958, test speedup 0.989, val speedup 0.733
last model at epoch 49, train speedup 4.958, test speedup 0.989, val speedup 0.733
execution cost 0:13:51.235358
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.043937, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 17.95 s
Epoch 1/50 |loss: 0.206280| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 15.62 s
Epoch 2/50 |loss: 0.178327| train set 4.715x speedup, test set 0.992x speedup, val set 1.000x speedup, step: 3, train time 15.42 s
Epoch 3/50 |loss: 0.172392| train set 5.007x speedup, test set 1.020x speedup, val set 0.973x speedup, step: 4, train time 15.02 s
Epoch 4/50 |loss: 0.160402| train set 5.008x speedup, test set 1.002x speedup, val set 0.729x speedup, step: 1, train time 15.40 s
Epoch 5/50 |loss: 0.155659| train set 4.873x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 2, train time 15.02 s
Epoch 6/50 |loss: 0.151898| train set 5.008x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 3, train time 15.31 s
Epoch 7/50 |loss: 0.148413| train set 5.008x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 4, train time 15.09 s
Epoch 8/50 |loss: 0.150415| train set 4.715x speedup, test set 0.971x speedup, val set 0.733x speedup, step: 5, train time 15.03 s
Epoch 9/50 |loss: 0.148979| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 1, train time 15.31 s
Epoch 10/50 |loss: 0.142914| train set 4.913x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 2, train time 14.99 s
Epoch 11/50 |loss: 0.139979| train set 5.007x speedup, test set 1.027x speedup, val set 0.729x speedup, step: 3, train time 15.21 s
Epoch 12/50 |loss: 0.143168| train set 5.008x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 4, train time 14.95 s
Epoch 13/50 |loss: 0.139413| train set 5.008x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 5, train time 15.00 s
Epoch 14/50 |loss: 0.138179| train set 4.873x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 1, train time 15.10 s
Epoch 15/50 |loss: 0.137914| train set 4.921x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 2, train time 15.20 s
Epoch 16/50 |loss: 0.136974| train set 4.921x speedup, test set 0.981x speedup, val set 0.742x speedup, step: 3, train time 15.15 s
Epoch 17/50 |loss: 0.137058| train set 5.008x speedup, test set 1.022x speedup, val set 0.729x speedup, step: 4, train time 15.14 s
Epoch 18/50 |loss: 0.134342| train set 5.008x speedup, test set 0.993x speedup, val set 0.735x speedup, step: 5, train time 15.11 s
Epoch 19/50 |loss: 0.136154| train set 5.008x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 1, train time 15.12 s
Epoch 20/50 |loss: 0.134250| train set 4.921x speedup, test set 1.014x speedup, val set 0.742x speedup, step: 2, train time 16.13 s
Epoch 21/50 |loss: 0.134732| train set 4.863x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 3, train time 15.40 s
Epoch 22/50 |loss: 0.136687| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 4, train time 15.42 s
Epoch 23/50 |loss: 0.132632| train set 5.008x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 5, train time 15.12 s
Epoch 24/50 |loss: 0.132105| train set 4.921x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 6, train time 15.33 s
Epoch 25/50 |loss: 0.131584| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 7, train time 15.32 s
Epoch 26/50 |loss: 0.130503| train set 5.007x speedup, test set 1.038x speedup, val set 0.733x speedup, step: 8, train time 15.43 s
Epoch 27/50 |loss: 0.130863| train set 4.921x speedup, test set 1.010x speedup, val set 0.739x speedup, step: 9, train time 15.33 s
Epoch 28/50 |loss: 0.130159| train set 5.008x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 10, train time 15.42 s
Epoch 29/50 |loss: 0.131703| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 11, train time 15.51 s
Epoch 30/50 |loss: 0.132074| train set 5.008x speedup, test set 0.989x speedup, val set 0.746x speedup, step: 12, train time 15.62 s
Epoch 31/50 |loss: 0.130742| train set 4.873x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 13, train time 15.54 s
Epoch 32/50 |loss: 0.128354| train set 4.958x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 14, train time 15.54 s
Epoch 33/50 |loss: 0.129044| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 15, train time 15.40 s
Epoch 34/50 |loss: 0.127727| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 16, train time 15.41 s
Epoch 35/50 |loss: 0.128906| train set 5.008x speedup, test set 1.004x speedup, val set 0.733x speedup, step: 17, train time 15.13 s
Epoch 36/50 |loss: 0.128547| train set 5.008x speedup, test set 0.988x speedup, val set 0.767x speedup, step: 18, train time 15.35 s
Epoch 37/50 |loss: 0.129181| train set 4.917x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 19, train time 15.41 s
Epoch 38/50 |loss: 0.131579| train set 4.958x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 20, train time 15.42 s
Epoch 39/50 |loss: 0.128373| train set 5.010x speedup, test set 1.004x speedup, val set 0.742x speedup, step: 1, train time 15.34 s
Epoch 40/50 |loss: 0.125168| train set 4.921x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 2, train time 15.52 s
Epoch 41/50 |loss: 0.126818| train set 4.921x speedup, test set 0.988x speedup, val set 0.733x speedup, step: 3, train time 15.31 s
Epoch 42/50 |loss: 0.127313| train set 4.958x speedup, test set 0.947x speedup, val set 0.729x speedup, step: 4, train time 15.49 s
Epoch 43/50 |loss: 0.127259| train set 4.920x speedup, test set 0.989x speedup, val set 0.762x speedup, step: 5, train time 15.33 s
Epoch 44/50 |loss: 0.128520| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 6, train time 15.43 s
Epoch 45/50 |loss: 0.128195| train set 5.008x speedup, test set 0.988x speedup, val set 0.735x speedup, step: 7, train time 15.31 s
Epoch 46/50 |loss: 0.128226| train set 4.921x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 8, train time 15.51 s
Epoch 47/50 |loss: 0.126166| train set 5.008x speedup, test set 0.988x speedup, val set 0.735x speedup, step: 9, train time 15.52 s
Epoch 48/50 |loss: 0.126862| train set 4.958x speedup, test set 1.015x speedup, val set 0.735x speedup, step: 10, train time 15.48 s
Epoch 49/50 |loss: 0.126265| train set 4.958x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 11, train time 15.62 s
early stopping at epoch 49
Training per epoch cost 15.385 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.078s, pg runtime 1.357s, speedup 0.653x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 39, train speedup 5.010, test speedup 1.004, val speedup 0.742
best test speedup epoch: 26, train speedup 5.007, test speedup 1.038, val speedup 0.733
best validation speedup epoch: 39, train speedup 5.010, test speedup 1.004, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.988, val speedup 0.729
execution cost 0:14:05.780177
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.048928, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336394| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 18.64 s
Epoch 1/50 |loss: 0.209097| train set 4.987x speedup, test set 1.025x speedup, val set 1.033x speedup, step: 2, train time 16.12 s
Epoch 2/50 |loss: 0.179617| train set 4.921x speedup, test set 0.972x speedup, val set 0.779x speedup, step: 3, train time 16.25 s
Epoch 3/50 |loss: 0.169902| train set 5.008x speedup, test set 1.001x speedup, val set 0.729x speedup, step: 4, train time 16.22 s
Epoch 4/50 |loss: 0.161448| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 1, train time 16.20 s
Epoch 5/50 |loss: 0.155504| train set 4.630x speedup, test set 0.915x speedup, val set 0.729x speedup, step: 2, train time 16.20 s
Epoch 6/50 |loss: 0.152171| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 3, train time 16.21 s
Epoch 7/50 |loss: 0.147992| train set 4.921x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 16.04 s
Epoch 8/50 |loss: 0.149159| train set 4.988x speedup, test set 0.973x speedup, val set 0.729x speedup, step: 5, train time 16.11 s
Epoch 9/50 |loss: 0.148811| train set 5.008x speedup, test set 0.960x speedup, val set 0.729x speedup, step: 1, train time 16.30 s
Epoch 10/50 |loss: 0.142107| train set 5.008x speedup, test set 0.965x speedup, val set 0.742x speedup, step: 2, train time 16.40 s
Epoch 11/50 |loss: 0.136976| train set 5.007x speedup, test set 0.965x speedup, val set 0.735x speedup, step: 3, train time 16.23 s
Epoch 12/50 |loss: 0.140658| train set 5.007x speedup, test set 0.954x speedup, val set 0.729x speedup, step: 4, train time 16.33 s
Epoch 13/50 |loss: 0.136896| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 5, train time 16.47 s
Epoch 14/50 |loss: 0.137511| train set 4.872x speedup, test set 0.953x speedup, val set 0.742x speedup, step: 1, train time 15.83 s
Epoch 15/50 |loss: 0.136970| train set 4.921x speedup, test set 0.968x speedup, val set 0.770x speedup, step: 2, train time 15.70 s
Epoch 16/50 |loss: 0.136796| train set 4.921x speedup, test set 0.953x speedup, val set 0.786x speedup, step: 3, train time 15.73 s
Epoch 17/50 |loss: 0.136445| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 4, train time 15.83 s
Epoch 18/50 |loss: 0.133319| train set 5.008x speedup, test set 0.988x speedup, val set 0.742x speedup, step: 5, train time 15.73 s
Epoch 19/50 |loss: 0.135548| train set 4.958x speedup, test set 0.988x speedup, val set 0.735x speedup, step: 6, train time 15.93 s
Epoch 20/50 |loss: 0.133874| train set 4.921x speedup, test set 0.988x speedup, val set 0.795x speedup, step: 7, train time 17.00 s
Epoch 21/50 |loss: 0.133510| train set 4.868x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 8, train time 15.93 s
Epoch 22/50 |loss: 0.135762| train set 5.008x speedup, test set 0.987x speedup, val set 0.762x speedup, step: 9, train time 15.92 s
Epoch 23/50 |loss: 0.132597| train set 5.008x speedup, test set 0.972x speedup, val set 0.739x speedup, step: 10, train time 15.49 s
Epoch 24/50 |loss: 0.130257| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 11, train time 15.30 s
Epoch 25/50 |loss: 0.132717| train set 5.008x speedup, test set 0.988x speedup, val set 0.742x speedup, step: 12, train time 15.01 s
Epoch 26/50 |loss: 0.130598| train set 5.007x speedup, test set 0.968x speedup, val set 0.746x speedup, step: 13, train time 15.14 s
Epoch 27/50 |loss: 0.131793| train set 4.873x speedup, test set 0.988x speedup, val set 0.809x speedup, step: 14, train time 15.13 s
Epoch 28/50 |loss: 0.130142| train set 5.008x speedup, test set 0.940x speedup, val set 0.800x speedup, step: 15, train time 15.21 s
Epoch 29/50 |loss: 0.129033| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 1, train time 15.04 s
Epoch 30/50 |loss: 0.130506| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 2, train time 15.04 s
Epoch 31/50 |loss: 0.129480| train set 4.958x speedup, test set 0.988x speedup, val set 0.742x speedup, step: 3, train time 15.02 s
Epoch 32/50 |loss: 0.127486| train set 5.010x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 4, train time 15.02 s
Epoch 33/50 |loss: 0.129053| train set 5.008x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 5, train time 15.30 s
Epoch 34/50 |loss: 0.127561| train set 5.008x speedup, test set 1.010x speedup, val set 0.733x speedup, step: 6, train time 15.05 s
Epoch 35/50 |loss: 0.129353| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 7, train time 15.02 s
Epoch 36/50 |loss: 0.128755| train set 5.008x speedup, test set 0.965x speedup, val set 0.786x speedup, step: 8, train time 15.22 s
Epoch 37/50 |loss: 0.128436| train set 4.958x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 9, train time 15.02 s
Epoch 38/50 |loss: 0.129811| train set 4.958x speedup, test set 0.970x speedup, val set 0.729x speedup, step: 10, train time 15.00 s
Epoch 39/50 |loss: 0.128663| train set 5.008x speedup, test set 0.986x speedup, val set 0.742x speedup, step: 1, train time 15.11 s
Epoch 40/50 |loss: 0.126234| train set 5.008x speedup, test set 0.965x speedup, val set 0.729x speedup, step: 2, train time 15.11 s
Epoch 41/50 |loss: 0.126349| train set 5.008x speedup, test set 0.946x speedup, val set 0.729x speedup, step: 3, train time 15.22 s
Epoch 42/50 |loss: 0.127147| train set 4.958x speedup, test set 0.901x speedup, val set 0.729x speedup, step: 4, train time 15.13 s
Epoch 43/50 |loss: 0.127728| train set 4.917x speedup, test set 0.944x speedup, val set 0.809x speedup, step: 5, train time 15.13 s
Epoch 44/50 |loss: 0.128276| train set 4.958x speedup, test set 1.010x speedup, val set 0.733x speedup, step: 6, train time 15.11 s
Epoch 45/50 |loss: 0.128418| train set 5.000x speedup, test set 0.998x speedup, val set 0.746x speedup, step: 7, train time 14.94 s
Epoch 46/50 |loss: 0.126955| train set 4.921x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 8, train time 15.03 s
Epoch 47/50 |loss: 0.126189| train set 5.004x speedup, test set 0.998x speedup, val set 0.735x speedup, step: 9, train time 15.12 s
Epoch 48/50 |loss: 0.127549| train set 4.958x speedup, test set 1.011x speedup, val set 0.746x speedup, step: 10, train time 15.21 s
Epoch 49/50 |loss: 0.127026| train set 4.958x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 11, train time 15.05 s
early stopping at epoch 49
Training per epoch cost 15.629 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 1.357s, pg runtime 1.357s, speedup 1.000x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 32, train speedup 5.010, test speedup 0.967, val speedup 0.742
best test speedup epoch: 1, train speedup 4.987, test speedup 1.025, val speedup 1.033
best validation speedup epoch: 39, train speedup 5.008, test speedup 0.986, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 1.010, val speedup 0.729
execution cost 0:14:20.081499
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.677342, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 16.94 s
Epoch 1/50 |loss: 0.206187| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 15.02 s
Epoch 2/50 |loss: 0.182012| train set 4.715x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 3, train time 14.84 s
Epoch 3/50 |loss: 0.170533| train set 5.007x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 4, train time 15.03 s
Epoch 4/50 |loss: 0.161285| train set 5.008x speedup, test set 0.875x speedup, val set 0.729x speedup, step: 1, train time 14.86 s
Epoch 5/50 |loss: 0.159090| train set 4.958x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 2, train time 14.91 s
Epoch 6/50 |loss: 0.151745| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 3, train time 14.90 s
Epoch 7/50 |loss: 0.148970| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 15.01 s
Epoch 8/50 |loss: 0.150871| train set 4.715x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 5, train time 15.11 s
Epoch 9/50 |loss: 0.148360| train set 4.895x speedup, test set 1.006x speedup, val set 0.729x speedup, step: 1, train time 15.01 s
Epoch 10/50 |loss: 0.144185| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 2, train time 15.11 s
Epoch 11/50 |loss: 0.137942| train set 5.007x speedup, test set 1.036x speedup, val set 0.729x speedup, step: 3, train time 15.11 s
Epoch 12/50 |loss: 0.141430| train set 5.007x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 15.21 s
Epoch 13/50 |loss: 0.138731| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 5, train time 15.00 s
Epoch 14/50 |loss: 0.138482| train set 4.872x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 1, train time 15.03 s
Epoch 15/50 |loss: 0.137293| train set 4.921x speedup, test set 0.972x speedup, val set 0.735x speedup, step: 2, train time 14.99 s
Epoch 16/50 |loss: 0.137376| train set 4.921x speedup, test set 0.967x speedup, val set 0.735x speedup, step: 3, train time 15.02 s
Epoch 17/50 |loss: 0.138550| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 4, train time 15.32 s
Epoch 18/50 |loss: 0.134634| train set 5.008x speedup, test set 0.981x speedup, val set 0.742x speedup, step: 5, train time 15.02 s
Epoch 19/50 |loss: 0.136162| train set 4.958x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 1, train time 14.99 s
Epoch 20/50 |loss: 0.133747| train set 4.921x speedup, test set 1.003x speedup, val set 0.742x speedup, step: 2, train time 15.79 s
Epoch 21/50 |loss: 0.134401| train set 4.873x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 3, train time 14.90 s
Epoch 22/50 |loss: 0.137278| train set 4.921x speedup, test set 0.977x speedup, val set 0.742x speedup, step: 4, train time 15.04 s
Epoch 23/50 |loss: 0.132172| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 5, train time 14.80 s
Epoch 24/50 |loss: 0.131042| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 1, train time 15.03 s
Epoch 25/50 |loss: 0.132724| train set 5.008x speedup, test set 0.981x speedup, val set 0.742x speedup, step: 2, train time 15.02 s
Epoch 26/50 |loss: 0.131049| train set 5.007x speedup, test set 1.001x speedup, val set 0.746x speedup, step: 3, train time 15.03 s
Epoch 27/50 |loss: 0.131762| train set 4.921x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 4, train time 15.03 s
Epoch 28/50 |loss: 0.129736| train set 5.008x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 5, train time 15.02 s
Epoch 29/50 |loss: 0.129298| train set 5.008x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 1, train time 15.11 s
Epoch 30/50 |loss: 0.131171| train set 5.008x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 2, train time 14.92 s
Epoch 31/50 |loss: 0.129701| train set 4.958x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 3, train time 15.03 s
Epoch 32/50 |loss: 0.128019| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 4, train time 15.03 s
Epoch 33/50 |loss: 0.129339| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 5, train time 15.10 s
Epoch 34/50 |loss: 0.127493| train set 5.008x speedup, test set 0.977x speedup, val set 0.742x speedup, step: 1, train time 15.22 s
Epoch 35/50 |loss: 0.129084| train set 5.008x speedup, test set 0.999x speedup, val set 0.733x speedup, step: 2, train time 15.01 s
Epoch 36/50 |loss: 0.128484| train set 5.008x speedup, test set 0.987x speedup, val set 0.733x speedup, step: 3, train time 15.11 s
Epoch 37/50 |loss: 0.128475| train set 4.958x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 4, train time 15.01 s
Epoch 38/50 |loss: 0.130248| train set 4.958x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 5, train time 15.02 s
Epoch 39/50 |loss: 0.129177| train set 5.008x speedup, test set 0.977x speedup, val set 0.742x speedup, step: 1, train time 15.02 s
Epoch 40/50 |loss: 0.125366| train set 4.921x speedup, test set 0.937x speedup, val set 0.735x speedup, step: 2, train time 14.90 s
Epoch 41/50 |loss: 0.126744| train set 5.008x speedup, test set 0.940x speedup, val set 0.729x speedup, step: 3, train time 15.10 s
Epoch 42/50 |loss: 0.126815| train set 4.958x speedup, test set 0.936x speedup, val set 0.729x speedup, step: 4, train time 15.03 s
Epoch 43/50 |loss: 0.127855| train set 4.920x speedup, test set 0.982x speedup, val set 0.804x speedup, step: 5, train time 14.91 s
Epoch 44/50 |loss: 0.128876| train set 4.958x speedup, test set 0.986x speedup, val set 0.733x speedup, step: 6, train time 14.92 s
Epoch 45/50 |loss: 0.128425| train set 5.000x speedup, test set 0.986x speedup, val set 0.735x speedup, step: 7, train time 15.01 s
Epoch 46/50 |loss: 0.128156| train set 4.921x speedup, test set 0.946x speedup, val set 0.729x speedup, step: 8, train time 15.01 s
Epoch 47/50 |loss: 0.125427| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 9, train time 15.00 s
Epoch 48/50 |loss: 0.127247| train set 4.958x speedup, test set 0.937x speedup, val set 0.735x speedup, step: 10, train time 15.12 s
Epoch 49/50 |loss: 0.125946| train set 4.958x speedup, test set 0.937x speedup, val set 0.729x speedup, step: 11, train time 15.03 s
early stopping at epoch 49
Training per epoch cost 15.073 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 11, train speedup 5.007, test speedup 1.036, val speedup 0.729
best validation speedup epoch: 39, train speedup 5.008, test speedup 0.977, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.937, val speedup 0.729
execution cost 0:13:45.043388
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.111286, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336340| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 18.07 s
Epoch 1/50 |loss: 0.208302| train set 4.788x speedup, test set 1.025x speedup, val set 1.033x speedup, step: 2, train time 15.43 s
Epoch 2/50 |loss: 0.180091| train set 4.653x speedup, test set 0.989x speedup, val set 1.063x speedup, step: 3, train time 15.42 s
Epoch 3/50 |loss: 0.171640| train set 5.008x speedup, test set 0.988x speedup, val set 1.000x speedup, step: 4, train time 15.24 s
Epoch 4/50 |loss: 0.160484| train set 5.008x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 1, train time 15.64 s
Epoch 5/50 |loss: 0.155073| train set 4.958x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 2, train time 15.50 s
Epoch 6/50 |loss: 0.151816| train set 5.008x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 3, train time 15.53 s
Epoch 7/50 |loss: 0.147146| train set 5.008x speedup, test set 0.984x speedup, val set 1.000x speedup, step: 4, train time 15.64 s
Epoch 8/50 |loss: 0.150694| train set 4.671x speedup, test set 1.007x speedup, val set 0.981x speedup, step: 5, train time 15.42 s
Epoch 9/50 |loss: 0.147886| train set 5.008x speedup, test set 0.971x speedup, val set 0.738x speedup, step: 1, train time 15.62 s
Epoch 10/50 |loss: 0.142854| train set 5.008x speedup, test set 0.993x speedup, val set 0.742x speedup, step: 2, train time 15.80 s
Epoch 11/50 |loss: 0.138021| train set 5.008x speedup, test set 1.003x speedup, val set 1.000x speedup, step: 3, train time 15.53 s
Epoch 12/50 |loss: 0.140312| train set 5.008x speedup, test set 0.994x speedup, val set 0.991x speedup, step: 4, train time 15.61 s
Epoch 13/50 |loss: 0.137478| train set 5.008x speedup, test set 0.972x speedup, val set 0.762x speedup, step: 5, train time 15.33 s
Epoch 14/50 |loss: 0.136632| train set 4.873x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 1, train time 15.61 s
Epoch 15/50 |loss: 0.137531| train set 4.921x speedup, test set 0.954x speedup, val set 0.742x speedup, step: 2, train time 15.21 s
Epoch 16/50 |loss: 0.137112| train set 4.921x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 3, train time 15.11 s
Epoch 17/50 |loss: 0.137680| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 15.01 s
Epoch 18/50 |loss: 0.134520| train set 5.008x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 5, train time 15.05 s
Epoch 19/50 |loss: 0.135887| train set 4.958x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 1, train time 15.01 s
Epoch 20/50 |loss: 0.134083| train set 4.921x speedup, test set 0.984x speedup, val set 0.742x speedup, step: 2, train time 16.14 s
Epoch 21/50 |loss: 0.134645| train set 4.869x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 3, train time 15.03 s
Epoch 22/50 |loss: 0.136425| train set 4.921x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 4, train time 14.83 s
Epoch 23/50 |loss: 0.132621| train set 5.008x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 5, train time 15.20 s
Epoch 24/50 |loss: 0.130464| train set 4.921x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 6, train time 14.93 s
Epoch 25/50 |loss: 0.131711| train set 5.008x speedup, test set 0.966x speedup, val set 0.786x speedup, step: 7, train time 15.11 s
Epoch 26/50 |loss: 0.131162| train set 5.008x speedup, test set 0.972x speedup, val set 0.746x speedup, step: 8, train time 15.03 s
Epoch 27/50 |loss: 0.132025| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 9, train time 15.11 s
Epoch 28/50 |loss: 0.129243| train set 5.008x speedup, test set 0.972x speedup, val set 0.739x speedup, step: 10, train time 15.02 s
Epoch 29/50 |loss: 0.131628| train set 5.008x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 1, train time 15.13 s
Epoch 30/50 |loss: 0.131909| train set 4.957x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 2, train time 14.82 s
Epoch 31/50 |loss: 0.130127| train set 4.873x speedup, test set 0.984x speedup, val set 0.735x speedup, step: 3, train time 15.13 s
Epoch 32/50 |loss: 0.128327| train set 4.958x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 4, train time 15.02 s
Epoch 33/50 |loss: 0.129653| train set 5.008x speedup, test set 0.972x speedup, val set 0.735x speedup, step: 5, train time 15.03 s
Epoch 34/50 |loss: 0.128321| train set 5.008x speedup, test set 1.003x speedup, val set 0.742x speedup, step: 1, train time 15.29 s
Epoch 35/50 |loss: 0.129662| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 2, train time 15.24 s
Epoch 36/50 |loss: 0.129280| train set 5.008x speedup, test set 0.988x speedup, val set 0.742x speedup, step: 3, train time 15.15 s
Epoch 37/50 |loss: 0.129142| train set 4.958x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 4, train time 15.21 s
Epoch 38/50 |loss: 0.130203| train set 4.958x speedup, test set 0.967x speedup, val set 0.735x speedup, step: 5, train time 15.24 s
Epoch 39/50 |loss: 0.128279| train set 5.008x speedup, test set 0.988x speedup, val set 0.735x speedup, step: 6, train time 15.20 s
Epoch 40/50 |loss: 0.125142| train set 4.921x speedup, test set 0.988x speedup, val set 0.742x speedup, step: 7, train time 15.21 s
Epoch 41/50 |loss: 0.127252| train set 5.008x speedup, test set 0.967x speedup, val set 0.735x speedup, step: 8, train time 15.34 s
Epoch 42/50 |loss: 0.127602| train set 4.958x speedup, test set 0.938x speedup, val set 0.729x speedup, step: 9, train time 15.42 s
Epoch 43/50 |loss: 0.127367| train set 4.917x speedup, test set 0.987x speedup, val set 0.804x speedup, step: 10, train time 15.50 s
Epoch 44/50 |loss: 0.128587| train set 4.958x speedup, test set 0.938x speedup, val set 0.739x speedup, step: 11, train time 15.43 s
Epoch 45/50 |loss: 0.128806| train set 5.000x speedup, test set 0.944x speedup, val set 0.746x speedup, step: 12, train time 15.43 s
Epoch 46/50 |loss: 0.127885| train set 4.921x speedup, test set 0.960x speedup, val set 0.770x speedup, step: 13, train time 15.40 s
Epoch 47/50 |loss: 0.125995| train set 5.008x speedup, test set 0.970x speedup, val set 0.762x speedup, step: 14, train time 15.58 s
Epoch 48/50 |loss: 0.127708| train set 4.958x speedup, test set 0.984x speedup, val set 0.762x speedup, step: 15, train time 15.40 s
Epoch 49/50 |loss: 0.126771| train set 4.958x speedup, test set 0.965x speedup, val set 0.735x speedup, step: 16, train time 15.42 s
early stopping at epoch 49
Training per epoch cost 15.355 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 0.986s, pg runtime 1.357s, speedup 1.377x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 1, train speedup 4.788, test speedup 1.025, val speedup 1.033
best validation speedup epoch: 34, train speedup 5.008, test speedup 1.003, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.965, val speedup 0.735
execution cost 0:14:05.367916
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.102494, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336805| train set 5.007x speedup, test set 0.979x speedup, val set 1.000x speedup, step: 1, train time 18.58 s
Epoch 1/50 |loss: 0.215640| train set 4.486x speedup, test set 0.997x speedup, val set 1.033x speedup, step: 2, train time 16.11 s
Epoch 2/50 |loss: 0.181105| train set 4.638x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 3, train time 15.91 s
Epoch 3/50 |loss: 0.170478| train set 5.008x speedup, test set 0.988x speedup, val set 0.738x speedup, step: 4, train time 15.94 s
Epoch 4/50 |loss: 0.161409| train set 5.008x speedup, test set 0.957x speedup, val set 0.729x speedup, step: 1, train time 15.93 s
Epoch 5/50 |loss: 0.157915| train set 4.873x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 2, train time 16.10 s
Epoch 6/50 |loss: 0.151474| train set 5.008x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 3, train time 16.12 s
Epoch 7/50 |loss: 0.147499| train set 4.921x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 15.72 s
Epoch 8/50 |loss: 0.149529| train set 4.809x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 5, train time 15.74 s
Epoch 9/50 |loss: 0.149334| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 1, train time 15.70 s
Epoch 10/50 |loss: 0.143759| train set 4.921x speedup, test set 0.959x speedup, val set 0.762x speedup, step: 2, train time 15.52 s
Epoch 11/50 |loss: 0.139704| train set 5.007x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 3, train time 15.70 s
Epoch 12/50 |loss: 0.142012| train set 5.008x speedup, test set 0.960x speedup, val set 0.729x speedup, step: 4, train time 15.62 s
Epoch 13/50 |loss: 0.138132| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 5, train time 15.52 s
Epoch 14/50 |loss: 0.137442| train set 4.873x speedup, test set 0.935x speedup, val set 0.729x speedup, step: 1, train time 15.79 s
Epoch 15/50 |loss: 0.137363| train set 4.921x speedup, test set 0.957x speedup, val set 0.742x speedup, step: 2, train time 15.63 s
Epoch 16/50 |loss: 0.136114| train set 5.008x speedup, test set 0.936x speedup, val set 0.742x speedup, step: 3, train time 15.80 s
Epoch 17/50 |loss: 0.135885| train set 5.008x speedup, test set 0.970x speedup, val set 0.729x speedup, step: 4, train time 15.84 s
Epoch 18/50 |loss: 0.133783| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 5, train time 16.08 s
Epoch 19/50 |loss: 0.134922| train set 4.958x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 1, train time 15.83 s
Epoch 20/50 |loss: 0.133237| train set 4.921x speedup, test set 0.954x speedup, val set 0.742x speedup, step: 2, train time 16.93 s
Epoch 21/50 |loss: 0.133866| train set 4.873x speedup, test set 0.957x speedup, val set 0.729x speedup, step: 3, train time 16.01 s
Epoch 22/50 |loss: 0.136505| train set 5.008x speedup, test set 0.954x speedup, val set 0.729x speedup, step: 4, train time 15.92 s
Epoch 23/50 |loss: 0.132612| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 5, train time 15.81 s
Epoch 24/50 |loss: 0.129573| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 1, train time 15.84 s
Epoch 25/50 |loss: 0.131539| train set 5.008x speedup, test set 0.927x speedup, val set 0.742x speedup, step: 2, train time 16.01 s
Epoch 26/50 |loss: 0.131363| train set 5.008x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 3, train time 15.94 s
Epoch 27/50 |loss: 0.132416| train set 4.873x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 16.02 s
Epoch 28/50 |loss: 0.130364| train set 5.008x speedup, test set 0.928x speedup, val set 0.742x speedup, step: 5, train time 15.93 s
Epoch 29/50 |loss: 0.129784| train set 5.008x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 1, train time 15.97 s
Epoch 30/50 |loss: 0.131212| train set 5.008x speedup, test set 0.965x speedup, val set 0.729x speedup, step: 2, train time 15.92 s
Epoch 31/50 |loss: 0.129907| train set 4.873x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 3, train time 15.95 s
Epoch 32/50 |loss: 0.127901| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 4, train time 15.92 s
Epoch 33/50 |loss: 0.128298| train set 5.008x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 5, train time 15.65 s
Epoch 34/50 |loss: 0.128129| train set 5.008x speedup, test set 0.954x speedup, val set 0.742x speedup, step: 1, train time 15.75 s
Epoch 35/50 |loss: 0.129800| train set 5.008x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 2, train time 16.01 s
Epoch 36/50 |loss: 0.128989| train set 5.008x speedup, test set 0.965x speedup, val set 0.742x speedup, step: 3, train time 15.84 s
Epoch 37/50 |loss: 0.128261| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 4, train time 15.94 s
Epoch 38/50 |loss: 0.130200| train set 4.958x speedup, test set 0.926x speedup, val set 0.729x speedup, step: 5, train time 15.83 s
Epoch 39/50 |loss: 0.128530| train set 5.004x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 6, train time 16.06 s
Epoch 40/50 |loss: 0.125215| train set 4.921x speedup, test set 0.944x speedup, val set 0.729x speedup, step: 7, train time 16.00 s
Epoch 41/50 |loss: 0.127088| train set 5.008x speedup, test set 0.915x speedup, val set 0.729x speedup, step: 8, train time 15.63 s
Epoch 42/50 |loss: 0.127592| train set 4.958x speedup, test set 0.906x speedup, val set 0.729x speedup, step: 9, train time 15.93 s
Epoch 43/50 |loss: 0.127157| train set 5.008x speedup, test set 0.952x speedup, val set 0.804x speedup, step: 10, train time 16.13 s
Epoch 44/50 |loss: 0.128383| train set 4.958x speedup, test set 0.914x speedup, val set 0.733x speedup, step: 11, train time 15.96 s
Epoch 45/50 |loss: 0.128229| train set 5.000x speedup, test set 0.916x speedup, val set 0.729x speedup, step: 12, train time 16.03 s
Epoch 46/50 |loss: 0.128198| train set 4.921x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 13, train time 16.03 s
Epoch 47/50 |loss: 0.127024| train set 5.006x speedup, test set 0.965x speedup, val set 0.735x speedup, step: 14, train time 16.02 s
Epoch 48/50 |loss: 0.127207| train set 4.958x speedup, test set 0.970x speedup, val set 0.739x speedup, step: 15, train time 16.19 s
Epoch 49/50 |loss: 0.126499| train set 4.958x speedup, test set 0.964x speedup, val set 0.733x speedup, step: 16, train time 16.04 s
early stopping at epoch 49
Training per epoch cost 15.967 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 4.408s, pg runtime 3.112s, speedup 0.706x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 3, train speedup 5.008, test speedup 0.988, val speedup 0.738
best test speedup epoch: 1, train speedup 4.486, test speedup 0.997, val speedup 1.033
best validation speedup epoch: 34, train speedup 5.008, test speedup 0.954, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.964, val speedup 0.733
execution cost 0:14:41.618098
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.086169, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336560| train set 5.008x speedup, test set 1.004x speedup, val set 1.000x speedup, step: 1, train time 18.81 s
Epoch 1/50 |loss: 0.211926| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 2, train time 16.14 s
Epoch 2/50 |loss: 0.182563| train set 4.638x speedup, test set 0.990x speedup, val set 0.737x speedup, step: 3, train time 16.02 s
Epoch 3/50 |loss: 0.172037| train set 4.958x speedup, test set 1.002x speedup, val set 0.738x speedup, step: 4, train time 16.02 s
Epoch 4/50 |loss: 0.159272| train set 5.008x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 1, train time 15.84 s
Epoch 5/50 |loss: 0.156228| train set 4.958x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 2, train time 15.82 s
Epoch 6/50 |loss: 0.152168| train set 5.008x speedup, test set 1.001x speedup, val set 0.729x speedup, step: 3, train time 16.00 s
Epoch 7/50 |loss: 0.148022| train set 4.921x speedup, test set 0.973x speedup, val set 0.729x speedup, step: 4, train time 15.52 s
Epoch 8/50 |loss: 0.149984| train set 4.715x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 5, train time 15.55 s
Epoch 9/50 |loss: 0.148162| train set 4.895x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 15.64 s
Epoch 10/50 |loss: 0.144006| train set 5.008x speedup, test set 1.014x speedup, val set 0.735x speedup, step: 2, train time 15.72 s
Epoch 11/50 |loss: 0.138989| train set 5.007x speedup, test set 1.013x speedup, val set 0.729x speedup, step: 3, train time 15.61 s
Epoch 12/50 |loss: 0.142625| train set 5.008x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 4, train time 15.85 s
Epoch 13/50 |loss: 0.138221| train set 5.008x speedup, test set 0.958x speedup, val set 0.729x speedup, step: 5, train time 15.73 s
Epoch 14/50 |loss: 0.137971| train set 4.921x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 15.60 s
Epoch 15/50 |loss: 0.137748| train set 4.921x speedup, test set 0.975x speedup, val set 0.742x speedup, step: 2, train time 15.65 s
Epoch 16/50 |loss: 0.137291| train set 4.921x speedup, test set 0.975x speedup, val set 0.742x speedup, step: 3, train time 15.72 s
Epoch 17/50 |loss: 0.136570| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 4, train time 15.82 s
Epoch 18/50 |loss: 0.134738| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 5, train time 15.65 s
Epoch 19/50 |loss: 0.136287| train set 4.958x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 15.93 s
Epoch 20/50 |loss: 0.133774| train set 5.008x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 2, train time 16.79 s
Epoch 21/50 |loss: 0.135647| train set 4.870x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 3, train time 15.90 s
Epoch 22/50 |loss: 0.136861| train set 5.008x speedup, test set 0.995x speedup, val set 0.735x speedup, step: 4, train time 15.73 s
Epoch 23/50 |loss: 0.133142| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 5, train time 15.54 s
Epoch 24/50 |loss: 0.131593| train set 4.921x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 1, train time 15.71 s
Epoch 25/50 |loss: 0.132476| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 2, train time 15.52 s
Epoch 26/50 |loss: 0.131569| train set 5.007x speedup, test set 1.039x speedup, val set 0.733x speedup, step: 3, train time 15.51 s
Epoch 27/50 |loss: 0.131781| train set 4.921x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 15.31 s
Epoch 28/50 |loss: 0.129792| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 5, train time 15.11 s
Epoch 29/50 |loss: 0.129849| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 1, train time 15.04 s
Epoch 30/50 |loss: 0.131472| train set 5.008x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 2, train time 15.09 s
Epoch 31/50 |loss: 0.130891| train set 4.958x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 3, train time 15.13 s
Epoch 32/50 |loss: 0.128823| train set 4.958x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 4, train time 15.10 s
Epoch 33/50 |loss: 0.130449| train set 5.008x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 5, train time 15.02 s
Epoch 34/50 |loss: 0.128864| train set 5.008x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 1, train time 15.03 s
Epoch 35/50 |loss: 0.130208| train set 5.008x speedup, test set 1.004x speedup, val set 0.729x speedup, step: 2, train time 15.09 s
Epoch 36/50 |loss: 0.130410| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 3, train time 14.92 s
Epoch 37/50 |loss: 0.129724| train set 4.958x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 4, train time 15.01 s
Epoch 38/50 |loss: 0.130657| train set 4.958x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 5, train time 15.03 s
Epoch 39/50 |loss: 0.130015| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 1, train time 15.04 s
Epoch 40/50 |loss: 0.126597| train set 4.921x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 2, train time 15.10 s
Epoch 41/50 |loss: 0.128009| train set 5.008x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 3, train time 14.92 s
Epoch 42/50 |loss: 0.127726| train set 4.958x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 4, train time 15.10 s
Epoch 43/50 |loss: 0.127467| train set 4.919x speedup, test set 1.008x speedup, val set 0.804x speedup, step: 5, train time 15.12 s
Epoch 44/50 |loss: 0.128947| train set 4.958x speedup, test set 0.992x speedup, val set 0.733x speedup, step: 1, train time 15.19 s
Epoch 45/50 |loss: 0.129615| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 2, train time 14.93 s
Epoch 46/50 |loss: 0.126954| train set 4.921x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 3, train time 15.12 s
Epoch 47/50 |loss: 0.126323| train set 5.008x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 4, train time 14.93 s
Epoch 48/50 |loss: 0.127850| train set 4.958x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 5, train time 15.02 s
Epoch 49/50 |loss: 0.126384| train set 4.958x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 6, train time 14.92 s
Training per epoch cost 15.513 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.004, val speedup 1.000
best test speedup epoch: 26, train speedup 5.007, test speedup 1.039, val speedup 0.733
best validation speedup epoch: 44, train speedup 4.958, test speedup 0.992, val speedup 0.733
last model at epoch 49, train speedup 4.958, test speedup 0.992, val speedup 0.729
execution cost 0:14:14.628193
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.066896, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 18.64 s
Epoch 1/50 |loss: 0.206187| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 15.82 s
Epoch 2/50 |loss: 0.182581| train set 4.638x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 3, train time 15.82 s
Epoch 3/50 |loss: 0.171637| train set 5.007x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 4, train time 15.81 s
Epoch 4/50 |loss: 0.161146| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 1, train time 15.93 s
Epoch 5/50 |loss: 0.158243| train set 4.958x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 2, train time 15.71 s
Epoch 6/50 |loss: 0.153647| train set 5.008x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 3, train time 15.74 s
Epoch 7/50 |loss: 0.148654| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 4, train time 15.84 s
Epoch 8/50 |loss: 0.149003| train set 4.700x speedup, test set 1.037x speedup, val set 0.729x speedup, step: 5, train time 15.90 s
Epoch 9/50 |loss: 0.149170| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 1, train time 16.02 s
Epoch 10/50 |loss: 0.143806| train set 5.008x speedup, test set 1.039x speedup, val set 0.729x speedup, step: 2, train time 15.81 s
Epoch 11/50 |loss: 0.138421| train set 5.007x speedup, test set 1.025x speedup, val set 0.729x speedup, step: 3, train time 15.83 s
Epoch 12/50 |loss: 0.142220| train set 5.007x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 4, train time 16.10 s
Epoch 13/50 |loss: 0.139050| train set 4.988x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 5, train time 15.54 s
Epoch 14/50 |loss: 0.137085| train set 4.917x speedup, test set 1.002x speedup, val set 0.742x speedup, step: 1, train time 15.46 s
Epoch 15/50 |loss: 0.137047| train set 4.921x speedup, test set 1.025x speedup, val set 0.742x speedup, step: 2, train time 15.50 s
Epoch 16/50 |loss: 0.136734| train set 4.921x speedup, test set 0.981x speedup, val set 0.762x speedup, step: 3, train time 15.45 s
Epoch 17/50 |loss: 0.136699| train set 5.008x speedup, test set 1.025x speedup, val set 0.729x speedup, step: 4, train time 15.52 s
Epoch 18/50 |loss: 0.134953| train set 5.008x speedup, test set 1.002x speedup, val set 0.742x speedup, step: 5, train time 15.70 s
Epoch 19/50 |loss: 0.136726| train set 5.008x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 6, train time 15.54 s
Epoch 20/50 |loss: 0.133802| train set 4.921x speedup, test set 1.015x speedup, val set 0.809x speedup, step: 7, train time 16.73 s
Epoch 21/50 |loss: 0.133969| train set 4.873x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 8, train time 15.62 s
Epoch 22/50 |loss: 0.136137| train set 5.008x speedup, test set 1.003x speedup, val set 0.762x speedup, step: 9, train time 15.30 s
Epoch 23/50 |loss: 0.132099| train set 5.008x speedup, test set 1.007x speedup, val set 0.746x speedup, step: 10, train time 15.63 s
Epoch 24/50 |loss: 0.130336| train set 5.008x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 11, train time 15.42 s
Epoch 25/50 |loss: 0.132119| train set 5.008x speedup, test set 1.025x speedup, val set 0.762x speedup, step: 12, train time 15.73 s
Epoch 26/50 |loss: 0.131700| train set 5.008x speedup, test set 1.025x speedup, val set 0.739x speedup, step: 13, train time 15.83 s
Epoch 27/50 |loss: 0.130859| train set 4.873x speedup, test set 1.003x speedup, val set 0.733x speedup, step: 14, train time 15.53 s
Epoch 28/50 |loss: 0.129729| train set 5.008x speedup, test set 0.993x speedup, val set 0.767x speedup, step: 15, train time 15.62 s
Epoch 29/50 |loss: 0.131091| train set 4.921x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16, train time 15.52 s
Epoch 30/50 |loss: 0.131708| train set 5.008x speedup, test set 1.003x speedup, val set 0.746x speedup, step: 17, train time 15.72 s
Epoch 31/50 |loss: 0.130411| train set 4.958x speedup, test set 0.993x speedup, val set 0.742x speedup, step: 18, train time 15.61 s
Epoch 32/50 |loss: 0.127753| train set 5.004x speedup, test set 0.992x speedup, val set 0.742x speedup, step: 19, train time 15.73 s
Epoch 33/50 |loss: 0.128195| train set 5.008x speedup, test set 1.015x speedup, val set 0.729x speedup, step: 20, train time 15.63 s
Epoch 34/50 |loss: 0.127300| train set 5.008x speedup, test set 1.013x speedup, val set 0.735x speedup, step: 21, train time 15.52 s
Epoch 35/50 |loss: 0.129293| train set 5.008x speedup, test set 1.037x speedup, val set 0.735x speedup, step: 22, train time 15.61 s
Epoch 36/50 |loss: 0.128317| train set 5.008x speedup, test set 1.052x speedup, val set 0.809x speedup, step: 23, train time 15.70 s
Epoch 37/50 |loss: 0.128863| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 24, train time 15.65 s
Epoch 38/50 |loss: 0.130780| train set 4.958x speedup, test set 0.992x speedup, val set 0.742x speedup, step: 25, train time 15.71 s
Epoch 39/50 |loss: 0.128602| train set 5.008x speedup, test set 1.016x speedup, val set 0.735x speedup, step: 26, train time 15.46 s
Epoch 40/50 |loss: 0.125115| train set 5.008x speedup, test set 0.979x speedup, val set 0.746x speedup, step: 27, train time 15.52 s
Epoch 41/50 |loss: 0.126373| train set 4.921x speedup, test set 0.990x speedup, val set 0.733x speedup, step: 28, train time 15.45 s
Epoch 42/50 |loss: 0.126817| train set 4.958x speedup, test set 0.990x speedup, val set 0.733x speedup, step: 29, train time 15.62 s
Epoch 43/50 |loss: 0.126282| train set 4.917x speedup, test set 1.003x speedup, val set 0.791x speedup, step: 30, train time 15.51 s
Epoch 44/50 |loss: 0.127443| train set 4.958x speedup, test set 0.990x speedup, val set 0.733x speedup, step: 31, train time 15.64 s
Epoch 45/50 |loss: 0.128590| train set 5.008x speedup, test set 0.990x speedup, val set 0.746x speedup, step: 32, train time 15.60 s
Epoch 46/50 |loss: 0.127993| train set 4.921x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 33, train time 15.53 s
Epoch 47/50 |loss: 0.126266| train set 5.008x speedup, test set 1.000x speedup, val set 0.739x speedup, step: 34, train time 15.65 s
Epoch 48/50 |loss: 0.128401| train set 4.958x speedup, test set 1.001x speedup, val set 0.746x speedup, step: 35, train time 15.60 s
Epoch 49/50 |loss: 0.126827| train set 4.958x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 36, train time 15.64 s
early stopping at epoch 49
Training per epoch cost 15.734 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 36, train speedup 5.008, test speedup 1.052, val speedup 0.809
best validation speedup epoch: 14, train speedup 4.917, test speedup 1.002, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.991, val speedup 0.733
execution cost 0:14:28.403572
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.016741, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 18.59 s
Epoch 1/50 |loss: 0.206117| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 16.10 s
Epoch 2/50 |loss: 0.181031| train set 4.715x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 3, train time 15.85 s
Epoch 3/50 |loss: 0.171963| train set 5.007x speedup, test set 1.012x speedup, val set 0.973x speedup, step: 4, train time 15.84 s
Epoch 4/50 |loss: 0.161813| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 1, train time 15.81 s
Epoch 5/50 |loss: 0.156754| train set 4.958x speedup, test set 1.011x speedup, val set 0.729x speedup, step: 2, train time 15.92 s
Epoch 6/50 |loss: 0.151951| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 3, train time 15.83 s
Epoch 7/50 |loss: 0.147562| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 15.93 s
Epoch 8/50 |loss: 0.151102| train set 4.988x speedup, test set 0.997x speedup, val set 0.973x speedup, step: 5, train time 15.95 s
Epoch 9/50 |loss: 0.147876| train set 4.895x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 1, train time 15.94 s
Epoch 10/50 |loss: 0.144641| train set 4.921x speedup, test set 1.013x speedup, val set 0.729x speedup, step: 2, train time 15.72 s
Epoch 11/50 |loss: 0.138304| train set 5.007x speedup, test set 1.037x speedup, val set 0.729x speedup, step: 3, train time 15.84 s
Epoch 12/50 |loss: 0.141479| train set 5.008x speedup, test set 1.016x speedup, val set 0.729x speedup, step: 4, train time 15.94 s
Epoch 13/50 |loss: 0.138596| train set 5.008x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 5, train time 16.00 s
Epoch 14/50 |loss: 0.137997| train set 4.872x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 1, train time 16.00 s
Epoch 15/50 |loss: 0.137996| train set 4.921x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 2, train time 15.93 s
Epoch 16/50 |loss: 0.137188| train set 4.921x speedup, test set 0.976x speedup, val set 0.762x speedup, step: 3, train time 15.93 s
Epoch 17/50 |loss: 0.136992| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 15.82 s
Epoch 18/50 |loss: 0.134916| train set 5.008x speedup, test set 0.980x speedup, val set 0.735x speedup, step: 5, train time 15.25 s
Epoch 19/50 |loss: 0.136332| train set 4.958x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 1, train time 15.82 s
Epoch 20/50 |loss: 0.134285| train set 4.921x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 2, train time 16.70 s
Epoch 21/50 |loss: 0.134706| train set 4.873x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 3, train time 15.42 s
Epoch 22/50 |loss: 0.136894| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 4, train time 15.71 s
Epoch 23/50 |loss: 0.132605| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 5, train time 15.52 s
Epoch 24/50 |loss: 0.129615| train set 4.921x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 1, train time 15.80 s
Epoch 25/50 |loss: 0.131899| train set 4.958x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 2, train time 15.58 s
Epoch 26/50 |loss: 0.132014| train set 5.008x speedup, test set 0.959x speedup, val set 0.742x speedup, step: 3, train time 15.53 s
Epoch 27/50 |loss: 0.131761| train set 4.921x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 4, train time 15.62 s
Epoch 28/50 |loss: 0.129478| train set 5.008x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 5, train time 15.52 s
Epoch 29/50 |loss: 0.129335| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 15.63 s
Epoch 30/50 |loss: 0.131901| train set 5.007x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 2, train time 15.44 s
Epoch 31/50 |loss: 0.130281| train set 4.958x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 3, train time 15.65 s
Epoch 32/50 |loss: 0.127952| train set 5.008x speedup, test set 0.949x speedup, val set 0.742x speedup, step: 4, train time 15.54 s
Epoch 33/50 |loss: 0.129376| train set 5.008x speedup, test set 0.968x speedup, val set 0.735x speedup, step: 5, train time 15.54 s
Epoch 34/50 |loss: 0.127873| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 1, train time 15.44 s
Epoch 35/50 |loss: 0.128688| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 2, train time 15.51 s
Epoch 36/50 |loss: 0.128672| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 3, train time 15.50 s
Epoch 37/50 |loss: 0.128082| train set 4.921x speedup, test set 0.977x speedup, val set 0.804x speedup, step: 4, train time 15.70 s
Epoch 38/50 |loss: 0.130053| train set 4.958x speedup, test set 0.950x speedup, val set 0.735x speedup, step: 5, train time 15.72 s
Epoch 39/50 |loss: 0.128324| train set 5.008x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 1, train time 15.54 s
Epoch 40/50 |loss: 0.125002| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 2, train time 15.98 s
Epoch 41/50 |loss: 0.126096| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 3, train time 15.70 s
Epoch 42/50 |loss: 0.127462| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 4, train time 15.93 s
Epoch 43/50 |loss: 0.126456| train set 4.917x speedup, test set 0.976x speedup, val set 0.742x speedup, step: 5, train time 15.93 s
Epoch 44/50 |loss: 0.126357| train set 4.958x speedup, test set 0.976x speedup, val set 0.733x speedup, step: 6, train time 15.92 s
Epoch 45/50 |loss: 0.127524| train set 5.000x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 7, train time 15.69 s
Epoch 46/50 |loss: 0.127602| train set 4.921x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 8, train time 15.72 s
Epoch 47/50 |loss: 0.125620| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 9, train time 15.42 s
Epoch 48/50 |loss: 0.127552| train set 4.958x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 10, train time 15.71 s
Epoch 49/50 |loss: 0.125651| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 11, train time 15.61 s
early stopping at epoch 49
Training per epoch cost 15.805 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 11, train speedup 5.007, test speedup 1.037, val speedup 0.729
best validation speedup epoch: 39, train speedup 5.008, test speedup 0.976, val speedup 0.735
last model at epoch 49, train speedup 4.958, test speedup 0.979, val speedup 0.729
execution cost 0:14:32.328044
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:01.116579, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336391| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 18.13 s
Epoch 1/50 |loss: 0.208386| train set 4.865x speedup, test set 0.997x speedup, val set 1.033x speedup, step: 2, train time 15.61 s
Epoch 2/50 |loss: 0.180223| train set 4.715x speedup, test set 0.943x speedup, val set 1.000x speedup, step: 3, train time 15.31 s
Epoch 3/50 |loss: 0.170634| train set 5.007x speedup, test set 1.012x speedup, val set 0.973x speedup, step: 4, train time 15.52 s
Epoch 4/50 |loss: 0.160518| train set 5.008x speedup, test set 0.969x speedup, val set 0.729x speedup, step: 1, train time 15.60 s
Epoch 5/50 |loss: 0.157351| train set 4.958x speedup, test set 1.011x speedup, val set 1.033x speedup, step: 2, train time 15.20 s
Epoch 6/50 |loss: 0.152694| train set 5.008x speedup, test set 0.999x speedup, val set 0.740x speedup, step: 3, train time 15.50 s
Epoch 7/50 |loss: 0.146938| train set 4.921x speedup, test set 0.972x speedup, val set 1.000x speedup, step: 4, train time 15.43 s
Epoch 8/50 |loss: 0.149064| train set 4.538x speedup, test set 1.001x speedup, val set 0.985x speedup, step: 5, train time 15.43 s
Epoch 9/50 |loss: 0.147089| train set 5.002x speedup, test set 0.972x speedup, val set 0.735x speedup, step: 1, train time 15.30 s
Epoch 10/50 |loss: 0.141964| train set 4.921x speedup, test set 0.980x speedup, val set 0.738x speedup, step: 2, train time 15.51 s
Epoch 11/50 |loss: 0.137880| train set 5.007x speedup, test set 1.009x speedup, val set 0.786x speedup, step: 3, train time 15.37 s
Epoch 12/50 |loss: 0.141952| train set 5.007x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 4, train time 15.44 s
Epoch 13/50 |loss: 0.138026| train set 5.008x speedup, test set 0.967x speedup, val set 0.735x speedup, step: 5, train time 15.50 s
Epoch 14/50 |loss: 0.136383| train set 4.873x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 1, train time 15.32 s
Epoch 15/50 |loss: 0.136523| train set 4.921x speedup, test set 0.988x speedup, val set 0.786x speedup, step: 2, train time 15.43 s
Epoch 16/50 |loss: 0.136070| train set 4.921x speedup, test set 0.970x speedup, val set 0.786x speedup, step: 3, train time 15.32 s
Epoch 17/50 |loss: 0.136242| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 4, train time 15.44 s
Epoch 18/50 |loss: 0.133453| train set 5.008x speedup, test set 0.992x speedup, val set 0.742x speedup, step: 5, train time 15.64 s
Epoch 19/50 |loss: 0.136597| train set 4.958x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 6, train time 15.52 s
Epoch 20/50 |loss: 0.133373| train set 4.921x speedup, test set 0.967x speedup, val set 0.804x speedup, step: 7, train time 16.43 s
Epoch 21/50 |loss: 0.134383| train set 4.868x speedup, test set 1.010x speedup, val set 0.742x speedup, step: 8, train time 15.61 s
Epoch 22/50 |loss: 0.136881| train set 4.921x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 9, train time 15.50 s
Epoch 23/50 |loss: 0.132628| train set 5.008x speedup, test set 0.983x speedup, val set 0.735x speedup, step: 10, train time 15.65 s
Epoch 24/50 |loss: 0.129232| train set 4.921x speedup, test set 0.984x speedup, val set 0.733x speedup, step: 11, train time 15.61 s
Epoch 25/50 |loss: 0.131627| train set 5.008x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 12, train time 15.49 s
Epoch 26/50 |loss: 0.131385| train set 5.007x speedup, test set 1.003x speedup, val set 0.746x speedup, step: 13, train time 15.52 s
Epoch 27/50 |loss: 0.131255| train set 4.873x speedup, test set 1.000x speedup, val set 0.746x speedup, step: 14, train time 15.60 s
Epoch 28/50 |loss: 0.129149| train set 5.008x speedup, test set 0.981x speedup, val set 0.767x speedup, step: 15, train time 15.52 s
Epoch 29/50 |loss: 0.129034| train set 5.008x speedup, test set 0.981x speedup, val set 0.733x speedup, step: 16, train time 15.62 s
Epoch 30/50 |loss: 0.130640| train set 5.007x speedup, test set 1.003x speedup, val set 0.735x speedup, step: 17, train time 15.51 s
Epoch 31/50 |loss: 0.129620| train set 4.958x speedup, test set 0.981x speedup, val set 0.735x speedup, step: 18, train time 15.50 s
Epoch 32/50 |loss: 0.127386| train set 5.008x speedup, test set 0.981x speedup, val set 0.742x speedup, step: 19, train time 15.52 s
Epoch 33/50 |loss: 0.128324| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 20, train time 15.62 s
Epoch 34/50 |loss: 0.127808| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 1, train time 15.64 s
Epoch 35/50 |loss: 0.128709| train set 5.008x speedup, test set 0.981x speedup, val set 0.733x speedup, step: 2, train time 15.40 s
Epoch 36/50 |loss: 0.128035| train set 5.008x speedup, test set 1.003x speedup, val set 0.746x speedup, step: 3, train time 15.64 s
Epoch 37/50 |loss: 0.129159| train set 4.958x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 4, train time 15.54 s
Epoch 38/50 |loss: 0.129613| train set 4.958x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 5, train time 15.71 s
early stopping at epoch 38
Training per epoch cost 15.594 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 3, train speedup 5.007, test speedup 1.012, val speedup 0.973
best validation speedup epoch: 34, train speedup 5.008, test speedup 0.978, val speedup 0.742
last model at epoch 38, train speedup 4.958, test speedup 0.950, val speedup 0.729
execution cost 0:11:14.511523
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.601051, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 13.99 s
Epoch 1/50 |loss: 0.206336| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 12.91 s
Epoch 2/50 |loss: 0.179305| train set 4.638x speedup, test set 1.014x speedup, val set 0.729x speedup, step: 3, train time 12.71 s
Epoch 3/50 |loss: 0.172552| train set 5.008x speedup, test set 0.994x speedup, val set 0.779x speedup, step: 4, train time 12.80 s
Epoch 4/50 |loss: 0.161752| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 1, train time 12.71 s
Epoch 5/50 |loss: 0.157481| train set 4.958x speedup, test set 1.016x speedup, val set 0.729x speedup, step: 2, train time 13.11 s
Epoch 6/50 |loss: 0.152891| train set 5.008x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 3, train time 13.00 s
Epoch 7/50 |loss: 0.148442| train set 4.921x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 4, train time 12.92 s
Epoch 8/50 |loss: 0.150561| train set 5.008x speedup, test set 0.994x speedup, val set 0.735x speedup, step: 5, train time 12.92 s
Epoch 9/50 |loss: 0.148516| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 1, train time 12.79 s
Epoch 10/50 |loss: 0.142985| train set 5.008x speedup, test set 1.015x speedup, val set 0.729x speedup, step: 2, train time 13.18 s
Epoch 11/50 |loss: 0.138602| train set 5.007x speedup, test set 1.034x speedup, val set 0.729x speedup, step: 3, train time 12.70 s
Epoch 12/50 |loss: 0.141295| train set 5.008x speedup, test set 1.009x speedup, val set 0.729x speedup, step: 4, train time 12.69 s
Epoch 13/50 |loss: 0.138453| train set 5.008x speedup, test set 0.972x speedup, val set 0.735x speedup, step: 5, train time 12.90 s
Epoch 14/50 |loss: 0.137598| train set 4.872x speedup, test set 0.998x speedup, val set 0.742x speedup, step: 1, train time 13.12 s
Epoch 15/50 |loss: 0.137391| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 2, train time 12.99 s
Epoch 16/50 |loss: 0.135975| train set 4.921x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 3, train time 12.89 s
Epoch 17/50 |loss: 0.136602| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 13.02 s
Epoch 18/50 |loss: 0.134521| train set 4.920x speedup, test set 1.022x speedup, val set 0.762x speedup, step: 5, train time 13.11 s
Epoch 19/50 |loss: 0.135553| train set 4.958x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 6, train time 12.61 s
Epoch 20/50 |loss: 0.134608| train set 4.921x speedup, test set 1.010x speedup, val set 0.742x speedup, step: 7, train time 13.41 s
Epoch 21/50 |loss: 0.132915| train set 4.873x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 8, train time 12.90 s
Epoch 22/50 |loss: 0.135931| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 9, train time 12.80 s
Epoch 23/50 |loss: 0.132526| train set 5.008x speedup, test set 0.995x speedup, val set 0.735x speedup, step: 10, train time 12.89 s
Epoch 24/50 |loss: 0.130602| train set 4.921x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 11, train time 12.91 s
Epoch 25/50 |loss: 0.131556| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 12, train time 13.03 s
Epoch 26/50 |loss: 0.130933| train set 5.008x speedup, test set 1.038x speedup, val set 0.746x speedup, step: 13, train time 12.80 s
Epoch 27/50 |loss: 0.131648| train set 4.873x speedup, test set 1.034x speedup, val set 0.746x speedup, step: 14, train time 12.81 s
Epoch 28/50 |loss: 0.130332| train set 5.008x speedup, test set 0.989x speedup, val set 0.746x speedup, step: 15, train time 12.70 s
Epoch 29/50 |loss: 0.130662| train set 5.008x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 16, train time 12.80 s
Epoch 30/50 |loss: 0.130403| train set 5.008x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 17, train time 12.89 s
Epoch 31/50 |loss: 0.130252| train set 4.958x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 18, train time 13.31 s
Epoch 32/50 |loss: 0.127513| train set 5.008x speedup, test set 0.989x speedup, val set 0.746x speedup, step: 19, train time 12.70 s
Epoch 33/50 |loss: 0.129102| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 20, train time 12.61 s
Epoch 34/50 |loss: 0.127721| train set 5.008x speedup, test set 0.989x speedup, val set 0.739x speedup, step: 21, train time 12.82 s
Epoch 35/50 |loss: 0.127932| train set 5.008x speedup, test set 1.034x speedup, val set 0.733x speedup, step: 22, train time 12.62 s
Epoch 36/50 |loss: 0.128723| train set 5.008x speedup, test set 0.989x speedup, val set 0.739x speedup, step: 23, train time 12.93 s
Epoch 37/50 |loss: 0.128855| train set 4.958x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 24, train time 12.82 s
Epoch 38/50 |loss: 0.129608| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 25, train time 13.13 s
Epoch 39/50 |loss: 0.127474| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 26, train time 12.89 s
Epoch 40/50 |loss: 0.124254| train set 4.921x speedup, test set 0.989x speedup, val set 0.739x speedup, step: 27, train time 12.62 s
Epoch 41/50 |loss: 0.126197| train set 5.008x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 28, train time 13.00 s
Epoch 42/50 |loss: 0.126246| train set 4.958x speedup, test set 0.988x speedup, val set 0.733x speedup, step: 29, train time 13.08 s
Epoch 43/50 |loss: 0.126167| train set 5.003x speedup, test set 0.989x speedup, val set 0.800x speedup, step: 30, train time 12.90 s
Epoch 44/50 |loss: 0.126790| train set 4.958x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 31, train time 12.73 s
Epoch 45/50 |loss: 0.127931| train set 5.008x speedup, test set 0.988x speedup, val set 0.739x speedup, step: 32, train time 12.80 s
Epoch 46/50 |loss: 0.126268| train set 4.921x speedup, test set 0.988x speedup, val set 0.733x speedup, step: 33, train time 12.92 s
Epoch 47/50 |loss: 0.125536| train set 5.004x speedup, test set 0.988x speedup, val set 0.739x speedup, step: 34, train time 12.81 s
Epoch 48/50 |loss: 0.127468| train set 4.958x speedup, test set 1.010x speedup, val set 0.746x speedup, step: 35, train time 12.69 s
Epoch 49/50 |loss: 0.125506| train set 4.958x speedup, test set 0.992x speedup, val set 0.733x speedup, step: 36, train time 12.90 s
early stopping at epoch 49
Training per epoch cost 12.906 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 26, train speedup 5.008, test speedup 1.038, val speedup 0.746
best validation speedup epoch: 14, train speedup 4.872, test speedup 0.998, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.992, val speedup 0.733
execution cost 0:11:24.870972
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.587971, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 13.68 s
Epoch 1/50 |loss: 0.206309| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 12.92 s
Epoch 2/50 |loss: 0.177496| train set 4.715x speedup, test set 1.012x speedup, val set 1.000x speedup, step: 3, train time 12.91 s
Epoch 3/50 |loss: 0.172388| train set 5.008x speedup, test set 1.008x speedup, val set 1.001x speedup, step: 4, train time 13.00 s
Epoch 4/50 |loss: 0.162022| train set 5.008x speedup, test set 0.976x speedup, val set 0.738x speedup, step: 1, train time 12.79 s
Epoch 5/50 |loss: 0.155563| train set 4.873x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 2, train time 12.88 s
Epoch 6/50 |loss: 0.151936| train set 5.008x speedup, test set 0.998x speedup, val set 0.738x speedup, step: 3, train time 12.79 s
Epoch 7/50 |loss: 0.149306| train set 4.921x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 12.52 s
Epoch 8/50 |loss: 0.150054| train set 4.714x speedup, test set 0.994x speedup, val set 1.001x speedup, step: 5, train time 12.81 s
Epoch 9/50 |loss: 0.148789| train set 5.008x speedup, test set 0.997x speedup, val set 0.738x speedup, step: 1, train time 12.69 s
Epoch 10/50 |loss: 0.144853| train set 4.921x speedup, test set 0.972x speedup, val set 0.762x speedup, step: 2, train time 12.50 s
Epoch 11/50 |loss: 0.139489| train set 5.007x speedup, test set 1.013x speedup, val set 0.973x speedup, step: 3, train time 12.92 s
Epoch 12/50 |loss: 0.143706| train set 5.007x speedup, test set 0.975x speedup, val set 1.000x speedup, step: 4, train time 12.83 s
Epoch 13/50 |loss: 0.139639| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 5, train time 12.89 s
Epoch 14/50 |loss: 0.138381| train set 4.873x speedup, test set 0.986x speedup, val set 0.742x speedup, step: 1, train time 12.99 s
Epoch 15/50 |loss: 0.137990| train set 4.921x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 2, train time 12.79 s
Epoch 16/50 |loss: 0.136649| train set 4.921x speedup, test set 0.977x speedup, val set 0.804x speedup, step: 3, train time 12.91 s
Epoch 17/50 |loss: 0.136731| train set 5.008x speedup, test set 1.018x speedup, val set 0.738x speedup, step: 4, train time 12.91 s
Epoch 18/50 |loss: 0.134531| train set 5.008x speedup, test set 1.002x speedup, val set 0.742x speedup, step: 5, train time 12.93 s
Epoch 19/50 |loss: 0.135726| train set 5.008x speedup, test set 0.983x speedup, val set 0.742x speedup, step: 1, train time 12.82 s
Epoch 20/50 |loss: 0.134203| train set 5.008x speedup, test set 0.999x speedup, val set 0.804x speedup, step: 2, train time 13.68 s
Epoch 21/50 |loss: 0.136359| train set 4.873x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 3, train time 12.97 s
Epoch 22/50 |loss: 0.135788| train set 5.008x speedup, test set 0.971x speedup, val set 0.762x speedup, step: 4, train time 12.82 s
Epoch 23/50 |loss: 0.133035| train set 5.008x speedup, test set 0.983x speedup, val set 0.739x speedup, step: 5, train time 12.71 s
Epoch 24/50 |loss: 0.131265| train set 4.921x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 6, train time 12.62 s
Epoch 25/50 |loss: 0.131713| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 7, train time 13.08 s
Epoch 26/50 |loss: 0.131369| train set 5.007x speedup, test set 0.998x speedup, val set 0.739x speedup, step: 8, train time 12.80 s
Epoch 27/50 |loss: 0.131960| train set 4.873x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 9, train time 12.89 s
Epoch 28/50 |loss: 0.129772| train set 5.008x speedup, test set 0.977x speedup, val set 0.746x speedup, step: 10, train time 12.60 s
Epoch 29/50 |loss: 0.131257| train set 5.008x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 11, train time 13.19 s
Epoch 30/50 |loss: 0.131647| train set 5.008x speedup, test set 0.967x speedup, val set 0.739x speedup, step: 12, train time 12.82 s
Epoch 31/50 |loss: 0.131633| train set 4.958x speedup, test set 0.972x speedup, val set 0.735x speedup, step: 13, train time 12.60 s
Epoch 32/50 |loss: 0.127801| train set 4.958x speedup, test set 0.977x speedup, val set 0.742x speedup, step: 14, train time 13.11 s
Epoch 33/50 |loss: 0.128848| train set 5.008x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 15, train time 12.33 s
Epoch 34/50 |loss: 0.127881| train set 5.008x speedup, test set 0.977x speedup, val set 0.746x speedup, step: 1, train time 12.81 s
Epoch 35/50 |loss: 0.129156| train set 5.008x speedup, test set 0.983x speedup, val set 0.733x speedup, step: 2, train time 12.07 s
Epoch 36/50 |loss: 0.128070| train set 5.008x speedup, test set 0.983x speedup, val set 0.746x speedup, step: 3, train time 12.70 s
Epoch 37/50 |loss: 0.128650| train set 4.958x speedup, test set 0.983x speedup, val set 0.733x speedup, step: 4, train time 12.31 s
Epoch 38/50 |loss: 0.129931| train set 4.958x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 5, train time 12.90 s
Epoch 39/50 |loss: 0.128638| train set 5.008x speedup, test set 0.976x speedup, val set 0.742x speedup, step: 6, train time 12.39 s
Epoch 40/50 |loss: 0.125025| train set 4.921x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 7, train time 12.72 s
Epoch 41/50 |loss: 0.126327| train set 5.008x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 8, train time 13.00 s
Epoch 42/50 |loss: 0.126855| train set 4.958x speedup, test set 0.976x speedup, val set 0.733x speedup, step: 9, train time 13.13 s
Epoch 43/50 |loss: 0.126142| train set 4.916x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 10, train time 13.20 s
Epoch 44/50 |loss: 0.127386| train set 4.958x speedup, test set 0.983x speedup, val set 0.733x speedup, step: 11, train time 12.40 s
Epoch 45/50 |loss: 0.128029| train set 5.008x speedup, test set 0.976x speedup, val set 0.739x speedup, step: 12, train time 12.70 s
Epoch 46/50 |loss: 0.128055| train set 4.921x speedup, test set 0.964x speedup, val set 0.746x speedup, step: 13, train time 12.81 s
Epoch 47/50 |loss: 0.125497| train set 5.008x speedup, test set 0.977x speedup, val set 0.746x speedup, step: 14, train time 12.91 s
Epoch 48/50 |loss: 0.127326| train set 4.958x speedup, test set 0.978x speedup, val set 0.746x speedup, step: 15, train time 13.10 s
Epoch 49/50 |loss: 0.125999| train set 4.958x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 16, train time 12.92 s
early stopping at epoch 49
Training per epoch cost 12.835 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 1, train speedup 4.864, test speedup 1.020, val speedup 1.033
best validation speedup epoch: 34, train speedup 5.008, test speedup 0.977, val speedup 0.746
last model at epoch 49, train speedup 4.958, test speedup 0.977, val speedup 0.733
execution cost 0:11:22.765494
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.653884, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 14.19 s
Epoch 1/50 |loss: 0.206309| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 13.11 s
Epoch 2/50 |loss: 0.177454| train set 4.715x speedup, test set 1.012x speedup, val set 0.983x speedup, step: 3, train time 12.79 s
Epoch 3/50 |loss: 0.171946| train set 5.007x speedup, test set 0.998x speedup, val set 1.063x speedup, step: 4, train time 12.90 s
Epoch 4/50 |loss: 0.162240| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 1, train time 13.09 s
Epoch 5/50 |loss: 0.158355| train set 4.958x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 2, train time 12.59 s
Epoch 6/50 |loss: 0.151861| train set 5.008x speedup, test set 1.016x speedup, val set 0.729x speedup, step: 3, train time 13.03 s
Epoch 7/50 |loss: 0.148512| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 12.92 s
Epoch 8/50 |loss: 0.150554| train set 5.008x speedup, test set 1.006x speedup, val set 0.988x speedup, step: 5, train time 12.80 s
Epoch 9/50 |loss: 0.148927| train set 5.008x speedup, test set 1.006x speedup, val set 0.735x speedup, step: 1, train time 12.63 s
Epoch 10/50 |loss: 0.143146| train set 5.004x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 2, train time 12.91 s
Epoch 11/50 |loss: 0.137836| train set 5.007x speedup, test set 1.013x speedup, val set 0.729x speedup, step: 3, train time 12.51 s
Epoch 12/50 |loss: 0.142028| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 12.71 s
Epoch 13/50 |loss: 0.138539| train set 5.008x speedup, test set 0.971x speedup, val set 0.735x speedup, step: 5, train time 12.40 s
Epoch 14/50 |loss: 0.136652| train set 4.873x speedup, test set 0.984x speedup, val set 0.742x speedup, step: 1, train time 12.71 s
Epoch 15/50 |loss: 0.136076| train set 4.921x speedup, test set 0.981x speedup, val set 0.735x speedup, step: 2, train time 12.81 s
Epoch 16/50 |loss: 0.135569| train set 4.921x speedup, test set 0.978x speedup, val set 0.786x speedup, step: 3, train time 12.62 s
Epoch 17/50 |loss: 0.135606| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 12.62 s
Epoch 18/50 |loss: 0.135709| train set 5.008x speedup, test set 1.000x speedup, val set 0.742x speedup, step: 5, train time 12.70 s
Epoch 19/50 |loss: 0.135143| train set 4.958x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 6, train time 12.71 s
Epoch 20/50 |loss: 0.134754| train set 5.008x speedup, test set 0.996x speedup, val set 0.786x speedup, step: 7, train time 13.37 s
Epoch 21/50 |loss: 0.134536| train set 4.873x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 8, train time 12.89 s
Epoch 22/50 |loss: 0.135307| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 9, train time 12.80 s
Epoch 23/50 |loss: 0.133117| train set 5.008x speedup, test set 1.000x speedup, val set 0.742x speedup, step: 10, train time 13.01 s
Epoch 24/50 |loss: 0.131034| train set 5.008x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 11, train time 12.80 s
Epoch 25/50 |loss: 0.131588| train set 5.008x speedup, test set 0.975x speedup, val set 0.742x speedup, step: 12, train time 12.89 s
Epoch 26/50 |loss: 0.131135| train set 5.007x speedup, test set 1.034x speedup, val set 0.746x speedup, step: 13, train time 12.92 s
Epoch 27/50 |loss: 0.131270| train set 4.873x speedup, test set 1.011x speedup, val set 0.735x speedup, step: 14, train time 12.62 s
Epoch 28/50 |loss: 0.129249| train set 5.008x speedup, test set 0.988x speedup, val set 0.746x speedup, step: 15, train time 12.40 s
Epoch 29/50 |loss: 0.130525| train set 5.008x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 16, train time 13.01 s
Epoch 30/50 |loss: 0.131943| train set 5.008x speedup, test set 0.973x speedup, val set 0.733x speedup, step: 17, train time 13.01 s
Epoch 31/50 |loss: 0.129476| train set 4.958x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 18, train time 12.92 s
Epoch 32/50 |loss: 0.127394| train set 5.004x speedup, test set 0.986x speedup, val set 0.742x speedup, step: 19, train time 12.79 s
Epoch 33/50 |loss: 0.129185| train set 5.008x speedup, test set 0.973x speedup, val set 0.729x speedup, step: 20, train time 12.90 s
Epoch 34/50 |loss: 0.126923| train set 5.008x speedup, test set 0.986x speedup, val set 0.742x speedup, step: 1, train time 12.52 s
Epoch 35/50 |loss: 0.128742| train set 5.008x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 2, train time 12.68 s
Epoch 36/50 |loss: 0.129133| train set 5.008x speedup, test set 1.024x speedup, val set 0.809x speedup, step: 3, train time 13.00 s
Epoch 37/50 |loss: 0.128193| train set 4.917x speedup, test set 0.988x speedup, val set 0.735x speedup, step: 4, train time 12.49 s
Epoch 38/50 |loss: 0.129476| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 5, train time 12.72 s
Epoch 39/50 |loss: 0.128748| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 6, train time 12.80 s
Epoch 40/50 |loss: 0.124993| train set 4.921x speedup, test set 0.973x speedup, val set 0.746x speedup, step: 7, train time 12.90 s
Epoch 41/50 |loss: 0.126372| train set 5.008x speedup, test set 0.986x speedup, val set 0.733x speedup, step: 8, train time 13.01 s
Epoch 42/50 |loss: 0.126693| train set 4.958x speedup, test set 0.946x speedup, val set 0.733x speedup, step: 9, train time 13.11 s
Epoch 43/50 |loss: 0.127011| train set 4.917x speedup, test set 0.975x speedup, val set 0.804x speedup, step: 10, train time 12.51 s
Epoch 44/50 |loss: 0.127500| train set 4.958x speedup, test set 0.987x speedup, val set 0.733x speedup, step: 11, train time 12.89 s
Epoch 45/50 |loss: 0.128313| train set 5.000x speedup, test set 0.986x speedup, val set 0.739x speedup, step: 12, train time 12.71 s
Epoch 46/50 |loss: 0.126698| train set 4.921x speedup, test set 0.972x speedup, val set 0.733x speedup, step: 13, train time 12.61 s
Epoch 47/50 |loss: 0.124983| train set 5.008x speedup, test set 0.987x speedup, val set 0.746x speedup, step: 14, train time 12.20 s
Epoch 48/50 |loss: 0.126970| train set 4.958x speedup, test set 0.987x speedup, val set 0.746x speedup, step: 15, train time 13.01 s
Epoch 49/50 |loss: 0.125753| train set 4.958x speedup, test set 0.986x speedup, val set 0.733x speedup, step: 16, train time 12.70 s
early stopping at epoch 49
Training per epoch cost 12.818 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
13, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
14, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
15, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 26, train speedup 5.007, test speedup 1.034, val speedup 0.746
best validation speedup epoch: 34, train speedup 5.008, test speedup 0.986, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.986, val speedup 0.733
execution cost 0:11:19.277221
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.693606, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.338957| train set 4.674x speedup, test set 1.011x speedup, val set 1.000x speedup, step: 1, train time 14.30 s
Epoch 1/50 |loss: 0.215926| train set 4.652x speedup, test set 1.009x speedup, val set 1.033x speedup, step: 2, train time 13.00 s
Epoch 2/50 |loss: 0.182931| train set 4.715x speedup, test set 0.968x speedup, val set 1.000x speedup, step: 3, train time 12.80 s
Epoch 3/50 |loss: 0.172694| train set 5.008x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 4, train time 12.81 s
Epoch 4/50 |loss: 0.160918| train set 4.921x speedup, test set 0.946x speedup, val set 0.729x speedup, step: 1, train time 13.01 s
Epoch 5/50 |loss: 0.159181| train set 4.958x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 2, train time 12.62 s
Epoch 6/50 |loss: 0.153659| train set 5.008x speedup, test set 1.009x speedup, val set 0.729x speedup, step: 3, train time 12.80 s
Epoch 7/50 |loss: 0.150319| train set 5.008x speedup, test set 0.968x speedup, val set 0.729x speedup, step: 4, train time 12.92 s
Epoch 8/50 |loss: 0.149633| train set 4.715x speedup, test set 1.011x speedup, val set 0.729x speedup, step: 5, train time 12.99 s
Epoch 9/50 |loss: 0.149720| train set 5.008x speedup, test set 1.011x speedup, val set 0.729x speedup, step: 1, train time 12.68 s
Epoch 10/50 |loss: 0.143630| train set 5.005x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 2, train time 12.69 s
Epoch 11/50 |loss: 0.138411| train set 5.007x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 3, train time 13.00 s
Epoch 12/50 |loss: 0.142368| train set 5.008x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 4, train time 12.82 s
Epoch 13/50 |loss: 0.139075| train set 5.008x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 5, train time 12.79 s
Epoch 14/50 |loss: 0.138372| train set 4.873x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 1, train time 12.70 s
Epoch 15/50 |loss: 0.137990| train set 4.921x speedup, test set 0.988x speedup, val set 0.735x speedup, step: 2, train time 12.72 s
Epoch 16/50 |loss: 0.137342| train set 4.921x speedup, test set 0.943x speedup, val set 0.762x speedup, step: 3, train time 12.81 s
Epoch 17/50 |loss: 0.136924| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 4, train time 12.70 s
Epoch 18/50 |loss: 0.135131| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 5, train time 12.88 s
Epoch 19/50 |loss: 0.136387| train set 4.709x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 1, train time 12.79 s
Epoch 20/50 |loss: 0.134516| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 2, train time 13.49 s
Epoch 21/50 |loss: 0.135634| train set 4.873x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 3, train time 12.99 s
Epoch 22/50 |loss: 0.136529| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 4, train time 12.71 s
Epoch 23/50 |loss: 0.133660| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 5, train time 12.49 s
Epoch 24/50 |loss: 0.130701| train set 4.921x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 1, train time 13.11 s
Epoch 25/50 |loss: 0.132628| train set 5.008x speedup, test set 0.968x speedup, val set 0.742x speedup, step: 2, train time 12.82 s
Epoch 26/50 |loss: 0.131361| train set 5.008x speedup, test set 0.988x speedup, val set 0.735x speedup, step: 3, train time 13.11 s
Epoch 27/50 |loss: 0.132162| train set 4.873x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 12.88 s
Epoch 28/50 |loss: 0.129810| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 5, train time 12.90 s
Epoch 29/50 |loss: 0.132371| train set 5.008x speedup, test set 0.940x speedup, val set 0.729x speedup, step: 1, train time 13.11 s
Epoch 30/50 |loss: 0.131239| train set 5.007x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 2, train time 12.78 s
Epoch 31/50 |loss: 0.130648| train set 4.958x speedup, test set 0.951x speedup, val set 0.735x speedup, step: 3, train time 12.73 s
Epoch 32/50 |loss: 0.127695| train set 5.008x speedup, test set 0.970x speedup, val set 0.742x speedup, step: 4, train time 12.81 s
Epoch 33/50 |loss: 0.129853| train set 5.008x speedup, test set 0.970x speedup, val set 0.729x speedup, step: 5, train time 13.02 s
Epoch 34/50 |loss: 0.127803| train set 4.753x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 1, train time 12.68 s
Epoch 35/50 |loss: 0.130421| train set 5.008x speedup, test set 1.016x speedup, val set 0.729x speedup, step: 2, train time 12.71 s
Epoch 36/50 |loss: 0.129917| train set 5.008x speedup, test set 0.939x speedup, val set 0.729x speedup, step: 3, train time 12.29 s
Epoch 37/50 |loss: 0.130652| train set 4.958x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 4, train time 12.87 s
early stopping at epoch 37
Training per epoch cost 12.878 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 3, train speedup 5.008, test speedup 0.998, val speedup 0.729
best test speedup epoch: 35, train speedup 5.008, test speedup 1.016, val speedup 0.729
best validation speedup epoch: 34, train speedup 4.753, test speedup 0.991, val speedup 0.735
last model at epoch 37, train speedup 4.958, test speedup 0.975, val speedup 0.729
execution cost 0:08:39.801970
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.649902, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336333| train set 5.008x speedup, test set 0.995x speedup, val set 1.008x speedup, step: 1, train time 13.85 s
Epoch 1/50 |loss: 0.206989| train set 4.272x speedup, test set 1.023x speedup, val set 0.973x speedup, step: 2, train time 12.72 s
Epoch 2/50 |loss: 0.180265| train set 4.715x speedup, test set 1.010x speedup, val set 1.000x speedup, step: 3, train time 12.79 s
Epoch 3/50 |loss: 0.170874| train set 5.007x speedup, test set 0.980x speedup, val set 1.000x speedup, step: 4, train time 12.72 s
Epoch 4/50 |loss: 0.162270| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 1, train time 12.72 s
Epoch 5/50 |loss: 0.157980| train set 4.631x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 2, train time 12.82 s
Epoch 6/50 |loss: 0.151696| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 3, train time 12.69 s
Epoch 7/50 |loss: 0.147347| train set 4.921x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 13.09 s
Epoch 8/50 |loss: 0.149086| train set 4.538x speedup, test set 0.988x speedup, val set 0.735x speedup, step: 5, train time 12.49 s
Epoch 9/50 |loss: 0.148926| train set 5.008x speedup, test set 0.970x speedup, val set 0.735x speedup, step: 1, train time 12.74 s
Epoch 10/50 |loss: 0.142321| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 2, train time 13.08 s
Epoch 11/50 |loss: 0.137120| train set 5.008x speedup, test set 1.006x speedup, val set 0.738x speedup, step: 3, train time 13.08 s
Epoch 12/50 |loss: 0.140200| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 13.10 s
Epoch 13/50 |loss: 0.138952| train set 5.008x speedup, test set 0.984x speedup, val set 0.742x speedup, step: 5, train time 13.09 s
Epoch 14/50 |loss: 0.135672| train set 4.873x speedup, test set 0.965x speedup, val set 0.742x speedup, step: 1, train time 12.79 s
Epoch 15/50 |loss: 0.136940| train set 4.921x speedup, test set 0.992x speedup, val set 0.742x speedup, step: 2, train time 12.69 s
Epoch 16/50 |loss: 0.136279| train set 4.921x speedup, test set 0.968x speedup, val set 0.742x speedup, step: 3, train time 12.51 s
Epoch 17/50 |loss: 0.135251| train set 5.008x speedup, test set 1.016x speedup, val set 0.729x speedup, step: 4, train time 12.80 s
Epoch 18/50 |loss: 0.133758| train set 5.008x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 5, train time 12.68 s
Epoch 19/50 |loss: 0.135356| train set 4.958x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 6, train time 12.60 s
Epoch 20/50 |loss: 0.134000| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 7, train time 13.41 s
Epoch 21/50 |loss: 0.135258| train set 4.867x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 8, train time 12.92 s
Epoch 22/50 |loss: 0.135550| train set 4.921x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 9, train time 12.91 s
Epoch 23/50 |loss: 0.131926| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 10, train time 12.89 s
Epoch 24/50 |loss: 0.129329| train set 4.921x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 11, train time 12.52 s
Epoch 25/50 |loss: 0.130741| train set 5.008x speedup, test set 0.980x speedup, val set 0.742x speedup, step: 12, train time 12.30 s
Epoch 26/50 |loss: 0.131045| train set 5.008x speedup, test set 0.993x speedup, val set 0.739x speedup, step: 13, train time 12.82 s
Epoch 27/50 |loss: 0.131184| train set 4.873x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 14, train time 12.71 s
Epoch 28/50 |loss: 0.129651| train set 5.008x speedup, test set 0.979x speedup, val set 0.746x speedup, step: 15, train time 12.91 s
Epoch 29/50 |loss: 0.128932| train set 5.008x speedup, test set 0.968x speedup, val set 0.742x speedup, step: 1, train time 12.91 s
Epoch 30/50 |loss: 0.131693| train set 5.008x speedup, test set 0.993x speedup, val set 0.739x speedup, step: 2, train time 12.80 s
Epoch 31/50 |loss: 0.128407| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 3, train time 12.52 s
Epoch 32/50 |loss: 0.126951| train set 5.008x speedup, test set 0.993x speedup, val set 0.742x speedup, step: 4, train time 12.29 s
Epoch 33/50 |loss: 0.128105| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 5, train time 12.11 s
Epoch 34/50 |loss: 0.126924| train set 5.008x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 6, train time 12.92 s
Epoch 35/50 |loss: 0.129848| train set 5.008x speedup, test set 1.003x speedup, val set 0.733x speedup, step: 7, train time 12.60 s
Epoch 36/50 |loss: 0.128733| train set 5.008x speedup, test set 0.986x speedup, val set 0.746x speedup, step: 8, train time 12.50 s
Epoch 37/50 |loss: 0.128606| train set 4.917x speedup, test set 0.992x speedup, val set 0.804x speedup, step: 9, train time 12.41 s
Epoch 38/50 |loss: 0.130308| train set 4.958x speedup, test set 0.948x speedup, val set 0.729x speedup, step: 10, train time 12.79 s
Epoch 39/50 |loss: 0.127468| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 11, train time 12.49 s
Epoch 40/50 |loss: 0.124340| train set 5.008x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 12, train time 12.82 s
Epoch 41/50 |loss: 0.126109| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 13, train time 12.61 s
Epoch 42/50 |loss: 0.126429| train set 5.008x speedup, test set 0.948x speedup, val set 0.729x speedup, step: 14, train time 12.50 s
Epoch 43/50 |loss: 0.125604| train set 4.917x speedup, test set 0.979x speedup, val set 0.804x speedup, step: 15, train time 12.91 s
Epoch 44/50 |loss: 0.127794| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 16, train time 12.32 s
Epoch 45/50 |loss: 0.127644| train set 5.008x speedup, test set 0.992x speedup, val set 0.735x speedup, step: 17, train time 12.89 s
Epoch 46/50 |loss: 0.127151| train set 4.921x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 18, train time 12.72 s
Epoch 47/50 |loss: 0.125926| train set 5.004x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 19, train time 12.89 s
Epoch 48/50 |loss: 0.127182| train set 4.958x speedup, test set 0.993x speedup, val set 0.742x speedup, step: 20, train time 12.90 s
Epoch 49/50 |loss: 0.125281| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 21, train time 12.80 s
early stopping at epoch 49
Training per epoch cost 12.763 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 4.408s, pg runtime 3.112s, speedup 0.706x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 0.995, val speedup 1.008
best test speedup epoch: 1, train speedup 4.272, test speedup 1.023, val speedup 0.973
best validation speedup epoch: 29, train speedup 5.008, test speedup 0.968, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.979, val speedup 0.729
execution cost 0:11:18.421487
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.666601, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 13.85 s
Epoch 1/50 |loss: 0.206187| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 12.89 s
Epoch 2/50 |loss: 0.181984| train set 4.638x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 3, train time 12.61 s
Epoch 3/50 |loss: 0.170349| train set 5.008x speedup, test set 0.998x speedup, val set 1.033x speedup, step: 4, train time 13.30 s
Epoch 4/50 |loss: 0.162163| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 1, train time 12.19 s
Epoch 5/50 |loss: 0.158087| train set 4.958x speedup, test set 1.000x speedup, val set 0.729x speedup, step: 2, train time 12.49 s
Epoch 6/50 |loss: 0.150913| train set 5.008x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 3, train time 12.60 s
Epoch 7/50 |loss: 0.148736| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 13.10 s
Epoch 8/50 |loss: 0.150301| train set 4.715x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 5, train time 13.09 s
Epoch 9/50 |loss: 0.149651| train set 5.008x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 1, train time 12.60 s
Epoch 10/50 |loss: 0.143560| train set 5.008x speedup, test set 0.972x speedup, val set 0.735x speedup, step: 2, train time 13.12 s
Epoch 11/50 |loss: 0.138318| train set 5.007x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 3, train time 12.69 s
Epoch 12/50 |loss: 0.141071| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 12.51 s
Epoch 13/50 |loss: 0.138110| train set 5.008x speedup, test set 0.959x speedup, val set 0.742x speedup, step: 5, train time 12.62 s
Epoch 14/50 |loss: 0.137179| train set 4.873x speedup, test set 0.972x speedup, val set 0.735x speedup, step: 1, train time 12.75 s
Epoch 15/50 |loss: 0.137437| train set 4.921x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 2, train time 12.53 s
Epoch 16/50 |loss: 0.135819| train set 5.008x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 3, train time 12.80 s
Epoch 17/50 |loss: 0.137182| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 4, train time 12.70 s
Epoch 18/50 |loss: 0.133764| train set 5.008x speedup, test set 0.977x speedup, val set 0.742x speedup, step: 5, train time 12.89 s
Epoch 19/50 |loss: 0.136059| train set 4.958x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 6, train time 12.30 s
Epoch 20/50 |loss: 0.133947| train set 4.921x speedup, test set 1.003x speedup, val set 0.762x speedup, step: 7, train time 13.62 s
Epoch 21/50 |loss: 0.134338| train set 4.869x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 8, train time 13.02 s
Epoch 22/50 |loss: 0.135751| train set 4.921x speedup, test set 0.977x speedup, val set 0.786x speedup, step: 9, train time 12.40 s
Epoch 23/50 |loss: 0.132661| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 10, train time 12.98 s
Epoch 24/50 |loss: 0.130027| train set 5.008x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 11, train time 12.68 s
Epoch 25/50 |loss: 0.131905| train set 5.008x speedup, test set 0.977x speedup, val set 0.762x speedup, step: 12, train time 12.70 s
Epoch 26/50 |loss: 0.131378| train set 5.007x speedup, test set 0.977x speedup, val set 0.809x speedup, step: 13, train time 12.80 s
Epoch 27/50 |loss: 0.130819| train set 4.873x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 14, train time 12.60 s
Epoch 28/50 |loss: 0.129160| train set 5.008x speedup, test set 0.977x speedup, val set 0.746x speedup, step: 15, train time 12.62 s
Epoch 29/50 |loss: 0.128994| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 1, train time 12.63 s
Epoch 30/50 |loss: 0.131485| train set 5.008x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 2, train time 12.40 s
Epoch 31/50 |loss: 0.130383| train set 4.958x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 3, train time 12.61 s
Epoch 32/50 |loss: 0.127289| train set 5.008x speedup, test set 0.977x speedup, val set 0.786x speedup, step: 4, train time 12.69 s
Epoch 33/50 |loss: 0.128854| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 5, train time 12.90 s
Epoch 34/50 |loss: 0.126661| train set 5.008x speedup, test set 0.948x speedup, val set 0.742x speedup, step: 1, train time 12.32 s
Epoch 35/50 |loss: 0.129341| train set 5.008x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 2, train time 12.29 s
Epoch 36/50 |loss: 0.128709| train set 5.008x speedup, test set 0.967x speedup, val set 0.809x speedup, step: 3, train time 12.50 s
Epoch 37/50 |loss: 0.129039| train set 4.958x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 4, train time 12.60 s
Epoch 38/50 |loss: 0.130153| train set 4.958x speedup, test set 0.948x speedup, val set 0.742x speedup, step: 5, train time 12.63 s
early stopping at epoch 38
Training per epoch cost 12.734 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 7.660s, pg runtime 3.549s, speedup 0.463x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 1, train speedup 4.864, test speedup 1.020, val speedup 1.033
best validation speedup epoch: 34, train speedup 5.008, test speedup 0.948, val speedup 0.742
last model at epoch 38, train speedup 4.958, test speedup 0.948, val speedup 0.742
execution cost 0:08:47.416414
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.623397, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336516| train set 5.008x speedup, test set 0.997x speedup, val set 1.008x speedup, step: 1, train time 13.82 s
Epoch 1/50 |loss: 0.205426| train set 4.864x speedup, test set 1.025x speedup, val set 1.033x speedup, step: 2, train time 12.72 s
Epoch 2/50 |loss: 0.179630| train set 4.671x speedup, test set 0.903x speedup, val set 0.973x speedup, step: 3, train time 12.71 s
Epoch 3/50 |loss: 0.171515| train set 5.007x speedup, test set 0.994x speedup, val set 1.000x speedup, step: 4, train time 12.80 s
Epoch 4/50 |loss: 0.161546| train set 5.008x speedup, test set 1.001x speedup, val set 0.740x speedup, step: 1, train time 12.49 s
Epoch 5/50 |loss: 0.157738| train set 4.958x speedup, test set 1.000x speedup, val set 0.729x speedup, step: 2, train time 12.59 s
Epoch 6/50 |loss: 0.152599| train set 5.008x speedup, test set 0.979x speedup, val set 0.738x speedup, step: 3, train time 12.63 s
Epoch 7/50 |loss: 0.148036| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 12.41 s
Epoch 8/50 |loss: 0.148543| train set 4.538x speedup, test set 0.994x speedup, val set 0.738x speedup, step: 5, train time 12.90 s
Epoch 9/50 |loss: 0.147788| train set 5.004x speedup, test set 0.959x speedup, val set 0.742x speedup, step: 1, train time 12.90 s
Epoch 10/50 |loss: 0.143743| train set 4.921x speedup, test set 0.967x speedup, val set 0.735x speedup, step: 2, train time 12.91 s
Epoch 11/50 |loss: 0.139136| train set 5.007x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 3, train time 12.80 s
Epoch 12/50 |loss: 0.142708| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 4, train time 12.99 s
Epoch 13/50 |loss: 0.137419| train set 5.008x speedup, test set 0.958x speedup, val set 0.742x speedup, step: 5, train time 12.72 s
Epoch 14/50 |loss: 0.138335| train set 4.873x speedup, test set 0.965x speedup, val set 0.735x speedup, step: 6, train time 12.20 s
Epoch 15/50 |loss: 0.137876| train set 4.921x speedup, test set 0.952x speedup, val set 0.762x speedup, step: 7, train time 12.53 s
Epoch 16/50 |loss: 0.136879| train set 4.921x speedup, test set 0.967x speedup, val set 0.762x speedup, step: 8, train time 12.91 s
Epoch 17/50 |loss: 0.136080| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 9, train time 12.52 s
Epoch 18/50 |loss: 0.134073| train set 5.008x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 10, train time 12.69 s
Epoch 19/50 |loss: 0.135855| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 11, train time 12.72 s
Epoch 20/50 |loss: 0.133451| train set 4.921x speedup, test set 0.970x speedup, val set 0.742x speedup, step: 12, train time 13.50 s
Epoch 21/50 |loss: 0.135020| train set 4.873x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 13, train time 12.92 s
Epoch 22/50 |loss: 0.136865| train set 4.921x speedup, test set 0.972x speedup, val set 0.735x speedup, step: 14, train time 12.79 s
Epoch 23/50 |loss: 0.132421| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 15, train time 12.99 s
Epoch 24/50 |loss: 0.129800| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 16, train time 13.00 s
Epoch 25/50 |loss: 0.132103| train set 5.008x speedup, test set 0.965x speedup, val set 0.742x speedup, step: 17, train time 13.00 s
Epoch 26/50 |loss: 0.130584| train set 5.003x speedup, test set 0.952x speedup, val set 0.733x speedup, step: 18, train time 12.20 s
Epoch 27/50 |loss: 0.130708| train set 4.873x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 19, train time 12.81 s
Epoch 28/50 |loss: 0.127986| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 20, train time 12.62 s
Epoch 29/50 |loss: 0.131890| train set 5.008x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 21, train time 12.51 s
Epoch 30/50 |loss: 0.132302| train set 5.007x speedup, test set 0.957x speedup, val set 0.742x speedup, step: 22, train time 12.41 s
Epoch 31/50 |loss: 0.129165| train set 4.958x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 23, train time 13.01 s
Epoch 32/50 |loss: 0.127277| train set 5.008x speedup, test set 0.977x speedup, val set 0.742x speedup, step: 24, train time 12.81 s
Epoch 33/50 |loss: 0.128687| train set 5.008x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 25, train time 12.79 s
Epoch 34/50 |loss: 0.126715| train set 5.008x speedup, test set 0.975x speedup, val set 0.735x speedup, step: 26, train time 12.92 s
Epoch 35/50 |loss: 0.129130| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 27, train time 12.81 s
Epoch 36/50 |loss: 0.128229| train set 5.007x speedup, test set 0.961x speedup, val set 0.762x speedup, step: 28, train time 13.01 s
Epoch 37/50 |loss: 0.127812| train set 4.958x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 29, train time 12.60 s
Epoch 38/50 |loss: 0.129578| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 30, train time 12.42 s
Epoch 39/50 |loss: 0.128086| train set 5.008x speedup, test set 0.951x speedup, val set 0.742x speedup, step: 1, train time 12.69 s
Epoch 40/50 |loss: 0.125163| train set 4.921x speedup, test set 0.962x speedup, val set 0.729x speedup, step: 2, train time 12.61 s
Epoch 41/50 |loss: 0.126474| train set 5.008x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 3, train time 12.22 s
Epoch 42/50 |loss: 0.126197| train set 4.958x speedup, test set 0.964x speedup, val set 0.735x speedup, step: 4, train time 12.73 s
Epoch 43/50 |loss: 0.126393| train set 4.917x speedup, test set 0.962x speedup, val set 0.762x speedup, step: 5, train time 12.90 s
Epoch 44/50 |loss: 0.126863| train set 4.958x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 6, train time 12.82 s
Epoch 45/50 |loss: 0.127290| train set 5.008x speedup, test set 0.962x speedup, val set 0.742x speedup, step: 7, train time 13.09 s
Epoch 46/50 |loss: 0.126782| train set 4.921x speedup, test set 0.951x speedup, val set 0.735x speedup, step: 8, train time 12.82 s
Epoch 47/50 |loss: 0.125133| train set 4.991x speedup, test set 0.951x speedup, val set 0.742x speedup, step: 9, train time 12.63 s
Epoch 48/50 |loss: 0.127365| train set 4.958x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 10, train time 12.50 s
Epoch 49/50 |loss: 0.124903| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 11, train time 12.57 s
Training per epoch cost 12.753 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 7.179s, pg runtime 5.855s, speedup 0.816x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 0.997, val speedup 1.008
best test speedup epoch: 1, train speedup 4.864, test speedup 1.025, val speedup 1.033
best validation speedup epoch: 39, train speedup 5.008, test speedup 0.951, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.963, val speedup 0.729
execution cost 0:11:16.656838
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.619894, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 14.17 s
Epoch 1/50 |loss: 0.205916| train set 5.007x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 13.09 s
Epoch 2/50 |loss: 0.179013| train set 4.715x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 3, train time 13.20 s
Epoch 3/50 |loss: 0.169244| train set 5.007x speedup, test set 0.980x speedup, val set 0.983x speedup, step: 4, train time 13.41 s
Epoch 4/50 |loss: 0.160447| train set 5.008x speedup, test set 0.960x speedup, val set 0.729x speedup, step: 1, train time 13.07 s
Epoch 5/50 |loss: 0.158103| train set 4.958x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 2, train time 12.70 s
Epoch 6/50 |loss: 0.153109| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 3, train time 13.10 s
Epoch 7/50 |loss: 0.148296| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 12.68 s
Epoch 8/50 |loss: 0.150191| train set 4.715x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 5, train time 12.61 s
Epoch 9/50 |loss: 0.148338| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 1, train time 12.52 s
Epoch 10/50 |loss: 0.144050| train set 4.921x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 2, train time 12.57 s
Epoch 11/50 |loss: 0.139131| train set 5.007x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 3, train time 12.89 s
Epoch 12/50 |loss: 0.141942| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 4, train time 13.02 s
Epoch 13/50 |loss: 0.137877| train set 5.008x speedup, test set 0.971x speedup, val set 0.729x speedup, step: 5, train time 12.69 s
Epoch 14/50 |loss: 0.137212| train set 4.870x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 1, train time 13.21 s
Epoch 15/50 |loss: 0.136707| train set 4.921x speedup, test set 0.965x speedup, val set 0.742x speedup, step: 2, train time 13.12 s
Epoch 16/50 |loss: 0.136067| train set 4.921x speedup, test set 0.965x speedup, val set 0.735x speedup, step: 3, train time 12.69 s
Epoch 17/50 |loss: 0.135718| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 4, train time 12.91 s
Epoch 18/50 |loss: 0.134791| train set 5.008x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 5, train time 12.99 s
Epoch 19/50 |loss: 0.135460| train set 4.958x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 1, train time 12.90 s
Epoch 20/50 |loss: 0.133041| train set 4.921x speedup, test set 1.003x speedup, val set 0.742x speedup, step: 2, train time 13.97 s
Epoch 21/50 |loss: 0.133358| train set 4.873x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 3, train time 12.73 s
Epoch 22/50 |loss: 0.135722| train set 5.008x speedup, test set 0.965x speedup, val set 0.762x speedup, step: 4, train time 12.69 s
Epoch 23/50 |loss: 0.132005| train set 5.008x speedup, test set 0.965x speedup, val set 0.729x speedup, step: 5, train time 13.12 s
Epoch 24/50 |loss: 0.130396| train set 4.921x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 1, train time 12.33 s
Epoch 25/50 |loss: 0.130863| train set 5.008x speedup, test set 0.976x speedup, val set 0.742x speedup, step: 2, train time 11.91 s
Epoch 26/50 |loss: 0.131648| train set 5.007x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 3, train time 9.89 s
Epoch 27/50 |loss: 0.130565| train set 4.873x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 4, train time 10.09 s
Epoch 28/50 |loss: 0.129321| train set 5.008x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 5, train time 9.90 s
Epoch 29/50 |loss: 0.131070| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 1, train time 10.09 s
Epoch 30/50 |loss: 0.130571| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 2, train time 9.88 s
Epoch 31/50 |loss: 0.129291| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 3, train time 10.00 s
Epoch 32/50 |loss: 0.126064| train set 5.004x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 4, train time 10.00 s
Epoch 33/50 |loss: 0.127981| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 5, train time 10.09 s
Epoch 34/50 |loss: 0.127276| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 9.82 s
Epoch 35/50 |loss: 0.128440| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 2, train time 9.90 s
Epoch 36/50 |loss: 0.129801| train set 5.008x speedup, test set 0.978x speedup, val set 0.746x speedup, step: 3, train time 9.91 s
Epoch 37/50 |loss: 0.129856| train set 4.958x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 4, train time 10.00 s
early stopping at epoch 37
Training per epoch cost 11.996 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 1, train speedup 5.007, test speedup 1.020, val speedup 1.033
best validation speedup epoch: 34, train speedup 5.008, test speedup 0.976, val speedup 0.729
last model at epoch 37, train speedup 4.958, test speedup 0.977, val speedup 0.729
execution cost 0:08:04.262361
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.602305, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336619| train set 4.808x speedup, test set 1.005x speedup, val set 1.008x speedup, step: 1, train time 11.12 s
Epoch 1/50 |loss: 0.205765| train set 5.007x speedup, test set 0.997x speedup, val set 0.729x speedup, step: 2, train time 10.30 s
Epoch 2/50 |loss: 0.178369| train set 4.715x speedup, test set 0.981x speedup, val set 0.983x speedup, step: 3, train time 9.71 s
Epoch 3/50 |loss: 0.171807| train set 5.008x speedup, test set 0.994x speedup, val set 1.000x speedup, step: 4, train time 9.79 s
Epoch 4/50 |loss: 0.162227| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 1, train time 10.21 s
Epoch 5/50 |loss: 0.155875| train set 4.958x speedup, test set 1.002x speedup, val set 0.729x speedup, step: 2, train time 9.61 s
Epoch 6/50 |loss: 0.153376| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 3, train time 10.18 s
Epoch 7/50 |loss: 0.147925| train set 4.921x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 4, train time 10.41 s
Epoch 8/50 |loss: 0.149958| train set 5.008x speedup, test set 1.003x speedup, val set 0.973x speedup, step: 5, train time 10.02 s
Epoch 9/50 |loss: 0.148410| train set 5.008x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 1, train time 9.92 s
Epoch 10/50 |loss: 0.143855| train set 5.008x speedup, test set 0.976x speedup, val set 0.762x speedup, step: 2, train time 9.98 s
Epoch 11/50 |loss: 0.139576| train set 5.007x speedup, test set 1.022x speedup, val set 1.000x speedup, step: 3, train time 10.09 s
Epoch 12/50 |loss: 0.142427| train set 5.008x speedup, test set 0.997x speedup, val set 0.983x speedup, step: 4, train time 10.20 s
Epoch 13/50 |loss: 0.139069| train set 5.008x speedup, test set 0.971x speedup, val set 0.742x speedup, step: 5, train time 9.98 s
Epoch 14/50 |loss: 0.138339| train set 4.920x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 1, train time 9.71 s
Epoch 15/50 |loss: 0.138065| train set 4.921x speedup, test set 0.986x speedup, val set 0.742x speedup, step: 2, train time 10.10 s
Epoch 16/50 |loss: 0.137337| train set 4.921x speedup, test set 0.970x speedup, val set 0.786x speedup, step: 3, train time 9.81 s
Epoch 17/50 |loss: 0.137214| train set 5.008x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 4, train time 10.02 s
Epoch 18/50 |loss: 0.134374| train set 5.007x speedup, test set 0.995x speedup, val set 0.735x speedup, step: 5, train time 10.00 s
Epoch 19/50 |loss: 0.136070| train set 5.008x speedup, test set 0.976x speedup, val set 0.887x speedup, step: 1, train time 10.02 s
Epoch 20/50 |loss: 0.134463| train set 5.008x speedup, test set 1.007x speedup, val set 0.762x speedup, step: 2, train time 10.60 s
Epoch 21/50 |loss: 0.134107| train set 4.873x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 3, train time 10.10 s
Epoch 22/50 |loss: 0.135603| train set 5.008x speedup, test set 1.003x speedup, val set 0.742x speedup, step: 4, train time 9.91 s
Epoch 23/50 |loss: 0.133032| train set 5.008x speedup, test set 0.983x speedup, val set 0.735x speedup, step: 5, train time 9.90 s
Epoch 24/50 |loss: 0.131119| train set 5.008x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 6, train time 10.32 s
Epoch 25/50 |loss: 0.133046| train set 4.958x speedup, test set 0.981x speedup, val set 0.742x speedup, step: 7, train time 10.28 s
Epoch 26/50 |loss: 0.131503| train set 4.957x speedup, test set 0.981x speedup, val set 0.739x speedup, step: 8, train time 9.91 s
Epoch 27/50 |loss: 0.133239| train set 4.921x speedup, test set 0.983x speedup, val set 0.742x speedup, step: 9, train time 9.81 s
Epoch 28/50 |loss: 0.130002| train set 5.008x speedup, test set 0.990x speedup, val set 0.742x speedup, step: 10, train time 10.00 s
Epoch 29/50 |loss: 0.130172| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 11, train time 9.91 s
Epoch 30/50 |loss: 0.132566| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 12, train time 9.90 s
Epoch 31/50 |loss: 0.130882| train set 4.873x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 13, train time 10.39 s
Epoch 32/50 |loss: 0.127952| train set 4.958x speedup, test set 0.993x speedup, val set 0.762x speedup, step: 14, train time 9.91 s
Epoch 33/50 |loss: 0.129177| train set 5.008x speedup, test set 0.993x speedup, val set 0.735x speedup, step: 15, train time 10.22 s
Epoch 34/50 |loss: 0.128355| train set 5.008x speedup, test set 0.947x speedup, val set 0.795x speedup, step: 16, train time 9.80 s
Epoch 35/50 |loss: 0.130076| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 17, train time 9.80 s
Epoch 36/50 |loss: 0.128845| train set 5.008x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 18, train time 9.70 s
Epoch 37/50 |loss: 0.129226| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 19, train time 10.19 s
Epoch 38/50 |loss: 0.130393| train set 4.958x speedup, test set 0.961x speedup, val set 0.742x speedup, step: 20, train time 9.90 s
Epoch 39/50 |loss: 0.128268| train set 5.008x speedup, test set 1.004x speedup, val set 0.735x speedup, step: 21, train time 9.91 s
Epoch 40/50 |loss: 0.126471| train set 5.008x speedup, test set 0.989x speedup, val set 0.746x speedup, step: 22, train time 10.01 s
Epoch 41/50 |loss: 0.127018| train set 4.921x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 23, train time 9.62 s
Epoch 42/50 |loss: 0.127567| train set 4.958x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 24, train time 10.19 s
Epoch 43/50 |loss: 0.127024| train set 4.917x speedup, test set 0.989x speedup, val set 0.804x speedup, step: 25, train time 9.91 s
Epoch 44/50 |loss: 0.127294| train set 4.958x speedup, test set 0.992x speedup, val set 0.735x speedup, step: 26, train time 10.00 s
Epoch 45/50 |loss: 0.128626| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 27, train time 10.20 s
Epoch 46/50 |loss: 0.127214| train set 4.921x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 28, train time 9.90 s
Epoch 47/50 |loss: 0.126157| train set 4.958x speedup, test set 0.992x speedup, val set 0.742x speedup, step: 29, train time 9.90 s
Epoch 48/50 |loss: 0.128091| train set 4.958x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 30, train time 9.61 s
Epoch 49/50 |loss: 0.126541| train set 4.958x speedup, test set 0.993x speedup, val set 0.729x speedup, step: 31, train time 10.21 s
early stopping at epoch 49
Training per epoch cost 10.024 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 3, train speedup 5.008, test speedup 0.994, val speedup 1.000
best test speedup epoch: 11, train speedup 5.007, test speedup 1.022, val speedup 1.000
best validation speedup epoch: 19, train speedup 5.008, test speedup 0.976, val speedup 0.887
last model at epoch 49, train speedup 4.958, test speedup 0.993, val speedup 0.729
execution cost 0:08:53.707720
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.582586, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336378| train set 5.008x speedup, test set 0.995x speedup, val set 1.000x speedup, step: 1, train time 11.34 s
Epoch 1/50 |loss: 0.208555| train set 4.864x speedup, test set 1.011x speedup, val set 0.973x speedup, step: 2, train time 9.99 s
Epoch 2/50 |loss: 0.180659| train set 4.987x speedup, test set 1.012x speedup, val set 1.000x speedup, step: 3, train time 10.30 s
Epoch 3/50 |loss: 0.170306| train set 5.008x speedup, test set 0.989x speedup, val set 1.000x speedup, step: 4, train time 9.59 s
Epoch 4/50 |loss: 0.161061| train set 5.008x speedup, test set 1.003x speedup, val set 0.738x speedup, step: 1, train time 10.10 s
Epoch 5/50 |loss: 0.156943| train set 4.958x speedup, test set 1.009x speedup, val set 0.729x speedup, step: 2, train time 10.29 s
Epoch 6/50 |loss: 0.151538| train set 5.008x speedup, test set 1.012x speedup, val set 0.735x speedup, step: 3, train time 9.91 s
Epoch 7/50 |loss: 0.147258| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 10.08 s
Epoch 8/50 |loss: 0.148541| train set 4.809x speedup, test set 0.997x speedup, val set 1.041x speedup, step: 5, train time 10.00 s
Epoch 9/50 |loss: 0.146364| train set 5.005x speedup, test set 0.992x speedup, val set 0.735x speedup, step: 6, train time 9.89 s
Epoch 10/50 |loss: 0.141978| train set 5.008x speedup, test set 1.015x speedup, val set 0.742x speedup, step: 7, train time 10.20 s
Epoch 11/50 |loss: 0.137945| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 8, train time 9.71 s
Epoch 12/50 |loss: 0.140292| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 9, train time 10.01 s
Epoch 13/50 |loss: 0.137917| train set 5.008x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 10, train time 10.18 s
Epoch 14/50 |loss: 0.137100| train set 4.921x speedup, test set 0.970x speedup, val set 0.742x speedup, step: 1, train time 10.31 s
Epoch 15/50 |loss: 0.137355| train set 4.921x speedup, test set 1.008x speedup, val set 0.762x speedup, step: 2, train time 10.10 s
Epoch 16/50 |loss: 0.135821| train set 4.921x speedup, test set 0.982x speedup, val set 0.804x speedup, step: 3, train time 10.11 s
Epoch 17/50 |loss: 0.135919| train set 5.008x speedup, test set 1.011x speedup, val set 0.735x speedup, step: 4, train time 10.10 s
Epoch 18/50 |loss: 0.133779| train set 5.008x speedup, test set 0.993x speedup, val set 0.762x speedup, step: 5, train time 10.29 s
Epoch 19/50 |loss: 0.136088| train set 4.958x speedup, test set 0.993x speedup, val set 0.851x speedup, step: 1, train time 9.90 s
Epoch 20/50 |loss: 0.132921| train set 4.921x speedup, test set 0.989x speedup, val set 0.786x speedup, step: 2, train time 10.60 s
Epoch 21/50 |loss: 0.133595| train set 4.873x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 3, train time 9.99 s
Epoch 22/50 |loss: 0.137263| train set 4.921x speedup, test set 0.989x speedup, val set 0.786x speedup, step: 4, train time 9.99 s
Epoch 23/50 |loss: 0.131346| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 5, train time 9.79 s
Epoch 24/50 |loss: 0.129648| train set 4.921x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 6, train time 9.79 s
Epoch 25/50 |loss: 0.130908| train set 5.008x speedup, test set 0.993x speedup, val set 0.762x speedup, step: 7, train time 10.11 s
Epoch 26/50 |loss: 0.131237| train set 5.008x speedup, test set 0.980x speedup, val set 0.809x speedup, step: 8, train time 10.21 s
Epoch 27/50 |loss: 0.132243| train set 4.873x speedup, test set 0.981x speedup, val set 0.735x speedup, step: 9, train time 10.23 s
Epoch 28/50 |loss: 0.129741| train set 5.008x speedup, test set 0.951x speedup, val set 0.809x speedup, step: 10, train time 10.38 s
Epoch 29/50 |loss: 0.130098| train set 5.008x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 11, train time 9.90 s
Epoch 30/50 |loss: 0.130855| train set 5.008x speedup, test set 0.981x speedup, val set 0.735x speedup, step: 12, train time 9.59 s
Epoch 31/50 |loss: 0.129337| train set 4.873x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 13, train time 10.20 s
Epoch 32/50 |loss: 0.126392| train set 5.004x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 14, train time 9.81 s
Epoch 33/50 |loss: 0.128222| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 15, train time 9.99 s
Epoch 34/50 |loss: 0.127879| train set 5.008x speedup, test set 0.988x speedup, val set 0.742x speedup, step: 16, train time 10.41 s
Epoch 35/50 |loss: 0.128130| train set 5.007x speedup, test set 0.992x speedup, val set 0.733x speedup, step: 17, train time 10.28 s
Epoch 36/50 |loss: 0.129261| train set 5.008x speedup, test set 0.957x speedup, val set 0.791x speedup, step: 18, train time 10.01 s
Epoch 37/50 |loss: 0.129577| train set 5.008x speedup, test set 0.950x speedup, val set 0.733x speedup, step: 19, train time 10.18 s
Epoch 38/50 |loss: 0.129607| train set 4.958x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 20, train time 9.81 s
Epoch 39/50 |loss: 0.126339| train set 5.004x speedup, test set 0.977x speedup, val set 0.746x speedup, step: 21, train time 10.21 s
Epoch 40/50 |loss: 0.125564| train set 4.921x speedup, test set 0.977x speedup, val set 0.742x speedup, step: 22, train time 10.02 s
Epoch 41/50 |loss: 0.126251| train set 5.008x speedup, test set 0.949x speedup, val set 0.733x speedup, step: 23, train time 10.00 s
Epoch 42/50 |loss: 0.126185| train set 4.958x speedup, test set 0.947x speedup, val set 0.733x speedup, step: 24, train time 10.01 s
Epoch 43/50 |loss: 0.126210| train set 5.004x speedup, test set 0.966x speedup, val set 0.809x speedup, step: 25, train time 9.89 s
Epoch 44/50 |loss: 0.126479| train set 4.958x speedup, test set 0.950x speedup, val set 0.733x speedup, step: 26, train time 10.29 s
Epoch 45/50 |loss: 0.127979| train set 5.008x speedup, test set 0.948x speedup, val set 0.739x speedup, step: 27, train time 10.01 s
Epoch 46/50 |loss: 0.127371| train set 4.921x speedup, test set 0.976x speedup, val set 0.733x speedup, step: 28, train time 10.11 s
Epoch 47/50 |loss: 0.125161| train set 5.004x speedup, test set 0.976x speedup, val set 0.739x speedup, step: 29, train time 10.51 s
Epoch 48/50 |loss: 0.126554| train set 4.958x speedup, test set 0.976x speedup, val set 0.742x speedup, step: 30, train time 10.21 s
Epoch 49/50 |loss: 0.125234| train set 4.958x speedup, test set 0.950x speedup, val set 0.733x speedup, step: 31, train time 10.10 s
Training per epoch cost 10.101 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 0.995, val speedup 1.000
best test speedup epoch: 10, train speedup 5.008, test speedup 1.015, val speedup 0.742
best validation speedup epoch: 19, train speedup 4.958, test speedup 0.993, val speedup 0.851
last model at epoch 49, train speedup 4.958, test speedup 0.950, val speedup 0.733
execution cost 0:08:56.992222
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.574979, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 9.63 s
Epoch 1/50 |loss: 0.206117| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 8.21 s
Epoch 2/50 |loss: 0.179442| train set 4.715x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 3, train time 8.42 s
Epoch 3/50 |loss: 0.170787| train set 5.006x speedup, test set 1.013x speedup, val set 0.981x speedup, step: 4, train time 8.41 s
Epoch 4/50 |loss: 0.160786| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 8.21 s
Epoch 5/50 |loss: 0.157594| train set 4.958x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 2, train time 8.21 s
Epoch 6/50 |loss: 0.153461| train set 5.008x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 3, train time 8.11 s
Epoch 7/50 |loss: 0.149149| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 8.50 s
Epoch 8/50 |loss: 0.153540| train set 4.987x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 5, train time 8.31 s
Epoch 9/50 |loss: 0.150161| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 1, train time 8.80 s
Epoch 10/50 |loss: 0.143393| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 2, train time 8.79 s
Epoch 11/50 |loss: 0.138400| train set 5.007x speedup, test set 1.023x speedup, val set 0.729x speedup, step: 3, train time 8.22 s
Epoch 12/50 |loss: 0.141815| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 4, train time 8.40 s
Epoch 13/50 |loss: 0.139524| train set 5.008x speedup, test set 0.959x speedup, val set 0.735x speedup, step: 5, train time 8.39 s
Epoch 14/50 |loss: 0.138721| train set 4.872x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 1, train time 8.42 s
Epoch 15/50 |loss: 0.137631| train set 4.920x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 2, train time 8.59 s
Epoch 16/50 |loss: 0.136610| train set 4.921x speedup, test set 0.981x speedup, val set 0.742x speedup, step: 3, train time 8.61 s
Epoch 17/50 |loss: 0.138167| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 4, train time 8.50 s
Epoch 18/50 |loss: 0.134496| train set 4.921x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 5, train time 8.89 s
Epoch 19/50 |loss: 0.135362| train set 4.958x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 1, train time 8.40 s
Epoch 20/50 |loss: 0.134234| train set 4.921x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 2, train time 9.39 s
Epoch 21/50 |loss: 0.136688| train set 4.869x speedup, test set 0.992x speedup, val set 0.735x speedup, step: 3, train time 8.38 s
Epoch 22/50 |loss: 0.136989| train set 5.008x speedup, test set 1.010x speedup, val set 0.742x speedup, step: 4, train time 8.50 s
Epoch 23/50 |loss: 0.132272| train set 5.008x speedup, test set 1.010x speedup, val set 0.735x speedup, step: 5, train time 8.78 s
Epoch 24/50 |loss: 0.131054| train set 4.921x speedup, test set 1.010x speedup, val set 0.733x speedup, step: 1, train time 8.99 s
Epoch 25/50 |loss: 0.132035| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 2, train time 9.01 s
Epoch 26/50 |loss: 0.130266| train set 5.008x speedup, test set 1.036x speedup, val set 0.739x speedup, step: 3, train time 8.31 s
Epoch 27/50 |loss: 0.132147| train set 4.873x speedup, test set 1.011x speedup, val set 0.729x speedup, step: 4, train time 8.22 s
Epoch 28/50 |loss: 0.130054| train set 5.008x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 5, train time 8.51 s
Epoch 29/50 |loss: 0.132371| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 6, train time 8.71 s
Epoch 30/50 |loss: 0.130806| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 7, train time 8.30 s
Epoch 31/50 |loss: 0.130603| train set 4.958x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 8, train time 9.09 s
Epoch 32/50 |loss: 0.127678| train set 5.008x speedup, test set 0.992x speedup, val set 0.735x speedup, step: 9, train time 8.91 s
Epoch 33/50 |loss: 0.129900| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 10, train time 8.20 s
Epoch 34/50 |loss: 0.127545| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 11, train time 8.52 s
Epoch 35/50 |loss: 0.129046| train set 5.008x speedup, test set 1.012x speedup, val set 0.733x speedup, step: 12, train time 8.30 s
Epoch 36/50 |loss: 0.129211| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 13, train time 8.39 s
Epoch 37/50 |loss: 0.129459| train set 4.958x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 14, train time 8.32 s
Epoch 38/50 |loss: 0.130820| train set 4.958x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 15, train time 8.51 s
Epoch 39/50 |loss: 0.129302| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 1, train time 8.71 s
Epoch 40/50 |loss: 0.125557| train set 4.921x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 2, train time 8.19 s
Epoch 41/50 |loss: 0.127241| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 3, train time 8.21 s
Epoch 42/50 |loss: 0.127979| train set 4.958x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 4, train time 8.90 s
Epoch 43/50 |loss: 0.127218| train set 4.917x speedup, test set 0.974x speedup, val set 0.786x speedup, step: 5, train time 9.00 s
Epoch 44/50 |loss: 0.127213| train set 4.958x speedup, test set 0.975x speedup, val set 0.739x speedup, step: 6, train time 8.61 s
Epoch 45/50 |loss: 0.128778| train set 5.000x speedup, test set 0.985x speedup, val set 0.729x speedup, step: 7, train time 8.72 s
Epoch 46/50 |loss: 0.129027| train set 4.921x speedup, test set 0.969x speedup, val set 0.729x speedup, step: 8, train time 8.51 s
Epoch 47/50 |loss: 0.125917| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 9, train time 8.50 s
Epoch 48/50 |loss: 0.127226| train set 4.958x speedup, test set 0.983x speedup, val set 0.735x speedup, step: 10, train time 8.49 s
Epoch 49/50 |loss: 0.126113| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 11, train time 8.82 s
early stopping at epoch 49
Training per epoch cost 8.560 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 26, train speedup 5.008, test speedup 1.036, val speedup 0.739
best validation speedup epoch: 39, train speedup 5.008, test speedup 0.987, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.989, val speedup 0.729
execution cost 0:07:37.541301
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.579410, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336195| train set 5.008x speedup, test set 0.995x speedup, val set 1.000x speedup, step: 1, train time 9.69 s
Epoch 1/50 |loss: 0.211950| train set 4.658x speedup, test set 1.010x speedup, val set 1.033x speedup, step: 2, train time 8.10 s
Epoch 2/50 |loss: 0.179433| train set 4.489x speedup, test set 0.972x speedup, val set 0.983x speedup, step: 3, train time 8.42 s
Epoch 3/50 |loss: 0.168963| train set 5.007x speedup, test set 0.989x speedup, val set 0.973x speedup, step: 4, train time 8.03 s
Epoch 4/50 |loss: 0.159957| train set 5.008x speedup, test set 0.957x speedup, val set 0.729x speedup, step: 1, train time 8.31 s
Epoch 5/50 |loss: 0.158832| train set 4.958x speedup, test set 1.006x speedup, val set 0.729x speedup, step: 2, train time 8.21 s
Epoch 6/50 |loss: 0.153963| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 3, train time 8.71 s
Epoch 7/50 |loss: 0.147143| train set 4.921x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 8.60 s
Epoch 8/50 |loss: 0.149134| train set 5.008x speedup, test set 0.998x speedup, val set 0.738x speedup, step: 5, train time 8.62 s
Epoch 9/50 |loss: 0.148150| train set 5.004x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 1, train time 8.50 s
Epoch 10/50 |loss: 0.143099| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 2, train time 8.29 s
Epoch 11/50 |loss: 0.139545| train set 5.007x speedup, test set 1.013x speedup, val set 1.000x speedup, step: 3, train time 8.41 s
Epoch 12/50 |loss: 0.141082| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 4, train time 8.48 s
Epoch 13/50 |loss: 0.140323| train set 4.987x speedup, test set 0.959x speedup, val set 0.735x speedup, step: 5, train time 8.79 s
Epoch 14/50 |loss: 0.137700| train set 4.873x speedup, test set 0.969x speedup, val set 0.742x speedup, step: 1, train time 8.70 s
Epoch 15/50 |loss: 0.137796| train set 4.921x speedup, test set 0.970x speedup, val set 0.742x speedup, step: 2, train time 8.59 s
Epoch 16/50 |loss: 0.137727| train set 4.921x speedup, test set 0.969x speedup, val set 0.762x speedup, step: 3, train time 8.49 s
Epoch 17/50 |loss: 0.137425| train set 5.008x speedup, test set 0.970x speedup, val set 0.729x speedup, step: 4, train time 8.49 s
Epoch 18/50 |loss: 0.134013| train set 5.008x speedup, test set 0.970x speedup, val set 0.735x speedup, step: 5, train time 8.41 s
Epoch 19/50 |loss: 0.137026| train set 4.708x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 6, train time 8.62 s
Epoch 20/50 |loss: 0.135221| train set 4.921x speedup, test set 0.965x speedup, val set 0.804x speedup, step: 7, train time 9.11 s
Epoch 21/50 |loss: 0.134230| train set 4.872x speedup, test set 0.970x speedup, val set 0.729x speedup, step: 8, train time 8.11 s
Epoch 22/50 |loss: 0.136059| train set 5.008x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 9, train time 8.51 s
Epoch 23/50 |loss: 0.132147| train set 5.008x speedup, test set 0.973x speedup, val set 0.735x speedup, step: 10, train time 8.19 s
Epoch 24/50 |loss: 0.130511| train set 4.921x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 11, train time 8.61 s
Epoch 25/50 |loss: 0.131578| train set 5.008x speedup, test set 0.969x speedup, val set 0.742x speedup, step: 12, train time 8.59 s
Epoch 26/50 |loss: 0.130306| train set 5.007x speedup, test set 0.991x speedup, val set 0.739x speedup, step: 13, train time 8.61 s
Epoch 27/50 |loss: 0.131150| train set 4.873x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 14, train time 8.42 s
Epoch 28/50 |loss: 0.129764| train set 5.008x speedup, test set 0.970x speedup, val set 0.739x speedup, step: 15, train time 8.31 s
Epoch 29/50 |loss: 0.131699| train set 5.008x speedup, test set 0.965x speedup, val set 0.729x speedup, step: 16, train time 8.40 s
Epoch 30/50 |loss: 0.130836| train set 5.008x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 17, train time 8.28 s
Epoch 31/50 |loss: 0.130822| train set 4.873x speedup, test set 0.939x speedup, val set 0.729x speedup, step: 18, train time 8.62 s
Epoch 32/50 |loss: 0.127776| train set 5.008x speedup, test set 0.946x speedup, val set 0.742x speedup, step: 19, train time 8.60 s
Epoch 33/50 |loss: 0.128248| train set 5.008x speedup, test set 1.003x speedup, val set 0.733x speedup, step: 20, train time 8.58 s
Epoch 34/50 |loss: 0.126879| train set 5.008x speedup, test set 0.965x speedup, val set 0.739x speedup, step: 21, train time 8.59 s
Epoch 35/50 |loss: 0.128279| train set 5.007x speedup, test set 0.967x speedup, val set 0.733x speedup, step: 22, train time 8.49 s
Epoch 36/50 |loss: 0.128573| train set 5.008x speedup, test set 0.969x speedup, val set 0.809x speedup, step: 23, train time 8.40 s
Epoch 37/50 |loss: 0.129170| train set 4.958x speedup, test set 0.965x speedup, val set 0.733x speedup, step: 24, train time 8.32 s
Epoch 38/50 |loss: 0.129419| train set 4.958x speedup, test set 0.927x speedup, val set 0.733x speedup, step: 25, train time 8.11 s
Epoch 39/50 |loss: 0.128090| train set 5.008x speedup, test set 0.965x speedup, val set 0.742x speedup, step: 1, train time 8.39 s
Epoch 40/50 |loss: 0.124516| train set 5.008x speedup, test set 0.952x speedup, val set 0.739x speedup, step: 2, train time 8.31 s
Epoch 41/50 |loss: 0.126214| train set 5.008x speedup, test set 0.939x speedup, val set 0.742x speedup, step: 3, train time 8.51 s
Epoch 42/50 |loss: 0.126692| train set 4.958x speedup, test set 0.934x speedup, val set 0.733x speedup, step: 4, train time 8.48 s
Epoch 43/50 |loss: 0.127495| train set 5.003x speedup, test set 0.965x speedup, val set 0.791x speedup, step: 5, train time 8.61 s
Epoch 44/50 |loss: 0.127363| train set 4.958x speedup, test set 0.937x speedup, val set 0.746x speedup, step: 1, train time 8.29 s
Epoch 45/50 |loss: 0.127584| train set 5.000x speedup, test set 0.945x speedup, val set 0.746x speedup, step: 2, train time 8.61 s
Epoch 46/50 |loss: 0.128025| train set 4.921x speedup, test set 0.952x speedup, val set 0.733x speedup, step: 3, train time 8.21 s
Epoch 47/50 |loss: 0.125841| train set 5.008x speedup, test set 0.969x speedup, val set 0.739x speedup, step: 4, train time 8.41 s
Epoch 48/50 |loss: 0.127071| train set 4.958x speedup, test set 0.965x speedup, val set 0.733x speedup, step: 5, train time 8.33 s
Epoch 49/50 |loss: 0.125698| train set 4.958x speedup, test set 0.939x speedup, val set 0.733x speedup, step: 6, train time 8.12 s
early stopping at epoch 49
Training per epoch cost 8.471 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.741s, pg runtime 18.741s, speedup 1.000x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 3.309s, pg runtime 0.189s, speedup 0.057x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.256s, pg runtime 0.250s, speedup 0.978x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 0.995, val speedup 1.000
best test speedup epoch: 11, train speedup 5.007, test speedup 1.013, val speedup 1.000
best validation speedup epoch: 44, train speedup 4.958, test speedup 0.937, val speedup 0.746
last model at epoch 49, train speedup 4.958, test speedup 0.939, val speedup 0.733
execution cost 0:07:33.582645
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.604524, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336818| train set 5.007x speedup, test set 0.979x speedup, val set 1.000x speedup, step: 1, train time 10.14 s
Epoch 1/50 |loss: 0.213281| train set 4.657x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 2, train time 8.22 s
Epoch 2/50 |loss: 0.182713| train set 4.697x speedup, test set 0.959x speedup, val set 1.000x speedup, step: 3, train time 8.81 s
Epoch 3/50 |loss: 0.171924| train set 5.007x speedup, test set 0.980x speedup, val set 1.000x speedup, step: 4, train time 8.59 s
Epoch 4/50 |loss: 0.160087| train set 5.008x speedup, test set 0.958x speedup, val set 0.729x speedup, step: 1, train time 8.30 s
Epoch 5/50 |loss: 0.159276| train set 4.958x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 2, train time 8.70 s
Epoch 6/50 |loss: 0.151505| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 3, train time 8.90 s
Epoch 7/50 |loss: 0.148977| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 8.60 s
Epoch 8/50 |loss: 0.149122| train set 4.715x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 5, train time 9.20 s
Epoch 9/50 |loss: 0.147462| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 1, train time 8.60 s
Epoch 10/50 |loss: 0.143796| train set 5.008x speedup, test set 0.959x speedup, val set 0.735x speedup, step: 2, train time 8.59 s
Epoch 11/50 |loss: 0.137586| train set 5.007x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 3, train time 8.70 s
Epoch 12/50 |loss: 0.142300| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 8.69 s
Epoch 13/50 |loss: 0.137852| train set 5.008x speedup, test set 0.958x speedup, val set 0.735x speedup, step: 5, train time 8.80 s
Epoch 14/50 |loss: 0.137260| train set 4.873x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 1, train time 8.32 s
Epoch 15/50 |loss: 0.136887| train set 4.921x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 2, train time 8.29 s
Epoch 16/50 |loss: 0.135621| train set 4.921x speedup, test set 0.957x speedup, val set 0.742x speedup, step: 3, train time 8.88 s
Epoch 17/50 |loss: 0.137127| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 8.61 s
Epoch 18/50 |loss: 0.133681| train set 5.008x speedup, test set 0.959x speedup, val set 0.735x speedup, step: 5, train time 8.84 s
Epoch 19/50 |loss: 0.134604| train set 4.958x speedup, test set 0.959x speedup, val set 0.735x speedup, step: 1, train time 8.70 s
Epoch 20/50 |loss: 0.133224| train set 4.921x speedup, test set 0.959x speedup, val set 0.804x speedup, step: 2, train time 9.19 s
Epoch 21/50 |loss: 0.133639| train set 4.872x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 3, train time 8.42 s
Epoch 22/50 |loss: 0.135832| train set 5.008x speedup, test set 0.954x speedup, val set 0.742x speedup, step: 4, train time 8.41 s
Epoch 23/50 |loss: 0.132308| train set 5.008x speedup, test set 0.959x speedup, val set 0.735x speedup, step: 5, train time 8.41 s
Epoch 24/50 |loss: 0.129520| train set 4.921x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 6, train time 8.68 s
Epoch 25/50 |loss: 0.130972| train set 5.008x speedup, test set 0.926x speedup, val set 0.786x speedup, step: 7, train time 9.00 s
Epoch 26/50 |loss: 0.130263| train set 5.007x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 8, train time 8.69 s
Epoch 27/50 |loss: 0.130497| train set 4.873x speedup, test set 0.970x speedup, val set 0.729x speedup, step: 9, train time 8.11 s
Epoch 28/50 |loss: 0.128566| train set 5.008x speedup, test set 0.926x speedup, val set 0.735x speedup, step: 10, train time 8.31 s
Epoch 29/50 |loss: 0.132347| train set 5.008x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 11, train time 8.61 s
Epoch 30/50 |loss: 0.130090| train set 5.008x speedup, test set 0.952x speedup, val set 0.735x speedup, step: 12, train time 8.61 s
Epoch 31/50 |loss: 0.129429| train set 4.873x speedup, test set 0.957x speedup, val set 0.729x speedup, step: 13, train time 8.38 s
Epoch 32/50 |loss: 0.126917| train set 5.004x speedup, test set 0.953x speedup, val set 0.742x speedup, step: 14, train time 8.19 s
Epoch 33/50 |loss: 0.128501| train set 5.008x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 15, train time 8.90 s
Epoch 34/50 |loss: 0.127755| train set 5.008x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 1, train time 8.20 s
Epoch 35/50 |loss: 0.128506| train set 5.008x speedup, test set 0.973x speedup, val set 0.729x speedup, step: 2, train time 8.81 s
Epoch 36/50 |loss: 0.127921| train set 5.008x speedup, test set 0.927x speedup, val set 0.804x speedup, step: 3, train time 8.90 s
Epoch 37/50 |loss: 0.127774| train set 4.958x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 4, train time 8.41 s
Epoch 38/50 |loss: 0.129210| train set 4.958x speedup, test set 0.925x speedup, val set 0.729x speedup, step: 5, train time 8.61 s
Epoch 39/50 |loss: 0.128006| train set 5.004x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 1, train time 8.49 s
Epoch 40/50 |loss: 0.125340| train set 4.921x speedup, test set 0.913x speedup, val set 0.729x speedup, step: 2, train time 8.38 s
Epoch 41/50 |loss: 0.126587| train set 5.008x speedup, test set 0.932x speedup, val set 0.729x speedup, step: 3, train time 8.20 s
Epoch 42/50 |loss: 0.126884| train set 4.958x speedup, test set 0.890x speedup, val set 0.729x speedup, step: 4, train time 8.59 s
Epoch 43/50 |loss: 0.126098| train set 4.916x speedup, test set 0.964x speedup, val set 0.804x speedup, step: 5, train time 8.43 s
Epoch 44/50 |loss: 0.127623| train set 4.958x speedup, test set 0.890x speedup, val set 0.742x speedup, step: 1, train time 8.68 s
Epoch 45/50 |loss: 0.128299| train set 5.008x speedup, test set 0.951x speedup, val set 0.746x speedup, step: 2, train time 8.21 s
Epoch 46/50 |loss: 0.127505| train set 4.921x speedup, test set 0.944x speedup, val set 0.729x speedup, step: 3, train time 8.51 s
Epoch 47/50 |loss: 0.124802| train set 4.958x speedup, test set 0.951x speedup, val set 0.729x speedup, step: 4, train time 9.01 s
Epoch 48/50 |loss: 0.127160| train set 4.958x speedup, test set 0.985x speedup, val set 0.735x speedup, step: 5, train time 8.80 s
Epoch 49/50 |loss: 0.125605| train set 4.958x speedup, test set 0.918x speedup, val set 0.729x speedup, step: 6, train time 8.41 s
early stopping at epoch 49
Training per epoch cost 8.620 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 7.660s, pg runtime 3.549s, speedup 0.463x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.143s, pg runtime 6.143s, speedup 1.000x
13, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 3.309s, pg runtime 0.189s, speedup 0.057x
20, opt runtime 2.719s, model runtime 4.408s, pg runtime 3.112s, speedup 0.706x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 13, train speedup 5.008, test speedup 0.958, val speedup 0.735
best test speedup epoch: 1, train speedup 4.657, test speedup 0.998, val speedup 0.729
best validation speedup epoch: 44, train speedup 4.958, test speedup 0.890, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.918, val speedup 0.729
execution cost 0:07:41.441014
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.579721, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 9.94 s
Epoch 1/50 |loss: 0.206259| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 8.22 s
Epoch 2/50 |loss: 0.178873| train set 4.715x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 3, train time 8.50 s
Epoch 3/50 |loss: 0.172713| train set 5.007x speedup, test set 0.972x speedup, val set 1.033x speedup, step: 4, train time 8.52 s
Epoch 4/50 |loss: 0.161591| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 8.31 s
Epoch 5/50 |loss: 0.156873| train set 4.958x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 2, train time 8.51 s
Epoch 6/50 |loss: 0.153107| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 3, train time 8.49 s
Epoch 7/50 |loss: 0.148590| train set 4.921x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 8.61 s
Epoch 8/50 |loss: 0.150960| train set 4.715x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 5, train time 8.38 s
Epoch 9/50 |loss: 0.148914| train set 5.002x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 1, train time 8.81 s
Epoch 10/50 |loss: 0.145166| train set 4.921x speedup, test set 0.984x speedup, val set 0.735x speedup, step: 2, train time 8.80 s
Epoch 11/50 |loss: 0.138389| train set 5.008x speedup, test set 1.001x speedup, val set 0.729x speedup, step: 3, train time 8.51 s
Epoch 12/50 |loss: 0.142362| train set 5.008x speedup, test set 1.013x speedup, val set 0.729x speedup, step: 4, train time 8.82 s
Epoch 13/50 |loss: 0.138733| train set 5.008x speedup, test set 0.984x speedup, val set 0.735x speedup, step: 5, train time 8.28 s
Epoch 14/50 |loss: 0.136854| train set 4.873x speedup, test set 0.984x speedup, val set 0.735x speedup, step: 1, train time 8.51 s
Epoch 15/50 |loss: 0.137975| train set 4.921x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 2, train time 8.62 s
Epoch 16/50 |loss: 0.136488| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 3, train time 8.81 s
Epoch 17/50 |loss: 0.137032| train set 5.008x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 4, train time 8.52 s
Epoch 18/50 |loss: 0.133979| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 5, train time 8.81 s
Epoch 19/50 |loss: 0.135977| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 6, train time 8.70 s
Epoch 20/50 |loss: 0.133890| train set 4.921x speedup, test set 1.015x speedup, val set 0.735x speedup, step: 7, train time 9.50 s
Epoch 21/50 |loss: 0.134289| train set 4.873x speedup, test set 1.015x speedup, val set 0.729x speedup, step: 8, train time 8.72 s
Epoch 22/50 |loss: 0.135707| train set 5.008x speedup, test set 1.016x speedup, val set 0.742x speedup, step: 9, train time 8.80 s
Epoch 23/50 |loss: 0.132841| train set 5.008x speedup, test set 1.015x speedup, val set 0.729x speedup, step: 10, train time 8.52 s
Epoch 24/50 |loss: 0.130760| train set 4.921x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 11, train time 8.48 s
Epoch 25/50 |loss: 0.131933| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 12, train time 8.69 s
Epoch 26/50 |loss: 0.129781| train set 5.008x speedup, test set 0.997x speedup, val set 0.733x speedup, step: 13, train time 8.70 s
Epoch 27/50 |loss: 0.132759| train set 4.921x speedup, test set 1.016x speedup, val set 0.729x speedup, step: 14, train time 8.49 s
Epoch 28/50 |loss: 0.129683| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 15, train time 8.71 s
Epoch 29/50 |loss: 0.132725| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 16, train time 8.39 s
Epoch 30/50 |loss: 0.132579| train set 5.008x speedup, test set 1.016x speedup, val set 0.729x speedup, step: 17, train time 8.41 s
Epoch 31/50 |loss: 0.130439| train set 4.873x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 18, train time 8.71 s
Epoch 32/50 |loss: 0.127459| train set 4.958x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 19, train time 8.30 s
Epoch 33/50 |loss: 0.128766| train set 5.008x speedup, test set 1.002x speedup, val set 0.735x speedup, step: 20, train time 8.80 s
Epoch 34/50 |loss: 0.127425| train set 5.008x speedup, test set 0.973x speedup, val set 0.735x speedup, step: 1, train time 8.51 s
Epoch 35/50 |loss: 0.128573| train set 5.008x speedup, test set 0.976x speedup, val set 0.733x speedup, step: 2, train time 8.99 s
Epoch 36/50 |loss: 0.127746| train set 5.008x speedup, test set 0.975x speedup, val set 0.746x speedup, step: 3, train time 8.49 s
Epoch 37/50 |loss: 0.129056| train set 4.917x speedup, test set 1.015x speedup, val set 0.735x speedup, step: 4, train time 8.41 s
Epoch 38/50 |loss: 0.129915| train set 4.958x speedup, test set 0.948x speedup, val set 0.729x speedup, step: 5, train time 8.71 s
Epoch 39/50 |loss: 0.128441| train set 5.008x speedup, test set 0.971x speedup, val set 0.729x speedup, step: 6, train time 8.81 s
Epoch 40/50 |loss: 0.125325| train set 5.008x speedup, test set 0.936x speedup, val set 0.733x speedup, step: 7, train time 8.59 s
Epoch 41/50 |loss: 0.125762| train set 5.008x speedup, test set 0.947x speedup, val set 0.729x speedup, step: 8, train time 8.39 s
Epoch 42/50 |loss: 0.126387| train set 4.958x speedup, test set 0.947x speedup, val set 0.733x speedup, step: 9, train time 8.67 s
Epoch 43/50 |loss: 0.125901| train set 5.004x speedup, test set 0.975x speedup, val set 0.742x speedup, step: 10, train time 8.40 s
Epoch 44/50 |loss: 0.127398| train set 4.958x speedup, test set 0.947x speedup, val set 0.733x speedup, step: 11, train time 8.82 s
Epoch 45/50 |loss: 0.127326| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 12, train time 8.41 s
Epoch 46/50 |loss: 0.127133| train set 4.921x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 13, train time 8.39 s
Epoch 47/50 |loss: 0.124816| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 14, train time 8.41 s
Epoch 48/50 |loss: 0.126342| train set 4.958x speedup, test set 1.015x speedup, val set 0.746x speedup, step: 15, train time 8.30 s
Epoch 49/50 |loss: 0.125138| train set 4.958x speedup, test set 0.947x speedup, val set 0.729x speedup, step: 16, train time 8.62 s
Training per epoch cost 8.616 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 7.660s, pg runtime 3.549s, speedup 0.463x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 0.986s, pg runtime 1.357s, speedup 1.377x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 1, train speedup 4.864, test speedup 1.020, val speedup 1.033
best validation speedup epoch: 34, train speedup 5.008, test speedup 0.973, val speedup 0.735
last model at epoch 49, train speedup 4.958, test speedup 0.947, val speedup 0.729
execution cost 0:07:40.321971
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.627197, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 9.64 s
Epoch 1/50 |loss: 0.205546| train set 5.007x speedup, test set 1.025x speedup, val set 1.033x speedup, step: 2, train time 8.21 s
Epoch 2/50 |loss: 0.182592| train set 4.489x speedup, test set 0.994x speedup, val set 0.738x speedup, step: 3, train time 8.30 s
Epoch 3/50 |loss: 0.170368| train set 5.008x speedup, test set 1.008x speedup, val set 0.973x speedup, step: 4, train time 8.31 s
Epoch 4/50 |loss: 0.161151| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 1, train time 8.38 s
Epoch 5/50 |loss: 0.158432| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 2, train time 8.20 s
Epoch 6/50 |loss: 0.150762| train set 5.008x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 3, train time 8.40 s
Epoch 7/50 |loss: 0.147378| train set 4.921x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 8.69 s
Epoch 8/50 |loss: 0.151229| train set 4.715x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 5, train time 8.80 s
Epoch 9/50 |loss: 0.148140| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 1, train time 8.50 s
Epoch 10/50 |loss: 0.143412| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 2, train time 8.50 s
Epoch 11/50 |loss: 0.138165| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 3, train time 8.50 s
Epoch 12/50 |loss: 0.142453| train set 5.008x speedup, test set 0.973x speedup, val set 0.729x speedup, step: 4, train time 8.80 s
Epoch 13/50 |loss: 0.139059| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 5, train time 7.88 s
Epoch 14/50 |loss: 0.136953| train set 4.873x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 1, train time 8.68 s
Epoch 15/50 |loss: 0.137276| train set 4.921x speedup, test set 0.992x speedup, val set 0.735x speedup, step: 2, train time 8.20 s
Epoch 16/50 |loss: 0.136961| train set 4.921x speedup, test set 0.992x speedup, val set 0.742x speedup, step: 3, train time 8.41 s
Epoch 17/50 |loss: 0.136476| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 4, train time 8.47 s
Epoch 18/50 |loss: 0.134243| train set 5.008x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 5, train time 8.51 s
Epoch 19/50 |loss: 0.136276| train set 5.008x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 1, train time 8.19 s
Epoch 20/50 |loss: 0.135221| train set 5.008x speedup, test set 1.010x speedup, val set 0.735x speedup, step: 2, train time 8.99 s
Epoch 21/50 |loss: 0.134382| train set 4.873x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 3, train time 8.31 s
Epoch 22/50 |loss: 0.136456| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 4, train time 8.09 s
Epoch 23/50 |loss: 0.132673| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 5, train time 8.71 s
Epoch 24/50 |loss: 0.130900| train set 4.921x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 1, train time 8.40 s
Epoch 25/50 |loss: 0.132605| train set 4.958x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 2, train time 8.30 s
Epoch 26/50 |loss: 0.130616| train set 4.957x speedup, test set 1.001x speedup, val set 0.739x speedup, step: 3, train time 8.52 s
Epoch 27/50 |loss: 0.133377| train set 4.873x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 4, train time 8.31 s
Epoch 28/50 |loss: 0.129897| train set 5.008x speedup, test set 0.984x speedup, val set 0.733x speedup, step: 5, train time 8.29 s
Epoch 29/50 |loss: 0.132015| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 1, train time 8.30 s
Epoch 30/50 |loss: 0.132494| train set 5.008x speedup, test set 0.998x speedup, val set 0.729x speedup, step: 2, train time 8.19 s
Epoch 31/50 |loss: 0.130742| train set 4.873x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 3, train time 8.11 s
Epoch 32/50 |loss: 0.127578| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 4, train time 8.21 s
Epoch 33/50 |loss: 0.129717| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 5, train time 8.21 s
Epoch 34/50 |loss: 0.127648| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 1, train time 8.20 s
Epoch 35/50 |loss: 0.129807| train set 5.008x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 2, train time 8.10 s
Epoch 36/50 |loss: 0.129292| train set 5.008x speedup, test set 0.998x speedup, val set 0.742x speedup, step: 3, train time 8.69 s
Epoch 37/50 |loss: 0.129802| train set 5.008x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 4, train time 8.62 s
Epoch 38/50 |loss: 0.129866| train set 4.958x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 5, train time 8.39 s
Epoch 39/50 |loss: 0.128791| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 1, train time 8.20 s
Epoch 40/50 |loss: 0.125509| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 2, train time 8.29 s
Epoch 41/50 |loss: 0.126999| train set 4.921x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 3, train time 8.49 s
Epoch 42/50 |loss: 0.127489| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 4, train time 8.23 s
Epoch 43/50 |loss: 0.126621| train set 4.917x speedup, test set 0.998x speedup, val set 0.786x speedup, step: 5, train time 8.69 s
Epoch 44/50 |loss: 0.127841| train set 4.958x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 1, train time 8.31 s
Epoch 45/50 |loss: 0.128098| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 2, train time 8.60 s
Epoch 46/50 |loss: 0.127792| train set 4.921x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 3, train time 8.00 s
Epoch 47/50 |loss: 0.125907| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 4, train time 8.29 s
Epoch 48/50 |loss: 0.126936| train set 4.958x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 5, train time 8.61 s
Epoch 49/50 |loss: 0.126473| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 6, train time 8.32 s
early stopping at epoch 49
Training per epoch cost 8.410 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 1, train speedup 5.007, test speedup 1.025, val speedup 1.033
best validation speedup epoch: 44, train speedup 4.958, test speedup 0.977, val speedup 0.735
last model at epoch 49, train speedup 4.958, test speedup 0.989, val speedup 0.729
execution cost 0:07:30.595784
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.573298, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336340| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 9.82 s
Epoch 1/50 |loss: 0.208570| train set 4.864x speedup, test set 1.009x speedup, val set 1.033x speedup, step: 2, train time 8.59 s
Epoch 2/50 |loss: 0.179116| train set 4.488x speedup, test set 0.993x speedup, val set 1.000x speedup, step: 3, train time 8.61 s
Epoch 3/50 |loss: 0.171711| train set 5.008x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 4, train time 8.52 s
Epoch 4/50 |loss: 0.160191| train set 5.008x speedup, test set 0.949x speedup, val set 0.729x speedup, step: 1, train time 8.50 s
Epoch 5/50 |loss: 0.157765| train set 4.630x speedup, test set 1.010x speedup, val set 0.729x speedup, step: 2, train time 8.79 s
Epoch 6/50 |loss: 0.151043| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 3, train time 8.32 s
Epoch 7/50 |loss: 0.149032| train set 5.008x speedup, test set 0.960x speedup, val set 0.983x speedup, step: 4, train time 8.52 s
Epoch 8/50 |loss: 0.149188| train set 4.715x speedup, test set 1.008x speedup, val set 1.006x speedup, step: 5, train time 8.90 s
Epoch 9/50 |loss: 0.147912| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 1, train time 8.71 s
Epoch 10/50 |loss: 0.142970| train set 5.008x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 2, train time 8.38 s
Epoch 11/50 |loss: 0.137878| train set 5.007x speedup, test set 1.024x speedup, val set 0.983x speedup, step: 3, train time 8.21 s
Epoch 12/50 |loss: 0.142312| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 4, train time 8.71 s
Epoch 13/50 |loss: 0.137526| train set 5.008x speedup, test set 0.960x speedup, val set 0.735x speedup, step: 5, train time 8.71 s
Epoch 14/50 |loss: 0.138010| train set 4.873x speedup, test set 0.967x speedup, val set 0.735x speedup, step: 1, train time 8.80 s
Epoch 15/50 |loss: 0.138390| train set 4.921x speedup, test set 0.988x speedup, val set 0.795x speedup, step: 2, train time 8.21 s
Epoch 16/50 |loss: 0.138846| train set 4.921x speedup, test set 0.966x speedup, val set 0.786x speedup, step: 3, train time 8.60 s
Epoch 17/50 |loss: 0.136902| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4, train time 8.30 s
Epoch 18/50 |loss: 0.136355| train set 5.008x speedup, test set 0.972x speedup, val set 0.735x speedup, step: 5, train time 8.40 s
Epoch 19/50 |loss: 0.135605| train set 4.958x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 6, train time 8.32 s
Epoch 20/50 |loss: 0.134811| train set 5.008x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 7, train time 9.29 s
Epoch 21/50 |loss: 0.134398| train set 4.873x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 8, train time 8.67 s
Epoch 22/50 |loss: 0.135669| train set 4.921x speedup, test set 0.992x speedup, val set 0.742x speedup, step: 9, train time 8.81 s
Epoch 23/50 |loss: 0.132324| train set 5.008x speedup, test set 0.995x speedup, val set 0.735x speedup, step: 10, train time 8.60 s
Epoch 24/50 |loss: 0.130892| train set 4.921x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 11, train time 8.99 s
Epoch 25/50 |loss: 0.132248| train set 4.958x speedup, test set 0.970x speedup, val set 0.742x speedup, step: 12, train time 8.40 s
Epoch 26/50 |loss: 0.131350| train set 5.007x speedup, test set 0.998x speedup, val set 0.746x speedup, step: 13, train time 8.22 s
Epoch 27/50 |loss: 0.132534| train set 4.921x speedup, test set 1.035x speedup, val set 0.742x speedup, step: 14, train time 8.81 s
Epoch 28/50 |loss: 0.129252| train set 5.008x speedup, test set 0.995x speedup, val set 0.746x speedup, step: 15, train time 8.49 s
Epoch 29/50 |loss: 0.131308| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 16, train time 8.31 s
Epoch 30/50 |loss: 0.131172| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 17, train time 8.12 s
Epoch 31/50 |loss: 0.130407| train set 4.958x speedup, test set 0.995x speedup, val set 0.742x speedup, step: 18, train time 8.40 s
Epoch 32/50 |loss: 0.127491| train set 5.008x speedup, test set 0.989x speedup, val set 0.762x speedup, step: 19, train time 8.50 s
Epoch 33/50 |loss: 0.129304| train set 5.008x speedup, test set 1.035x speedup, val set 0.729x speedup, step: 20, train time 8.51 s
Epoch 34/50 |loss: 0.128385| train set 5.008x speedup, test set 1.018x speedup, val set 0.735x speedup, step: 1, train time 8.50 s
Epoch 35/50 |loss: 0.128277| train set 5.008x speedup, test set 1.039x speedup, val set 0.729x speedup, step: 2, train time 8.60 s
Epoch 36/50 |loss: 0.129084| train set 5.008x speedup, test set 1.000x speedup, val set 0.742x speedup, step: 3, train time 8.72 s
Epoch 37/50 |loss: 0.129049| train set 4.917x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 4, train time 8.41 s
Epoch 38/50 |loss: 0.130254| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 5, train time 8.39 s
Epoch 39/50 |loss: 0.128246| train set 5.008x speedup, test set 1.011x speedup, val set 0.742x speedup, step: 1, train time 8.70 s
Epoch 40/50 |loss: 0.125635| train set 4.921x speedup, test set 1.011x speedup, val set 0.739x speedup, step: 2, train time 8.19 s
Epoch 41/50 |loss: 0.126944| train set 4.921x speedup, test set 1.011x speedup, val set 0.735x speedup, step: 3, train time 8.40 s
Epoch 42/50 |loss: 0.126917| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 4, train time 8.71 s
Epoch 43/50 |loss: 0.127125| train set 4.917x speedup, test set 0.998x speedup, val set 0.804x speedup, step: 5, train time 8.80 s
Epoch 44/50 |loss: 0.128732| train set 4.958x speedup, test set 1.011x speedup, val set 0.729x speedup, step: 6, train time 8.29 s
Epoch 45/50 |loss: 0.127918| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 7, train time 8.22 s
Epoch 46/50 |loss: 0.126675| train set 4.921x speedup, test set 0.995x speedup, val set 0.770x speedup, step: 8, train time 8.90 s
Epoch 47/50 |loss: 0.125438| train set 5.008x speedup, test set 1.011x speedup, val set 0.742x speedup, step: 9, train time 8.59 s
Epoch 48/50 |loss: 0.127337| train set 4.958x speedup, test set 1.011x speedup, val set 0.735x speedup, step: 10, train time 8.71 s
Epoch 49/50 |loss: 0.125716| train set 4.958x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 11, train time 8.69 s
early stopping at epoch 49
Training per epoch cost 8.578 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 1.357s, pg runtime 1.357s, speedup 1.000x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 35, train speedup 5.008, test speedup 1.039, val speedup 0.729
best validation speedup epoch: 39, train speedup 5.008, test speedup 1.011, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.995, val speedup 0.729
execution cost 0:07:38.389064
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.572850, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 9.42 s
Epoch 1/50 |loss: 0.208347| train set 4.849x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 2, train time 8.21 s
Epoch 2/50 |loss: 0.181676| train set 4.675x speedup, test set 0.993x speedup, val set 0.738x speedup, step: 3, train time 8.42 s
Epoch 3/50 |loss: 0.172351| train set 5.007x speedup, test set 0.994x speedup, val set 0.881x speedup, step: 4, train time 8.30 s
Epoch 4/50 |loss: 0.161286| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 1, train time 8.70 s
Epoch 5/50 |loss: 0.155271| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 2, train time 8.31 s
Epoch 6/50 |loss: 0.151313| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 3, train time 8.41 s
Epoch 7/50 |loss: 0.148754| train set 4.921x speedup, test set 0.970x speedup, val set 0.779x speedup, step: 4, train time 9.01 s
Epoch 8/50 |loss: 0.150715| train set 4.697x speedup, test set 0.994x speedup, val set 0.733x speedup, step: 5, train time 8.89 s
Epoch 9/50 |loss: 0.148396| train set 4.895x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 1, train time 8.80 s
Epoch 10/50 |loss: 0.142935| train set 5.008x speedup, test set 1.004x speedup, val set 0.729x speedup, step: 2, train time 8.60 s
Epoch 11/50 |loss: 0.137629| train set 5.008x speedup, test set 1.034x speedup, val set 0.729x speedup, step: 3, train time 8.80 s
Epoch 12/50 |loss: 0.140677| train set 5.007x speedup, test set 1.001x speedup, val set 0.729x speedup, step: 4, train time 8.89 s
Epoch 13/50 |loss: 0.138713| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 5, train time 8.30 s
Epoch 14/50 |loss: 0.135783| train set 4.958x speedup, test set 1.004x speedup, val set 0.729x speedup, step: 1, train time 8.51 s
Epoch 15/50 |loss: 0.136892| train set 4.921x speedup, test set 0.998x speedup, val set 0.742x speedup, step: 2, train time 8.79 s
Epoch 16/50 |loss: 0.135890| train set 4.921x speedup, test set 0.965x speedup, val set 0.742x speedup, step: 3, train time 8.60 s
Epoch 17/50 |loss: 0.135877| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 4, train time 8.62 s
Epoch 18/50 |loss: 0.134081| train set 5.008x speedup, test set 1.010x speedup, val set 0.735x speedup, step: 5, train time 8.49 s
Epoch 19/50 |loss: 0.134178| train set 4.958x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 1, train time 8.61 s
Epoch 20/50 |loss: 0.133586| train set 4.921x speedup, test set 0.943x speedup, val set 0.735x speedup, step: 2, train time 9.18 s
Epoch 21/50 |loss: 0.133002| train set 4.873x speedup, test set 0.951x speedup, val set 0.729x speedup, step: 3, train time 10.00 s
Epoch 22/50 |loss: 0.135474| train set 5.008x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 4, train time 9.51 s
Epoch 23/50 |loss: 0.131434| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 5, train time 8.30 s
Epoch 24/50 |loss: 0.130318| train set 4.921x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 1, train time 8.62 s
Epoch 25/50 |loss: 0.131415| train set 5.008x speedup, test set 0.937x speedup, val set 0.742x speedup, step: 2, train time 8.61 s
Epoch 26/50 |loss: 0.130475| train set 5.007x speedup, test set 0.957x speedup, val set 0.733x speedup, step: 3, train time 8.40 s
Epoch 27/50 |loss: 0.130896| train set 4.873x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 4, train time 8.80 s
Epoch 28/50 |loss: 0.128051| train set 5.008x speedup, test set 0.949x speedup, val set 0.739x speedup, step: 5, train time 8.60 s
Epoch 29/50 |loss: 0.129057| train set 5.008x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 1, train time 8.39 s
Epoch 30/50 |loss: 0.130779| train set 5.007x speedup, test set 0.937x speedup, val set 0.733x speedup, step: 2, train time 8.39 s
Epoch 31/50 |loss: 0.130014| train set 4.958x speedup, test set 0.979x speedup, val set 0.733x speedup, step: 3, train time 8.40 s
Epoch 32/50 |loss: 0.127454| train set 5.008x speedup, test set 0.914x speedup, val set 0.729x speedup, step: 4, train time 8.40 s
Epoch 33/50 |loss: 0.128478| train set 5.008x speedup, test set 0.949x speedup, val set 0.733x speedup, step: 5, train time 8.61 s
Epoch 34/50 |loss: 0.127533| train set 5.008x speedup, test set 0.916x speedup, val set 0.767x speedup, step: 1, train time 8.51 s
Epoch 35/50 |loss: 0.129137| train set 5.007x speedup, test set 0.939x speedup, val set 0.733x speedup, step: 2, train time 8.49 s
Epoch 36/50 |loss: 0.128631| train set 5.008x speedup, test set 0.925x speedup, val set 0.791x speedup, step: 3, train time 8.52 s
Epoch 37/50 |loss: 0.128927| train set 4.958x speedup, test set 0.937x speedup, val set 0.733x speedup, step: 4, train time 8.61 s
early stopping at epoch 37
Training per epoch cost 8.659 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 7.660s, pg runtime 3.549s, speedup 0.463x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.866s, pg runtime 1.437s, speedup 0.372x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 11, train speedup 5.008, test speedup 1.034, val speedup 0.729
best validation speedup epoch: 34, train speedup 5.008, test speedup 0.916, val speedup 0.767
last model at epoch 37, train speedup 4.958, test speedup 0.937, val speedup 0.733
execution cost 0:05:53.286482
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.587228, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 9.57 s
Epoch 1/50 |loss: 0.206117| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 8.31 s
Epoch 2/50 |loss: 0.180460| train set 4.715x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 3, train time 8.71 s
Epoch 3/50 |loss: 0.170403| train set 5.007x speedup, test set 1.012x speedup, val set 0.973x speedup, step: 4, train time 8.49 s
Epoch 4/50 |loss: 0.161046| train set 5.008x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 1, train time 8.61 s
Epoch 5/50 |loss: 0.158187| train set 4.958x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 2, train time 8.41 s
Epoch 6/50 |loss: 0.152443| train set 5.008x speedup, test set 0.995x speedup, val set 0.738x speedup, step: 3, train time 8.50 s
Epoch 7/50 |loss: 0.148907| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 4, train time 8.30 s
Epoch 8/50 |loss: 0.149845| train set 4.697x speedup, test set 0.994x speedup, val set 0.957x speedup, step: 5, train time 8.60 s
Epoch 9/50 |loss: 0.147180| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 1, train time 9.11 s
Epoch 10/50 |loss: 0.142443| train set 5.008x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 2, train time 8.60 s
Epoch 11/50 |loss: 0.137903| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 3, train time 8.79 s
Epoch 12/50 |loss: 0.141864| train set 5.007x speedup, test set 1.005x speedup, val set 0.729x speedup, step: 4, train time 8.49 s
Epoch 13/50 |loss: 0.138859| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 5, train time 8.29 s
Epoch 14/50 |loss: 0.138425| train set 4.872x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 1, train time 8.69 s
Epoch 15/50 |loss: 0.137583| train set 4.921x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 2, train time 8.40 s
Epoch 16/50 |loss: 0.136325| train set 4.921x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 3, train time 8.70 s
Epoch 17/50 |loss: 0.136819| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 4, train time 8.41 s
Epoch 18/50 |loss: 0.134575| train set 5.008x speedup, test set 0.972x speedup, val set 0.742x speedup, step: 5, train time 8.39 s
Epoch 19/50 |loss: 0.135188| train set 4.958x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 6, train time 8.60 s
Epoch 20/50 |loss: 0.133783| train set 5.008x speedup, test set 0.983x speedup, val set 0.804x speedup, step: 7, train time 9.31 s
Epoch 21/50 |loss: 0.133427| train set 4.873x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 8, train time 8.70 s
Epoch 22/50 |loss: 0.136633| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 9, train time 8.70 s
Epoch 23/50 |loss: 0.132538| train set 5.008x speedup, test set 0.983x speedup, val set 0.735x speedup, step: 10, train time 8.51 s
Epoch 24/50 |loss: 0.131414| train set 4.921x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 11, train time 8.22 s
Epoch 25/50 |loss: 0.132827| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 12, train time 8.41 s
Epoch 26/50 |loss: 0.130754| train set 5.007x speedup, test set 0.976x speedup, val set 0.739x speedup, step: 13, train time 8.39 s
Epoch 27/50 |loss: 0.131523| train set 4.873x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 14, train time 8.71 s
Epoch 28/50 |loss: 0.129794| train set 5.008x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 15, train time 8.60 s
Epoch 29/50 |loss: 0.131330| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 16, train time 8.41 s
Epoch 30/50 |loss: 0.131419| train set 5.008x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 17, train time 8.49 s
Epoch 31/50 |loss: 0.130854| train set 4.958x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 18, train time 8.60 s
Epoch 32/50 |loss: 0.126632| train set 5.008x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 19, train time 8.12 s
Epoch 33/50 |loss: 0.129021| train set 5.008x speedup, test set 0.976x speedup, val set 0.735x speedup, step: 20, train time 8.41 s
Epoch 34/50 |loss: 0.127423| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 1, train time 8.32 s
Epoch 35/50 |loss: 0.128879| train set 5.008x speedup, test set 1.031x speedup, val set 0.733x speedup, step: 2, train time 8.39 s
Epoch 36/50 |loss: 0.128672| train set 5.008x speedup, test set 0.976x speedup, val set 0.775x speedup, step: 3, train time 8.61 s
Epoch 37/50 |loss: 0.128495| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 4, train time 8.79 s
Epoch 38/50 |loss: 0.130416| train set 4.958x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 5, train time 8.69 s
Epoch 39/50 |loss: 0.127854| train set 5.008x speedup, test set 0.965x speedup, val set 0.742x speedup, step: 1, train time 9.10 s
Epoch 40/50 |loss: 0.125567| train set 5.008x speedup, test set 0.943x speedup, val set 0.735x speedup, step: 2, train time 8.74 s
Epoch 41/50 |loss: 0.127340| train set 4.921x speedup, test set 0.956x speedup, val set 0.729x speedup, step: 3, train time 8.32 s
Epoch 42/50 |loss: 0.127026| train set 5.008x speedup, test set 0.948x speedup, val set 0.735x speedup, step: 4, train time 9.09 s
Epoch 43/50 |loss: 0.126338| train set 5.004x speedup, test set 0.964x speedup, val set 0.809x speedup, step: 5, train time 8.50 s
Epoch 44/50 |loss: 0.127142| train set 4.958x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 6, train time 8.71 s
Epoch 45/50 |loss: 0.128535| train set 5.008x speedup, test set 0.988x speedup, val set 0.742x speedup, step: 7, train time 10.00 s
Epoch 46/50 |loss: 0.127974| train set 4.921x speedup, test set 0.965x speedup, val set 0.742x speedup, step: 8, train time 9.00 s
Epoch 47/50 |loss: 0.125718| train set 5.004x speedup, test set 1.021x speedup, val set 0.746x speedup, step: 9, train time 8.21 s
Epoch 48/50 |loss: 0.127244| train set 4.958x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 10, train time 8.00 s
Epoch 49/50 |loss: 0.125887| train set 4.958x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 11, train time 8.11 s
early stopping at epoch 49
Training per epoch cost 8.603 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 7.179s, pg runtime 5.855s, speedup 0.816x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.763s, pg runtime 1.763s, speedup 1.000x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 35, train speedup 5.008, test speedup 1.031, val speedup 0.733
best validation speedup epoch: 39, train speedup 5.008, test speedup 0.965, val speedup 0.742
last model at epoch 49, train speedup 4.958, test speedup 0.950, val speedup 0.729
execution cost 0:07:39.854082
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.595454, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 9.74 s
Epoch 1/50 |loss: 0.206248| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 8.60 s
Epoch 2/50 |loss: 0.178337| train set 4.715x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 3, train time 8.61 s
Epoch 3/50 |loss: 0.172555| train set 5.007x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 4, train time 8.39 s
Epoch 4/50 |loss: 0.160934| train set 5.008x speedup, test set 0.971x speedup, val set 0.729x speedup, step: 1, train time 8.51 s
Epoch 5/50 |loss: 0.158584| train set 4.958x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 2, train time 8.18 s
Epoch 6/50 |loss: 0.152078| train set 5.000x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 3, train time 8.40 s
Epoch 7/50 |loss: 0.149812| train set 5.008x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 4, train time 8.60 s
Epoch 8/50 |loss: 0.149578| train set 5.008x speedup, test set 0.985x speedup, val set 0.729x speedup, step: 5, train time 8.40 s
Epoch 9/50 |loss: 0.148281| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 1, train time 8.62 s
Epoch 10/50 |loss: 0.144266| train set 5.008x speedup, test set 0.972x speedup, val set 0.729x speedup, step: 2, train time 8.40 s
Epoch 11/50 |loss: 0.138248| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 3, train time 8.72 s
Epoch 12/50 |loss: 0.142474| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 4, train time 8.42 s
Epoch 13/50 |loss: 0.137661| train set 4.988x speedup, test set 0.959x speedup, val set 0.735x speedup, step: 5, train time 8.59 s
Epoch 14/50 |loss: 0.137790| train set 4.872x speedup, test set 0.967x speedup, val set 0.735x speedup, step: 1, train time 8.81 s
Epoch 15/50 |loss: 0.137666| train set 4.921x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 2, train time 8.60 s
Epoch 16/50 |loss: 0.135922| train set 4.921x speedup, test set 0.973x speedup, val set 0.742x speedup, step: 3, train time 8.51 s
Epoch 17/50 |loss: 0.137444| train set 5.008x speedup, test set 1.004x speedup, val set 0.729x speedup, step: 4, train time 8.41 s
Epoch 18/50 |loss: 0.134431| train set 5.008x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 5, train time 8.40 s
Epoch 19/50 |loss: 0.135697| train set 4.958x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 6, train time 8.12 s
Epoch 20/50 |loss: 0.133827| train set 5.008x speedup, test set 0.989x speedup, val set 0.795x speedup, step: 7, train time 9.10 s
Epoch 21/50 |loss: 0.133769| train set 4.873x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 8, train time 8.71 s
Epoch 22/50 |loss: 0.136830| train set 5.008x speedup, test set 1.007x speedup, val set 0.735x speedup, step: 9, train time 8.49 s
Epoch 23/50 |loss: 0.132563| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 10, train time 8.11 s
Epoch 24/50 |loss: 0.130721| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 11, train time 8.72 s
Epoch 25/50 |loss: 0.132083| train set 5.008x speedup, test set 0.983x speedup, val set 0.742x speedup, step: 12, train time 8.61 s
Epoch 26/50 |loss: 0.130456| train set 4.957x speedup, test set 0.989x speedup, val set 0.739x speedup, step: 13, train time 8.50 s
Epoch 27/50 |loss: 0.131200| train set 4.865x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 14, train time 8.61 s
Epoch 28/50 |loss: 0.129733| train set 5.008x speedup, test set 0.989x speedup, val set 0.746x speedup, step: 15, train time 8.38 s
Epoch 29/50 |loss: 0.131743| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 16, train time 8.60 s
Epoch 30/50 |loss: 0.131862| train set 5.007x speedup, test set 0.976x speedup, val set 0.739x speedup, step: 17, train time 8.60 s
Epoch 31/50 |loss: 0.129884| train set 4.873x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 18, train time 8.51 s
Epoch 32/50 |loss: 0.127413| train set 4.960x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 19, train time 8.81 s
Epoch 33/50 |loss: 0.127982| train set 5.008x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 20, train time 8.51 s
Epoch 34/50 |loss: 0.127886| train set 5.008x speedup, test set 0.948x speedup, val set 0.733x speedup, step: 21, train time 8.40 s
Epoch 35/50 |loss: 0.128783| train set 5.008x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 22, train time 8.60 s
Epoch 36/50 |loss: 0.128878| train set 5.008x speedup, test set 0.997x speedup, val set 0.809x speedup, step: 23, train time 8.60 s
Epoch 37/50 |loss: 0.128161| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 24, train time 8.50 s
Epoch 38/50 |loss: 0.129575| train set 4.958x speedup, test set 0.947x speedup, val set 0.729x speedup, step: 25, train time 8.80 s
Epoch 39/50 |loss: 0.128927| train set 5.008x speedup, test set 0.948x speedup, val set 0.729x speedup, step: 26, train time 8.49 s
Epoch 40/50 |loss: 0.125137| train set 4.921x speedup, test set 0.935x speedup, val set 0.733x speedup, step: 27, train time 8.41 s
Epoch 41/50 |loss: 0.126495| train set 5.008x speedup, test set 0.946x speedup, val set 0.746x speedup, step: 28, train time 8.30 s
Epoch 42/50 |loss: 0.127226| train set 5.008x speedup, test set 0.925x speedup, val set 0.733x speedup, step: 29, train time 8.80 s
Epoch 43/50 |loss: 0.126674| train set 4.916x speedup, test set 0.935x speedup, val set 0.809x speedup, step: 30, train time 8.51 s
Epoch 44/50 |loss: 0.127725| train set 4.958x speedup, test set 0.946x speedup, val set 0.733x speedup, step: 31, train time 8.72 s
Epoch 45/50 |loss: 0.127505| train set 5.008x speedup, test set 0.935x speedup, val set 0.735x speedup, step: 32, train time 8.62 s
Epoch 46/50 |loss: 0.127066| train set 4.921x speedup, test set 0.948x speedup, val set 0.729x speedup, step: 33, train time 8.72 s
Epoch 47/50 |loss: 0.124407| train set 5.008x speedup, test set 0.989x speedup, val set 0.739x speedup, step: 34, train time 8.80 s
Epoch 48/50 |loss: 0.126729| train set 4.958x speedup, test set 0.988x speedup, val set 0.746x speedup, step: 35, train time 9.01 s
Epoch 49/50 |loss: 0.126461| train set 4.958x speedup, test set 0.948x speedup, val set 0.733x speedup, step: 36, train time 8.52 s
early stopping at epoch 49
Training per epoch cost 8.581 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 1, train speedup 4.864, test speedup 1.020, val speedup 1.033
best validation speedup epoch: 14, train speedup 4.872, test speedup 0.967, val speedup 0.735
last model at epoch 49, train speedup 4.958, test speedup 0.948, val speedup 0.733
execution cost 0:07:39.162080
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: pair
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 50
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/pair_wo_weighted
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
(140, 49)
(140, 49)
construct training samples cost 0:00:00.605543, and there are 12980 training samples
in channel 9
Epoch 0/50 |loss: 0.336347| train set 5.008x speedup, test set 1.010x speedup, val set 1.008x speedup, step: 1, train time 9.92 s
Epoch 1/50 |loss: 0.206117| train set 4.864x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 2, train time 8.92 s
Epoch 2/50 |loss: 0.179958| train set 4.715x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 3, train time 8.80 s
Epoch 3/50 |loss: 0.170626| train set 5.008x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 4, train time 8.32 s
Epoch 4/50 |loss: 0.161625| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 1, train time 8.50 s
Epoch 5/50 |loss: 0.157621| train set 4.958x speedup, test set 1.009x speedup, val set 0.729x speedup, step: 2, train time 8.80 s
Epoch 6/50 |loss: 0.152484| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 3, train time 8.91 s
Epoch 7/50 |loss: 0.149314| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 4, train time 8.80 s
Epoch 8/50 |loss: 0.150912| train set 4.697x speedup, test set 1.012x speedup, val set 0.733x speedup, step: 5, train time 8.51 s
Epoch 9/50 |loss: 0.150326| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 1, train time 9.29 s
Epoch 10/50 |loss: 0.143783| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 2, train time 9.57 s
Epoch 11/50 |loss: 0.139322| train set 5.007x speedup, test set 1.004x speedup, val set 0.729x speedup, step: 3, train time 9.51 s
Epoch 12/50 |loss: 0.143077| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 4, train time 8.40 s
Epoch 13/50 |loss: 0.138641| train set 5.008x speedup, test set 0.971x speedup, val set 0.729x speedup, step: 5, train time 8.39 s
Epoch 14/50 |loss: 0.137483| train set 4.920x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 1, train time 8.71 s
Epoch 15/50 |loss: 0.138274| train set 4.921x speedup, test set 0.992x speedup, val set 0.735x speedup, step: 2, train time 8.50 s
Epoch 16/50 |loss: 0.136133| train set 4.921x speedup, test set 0.967x speedup, val set 0.735x speedup, step: 3, train time 8.81 s
Epoch 17/50 |loss: 0.137923| train set 5.008x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 4, train time 8.69 s
Epoch 18/50 |loss: 0.134657| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 5, train time 8.61 s
Epoch 19/50 |loss: 0.135625| train set 4.958x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 1, train time 8.90 s
Epoch 20/50 |loss: 0.134039| train set 4.921x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 2, train time 9.00 s
Epoch 21/50 |loss: 0.134216| train set 4.873x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 3, train time 8.59 s
Epoch 22/50 |loss: 0.135851| train set 5.008x speedup, test set 0.977x speedup, val set 0.742x speedup, step: 4, train time 8.42 s
Epoch 23/50 |loss: 0.132137| train set 5.008x speedup, test set 0.965x speedup, val set 0.735x speedup, step: 5, train time 8.70 s
Epoch 24/50 |loss: 0.130929| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 1, train time 8.51 s
Epoch 25/50 |loss: 0.131148| train set 5.008x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 2, train time 8.89 s
Epoch 26/50 |loss: 0.130399| train set 5.008x speedup, test set 1.010x speedup, val set 0.739x speedup, step: 3, train time 8.82 s
Epoch 27/50 |loss: 0.131074| train set 4.921x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 4, train time 8.92 s
Epoch 28/50 |loss: 0.130305| train set 5.008x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 5, train time 8.98 s
Epoch 29/50 |loss: 0.129632| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 1, train time 10.08 s
Epoch 30/50 |loss: 0.130875| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 2, train time 8.50 s
Epoch 31/50 |loss: 0.130363| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 3, train time 8.31 s
Epoch 32/50 |loss: 0.127815| train set 4.958x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 4, train time 8.51 s
Epoch 33/50 |loss: 0.129594| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 5, train time 8.60 s
Epoch 34/50 |loss: 0.127588| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 1, train time 8.42 s
Epoch 35/50 |loss: 0.128721| train set 5.008x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 2, train time 8.61 s
Epoch 36/50 |loss: 0.128341| train set 5.008x speedup, test set 0.964x speedup, val set 0.795x speedup, step: 3, train time 8.58 s
Epoch 37/50 |loss: 0.130455| train set 4.921x speedup, test set 0.990x speedup, val set 0.742x speedup, step: 4, train time 8.99 s
Epoch 38/50 |loss: 0.130377| train set 4.958x speedup, test set 0.957x speedup, val set 0.729x speedup, step: 5, train time 8.97 s
early stopping at epoch 38
Training per epoch cost 8.801 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 3.482s, pg runtime 1.357s, speedup 0.390x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 0, train speedup 5.008, test speedup 1.010, val speedup 1.008
best test speedup epoch: 1, train speedup 4.864, test speedup 1.020, val speedup 1.033
best validation speedup epoch: 34, train speedup 5.008, test speedup 0.989, val speedup 0.742
last model at epoch 38, train speedup 4.958, test speedup 0.957, val speedup 0.729
execution cost 0:06:08.388023
==================================================
