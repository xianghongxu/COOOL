all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.753102, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004529| train set 3.550x speedup, test set 1.380x speedup, val set 3.472x speedup, step: 2
Epoch 6/300 |loss: 0.003493| train set 4.145x speedup, test set 1.350x speedup, val set 4.104x speedup, step: 1
Epoch 7/300 |loss: 0.004846| train set 4.787x speedup, test set 1.632x speedup, val set 4.840x speedup, step: 1
Epoch 8/300 |loss: 0.003373| train set 3.771x speedup, test set 0.856x speedup, val set 3.771x speedup, step: 2
Epoch 9/300 |loss: 0.002805| train set 4.680x speedup, test set 0.757x speedup, val set 4.684x speedup, step: 3
Epoch 10/300 |loss: 0.002647| train set 5.104x speedup, test set 0.812x speedup, val set 5.126x speedup, step: 1
Epoch 11/300 |loss: 0.002680| train set 3.888x speedup, test set 0.905x speedup, val set 3.806x speedup, step: 2
Epoch 12/300 |loss: 0.003829| train set 5.271x speedup, test set 1.912x speedup, val set 5.293x speedup, step: 1
Epoch 13/300 |loss: 0.002341| train set 4.324x speedup, test set 0.939x speedup, val set 4.665x speedup, step: 2
Epoch 14/300 |loss: 0.001793| train set 4.778x speedup, test set 0.922x speedup, val set 4.819x speedup, step: 3
Epoch 15/300 |loss: 0.001687| train set 4.651x speedup, test set 0.514x speedup, val set 4.647x speedup, step: 4
Epoch 16/300 |loss: 0.001574| train set 4.785x speedup, test set 1.712x speedup, val set 4.838x speedup, step: 5
Epoch 17/300 |loss: 0.001432| train set 5.137x speedup, test set 0.524x speedup, val set 5.167x speedup, step: 6
Epoch 18/300 |loss: 0.001217| train set 4.860x speedup, test set 0.740x speedup, val set 5.308x speedup, step: 1
Epoch 19/300 |loss: 0.001120| train set 5.305x speedup, test set 0.740x speedup, val set 5.323x speedup, step: 1
Epoch 20/300 |loss: 0.001103| train set 5.220x speedup, test set 0.733x speedup, val set 5.266x speedup, step: 2
Epoch 21/300 |loss: 0.001226| train set 5.249x speedup, test set 0.672x speedup, val set 5.269x speedup, step: 3
Epoch 22/300 |loss: 0.001066| train set 5.268x speedup, test set 0.696x speedup, val set 5.282x speedup, step: 4
Epoch 23/300 |loss: 0.000860| train set 5.300x speedup, test set 0.699x speedup, val set 5.323x speedup, step: 5
Epoch 24/300 |loss: 0.000813| train set 5.308x speedup, test set 0.519x speedup, val set 5.329x speedup, step: 1
Epoch 25/300 |loss: 0.000835| train set 5.255x speedup, test set 0.760x speedup, val set 5.269x speedup, step: 2
Epoch 26/300 |loss: 0.000925| train set 5.282x speedup, test set 0.714x speedup, val set 5.306x speedup, step: 3
Epoch 27/300 |loss: 0.000775| train set 5.307x speedup, test set 1.562x speedup, val set 5.330x speedup, step: 1
Epoch 28/300 |loss: 0.000830| train set 5.256x speedup, test set 0.887x speedup, val set 5.272x speedup, step: 2
Epoch 29/300 |loss: 0.000750| train set 5.307x speedup, test set 0.657x speedup, val set 5.330x speedup, step: 1
Epoch 30/300 |loss: 0.000803| train set 5.305x speedup, test set 0.694x speedup, val set 5.326x speedup, step: 2
Epoch 31/300 |loss: 0.000746| train set 5.296x speedup, test set 0.680x speedup, val set 5.324x speedup, step: 3
Epoch 32/300 |loss: 0.000642| train set 5.296x speedup, test set 1.532x speedup, val set 5.316x speedup, step: 4
Epoch 33/300 |loss: 0.000736| train set 5.304x speedup, test set 0.913x speedup, val set 5.323x speedup, step: 5
Epoch 34/300 |loss: 0.000690| train set 5.304x speedup, test set 1.807x speedup, val set 5.323x speedup, step: 6
Epoch 35/300 |loss: 0.000983| train set 5.305x speedup, test set 0.530x speedup, val set 5.334x speedup, step: 1
Epoch 36/300 |loss: 0.000803| train set 5.290x speedup, test set 0.731x speedup, val set 5.309x speedup, step: 2
early stopping at epoch 36
Training per epoch cost 0.882 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.084s, pg runtime 0.086s, speedup 1.022x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 4.653s, pg runtime 0.250s, speedup 0.054x
====================
best train speedup epoch: 24, train speedup 5.308, test speedup 0.519, val speedup 5.329
best test speedup epoch: 12, train speedup 5.271, test speedup 1.912, val speedup 5.293
best validation speedup epoch: 35, train speedup 5.305, test speedup 0.530, val speedup 5.334
last model at epoch 36, train speedup 5.290, test speedup 0.731, val speedup 5.309
execution cost 0:01:42.595478
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.851811, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004529| train set 3.550x speedup, test set 1.380x speedup, val set 3.472x speedup, step: 2
Epoch 6/300 |loss: 0.003495| train set 4.145x speedup, test set 1.350x speedup, val set 4.104x speedup, step: 1
Epoch 7/300 |loss: 0.004754| train set 4.594x speedup, test set 1.567x speedup, val set 4.828x speedup, step: 1
Epoch 8/300 |loss: 0.003330| train set 3.782x speedup, test set 0.850x speedup, val set 3.784x speedup, step: 2
Epoch 9/300 |loss: 0.002785| train set 4.680x speedup, test set 1.346x speedup, val set 4.675x speedup, step: 3
Epoch 10/300 |loss: 0.002630| train set 5.203x speedup, test set 0.878x speedup, val set 5.229x speedup, step: 1
Epoch 11/300 |loss: 0.002529| train set 4.784x speedup, test set 0.518x speedup, val set 5.299x speedup, step: 1
Epoch 12/300 |loss: 0.004037| train set 5.187x speedup, test set 1.386x speedup, val set 5.205x speedup, step: 2
Epoch 13/300 |loss: 0.002074| train set 4.168x speedup, test set 0.891x speedup, val set 4.181x speedup, step: 3
Epoch 14/300 |loss: 0.001757| train set 5.222x speedup, test set 0.799x speedup, val set 5.266x speedup, step: 4
Epoch 15/300 |loss: 0.001701| train set 5.005x speedup, test set 0.498x speedup, val set 4.993x speedup, step: 5
Epoch 16/300 |loss: 0.001584| train set 5.118x speedup, test set 1.447x speedup, val set 5.168x speedup, step: 6
Epoch 17/300 |loss: 0.001373| train set 5.248x speedup, test set 0.919x speedup, val set 5.265x speedup, step: 7
Epoch 18/300 |loss: 0.001221| train set 5.069x speedup, test set 0.519x speedup, val set 5.316x speedup, step: 1
Epoch 19/300 |loss: 0.001089| train set 5.305x speedup, test set 0.525x speedup, val set 5.326x speedup, step: 1
Epoch 20/300 |loss: 0.001048| train set 5.166x speedup, test set 0.495x speedup, val set 5.204x speedup, step: 2
Epoch 21/300 |loss: 0.001220| train set 5.254x speedup, test set 0.623x speedup, val set 5.267x speedup, step: 3
Epoch 22/300 |loss: 0.000958| train set 5.290x speedup, test set 0.708x speedup, val set 5.311x speedup, step: 4
Epoch 23/300 |loss: 0.000925| train set 5.249x speedup, test set 0.641x speedup, val set 5.259x speedup, step: 5
Epoch 24/300 |loss: 0.000880| train set 5.305x speedup, test set 0.494x speedup, val set 5.334x speedup, step: 1
Epoch 25/300 |loss: 0.000737| train set 5.297x speedup, test set 1.352x speedup, val set 5.316x speedup, step: 2
Epoch 26/300 |loss: 0.000836| train set 5.305x speedup, test set 0.674x speedup, val set 5.334x speedup, step: 1
Epoch 27/300 |loss: 0.000755| train set 5.304x speedup, test set 0.665x speedup, val set 5.328x speedup, step: 2
Epoch 28/300 |loss: 0.001183| train set 5.174x speedup, test set 0.504x speedup, val set 5.204x speedup, step: 3
Epoch 29/300 |loss: 0.001023| train set 5.307x speedup, test set 1.366x speedup, val set 5.332x speedup, step: 4
Epoch 30/300 |loss: 0.000734| train set 5.305x speedup, test set 1.702x speedup, val set 5.326x speedup, step: 5
Epoch 31/300 |loss: 0.000704| train set 5.284x speedup, test set 1.757x speedup, val set 5.310x speedup, step: 6
Epoch 32/300 |loss: 0.000647| train set 5.293x speedup, test set 1.712x speedup, val set 5.309x speedup, step: 7
Epoch 33/300 |loss: 0.000758| train set 5.294x speedup, test set 0.706x speedup, val set 5.327x speedup, step: 8
Epoch 34/300 |loss: 0.000673| train set 5.308x speedup, test set 0.706x speedup, val set 5.330x speedup, step: 9
Epoch 35/300 |loss: 0.000859| train set 5.247x speedup, test set 0.505x speedup, val set 5.272x speedup, step: 10
Epoch 36/300 |loss: 0.000814| train set 5.297x speedup, test set 0.518x speedup, val set 5.317x speedup, step: 11
early stopping at epoch 36
Training per epoch cost 0.873 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 2.252s, pg runtime 53.885s, speedup 23.927x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.371s, pg runtime 0.313s, speedup 0.844x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.520s, pg runtime 0.354s, speedup 0.681x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.556s, pg runtime 0.189s, speedup 0.340x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.089s, pg runtime 0.112s, speedup 1.262x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 4.653s, pg runtime 0.250s, speedup 0.054x
====================
best train speedup epoch: 34, train speedup 5.308, test speedup 0.706, val speedup 5.330
best test speedup epoch: 31, train speedup 5.284, test speedup 1.757, val speedup 5.310
best validation speedup epoch: 26, train speedup 5.305, test speedup 0.674, val speedup 5.334
last model at epoch 36, train speedup 5.297, test speedup 0.518, val speedup 5.317
execution cost 0:01:43.183377
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.725995, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004568| train set 3.550x speedup, test set 1.438x speedup, val set 3.468x speedup, step: 2
Epoch 6/300 |loss: 0.003504| train set 4.138x speedup, test set 1.350x speedup, val set 4.093x speedup, step: 1
Epoch 7/300 |loss: 0.004804| train set 4.857x speedup, test set 1.521x speedup, val set 4.900x speedup, step: 1
Epoch 8/300 |loss: 0.003282| train set 4.179x speedup, test set 0.760x speedup, val set 4.178x speedup, step: 2
Epoch 9/300 |loss: 0.002722| train set 4.680x speedup, test set 1.395x speedup, val set 4.675x speedup, step: 3
Epoch 10/300 |loss: 0.002634| train set 4.630x speedup, test set 1.416x speedup, val set 4.615x speedup, step: 4
Epoch 11/300 |loss: 0.002499| train set 4.808x speedup, test set 0.552x speedup, val set 5.237x speedup, step: 1
Epoch 12/300 |loss: 0.003884| train set 5.161x speedup, test set 2.079x speedup, val set 5.185x speedup, step: 2
Epoch 13/300 |loss: 0.002182| train set 4.155x speedup, test set 0.543x speedup, val set 4.165x speedup, step: 3
Epoch 14/300 |loss: 0.001804| train set 4.866x speedup, test set 0.955x speedup, val set 4.906x speedup, step: 4
Epoch 15/300 |loss: 0.001701| train set 5.154x speedup, test set 0.515x speedup, val set 5.188x speedup, step: 5
Epoch 16/300 |loss: 0.001681| train set 5.127x speedup, test set 0.482x speedup, val set 5.174x speedup, step: 6
Epoch 17/300 |loss: 0.001420| train set 4.925x speedup, test set 0.507x speedup, val set 5.176x speedup, step: 7
Epoch 18/300 |loss: 0.001189| train set 4.867x speedup, test set 0.521x speedup, val set 5.316x speedup, step: 1
Epoch 19/300 |loss: 0.001050| train set 5.307x speedup, test set 0.529x speedup, val set 5.326x speedup, step: 1
Epoch 20/300 |loss: 0.001093| train set 5.223x speedup, test set 0.528x speedup, val set 5.267x speedup, step: 2
Epoch 21/300 |loss: 0.001199| train set 5.307x speedup, test set 0.509x speedup, val set 5.330x speedup, step: 1
Epoch 22/300 |loss: 0.000917| train set 5.290x speedup, test set 0.514x speedup, val set 5.309x speedup, step: 2
Epoch 23/300 |loss: 0.000917| train set 5.300x speedup, test set 0.502x speedup, val set 5.326x speedup, step: 3
Epoch 24/300 |loss: 0.000818| train set 5.306x speedup, test set 0.516x speedup, val set 5.336x speedup, step: 1
Epoch 25/300 |loss: 0.000760| train set 5.307x speedup, test set 0.509x speedup, val set 5.329x speedup, step: 2
Epoch 26/300 |loss: 0.000835| train set 5.304x speedup, test set 0.502x speedup, val set 5.325x speedup, step: 3
Epoch 27/300 |loss: 0.000733| train set 5.254x speedup, test set 0.502x speedup, val set 5.267x speedup, step: 4
Epoch 28/300 |loss: 0.000826| train set 5.308x speedup, test set 0.512x speedup, val set 5.335x speedup, step: 5
Epoch 29/300 |loss: 0.000786| train set 5.308x speedup, test set 0.498x speedup, val set 5.332x speedup, step: 6
Epoch 30/300 |loss: 0.000826| train set 5.308x speedup, test set 0.524x speedup, val set 5.330x speedup, step: 7
Epoch 31/300 |loss: 0.000711| train set 5.285x speedup, test set 0.515x speedup, val set 5.310x speedup, step: 8
Epoch 32/300 |loss: 0.000647| train set 5.295x speedup, test set 0.525x speedup, val set 5.313x speedup, step: 9
Epoch 33/300 |loss: 0.000709| train set 5.311x speedup, test set 0.511x speedup, val set 5.334x speedup, step: 10
Epoch 34/300 |loss: 0.000672| train set 5.304x speedup, test set 0.495x speedup, val set 5.329x speedup, step: 11
Epoch 35/300 |loss: 0.001117| train set 5.255x speedup, test set 0.512x speedup, val set 5.274x speedup, step: 12
Epoch 36/300 |loss: 0.000814| train set 5.295x speedup, test set 0.509x speedup, val set 5.313x speedup, step: 13
early stopping at epoch 36
Training per epoch cost 0.869 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.875s, pg runtime 2.352s, speedup 2.688x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.371s, pg runtime 0.313s, speedup 0.844x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.369s, pg runtime 0.354s, speedup 0.960x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 4.653s, pg runtime 0.250s, speedup 0.054x
====================
best train speedup epoch: 33, train speedup 5.311, test speedup 0.511, val speedup 5.334
best test speedup epoch: 12, train speedup 5.161, test speedup 2.079, val speedup 5.185
best validation speedup epoch: 24, train speedup 5.306, test speedup 0.516, val speedup 5.336
last model at epoch 36, train speedup 5.295, test speedup 0.509, val speedup 5.313
execution cost 0:01:42.350304
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.961092, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004529| train set 3.447x speedup, test set 1.447x speedup, val set 3.388x speedup, step: 2
Epoch 6/300 |loss: 0.003494| train set 4.149x speedup, test set 1.259x speedup, val set 4.107x speedup, step: 1
Epoch 7/300 |loss: 0.004729| train set 4.787x speedup, test set 1.538x speedup, val set 4.840x speedup, step: 1
Epoch 8/300 |loss: 0.003511| train set 3.782x speedup, test set 0.937x speedup, val set 3.784x speedup, step: 2
Epoch 9/300 |loss: 0.002758| train set 4.700x speedup, test set 1.565x speedup, val set 4.698x speedup, step: 3
Epoch 10/300 |loss: 0.002665| train set 5.204x speedup, test set 0.798x speedup, val set 5.227x speedup, step: 1
Epoch 11/300 |loss: 0.002653| train set 4.852x speedup, test set 0.986x speedup, val set 5.300x speedup, step: 1
Epoch 12/300 |loss: 0.003642| train set 5.183x speedup, test set 1.658x speedup, val set 5.167x speedup, step: 2
Epoch 13/300 |loss: 0.002243| train set 4.163x speedup, test set 0.991x speedup, val set 4.174x speedup, step: 3
Epoch 14/300 |loss: 0.001762| train set 4.770x speedup, test set 0.962x speedup, val set 4.815x speedup, step: 4
Epoch 15/300 |loss: 0.001695| train set 4.651x speedup, test set 0.503x speedup, val set 4.647x speedup, step: 5
Epoch 16/300 |loss: 0.001665| train set 5.125x speedup, test set 0.700x speedup, val set 5.174x speedup, step: 6
Epoch 17/300 |loss: 0.001497| train set 4.925x speedup, test set 0.513x speedup, val set 5.173x speedup, step: 7
Epoch 18/300 |loss: 0.001261| train set 4.870x speedup, test set 0.725x speedup, val set 5.322x speedup, step: 1
Epoch 19/300 |loss: 0.001215| train set 5.302x speedup, test set 0.700x speedup, val set 5.322x speedup, step: 1
Epoch 20/300 |loss: 0.001239| train set 4.923x speedup, test set 0.502x speedup, val set 5.187x speedup, step: 2
Epoch 21/300 |loss: 0.001263| train set 5.170x speedup, test set 0.501x speedup, val set 5.204x speedup, step: 3
Epoch 22/300 |loss: 0.000981| train set 5.290x speedup, test set 0.726x speedup, val set 5.308x speedup, step: 4
Epoch 23/300 |loss: 0.000950| train set 5.224x speedup, test set 0.746x speedup, val set 5.273x speedup, step: 5
Epoch 24/300 |loss: 0.000911| train set 5.076x speedup, test set 0.506x speedup, val set 5.333x speedup, step: 1
Epoch 25/300 |loss: 0.000822| train set 5.254x speedup, test set 0.728x speedup, val set 5.263x speedup, step: 2
Epoch 26/300 |loss: 0.000887| train set 5.308x speedup, test set 0.708x speedup, val set 5.330x speedup, step: 3
Epoch 27/300 |loss: 0.000774| train set 5.308x speedup, test set 1.475x speedup, val set 5.332x speedup, step: 4
Epoch 28/300 |loss: 0.001177| train set 5.199x speedup, test set 0.513x speedup, val set 5.226x speedup, step: 5
Epoch 29/300 |loss: 0.000793| train set 5.248x speedup, test set 0.701x speedup, val set 5.261x speedup, step: 6
Epoch 30/300 |loss: 0.000764| train set 5.305x speedup, test set 1.800x speedup, val set 5.323x speedup, step: 7
Epoch 31/300 |loss: 0.000756| train set 5.284x speedup, test set 0.726x speedup, val set 5.310x speedup, step: 8
Epoch 32/300 |loss: 0.000652| train set 5.293x speedup, test set 0.506x speedup, val set 5.309x speedup, step: 9
Epoch 33/300 |loss: 0.000748| train set 5.301x speedup, test set 0.518x speedup, val set 5.326x speedup, step: 10
Epoch 34/300 |loss: 0.000715| train set 5.307x speedup, test set 0.724x speedup, val set 5.330x speedup, step: 11
Epoch 35/300 |loss: 0.001100| train set 5.251x speedup, test set 0.506x speedup, val set 5.271x speedup, step: 12
Epoch 36/300 |loss: 0.000860| train set 5.296x speedup, test set 0.519x speedup, val set 5.324x speedup, step: 13
early stopping at epoch 36
Training per epoch cost 0.889 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.469s, pg runtime 0.453s, speedup 0.967x
17, opt runtime 0.327s, model runtime 0.449s, pg runtime 0.354s, speedup 0.788x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 0.024s, pg runtime 0.023s, speedup 0.971x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 27, train speedup 5.308, test speedup 1.475, val speedup 5.332
best test speedup epoch: 30, train speedup 5.305, test speedup 1.800, val speedup 5.323
best validation speedup epoch: 24, train speedup 5.076, test speedup 0.506, val speedup 5.333
last model at epoch 36, train speedup 5.296, test speedup 0.519, val speedup 5.324
execution cost 0:01:44.306592
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.905784, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014859| train set 2.920x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008823| train set 3.272x speedup, test set 1.614x speedup, val set 3.210x speedup, step: 1
Epoch 3/300 |loss: 0.005987| train set 3.318x speedup, test set 1.493x speedup, val set 3.213x speedup, step: 1
Epoch 4/300 |loss: 0.004841| train set 3.495x speedup, test set 0.843x speedup, val set 3.451x speedup, step: 1
Epoch 5/300 |loss: 0.004502| train set 3.559x speedup, test set 0.784x speedup, val set 3.478x speedup, step: 1
Epoch 6/300 |loss: 0.003575| train set 4.155x speedup, test set 1.487x speedup, val set 4.103x speedup, step: 1
Epoch 7/300 |loss: 0.004522| train set 4.856x speedup, test set 0.824x speedup, val set 4.906x speedup, step: 1
Epoch 8/300 |loss: 0.003177| train set 4.500x speedup, test set 0.798x speedup, val set 4.907x speedup, step: 1
Epoch 9/300 |loss: 0.002769| train set 4.636x speedup, test set 1.666x speedup, val set 4.646x speedup, step: 2
Epoch 10/300 |loss: 0.002468| train set 5.172x speedup, test set 1.308x speedup, val set 5.233x speedup, step: 1
Epoch 11/300 |loss: 0.002347| train set 4.146x speedup, test set 0.880x speedup, val set 4.155x speedup, step: 2
Epoch 12/300 |loss: 0.003243| train set 5.036x speedup, test set 1.583x speedup, val set 5.067x speedup, step: 3
Epoch 13/300 |loss: 0.002122| train set 4.168x speedup, test set 0.901x speedup, val set 4.181x speedup, step: 4
Epoch 14/300 |loss: 0.001712| train set 4.923x speedup, test set 0.864x speedup, val set 5.179x speedup, step: 5
Epoch 15/300 |loss: 0.001736| train set 5.161x speedup, test set 0.863x speedup, val set 5.193x speedup, step: 6
Epoch 16/300 |loss: 0.001607| train set 5.108x speedup, test set 0.886x speedup, val set 5.152x speedup, step: 7
Epoch 17/300 |loss: 0.001500| train set 4.758x speedup, test set 0.874x speedup, val set 5.197x speedup, step: 8
Epoch 18/300 |loss: 0.001307| train set 4.872x speedup, test set 0.876x speedup, val set 5.324x speedup, step: 1
Epoch 19/300 |loss: 0.001460| train set 5.299x speedup, test set 0.854x speedup, val set 5.317x speedup, step: 2
Epoch 20/300 |loss: 0.001245| train set 5.165x speedup, test set 0.854x speedup, val set 5.204x speedup, step: 3
Epoch 21/300 |loss: 0.001448| train set 5.299x speedup, test set 0.854x speedup, val set 5.332x speedup, step: 1
Epoch 22/300 |loss: 0.001435| train set 5.269x speedup, test set 0.873x speedup, val set 5.286x speedup, step: 2
Epoch 23/300 |loss: 0.000932| train set 5.244x speedup, test set 0.855x speedup, val set 5.254x speedup, step: 3
Epoch 24/300 |loss: 0.000730| train set 5.304x speedup, test set 0.855x speedup, val set 5.323x speedup, step: 4
Epoch 25/300 |loss: 0.000779| train set 5.292x speedup, test set 0.805x speedup, val set 5.320x speedup, step: 5
Epoch 26/300 |loss: 0.000955| train set 5.305x speedup, test set 0.853x speedup, val set 5.334x speedup, step: 1
Epoch 27/300 |loss: 0.000843| train set 5.300x speedup, test set 0.797x speedup, val set 5.328x speedup, step: 2
Epoch 28/300 |loss: 0.000943| train set 5.214x speedup, test set 0.855x speedup, val set 5.242x speedup, step: 3
Epoch 29/300 |loss: 0.000873| train set 5.299x speedup, test set 0.501x speedup, val set 5.332x speedup, step: 4
Epoch 30/300 |loss: 0.000826| train set 5.305x speedup, test set 0.855x speedup, val set 5.326x speedup, step: 5
Epoch 31/300 |loss: 0.000721| train set 5.306x speedup, test set 0.852x speedup, val set 5.336x speedup, step: 1
Epoch 32/300 |loss: 0.000724| train set 5.294x speedup, test set 0.852x speedup, val set 5.309x speedup, step: 2
Epoch 33/300 |loss: 0.000903| train set 5.264x speedup, test set 0.864x speedup, val set 5.285x speedup, step: 3
Epoch 34/300 |loss: 0.000636| train set 5.291x speedup, test set 0.869x speedup, val set 5.303x speedup, step: 4
Epoch 35/300 |loss: 0.001430| train set 5.171x speedup, test set 0.864x speedup, val set 5.207x speedup, step: 5
Epoch 36/300 |loss: 0.000776| train set 5.305x speedup, test set 0.918x speedup, val set 5.334x speedup, step: 6
Epoch 37/300 |loss: 0.001314| train set 5.304x speedup, test set 0.800x speedup, val set 5.322x speedup, step: 7
Epoch 38/300 |loss: 0.000773| train set 5.297x speedup, test set 0.497x speedup, val set 5.317x speedup, step: 8
Epoch 39/300 |loss: 0.000697| train set 5.311x speedup, test set 0.843x speedup, val set 5.334x speedup, step: 9
Epoch 40/300 |loss: 0.000645| train set 5.298x speedup, test set 0.867x speedup, val set 5.326x speedup, step: 10
Epoch 41/300 |loss: 0.000646| train set 5.311x speedup, test set 0.506x speedup, val set 5.334x speedup, step: 11
Epoch 42/300 |loss: 0.000608| train set 5.298x speedup, test set 0.855x speedup, val set 5.321x speedup, step: 12
Epoch 43/300 |loss: 0.000629| train set 5.289x speedup, test set 0.856x speedup, val set 5.309x speedup, step: 13
Epoch 44/300 |loss: 0.000651| train set 5.308x speedup, test set 0.853x speedup, val set 5.332x speedup, step: 14
Epoch 45/300 |loss: 0.000626| train set 5.307x speedup, test set 0.903x speedup, val set 5.341x speedup, step: 1
Epoch 46/300 |loss: 0.000632| train set 5.308x speedup, test set 1.416x speedup, val set 5.332x speedup, step: 2
Epoch 47/300 |loss: 0.000627| train set 5.308x speedup, test set 0.890x speedup, val set 5.332x speedup, step: 3
Epoch 48/300 |loss: 0.000654| train set 5.297x speedup, test set 0.859x speedup, val set 5.317x speedup, step: 4
Epoch 49/300 |loss: 0.000652| train set 5.309x speedup, test set 0.855x speedup, val set 5.337x speedup, step: 5
early stopping at epoch 49
Training per epoch cost 0.862 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 39, train speedup 5.311, test speedup 0.843, val speedup 5.334
best test speedup epoch: 9, train speedup 4.636, test speedup 1.666, val speedup 4.646
best validation speedup epoch: 45, train speedup 5.307, test speedup 0.903, val speedup 5.341
last model at epoch 49, train speedup 5.309, test speedup 0.855, val speedup 5.337
execution cost 0:02:15.143018
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.927146, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004533| train set 3.550x speedup, test set 0.773x speedup, val set 3.474x speedup, step: 2
Epoch 6/300 |loss: 0.003486| train set 4.145x speedup, test set 1.349x speedup, val set 4.104x speedup, step: 1
Epoch 7/300 |loss: 0.004745| train set 4.857x speedup, test set 1.535x speedup, val set 4.900x speedup, step: 1
Epoch 8/300 |loss: 0.003386| train set 3.784x speedup, test set 0.843x speedup, val set 3.785x speedup, step: 2
Epoch 9/300 |loss: 0.002676| train set 4.686x speedup, test set 1.534x speedup, val set 4.687x speedup, step: 3
Epoch 10/300 |loss: 0.002632| train set 4.769x speedup, test set 0.800x speedup, val set 4.799x speedup, step: 4
Epoch 11/300 |loss: 0.002424| train set 4.852x speedup, test set 0.548x speedup, val set 5.300x speedup, step: 1
Epoch 12/300 |loss: 0.003836| train set 5.086x speedup, test set 1.973x speedup, val set 5.111x speedup, step: 2
Epoch 13/300 |loss: 0.002275| train set 4.168x speedup, test set 0.982x speedup, val set 4.181x speedup, step: 3
Epoch 14/300 |loss: 0.001733| train set 4.764x speedup, test set 0.534x speedup, val set 4.804x speedup, step: 4
Epoch 15/300 |loss: 0.001674| train set 5.165x speedup, test set 0.513x speedup, val set 5.201x speedup, step: 5
Epoch 16/300 |loss: 0.001647| train set 4.784x speedup, test set 0.708x speedup, val set 4.837x speedup, step: 6
Epoch 17/300 |loss: 0.001413| train set 5.140x speedup, test set 0.527x speedup, val set 5.173x speedup, step: 7
Epoch 18/300 |loss: 0.001234| train set 5.060x speedup, test set 0.543x speedup, val set 5.306x speedup, step: 1
Epoch 19/300 |loss: 0.001183| train set 5.308x speedup, test set 0.543x speedup, val set 5.326x speedup, step: 1
Epoch 20/300 |loss: 0.001035| train set 5.170x speedup, test set 0.519x speedup, val set 5.195x speedup, step: 2
Epoch 21/300 |loss: 0.001233| train set 5.253x speedup, test set 0.511x speedup, val set 5.266x speedup, step: 3
Epoch 22/300 |loss: 0.000985| train set 5.289x speedup, test set 0.739x speedup, val set 5.309x speedup, step: 4
Epoch 23/300 |loss: 0.000892| train set 5.296x speedup, test set 0.517x speedup, val set 5.320x speedup, step: 5
Epoch 24/300 |loss: 0.000813| train set 5.305x speedup, test set 0.527x speedup, val set 5.323x speedup, step: 6
Epoch 25/300 |loss: 0.000735| train set 5.304x speedup, test set 0.518x speedup, val set 5.328x speedup, step: 1
Epoch 26/300 |loss: 0.000926| train set 5.308x speedup, test set 0.511x speedup, val set 5.330x speedup, step: 1
Epoch 27/300 |loss: 0.000755| train set 5.304x speedup, test set 0.518x speedup, val set 5.328x speedup, step: 2
Epoch 28/300 |loss: 0.001050| train set 5.195x speedup, test set 0.534x speedup, val set 5.218x speedup, step: 3
Epoch 29/300 |loss: 0.000876| train set 5.305x speedup, test set 0.518x speedup, val set 5.334x speedup, step: 1
Epoch 30/300 |loss: 0.000771| train set 5.305x speedup, test set 0.533x speedup, val set 5.323x speedup, step: 2
Epoch 31/300 |loss: 0.000693| train set 5.231x speedup, test set 0.534x speedup, val set 5.238x speedup, step: 3
Epoch 32/300 |loss: 0.000648| train set 5.205x speedup, test set 0.533x speedup, val set 5.227x speedup, step: 4
Epoch 33/300 |loss: 0.000734| train set 5.305x speedup, test set 0.531x speedup, val set 5.323x speedup, step: 5
Epoch 34/300 |loss: 0.000718| train set 5.307x speedup, test set 0.536x speedup, val set 5.330x speedup, step: 6
Epoch 35/300 |loss: 0.000860| train set 5.305x speedup, test set 0.543x speedup, val set 5.334x speedup, step: 1
Epoch 36/300 |loss: 0.000759| train set 5.295x speedup, test set 0.518x speedup, val set 5.321x speedup, step: 2
early stopping at epoch 36
Training per epoch cost 0.866 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 3.764s, pg runtime 2.959s, speedup 0.786x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.470s, pg runtime 0.354s, speedup 0.753x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 26, train speedup 5.308, test speedup 0.511, val speedup 5.330
best test speedup epoch: 12, train speedup 5.086, test speedup 1.973, val speedup 5.111
best validation speedup epoch: 35, train speedup 5.305, test speedup 0.543, val speedup 5.334
last model at epoch 36, train speedup 5.295, test speedup 0.518, val speedup 5.321
execution cost 0:01:42.651966
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:01.045882, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014859| train set 2.920x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008823| train set 3.272x speedup, test set 1.614x speedup, val set 3.210x speedup, step: 1
Epoch 3/300 |loss: 0.005987| train set 3.318x speedup, test set 1.493x speedup, val set 3.213x speedup, step: 1
Epoch 4/300 |loss: 0.004845| train set 3.495x speedup, test set 0.843x speedup, val set 3.451x speedup, step: 1
Epoch 5/300 |loss: 0.004443| train set 3.535x speedup, test set 0.798x speedup, val set 3.451x speedup, step: 2
Epoch 6/300 |loss: 0.003594| train set 4.142x speedup, test set 1.523x speedup, val set 4.096x speedup, step: 1
Epoch 7/300 |loss: 0.004631| train set 4.764x speedup, test set 0.824x speedup, val set 4.815x speedup, step: 1
Epoch 8/300 |loss: 0.003122| train set 4.437x speedup, test set 0.826x speedup, val set 4.838x speedup, step: 1
Epoch 9/300 |loss: 0.002858| train set 4.705x speedup, test set 1.692x speedup, val set 4.710x speedup, step: 2
Epoch 10/300 |loss: 0.002468| train set 5.209x speedup, test set 1.221x speedup, val set 5.237x speedup, step: 1
Epoch 11/300 |loss: 0.002344| train set 4.092x speedup, test set 0.856x speedup, val set 3.979x speedup, step: 2
Epoch 12/300 |loss: 0.003056| train set 4.684x speedup, test set 0.910x speedup, val set 4.683x speedup, step: 3
Epoch 13/300 |loss: 0.001927| train set 4.096x speedup, test set 0.935x speedup, val set 4.122x speedup, step: 4
Epoch 14/300 |loss: 0.002065| train set 5.068x speedup, test set 0.941x speedup, val set 5.017x speedup, step: 5
Epoch 15/300 |loss: 0.002108| train set 5.161x speedup, test set 0.850x speedup, val set 5.192x speedup, step: 6
Epoch 16/300 |loss: 0.001796| train set 5.272x speedup, test set 0.794x speedup, val set 5.294x speedup, step: 1
Epoch 17/300 |loss: 0.001583| train set 4.826x speedup, test set 0.898x speedup, val set 5.263x speedup, step: 2
Epoch 18/300 |loss: 0.001322| train set 4.864x speedup, test set 0.968x speedup, val set 5.316x speedup, step: 1
Epoch 19/300 |loss: 0.001233| train set 4.734x speedup, test set 0.961x speedup, val set 5.175x speedup, step: 2
Epoch 20/300 |loss: 0.001200| train set 5.216x speedup, test set 0.876x speedup, val set 5.255x speedup, step: 3
Epoch 21/300 |loss: 0.001520| train set 5.249x speedup, test set 0.915x speedup, val set 5.303x speedup, step: 4
Epoch 22/300 |loss: 0.001494| train set 5.287x speedup, test set 0.894x speedup, val set 5.308x speedup, step: 5
Epoch 23/300 |loss: 0.000891| train set 5.307x speedup, test set 0.888x speedup, val set 5.330x speedup, step: 1
Epoch 24/300 |loss: 0.000713| train set 5.300x speedup, test set 0.945x speedup, val set 5.322x speedup, step: 2
Epoch 25/300 |loss: 0.000691| train set 5.297x speedup, test set 0.891x speedup, val set 5.317x speedup, step: 3
Epoch 26/300 |loss: 0.000888| train set 5.305x speedup, test set 0.535x speedup, val set 5.334x speedup, step: 1
Epoch 27/300 |loss: 0.000761| train set 5.297x speedup, test set 0.952x speedup, val set 5.320x speedup, step: 2
Epoch 28/300 |loss: 0.000846| train set 5.218x speedup, test set 0.853x speedup, val set 5.257x speedup, step: 3
Epoch 29/300 |loss: 0.000711| train set 5.307x speedup, test set 0.888x speedup, val set 5.329x speedup, step: 4
Epoch 30/300 |loss: 0.000824| train set 5.304x speedup, test set 0.944x speedup, val set 5.322x speedup, step: 5
Epoch 31/300 |loss: 0.000709| train set 5.284x speedup, test set 0.518x speedup, val set 5.311x speedup, step: 6
Epoch 32/300 |loss: 0.000667| train set 5.294x speedup, test set 0.916x speedup, val set 5.318x speedup, step: 7
Epoch 33/300 |loss: 0.000770| train set 5.243x speedup, test set 0.903x speedup, val set 5.258x speedup, step: 8
Epoch 34/300 |loss: 0.000732| train set 5.180x speedup, test set 0.505x speedup, val set 5.240x speedup, step: 9
early stopping at epoch 34
Training per epoch cost 0.887 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.369s, pg runtime 0.354s, speedup 0.960x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.556s, pg runtime 0.189s, speedup 0.340x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 23, train speedup 5.307, test speedup 0.888, val speedup 5.330
best test speedup epoch: 9, train speedup 4.705, test speedup 1.692, val speedup 4.710
best validation speedup epoch: 26, train speedup 5.305, test speedup 0.535, val speedup 5.334
last model at epoch 34, train speedup 5.180, test speedup 0.505, val speedup 5.240
execution cost 0:01:39.170897
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.945931, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004533| train set 3.550x speedup, test set 0.773x speedup, val set 3.474x speedup, step: 2
Epoch 6/300 |loss: 0.003486| train set 4.145x speedup, test set 1.349x speedup, val set 4.104x speedup, step: 1
Epoch 7/300 |loss: 0.004725| train set 4.857x speedup, test set 1.529x speedup, val set 4.900x speedup, step: 1
Epoch 8/300 |loss: 0.003367| train set 3.773x speedup, test set 0.918x speedup, val set 3.773x speedup, step: 2
Epoch 9/300 |loss: 0.002717| train set 4.681x speedup, test set 2.011x speedup, val set 4.683x speedup, step: 3
Epoch 10/300 |loss: 0.002605| train set 5.107x speedup, test set 0.802x speedup, val set 5.130x speedup, step: 1
Epoch 11/300 |loss: 0.002589| train set 4.852x speedup, test set 0.554x speedup, val set 5.299x speedup, step: 1
Epoch 12/300 |loss: 0.003852| train set 5.169x speedup, test set 1.985x speedup, val set 5.189x speedup, step: 2
Epoch 13/300 |loss: 0.002193| train set 4.168x speedup, test set 0.943x speedup, val set 4.181x speedup, step: 3
Epoch 14/300 |loss: 0.001836| train set 4.589x speedup, test set 0.959x speedup, val set 4.818x speedup, step: 4
Epoch 15/300 |loss: 0.001656| train set 5.135x speedup, test set 0.515x speedup, val set 5.161x speedup, step: 5
Epoch 16/300 |loss: 0.001552| train set 5.104x speedup, test set 0.686x speedup, val set 5.149x speedup, step: 6
Epoch 17/300 |loss: 0.001472| train set 4.924x speedup, test set 0.920x speedup, val set 5.170x speedup, step: 7
Epoch 18/300 |loss: 0.001319| train set 5.069x speedup, test set 0.532x speedup, val set 5.316x speedup, step: 1
Epoch 19/300 |loss: 0.001231| train set 5.304x speedup, test set 0.539x speedup, val set 5.323x speedup, step: 1
Epoch 20/300 |loss: 0.001187| train set 4.949x speedup, test set 0.520x speedup, val set 5.204x speedup, step: 2
Epoch 21/300 |loss: 0.001177| train set 5.251x speedup, test set 0.511x speedup, val set 5.271x speedup, step: 3
Epoch 22/300 |loss: 0.001044| train set 5.290x speedup, test set 0.735x speedup, val set 5.309x speedup, step: 4
Epoch 23/300 |loss: 0.000923| train set 5.306x speedup, test set 0.521x speedup, val set 5.331x speedup, step: 1
Epoch 24/300 |loss: 0.000776| train set 5.076x speedup, test set 0.529x speedup, val set 5.323x speedup, step: 2
Epoch 25/300 |loss: 0.000807| train set 5.278x speedup, test set 0.523x speedup, val set 5.296x speedup, step: 3
Epoch 26/300 |loss: 0.000885| train set 5.305x speedup, test set 0.519x speedup, val set 5.323x speedup, step: 4
Epoch 27/300 |loss: 0.000738| train set 5.297x speedup, test set 0.519x speedup, val set 5.316x speedup, step: 5
Epoch 28/300 |loss: 0.001123| train set 5.219x speedup, test set 0.527x speedup, val set 5.252x speedup, step: 6
Epoch 29/300 |loss: 0.000813| train set 5.308x speedup, test set 0.516x speedup, val set 5.332x speedup, step: 1
Epoch 30/300 |loss: 0.000777| train set 5.305x speedup, test set 0.522x speedup, val set 5.323x speedup, step: 2
Epoch 31/300 |loss: 0.000706| train set 5.285x speedup, test set 0.518x speedup, val set 5.310x speedup, step: 3
Epoch 32/300 |loss: 0.000639| train set 5.293x speedup, test set 0.519x speedup, val set 5.310x speedup, step: 4
Epoch 33/300 |loss: 0.000759| train set 5.293x speedup, test set 0.517x speedup, val set 5.313x speedup, step: 5
Epoch 34/300 |loss: 0.000718| train set 5.308x speedup, test set 0.526x speedup, val set 5.330x speedup, step: 6
Epoch 35/300 |loss: 0.001028| train set 5.252x speedup, test set 0.520x speedup, val set 5.272x speedup, step: 7
Epoch 36/300 |loss: 0.000775| train set 5.297x speedup, test set 0.523x speedup, val set 5.317x speedup, step: 8
early stopping at epoch 36
Training per epoch cost 0.878 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.369s, pg runtime 0.354s, speedup 0.960x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.084s, pg runtime 0.086s, speedup 1.022x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 0.168s, pg runtime 0.891s, speedup 5.291x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.556s, pg runtime 0.189s, speedup 0.340x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 29, train speedup 5.308, test speedup 0.516, val speedup 5.332
best test speedup epoch: 9, train speedup 4.681, test speedup 2.011, val speedup 4.683
best validation speedup epoch: 29, train speedup 5.308, test speedup 0.516, val speedup 5.332
last model at epoch 36, train speedup 5.297, test speedup 0.523, val speedup 5.317
execution cost 0:01:42.257833
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.576894, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004533| train set 3.550x speedup, test set 0.773x speedup, val set 3.474x speedup, step: 2
Epoch 6/300 |loss: 0.003486| train set 4.145x speedup, test set 1.349x speedup, val set 4.104x speedup, step: 1
Epoch 7/300 |loss: 0.004722| train set 4.857x speedup, test set 1.529x speedup, val set 4.900x speedup, step: 1
Epoch 8/300 |loss: 0.003368| train set 3.784x speedup, test set 0.843x speedup, val set 3.786x speedup, step: 2
Epoch 9/300 |loss: 0.002691| train set 4.682x speedup, test set 2.014x speedup, val set 4.675x speedup, step: 3
Epoch 10/300 |loss: 0.002649| train set 5.206x speedup, test set 1.419x speedup, val set 5.236x speedup, step: 1
Epoch 11/300 |loss: 0.002575| train set 4.778x speedup, test set 0.552x speedup, val set 5.218x speedup, step: 2
Epoch 12/300 |loss: 0.003780| train set 5.003x speedup, test set 1.961x speedup, val set 5.032x speedup, step: 3
Epoch 13/300 |loss: 0.002132| train set 4.114x speedup, test set 0.968x speedup, val set 4.130x speedup, step: 4
Epoch 14/300 |loss: 0.001728| train set 5.137x speedup, test set 0.945x speedup, val set 5.176x speedup, step: 5
Epoch 15/300 |loss: 0.001664| train set 4.986x speedup, test set 0.498x speedup, val set 4.968x speedup, step: 6
Epoch 16/300 |loss: 0.001680| train set 5.125x speedup, test set 0.680x speedup, val set 5.174x speedup, step: 7
Epoch 17/300 |loss: 0.001524| train set 4.734x speedup, test set 0.506x speedup, val set 5.173x speedup, step: 8
Epoch 18/300 |loss: 0.001206| train set 5.062x speedup, test set 0.521x speedup, val set 5.312x speedup, step: 1
Epoch 19/300 |loss: 0.001148| train set 5.305x speedup, test set 0.943x speedup, val set 5.323x speedup, step: 1
Epoch 20/300 |loss: 0.001339| train set 5.104x speedup, test set 0.536x speedup, val set 5.159x speedup, step: 2
Epoch 21/300 |loss: 0.001252| train set 5.223x speedup, test set 0.526x speedup, val set 5.267x speedup, step: 3
Epoch 22/300 |loss: 0.000927| train set 5.301x speedup, test set 0.526x speedup, val set 5.322x speedup, step: 4
Epoch 23/300 |loss: 0.000791| train set 5.307x speedup, test set 0.511x speedup, val set 5.330x speedup, step: 1
Epoch 24/300 |loss: 0.000751| train set 5.308x speedup, test set 0.512x speedup, val set 5.326x speedup, step: 2
Epoch 25/300 |loss: 0.000809| train set 5.303x speedup, test set 0.510x speedup, val set 5.329x speedup, step: 3
Epoch 26/300 |loss: 0.000898| train set 5.305x speedup, test set 0.712x speedup, val set 5.334x speedup, step: 1
Epoch 27/300 |loss: 0.000752| train set 5.307x speedup, test set 0.526x speedup, val set 5.330x speedup, step: 2
Epoch 28/300 |loss: 0.000980| train set 5.198x speedup, test set 0.890x speedup, val set 5.221x speedup, step: 3
Epoch 29/300 |loss: 0.000931| train set 5.246x speedup, test set 0.526x speedup, val set 5.269x speedup, step: 4
Epoch 30/300 |loss: 0.001031| train set 5.304x speedup, test set 0.926x speedup, val set 5.322x speedup, step: 5
Epoch 31/300 |loss: 0.000814| train set 5.225x speedup, test set 0.875x speedup, val set 5.243x speedup, step: 6
Epoch 32/300 |loss: 0.000703| train set 5.293x speedup, test set 0.940x speedup, val set 5.310x speedup, step: 7
Epoch 33/300 |loss: 0.000695| train set 5.299x speedup, test set 0.954x speedup, val set 5.323x speedup, step: 8
Epoch 34/300 |loss: 0.000668| train set 5.308x speedup, test set 0.895x speedup, val set 5.332x speedup, step: 9
Epoch 35/300 |loss: 0.000765| train set 5.307x speedup, test set 0.531x speedup, val set 5.336x speedup, step: 1
Epoch 36/300 |loss: 0.000719| train set 5.305x speedup, test set 0.950x speedup, val set 5.326x speedup, step: 2
Epoch 37/300 |loss: 0.001363| train set 5.301x speedup, test set 0.530x speedup, val set 5.334x speedup, step: 3
Epoch 38/300 |loss: 0.000728| train set 5.241x speedup, test set 0.530x speedup, val set 5.247x speedup, step: 4
Epoch 39/300 |loss: 0.000737| train set 5.287x speedup, test set 0.915x speedup, val set 5.311x speedup, step: 5
Epoch 40/300 |loss: 0.000707| train set 5.304x speedup, test set 1.790x speedup, val set 5.332x speedup, step: 6
Epoch 41/300 |loss: 0.000669| train set 5.311x speedup, test set 0.898x speedup, val set 5.320x speedup, step: 7
Epoch 42/300 |loss: 0.000643| train set 5.307x speedup, test set 1.990x speedup, val set 5.332x speedup, step: 8
Epoch 43/300 |loss: 0.000651| train set 5.307x speedup, test set 2.028x speedup, val set 5.330x speedup, step: 9
Epoch 44/300 |loss: 0.000730| train set 5.308x speedup, test set 0.946x speedup, val set 5.332x speedup, step: 10
Epoch 45/300 |loss: 0.000678| train set 5.307x speedup, test set 2.010x speedup, val set 5.337x speedup, step: 1
Epoch 46/300 |loss: 0.000687| train set 5.308x speedup, test set 1.962x speedup, val set 5.330x speedup, step: 2
Epoch 47/300 |loss: 0.000618| train set 5.310x speedup, test set 0.946x speedup, val set 5.333x speedup, step: 3
Epoch 48/300 |loss: 0.000667| train set 5.298x speedup, test set 1.962x speedup, val set 5.313x speedup, step: 4
Epoch 49/300 |loss: 0.000711| train set 5.302x speedup, test set 2.005x speedup, val set 5.331x speedup, step: 5
Epoch 50/300 |loss: 0.001292| train set 5.246x speedup, test set 0.713x speedup, val set 5.259x speedup, step: 6
early stopping at epoch 50
Training per epoch cost 0.645 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 3.764s, pg runtime 2.959s, speedup 0.786x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.024s, pg runtime 0.023s, speedup 0.971x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 41, train speedup 5.311, test speedup 0.898, val speedup 5.320
best test speedup epoch: 43, train speedup 5.307, test speedup 2.028, val speedup 5.330
best validation speedup epoch: 45, train speedup 5.307, test speedup 2.010, val speedup 5.337
last model at epoch 50, train speedup 5.246, test speedup 0.713, val speedup 5.259
execution cost 0:01:53.036937
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.929060, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014840| train set 2.958x speedup, test set 1.427x speedup, val set 2.900x speedup, step: 1
Epoch 2/300 |loss: 0.008717| train set 3.280x speedup, test set 1.683x speedup, val set 3.218x speedup, step: 1
Epoch 3/300 |loss: 0.006249| train set 3.314x speedup, test set 1.450x speedup, val set 3.207x speedup, step: 2
Epoch 4/300 |loss: 0.004694| train set 3.493x speedup, test set 0.781x speedup, val set 3.446x speedup, step: 1
Epoch 5/300 |loss: 0.004352| train set 3.308x speedup, test set 1.553x speedup, val set 3.205x speedup, step: 2
Epoch 6/300 |loss: 0.003739| train set 4.101x speedup, test set 1.302x speedup, val set 4.062x speedup, step: 1
Epoch 7/300 |loss: 0.004766| train set 3.772x speedup, test set 0.736x speedup, val set 3.800x speedup, step: 2
Epoch 8/300 |loss: 0.003394| train set 3.739x speedup, test set 0.785x speedup, val set 3.743x speedup, step: 3
Epoch 9/300 |loss: 0.002850| train set 4.455x speedup, test set 1.451x speedup, val set 4.633x speedup, step: 1
Epoch 10/300 |loss: 0.002709| train set 4.630x speedup, test set 0.725x speedup, val set 4.614x speedup, step: 2
Epoch 11/300 |loss: 0.002731| train set 3.882x speedup, test set 0.819x speedup, val set 3.800x speedup, step: 3
Epoch 12/300 |loss: 0.003801| train set 4.665x speedup, test set 0.836x speedup, val set 4.645x speedup, step: 1
Epoch 13/300 |loss: 0.002351| train set 4.110x speedup, test set 0.844x speedup, val set 4.181x speedup, step: 2
Epoch 14/300 |loss: 0.001883| train set 4.804x speedup, test set 0.818x speedup, val set 5.256x speedup, step: 1
Epoch 15/300 |loss: 0.001806| train set 4.811x speedup, test set 0.821x speedup, val set 4.851x speedup, step: 2
Epoch 16/300 |loss: 0.001723| train set 4.787x speedup, test set 1.350x speedup, val set 4.838x speedup, step: 3
Epoch 17/300 |loss: 0.001782| train set 4.826x speedup, test set 0.850x speedup, val set 5.263x speedup, step: 1
Epoch 18/300 |loss: 0.001441| train set 5.063x speedup, test set 0.838x speedup, val set 5.309x speedup, step: 1
Epoch 19/300 |loss: 0.001213| train set 5.300x speedup, test set 1.364x speedup, val set 5.322x speedup, step: 1
Epoch 20/300 |loss: 0.001458| train set 4.768x speedup, test set 1.360x speedup, val set 4.827x speedup, step: 2
Epoch 21/300 |loss: 0.001513| train set 5.298x speedup, test set 1.364x speedup, val set 5.330x speedup, step: 1
Epoch 22/300 |loss: 0.001131| train set 5.269x speedup, test set 1.457x speedup, val set 5.286x speedup, step: 2
Epoch 23/300 |loss: 0.001008| train set 5.250x speedup, test set 1.664x speedup, val set 5.262x speedup, step: 3
Epoch 24/300 |loss: 0.000887| train set 5.305x speedup, test set 1.491x speedup, val set 5.329x speedup, step: 4
Epoch 25/300 |loss: 0.000842| train set 5.254x speedup, test set 1.450x speedup, val set 5.267x speedup, step: 5
Epoch 26/300 |loss: 0.000945| train set 5.308x speedup, test set 1.510x speedup, val set 5.330x speedup, step: 1
Epoch 27/300 |loss: 0.000896| train set 5.255x speedup, test set 0.799x speedup, val set 5.269x speedup, step: 2
Epoch 28/300 |loss: 0.001958| train set 5.109x speedup, test set 1.535x speedup, val set 5.147x speedup, step: 3
Epoch 29/300 |loss: 0.001063| train set 5.304x speedup, test set 1.447x speedup, val set 5.323x speedup, step: 4
Epoch 30/300 |loss: 0.000713| train set 5.305x speedup, test set 1.447x speedup, val set 5.323x speedup, step: 5
Epoch 31/300 |loss: 0.000706| train set 5.300x speedup, test set 1.450x speedup, val set 5.321x speedup, step: 6
Epoch 32/300 |loss: 0.000682| train set 5.294x speedup, test set 1.449x speedup, val set 5.310x speedup, step: 7
Epoch 33/300 |loss: 0.000765| train set 5.307x speedup, test set 1.450x speedup, val set 5.334x speedup, step: 1
Epoch 34/300 |loss: 0.000674| train set 5.255x speedup, test set 1.450x speedup, val set 5.269x speedup, step: 2
Epoch 35/300 |loss: 0.001034| train set 5.305x speedup, test set 0.834x speedup, val set 5.334x speedup, step: 1
Epoch 36/300 |loss: 0.000894| train set 5.305x speedup, test set 1.447x speedup, val set 5.323x speedup, step: 2
Epoch 37/300 |loss: 0.001348| train set 5.304x speedup, test set 0.781x speedup, val set 5.323x speedup, step: 3
Epoch 38/300 |loss: 0.000774| train set 5.276x speedup, test set 1.445x speedup, val set 5.294x speedup, step: 4
Epoch 39/300 |loss: 0.000682| train set 5.308x speedup, test set 1.460x speedup, val set 5.330x speedup, step: 5
Epoch 40/300 |loss: 0.000641| train set 5.298x speedup, test set 1.458x speedup, val set 5.327x speedup, step: 6
Epoch 41/300 |loss: 0.000682| train set 5.305x speedup, test set 1.511x speedup, val set 5.332x speedup, step: 7
Epoch 42/300 |loss: 0.000624| train set 5.307x speedup, test set 1.449x speedup, val set 5.329x speedup, step: 8
Epoch 43/300 |loss: 0.000612| train set 5.305x speedup, test set 1.492x speedup, val set 5.326x speedup, step: 9
Epoch 44/300 |loss: 0.000627| train set 5.310x speedup, test set 1.462x speedup, val set 5.331x speedup, step: 10
Epoch 45/300 |loss: 0.000613| train set 5.298x speedup, test set 1.476x speedup, val set 5.323x speedup, step: 11
Epoch 46/300 |loss: 0.000621| train set 5.308x speedup, test set 1.427x speedup, val set 5.330x speedup, step: 12
Epoch 47/300 |loss: 0.000621| train set 5.308x speedup, test set 1.548x speedup, val set 5.330x speedup, step: 13
Epoch 48/300 |loss: 0.000697| train set 5.297x speedup, test set 1.446x speedup, val set 5.316x speedup, step: 14
Epoch 49/300 |loss: 0.000791| train set 5.306x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 15
early stopping at epoch 49
Training per epoch cost 0.872 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.018s, pg runtime 0.014s, speedup 0.795x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.096s, pg runtime 0.112s, speedup 1.171x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.024s, pg runtime 0.023s, speedup 0.971x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 4.653s, pg runtime 0.250s, speedup 0.054x
====================
best train speedup epoch: 44, train speedup 5.310, test speedup 1.462, val speedup 5.331
best test speedup epoch: 2, train speedup 3.280, test speedup 1.683, val speedup 3.218
best validation speedup epoch: 35, train speedup 5.305, test speedup 0.834, val speedup 5.334
last model at epoch 49, train speedup 5.306, test speedup 0.802, val speedup 5.330
execution cost 0:02:13.455788
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.515830, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014840| train set 2.958x speedup, test set 1.427x speedup, val set 2.900x speedup, step: 1
Epoch 2/300 |loss: 0.008731| train set 3.582x speedup, test set 1.587x speedup, val set 3.570x speedup, step: 1
Epoch 3/300 |loss: 0.006160| train set 3.314x speedup, test set 1.410x speedup, val set 3.207x speedup, step: 2
Epoch 4/300 |loss: 0.004675| train set 3.499x speedup, test set 0.814x speedup, val set 3.456x speedup, step: 3
Epoch 5/300 |loss: 0.004204| train set 3.711x speedup, test set 1.565x speedup, val set 3.706x speedup, step: 1
Epoch 6/300 |loss: 0.003847| train set 3.886x speedup, test set 0.749x speedup, val set 4.100x speedup, step: 1
Epoch 7/300 |loss: 0.004850| train set 4.784x speedup, test set 1.221x speedup, val set 4.831x speedup, step: 1
Epoch 8/300 |loss: 0.003390| train set 3.797x speedup, test set 0.760x speedup, val set 3.797x speedup, step: 2
Epoch 9/300 |loss: 0.002764| train set 4.440x speedup, test set 0.788x speedup, val set 4.621x speedup, step: 3
Epoch 10/300 |loss: 0.002696| train set 4.630x speedup, test set 1.736x speedup, val set 4.614x speedup, step: 4
Epoch 11/300 |loss: 0.002840| train set 4.513x speedup, test set 0.888x speedup, val set 4.407x speedup, step: 5
Epoch 12/300 |loss: 0.003711| train set 5.077x speedup, test set 1.599x speedup, val set 5.109x speedup, step: 1
Epoch 13/300 |loss: 0.002247| train set 4.324x speedup, test set 0.866x speedup, val set 4.676x speedup, step: 2
Epoch 14/300 |loss: 0.001836| train set 4.484x speedup, test set 0.868x speedup, val set 4.883x speedup, step: 3
Epoch 15/300 |loss: 0.001744| train set 4.462x speedup, test set 0.875x speedup, val set 4.853x speedup, step: 4
Epoch 16/300 |loss: 0.001744| train set 4.773x speedup, test set 1.777x speedup, val set 4.824x speedup, step: 5
Epoch 17/300 |loss: 0.001691| train set 5.140x speedup, test set 0.874x speedup, val set 5.173x speedup, step: 1
Epoch 18/300 |loss: 0.001436| train set 5.029x speedup, test set 1.727x speedup, val set 5.311x speedup, step: 1
Epoch 19/300 |loss: 0.001259| train set 5.304x speedup, test set 0.510x speedup, val set 5.322x speedup, step: 1
Epoch 20/300 |loss: 0.001402| train set 4.850x speedup, test set 0.707x speedup, val set 4.898x speedup, step: 2
Epoch 21/300 |loss: 0.001444| train set 5.271x speedup, test set 0.882x speedup, val set 5.328x speedup, step: 1
Epoch 22/300 |loss: 0.001155| train set 5.287x speedup, test set 0.686x speedup, val set 5.308x speedup, step: 2
Epoch 23/300 |loss: 0.001145| train set 5.225x speedup, test set 0.516x speedup, val set 5.237x speedup, step: 3
Epoch 24/300 |loss: 0.000930| train set 5.030x speedup, test set 0.808x speedup, val set 5.269x speedup, step: 4
Epoch 25/300 |loss: 0.000932| train set 5.294x speedup, test set 0.495x speedup, val set 5.316x speedup, step: 5
Epoch 26/300 |loss: 0.000893| train set 5.308x speedup, test set 0.832x speedup, val set 5.330x speedup, step: 1
Epoch 27/300 |loss: 0.000840| train set 5.251x speedup, test set 0.793x speedup, val set 5.265x speedup, step: 2
Epoch 28/300 |loss: 0.001165| train set 5.175x speedup, test set 0.488x speedup, val set 5.207x speedup, step: 3
Epoch 29/300 |loss: 0.000825| train set 5.308x speedup, test set 0.808x speedup, val set 5.332x speedup, step: 1
Epoch 30/300 |loss: 0.000790| train set 5.305x speedup, test set 0.844x speedup, val set 5.323x speedup, step: 2
Epoch 31/300 |loss: 0.000721| train set 5.277x speedup, test set 0.485x speedup, val set 5.295x speedup, step: 3
Epoch 32/300 |loss: 0.000710| train set 5.293x speedup, test set 0.669x speedup, val set 5.320x speedup, step: 4
Epoch 33/300 |loss: 0.000817| train set 5.289x speedup, test set 0.491x speedup, val set 5.309x speedup, step: 5
Epoch 34/300 |loss: 0.000680| train set 5.308x speedup, test set 0.475x speedup, val set 5.330x speedup, step: 6
Epoch 35/300 |loss: 0.000941| train set 5.305x speedup, test set 0.485x speedup, val set 5.334x speedup, step: 1
Epoch 36/300 |loss: 0.000820| train set 5.305x speedup, test set 0.844x speedup, val set 5.323x speedup, step: 2
Epoch 37/300 |loss: 0.001365| train set 5.304x speedup, test set 0.855x speedup, val set 5.323x speedup, step: 3
Epoch 38/300 |loss: 0.000704| train set 5.297x speedup, test set 0.856x speedup, val set 5.319x speedup, step: 4
Epoch 39/300 |loss: 0.000739| train set 5.308x speedup, test set 0.814x speedup, val set 5.333x speedup, step: 5
Epoch 40/300 |loss: 0.000734| train set 5.309x speedup, test set 0.814x speedup, val set 5.337x speedup, step: 1
early stopping at epoch 40
Training per epoch cost 0.481 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.386s, pg runtime 0.313s, speedup 0.811x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 8.156s, pg runtime 0.354s, speedup 0.043x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.124s, pg runtime 0.112s, speedup 0.907x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.024s, pg runtime 0.023s, speedup 0.971x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 40, train speedup 5.309, test speedup 0.814, val speedup 5.337
best test speedup epoch: 16, train speedup 4.773, test speedup 1.777, val speedup 4.824
best validation speedup epoch: 40, train speedup 5.309, test speedup 0.814, val speedup 5.337
last model at epoch 40, train speedup 5.309, test speedup 0.814, val speedup 5.337
execution cost 0:00:48.657685
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.532641, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014859| train set 2.920x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008823| train set 3.272x speedup, test set 1.614x speedup, val set 3.210x speedup, step: 1
Epoch 3/300 |loss: 0.005987| train set 3.318x speedup, test set 1.493x speedup, val set 3.213x speedup, step: 1
Epoch 4/300 |loss: 0.004845| train set 3.495x speedup, test set 0.843x speedup, val set 3.451x speedup, step: 1
Epoch 5/300 |loss: 0.004443| train set 3.535x speedup, test set 0.798x speedup, val set 3.451x speedup, step: 2
Epoch 6/300 |loss: 0.003594| train set 4.142x speedup, test set 1.523x speedup, val set 4.096x speedup, step: 1
Epoch 7/300 |loss: 0.004582| train set 4.764x speedup, test set 0.808x speedup, val set 4.815x speedup, step: 1
Epoch 8/300 |loss: 0.003185| train set 4.437x speedup, test set 0.933x speedup, val set 4.838x speedup, step: 1
Epoch 9/300 |loss: 0.002823| train set 4.795x speedup, test set 1.686x speedup, val set 4.781x speedup, step: 2
Epoch 10/300 |loss: 0.002504| train set 5.208x speedup, test set 1.340x speedup, val set 5.242x speedup, step: 1
Epoch 11/300 |loss: 0.002278| train set 4.151x speedup, test set 0.862x speedup, val set 4.161x speedup, step: 2
Epoch 12/300 |loss: 0.003322| train set 5.104x speedup, test set 0.883x speedup, val set 5.126x speedup, step: 3
Epoch 13/300 |loss: 0.002200| train set 4.163x speedup, test set 0.910x speedup, val set 4.165x speedup, step: 4
Epoch 14/300 |loss: 0.001840| train set 4.779x speedup, test set 0.860x speedup, val set 5.215x speedup, step: 5
Epoch 15/300 |loss: 0.001795| train set 4.635x speedup, test set 0.863x speedup, val set 4.865x speedup, step: 6
Epoch 16/300 |loss: 0.001628| train set 4.778x speedup, test set 0.881x speedup, val set 4.827x speedup, step: 7
Epoch 17/300 |loss: 0.001497| train set 4.826x speedup, test set 0.871x speedup, val set 5.263x speedup, step: 1
Epoch 18/300 |loss: 0.001355| train set 5.051x speedup, test set 0.888x speedup, val set 5.302x speedup, step: 1
Epoch 19/300 |loss: 0.001376| train set 5.074x speedup, test set 0.867x speedup, val set 5.328x speedup, step: 1
Epoch 20/300 |loss: 0.001222| train set 4.818x speedup, test set 0.868x speedup, val set 4.863x speedup, step: 2
Epoch 21/300 |loss: 0.001327| train set 5.216x speedup, test set 0.515x speedup, val set 5.263x speedup, step: 3
Epoch 22/300 |loss: 0.001283| train set 5.287x speedup, test set 0.509x speedup, val set 5.308x speedup, step: 4
Epoch 23/300 |loss: 0.000921| train set 5.249x speedup, test set 0.512x speedup, val set 5.259x speedup, step: 5
Epoch 24/300 |loss: 0.000773| train set 5.304x speedup, test set 0.512x speedup, val set 5.323x speedup, step: 6
Epoch 25/300 |loss: 0.000739| train set 5.294x speedup, test set 0.512x speedup, val set 5.320x speedup, step: 7
Epoch 26/300 |loss: 0.000922| train set 5.213x speedup, test set 0.511x speedup, val set 5.244x speedup, step: 8
Epoch 27/300 |loss: 0.000744| train set 5.307x speedup, test set 0.516x speedup, val set 5.330x speedup, step: 1
Epoch 28/300 |loss: 0.001425| train set 4.896x speedup, test set 0.522x speedup, val set 5.164x speedup, step: 2
Epoch 29/300 |loss: 0.000913| train set 5.294x speedup, test set 0.512x speedup, val set 5.320x speedup, step: 3
Epoch 30/300 |loss: 0.000756| train set 5.305x speedup, test set 0.510x speedup, val set 5.326x speedup, step: 4
Epoch 31/300 |loss: 0.000746| train set 5.306x speedup, test set 0.510x speedup, val set 5.340x speedup, step: 1
Epoch 32/300 |loss: 0.000691| train set 5.297x speedup, test set 0.513x speedup, val set 5.317x speedup, step: 2
Epoch 33/300 |loss: 0.000867| train set 5.288x speedup, test set 0.514x speedup, val set 5.311x speedup, step: 3
Epoch 34/300 |loss: 0.000700| train set 5.251x speedup, test set 0.509x speedup, val set 5.260x speedup, step: 4
Epoch 35/300 |loss: 0.001186| train set 5.281x speedup, test set 0.515x speedup, val set 5.343x speedup, step: 1
Epoch 36/300 |loss: 0.000890| train set 5.253x speedup, test set 0.516x speedup, val set 5.263x speedup, step: 2
early stopping at epoch 36
Training per epoch cost 0.490 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.371s, pg runtime 0.313s, speedup 0.844x
16, opt runtime 0.441s, model runtime 0.469s, pg runtime 0.453s, speedup 0.967x
17, opt runtime 0.327s, model runtime 0.369s, pg runtime 0.354s, speedup 0.960x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 0.168s, pg runtime 0.891s, speedup 5.291x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.556s, pg runtime 0.189s, speedup 0.340x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 27, train speedup 5.307, test speedup 0.516, val speedup 5.330
best test speedup epoch: 9, train speedup 4.795, test speedup 1.686, val speedup 4.781
best validation speedup epoch: 35, train speedup 5.281, test speedup 0.515, val speedup 5.343
last model at epoch 36, train speedup 5.253, test speedup 0.516, val speedup 5.263
execution cost 0:00:44.680669
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.494219, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014860| train set 2.958x speedup, test set 1.423x speedup, val set 2.900x speedup, step: 1
Epoch 2/300 |loss: 0.008725| train set 3.565x speedup, test set 1.660x speedup, val set 3.523x speedup, step: 1
Epoch 3/300 |loss: 0.006256| train set 3.383x speedup, test set 1.638x speedup, val set 3.329x speedup, step: 2
Epoch 4/300 |loss: 0.004842| train set 3.484x speedup, test set 0.845x speedup, val set 3.445x speedup, step: 3
Epoch 5/300 |loss: 0.004380| train set 3.769x speedup, test set 0.806x speedup, val set 3.766x speedup, step: 1
Epoch 6/300 |loss: 0.003564| train set 3.676x speedup, test set 1.272x speedup, val set 3.565x speedup, step: 2
Epoch 7/300 |loss: 0.004766| train set 4.770x speedup, test set 0.823x speedup, val set 4.810x speedup, step: 1
Epoch 8/300 |loss: 0.003496| train set 3.756x speedup, test set 0.802x speedup, val set 3.753x speedup, step: 2
Epoch 9/300 |loss: 0.002739| train set 4.358x speedup, test set 0.935x speedup, val set 4.704x speedup, step: 3
Epoch 10/300 |loss: 0.002742| train set 4.696x speedup, test set 1.674x speedup, val set 4.676x speedup, step: 4
Epoch 11/300 |loss: 0.002611| train set 4.521x speedup, test set 1.011x speedup, val set 4.416x speedup, step: 5
Epoch 12/300 |loss: 0.003987| train set 5.265x speedup, test set 0.847x speedup, val set 5.289x speedup, step: 1
Epoch 13/300 |loss: 0.002428| train set 4.151x speedup, test set 0.935x speedup, val set 4.162x speedup, step: 2
Epoch 14/300 |loss: 0.001901| train set 4.805x speedup, test set 0.846x speedup, val set 5.256x speedup, step: 3
Epoch 15/300 |loss: 0.001844| train set 4.858x speedup, test set 0.857x speedup, val set 5.031x speedup, step: 4
Epoch 16/300 |loss: 0.001587| train set 5.191x speedup, test set 1.383x speedup, val set 5.229x speedup, step: 5
Epoch 17/300 |loss: 0.001555| train set 5.022x speedup, test set 0.848x speedup, val set 5.256x speedup, step: 6
Epoch 18/300 |loss: 0.001311| train set 5.066x speedup, test set 1.823x speedup, val set 5.310x speedup, step: 1
Epoch 19/300 |loss: 0.001167| train set 5.244x speedup, test set 0.894x speedup, val set 5.251x speedup, step: 2
Epoch 20/300 |loss: 0.001310| train set 5.132x speedup, test set 0.695x speedup, val set 5.176x speedup, step: 3
Epoch 21/300 |loss: 0.001512| train set 5.252x speedup, test set 1.695x speedup, val set 5.270x speedup, step: 4
Epoch 22/300 |loss: 0.001034| train set 5.290x speedup, test set 0.708x speedup, val set 5.309x speedup, step: 5
Epoch 23/300 |loss: 0.000843| train set 5.249x speedup, test set 0.684x speedup, val set 5.259x speedup, step: 6
Epoch 24/300 |loss: 0.000754| train set 5.297x speedup, test set 0.726x speedup, val set 5.319x speedup, step: 1
Epoch 25/300 |loss: 0.000805| train set 5.291x speedup, test set 1.516x speedup, val set 5.308x speedup, step: 2
Epoch 26/300 |loss: 0.000924| train set 5.304x speedup, test set 0.708x speedup, val set 5.332x speedup, step: 1
Epoch 27/300 |loss: 0.000749| train set 5.308x speedup, test set 0.723x speedup, val set 5.332x speedup, step: 1
Epoch 28/300 |loss: 0.000783| train set 5.306x speedup, test set 1.730x speedup, val set 5.328x speedup, step: 2
Epoch 29/300 |loss: 0.000807| train set 5.253x speedup, test set 1.807x speedup, val set 5.266x speedup, step: 3
Epoch 30/300 |loss: 0.001159| train set 5.201x speedup, test set 1.464x speedup, val set 5.380x speedup, step: 1
Epoch 31/300 |loss: 0.000940| train set 5.270x speedup, test set 1.611x speedup, val set 5.309x speedup, step: 2
Epoch 32/300 |loss: 0.000687| train set 5.292x speedup, test set 1.689x speedup, val set 5.316x speedup, step: 3
Epoch 33/300 |loss: 0.000720| train set 5.288x speedup, test set 0.743x speedup, val set 5.306x speedup, step: 4
Epoch 34/300 |loss: 0.000661| train set 5.297x speedup, test set 0.723x speedup, val set 5.321x speedup, step: 5
Epoch 35/300 |loss: 0.001349| train set 5.295x speedup, test set 1.607x speedup, val set 5.321x speedup, step: 6
Epoch 36/300 |loss: 0.000861| train set 5.296x speedup, test set 1.765x speedup, val set 5.324x speedup, step: 7
early stopping at epoch 36
Training per epoch cost 0.478 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 2.252s, pg runtime 53.885s, speedup 23.927x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.371s, pg runtime 0.313s, speedup 0.844x
16, opt runtime 0.441s, model runtime 0.477s, pg runtime 0.453s, speedup 0.950x
17, opt runtime 0.327s, model runtime 8.156s, pg runtime 0.354s, speedup 0.043x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 2.321s, pg runtime 3.540s, speedup 1.525x
20, opt runtime 0.061s, model runtime 0.084s, pg runtime 0.086s, speedup 1.022x
21, opt runtime 0.626s, model runtime 0.782s, pg runtime 2.558s, speedup 3.272x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.024s, pg runtime 0.023s, speedup 0.971x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 27, train speedup 5.308, test speedup 0.723, val speedup 5.332
best test speedup epoch: 18, train speedup 5.066, test speedup 1.823, val speedup 5.310
best validation speedup epoch: 30, train speedup 5.201, test speedup 1.464, val speedup 5.380
last model at epoch 36, train speedup 5.296, test speedup 1.765, val speedup 5.324
execution cost 0:00:42.774955
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.498617, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014840| train set 2.958x speedup, test set 1.427x speedup, val set 2.900x speedup, step: 1
Epoch 2/300 |loss: 0.008731| train set 3.582x speedup, test set 1.587x speedup, val set 3.570x speedup, step: 1
Epoch 3/300 |loss: 0.006160| train set 3.314x speedup, test set 1.410x speedup, val set 3.207x speedup, step: 2
Epoch 4/300 |loss: 0.004675| train set 3.499x speedup, test set 0.814x speedup, val set 3.456x speedup, step: 3
Epoch 5/300 |loss: 0.004204| train set 3.711x speedup, test set 1.565x speedup, val set 3.706x speedup, step: 1
Epoch 6/300 |loss: 0.003834| train set 4.155x speedup, test set 0.748x speedup, val set 4.100x speedup, step: 1
Epoch 7/300 |loss: 0.004813| train set 4.784x speedup, test set 0.735x speedup, val set 4.830x speedup, step: 1
Epoch 8/300 |loss: 0.003381| train set 3.782x speedup, test set 0.771x speedup, val set 3.783x speedup, step: 2
Epoch 9/300 |loss: 0.002765| train set 4.417x speedup, test set 0.780x speedup, val set 4.621x speedup, step: 3
Epoch 10/300 |loss: 0.002656| train set 4.713x speedup, test set 0.752x speedup, val set 4.697x speedup, step: 4
Epoch 11/300 |loss: 0.002753| train set 3.977x speedup, test set 0.831x speedup, val set 3.972x speedup, step: 5
Epoch 12/300 |loss: 0.003927| train set 4.610x speedup, test set 1.615x speedup, val set 4.599x speedup, step: 6
Epoch 13/300 |loss: 0.002334| train set 4.673x speedup, test set 0.865x speedup, val set 4.676x speedup, step: 7
Epoch 14/300 |loss: 0.001938| train set 4.653x speedup, test set 0.840x speedup, val set 4.886x speedup, step: 1
Epoch 15/300 |loss: 0.001769| train set 4.462x speedup, test set 0.542x speedup, val set 4.862x speedup, step: 2
Epoch 16/300 |loss: 0.001622| train set 4.762x speedup, test set 1.655x speedup, val set 4.811x speedup, step: 3
Epoch 17/300 |loss: 0.001593| train set 4.835x speedup, test set 0.536x speedup, val set 5.074x speedup, step: 1
Epoch 18/300 |loss: 0.001478| train set 4.865x speedup, test set 0.518x speedup, val set 5.320x speedup, step: 1
Epoch 19/300 |loss: 0.001251| train set 5.305x speedup, test set 0.537x speedup, val set 5.323x speedup, step: 1
Epoch 20/300 |loss: 0.001445| train set 4.801x speedup, test set 0.513x speedup, val set 4.844x speedup, step: 2
Epoch 21/300 |loss: 0.001592| train set 5.305x speedup, test set 0.715x speedup, val set 5.334x speedup, step: 1
Epoch 22/300 |loss: 0.001233| train set 5.265x speedup, test set 0.684x speedup, val set 5.282x speedup, step: 2
Epoch 23/300 |loss: 0.001026| train set 5.247x speedup, test set 0.686x speedup, val set 5.263x speedup, step: 3
Epoch 24/300 |loss: 0.001018| train set 5.305x speedup, test set 0.687x speedup, val set 5.326x speedup, step: 4
Epoch 25/300 |loss: 0.000948| train set 5.244x speedup, test set 0.668x speedup, val set 5.254x speedup, step: 5
Epoch 26/300 |loss: 0.000982| train set 5.297x speedup, test set 0.657x speedup, val set 5.328x speedup, step: 6
Epoch 27/300 |loss: 0.000960| train set 5.308x speedup, test set 0.660x speedup, val set 5.332x speedup, step: 7
Epoch 28/300 |loss: 0.001091| train set 5.250x speedup, test set 0.661x speedup, val set 5.271x speedup, step: 8
Epoch 29/300 |loss: 0.000790| train set 5.307x speedup, test set 0.669x speedup, val set 5.332x speedup, step: 9
Epoch 30/300 |loss: 0.000705| train set 5.308x speedup, test set 0.685x speedup, val set 5.332x speedup, step: 10
Epoch 31/300 |loss: 0.000687| train set 5.305x speedup, test set 0.762x speedup, val set 5.333x speedup, step: 11
Epoch 32/300 |loss: 0.000639| train set 5.293x speedup, test set 0.701x speedup, val set 5.319x speedup, step: 12
Epoch 33/300 |loss: 0.000750| train set 5.305x speedup, test set 0.680x speedup, val set 5.334x speedup, step: 1
Epoch 34/300 |loss: 0.000650| train set 5.308x speedup, test set 0.690x speedup, val set 5.330x speedup, step: 2
Epoch 35/300 |loss: 0.000952| train set 5.305x speedup, test set 0.687x speedup, val set 5.334x speedup, step: 1
Epoch 36/300 |loss: 0.000826| train set 5.292x speedup, test set 0.689x speedup, val set 5.328x speedup, step: 2
Epoch 37/300 |loss: 0.001403| train set 5.300x speedup, test set 0.706x speedup, val set 5.322x speedup, step: 3
Epoch 38/300 |loss: 0.000706| train set 5.292x speedup, test set 0.695x speedup, val set 5.308x speedup, step: 4
Epoch 39/300 |loss: 0.000766| train set 5.304x speedup, test set 1.609x speedup, val set 5.333x speedup, step: 5
early stopping at epoch 39
Training per epoch cost 0.461 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.883s, pg runtime 0.802s, speedup 0.908x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.250s, pg runtime 0.206s, speedup 0.826x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 1.924s, pg runtime 53.885s, speedup 28.009x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.371s, pg runtime 0.313s, speedup 0.844x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 8.156s, pg runtime 0.354s, speedup 0.043x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.024s, pg runtime 0.023s, speedup 0.971x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 27, train speedup 5.308, test speedup 0.660, val speedup 5.332
best test speedup epoch: 16, train speedup 4.762, test speedup 1.655, val speedup 4.811
best validation speedup epoch: 35, train speedup 5.305, test speedup 0.687, val speedup 5.334
last model at epoch 39, train speedup 5.304, test speedup 1.609, val speedup 5.333
execution cost 0:00:46.010218
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.498316, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004532| train set 3.550x speedup, test set 0.777x speedup, val set 3.474x speedup, step: 2
Epoch 6/300 |loss: 0.003497| train set 4.151x speedup, test set 1.349x speedup, val set 4.108x speedup, step: 1
Epoch 7/300 |loss: 0.004856| train set 4.861x speedup, test set 1.522x speedup, val set 4.910x speedup, step: 1
Epoch 8/300 |loss: 0.003413| train set 3.782x speedup, test set 0.933x speedup, val set 3.784x speedup, step: 2
Epoch 9/300 |loss: 0.002708| train set 4.682x speedup, test set 1.337x speedup, val set 4.676x speedup, step: 3
Epoch 10/300 |loss: 0.002564| train set 5.104x speedup, test set 1.690x speedup, val set 5.126x speedup, step: 1
Epoch 11/300 |loss: 0.002375| train set 4.852x speedup, test set 0.521x speedup, val set 5.299x speedup, step: 1
Epoch 12/300 |loss: 0.003756| train set 5.135x speedup, test set 1.608x speedup, val set 5.149x speedup, step: 2
Epoch 13/300 |loss: 0.002245| train set 4.168x speedup, test set 0.957x speedup, val set 4.181x speedup, step: 3
Epoch 14/300 |loss: 0.001708| train set 5.216x speedup, test set 0.823x speedup, val set 5.251x speedup, step: 4
Epoch 15/300 |loss: 0.001652| train set 4.774x speedup, test set 0.513x speedup, val set 4.959x speedup, step: 5
Epoch 16/300 |loss: 0.001533| train set 5.209x speedup, test set 0.687x speedup, val set 5.253x speedup, step: 6
Epoch 17/300 |loss: 0.001388| train set 5.247x speedup, test set 0.511x speedup, val set 5.263x speedup, step: 7
Epoch 18/300 |loss: 0.001184| train set 5.069x speedup, test set 0.506x speedup, val set 5.316x speedup, step: 1
Epoch 19/300 |loss: 0.001103| train set 5.300x speedup, test set 0.501x speedup, val set 5.318x speedup, step: 1
Epoch 20/300 |loss: 0.000996| train set 4.954x speedup, test set 0.501x speedup, val set 5.207x speedup, step: 2
Epoch 21/300 |loss: 0.001061| train set 5.245x speedup, test set 0.481x speedup, val set 5.256x speedup, step: 3
Epoch 22/300 |loss: 0.000823| train set 5.268x speedup, test set 0.501x speedup, val set 5.282x speedup, step: 4
Epoch 23/300 |loss: 0.000800| train set 5.249x speedup, test set 0.502x speedup, val set 5.262x speedup, step: 5
Epoch 24/300 |loss: 0.000805| train set 5.252x speedup, test set 0.502x speedup, val set 5.270x speedup, step: 6
Epoch 25/300 |loss: 0.000909| train set 5.241x speedup, test set 0.656x speedup, val set 5.247x speedup, step: 7
Epoch 26/300 |loss: 0.000879| train set 5.303x speedup, test set 0.501x speedup, val set 5.332x speedup, step: 1
Epoch 27/300 |loss: 0.000740| train set 5.304x speedup, test set 0.656x speedup, val set 5.328x speedup, step: 2
Epoch 28/300 |loss: 0.000817| train set 5.221x speedup, test set 0.502x speedup, val set 5.253x speedup, step: 3
Epoch 29/300 |loss: 0.000751| train set 5.308x speedup, test set 0.656x speedup, val set 5.332x speedup, step: 1
Epoch 30/300 |loss: 0.000768| train set 5.308x speedup, test set 0.693x speedup, val set 5.330x speedup, step: 2
Epoch 31/300 |loss: 0.000770| train set 5.284x speedup, test set 0.502x speedup, val set 5.310x speedup, step: 3
Epoch 32/300 |loss: 0.000665| train set 5.296x speedup, test set 0.496x speedup, val set 5.316x speedup, step: 4
Epoch 33/300 |loss: 0.000720| train set 5.304x speedup, test set 0.503x speedup, val set 5.323x speedup, step: 5
Epoch 34/300 |loss: 0.000678| train set 5.307x speedup, test set 0.503x speedup, val set 5.330x speedup, step: 6
Epoch 35/300 |loss: 0.000995| train set 5.251x speedup, test set 0.496x speedup, val set 5.271x speedup, step: 7
Epoch 36/300 |loss: 0.000736| train set 5.295x speedup, test set 0.503x speedup, val set 5.310x speedup, step: 8
Epoch 37/300 |loss: 0.001263| train set 5.304x speedup, test set 0.659x speedup, val set 5.328x speedup, step: 9
Epoch 38/300 |loss: 0.000708| train set 5.297x speedup, test set 0.697x speedup, val set 5.317x speedup, step: 10
Epoch 39/300 |loss: 0.000800| train set 5.285x speedup, test set 0.702x speedup, val set 5.310x speedup, step: 11
Epoch 40/300 |loss: 0.000705| train set 5.298x speedup, test set 0.695x speedup, val set 5.324x speedup, step: 12
Epoch 41/300 |loss: 0.000650| train set 5.307x speedup, test set 0.695x speedup, val set 5.329x speedup, step: 13
Epoch 42/300 |loss: 0.000619| train set 5.305x speedup, test set 0.676x speedup, val set 5.333x speedup, step: 1
Epoch 43/300 |loss: 0.000631| train set 5.307x speedup, test set 0.676x speedup, val set 5.330x speedup, step: 2
Epoch 44/300 |loss: 0.000675| train set 5.306x speedup, test set 0.715x speedup, val set 5.331x speedup, step: 3
Epoch 45/300 |loss: 0.000646| train set 5.307x speedup, test set 0.678x speedup, val set 5.337x speedup, step: 1
Epoch 46/300 |loss: 0.000657| train set 5.308x speedup, test set 0.689x speedup, val set 5.330x speedup, step: 2
Epoch 47/300 |loss: 0.000633| train set 5.308x speedup, test set 0.683x speedup, val set 5.330x speedup, step: 3
Epoch 48/300 |loss: 0.000727| train set 5.276x speedup, test set 0.704x speedup, val set 5.291x speedup, step: 4
Epoch 49/300 |loss: 0.000700| train set 5.301x speedup, test set 0.683x speedup, val set 5.326x speedup, step: 5
Epoch 50/300 |loss: 0.001296| train set 5.219x speedup, test set 0.713x speedup, val set 5.223x speedup, step: 6
early stopping at epoch 50
Training per epoch cost 0.465 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 1.924s, pg runtime 53.885s, speedup 28.009x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.469s, pg runtime 0.453s, speedup 0.967x
17, opt runtime 0.327s, model runtime 0.470s, pg runtime 0.354s, speedup 0.753x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.024s, pg runtime 0.023s, speedup 0.971x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 4.653s, pg runtime 0.250s, speedup 0.054x
====================
best train speedup epoch: 29, train speedup 5.308, test speedup 0.656, val speedup 5.332
best test speedup epoch: 10, train speedup 5.104, test speedup 1.690, val speedup 5.126
best validation speedup epoch: 45, train speedup 5.307, test speedup 0.678, val speedup 5.337
last model at epoch 50, train speedup 5.219, test speedup 0.713, val speedup 5.223
execution cost 0:00:55.707079
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.533056, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004529| train set 3.447x speedup, test set 1.447x speedup, val set 3.388x speedup, step: 2
Epoch 6/300 |loss: 0.003494| train set 4.149x speedup, test set 1.259x speedup, val set 4.107x speedup, step: 1
Epoch 7/300 |loss: 0.004731| train set 4.787x speedup, test set 1.537x speedup, val set 4.831x speedup, step: 1
Epoch 8/300 |loss: 0.003530| train set 3.800x speedup, test set 0.959x speedup, val set 3.778x speedup, step: 2
Epoch 9/300 |loss: 0.002821| train set 4.613x speedup, test set 0.891x speedup, val set 4.620x speedup, step: 3
Epoch 10/300 |loss: 0.002713| train set 4.772x speedup, test set 0.811x speedup, val set 4.805x speedup, step: 4
Epoch 11/300 |loss: 0.002818| train set 4.852x speedup, test set 0.978x speedup, val set 5.299x speedup, step: 1
Epoch 12/300 |loss: 0.003591| train set 5.157x speedup, test set 1.819x speedup, val set 5.173x speedup, step: 2
Epoch 13/300 |loss: 0.002067| train set 4.324x speedup, test set 0.959x speedup, val set 4.676x speedup, step: 3
Epoch 14/300 |loss: 0.001873| train set 4.584x speedup, test set 0.927x speedup, val set 4.824x speedup, step: 4
Epoch 15/300 |loss: 0.001722| train set 4.667x speedup, test set 0.504x speedup, val set 4.667x speedup, step: 5
Epoch 16/300 |loss: 0.001649| train set 4.787x speedup, test set 0.659x speedup, val set 4.839x speedup, step: 6
Epoch 17/300 |loss: 0.001586| train set 4.826x speedup, test set 0.508x speedup, val set 5.262x speedup, step: 7
Epoch 18/300 |loss: 0.001308| train set 4.860x speedup, test set 0.504x speedup, val set 5.313x speedup, step: 1
Epoch 19/300 |loss: 0.001245| train set 5.305x speedup, test set 0.527x speedup, val set 5.323x speedup, step: 1
Epoch 20/300 |loss: 0.001165| train set 5.222x speedup, test set 0.497x speedup, val set 5.267x speedup, step: 2
Epoch 21/300 |loss: 0.001267| train set 5.167x speedup, test set 0.512x speedup, val set 5.197x speedup, step: 3
Epoch 22/300 |loss: 0.001164| train set 5.290x speedup, test set 0.513x speedup, val set 5.308x speedup, step: 4
Epoch 23/300 |loss: 0.001014| train set 5.249x speedup, test set 0.512x speedup, val set 5.259x speedup, step: 5
Epoch 24/300 |loss: 0.000902| train set 5.304x speedup, test set 0.523x speedup, val set 5.322x speedup, step: 6
Epoch 25/300 |loss: 0.000835| train set 5.306x speedup, test set 0.521x speedup, val set 5.316x speedup, step: 7
Epoch 26/300 |loss: 0.000927| train set 5.308x speedup, test set 0.513x speedup, val set 5.330x speedup, step: 1
Epoch 27/300 |loss: 0.000785| train set 5.294x speedup, test set 0.538x speedup, val set 5.315x speedup, step: 2
Epoch 28/300 |loss: 0.000941| train set 5.215x speedup, test set 0.548x speedup, val set 5.240x speedup, step: 3
Epoch 29/300 |loss: 0.000792| train set 5.301x speedup, test set 0.523x speedup, val set 5.324x speedup, step: 4
Epoch 30/300 |loss: 0.000851| train set 5.305x speedup, test set 0.538x speedup, val set 5.323x speedup, step: 5
Epoch 31/300 |loss: 0.000754| train set 5.302x speedup, test set 0.523x speedup, val set 5.331x speedup, step: 1
Epoch 32/300 |loss: 0.000655| train set 5.294x speedup, test set 0.522x speedup, val set 5.309x speedup, step: 2
Epoch 33/300 |loss: 0.000790| train set 5.308x speedup, test set 0.541x speedup, val set 5.332x speedup, step: 1
Epoch 34/300 |loss: 0.000719| train set 5.294x speedup, test set 0.541x speedup, val set 5.318x speedup, step: 2
Epoch 35/300 |loss: 0.001236| train set 5.171x speedup, test set 0.537x speedup, val set 5.204x speedup, step: 3
Epoch 36/300 |loss: 0.001157| train set 5.290x speedup, test set 0.540x speedup, val set 5.312x speedup, step: 4
early stopping at epoch 36
Training per epoch cost 0.479 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.369s, pg runtime 0.354s, speedup 0.960x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.065s, pg runtime 0.086s, speedup 1.315x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.308, test speedup 0.541, val speedup 5.332
best test speedup epoch: 12, train speedup 5.157, test speedup 1.819, val speedup 5.173
best validation speedup epoch: 33, train speedup 5.308, test speedup 0.541, val speedup 5.332
last model at epoch 36, train speedup 5.290, test speedup 0.540, val speedup 5.312
execution cost 0:00:43.691698
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.558192, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004529| train set 3.550x speedup, test set 1.380x speedup, val set 3.472x speedup, step: 2
Epoch 6/300 |loss: 0.003488| train set 4.145x speedup, test set 1.350x speedup, val set 4.104x speedup, step: 1
Epoch 7/300 |loss: 0.004828| train set 4.839x speedup, test set 1.522x speedup, val set 4.877x speedup, step: 1
Epoch 8/300 |loss: 0.003248| train set 3.789x speedup, test set 0.838x speedup, val set 3.791x speedup, step: 2
Epoch 9/300 |loss: 0.002742| train set 4.697x speedup, test set 1.301x speedup, val set 4.696x speedup, step: 3
Epoch 10/300 |loss: 0.002617| train set 5.137x speedup, test set 1.433x speedup, val set 5.127x speedup, step: 1
Epoch 11/300 |loss: 0.002406| train set 4.808x speedup, test set 0.524x speedup, val set 5.237x speedup, step: 1
Epoch 12/300 |loss: 0.003858| train set 5.184x speedup, test set 1.688x speedup, val set 5.201x speedup, step: 2
Epoch 13/300 |loss: 0.002219| train set 4.168x speedup, test set 0.858x speedup, val set 4.181x speedup, step: 3
Epoch 14/300 |loss: 0.001673| train set 4.866x speedup, test set 0.793x speedup, val set 4.909x speedup, step: 4
Epoch 15/300 |loss: 0.001589| train set 4.989x speedup, test set 0.499x speedup, val set 4.977x speedup, step: 5
Epoch 16/300 |loss: 0.001649| train set 5.128x speedup, test set 0.827x speedup, val set 5.180x speedup, step: 6
Epoch 17/300 |loss: 0.001640| train set 4.734x speedup, test set 0.847x speedup, val set 5.176x speedup, step: 7
Epoch 18/300 |loss: 0.001249| train set 4.972x speedup, test set 0.508x speedup, val set 5.234x speedup, step: 8
Epoch 19/300 |loss: 0.001208| train set 5.194x speedup, test set 0.510x speedup, val set 5.232x speedup, step: 9
Epoch 20/300 |loss: 0.001212| train set 5.138x speedup, test set 0.524x speedup, val set 5.173x speedup, step: 10
Epoch 21/300 |loss: 0.001600| train set 5.304x speedup, test set 0.498x speedup, val set 5.332x speedup, step: 1
Epoch 22/300 |loss: 0.001125| train set 5.269x speedup, test set 0.700x speedup, val set 5.283x speedup, step: 2
Epoch 23/300 |loss: 0.000943| train set 5.303x speedup, test set 0.691x speedup, val set 5.325x speedup, step: 3
Epoch 24/300 |loss: 0.000949| train set 5.227x speedup, test set 0.502x speedup, val set 5.263x speedup, step: 4
Epoch 25/300 |loss: 0.000796| train set 5.294x speedup, test set 0.677x speedup, val set 5.320x speedup, step: 5
Epoch 26/300 |loss: 0.000839| train set 5.305x speedup, test set 0.496x speedup, val set 5.333x speedup, step: 1
Epoch 27/300 |loss: 0.000738| train set 5.308x speedup, test set 0.675x speedup, val set 5.330x speedup, step: 2
Epoch 28/300 |loss: 0.000734| train set 5.252x speedup, test set 0.489x speedup, val set 5.263x speedup, step: 3
Epoch 29/300 |loss: 0.000754| train set 5.307x speedup, test set 0.673x speedup, val set 5.329x speedup, step: 4
Epoch 30/300 |loss: 0.000780| train set 5.305x speedup, test set 0.816x speedup, val set 5.323x speedup, step: 5
Epoch 31/300 |loss: 0.000788| train set 5.268x speedup, test set 1.437x speedup, val set 5.282x speedup, step: 6
Epoch 32/300 |loss: 0.000732| train set 5.295x speedup, test set 1.483x speedup, val set 5.321x speedup, step: 7
Epoch 33/300 |loss: 0.000783| train set 5.295x speedup, test set 0.625x speedup, val set 5.321x speedup, step: 8
Epoch 34/300 |loss: 0.000688| train set 5.308x speedup, test set 0.677x speedup, val set 5.332x speedup, step: 9
Epoch 35/300 |loss: 0.000790| train set 5.303x speedup, test set 0.685x speedup, val set 5.343x speedup, step: 1
Epoch 36/300 |loss: 0.001028| train set 5.288x speedup, test set 0.694x speedup, val set 5.310x speedup, step: 2
early stopping at epoch 36
Training per epoch cost 0.465 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 1.924s, pg runtime 53.885s, speedup 28.009x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.449s, pg runtime 0.354s, speedup 0.788x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.084s, pg runtime 0.086s, speedup 1.022x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.246s, pg runtime 0.189s, speedup 0.768x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 4.653s, pg runtime 0.250s, speedup 0.054x
====================
best train speedup epoch: 34, train speedup 5.308, test speedup 0.677, val speedup 5.332
best test speedup epoch: 12, train speedup 5.184, test speedup 1.688, val speedup 5.201
best validation speedup epoch: 35, train speedup 5.303, test speedup 0.685, val speedup 5.343
last model at epoch 36, train speedup 5.288, test speedup 0.694, val speedup 5.310
execution cost 0:00:42.933670
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.536977, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004533| train set 3.550x speedup, test set 0.773x speedup, val set 3.474x speedup, step: 2
Epoch 6/300 |loss: 0.003485| train set 4.145x speedup, test set 1.349x speedup, val set 4.104x speedup, step: 1
Epoch 7/300 |loss: 0.004790| train set 4.018x speedup, test set 1.638x speedup, val set 4.338x speedup, step: 1
Epoch 8/300 |loss: 0.003345| train set 3.886x speedup, test set 0.859x speedup, val set 3.913x speedup, step: 2
Epoch 9/300 |loss: 0.002822| train set 4.343x speedup, test set 0.780x speedup, val set 4.684x speedup, step: 1
Epoch 10/300 |loss: 0.002660| train set 5.104x speedup, test set 1.677x speedup, val set 5.126x speedup, step: 1
Epoch 11/300 |loss: 0.002753| train set 4.846x speedup, test set 0.753x speedup, val set 5.298x speedup, step: 1
Epoch 12/300 |loss: 0.003556| train set 5.184x speedup, test set 2.036x speedup, val set 5.201x speedup, step: 2
Epoch 13/300 |loss: 0.002017| train set 4.266x speedup, test set 0.958x speedup, val set 4.613x speedup, step: 3
Epoch 14/300 |loss: 0.001741| train set 4.866x speedup, test set 0.667x speedup, val set 4.909x speedup, step: 4
Epoch 15/300 |loss: 0.001603| train set 5.001x speedup, test set 0.512x speedup, val set 4.983x speedup, step: 5
Epoch 16/300 |loss: 0.001678| train set 5.219x speedup, test set 1.455x speedup, val set 5.265x speedup, step: 6
Epoch 17/300 |loss: 0.001621| train set 4.950x speedup, test set 0.509x speedup, val set 5.198x speedup, step: 7
Epoch 18/300 |loss: 0.001238| train set 5.068x speedup, test set 0.693x speedup, val set 5.317x speedup, step: 1
Epoch 19/300 |loss: 0.001276| train set 5.266x speedup, test set 0.509x speedup, val set 5.323x speedup, step: 1
Epoch 20/300 |loss: 0.001152| train set 5.102x speedup, test set 0.501x speedup, val set 5.152x speedup, step: 2
Epoch 21/300 |loss: 0.001646| train set 5.282x speedup, test set 0.681x speedup, val set 5.306x speedup, step: 3
Epoch 22/300 |loss: 0.000963| train set 5.301x speedup, test set 0.506x speedup, val set 5.322x speedup, step: 4
Epoch 23/300 |loss: 0.000808| train set 5.307x speedup, test set 0.502x speedup, val set 5.330x speedup, step: 1
Epoch 24/300 |loss: 0.000740| train set 5.308x speedup, test set 0.501x speedup, val set 5.332x speedup, step: 1
Epoch 25/300 |loss: 0.000711| train set 5.306x speedup, test set 0.506x speedup, val set 5.330x speedup, step: 2
Epoch 26/300 |loss: 0.000755| train set 5.307x speedup, test set 0.506x speedup, val set 5.329x speedup, step: 3
Epoch 27/300 |loss: 0.000758| train set 5.307x speedup, test set 0.505x speedup, val set 5.330x speedup, step: 4
Epoch 28/300 |loss: 0.000746| train set 5.249x speedup, test set 0.501x speedup, val set 5.268x speedup, step: 5
Epoch 29/300 |loss: 0.000703| train set 5.300x speedup, test set 0.501x speedup, val set 5.324x speedup, step: 6
Epoch 30/300 |loss: 0.000945| train set 5.305x speedup, test set 0.506x speedup, val set 5.326x speedup, step: 7
Epoch 31/300 |loss: 0.000911| train set 5.275x speedup, test set 0.501x speedup, val set 5.300x speedup, step: 8
Epoch 32/300 |loss: 0.000655| train set 5.297x speedup, test set 0.501x speedup, val set 5.314x speedup, step: 9
Epoch 33/300 |loss: 0.000753| train set 5.245x speedup, test set 0.501x speedup, val set 5.256x speedup, step: 10
Epoch 34/300 |loss: 0.000674| train set 5.267x speedup, test set 0.501x speedup, val set 5.287x speedup, step: 11
Epoch 35/300 |loss: 0.000822| train set 5.302x speedup, test set 0.501x speedup, val set 5.335x speedup, step: 1
Epoch 36/300 |loss: 0.000734| train set 5.295x speedup, test set 0.501x speedup, val set 5.321x speedup, step: 2
Epoch 37/300 |loss: 0.001229| train set 5.304x speedup, test set 0.684x speedup, val set 5.323x speedup, step: 3
Epoch 38/300 |loss: 0.000706| train set 5.294x speedup, test set 0.690x speedup, val set 5.309x speedup, step: 4
early stopping at epoch 38
Training per epoch cost 0.475 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 0.243s, pg runtime 0.206s, speedup 0.850x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.371s, pg runtime 0.313s, speedup 0.844x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.369s, pg runtime 0.354s, speedup 0.960x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.084s, pg runtime 0.086s, speedup 1.022x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.556s, pg runtime 0.189s, speedup 0.340x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.024s, pg runtime 0.023s, speedup 0.971x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 4.653s, pg runtime 0.250s, speedup 0.054x
====================
best train speedup epoch: 24, train speedup 5.308, test speedup 0.501, val speedup 5.332
best test speedup epoch: 12, train speedup 5.184, test speedup 2.036, val speedup 5.201
best validation speedup epoch: 35, train speedup 5.302, test speedup 0.501, val speedup 5.335
last model at epoch 38, train speedup 5.294, test speedup 0.690, val speedup 5.309
execution cost 0:00:45.210140
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.540957, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004568| train set 3.550x speedup, test set 1.438x speedup, val set 3.468x speedup, step: 2
Epoch 6/300 |loss: 0.003504| train set 4.138x speedup, test set 1.350x speedup, val set 4.093x speedup, step: 1
Epoch 7/300 |loss: 0.004807| train set 4.857x speedup, test set 1.523x speedup, val set 4.900x speedup, step: 1
Epoch 8/300 |loss: 0.003283| train set 4.182x speedup, test set 0.760x speedup, val set 4.172x speedup, step: 2
Epoch 9/300 |loss: 0.002709| train set 4.680x speedup, test set 1.330x speedup, val set 4.675x speedup, step: 3
Epoch 10/300 |loss: 0.002639| train set 5.103x speedup, test set 0.812x speedup, val set 5.127x speedup, step: 1
Epoch 11/300 |loss: 0.002468| train set 4.506x speedup, test set 0.534x speedup, val set 4.373x speedup, step: 2
Epoch 12/300 |loss: 0.003832| train set 5.050x speedup, test set 1.768x speedup, val set 5.059x speedup, step: 3
Epoch 13/300 |loss: 0.002244| train set 4.168x speedup, test set 0.888x speedup, val set 4.181x speedup, step: 4
Epoch 14/300 |loss: 0.001758| train set 5.222x speedup, test set 0.912x speedup, val set 5.266x speedup, step: 1
Epoch 15/300 |loss: 0.001689| train set 4.990x speedup, test set 0.504x speedup, val set 4.982x speedup, step: 2
Epoch 16/300 |loss: 0.001665| train set 5.021x speedup, test set 1.585x speedup, val set 5.210x speedup, step: 3
Epoch 17/300 |loss: 0.001442| train set 5.248x speedup, test set 0.505x speedup, val set 5.263x speedup, step: 4
Epoch 18/300 |loss: 0.001198| train set 5.066x speedup, test set 0.505x speedup, val set 5.320x speedup, step: 1
Epoch 19/300 |loss: 0.001015| train set 5.302x speedup, test set 0.511x speedup, val set 5.321x speedup, step: 1
Epoch 20/300 |loss: 0.001162| train set 5.168x speedup, test set 0.503x speedup, val set 5.204x speedup, step: 2
Epoch 21/300 |loss: 0.001369| train set 5.305x speedup, test set 0.501x speedup, val set 5.334x speedup, step: 1
Epoch 22/300 |loss: 0.000938| train set 5.265x speedup, test set 0.507x speedup, val set 5.282x speedup, step: 2
Epoch 23/300 |loss: 0.000852| train set 5.300x speedup, test set 0.505x speedup, val set 5.312x speedup, step: 3
Epoch 24/300 |loss: 0.000792| train set 5.306x speedup, test set 0.504x speedup, val set 5.343x speedup, step: 1
Epoch 25/300 |loss: 0.000726| train set 5.297x speedup, test set 0.502x speedup, val set 5.316x speedup, step: 2
Epoch 26/300 |loss: 0.000965| train set 5.282x speedup, test set 0.516x speedup, val set 5.306x speedup, step: 3
Epoch 27/300 |loss: 0.000855| train set 5.308x speedup, test set 0.516x speedup, val set 5.330x speedup, step: 4
Epoch 28/300 |loss: 0.000762| train set 5.217x speedup, test set 0.516x speedup, val set 5.250x speedup, step: 5
Epoch 29/300 |loss: 0.000707| train set 5.308x speedup, test set 0.503x speedup, val set 5.332x speedup, step: 6
Epoch 30/300 |loss: 0.000682| train set 5.305x speedup, test set 0.516x speedup, val set 5.323x speedup, step: 7
Epoch 31/300 |loss: 0.000718| train set 5.279x speedup, test set 0.511x speedup, val set 5.298x speedup, step: 8
Epoch 32/300 |loss: 0.000637| train set 5.263x speedup, test set 0.511x speedup, val set 5.269x speedup, step: 9
Epoch 33/300 |loss: 0.000722| train set 5.294x speedup, test set 0.511x speedup, val set 5.320x speedup, step: 10
Epoch 34/300 |loss: 0.000662| train set 5.241x speedup, test set 0.511x speedup, val set 5.255x speedup, step: 11
Epoch 35/300 |loss: 0.000958| train set 5.252x speedup, test set 0.513x speedup, val set 5.273x speedup, step: 12
Epoch 36/300 |loss: 0.000766| train set 5.305x speedup, test set 0.516x speedup, val set 5.334x speedup, step: 13
Epoch 37/300 |loss: 0.001248| train set 5.305x speedup, test set 0.511x speedup, val set 5.334x speedup, step: 14
early stopping at epoch 37
Training per epoch cost 0.457 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.186s, pg runtime 0.072s, speedup 0.387x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 5.495s, pg runtime 3.549s, speedup 0.646x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.371s, pg runtime 0.313s, speedup 0.844x
16, opt runtime 0.441s, model runtime 0.469s, pg runtime 0.453s, speedup 0.967x
17, opt runtime 0.327s, model runtime 0.470s, pg runtime 0.354s, speedup 0.753x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.084s, pg runtime 0.086s, speedup 1.022x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.556s, pg runtime 0.189s, speedup 0.340x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.494s, pg runtime 1.315s, speedup 0.880x
33, opt runtime 0.250s, model runtime 4.653s, pg runtime 0.250s, speedup 0.054x
====================
best train speedup epoch: 29, train speedup 5.308, test speedup 0.503, val speedup 5.332
best test speedup epoch: 12, train speedup 5.050, test speedup 1.768, val speedup 5.059
best validation speedup epoch: 24, train speedup 5.306, test speedup 0.504, val speedup 5.343
last model at epoch 37, train speedup 5.305, test speedup 0.511, val speedup 5.334
execution cost 0:00:43.210904
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.509394, and there are 6076 training samples
in channel 9
Epoch 0/300 |loss: 0.047784| train set 2.488x speedup, test set 1.503x speedup, val set 2.373x speedup, step: 1
Epoch 1/300 |loss: 0.014842| train set 2.913x speedup, test set 1.427x speedup, val set 2.873x speedup, step: 1
Epoch 2/300 |loss: 0.008594| train set 3.317x speedup, test set 1.671x speedup, val set 3.262x speedup, step: 1
Epoch 3/300 |loss: 0.006493| train set 3.562x speedup, test set 1.451x speedup, val set 3.481x speedup, step: 1
Epoch 4/300 |loss: 0.004846| train set 3.545x speedup, test set 0.787x speedup, val set 3.489x speedup, step: 1
Epoch 5/300 |loss: 0.004529| train set 3.447x speedup, test set 1.447x speedup, val set 3.388x speedup, step: 2
Epoch 6/300 |loss: 0.003494| train set 4.149x speedup, test set 1.259x speedup, val set 4.107x speedup, step: 1
Epoch 7/300 |loss: 0.004734| train set 4.787x speedup, test set 1.543x speedup, val set 4.840x speedup, step: 1
Epoch 8/300 |loss: 0.003439| train set 3.782x speedup, test set 0.845x speedup, val set 3.784x speedup, step: 2
Epoch 9/300 |loss: 0.002809| train set 4.699x speedup, test set 1.492x speedup, val set 4.696x speedup, step: 3
Epoch 10/300 |loss: 0.002647| train set 5.203x speedup, test set 0.801x speedup, val set 5.229x speedup, step: 1
Epoch 11/300 |loss: 0.002510| train set 4.852x speedup, test set 0.540x speedup, val set 5.299x speedup, step: 1
Epoch 12/300 |loss: 0.003775| train set 5.167x speedup, test set 1.975x speedup, val set 5.189x speedup, step: 2
Epoch 13/300 |loss: 0.002228| train set 4.168x speedup, test set 0.957x speedup, val set 4.181x speedup, step: 3
Epoch 14/300 |loss: 0.001763| train set 4.865x speedup, test set 0.538x speedup, val set 4.906x speedup, step: 4
Epoch 15/300 |loss: 0.001694| train set 4.973x speedup, test set 0.521x speedup, val set 4.949x speedup, step: 5
Epoch 16/300 |loss: 0.001689| train set 5.212x speedup, test set 0.737x speedup, val set 5.254x speedup, step: 6
Epoch 17/300 |loss: 0.001472| train set 5.024x speedup, test set 0.519x speedup, val set 5.265x speedup, step: 7
Epoch 18/300 |loss: 0.001222| train set 4.861x speedup, test set 0.535x speedup, val set 5.309x speedup, step: 1
Epoch 19/300 |loss: 0.001128| train set 5.304x speedup, test set 0.527x speedup, val set 5.323x speedup, step: 1
Epoch 20/300 |loss: 0.001146| train set 5.171x speedup, test set 0.512x speedup, val set 5.205x speedup, step: 2
Epoch 21/300 |loss: 0.001309| train set 5.164x speedup, test set 0.512x speedup, val set 5.200x speedup, step: 3
Epoch 22/300 |loss: 0.001026| train set 5.279x speedup, test set 0.533x speedup, val set 5.296x speedup, step: 4
Epoch 23/300 |loss: 0.000868| train set 5.248x speedup, test set 0.517x speedup, val set 5.269x speedup, step: 5
Epoch 24/300 |loss: 0.000720| train set 5.302x speedup, test set 0.527x speedup, val set 5.322x speedup, step: 6
Epoch 25/300 |loss: 0.000754| train set 5.299x speedup, test set 0.525x speedup, val set 5.329x speedup, step: 1
Epoch 26/300 |loss: 0.000941| train set 5.279x speedup, test set 0.525x speedup, val set 5.296x speedup, step: 2
Epoch 27/300 |loss: 0.000761| train set 5.308x speedup, test set 0.532x speedup, val set 5.330x speedup, step: 1
Epoch 28/300 |loss: 0.000836| train set 5.252x speedup, test set 0.536x speedup, val set 5.263x speedup, step: 2
Epoch 29/300 |loss: 0.000892| train set 5.213x speedup, test set 0.521x speedup, val set 5.244x speedup, step: 3
Epoch 30/300 |loss: 0.001042| train set 5.304x speedup, test set 0.539x speedup, val set 5.322x speedup, step: 4
Epoch 31/300 |loss: 0.000796| train set 5.226x speedup, test set 0.537x speedup, val set 5.246x speedup, step: 5
Epoch 32/300 |loss: 0.000694| train set 5.295x speedup, test set 0.536x speedup, val set 5.310x speedup, step: 6
Epoch 33/300 |loss: 0.000745| train set 5.303x speedup, test set 0.519x speedup, val set 5.327x speedup, step: 7
Epoch 34/300 |loss: 0.000681| train set 5.181x speedup, test set 0.520x speedup, val set 5.221x speedup, step: 8
Epoch 35/300 |loss: 0.001268| train set 5.305x speedup, test set 0.544x speedup, val set 5.336x speedup, step: 1
Epoch 36/300 |loss: 0.001020| train set 5.290x speedup, test set 0.524x speedup, val set 5.309x speedup, step: 2
early stopping at epoch 36
Training per epoch cost 0.469 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 3.764s, pg runtime 2.959s, speedup 0.786x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 52.559s, pg runtime 53.885s, speedup 1.025x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.469s, pg runtime 0.453s, speedup 0.967x
17, opt runtime 0.327s, model runtime 0.449s, pg runtime 0.354s, speedup 0.788x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 78.426s, pg runtime 3.540s, speedup 0.045x
20, opt runtime 0.061s, model runtime 0.065s, pg runtime 0.086s, speedup 1.315x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.556s, pg runtime 0.189s, speedup 0.340x
25, opt runtime 0.434s, model runtime 0.529s, pg runtime 0.434s, speedup 0.820x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.115s, pg runtime 0.112s, speedup 0.974x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 27, train speedup 5.308, test speedup 0.532, val speedup 5.330
best test speedup epoch: 12, train speedup 5.167, test speedup 1.975, val speedup 5.189
best validation speedup epoch: 35, train speedup 5.305, test speedup 0.544, val speedup 5.336
last model at epoch 36, train speedup 5.290, test speedup 0.524, val speedup 5.309
execution cost 0:00:44.678803
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.493267, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003751| train set 3.395x speedup, test set 1.090x speedup, val set 3.130x speedup, step: 3
Epoch 6/300 |loss: 0.004258| train set 4.718x speedup, test set 1.217x speedup, val set 4.461x speedup, step: 1
Epoch 7/300 |loss: 0.003407| train set 4.971x speedup, test set 1.264x speedup, val set 4.842x speedup, step: 1
Epoch 8/300 |loss: 0.002567| train set 4.019x speedup, test set 1.242x speedup, val set 3.720x speedup, step: 2
Epoch 9/300 |loss: 0.002171| train set 5.396x speedup, test set 1.502x speedup, val set 5.131x speedup, step: 1
Epoch 10/300 |loss: 0.002058| train set 4.216x speedup, test set 1.192x speedup, val set 3.848x speedup, step: 2
Epoch 11/300 |loss: 0.002124| train set 5.118x speedup, test set 1.349x speedup, val set 5.118x speedup, step: 3
Epoch 12/300 |loss: 0.002412| train set 4.957x speedup, test set 1.395x speedup, val set 4.959x speedup, step: 4
Epoch 13/300 |loss: 0.001696| train set 5.113x speedup, test set 1.395x speedup, val set 4.888x speedup, step: 5
Epoch 14/300 |loss: 0.002037| train set 5.004x speedup, test set 1.398x speedup, val set 4.757x speedup, step: 6
Epoch 15/300 |loss: 0.001992| train set 4.886x speedup, test set 1.362x speedup, val set 4.856x speedup, step: 7
Epoch 16/300 |loss: 0.001632| train set 5.214x speedup, test set 1.398x speedup, val set 5.040x speedup, step: 8
Epoch 17/300 |loss: 0.001513| train set 4.237x speedup, test set 1.816x speedup, val set 3.854x speedup, step: 9
Epoch 18/300 |loss: 0.001657| train set 5.375x speedup, test set 1.337x speedup, val set 4.906x speedup, step: 10
Epoch 19/300 |loss: 0.001368| train set 5.496x speedup, test set 1.395x speedup, val set 5.107x speedup, step: 11
Epoch 20/300 |loss: 0.001080| train set 5.448x speedup, test set 1.492x speedup, val set 5.068x speedup, step: 12
Epoch 21/300 |loss: 0.000956| train set 5.031x speedup, test set 1.467x speedup, val set 5.094x speedup, step: 13
Epoch 22/300 |loss: 0.001135| train set 4.519x speedup, test set 0.907x speedup, val set 3.827x speedup, step: 14
Epoch 23/300 |loss: 0.001164| train set 5.490x speedup, test set 1.726x speedup, val set 5.096x speedup, step: 15
Epoch 24/300 |loss: 0.000836| train set 4.893x speedup, test set 0.907x speedup, val set 4.970x speedup, step: 16
Epoch 25/300 |loss: 0.000894| train set 5.490x speedup, test set 1.702x speedup, val set 5.094x speedup, step: 17
Epoch 26/300 |loss: 0.000807| train set 5.443x speedup, test set 1.854x speedup, val set 5.062x speedup, step: 18
Epoch 27/300 |loss: 0.000813| train set 5.447x speedup, test set 1.854x speedup, val set 5.066x speedup, step: 19
Epoch 28/300 |loss: 0.000813| train set 5.424x speedup, test set 1.866x speedup, val set 5.051x speedup, step: 20
Epoch 29/300 |loss: 0.000755| train set 5.494x speedup, test set 1.844x speedup, val set 5.101x speedup, step: 21
Epoch 30/300 |loss: 0.000739| train set 5.497x speedup, test set 1.837x speedup, val set 5.106x speedup, step: 22
Epoch 31/300 |loss: 0.000794| train set 5.495x speedup, test set 0.897x speedup, val set 5.106x speedup, step: 23
Epoch 32/300 |loss: 0.000803| train set 5.443x speedup, test set 0.912x speedup, val set 5.047x speedup, step: 24
Epoch 33/300 |loss: 0.000737| train set 5.497x speedup, test set 1.894x speedup, val set 5.106x speedup, step: 25
Epoch 34/300 |loss: 0.000709| train set 5.450x speedup, test set 1.881x speedup, val set 5.069x speedup, step: 26
Epoch 35/300 |loss: 0.000696| train set 5.448x speedup, test set 1.854x speedup, val set 5.055x speedup, step: 27
Epoch 36/300 |loss: 0.000702| train set 5.496x speedup, test set 0.912x speedup, val set 5.106x speedup, step: 28
Epoch 37/300 |loss: 0.000719| train set 5.491x speedup, test set 0.912x speedup, val set 5.102x speedup, step: 29
Epoch 38/300 |loss: 0.000622| train set 5.496x speedup, test set 0.912x speedup, val set 5.107x speedup, step: 30
Epoch 39/300 |loss: 0.000750| train set 5.492x speedup, test set 0.896x speedup, val set 5.100x speedup, step: 31
Epoch 40/300 |loss: 0.000760| train set 5.451x speedup, test set 0.912x speedup, val set 5.069x speedup, step: 32
Epoch 41/300 |loss: 0.000716| train set 5.491x speedup, test set 0.905x speedup, val set 5.106x speedup, step: 33
Epoch 42/300 |loss: 0.000682| train set 5.448x speedup, test set 0.912x speedup, val set 5.067x speedup, step: 34
Epoch 43/300 |loss: 0.000676| train set 5.413x speedup, test set 0.912x speedup, val set 5.039x speedup, step: 35
Epoch 44/300 |loss: 0.001885| train set 5.450x speedup, test set 0.877x speedup, val set 5.070x speedup, step: 36
Epoch 45/300 |loss: 0.000815| train set 5.499x speedup, test set 0.889x speedup, val set 5.108x speedup, step: 37
early stopping at epoch 45
Training per epoch cost 0.433 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.186s, pg runtime 0.189s, speedup 1.017x
03, opt runtime 0.014s, model runtime 0.737s, pg runtime 0.014s, speedup 0.019x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 1.924s, pg runtime 53.885s, speedup 28.009x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 1.243s, pg runtime 0.453s, speedup 0.365x
17, opt runtime 0.327s, model runtime 8.156s, pg runtime 0.354s, speedup 0.043x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.061s, model runtime 0.264s, pg runtime 0.086s, speedup 0.325x
21, opt runtime 0.626s, model runtime 0.782s, pg runtime 2.558s, speedup 3.272x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 3.398s, pg runtime 0.189s, speedup 0.056x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.823s, pg runtime 0.112s, speedup 0.137x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 45, train speedup 5.499, test speedup 0.889, val speedup 5.108
best test speedup epoch: 33, train speedup 5.497, test speedup 1.894, val speedup 5.106
best validation speedup epoch: 9, train speedup 5.396, test speedup 1.502, val speedup 5.131
last model at epoch 45, train speedup 5.499, test speedup 0.889, val speedup 5.108
execution cost 0:00:47.793667
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.557035, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003757| train set 3.418x speedup, test set 1.090x speedup, val set 3.141x speedup, step: 3
Epoch 6/300 |loss: 0.004265| train set 5.306x speedup, test set 1.229x speedup, val set 4.982x speedup, step: 1
Epoch 7/300 |loss: 0.003353| train set 4.965x speedup, test set 1.499x speedup, val set 4.838x speedup, step: 2
Epoch 8/300 |loss: 0.002552| train set 4.016x speedup, test set 1.242x speedup, val set 3.719x speedup, step: 3
Epoch 9/300 |loss: 0.002161| train set 5.276x speedup, test set 1.502x speedup, val set 5.032x speedup, step: 1
Epoch 10/300 |loss: 0.002054| train set 4.390x speedup, test set 1.228x speedup, val set 3.849x speedup, step: 2
Epoch 11/300 |loss: 0.002077| train set 5.385x speedup, test set 1.348x speedup, val set 5.023x speedup, step: 3
Epoch 12/300 |loss: 0.002323| train set 5.165x speedup, test set 1.366x speedup, val set 4.959x speedup, step: 4
Epoch 13/300 |loss: 0.001917| train set 5.084x speedup, test set 1.351x speedup, val set 4.958x speedup, step: 5
Epoch 14/300 |loss: 0.001928| train set 5.025x speedup, test set 1.351x speedup, val set 4.760x speedup, step: 6
Epoch 15/300 |loss: 0.001955| train set 4.913x speedup, test set 1.413x speedup, val set 4.892x speedup, step: 7
Epoch 16/300 |loss: 0.001723| train set 5.158x speedup, test set 1.332x speedup, val set 5.005x speedup, step: 8
Epoch 17/300 |loss: 0.001526| train set 4.220x speedup, test set 1.842x speedup, val set 3.845x speedup, step: 9
Epoch 18/300 |loss: 0.001597| train set 5.398x speedup, test set 1.343x speedup, val set 4.943x speedup, step: 10
Epoch 19/300 |loss: 0.001425| train set 5.397x speedup, test set 1.401x speedup, val set 5.012x speedup, step: 11
Epoch 20/300 |loss: 0.001084| train set 5.448x speedup, test set 1.401x speedup, val set 5.068x speedup, step: 1
Epoch 21/300 |loss: 0.000909| train set 5.030x speedup, test set 1.610x speedup, val set 5.093x speedup, step: 1
Epoch 22/300 |loss: 0.001218| train set 4.655x speedup, test set 0.908x speedup, val set 4.162x speedup, step: 2
Epoch 23/300 |loss: 0.001346| train set 5.442x speedup, test set 1.525x speedup, val set 4.990x speedup, step: 3
Epoch 24/300 |loss: 0.000836| train set 5.095x speedup, test set 0.913x speedup, val set 4.965x speedup, step: 4
Epoch 25/300 |loss: 0.000859| train set 5.485x speedup, test set 1.702x speedup, val set 5.096x speedup, step: 1
Epoch 26/300 |loss: 0.000749| train set 5.447x speedup, test set 0.913x speedup, val set 5.067x speedup, step: 2
Epoch 27/300 |loss: 0.000815| train set 5.495x speedup, test set 0.884x speedup, val set 5.104x speedup, step: 1
Epoch 28/300 |loss: 0.000772| train set 5.448x speedup, test set 1.703x speedup, val set 5.052x speedup, step: 2
Epoch 29/300 |loss: 0.001014| train set 5.492x speedup, test set 0.885x speedup, val set 5.100x speedup, step: 3
Epoch 30/300 |loss: 0.000769| train set 5.448x speedup, test set 0.912x speedup, val set 5.067x speedup, step: 4
Epoch 31/300 |loss: 0.000717| train set 5.495x speedup, test set 0.881x speedup, val set 5.104x speedup, step: 1
Epoch 32/300 |loss: 0.000807| train set 5.492x speedup, test set 0.887x speedup, val set 5.100x speedup, step: 2
Epoch 33/300 |loss: 0.000722| train set 5.497x speedup, test set 0.888x speedup, val set 5.106x speedup, step: 1
Epoch 34/300 |loss: 0.000686| train set 5.441x speedup, test set 0.913x speedup, val set 5.070x speedup, step: 2
Epoch 35/300 |loss: 0.000674| train set 5.494x speedup, test set 0.881x speedup, val set 5.099x speedup, step: 3
Epoch 36/300 |loss: 0.000708| train set 5.420x speedup, test set 0.915x speedup, val set 5.057x speedup, step: 4
Epoch 37/300 |loss: 0.000741| train set 5.490x speedup, test set 0.888x speedup, val set 5.100x speedup, step: 5
Epoch 38/300 |loss: 0.000628| train set 5.491x speedup, test set 0.909x speedup, val set 5.096x speedup, step: 6
Epoch 39/300 |loss: 0.000783| train set 5.491x speedup, test set 1.726x speedup, val set 5.097x speedup, step: 7
Epoch 40/300 |loss: 0.000726| train set 5.451x speedup, test set 0.885x speedup, val set 5.066x speedup, step: 8
early stopping at epoch 40
Training per epoch cost 0.436 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.012s, pg runtime 0.072s, speedup 6.102x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.061s, pg runtime 0.086s, speedup 1.407x
21, opt runtime 0.626s, model runtime 0.782s, pg runtime 2.558s, speedup 3.272x
22, opt runtime 0.136s, model runtime 4.005s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 3.398s, pg runtime 0.189s, speedup 0.056x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.497, test speedup 0.888, val speedup 5.106
best test speedup epoch: 17, train speedup 4.220, test speedup 1.842, val speedup 3.845
best validation speedup epoch: 33, train speedup 5.497, test speedup 0.888, val speedup 5.106
last model at epoch 40, train speedup 5.451, test speedup 0.885, val speedup 5.066
execution cost 0:00:43.791178
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.488060, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003747| train set 3.598x speedup, test set 1.090x speedup, val set 3.343x speedup, step: 3
Epoch 6/300 |loss: 0.004217| train set 4.736x speedup, test set 1.201x speedup, val set 4.462x speedup, step: 1
Epoch 7/300 |loss: 0.003439| train set 4.966x speedup, test set 1.439x speedup, val set 4.839x speedup, step: 1
Epoch 8/300 |loss: 0.002564| train set 4.019x speedup, test set 1.257x speedup, val set 3.722x speedup, step: 2
Epoch 9/300 |loss: 0.002192| train set 5.272x speedup, test set 1.271x speedup, val set 5.029x speedup, step: 1
Epoch 10/300 |loss: 0.002078| train set 4.374x speedup, test set 1.238x speedup, val set 3.848x speedup, step: 2
Epoch 11/300 |loss: 0.002095| train set 5.395x speedup, test set 1.300x speedup, val set 5.033x speedup, step: 1
Epoch 12/300 |loss: 0.002278| train set 4.978x speedup, test set 1.395x speedup, val set 4.961x speedup, step: 2
Epoch 13/300 |loss: 0.002079| train set 5.169x speedup, test set 1.357x speedup, val set 5.021x speedup, step: 3
Epoch 14/300 |loss: 0.002113| train set 3.704x speedup, test set 1.452x speedup, val set 3.359x speedup, step: 4
Epoch 15/300 |loss: 0.002094| train set 4.891x speedup, test set 1.392x speedup, val set 4.860x speedup, step: 5
Epoch 16/300 |loss: 0.001429| train set 5.177x speedup, test set 1.448x speedup, val set 5.026x speedup, step: 6
Epoch 17/300 |loss: 0.001514| train set 3.989x speedup, test set 0.900x speedup, val set 3.697x speedup, step: 7
Epoch 18/300 |loss: 0.001488| train set 5.375x speedup, test set 1.401x speedup, val set 4.903x speedup, step: 8
Epoch 19/300 |loss: 0.001368| train set 5.397x speedup, test set 1.434x speedup, val set 5.012x speedup, step: 9
Epoch 20/300 |loss: 0.001101| train set 5.442x speedup, test set 1.510x speedup, val set 5.058x speedup, step: 1
Epoch 21/300 |loss: 0.000919| train set 5.031x speedup, test set 1.852x speedup, val set 5.094x speedup, step: 1
Epoch 22/300 |loss: 0.001071| train set 4.730x speedup, test set 0.913x speedup, val set 4.232x speedup, step: 2
Epoch 23/300 |loss: 0.001012| train set 5.248x speedup, test set 1.934x speedup, val set 5.101x speedup, step: 1
Epoch 24/300 |loss: 0.000799| train set 4.963x speedup, test set 0.922x speedup, val set 5.011x speedup, step: 2
Epoch 25/300 |loss: 0.000889| train set 5.483x speedup, test set 0.921x speedup, val set 5.089x speedup, step: 3
Epoch 26/300 |loss: 0.000765| train set 5.448x speedup, test set 0.919x speedup, val set 5.067x speedup, step: 4
Epoch 27/300 |loss: 0.000928| train set 5.495x speedup, test set 0.930x speedup, val set 5.104x speedup, step: 1
Epoch 28/300 |loss: 0.000860| train set 5.424x speedup, test set 0.911x speedup, val set 5.052x speedup, step: 2
Epoch 29/300 |loss: 0.000782| train set 5.497x speedup, test set 0.905x speedup, val set 5.106x speedup, step: 1
Epoch 30/300 |loss: 0.000701| train set 5.442x speedup, test set 0.919x speedup, val set 5.062x speedup, step: 2
Epoch 31/300 |loss: 0.000764| train set 5.495x speedup, test set 0.941x speedup, val set 5.104x speedup, step: 3
Epoch 32/300 |loss: 0.000711| train set 5.494x speedup, test set 0.968x speedup, val set 5.100x speedup, step: 4
Epoch 33/300 |loss: 0.000687| train set 5.497x speedup, test set 0.924x speedup, val set 5.106x speedup, step: 5
Epoch 34/300 |loss: 0.000696| train set 5.442x speedup, test set 0.877x speedup, val set 5.055x speedup, step: 6
Epoch 35/300 |loss: 0.000663| train set 5.491x speedup, test set 0.885x speedup, val set 5.100x speedup, step: 7
Epoch 36/300 |loss: 0.000713| train set 5.494x speedup, test set 0.899x speedup, val set 5.100x speedup, step: 8
Epoch 37/300 |loss: 0.000761| train set 5.483x speedup, test set 0.904x speedup, val set 5.092x speedup, step: 9
Epoch 38/300 |loss: 0.000624| train set 5.495x speedup, test set 0.899x speedup, val set 5.099x speedup, step: 10
Epoch 39/300 |loss: 0.000748| train set 5.492x speedup, test set 0.925x speedup, val set 5.100x speedup, step: 11
Epoch 40/300 |loss: 0.000759| train set 5.451x speedup, test set 0.896x speedup, val set 5.069x speedup, step: 12
Epoch 41/300 |loss: 0.000683| train set 5.496x speedup, test set 0.908x speedup, val set 5.107x speedup, step: 1
Epoch 42/300 |loss: 0.000672| train set 5.491x speedup, test set 0.901x speedup, val set 5.097x speedup, step: 2
Epoch 43/300 |loss: 0.000700| train set 5.439x speedup, test set 0.883x speedup, val set 5.048x speedup, step: 3
Epoch 44/300 |loss: 0.001941| train set 5.446x speedup, test set 0.925x speedup, val set 5.066x speedup, step: 4
early stopping at epoch 44
Training per epoch cost 0.439 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.012s, pg runtime 0.072s, speedup 6.102x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 4.005s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.497, test speedup 0.924, val speedup 5.106
best test speedup epoch: 23, train speedup 5.248, test speedup 1.934, val speedup 5.101
best validation speedup epoch: 41, train speedup 5.496, test speedup 0.908, val speedup 5.107
last model at epoch 44, train speedup 5.446, test speedup 0.925, val speedup 5.066
execution cost 0:00:47.336555
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.483588, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003753| train set 3.429x speedup, test set 1.090x speedup, val set 3.130x speedup, step: 3
Epoch 6/300 |loss: 0.004334| train set 5.306x speedup, test set 1.229x speedup, val set 4.982x speedup, step: 1
Epoch 7/300 |loss: 0.003345| train set 4.966x speedup, test set 1.499x speedup, val set 4.838x speedup, step: 2
Epoch 8/300 |loss: 0.002561| train set 4.016x speedup, test set 1.286x speedup, val set 3.720x speedup, step: 3
Epoch 9/300 |loss: 0.002192| train set 5.270x speedup, test set 1.271x speedup, val set 5.027x speedup, step: 1
Epoch 10/300 |loss: 0.002047| train set 4.739x speedup, test set 1.363x speedup, val set 4.284x speedup, step: 2
Epoch 11/300 |loss: 0.002054| train set 5.346x speedup, test set 1.337x speedup, val set 5.113x speedup, step: 1
Epoch 12/300 |loss: 0.002319| train set 5.165x speedup, test set 1.351x speedup, val set 4.959x speedup, step: 2
Epoch 13/300 |loss: 0.002151| train set 4.966x speedup, test set 1.351x speedup, val set 5.030x speedup, step: 3
Epoch 14/300 |loss: 0.002073| train set 4.443x speedup, test set 1.428x speedup, val set 4.581x speedup, step: 4
Epoch 15/300 |loss: 0.002216| train set 5.095x speedup, test set 1.428x speedup, val set 4.866x speedup, step: 5
Epoch 16/300 |loss: 0.001474| train set 5.492x speedup, test set 1.452x speedup, val set 5.100x speedup, step: 6
Epoch 17/300 |loss: 0.001374| train set 4.216x speedup, test set 1.924x speedup, val set 3.842x speedup, step: 7
Epoch 18/300 |loss: 0.001555| train set 5.492x speedup, test set 1.357x speedup, val set 5.100x speedup, step: 8
Epoch 19/300 |loss: 0.001406| train set 5.496x speedup, test set 1.401x speedup, val set 5.107x speedup, step: 9
Epoch 20/300 |loss: 0.001076| train set 5.448x speedup, test set 1.418x speedup, val set 5.067x speedup, step: 10
Epoch 21/300 |loss: 0.000916| train set 5.029x speedup, test set 1.674x speedup, val set 5.094x speedup, step: 11
Epoch 22/300 |loss: 0.001102| train set 4.874x speedup, test set 0.924x speedup, val set 4.866x speedup, step: 12
Epoch 23/300 |loss: 0.001086| train set 5.486x speedup, test set 1.899x speedup, val set 5.091x speedup, step: 13
Epoch 24/300 |loss: 0.000805| train set 4.912x speedup, test set 0.908x speedup, val set 4.966x speedup, step: 14
Epoch 25/300 |loss: 0.000879| train set 5.486x speedup, test set 1.750x speedup, val set 5.098x speedup, step: 15
Epoch 26/300 |loss: 0.000822| train set 5.447x speedup, test set 0.914x speedup, val set 5.067x speedup, step: 16
Epoch 27/300 |loss: 0.000814| train set 5.495x speedup, test set 0.933x speedup, val set 5.104x speedup, step: 17
Epoch 28/300 |loss: 0.000824| train set 5.448x speedup, test set 0.911x speedup, val set 5.053x speedup, step: 18
Epoch 29/300 |loss: 0.001010| train set 5.489x speedup, test set 0.905x speedup, val set 5.110x speedup, step: 19
Epoch 30/300 |loss: 0.000746| train set 5.442x speedup, test set 0.916x speedup, val set 5.062x speedup, step: 20
Epoch 31/300 |loss: 0.000725| train set 5.495x speedup, test set 0.931x speedup, val set 5.104x speedup, step: 21
Epoch 32/300 |loss: 0.000768| train set 5.492x speedup, test set 0.925x speedup, val set 5.100x speedup, step: 22
Epoch 33/300 |loss: 0.000683| train set 5.497x speedup, test set 0.925x speedup, val set 5.106x speedup, step: 23
Epoch 34/300 |loss: 0.000706| train set 5.448x speedup, test set 0.925x speedup, val set 5.067x speedup, step: 24
Epoch 35/300 |loss: 0.000688| train set 5.447x speedup, test set 0.913x speedup, val set 5.051x speedup, step: 25
Epoch 36/300 |loss: 0.000663| train set 5.495x speedup, test set 0.911x speedup, val set 5.105x speedup, step: 26
Epoch 37/300 |loss: 0.000718| train set 5.489x speedup, test set 0.911x speedup, val set 5.101x speedup, step: 27
Epoch 38/300 |loss: 0.000628| train set 5.496x speedup, test set 0.916x speedup, val set 5.106x speedup, step: 28
Epoch 39/300 |loss: 0.000754| train set 5.492x speedup, test set 0.903x speedup, val set 5.100x speedup, step: 29
Epoch 40/300 |loss: 0.000822| train set 5.407x speedup, test set 0.911x speedup, val set 5.020x speedup, step: 30
early stopping at epoch 40
Training per epoch cost 0.435 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.325s, pg runtime 0.072s, speedup 0.221x
02, opt runtime 0.183s, model runtime 0.186s, pg runtime 0.189s, speedup 1.017x
03, opt runtime 0.014s, model runtime 0.737s, pg runtime 0.014s, speedup 0.019x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 1.924s, pg runtime 53.885s, speedup 28.009x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 1.243s, pg runtime 0.453s, speedup 0.365x
17, opt runtime 0.327s, model runtime 8.156s, pg runtime 0.354s, speedup 0.043x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.264s, pg runtime 0.086s, speedup 0.325x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 3.398s, pg runtime 0.189s, speedup 0.056x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.823s, pg runtime 0.112s, speedup 0.137x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.497, test speedup 0.925, val speedup 5.106
best test speedup epoch: 17, train speedup 4.216, test speedup 1.924, val speedup 3.842
best validation speedup epoch: 11, train speedup 5.346, test speedup 1.337, val speedup 5.113
last model at epoch 40, train speedup 5.407, test speedup 0.911, val speedup 5.020
execution cost 0:00:43.335021
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.480006, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003750| train set 3.395x speedup, test set 1.090x speedup, val set 3.130x speedup, step: 3
Epoch 6/300 |loss: 0.004196| train set 4.885x speedup, test set 1.229x speedup, val set 4.622x speedup, step: 1
Epoch 7/300 |loss: 0.003433| train set 4.971x speedup, test set 1.304x speedup, val set 4.842x speedup, step: 1
Epoch 8/300 |loss: 0.002534| train set 4.015x speedup, test set 1.282x speedup, val set 3.719x speedup, step: 2
Epoch 9/300 |loss: 0.002190| train set 5.397x speedup, test set 1.502x speedup, val set 5.131x speedup, step: 1
Epoch 10/300 |loss: 0.002081| train set 4.535x speedup, test set 1.314x speedup, val set 3.848x speedup, step: 2
Epoch 11/300 |loss: 0.002123| train set 5.113x speedup, test set 1.289x speedup, val set 5.110x speedup, step: 3
Epoch 12/300 |loss: 0.002360| train set 4.977x speedup, test set 1.351x speedup, val set 4.960x speedup, step: 4
Epoch 13/300 |loss: 0.001935| train set 5.176x speedup, test set 1.368x speedup, val set 5.029x speedup, step: 5
Epoch 14/300 |loss: 0.002237| train set 4.988x speedup, test set 1.370x speedup, val set 4.729x speedup, step: 6
Epoch 15/300 |loss: 0.002092| train set 4.948x speedup, test set 1.398x speedup, val set 5.000x speedup, step: 7
Epoch 16/300 |loss: 0.001452| train set 5.250x speedup, test set 1.363x speedup, val set 5.099x speedup, step: 8
Epoch 17/300 |loss: 0.001383| train set 4.261x speedup, test set 1.842x speedup, val set 3.882x speedup, step: 9
Epoch 18/300 |loss: 0.001734| train set 5.392x speedup, test set 1.355x speedup, val set 5.006x speedup, step: 10
Epoch 19/300 |loss: 0.001425| train set 5.495x speedup, test set 1.399x speedup, val set 5.102x speedup, step: 11
Epoch 20/300 |loss: 0.001056| train set 5.448x speedup, test set 1.401x speedup, val set 5.067x speedup, step: 12
Epoch 21/300 |loss: 0.000904| train set 5.031x speedup, test set 1.708x speedup, val set 5.094x speedup, step: 13
Epoch 22/300 |loss: 0.001029| train set 4.784x speedup, test set 0.893x speedup, val set 4.338x speedup, step: 14
Epoch 23/300 |loss: 0.000930| train set 5.247x speedup, test set 1.726x speedup, val set 5.098x speedup, step: 15
Epoch 24/300 |loss: 0.000787| train set 4.909x speedup, test set 0.908x speedup, val set 4.969x speedup, step: 16
Epoch 25/300 |loss: 0.000883| train set 5.492x speedup, test set 1.489x speedup, val set 5.101x speedup, step: 17
Epoch 26/300 |loss: 0.000869| train set 5.446x speedup, test set 1.872x speedup, val set 5.060x speedup, step: 18
Epoch 27/300 |loss: 0.000855| train set 5.495x speedup, test set 1.849x speedup, val set 5.104x speedup, step: 19
Epoch 28/300 |loss: 0.000792| train set 5.376x speedup, test set 1.849x speedup, val set 5.013x speedup, step: 20
Epoch 29/300 |loss: 0.000928| train set 5.482x speedup, test set 0.901x speedup, val set 5.103x speedup, step: 21
Epoch 30/300 |loss: 0.000728| train set 5.442x speedup, test set 1.752x speedup, val set 5.062x speedup, step: 22
Epoch 31/300 |loss: 0.000762| train set 5.496x speedup, test set 1.877x speedup, val set 5.106x speedup, step: 23
Epoch 32/300 |loss: 0.000711| train set 5.496x speedup, test set 1.762x speedup, val set 5.107x speedup, step: 24
Epoch 33/300 |loss: 0.000717| train set 5.497x speedup, test set 1.887x speedup, val set 5.106x speedup, step: 25
Epoch 34/300 |loss: 0.000783| train set 5.445x speedup, test set 1.876x speedup, val set 5.058x speedup, step: 26
Epoch 35/300 |loss: 0.000693| train set 5.448x speedup, test set 1.748x speedup, val set 5.048x speedup, step: 27
Epoch 36/300 |loss: 0.000742| train set 5.445x speedup, test set 1.871x speedup, val set 5.061x speedup, step: 28
Epoch 37/300 |loss: 0.000720| train set 5.489x speedup, test set 0.908x speedup, val set 5.101x speedup, step: 29
Epoch 38/300 |loss: 0.000632| train set 5.490x speedup, test set 1.877x speedup, val set 5.098x speedup, step: 30
Epoch 39/300 |loss: 0.000821| train set 5.492x speedup, test set 1.725x speedup, val set 5.100x speedup, step: 31
Epoch 40/300 |loss: 0.000838| train set 5.451x speedup, test set 1.896x speedup, val set 5.069x speedup, step: 32
early stopping at epoch 40
Training per epoch cost 0.434 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.187s, pg runtime 0.072s, speedup 0.385x
02, opt runtime 0.183s, model runtime 0.186s, pg runtime 0.189s, speedup 1.017x
03, opt runtime 0.014s, model runtime 0.737s, pg runtime 0.014s, speedup 0.019x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 3.415s, pg runtime 0.802s, speedup 0.235x
07, opt runtime 0.919s, model runtime 1.048s, pg runtime 0.942s, speedup 0.898x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 1.994s, pg runtime 0.557s, speedup 0.279x
13, opt runtime 1.829s, model runtime 1.924s, pg runtime 53.885s, speedup 28.009x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 1.243s, pg runtime 0.453s, speedup 0.365x
17, opt runtime 0.327s, model runtime 8.156s, pg runtime 0.354s, speedup 0.043x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.061s, model runtime 0.264s, pg runtime 0.086s, speedup 0.325x
21, opt runtime 0.626s, model runtime 0.782s, pg runtime 2.558s, speedup 3.272x
22, opt runtime 0.136s, model runtime 1.894s, pg runtime 0.891s, speedup 0.471x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 3.398s, pg runtime 0.189s, speedup 0.056x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.823s, pg runtime 0.112s, speedup 0.137x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.497, test speedup 1.887, val speedup 5.106
best test speedup epoch: 40, train speedup 5.451, test speedup 1.896, val speedup 5.069
best validation speedup epoch: 9, train speedup 5.397, test speedup 1.502, val speedup 5.131
last model at epoch 40, train speedup 5.451, test speedup 1.896, val speedup 5.069
execution cost 0:00:43.754933
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.526690, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003747| train set 3.600x speedup, test set 1.090x speedup, val set 3.348x speedup, step: 3
Epoch 6/300 |loss: 0.004243| train set 4.736x speedup, test set 1.229x speedup, val set 4.462x speedup, step: 1
Epoch 7/300 |loss: 0.003400| train set 4.965x speedup, test set 1.445x speedup, val set 4.838x speedup, step: 1
Epoch 8/300 |loss: 0.002582| train set 4.018x speedup, test set 1.257x speedup, val set 3.720x speedup, step: 2
Epoch 9/300 |loss: 0.002205| train set 5.210x speedup, test set 1.271x speedup, val set 4.886x speedup, step: 1
Epoch 10/300 |loss: 0.002050| train set 4.929x speedup, test set 1.257x speedup, val set 5.005x speedup, step: 1
Epoch 11/300 |loss: 0.002058| train set 5.359x speedup, test set 1.300x speedup, val set 4.993x speedup, step: 2
Epoch 12/300 |loss: 0.002254| train set 5.186x speedup, test set 1.395x speedup, val set 4.997x speedup, step: 3
Epoch 13/300 |loss: 0.002281| train set 5.413x speedup, test set 1.429x speedup, val set 5.029x speedup, step: 1
Epoch 14/300 |loss: 0.001838| train set 3.735x speedup, test set 1.448x speedup, val set 3.424x speedup, step: 2
Epoch 15/300 |loss: 0.002095| train set 4.548x speedup, test set 1.426x speedup, val set 3.842x speedup, step: 3
Epoch 16/300 |loss: 0.001420| train set 5.251x speedup, test set 1.448x speedup, val set 5.103x speedup, step: 1
Epoch 17/300 |loss: 0.001574| train set 3.980x speedup, test set 0.907x speedup, val set 3.699x speedup, step: 2
Epoch 18/300 |loss: 0.001496| train set 5.445x speedup, test set 1.418x speedup, val set 5.048x speedup, step: 3
Epoch 19/300 |loss: 0.001415| train set 5.371x speedup, test set 1.434x speedup, val set 5.004x speedup, step: 4
Epoch 20/300 |loss: 0.001072| train set 5.448x speedup, test set 1.896x speedup, val set 5.067x speedup, step: 5
Epoch 21/300 |loss: 0.000902| train set 5.031x speedup, test set 1.885x speedup, val set 5.094x speedup, step: 6
Epoch 22/300 |loss: 0.001278| train set 4.094x speedup, test set 0.907x speedup, val set 3.630x speedup, step: 7
Epoch 23/300 |loss: 0.001220| train set 5.496x speedup, test set 1.945x speedup, val set 5.106x speedup, step: 1
Epoch 24/300 |loss: 0.000859| train set 4.887x speedup, test set 0.932x speedup, val set 4.961x speedup, step: 2
Epoch 25/300 |loss: 0.000959| train set 5.453x speedup, test set 0.924x speedup, val set 5.200x speedup, step: 1
Epoch 26/300 |loss: 0.000731| train set 5.445x speedup, test set 0.891x speedup, val set 5.061x speedup, step: 2
Epoch 27/300 |loss: 0.000962| train set 5.446x speedup, test set 0.930x speedup, val set 5.065x speedup, step: 3
Epoch 28/300 |loss: 0.000755| train set 5.355x speedup, test set 0.945x speedup, val set 4.908x speedup, step: 4
Epoch 29/300 |loss: 0.000780| train set 5.496x speedup, test set 0.899x speedup, val set 5.107x speedup, step: 5
Epoch 30/300 |loss: 0.000745| train set 5.448x speedup, test set 0.888x speedup, val set 5.067x speedup, step: 6
Epoch 31/300 |loss: 0.000754| train set 5.495x speedup, test set 0.910x speedup, val set 5.104x speedup, step: 7
Epoch 32/300 |loss: 0.000805| train set 5.495x speedup, test set 0.867x speedup, val set 5.104x speedup, step: 8
Epoch 33/300 |loss: 0.000695| train set 5.497x speedup, test set 0.907x speedup, val set 5.106x speedup, step: 9
Epoch 34/300 |loss: 0.000680| train set 5.447x speedup, test set 0.891x speedup, val set 5.067x speedup, step: 10
Epoch 35/300 |loss: 0.000663| train set 5.496x speedup, test set 0.910x speedup, val set 5.107x speedup, step: 11
Epoch 36/300 |loss: 0.000677| train set 5.445x speedup, test set 0.910x speedup, val set 5.061x speedup, step: 12
Epoch 37/300 |loss: 0.000753| train set 5.440x speedup, test set 0.891x speedup, val set 5.062x speedup, step: 13
Epoch 38/300 |loss: 0.000623| train set 5.496x speedup, test set 0.891x speedup, val set 5.107x speedup, step: 14
Epoch 39/300 |loss: 0.000728| train set 5.490x speedup, test set 0.888x speedup, val set 5.098x speedup, step: 15
Epoch 40/300 |loss: 0.000768| train set 5.450x speedup, test set 0.891x speedup, val set 5.069x speedup, step: 16
Epoch 41/300 |loss: 0.000667| train set 5.496x speedup, test set 0.891x speedup, val set 5.107x speedup, step: 17
Epoch 42/300 |loss: 0.000709| train set 5.495x speedup, test set 0.882x speedup, val set 5.100x speedup, step: 18
Epoch 43/300 |loss: 0.000716| train set 5.447x speedup, test set 0.910x speedup, val set 5.047x speedup, step: 19
early stopping at epoch 43
Training per epoch cost 0.437 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.325s, pg runtime 0.072s, speedup 0.221x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 0.782s, pg runtime 2.558s, speedup 3.272x
22, opt runtime 0.136s, model runtime 4.005s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.497, test speedup 0.907, val speedup 5.106
best test speedup epoch: 23, train speedup 5.496, test speedup 1.945, val speedup 5.106
best validation speedup epoch: 25, train speedup 5.453, test speedup 0.924, val speedup 5.200
last model at epoch 43, train speedup 5.447, test speedup 0.910, val speedup 5.047
execution cost 0:00:46.918862
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.571152, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003758| train set 3.477x speedup, test set 1.246x speedup, val set 3.238x speedup, step: 3
Epoch 6/300 |loss: 0.004069| train set 4.662x speedup, test set 1.217x speedup, val set 4.390x speedup, step: 1
Epoch 7/300 |loss: 0.003609| train set 4.965x speedup, test set 1.309x speedup, val set 4.838x speedup, step: 1
Epoch 8/300 |loss: 0.002732| train set 4.016x speedup, test set 1.302x speedup, val set 3.719x speedup, step: 2
Epoch 9/300 |loss: 0.002184| train set 5.327x speedup, test set 1.271x speedup, val set 4.981x speedup, step: 1
Epoch 10/300 |loss: 0.002059| train set 4.721x speedup, test set 1.294x speedup, val set 4.292x speedup, step: 2
Epoch 11/300 |loss: 0.002034| train set 5.398x speedup, test set 1.348x speedup, val set 5.037x speedup, step: 1
Epoch 12/300 |loss: 0.002439| train set 5.356x speedup, test set 1.383x speedup, val set 5.042x speedup, step: 1
Epoch 13/300 |loss: 0.001962| train set 4.964x speedup, test set 1.445x speedup, val set 5.024x speedup, step: 2
Epoch 14/300 |loss: 0.002047| train set 3.736x speedup, test set 1.402x speedup, val set 3.427x speedup, step: 3
Epoch 15/300 |loss: 0.002125| train set 4.690x speedup, test set 1.387x speedup, val set 4.189x speedup, step: 4
Epoch 16/300 |loss: 0.001465| train set 5.035x speedup, test set 1.401x speedup, val set 5.100x speedup, step: 1
Epoch 17/300 |loss: 0.001530| train set 4.261x speedup, test set 0.900x speedup, val set 3.879x speedup, step: 2
Epoch 18/300 |loss: 0.001531| train set 5.281x speedup, test set 1.435x speedup, val set 4.819x speedup, step: 3
Epoch 19/300 |loss: 0.001313| train set 5.497x speedup, test set 1.473x speedup, val set 5.106x speedup, step: 1
Epoch 20/300 |loss: 0.001066| train set 5.491x speedup, test set 1.780x speedup, val set 5.097x speedup, step: 2
Epoch 21/300 |loss: 0.000890| train set 5.031x speedup, test set 0.905x speedup, val set 5.094x speedup, step: 3
Epoch 22/300 |loss: 0.001002| train set 4.777x speedup, test set 0.908x speedup, val set 4.329x speedup, step: 4
Epoch 23/300 |loss: 0.001012| train set 5.247x speedup, test set 1.885x speedup, val set 5.101x speedup, step: 5
Epoch 24/300 |loss: 0.000745| train set 4.997x speedup, test set 0.922x speedup, val set 5.068x speedup, step: 6
Epoch 25/300 |loss: 0.000817| train set 5.487x speedup, test set 1.830x speedup, val set 5.099x speedup, step: 7
Epoch 26/300 |loss: 0.000829| train set 5.405x speedup, test set 0.908x speedup, val set 5.002x speedup, step: 8
Epoch 27/300 |loss: 0.000782| train set 5.495x speedup, test set 0.908x speedup, val set 5.104x speedup, step: 9
Epoch 28/300 |loss: 0.000797| train set 5.401x speedup, test set 0.907x speedup, val set 5.015x speedup, step: 10
Epoch 29/300 |loss: 0.000987| train set 5.384x speedup, test set 0.908x speedup, val set 5.012x speedup, step: 11
Epoch 30/300 |loss: 0.000717| train set 5.448x speedup, test set 0.928x speedup, val set 5.067x speedup, step: 12
Epoch 31/300 |loss: 0.000754| train set 5.495x speedup, test set 0.928x speedup, val set 5.104x speedup, step: 13
Epoch 32/300 |loss: 0.000742| train set 5.489x speedup, test set 0.908x speedup, val set 5.096x speedup, step: 14
Epoch 33/300 |loss: 0.000671| train set 5.497x speedup, test set 0.913x speedup, val set 5.105x speedup, step: 15
Epoch 34/300 |loss: 0.000696| train set 5.440x speedup, test set 0.908x speedup, val set 5.052x speedup, step: 16
Epoch 35/300 |loss: 0.000667| train set 5.497x speedup, test set 0.908x speedup, val set 5.106x speedup, step: 1
Epoch 36/300 |loss: 0.000646| train set 5.496x speedup, test set 0.943x speedup, val set 5.107x speedup, step: 1
Epoch 37/300 |loss: 0.000729| train set 5.441x speedup, test set 0.913x speedup, val set 5.062x speedup, step: 2
Epoch 38/300 |loss: 0.000613| train set 5.491x speedup, test set 0.908x speedup, val set 5.107x speedup, step: 1
Epoch 39/300 |loss: 0.000722| train set 5.492x speedup, test set 0.912x speedup, val set 5.100x speedup, step: 2
Epoch 40/300 |loss: 0.000782| train set 5.448x speedup, test set 0.943x speedup, val set 5.067x speedup, step: 3
Epoch 41/300 |loss: 0.000684| train set 5.491x speedup, test set 0.908x speedup, val set 5.100x speedup, step: 4
Epoch 42/300 |loss: 0.000726| train set 5.451x speedup, test set 0.948x speedup, val set 5.069x speedup, step: 5
early stopping at epoch 42
Training per epoch cost 0.429 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.012s, pg runtime 0.072s, speedup 6.102x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.061s, pg runtime 0.086s, speedup 1.407x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 4.005s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.497, test speedup 0.913, val speedup 5.105
best test speedup epoch: 23, train speedup 5.247, test speedup 1.885, val speedup 5.101
best validation speedup epoch: 38, train speedup 5.491, test speedup 0.908, val speedup 5.107
last model at epoch 42, train speedup 5.451, test speedup 0.948, val speedup 5.069
execution cost 0:00:45.451258
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.480712, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003757| train set 3.418x speedup, test set 1.090x speedup, val set 3.141x speedup, step: 3
Epoch 6/300 |loss: 0.004334| train set 5.306x speedup, test set 1.229x speedup, val set 4.982x speedup, step: 1
Epoch 7/300 |loss: 0.003331| train set 4.966x speedup, test set 1.499x speedup, val set 4.838x speedup, step: 2
Epoch 8/300 |loss: 0.002530| train set 4.245x speedup, test set 1.299x speedup, val set 3.858x speedup, step: 3
Epoch 9/300 |loss: 0.002137| train set 5.212x speedup, test set 1.271x speedup, val set 4.891x speedup, step: 4
Epoch 10/300 |loss: 0.002093| train set 4.374x speedup, test set 1.230x speedup, val set 3.848x speedup, step: 5
Epoch 11/300 |loss: 0.002033| train set 5.394x speedup, test set 1.337x speedup, val set 5.034x speedup, step: 1
Epoch 12/300 |loss: 0.002191| train set 4.958x speedup, test set 1.411x speedup, val set 4.956x speedup, step: 2
Epoch 13/300 |loss: 0.002684| train set 4.882x speedup, test set 1.431x speedup, val set 4.954x speedup, step: 3
Epoch 14/300 |loss: 0.001762| train set 4.607x speedup, test set 1.464x speedup, val set 4.727x speedup, step: 4
Epoch 15/300 |loss: 0.001972| train set 4.892x speedup, test set 1.431x speedup, val set 4.859x speedup, step: 5
Epoch 16/300 |loss: 0.001450| train set 5.248x speedup, test set 1.447x speedup, val set 5.097x speedup, step: 1
Epoch 17/300 |loss: 0.001505| train set 4.177x speedup, test set 1.929x speedup, val set 3.814x speedup, step: 2
Epoch 18/300 |loss: 0.001528| train set 5.372x speedup, test set 1.386x speedup, val set 4.903x speedup, step: 3
Epoch 19/300 |loss: 0.001336| train set 5.397x speedup, test set 1.448x speedup, val set 5.012x speedup, step: 4
Epoch 20/300 |loss: 0.001111| train set 5.442x speedup, test set 1.437x speedup, val set 5.059x speedup, step: 5
Epoch 21/300 |loss: 0.000904| train set 5.032x speedup, test set 1.953x speedup, val set 5.098x speedup, step: 1
Epoch 22/300 |loss: 0.001216| train set 4.858x speedup, test set 0.905x speedup, val set 4.836x speedup, step: 2
Epoch 23/300 |loss: 0.001285| train set 5.494x speedup, test set 1.983x speedup, val set 5.105x speedup, step: 1
Epoch 24/300 |loss: 0.000862| train set 4.974x speedup, test set 0.907x speedup, val set 5.059x speedup, step: 2
Epoch 25/300 |loss: 0.000904| train set 5.489x speedup, test set 1.885x speedup, val set 5.101x speedup, step: 3
Epoch 26/300 |loss: 0.000733| train set 5.446x speedup, test set 0.927x speedup, val set 5.060x speedup, step: 4
Epoch 27/300 |loss: 0.000854| train set 5.447x speedup, test set 0.929x speedup, val set 5.066x speedup, step: 5
Epoch 28/300 |loss: 0.000780| train set 5.379x speedup, test set 0.929x speedup, val set 4.910x speedup, step: 6
Epoch 29/300 |loss: 0.000878| train set 5.371x speedup, test set 0.925x speedup, val set 5.003x speedup, step: 7
Epoch 30/300 |loss: 0.000743| train set 5.448x speedup, test set 0.925x speedup, val set 5.064x speedup, step: 8
Epoch 31/300 |loss: 0.000754| train set 5.495x speedup, test set 0.981x speedup, val set 5.104x speedup, step: 9
Epoch 32/300 |loss: 0.000780| train set 5.484x speedup, test set 0.928x speedup, val set 5.094x speedup, step: 10
Epoch 33/300 |loss: 0.000732| train set 5.497x speedup, test set 0.932x speedup, val set 5.106x speedup, step: 1
Epoch 34/300 |loss: 0.000724| train set 5.445x speedup, test set 0.925x speedup, val set 5.060x speedup, step: 2
Epoch 35/300 |loss: 0.000713| train set 5.448x speedup, test set 0.905x speedup, val set 5.048x speedup, step: 3
Epoch 36/300 |loss: 0.000690| train set 5.495x speedup, test set 0.950x speedup, val set 5.106x speedup, step: 1
Epoch 37/300 |loss: 0.000719| train set 5.485x speedup, test set 0.904x speedup, val set 5.095x speedup, step: 2
Epoch 38/300 |loss: 0.000633| train set 5.496x speedup, test set 0.927x speedup, val set 5.106x speedup, step: 3
Epoch 39/300 |loss: 0.000770| train set 5.492x speedup, test set 0.924x speedup, val set 5.101x speedup, step: 4
Epoch 40/300 |loss: 0.000887| train set 5.451x speedup, test set 0.958x speedup, val set 5.069x speedup, step: 5
early stopping at epoch 40
Training per epoch cost 0.424 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.012s, pg runtime 0.072s, speedup 6.102x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 0.168s, pg runtime 0.891s, speedup 5.291x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.497, test speedup 0.932, val speedup 5.106
best test speedup epoch: 23, train speedup 5.494, test speedup 1.983, val speedup 5.105
best validation speedup epoch: 36, train speedup 5.495, test speedup 0.950, val speedup 5.106
last model at epoch 40, train speedup 5.451, test speedup 0.958, val speedup 5.069
execution cost 0:00:42.629759
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.500382, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003757| train set 3.418x speedup, test set 1.090x speedup, val set 3.141x speedup, step: 3
Epoch 6/300 |loss: 0.004334| train set 5.306x speedup, test set 1.229x speedup, val set 4.982x speedup, step: 1
Epoch 7/300 |loss: 0.003331| train set 4.966x speedup, test set 1.499x speedup, val set 4.838x speedup, step: 2
Epoch 8/300 |loss: 0.002533| train set 4.246x speedup, test set 1.299x speedup, val set 3.865x speedup, step: 3
Epoch 9/300 |loss: 0.002153| train set 5.234x speedup, test set 1.271x speedup, val set 4.893x speedup, step: 4
Epoch 10/300 |loss: 0.002093| train set 4.216x speedup, test set 1.230x speedup, val set 3.848x speedup, step: 5
Epoch 11/300 |loss: 0.002040| train set 5.394x speedup, test set 1.348x speedup, val set 5.034x speedup, step: 1
Epoch 12/300 |loss: 0.002158| train set 4.957x speedup, test set 1.395x speedup, val set 4.959x speedup, step: 2
Epoch 13/300 |loss: 0.002239| train set 4.966x speedup, test set 1.363x speedup, val set 5.026x speedup, step: 3
Epoch 14/300 |loss: 0.002019| train set 3.737x speedup, test set 1.444x speedup, val set 3.427x speedup, step: 4
Epoch 15/300 |loss: 0.002021| train set 4.652x speedup, test set 1.416x speedup, val set 4.159x speedup, step: 5
Epoch 16/300 |loss: 0.001462| train set 4.974x speedup, test set 1.372x speedup, val set 5.039x speedup, step: 1
Epoch 17/300 |loss: 0.001526| train set 4.201x speedup, test set 1.870x speedup, val set 3.841x speedup, step: 2
Epoch 18/300 |loss: 0.001677| train set 5.444x speedup, test set 1.386x speedup, val set 5.047x speedup, step: 1
Epoch 19/300 |loss: 0.001401| train set 5.463x speedup, test set 1.386x speedup, val set 5.058x speedup, step: 1
Epoch 20/300 |loss: 0.001102| train set 5.450x speedup, test set 1.868x speedup, val set 5.064x speedup, step: 1
Epoch 21/300 |loss: 0.000918| train set 5.248x speedup, test set 1.857x speedup, val set 5.101x speedup, step: 1
Epoch 22/300 |loss: 0.001174| train set 4.655x speedup, test set 1.885x speedup, val set 4.162x speedup, step: 2
Epoch 23/300 |loss: 0.001211| train set 5.421x speedup, test set 1.885x speedup, val set 4.958x speedup, step: 3
Epoch 24/300 |loss: 0.000851| train set 5.090x speedup, test set 0.943x speedup, val set 4.962x speedup, step: 4
Epoch 25/300 |loss: 0.000906| train set 5.491x speedup, test set 1.885x speedup, val set 5.100x speedup, step: 5
Epoch 26/300 |loss: 0.000742| train set 5.495x speedup, test set 0.948x speedup, val set 5.099x speedup, step: 6
Epoch 27/300 |loss: 0.000878| train set 5.447x speedup, test set 1.900x speedup, val set 5.066x speedup, step: 7
Epoch 28/300 |loss: 0.000782| train set 5.379x speedup, test set 1.884x speedup, val set 4.910x speedup, step: 8
Epoch 29/300 |loss: 0.000956| train set 5.492x speedup, test set 0.928x speedup, val set 5.100x speedup, step: 9
Epoch 30/300 |loss: 0.000753| train set 5.497x speedup, test set 0.943x speedup, val set 5.106x speedup, step: 1
Epoch 31/300 |loss: 0.000737| train set 5.495x speedup, test set 0.934x speedup, val set 5.104x speedup, step: 2
Epoch 32/300 |loss: 0.000771| train set 5.489x speedup, test set 0.943x speedup, val set 5.096x speedup, step: 3
Epoch 33/300 |loss: 0.000715| train set 5.497x speedup, test set 2.058x speedup, val set 5.106x speedup, step: 4
Epoch 34/300 |loss: 0.000735| train set 5.491x speedup, test set 0.951x speedup, val set 5.099x speedup, step: 5
Epoch 35/300 |loss: 0.000672| train set 5.450x speedup, test set 0.904x speedup, val set 5.055x speedup, step: 6
Epoch 36/300 |loss: 0.000696| train set 5.445x speedup, test set 0.928x speedup, val set 5.059x speedup, step: 7
Epoch 37/300 |loss: 0.000761| train set 5.441x speedup, test set 0.948x speedup, val set 5.062x speedup, step: 8
Epoch 38/300 |loss: 0.000621| train set 5.488x speedup, test set 0.949x speedup, val set 5.090x speedup, step: 9
Epoch 39/300 |loss: 0.000740| train set 5.491x speedup, test set 1.976x speedup, val set 5.099x speedup, step: 10
Epoch 40/300 |loss: 0.000784| train set 5.450x speedup, test set 0.904x speedup, val set 5.070x speedup, step: 11
early stopping at epoch 40
Training per epoch cost 0.422 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.012s, pg runtime 0.072s, speedup 6.102x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 1.369s, pg runtime 2.558s, speedup 1.868x
22, opt runtime 0.136s, model runtime 4.005s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.497, test speedup 2.058, val speedup 5.106
best test speedup epoch: 33, train speedup 5.497, test speedup 2.058, val speedup 5.106
best validation speedup epoch: 30, train speedup 5.497, test speedup 0.943, val speedup 5.106
last model at epoch 40, train speedup 5.450, test speedup 0.904, val speedup 5.070
execution cost 0:00:42.872221
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
construct training samples cost 0:00:00.520708, and there are 5880 training samples
in channel 9
Epoch 0/300 |loss: 0.049662| train set 2.636x speedup, test set 1.707x speedup, val set 2.435x speedup, step: 1
Epoch 1/300 |loss: 0.020790| train set 2.944x speedup, test set 1.745x speedup, val set 2.627x speedup, step: 1
Epoch 2/300 |loss: 0.010599| train set 3.374x speedup, test set 1.588x speedup, val set 3.117x speedup, step: 1
Epoch 3/300 |loss: 0.006414| train set 3.841x speedup, test set 1.212x speedup, val set 3.568x speedup, step: 1
Epoch 4/300 |loss: 0.004772| train set 3.593x speedup, test set 1.250x speedup, val set 3.343x speedup, step: 2
Epoch 5/300 |loss: 0.003751| train set 3.395x speedup, test set 1.090x speedup, val set 3.130x speedup, step: 3
Epoch 6/300 |loss: 0.004258| train set 4.718x speedup, test set 1.217x speedup, val set 4.461x speedup, step: 1
Epoch 7/300 |loss: 0.003405| train set 4.966x speedup, test set 1.264x speedup, val set 4.842x speedup, step: 1
Epoch 8/300 |loss: 0.002540| train set 4.015x speedup, test set 1.242x speedup, val set 3.719x speedup, step: 2
Epoch 9/300 |loss: 0.002180| train set 5.276x speedup, test set 1.502x speedup, val set 5.030x speedup, step: 1
Epoch 10/300 |loss: 0.002054| train set 4.214x speedup, test set 1.233x speedup, val set 3.846x speedup, step: 2
Epoch 11/300 |loss: 0.002051| train set 5.395x speedup, test set 1.348x speedup, val set 5.033x speedup, step: 1
Epoch 12/300 |loss: 0.002214| train set 5.165x speedup, test set 1.366x speedup, val set 4.959x speedup, step: 2
Epoch 13/300 |loss: 0.002141| train set 5.082x speedup, test set 1.323x speedup, val set 4.951x speedup, step: 3
Epoch 14/300 |loss: 0.001970| train set 4.930x speedup, test set 1.425x speedup, val set 4.603x speedup, step: 4
Epoch 15/300 |loss: 0.002088| train set 4.948x speedup, test set 1.249x speedup, val set 5.000x speedup, step: 5
Epoch 16/300 |loss: 0.001395| train set 5.439x speedup, test set 1.425x speedup, val set 4.999x speedup, step: 6
Epoch 17/300 |loss: 0.001535| train set 4.213x speedup, test set 0.900x speedup, val set 3.839x speedup, step: 7
Epoch 18/300 |loss: 0.001548| train set 5.330x speedup, test set 1.355x speedup, val set 4.821x speedup, step: 8
Epoch 19/300 |loss: 0.001363| train set 5.496x speedup, test set 1.399x speedup, val set 5.107x speedup, step: 1
Epoch 20/300 |loss: 0.001050| train set 5.442x speedup, test set 1.418x speedup, val set 5.058x speedup, step: 2
Epoch 21/300 |loss: 0.000898| train set 5.031x speedup, test set 1.706x speedup, val set 5.094x speedup, step: 3
Epoch 22/300 |loss: 0.001139| train set 4.380x speedup, test set 0.913x speedup, val set 3.798x speedup, step: 4
Epoch 23/300 |loss: 0.001046| train set 5.492x speedup, test set 1.751x speedup, val set 5.099x speedup, step: 5
Epoch 24/300 |loss: 0.000790| train set 4.991x speedup, test set 0.908x speedup, val set 5.062x speedup, step: 6
Epoch 25/300 |loss: 0.000902| train set 5.483x speedup, test set 1.750x speedup, val set 5.089x speedup, step: 7
Epoch 26/300 |loss: 0.000861| train set 5.446x speedup, test set 0.910x speedup, val set 5.060x speedup, step: 8
Epoch 27/300 |loss: 0.000819| train set 5.447x speedup, test set 0.909x speedup, val set 5.066x speedup, step: 9
Epoch 28/300 |loss: 0.000827| train set 5.401x speedup, test set 0.910x speedup, val set 5.015x speedup, step: 10
Epoch 29/300 |loss: 0.000896| train set 5.494x speedup, test set 0.911x speedup, val set 5.101x speedup, step: 11
Epoch 30/300 |loss: 0.000747| train set 5.448x speedup, test set 0.911x speedup, val set 5.067x speedup, step: 12
Epoch 31/300 |loss: 0.000784| train set 5.495x speedup, test set 1.873x speedup, val set 5.104x speedup, step: 13
Epoch 32/300 |loss: 0.000722| train set 5.489x speedup, test set 0.911x speedup, val set 5.094x speedup, step: 14
Epoch 33/300 |loss: 0.000761| train set 5.497x speedup, test set 1.873x speedup, val set 5.106x speedup, step: 15
Epoch 34/300 |loss: 0.000735| train set 5.442x speedup, test set 0.911x speedup, val set 5.072x speedup, step: 16
Epoch 35/300 |loss: 0.000706| train set 5.494x speedup, test set 1.849x speedup, val set 5.100x speedup, step: 17
Epoch 36/300 |loss: 0.000785| train set 5.471x speedup, test set 0.914x speedup, val set 5.105x speedup, step: 18
Epoch 37/300 |loss: 0.000747| train set 5.489x speedup, test set 0.911x speedup, val set 5.101x speedup, step: 19
Epoch 38/300 |loss: 0.000629| train set 5.485x speedup, test set 0.911x speedup, val set 5.108x speedup, step: 1
Epoch 39/300 |loss: 0.000848| train set 5.492x speedup, test set 1.885x speedup, val set 5.100x speedup, step: 2
Epoch 40/300 |loss: 0.001042| train set 5.448x speedup, test set 0.910x speedup, val set 5.067x speedup, step: 3
early stopping at epoch 40
Training per epoch cost 0.423 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.325s, pg runtime 0.072s, speedup 0.221x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 2.969s, pg runtime 2.959s, speedup 0.997x
11, opt runtime 0.294s, model runtime 2.841s, pg runtime 2.352s, speedup 0.828x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 1.659s, pg runtime 0.153s, speedup 0.092x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.489s, pg runtime 0.453s, speedup 0.928x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.601s, pg runtime 2.599s, speedup 0.999x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.061s, pg runtime 0.086s, speedup 1.407x
21, opt runtime 0.626s, model runtime 0.782s, pg runtime 2.558s, speedup 3.272x
22, opt runtime 0.136s, model runtime 4.005s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 33, train speedup 5.497, test speedup 1.873, val speedup 5.106
best test speedup epoch: 39, train speedup 5.492, test speedup 1.885, val speedup 5.100
best validation speedup epoch: 38, train speedup 5.485, test speedup 0.911, val speedup 5.108
last model at epoch 40, train speedup 5.448, test speedup 0.910, val speedup 5.067
execution cost 0:00:43.475686
==================================================
