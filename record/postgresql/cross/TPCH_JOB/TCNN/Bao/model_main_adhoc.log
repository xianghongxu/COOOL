all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.699997, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006085| train set 3.665x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004554| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003956| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003215| train set 4.348x speedup, test set 0.941x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003188| train set 4.957x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002454| train set 4.338x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002374| train set 4.306x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001976| train set 4.956x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.002077| train set 4.479x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001739| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001528| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001394| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001202| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001058| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001368| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.001066| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.001067| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000834| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000938| train set 4.865x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001541| train set 4.920x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000936| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000791| train set 4.998x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.001010| train set 5.005x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000852| train set 5.004x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000771| train set 5.004x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000729| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000766| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000984| train set 4.994x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000844| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000781| train set 4.998x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000843| train set 5.003x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000796| train set 4.920x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000761| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000820| train set 4.993x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000916| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.740 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.008, test speedup 0.957, val speedup 0.918
execution cost 0:01:21.608832
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:01.010601, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004564| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003919| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003141| train set 4.348x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003116| train set 5.007x speedup, test set 0.895x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002341| train set 4.300x speedup, test set 0.934x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002124| train set 4.888x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001849| train set 4.957x speedup, test set 0.962x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001837| train set 4.440x speedup, test set 0.926x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001686| train set 5.007x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001407| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001517| train set 4.844x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001150| train set 4.883x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001001| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001097| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000869| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000911| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000819| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000957| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001327| train set 4.996x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000880| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000837| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000863| train set 5.008x speedup, test set 0.963x speedup, val set 0.733x speedup, step: 25
Epoch 25/300 |loss: 0.000781| train set 5.000x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000803| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000788| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000817| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000980| train set 4.954x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 30
Epoch 30/300 |loss: 0.001050| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000760| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000773| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000785| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000766| train set 5.008x speedup, test set 0.957x speedup, val set 0.729x speedup, step: 35
Epoch 35/300 |loss: 0.000785| train set 4.997x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000926| train set 5.008x speedup, test set 0.957x speedup, val set 0.928x speedup, step: 37
Epoch 37/300 |loss: 0.000800| train set 5.004x speedup, test set 0.957x speedup, val set 0.739x speedup, step: 38
Epoch 38/300 |loss: 0.000854| train set 5.007x speedup, test set 0.957x speedup, val set 0.938x speedup, step: 39
Epoch 39/300 |loss: 0.000857| train set 5.007x speedup, test set 0.957x speedup, val set 0.729x speedup, step: 40
Epoch 40/300 |loss: 0.000747| train set 4.921x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 41
Epoch 41/300 |loss: 0.000792| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 42
Epoch 42/300 |loss: 0.000755| train set 5.004x speedup, test set 0.957x speedup, val set 0.928x speedup, step: 43
Epoch 43/300 |loss: 0.000766| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 44
Epoch 44/300 |loss: 0.000803| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 45
Epoch 45/300 |loss: 0.000790| train set 5.007x speedup, test set 0.957x speedup, val set 0.746x speedup, step: 46
Epoch 46/300 |loss: 0.000766| train set 5.000x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 47
Epoch 47/300 |loss: 0.000728| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 48
Epoch 48/300 |loss: 0.000746| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 49
Epoch 49/300 |loss: 0.000850| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 50
Epoch 50/300 |loss: 0.000758| train set 5.004x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 51
Epoch 51/300 |loss: 0.000752| train set 5.008x speedup, test set 0.957x speedup, val set 0.739x speedup, step: 52
Epoch 52/300 |loss: 0.000756| train set 5.008x speedup, test set 0.963x speedup, val set 0.733x speedup, step: 53
Epoch 53/300 |loss: 0.000737| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 54
Epoch 54/300 |loss: 0.000791| train set 4.921x speedup, test set 0.957x speedup, val set 0.729x speedup, step: 55
Epoch 55/300 |loss: 0.000751| train set 5.003x speedup, test set 0.963x speedup, val set 0.938x speedup, step: 56
Epoch 56/300 |loss: 0.000774| train set 5.007x speedup, test set 0.957x speedup, val set 0.928x speedup, step: 57
early stopping at epoch 56
Training per epoch cost 0.960 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 19, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 56, train speedup 5.007, test speedup 0.957, val speedup 0.928
execution cost 0:02:28.600770
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:01.024259, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004580| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.004069| train set 4.348x speedup, test set 0.920x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003159| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003181| train set 5.007x speedup, test set 0.905x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002365| train set 4.338x speedup, test set 0.894x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002210| train set 4.891x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001857| train set 4.956x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001812| train set 4.433x speedup, test set 0.927x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001591| train set 5.008x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001370| train set 4.806x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001440| train set 4.844x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001170| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001044| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.000983| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000907| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000975| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000876| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000975| train set 4.865x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001271| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000834| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000835| train set 4.998x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000832| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000806| train set 4.988x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000874| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000751| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000781| train set 5.008x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000961| train set 4.958x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000908| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000802| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000829| train set 5.005x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000800| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000860| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000802| train set 4.997x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000916| train set 4.998x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.996 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 11, train speedup 5.008, test speedup 0.925, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 4.998, test speedup 0.963, val speedup 0.928
execution cost 0:01:41.726656
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:01.083605, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006094| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004588| train set 4.082x speedup, test set 0.984x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003963| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003174| train set 4.348x speedup, test set 0.947x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003106| train set 4.957x speedup, test set 0.905x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002194| train set 4.300x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002109| train set 4.891x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001879| train set 4.947x speedup, test set 0.955x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001704| train set 4.883x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001590| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001371| train set 4.809x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001382| train set 4.957x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001035| train set 5.005x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001181| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001143| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000853| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000898| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000812| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000927| train set 4.864x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001556| train set 4.910x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000930| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000793| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000883| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000784| train set 5.002x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000779| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000738| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000763| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000953| train set 5.002x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000852| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000776| train set 4.945x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000812| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000794| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000816| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
early stopping at epoch 34
Training per epoch cost 0.955 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 17, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 34, train speedup 5.008, test speedup 0.963, val speedup 0.918
execution cost 0:01:36.095321
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:01.033955, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004582| train set 4.082x speedup, test set 0.945x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.004005| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003217| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003074| train set 4.956x speedup, test set 0.887x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002296| train set 4.300x speedup, test set 0.909x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002097| train set 4.386x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001853| train set 4.956x speedup, test set 0.920x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001738| train set 4.990x speedup, test set 0.926x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001785| train set 5.008x speedup, test set 0.927x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001507| train set 4.809x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001601| train set 4.844x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001097| train set 4.999x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.000974| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.000997| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000968| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.001000| train set 5.005x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000800| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000927| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001346| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000872| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000799| train set 4.997x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000855| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000785| train set 4.997x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000834| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000751| train set 5.004x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 28
Epoch 28/300 |loss: 0.000779| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000900| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.001004| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000778| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000798| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000792| train set 5.007x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 34
Epoch 34/300 |loss: 0.000796| train set 5.008x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 35
early stopping at epoch 34
Training per epoch cost 0.962 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 11, train speedup 5.008, test speedup 0.927, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 34, train speedup 5.008, test speedup 0.963, val speedup 0.928
execution cost 0:01:36.188559
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:01.011415, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006088| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004595| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003894| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003169| train set 4.348x speedup, test set 0.930x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003278| train set 4.957x speedup, test set 0.897x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002306| train set 4.300x speedup, test set 0.894x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002087| train set 4.487x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001897| train set 4.957x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001733| train set 4.479x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001644| train set 5.007x speedup, test set 0.909x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001471| train set 4.809x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001438| train set 4.958x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001146| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001272| train set 4.958x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001341| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000890| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000858| train set 5.001x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000794| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000847| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001251| train set 4.919x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000870| train set 4.999x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000829| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000875| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000781| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000800| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000771| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000771| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000991| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000925| train set 4.949x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000821| train set 4.990x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 32
Epoch 32/300 |loss: 0.000881| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000803| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000780| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000775| train set 4.994x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 36
Epoch 36/300 |loss: 0.000931| train set 4.997x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.979 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 17, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 4.997, test speedup 0.963, val speedup 0.918
execution cost 0:01:41.198682
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:01.038839, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006085| train set 3.665x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004554| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003956| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003227| train set 4.348x speedup, test set 0.947x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003156| train set 4.957x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002341| train set 4.300x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002271| train set 4.334x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001843| train set 4.997x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001729| train set 4.471x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001660| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001470| train set 4.793x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001487| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001149| train set 4.921x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001173| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001213| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000931| train set 4.920x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000956| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000864| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000964| train set 4.998x speedup, test set 0.963x speedup, val set 0.797x speedup, step: 21
Epoch 21/300 |loss: 0.001440| train set 4.911x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000876| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000836| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000911| train set 5.008x speedup, test set 0.963x speedup, val set 0.733x speedup, step: 25
Epoch 25/300 |loss: 0.000798| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000788| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000747| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000779| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000959| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000985| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000800| train set 4.995x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000834| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000788| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000759| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000804| train set 4.997x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000930| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.956 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 11, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.008, test speedup 0.963, val speedup 0.918
execution cost 0:01:40.942531
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.993398, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004574| train set 4.082x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003993| train set 4.310x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003234| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003171| train set 4.956x speedup, test set 0.887x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002315| train set 4.300x speedup, test set 0.894x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002146| train set 4.891x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001898| train set 4.956x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001721| train set 4.468x speedup, test set 0.926x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001580| train set 5.007x speedup, test set 0.927x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001347| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001426| train set 4.956x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001109| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001302| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001340| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000910| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000873| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000794| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000858| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001218| train set 4.921x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000848| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000823| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000854| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000785| train set 4.993x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000828| train set 5.000x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000762| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000769| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000957| train set 4.945x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.001026| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000769| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000815| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000785| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000847| train set 4.998x speedup, test set 0.963x speedup, val set 0.895x speedup, step: 35
early stopping at epoch 34
Training per epoch cost 0.955 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 34, train speedup 4.998, test speedup 0.963, val speedup 0.895
execution cost 0:01:36.248765
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:01.091021, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006094| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004588| train set 4.082x speedup, test set 0.984x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003957| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003155| train set 4.301x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003098| train set 4.957x speedup, test set 0.901x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002263| train set 4.300x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002101| train set 4.888x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001911| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001761| train set 4.478x speedup, test set 0.955x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001652| train set 5.008x speedup, test set 0.955x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001451| train set 4.801x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001524| train set 4.957x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001073| train set 5.005x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001029| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.000919| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000866| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000861| train set 5.002x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000928| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.001085| train set 4.864x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001471| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000871| train set 5.001x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000787| train set 4.911x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000857| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000779| train set 5.002x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000823| train set 5.004x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000769| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000757| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000961| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000911| train set 4.999x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000792| train set 4.945x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000904| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
early stopping at epoch 32
Training per epoch cost 0.983 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 32, train speedup 4.998, test speedup 0.963, val speedup 0.918
execution cost 0:01:33.511359
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.951742, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.665x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004552| train set 4.264x speedup, test set 0.984x speedup, val set 0.918x speedup, step: 4
Epoch 4/300 |loss: 0.003908| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003124| train set 4.300x speedup, test set 0.930x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003087| train set 4.958x speedup, test set 0.895x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002215| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002152| train set 4.870x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001915| train set 4.826x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001747| train set 4.882x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001743| train set 5.008x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001467| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001455| train set 4.843x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001163| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001051| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001035| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000972| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000944| train set 5.006x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000810| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000936| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001342| train set 4.997x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000902| train set 4.992x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000812| train set 4.998x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000905| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000800| train set 5.006x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000806| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000780| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000768| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000952| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.001054| train set 4.998x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000781| train set 5.000x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000820| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000805| train set 4.920x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000784| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000828| train set 4.904x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000949| train set 4.914x speedup, test set 0.957x speedup, val set 0.928x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.964 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 4.914, test speedup 0.957, val speedup 0.928
execution cost 0:01:41.083628
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.556355, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004564| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003921| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003140| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003165| train set 4.957x speedup, test set 0.905x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002362| train set 4.300x speedup, test set 0.950x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002210| train set 4.891x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001841| train set 4.954x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001834| train set 4.434x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001720| train set 5.008x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001449| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001572| train set 4.918x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001199| train set 4.892x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001159| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001425| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000911| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000899| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000808| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000953| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001213| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000812| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000814| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000877| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000786| train set 5.002x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000798| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000762| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000762| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000969| train set 4.921x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000872| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000772| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000797| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000784| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000805| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000867| train set 4.912x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 36
early stopping at epoch 35
Training per epoch cost 0.516 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 11, train speedup 5.008, test speedup 0.925, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 35, train speedup 4.912, test speedup 0.963, val speedup 0.918
execution cost 0:00:44.747859
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.583233, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004564| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003920| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003150| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003178| train set 5.007x speedup, test set 0.887x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002377| train set 4.318x speedup, test set 0.934x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002278| train set 4.891x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001859| train set 4.956x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001835| train set 4.478x speedup, test set 0.927x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001634| train set 5.007x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001404| train set 4.800x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001576| train set 4.956x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001219| train set 4.800x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.000992| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001080| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000860| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000864| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000830| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000920| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001617| train set 4.920x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000945| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000810| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000893| train set 5.008x speedup, test set 0.963x speedup, val set 0.733x speedup, step: 25
Epoch 25/300 |loss: 0.000811| train set 4.994x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000777| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000753| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000789| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000951| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000833| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000775| train set 5.004x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000838| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000799| train set 4.920x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000767| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000801| train set 4.911x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000912| train set 5.008x speedup, test set 0.957x speedup, val set 0.928x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.524 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 17, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.008, test speedup 0.957, val speedup 0.928
execution cost 0:00:45.753928
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.561511, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006088| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004595| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003894| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003160| train set 4.348x speedup, test set 0.936x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003167| train set 4.957x speedup, test set 0.906x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002242| train set 4.300x speedup, test set 0.895x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002106| train set 4.359x speedup, test set 0.950x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001946| train set 4.874x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001738| train set 4.470x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001731| train set 5.007x speedup, test set 0.919x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001491| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001468| train set 4.844x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001228| train set 4.883x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001115| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001072| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000988| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000983| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000846| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000947| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001317| train set 4.989x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000840| train set 5.007x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000837| train set 4.997x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000912| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000797| train set 5.006x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000883| train set 5.004x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000741| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000775| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000937| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000974| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000777| train set 5.005x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000832| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000822| train set 5.007x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 34
Epoch 34/300 |loss: 0.000809| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
early stopping at epoch 34
Training per epoch cost 0.517 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 17, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 34, train speedup 5.008, test speedup 0.963, val speedup 0.918
execution cost 0:00:43.408352
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.617887, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006088| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004605| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003933| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003159| train set 4.348x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003224| train set 4.957x speedup, test set 0.898x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002364| train set 4.300x speedup, test set 0.906x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002174| train set 4.332x speedup, test set 0.920x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001860| train set 5.006x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001680| train set 4.478x speedup, test set 0.920x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001615| train set 5.007x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001466| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001466| train set 4.958x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001160| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001073| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.000997| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000897| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000964| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000876| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000935| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001274| train set 4.998x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000832| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000822| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000898| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000822| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000875| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000763| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000757| train set 5.008x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.001052| train set 4.954x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000983| train set 5.008x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000805| train set 4.990x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000850| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000786| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000756| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000811| train set 4.992x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 36
Epoch 36/300 |loss: 0.000902| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.528 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 16, train speedup 5.008, test speedup 0.957, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.008, test speedup 0.963, val speedup 0.918
execution cost 0:00:46.340161
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.599578, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006085| train set 3.665x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004554| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003958| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003231| train set 4.331x speedup, test set 0.941x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003216| train set 4.957x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002330| train set 4.300x speedup, test set 0.944x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002210| train set 4.385x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001877| train set 4.956x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001679| train set 4.479x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001605| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001487| train set 4.802x speedup, test set 0.950x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001471| train set 4.958x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001060| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001103| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001034| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000853| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000900| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000898| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000978| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001488| train set 4.997x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000880| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000795| train set 4.911x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000899| train set 5.005x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000777| train set 5.005x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000796| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000741| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000762| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000929| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000926| train set 4.958x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000826| train set 4.945x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000922| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
early stopping at epoch 32
Training per epoch cost 0.527 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 32, train speedup 5.007, test speedup 0.963, val speedup 0.918
execution cost 0:00:41.917724
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.618285, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004587| train set 4.082x speedup, test set 0.945x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.004089| train set 4.310x speedup, test set 0.922x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003179| train set 4.348x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003128| train set 4.957x speedup, test set 0.905x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002297| train set 4.300x speedup, test set 0.894x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002144| train set 4.892x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001906| train set 5.006x speedup, test set 0.926x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001741| train set 4.470x speedup, test set 0.926x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001635| train set 5.008x speedup, test set 0.926x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001415| train set 4.801x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001379| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001183| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001351| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001138| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000970| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.001001| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000855| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000929| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001182| train set 4.917x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000803| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000880| train set 5.008x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 24
Epoch 24/300 |loss: 0.000977| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000824| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000857| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000785| train set 5.004x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 28
Epoch 28/300 |loss: 0.000761| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.001000| train set 4.945x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000997| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000809| train set 5.003x speedup, test set 0.963x speedup, val set 0.938x speedup, step: 32
early stopping at epoch 31
Training per epoch cost 0.517 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 11, train speedup 5.008, test speedup 0.926, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 31, train speedup 5.003, test speedup 0.963, val speedup 0.938
execution cost 0:00:39.894817
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.548629, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004564| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003921| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003134| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003100| train set 5.007x speedup, test set 0.895x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002295| train set 4.338x speedup, test set 0.950x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002087| train set 4.372x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001923| train set 4.957x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001756| train set 4.470x speedup, test set 0.927x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001657| train set 5.007x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001437| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001464| train set 4.956x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001086| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001392| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001518| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.001003| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000909| train set 5.006x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000831| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000922| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001139| train set 4.911x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000800| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000834| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000976| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000777| train set 4.995x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000814| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000768| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000770| train set 4.865x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000965| train set 4.958x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000956| train set 4.958x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000824| train set 4.950x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 32
early stopping at epoch 31
Training per epoch cost 0.528 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 31, train speedup 4.950, test speedup 0.957, val speedup 0.918
execution cost 0:00:40.223797
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.550393, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004564| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003919| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003148| train set 4.195x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003167| train set 4.957x speedup, test set 0.905x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002351| train set 4.300x speedup, test set 0.950x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002204| train set 4.884x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001833| train set 4.956x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001673| train set 4.470x speedup, test set 0.927x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001587| train set 5.007x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001403| train set 4.801x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001456| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001180| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001063| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001126| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000968| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.001002| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000822| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000947| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001420| train set 4.997x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000865| train set 5.001x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000828| train set 4.911x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000909| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000793| train set 4.992x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000807| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000760| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000767| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000947| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000894| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000821| train set 4.990x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000865| train set 5.003x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000798| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000793| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 35
early stopping at epoch 34
Training per epoch cost 0.520 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 16, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 34, train speedup 5.008, test speedup 0.957, val speedup 0.918
execution cost 0:00:43.480481
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.627645, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006088| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004605| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003931| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003183| train set 4.348x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003280| train set 4.958x speedup, test set 0.898x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002482| train set 4.338x speedup, test set 0.904x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002433| train set 4.338x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001968| train set 4.958x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.002015| train set 4.478x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001686| train set 5.006x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001486| train set 4.801x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001407| train set 4.957x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001088| train set 4.921x speedup, test set 0.962x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001013| train set 5.008x speedup, test set 0.962x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001156| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000909| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000929| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000836| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000939| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001453| train set 4.920x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000921| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000791| train set 4.998x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000841| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000779| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000764| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000738| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000762| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000944| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000842| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000771| train set 4.990x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 32
Epoch 32/300 |loss: 0.000838| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000796| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000761| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000781| train set 4.997x speedup, test set 0.957x speedup, val set 0.928x speedup, step: 36
Epoch 36/300 |loss: 0.000959| train set 4.990x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.516 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.962, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 4.990, test speedup 0.957, val speedup 0.918
execution cost 0:00:45.658037
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.529297, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006088| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004595| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003895| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003190| train set 4.348x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003151| train set 4.957x speedup, test set 0.896x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002280| train set 4.300x speedup, test set 0.909x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002085| train set 4.892x speedup, test set 0.926x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001885| train set 4.797x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001783| train set 4.476x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001796| train set 5.007x speedup, test set 0.920x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001511| train set 4.809x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001504| train set 4.845x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001182| train set 4.892x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001085| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001053| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.001073| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.001028| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000831| train set 5.008x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000942| train set 4.865x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001137| train set 4.998x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000858| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000886| train set 5.008x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000946| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000814| train set 4.997x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000887| train set 5.000x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000749| train set 5.008x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000774| train set 5.008x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.001087| train set 4.954x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.001019| train set 4.998x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000776| train set 4.996x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000824| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000803| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000769| train set 5.004x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000790| train set 4.993x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000940| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.525 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.008, test speedup 0.957, val speedup 0.918
execution cost 0:00:46.109440
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.526101, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004574| train set 4.082x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003993| train set 4.310x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003227| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003140| train set 4.957x speedup, test set 0.887x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002333| train set 4.300x speedup, test set 0.904x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002129| train set 4.891x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001855| train set 4.956x speedup, test set 0.926x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001723| train set 4.468x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001607| train set 5.007x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001401| train set 4.809x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001448| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001143| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001244| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001186| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000877| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000851| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000817| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000891| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001291| train set 4.921x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000824| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000845| train set 4.997x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000971| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000815| train set 4.993x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000827| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000756| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000776| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.001003| train set 4.917x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000870| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000804| train set 5.002x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000852| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000788| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000777| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000805| train set 4.907x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000924| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.487 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.008, test speedup 0.963, val speedup 0.918
execution cost 0:00:42.602323
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.536774, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006088| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004595| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003895| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003191| train set 4.348x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003155| train set 4.957x speedup, test set 0.896x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002288| train set 4.301x speedup, test set 0.894x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002111| train set 4.892x speedup, test set 0.962x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001828| train set 4.310x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001704| train set 4.478x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001820| train set 5.007x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001582| train set 4.809x speedup, test set 0.962x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001469| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001155| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001218| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001113| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.001060| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000948| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000852| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000947| train set 4.865x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001332| train set 4.904x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000847| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000829| train set 4.912x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.001027| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000829| train set 5.002x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000817| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000764| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000768| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.001040| train set 4.954x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000901| train set 4.998x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000805| train set 5.004x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000885| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000837| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000774| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000825| train set 4.994x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000905| train set 5.004x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.487 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.004, test speedup 0.957, val speedup 0.918
execution cost 0:00:43.698803
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.552753, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006088| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004595| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003989| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003217| train set 4.300x speedup, test set 0.930x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003238| train set 4.957x speedup, test set 0.887x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002389| train set 4.300x speedup, test set 0.894x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002272| train set 4.338x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001928| train set 4.956x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001833| train set 4.468x speedup, test set 0.920x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001641| train set 5.006x speedup, test set 0.920x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001405| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001480| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001089| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.000973| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.000984| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000905| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000993| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000865| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000945| train set 4.865x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001411| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000856| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000804| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000806| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000779| train set 4.988x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000805| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000751| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000781| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000995| train set 4.954x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000946| train set 5.005x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000783| train set 4.986x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000847| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000795| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000783| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 35
early stopping at epoch 34
Training per epoch cost 0.497 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 34, train speedup 5.008, test speedup 0.957, val speedup 0.918
execution cost 0:00:41.406388
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.664639, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004564| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003921| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003140| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003165| train set 4.957x speedup, test set 0.905x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002362| train set 4.300x speedup, test set 0.950x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002202| train set 4.892x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001835| train set 4.956x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001735| train set 4.468x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001701| train set 5.007x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001468| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001545| train set 4.957x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001190| train set 4.911x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001183| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001430| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000972| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000891| train set 5.006x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000797| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000889| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001175| train set 4.920x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000816| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000826| train set 4.998x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000911| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000799| train set 5.002x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000852| train set 5.007x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000755| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000768| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.001003| train set 4.953x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000878| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000786| train set 4.945x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000851| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000822| train set 4.920x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000785| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000825| train set 4.907x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000945| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.506 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.008, test speedup 0.957, val speedup 0.918
execution cost 0:00:44.318305
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.533652, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006094| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004588| train set 4.082x speedup, test set 0.984x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003963| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003174| train set 4.348x speedup, test set 0.947x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003118| train set 4.957x speedup, test set 0.906x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002217| train set 4.195x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002111| train set 4.891x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001924| train set 4.834x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001710| train set 4.468x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001659| train set 5.007x speedup, test set 0.955x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001418| train set 4.801x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001502| train set 5.006x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001079| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001032| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.000993| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000840| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000900| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000874| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000939| train set 4.865x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001551| train set 5.006x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000889| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000803| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000881| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000803| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000808| train set 5.000x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000751| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000759| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000920| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000831| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000788| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000881| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000782| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000771| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000808| train set 4.989x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000867| train set 4.990x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.511 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 14, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 4.990, test speedup 0.963, val speedup 0.918
execution cost 0:00:43.689812
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.559364, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004564| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003921| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003132| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003102| train set 5.007x speedup, test set 0.895x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002290| train set 4.338x speedup, test set 0.950x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002109| train set 4.386x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001945| train set 4.826x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001719| train set 4.470x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001644| train set 5.007x speedup, test set 0.925x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001431| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001496| train set 4.957x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001171| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001252| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001487| train set 5.008x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000908| train set 4.921x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000847| train set 5.006x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000782| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000872| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001211| train set 4.921x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000822| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000824| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000876| train set 5.008x speedup, test set 0.963x speedup, val set 0.733x speedup, step: 25
Epoch 25/300 |loss: 0.000785| train set 4.991x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000856| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000758| train set 5.005x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000782| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000997| train set 4.958x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000808| train set 4.958x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000801| train set 4.944x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000865| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000812| train set 4.921x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000786| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 35
early stopping at epoch 34
Training per epoch cost 0.491 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 34, train speedup 5.008, test speedup 0.963, val speedup 0.729
execution cost 0:00:40.561218
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.685432, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006094| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004588| train set 4.082x speedup, test set 0.984x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003957| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003161| train set 4.348x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003069| train set 4.957x speedup, test set 0.905x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002195| train set 4.300x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002067| train set 4.890x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001896| train set 4.957x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001683| train set 4.468x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001588| train set 5.005x speedup, test set 0.961x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001356| train set 4.807x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001335| train set 4.957x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001082| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.000915| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.000906| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000865| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000889| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000851| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000996| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001462| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000861| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000797| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000850| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000798| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000829| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000738| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000764| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000958| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000877| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000770| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000863| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000813| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000775| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000795| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 36
Epoch 36/300 |loss: 0.000884| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.487 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 16, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.008, test speedup 0.963, val speedup 0.918
execution cost 0:00:43.083942
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.580332, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006088| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004595| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.004000| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003200| train set 4.300x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003108| train set 5.007x speedup, test set 0.905x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002258| train set 4.301x speedup, test set 0.894x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002106| train set 4.892x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001925| train set 4.835x speedup, test set 0.919x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001795| train set 4.471x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001712| train set 5.008x speedup, test set 0.919x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001467| train set 4.809x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001553| train set 4.957x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001110| train set 4.910x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001101| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001112| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000889| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000933| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000837| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000902| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001403| train set 4.999x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000866| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000821| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000872| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000789| train set 4.994x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000812| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000769| train set 5.004x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 28
Epoch 28/300 |loss: 0.000771| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.001061| train set 4.958x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000823| train set 5.008x speedup, test set 0.956x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000771| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000829| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000787| train set 4.921x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000770| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000799| train set 4.997x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 36
Epoch 36/300 |loss: 0.000954| train set 5.007x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.500 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.007, test speedup 0.963, val speedup 0.928
execution cost 0:00:43.032157
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.659802, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006088| train set 3.668x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004595| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003893| train set 4.348x speedup, test set 0.932x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003169| train set 4.348x speedup, test set 0.941x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003209| train set 4.958x speedup, test set 0.898x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002256| train set 4.300x speedup, test set 0.894x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002064| train set 4.884x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001943| train set 4.826x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001790| train set 4.470x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001616| train set 5.007x speedup, test set 0.913x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001449| train set 4.801x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001464| train set 4.957x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001122| train set 4.998x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001083| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.000965| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000893| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000889| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000860| train set 5.008x speedup, test set 0.962x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.001047| train set 4.864x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001278| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000841| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000822| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000863| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000803| train set 5.003x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000821| train set 5.000x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000790| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000780| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000982| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.001014| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000785| train set 4.990x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 32
Epoch 32/300 |loss: 0.000843| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000805| train set 5.007x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 34
Epoch 34/300 |loss: 0.000793| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
Epoch 35/300 |loss: 0.000790| train set 4.994x speedup, test set 0.963x speedup, val set 0.938x speedup, step: 36
Epoch 36/300 |loss: 0.000922| train set 5.008x speedup, test set 0.963x speedup, val set 0.928x speedup, step: 37
early stopping at epoch 36
Training per epoch cost 0.491 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 15, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 36, train speedup 5.008, test speedup 0.963, val speedup 0.928
execution cost 0:00:42.965083
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/point
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: point
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 300
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/point
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
construct training samples cost 0:00:00.530634, and there are 6860 training samples
in channel 9
Epoch 0/300 |loss: 0.042801| train set 2.378x speedup, test set 1.071x speedup, val set 1.684x speedup, step: 1
Epoch 1/300 |loss: 0.011355| train set 3.089x speedup, test set 0.939x speedup, val set 0.992x speedup, step: 2
Epoch 2/300 |loss: 0.006086| train set 3.667x speedup, test set 0.997x speedup, val set 0.975x speedup, step: 3
Epoch 3/300 |loss: 0.004564| train set 4.264x speedup, test set 0.986x speedup, val set 0.975x speedup, step: 4
Epoch 4/300 |loss: 0.003920| train set 4.348x speedup, test set 0.921x speedup, val set 0.918x speedup, step: 5
Epoch 5/300 |loss: 0.003160| train set 4.348x speedup, test set 0.928x speedup, val set 0.918x speedup, step: 6
Epoch 6/300 |loss: 0.003164| train set 4.957x speedup, test set 0.898x speedup, val set 0.918x speedup, step: 7
Epoch 7/300 |loss: 0.002371| train set 4.338x speedup, test set 0.934x speedup, val set 0.918x speedup, step: 8
Epoch 8/300 |loss: 0.002244| train set 4.891x speedup, test set 0.962x speedup, val set 0.918x speedup, step: 9
Epoch 9/300 |loss: 0.001903| train set 4.957x speedup, test set 0.962x speedup, val set 0.918x speedup, step: 10
Epoch 10/300 |loss: 0.001895| train set 4.471x speedup, test set 0.927x speedup, val set 0.918x speedup, step: 11
Epoch 11/300 |loss: 0.001553| train set 5.006x speedup, test set 0.927x speedup, val set 0.918x speedup, step: 12
Epoch 12/300 |loss: 0.001401| train set 4.802x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 13
Epoch 13/300 |loss: 0.001553| train set 4.956x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 14
Epoch 14/300 |loss: 0.001184| train set 4.912x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 15
Epoch 15/300 |loss: 0.001023| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 16
Epoch 16/300 |loss: 0.001070| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 17
Epoch 17/300 |loss: 0.000841| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 18
Epoch 18/300 |loss: 0.000869| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 19
Epoch 19/300 |loss: 0.000857| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 20
Epoch 20/300 |loss: 0.000930| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 21
Epoch 21/300 |loss: 0.001491| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 22
Epoch 22/300 |loss: 0.000860| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 23
Epoch 23/300 |loss: 0.000849| train set 4.997x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 24
Epoch 24/300 |loss: 0.000881| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 25
Epoch 25/300 |loss: 0.000779| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 26
Epoch 26/300 |loss: 0.000825| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 27
Epoch 27/300 |loss: 0.000739| train set 5.005x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 28
Epoch 28/300 |loss: 0.000761| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 29
Epoch 29/300 |loss: 0.000920| train set 5.004x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 30
Epoch 30/300 |loss: 0.000910| train set 5.008x speedup, test set 0.957x speedup, val set 0.918x speedup, step: 31
Epoch 31/300 |loss: 0.000773| train set 4.990x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 32
Epoch 32/300 |loss: 0.000841| train set 5.007x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 33
Epoch 33/300 |loss: 0.000788| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 34
Epoch 34/300 |loss: 0.000806| train set 5.008x speedup, test set 0.963x speedup, val set 0.918x speedup, step: 35
early stopping at epoch 34
Training per epoch cost 0.490 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 1.299s, pg runtime 5.855s, speedup 4.506x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 3.353s, pg runtime 3.549s, speedup 1.059x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.247s, pg runtime 1.437s, speedup 0.442x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 2.323s, pg runtime 1.386s, speedup 0.597x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.654s, pg runtime 0.189s, speedup 0.289x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
22, opt runtime 0.158s, model runtime 0.261s, pg runtime 0.158s, speedup 0.607x
23, opt runtime 0.129s, model runtime 0.711s, pg runtime 0.129s, speedup 0.182x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
27, opt runtime 0.278s, model runtime 1.700s, pg runtime 0.948s, speedup 0.558x
====================
best train speedup epoch: 22, train speedup 5.008, test speedup 0.963, val speedup 0.918
best test speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
best validation speedup epoch: 0, train speedup 2.378, test speedup 1.071, val speedup 1.684
last model at epoch 34, train speedup 5.008, test speedup 0.963, val speedup 0.918
execution cost 0:00:40.988846
==================================================
