all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.038976, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863303| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869003| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.875958| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.878937| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.886033| train set 2.928x speedup, test set 2.049x speedup, val set 0.729x speedup, step: 11
Epoch 12/200 |loss: -0.890737| train set 2.928x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 12
Epoch 13/200 |loss: -0.899641| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895254| train set 3.089x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 2
Epoch 15/200 |loss: -0.905721| train set 2.287x speedup, test set 2.049x speedup, val set 0.764x speedup, step: 3
Epoch 16/200 |loss: -0.901702| train set 2.437x speedup, test set 1.907x speedup, val set 0.764x speedup, step: 4
Epoch 17/200 |loss: -0.902505| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.906628| train set 2.415x speedup, test set 1.907x speedup, val set 0.832x speedup, step: 6
Epoch 19/200 |loss: -0.899578| train set 2.335x speedup, test set 2.099x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.909138| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.914258| train set 2.437x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.905348| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.903453| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.904447| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 12
early stopping at epoch 24
Training per epoch cost 0.918 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 5, train speedup 3.374, test speedup 1.143, val speedup 0.729
best test speedup epoch: 19, train speedup 2.335, test speedup 2.099, val speedup 0.729
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 24, train speedup 3.092, test speedup 1.249, val speedup 0.729
execution cost 0:01:03.674252
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.747249, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863303| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869003| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.875958| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.878937| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.886033| train set 2.928x speedup, test set 2.049x speedup, val set 0.729x speedup, step: 11
Epoch 12/200 |loss: -0.890737| train set 2.928x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 12
Epoch 13/200 |loss: -0.899641| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895254| train set 3.089x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 2
Epoch 15/200 |loss: -0.905721| train set 2.287x speedup, test set 2.049x speedup, val set 0.764x speedup, step: 3
Epoch 16/200 |loss: -0.901702| train set 2.437x speedup, test set 1.907x speedup, val set 0.764x speedup, step: 4
Epoch 17/200 |loss: -0.902505| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.906628| train set 2.415x speedup, test set 1.907x speedup, val set 0.832x speedup, step: 6
Epoch 19/200 |loss: -0.899578| train set 2.335x speedup, test set 2.099x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.909138| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.914258| train set 2.437x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.905348| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.903453| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.904447| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 12
early stopping at epoch 24
Training per epoch cost 1.059 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 5, train speedup 3.374, test speedup 1.143, val speedup 0.729
best test speedup epoch: 19, train speedup 2.335, test speedup 2.099, val speedup 0.729
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 24, train speedup 3.092, test speedup 1.249, val speedup 0.729
execution cost 0:01:13.575035
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.715055, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863303| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869003| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.875958| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.878937| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.886033| train set 2.928x speedup, test set 2.049x speedup, val set 0.729x speedup, step: 11
Epoch 12/200 |loss: -0.890737| train set 2.928x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 12
Epoch 13/200 |loss: -0.899641| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895254| train set 3.089x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 2
Epoch 15/200 |loss: -0.905721| train set 2.287x speedup, test set 2.049x speedup, val set 0.764x speedup, step: 3
Epoch 16/200 |loss: -0.901702| train set 2.437x speedup, test set 1.907x speedup, val set 0.764x speedup, step: 4
Epoch 17/200 |loss: -0.902505| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.906628| train set 2.415x speedup, test set 1.907x speedup, val set 0.832x speedup, step: 6
Epoch 19/200 |loss: -0.899578| train set 2.335x speedup, test set 2.099x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.909138| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.914258| train set 2.437x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.905348| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.903453| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.904447| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 12
early stopping at epoch 24
Training per epoch cost 1.063 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 5, train speedup 3.374, test speedup 1.143, val speedup 0.729
best test speedup epoch: 19, train speedup 2.335, test speedup 2.099, val speedup 0.729
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 24, train speedup 3.092, test speedup 1.249, val speedup 0.729
execution cost 0:01:16.023898
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.698888, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863303| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869003| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.875958| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.878937| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.886033| train set 2.928x speedup, test set 2.049x speedup, val set 0.729x speedup, step: 11
Epoch 12/200 |loss: -0.890737| train set 2.928x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 12
Epoch 13/200 |loss: -0.899641| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895254| train set 3.089x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 2
Epoch 15/200 |loss: -0.905721| train set 2.287x speedup, test set 2.049x speedup, val set 0.764x speedup, step: 3
Epoch 16/200 |loss: -0.901702| train set 2.437x speedup, test set 1.907x speedup, val set 0.764x speedup, step: 4
Epoch 17/200 |loss: -0.902505| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.906628| train set 2.415x speedup, test set 1.907x speedup, val set 0.832x speedup, step: 6
Epoch 19/200 |loss: -0.899578| train set 2.335x speedup, test set 2.099x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.909138| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.914258| train set 2.437x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.905348| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.903453| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.904447| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 12
early stopping at epoch 24
Training per epoch cost 0.983 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 5, train speedup 3.374, test speedup 1.143, val speedup 0.729
best test speedup epoch: 19, train speedup 2.335, test speedup 2.099, val speedup 0.729
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 24, train speedup 3.092, test speedup 1.249, val speedup 0.729
execution cost 0:01:09.885081
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.559612, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863304| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869009| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.876075| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.879239| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.885832| train set 2.928x speedup, test set 2.049x speedup, val set 0.752x speedup, step: 11
Epoch 12/200 |loss: -0.890451| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 13/200 |loss: -0.899811| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895101| train set 2.928x speedup, test set 2.049x speedup, val set 0.775x speedup, step: 2
Epoch 15/200 |loss: -0.905461| train set 2.994x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 3
Epoch 16/200 |loss: -0.901455| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 4
Epoch 17/200 |loss: -0.903154| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.907711| train set 2.583x speedup, test set 1.892x speedup, val set 0.764x speedup, step: 6
Epoch 19/200 |loss: -0.899571| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.911450| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.915492| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.906272| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.905467| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.905409| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 12
Epoch 25/200 |loss: -0.907648| train set 3.304x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 13
Epoch 26/200 |loss: -0.909079| train set 2.964x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 14
Epoch 27/200 |loss: -0.908915| train set 2.964x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 15
Epoch 28/200 |loss: -0.913723| train set 3.304x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 16
Epoch 29/200 |loss: -0.914654| train set 3.304x speedup, test set 1.336x speedup, val set 0.729x speedup, step: 17
Epoch 30/200 |loss: -0.907940| train set 3.460x speedup, test set 1.475x speedup, val set 0.729x speedup, step: 18
early stopping at epoch 30
Training per epoch cost 0.998 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 30, train speedup 3.460, test speedup 1.475, val speedup 0.729
best test speedup epoch: 11, train speedup 2.928, test speedup 2.049, val speedup 0.752
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 30, train speedup 3.460, test speedup 1.475, val speedup 0.729
execution cost 0:01:27.014615
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.564221, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863303| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869003| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.875958| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.878937| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.886033| train set 2.928x speedup, test set 2.049x speedup, val set 0.729x speedup, step: 11
Epoch 12/200 |loss: -0.890737| train set 2.928x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 12
Epoch 13/200 |loss: -0.899641| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895254| train set 3.089x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 2
Epoch 15/200 |loss: -0.905721| train set 2.287x speedup, test set 2.049x speedup, val set 0.764x speedup, step: 3
Epoch 16/200 |loss: -0.901702| train set 2.437x speedup, test set 1.907x speedup, val set 0.764x speedup, step: 4
Epoch 17/200 |loss: -0.902505| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.906628| train set 2.415x speedup, test set 1.907x speedup, val set 0.832x speedup, step: 6
Epoch 19/200 |loss: -0.899578| train set 2.335x speedup, test set 2.099x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.909138| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.914258| train set 2.437x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.905348| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.903453| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.904447| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 12
early stopping at epoch 24
Training per epoch cost 1.048 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 5, train speedup 3.374, test speedup 1.143, val speedup 0.729
best test speedup epoch: 19, train speedup 2.335, test speedup 2.099, val speedup 0.729
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 24, train speedup 3.092, test speedup 1.249, val speedup 0.729
execution cost 0:01:14.003972
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.769101, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863303| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869003| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.875958| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.878937| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.886033| train set 2.928x speedup, test set 2.049x speedup, val set 0.729x speedup, step: 11
Epoch 12/200 |loss: -0.890737| train set 2.928x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 12
Epoch 13/200 |loss: -0.899641| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895254| train set 3.089x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 2
Epoch 15/200 |loss: -0.905721| train set 2.287x speedup, test set 2.049x speedup, val set 0.764x speedup, step: 3
Epoch 16/200 |loss: -0.901702| train set 2.437x speedup, test set 1.907x speedup, val set 0.764x speedup, step: 4
Epoch 17/200 |loss: -0.902505| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.906628| train set 2.415x speedup, test set 1.907x speedup, val set 0.832x speedup, step: 6
Epoch 19/200 |loss: -0.899578| train set 2.335x speedup, test set 2.099x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.909138| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.914258| train set 2.437x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.905348| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.903453| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.904447| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 12
early stopping at epoch 24
Training per epoch cost 1.065 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 5, train speedup 3.374, test speedup 1.143, val speedup 0.729
best test speedup epoch: 19, train speedup 2.335, test speedup 2.099, val speedup 0.729
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 24, train speedup 3.092, test speedup 1.249, val speedup 0.729
execution cost 0:01:16.038993
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.735627, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863303| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869003| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.875958| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.878937| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.886033| train set 2.928x speedup, test set 2.049x speedup, val set 0.729x speedup, step: 11
Epoch 12/200 |loss: -0.890737| train set 2.928x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 12
Epoch 13/200 |loss: -0.899641| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895254| train set 3.089x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 2
Epoch 15/200 |loss: -0.905721| train set 2.287x speedup, test set 2.049x speedup, val set 0.764x speedup, step: 3
Epoch 16/200 |loss: -0.901702| train set 2.437x speedup, test set 1.907x speedup, val set 0.764x speedup, step: 4
Epoch 17/200 |loss: -0.902505| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.906628| train set 2.415x speedup, test set 1.907x speedup, val set 0.832x speedup, step: 6
Epoch 19/200 |loss: -0.899578| train set 2.335x speedup, test set 2.099x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.909138| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.914258| train set 2.437x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.905348| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.903453| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.904448| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 12
early stopping at epoch 24
Training per epoch cost 1.034 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 5, train speedup 3.374, test speedup 1.143, val speedup 0.729
best test speedup epoch: 19, train speedup 2.335, test speedup 2.099, val speedup 0.729
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 24, train speedup 3.092, test speedup 1.249, val speedup 0.729
execution cost 0:01:13.982043
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.740185, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863303| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869003| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.875958| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.878937| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.886033| train set 2.928x speedup, test set 2.049x speedup, val set 0.729x speedup, step: 11
Epoch 12/200 |loss: -0.890737| train set 2.928x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 12
Epoch 13/200 |loss: -0.899641| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895254| train set 3.089x speedup, test set 2.049x speedup, val set 0.994x speedup, step: 2
Epoch 15/200 |loss: -0.905721| train set 2.287x speedup, test set 2.049x speedup, val set 0.764x speedup, step: 3
Epoch 16/200 |loss: -0.901702| train set 2.437x speedup, test set 1.907x speedup, val set 0.764x speedup, step: 4
Epoch 17/200 |loss: -0.902505| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.906628| train set 2.415x speedup, test set 1.907x speedup, val set 0.832x speedup, step: 6
Epoch 19/200 |loss: -0.899578| train set 2.335x speedup, test set 2.099x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.909138| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.914258| train set 2.437x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.905348| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.903453| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.904447| train set 3.092x speedup, test set 1.249x speedup, val set 0.729x speedup, step: 12
early stopping at epoch 24
Training per epoch cost 1.065 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 5, train speedup 3.374, test speedup 1.143, val speedup 0.729
best test speedup epoch: 19, train speedup 2.335, test speedup 2.099, val speedup 0.729
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 24, train speedup 3.092, test speedup 1.249, val speedup 0.729
execution cost 0:01:15.569820
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
2.860536119643044
-0.059129222292990787
construct training samples cost 0:00:01.660686, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: -0.728278| train set 1.243x speedup, test set 0.969x speedup, val set 0.800x speedup, step: 1
Epoch 1/200 |loss: -0.750680| train set 1.869x speedup, test set 1.002x speedup, val set 1.000x speedup, step: 1
Epoch 2/200 |loss: -0.803145| train set 1.032x speedup, test set 0.985x speedup, val set 0.983x speedup, step: 2
Epoch 3/200 |loss: -0.798294| train set 1.023x speedup, test set 1.024x speedup, val set 0.729x speedup, step: 3
Epoch 4/200 |loss: -0.841509| train set 2.989x speedup, test set 1.402x speedup, val set 0.729x speedup, step: 4
Epoch 5/200 |loss: -0.855502| train set 3.374x speedup, test set 1.143x speedup, val set 0.729x speedup, step: 5
Epoch 6/200 |loss: -0.858035| train set 3.374x speedup, test set 1.127x speedup, val set 0.729x speedup, step: 6
Epoch 7/200 |loss: -0.863304| train set 3.170x speedup, test set 1.220x speedup, val set 0.729x speedup, step: 7
Epoch 8/200 |loss: -0.869009| train set 2.808x speedup, test set 1.268x speedup, val set 0.718x speedup, step: 8
Epoch 9/200 |loss: -0.876075| train set 2.808x speedup, test set 1.803x speedup, val set 0.729x speedup, step: 9
Epoch 10/200 |loss: -0.879239| train set 2.928x speedup, test set 1.868x speedup, val set 0.689x speedup, step: 10
Epoch 11/200 |loss: -0.885832| train set 2.928x speedup, test set 2.049x speedup, val set 0.752x speedup, step: 11
Epoch 12/200 |loss: -0.890451| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 13/200 |loss: -0.899811| train set 2.928x speedup, test set 2.049x speedup, val set 1.033x speedup, step: 1
Epoch 14/200 |loss: -0.895101| train set 2.928x speedup, test set 2.049x speedup, val set 0.775x speedup, step: 2
Epoch 15/200 |loss: -0.905461| train set 2.994x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 3
Epoch 16/200 |loss: -0.901455| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 4
Epoch 17/200 |loss: -0.903154| train set 2.287x speedup, test set 1.892x speedup, val set 0.965x speedup, step: 5
Epoch 18/200 |loss: -0.907711| train set 2.583x speedup, test set 1.892x speedup, val set 0.764x speedup, step: 6
Epoch 19/200 |loss: -0.899571| train set 2.287x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 7
Epoch 20/200 |loss: -0.911450| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 8
Epoch 21/200 |loss: -0.915492| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 9
Epoch 22/200 |loss: -0.906272| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 10
Epoch 23/200 |loss: -0.905467| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 11
Epoch 24/200 |loss: -0.905409| train set 2.885x speedup, test set 1.892x speedup, val set 0.729x speedup, step: 12
Epoch 25/200 |loss: -0.907648| train set 3.304x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 13
Epoch 26/200 |loss: -0.909079| train set 2.964x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 14
Epoch 27/200 |loss: -0.908915| train set 2.964x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 15
Epoch 28/200 |loss: -0.913723| train set 3.304x speedup, test set 1.907x speedup, val set 0.729x speedup, step: 16
Epoch 29/200 |loss: -0.914654| train set 3.304x speedup, test set 1.336x speedup, val set 0.729x speedup, step: 17
Epoch 30/200 |loss: -0.907940| train set 3.460x speedup, test set 1.475x speedup, val set 0.729x speedup, step: 18
early stopping at epoch 30
Training per epoch cost 1.023 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.198s, pg runtime 0.189s, speedup 0.958x
02, opt runtime 1.299s, model runtime 2.415s, pg runtime 5.855s, speedup 2.425x
03, opt runtime 0.399s, model runtime 0.449s, pg runtime 0.404s, speedup 0.900x
04, opt runtime 0.637s, model runtime 0.752s, pg runtime 0.637s, speedup 0.847x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.661s, model runtime 0.739s, pg runtime 0.661s, speedup 0.894x
07, opt runtime 1.437s, model runtime 1.860s, pg runtime 1.437s, speedup 0.772x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 4.223s, model runtime 4.223s, pg runtime 18.741s, speedup 4.438x
10, opt runtime 1.763s, model runtime 2.388s, pg runtime 1.763s, speedup 0.738x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 3.504s, pg runtime 6.143s, speedup 1.753x
13, opt runtime 2.593s, model runtime 2.593s, pg runtime 8.283s, speedup 3.195x
14, opt runtime 2.046s, model runtime 2.046s, pg runtime 5.879s, speedup 2.874x
15, opt runtime 1.737s, model runtime 1.737s, pg runtime 5.994s, speedup 3.452x
16, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
17, opt runtime 3.248s, model runtime 3.248s, pg runtime 10.538s, speedup 3.244x
18, opt runtime 0.612s, model runtime 1.438s, pg runtime 1.357s, speedup 0.944x
19, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
20, opt runtime 2.719s, model runtime 4.350s, pg runtime 3.112s, speedup 0.715x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.176s, pg runtime 0.158s, speedup 0.899x
23, opt runtime 0.129s, model runtime 0.131s, pg runtime 0.129s, speedup 0.990x
24, opt runtime 0.348s, model runtime 0.396s, pg runtime 0.391s, speedup 0.988x
25, opt runtime 2.755s, model runtime 3.377s, pg runtime 5.521s, speedup 1.635x
26, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
27, opt runtime 0.278s, model runtime 1.116s, pg runtime 0.948s, speedup 0.850x
====================
best train speedup epoch: 30, train speedup 3.460, test speedup 1.475, val speedup 0.729
best test speedup epoch: 11, train speedup 2.928, test speedup 2.049, val speedup 0.752
best validation speedup epoch: 13, train speedup 2.928, test speedup 2.049, val speedup 1.033
last model at epoch 30, train speedup 3.460, test speedup 1.475, val speedup 0.729
execution cost 0:01:28.590750
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.952225, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793528| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089632| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913027| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588155| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.558287| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.379457| train set 3.958x speedup, test set 1.040x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.760474| train set 4.032x speedup, test set 0.990x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.463382| train set 4.630x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.915882| train set 4.630x speedup, test set 0.870x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 13.910288| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.103303| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.441317| train set 4.630x speedup, test set 1.028x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.552013| train set 4.670x speedup, test set 0.865x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.226528| train set 4.958x speedup, test set 1.009x speedup, val set 0.733x speedup, step: 19
Epoch 19/200 |loss: 10.123577| train set 4.958x speedup, test set 0.990x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.347246| train set 4.958x speedup, test set 0.990x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.441335| train set 5.008x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 22
Epoch 22/200 |loss: 10.137733| train set 4.674x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.750445| train set 5.007x speedup, test set 1.028x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 12.131955| train set 4.948x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.648726| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.854962| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 12.361083| train set 4.631x speedup, test set 1.015x speedup, val set 0.733x speedup, step: 28
Epoch 28/200 |loss: 10.479069| train set 4.958x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 29
Epoch 29/200 |loss: 10.320414| train set 4.921x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.737298| train set 5.008x speedup, test set 0.940x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.153256| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.718854| train set 4.957x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 10.372845| train set 4.670x speedup, test set 1.008x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.147414| train set 4.894x speedup, test set 1.005x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 13.044520| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.444654| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.528407| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 38
Epoch 38/200 |loss: 9.756649| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.607849| train set 5.008x speedup, test set 0.991x speedup, val set 0.957x speedup, step: 40
Epoch 40/200 |loss: 9.144749| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.017241| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 42
Epoch 42/200 |loss: 10.165628| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 43
Epoch 43/200 |loss: 10.517020| train set 4.957x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.390493| train set 4.957x speedup, test set 1.000x speedup, val set 0.957x speedup, step: 45
Epoch 45/200 |loss: 9.060786| train set 4.577x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 10.486588| train set 4.412x speedup, test set 1.001x speedup, val set 0.729x speedup, step: 47
Epoch 47/200 |loss: 10.457324| train set 4.651x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.439609| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 9.967366| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 50
Epoch 50/200 |loss: 9.483925| train set 4.958x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 10.012154| train set 4.958x speedup, test set 0.983x speedup, val set 0.957x speedup, step: 52
Epoch 52/200 |loss: 10.823712| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 9.002179| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 9.209168| train set 4.715x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 55
Epoch 55/200 |loss: 9.807270| train set 4.671x speedup, test set 0.991x speedup, val set 0.965x speedup, step: 56
Epoch 56/200 |loss: 9.231901| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.230052| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.636750| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 59
Epoch 59/200 |loss: 8.606357| train set 5.007x speedup, test set 0.985x speedup, val set 0.729x speedup, step: 60
Epoch 60/200 |loss: 9.290308| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.215495| train set 4.958x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 62
Epoch 62/200 |loss: 8.095604| train set 4.873x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 63
Epoch 63/200 |loss: 8.853529| train set 4.873x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 64
Epoch 64/200 |loss: 8.239295| train set 5.007x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 65
Epoch 65/200 |loss: 8.971788| train set 5.007x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 66
Epoch 66/200 |loss: 9.888326| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 67
Epoch 67/200 |loss: 7.597021| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.234699| train set 5.008x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.119110| train set 5.008x speedup, test set 0.955x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.342889| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.289526| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 7.824516| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 73
Epoch 73/200 |loss: 8.941990| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 74
Epoch 74/200 |loss: 9.111350| train set 5.008x speedup, test set 0.996x speedup, val set 0.733x speedup, step: 75
Epoch 75/200 |loss: 8.777946| train set 4.957x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 76
Epoch 76/200 |loss: 7.274866| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.305305| train set 5.007x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 78
Epoch 78/200 |loss: 9.077806| train set 5.007x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 79
Epoch 79/200 |loss: 8.851501| train set 5.003x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 80
Epoch 80/200 |loss: 7.523264| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 81
Epoch 81/200 |loss: 10.230707| train set 5.008x speedup, test set 0.914x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 9.000326| train set 5.008x speedup, test set 0.949x speedup, val set 0.735x speedup, step: 83
Epoch 83/200 |loss: 8.514140| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 84
Epoch 84/200 |loss: 9.027069| train set 4.921x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.158339| train set 4.921x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.907263| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 87
Epoch 87/200 |loss: 9.498880| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.683507| train set 5.008x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 89
Epoch 89/200 |loss: 8.202826| train set 4.883x speedup, test set 0.978x speedup, val set 0.739x speedup, step: 90
Epoch 90/200 |loss: 8.825318| train set 5.008x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 91
Epoch 91/200 |loss: 8.485133| train set 5.008x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 92
Epoch 92/200 |loss: 8.371042| train set 5.008x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 93
Epoch 93/200 |loss: 9.196876| train set 5.008x speedup, test set 0.962x speedup, val set 0.729x speedup, step: 94
Epoch 94/200 |loss: 8.441485| train set 4.958x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 95
Epoch 95/200 |loss: 8.953762| train set 4.958x speedup, test set 0.966x speedup, val set 1.211x speedup, step: 96
Epoch 96/200 |loss: 9.047339| train set 4.958x speedup, test set 0.956x speedup, val set 0.742x speedup, step: 97
Epoch 97/200 |loss: 8.929636| train set 5.008x speedup, test set 0.962x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.560784| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 99
Epoch 99/200 |loss: 9.267047| train set 5.008x speedup, test set 0.962x speedup, val set 0.729x speedup, step: 100
Epoch 100/200 |loss: 9.146729| train set 5.008x speedup, test set 0.962x speedup, val set 0.742x speedup, step: 1
Epoch 101/200 |loss: 10.030327| train set 4.715x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 2
Epoch 102/200 |loss: 9.149345| train set 4.958x speedup, test set 0.971x speedup, val set 1.302x speedup, step: 1
Epoch 103/200 |loss: 9.870705| train set 4.917x speedup, test set 0.967x speedup, val set 0.770x speedup, step: 2
Epoch 104/200 |loss: 8.896319| train set 4.918x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 3
Epoch 105/200 |loss: 8.046685| train set 5.007x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 4
Epoch 106/200 |loss: 8.701166| train set 5.007x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 5
Epoch 107/200 |loss: 9.157123| train set 5.007x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 6
Epoch 108/200 |loss: 8.538070| train set 5.008x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 7
Epoch 109/200 |loss: 9.466145| train set 5.008x speedup, test set 0.978x speedup, val set 1.228x speedup, step: 8
Epoch 110/200 |loss: 7.821298| train set 4.631x speedup, test set 0.971x speedup, val set 1.176x speedup, step: 9
Epoch 111/200 |loss: 9.120568| train set 4.954x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 10
Epoch 112/200 |loss: 9.184738| train set 4.954x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 11
Epoch 113/200 |loss: 8.704294| train set 5.008x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 12
Epoch 114/200 |loss: 9.372793| train set 5.008x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 13
Epoch 115/200 |loss: 7.888437| train set 5.008x speedup, test set 0.978x speedup, val set 0.806x speedup, step: 14
Epoch 116/200 |loss: 8.036821| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 15
Epoch 117/200 |loss: 9.879297| train set 5.008x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 16
Epoch 118/200 |loss: 8.808375| train set 5.008x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 17
Epoch 119/200 |loss: 9.037807| train set 5.008x speedup, test set 0.990x speedup, val set 0.735x speedup, step: 18
Epoch 120/200 |loss: 9.552576| train set 4.921x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 19
Epoch 121/200 |loss: 8.786659| train set 4.921x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 20
Epoch 122/200 |loss: 8.677898| train set 4.958x speedup, test set 0.974x speedup, val set 1.144x speedup, step: 21
Epoch 123/200 |loss: 7.051935| train set 4.957x speedup, test set 0.990x speedup, val set 0.742x speedup, step: 22
Epoch 124/200 |loss: 9.134308| train set 4.920x speedup, test set 0.990x speedup, val set 0.770x speedup, step: 23
Epoch 125/200 |loss: 9.418275| train set 4.920x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 24
Epoch 126/200 |loss: 9.960264| train set 5.007x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 25
Epoch 127/200 |loss: 8.408251| train set 5.007x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 26
Epoch 128/200 |loss: 8.967395| train set 5.007x speedup, test set 0.999x speedup, val set 0.762x speedup, step: 27
Epoch 129/200 |loss: 8.320472| train set 5.008x speedup, test set 0.991x speedup, val set 0.762x speedup, step: 28
Epoch 130/200 |loss: 9.029305| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 29
Epoch 131/200 |loss: 8.706443| train set 4.958x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 30
Epoch 132/200 |loss: 9.217585| train set 4.956x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 31
Epoch 133/200 |loss: 7.372808| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 32
Epoch 134/200 |loss: 6.999237| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 33
Epoch 135/200 |loss: 8.571604| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 34
Epoch 136/200 |loss: 7.693741| train set 5.008x speedup, test set 0.988x speedup, val set 0.770x speedup, step: 35
Epoch 137/200 |loss: 8.536003| train set 5.008x speedup, test set 0.990x speedup, val set 0.742x speedup, step: 36
Epoch 138/200 |loss: 9.423202| train set 5.008x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 37
Epoch 139/200 |loss: 8.827682| train set 4.671x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 38
Epoch 140/200 |loss: 7.868714| train set 4.958x speedup, test set 0.982x speedup, val set 1.133x speedup, step: 39
Epoch 141/200 |loss: 8.371378| train set 4.958x speedup, test set 0.982x speedup, val set 1.165x speedup, step: 40
Epoch 142/200 |loss: 8.754888| train set 4.918x speedup, test set 0.983x speedup, val set 0.786x speedup, step: 41
Epoch 143/200 |loss: 9.335514| train set 4.988x speedup, test set 0.983x speedup, val set 0.742x speedup, step: 42
Epoch 144/200 |loss: 8.804667| train set 4.957x speedup, test set 0.982x speedup, val set 1.133x speedup, step: 43
Epoch 145/200 |loss: 9.463054| train set 4.957x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 44
Epoch 146/200 |loss: 8.954708| train set 4.920x speedup, test set 0.967x speedup, val set 0.786x speedup, step: 45
Epoch 147/200 |loss: 9.558670| train set 4.920x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 46
Epoch 148/200 |loss: 8.341196| train set 5.007x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 47
Epoch 149/200 |loss: 8.708765| train set 5.007x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 48
Epoch 150/200 |loss: 9.543033| train set 5.007x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 49
Epoch 151/200 |loss: 8.939651| train set 4.920x speedup, test set 0.977x speedup, val set 0.786x speedup, step: 50
Epoch 152/200 |loss: 7.886040| train set 4.920x speedup, test set 0.981x speedup, val set 0.742x speedup, step: 51
Epoch 153/200 |loss: 9.866812| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 52
Epoch 154/200 |loss: 8.964356| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 53
Epoch 155/200 |loss: 9.425420| train set 5.008x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 54
Epoch 156/200 |loss: 8.700280| train set 5.008x speedup, test set 0.965x speedup, val set 0.735x speedup, step: 55
Epoch 157/200 |loss: 9.328829| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 56
Epoch 158/200 |loss: 10.726490| train set 4.921x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 57
Epoch 159/200 |loss: 7.933682| train set 4.921x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 58
Epoch 160/200 |loss: 7.821031| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 59
Epoch 161/200 |loss: 9.325704| train set 5.008x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 60
Epoch 162/200 |loss: 8.151370| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 61
Epoch 163/200 |loss: 7.681178| train set 5.008x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 62
Epoch 164/200 |loss: 8.951212| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 63
Epoch 165/200 |loss: 8.073618| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 64
Epoch 166/200 |loss: 9.077298| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 65
Epoch 167/200 |loss: 9.644052| train set 4.920x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 66
Epoch 168/200 |loss: 8.772202| train set 4.957x speedup, test set 0.962x speedup, val set 1.133x speedup, step: 67
Epoch 169/200 |loss: 8.395976| train set 4.958x speedup, test set 0.959x speedup, val set 1.302x speedup, step: 1
Epoch 170/200 |loss: 8.565670| train set 4.873x speedup, test set 0.959x speedup, val set 0.944x speedup, step: 2
Epoch 171/200 |loss: 9.331928| train set 4.873x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 3
Epoch 172/200 |loss: 9.608014| train set 4.873x speedup, test set 0.962x speedup, val set 0.729x speedup, step: 4
Epoch 173/200 |loss: 8.126899| train set 4.957x speedup, test set 0.962x speedup, val set 0.729x speedup, step: 5
Epoch 174/200 |loss: 8.646417| train set 4.920x speedup, test set 0.962x speedup, val set 0.742x speedup, step: 6
Epoch 175/200 |loss: 9.665028| train set 4.920x speedup, test set 1.007x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 9.257536| train set 5.007x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 177/200 |loss: 8.314582| train set 4.957x speedup, test set 0.963x speedup, val set 0.806x speedup, step: 9
Epoch 178/200 |loss: 9.203138| train set 4.958x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 10
Epoch 179/200 |loss: 8.455956| train set 4.954x speedup, test set 0.966x speedup, val set 0.770x speedup, step: 11
Epoch 180/200 |loss: 9.273879| train set 4.958x speedup, test set 1.012x speedup, val set 0.742x speedup, step: 12
Epoch 181/200 |loss: 8.665410| train set 4.958x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 13
Epoch 182/200 |loss: 9.290955| train set 4.958x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 14
Epoch 183/200 |loss: 8.369260| train set 5.008x speedup, test set 0.983x speedup, val set 0.735x speedup, step: 15
Epoch 184/200 |loss: 7.317160| train set 5.008x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 16
Epoch 185/200 |loss: 8.467669| train set 5.007x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 17
Epoch 186/200 |loss: 8.913739| train set 5.007x speedup, test set 0.962x speedup, val set 0.742x speedup, step: 18
Epoch 187/200 |loss: 8.411307| train set 5.007x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 19
Epoch 188/200 |loss: 8.278126| train set 5.007x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 20
Epoch 189/200 |loss: 8.647986| train set 5.007x speedup, test set 0.961x speedup, val set 0.742x speedup, step: 21
Epoch 190/200 |loss: 8.688818| train set 5.008x speedup, test set 0.961x speedup, val set 0.735x speedup, step: 22
Epoch 191/200 |loss: 7.798208| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 23
Epoch 192/200 |loss: 9.736100| train set 4.921x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 24
Epoch 193/200 |loss: 9.174473| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 25
Epoch 194/200 |loss: 9.633181| train set 4.921x speedup, test set 0.962x speedup, val set 0.742x speedup, step: 26
Epoch 195/200 |loss: 7.581022| train set 5.008x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 27
Epoch 196/200 |loss: 8.644273| train set 4.958x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 28
Epoch 197/200 |loss: 8.890732| train set 4.954x speedup, test set 0.965x speedup, val set 0.786x speedup, step: 29
Epoch 198/200 |loss: 9.356823| train set 4.954x speedup, test set 0.965x speedup, val set 0.804x speedup, step: 30
Epoch 199/200 |loss: 7.589431| train set 5.004x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 31
Training per epoch cost 0.372 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 1.007, val speedup 0.733
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 169, train speedup 4.958, test speedup 0.959, val speedup 1.302
last model at epoch 199, train speedup 5.004, test speedup 0.967, val speedup 0.742
execution cost 0:03:02.154527
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.964415, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286845| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936657| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179352| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793522| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089554| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913385| train set 3.160x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.594266| train set 3.349x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 9
Epoch 9/200 |loss: 16.569079| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.372631| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.791769| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.438400| train set 4.202x speedup, test set 0.976x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.988717| train set 4.630x speedup, test set 0.870x speedup, val set 0.733x speedup, step: 14
Epoch 14/200 |loss: 13.838069| train set 4.630x speedup, test set 0.870x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 12.999798| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.398811| train set 4.630x speedup, test set 0.865x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.424181| train set 4.958x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.216811| train set 4.958x speedup, test set 1.000x speedup, val set 1.041x speedup, step: 19
Epoch 19/200 |loss: 10.010424| train set 4.958x speedup, test set 0.990x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.423721| train set 4.631x speedup, test set 0.996x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.581069| train set 5.008x speedup, test set 0.980x speedup, val set 0.733x speedup, step: 22
Epoch 22/200 |loss: 10.152213| train set 5.008x speedup, test set 0.960x speedup, val set 0.733x speedup, step: 23
Epoch 23/200 |loss: 10.855151| train set 5.007x speedup, test set 0.934x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.771000| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 25
Epoch 25/200 |loss: 11.697398| train set 4.958x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 26
Epoch 26/200 |loss: 10.322979| train set 4.958x speedup, test set 1.002x speedup, val set 0.965x speedup, step: 27
Epoch 27/200 |loss: 12.041523| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 28
Epoch 28/200 |loss: 10.204513| train set 4.958x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 10.014406| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.329494| train set 4.865x speedup, test set 1.016x speedup, val set 0.965x speedup, step: 31
Epoch 31/200 |loss: 10.737401| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.372189| train set 4.708x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 10.098572| train set 4.448x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.312885| train set 5.007x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 12.116791| train set 5.007x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 11.425063| train set 5.008x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 37
Epoch 37/200 |loss: 9.763041| train set 4.715x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 38
Epoch 38/200 |loss: 9.474572| train set 5.008x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 9.946039| train set 4.958x speedup, test set 1.008x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.072776| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 9.964525| train set 4.921x speedup, test set 1.003x speedup, val set 0.957x speedup, step: 42
Epoch 42/200 |loss: 10.027038| train set 4.873x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.051069| train set 4.631x speedup, test set 1.008x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 10.629899| train set 5.008x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 45
Epoch 45/200 |loss: 9.281110| train set 4.754x speedup, test set 1.008x speedup, val set 1.033x speedup, step: 46
Epoch 46/200 |loss: 9.446201| train set 4.754x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 47
Epoch 47/200 |loss: 9.629264| train set 4.452x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.094582| train set 4.754x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 9.578887| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 50
Epoch 50/200 |loss: 9.228568| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 9.536200| train set 4.921x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.262289| train set 4.883x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 53
Epoch 53/200 |loss: 8.702187| train set 5.008x speedup, test set 1.007x speedup, val set 1.033x speedup, step: 54
Epoch 54/200 |loss: 8.970855| train set 5.008x speedup, test set 1.007x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.546170| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 9.138513| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 57
Epoch 57/200 |loss: 10.322992| train set 5.008x speedup, test set 1.003x speedup, val set 1.133x speedup, step: 58
Epoch 58/200 |loss: 9.221108| train set 4.883x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.282579| train set 4.990x speedup, test set 0.994x speedup, val set 0.957x speedup, step: 60
Epoch 60/200 |loss: 9.425109| train set 4.957x speedup, test set 0.994x speedup, val set 1.033x speedup, step: 61
Epoch 61/200 |loss: 10.398354| train set 4.958x speedup, test set 0.999x speedup, val set 0.957x speedup, step: 62
Epoch 62/200 |loss: 7.903188| train set 4.871x speedup, test set 0.988x speedup, val set 0.758x speedup, step: 63
Epoch 63/200 |loss: 8.939763| train set 4.556x speedup, test set 0.998x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.263268| train set 4.920x speedup, test set 1.006x speedup, val set 1.033x speedup, step: 65
Epoch 65/200 |loss: 9.068144| train set 5.007x speedup, test set 0.990x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 10.246898| train set 5.008x speedup, test set 0.976x speedup, val set 1.033x speedup, step: 67
Epoch 67/200 |loss: 7.671297| train set 5.005x speedup, test set 0.965x speedup, val set 0.980x speedup, step: 68
Epoch 68/200 |loss: 9.539027| train set 5.008x speedup, test set 0.956x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.608389| train set 5.008x speedup, test set 0.956x speedup, val set 1.302x speedup, step: 70
Epoch 70/200 |loss: 9.025297| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 71
Epoch 71/200 |loss: 10.013141| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 72
Epoch 72/200 |loss: 8.164628| train set 5.008x speedup, test set 0.991x speedup, val set 1.222x speedup, step: 73
Epoch 73/200 |loss: 9.559916| train set 5.007x speedup, test set 0.991x speedup, val set 1.314x speedup, step: 74
Epoch 74/200 |loss: 9.414946| train set 4.958x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 9.053019| train set 5.008x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.219928| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.665773| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 78
Epoch 78/200 |loss: 9.115885| train set 4.883x speedup, test set 0.987x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.926264| train set 4.921x speedup, test set 0.985x speedup, val set 0.864x speedup, step: 80
Epoch 80/200 |loss: 7.803099| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 9.922738| train set 5.008x speedup, test set 0.984x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 9.079507| train set 5.008x speedup, test set 0.984x speedup, val set 0.742x speedup, step: 83
Epoch 83/200 |loss: 8.527591| train set 5.008x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 84
Epoch 84/200 |loss: 8.785091| train set 5.008x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.054433| train set 4.674x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.929050| train set 4.674x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 87
Epoch 87/200 |loss: 9.590760| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.980502| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 89
Epoch 89/200 |loss: 8.219372| train set 5.008x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 90
Epoch 90/200 |loss: 8.844646| train set 5.008x speedup, test set 1.000x speedup, val set 0.729x speedup, step: 91
Epoch 91/200 |loss: 8.625026| train set 5.008x speedup, test set 1.000x speedup, val set 0.729x speedup, step: 92
Epoch 92/200 |loss: 8.333857| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 93
Epoch 93/200 |loss: 9.376296| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 94
Epoch 94/200 |loss: 8.501229| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 95
Epoch 95/200 |loss: 9.026764| train set 4.958x speedup, test set 0.991x speedup, val set 0.762x speedup, step: 96
Epoch 96/200 |loss: 9.367625| train set 4.958x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 97
Epoch 97/200 |loss: 8.852735| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.805130| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 99
Epoch 99/200 |loss: 9.523486| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 100
Epoch 100/200 |loss: 9.079122| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 1
Epoch 101/200 |loss: 9.826945| train set 4.715x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 2
Epoch 102/200 |loss: 8.742332| train set 4.958x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 1
Epoch 103/200 |loss: 9.242469| train set 4.921x speedup, test set 0.987x speedup, val set 0.786x speedup, step: 1
Epoch 104/200 |loss: 8.335022| train set 4.920x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 2
Epoch 105/200 |loss: 7.397962| train set 5.007x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 3
Epoch 106/200 |loss: 8.047288| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 4
Epoch 107/200 |loss: 8.668159| train set 5.007x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 5
Epoch 108/200 |loss: 7.910244| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 6
Epoch 109/200 |loss: 9.274033| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 7
Epoch 110/200 |loss: 7.339956| train set 5.004x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 8
Epoch 111/200 |loss: 9.126458| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 9
Epoch 112/200 |loss: 9.866683| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 10
Epoch 113/200 |loss: 8.822638| train set 5.000x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 11
Epoch 114/200 |loss: 9.765964| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 12
Epoch 115/200 |loss: 8.120353| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 13
Epoch 116/200 |loss: 8.302316| train set 5.008x speedup, test set 0.971x speedup, val set 0.729x speedup, step: 14
Epoch 117/200 |loss: 9.741935| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 15
Epoch 118/200 |loss: 9.113350| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 16
Epoch 119/200 |loss: 8.704456| train set 5.008x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 17
Epoch 120/200 |loss: 9.873515| train set 5.008x speedup, test set 0.977x speedup, val set 0.735x speedup, step: 18
Epoch 121/200 |loss: 8.640759| train set 4.921x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 19
Epoch 122/200 |loss: 8.525434| train set 4.958x speedup, test set 0.978x speedup, val set 0.934x speedup, step: 1
Epoch 123/200 |loss: 6.959452| train set 4.873x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 2
Epoch 124/200 |loss: 9.125631| train set 4.920x speedup, test set 0.981x speedup, val set 0.742x speedup, step: 3
Epoch 125/200 |loss: 9.340011| train set 5.007x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 4
Epoch 126/200 |loss: 10.377845| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 5
Epoch 127/200 |loss: 9.421536| train set 4.920x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 6
Epoch 128/200 |loss: 9.735125| train set 5.007x speedup, test set 0.979x speedup, val set 0.735x speedup, step: 7
Epoch 129/200 |loss: 8.557655| train set 5.008x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 8
Epoch 130/200 |loss: 9.572189| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 9
Epoch 131/200 |loss: 9.148694| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 10
Epoch 132/200 |loss: 9.382914| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 11
Epoch 133/200 |loss: 7.965034| train set 4.958x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 12
Epoch 134/200 |loss: 6.882972| train set 4.958x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 13
Epoch 135/200 |loss: 8.621735| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 14
Epoch 136/200 |loss: 7.665452| train set 5.004x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 15
Epoch 137/200 |loss: 8.558431| train set 5.008x speedup, test set 0.985x speedup, val set 0.742x speedup, step: 16
Epoch 138/200 |loss: 9.500365| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 17
Epoch 139/200 |loss: 8.977932| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 18
Epoch 140/200 |loss: 7.965043| train set 5.008x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 19
Epoch 141/200 |loss: 8.362339| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 20
Epoch 142/200 |loss: 8.829638| train set 4.921x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 21
Epoch 143/200 |loss: 9.209611| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 22
Epoch 144/200 |loss: 8.702033| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.687166| train set 4.958x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 2
Epoch 146/200 |loss: 9.349710| train set 4.873x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 3
Epoch 147/200 |loss: 9.923217| train set 4.957x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4
Epoch 148/200 |loss: 8.482254| train set 5.007x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 9.152759| train set 5.007x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 1
Epoch 150/200 |loss: 9.769000| train set 5.007x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 2
Epoch 151/200 |loss: 9.002477| train set 4.920x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 3
Epoch 152/200 |loss: 7.831548| train set 4.921x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 4
Epoch 153/200 |loss: 10.066548| train set 5.008x speedup, test set 0.999x speedup, val set 1.133x speedup, step: 5
Epoch 154/200 |loss: 9.222219| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 6
Epoch 155/200 |loss: 9.410521| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 7
Epoch 156/200 |loss: 9.172612| train set 5.008x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 8
Epoch 157/200 |loss: 9.363466| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 9
Epoch 158/200 |loss: 10.418430| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 10
Epoch 159/200 |loss: 7.620553| train set 5.008x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 11
Epoch 160/200 |loss: 7.912530| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 12
Epoch 161/200 |loss: 9.437710| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 13
Epoch 162/200 |loss: 8.043827| train set 5.008x speedup, test set 0.985x speedup, val set 0.786x speedup, step: 14
Epoch 163/200 |loss: 7.628939| train set 5.008x speedup, test set 0.985x speedup, val set 0.742x speedup, step: 15
Epoch 164/200 |loss: 8.801709| train set 5.008x speedup, test set 0.985x speedup, val set 0.735x speedup, step: 16
Epoch 165/200 |loss: 8.113775| train set 5.008x speedup, test set 0.985x speedup, val set 0.735x speedup, step: 17
Epoch 166/200 |loss: 8.985701| train set 5.008x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 18
Epoch 167/200 |loss: 9.390084| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 19
Epoch 168/200 |loss: 8.871125| train set 4.958x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 20
Epoch 169/200 |loss: 8.329368| train set 4.958x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 21
Epoch 170/200 |loss: 8.625487| train set 4.873x speedup, test set 0.975x speedup, val set 0.735x speedup, step: 22
Epoch 171/200 |loss: 9.343577| train set 4.873x speedup, test set 0.959x speedup, val set 0.735x speedup, step: 23
Epoch 172/200 |loss: 9.640140| train set 4.873x speedup, test set 0.959x speedup, val set 0.729x speedup, step: 24
Epoch 173/200 |loss: 8.092247| train set 4.957x speedup, test set 0.975x speedup, val set 0.769x speedup, step: 25
Epoch 174/200 |loss: 8.564347| train set 5.007x speedup, test set 0.975x speedup, val set 0.762x speedup, step: 26
Epoch 175/200 |loss: 9.848636| train set 4.920x speedup, test set 0.975x speedup, val set 0.804x speedup, step: 27
Epoch 176/200 |loss: 8.936886| train set 5.007x speedup, test set 0.979x speedup, val set 0.762x speedup, step: 28
Epoch 177/200 |loss: 8.324672| train set 5.007x speedup, test set 0.991x speedup, val set 1.149x speedup, step: 29
Epoch 178/200 |loss: 9.127595| train set 4.957x speedup, test set 0.985x speedup, val set 0.735x speedup, step: 30
Epoch 179/200 |loss: 8.398798| train set 4.958x speedup, test set 0.985x speedup, val set 0.742x speedup, step: 31
Epoch 180/200 |loss: 9.027816| train set 4.958x speedup, test set 0.985x speedup, val set 0.742x speedup, step: 32
Epoch 181/200 |loss: 8.503752| train set 4.958x speedup, test set 0.985x speedup, val set 0.742x speedup, step: 33
Epoch 182/200 |loss: 9.238024| train set 4.873x speedup, test set 0.985x speedup, val set 0.742x speedup, step: 34
Epoch 183/200 |loss: 8.357844| train set 4.958x speedup, test set 0.985x speedup, val set 0.735x speedup, step: 35
Epoch 184/200 |loss: 7.309118| train set 5.008x speedup, test set 0.985x speedup, val set 0.892x speedup, step: 36
Epoch 185/200 |loss: 8.519181| train set 5.002x speedup, test set 0.985x speedup, val set 0.742x speedup, step: 37
Epoch 186/200 |loss: 8.742233| train set 5.008x speedup, test set 0.985x speedup, val set 0.769x speedup, step: 38
Epoch 187/200 |loss: 8.230343| train set 5.007x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 1
Epoch 188/200 |loss: 8.312845| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 2
Epoch 189/200 |loss: 8.668176| train set 5.008x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 3
Epoch 190/200 |loss: 8.632342| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 4
Epoch 191/200 |loss: 7.924400| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 5
Epoch 192/200 |loss: 9.903748| train set 4.921x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 6
Epoch 193/200 |loss: 9.170625| train set 4.921x speedup, test set 0.986x speedup, val set 0.742x speedup, step: 7
Epoch 194/200 |loss: 9.577240| train set 4.921x speedup, test set 0.986x speedup, val set 1.165x speedup, step: 8
Epoch 195/200 |loss: 7.618726| train set 4.958x speedup, test set 0.982x speedup, val set 1.228x speedup, step: 9
Epoch 196/200 |loss: 8.509588| train set 4.958x speedup, test set 0.986x speedup, val set 1.165x speedup, step: 10
Epoch 197/200 |loss: 8.862845| train set 4.958x speedup, test set 0.977x speedup, val set 0.795x speedup, step: 11
Epoch 198/200 |loss: 9.327938| train set 4.955x speedup, test set 0.974x speedup, val set 0.804x speedup, step: 12
Epoch 199/200 |loss: 7.643661| train set 4.958x speedup, test set 0.973x speedup, val set 0.804x speedup, step: 13
Training per epoch cost 0.375 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
15, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 0.980, val speedup 0.733
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 187, train speedup 5.007, test speedup 0.987, val speedup 1.302
last model at epoch 199, train speedup 4.958, test speedup 0.973, val speedup 0.804
execution cost 0:03:01.347368
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.948999, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281971| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793524| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912635| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587205| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575418| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370788| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755566| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455400| train set 4.285x speedup, test set 0.975x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921765| train set 4.630x speedup, test set 0.870x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914977| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.109000| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590155| train set 4.630x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591467| train set 4.670x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213897| train set 5.008x speedup, test set 1.001x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153138| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.501633| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.035406| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.297973| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.687851| train set 5.007x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.883906| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.646016| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.531391| train set 4.958x speedup, test set 1.026x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.331560| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.345002| train set 4.991x speedup, test set 0.992x speedup, val set 0.733x speedup, step: 29
Epoch 29/200 |loss: 10.291331| train set 4.921x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.726775| train set 5.008x speedup, test set 0.891x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.462272| train set 4.958x speedup, test set 1.039x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.668274| train set 4.708x speedup, test set 0.995x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 10.937076| train set 4.630x speedup, test set 0.995x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.307288| train set 4.670x speedup, test set 0.941x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 13.279865| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.939661| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.833652| train set 5.008x speedup, test set 1.019x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 10.604883| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 11.130417| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.767653| train set 4.958x speedup, test set 1.016x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.163247| train set 4.812x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.540840| train set 4.921x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.189477| train set 4.631x speedup, test set 1.007x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.070769| train set 4.958x speedup, test set 1.000x speedup, val set 1.041x speedup, step: 45
Epoch 45/200 |loss: 9.111845| train set 4.649x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 46
Epoch 46/200 |loss: 10.216187| train set 4.754x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 9.802178| train set 4.452x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.387225| train set 4.674x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 9.702777| train set 5.007x speedup, test set 0.998x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.326665| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 9.675611| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.339999| train set 4.921x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 53
Epoch 53/200 |loss: 8.891716| train set 5.008x speedup, test set 0.998x speedup, val set 1.033x speedup, step: 54
Epoch 54/200 |loss: 8.802047| train set 4.715x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 55
Epoch 55/200 |loss: 9.575788| train set 4.957x speedup, test set 0.987x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 8.843989| train set 5.007x speedup, test set 0.998x speedup, val set 1.033x speedup, step: 57
Epoch 57/200 |loss: 10.077484| train set 5.008x speedup, test set 0.994x speedup, val set 1.268x speedup, step: 58
Epoch 58/200 |loss: 9.341498| train set 5.007x speedup, test set 0.978x speedup, val set 1.241x speedup, step: 59
Epoch 59/200 |loss: 8.460102| train set 5.007x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 60
Epoch 60/200 |loss: 9.262487| train set 4.958x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 61
Epoch 61/200 |loss: 9.968317| train set 4.958x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 7.976638| train set 4.873x speedup, test set 0.982x speedup, val set 1.006x speedup, step: 63
Epoch 63/200 |loss: 8.678497| train set 4.873x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.243858| train set 5.007x speedup, test set 1.000x speedup, val set 1.033x speedup, step: 65
Epoch 65/200 |loss: 8.947013| train set 5.008x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.906933| train set 5.008x speedup, test set 0.991x speedup, val set 1.006x speedup, step: 67
Epoch 67/200 |loss: 7.589899| train set 5.008x speedup, test set 0.982x speedup, val set 0.980x speedup, step: 68
Epoch 68/200 |loss: 9.051713| train set 5.008x speedup, test set 0.966x speedup, val set 0.994x speedup, step: 69
Epoch 69/200 |loss: 9.044593| train set 5.008x speedup, test set 0.966x speedup, val set 1.133x speedup, step: 70
Epoch 70/200 |loss: 8.395623| train set 5.008x speedup, test set 0.982x speedup, val set 1.032x speedup, step: 71
Epoch 71/200 |loss: 9.375252| train set 5.007x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 72
Epoch 72/200 |loss: 7.929170| train set 5.007x speedup, test set 0.982x speedup, val set 1.241x speedup, step: 73
Epoch 73/200 |loss: 9.094832| train set 5.007x speedup, test set 0.982x speedup, val set 1.316x speedup, step: 74
Epoch 74/200 |loss: 9.261264| train set 4.958x speedup, test set 0.982x speedup, val set 1.316x speedup, step: 75
Epoch 75/200 |loss: 8.766941| train set 4.958x speedup, test set 0.982x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.092775| train set 4.917x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 77
Epoch 77/200 |loss: 8.381204| train set 5.008x speedup, test set 0.978x speedup, val set 1.041x speedup, step: 78
Epoch 78/200 |loss: 9.127716| train set 5.007x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.892121| train set 5.004x speedup, test set 0.982x speedup, val set 0.980x speedup, step: 80
Epoch 80/200 |loss: 7.605268| train set 5.008x speedup, test set 0.994x speedup, val set 1.053x speedup, step: 81
Epoch 81/200 |loss: 10.240650| train set 5.008x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 8.921158| train set 5.008x speedup, test set 0.982x speedup, val set 0.804x speedup, step: 83
Epoch 83/200 |loss: 8.230966| train set 5.008x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 8.731735| train set 5.008x speedup, test set 0.982x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.037470| train set 4.921x speedup, test set 0.966x speedup, val set 0.980x speedup, step: 86
Epoch 86/200 |loss: 9.006749| train set 5.008x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 87
Epoch 87/200 |loss: 9.331007| train set 5.008x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 7.828886| train set 5.008x speedup, test set 0.966x speedup, val set 1.165x speedup, step: 89
Epoch 89/200 |loss: 8.244426| train set 4.883x speedup, test set 0.966x speedup, val set 0.841x speedup, step: 90
Epoch 90/200 |loss: 8.893480| train set 5.008x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.692254| train set 5.008x speedup, test set 0.994x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.311585| train set 5.008x speedup, test set 0.994x speedup, val set 1.268x speedup, step: 93
Epoch 93/200 |loss: 9.417082| train set 5.008x speedup, test set 0.994x speedup, val set 1.006x speedup, step: 94
Epoch 94/200 |loss: 8.492294| train set 4.958x speedup, test set 0.974x speedup, val set 1.053x speedup, step: 95
Epoch 95/200 |loss: 8.918201| train set 4.957x speedup, test set 0.974x speedup, val set 1.316x speedup, step: 96
Epoch 96/200 |loss: 9.454729| train set 4.958x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 97
Epoch 97/200 |loss: 8.996835| train set 4.958x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 98
Epoch 98/200 |loss: 8.726866| train set 5.008x speedup, test set 0.974x speedup, val set 1.041x speedup, step: 99
Epoch 99/200 |loss: 9.335846| train set 5.008x speedup, test set 0.971x speedup, val set 0.980x speedup, step: 100
Epoch 100/200 |loss: 9.175986| train set 5.008x speedup, test set 0.971x speedup, val set 0.980x speedup, step: 1
Epoch 101/200 |loss: 10.110478| train set 4.715x speedup, test set 1.009x speedup, val set 1.041x speedup, step: 1
Epoch 102/200 |loss: 8.825674| train set 4.958x speedup, test set 0.996x speedup, val set 1.302x speedup, step: 1
Epoch 103/200 |loss: 9.485185| train set 4.917x speedup, test set 0.996x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.697091| train set 4.916x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 3
Epoch 105/200 |loss: 7.721395| train set 5.007x speedup, test set 0.986x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.247448| train set 5.007x speedup, test set 1.009x speedup, val set 1.302x speedup, step: 1
Epoch 107/200 |loss: 8.932107| train set 4.753x speedup, test set 1.001x speedup, val set 0.873x speedup, step: 2
Epoch 108/200 |loss: 8.157699| train set 4.754x speedup, test set 0.999x speedup, val set 0.980x speedup, step: 3
Epoch 109/200 |loss: 9.190462| train set 5.008x speedup, test set 1.009x speedup, val set 1.150x speedup, step: 4
Epoch 110/200 |loss: 7.461746| train set 5.004x speedup, test set 0.996x speedup, val set 0.980x speedup, step: 5
Epoch 111/200 |loss: 8.868479| train set 4.958x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 6
Epoch 112/200 |loss: 9.815185| train set 4.958x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 7
Epoch 113/200 |loss: 8.829364| train set 5.008x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 8
Epoch 114/200 |loss: 9.409254| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 9
Epoch 115/200 |loss: 8.096160| train set 5.008x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 10
Epoch 116/200 |loss: 8.157928| train set 5.008x speedup, test set 0.967x speedup, val set 1.302x speedup, step: 1
Epoch 117/200 |loss: 9.747339| train set 5.008x speedup, test set 0.974x speedup, val set 0.934x speedup, step: 2
Epoch 118/200 |loss: 8.889987| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 3
Epoch 119/200 |loss: 8.900133| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 4
Epoch 120/200 |loss: 9.710928| train set 5.008x speedup, test set 0.974x speedup, val set 0.813x speedup, step: 5
Epoch 121/200 |loss: 8.421088| train set 4.921x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 6
Epoch 122/200 |loss: 8.406541| train set 4.958x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 7
Epoch 123/200 |loss: 6.891156| train set 4.958x speedup, test set 0.974x speedup, val set 0.980x speedup, step: 8
Epoch 124/200 |loss: 9.017726| train set 4.917x speedup, test set 0.974x speedup, val set 0.786x speedup, step: 9
Epoch 125/200 |loss: 9.294970| train set 4.920x speedup, test set 0.974x speedup, val set 1.006x speedup, step: 10
Epoch 126/200 |loss: 10.107005| train set 5.007x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 127/200 |loss: 8.696619| train set 5.007x speedup, test set 0.991x speedup, val set 0.806x speedup, step: 2
Epoch 128/200 |loss: 9.528673| train set 5.008x speedup, test set 0.991x speedup, val set 0.804x speedup, step: 3
Epoch 129/200 |loss: 8.475711| train set 5.008x speedup, test set 0.991x speedup, val set 0.762x speedup, step: 4
Epoch 130/200 |loss: 9.287552| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 5
Epoch 131/200 |loss: 9.018902| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 6
Epoch 132/200 |loss: 9.176396| train set 4.954x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 7
Epoch 133/200 |loss: 7.876181| train set 4.709x speedup, test set 1.009x speedup, val set 0.868x speedup, step: 8
Epoch 134/200 |loss: 6.856654| train set 4.709x speedup, test set 1.009x speedup, val set 1.033x speedup, step: 9
Epoch 135/200 |loss: 8.699100| train set 4.958x speedup, test set 1.000x speedup, val set 1.006x speedup, step: 10
Epoch 136/200 |loss: 7.604660| train set 5.008x speedup, test set 1.000x speedup, val set 0.804x speedup, step: 11
Epoch 137/200 |loss: 8.791356| train set 5.008x speedup, test set 1.000x speedup, val set 0.980x speedup, step: 12
Epoch 138/200 |loss: 9.421128| train set 5.008x speedup, test set 1.000x speedup, val set 0.980x speedup, step: 13
Epoch 139/200 |loss: 9.203712| train set 4.715x speedup, test set 1.000x speedup, val set 1.165x speedup, step: 14
Epoch 140/200 |loss: 8.095519| train set 4.958x speedup, test set 0.996x speedup, val set 1.228x speedup, step: 15
Epoch 141/200 |loss: 8.379991| train set 4.958x speedup, test set 0.996x speedup, val set 1.165x speedup, step: 16
Epoch 142/200 |loss: 8.568227| train set 5.008x speedup, test set 1.001x speedup, val set 0.868x speedup, step: 17
Epoch 143/200 |loss: 8.912091| train set 5.008x speedup, test set 0.996x speedup, val set 1.165x speedup, step: 18
Epoch 144/200 |loss: 8.532237| train set 4.957x speedup, test set 0.996x speedup, val set 1.228x speedup, step: 19
Epoch 145/200 |loss: 9.011775| train set 4.920x speedup, test set 0.975x speedup, val set 1.165x speedup, step: 20
Epoch 146/200 |loss: 9.281282| train set 4.920x speedup, test set 0.986x speedup, val set 1.165x speedup, step: 21
Epoch 147/200 |loss: 9.305052| train set 4.957x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 148/200 |loss: 8.147883| train set 5.007x speedup, test set 1.013x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 8.702082| train set 5.007x speedup, test set 0.999x speedup, val set 1.228x speedup, step: 2
Epoch 150/200 |loss: 9.416606| train set 5.007x speedup, test set 0.999x speedup, val set 0.980x speedup, step: 3
Epoch 151/200 |loss: 8.718846| train set 5.007x speedup, test set 0.982x speedup, val set 0.786x speedup, step: 4
Epoch 152/200 |loss: 7.731832| train set 4.920x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 5
Epoch 153/200 |loss: 9.726800| train set 4.921x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 6
Epoch 154/200 |loss: 9.086222| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 7
Epoch 155/200 |loss: 9.269016| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 156/200 |loss: 8.802993| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 9
Epoch 157/200 |loss: 9.332575| train set 4.958x speedup, test set 0.974x speedup, val set 1.211x speedup, step: 10
Epoch 158/200 |loss: 10.509669| train set 4.921x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 11
Epoch 159/200 |loss: 7.852975| train set 5.008x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 12
Epoch 160/200 |loss: 7.728773| train set 5.008x speedup, test set 0.999x speedup, val set 0.990x speedup, step: 13
Epoch 161/200 |loss: 9.315311| train set 5.008x speedup, test set 0.991x speedup, val set 0.868x speedup, step: 14
Epoch 162/200 |loss: 8.079401| train set 5.004x speedup, test set 0.991x speedup, val set 0.804x speedup, step: 15
Epoch 163/200 |loss: 7.711980| train set 5.008x speedup, test set 1.003x speedup, val set 0.786x speedup, step: 16
Epoch 164/200 |loss: 8.907506| train set 5.008x speedup, test set 1.003x speedup, val set 0.873x speedup, step: 17
Epoch 165/200 |loss: 8.119102| train set 5.008x speedup, test set 1.003x speedup, val set 0.980x speedup, step: 18
Epoch 166/200 |loss: 8.979660| train set 5.008x speedup, test set 1.003x speedup, val set 0.944x speedup, step: 19
Epoch 167/200 |loss: 9.534138| train set 5.007x speedup, test set 1.003x speedup, val set 1.165x speedup, step: 20
Epoch 168/200 |loss: 8.847061| train set 4.957x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.201054| train set 4.958x speedup, test set 1.003x speedup, val set 1.228x speedup, step: 2
Epoch 170/200 |loss: 8.585191| train set 4.873x speedup, test set 1.003x speedup, val set 1.165x speedup, step: 3
Epoch 171/200 |loss: 9.330328| train set 4.873x speedup, test set 1.003x speedup, val set 0.742x speedup, step: 4
Epoch 172/200 |loss: 9.638960| train set 4.958x speedup, test set 0.999x speedup, val set 0.798x speedup, step: 5
Epoch 173/200 |loss: 8.143752| train set 4.957x speedup, test set 1.013x speedup, val set 0.729x speedup, step: 6
Epoch 174/200 |loss: 8.850295| train set 5.007x speedup, test set 0.991x speedup, val set 0.762x speedup, step: 7
Epoch 175/200 |loss: 9.714735| train set 4.920x speedup, test set 0.991x speedup, val set 0.804x speedup, step: 8
Epoch 176/200 |loss: 8.858377| train set 5.007x speedup, test set 0.987x speedup, val set 0.762x speedup, step: 9
Epoch 177/200 |loss: 8.339048| train set 5.007x speedup, test set 0.999x speedup, val set 0.762x speedup, step: 10
Epoch 178/200 |loss: 9.019827| train set 5.008x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 11
Epoch 179/200 |loss: 8.458980| train set 4.865x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 12
Epoch 180/200 |loss: 9.207740| train set 4.958x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 13
Epoch 181/200 |loss: 8.493321| train set 4.958x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 14
Epoch 182/200 |loss: 9.457011| train set 4.956x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 15
Epoch 183/200 |loss: 8.453197| train set 4.958x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 16
Epoch 184/200 |loss: 7.351219| train set 5.008x speedup, test set 1.003x speedup, val set 0.735x speedup, step: 17
Epoch 185/200 |loss: 8.491257| train set 5.008x speedup, test set 1.003x speedup, val set 0.742x speedup, step: 18
Epoch 186/200 |loss: 8.920187| train set 5.008x speedup, test set 0.999x speedup, val set 0.742x speedup, step: 19
Epoch 187/200 |loss: 8.373252| train set 5.007x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 20
Epoch 188/200 |loss: 8.324244| train set 5.007x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 21
Epoch 189/200 |loss: 8.628223| train set 5.008x speedup, test set 0.999x speedup, val set 0.742x speedup, step: 22
Epoch 190/200 |loss: 8.547593| train set 5.008x speedup, test set 0.996x speedup, val set 0.742x speedup, step: 23
Epoch 191/200 |loss: 7.794688| train set 5.008x speedup, test set 1.003x speedup, val set 0.735x speedup, step: 24
Epoch 192/200 |loss: 9.726063| train set 4.921x speedup, test set 0.996x speedup, val set 0.742x speedup, step: 25
Epoch 193/200 |loss: 9.107661| train set 4.921x speedup, test set 0.991x speedup, val set 0.795x speedup, step: 26
Epoch 194/200 |loss: 9.646789| train set 4.921x speedup, test set 0.999x speedup, val set 0.990x speedup, step: 27
Epoch 195/200 |loss: 7.486128| train set 4.921x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 196/200 |loss: 8.644442| train set 4.991x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 2
Epoch 197/200 |loss: 8.902736| train set 5.004x speedup, test set 0.987x speedup, val set 0.804x speedup, step: 3
Epoch 198/200 |loss: 9.207380| train set 4.954x speedup, test set 0.987x speedup, val set 0.804x speedup, step: 4
Epoch 199/200 |loss: 7.614742| train set 4.958x speedup, test set 0.987x speedup, val set 0.804x speedup, step: 5
Training per epoch cost 0.375 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 1.001, val speedup 0.965
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 195, train speedup 4.921, test speedup 0.999, val speedup 1.302
last model at epoch 199, train speedup 4.958, test speedup 0.987, val speedup 0.804
execution cost 0:03:03.332174
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.988560, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281973| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793523| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912634| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587205| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575417| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370786| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755566| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455400| train set 4.285x speedup, test set 0.975x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921763| train set 4.630x speedup, test set 0.870x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914977| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.109001| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590154| train set 4.630x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591467| train set 4.670x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213896| train set 5.008x speedup, test set 1.001x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153137| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.501636| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.035407| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.297975| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.687850| train set 5.007x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.883907| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.646014| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.531390| train set 4.958x speedup, test set 1.026x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.331557| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.345001| train set 4.991x speedup, test set 0.992x speedup, val set 0.733x speedup, step: 29
Epoch 29/200 |loss: 10.291329| train set 4.921x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.726824| train set 5.008x speedup, test set 0.891x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.462419| train set 4.958x speedup, test set 1.039x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.670102| train set 4.708x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 33
Epoch 33/200 |loss: 10.950139| train set 4.630x speedup, test set 0.995x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.332872| train set 4.670x speedup, test set 0.937x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 13.279684| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.832101| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.840023| train set 5.008x speedup, test set 1.026x speedup, val set 1.033x speedup, step: 38
Epoch 38/200 |loss: 10.647147| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 11.120449| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.751295| train set 4.818x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.218369| train set 4.812x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.632307| train set 4.921x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.389650| train set 4.631x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.110835| train set 5.008x speedup, test set 1.017x speedup, val set 1.041x speedup, step: 45
Epoch 45/200 |loss: 9.241202| train set 4.649x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 46
Epoch 46/200 |loss: 10.396928| train set 4.754x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 47
Epoch 47/200 |loss: 9.946220| train set 4.673x speedup, test set 0.996x speedup, val set 1.041x speedup, step: 48
Epoch 48/200 |loss: 9.542155| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 9.966189| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.519866| train set 4.957x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 9.878849| train set 4.958x speedup, test set 0.984x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.810246| train set 4.766x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 53
Epoch 53/200 |loss: 8.988017| train set 4.921x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 54
Epoch 54/200 |loss: 9.063946| train set 4.715x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.883520| train set 5.008x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 9.018935| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 57
Epoch 57/200 |loss: 10.161081| train set 4.921x speedup, test set 0.982x speedup, val set 1.202x speedup, step: 58
Epoch 58/200 |loss: 9.633084| train set 5.008x speedup, test set 0.978x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.758848| train set 5.008x speedup, test set 0.994x speedup, val set 1.033x speedup, step: 60
Epoch 60/200 |loss: 9.315874| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 61
Epoch 61/200 |loss: 10.432072| train set 4.958x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 7.975999| train set 4.958x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 63
Epoch 63/200 |loss: 8.705345| train set 4.869x speedup, test set 0.991x speedup, val set 1.006x speedup, step: 64
Epoch 64/200 |loss: 8.283657| train set 4.915x speedup, test set 0.979x speedup, val set 1.006x speedup, step: 65
Epoch 65/200 |loss: 8.915916| train set 5.007x speedup, test set 0.987x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 10.048397| train set 5.004x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 67
Epoch 67/200 |loss: 7.684351| train set 5.008x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 68
Epoch 68/200 |loss: 9.333083| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 69
Epoch 69/200 |loss: 9.360912| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 70
Epoch 70/200 |loss: 8.349547| train set 5.008x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 71
Epoch 71/200 |loss: 9.351239| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 72
Epoch 72/200 |loss: 7.870350| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 73
Epoch 73/200 |loss: 8.954997| train set 5.007x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 74
Epoch 74/200 |loss: 9.248495| train set 4.957x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.878644| train set 4.957x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.170202| train set 4.920x speedup, test set 0.996x speedup, val set 1.302x speedup, step: 77
Epoch 77/200 |loss: 8.601037| train set 5.007x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 78
Epoch 78/200 |loss: 9.152817| train set 5.007x speedup, test set 0.991x speedup, val set 0.988x speedup, step: 79
Epoch 79/200 |loss: 8.745277| train set 5.004x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 80
Epoch 80/200 |loss: 7.676212| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.218469| train set 5.008x speedup, test set 0.982x speedup, val set 1.165x speedup, step: 82
Epoch 82/200 |loss: 8.755793| train set 5.008x speedup, test set 0.961x speedup, val set 0.804x speedup, step: 83
Epoch 83/200 |loss: 8.894028| train set 5.008x speedup, test set 0.966x speedup, val set 1.228x speedup, step: 84
Epoch 84/200 |loss: 8.999703| train set 4.921x speedup, test set 0.982x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.412349| train set 4.921x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 86
Epoch 86/200 |loss: 8.637731| train set 5.008x speedup, test set 0.982x speedup, val set 1.302x speedup, step: 87
Epoch 87/200 |loss: 9.534211| train set 5.008x speedup, test set 0.966x speedup, val set 1.165x speedup, step: 88
Epoch 88/200 |loss: 7.821367| train set 5.008x speedup, test set 0.966x speedup, val set 0.990x speedup, step: 89
Epoch 89/200 |loss: 8.300973| train set 5.008x speedup, test set 0.982x speedup, val set 1.165x speedup, step: 90
Epoch 90/200 |loss: 8.730113| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.701443| train set 5.008x speedup, test set 0.978x speedup, val set 1.302x speedup, step: 92
Epoch 92/200 |loss: 8.322258| train set 5.008x speedup, test set 0.978x speedup, val set 1.228x speedup, step: 93
Epoch 93/200 |loss: 9.408190| train set 5.008x speedup, test set 0.978x speedup, val set 1.165x speedup, step: 94
Epoch 94/200 |loss: 8.291319| train set 4.958x speedup, test set 0.966x speedup, val set 1.228x speedup, step: 95
Epoch 95/200 |loss: 9.113352| train set 4.957x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 9.160666| train set 4.958x speedup, test set 0.976x speedup, val set 0.823x speedup, step: 97
Epoch 97/200 |loss: 8.896387| train set 5.008x speedup, test set 0.966x speedup, val set 1.165x speedup, step: 98
Epoch 98/200 |loss: 8.709530| train set 5.008x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 99
Epoch 99/200 |loss: 9.351066| train set 5.008x speedup, test set 0.964x speedup, val set 0.980x speedup, step: 100
Epoch 100/200 |loss: 9.247366| train set 5.008x speedup, test set 0.981x speedup, val set 0.804x speedup, step: 1
Epoch 101/200 |loss: 10.050563| train set 4.671x speedup, test set 0.973x speedup, val set 1.006x speedup, step: 1
Epoch 102/200 |loss: 8.794675| train set 4.958x speedup, test set 0.994x speedup, val set 1.165x speedup, step: 1
Epoch 103/200 |loss: 9.404750| train set 4.869x speedup, test set 0.973x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.547197| train set 4.920x speedup, test set 0.979x speedup, val set 1.165x speedup, step: 1
Epoch 105/200 |loss: 7.593596| train set 5.007x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.099584| train set 5.007x speedup, test set 0.975x speedup, val set 1.228x speedup, step: 2
Epoch 107/200 |loss: 8.774829| train set 5.007x speedup, test set 0.982x speedup, val set 0.841x speedup, step: 3
Epoch 108/200 |loss: 7.963036| train set 4.715x speedup, test set 0.979x speedup, val set 1.165x speedup, step: 4
Epoch 109/200 |loss: 9.272667| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 5
Epoch 110/200 |loss: 7.389955| train set 5.004x speedup, test set 0.966x speedup, val set 0.804x speedup, step: 6
Epoch 111/200 |loss: 8.933344| train set 4.958x speedup, test set 0.967x speedup, val set 1.033x speedup, step: 7
Epoch 112/200 |loss: 9.698825| train set 4.958x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 8
Epoch 113/200 |loss: 8.698099| train set 5.004x speedup, test set 0.966x speedup, val set 0.879x speedup, step: 9
Epoch 114/200 |loss: 9.437603| train set 5.008x speedup, test set 0.966x speedup, val set 0.804x speedup, step: 10
Epoch 115/200 |loss: 7.969607| train set 5.008x speedup, test set 0.982x speedup, val set 1.228x speedup, step: 11
Epoch 116/200 |loss: 8.225016| train set 5.008x speedup, test set 0.978x speedup, val set 1.302x speedup, step: 1
Epoch 117/200 |loss: 9.842416| train set 5.008x speedup, test set 0.987x speedup, val set 0.798x speedup, step: 2
Epoch 118/200 |loss: 8.829483| train set 5.008x speedup, test set 1.000x speedup, val set 0.735x speedup, step: 3
Epoch 119/200 |loss: 8.795687| train set 5.008x speedup, test set 1.000x speedup, val set 0.742x speedup, step: 4
Epoch 120/200 |loss: 9.740853| train set 5.008x speedup, test set 1.000x speedup, val set 0.955x speedup, step: 5
Epoch 121/200 |loss: 8.442486| train set 4.921x speedup, test set 0.996x speedup, val set 1.228x speedup, step: 6
Epoch 122/200 |loss: 8.589498| train set 4.873x speedup, test set 0.996x speedup, val set 1.228x speedup, step: 7
Epoch 123/200 |loss: 6.957311| train set 4.957x speedup, test set 0.994x speedup, val set 0.868x speedup, step: 8
Epoch 124/200 |loss: 9.096425| train set 4.867x speedup, test set 0.989x speedup, val set 0.804x speedup, step: 9
Epoch 125/200 |loss: 9.394405| train set 4.920x speedup, test set 0.996x speedup, val set 0.777x speedup, step: 10
Epoch 126/200 |loss: 10.253217| train set 5.007x speedup, test set 0.975x speedup, val set 1.302x speedup, step: 1
Epoch 127/200 |loss: 8.915100| train set 5.007x speedup, test set 0.977x speedup, val set 1.149x speedup, step: 2
Epoch 128/200 |loss: 9.713964| train set 5.008x speedup, test set 0.977x speedup, val set 0.804x speedup, step: 3
Epoch 129/200 |loss: 8.402165| train set 5.008x speedup, test set 0.977x speedup, val set 0.804x speedup, step: 4
Epoch 130/200 |loss: 9.500923| train set 5.008x speedup, test set 0.975x speedup, val set 0.742x speedup, step: 5
Epoch 131/200 |loss: 8.905599| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 132/200 |loss: 9.151019| train set 4.869x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 2
Epoch 133/200 |loss: 7.927642| train set 4.705x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 3
Epoch 134/200 |loss: 6.881783| train set 4.958x speedup, test set 0.975x speedup, val set 0.934x speedup, step: 4
Epoch 135/200 |loss: 8.469792| train set 4.958x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 5
Epoch 136/200 |loss: 7.592224| train set 5.008x speedup, test set 0.986x speedup, val set 0.795x speedup, step: 6
Epoch 137/200 |loss: 8.578185| train set 5.008x speedup, test set 0.989x speedup, val set 0.804x speedup, step: 7
Epoch 138/200 |loss: 9.600413| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 8
Epoch 139/200 |loss: 9.167953| train set 4.715x speedup, test set 0.975x speedup, val set 1.302x speedup, step: 1
Epoch 140/200 |loss: 8.137070| train set 4.958x speedup, test set 0.975x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.339165| train set 4.873x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 2
Epoch 142/200 |loss: 8.546214| train set 4.921x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 3
Epoch 143/200 |loss: 8.889792| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 144/200 |loss: 8.826019| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.343908| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 2
Epoch 146/200 |loss: 9.107954| train set 4.921x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 3
Epoch 147/200 |loss: 9.484275| train set 4.920x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 4
Epoch 148/200 |loss: 8.122493| train set 5.007x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 8.698300| train set 5.007x speedup, test set 0.975x speedup, val set 1.302x speedup, step: 1
Epoch 150/200 |loss: 9.491590| train set 5.007x speedup, test set 0.975x speedup, val set 0.742x speedup, step: 2
Epoch 151/200 |loss: 8.948781| train set 4.916x speedup, test set 0.979x speedup, val set 0.795x speedup, step: 3
Epoch 152/200 |loss: 7.768937| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 4
Epoch 153/200 |loss: 9.516148| train set 5.008x speedup, test set 0.963x speedup, val set 0.798x speedup, step: 5
Epoch 154/200 |loss: 8.942865| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 6
Epoch 155/200 |loss: 9.293017| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 7
Epoch 156/200 |loss: 8.755329| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 157/200 |loss: 8.942262| train set 4.873x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 9
Epoch 158/200 |loss: 10.496306| train set 4.921x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 10
Epoch 159/200 |loss: 7.877946| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 11
Epoch 160/200 |loss: 7.649915| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 12
Epoch 161/200 |loss: 9.292743| train set 5.008x speedup, test set 0.966x speedup, val set 0.786x speedup, step: 13
Epoch 162/200 |loss: 7.987630| train set 5.008x speedup, test set 0.964x speedup, val set 0.804x speedup, step: 14
Epoch 163/200 |loss: 7.904607| train set 5.008x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 15
Epoch 164/200 |loss: 8.794927| train set 5.008x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 16
Epoch 165/200 |loss: 8.016292| train set 5.008x speedup, test set 0.966x speedup, val set 1.149x speedup, step: 17
Epoch 166/200 |loss: 8.951161| train set 5.007x speedup, test set 0.982x speedup, val set 1.165x speedup, step: 18
Epoch 167/200 |loss: 9.332155| train set 4.920x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 19
Epoch 168/200 |loss: 8.810123| train set 4.872x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.191746| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 170/200 |loss: 8.928111| train set 4.873x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 2
Epoch 171/200 |loss: 9.310275| train set 4.873x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 3
Epoch 172/200 |loss: 9.962404| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 4
Epoch 173/200 |loss: 8.135818| train set 4.957x speedup, test set 0.975x speedup, val set 1.228x speedup, step: 5
Epoch 174/200 |loss: 9.002643| train set 5.007x speedup, test set 0.975x speedup, val set 0.868x speedup, step: 6
Epoch 175/200 |loss: 9.830358| train set 4.920x speedup, test set 0.973x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 9.074829| train set 5.007x speedup, test set 0.975x speedup, val set 0.944x speedup, step: 8
Epoch 177/200 |loss: 8.344017| train set 4.957x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 9
Epoch 178/200 |loss: 9.074234| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 10
Epoch 179/200 |loss: 8.467295| train set 4.958x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 11
Epoch 180/200 |loss: 9.098015| train set 4.958x speedup, test set 0.963x speedup, val set 0.908x speedup, step: 12
Epoch 181/200 |loss: 8.568198| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 13
Epoch 182/200 |loss: 9.210317| train set 4.958x speedup, test set 0.979x speedup, val set 0.868x speedup, step: 14
Epoch 183/200 |loss: 8.504159| train set 5.008x speedup, test set 0.987x speedup, val set 0.990x speedup, step: 15
Epoch 184/200 |loss: 7.340648| train set 5.008x speedup, test set 0.987x speedup, val set 1.165x speedup, step: 16
Epoch 185/200 |loss: 8.490127| train set 5.008x speedup, test set 0.987x speedup, val set 0.932x speedup, step: 17
Epoch 186/200 |loss: 8.655897| train set 5.007x speedup, test set 0.996x speedup, val set 0.868x speedup, step: 18
Epoch 187/200 |loss: 8.513814| train set 5.007x speedup, test set 0.996x speedup, val set 1.165x speedup, step: 19
Epoch 188/200 |loss: 8.265909| train set 5.007x speedup, test set 0.975x speedup, val set 1.165x speedup, step: 20
Epoch 189/200 |loss: 8.504762| train set 5.007x speedup, test set 0.979x speedup, val set 1.165x speedup, step: 21
Epoch 190/200 |loss: 8.641176| train set 5.007x speedup, test set 0.979x speedup, val set 0.813x speedup, step: 22
Epoch 191/200 |loss: 7.740891| train set 5.008x speedup, test set 0.979x speedup, val set 0.762x speedup, step: 23
Epoch 192/200 |loss: 9.570081| train set 4.921x speedup, test set 0.979x speedup, val set 0.786x speedup, step: 24
Epoch 193/200 |loss: 9.112638| train set 4.921x speedup, test set 0.979x speedup, val set 0.770x speedup, step: 25
Epoch 194/200 |loss: 9.304172| train set 4.921x speedup, test set 0.979x speedup, val set 1.165x speedup, step: 26
Epoch 195/200 |loss: 7.616247| train set 5.008x speedup, test set 0.979x speedup, val set 1.228x speedup, step: 27
Epoch 196/200 |loss: 8.586898| train set 5.008x speedup, test set 0.987x speedup, val set 0.813x speedup, step: 28
Epoch 197/200 |loss: 8.780650| train set 4.954x speedup, test set 0.986x speedup, val set 0.804x speedup, step: 29
Epoch 198/200 |loss: 9.321066| train set 4.954x speedup, test set 0.986x speedup, val set 0.804x speedup, step: 30
Epoch 199/200 |loss: 7.655895| train set 4.954x speedup, test set 0.991x speedup, val set 0.786x speedup, step: 31
Training per epoch cost 0.362 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 1.001, val speedup 0.965
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 169, train speedup 4.958, test speedup 0.963, val speedup 1.302
last model at epoch 199, train speedup 4.954, test speedup 0.991, val speedup 0.786
execution cost 0:03:00.061675
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.147736, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793523| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912633| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587205| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575417| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370786| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755566| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455400| train set 4.285x speedup, test set 0.975x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921764| train set 4.630x speedup, test set 0.870x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914978| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.109002| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590155| train set 4.630x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591467| train set 4.670x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213897| train set 5.008x speedup, test set 1.001x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153136| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.501635| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.035405| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.297974| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.687850| train set 5.007x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.883907| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.646015| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.531392| train set 4.958x speedup, test set 1.026x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.331562| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.345001| train set 4.991x speedup, test set 0.992x speedup, val set 0.733x speedup, step: 29
Epoch 29/200 |loss: 10.291331| train set 4.921x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.726825| train set 5.008x speedup, test set 0.891x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.462420| train set 4.958x speedup, test set 1.039x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.670101| train set 4.708x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 33
Epoch 33/200 |loss: 10.950141| train set 4.630x speedup, test set 0.995x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.332872| train set 4.670x speedup, test set 0.937x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 13.279685| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.832105| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.840018| train set 5.008x speedup, test set 1.026x speedup, val set 1.033x speedup, step: 38
Epoch 38/200 |loss: 10.647110| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 11.120985| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.752074| train set 4.818x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.213977| train set 4.812x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.630507| train set 4.921x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.374028| train set 4.631x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.101193| train set 4.715x speedup, test set 1.017x speedup, val set 1.041x speedup, step: 45
Epoch 45/200 |loss: 9.247831| train set 4.649x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 46
Epoch 46/200 |loss: 10.432074| train set 4.754x speedup, test set 0.996x speedup, val set 1.041x speedup, step: 47
Epoch 47/200 |loss: 10.060684| train set 4.674x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 48
Epoch 48/200 |loss: 9.571191| train set 5.008x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 49
Epoch 49/200 |loss: 9.998467| train set 5.008x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 50
Epoch 50/200 |loss: 9.455155| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 51
Epoch 51/200 |loss: 9.755834| train set 4.958x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.578645| train set 4.921x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 53
Epoch 53/200 |loss: 8.894175| train set 4.921x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 54
Epoch 54/200 |loss: 8.836397| train set 4.715x speedup, test set 0.973x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.805004| train set 4.957x speedup, test set 0.956x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 8.908813| train set 5.007x speedup, test set 0.956x speedup, val set 1.033x speedup, step: 57
Epoch 57/200 |loss: 9.882232| train set 5.007x speedup, test set 0.956x speedup, val set 1.149x speedup, step: 58
Epoch 58/200 |loss: 9.601805| train set 5.007x speedup, test set 0.955x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.579167| train set 5.007x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 60
Epoch 60/200 |loss: 9.240451| train set 5.008x speedup, test set 0.966x speedup, val set 0.957x speedup, step: 61
Epoch 61/200 |loss: 10.300404| train set 4.958x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 8.017531| train set 4.869x speedup, test set 0.963x speedup, val set 1.006x speedup, step: 63
Epoch 63/200 |loss: 8.577197| train set 4.869x speedup, test set 0.963x speedup, val set 1.006x speedup, step: 64
Epoch 64/200 |loss: 8.391492| train set 5.003x speedup, test set 0.966x speedup, val set 1.006x speedup, step: 65
Epoch 65/200 |loss: 8.827051| train set 5.008x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.652748| train set 5.005x speedup, test set 0.982x speedup, val set 0.980x speedup, step: 67
Epoch 67/200 |loss: 7.604458| train set 5.008x speedup, test set 0.982x speedup, val set 1.006x speedup, step: 68
Epoch 68/200 |loss: 9.222882| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 69
Epoch 69/200 |loss: 9.147504| train set 5.008x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 70
Epoch 70/200 |loss: 8.458044| train set 5.008x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 71
Epoch 71/200 |loss: 9.262012| train set 5.007x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 72
Epoch 72/200 |loss: 7.901350| train set 5.007x speedup, test set 0.963x speedup, val set 1.045x speedup, step: 73
Epoch 73/200 |loss: 8.995162| train set 5.007x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.256297| train set 5.007x speedup, test set 0.971x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 9.014385| train set 5.008x speedup, test set 0.978x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.219056| train set 4.921x speedup, test set 0.978x speedup, val set 1.006x speedup, step: 77
Epoch 77/200 |loss: 8.524250| train set 5.007x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 78
Epoch 78/200 |loss: 9.105246| train set 5.007x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.863203| train set 5.007x speedup, test set 0.966x speedup, val set 0.980x speedup, step: 80
Epoch 80/200 |loss: 7.739872| train set 5.008x speedup, test set 0.978x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.279372| train set 5.008x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 8.747244| train set 5.004x speedup, test set 1.011x speedup, val set 0.804x speedup, step: 83
Epoch 83/200 |loss: 8.566118| train set 5.008x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 8.987113| train set 5.008x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.147380| train set 4.921x speedup, test set 0.966x speedup, val set 1.228x speedup, step: 86
Epoch 86/200 |loss: 8.614374| train set 4.715x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 87
Epoch 87/200 |loss: 9.617137| train set 5.008x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 7.682508| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 89
Epoch 89/200 |loss: 8.285717| train set 5.008x speedup, test set 0.966x speedup, val set 0.980x speedup, step: 90
Epoch 90/200 |loss: 8.598954| train set 5.008x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.582885| train set 5.008x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.305585| train set 5.008x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 93
Epoch 93/200 |loss: 9.306188| train set 5.008x speedup, test set 0.974x speedup, val set 1.006x speedup, step: 94
Epoch 94/200 |loss: 8.522930| train set 4.958x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 95
Epoch 95/200 |loss: 9.013628| train set 4.957x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 96
Epoch 96/200 |loss: 9.383353| train set 4.958x speedup, test set 0.963x speedup, val set 1.006x speedup, step: 97
Epoch 97/200 |loss: 8.951020| train set 5.008x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 98
Epoch 98/200 |loss: 8.586568| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 99
Epoch 99/200 |loss: 9.308343| train set 5.008x speedup, test set 0.966x speedup, val set 1.006x speedup, step: 100
Epoch 100/200 |loss: 9.133036| train set 5.008x speedup, test set 0.966x speedup, val set 0.980x speedup, step: 1
Epoch 101/200 |loss: 9.960187| train set 4.664x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 1
Epoch 102/200 |loss: 8.866527| train set 4.958x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 1
Epoch 103/200 |loss: 9.422288| train set 4.954x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.674794| train set 4.920x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 3
Epoch 105/200 |loss: 7.735795| train set 4.920x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.441116| train set 4.883x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 107/200 |loss: 8.965573| train set 5.007x speedup, test set 0.966x speedup, val set 0.841x speedup, step: 2
Epoch 108/200 |loss: 8.254648| train set 4.714x speedup, test set 0.963x speedup, val set 0.902x speedup, step: 3
Epoch 109/200 |loss: 9.501569| train set 5.008x speedup, test set 0.974x speedup, val set 1.202x speedup, step: 4
Epoch 110/200 |loss: 7.586594| train set 5.008x speedup, test set 0.974x speedup, val set 1.006x speedup, step: 5
Epoch 111/200 |loss: 8.861552| train set 4.958x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 6
Epoch 112/200 |loss: 9.455866| train set 5.008x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 7
Epoch 113/200 |loss: 8.695532| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 8
Epoch 114/200 |loss: 9.462374| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 9
Epoch 115/200 |loss: 8.033530| train set 5.008x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 10
Epoch 116/200 |loss: 8.159996| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 117/200 |loss: 9.891733| train set 5.008x speedup, test set 0.963x speedup, val set 1.211x speedup, step: 2
Epoch 118/200 |loss: 8.686861| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 3
Epoch 119/200 |loss: 8.903802| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 4
Epoch 120/200 |loss: 9.576881| train set 5.008x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 5
Epoch 121/200 |loss: 8.534872| train set 5.008x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 6
Epoch 122/200 |loss: 8.602497| train set 4.958x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 7
Epoch 123/200 |loss: 6.894489| train set 4.958x speedup, test set 0.974x speedup, val set 0.868x speedup, step: 8
Epoch 124/200 |loss: 9.231954| train set 4.921x speedup, test set 0.974x speedup, val set 0.795x speedup, step: 9
Epoch 125/200 |loss: 9.203203| train set 4.921x speedup, test set 0.974x speedup, val set 0.980x speedup, step: 10
Epoch 126/200 |loss: 10.259399| train set 5.007x speedup, test set 0.974x speedup, val set 1.149x speedup, step: 11
Epoch 127/200 |loss: 9.171101| train set 5.007x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 12
Epoch 128/200 |loss: 9.476122| train set 5.007x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 13
Epoch 129/200 |loss: 8.584517| train set 5.007x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 14
Epoch 130/200 |loss: 9.432933| train set 5.008x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 15
Epoch 131/200 |loss: 9.031568| train set 4.958x speedup, test set 0.974x speedup, val set 0.777x speedup, step: 16
Epoch 132/200 |loss: 9.287077| train set 4.958x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 17
Epoch 133/200 |loss: 7.679793| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 134/200 |loss: 6.856558| train set 5.008x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 135/200 |loss: 8.461359| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 2
Epoch 136/200 |loss: 7.531263| train set 5.008x speedup, test set 0.982x speedup, val set 0.823x speedup, step: 3
Epoch 137/200 |loss: 8.789196| train set 5.008x speedup, test set 0.982x speedup, val set 0.980x speedup, step: 4
Epoch 138/200 |loss: 9.384223| train set 5.008x speedup, test set 0.979x speedup, val set 0.980x speedup, step: 5
Epoch 139/200 |loss: 9.008410| train set 5.008x speedup, test set 0.979x speedup, val set 1.165x speedup, step: 6
Epoch 140/200 |loss: 8.029615| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.562300| train set 4.958x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 2
Epoch 142/200 |loss: 8.578804| train set 4.921x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 3
Epoch 143/200 |loss: 9.195298| train set 4.921x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 4
Epoch 144/200 |loss: 8.696303| train set 4.957x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.324342| train set 4.957x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 2
Epoch 146/200 |loss: 9.018914| train set 4.921x speedup, test set 0.963x speedup, val set 0.786x speedup, step: 3
Epoch 147/200 |loss: 9.431343| train set 5.007x speedup, test set 0.963x speedup, val set 0.813x speedup, step: 4
Epoch 148/200 |loss: 8.255106| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 5
Epoch 149/200 |loss: 8.672583| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 6
Epoch 150/200 |loss: 9.411594| train set 4.920x speedup, test set 0.963x speedup, val set 0.786x speedup, step: 7
Epoch 151/200 |loss: 8.803484| train set 4.920x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 8
Epoch 152/200 |loss: 7.754311| train set 4.921x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 9
Epoch 153/200 |loss: 9.562744| train set 5.008x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 154/200 |loss: 8.847410| train set 5.008x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 2
Epoch 155/200 |loss: 9.370362| train set 4.921x speedup, test set 0.974x speedup, val set 0.955x speedup, step: 3
Epoch 156/200 |loss: 8.760975| train set 5.008x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 4
Epoch 157/200 |loss: 9.277920| train set 4.958x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 5
Epoch 158/200 |loss: 10.501808| train set 4.917x speedup, test set 0.974x speedup, val set 0.770x speedup, step: 6
Epoch 159/200 |loss: 8.046328| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 7
Epoch 160/200 |loss: 7.779976| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 8
Epoch 161/200 |loss: 9.375267| train set 5.008x speedup, test set 0.974x speedup, val set 0.762x speedup, step: 9
Epoch 162/200 |loss: 8.071375| train set 5.005x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 10
Epoch 163/200 |loss: 7.956516| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 11
Epoch 164/200 |loss: 8.812644| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 12
Epoch 165/200 |loss: 8.141566| train set 5.008x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 13
Epoch 166/200 |loss: 9.150233| train set 5.008x speedup, test set 0.963x speedup, val set 0.762x speedup, step: 14
Epoch 167/200 |loss: 9.702785| train set 5.007x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 15
Epoch 168/200 |loss: 8.798749| train set 4.957x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.269437| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 170/200 |loss: 8.873721| train set 4.873x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 2
Epoch 171/200 |loss: 9.469441| train set 4.873x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 3
Epoch 172/200 |loss: 9.824410| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 173/200 |loss: 8.315102| train set 4.957x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 2
Epoch 174/200 |loss: 8.920231| train set 5.007x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 3
Epoch 175/200 |loss: 9.774639| train set 4.920x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 4
Epoch 176/200 |loss: 9.139699| train set 5.007x speedup, test set 0.963x speedup, val set 0.836x speedup, step: 5
Epoch 177/200 |loss: 8.315739| train set 4.957x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 6
Epoch 178/200 |loss: 9.075850| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 7
Epoch 179/200 |loss: 8.564978| train set 4.958x speedup, test set 0.963x speedup, val set 0.823x speedup, step: 8
Epoch 180/200 |loss: 8.985196| train set 4.958x speedup, test set 0.963x speedup, val set 0.902x speedup, step: 9
Epoch 181/200 |loss: 8.435755| train set 4.941x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 10
Epoch 182/200 |loss: 9.363686| train set 4.954x speedup, test set 0.963x speedup, val set 0.902x speedup, step: 11
Epoch 183/200 |loss: 8.531248| train set 4.873x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 12
Epoch 184/200 |loss: 7.518317| train set 4.921x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 13
Epoch 185/200 |loss: 8.846272| train set 4.999x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 14
Epoch 186/200 |loss: 8.998333| train set 5.007x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 15
Epoch 187/200 |loss: 8.405343| train set 5.007x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 16
Epoch 188/200 |loss: 8.388093| train set 5.007x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 17
Epoch 189/200 |loss: 8.606388| train set 5.007x speedup, test set 0.963x speedup, val set 0.868x speedup, step: 18
Epoch 190/200 |loss: 8.766235| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 19
Epoch 191/200 |loss: 7.796860| train set 5.008x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 20
Epoch 192/200 |loss: 9.995594| train set 4.921x speedup, test set 0.974x speedup, val set 1.149x speedup, step: 21
Epoch 193/200 |loss: 9.222140| train set 4.921x speedup, test set 0.974x speedup, val set 0.944x speedup, step: 22
Epoch 194/200 |loss: 9.608940| train set 4.921x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 23
Epoch 195/200 |loss: 7.551391| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 196/200 |loss: 8.621318| train set 4.958x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 2
Epoch 197/200 |loss: 8.724644| train set 4.954x speedup, test set 0.974x speedup, val set 0.804x speedup, step: 3
Epoch 198/200 |loss: 9.360395| train set 4.954x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 4
Epoch 199/200 |loss: 7.641356| train set 5.004x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 5
Training per epoch cost 0.377 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 1.001, val speedup 0.965
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 195, train speedup 4.958, test speedup 0.974, val speedup 1.302
last model at epoch 199, train speedup 5.004, test speedup 0.963, val speedup 0.804
execution cost 0:03:01.750243
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.923807, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281973| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286847| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936656| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.794127| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.084895| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.898460| train set 3.146x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.589469| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.624154| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.481757| train set 4.186x speedup, test set 1.012x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.770710| train set 3.958x speedup, test set 0.934x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.435206| train set 4.286x speedup, test set 0.986x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.875360| train set 4.630x speedup, test set 0.870x speedup, val set 1.072x speedup, step: 14
Epoch 14/200 |loss: 13.950064| train set 4.630x speedup, test set 0.879x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.001891| train set 4.895x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.739033| train set 4.631x speedup, test set 1.028x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.596296| train set 4.630x speedup, test set 0.867x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.343484| train set 4.958x speedup, test set 0.888x speedup, val set 1.041x speedup, step: 19
Epoch 19/200 |loss: 10.077988| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.487943| train set 4.631x speedup, test set 1.008x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.911152| train set 5.008x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 22
Epoch 22/200 |loss: 10.262913| train set 5.008x speedup, test set 1.007x speedup, val set 0.855x speedup, step: 23
Epoch 23/200 |loss: 10.649988| train set 4.883x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 24
Epoch 24/200 |loss: 12.277724| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.592276| train set 4.957x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.567834| train set 4.958x speedup, test set 1.014x speedup, val set 0.965x speedup, step: 27
Epoch 27/200 |loss: 12.485828| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.290080| train set 5.008x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 29
Epoch 29/200 |loss: 10.146249| train set 5.008x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 30
Epoch 30/200 |loss: 10.662208| train set 4.958x speedup, test set 1.005x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 10.821290| train set 4.958x speedup, test set 1.014x speedup, val set 1.033x speedup, step: 32
Epoch 32/200 |loss: 10.560391| train set 4.957x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 33
Epoch 33/200 |loss: 9.912266| train set 4.630x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.192122| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 12.386942| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 11.375002| train set 5.008x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 37
Epoch 37/200 |loss: 9.854743| train set 4.674x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 9.402209| train set 4.921x speedup, test set 0.991x speedup, val set 0.994x speedup, step: 39
Epoch 39/200 |loss: 10.108368| train set 4.895x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 40
Epoch 40/200 |loss: 8.943422| train set 5.008x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 41
Epoch 41/200 |loss: 10.112936| train set 4.921x speedup, test set 0.992x speedup, val set 1.063x speedup, step: 42
Epoch 42/200 |loss: 10.686681| train set 4.873x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.292984| train set 4.709x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.501402| train set 4.754x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.582935| train set 4.921x speedup, test set 0.979x speedup, val set 0.786x speedup, step: 46
Epoch 46/200 |loss: 10.415167| train set 4.958x speedup, test set 0.991x speedup, val set 1.160x speedup, step: 47
Epoch 47/200 |loss: 10.694357| train set 5.008x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 48
Epoch 48/200 |loss: 9.436941| train set 4.895x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 10.387223| train set 5.008x speedup, test set 0.991x speedup, val set 0.752x speedup, step: 50
Epoch 50/200 |loss: 9.595481| train set 4.958x speedup, test set 0.992x speedup, val set 1.150x speedup, step: 51
Epoch 51/200 |loss: 10.016852| train set 4.958x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.700260| train set 4.921x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 9.074424| train set 5.008x speedup, test set 0.980x speedup, val set 0.957x speedup, step: 54
Epoch 54/200 |loss: 9.030465| train set 4.715x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.745596| train set 5.008x speedup, test set 0.983x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 8.880496| train set 5.008x speedup, test set 0.983x speedup, val set 0.957x speedup, step: 57
Epoch 57/200 |loss: 9.922676| train set 5.008x speedup, test set 0.992x speedup, val set 0.957x speedup, step: 58
Epoch 58/200 |loss: 9.341964| train set 4.753x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 59
Epoch 59/200 |loss: 8.550010| train set 4.753x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 60
Epoch 60/200 |loss: 9.051000| train set 5.007x speedup, test set 0.983x speedup, val set 1.033x speedup, step: 61
Epoch 61/200 |loss: 10.208924| train set 4.958x speedup, test set 0.967x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 7.822831| train set 4.873x speedup, test set 0.967x speedup, val set 1.033x speedup, step: 63
Epoch 63/200 |loss: 8.826242| train set 4.873x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.356768| train set 4.998x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 65
Epoch 65/200 |loss: 8.774664| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.794609| train set 5.008x speedup, test set 0.967x speedup, val set 1.033x speedup, step: 67
Epoch 67/200 |loss: 7.510333| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 68
Epoch 68/200 |loss: 9.122119| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 69
Epoch 69/200 |loss: 9.180609| train set 5.008x speedup, test set 0.967x speedup, val set 1.033x speedup, step: 70
Epoch 70/200 |loss: 8.406194| train set 5.008x speedup, test set 0.967x speedup, val set 1.033x speedup, step: 71
Epoch 71/200 |loss: 9.388957| train set 5.008x speedup, test set 0.967x speedup, val set 1.033x speedup, step: 72
Epoch 72/200 |loss: 7.953303| train set 5.007x speedup, test set 0.967x speedup, val set 1.033x speedup, step: 73
Epoch 73/200 |loss: 8.914987| train set 5.007x speedup, test set 0.967x speedup, val set 1.033x speedup, step: 74
Epoch 74/200 |loss: 9.294374| train set 5.007x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 75
Epoch 75/200 |loss: 8.900460| train set 4.957x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 76
Epoch 76/200 |loss: 7.301049| train set 4.920x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.427769| train set 4.883x speedup, test set 0.994x speedup, val set 0.994x speedup, step: 78
Epoch 78/200 |loss: 9.329514| train set 4.883x speedup, test set 0.994x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.903918| train set 4.917x speedup, test set 0.994x speedup, val set 0.980x speedup, step: 80
Epoch 80/200 |loss: 7.777321| train set 4.902x speedup, test set 0.994x speedup, val set 0.994x speedup, step: 81
Epoch 81/200 |loss: 10.363712| train set 5.008x speedup, test set 0.994x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 8.850861| train set 5.008x speedup, test set 0.994x speedup, val set 0.980x speedup, step: 83
Epoch 83/200 |loss: 8.655215| train set 5.008x speedup, test set 0.967x speedup, val set 0.864x speedup, step: 84
Epoch 84/200 |loss: 8.928544| train set 5.008x speedup, test set 0.983x speedup, val set 0.752x speedup, step: 85
Epoch 85/200 |loss: 8.216959| train set 5.008x speedup, test set 0.992x speedup, val set 0.994x speedup, step: 86
Epoch 86/200 |loss: 8.680809| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 87
Epoch 87/200 |loss: 9.685859| train set 4.921x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.762510| train set 5.008x speedup, test set 0.983x speedup, val set 0.735x speedup, step: 89
Epoch 89/200 |loss: 8.278642| train set 5.008x speedup, test set 0.980x speedup, val set 0.758x speedup, step: 90
Epoch 90/200 |loss: 8.544072| train set 5.008x speedup, test set 0.992x speedup, val set 0.957x speedup, step: 91
Epoch 91/200 |loss: 8.447831| train set 5.008x speedup, test set 0.983x speedup, val set 0.994x speedup, step: 92
Epoch 92/200 |loss: 8.273960| train set 5.008x speedup, test set 0.983x speedup, val set 0.855x speedup, step: 93
Epoch 93/200 |loss: 9.245245| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 94
Epoch 94/200 |loss: 8.228229| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 95
Epoch 95/200 |loss: 9.042804| train set 4.958x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 96
Epoch 96/200 |loss: 8.935871| train set 4.958x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 97
Epoch 97/200 |loss: 8.888900| train set 5.008x speedup, test set 0.967x speedup, val set 0.957x speedup, step: 98
Epoch 98/200 |loss: 8.724294| train set 5.008x speedup, test set 0.967x speedup, val set 0.752x speedup, step: 99
Epoch 99/200 |loss: 9.323757| train set 5.008x speedup, test set 0.967x speedup, val set 0.735x speedup, step: 100
Epoch 100/200 |loss: 9.043988| train set 5.008x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 1
Epoch 101/200 |loss: 10.021394| train set 4.715x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 1
Epoch 102/200 |loss: 8.671143| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 1
Epoch 103/200 |loss: 9.414232| train set 5.004x speedup, test set 0.963x speedup, val set 0.795x speedup, step: 1
Epoch 104/200 |loss: 8.575767| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 2
Epoch 105/200 |loss: 7.477978| train set 5.007x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 1
Epoch 106/200 |loss: 8.249769| train set 5.007x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 2
Epoch 107/200 |loss: 8.931723| train set 5.007x speedup, test set 0.994x speedup, val set 0.735x speedup, step: 3
Epoch 108/200 |loss: 8.026727| train set 4.753x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 4
Epoch 109/200 |loss: 9.179025| train set 5.008x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 5
Epoch 110/200 |loss: 7.508073| train set 4.921x speedup, test set 0.971x speedup, val set 0.762x speedup, step: 6
Epoch 111/200 |loss: 8.988395| train set 4.958x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 7
Epoch 112/200 |loss: 9.494541| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 8
Epoch 113/200 |loss: 8.723435| train set 4.999x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 9
Epoch 114/200 |loss: 9.325382| train set 5.008x speedup, test set 0.994x speedup, val set 0.735x speedup, step: 10
Epoch 115/200 |loss: 8.032828| train set 5.008x speedup, test set 0.994x speedup, val set 0.798x speedup, step: 11
Epoch 116/200 |loss: 8.106372| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 12
Epoch 117/200 |loss: 9.669077| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 13
Epoch 118/200 |loss: 8.620888| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 14
Epoch 119/200 |loss: 8.887290| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 15
Epoch 120/200 |loss: 9.626558| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 16
Epoch 121/200 |loss: 8.385407| train set 4.921x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 17
Epoch 122/200 |loss: 8.578279| train set 4.958x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 1
Epoch 123/200 |loss: 6.968086| train set 4.957x speedup, test set 0.963x speedup, val set 0.934x speedup, step: 2
Epoch 124/200 |loss: 9.139959| train set 4.920x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 3
Epoch 125/200 |loss: 9.444894| train set 5.007x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 4
Epoch 126/200 |loss: 10.348047| train set 5.007x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 5
Epoch 127/200 |loss: 8.844222| train set 5.007x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 6
Epoch 128/200 |loss: 9.410314| train set 5.007x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 7
Epoch 129/200 |loss: 8.401252| train set 4.921x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 8
Epoch 130/200 |loss: 9.475548| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 9
Epoch 131/200 |loss: 8.766796| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 10
Epoch 132/200 |loss: 9.226217| train set 4.954x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 11
Epoch 133/200 |loss: 7.565684| train set 4.958x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 12
Epoch 134/200 |loss: 7.050220| train set 5.008x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 13
Epoch 135/200 |loss: 8.331997| train set 5.008x speedup, test set 0.978x speedup, val set 0.739x speedup, step: 14
Epoch 136/200 |loss: 7.694674| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 15
Epoch 137/200 |loss: 8.393829| train set 5.008x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 16
Epoch 138/200 |loss: 9.555501| train set 4.921x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 17
Epoch 139/200 |loss: 9.203554| train set 4.958x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 18
Epoch 140/200 |loss: 7.861538| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.627563| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 142/200 |loss: 8.320170| train set 4.917x speedup, test set 0.974x speedup, val set 0.762x speedup, step: 2
Epoch 143/200 |loss: 9.221888| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 3
Epoch 144/200 |loss: 8.524046| train set 4.957x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.359560| train set 4.920x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 2
Epoch 146/200 |loss: 9.347816| train set 4.920x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 3
Epoch 147/200 |loss: 9.885308| train set 4.957x speedup, test set 0.978x speedup, val set 1.133x speedup, step: 4
Epoch 148/200 |loss: 8.534536| train set 5.007x speedup, test set 0.990x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 9.071836| train set 5.007x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 150/200 |loss: 9.689689| train set 5.001x speedup, test set 0.965x speedup, val set 0.735x speedup, step: 2
Epoch 151/200 |loss: 9.304288| train set 5.004x speedup, test set 0.965x speedup, val set 0.735x speedup, step: 3
Epoch 152/200 |loss: 7.840909| train set 4.921x speedup, test set 0.990x speedup, val set 1.133x speedup, step: 4
Epoch 153/200 |loss: 9.785024| train set 4.921x speedup, test set 0.978x speedup, val set 0.762x speedup, step: 5
Epoch 154/200 |loss: 9.034252| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 6
Epoch 155/200 |loss: 9.418573| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 7
Epoch 156/200 |loss: 8.913358| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 8
Epoch 157/200 |loss: 9.364801| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 9
Epoch 158/200 |loss: 10.390443| train set 4.921x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 10
Epoch 159/200 |loss: 7.902909| train set 5.008x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 11
Epoch 160/200 |loss: 7.822589| train set 5.008x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 12
Epoch 161/200 |loss: 9.422752| train set 5.008x speedup, test set 0.978x speedup, val set 0.813x speedup, step: 13
Epoch 162/200 |loss: 8.033357| train set 5.008x speedup, test set 1.011x speedup, val set 0.770x speedup, step: 14
Epoch 163/200 |loss: 7.613159| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 15
Epoch 164/200 |loss: 9.011940| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 16
Epoch 165/200 |loss: 8.045384| train set 5.008x speedup, test set 0.994x speedup, val set 0.735x speedup, step: 17
Epoch 166/200 |loss: 9.200493| train set 5.008x speedup, test set 0.994x speedup, val set 0.742x speedup, step: 18
Epoch 167/200 |loss: 9.544880| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 19
Epoch 168/200 |loss: 9.094938| train set 4.957x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.316175| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 170/200 |loss: 8.713328| train set 4.958x speedup, test set 0.957x speedup, val set 1.228x speedup, step: 2
Epoch 171/200 |loss: 9.481350| train set 4.873x speedup, test set 0.957x speedup, val set 0.735x speedup, step: 3
Epoch 172/200 |loss: 9.746591| train set 4.873x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 4
Epoch 173/200 |loss: 8.264484| train set 4.957x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 174/200 |loss: 8.946234| train set 4.920x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 2
Epoch 175/200 |loss: 9.967913| train set 4.920x speedup, test set 0.966x speedup, val set 0.786x speedup, step: 3
Epoch 176/200 |loss: 9.226937| train set 4.920x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 4
Epoch 177/200 |loss: 8.270895| train set 4.957x speedup, test set 0.974x speedup, val set 1.211x speedup, step: 5
Epoch 178/200 |loss: 9.202599| train set 4.957x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 6
Epoch 179/200 |loss: 8.550501| train set 4.958x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 7
Epoch 180/200 |loss: 8.968341| train set 4.958x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 8
Epoch 181/200 |loss: 8.436564| train set 4.958x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 9
Epoch 182/200 |loss: 9.286773| train set 4.958x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 10
Epoch 183/200 |loss: 8.358734| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 184/200 |loss: 7.495265| train set 5.008x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 2
Epoch 185/200 |loss: 8.510783| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 3
Epoch 186/200 |loss: 9.017395| train set 4.753x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 4
Epoch 187/200 |loss: 8.331221| train set 5.007x speedup, test set 0.974x speedup, val set 1.316x speedup, step: 1
Epoch 188/200 |loss: 8.345928| train set 5.007x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 2
Epoch 189/200 |loss: 8.814096| train set 5.007x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 3
Epoch 190/200 |loss: 8.793939| train set 5.007x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 4
Epoch 191/200 |loss: 7.874138| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 5
Epoch 192/200 |loss: 9.972323| train set 4.921x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 6
Epoch 193/200 |loss: 9.161504| train set 4.921x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 7
Epoch 194/200 |loss: 9.640102| train set 4.921x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 8
Epoch 195/200 |loss: 7.583389| train set 4.873x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 9
Epoch 196/200 |loss: 8.451122| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 10
Epoch 197/200 |loss: 8.758975| train set 4.958x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 11
Epoch 198/200 |loss: 9.353302| train set 4.954x speedup, test set 0.978x speedup, val set 0.786x speedup, step: 12
Epoch 199/200 |loss: 7.498668| train set 5.008x speedup, test set 0.978x speedup, val set 0.795x speedup, step: 13
Training per epoch cost 0.374 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 1.007, val speedup 0.733
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 187, train speedup 5.007, test speedup 0.974, val speedup 1.316
last model at epoch 199, train speedup 5.008, test speedup 0.978, val speedup 0.795
execution cost 0:03:02.369716
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.012310, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286847| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.794125| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.084892| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.898472| train set 3.146x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588903| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.621377| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.479285| train set 3.958x speedup, test set 1.012x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.773628| train set 3.958x speedup, test set 0.934x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.428043| train set 4.286x speedup, test set 0.986x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.939327| train set 4.630x speedup, test set 0.870x speedup, val set 1.072x speedup, step: 14
Epoch 14/200 |loss: 14.082240| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.129756| train set 4.895x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.694132| train set 4.631x speedup, test set 1.031x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.614178| train set 4.630x speedup, test set 0.868x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.223695| train set 4.958x speedup, test set 0.892x speedup, val set 1.041x speedup, step: 19
Epoch 19/200 |loss: 10.013262| train set 4.958x speedup, test set 0.985x speedup, val set 1.041x speedup, step: 20
Epoch 20/200 |loss: 12.364560| train set 4.631x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.855115| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.411454| train set 5.007x speedup, test set 0.991x speedup, val set 1.063x speedup, step: 23
Epoch 23/200 |loss: 10.890330| train set 4.957x speedup, test set 1.014x speedup, val set 1.041x speedup, step: 24
Epoch 24/200 |loss: 12.019932| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.861131| train set 4.958x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 11.023620| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 12.451422| train set 4.674x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 28
Epoch 28/200 |loss: 10.676621| train set 5.008x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 29
Epoch 29/200 |loss: 10.455029| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.736735| train set 4.958x speedup, test set 0.922x speedup, val set 1.033x speedup, step: 31
Epoch 31/200 |loss: 11.395116| train set 4.958x speedup, test set 1.001x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 10.699994| train set 4.957x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 10.632474| train set 4.957x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.133176| train set 4.894x speedup, test set 0.923x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 13.007939| train set 5.007x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.427240| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.758182| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 38
Epoch 38/200 |loss: 9.854593| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.549299| train set 4.958x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.236672| train set 4.958x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 10.960632| train set 4.873x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.359091| train set 4.873x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.114686| train set 4.630x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 10.742630| train set 5.007x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.234355| train set 4.754x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 10.037676| train set 4.754x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 10.270617| train set 4.674x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.165045| train set 4.638x speedup, test set 0.971x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 10.293033| train set 5.008x speedup, test set 0.955x speedup, val set 0.855x speedup, step: 50
Epoch 50/200 |loss: 9.310624| train set 5.008x speedup, test set 0.955x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 10.135510| train set 4.958x speedup, test set 0.955x speedup, val set 0.729x speedup, step: 52
Epoch 52/200 |loss: 10.490307| train set 4.812x speedup, test set 0.970x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 9.046309| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.838593| train set 4.715x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.831952| train set 5.007x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 8.782284| train set 5.007x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 9.952627| train set 5.007x speedup, test set 0.971x speedup, val set 1.033x speedup, step: 58
Epoch 58/200 |loss: 9.278475| train set 5.007x speedup, test set 0.955x speedup, val set 1.033x speedup, step: 59
Epoch 59/200 |loss: 8.643231| train set 4.753x speedup, test set 0.971x speedup, val set 0.994x speedup, step: 60
Epoch 60/200 |loss: 9.249485| train set 5.007x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.400544| train set 4.958x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 62
Epoch 62/200 |loss: 7.925733| train set 4.873x speedup, test set 0.970x speedup, val set 0.957x speedup, step: 63
Epoch 63/200 |loss: 8.746911| train set 4.921x speedup, test set 0.970x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.404774| train set 4.920x speedup, test set 0.970x speedup, val set 0.980x speedup, step: 65
Epoch 65/200 |loss: 8.931185| train set 5.008x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.927643| train set 5.004x speedup, test set 0.981x speedup, val set 0.980x speedup, step: 67
Epoch 67/200 |loss: 7.568661| train set 5.004x speedup, test set 0.981x speedup, val set 0.980x speedup, step: 68
Epoch 68/200 |loss: 9.275240| train set 5.008x speedup, test set 0.954x speedup, val set 1.033x speedup, step: 69
Epoch 69/200 |loss: 9.294542| train set 5.008x speedup, test set 0.954x speedup, val set 0.855x speedup, step: 70
Epoch 70/200 |loss: 8.853966| train set 5.008x speedup, test set 0.953x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.612493| train set 5.008x speedup, test set 0.953x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 7.939030| train set 5.007x speedup, test set 0.950x speedup, val set 0.957x speedup, step: 73
Epoch 73/200 |loss: 9.101525| train set 5.007x speedup, test set 0.950x speedup, val set 0.735x speedup, step: 74
Epoch 74/200 |loss: 9.370947| train set 4.957x speedup, test set 0.950x speedup, val set 1.185x speedup, step: 75
Epoch 75/200 |loss: 8.886721| train set 4.957x speedup, test set 0.961x speedup, val set 1.033x speedup, step: 76
Epoch 76/200 |loss: 7.254466| train set 5.007x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.318421| train set 5.007x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 78
Epoch 78/200 |loss: 9.257787| train set 5.007x speedup, test set 0.961x speedup, val set 0.735x speedup, step: 79
Epoch 79/200 |loss: 8.909888| train set 5.008x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 80
Epoch 80/200 |loss: 7.535288| train set 5.008x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 81
Epoch 81/200 |loss: 10.413338| train set 5.008x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 8.755925| train set 4.880x speedup, test set 1.009x speedup, val set 0.742x speedup, step: 83
Epoch 83/200 |loss: 8.642260| train set 5.008x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 84
Epoch 84/200 |loss: 8.901205| train set 4.921x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.130426| train set 5.008x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 9.021224| train set 5.008x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 87
Epoch 87/200 |loss: 9.617391| train set 5.008x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.983947| train set 5.008x speedup, test set 0.950x speedup, val set 0.735x speedup, step: 89
Epoch 89/200 |loss: 8.221693| train set 5.008x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 90
Epoch 90/200 |loss: 8.728345| train set 5.008x speedup, test set 0.964x speedup, val set 0.994x speedup, step: 91
Epoch 91/200 |loss: 8.842355| train set 5.008x speedup, test set 0.964x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.348670| train set 5.008x speedup, test set 0.964x speedup, val set 1.033x speedup, step: 93
Epoch 93/200 |loss: 9.271072| train set 5.008x speedup, test set 0.964x speedup, val set 1.006x speedup, step: 94
Epoch 94/200 |loss: 8.286331| train set 4.958x speedup, test set 0.961x speedup, val set 1.033x speedup, step: 95
Epoch 95/200 |loss: 9.060215| train set 4.958x speedup, test set 0.952x speedup, val set 1.033x speedup, step: 96
Epoch 96/200 |loss: 9.152112| train set 4.958x speedup, test set 0.950x speedup, val set 0.968x speedup, step: 97
Epoch 97/200 |loss: 8.865238| train set 4.958x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.684467| train set 5.008x speedup, test set 0.950x speedup, val set 0.957x speedup, step: 99
Epoch 99/200 |loss: 9.561895| train set 5.008x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 100
Epoch 100/200 |loss: 9.225534| train set 5.008x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 1
Epoch 101/200 |loss: 9.824671| train set 4.715x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 2
Epoch 102/200 |loss: 8.812754| train set 4.958x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 3
Epoch 103/200 |loss: 9.369198| train set 5.004x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 1
Epoch 104/200 |loss: 8.455586| train set 4.921x speedup, test set 0.950x speedup, val set 0.735x speedup, step: 2
Epoch 105/200 |loss: 7.653642| train set 4.920x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 3
Epoch 106/200 |loss: 8.324376| train set 5.007x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 4
Epoch 107/200 |loss: 8.836018| train set 5.007x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 5
Epoch 108/200 |loss: 7.953847| train set 5.007x speedup, test set 0.954x speedup, val set 0.729x speedup, step: 6
Epoch 109/200 |loss: 9.563756| train set 5.008x speedup, test set 0.954x speedup, val set 0.729x speedup, step: 7
Epoch 110/200 |loss: 7.436348| train set 5.008x speedup, test set 0.954x speedup, val set 0.735x speedup, step: 8
Epoch 111/200 |loss: 9.176540| train set 5.008x speedup, test set 0.954x speedup, val set 0.729x speedup, step: 9
Epoch 112/200 |loss: 9.521111| train set 5.004x speedup, test set 0.954x speedup, val set 0.729x speedup, step: 10
Epoch 113/200 |loss: 8.821115| train set 5.005x speedup, test set 0.954x speedup, val set 0.729x speedup, step: 11
Epoch 114/200 |loss: 9.476723| train set 5.008x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 12
Epoch 115/200 |loss: 7.969682| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 13
Epoch 116/200 |loss: 8.187742| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 14
Epoch 117/200 |loss: 9.832588| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 15
Epoch 118/200 |loss: 8.722046| train set 5.008x speedup, test set 0.964x speedup, val set 0.729x speedup, step: 16
Epoch 119/200 |loss: 8.815957| train set 5.008x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 17
Epoch 120/200 |loss: 9.585870| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 18
Epoch 121/200 |loss: 8.558397| train set 4.921x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 19
Epoch 122/200 |loss: 8.574725| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 20
Epoch 123/200 |loss: 7.056698| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 21
Epoch 124/200 |loss: 9.189678| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 1
Epoch 125/200 |loss: 9.240057| train set 4.920x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 2
Epoch 126/200 |loss: 9.956743| train set 5.007x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 3
Epoch 127/200 |loss: 8.647025| train set 5.007x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 4
Epoch 128/200 |loss: 9.130300| train set 5.008x speedup, test set 0.954x speedup, val set 0.762x speedup, step: 1
Epoch 129/200 |loss: 8.488728| train set 5.008x speedup, test set 0.961x speedup, val set 0.742x speedup, step: 2
Epoch 130/200 |loss: 9.291804| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 3
Epoch 131/200 |loss: 8.895121| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 4
Epoch 132/200 |loss: 8.952795| train set 4.955x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 5
Epoch 133/200 |loss: 7.633008| train set 5.008x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 1
Epoch 134/200 |loss: 6.795331| train set 5.008x speedup, test set 0.950x speedup, val set 0.882x speedup, step: 2
Epoch 135/200 |loss: 8.551838| train set 5.008x speedup, test set 0.961x speedup, val set 0.782x speedup, step: 3
Epoch 136/200 |loss: 7.569881| train set 5.008x speedup, test set 0.964x speedup, val set 0.804x speedup, step: 4
Epoch 137/200 |loss: 8.834815| train set 5.008x speedup, test set 0.964x speedup, val set 0.980x speedup, step: 5
Epoch 138/200 |loss: 9.490823| train set 4.921x speedup, test set 0.961x speedup, val set 1.016x speedup, step: 6
Epoch 139/200 |loss: 9.084105| train set 4.873x speedup, test set 0.950x speedup, val set 1.165x speedup, step: 1
Epoch 140/200 |loss: 7.965869| train set 4.958x speedup, test set 0.950x speedup, val set 1.228x speedup, step: 1
Epoch 141/200 |loss: 8.440349| train set 4.958x speedup, test set 0.950x speedup, val set 1.228x speedup, step: 1
Epoch 142/200 |loss: 8.674077| train set 4.921x speedup, test set 0.963x speedup, val set 0.932x speedup, step: 2
Epoch 143/200 |loss: 9.387424| train set 4.921x speedup, test set 0.963x speedup, val set 0.955x speedup, step: 3
Epoch 144/200 |loss: 8.701084| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.402370| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 2
Epoch 146/200 |loss: 9.086551| train set 4.920x speedup, test set 0.963x speedup, val set 0.770x speedup, step: 3
Epoch 147/200 |loss: 9.672329| train set 4.920x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 4
Epoch 148/200 |loss: 8.247326| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 5
Epoch 149/200 |loss: 8.646285| train set 5.007x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 6
Epoch 150/200 |loss: 9.559910| train set 5.007x speedup, test set 0.961x speedup, val set 0.742x speedup, step: 7
Epoch 151/200 |loss: 8.766330| train set 4.921x speedup, test set 0.961x speedup, val set 0.795x speedup, step: 8
Epoch 152/200 |loss: 7.767216| train set 4.921x speedup, test set 0.961x speedup, val set 0.735x speedup, step: 9
Epoch 153/200 |loss: 9.572130| train set 4.921x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 10
Epoch 154/200 |loss: 8.957792| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 11
Epoch 155/200 |loss: 9.112337| train set 5.008x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 12
Epoch 156/200 |loss: 8.705578| train set 5.008x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 13
Epoch 157/200 |loss: 9.282157| train set 4.958x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 14
Epoch 158/200 |loss: 10.400438| train set 4.913x speedup, test set 0.950x speedup, val set 0.735x speedup, step: 15
Epoch 159/200 |loss: 7.799706| train set 5.002x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 16
Epoch 160/200 |loss: 7.554615| train set 5.008x speedup, test set 0.950x speedup, val set 0.735x speedup, step: 17
Epoch 161/200 |loss: 9.327132| train set 5.008x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 18
Epoch 162/200 |loss: 8.057216| train set 5.008x speedup, test set 0.950x speedup, val set 0.762x speedup, step: 19
Epoch 163/200 |loss: 7.799959| train set 5.008x speedup, test set 0.950x speedup, val set 0.735x speedup, step: 20
Epoch 164/200 |loss: 8.998662| train set 5.008x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 21
Epoch 165/200 |loss: 7.962222| train set 5.007x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 22
Epoch 166/200 |loss: 9.140219| train set 5.007x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 23
Epoch 167/200 |loss: 9.563197| train set 4.920x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 24
Epoch 168/200 |loss: 8.963115| train set 4.958x speedup, test set 0.961x speedup, val set 1.133x speedup, step: 25
Epoch 169/200 |loss: 8.231773| train set 4.958x speedup, test set 0.961x speedup, val set 1.133x speedup, step: 26
Epoch 170/200 |loss: 8.691847| train set 4.873x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 27
Epoch 171/200 |loss: 9.563889| train set 4.873x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 28
Epoch 172/200 |loss: 9.688286| train set 4.873x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 29
Epoch 173/200 |loss: 8.172616| train set 4.872x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 30
Epoch 174/200 |loss: 8.599325| train set 4.920x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 31
Epoch 175/200 |loss: 9.868756| train set 4.920x speedup, test set 0.994x speedup, val set 0.742x speedup, step: 32
Epoch 176/200 |loss: 8.980977| train set 5.007x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 33
Epoch 177/200 |loss: 8.311357| train set 5.007x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 34
Epoch 178/200 |loss: 9.078301| train set 4.958x speedup, test set 0.950x speedup, val set 0.735x speedup, step: 35
Epoch 179/200 |loss: 8.540257| train set 4.958x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 36
Epoch 180/200 |loss: 9.101876| train set 4.958x speedup, test set 1.008x speedup, val set 0.735x speedup, step: 37
Epoch 181/200 |loss: 8.468379| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 38
Epoch 182/200 |loss: 9.362165| train set 4.958x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 39
Epoch 183/200 |loss: 8.340583| train set 4.958x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 40
Epoch 184/200 |loss: 7.522921| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 41
Epoch 185/200 |loss: 8.489118| train set 4.999x speedup, test set 0.971x speedup, val set 0.735x speedup, step: 42
Epoch 186/200 |loss: 9.031483| train set 4.753x speedup, test set 0.971x speedup, val set 0.729x speedup, step: 43
Epoch 187/200 |loss: 8.440430| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 44
Epoch 188/200 |loss: 8.262694| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 45
Epoch 189/200 |loss: 8.586663| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 46
Epoch 190/200 |loss: 8.499131| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 47
Epoch 191/200 |loss: 7.952996| train set 5.008x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 48
Epoch 192/200 |loss: 9.779366| train set 4.921x speedup, test set 1.008x speedup, val set 0.742x speedup, step: 49
Epoch 193/200 |loss: 9.302494| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 50
Epoch 194/200 |loss: 9.504308| train set 4.921x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 51
Epoch 195/200 |loss: 7.491117| train set 4.958x speedup, test set 0.963x speedup, val set 0.934x speedup, step: 52
Epoch 196/200 |loss: 8.683398| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 53
Epoch 197/200 |loss: 8.758855| train set 5.004x speedup, test set 0.963x speedup, val set 0.786x speedup, step: 54
Epoch 198/200 |loss: 9.217197| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 55
Epoch 199/200 |loss: 7.471107| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 56
Training per epoch cost 0.365 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 0.991, val speedup 0.729
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 144, train speedup 4.957, test speedup 0.963, val speedup 1.302
last model at epoch 199, train speedup 4.958, test speedup 0.963, val speedup 0.742
execution cost 0:03:00.172482
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.999197, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281971| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286848| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793521| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089587| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912633| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587203| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575415| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370782| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755565| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455397| train set 4.285x speedup, test set 0.975x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921762| train set 4.630x speedup, test set 0.870x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914979| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.108999| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590152| train set 4.630x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591465| train set 4.670x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213898| train set 5.008x speedup, test set 1.001x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153138| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.501282| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.032994| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.299733| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.682258| train set 5.007x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.868282| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.634622| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.587011| train set 4.958x speedup, test set 1.014x speedup, val set 0.965x speedup, step: 27
Epoch 27/200 |loss: 12.317118| train set 4.958x speedup, test set 0.979x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.399300| train set 5.008x speedup, test set 0.991x speedup, val set 0.965x speedup, step: 29
Epoch 29/200 |loss: 10.265635| train set 4.921x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.689190| train set 4.958x speedup, test set 0.891x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.407424| train set 4.958x speedup, test set 1.015x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.769504| train set 4.708x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 10.962969| train set 4.630x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.359431| train set 4.714x speedup, test set 0.875x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 12.914875| train set 5.008x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 13.040853| train set 5.008x speedup, test set 0.990x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.866453| train set 5.008x speedup, test set 1.040x speedup, val set 0.729x speedup, step: 38
Epoch 38/200 |loss: 10.210923| train set 5.008x speedup, test set 1.002x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.658595| train set 4.958x speedup, test set 1.002x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.371655| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 10.860033| train set 4.921x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.280919| train set 5.008x speedup, test set 1.000x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 9.882837| train set 4.631x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.124209| train set 5.008x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.090438| train set 4.652x speedup, test set 0.980x speedup, val set 0.855x speedup, step: 46
Epoch 46/200 |loss: 10.105725| train set 4.754x speedup, test set 0.976x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 10.099934| train set 4.674x speedup, test set 0.988x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.680800| train set 4.921x speedup, test set 0.988x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 9.948733| train set 4.921x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.506264| train set 4.958x speedup, test set 0.991x speedup, val set 1.175x speedup, step: 51
Epoch 51/200 |loss: 9.926155| train set 4.958x speedup, test set 0.988x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.669071| train set 4.812x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 8.733271| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.875608| train set 4.714x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.957605| train set 5.007x speedup, test set 0.994x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 8.970645| train set 4.920x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.125530| train set 5.007x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.476084| train set 5.007x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.766409| train set 5.007x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 60
Epoch 60/200 |loss: 9.313924| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.599072| train set 4.958x speedup, test set 0.982x speedup, val set 0.798x speedup, step: 62
Epoch 62/200 |loss: 8.039269| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 63
Epoch 63/200 |loss: 8.609481| train set 4.869x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 64
Epoch 64/200 |loss: 8.406410| train set 4.917x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 65
Epoch 65/200 |loss: 8.773486| train set 5.008x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 66
Epoch 66/200 |loss: 9.934604| train set 5.008x speedup, test set 0.982x speedup, val set 0.882x speedup, step: 67
Epoch 67/200 |loss: 7.502875| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.179773| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.182585| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.675848| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.444708| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 7.790646| train set 5.008x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 73
Epoch 73/200 |loss: 9.023263| train set 5.008x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.245400| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.937360| train set 5.007x speedup, test set 0.978x speedup, val set 1.133x speedup, step: 76
Epoch 76/200 |loss: 7.289379| train set 5.007x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.356013| train set 5.007x speedup, test set 0.974x speedup, val set 0.994x speedup, step: 78
Epoch 78/200 |loss: 9.317273| train set 5.007x speedup, test set 0.978x speedup, val set 0.994x speedup, step: 79
Epoch 79/200 |loss: 8.757262| train set 5.003x speedup, test set 0.978x speedup, val set 0.980x speedup, step: 80
Epoch 80/200 |loss: 7.609914| train set 5.008x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 81
Epoch 81/200 |loss: 10.275154| train set 5.008x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 8.899337| train set 5.008x speedup, test set 0.945x speedup, val set 0.804x speedup, step: 83
Epoch 83/200 |loss: 8.655602| train set 5.008x speedup, test set 0.978x speedup, val set 1.006x speedup, step: 84
Epoch 84/200 |loss: 9.079718| train set 5.008x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 85
Epoch 85/200 |loss: 8.135208| train set 4.921x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 86
Epoch 86/200 |loss: 8.946560| train set 5.008x speedup, test set 0.973x speedup, val set 1.033x speedup, step: 87
Epoch 87/200 |loss: 9.634982| train set 5.008x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 7.866659| train set 4.883x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 89
Epoch 89/200 |loss: 8.367843| train set 4.883x speedup, test set 0.966x speedup, val set 0.988x speedup, step: 90
Epoch 90/200 |loss: 8.731183| train set 4.958x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.721746| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.275492| train set 5.008x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 93
Epoch 93/200 |loss: 9.249204| train set 5.008x speedup, test set 0.999x speedup, val set 1.006x speedup, step: 94
Epoch 94/200 |loss: 8.380236| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 95
Epoch 95/200 |loss: 9.021138| train set 4.958x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 96
Epoch 96/200 |loss: 9.268283| train set 4.958x speedup, test set 0.966x speedup, val set 0.980x speedup, step: 97
Epoch 97/200 |loss: 9.063553| train set 4.958x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 98
Epoch 98/200 |loss: 8.635700| train set 5.008x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 99
Epoch 99/200 |loss: 9.525849| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 100
Epoch 100/200 |loss: 9.044690| train set 5.008x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 1
Epoch 101/200 |loss: 10.146672| train set 4.715x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 1
Epoch 102/200 |loss: 9.086763| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 103/200 |loss: 9.492803| train set 5.004x speedup, test set 0.963x speedup, val set 0.836x speedup, step: 2
Epoch 104/200 |loss: 8.646750| train set 4.917x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 3
Epoch 105/200 |loss: 7.823568| train set 5.007x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.594601| train set 5.007x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 107/200 |loss: 8.843864| train set 5.007x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 2
Epoch 108/200 |loss: 7.925882| train set 5.007x speedup, test set 0.952x speedup, val set 0.841x speedup, step: 3
Epoch 109/200 |loss: 9.242490| train set 4.715x speedup, test set 0.952x speedup, val set 1.006x speedup, step: 4
Epoch 110/200 |loss: 7.496652| train set 5.008x speedup, test set 0.952x speedup, val set 1.033x speedup, step: 5
Epoch 111/200 |loss: 8.688423| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 6
Epoch 112/200 |loss: 9.308089| train set 5.008x speedup, test set 0.963x speedup, val set 1.006x speedup, step: 7
Epoch 113/200 |loss: 8.561015| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 8
Epoch 114/200 |loss: 9.376330| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 9
Epoch 115/200 |loss: 7.805611| train set 5.008x speedup, test set 0.963x speedup, val set 1.006x speedup, step: 10
Epoch 116/200 |loss: 7.977563| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 11
Epoch 117/200 |loss: 10.089790| train set 5.008x speedup, test set 0.974x speedup, val set 1.006x speedup, step: 12
Epoch 118/200 |loss: 8.715019| train set 5.008x speedup, test set 0.974x speedup, val set 1.006x speedup, step: 13
Epoch 119/200 |loss: 8.914914| train set 5.008x speedup, test set 0.963x speedup, val set 0.841x speedup, step: 14
Epoch 120/200 |loss: 9.688199| train set 5.008x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 15
Epoch 121/200 |loss: 8.667699| train set 5.008x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 122/200 |loss: 8.743821| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 123/200 |loss: 6.974974| train set 4.958x speedup, test set 0.963x speedup, val set 0.841x speedup, step: 2
Epoch 124/200 |loss: 9.121526| train set 4.920x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 3
Epoch 125/200 |loss: 9.272569| train set 4.920x speedup, test set 0.974x speedup, val set 0.980x speedup, step: 4
Epoch 126/200 |loss: 10.406606| train set 5.007x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 5
Epoch 127/200 |loss: 8.895552| train set 5.007x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 6
Epoch 128/200 |loss: 9.391977| train set 5.007x speedup, test set 0.963x speedup, val set 0.786x speedup, step: 7
Epoch 129/200 |loss: 8.486826| train set 5.008x speedup, test set 0.974x speedup, val set 0.762x speedup, step: 8
Epoch 130/200 |loss: 9.349296| train set 5.008x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 9
Epoch 131/200 |loss: 8.992129| train set 5.008x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 10
Epoch 132/200 |loss: 9.283859| train set 4.958x speedup, test set 0.974x speedup, val set 0.980x speedup, step: 11
Epoch 133/200 |loss: 7.745139| train set 4.958x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 12
Epoch 134/200 |loss: 6.937171| train set 4.958x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 13
Epoch 135/200 |loss: 8.508618| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 14
Epoch 136/200 |loss: 7.530498| train set 5.008x speedup, test set 0.961x speedup, val set 0.841x speedup, step: 15
Epoch 137/200 |loss: 8.685474| train set 5.008x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 16
Epoch 138/200 |loss: 9.607595| train set 5.008x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 17
Epoch 139/200 |loss: 9.052898| train set 4.958x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 18
Epoch 140/200 |loss: 7.905651| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.333348| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 2
Epoch 142/200 |loss: 8.692729| train set 4.921x speedup, test set 0.963x speedup, val set 0.868x speedup, step: 3
Epoch 143/200 |loss: 9.201167| train set 4.999x speedup, test set 0.974x speedup, val set 1.006x speedup, step: 4
Epoch 144/200 |loss: 8.711851| train set 4.957x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 5
Epoch 145/200 |loss: 9.572752| train set 5.008x speedup, test set 0.963x speedup, val set 0.902x speedup, step: 6
Epoch 146/200 |loss: 9.385171| train set 4.921x speedup, test set 0.963x speedup, val set 0.777x speedup, step: 7
Epoch 147/200 |loss: 10.035020| train set 4.957x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 148/200 |loss: 8.542397| train set 5.007x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 9.225000| train set 5.007x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 150/200 |loss: 9.743671| train set 5.007x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 2
Epoch 151/200 |loss: 9.203785| train set 5.007x speedup, test set 0.974x speedup, val set 0.980x speedup, step: 3
Epoch 152/200 |loss: 7.923103| train set 4.921x speedup, test set 0.974x speedup, val set 0.980x speedup, step: 4
Epoch 153/200 |loss: 10.035107| train set 5.008x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 5
Epoch 154/200 |loss: 8.894736| train set 5.008x speedup, test set 0.974x speedup, val set 0.957x speedup, step: 6
Epoch 155/200 |loss: 9.273043| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 7
Epoch 156/200 |loss: 8.925013| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 157/200 |loss: 9.140197| train set 4.873x speedup, test set 0.963x speedup, val set 0.957x speedup, step: 9
Epoch 158/200 |loss: 10.550756| train set 4.873x speedup, test set 0.974x speedup, val set 0.968x speedup, step: 10
Epoch 159/200 |loss: 7.765252| train set 5.008x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 11
Epoch 160/200 |loss: 7.843362| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 12
Epoch 161/200 |loss: 9.159359| train set 5.008x speedup, test set 0.952x speedup, val set 0.868x speedup, step: 13
Epoch 162/200 |loss: 8.110409| train set 5.008x speedup, test set 0.952x speedup, val set 0.804x speedup, step: 14
Epoch 163/200 |loss: 7.753253| train set 5.008x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 15
Epoch 164/200 |loss: 8.650399| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 16
Epoch 165/200 |loss: 7.995556| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 17
Epoch 166/200 |loss: 9.074374| train set 4.921x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 18
Epoch 167/200 |loss: 9.320118| train set 4.920x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 19
Epoch 168/200 |loss: 8.623935| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.359920| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 170/200 |loss: 8.528452| train set 4.873x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 2
Epoch 171/200 |loss: 9.342908| train set 4.873x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 3
Epoch 172/200 |loss: 9.683587| train set 4.958x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 4
Epoch 173/200 |loss: 8.079578| train set 4.957x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 5
Epoch 174/200 |loss: 8.838924| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 6
Epoch 175/200 |loss: 9.934142| train set 4.920x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 9.143788| train set 5.007x speedup, test set 0.961x speedup, val set 0.804x speedup, step: 8
Epoch 177/200 |loss: 8.460016| train set 5.007x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 9
Epoch 178/200 |loss: 9.159567| train set 4.958x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 10
Epoch 179/200 |loss: 8.509392| train set 4.958x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 11
Epoch 180/200 |loss: 8.940900| train set 4.958x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 12
Epoch 181/200 |loss: 8.685541| train set 4.958x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 13
Epoch 182/200 |loss: 9.365477| train set 4.958x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 14
Epoch 183/200 |loss: 8.261625| train set 4.958x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 15
Epoch 184/200 |loss: 7.500705| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 16
Epoch 185/200 |loss: 8.379606| train set 5.007x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 17
Epoch 186/200 |loss: 8.983660| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 18
Epoch 187/200 |loss: 8.400666| train set 5.007x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 19
Epoch 188/200 |loss: 8.198247| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 20
Epoch 189/200 |loss: 8.688586| train set 5.007x speedup, test set 0.963x speedup, val set 0.901x speedup, step: 21
Epoch 190/200 |loss: 8.612141| train set 5.007x speedup, test set 0.961x speedup, val set 0.742x speedup, step: 22
Epoch 191/200 |loss: 7.789099| train set 5.008x speedup, test set 0.963x speedup, val set 0.813x speedup, step: 23
Epoch 192/200 |loss: 9.564013| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 24
Epoch 193/200 |loss: 9.169730| train set 4.921x speedup, test set 0.963x speedup, val set 0.799x speedup, step: 25
Epoch 194/200 |loss: 9.421250| train set 4.921x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 26
Epoch 195/200 |loss: 7.541135| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 27
Epoch 196/200 |loss: 8.447224| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 28
Epoch 197/200 |loss: 8.886034| train set 4.958x speedup, test set 0.961x speedup, val set 0.795x speedup, step: 29
Epoch 198/200 |loss: 9.203151| train set 4.958x speedup, test set 0.961x speedup, val set 0.795x speedup, step: 30
Epoch 199/200 |loss: 7.652840| train set 4.958x speedup, test set 0.961x speedup, val set 0.868x speedup, step: 31
Training per epoch cost 0.378 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 1.001, val speedup 0.965
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 169, train speedup 4.958, test speedup 0.963, val speedup 1.302
last model at epoch 199, train speedup 4.958, test speedup 0.961, val speedup 0.868
execution cost 0:03:05.791844
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.004916, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286847| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793527| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089631| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913025| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588147| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.558286| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.379582| train set 3.958x speedup, test set 1.040x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.760285| train set 4.032x speedup, test set 0.990x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.461717| train set 4.630x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.913137| train set 4.630x speedup, test set 0.870x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 13.903443| train set 4.630x speedup, test set 0.870x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.083242| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.477353| train set 4.630x speedup, test set 1.014x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.484351| train set 4.670x speedup, test set 0.864x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.242603| train set 4.958x speedup, test set 1.032x speedup, val set 0.733x speedup, step: 19
Epoch 19/200 |loss: 10.133667| train set 4.958x speedup, test set 0.990x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.261764| train set 4.631x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.475408| train set 4.895x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.062771| train set 4.673x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 23
Epoch 23/200 |loss: 10.508967| train set 5.007x speedup, test set 0.966x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 11.710320| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.251395| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.416916| train set 5.008x speedup, test set 1.021x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 11.636400| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 28
Epoch 28/200 |loss: 10.318160| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 9.573848| train set 5.008x speedup, test set 0.914x speedup, val set 1.033x speedup, step: 30
Epoch 30/200 |loss: 10.331101| train set 4.988x speedup, test set 0.876x speedup, val set 1.033x speedup, step: 31
Epoch 31/200 |loss: 10.326463| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.225081| train set 4.708x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 9.661064| train set 4.708x speedup, test set 0.998x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.225362| train set 4.894x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 11.800601| train set 5.007x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 11.385359| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 10.275039| train set 4.638x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 38
Epoch 38/200 |loss: 10.225534| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 9.810513| train set 5.008x speedup, test set 1.003x speedup, val set 0.994x speedup, step: 40
Epoch 40/200 |loss: 9.572107| train set 5.008x speedup, test set 1.003x speedup, val set 1.211x speedup, step: 41
Epoch 41/200 |loss: 9.862129| train set 4.638x speedup, test set 1.003x speedup, val set 1.211x speedup, step: 42
Epoch 42/200 |loss: 10.652713| train set 4.958x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 43
Epoch 43/200 |loss: 10.887522| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.790329| train set 4.958x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 45
Epoch 45/200 |loss: 9.922026| train set 4.917x speedup, test set 0.991x speedup, val set 0.868x speedup, step: 46
Epoch 46/200 |loss: 10.516265| train set 4.754x speedup, test set 0.998x speedup, val set 1.253x speedup, step: 47
Epoch 47/200 |loss: 10.417652| train set 4.754x speedup, test set 1.003x speedup, val set 0.994x speedup, step: 48
Epoch 48/200 |loss: 9.711751| train set 4.754x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 10.190185| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.707272| train set 4.958x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 51
Epoch 51/200 |loss: 9.993183| train set 5.002x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 52
Epoch 52/200 |loss: 10.959632| train set 5.008x speedup, test set 1.003x speedup, val set 0.957x speedup, step: 53
Epoch 53/200 |loss: 9.178349| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 54
Epoch 54/200 |loss: 8.889633| train set 4.714x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.823504| train set 5.007x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 8.905042| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 57
Epoch 57/200 |loss: 10.412750| train set 4.921x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 58
Epoch 58/200 |loss: 9.205392| train set 5.008x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.635787| train set 4.957x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 60
Epoch 60/200 |loss: 8.956164| train set 5.007x speedup, test set 0.979x speedup, val set 0.882x speedup, step: 61
Epoch 61/200 |loss: 10.186444| train set 4.921x speedup, test set 0.979x speedup, val set 1.133x speedup, step: 62
Epoch 62/200 |loss: 7.772981| train set 4.873x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 63
Epoch 63/200 |loss: 8.604424| train set 4.921x speedup, test set 0.980x speedup, val set 1.302x speedup, step: 64
Epoch 64/200 |loss: 8.110144| train set 5.007x speedup, test set 0.980x speedup, val set 1.302x speedup, step: 65
Epoch 65/200 |loss: 8.701426| train set 5.007x speedup, test set 0.980x speedup, val set 1.316x speedup, step: 66
Epoch 66/200 |loss: 9.649405| train set 5.004x speedup, test set 0.980x speedup, val set 1.228x speedup, step: 67
Epoch 67/200 |loss: 7.577334| train set 5.008x speedup, test set 0.980x speedup, val set 1.149x speedup, step: 68
Epoch 68/200 |loss: 9.162602| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 69
Epoch 69/200 |loss: 9.021787| train set 5.008x speedup, test set 0.980x speedup, val set 1.211x speedup, step: 70
Epoch 70/200 |loss: 8.480287| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 71
Epoch 71/200 |loss: 9.497877| train set 4.958x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 72
Epoch 72/200 |loss: 8.063570| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 73
Epoch 73/200 |loss: 9.023952| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.286535| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.897108| train set 4.921x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.052579| train set 4.921x speedup, test set 1.003x speedup, val set 0.980x speedup, step: 77
Epoch 77/200 |loss: 8.375267| train set 5.007x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 78
Epoch 78/200 |loss: 9.177056| train set 5.003x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.663245| train set 4.917x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 80
Epoch 80/200 |loss: 7.650442| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.006438| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 9.137301| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 83
Epoch 83/200 |loss: 8.352047| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 9.162673| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.042440| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.976219| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 87
Epoch 87/200 |loss: 9.712144| train set 5.008x speedup, test set 0.991x speedup, val set 1.211x speedup, step: 88
Epoch 88/200 |loss: 8.008677| train set 4.883x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 89
Epoch 89/200 |loss: 8.176457| train set 4.883x speedup, test set 0.987x speedup, val set 0.733x speedup, step: 90
Epoch 90/200 |loss: 8.991003| train set 5.008x speedup, test set 0.987x speedup, val set 0.775x speedup, step: 91
Epoch 91/200 |loss: 8.509627| train set 5.008x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 92
Epoch 92/200 |loss: 8.503310| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 93
Epoch 93/200 |loss: 9.260453| train set 5.008x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 94
Epoch 94/200 |loss: 8.553044| train set 4.958x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 95
Epoch 95/200 |loss: 9.003377| train set 4.958x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 9.298045| train set 4.958x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 97
Epoch 97/200 |loss: 8.826204| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.834038| train set 5.008x speedup, test set 0.991x speedup, val set 1.133x speedup, step: 99
Epoch 99/200 |loss: 9.557980| train set 5.008x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 100
Epoch 100/200 |loss: 9.282982| train set 5.008x speedup, test set 0.987x speedup, val set 1.149x speedup, step: 1
Epoch 101/200 |loss: 10.094112| train set 4.671x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 102/200 |loss: 9.017989| train set 4.958x speedup, test set 0.987x speedup, val set 1.241x speedup, step: 2
Epoch 103/200 |loss: 9.342019| train set 4.917x speedup, test set 0.987x speedup, val set 0.804x speedup, step: 3
Epoch 104/200 |loss: 8.634157| train set 4.920x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 4
Epoch 105/200 |loss: 7.586076| train set 5.007x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.454311| train set 5.007x speedup, test set 0.991x speedup, val set 1.133x speedup, step: 2
Epoch 107/200 |loss: 8.861827| train set 5.007x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 3
Epoch 108/200 |loss: 8.519238| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 4
Epoch 109/200 |loss: 9.726389| train set 4.715x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 1
Epoch 110/200 |loss: 7.642891| train set 5.008x speedup, test set 0.987x speedup, val set 1.014x speedup, step: 2
Epoch 111/200 |loss: 9.187183| train set 5.004x speedup, test set 0.987x speedup, val set 0.968x speedup, step: 3
Epoch 112/200 |loss: 9.418051| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 4
Epoch 113/200 |loss: 8.825626| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 5
Epoch 114/200 |loss: 9.366714| train set 5.008x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 6
Epoch 115/200 |loss: 8.013752| train set 5.008x speedup, test set 0.990x speedup, val set 1.133x speedup, step: 7
Epoch 116/200 |loss: 8.282879| train set 5.008x speedup, test set 0.990x speedup, val set 1.302x speedup, step: 1
Epoch 117/200 |loss: 9.770206| train set 5.008x speedup, test set 0.999x speedup, val set 1.133x speedup, step: 2
Epoch 118/200 |loss: 8.809021| train set 5.008x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 3
Epoch 119/200 |loss: 8.840361| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 4
Epoch 120/200 |loss: 9.599234| train set 5.008x speedup, test set 0.987x speedup, val set 1.228x speedup, step: 5
Epoch 121/200 |loss: 8.730835| train set 4.958x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 1
Epoch 122/200 |loss: 8.627002| train set 4.958x speedup, test set 0.987x speedup, val set 1.241x speedup, step: 2
Epoch 123/200 |loss: 6.964407| train set 4.873x speedup, test set 0.987x speedup, val set 0.836x speedup, step: 3
Epoch 124/200 |loss: 9.347046| train set 4.872x speedup, test set 0.987x speedup, val set 0.990x speedup, step: 4
Epoch 125/200 |loss: 9.078021| train set 4.920x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 126/200 |loss: 10.195054| train set 5.007x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 127/200 |loss: 8.874059| train set 5.007x speedup, test set 0.987x speedup, val set 0.944x speedup, step: 2
Epoch 128/200 |loss: 9.583066| train set 5.007x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 3
Epoch 129/200 |loss: 8.350472| train set 5.008x speedup, test set 0.999x speedup, val set 0.742x speedup, step: 4
Epoch 130/200 |loss: 9.275376| train set 5.008x speedup, test set 0.999x speedup, val set 1.133x speedup, step: 5
Epoch 131/200 |loss: 8.802297| train set 4.958x speedup, test set 0.994x speedup, val set 1.302x speedup, step: 1
Epoch 132/200 |loss: 9.300977| train set 4.954x speedup, test set 0.987x speedup, val set 1.165x speedup, step: 2
Epoch 133/200 |loss: 7.601507| train set 4.958x speedup, test set 0.987x speedup, val set 1.316x speedup, step: 1
Epoch 134/200 |loss: 7.110544| train set 4.958x speedup, test set 0.999x speedup, val set 1.316x speedup, step: 1
Epoch 135/200 |loss: 8.602033| train set 5.008x speedup, test set 0.987x speedup, val set 1.316x speedup, step: 1
Epoch 136/200 |loss: 7.572729| train set 5.008x speedup, test set 0.987x speedup, val set 0.795x speedup, step: 2
Epoch 137/200 |loss: 8.628082| train set 5.008x speedup, test set 0.987x speedup, val set 0.813x speedup, step: 3
Epoch 138/200 |loss: 9.483231| train set 4.715x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 4
Epoch 139/200 |loss: 9.078447| train set 4.671x speedup, test set 0.991x speedup, val set 1.315x speedup, step: 5
Epoch 140/200 |loss: 8.196863| train set 4.958x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 6
Epoch 141/200 |loss: 8.381152| train set 4.958x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 7
Epoch 142/200 |loss: 8.915106| train set 4.921x speedup, test set 0.987x speedup, val set 0.944x speedup, step: 8
Epoch 143/200 |loss: 9.612223| train set 4.866x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 9
Epoch 144/200 |loss: 8.951768| train set 4.957x speedup, test set 0.987x speedup, val set 1.316x speedup, step: 1
Epoch 145/200 |loss: 10.447448| train set 4.957x speedup, test set 0.978x speedup, val set 1.316x speedup, step: 1
Epoch 146/200 |loss: 8.972759| train set 4.921x speedup, test set 0.978x speedup, val set 0.868x speedup, step: 2
Epoch 147/200 |loss: 10.015543| train set 4.920x speedup, test set 0.987x speedup, val set 1.165x speedup, step: 3
Epoch 148/200 |loss: 8.453740| train set 5.007x speedup, test set 0.987x speedup, val set 1.316x speedup, step: 1
Epoch 149/200 |loss: 8.920717| train set 5.007x speedup, test set 0.987x speedup, val set 1.316x speedup, step: 1
Epoch 150/200 |loss: 9.582295| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 2
Epoch 151/200 |loss: 9.137282| train set 4.920x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 3
Epoch 152/200 |loss: 7.755679| train set 4.921x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 4
Epoch 153/200 |loss: 9.801787| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 5
Epoch 154/200 |loss: 8.930163| train set 5.008x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 6
Epoch 155/200 |loss: 9.230259| train set 5.008x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 7
Epoch 156/200 |loss: 8.829025| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 8
Epoch 157/200 |loss: 9.329419| train set 4.958x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 9
Epoch 158/200 |loss: 10.475158| train set 4.921x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 10
Epoch 159/200 |loss: 7.840354| train set 5.004x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 11
Epoch 160/200 |loss: 7.912274| train set 5.008x speedup, test set 0.962x speedup, val set 0.742x speedup, step: 12
Epoch 161/200 |loss: 9.322787| train set 5.008x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 13
Epoch 162/200 |loss: 8.204887| train set 5.008x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 14
Epoch 163/200 |loss: 7.597295| train set 5.008x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 15
Epoch 164/200 |loss: 8.907756| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 16
Epoch 165/200 |loss: 7.942828| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 17
Epoch 166/200 |loss: 8.877685| train set 5.007x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 18
Epoch 167/200 |loss: 9.417453| train set 4.920x speedup, test set 0.978x speedup, val set 1.149x speedup, step: 19
Epoch 168/200 |loss: 8.783798| train set 4.957x speedup, test set 0.962x speedup, val set 1.302x speedup, step: 20
Epoch 169/200 |loss: 8.170443| train set 4.958x speedup, test set 0.962x speedup, val set 1.316x speedup, step: 1
Epoch 170/200 |loss: 8.455873| train set 4.873x speedup, test set 0.962x speedup, val set 0.729x speedup, step: 2
Epoch 171/200 |loss: 9.241099| train set 4.873x speedup, test set 0.962x speedup, val set 0.729x speedup, step: 3
Epoch 172/200 |loss: 9.474773| train set 4.958x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 4
Epoch 173/200 |loss: 8.059082| train set 4.957x speedup, test set 0.966x speedup, val set 0.739x speedup, step: 5
Epoch 174/200 |loss: 8.556230| train set 4.920x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 6
Epoch 175/200 |loss: 9.642391| train set 4.920x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 7
Epoch 176/200 |loss: 9.007115| train set 5.007x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 8
Epoch 177/200 |loss: 8.300385| train set 4.957x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 9
Epoch 178/200 |loss: 9.069543| train set 4.958x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 10
Epoch 179/200 |loss: 8.431332| train set 4.873x speedup, test set 0.962x speedup, val set 0.742x speedup, step: 11
Epoch 180/200 |loss: 9.151624| train set 4.958x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 12
Epoch 181/200 |loss: 8.464786| train set 4.958x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 13
Epoch 182/200 |loss: 9.209237| train set 4.958x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 14
Epoch 183/200 |loss: 8.316113| train set 4.958x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 15
Epoch 184/200 |loss: 7.289821| train set 5.008x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 16
Epoch 185/200 |loss: 8.467472| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 17
Epoch 186/200 |loss: 8.862367| train set 5.008x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 18
Epoch 187/200 |loss: 8.292071| train set 5.007x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 19
Epoch 188/200 |loss: 8.095257| train set 5.007x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 20
Epoch 189/200 |loss: 8.614479| train set 5.007x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 21
Epoch 190/200 |loss: 8.593935| train set 5.007x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 22
Epoch 191/200 |loss: 7.890014| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 23
Epoch 192/200 |loss: 9.756392| train set 4.921x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 24
Epoch 193/200 |loss: 9.096994| train set 4.921x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 25
Epoch 194/200 |loss: 9.601185| train set 4.921x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 26
Epoch 195/200 |loss: 7.469265| train set 4.873x speedup, test set 0.987x speedup, val set 1.133x speedup, step: 27
Epoch 196/200 |loss: 8.519625| train set 4.873x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 28
Epoch 197/200 |loss: 8.766221| train set 4.954x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 29
Epoch 198/200 |loss: 9.126854| train set 4.954x speedup, test set 0.978x speedup, val set 0.762x speedup, step: 30
Epoch 199/200 |loss: 7.549244| train set 4.954x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 31
Training per epoch cost 0.381 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 25, train speedup 5.008, test speedup 0.979, val speedup 0.729
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 169, train speedup 4.958, test speedup 0.962, val speedup 1.316
last model at epoch 199, train speedup 4.954, test speedup 0.978, val speedup 0.742
execution cost 0:03:04.360112
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:01.090695, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281971| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793519| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089584| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912633| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587201| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575415| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370780| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755564| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455396| train set 4.285x speedup, test set 0.975x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921760| train set 4.630x speedup, test set 0.870x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914979| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.108997| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590150| train set 4.630x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591464| train set 4.670x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213896| train set 5.008x speedup, test set 1.001x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153141| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.500167| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.041807| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.293589| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.717368| train set 5.007x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.930545| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.713589| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.632062| train set 4.958x speedup, test set 1.003x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.324127| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.413005| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 10.282682| train set 4.921x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.612876| train set 5.008x speedup, test set 0.895x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.498895| train set 4.958x speedup, test set 1.013x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.635414| train set 4.708x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 10.918380| train set 4.412x speedup, test set 1.007x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.463887| train set 4.957x speedup, test set 0.998x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 13.550175| train set 5.007x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.875888| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.890909| train set 5.008x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 10.281030| train set 5.008x speedup, test set 1.003x speedup, val set 0.733x speedup, step: 39
Epoch 39/200 |loss: 11.025032| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.664510| train set 4.958x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 41
Epoch 41/200 |loss: 11.232327| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.189466| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 43
Epoch 43/200 |loss: 10.484499| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.094963| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 8.996494| train set 4.895x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 10.133996| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 47
Epoch 47/200 |loss: 10.014064| train set 4.674x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 48
Epoch 48/200 |loss: 9.499674| train set 5.008x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 49
Epoch 49/200 |loss: 9.872174| train set 5.008x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 50
Epoch 50/200 |loss: 9.481225| train set 4.958x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 51
Epoch 51/200 |loss: 10.014282| train set 4.958x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 52
Epoch 52/200 |loss: 10.596741| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 8.818626| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.862832| train set 4.715x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 55
Epoch 55/200 |loss: 9.585063| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 56
Epoch 56/200 |loss: 8.842161| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 9.901047| train set 4.920x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.536654| train set 4.753x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.784475| train set 5.007x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 60
Epoch 60/200 |loss: 9.275866| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.240872| train set 4.958x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 62
Epoch 62/200 |loss: 8.006732| train set 4.873x speedup, test set 1.003x speedup, val set 1.133x speedup, step: 63
Epoch 63/200 |loss: 8.692757| train set 4.869x speedup, test set 1.003x speedup, val set 0.798x speedup, step: 64
Epoch 64/200 |loss: 8.412671| train set 5.007x speedup, test set 0.991x speedup, val set 0.957x speedup, step: 65
Epoch 65/200 |loss: 8.772652| train set 5.008x speedup, test set 0.991x speedup, val set 0.798x speedup, step: 66
Epoch 66/200 |loss: 9.837659| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 67
Epoch 67/200 |loss: 7.467071| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.079784| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.097318| train set 5.008x speedup, test set 0.991x speedup, val set 0.934x speedup, step: 70
Epoch 70/200 |loss: 8.415428| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.464017| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 7.730901| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 73
Epoch 73/200 |loss: 9.049046| train set 5.007x speedup, test set 1.003x speedup, val set 1.316x speedup, step: 74
Epoch 74/200 |loss: 9.494691| train set 4.957x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.779591| train set 5.007x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 76
Epoch 76/200 |loss: 7.335392| train set 5.007x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.381079| train set 5.007x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 78
Epoch 78/200 |loss: 9.350300| train set 5.007x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 79
Epoch 79/200 |loss: 8.939109| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 80
Epoch 80/200 |loss: 7.751815| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 81
Epoch 81/200 |loss: 10.319891| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 9.004356| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 83
Epoch 83/200 |loss: 8.773989| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 84
Epoch 84/200 |loss: 8.913945| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.219255| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.876372| train set 4.715x speedup, test set 0.996x speedup, val set 1.133x speedup, step: 87
Epoch 87/200 |loss: 9.577798| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 7.701770| train set 4.958x speedup, test set 1.003x speedup, val set 1.133x speedup, step: 89
Epoch 89/200 |loss: 8.161386| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 90
Epoch 90/200 |loss: 8.710512| train set 5.008x speedup, test set 1.003x speedup, val set 0.957x speedup, step: 91
Epoch 91/200 |loss: 8.529644| train set 5.008x speedup, test set 1.003x speedup, val set 1.211x speedup, step: 92
Epoch 92/200 |loss: 8.342539| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 93
Epoch 93/200 |loss: 9.337676| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 94
Epoch 94/200 |loss: 8.427777| train set 4.958x speedup, test set 1.003x speedup, val set 1.133x speedup, step: 95
Epoch 95/200 |loss: 9.067400| train set 4.958x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 8.986715| train set 4.958x speedup, test set 1.003x speedup, val set 0.735x speedup, step: 97
Epoch 97/200 |loss: 9.007810| train set 4.958x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.673475| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 99
Epoch 99/200 |loss: 9.154770| train set 5.008x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 100
Epoch 100/200 |loss: 9.163733| train set 4.921x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 1
Epoch 101/200 |loss: 10.135765| train set 4.715x speedup, test set 0.978x speedup, val set 1.133x speedup, step: 1
Epoch 102/200 |loss: 8.723783| train set 4.952x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 1
Epoch 103/200 |loss: 9.504595| train set 5.004x speedup, test set 0.966x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.740789| train set 5.007x speedup, test set 0.991x speedup, val set 0.762x speedup, step: 3
Epoch 105/200 |loss: 7.694509| train set 5.007x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.443994| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 2
Epoch 107/200 |loss: 9.048916| train set 5.007x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 3
Epoch 108/200 |loss: 8.378597| train set 4.488x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 4
Epoch 109/200 |loss: 9.472144| train set 4.489x speedup, test set 1.003x speedup, val set 0.762x speedup, step: 5
Epoch 110/200 |loss: 7.486162| train set 4.954x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 6
Epoch 111/200 |loss: 9.097816| train set 4.958x speedup, test set 0.999x speedup, val set 0.934x speedup, step: 7
Epoch 112/200 |loss: 9.365576| train set 4.958x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 8
Epoch 113/200 |loss: 8.935375| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 9
Epoch 114/200 |loss: 9.218771| train set 5.008x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 10
Epoch 115/200 |loss: 8.136110| train set 5.008x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 11
Epoch 116/200 |loss: 8.141643| train set 5.008x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 12
Epoch 117/200 |loss: 9.761273| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 13
Epoch 118/200 |loss: 8.640953| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 14
Epoch 119/200 |loss: 9.286987| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 15
Epoch 120/200 |loss: 9.633545| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 16
Epoch 121/200 |loss: 8.587146| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 17
Epoch 122/200 |loss: 8.703151| train set 4.958x speedup, test set 0.994x speedup, val set 0.735x speedup, step: 18
Epoch 123/200 |loss: 6.996136| train set 4.958x speedup, test set 1.003x speedup, val set 0.735x speedup, step: 19
Epoch 124/200 |loss: 9.337248| train set 4.920x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 20
Epoch 125/200 |loss: 9.135296| train set 4.920x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 21
Epoch 126/200 |loss: 9.817704| train set 4.920x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 22
Epoch 127/200 |loss: 8.557998| train set 5.007x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 23
Epoch 128/200 |loss: 8.942345| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 24
Epoch 129/200 |loss: 8.152450| train set 5.008x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 25
Epoch 130/200 |loss: 9.124773| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 26
Epoch 131/200 |loss: 8.650373| train set 4.958x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 27
Epoch 132/200 |loss: 9.062860| train set 4.954x speedup, test set 0.994x speedup, val set 0.735x speedup, step: 28
Epoch 133/200 |loss: 7.401043| train set 4.709x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 29
Epoch 134/200 |loss: 6.918634| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 30
Epoch 135/200 |loss: 8.631448| train set 5.008x speedup, test set 0.982x speedup, val set 0.733x speedup, step: 31
Epoch 136/200 |loss: 7.568540| train set 5.004x speedup, test set 0.978x speedup, val set 0.746x speedup, step: 32
Epoch 137/200 |loss: 8.760530| train set 5.004x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 33
Epoch 138/200 |loss: 9.490481| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 34
Epoch 139/200 |loss: 9.067427| train set 5.008x speedup, test set 0.966x speedup, val set 1.211x speedup, step: 35
Epoch 140/200 |loss: 8.384092| train set 4.958x speedup, test set 0.966x speedup, val set 1.211x speedup, step: 36
Epoch 141/200 |loss: 8.357315| train set 4.991x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 37
Epoch 142/200 |loss: 8.757543| train set 4.917x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 38
Epoch 143/200 |loss: 9.279215| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 39
Epoch 144/200 |loss: 8.569239| train set 4.957x speedup, test set 0.978x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.370762| train set 4.957x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 2
Epoch 146/200 |loss: 9.283882| train set 4.921x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 3
Epoch 147/200 |loss: 9.574864| train set 5.007x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4
Epoch 148/200 |loss: 8.356939| train set 5.007x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 8.965271| train set 5.007x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 150/200 |loss: 9.779182| train set 4.920x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 2
Epoch 151/200 |loss: 8.870008| train set 4.920x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 3
Epoch 152/200 |loss: 7.646641| train set 4.921x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4
Epoch 153/200 |loss: 9.821671| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 5
Epoch 154/200 |loss: 8.935314| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 6
Epoch 155/200 |loss: 9.146637| train set 5.008x speedup, test set 0.994x speedup, val set 0.735x speedup, step: 7
Epoch 156/200 |loss: 8.724075| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 8
Epoch 157/200 |loss: 9.374936| train set 4.958x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 9
Epoch 158/200 |loss: 10.493520| train set 4.921x speedup, test set 1.003x speedup, val set 0.735x speedup, step: 10
Epoch 159/200 |loss: 7.887406| train set 5.008x speedup, test set 1.003x speedup, val set 0.735x speedup, step: 11
Epoch 160/200 |loss: 7.666177| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 12
Epoch 161/200 |loss: 9.333141| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 13
Epoch 162/200 |loss: 8.073038| train set 5.008x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 14
Epoch 163/200 |loss: 7.585096| train set 5.008x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 15
Epoch 164/200 |loss: 8.761519| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 16
Epoch 165/200 |loss: 7.935423| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 17
Epoch 166/200 |loss: 8.918176| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 18
Epoch 167/200 |loss: 9.685663| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 19
Epoch 168/200 |loss: 8.760008| train set 4.957x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 20
Epoch 169/200 |loss: 8.154361| train set 4.957x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 21
Epoch 170/200 |loss: 8.677225| train set 4.873x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 22
Epoch 171/200 |loss: 9.305925| train set 4.873x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 23
Epoch 172/200 |loss: 9.764012| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 24
Epoch 173/200 |loss: 8.160714| train set 4.957x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 25
Epoch 174/200 |loss: 8.861025| train set 4.920x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 26
Epoch 175/200 |loss: 9.868606| train set 4.920x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 27
Epoch 176/200 |loss: 9.045504| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 28
Epoch 177/200 |loss: 8.355939| train set 4.957x speedup, test set 0.963x speedup, val set 0.798x speedup, step: 29
Epoch 178/200 |loss: 8.977882| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 30
Epoch 179/200 |loss: 8.424841| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 31
Epoch 180/200 |loss: 9.046103| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 32
Epoch 181/200 |loss: 8.555790| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 33
Epoch 182/200 |loss: 9.219249| train set 4.958x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 34
Epoch 183/200 |loss: 8.507374| train set 4.958x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 35
Epoch 184/200 |loss: 7.243340| train set 4.921x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 36
Epoch 185/200 |loss: 8.537458| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 37
Epoch 186/200 |loss: 8.800528| train set 4.753x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 38
Epoch 187/200 |loss: 8.279346| train set 4.753x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 39
Epoch 188/200 |loss: 8.292733| train set 5.007x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 40
Epoch 189/200 |loss: 8.667466| train set 5.007x speedup, test set 0.962x speedup, val set 0.742x speedup, step: 41
Epoch 190/200 |loss: 8.709990| train set 5.007x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 42
Epoch 191/200 |loss: 7.984183| train set 5.008x speedup, test set 0.962x speedup, val set 0.729x speedup, step: 43
Epoch 192/200 |loss: 9.872847| train set 4.921x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 44
Epoch 193/200 |loss: 9.303513| train set 4.921x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 45
Epoch 194/200 |loss: 9.763939| train set 4.921x speedup, test set 0.962x speedup, val set 0.735x speedup, step: 46
Epoch 195/200 |loss: 7.499662| train set 4.921x speedup, test set 0.978x speedup, val set 1.133x speedup, step: 47
Epoch 196/200 |loss: 8.581216| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 48
Epoch 197/200 |loss: 8.997353| train set 5.004x speedup, test set 0.961x speedup, val set 0.742x speedup, step: 49
Epoch 198/200 |loss: 9.151391| train set 5.004x speedup, test set 0.961x speedup, val set 0.804x speedup, step: 50
Epoch 199/200 |loss: 7.509483| train set 5.004x speedup, test set 0.961x speedup, val set 0.786x speedup, step: 51
Training per epoch cost 0.376 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.391s, pg runtime 0.391s, speedup 1.000x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 1.001, val speedup 0.965
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 149, train speedup 5.007, test speedup 0.999, val speedup 1.302
last model at epoch 199, train speedup 5.004, test speedup 0.961, val speedup 0.786
execution cost 0:03:00.585658
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.973158, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281973| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793522| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912633| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587204| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575417| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370784| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755564| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455399| train set 4.285x speedup, test set 0.975x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921763| train set 4.630x speedup, test set 0.870x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914977| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.109000| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590152| train set 4.630x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591466| train set 4.670x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213894| train set 5.008x speedup, test set 1.001x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153130| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.500229| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.041861| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.295305| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.714755| train set 5.007x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.941025| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.691510| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.565954| train set 4.958x speedup, test set 1.003x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.269189| train set 4.958x speedup, test set 1.017x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.376108| train set 5.008x speedup, test set 0.991x speedup, val set 0.775x speedup, step: 29
Epoch 29/200 |loss: 10.226847| train set 4.921x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.713391| train set 5.008x speedup, test set 0.955x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.304720| train set 4.958x speedup, test set 1.013x speedup, val set 1.040x speedup, step: 32
Epoch 32/200 |loss: 10.696547| train set 4.708x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 33
Epoch 33/200 |loss: 10.753702| train set 4.412x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.189034| train set 4.847x speedup, test set 0.925x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 13.355624| train set 5.007x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.874190| train set 5.008x speedup, test set 1.007x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.795411| train set 5.008x speedup, test set 1.014x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 10.426719| train set 4.715x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.895760| train set 5.008x speedup, test set 0.997x speedup, val set 0.855x speedup, step: 40
Epoch 40/200 |loss: 9.570409| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.505651| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.479791| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 43
Epoch 43/200 |loss: 10.680916| train set 4.958x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.601833| train set 4.958x speedup, test set 1.026x speedup, val set 1.041x speedup, step: 45
Epoch 45/200 |loss: 9.495975| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 10.679074| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 47
Epoch 47/200 |loss: 9.975257| train set 4.673x speedup, test set 0.984x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.819671| train set 4.674x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 10.068949| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.426068| train set 4.958x speedup, test set 1.003x speedup, val set 1.268x speedup, step: 51
Epoch 51/200 |loss: 9.695529| train set 4.958x speedup, test set 0.992x speedup, val set 1.302x speedup, step: 52
Epoch 52/200 |loss: 10.532947| train set 4.895x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 8.822418| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 9.101517| train set 4.715x speedup, test set 1.003x speedup, val set 0.957x speedup, step: 55
Epoch 55/200 |loss: 9.885164| train set 4.958x speedup, test set 1.005x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 9.251948| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.375752| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.903797| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 59
Epoch 59/200 |loss: 9.000680| train set 5.007x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 60
Epoch 60/200 |loss: 9.343914| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.741923| train set 4.958x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 62
Epoch 62/200 |loss: 8.067963| train set 4.873x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 63
Epoch 63/200 |loss: 8.985395| train set 4.871x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 64
Epoch 64/200 |loss: 8.340535| train set 4.920x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 65
Epoch 65/200 |loss: 9.013259| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 66
Epoch 66/200 |loss: 9.969330| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 67
Epoch 67/200 |loss: 7.613493| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.260265| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.342124| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.457761| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.122080| train set 5.007x speedup, test set 0.991x speedup, val set 0.957x speedup, step: 72
Epoch 72/200 |loss: 7.775324| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 73
Epoch 73/200 |loss: 9.156633| train set 5.007x speedup, test set 0.991x speedup, val set 1.133x speedup, step: 74
Epoch 74/200 |loss: 9.406398| train set 5.008x speedup, test set 0.991x speedup, val set 1.211x speedup, step: 75
Epoch 75/200 |loss: 8.929785| train set 4.958x speedup, test set 0.991x speedup, val set 1.211x speedup, step: 76
Epoch 76/200 |loss: 7.332308| train set 4.921x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.551157| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 78
Epoch 78/200 |loss: 9.104038| train set 5.007x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 79
Epoch 79/200 |loss: 8.902571| train set 5.007x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 80
Epoch 80/200 |loss: 7.666811| train set 4.921x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 81
Epoch 81/200 |loss: 10.513151| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 8.882557| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 83
Epoch 83/200 |loss: 8.696657| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 84
Epoch 84/200 |loss: 9.056964| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.239474| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.732198| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 87
Epoch 87/200 |loss: 9.516067| train set 5.008x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 88
Epoch 88/200 |loss: 7.922697| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 89
Epoch 89/200 |loss: 8.320872| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 90
Epoch 90/200 |loss: 8.600811| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 91
Epoch 91/200 |loss: 8.627092| train set 5.008x speedup, test set 1.012x speedup, val set 0.957x speedup, step: 92
Epoch 92/200 |loss: 8.281302| train set 5.008x speedup, test set 1.009x speedup, val set 0.957x speedup, step: 93
Epoch 93/200 |loss: 9.466179| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 94
Epoch 94/200 |loss: 8.462870| train set 4.958x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 95
Epoch 95/200 |loss: 9.119910| train set 4.958x speedup, test set 0.999x speedup, val set 0.775x speedup, step: 96
Epoch 96/200 |loss: 9.537695| train set 4.958x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 97
Epoch 97/200 |loss: 9.062928| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.742142| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 99
Epoch 99/200 |loss: 9.408761| train set 5.008x speedup, test set 0.992x speedup, val set 0.729x speedup, step: 100
Epoch 100/200 |loss: 9.096665| train set 4.921x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 1
Epoch 101/200 |loss: 10.138241| train set 4.715x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 1
Epoch 102/200 |loss: 9.039109| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 1
Epoch 103/200 |loss: 9.473050| train set 5.003x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 1
Epoch 104/200 |loss: 8.580803| train set 4.917x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 1
Epoch 105/200 |loss: 7.979438| train set 4.920x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 2
Epoch 106/200 |loss: 8.483151| train set 5.007x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 3
Epoch 107/200 |loss: 8.993069| train set 5.007x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 4
Epoch 108/200 |loss: 8.035665| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 5
Epoch 109/200 |loss: 9.475204| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 6
Epoch 110/200 |loss: 7.651547| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 7
Epoch 111/200 |loss: 9.200085| train set 4.958x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 8
Epoch 112/200 |loss: 9.679069| train set 5.008x speedup, test set 1.000x speedup, val set 0.729x speedup, step: 9
Epoch 113/200 |loss: 8.960978| train set 5.008x speedup, test set 1.000x speedup, val set 0.729x speedup, step: 10
Epoch 114/200 |loss: 9.762400| train set 5.008x speedup, test set 1.000x speedup, val set 0.729x speedup, step: 11
Epoch 115/200 |loss: 8.038180| train set 4.958x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 12
Epoch 116/200 |loss: 8.157362| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 13
Epoch 117/200 |loss: 10.029976| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 14
Epoch 118/200 |loss: 8.839401| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 15
Epoch 119/200 |loss: 8.671308| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 16
Epoch 120/200 |loss: 9.916009| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 17
Epoch 121/200 |loss: 8.560631| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 18
Epoch 122/200 |loss: 8.400707| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 19
Epoch 123/200 |loss: 7.102698| train set 4.958x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 1
Epoch 124/200 |loss: 9.160923| train set 4.918x speedup, test set 0.979x speedup, val set 0.795x speedup, step: 1
Epoch 125/200 |loss: 9.403806| train set 4.921x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 2
Epoch 126/200 |loss: 10.298309| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 3
Epoch 127/200 |loss: 8.747439| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 4
Epoch 128/200 |loss: 9.416719| train set 4.920x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 5
Epoch 129/200 |loss: 8.641802| train set 5.008x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 6
Epoch 130/200 |loss: 9.419443| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 7
Epoch 131/200 |loss: 8.913404| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 8
Epoch 132/200 |loss: 9.317141| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 9
Epoch 133/200 |loss: 7.603150| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 10
Epoch 134/200 |loss: 6.953559| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 11
Epoch 135/200 |loss: 8.712626| train set 5.008x speedup, test set 1.009x speedup, val set 0.729x speedup, step: 12
Epoch 136/200 |loss: 7.592028| train set 5.008x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 13
Epoch 137/200 |loss: 8.500817| train set 5.008x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 14
Epoch 138/200 |loss: 9.459390| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 15
Epoch 139/200 |loss: 9.109303| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 16
Epoch 140/200 |loss: 8.006919| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 17
Epoch 141/200 |loss: 8.254509| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 18
Epoch 142/200 |loss: 8.460366| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 19
Epoch 143/200 |loss: 9.342956| train set 4.991x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 20
Epoch 144/200 |loss: 8.561625| train set 4.957x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 1
Epoch 145/200 |loss: 9.441102| train set 4.872x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 2
Epoch 146/200 |loss: 9.083428| train set 4.920x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 3
Epoch 147/200 |loss: 9.756052| train set 4.920x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 4
Epoch 148/200 |loss: 8.312521| train set 5.007x speedup, test set 0.999x speedup, val set 1.149x speedup, step: 1
Epoch 149/200 |loss: 8.737655| train set 5.007x speedup, test set 0.999x speedup, val set 1.133x speedup, step: 2
Epoch 150/200 |loss: 9.619379| train set 4.920x speedup, test set 0.999x speedup, val set 0.742x speedup, step: 3
Epoch 151/200 |loss: 8.890091| train set 4.921x speedup, test set 0.999x speedup, val set 0.804x speedup, step: 4
Epoch 152/200 |loss: 7.879102| train set 4.921x speedup, test set 0.999x speedup, val set 0.742x speedup, step: 5
Epoch 153/200 |loss: 9.793655| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 6
Epoch 154/200 |loss: 9.096991| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 7
Epoch 155/200 |loss: 9.240816| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 156/200 |loss: 8.833185| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 9
Epoch 157/200 |loss: 9.288493| train set 5.008x speedup, test set 0.974x speedup, val set 0.762x speedup, step: 10
Epoch 158/200 |loss: 10.482641| train set 4.921x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 11
Epoch 159/200 |loss: 7.732623| train set 4.918x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 12
Epoch 160/200 |loss: 7.866553| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 13
Epoch 161/200 |loss: 9.190549| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 14
Epoch 162/200 |loss: 8.109242| train set 5.008x speedup, test set 0.963x speedup, val set 0.762x speedup, step: 15
Epoch 163/200 |loss: 7.599938| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 16
Epoch 164/200 |loss: 8.796290| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 17
Epoch 165/200 |loss: 7.851948| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 18
Epoch 166/200 |loss: 9.183428| train set 5.008x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 19
Epoch 167/200 |loss: 9.658833| train set 4.920x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 20
Epoch 168/200 |loss: 8.953020| train set 4.872x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 21
Epoch 169/200 |loss: 8.198418| train set 4.872x speedup, test set 0.974x speedup, val set 0.762x speedup, step: 22
Epoch 170/200 |loss: 8.621085| train set 4.873x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 23
Epoch 171/200 |loss: 9.326958| train set 4.873x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 24
Epoch 172/200 |loss: 9.900602| train set 4.873x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 25
Epoch 173/200 |loss: 8.101181| train set 4.957x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 26
Epoch 174/200 |loss: 8.827590| train set 4.957x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 27
Epoch 175/200 |loss: 9.940417| train set 4.917x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 28
Epoch 176/200 |loss: 9.020845| train set 4.917x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 29
Epoch 177/200 |loss: 8.278632| train set 5.007x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 30
Epoch 178/200 |loss: 9.007055| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 31
Epoch 179/200 |loss: 8.476491| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 32
Epoch 180/200 |loss: 8.854729| train set 5.002x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 33
Epoch 181/200 |loss: 8.465796| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 34
Epoch 182/200 |loss: 9.172888| train set 4.958x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 35
Epoch 183/200 |loss: 8.323100| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 36
Epoch 184/200 |loss: 7.504430| train set 4.958x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 37
Epoch 185/200 |loss: 8.551602| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 38
Epoch 186/200 |loss: 8.793257| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 39
Epoch 187/200 |loss: 8.192041| train set 5.007x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 40
Epoch 188/200 |loss: 8.318032| train set 5.007x speedup, test set 0.974x speedup, val set 0.806x speedup, step: 41
Epoch 189/200 |loss: 8.592210| train set 5.007x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 42
Epoch 190/200 |loss: 8.708240| train set 5.007x speedup, test set 0.969x speedup, val set 0.735x speedup, step: 43
Epoch 191/200 |loss: 7.761292| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 44
Epoch 192/200 |loss: 9.789383| train set 4.921x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 45
Epoch 193/200 |loss: 9.007177| train set 4.921x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 46
Epoch 194/200 |loss: 9.531697| train set 4.921x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 47
Epoch 195/200 |loss: 7.493858| train set 4.873x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 48
Epoch 196/200 |loss: 8.622498| train set 4.958x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 49
Epoch 197/200 |loss: 8.754080| train set 4.954x speedup, test set 0.963x speedup, val set 0.762x speedup, step: 50
Epoch 198/200 |loss: 9.300522| train set 4.954x speedup, test set 0.963x speedup, val set 0.809x speedup, step: 51
Epoch 199/200 |loss: 7.591877| train set 4.954x speedup, test set 0.963x speedup, val set 0.775x speedup, step: 52
Training per epoch cost 0.330 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.129s, pg runtime 0.129s, speedup 1.000x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 1.001, val speedup 0.965
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 148, train speedup 5.007, test speedup 0.999, val speedup 1.149
last model at epoch 199, train speedup 4.954, test speedup 0.963, val speedup 0.775
execution cost 0:02:41.941896
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.924306, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286845| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936656| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179352| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793533| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089046| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.911767| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587728| train set 3.349x speedup, test set 1.012x speedup, val set 0.733x speedup, step: 9
Epoch 9/200 |loss: 16.582365| train set 3.511x speedup, test set 0.994x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.371445| train set 3.958x speedup, test set 1.040x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.701103| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.376553| train set 4.286x speedup, test set 0.972x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.801852| train set 4.630x speedup, test set 0.880x speedup, val set 0.733x speedup, step: 14
Epoch 14/200 |loss: 13.742209| train set 4.630x speedup, test set 0.870x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 12.958076| train set 4.847x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.427330| train set 4.630x speedup, test set 1.028x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.274512| train set 4.671x speedup, test set 0.886x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.110075| train set 4.958x speedup, test set 1.007x speedup, val set 0.780x speedup, step: 19
Epoch 19/200 |loss: 10.071143| train set 4.958x speedup, test set 0.989x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.317323| train set 4.958x speedup, test set 1.032x speedup, val set 1.041x speedup, step: 21
Epoch 21/200 |loss: 11.567379| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 22
Epoch 22/200 |loss: 10.192303| train set 5.007x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 23
Epoch 23/200 |loss: 10.461909| train set 5.007x speedup, test set 0.993x speedup, val set 1.041x speedup, step: 24
Epoch 24/200 |loss: 11.534735| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.301335| train set 5.008x speedup, test set 0.980x speedup, val set 0.861x speedup, step: 26
Epoch 26/200 |loss: 10.269592| train set 5.008x speedup, test set 0.979x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 11.581318| train set 4.957x speedup, test set 0.991x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 10.439810| train set 4.958x speedup, test set 0.991x speedup, val set 0.994x speedup, step: 29
Epoch 29/200 |loss: 9.797617| train set 5.008x speedup, test set 1.001x speedup, val set 1.033x speedup, step: 30
Epoch 30/200 |loss: 10.449911| train set 5.008x speedup, test set 1.014x speedup, val set 1.033x speedup, step: 31
Epoch 31/200 |loss: 10.300808| train set 5.008x speedup, test set 1.002x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 10.210110| train set 4.708x speedup, test set 1.002x speedup, val set 1.033x speedup, step: 33
Epoch 33/200 |loss: 9.761739| train set 4.957x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.074234| train set 4.894x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 11.818503| train set 5.007x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 11.504009| train set 5.008x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 37
Epoch 37/200 |loss: 10.449770| train set 4.638x speedup, test set 0.987x speedup, val set 1.033x speedup, step: 38
Epoch 38/200 |loss: 10.076372| train set 5.008x speedup, test set 0.977x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 10.332978| train set 5.008x speedup, test set 1.004x speedup, val set 1.041x speedup, step: 40
Epoch 40/200 |loss: 9.431153| train set 5.008x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 41
Epoch 41/200 |loss: 9.927699| train set 4.921x speedup, test set 1.007x speedup, val set 1.302x speedup, step: 42
Epoch 42/200 |loss: 10.152627| train set 4.958x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 43
Epoch 43/200 |loss: 10.436088| train set 4.958x speedup, test set 1.017x speedup, val set 1.002x speedup, step: 44
Epoch 44/200 |loss: 11.539379| train set 4.958x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 45
Epoch 45/200 |loss: 9.461464| train set 4.754x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 46
Epoch 46/200 |loss: 10.026053| train set 4.753x speedup, test set 1.011x speedup, val set 1.316x speedup, step: 47
Epoch 47/200 |loss: 10.239188| train set 4.753x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 48
Epoch 48/200 |loss: 9.550893| train set 4.920x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 9.760447| train set 4.673x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.396539| train set 4.958x speedup, test set 1.003x speedup, val set 1.126x speedup, step: 51
Epoch 51/200 |loss: 9.960026| train set 4.873x speedup, test set 0.980x speedup, val set 0.983x speedup, step: 52
Epoch 52/200 |loss: 10.589643| train set 5.008x speedup, test set 0.980x speedup, val set 1.063x speedup, step: 53
Epoch 53/200 |loss: 8.865202| train set 5.008x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 54
Epoch 54/200 |loss: 9.169148| train set 4.928x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.411004| train set 5.008x speedup, test set 0.991x speedup, val set 1.022x speedup, step: 56
Epoch 56/200 |loss: 8.783956| train set 5.008x speedup, test set 0.991x speedup, val set 0.983x speedup, step: 57
Epoch 57/200 |loss: 10.122137| train set 5.008x speedup, test set 0.980x speedup, val set 1.108x speedup, step: 58
Epoch 58/200 |loss: 9.119156| train set 5.008x speedup, test set 0.980x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.334446| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 60
Epoch 60/200 |loss: 9.189923| train set 4.958x speedup, test set 0.991x speedup, val set 1.073x speedup, step: 61
Epoch 61/200 |loss: 10.119965| train set 4.873x speedup, test set 0.987x speedup, val set 0.957x speedup, step: 62
Epoch 62/200 |loss: 7.654154| train set 4.867x speedup, test set 0.991x speedup, val set 1.016x speedup, step: 63
Epoch 63/200 |loss: 8.731843| train set 4.594x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.265644| train set 4.920x speedup, test set 0.989x speedup, val set 1.228x speedup, step: 65
Epoch 65/200 |loss: 8.851727| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 66
Epoch 66/200 |loss: 9.762544| train set 5.004x speedup, test set 0.989x speedup, val set 0.841x speedup, step: 67
Epoch 67/200 |loss: 7.513335| train set 5.008x speedup, test set 0.985x speedup, val set 0.742x speedup, step: 68
Epoch 68/200 |loss: 9.181376| train set 5.008x speedup, test set 0.987x speedup, val set 0.733x speedup, step: 69
Epoch 69/200 |loss: 9.149803| train set 5.008x speedup, test set 0.985x speedup, val set 0.941x speedup, step: 70
Epoch 70/200 |loss: 8.503035| train set 5.008x speedup, test set 0.984x speedup, val set 0.735x speedup, step: 71
Epoch 71/200 |loss: 9.529885| train set 4.714x speedup, test set 0.985x speedup, val set 1.041x speedup, step: 72
Epoch 72/200 |loss: 8.230144| train set 5.007x speedup, test set 0.985x speedup, val set 1.214x speedup, step: 73
Epoch 73/200 |loss: 9.102214| train set 5.007x speedup, test set 0.986x speedup, val set 1.228x speedup, step: 74
Epoch 74/200 |loss: 9.501132| train set 5.008x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.799803| train set 4.991x speedup, test set 0.987x speedup, val set 1.202x speedup, step: 76
Epoch 76/200 |loss: 7.270579| train set 4.920x speedup, test set 0.973x speedup, val set 0.742x speedup, step: 77
Epoch 77/200 |loss: 8.898729| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 78
Epoch 78/200 |loss: 9.173660| train set 5.007x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 79
Epoch 79/200 |loss: 8.747443| train set 4.916x speedup, test set 0.989x speedup, val set 0.836x speedup, step: 80
Epoch 80/200 |loss: 7.891607| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.237127| train set 5.008x speedup, test set 1.032x speedup, val set 0.855x speedup, step: 82
Epoch 82/200 |loss: 9.279654| train set 5.004x speedup, test set 1.033x speedup, val set 0.809x speedup, step: 83
Epoch 83/200 |loss: 8.914893| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 9.276490| train set 4.921x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.478681| train set 5.008x speedup, test set 0.987x speedup, val set 1.228x speedup, step: 86
Epoch 86/200 |loss: 9.246827| train set 4.715x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 87
Epoch 87/200 |loss: 9.878517| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 8.123985| train set 4.958x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 89
Epoch 89/200 |loss: 8.610147| train set 5.008x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 90
Epoch 90/200 |loss: 8.944888| train set 5.008x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 91
Epoch 91/200 |loss: 8.732029| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.429380| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 93
Epoch 93/200 |loss: 9.616367| train set 5.008x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 94
Epoch 94/200 |loss: 8.697412| train set 5.008x speedup, test set 0.991x speedup, val set 1.093x speedup, step: 95
Epoch 95/200 |loss: 9.019539| train set 4.958x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 9.166845| train set 4.958x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 97
Epoch 97/200 |loss: 8.868458| train set 5.008x speedup, test set 0.991x speedup, val set 1.006x speedup, step: 98
Epoch 98/200 |loss: 8.670259| train set 5.008x speedup, test set 0.971x speedup, val set 1.302x speedup, step: 99
Epoch 99/200 |loss: 9.469866| train set 5.008x speedup, test set 0.970x speedup, val set 0.980x speedup, step: 100
Epoch 100/200 |loss: 8.945930| train set 5.008x speedup, test set 0.991x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 10.143608| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 1
Epoch 102/200 |loss: 8.774111| train set 5.008x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 1
Epoch 103/200 |loss: 9.169536| train set 5.004x speedup, test set 0.970x speedup, val set 0.742x speedup, step: 2
Epoch 104/200 |loss: 8.296072| train set 4.917x speedup, test set 0.970x speedup, val set 0.786x speedup, step: 3
Epoch 105/200 |loss: 7.803780| train set 5.007x speedup, test set 0.989x speedup, val set 1.211x speedup, step: 1
Epoch 106/200 |loss: 8.266758| train set 5.007x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 2
Epoch 107/200 |loss: 8.816080| train set 5.007x speedup, test set 0.985x speedup, val set 0.735x speedup, step: 3
Epoch 108/200 |loss: 7.765348| train set 5.007x speedup, test set 0.985x speedup, val set 0.735x speedup, step: 4
Epoch 109/200 |loss: 9.136197| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 5
Epoch 110/200 |loss: 7.489637| train set 5.008x speedup, test set 0.989x speedup, val set 0.739x speedup, step: 6
Epoch 111/200 |loss: 8.838214| train set 4.958x speedup, test set 0.989x speedup, val set 0.735x speedup, step: 7
Epoch 112/200 |loss: 9.652482| train set 4.991x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 8
Epoch 113/200 |loss: 8.697612| train set 5.008x speedup, test set 0.989x speedup, val set 0.746x speedup, step: 9
Epoch 114/200 |loss: 9.486022| train set 5.008x speedup, test set 0.991x speedup, val set 0.737x speedup, step: 10
Epoch 115/200 |loss: 7.995156| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 116/200 |loss: 7.915237| train set 5.008x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 2
Epoch 117/200 |loss: 10.024293| train set 5.008x speedup, test set 0.980x speedup, val set 0.735x speedup, step: 3
Epoch 118/200 |loss: 8.871638| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 4
Epoch 119/200 |loss: 8.846135| train set 5.008x speedup, test set 0.980x speedup, val set 0.742x speedup, step: 5
Epoch 120/200 |loss: 9.751483| train set 5.008x speedup, test set 0.980x speedup, val set 0.955x speedup, step: 6
Epoch 121/200 |loss: 8.585547| train set 5.008x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 7
Epoch 122/200 |loss: 8.534796| train set 4.958x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 123/200 |loss: 7.151788| train set 4.957x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 2
Epoch 124/200 |loss: 9.117390| train set 4.920x speedup, test set 0.967x speedup, val set 0.804x speedup, step: 3
Epoch 125/200 |loss: 9.266716| train set 5.007x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 4
Epoch 126/200 |loss: 10.315737| train set 5.007x speedup, test set 0.980x speedup, val set 1.302x speedup, step: 1
Epoch 127/200 |loss: 8.816515| train set 5.007x speedup, test set 0.980x speedup, val set 1.165x speedup, step: 2
Epoch 128/200 |loss: 9.559528| train set 4.920x speedup, test set 0.980x speedup, val set 0.804x speedup, step: 3
Epoch 129/200 |loss: 8.468281| train set 5.008x speedup, test set 0.980x speedup, val set 0.804x speedup, step: 4
Epoch 130/200 |loss: 9.290003| train set 5.008x speedup, test set 0.983x speedup, val set 1.149x speedup, step: 5
Epoch 131/200 |loss: 8.988958| train set 4.958x speedup, test set 0.983x speedup, val set 0.806x speedup, step: 6
Epoch 132/200 |loss: 9.539034| train set 4.954x speedup, test set 0.971x speedup, val set 0.770x speedup, step: 7
Epoch 133/200 |loss: 7.810571| train set 4.950x speedup, test set 0.971x speedup, val set 1.165x speedup, step: 8
Epoch 134/200 |loss: 7.034640| train set 4.671x speedup, test set 0.971x speedup, val set 1.241x speedup, step: 9
Epoch 135/200 |loss: 8.609522| train set 5.008x speedup, test set 0.979x speedup, val set 0.735x speedup, step: 10
Epoch 136/200 |loss: 7.590277| train set 5.008x speedup, test set 0.978x speedup, val set 0.804x speedup, step: 11
Epoch 137/200 |loss: 8.699053| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 12
Epoch 138/200 |loss: 9.595172| train set 5.008x speedup, test set 0.979x speedup, val set 0.762x speedup, step: 13
Epoch 139/200 |loss: 9.218034| train set 5.008x speedup, test set 0.980x speedup, val set 1.165x speedup, step: 14
Epoch 140/200 |loss: 7.907395| train set 4.958x speedup, test set 0.980x speedup, val set 1.228x speedup, step: 15
Epoch 141/200 |loss: 8.585939| train set 4.958x speedup, test set 0.980x speedup, val set 1.165x speedup, step: 16
Epoch 142/200 |loss: 8.602755| train set 5.008x speedup, test set 0.980x speedup, val set 0.804x speedup, step: 17
Epoch 143/200 |loss: 8.982032| train set 5.008x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 18
Epoch 144/200 |loss: 8.738714| train set 4.957x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.052239| train set 5.007x speedup, test set 0.991x speedup, val set 0.777x speedup, step: 2
Epoch 146/200 |loss: 8.870604| train set 4.920x speedup, test set 0.989x speedup, val set 0.795x speedup, step: 3
Epoch 147/200 |loss: 9.422259| train set 4.920x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 4
Epoch 148/200 |loss: 8.225804| train set 4.957x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 8.735594| train set 5.007x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 2
Epoch 150/200 |loss: 9.469666| train set 5.007x speedup, test set 0.991x speedup, val set 0.902x speedup, step: 3
Epoch 151/200 |loss: 8.904176| train set 4.920x speedup, test set 0.989x speedup, val set 0.804x speedup, step: 4
Epoch 152/200 |loss: 7.746847| train set 4.921x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 5
Epoch 153/200 |loss: 9.638171| train set 4.921x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 6
Epoch 154/200 |loss: 8.794219| train set 5.008x speedup, test set 0.955x speedup, val set 0.729x speedup, step: 7
Epoch 155/200 |loss: 9.242797| train set 5.008x speedup, test set 0.955x speedup, val set 0.742x speedup, step: 8
Epoch 156/200 |loss: 8.723577| train set 5.008x speedup, test set 0.955x speedup, val set 1.165x speedup, step: 9
Epoch 157/200 |loss: 9.012376| train set 4.958x speedup, test set 0.956x speedup, val set 1.228x speedup, step: 10
Epoch 158/200 |loss: 10.486742| train set 5.008x speedup, test set 0.956x speedup, val set 1.165x speedup, step: 11
Epoch 159/200 |loss: 7.837844| train set 5.008x speedup, test set 0.955x speedup, val set 0.786x speedup, step: 12
Epoch 160/200 |loss: 7.728476| train set 5.008x speedup, test set 0.970x speedup, val set 0.786x speedup, step: 13
Epoch 161/200 |loss: 9.333846| train set 5.008x speedup, test set 0.978x speedup, val set 0.786x speedup, step: 14
Epoch 162/200 |loss: 7.909003| train set 5.008x speedup, test set 0.978x speedup, val set 0.786x speedup, step: 15
Epoch 163/200 |loss: 7.509501| train set 5.008x speedup, test set 0.978x speedup, val set 0.955x speedup, step: 16
Epoch 164/200 |loss: 8.873432| train set 5.008x speedup, test set 0.980x speedup, val set 1.165x speedup, step: 17
Epoch 165/200 |loss: 8.005783| train set 5.008x speedup, test set 0.978x speedup, val set 0.944x speedup, step: 18
Epoch 166/200 |loss: 8.974161| train set 5.007x speedup, test set 0.989x speedup, val set 0.944x speedup, step: 19
Epoch 167/200 |loss: 9.604519| train set 5.007x speedup, test set 0.989x speedup, val set 1.165x speedup, step: 20
Epoch 168/200 |loss: 8.697367| train set 4.957x speedup, test set 0.982x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.227519| train set 4.958x speedup, test set 0.966x speedup, val set 1.316x speedup, step: 1
Epoch 170/200 |loss: 8.628256| train set 4.873x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 2
Epoch 171/200 |loss: 9.389109| train set 4.873x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 3
Epoch 172/200 |loss: 9.663010| train set 4.873x speedup, test set 0.963x speedup, val set 0.944x speedup, step: 4
Epoch 173/200 |loss: 8.062485| train set 4.957x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 5
Epoch 174/200 |loss: 8.766614| train set 4.920x speedup, test set 0.963x speedup, val set 0.839x speedup, step: 6
Epoch 175/200 |loss: 9.824134| train set 4.920x speedup, test set 0.979x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 8.905197| train set 5.007x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 8
Epoch 177/200 |loss: 8.265710| train set 4.958x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 9
Epoch 178/200 |loss: 9.163872| train set 4.958x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 10
Epoch 179/200 |loss: 8.427557| train set 4.954x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 11
Epoch 180/200 |loss: 9.113932| train set 4.955x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 12
Epoch 181/200 |loss: 8.445261| train set 4.958x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 13
Epoch 182/200 |loss: 9.312206| train set 4.954x speedup, test set 0.977x speedup, val set 0.742x speedup, step: 14
Epoch 183/200 |loss: 8.261540| train set 4.958x speedup, test set 0.985x speedup, val set 0.742x speedup, step: 15
Epoch 184/200 |loss: 7.354397| train set 5.008x speedup, test set 0.989x speedup, val set 1.165x speedup, step: 16
Epoch 185/200 |loss: 8.414292| train set 5.007x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 17
Epoch 186/200 |loss: 8.767356| train set 5.007x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 18
Epoch 187/200 |loss: 8.288924| train set 5.007x speedup, test set 0.991x speedup, val set 1.241x speedup, step: 19
Epoch 188/200 |loss: 8.261904| train set 5.007x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 20
Epoch 189/200 |loss: 8.604528| train set 5.007x speedup, test set 0.989x speedup, val set 0.762x speedup, step: 21
Epoch 190/200 |loss: 8.662653| train set 5.007x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 22
Epoch 191/200 |loss: 7.907492| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 23
Epoch 192/200 |loss: 9.763702| train set 4.921x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 24
Epoch 193/200 |loss: 9.257497| train set 4.921x speedup, test set 0.987x speedup, val set 0.786x speedup, step: 25
Epoch 194/200 |loss: 9.749743| train set 4.921x speedup, test set 0.987x speedup, val set 0.955x speedup, step: 26
Epoch 195/200 |loss: 7.503944| train set 5.008x speedup, test set 0.980x speedup, val set 1.228x speedup, step: 27
Epoch 196/200 |loss: 8.715199| train set 5.008x speedup, test set 0.980x speedup, val set 1.165x speedup, step: 28
Epoch 197/200 |loss: 8.860905| train set 5.008x speedup, test set 0.978x speedup, val set 0.804x speedup, step: 29
Epoch 198/200 |loss: 9.330207| train set 4.954x speedup, test set 0.970x speedup, val set 0.804x speedup, step: 30
Epoch 199/200 |loss: 7.473370| train set 5.008x speedup, test set 0.970x speedup, val set 0.868x speedup, step: 31
Training per epoch cost 0.327 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
15, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 24, train speedup 5.008, test speedup 0.980, val speedup 0.729
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 169, train speedup 4.958, test speedup 0.966, val speedup 1.316
last model at epoch 199, train speedup 5.008, test speedup 0.970, val speedup 0.868
execution cost 0:02:40.765408
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.923884, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281971| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793522| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912633| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587205| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575416| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370785| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755565| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455398| train set 4.285x speedup, test set 0.975x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921763| train set 4.630x speedup, test set 0.870x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914979| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.109001| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590152| train set 4.630x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591467| train set 4.670x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213896| train set 5.008x speedup, test set 1.001x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153133| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.501633| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.035396| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.297978| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.687193| train set 5.007x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.886801| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.646277| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.544176| train set 4.958x speedup, test set 1.026x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.312741| train set 4.958x speedup, test set 1.005x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.342385| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 29
Epoch 29/200 |loss: 10.265709| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.668327| train set 5.008x speedup, test set 0.891x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.477913| train set 4.958x speedup, test set 1.039x speedup, val set 1.033x speedup, step: 32
Epoch 32/200 |loss: 10.532225| train set 4.708x speedup, test set 0.995x speedup, val set 0.752x speedup, step: 33
Epoch 33/200 |loss: 10.978899| train set 4.630x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.413736| train set 4.572x speedup, test set 0.918x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 13.275599| train set 5.007x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 13.083163| train set 5.008x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.877524| train set 5.008x speedup, test set 1.001x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 10.859444| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 10.610071| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.595450| train set 4.958x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.151509| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.754459| train set 4.921x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.348718| train set 4.631x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.297457| train set 4.958x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.001556| train set 4.754x speedup, test set 0.999x speedup, val set 1.007x speedup, step: 46
Epoch 46/200 |loss: 10.378914| train set 4.754x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 9.855414| train set 4.412x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.503992| train set 5.008x speedup, test set 1.003x speedup, val set 0.983x speedup, step: 49
Epoch 49/200 |loss: 10.022445| train set 5.008x speedup, test set 1.003x speedup, val set 0.855x speedup, step: 50
Epoch 50/200 |loss: 9.465620| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 9.791947| train set 4.958x speedup, test set 1.003x speedup, val set 0.957x speedup, step: 52
Epoch 52/200 |loss: 10.504163| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 8.830579| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.922695| train set 4.715x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 55
Epoch 55/200 |loss: 9.720091| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 8.925083| train set 4.921x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 57
Epoch 57/200 |loss: 9.932528| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 58
Epoch 58/200 |loss: 9.534911| train set 5.007x speedup, test set 0.983x speedup, val set 1.033x speedup, step: 59
Epoch 59/200 |loss: 8.705579| train set 5.007x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 60
Epoch 60/200 |loss: 9.273840| train set 5.007x speedup, test set 0.994x speedup, val set 1.033x speedup, step: 61
Epoch 61/200 |loss: 10.401871| train set 4.958x speedup, test set 0.983x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 7.986979| train set 4.873x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 63
Epoch 63/200 |loss: 8.821681| train set 4.869x speedup, test set 0.988x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.335739| train set 4.916x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 65
Epoch 65/200 |loss: 8.765376| train set 5.007x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.991180| train set 5.004x speedup, test set 1.003x speedup, val set 0.980x speedup, step: 67
Epoch 67/200 |loss: 7.644009| train set 5.008x speedup, test set 1.003x speedup, val set 0.980x speedup, step: 68
Epoch 68/200 |loss: 9.200799| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 69
Epoch 69/200 |loss: 9.001028| train set 5.008x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 70
Epoch 70/200 |loss: 8.455439| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 71
Epoch 71/200 |loss: 9.340661| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 72
Epoch 72/200 |loss: 7.805338| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 73
Epoch 73/200 |loss: 8.904568| train set 5.008x speedup, test set 0.991x speedup, val set 1.057x speedup, step: 74
Epoch 74/200 |loss: 9.281413| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 9.006678| train set 4.958x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.189225| train set 5.007x speedup, test set 1.003x speedup, val set 0.735x speedup, step: 77
Epoch 77/200 |loss: 8.400903| train set 5.007x speedup, test set 0.999x speedup, val set 0.762x speedup, step: 78
Epoch 78/200 |loss: 9.169184| train set 5.007x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 79
Epoch 79/200 |loss: 8.947932| train set 4.916x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 80
Epoch 80/200 |loss: 7.436036| train set 4.921x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.232442| train set 5.008x speedup, test set 0.982x speedup, val set 0.980x speedup, step: 82
Epoch 82/200 |loss: 8.881442| train set 5.008x speedup, test set 0.971x speedup, val set 0.804x speedup, step: 83
Epoch 83/200 |loss: 8.641195| train set 5.008x speedup, test set 0.955x speedup, val set 1.033x speedup, step: 84
Epoch 84/200 |loss: 9.115588| train set 5.008x speedup, test set 0.955x speedup, val set 1.033x speedup, step: 85
Epoch 85/200 |loss: 8.167470| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 86
Epoch 86/200 |loss: 8.751481| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 87
Epoch 87/200 |loss: 9.577927| train set 5.008x speedup, test set 0.952x speedup, val set 1.165x speedup, step: 88
Epoch 88/200 |loss: 7.739766| train set 5.008x speedup, test set 0.952x speedup, val set 0.795x speedup, step: 89
Epoch 89/200 |loss: 8.322132| train set 5.008x speedup, test set 0.952x speedup, val set 0.980x speedup, step: 90
Epoch 90/200 |loss: 8.604568| train set 5.008x speedup, test set 0.952x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.452523| train set 5.008x speedup, test set 0.952x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.258523| train set 5.008x speedup, test set 0.952x speedup, val set 1.033x speedup, step: 93
Epoch 93/200 |loss: 9.163029| train set 5.008x speedup, test set 0.952x speedup, val set 1.006x speedup, step: 94
Epoch 94/200 |loss: 8.321733| train set 4.958x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 95
Epoch 95/200 |loss: 9.084950| train set 4.958x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 96
Epoch 96/200 |loss: 9.076189| train set 4.958x speedup, test set 0.952x speedup, val set 0.980x speedup, step: 97
Epoch 97/200 |loss: 9.023339| train set 5.008x speedup, test set 0.963x speedup, val set 0.957x speedup, step: 98
Epoch 98/200 |loss: 8.819195| train set 5.008x speedup, test set 0.963x speedup, val set 0.957x speedup, step: 99
Epoch 99/200 |loss: 9.366117| train set 5.008x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 100
Epoch 100/200 |loss: 9.135042| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 1
Epoch 101/200 |loss: 10.033799| train set 4.671x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 2
Epoch 102/200 |loss: 8.881454| train set 4.958x speedup, test set 0.963x speedup, val set 0.892x speedup, step: 1
Epoch 103/200 |loss: 9.272568| train set 4.917x speedup, test set 0.957x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.460496| train set 4.915x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 3
Epoch 105/200 |loss: 7.553954| train set 5.007x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 7.978827| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 107/200 |loss: 8.821867| train set 4.753x speedup, test set 0.999x speedup, val set 0.742x speedup, step: 2
Epoch 108/200 |loss: 7.933661| train set 4.754x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 3
Epoch 109/200 |loss: 9.237943| train set 5.008x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 4
Epoch 110/200 |loss: 7.348856| train set 4.917x speedup, test set 0.974x speedup, val set 0.804x speedup, step: 5
Epoch 111/200 |loss: 9.062240| train set 4.958x speedup, test set 0.974x speedup, val set 0.980x speedup, step: 6
Epoch 112/200 |loss: 9.698997| train set 4.958x speedup, test set 0.974x speedup, val set 0.980x speedup, step: 7
Epoch 113/200 |loss: 8.878824| train set 5.008x speedup, test set 0.974x speedup, val set 0.990x speedup, step: 8
Epoch 114/200 |loss: 9.510919| train set 5.008x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 9
Epoch 115/200 |loss: 7.796359| train set 5.008x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 10
Epoch 116/200 |loss: 8.136542| train set 4.921x speedup, test set 0.974x speedup, val set 0.806x speedup, step: 11
Epoch 117/200 |loss: 9.895494| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 12
Epoch 118/200 |loss: 8.745359| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 13
Epoch 119/200 |loss: 8.738214| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 14
Epoch 120/200 |loss: 9.629705| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 15
Epoch 121/200 |loss: 8.645612| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 16
Epoch 122/200 |loss: 8.491504| train set 4.958x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 17
Epoch 123/200 |loss: 6.987877| train set 4.872x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 18
Epoch 124/200 |loss: 9.216623| train set 4.920x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 19
Epoch 125/200 |loss: 9.388673| train set 4.920x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 20
Epoch 126/200 |loss: 10.172337| train set 5.007x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 21
Epoch 127/200 |loss: 8.898333| train set 5.007x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 22
Epoch 128/200 |loss: 9.330747| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 23
Epoch 129/200 |loss: 8.441971| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 24
Epoch 130/200 |loss: 9.397766| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 25
Epoch 131/200 |loss: 8.868746| train set 4.958x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 26
Epoch 132/200 |loss: 9.187291| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 27
Epoch 133/200 |loss: 7.638843| train set 4.709x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 28
Epoch 134/200 |loss: 7.041712| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 29
Epoch 135/200 |loss: 8.561589| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 30
Epoch 136/200 |loss: 7.569864| train set 5.008x speedup, test set 0.966x speedup, val set 0.786x speedup, step: 31
Epoch 137/200 |loss: 8.622402| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 32
Epoch 138/200 |loss: 9.487473| train set 4.715x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 33
Epoch 139/200 |loss: 9.237822| train set 4.715x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 34
Epoch 140/200 |loss: 7.954379| train set 4.958x speedup, test set 0.952x speedup, val set 1.228x speedup, step: 35
Epoch 141/200 |loss: 8.422479| train set 4.958x speedup, test set 0.952x speedup, val set 1.165x speedup, step: 36
Epoch 142/200 |loss: 8.522974| train set 4.921x speedup, test set 0.963x speedup, val set 0.770x speedup, step: 37
Epoch 143/200 |loss: 9.213589| train set 4.872x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 38
Epoch 144/200 |loss: 8.656621| train set 4.957x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 39
Epoch 145/200 |loss: 9.690359| train set 4.957x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 40
Epoch 146/200 |loss: 9.147161| train set 4.872x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 41
Epoch 147/200 |loss: 9.784132| train set 4.957x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 42
Epoch 148/200 |loss: 8.314116| train set 5.007x speedup, test set 0.979x speedup, val set 1.133x speedup, step: 43
Epoch 149/200 |loss: 8.816124| train set 5.007x speedup, test set 0.992x speedup, val set 0.735x speedup, step: 44
Epoch 150/200 |loss: 9.711497| train set 5.004x speedup, test set 1.000x speedup, val set 0.742x speedup, step: 45
Epoch 151/200 |loss: 9.162500| train set 4.912x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 46
Epoch 152/200 |loss: 7.757936| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 47
Epoch 153/200 |loss: 9.840312| train set 4.921x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 48
Epoch 154/200 |loss: 9.172893| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 49
Epoch 155/200 |loss: 9.323554| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 50
Epoch 156/200 |loss: 8.966784| train set 5.008x speedup, test set 0.967x speedup, val set 0.742x speedup, step: 51
Epoch 157/200 |loss: 9.234447| train set 5.008x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 52
Epoch 158/200 |loss: 10.410495| train set 4.921x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 53
Epoch 159/200 |loss: 7.894739| train set 5.008x speedup, test set 0.974x speedup, val set 0.786x speedup, step: 54
Epoch 160/200 |loss: 7.886093| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 55
Epoch 161/200 |loss: 9.327587| train set 5.008x speedup, test set 0.963x speedup, val set 0.770x speedup, step: 56
Epoch 162/200 |loss: 8.148969| train set 5.008x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 57
Epoch 163/200 |loss: 7.753349| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 58
Epoch 164/200 |loss: 8.853105| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 59
Epoch 165/200 |loss: 8.082668| train set 5.008x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 60
Epoch 166/200 |loss: 9.261815| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 61
Epoch 167/200 |loss: 9.793114| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 62
Epoch 168/200 |loss: 8.945833| train set 4.957x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 63
Epoch 169/200 |loss: 8.353221| train set 4.958x speedup, test set 0.952x speedup, val set 1.133x speedup, step: 64
Epoch 170/200 |loss: 8.671203| train set 4.873x speedup, test set 0.952x speedup, val set 0.735x speedup, step: 65
Epoch 171/200 |loss: 9.410871| train set 4.873x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 66
Epoch 172/200 |loss: 9.856002| train set 4.873x speedup, test set 0.952x speedup, val set 0.735x speedup, step: 67
Epoch 173/200 |loss: 8.207071| train set 4.957x speedup, test set 0.952x speedup, val set 0.733x speedup, step: 68
Epoch 174/200 |loss: 8.714035| train set 4.881x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 69
Epoch 175/200 |loss: 9.838660| train set 4.920x speedup, test set 0.964x speedup, val set 0.804x speedup, step: 70
Epoch 176/200 |loss: 9.134684| train set 4.920x speedup, test set 0.964x speedup, val set 0.762x speedup, step: 71
Epoch 177/200 |loss: 8.322676| train set 5.007x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 72
Epoch 178/200 |loss: 9.131246| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 73
Epoch 179/200 |loss: 8.562398| train set 4.955x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 74
Epoch 180/200 |loss: 9.058851| train set 4.954x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 75
Epoch 181/200 |loss: 8.498619| train set 4.955x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 76
Epoch 182/200 |loss: 9.359426| train set 4.958x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 77
Epoch 183/200 |loss: 8.387128| train set 4.958x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 78
Epoch 184/200 |loss: 7.500516| train set 5.008x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 79
Epoch 185/200 |loss: 8.378487| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 80
Epoch 186/200 |loss: 9.021028| train set 5.007x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 81
Epoch 187/200 |loss: 8.289093| train set 4.957x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 82
Epoch 188/200 |loss: 8.276407| train set 5.007x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 83
Epoch 189/200 |loss: 8.576934| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 84
Epoch 190/200 |loss: 8.486986| train set 5.008x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 85
Epoch 191/200 |loss: 7.810787| train set 5.008x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 86
Epoch 192/200 |loss: 9.777645| train set 4.921x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 87
Epoch 193/200 |loss: 9.169552| train set 4.921x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 88
Epoch 194/200 |loss: 9.330544| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 89
Epoch 195/200 |loss: 7.618055| train set 4.873x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 90
Epoch 196/200 |loss: 8.490786| train set 4.958x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 91
Epoch 197/200 |loss: 8.624192| train set 4.954x speedup, test set 0.952x speedup, val set 0.786x speedup, step: 92
Epoch 198/200 |loss: 9.193227| train set 4.954x speedup, test set 0.952x speedup, val set 0.795x speedup, step: 93
Epoch 199/200 |loss: 7.520004| train set 5.004x speedup, test set 0.963x speedup, val set 0.786x speedup, step: 94
Training per epoch cost 0.327 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
17, opt runtime 3.248s, model runtime 9.856s, pg runtime 10.538s, speedup 1.069x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 1.001, val speedup 0.965
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 106, train speedup 5.007, test speedup 0.991, val speedup 1.302
last model at epoch 199, train speedup 5.004, test speedup 0.963, val speedup 0.786
execution cost 0:02:39.337166
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.987567, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286845| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793523| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912633| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587204| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575418| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370787| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755568| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455400| train set 4.285x speedup, test set 0.975x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921765| train set 4.630x speedup, test set 0.870x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914978| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.109002| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590154| train set 4.630x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591468| train set 4.670x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213898| train set 5.008x speedup, test set 1.001x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153141| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.500174| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.041613| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.292263| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.732161| train set 5.007x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.947754| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.744873| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.607518| train set 4.958x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.292207| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.411540| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 10.146389| train set 4.921x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.633709| train set 5.008x speedup, test set 0.970x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.439775| train set 4.958x speedup, test set 1.031x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.699395| train set 4.708x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 10.826054| train set 4.412x speedup, test set 1.007x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.541305| train set 4.614x speedup, test set 1.020x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 13.500085| train set 5.007x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 13.075391| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 10.021272| train set 4.883x speedup, test set 1.044x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 10.521848| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 10.821159| train set 4.809x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.798914| train set 4.865x speedup, test set 1.044x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.228999| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.305639| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 43
Epoch 43/200 |loss: 10.753854| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.402246| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.172855| train set 4.892x speedup, test set 1.003x speedup, val set 0.968x speedup, step: 46
Epoch 46/200 |loss: 10.828255| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 9.917457| train set 4.674x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.585411| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 9.842283| train set 4.921x speedup, test set 1.003x speedup, val set 0.994x speedup, step: 50
Epoch 50/200 |loss: 9.481200| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 9.728435| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 52
Epoch 52/200 |loss: 10.594590| train set 4.873x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 53
Epoch 53/200 |loss: 8.821200| train set 4.921x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.911166| train set 4.715x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 55
Epoch 55/200 |loss: 9.735348| train set 4.957x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 56
Epoch 56/200 |loss: 8.958825| train set 5.007x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.179619| train set 5.007x speedup, test set 0.991x speedup, val set 0.798x speedup, step: 58
Epoch 58/200 |loss: 9.653368| train set 5.007x speedup, test set 0.991x speedup, val set 1.316x speedup, step: 59
Epoch 59/200 |loss: 8.875898| train set 5.007x speedup, test set 1.007x speedup, val set 0.994x speedup, step: 60
Epoch 60/200 |loss: 9.409898| train set 5.008x speedup, test set 0.991x speedup, val set 0.957x speedup, step: 61
Epoch 61/200 |loss: 10.396742| train set 4.958x speedup, test set 0.982x speedup, val set 1.041x speedup, step: 62
Epoch 62/200 |loss: 8.254493| train set 4.869x speedup, test set 0.982x speedup, val set 1.302x speedup, step: 63
Epoch 63/200 |loss: 8.680932| train set 4.869x speedup, test set 0.991x speedup, val set 1.228x speedup, step: 64
Epoch 64/200 |loss: 8.471662| train set 4.918x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 65
Epoch 65/200 |loss: 8.859178| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 66
Epoch 66/200 |loss: 9.932591| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 67
Epoch 67/200 |loss: 7.658216| train set 5.008x speedup, test set 0.991x speedup, val set 0.798x speedup, step: 68
Epoch 68/200 |loss: 9.082691| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 8.936656| train set 5.008x speedup, test set 1.007x speedup, val set 1.211x speedup, step: 70
Epoch 70/200 |loss: 8.353868| train set 5.008x speedup, test set 1.007x speedup, val set 1.302x speedup, step: 71
Epoch 71/200 |loss: 9.211902| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 72
Epoch 72/200 |loss: 7.825230| train set 5.007x speedup, test set 0.989x speedup, val set 1.316x speedup, step: 73
Epoch 73/200 |loss: 8.765125| train set 5.007x speedup, test set 0.991x speedup, val set 1.316x speedup, step: 74
Epoch 74/200 |loss: 9.127337| train set 4.991x speedup, test set 0.991x speedup, val set 1.316x speedup, step: 75
Epoch 75/200 |loss: 9.018641| train set 4.958x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.179111| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 77
Epoch 77/200 |loss: 8.395212| train set 5.007x speedup, test set 1.003x speedup, val set 1.316x speedup, step: 78
Epoch 78/200 |loss: 9.124818| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 79
Epoch 79/200 |loss: 8.825025| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 80
Epoch 80/200 |loss: 7.562098| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.162157| train set 5.008x speedup, test set 0.991x speedup, val set 0.746x speedup, step: 82
Epoch 82/200 |loss: 8.910241| train set 5.008x speedup, test set 0.985x speedup, val set 0.809x speedup, step: 83
Epoch 83/200 |loss: 8.727260| train set 5.008x speedup, test set 1.007x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 9.041554| train set 4.921x speedup, test set 1.007x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.058379| train set 4.921x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.811694| train set 5.008x speedup, test set 1.007x speedup, val set 1.211x speedup, step: 87
Epoch 87/200 |loss: 9.521162| train set 5.008x speedup, test set 0.998x speedup, val set 1.302x speedup, step: 88
Epoch 88/200 |loss: 7.712137| train set 5.008x speedup, test set 0.982x speedup, val set 1.133x speedup, step: 89
Epoch 89/200 |loss: 8.124825| train set 4.958x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 90
Epoch 90/200 |loss: 8.791503| train set 5.008x speedup, test set 0.982x speedup, val set 0.775x speedup, step: 91
Epoch 91/200 |loss: 8.458197| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 92
Epoch 92/200 |loss: 8.353172| train set 5.008x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 93
Epoch 93/200 |loss: 9.225600| train set 5.008x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 94
Epoch 94/200 |loss: 8.432305| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 95
Epoch 95/200 |loss: 9.095620| train set 4.958x speedup, test set 0.963x speedup, val set 0.934x speedup, step: 96
Epoch 96/200 |loss: 9.105239| train set 4.958x speedup, test set 0.964x speedup, val set 0.735x speedup, step: 97
Epoch 97/200 |loss: 9.165640| train set 4.958x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 9.060460| train set 5.008x speedup, test set 0.963x speedup, val set 0.762x speedup, step: 99
Epoch 99/200 |loss: 9.453889| train set 5.008x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 100
Epoch 100/200 |loss: 9.352841| train set 5.008x speedup, test set 0.982x speedup, val set 0.762x speedup, step: 1
Epoch 101/200 |loss: 9.968865| train set 4.708x speedup, test set 1.003x speedup, val set 1.241x speedup, step: 1
Epoch 102/200 |loss: 8.787892| train set 4.991x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 103/200 |loss: 9.269096| train set 4.917x speedup, test set 0.979x speedup, val set 0.868x speedup, step: 2
Epoch 104/200 |loss: 8.271238| train set 4.921x speedup, test set 0.974x speedup, val set 0.990x speedup, step: 3
Epoch 105/200 |loss: 7.612217| train set 4.920x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.060133| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 107/200 |loss: 8.923860| train set 5.007x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 2
Epoch 108/200 |loss: 7.879988| train set 4.753x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 3
Epoch 109/200 |loss: 9.209079| train set 4.753x speedup, test set 0.982x speedup, val set 1.165x speedup, step: 4
Epoch 110/200 |loss: 7.472447| train set 5.004x speedup, test set 0.982x speedup, val set 1.165x speedup, step: 5
Epoch 111/200 |loss: 8.860311| train set 4.953x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 1
Epoch 112/200 |loss: 9.623826| train set 4.958x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 1
Epoch 113/200 |loss: 8.602370| train set 5.008x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 2
Epoch 114/200 |loss: 9.483212| train set 5.008x speedup, test set 0.963x speedup, val set 0.892x speedup, step: 3
Epoch 115/200 |loss: 8.029174| train set 5.008x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 4
Epoch 116/200 |loss: 8.034948| train set 5.008x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 5
Epoch 117/200 |loss: 9.934504| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 6
Epoch 118/200 |loss: 8.960538| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 7
Epoch 119/200 |loss: 8.907127| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 120/200 |loss: 9.718290| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 9
Epoch 121/200 |loss: 8.374501| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 10
Epoch 122/200 |loss: 8.434889| train set 4.873x speedup, test set 0.963x speedup, val set 0.901x speedup, step: 11
Epoch 123/200 |loss: 6.966914| train set 4.873x speedup, test set 0.963x speedup, val set 0.786x speedup, step: 12
Epoch 124/200 |loss: 9.231730| train set 4.921x speedup, test set 0.963x speedup, val set 0.762x speedup, step: 13
Epoch 125/200 |loss: 9.506762| train set 4.921x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 14
Epoch 126/200 |loss: 10.494147| train set 5.007x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 15
Epoch 127/200 |loss: 8.938402| train set 5.007x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 16
Epoch 128/200 |loss: 9.662190| train set 5.007x speedup, test set 0.963x speedup, val set 0.786x speedup, step: 17
Epoch 129/200 |loss: 8.598432| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 18
Epoch 130/200 |loss: 9.237679| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 19
Epoch 131/200 |loss: 9.147796| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 20
Epoch 132/200 |loss: 9.385962| train set 4.958x speedup, test set 0.963x speedup, val set 0.762x speedup, step: 21
Epoch 133/200 |loss: 7.842657| train set 4.958x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 22
Epoch 134/200 |loss: 7.010067| train set 5.008x speedup, test set 0.969x speedup, val set 0.729x speedup, step: 23
Epoch 135/200 |loss: 8.727724| train set 5.008x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 24
Epoch 136/200 |loss: 7.476296| train set 5.008x speedup, test set 0.966x speedup, val set 0.786x speedup, step: 25
Epoch 137/200 |loss: 8.633693| train set 5.004x speedup, test set 0.964x speedup, val set 0.770x speedup, step: 26
Epoch 138/200 |loss: 9.546541| train set 5.008x speedup, test set 0.966x speedup, val set 0.955x speedup, step: 27
Epoch 139/200 |loss: 9.168404| train set 5.008x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 1
Epoch 140/200 |loss: 8.226906| train set 4.958x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.378529| train set 4.958x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 2
Epoch 142/200 |loss: 8.637297| train set 4.921x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 3
Epoch 143/200 |loss: 9.178258| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 144/200 |loss: 8.489486| train set 4.957x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.761657| train set 4.872x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 2
Epoch 146/200 |loss: 9.343646| train set 4.920x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 3
Epoch 147/200 |loss: 9.769279| train set 4.556x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 148/200 |loss: 8.395678| train set 4.987x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 9.012250| train set 5.007x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 150/200 |loss: 9.852247| train set 5.004x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 2
Epoch 151/200 |loss: 8.935116| train set 5.003x speedup, test set 0.974x speedup, val set 0.836x speedup, step: 3
Epoch 152/200 |loss: 7.871567| train set 5.008x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 4
Epoch 153/200 |loss: 9.760627| train set 5.008x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 154/200 |loss: 8.976334| train set 5.008x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 2
Epoch 155/200 |loss: 9.513628| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 3
Epoch 156/200 |loss: 9.058162| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 4
Epoch 157/200 |loss: 9.253119| train set 4.958x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 5
Epoch 158/200 |loss: 10.437325| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 6
Epoch 159/200 |loss: 7.759685| train set 4.917x speedup, test set 0.963x speedup, val set 0.770x speedup, step: 7
Epoch 160/200 |loss: 8.106122| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 161/200 |loss: 9.270738| train set 5.008x speedup, test set 0.963x speedup, val set 0.813x speedup, step: 9
Epoch 162/200 |loss: 8.200658| train set 5.008x speedup, test set 0.960x speedup, val set 0.786x speedup, step: 10
Epoch 163/200 |loss: 7.745265| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 11
Epoch 164/200 |loss: 8.785822| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 12
Epoch 165/200 |loss: 8.019129| train set 5.008x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 13
Epoch 166/200 |loss: 9.221502| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 14
Epoch 167/200 |loss: 9.724159| train set 5.007x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 15
Epoch 168/200 |loss: 8.679388| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.385542| train set 4.958x speedup, test set 0.963x speedup, val set 1.316x speedup, step: 1
Epoch 170/200 |loss: 8.857126| train set 4.873x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 2
Epoch 171/200 |loss: 9.303278| train set 4.873x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 3
Epoch 172/200 |loss: 9.821121| train set 4.958x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 4
Epoch 173/200 |loss: 8.192871| train set 4.958x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 5
Epoch 174/200 |loss: 8.798837| train set 4.920x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 6
Epoch 175/200 |loss: 9.888031| train set 4.920x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 8.898046| train set 4.920x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 8
Epoch 177/200 |loss: 8.193339| train set 5.008x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 9
Epoch 178/200 |loss: 9.023338| train set 5.008x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 10
Epoch 179/200 |loss: 8.369415| train set 5.008x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 11
Epoch 180/200 |loss: 9.065401| train set 4.958x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 12
Epoch 181/200 |loss: 8.445194| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 13
Epoch 182/200 |loss: 9.163120| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 14
Epoch 183/200 |loss: 8.404371| train set 4.957x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 15
Epoch 184/200 |loss: 7.419149| train set 4.957x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 16
Epoch 185/200 |loss: 8.547860| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 17
Epoch 186/200 |loss: 8.809125| train set 5.007x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 18
Epoch 187/200 |loss: 8.354991| train set 5.007x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 19
Epoch 188/200 |loss: 8.237889| train set 5.007x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 20
Epoch 189/200 |loss: 8.533822| train set 5.007x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 21
Epoch 190/200 |loss: 8.607908| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 22
Epoch 191/200 |loss: 7.728105| train set 5.008x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 23
Epoch 192/200 |loss: 9.731912| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 24
Epoch 193/200 |loss: 9.102988| train set 4.921x speedup, test set 0.963x speedup, val set 0.990x speedup, step: 25
Epoch 194/200 |loss: 9.531317| train set 4.921x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 26
Epoch 195/200 |loss: 7.463157| train set 4.921x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 27
Epoch 196/200 |loss: 8.589160| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 28
Epoch 197/200 |loss: 8.823009| train set 4.954x speedup, test set 0.963x speedup, val set 0.944x speedup, step: 29
Epoch 198/200 |loss: 9.260743| train set 4.954x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 30
Epoch 199/200 |loss: 7.554888| train set 5.002x speedup, test set 0.963x speedup, val set 0.868x speedup, step: 31
Training per epoch cost 0.323 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.879s, pg runtime 5.879s, speedup 1.000x
15, opt runtime 1.737s, model runtime 5.994s, pg runtime 5.994s, speedup 1.000x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 1.001, val speedup 0.965
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 169, train speedup 4.958, test speedup 0.963, val speedup 1.316
last model at epoch 199, train speedup 5.002, test speedup 0.963, val speedup 0.868
execution cost 0:02:39.898726
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.944994, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281973| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286847| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.794128| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.084897| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.898474| train set 3.146x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588904| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.621334| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.479326| train set 3.958x speedup, test set 1.012x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.772231| train set 3.958x speedup, test set 0.934x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.426643| train set 4.286x speedup, test set 0.986x speedup, val set 0.874x speedup, step: 13
Epoch 13/200 |loss: 13.927896| train set 4.630x speedup, test set 0.870x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 14.073830| train set 4.630x speedup, test set 0.870x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.078859| train set 4.895x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.693985| train set 4.630x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.551717| train set 4.670x speedup, test set 0.867x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.297978| train set 4.958x speedup, test set 0.895x speedup, val set 1.041x speedup, step: 19
Epoch 19/200 |loss: 10.025262| train set 4.958x speedup, test set 1.008x speedup, val set 0.965x speedup, step: 20
Epoch 20/200 |loss: 12.575794| train set 4.674x speedup, test set 0.990x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.090203| train set 5.008x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.456271| train set 5.008x speedup, test set 1.008x speedup, val set 0.983x speedup, step: 23
Epoch 23/200 |loss: 10.965914| train set 5.007x speedup, test set 1.016x speedup, val set 1.041x speedup, step: 24
Epoch 24/200 |loss: 12.323600| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 12.239020| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.970085| train set 4.958x speedup, test set 1.014x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 12.730594| train set 4.631x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 28
Epoch 28/200 |loss: 10.766060| train set 4.958x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 29
Epoch 29/200 |loss: 10.437926| train set 5.008x speedup, test set 1.008x speedup, val set 0.855x speedup, step: 30
Epoch 30/200 |loss: 11.025525| train set 5.008x speedup, test set 1.007x speedup, val set 1.033x speedup, step: 31
Epoch 31/200 |loss: 11.257840| train set 5.008x speedup, test set 0.940x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.803466| train set 5.007x speedup, test set 1.007x speedup, val set 0.994x speedup, step: 33
Epoch 33/200 |loss: 10.672792| train set 4.630x speedup, test set 1.007x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.620802| train set 4.847x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 13.415182| train set 4.894x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.156969| train set 4.958x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.924130| train set 4.958x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 38
Epoch 38/200 |loss: 9.795018| train set 4.715x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.564411| train set 4.631x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.293640| train set 4.958x speedup, test set 0.960x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.101958| train set 4.921x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.277079| train set 4.921x speedup, test set 0.991x speedup, val set 0.983x speedup, step: 43
Epoch 43/200 |loss: 10.299222| train set 4.630x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.218887| train set 4.957x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 8.825840| train set 4.577x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 10.349538| train set 4.754x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 9.587109| train set 4.674x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.683632| train set 4.674x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 9.908572| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.415963| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 51
Epoch 51/200 |loss: 9.753365| train set 4.958x speedup, test set 0.991x speedup, val set 1.133x speedup, step: 52
Epoch 52/200 |loss: 10.472359| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 8.628175| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 8.999876| train set 4.715x speedup, test set 0.991x speedup, val set 0.994x speedup, step: 55
Epoch 55/200 |loss: 9.795887| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 9.010317| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.202443| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.387809| train set 4.957x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 59
Epoch 59/200 |loss: 8.782537| train set 4.957x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 60
Epoch 60/200 |loss: 9.392940| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.803335| train set 4.958x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 62
Epoch 62/200 |loss: 7.969748| train set 4.873x speedup, test set 0.979x speedup, val set 1.268x speedup, step: 63
Epoch 63/200 |loss: 8.716773| train set 4.917x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.289675| train set 4.917x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 65
Epoch 65/200 |loss: 8.904067| train set 5.008x speedup, test set 0.991x speedup, val set 1.268x speedup, step: 66
Epoch 66/200 |loss: 9.625067| train set 5.008x speedup, test set 0.991x speedup, val set 1.149x speedup, step: 67
Epoch 67/200 |loss: 7.386668| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.091529| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 8.993443| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.603470| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.545471| train set 5.007x speedup, test set 0.991x speedup, val set 0.992x speedup, step: 72
Epoch 72/200 |loss: 7.978409| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 73
Epoch 73/200 |loss: 9.100017| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.252312| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 9.073099| train set 4.958x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.205529| train set 5.004x speedup, test set 1.003x speedup, val set 1.211x speedup, step: 77
Epoch 77/200 |loss: 8.426106| train set 5.007x speedup, test set 1.003x speedup, val set 0.994x speedup, step: 78
Epoch 78/200 |loss: 9.405954| train set 4.999x speedup, test set 0.991x speedup, val set 1.006x speedup, step: 79
Epoch 79/200 |loss: 8.963122| train set 5.004x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 80
Epoch 80/200 |loss: 7.890579| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 81
Epoch 81/200 |loss: 10.454469| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 9.001599| train set 5.004x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 83
Epoch 83/200 |loss: 8.715611| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 84
Epoch 84/200 |loss: 9.069780| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 85
Epoch 85/200 |loss: 8.309301| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 86
Epoch 86/200 |loss: 8.892232| train set 4.715x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 87
Epoch 87/200 |loss: 9.762579| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.836558| train set 5.008x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 89
Epoch 89/200 |loss: 8.336588| train set 5.008x speedup, test set 0.991x speedup, val set 0.957x speedup, step: 90
Epoch 90/200 |loss: 8.591376| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 91
Epoch 91/200 |loss: 8.739043| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.289573| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 93
Epoch 93/200 |loss: 9.145459| train set 5.008x speedup, test set 0.991x speedup, val set 0.968x speedup, step: 94
Epoch 94/200 |loss: 8.311890| train set 4.958x speedup, test set 0.991x speedup, val set 0.957x speedup, step: 95
Epoch 95/200 |loss: 8.946463| train set 4.958x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 96
Epoch 96/200 |loss: 9.186056| train set 4.958x speedup, test set 0.991x speedup, val set 0.957x speedup, step: 97
Epoch 97/200 |loss: 8.982133| train set 5.008x speedup, test set 0.991x speedup, val set 0.752x speedup, step: 98
Epoch 98/200 |loss: 8.851272| train set 5.008x speedup, test set 0.991x speedup, val set 0.994x speedup, step: 99
Epoch 99/200 |loss: 9.598762| train set 5.008x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 100
Epoch 100/200 |loss: 9.164237| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 1
Epoch 101/200 |loss: 9.727178| train set 4.715x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 1
Epoch 102/200 |loss: 8.738976| train set 5.008x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 2
Epoch 103/200 |loss: 9.338626| train set 5.004x speedup, test set 0.991x speedup, val set 0.762x speedup, step: 3
Epoch 104/200 |loss: 8.464023| train set 4.920x speedup, test set 0.991x speedup, val set 1.149x speedup, step: 1
Epoch 105/200 |loss: 7.361804| train set 5.007x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.207742| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 2
Epoch 107/200 |loss: 8.772135| train set 5.007x speedup, test set 0.987x speedup, val set 0.879x speedup, step: 3
Epoch 108/200 |loss: 8.223883| train set 5.007x speedup, test set 0.987x speedup, val set 0.980x speedup, step: 4
Epoch 109/200 |loss: 9.382054| train set 5.008x speedup, test set 0.991x speedup, val set 1.006x speedup, step: 5
Epoch 110/200 |loss: 7.324660| train set 5.008x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 6
Epoch 111/200 |loss: 9.358490| train set 5.008x speedup, test set 0.991x speedup, val set 1.006x speedup, step: 7
Epoch 112/200 |loss: 9.426403| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 8
Epoch 113/200 |loss: 8.935364| train set 5.008x speedup, test set 0.991x speedup, val set 1.045x speedup, step: 9
Epoch 114/200 |loss: 9.489906| train set 5.008x speedup, test set 0.991x speedup, val set 0.868x speedup, step: 10
Epoch 115/200 |loss: 8.083361| train set 5.008x speedup, test set 0.982x speedup, val set 0.777x speedup, step: 11
Epoch 116/200 |loss: 8.106397| train set 5.008x speedup, test set 0.982x speedup, val set 0.934x speedup, step: 12
Epoch 117/200 |loss: 9.694016| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 13
Epoch 118/200 |loss: 8.783298| train set 5.008x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 14
Epoch 119/200 |loss: 9.039494| train set 5.008x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 15
Epoch 120/200 |loss: 9.636443| train set 5.008x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 16
Epoch 121/200 |loss: 8.697132| train set 4.921x speedup, test set 0.966x speedup, val set 1.149x speedup, step: 17
Epoch 122/200 |loss: 8.792964| train set 4.958x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 1
Epoch 123/200 |loss: 7.096980| train set 4.954x speedup, test set 0.966x speedup, val set 0.901x speedup, step: 2
Epoch 124/200 |loss: 9.310838| train set 4.916x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 3
Epoch 125/200 |loss: 9.357033| train set 5.007x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 4
Epoch 126/200 |loss: 10.338814| train set 5.007x speedup, test set 0.955x speedup, val set 0.729x speedup, step: 5
Epoch 127/200 |loss: 8.614884| train set 5.007x speedup, test set 0.971x speedup, val set 0.735x speedup, step: 6
Epoch 128/200 |loss: 9.730294| train set 5.007x speedup, test set 0.971x speedup, val set 0.735x speedup, step: 7
Epoch 129/200 |loss: 8.346814| train set 5.008x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 8
Epoch 130/200 |loss: 9.356477| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 9
Epoch 131/200 |loss: 8.723515| train set 4.958x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 10
Epoch 132/200 |loss: 9.259427| train set 4.954x speedup, test set 0.966x speedup, val set 1.165x speedup, step: 11
Epoch 133/200 |loss: 7.787654| train set 4.709x speedup, test set 0.966x speedup, val set 1.165x speedup, step: 12
Epoch 134/200 |loss: 6.723697| train set 4.958x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 13
Epoch 135/200 |loss: 8.514238| train set 4.958x speedup, test set 0.982x speedup, val set 0.733x speedup, step: 14
Epoch 136/200 |loss: 7.672219| train set 5.008x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 15
Epoch 137/200 |loss: 8.523808| train set 5.008x speedup, test set 0.989x speedup, val set 0.762x speedup, step: 16
Epoch 138/200 |loss: 9.574081| train set 5.008x speedup, test set 0.991x speedup, val set 1.006x speedup, step: 17
Epoch 139/200 |loss: 9.059698| train set 5.008x speedup, test set 0.987x speedup, val set 0.994x speedup, step: 18
Epoch 140/200 |loss: 8.006794| train set 4.873x speedup, test set 0.994x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.160384| train set 4.958x speedup, test set 0.994x speedup, val set 1.228x speedup, step: 2
Epoch 142/200 |loss: 8.855780| train set 4.921x speedup, test set 0.994x speedup, val set 1.165x speedup, step: 3
Epoch 143/200 |loss: 9.193503| train set 5.008x speedup, test set 0.994x speedup, val set 1.302x speedup, step: 1
Epoch 144/200 |loss: 8.532422| train set 4.958x speedup, test set 0.994x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.442371| train set 4.958x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 2
Epoch 146/200 |loss: 9.529974| train set 4.957x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 3
Epoch 147/200 |loss: 9.642349| train set 4.957x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 1
Epoch 148/200 |loss: 8.521438| train set 5.007x speedup, test set 0.982x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 8.925748| train set 4.920x speedup, test set 0.982x speedup, val set 0.980x speedup, step: 2
Epoch 150/200 |loss: 9.908809| train set 5.007x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 3
Epoch 151/200 |loss: 9.019985| train set 5.007x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 4
Epoch 152/200 |loss: 7.596501| train set 4.921x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 5
Epoch 153/200 |loss: 9.957038| train set 4.921x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 6
Epoch 154/200 |loss: 9.156057| train set 5.008x speedup, test set 0.966x speedup, val set 1.211x speedup, step: 7
Epoch 155/200 |loss: 9.622009| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 8
Epoch 156/200 |loss: 9.077404| train set 5.008x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 9
Epoch 157/200 |loss: 9.333613| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 10
Epoch 158/200 |loss: 10.469329| train set 4.921x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 11
Epoch 159/200 |loss: 7.641735| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 12
Epoch 160/200 |loss: 7.819920| train set 5.008x speedup, test set 0.966x speedup, val set 0.806x speedup, step: 13
Epoch 161/200 |loss: 9.012987| train set 5.004x speedup, test set 0.966x speedup, val set 1.165x speedup, step: 14
Epoch 162/200 |loss: 8.129460| train set 5.004x speedup, test set 0.966x speedup, val set 0.770x speedup, step: 15
Epoch 163/200 |loss: 7.747723| train set 5.004x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 16
Epoch 164/200 |loss: 8.894644| train set 5.008x speedup, test set 0.966x speedup, val set 0.957x speedup, step: 17
Epoch 165/200 |loss: 7.860893| train set 5.008x speedup, test set 0.966x speedup, val set 0.855x speedup, step: 18
Epoch 166/200 |loss: 9.018414| train set 5.007x speedup, test set 0.966x speedup, val set 0.806x speedup, step: 19
Epoch 167/200 |loss: 9.484731| train set 4.920x speedup, test set 0.966x speedup, val set 0.901x speedup, step: 20
Epoch 168/200 |loss: 8.829384| train set 4.957x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 1
Epoch 169/200 |loss: 8.313812| train set 4.873x speedup, test set 0.966x speedup, val set 1.302x speedup, step: 1
Epoch 170/200 |loss: 8.716880| train set 4.873x speedup, test set 0.966x speedup, val set 1.133x speedup, step: 2
Epoch 171/200 |loss: 9.337229| train set 4.873x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 3
Epoch 172/200 |loss: 9.955081| train set 4.958x speedup, test set 0.966x speedup, val set 1.149x speedup, step: 4
Epoch 173/200 |loss: 8.272066| train set 4.958x speedup, test set 0.967x speedup, val set 1.211x speedup, step: 5
Epoch 174/200 |loss: 8.910800| train set 4.957x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 6
Epoch 175/200 |loss: 10.002537| train set 4.920x speedup, test set 0.982x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 9.036695| train set 5.007x speedup, test set 0.971x speedup, val set 0.786x speedup, step: 8
Epoch 177/200 |loss: 8.323430| train set 4.957x speedup, test set 0.983x speedup, val set 1.228x speedup, step: 9
Epoch 178/200 |loss: 9.135891| train set 4.958x speedup, test set 0.966x speedup, val set 0.806x speedup, step: 10
Epoch 179/200 |loss: 8.450654| train set 5.002x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 11
Epoch 180/200 |loss: 8.943794| train set 4.958x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 12
Epoch 181/200 |loss: 8.566359| train set 4.958x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 13
Epoch 182/200 |loss: 9.373725| train set 4.958x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 14
Epoch 183/200 |loss: 8.370859| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 15
Epoch 184/200 |loss: 7.380527| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 16
Epoch 185/200 |loss: 8.534726| train set 5.004x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 17
Epoch 186/200 |loss: 8.974332| train set 4.753x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 18
Epoch 187/200 |loss: 8.379104| train set 5.007x speedup, test set 0.966x speedup, val set 1.211x speedup, step: 19
Epoch 188/200 |loss: 8.323721| train set 5.007x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 20
Epoch 189/200 |loss: 8.668362| train set 5.007x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 21
Epoch 190/200 |loss: 8.662215| train set 5.007x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 22
Epoch 191/200 |loss: 7.874364| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 23
Epoch 192/200 |loss: 9.853223| train set 4.921x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 24
Epoch 193/200 |loss: 9.262546| train set 4.921x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 25
Epoch 194/200 |loss: 9.808291| train set 4.921x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 26
Epoch 195/200 |loss: 7.483386| train set 4.958x speedup, test set 0.966x speedup, val set 1.211x speedup, step: 27
Epoch 196/200 |loss: 8.656693| train set 4.958x speedup, test set 0.966x speedup, val set 1.133x speedup, step: 28
Epoch 197/200 |loss: 8.780567| train set 4.958x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 29
Epoch 198/200 |loss: 9.624100| train set 4.954x speedup, test set 1.011x speedup, val set 0.795x speedup, step: 30
Epoch 199/200 |loss: 7.648965| train set 4.958x speedup, test set 0.966x speedup, val set 0.762x speedup, step: 31
Training per epoch cost 0.331 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 1.008, val speedup 0.729
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 169, train speedup 4.873, test speedup 0.966, val speedup 1.302
last model at epoch 199, train speedup 4.958, test speedup 0.966, val speedup 0.762
execution cost 0:02:39.715686
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.946776, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281974| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286847| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936653| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.794127| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.084895| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.898475| train set 3.146x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588904| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.621379| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.479291| train set 3.958x speedup, test set 1.012x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.773629| train set 3.958x speedup, test set 0.934x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.428044| train set 4.286x speedup, test set 0.986x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.939330| train set 4.630x speedup, test set 0.870x speedup, val set 1.072x speedup, step: 14
Epoch 14/200 |loss: 14.082243| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.129579| train set 4.895x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.696773| train set 4.631x speedup, test set 1.031x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.616606| train set 4.670x speedup, test set 0.868x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213688| train set 4.958x speedup, test set 0.892x speedup, val set 1.041x speedup, step: 19
Epoch 19/200 |loss: 10.011619| train set 4.958x speedup, test set 1.007x speedup, val set 1.041x speedup, step: 20
Epoch 20/200 |loss: 12.344686| train set 4.631x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.780986| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.413539| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.846811| train set 5.007x speedup, test set 1.014x speedup, val set 0.965x speedup, step: 24
Epoch 24/200 |loss: 11.905702| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.520839| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.640491| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 12.275298| train set 4.958x speedup, test set 0.991x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 10.214448| train set 5.008x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 10.202326| train set 5.008x speedup, test set 1.008x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 10.573527| train set 4.958x speedup, test set 1.026x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.145005| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.400838| train set 4.708x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 10.834268| train set 4.670x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.098907| train set 4.894x speedup, test set 1.002x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 13.224072| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 36
Epoch 36/200 |loss: 12.934652| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.870625| train set 5.008x speedup, test set 1.026x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 10.874273| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.760619| train set 4.715x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.786838| train set 5.008x speedup, test set 0.992x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.404427| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.448135| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.189570| train set 4.958x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.159636| train set 4.958x speedup, test set 1.019x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.220241| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 10.404284| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 47
Epoch 47/200 |loss: 9.556046| train set 4.452x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 48
Epoch 48/200 |loss: 9.550282| train set 4.754x speedup, test set 0.987x speedup, val set 0.957x speedup, step: 49
Epoch 49/200 |loss: 9.766663| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 50
Epoch 50/200 |loss: 9.590718| train set 4.958x speedup, test set 0.966x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 9.936621| train set 4.958x speedup, test set 0.952x speedup, val set 0.994x speedup, step: 52
Epoch 52/200 |loss: 10.763821| train set 4.873x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 9.012414| train set 4.921x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 9.010814| train set 4.670x speedup, test set 0.962x speedup, val set 0.957x speedup, step: 55
Epoch 55/200 |loss: 10.052274| train set 4.958x speedup, test set 0.962x speedup, val set 0.957x speedup, step: 56
Epoch 56/200 |loss: 8.996385| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.373239| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.462876| train set 5.008x speedup, test set 0.952x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.817637| train set 5.007x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 60
Epoch 60/200 |loss: 9.271240| train set 5.008x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.021121| train set 4.958x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 62
Epoch 62/200 |loss: 8.128627| train set 4.873x speedup, test set 0.968x speedup, val set 1.033x speedup, step: 63
Epoch 63/200 |loss: 8.639180| train set 4.869x speedup, test set 0.968x speedup, val set 1.033x speedup, step: 64
Epoch 64/200 |loss: 8.316514| train set 5.007x speedup, test set 0.987x speedup, val set 1.033x speedup, step: 65
Epoch 65/200 |loss: 8.861754| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 66
Epoch 66/200 |loss: 9.831614| train set 5.008x speedup, test set 0.991x speedup, val set 0.752x speedup, step: 67
Epoch 67/200 |loss: 7.375991| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.166273| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.094691| train set 4.715x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.604210| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.316872| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 7.789023| train set 5.007x speedup, test set 0.982x speedup, val set 0.882x speedup, step: 73
Epoch 73/200 |loss: 8.850727| train set 5.007x speedup, test set 0.966x speedup, val set 1.241x speedup, step: 74
Epoch 74/200 |loss: 9.199036| train set 5.007x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 75
Epoch 75/200 |loss: 8.699131| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 76
Epoch 76/200 |loss: 7.088608| train set 4.920x speedup, test set 0.987x speedup, val set 1.033x speedup, step: 77
Epoch 77/200 |loss: 8.145610| train set 5.007x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 78
Epoch 78/200 |loss: 9.050872| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.842424| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 80
Epoch 80/200 |loss: 7.415917| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 81
Epoch 81/200 |loss: 10.125292| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 8.779968| train set 5.004x speedup, test set 1.039x speedup, val set 0.902x speedup, step: 83
Epoch 83/200 |loss: 8.739922| train set 5.008x speedup, test set 0.982x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 9.014533| train set 4.921x speedup, test set 0.994x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.207654| train set 4.921x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.875145| train set 5.008x speedup, test set 0.994x speedup, val set 0.729x speedup, step: 87
Epoch 87/200 |loss: 9.600965| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.815489| train set 4.991x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 89
Epoch 89/200 |loss: 8.308217| train set 4.958x speedup, test set 0.979x speedup, val set 0.735x speedup, step: 90
Epoch 90/200 |loss: 8.831102| train set 5.008x speedup, test set 0.999x speedup, val set 0.957x speedup, step: 91
Epoch 91/200 |loss: 8.892512| train set 5.008x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.386335| train set 5.008x speedup, test set 0.999x speedup, val set 1.033x speedup, step: 93
Epoch 93/200 |loss: 9.354442| train set 5.008x speedup, test set 0.986x speedup, val set 1.033x speedup, step: 94
Epoch 94/200 |loss: 8.341384| train set 5.008x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 95
Epoch 95/200 |loss: 9.211607| train set 4.958x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 96
Epoch 96/200 |loss: 9.080052| train set 4.958x speedup, test set 0.963x speedup, val set 1.006x speedup, step: 97
Epoch 97/200 |loss: 9.036936| train set 4.958x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 98
Epoch 98/200 |loss: 8.678922| train set 5.008x speedup, test set 0.963x speedup, val set 1.033x speedup, step: 99
Epoch 99/200 |loss: 9.641243| train set 5.008x speedup, test set 0.966x speedup, val set 0.980x speedup, step: 100
Epoch 100/200 |loss: 9.194596| train set 5.008x speedup, test set 0.982x speedup, val set 0.879x speedup, step: 1
Epoch 101/200 |loss: 9.911103| train set 4.715x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 1
Epoch 102/200 |loss: 9.170353| train set 4.958x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 1
Epoch 103/200 |loss: 9.346096| train set 4.917x speedup, test set 0.979x speedup, val set 0.836x speedup, step: 2
Epoch 104/200 |loss: 8.672087| train set 4.917x speedup, test set 0.979x speedup, val set 0.836x speedup, step: 3
Epoch 105/200 |loss: 7.751801| train set 5.007x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.630351| train set 5.007x speedup, test set 0.987x speedup, val set 1.150x speedup, step: 2
Epoch 107/200 |loss: 8.823670| train set 5.007x speedup, test set 0.987x speedup, val set 0.980x speedup, step: 3
Epoch 108/200 |loss: 8.317384| train set 4.753x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 4
Epoch 109/200 |loss: 9.195014| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 1
Epoch 110/200 |loss: 7.704819| train set 4.958x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 111/200 |loss: 8.699748| train set 4.954x speedup, test set 0.963x speedup, val set 1.006x speedup, step: 2
Epoch 112/200 |loss: 8.875125| train set 4.987x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 3
Epoch 113/200 |loss: 8.539892| train set 5.008x speedup, test set 0.963x speedup, val set 0.994x speedup, step: 4
Epoch 114/200 |loss: 9.526721| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 5
Epoch 115/200 |loss: 7.789836| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 6
Epoch 116/200 |loss: 7.797085| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 7
Epoch 117/200 |loss: 9.957948| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 8
Epoch 118/200 |loss: 8.888425| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 9
Epoch 119/200 |loss: 8.846863| train set 5.008x speedup, test set 1.008x speedup, val set 0.735x speedup, step: 10
Epoch 120/200 |loss: 9.648276| train set 4.921x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 11
Epoch 121/200 |loss: 8.521140| train set 4.921x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 12
Epoch 122/200 |loss: 8.611961| train set 4.818x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 13
Epoch 123/200 |loss: 7.074915| train set 4.957x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 14
Epoch 124/200 |loss: 9.276249| train set 4.920x speedup, test set 0.979x speedup, val set 0.762x speedup, step: 15
Epoch 125/200 |loss: 9.491747| train set 5.007x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 16
Epoch 126/200 |loss: 9.892852| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 17
Epoch 127/200 |loss: 8.495404| train set 5.007x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 18
Epoch 128/200 |loss: 9.151353| train set 5.007x speedup, test set 0.986x speedup, val set 0.804x speedup, step: 19
Epoch 129/200 |loss: 8.569509| train set 5.008x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 20
Epoch 130/200 |loss: 9.159610| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 21
Epoch 131/200 |loss: 8.854152| train set 4.991x speedup, test set 0.979x speedup, val set 1.149x speedup, step: 22
Epoch 132/200 |loss: 9.182616| train set 4.954x speedup, test set 0.979x speedup, val set 1.165x speedup, step: 23
Epoch 133/200 |loss: 7.442628| train set 4.958x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 1
Epoch 134/200 |loss: 6.984896| train set 4.958x speedup, test set 0.979x speedup, val set 1.211x speedup, step: 2
Epoch 135/200 |loss: 8.485051| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 3
Epoch 136/200 |loss: 7.586742| train set 5.008x speedup, test set 0.977x speedup, val set 0.804x speedup, step: 4
Epoch 137/200 |loss: 8.858256| train set 5.008x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 5
Epoch 138/200 |loss: 9.448702| train set 5.008x speedup, test set 0.963x speedup, val set 1.211x speedup, step: 6
Epoch 139/200 |loss: 9.003653| train set 4.921x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 7
Epoch 140/200 |loss: 7.909685| train set 4.958x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 8
Epoch 141/200 |loss: 8.433779| train set 5.008x speedup, test set 0.952x speedup, val set 1.228x speedup, step: 9
Epoch 142/200 |loss: 8.415922| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 10
Epoch 143/200 |loss: 9.261652| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 11
Epoch 144/200 |loss: 8.708188| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.604170| train set 5.007x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 2
Epoch 146/200 |loss: 9.201470| train set 4.920x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 3
Epoch 147/200 |loss: 9.737902| train set 4.872x speedup, test set 0.963x speedup, val set 1.211x speedup, step: 4
Epoch 148/200 |loss: 8.351028| train set 4.957x speedup, test set 0.978x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 9.144774| train set 5.007x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 1
Epoch 150/200 |loss: 9.817349| train set 5.007x speedup, test set 0.991x speedup, val set 0.777x speedup, step: 2
Epoch 151/200 |loss: 9.099206| train set 5.005x speedup, test set 1.038x speedup, val set 0.795x speedup, step: 3
Epoch 152/200 |loss: 7.928078| train set 5.008x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 4
Epoch 153/200 |loss: 9.889499| train set 5.008x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 5
Epoch 154/200 |loss: 8.985539| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 6
Epoch 155/200 |loss: 9.370743| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 7
Epoch 156/200 |loss: 8.831794| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 157/200 |loss: 9.205015| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 9
Epoch 158/200 |loss: 10.427816| train set 4.921x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 10
Epoch 159/200 |loss: 7.924888| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 11
Epoch 160/200 |loss: 7.806353| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 12
Epoch 161/200 |loss: 9.127657| train set 5.008x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 13
Epoch 162/200 |loss: 8.090951| train set 5.008x speedup, test set 1.029x speedup, val set 0.742x speedup, step: 14
Epoch 163/200 |loss: 7.630840| train set 5.008x speedup, test set 1.029x speedup, val set 0.735x speedup, step: 15
Epoch 164/200 |loss: 8.865474| train set 5.008x speedup, test set 1.025x speedup, val set 0.729x speedup, step: 16
Epoch 165/200 |loss: 8.020847| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 17
Epoch 166/200 |loss: 9.067128| train set 5.008x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 18
Epoch 167/200 |loss: 9.801134| train set 4.920x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 19
Epoch 168/200 |loss: 8.890870| train set 4.957x speedup, test set 0.963x speedup, val set 1.211x speedup, step: 20
Epoch 169/200 |loss: 8.099810| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 170/200 |loss: 8.769596| train set 4.873x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 2
Epoch 171/200 |loss: 9.395925| train set 4.873x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 3
Epoch 172/200 |loss: 9.976494| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 4
Epoch 173/200 |loss: 8.097919| train set 4.957x speedup, test set 0.963x speedup, val set 0.798x speedup, step: 5
Epoch 174/200 |loss: 9.170440| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 6
Epoch 175/200 |loss: 9.880041| train set 4.916x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 9.094816| train set 4.920x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 177/200 |loss: 8.327092| train set 4.957x speedup, test set 0.963x speedup, val set 1.211x speedup, step: 9
Epoch 178/200 |loss: 9.061840| train set 4.958x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 10
Epoch 179/200 |loss: 8.519267| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 11
Epoch 180/200 |loss: 9.137097| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 12
Epoch 181/200 |loss: 8.619197| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 13
Epoch 182/200 |loss: 9.451691| train set 4.958x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 14
Epoch 183/200 |loss: 8.700865| train set 4.958x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 15
Epoch 184/200 |loss: 7.574110| train set 4.921x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 16
Epoch 185/200 |loss: 8.688282| train set 4.913x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 17
Epoch 186/200 |loss: 9.156825| train set 5.008x speedup, test set 0.979x speedup, val set 0.944x speedup, step: 18
Epoch 187/200 |loss: 8.432503| train set 5.007x speedup, test set 0.979x speedup, val set 1.211x speedup, step: 19
Epoch 188/200 |loss: 8.390315| train set 5.007x speedup, test set 0.963x speedup, val set 0.762x speedup, step: 20
Epoch 189/200 |loss: 8.712691| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 21
Epoch 190/200 |loss: 8.685843| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 22
Epoch 191/200 |loss: 7.778607| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 23
Epoch 192/200 |loss: 9.744343| train set 4.921x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 24
Epoch 193/200 |loss: 9.144760| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 25
Epoch 194/200 |loss: 9.643752| train set 4.921x speedup, test set 0.963x speedup, val set 0.955x speedup, step: 26
Epoch 195/200 |loss: 7.572318| train set 5.008x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 27
Epoch 196/200 |loss: 8.530988| train set 4.991x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 28
Epoch 197/200 |loss: 8.879671| train set 4.954x speedup, test set 0.963x speedup, val set 0.826x speedup, step: 29
Epoch 198/200 |loss: 9.181478| train set 4.954x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 30
Epoch 199/200 |loss: 7.551974| train set 5.008x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 31
Training per epoch cost 0.332 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 0.991, val speedup 0.729
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 169, train speedup 4.958, test speedup 0.963, val speedup 1.302
last model at epoch 199, train speedup 5.008, test speedup 0.963, val speedup 0.804
execution cost 0:02:42.251796
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.952320, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281971| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286846| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179350| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793522| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089588| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.912633| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.587205| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.575417| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.370785| train set 3.958x speedup, test set 1.022x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.755565| train set 4.032x speedup, test set 0.971x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.455398| train set 4.285x speedup, test set 0.975x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.921763| train set 4.630x speedup, test set 0.870x speedup, val set 0.758x speedup, step: 14
Epoch 14/200 |loss: 13.914977| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.109001| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.590153| train set 4.630x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.591466| train set 4.670x speedup, test set 0.917x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213895| train set 5.008x speedup, test set 1.001x speedup, val set 0.965x speedup, step: 19
Epoch 19/200 |loss: 10.153143| train set 4.958x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 20
Epoch 20/200 |loss: 12.500185| train set 4.958x speedup, test set 1.019x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 12.041663| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.292416| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.732600| train set 5.007x speedup, test set 0.995x speedup, val set 0.733x speedup, step: 24
Epoch 24/200 |loss: 11.939276| train set 5.007x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.750334| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.650596| train set 4.958x speedup, test set 1.003x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 12.273293| train set 4.958x speedup, test set 1.017x speedup, val set 1.041x speedup, step: 28
Epoch 28/200 |loss: 10.432226| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 10.308301| train set 4.921x speedup, test set 1.020x speedup, val set 0.729x speedup, step: 30
Epoch 30/200 |loss: 10.673965| train set 5.008x speedup, test set 0.970x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.563123| train set 4.958x speedup, test set 1.042x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.559591| train set 4.708x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 11.147722| train set 4.412x speedup, test set 0.996x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.381807| train set 4.614x speedup, test set 0.890x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 13.465428| train set 5.007x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 12.720515| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 9.710652| train set 5.008x speedup, test set 1.035x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 10.926427| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 39
Epoch 39/200 |loss: 10.593658| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.880182| train set 4.895x speedup, test set 1.054x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.666093| train set 4.812x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.506736| train set 5.008x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 43
Epoch 43/200 |loss: 10.665320| train set 4.631x speedup, test set 1.020x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.087110| train set 4.958x speedup, test set 1.029x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.370608| train set 5.008x speedup, test set 1.030x speedup, val set 1.033x speedup, step: 46
Epoch 46/200 |loss: 10.454017| train set 5.008x speedup, test set 1.012x speedup, val set 1.033x speedup, step: 47
Epoch 47/200 |loss: 9.845751| train set 4.674x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 48
Epoch 48/200 |loss: 9.469100| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 49
Epoch 49/200 |loss: 9.854937| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.320099| train set 4.958x speedup, test set 1.012x speedup, val set 1.302x speedup, step: 51
Epoch 51/200 |loss: 9.992686| train set 4.958x speedup, test set 1.012x speedup, val set 1.302x speedup, step: 52
Epoch 52/200 |loss: 10.501259| train set 4.921x speedup, test set 1.003x speedup, val set 0.957x speedup, step: 53
Epoch 53/200 |loss: 9.044366| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 54
Epoch 54/200 |loss: 8.910245| train set 4.715x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 55
Epoch 55/200 |loss: 9.852275| train set 5.008x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 56
Epoch 56/200 |loss: 8.851513| train set 5.008x speedup, test set 1.003x speedup, val set 1.002x speedup, step: 57
Epoch 57/200 |loss: 10.279510| train set 5.008x speedup, test set 1.003x speedup, val set 1.316x speedup, step: 58
Epoch 58/200 |loss: 9.617699| train set 5.008x speedup, test set 1.003x speedup, val set 1.316x speedup, step: 59
Epoch 59/200 |loss: 8.438275| train set 5.007x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 60
Epoch 60/200 |loss: 9.444951| train set 4.957x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 61
Epoch 61/200 |loss: 10.187062| train set 4.958x speedup, test set 1.012x speedup, val set 1.041x speedup, step: 62
Epoch 62/200 |loss: 8.043714| train set 4.869x speedup, test set 1.003x speedup, val set 1.316x speedup, step: 63
Epoch 63/200 |loss: 8.860945| train set 4.869x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 64
Epoch 64/200 |loss: 8.298883| train set 4.921x speedup, test set 1.012x speedup, val set 1.041x speedup, step: 65
Epoch 65/200 |loss: 8.984822| train set 5.008x speedup, test set 1.003x speedup, val set 1.253x speedup, step: 66
Epoch 66/200 |loss: 10.103783| train set 5.004x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 67
Epoch 67/200 |loss: 7.376492| train set 5.008x speedup, test set 1.003x speedup, val set 1.073x speedup, step: 68
Epoch 68/200 |loss: 9.238705| train set 5.008x speedup, test set 1.003x speedup, val set 1.241x speedup, step: 69
Epoch 69/200 |loss: 9.185530| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 70
Epoch 70/200 |loss: 8.471664| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 71
Epoch 71/200 |loss: 9.472945| train set 5.007x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 72
Epoch 72/200 |loss: 7.967017| train set 5.007x speedup, test set 1.003x speedup, val set 1.316x speedup, step: 73
Epoch 73/200 |loss: 8.962265| train set 5.007x speedup, test set 1.003x speedup, val set 1.160x speedup, step: 74
Epoch 74/200 |loss: 9.425964| train set 5.007x speedup, test set 1.003x speedup, val set 1.268x speedup, step: 75
Epoch 75/200 |loss: 8.758174| train set 5.007x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 76
Epoch 76/200 |loss: 7.300834| train set 5.007x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 77
Epoch 77/200 |loss: 8.269314| train set 5.007x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 78
Epoch 78/200 |loss: 9.158705| train set 5.007x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.816539| train set 4.921x speedup, test set 1.003x speedup, val set 1.006x speedup, step: 80
Epoch 80/200 |loss: 7.626404| train set 5.008x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.319512| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 9.165463| train set 5.004x speedup, test set 1.034x speedup, val set 0.828x speedup, step: 83
Epoch 83/200 |loss: 8.626135| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 84
Epoch 84/200 |loss: 9.147108| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 85
Epoch 85/200 |loss: 8.184558| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 9.117219| train set 5.008x speedup, test set 1.003x speedup, val set 1.144x speedup, step: 87
Epoch 87/200 |loss: 9.672840| train set 5.008x speedup, test set 1.003x speedup, val set 1.316x speedup, step: 88
Epoch 88/200 |loss: 7.819426| train set 5.008x speedup, test set 0.991x speedup, val set 0.944x speedup, step: 89
Epoch 89/200 |loss: 8.321116| train set 5.008x speedup, test set 0.991x speedup, val set 0.739x speedup, step: 90
Epoch 90/200 |loss: 8.743039| train set 5.008x speedup, test set 1.003x speedup, val set 1.041x speedup, step: 91
Epoch 91/200 |loss: 8.687002| train set 5.008x speedup, test set 1.003x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.270813| train set 5.008x speedup, test set 0.991x speedup, val set 1.033x speedup, step: 93
Epoch 93/200 |loss: 9.199991| train set 5.008x speedup, test set 0.998x speedup, val set 1.006x speedup, step: 94
Epoch 94/200 |loss: 8.424006| train set 5.008x speedup, test set 0.998x speedup, val set 1.133x speedup, step: 95
Epoch 95/200 |loss: 8.866994| train set 4.957x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 96
Epoch 96/200 |loss: 9.137594| train set 4.958x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 97
Epoch 97/200 |loss: 8.943130| train set 4.958x speedup, test set 1.003x speedup, val set 0.957x speedup, step: 98
Epoch 98/200 |loss: 8.777761| train set 4.958x speedup, test set 1.003x speedup, val set 1.133x speedup, step: 99
Epoch 99/200 |loss: 9.375370| train set 5.008x speedup, test set 1.003x speedup, val set 0.735x speedup, step: 100
Epoch 100/200 |loss: 9.111809| train set 5.008x speedup, test set 1.003x speedup, val set 0.742x speedup, step: 1
Epoch 101/200 |loss: 9.948699| train set 4.715x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 2
Epoch 102/200 |loss: 8.865469| train set 5.008x speedup, test set 0.999x speedup, val set 1.211x speedup, step: 1
Epoch 103/200 |loss: 9.429078| train set 5.004x speedup, test set 1.003x speedup, val set 0.804x speedup, step: 2
Epoch 104/200 |loss: 8.452630| train set 4.917x speedup, test set 1.003x speedup, val set 0.762x speedup, step: 3
Epoch 105/200 |loss: 7.717073| train set 4.920x speedup, test set 1.003x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.366781| train set 5.007x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 2
Epoch 107/200 |loss: 9.080048| train set 4.753x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 3
Epoch 108/200 |loss: 8.129081| train set 4.754x speedup, test set 0.999x speedup, val set 0.735x speedup, step: 4
Epoch 109/200 |loss: 9.262980| train set 5.008x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 5
Epoch 110/200 |loss: 7.568338| train set 5.004x speedup, test set 0.991x speedup, val set 0.980x speedup, step: 6
Epoch 111/200 |loss: 8.871143| train set 4.950x speedup, test set 0.987x speedup, val set 1.033x speedup, step: 7
Epoch 112/200 |loss: 9.634518| train set 4.958x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 8
Epoch 113/200 |loss: 8.693277| train set 5.004x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 9
Epoch 114/200 |loss: 9.593217| train set 5.008x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 10
Epoch 115/200 |loss: 7.982610| train set 5.008x speedup, test set 0.991x speedup, val set 0.798x speedup, step: 11
Epoch 116/200 |loss: 8.091474| train set 5.008x speedup, test set 0.999x speedup, val set 0.762x speedup, step: 12
Epoch 117/200 |loss: 9.894629| train set 5.008x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 13
Epoch 118/200 |loss: 8.996455| train set 5.008x speedup, test set 0.999x speedup, val set 0.729x speedup, step: 14
Epoch 119/200 |loss: 8.989615| train set 5.008x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 15
Epoch 120/200 |loss: 9.830398| train set 5.008x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 16
Epoch 121/200 |loss: 8.528869| train set 4.921x speedup, test set 1.003x speedup, val set 1.228x speedup, step: 17
Epoch 122/200 |loss: 8.713005| train set 4.958x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 123/200 |loss: 7.096640| train set 4.873x speedup, test set 1.003x speedup, val set 0.990x speedup, step: 2
Epoch 124/200 |loss: 9.158036| train set 4.921x speedup, test set 0.999x speedup, val set 0.868x speedup, step: 3
Epoch 125/200 |loss: 9.528999| train set 5.007x speedup, test set 0.999x speedup, val set 1.228x speedup, step: 4
Epoch 126/200 |loss: 10.076231| train set 5.007x speedup, test set 0.999x speedup, val set 1.149x speedup, step: 5
Epoch 127/200 |loss: 8.554537| train set 5.007x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 6
Epoch 128/200 |loss: 9.353234| train set 5.007x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 7
Epoch 129/200 |loss: 8.420434| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 8
Epoch 130/200 |loss: 9.076101| train set 5.008x speedup, test set 0.987x speedup, val set 1.133x speedup, step: 9
Epoch 131/200 |loss: 8.879789| train set 4.958x speedup, test set 0.999x speedup, val set 1.302x speedup, step: 1
Epoch 132/200 |loss: 9.143145| train set 4.954x speedup, test set 0.987x speedup, val set 1.165x speedup, step: 2
Epoch 133/200 |loss: 7.600759| train set 4.952x speedup, test set 0.987x speedup, val set 1.228x speedup, step: 3
Epoch 134/200 |loss: 6.966846| train set 4.958x speedup, test set 0.999x speedup, val set 1.222x speedup, step: 4
Epoch 135/200 |loss: 8.576109| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 5
Epoch 136/200 |loss: 7.519864| train set 5.008x speedup, test set 0.991x speedup, val set 0.804x speedup, step: 6
Epoch 137/200 |loss: 8.447509| train set 5.008x speedup, test set 0.991x speedup, val set 0.762x speedup, step: 7
Epoch 138/200 |loss: 9.532906| train set 5.008x speedup, test set 0.991x speedup, val set 0.965x speedup, step: 8
Epoch 139/200 |loss: 8.798327| train set 5.008x speedup, test set 0.991x speedup, val set 1.316x speedup, step: 1
Epoch 140/200 |loss: 7.800538| train set 4.958x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 2
Epoch 141/200 |loss: 8.220501| train set 4.921x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 3
Epoch 142/200 |loss: 8.507099| train set 4.921x speedup, test set 0.987x speedup, val set 1.165x speedup, step: 4
Epoch 143/200 |loss: 9.188470| train set 4.958x speedup, test set 1.009x speedup, val set 1.211x speedup, step: 5
Epoch 144/200 |loss: 8.714046| train set 4.957x speedup, test set 1.009x speedup, val set 1.302x speedup, step: 6
Epoch 145/200 |loss: 9.415969| train set 4.872x speedup, test set 0.987x speedup, val set 1.165x speedup, step: 7
Epoch 146/200 |loss: 9.487057| train set 4.920x speedup, test set 0.991x speedup, val set 0.742x speedup, step: 8
Epoch 147/200 |loss: 9.629425| train set 5.007x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 9
Epoch 148/200 |loss: 8.461511| train set 5.007x speedup, test set 0.987x speedup, val set 1.316x speedup, step: 1
Epoch 149/200 |loss: 8.751919| train set 5.007x speedup, test set 0.983x speedup, val set 1.241x speedup, step: 2
Epoch 150/200 |loss: 9.990765| train set 5.003x speedup, test set 0.995x speedup, val set 0.980x speedup, step: 3
Epoch 151/200 |loss: 8.914896| train set 4.920x speedup, test set 0.983x speedup, val set 0.980x speedup, step: 4
Epoch 152/200 |loss: 7.696976| train set 5.008x speedup, test set 0.987x speedup, val set 1.006x speedup, step: 5
Epoch 153/200 |loss: 9.578697| train set 5.008x speedup, test set 0.987x speedup, val set 1.253x speedup, step: 6
Epoch 154/200 |loss: 9.026300| train set 5.008x speedup, test set 1.001x speedup, val set 1.144x speedup, step: 7
Epoch 155/200 |loss: 9.379839| train set 5.008x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 8
Epoch 156/200 |loss: 8.826344| train set 5.008x speedup, test set 0.987x speedup, val set 1.133x speedup, step: 9
Epoch 157/200 |loss: 9.394817| train set 4.958x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 10
Epoch 158/200 |loss: 10.506338| train set 4.917x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 11
Epoch 159/200 |loss: 7.805346| train set 5.004x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 12
Epoch 160/200 |loss: 7.742275| train set 5.008x speedup, test set 0.979x speedup, val set 0.735x speedup, step: 13
Epoch 161/200 |loss: 9.278975| train set 5.008x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 14
Epoch 162/200 |loss: 8.139657| train set 5.008x speedup, test set 0.991x speedup, val set 0.795x speedup, step: 15
Epoch 163/200 |loss: 7.927183| train set 5.008x speedup, test set 0.987x speedup, val set 0.742x speedup, step: 16
Epoch 164/200 |loss: 8.740499| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 17
Epoch 165/200 |loss: 8.068505| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 18
Epoch 166/200 |loss: 9.031573| train set 5.008x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 19
Epoch 167/200 |loss: 9.514551| train set 4.921x speedup, test set 0.991x speedup, val set 1.149x speedup, step: 20
Epoch 168/200 |loss: 8.740995| train set 4.957x speedup, test set 0.996x speedup, val set 1.302x speedup, step: 21
Epoch 169/200 |loss: 8.324259| train set 4.958x speedup, test set 0.975x speedup, val set 1.302x speedup, step: 22
Epoch 170/200 |loss: 8.415797| train set 4.873x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 23
Epoch 171/200 |loss: 9.303972| train set 4.873x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 24
Epoch 172/200 |loss: 9.816322| train set 4.958x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 25
Epoch 173/200 |loss: 8.181382| train set 4.957x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 26
Epoch 174/200 |loss: 8.772296| train set 5.007x speedup, test set 0.996x speedup, val set 0.742x speedup, step: 27
Epoch 175/200 |loss: 9.686473| train set 4.920x speedup, test set 0.996x speedup, val set 0.804x speedup, step: 28
Epoch 176/200 |loss: 9.120223| train set 5.007x speedup, test set 0.996x speedup, val set 0.786x speedup, step: 29
Epoch 177/200 |loss: 8.415564| train set 4.957x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 30
Epoch 178/200 |loss: 9.230338| train set 4.958x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 31
Epoch 179/200 |loss: 8.495440| train set 4.954x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 32
Epoch 180/200 |loss: 9.205241| train set 4.950x speedup, test set 0.975x speedup, val set 0.742x speedup, step: 33
Epoch 181/200 |loss: 8.748014| train set 4.958x speedup, test set 0.996x speedup, val set 0.742x speedup, step: 34
Epoch 182/200 |loss: 9.549439| train set 4.950x speedup, test set 0.996x speedup, val set 0.742x speedup, step: 35
Epoch 183/200 |loss: 8.457867| train set 4.958x speedup, test set 0.996x speedup, val set 0.735x speedup, step: 36
Epoch 184/200 |loss: 7.625542| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 37
Epoch 185/200 |loss: 8.493347| train set 5.008x speedup, test set 1.004x speedup, val set 0.742x speedup, step: 38
Epoch 186/200 |loss: 8.882734| train set 5.008x speedup, test set 0.996x speedup, val set 0.742x speedup, step: 39
Epoch 187/200 |loss: 8.556895| train set 5.007x speedup, test set 0.996x speedup, val set 0.735x speedup, step: 40
Epoch 188/200 |loss: 8.210622| train set 5.007x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 41
Epoch 189/200 |loss: 8.624216| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 42
Epoch 190/200 |loss: 8.665392| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 43
Epoch 191/200 |loss: 7.853221| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 44
Epoch 192/200 |loss: 9.605803| train set 4.921x speedup, test set 0.996x speedup, val set 0.742x speedup, step: 45
Epoch 193/200 |loss: 9.116030| train set 4.921x speedup, test set 0.996x speedup, val set 0.742x speedup, step: 46
Epoch 194/200 |loss: 9.585484| train set 4.921x speedup, test set 0.996x speedup, val set 0.742x speedup, step: 47
Epoch 195/200 |loss: 7.474050| train set 4.958x speedup, test set 1.009x speedup, val set 1.133x speedup, step: 48
Epoch 196/200 |loss: 8.742941| train set 4.958x speedup, test set 0.975x speedup, val set 0.934x speedup, step: 49
Epoch 197/200 |loss: 9.048574| train set 5.004x speedup, test set 0.975x speedup, val set 0.786x speedup, step: 50
Epoch 198/200 |loss: 9.289575| train set 5.004x speedup, test set 0.975x speedup, val set 0.804x speedup, step: 51
Epoch 199/200 |loss: 7.776523| train set 5.008x speedup, test set 0.975x speedup, val set 0.786x speedup, step: 52
Training per epoch cost 0.326 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
20, opt runtime 2.719s, model runtime 3.112s, pg runtime 3.112s, speedup 1.000x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 18, train speedup 5.008, test speedup 1.001, val speedup 0.965
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 148, train speedup 5.007, test speedup 0.987, val speedup 1.316
last model at epoch 199, train speedup 5.008, test speedup 0.975, val speedup 0.786
execution cost 0:02:38.929721
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.935791, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281972| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286847| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793528| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089633| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913028| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588155| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.558288| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.379519| train set 3.958x speedup, test set 1.040x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.760398| train set 4.032x speedup, test set 0.990x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.463957| train set 4.630x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.907601| train set 4.630x speedup, test set 0.870x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 13.917950| train set 4.630x speedup, test set 0.870x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.089217| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.489371| train set 4.630x speedup, test set 1.028x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.550648| train set 4.670x speedup, test set 0.864x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.253948| train set 4.958x speedup, test set 1.008x speedup, val set 0.733x speedup, step: 19
Epoch 19/200 |loss: 10.049407| train set 4.958x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 20
Epoch 20/200 |loss: 12.359978| train set 4.631x speedup, test set 1.022x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.622890| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.092754| train set 5.008x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 23
Epoch 23/200 |loss: 10.686905| train set 5.007x speedup, test set 0.914x speedup, val set 1.041x speedup, step: 24
Epoch 24/200 |loss: 11.745453| train set 5.007x speedup, test set 0.979x speedup, val set 0.733x speedup, step: 25
Epoch 25/200 |loss: 11.521265| train set 5.007x speedup, test set 0.979x speedup, val set 0.733x speedup, step: 26
Epoch 26/200 |loss: 10.297415| train set 5.008x speedup, test set 0.933x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 11.835088| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 28
Epoch 28/200 |loss: 10.244449| train set 4.921x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 9.385711| train set 4.865x speedup, test set 0.934x speedup, val set 0.775x speedup, step: 30
Epoch 30/200 |loss: 10.314658| train set 4.958x speedup, test set 1.016x speedup, val set 0.729x speedup, step: 31
Epoch 31/200 |loss: 10.284288| train set 4.958x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.263751| train set 4.708x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 9.888952| train set 4.957x speedup, test set 0.971x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.495334| train set 4.957x speedup, test set 0.980x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 12.491441| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 36
Epoch 36/200 |loss: 11.787388| train set 4.958x speedup, test set 1.028x speedup, val set 1.041x speedup, step: 37
Epoch 37/200 |loss: 10.565333| train set 4.715x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 38
Epoch 38/200 |loss: 9.525618| train set 4.921x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.769886| train set 4.958x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 40
Epoch 40/200 |loss: 9.578156| train set 4.958x speedup, test set 1.022x speedup, val set 1.041x speedup, step: 41
Epoch 41/200 |loss: 11.074552| train set 5.002x speedup, test set 0.991x speedup, val set 1.002x speedup, step: 42
Epoch 42/200 |loss: 10.729385| train set 4.873x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 43
Epoch 43/200 |loss: 10.634508| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.503523| train set 4.674x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 45
Epoch 45/200 |loss: 9.507009| train set 4.754x speedup, test set 1.005x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 10.570798| train set 4.754x speedup, test set 1.000x speedup, val set 1.316x speedup, step: 47
Epoch 47/200 |loss: 10.255844| train set 4.754x speedup, test set 0.979x speedup, val set 0.733x speedup, step: 48
Epoch 48/200 |loss: 9.867851| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 10.317199| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 50
Epoch 50/200 |loss: 10.173072| train set 4.631x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 51
Epoch 51/200 |loss: 10.196128| train set 4.958x speedup, test set 0.976x speedup, val set 0.729x speedup, step: 52
Epoch 52/200 |loss: 11.285166| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 9.320762| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 9.472785| train set 4.715x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 55
Epoch 55/200 |loss: 10.129454| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 56
Epoch 56/200 |loss: 9.068938| train set 4.921x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.605029| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.627326| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 59
Epoch 59/200 |loss: 8.912836| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 60
Epoch 60/200 |loss: 9.339761| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.160631| train set 4.958x speedup, test set 0.978x speedup, val set 0.762x speedup, step: 62
Epoch 62/200 |loss: 8.171957| train set 4.873x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 63
Epoch 63/200 |loss: 8.737105| train set 4.920x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 64
Epoch 64/200 |loss: 8.289894| train set 5.007x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 65
Epoch 65/200 |loss: 8.879797| train set 5.007x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 66
Epoch 66/200 |loss: 9.808543| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 67
Epoch 67/200 |loss: 7.642604| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.426905| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 69
Epoch 69/200 |loss: 9.208560| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.592753| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.312487| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 7.780205| train set 5.007x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 73
Epoch 73/200 |loss: 8.948060| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 74
Epoch 74/200 |loss: 8.991404| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 75
Epoch 75/200 |loss: 8.990798| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 76
Epoch 76/200 |loss: 7.105590| train set 4.921x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.326418| train set 5.007x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 78
Epoch 78/200 |loss: 9.026443| train set 4.883x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 79
Epoch 79/200 |loss: 8.814404| train set 5.003x speedup, test set 0.985x speedup, val set 0.729x speedup, step: 80
Epoch 80/200 |loss: 7.700886| train set 5.008x speedup, test set 0.985x speedup, val set 0.729x speedup, step: 81
Epoch 81/200 |loss: 10.425346| train set 5.008x speedup, test set 0.986x speedup, val set 0.729x speedup, step: 82
Epoch 82/200 |loss: 9.061657| train set 5.004x speedup, test set 0.990x speedup, val set 0.733x speedup, step: 83
Epoch 83/200 |loss: 8.591624| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 84
Epoch 84/200 |loss: 9.032692| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.368322| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.870581| train set 4.715x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 87
Epoch 87/200 |loss: 9.600362| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.695778| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 89
Epoch 89/200 |loss: 8.219702| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 90
Epoch 90/200 |loss: 8.518116| train set 5.008x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 91
Epoch 91/200 |loss: 8.622949| train set 5.008x speedup, test set 0.990x speedup, val set 0.729x speedup, step: 92
Epoch 92/200 |loss: 8.312010| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 93
Epoch 93/200 |loss: 9.211200| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 94
Epoch 94/200 |loss: 8.332511| train set 4.957x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 95
Epoch 95/200 |loss: 9.169957| train set 4.957x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 96
Epoch 96/200 |loss: 9.272355| train set 4.958x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 97
Epoch 97/200 |loss: 8.937792| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.709310| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 99
Epoch 99/200 |loss: 9.340825| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 100
Epoch 100/200 |loss: 9.064288| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 1
Epoch 101/200 |loss: 10.070856| train set 4.715x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 1
Epoch 102/200 |loss: 8.843290| train set 4.958x speedup, test set 1.003x speedup, val set 0.729x speedup, step: 1
Epoch 103/200 |loss: 9.365386| train set 4.917x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 1
Epoch 104/200 |loss: 8.652804| train set 4.921x speedup, test set 1.000x speedup, val set 0.729x speedup, step: 2
Epoch 105/200 |loss: 7.452579| train set 5.007x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 3
Epoch 106/200 |loss: 8.318809| train set 5.007x speedup, test set 1.012x speedup, val set 0.729x speedup, step: 4
Epoch 107/200 |loss: 8.738581| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 5
Epoch 108/200 |loss: 8.286559| train set 5.007x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 6
Epoch 109/200 |loss: 9.507849| train set 4.631x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 7
Epoch 110/200 |loss: 7.631931| train set 4.954x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 8
Epoch 111/200 |loss: 9.292467| train set 4.954x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 9
Epoch 112/200 |loss: 9.231050| train set 4.999x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 10
Epoch 113/200 |loss: 9.120797| train set 5.004x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 11
Epoch 114/200 |loss: 9.412133| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 12
Epoch 115/200 |loss: 8.004680| train set 5.008x speedup, test set 1.000x speedup, val set 0.729x speedup, step: 13
Epoch 116/200 |loss: 7.989426| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 14
Epoch 117/200 |loss: 9.724227| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 15
Epoch 118/200 |loss: 8.822258| train set 5.008x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 16
Epoch 119/200 |loss: 8.942271| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 17
Epoch 120/200 |loss: 9.675547| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 18
Epoch 121/200 |loss: 8.697610| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 19
Epoch 122/200 |loss: 8.357455| train set 4.958x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 20
Epoch 123/200 |loss: 6.912826| train set 4.958x speedup, test set 0.989x speedup, val set 0.742x speedup, step: 1
Epoch 124/200 |loss: 9.213243| train set 4.921x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 2
Epoch 125/200 |loss: 9.301468| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 3
Epoch 126/200 |loss: 10.015819| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 4
Epoch 127/200 |loss: 8.567656| train set 4.920x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 5
Epoch 128/200 |loss: 9.267667| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 6
Epoch 129/200 |loss: 8.216218| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 7
Epoch 130/200 |loss: 9.097619| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 8
Epoch 131/200 |loss: 8.666090| train set 4.958x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 9
Epoch 132/200 |loss: 9.295612| train set 4.954x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 10
Epoch 133/200 |loss: 7.366330| train set 4.958x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 11
Epoch 134/200 |loss: 6.766099| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 12
Epoch 135/200 |loss: 8.501513| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 13
Epoch 136/200 |loss: 7.546968| train set 5.008x speedup, test set 0.990x speedup, val set 0.735x speedup, step: 14
Epoch 137/200 |loss: 8.696649| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 15
Epoch 138/200 |loss: 9.565805| train set 5.008x speedup, test set 0.970x speedup, val set 0.729x speedup, step: 16
Epoch 139/200 |loss: 9.112411| train set 5.008x speedup, test set 0.956x speedup, val set 0.729x speedup, step: 17
Epoch 140/200 |loss: 8.137579| train set 4.958x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 18
Epoch 141/200 |loss: 8.581597| train set 4.958x speedup, test set 0.952x speedup, val set 0.733x speedup, step: 19
Epoch 142/200 |loss: 8.625181| train set 4.921x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 1
Epoch 143/200 |loss: 9.368888| train set 4.921x speedup, test set 0.952x speedup, val set 0.735x speedup, step: 2
Epoch 144/200 |loss: 8.710186| train set 4.958x speedup, test set 0.952x speedup, val set 0.733x speedup, step: 3
Epoch 145/200 |loss: 9.594455| train set 4.957x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 4
Epoch 146/200 |loss: 9.070177| train set 4.920x speedup, test set 0.951x speedup, val set 0.735x speedup, step: 5
Epoch 147/200 |loss: 9.698228| train set 4.957x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 6
Epoch 148/200 |loss: 8.348010| train set 4.957x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 7
Epoch 149/200 |loss: 8.787541| train set 5.007x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 8
Epoch 150/200 |loss: 9.418064| train set 4.920x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 9
Epoch 151/200 |loss: 8.929307| train set 4.920x speedup, test set 0.985x speedup, val set 0.729x speedup, step: 10
Epoch 152/200 |loss: 7.750994| train set 4.921x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 11
Epoch 153/200 |loss: 10.066655| train set 4.921x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 12
Epoch 154/200 |loss: 8.914478| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 13
Epoch 155/200 |loss: 9.028994| train set 5.008x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 14
Epoch 156/200 |loss: 8.725540| train set 5.008x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 15
Epoch 157/200 |loss: 9.340166| train set 4.958x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 16
Epoch 158/200 |loss: 10.516366| train set 4.921x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 17
Epoch 159/200 |loss: 7.918901| train set 5.008x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 18
Epoch 160/200 |loss: 7.697598| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 19
Epoch 161/200 |loss: 9.149168| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 20
Epoch 162/200 |loss: 8.099892| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 21
Epoch 163/200 |loss: 7.759681| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 22
Epoch 164/200 |loss: 8.808650| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 23
Epoch 165/200 |loss: 7.868880| train set 5.008x speedup, test set 0.979x speedup, val set 0.733x speedup, step: 24
Epoch 166/200 |loss: 9.035455| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 25
Epoch 167/200 |loss: 9.545870| train set 5.008x speedup, test set 0.977x speedup, val set 0.729x speedup, step: 26
Epoch 168/200 |loss: 8.885539| train set 4.958x speedup, test set 0.944x speedup, val set 0.729x speedup, step: 27
Epoch 169/200 |loss: 8.396021| train set 4.958x speedup, test set 0.946x speedup, val set 0.733x speedup, step: 28
Epoch 170/200 |loss: 8.590731| train set 4.873x speedup, test set 0.946x speedup, val set 0.733x speedup, step: 29
Epoch 171/200 |loss: 9.232693| train set 4.873x speedup, test set 0.944x speedup, val set 0.729x speedup, step: 30
Epoch 172/200 |loss: 9.684694| train set 4.873x speedup, test set 0.961x speedup, val set 0.729x speedup, step: 31
Epoch 173/200 |loss: 8.018139| train set 4.957x speedup, test set 0.963x speedup, val set 0.733x speedup, step: 32
Epoch 174/200 |loss: 8.739991| train set 4.920x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 33
Epoch 175/200 |loss: 9.708149| train set 4.920x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 1
Epoch 176/200 |loss: 9.122155| train set 5.007x speedup, test set 0.950x speedup, val set 0.729x speedup, step: 2
Epoch 177/200 |loss: 8.325414| train set 4.957x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 3
Epoch 178/200 |loss: 8.980732| train set 4.958x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 4
Epoch 179/200 |loss: 8.514566| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 5
Epoch 180/200 |loss: 8.934736| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 6
Epoch 181/200 |loss: 8.424042| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 7
Epoch 182/200 |loss: 9.226318| train set 4.873x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 8
Epoch 183/200 |loss: 8.305244| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 9
Epoch 184/200 |loss: 7.385741| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 10
Epoch 185/200 |loss: 8.471823| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 11
Epoch 186/200 |loss: 8.693413| train set 4.753x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 12
Epoch 187/200 |loss: 8.202906| train set 5.007x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 13
Epoch 188/200 |loss: 8.170027| train set 5.007x speedup, test set 0.967x speedup, val set 0.729x speedup, step: 14
Epoch 189/200 |loss: 8.540736| train set 4.920x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 15
Epoch 190/200 |loss: 8.533027| train set 5.007x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 16
Epoch 191/200 |loss: 7.685332| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 17
Epoch 192/200 |loss: 9.851190| train set 4.921x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 18
Epoch 193/200 |loss: 8.990319| train set 4.921x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 19
Epoch 194/200 |loss: 9.655089| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 1
Epoch 195/200 |loss: 7.421905| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 2
Epoch 196/200 |loss: 8.514594| train set 4.958x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 3
Epoch 197/200 |loss: 8.860891| train set 4.954x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 1
Epoch 198/200 |loss: 9.281949| train set 4.987x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 1
Epoch 199/200 |loss: 7.547147| train set 5.008x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 1
Training per epoch cost 0.340 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 1.164s, pg runtime 0.637s, speedup 0.547x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 1.219s, pg runtime 0.661s, speedup 0.542x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.283s, pg runtime 8.283s, speedup 1.000x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 0.995, val speedup 0.729
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 199, train speedup 5.008, test speedup 0.950, val speedup 0.742
last model at epoch 199, train speedup 5.008, test speedup 0.950, val speedup 0.742
execution cost 0:02:45.345672
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.974540, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281973| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286847| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.793530| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.089635| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.913028| train set 3.193x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588156| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.558290| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.379521| train set 3.958x speedup, test set 1.040x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.760399| train set 4.032x speedup, test set 0.990x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.463957| train set 4.630x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 13
Epoch 13/200 |loss: 13.907602| train set 4.630x speedup, test set 0.870x speedup, val set 0.991x speedup, step: 14
Epoch 14/200 |loss: 13.917945| train set 4.630x speedup, test set 0.870x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.089211| train set 4.895x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.489371| train set 4.630x speedup, test set 1.028x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.550637| train set 4.670x speedup, test set 0.864x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.254319| train set 4.958x speedup, test set 1.008x speedup, val set 0.733x speedup, step: 19
Epoch 19/200 |loss: 10.048570| train set 4.958x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 20
Epoch 20/200 |loss: 12.370134| train set 4.631x speedup, test set 1.022x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.646552| train set 5.008x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.052857| train set 5.008x speedup, test set 0.995x speedup, val set 1.033x speedup, step: 23
Epoch 23/200 |loss: 10.627192| train set 4.957x speedup, test set 1.010x speedup, val set 1.041x speedup, step: 24
Epoch 24/200 |loss: 11.804796| train set 4.958x speedup, test set 0.979x speedup, val set 0.733x speedup, step: 25
Epoch 25/200 |loss: 11.424025| train set 5.008x speedup, test set 0.993x speedup, val set 0.733x speedup, step: 26
Epoch 26/200 |loss: 10.421112| train set 4.631x speedup, test set 0.933x speedup, val set 0.733x speedup, step: 27
Epoch 27/200 |loss: 11.921029| train set 4.958x speedup, test set 0.977x speedup, val set 0.733x speedup, step: 28
Epoch 28/200 |loss: 10.275478| train set 5.008x speedup, test set 0.994x speedup, val set 0.733x speedup, step: 29
Epoch 29/200 |loss: 9.714565| train set 5.008x speedup, test set 0.949x speedup, val set 0.733x speedup, step: 30
Epoch 30/200 |loss: 10.451865| train set 5.008x speedup, test set 0.948x speedup, val set 0.733x speedup, step: 31
Epoch 31/200 |loss: 10.723762| train set 5.008x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 32
Epoch 32/200 |loss: 10.464807| train set 4.708x speedup, test set 0.995x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 9.890235| train set 4.957x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 34
Epoch 34/200 |loss: 11.274163| train set 4.894x speedup, test set 0.981x speedup, val set 1.033x speedup, step: 35
Epoch 35/200 |loss: 12.918061| train set 5.007x speedup, test set 0.991x speedup, val set 0.994x speedup, step: 36
Epoch 36/200 |loss: 12.417963| train set 4.957x speedup, test set 0.999x speedup, val set 1.041x speedup, step: 37
Epoch 37/200 |loss: 10.162066| train set 4.671x speedup, test set 1.028x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 9.541193| train set 4.921x speedup, test set 1.004x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 10.306988| train set 4.958x speedup, test set 1.011x speedup, val set 1.041x speedup, step: 40
Epoch 40/200 |loss: 9.554489| train set 4.958x speedup, test set 0.937x speedup, val set 1.041x speedup, step: 41
Epoch 41/200 |loss: 10.412982| train set 4.921x speedup, test set 1.005x speedup, val set 0.729x speedup, step: 42
Epoch 42/200 |loss: 10.863063| train set 4.873x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 43
Epoch 43/200 |loss: 10.243426| train set 4.631x speedup, test set 0.988x speedup, val set 1.041x speedup, step: 44
Epoch 44/200 |loss: 11.892045| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 45
Epoch 45/200 |loss: 9.197775| train set 4.917x speedup, test set 0.991x speedup, val set 0.804x speedup, step: 46
Epoch 46/200 |loss: 10.482934| train set 4.958x speedup, test set 0.977x speedup, val set 1.316x speedup, step: 47
Epoch 47/200 |loss: 10.294774| train set 4.709x speedup, test set 0.979x speedup, val set 1.041x speedup, step: 48
Epoch 48/200 |loss: 9.728499| train set 4.754x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 49
Epoch 49/200 |loss: 10.077528| train set 4.674x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 50
Epoch 50/200 |loss: 9.694653| train set 4.631x speedup, test set 0.911x speedup, val set 0.729x speedup, step: 51
Epoch 51/200 |loss: 10.049812| train set 4.958x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 52
Epoch 52/200 |loss: 10.909355| train set 4.847x speedup, test set 1.005x speedup, val set 0.729x speedup, step: 53
Epoch 53/200 |loss: 9.197676| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 9.540365| train set 4.715x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 55
Epoch 55/200 |loss: 9.847530| train set 4.958x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 56
Epoch 56/200 |loss: 9.229444| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 57
Epoch 57/200 |loss: 10.456008| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 58
Epoch 58/200 |loss: 9.593702| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 59
Epoch 59/200 |loss: 8.701987| train set 5.007x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 60
Epoch 60/200 |loss: 9.326663| train set 5.007x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 61
Epoch 61/200 |loss: 10.486676| train set 5.008x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 62
Epoch 62/200 |loss: 7.890444| train set 4.917x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 63
Epoch 63/200 |loss: 8.827549| train set 4.873x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 64
Epoch 64/200 |loss: 8.338654| train set 5.007x speedup, test set 0.988x speedup, val set 0.733x speedup, step: 65
Epoch 65/200 |loss: 8.888653| train set 4.920x speedup, test set 0.988x speedup, val set 0.729x speedup, step: 66
Epoch 66/200 |loss: 9.887597| train set 5.008x speedup, test set 0.991x speedup, val set 0.762x speedup, step: 67
Epoch 67/200 |loss: 7.902101| train set 5.008x speedup, test set 0.991x speedup, val set 0.762x speedup, step: 68
Epoch 68/200 |loss: 9.249649| train set 5.008x speedup, test set 0.980x speedup, val set 0.733x speedup, step: 69
Epoch 69/200 |loss: 9.365339| train set 4.715x speedup, test set 0.971x speedup, val set 1.133x speedup, step: 70
Epoch 70/200 |loss: 8.810712| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.543130| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 72
Epoch 72/200 |loss: 8.008028| train set 5.008x speedup, test set 0.980x speedup, val set 0.889x speedup, step: 73
Epoch 73/200 |loss: 9.192775| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.120069| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.964021| train set 5.008x speedup, test set 0.991x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.123196| train set 4.920x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 77
Epoch 77/200 |loss: 8.271230| train set 5.007x speedup, test set 0.991x speedup, val set 0.733x speedup, step: 78
Epoch 78/200 |loss: 9.009939| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 79
Epoch 79/200 |loss: 8.809618| train set 4.920x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 80
Epoch 80/200 |loss: 7.462069| train set 4.921x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 81
Epoch 81/200 |loss: 10.246956| train set 5.008x speedup, test set 0.982x speedup, val set 0.733x speedup, step: 82
Epoch 82/200 |loss: 8.807110| train set 5.008x speedup, test set 0.895x speedup, val set 0.733x speedup, step: 83
Epoch 83/200 |loss: 8.511125| train set 5.008x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 84
Epoch 84/200 |loss: 8.763597| train set 4.921x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 85
Epoch 85/200 |loss: 8.275044| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 86
Epoch 86/200 |loss: 8.576849| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 87
Epoch 87/200 |loss: 9.553049| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 88
Epoch 88/200 |loss: 7.534619| train set 4.836x speedup, test set 0.964x speedup, val set 0.733x speedup, step: 89
Epoch 89/200 |loss: 8.369484| train set 5.008x speedup, test set 0.981x speedup, val set 0.729x speedup, step: 90
Epoch 90/200 |loss: 8.433746| train set 5.008x speedup, test set 0.985x speedup, val set 0.729x speedup, step: 91
Epoch 91/200 |loss: 8.379590| train set 5.008x speedup, test set 1.000x speedup, val set 0.733x speedup, step: 92
Epoch 92/200 |loss: 8.260020| train set 5.008x speedup, test set 1.000x speedup, val set 0.965x speedup, step: 93
Epoch 93/200 |loss: 9.504594| train set 5.008x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 94
Epoch 94/200 |loss: 8.303560| train set 4.958x speedup, test set 0.966x speedup, val set 1.133x speedup, step: 95
Epoch 95/200 |loss: 9.195137| train set 4.958x speedup, test set 0.966x speedup, val set 0.983x speedup, step: 96
Epoch 96/200 |loss: 9.047712| train set 4.958x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 97
Epoch 97/200 |loss: 9.096692| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 98
Epoch 98/200 |loss: 8.784558| train set 5.008x speedup, test set 0.966x speedup, val set 0.733x speedup, step: 99
Epoch 99/200 |loss: 9.265599| train set 5.008x speedup, test set 0.964x speedup, val set 0.733x speedup, step: 100
Epoch 100/200 |loss: 9.032179| train set 5.008x speedup, test set 0.967x speedup, val set 0.739x speedup, step: 1
Epoch 101/200 |loss: 10.077696| train set 4.715x speedup, test set 1.009x speedup, val set 1.144x speedup, step: 1
Epoch 102/200 |loss: 8.848909| train set 4.958x speedup, test set 0.977x speedup, val set 1.316x speedup, step: 1
Epoch 103/200 |loss: 9.345085| train set 4.917x speedup, test set 0.966x speedup, val set 0.809x speedup, step: 2
Epoch 104/200 |loss: 8.816315| train set 4.921x speedup, test set 0.983x speedup, val set 1.176x speedup, step: 3
Epoch 105/200 |loss: 7.504070| train set 4.957x speedup, test set 0.985x speedup, val set 1.316x speedup, step: 1
Epoch 106/200 |loss: 8.460830| train set 5.007x speedup, test set 1.000x speedup, val set 1.144x speedup, step: 2
Epoch 107/200 |loss: 8.762197| train set 5.007x speedup, test set 1.000x speedup, val set 0.742x speedup, step: 3
Epoch 108/200 |loss: 8.273319| train set 5.007x speedup, test set 1.000x speedup, val set 0.735x speedup, step: 4
Epoch 109/200 |loss: 9.365820| train set 5.008x speedup, test set 0.996x speedup, val set 1.302x speedup, step: 5
Epoch 110/200 |loss: 7.569985| train set 5.008x speedup, test set 0.996x speedup, val set 1.012x speedup, step: 6
Epoch 111/200 |loss: 8.903901| train set 5.004x speedup, test set 0.975x speedup, val set 0.735x speedup, step: 7
Epoch 112/200 |loss: 9.491020| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 8
Epoch 113/200 |loss: 8.921588| train set 5.008x speedup, test set 0.975x speedup, val set 1.160x speedup, step: 9
Epoch 114/200 |loss: 9.609488| train set 5.008x speedup, test set 0.961x speedup, val set 0.746x speedup, step: 10
Epoch 115/200 |loss: 8.187284| train set 5.008x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 11
Epoch 116/200 |loss: 8.056786| train set 5.008x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 12
Epoch 117/200 |loss: 10.069929| train set 5.008x speedup, test set 0.963x speedup, val set 0.934x speedup, step: 13
Epoch 118/200 |loss: 8.848135| train set 5.008x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 14
Epoch 119/200 |loss: 9.210711| train set 5.008x speedup, test set 0.950x speedup, val set 0.742x speedup, step: 15
Epoch 120/200 |loss: 9.824988| train set 5.008x speedup, test set 0.961x speedup, val set 0.813x speedup, step: 16
Epoch 121/200 |loss: 8.561221| train set 5.008x speedup, test set 0.961x speedup, val set 1.165x speedup, step: 17
Epoch 122/200 |loss: 8.593190| train set 4.958x speedup, test set 0.961x speedup, val set 1.228x speedup, step: 18
Epoch 123/200 |loss: 6.965373| train set 4.958x speedup, test set 0.961x speedup, val set 0.742x speedup, step: 19
Epoch 124/200 |loss: 9.136992| train set 4.921x speedup, test set 0.961x speedup, val set 0.762x speedup, step: 20
Epoch 125/200 |loss: 9.285687| train set 4.920x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 21
Epoch 126/200 |loss: 10.221554| train set 5.007x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 22
Epoch 127/200 |loss: 8.740546| train set 5.007x speedup, test set 0.961x speedup, val set 0.735x speedup, step: 23
Epoch 128/200 |loss: 9.695451| train set 5.007x speedup, test set 0.961x speedup, val set 0.762x speedup, step: 24
Epoch 129/200 |loss: 8.509570| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 25
Epoch 130/200 |loss: 9.275491| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 26
Epoch 131/200 |loss: 8.989343| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 27
Epoch 132/200 |loss: 9.262968| train set 4.954x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 28
Epoch 133/200 |loss: 7.561205| train set 4.958x speedup, test set 0.963x speedup, val set 1.144x speedup, step: 29
Epoch 134/200 |loss: 7.052816| train set 4.958x speedup, test set 0.975x speedup, val set 0.803x speedup, step: 30
Epoch 135/200 |loss: 8.644014| train set 5.008x speedup, test set 1.000x speedup, val set 0.733x speedup, step: 31
Epoch 136/200 |loss: 7.598657| train set 5.008x speedup, test set 0.976x speedup, val set 0.770x speedup, step: 32
Epoch 137/200 |loss: 8.680086| train set 5.008x speedup, test set 0.976x speedup, val set 0.770x speedup, step: 33
Epoch 138/200 |loss: 9.687084| train set 5.008x speedup, test set 0.998x speedup, val set 1.149x speedup, step: 34
Epoch 139/200 |loss: 9.152037| train set 4.715x speedup, test set 0.996x speedup, val set 1.316x speedup, step: 1
Epoch 140/200 |loss: 8.176081| train set 4.958x speedup, test set 0.985x speedup, val set 1.316x speedup, step: 1
Epoch 141/200 |loss: 8.332363| train set 4.958x speedup, test set 0.950x speedup, val set 1.165x speedup, step: 2
Epoch 142/200 |loss: 8.837641| train set 4.921x speedup, test set 0.961x speedup, val set 0.836x speedup, step: 3
Epoch 143/200 |loss: 9.579686| train set 4.921x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 4
Epoch 144/200 |loss: 8.767931| train set 4.957x speedup, test set 0.963x speedup, val set 1.316x speedup, step: 1
Epoch 145/200 |loss: 10.023567| train set 4.957x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 2
Epoch 146/200 |loss: 9.191647| train set 4.920x speedup, test set 0.961x speedup, val set 0.762x speedup, step: 3
Epoch 147/200 |loss: 9.663430| train set 4.872x speedup, test set 0.963x speedup, val set 0.934x speedup, step: 4
Epoch 148/200 |loss: 8.289290| train set 5.007x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 5
Epoch 149/200 |loss: 8.762108| train set 5.007x speedup, test set 0.965x speedup, val set 1.302x speedup, step: 6
Epoch 150/200 |loss: 9.628209| train set 5.007x speedup, test set 0.965x speedup, val set 0.729x speedup, step: 7
Epoch 151/200 |loss: 8.983509| train set 4.915x speedup, test set 0.954x speedup, val set 0.742x speedup, step: 8
Epoch 152/200 |loss: 7.827483| train set 4.921x speedup, test set 0.971x speedup, val set 0.735x speedup, step: 9
Epoch 153/200 |loss: 9.728503| train set 4.921x speedup, test set 0.983x speedup, val set 1.133x speedup, step: 10
Epoch 154/200 |loss: 8.924478| train set 5.008x speedup, test set 1.005x speedup, val set 0.729x speedup, step: 11
Epoch 155/200 |loss: 9.088246| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 12
Epoch 156/200 |loss: 8.854678| train set 5.008x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 13
Epoch 157/200 |loss: 9.049438| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 14
Epoch 158/200 |loss: 10.449139| train set 4.921x speedup, test set 0.954x speedup, val set 0.735x speedup, step: 15
Epoch 159/200 |loss: 7.773703| train set 5.005x speedup, test set 0.954x speedup, val set 0.742x speedup, step: 16
Epoch 160/200 |loss: 7.857842| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 17
Epoch 161/200 |loss: 9.243421| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 18
Epoch 162/200 |loss: 8.103066| train set 5.008x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 19
Epoch 163/200 |loss: 7.715004| train set 5.008x speedup, test set 0.964x speedup, val set 0.742x speedup, step: 20
Epoch 164/200 |loss: 8.771621| train set 5.008x speedup, test set 0.975x speedup, val set 0.729x speedup, step: 21
Epoch 165/200 |loss: 7.861087| train set 5.008x speedup, test set 0.996x speedup, val set 0.729x speedup, step: 22
Epoch 166/200 |loss: 9.102315| train set 5.007x speedup, test set 1.000x speedup, val set 0.944x speedup, step: 23
Epoch 167/200 |loss: 9.520344| train set 4.920x speedup, test set 0.966x speedup, val set 1.133x speedup, step: 24
Epoch 168/200 |loss: 8.935493| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 25
Epoch 169/200 |loss: 8.197861| train set 4.957x speedup, test set 0.963x speedup, val set 1.316x speedup, step: 1
Epoch 170/200 |loss: 8.942276| train set 4.873x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 2
Epoch 171/200 |loss: 9.360326| train set 4.873x speedup, test set 0.952x speedup, val set 0.777x speedup, step: 3
Epoch 172/200 |loss: 9.585320| train set 4.958x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 4
Epoch 173/200 |loss: 8.204894| train set 4.957x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 5
Epoch 174/200 |loss: 8.805503| train set 5.007x speedup, test set 1.008x speedup, val set 0.742x speedup, step: 6
Epoch 175/200 |loss: 9.876091| train set 4.920x speedup, test set 1.006x speedup, val set 0.804x speedup, step: 7
Epoch 176/200 |loss: 9.113805| train set 4.920x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 8
Epoch 177/200 |loss: 8.254198| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 9
Epoch 178/200 |loss: 9.012769| train set 4.958x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 10
Epoch 179/200 |loss: 8.438028| train set 4.873x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 11
Epoch 180/200 |loss: 8.998617| train set 4.958x speedup, test set 0.963x speedup, val set 0.770x speedup, step: 12
Epoch 181/200 |loss: 8.584857| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 13
Epoch 182/200 |loss: 9.243543| train set 4.958x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 14
Epoch 183/200 |loss: 8.195373| train set 4.958x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 15
Epoch 184/200 |loss: 7.480964| train set 4.921x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 16
Epoch 185/200 |loss: 8.448087| train set 4.917x speedup, test set 0.971x speedup, val set 0.762x speedup, step: 17
Epoch 186/200 |loss: 9.099733| train set 5.007x speedup, test set 0.983x speedup, val set 0.955x speedup, step: 18
Epoch 187/200 |loss: 8.289750| train set 5.007x speedup, test set 0.983x speedup, val set 1.222x speedup, step: 19
Epoch 188/200 |loss: 8.278243| train set 5.007x speedup, test set 0.983x speedup, val set 0.729x speedup, step: 20
Epoch 189/200 |loss: 8.671638| train set 5.006x speedup, test set 0.971x speedup, val set 0.742x speedup, step: 21
Epoch 190/200 |loss: 8.773351| train set 5.006x speedup, test set 0.971x speedup, val set 0.735x speedup, step: 22
Epoch 191/200 |loss: 7.734836| train set 5.008x speedup, test set 1.029x speedup, val set 0.729x speedup, step: 23
Epoch 192/200 |loss: 9.908173| train set 4.921x speedup, test set 1.029x speedup, val set 0.735x speedup, step: 24
Epoch 193/200 |loss: 9.208142| train set 4.921x speedup, test set 1.017x speedup, val set 0.770x speedup, step: 25
Epoch 194/200 |loss: 9.673421| train set 4.921x speedup, test set 0.971x speedup, val set 0.836x speedup, step: 26
Epoch 195/200 |loss: 7.637246| train set 4.958x speedup, test set 0.971x speedup, val set 1.165x speedup, step: 27
Epoch 196/200 |loss: 8.540638| train set 4.958x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 28
Epoch 197/200 |loss: 8.688951| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 29
Epoch 198/200 |loss: 9.281651| train set 4.977x speedup, test set 1.008x speedup, val set 0.804x speedup, step: 30
Epoch 199/200 |loss: 7.605980| train set 5.008x speedup, test set 0.963x speedup, val set 0.804x speedup, step: 31
Training per epoch cost 0.326 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.404s, pg runtime 0.404s, speedup 1.000x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 3.058s, pg runtime 1.437s, speedup 0.470x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 0.979, val speedup 0.729
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 169, train speedup 4.957, test speedup 0.963, val speedup 1.316
last model at epoch 199, train speedup 5.008, test speedup 0.963, val speedup 0.804
execution cost 0:02:39.374358
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_adhoc
grain: adhoc
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test templates:  ['16', '10', '30', '17', '9', '5', '13']
test queries:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
test query:  ['10b.sql' '10c.sql' '10a.sql' '13c.sql' '13d.sql' '13b.sql' '13a.sql'
 '16a.sql' '16b.sql' '16c.sql' '16d.sql' '17b.sql' '17f.sql' '17d.sql'
 '17c.sql' '17a.sql' '17e.sql' '30a.sql' '30b.sql' '30c.sql' '5b.sql'
 '5c.sql' '5a.sql' '9c.sql' '9d.sql' '9a.sql' '9b.sql']
load JOB succ
load TPCH...
TPCH test template [5, 20, 4, 15]
load TPCH succ
load TPCH_Skew...
TPCH test template [3, 1, 4, 8]
load TPCH Skew succ
train, test, validation (140, 49) (27, 49) (20, 49)
1.1458538341795936
-1.0
construct training samples cost 0:00:00.955167, and there are 140 training samples
in channel 9
Epoch 0/200 |loss: 26.377735| train set 2.795x speedup, test set 1.294x speedup, val set 1.613x speedup, step: 1
Epoch 1/200 |loss: 22.281973| train set 2.905x speedup, test set 1.055x speedup, val set 1.007x speedup, step: 2
Epoch 2/200 |loss: 22.286847| train set 3.191x speedup, test set 1.036x speedup, val set 1.007x speedup, step: 3
Epoch 3/200 |loss: 18.936654| train set 2.684x speedup, test set 0.993x speedup, val set 0.804x speedup, step: 4
Epoch 4/200 |loss: 20.179351| train set 3.350x speedup, test set 1.054x speedup, val set 1.007x speedup, step: 5
Epoch 5/200 |loss: 18.794127| train set 3.353x speedup, test set 1.210x speedup, val set 0.983x speedup, step: 6
Epoch 6/200 |loss: 17.084894| train set 3.353x speedup, test set 1.028x speedup, val set 0.983x speedup, step: 7
Epoch 7/200 |loss: 16.898472| train set 3.146x speedup, test set 1.032x speedup, val set 0.809x speedup, step: 8
Epoch 8/200 |loss: 18.588902| train set 3.349x speedup, test set 1.019x speedup, val set 0.729x speedup, step: 9
Epoch 9/200 |loss: 16.621378| train set 3.511x speedup, test set 0.993x speedup, val set 0.983x speedup, step: 10
Epoch 10/200 |loss: 16.479286| train set 3.958x speedup, test set 1.012x speedup, val set 0.983x speedup, step: 11
Epoch 11/200 |loss: 15.773626| train set 3.958x speedup, test set 0.934x speedup, val set 0.991x speedup, step: 12
Epoch 12/200 |loss: 13.428043| train set 4.286x speedup, test set 0.986x speedup, val set 0.991x speedup, step: 13
Epoch 13/200 |loss: 13.939326| train set 4.630x speedup, test set 0.870x speedup, val set 1.072x speedup, step: 14
Epoch 14/200 |loss: 14.082242| train set 4.630x speedup, test set 0.869x speedup, val set 0.733x speedup, step: 15
Epoch 15/200 |loss: 13.129577| train set 4.895x speedup, test set 1.008x speedup, val set 0.729x speedup, step: 16
Epoch 16/200 |loss: 12.696770| train set 4.631x speedup, test set 1.031x speedup, val set 0.733x speedup, step: 17
Epoch 17/200 |loss: 12.616605| train set 4.670x speedup, test set 0.868x speedup, val set 1.041x speedup, step: 18
Epoch 18/200 |loss: 12.213686| train set 4.958x speedup, test set 0.892x speedup, val set 1.041x speedup, step: 19
Epoch 19/200 |loss: 10.011617| train set 4.958x speedup, test set 1.007x speedup, val set 1.041x speedup, step: 20
Epoch 20/200 |loss: 12.344686| train set 4.631x speedup, test set 1.007x speedup, val set 0.733x speedup, step: 21
Epoch 21/200 |loss: 11.780995| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 22
Epoch 22/200 |loss: 10.413564| train set 5.007x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 23
Epoch 23/200 |loss: 10.846781| train set 5.007x speedup, test set 1.014x speedup, val set 0.965x speedup, step: 24
Epoch 24/200 |loss: 11.903100| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 25
Epoch 25/200 |loss: 11.522644| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 26
Epoch 26/200 |loss: 10.643680| train set 5.008x speedup, test set 0.991x speedup, val set 0.729x speedup, step: 27
Epoch 27/200 |loss: 12.251799| train set 4.958x speedup, test set 1.007x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 10.213217| train set 5.008x speedup, test set 1.007x speedup, val set 0.729x speedup, step: 29
Epoch 29/200 |loss: 10.167447| train set 5.008x speedup, test set 1.008x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 10.474382| train set 4.958x speedup, test set 1.014x speedup, val set 1.041x speedup, step: 31
Epoch 31/200 |loss: 11.069171| train set 4.958x speedup, test set 0.991x speedup, val set 1.041x speedup, step: 32
Epoch 32/200 |loss: 10.355503| train set 4.708x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 33
Epoch 33/200 |loss: 10.916426| train set 4.448x speedup, test set 0.979x speedup, val set 1.041x speedup, step: 34
Epoch 34/200 |loss: 11.242593| train set 4.894x speedup, test set 0.979x speedup, val set 1.041x speedup, step: 35
Epoch 35/200 |loss: 13.081293| train set 5.007x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 36
Epoch 36/200 |loss: 13.078729| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 37
Epoch 37/200 |loss: 10.020241| train set 5.008x speedup, test set 1.001x speedup, val set 1.041x speedup, step: 38
Epoch 38/200 |loss: 10.479767| train set 4.715x speedup, test set 0.979x speedup, val set 0.729x speedup, step: 39
Epoch 39/200 |loss: 11.038108| train set 4.674x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 40
Epoch 40/200 |loss: 9.715416| train set 4.958x speedup, test set 1.000x speedup, val set 1.033x speedup, step: 41
Epoch 41/200 |loss: 11.454012| train set 4.895x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 42
Epoch 42/200 |loss: 10.815381| train set 4.921x speedup, test set 0.979x speedup, val set 0.957x speedup, step: 43
Epoch 43/200 |loss: 10.307640| train set 4.630x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 44
Epoch 44/200 |loss: 11.774538| train set 4.674x speedup, test set 0.958x speedup, val set 1.033x speedup, step: 45
Epoch 45/200 |loss: 9.110175| train set 4.921x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 46
Epoch 46/200 |loss: 10.724384| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 47
Epoch 47/200 |loss: 9.737606| train set 4.631x speedup, test set 0.979x speedup, val set 1.316x speedup, step: 48
Epoch 48/200 |loss: 9.705534| train set 4.958x speedup, test set 0.968x speedup, val set 1.302x speedup, step: 49
Epoch 49/200 |loss: 9.929077| train set 5.008x speedup, test set 0.952x speedup, val set 1.033x speedup, step: 50
Epoch 50/200 |loss: 9.468027| train set 5.008x speedup, test set 0.952x speedup, val set 1.033x speedup, step: 51
Epoch 51/200 |loss: 9.534847| train set 4.958x speedup, test set 0.952x speedup, val set 1.150x speedup, step: 52
Epoch 52/200 |loss: 10.785841| train set 4.958x speedup, test set 0.955x speedup, val set 1.033x speedup, step: 53
Epoch 53/200 |loss: 8.738532| train set 5.008x speedup, test set 0.980x speedup, val set 0.729x speedup, step: 54
Epoch 54/200 |loss: 9.194264| train set 4.715x speedup, test set 0.979x speedup, val set 1.041x speedup, step: 55
Epoch 55/200 |loss: 9.571994| train set 4.957x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 56
Epoch 56/200 |loss: 9.031818| train set 5.008x speedup, test set 0.980x speedup, val set 1.302x speedup, step: 57
Epoch 57/200 |loss: 10.157366| train set 5.007x speedup, test set 0.980x speedup, val set 0.882x speedup, step: 58
Epoch 58/200 |loss: 9.313195| train set 5.007x speedup, test set 0.980x speedup, val set 1.302x speedup, step: 59
Epoch 59/200 |loss: 8.575085| train set 5.007x speedup, test set 0.989x speedup, val set 1.302x speedup, step: 60
Epoch 60/200 |loss: 9.435321| train set 5.008x speedup, test set 0.989x speedup, val set 0.729x speedup, step: 61
Epoch 61/200 |loss: 10.424070| train set 4.958x speedup, test set 0.978x speedup, val set 0.733x speedup, step: 62
Epoch 62/200 |loss: 8.141252| train set 4.873x speedup, test set 0.968x speedup, val set 1.133x speedup, step: 63
Epoch 63/200 |loss: 8.794142| train set 4.873x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 64
Epoch 64/200 |loss: 8.319974| train set 4.921x speedup, test set 0.987x speedup, val set 1.302x speedup, step: 65
Epoch 65/200 |loss: 9.004479| train set 5.008x speedup, test set 0.987x speedup, val set 1.241x speedup, step: 66
Epoch 66/200 |loss: 9.931592| train set 5.008x speedup, test set 0.979x speedup, val set 0.735x speedup, step: 67
Epoch 67/200 |loss: 7.320418| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 68
Epoch 68/200 |loss: 9.113104| train set 5.008x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 69
Epoch 69/200 |loss: 9.163865| train set 5.008x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 70
Epoch 70/200 |loss: 8.341696| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 71
Epoch 71/200 |loss: 9.316557| train set 5.007x speedup, test set 0.952x speedup, val set 1.241x speedup, step: 72
Epoch 72/200 |loss: 8.012526| train set 5.007x speedup, test set 0.932x speedup, val set 1.302x speedup, step: 73
Epoch 73/200 |loss: 9.091120| train set 5.007x speedup, test set 0.968x speedup, val set 1.302x speedup, step: 74
Epoch 74/200 |loss: 9.389624| train set 5.007x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 75
Epoch 75/200 |loss: 8.691158| train set 5.007x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 76
Epoch 76/200 |loss: 7.189811| train set 4.917x speedup, test set 0.987x speedup, val set 0.735x speedup, step: 77
Epoch 77/200 |loss: 8.647756| train set 5.004x speedup, test set 0.987x speedup, val set 0.729x speedup, step: 78
Epoch 78/200 |loss: 9.112077| train set 4.835x speedup, test set 0.978x speedup, val set 1.033x speedup, step: 79
Epoch 79/200 |loss: 8.963832| train set 5.008x speedup, test set 0.979x speedup, val set 1.016x speedup, step: 80
Epoch 80/200 |loss: 7.526083| train set 4.921x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 81
Epoch 81/200 |loss: 10.268717| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 82
Epoch 82/200 |loss: 8.887137| train set 5.008x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 83
Epoch 83/200 |loss: 8.568834| train set 5.008x speedup, test set 0.963x speedup, val set 1.006x speedup, step: 84
Epoch 84/200 |loss: 8.849125| train set 4.921x speedup, test set 0.979x speedup, val set 1.228x speedup, step: 85
Epoch 85/200 |loss: 8.121118| train set 5.008x speedup, test set 0.974x speedup, val set 1.073x speedup, step: 86
Epoch 86/200 |loss: 8.736990| train set 5.008x speedup, test set 0.974x speedup, val set 1.033x speedup, step: 87
Epoch 87/200 |loss: 9.343936| train set 5.008x speedup, test set 0.952x speedup, val set 1.165x speedup, step: 88
Epoch 88/200 |loss: 7.634337| train set 5.008x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 89
Epoch 89/200 |loss: 8.192992| train set 5.008x speedup, test set 0.982x speedup, val set 0.957x speedup, step: 90
Epoch 90/200 |loss: 8.800991| train set 5.008x speedup, test set 0.982x speedup, val set 0.957x speedup, step: 91
Epoch 91/200 |loss: 8.533515| train set 5.008x speedup, test set 0.982x speedup, val set 1.033x speedup, step: 92
Epoch 92/200 |loss: 8.319197| train set 5.008x speedup, test set 0.982x speedup, val set 1.268x speedup, step: 93
Epoch 93/200 |loss: 9.124235| train set 5.008x speedup, test set 0.982x speedup, val set 1.006x speedup, step: 94
Epoch 94/200 |loss: 8.359603| train set 4.958x speedup, test set 0.979x speedup, val set 1.033x speedup, step: 95
Epoch 95/200 |loss: 9.017575| train set 4.958x speedup, test set 0.979x speedup, val set 1.241x speedup, step: 96
Epoch 96/200 |loss: 9.276670| train set 4.958x speedup, test set 0.982x speedup, val set 0.980x speedup, step: 97
Epoch 97/200 |loss: 9.233539| train set 5.008x speedup, test set 0.971x speedup, val set 1.006x speedup, step: 98
Epoch 98/200 |loss: 8.921526| train set 5.008x speedup, test set 0.955x speedup, val set 1.033x speedup, step: 99
Epoch 99/200 |loss: 9.539856| train set 5.008x speedup, test set 0.955x speedup, val set 1.006x speedup, step: 100
Epoch 100/200 |loss: 9.529913| train set 5.008x speedup, test set 0.982x speedup, val set 1.006x speedup, step: 1
Epoch 101/200 |loss: 10.023902| train set 4.715x speedup, test set 0.971x speedup, val set 1.033x speedup, step: 1
Epoch 102/200 |loss: 9.182274| train set 5.008x speedup, test set 0.955x speedup, val set 1.302x speedup, step: 1
Epoch 103/200 |loss: 9.571414| train set 5.004x speedup, test set 0.961x speedup, val set 0.868x speedup, step: 2
Epoch 104/200 |loss: 8.679493| train set 4.917x speedup, test set 0.963x speedup, val set 0.868x speedup, step: 3
Epoch 105/200 |loss: 8.032020| train set 4.920x speedup, test set 0.968x speedup, val set 1.302x speedup, step: 1
Epoch 106/200 |loss: 8.341958| train set 5.007x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 1
Epoch 107/200 |loss: 8.990292| train set 5.008x speedup, test set 0.982x speedup, val set 0.980x speedup, step: 2
Epoch 108/200 |loss: 8.214373| train set 4.753x speedup, test set 0.966x speedup, val set 0.742x speedup, step: 3
Epoch 109/200 |loss: 9.071929| train set 5.008x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 4
Epoch 110/200 |loss: 7.504292| train set 5.008x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 111/200 |loss: 8.734931| train set 4.958x speedup, test set 0.963x speedup, val set 1.093x speedup, step: 2
Epoch 112/200 |loss: 9.341286| train set 5.008x speedup, test set 0.963x speedup, val set 0.980x speedup, step: 3
Epoch 113/200 |loss: 8.764269| train set 5.008x speedup, test set 0.963x speedup, val set 0.968x speedup, step: 4
Epoch 114/200 |loss: 9.308856| train set 5.008x speedup, test set 0.963x speedup, val set 0.934x speedup, step: 5
Epoch 115/200 |loss: 7.824312| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 6
Epoch 116/200 |loss: 7.896034| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 7
Epoch 117/200 |loss: 9.832693| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 8
Epoch 118/200 |loss: 8.945669| train set 5.008x speedup, test set 0.963x speedup, val set 0.729x speedup, step: 9
Epoch 119/200 |loss: 8.587064| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 10
Epoch 120/200 |loss: 9.520055| train set 5.008x speedup, test set 0.963x speedup, val set 0.806x speedup, step: 11
Epoch 121/200 |loss: 8.389482| train set 4.921x speedup, test set 0.963x speedup, val set 1.228x speedup, step: 12
Epoch 122/200 |loss: 8.613891| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 123/200 |loss: 6.789291| train set 4.958x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 2
Epoch 124/200 |loss: 9.176159| train set 4.921x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 3
Epoch 125/200 |loss: 9.297951| train set 4.920x speedup, test set 0.963x speedup, val set 0.944x speedup, step: 4
Epoch 126/200 |loss: 10.094726| train set 5.007x speedup, test set 0.979x speedup, val set 1.133x speedup, step: 5
Epoch 127/200 |loss: 8.870503| train set 5.007x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 6
Epoch 128/200 |loss: 9.588019| train set 5.007x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 7
Epoch 129/200 |loss: 8.344303| train set 5.008x speedup, test set 0.974x speedup, val set 0.742x speedup, step: 8
Epoch 130/200 |loss: 9.228378| train set 5.008x speedup, test set 0.974x speedup, val set 1.133x speedup, step: 9
Epoch 131/200 |loss: 8.911232| train set 4.958x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 10
Epoch 132/200 |loss: 9.098477| train set 4.958x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 11
Epoch 133/200 |loss: 7.665724| train set 4.958x speedup, test set 0.974x speedup, val set 1.228x speedup, step: 12
Epoch 134/200 |loss: 6.819606| train set 4.958x speedup, test set 0.974x speedup, val set 0.762x speedup, step: 13
Epoch 135/200 |loss: 8.326668| train set 5.008x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 14
Epoch 136/200 |loss: 7.493703| train set 5.008x speedup, test set 0.982x speedup, val set 0.762x speedup, step: 15
Epoch 137/200 |loss: 8.474261| train set 5.008x speedup, test set 0.982x speedup, val set 0.742x speedup, step: 16
Epoch 138/200 |loss: 9.416471| train set 5.008x speedup, test set 0.978x speedup, val set 0.742x speedup, step: 17
Epoch 139/200 |loss: 9.034808| train set 4.715x speedup, test set 0.974x speedup, val set 1.165x speedup, step: 18
Epoch 140/200 |loss: 8.092135| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 141/200 |loss: 8.611743| train set 4.958x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 142/200 |loss: 8.894055| train set 4.921x speedup, test set 0.963x speedup, val set 0.868x speedup, step: 2
Epoch 143/200 |loss: 9.350502| train set 4.921x speedup, test set 0.963x speedup, val set 0.806x speedup, step: 3
Epoch 144/200 |loss: 8.726899| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 145/200 |loss: 9.790941| train set 4.957x speedup, test set 0.974x speedup, val set 1.211x speedup, step: 2
Epoch 146/200 |loss: 9.089414| train set 4.920x speedup, test set 0.963x speedup, val set 0.770x speedup, step: 3
Epoch 147/200 |loss: 9.816982| train set 4.598x speedup, test set 0.963x speedup, val set 1.165x speedup, step: 4
Epoch 148/200 |loss: 8.588480| train set 5.007x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 149/200 |loss: 8.788193| train set 5.007x speedup, test set 0.974x speedup, val set 1.302x speedup, step: 1
Epoch 150/200 |loss: 9.730784| train set 5.007x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 2
Epoch 151/200 |loss: 8.968579| train set 4.920x speedup, test set 0.994x speedup, val set 0.786x speedup, step: 3
Epoch 152/200 |loss: 7.924893| train set 4.921x speedup, test set 0.991x speedup, val set 0.735x speedup, step: 4
Epoch 153/200 |loss: 9.955515| train set 4.921x speedup, test set 0.974x speedup, val set 0.798x speedup, step: 5
Epoch 154/200 |loss: 9.090680| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 6
Epoch 155/200 |loss: 9.336040| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 7
Epoch 156/200 |loss: 8.926926| train set 5.008x speedup, test set 0.966x speedup, val set 0.729x speedup, step: 8
Epoch 157/200 |loss: 9.203286| train set 4.958x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 9
Epoch 158/200 |loss: 10.579247| train set 4.921x speedup, test set 0.978x speedup, val set 0.729x speedup, step: 10
Epoch 159/200 |loss: 7.756198| train set 5.004x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 11
Epoch 160/200 |loss: 7.841962| train set 5.005x speedup, test set 0.978x speedup, val set 0.735x speedup, step: 12
Epoch 161/200 |loss: 9.116860| train set 5.008x speedup, test set 0.966x speedup, val set 0.735x speedup, step: 13
Epoch 162/200 |loss: 8.094409| train set 5.008x speedup, test set 0.982x speedup, val set 0.735x speedup, step: 14
Epoch 163/200 |loss: 7.782364| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 15
Epoch 164/200 |loss: 8.776144| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 16
Epoch 165/200 |loss: 7.944521| train set 5.008x speedup, test set 0.982x speedup, val set 0.729x speedup, step: 17
Epoch 166/200 |loss: 9.204583| train set 5.008x speedup, test set 0.982x speedup, val set 1.133x speedup, step: 18
Epoch 167/200 |loss: 9.501758| train set 4.921x speedup, test set 0.966x speedup, val set 1.133x speedup, step: 19
Epoch 168/200 |loss: 8.778602| train set 4.958x speedup, test set 0.966x speedup, val set 1.211x speedup, step: 20
Epoch 169/200 |loss: 8.241333| train set 4.958x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 21
Epoch 170/200 |loss: 8.639913| train set 4.873x speedup, test set 0.959x speedup, val set 0.735x speedup, step: 22
Epoch 171/200 |loss: 9.362178| train set 4.873x speedup, test set 0.952x speedup, val set 0.735x speedup, step: 23
Epoch 172/200 |loss: 10.087015| train set 4.873x speedup, test set 0.952x speedup, val set 0.729x speedup, step: 24
Epoch 173/200 |loss: 8.116818| train set 4.957x speedup, test set 0.963x speedup, val set 1.133x speedup, step: 25
Epoch 174/200 |loss: 8.789149| train set 5.007x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 26
Epoch 175/200 |loss: 9.641400| train set 4.920x speedup, test set 0.963x speedup, val set 0.786x speedup, step: 27
Epoch 176/200 |loss: 9.090253| train set 4.920x speedup, test set 0.952x speedup, val set 0.813x speedup, step: 28
Epoch 177/200 |loss: 8.336815| train set 4.957x speedup, test set 0.952x speedup, val set 1.302x speedup, step: 1
Epoch 178/200 |loss: 8.963806| train set 4.957x speedup, test set 0.963x speedup, val set 1.302x speedup, step: 1
Epoch 179/200 |loss: 8.619156| train set 4.958x speedup, test set 0.963x speedup, val set 1.149x speedup, step: 2
Epoch 180/200 |loss: 9.060377| train set 4.958x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 3
Epoch 181/200 |loss: 8.345844| train set 4.958x speedup, test set 0.979x speedup, val set 0.742x speedup, step: 4
Epoch 182/200 |loss: 9.420789| train set 4.958x speedup, test set 0.979x speedup, val set 0.944x speedup, step: 5
Epoch 183/200 |loss: 8.535749| train set 4.958x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 1
Epoch 184/200 |loss: 7.617324| train set 5.008x speedup, test set 0.979x speedup, val set 1.302x speedup, step: 1
Epoch 185/200 |loss: 8.679028| train set 5.005x speedup, test set 0.979x speedup, val set 1.165x speedup, step: 2
Epoch 186/200 |loss: 9.036710| train set 4.754x speedup, test set 0.991x speedup, val set 1.165x speedup, step: 3
Epoch 187/200 |loss: 8.503173| train set 5.007x speedup, test set 0.974x speedup, val set 0.889x speedup, step: 4
Epoch 188/200 |loss: 8.377230| train set 5.007x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 5
Epoch 189/200 |loss: 8.663231| train set 5.007x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 6
Epoch 190/200 |loss: 8.900222| train set 5.008x speedup, test set 0.963x speedup, val set 0.735x speedup, step: 7
Epoch 191/200 |loss: 7.757846| train set 5.008x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 8
Epoch 192/200 |loss: 9.866874| train set 4.921x speedup, test set 0.974x speedup, val set 0.729x speedup, step: 9
Epoch 193/200 |loss: 9.247590| train set 4.921x speedup, test set 0.974x speedup, val set 0.735x speedup, step: 10
Epoch 194/200 |loss: 9.648547| train set 4.915x speedup, test set 0.974x speedup, val set 0.777x speedup, step: 11
Epoch 195/200 |loss: 7.540947| train set 4.921x speedup, test set 0.974x speedup, val set 1.211x speedup, step: 12
Epoch 196/200 |loss: 8.538782| train set 4.958x speedup, test set 0.963x speedup, val set 1.211x speedup, step: 13
Epoch 197/200 |loss: 9.046766| train set 4.954x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 14
Epoch 198/200 |loss: 9.317432| train set 5.004x speedup, test set 0.952x speedup, val set 0.742x speedup, step: 15
Epoch 199/200 |loss: 7.466258| train set 5.008x speedup, test set 0.963x speedup, val set 0.742x speedup, step: 16
Training per epoch cost 0.321 s
Optimal speedup on test set is 2.520x
01, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
02, opt runtime 1.299s, model runtime 5.855s, pg runtime 5.855s, speedup 1.000x
03, opt runtime 0.399s, model runtime 0.399s, pg runtime 0.404s, speedup 1.013x
04, opt runtime 0.637s, model runtime 0.637s, pg runtime 0.637s, speedup 1.000x
05, opt runtime 2.262s, model runtime 4.385s, pg runtime 3.549s, speedup 0.809x
06, opt runtime 0.661s, model runtime 0.661s, pg runtime 0.661s, speedup 1.000x
07, opt runtime 1.437s, model runtime 1.437s, pg runtime 1.437s, speedup 1.000x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 4.223s, model runtime 18.614s, pg runtime 18.741s, speedup 1.007x
10, opt runtime 1.763s, model runtime 1.798s, pg runtime 1.763s, speedup 0.980x
11, opt runtime 1.386s, model runtime 1.386s, pg runtime 1.386s, speedup 1.000x
12, opt runtime 3.504s, model runtime 6.080s, pg runtime 6.143s, speedup 1.010x
13, opt runtime 2.593s, model runtime 8.106s, pg runtime 8.283s, speedup 1.022x
14, opt runtime 2.046s, model runtime 5.919s, pg runtime 5.879s, speedup 0.993x
15, opt runtime 1.737s, model runtime 5.958s, pg runtime 5.994s, speedup 1.006x
16, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
17, opt runtime 3.248s, model runtime 10.538s, pg runtime 10.538s, speedup 1.000x
18, opt runtime 0.612s, model runtime 2.907s, pg runtime 1.357s, speedup 0.467x
19, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
20, opt runtime 2.719s, model runtime 2.719s, pg runtime 3.112s, speedup 1.144x
21, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
22, opt runtime 0.158s, model runtime 0.158s, pg runtime 0.158s, speedup 1.000x
23, opt runtime 0.129s, model runtime 0.130s, pg runtime 0.129s, speedup 0.993x
24, opt runtime 0.348s, model runtime 0.353s, pg runtime 0.391s, speedup 1.108x
25, opt runtime 2.755s, model runtime 5.521s, pg runtime 5.521s, speedup 1.000x
26, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
27, opt runtime 0.278s, model runtime 1.016s, pg runtime 0.948s, speedup 0.933x
====================
best train speedup epoch: 21, train speedup 5.008, test speedup 0.991, val speedup 0.729
best test speedup epoch: 0, train speedup 2.795, test speedup 1.294, val speedup 1.613
best validation speedup epoch: 184, train speedup 5.008, test speedup 0.979, val speedup 1.302
last model at epoch 199, train speedup 5.008, test speedup 0.963, val speedup 0.742
execution cost 0:02:37.783815
==================================================
