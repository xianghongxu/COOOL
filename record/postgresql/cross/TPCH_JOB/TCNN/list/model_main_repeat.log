all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.429804, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727960| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859616| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862551| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864920| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868445| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872690| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876951| train set 3.017x speedup, test set 1.803x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882330| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886577| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.890070| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891448| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892879| train set 3.173x speedup, test set 1.890x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894040| train set 3.338x speedup, test set 1.714x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895449| train set 3.331x speedup, test set 1.714x speedup, val set 3.228x speedup, step: 2
Epoch 27/200 |loss: -0.896519| train set 3.109x speedup, test set 1.722x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897731| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 4
Epoch 29/200 |loss: -0.898470| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899143| train set 2.970x speedup, test set 1.758x speedup, val set 2.891x speedup, step: 6
Epoch 31/200 |loss: -0.899797| train set 2.970x speedup, test set 1.907x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.900493| train set 2.970x speedup, test set 1.907x speedup, val set 2.891x speedup, step: 8
Epoch 33/200 |loss: -0.900443| train set 2.971x speedup, test set 1.847x speedup, val set 2.891x speedup, step: 9
Epoch 34/200 |loss: -0.901509| train set 3.046x speedup, test set 1.821x speedup, val set 2.969x speedup, step: 10
Epoch 35/200 |loss: -0.899734| train set 2.727x speedup, test set 1.994x speedup, val set 2.595x speedup, step: 11
Epoch 36/200 |loss: -0.903215| train set 2.759x speedup, test set 1.994x speedup, val set 2.659x speedup, step: 12
Epoch 37/200 |loss: -0.902500| train set 2.759x speedup, test set 2.070x speedup, val set 2.659x speedup, step: 13
Epoch 38/200 |loss: -0.893365| train set 2.825x speedup, test set 1.831x speedup, val set 2.724x speedup, step: 14
Epoch 39/200 |loss: -0.903573| train set 2.825x speedup, test set 1.778x speedup, val set 2.724x speedup, step: 15
Epoch 40/200 |loss: -0.900241| train set 2.825x speedup, test set 1.777x speedup, val set 2.724x speedup, step: 16
Epoch 41/200 |loss: -0.902330| train set 2.825x speedup, test set 1.788x speedup, val set 2.724x speedup, step: 17
Epoch 42/200 |loss: -0.903569| train set 2.825x speedup, test set 1.915x speedup, val set 2.724x speedup, step: 18
Epoch 43/200 |loss: -0.904698| train set 2.764x speedup, test set 1.915x speedup, val set 2.663x speedup, step: 19
Epoch 44/200 |loss: -0.904865| train set 2.759x speedup, test set 2.037x speedup, val set 2.659x speedup, step: 20
Epoch 45/200 |loss: -0.904639| train set 2.759x speedup, test set 1.916x speedup, val set 2.659x speedup, step: 21
Epoch 46/200 |loss: -0.905731| train set 2.759x speedup, test set 1.916x speedup, val set 2.659x speedup, step: 22
Epoch 47/200 |loss: -0.906104| train set 2.820x speedup, test set 1.874x speedup, val set 2.720x speedup, step: 23
Epoch 48/200 |loss: -0.907066| train set 2.820x speedup, test set 1.875x speedup, val set 2.719x speedup, step: 24
Epoch 49/200 |loss: -0.908744| train set 2.820x speedup, test set 1.794x speedup, val set 2.719x speedup, step: 25
Epoch 50/200 |loss: -0.909986| train set 2.824x speedup, test set 1.837x speedup, val set 2.724x speedup, step: 26
Epoch 51/200 |loss: -0.911190| train set 3.007x speedup, test set 1.826x speedup, val set 2.886x speedup, step: 27
Epoch 52/200 |loss: -0.913597| train set 2.969x speedup, test set 0.871x speedup, val set 2.865x speedup, step: 28
Epoch 53/200 |loss: -0.917762| train set 2.964x speedup, test set 0.882x speedup, val set 2.859x speedup, step: 29
Epoch 54/200 |loss: -0.922367| train set 2.964x speedup, test set 0.882x speedup, val set 2.859x speedup, step: 30
Epoch 55/200 |loss: -0.923474| train set 2.851x speedup, test set 0.892x speedup, val set 2.778x speedup, step: 31
Epoch 56/200 |loss: -0.924908| train set 2.851x speedup, test set 0.872x speedup, val set 2.778x speedup, step: 32
Epoch 57/200 |loss: -0.927395| train set 1.996x speedup, test set 0.869x speedup, val set 1.930x speedup, step: 33
Epoch 58/200 |loss: -0.928286| train set 1.996x speedup, test set 0.868x speedup, val set 1.930x speedup, step: 34
Epoch 59/200 |loss: -0.929441| train set 3.031x speedup, test set 0.878x speedup, val set 2.939x speedup, step: 35
Epoch 60/200 |loss: -0.930241| train set 2.969x speedup, test set 0.868x speedup, val set 2.865x speedup, step: 36
Epoch 61/200 |loss: -0.931739| train set 1.969x speedup, test set 0.868x speedup, val set 1.898x speedup, step: 37
Epoch 62/200 |loss: -0.933516| train set 1.969x speedup, test set 0.868x speedup, val set 1.898x speedup, step: 38
Epoch 63/200 |loss: -0.935194| train set 2.969x speedup, test set 0.868x speedup, val set 2.865x speedup, step: 39
Epoch 64/200 |loss: -0.934152| train set 1.969x speedup, test set 0.869x speedup, val set 1.898x speedup, step: 40
Epoch 65/200 |loss: -0.930291| train set 1.969x speedup, test set 0.869x speedup, val set 1.898x speedup, step: 41
Epoch 66/200 |loss: -0.935449| train set 1.969x speedup, test set 0.872x speedup, val set 1.898x speedup, step: 42
Epoch 67/200 |loss: -0.936111| train set 1.969x speedup, test set 0.882x speedup, val set 1.898x speedup, step: 43
Epoch 68/200 |loss: -0.936500| train set 1.969x speedup, test set 0.882x speedup, val set 1.898x speedup, step: 44
Epoch 69/200 |loss: -0.938019| train set 1.969x speedup, test set 0.861x speedup, val set 1.898x speedup, step: 45
Epoch 70/200 |loss: -0.938736| train set 1.969x speedup, test set 0.878x speedup, val set 1.898x speedup, step: 46
Epoch 71/200 |loss: -0.939085| train set 1.969x speedup, test set 0.916x speedup, val set 1.898x speedup, step: 47
Epoch 72/200 |loss: -0.940001| train set 1.969x speedup, test set 0.916x speedup, val set 1.898x speedup, step: 48
Epoch 73/200 |loss: -0.940904| train set 1.969x speedup, test set 0.916x speedup, val set 1.898x speedup, step: 49
Epoch 74/200 |loss: -0.941822| train set 1.969x speedup, test set 0.929x speedup, val set 1.898x speedup, step: 50
Epoch 75/200 |loss: -0.942320| train set 1.969x speedup, test set 0.929x speedup, val set 1.898x speedup, step: 51
Epoch 76/200 |loss: -0.942793| train set 1.969x speedup, test set 0.929x speedup, val set 1.898x speedup, step: 52
Epoch 77/200 |loss: -0.943325| train set 1.969x speedup, test set 0.928x speedup, val set 1.898x speedup, step: 53
Epoch 78/200 |loss: -0.943949| train set 1.968x speedup, test set 0.928x speedup, val set 1.897x speedup, step: 54
Epoch 79/200 |loss: -0.944621| train set 1.968x speedup, test set 0.885x speedup, val set 1.897x speedup, step: 55
Epoch 80/200 |loss: -0.945114| train set 1.968x speedup, test set 0.906x speedup, val set 1.897x speedup, step: 56
Epoch 81/200 |loss: -0.945654| train set 1.968x speedup, test set 0.925x speedup, val set 1.897x speedup, step: 57
Epoch 82/200 |loss: -0.946112| train set 1.968x speedup, test set 0.925x speedup, val set 1.897x speedup, step: 58
Epoch 83/200 |loss: -0.946363| train set 1.968x speedup, test set 0.927x speedup, val set 1.897x speedup, step: 59
Epoch 84/200 |loss: -0.946771| train set 1.995x speedup, test set 0.934x speedup, val set 1.929x speedup, step: 60
Epoch 85/200 |loss: -0.947126| train set 1.995x speedup, test set 0.934x speedup, val set 1.929x speedup, step: 61
Epoch 86/200 |loss: -0.947312| train set 1.995x speedup, test set 0.934x speedup, val set 1.929x speedup, step: 62
Epoch 87/200 |loss: -0.947454| train set 1.995x speedup, test set 0.934x speedup, val set 1.929x speedup, step: 63
Epoch 88/200 |loss: -0.947789| train set 1.995x speedup, test set 0.889x speedup, val set 1.929x speedup, step: 64
Epoch 89/200 |loss: -0.947843| train set 1.995x speedup, test set 0.934x speedup, val set 1.929x speedup, step: 65
Epoch 90/200 |loss: -0.948201| train set 1.995x speedup, test set 0.934x speedup, val set 1.929x speedup, step: 66
Epoch 91/200 |loss: -0.948377| train set 1.995x speedup, test set 0.934x speedup, val set 1.929x speedup, step: 67
Epoch 92/200 |loss: -0.948591| train set 1.969x speedup, test set 0.962x speedup, val set 1.898x speedup, step: 68
Epoch 93/200 |loss: -0.948855| train set 1.969x speedup, test set 0.962x speedup, val set 1.898x speedup, step: 69
Epoch 94/200 |loss: -0.949032| train set 1.969x speedup, test set 0.962x speedup, val set 1.898x speedup, step: 70
Epoch 95/200 |loss: -0.949262| train set 1.969x speedup, test set 0.962x speedup, val set 1.898x speedup, step: 71
Epoch 96/200 |loss: -0.949349| train set 1.969x speedup, test set 0.962x speedup, val set 1.898x speedup, step: 72
Epoch 97/200 |loss: -0.948466| train set 2.968x speedup, test set 0.893x speedup, val set 2.864x speedup, step: 73
Epoch 98/200 |loss: -0.945629| train set 3.029x speedup, test set 0.893x speedup, val set 2.937x speedup, step: 74
Epoch 99/200 |loss: -0.945920| train set 2.968x speedup, test set 0.893x speedup, val set 2.864x speedup, step: 75
early stopping at epoch 99
Training per epoch cost 0.655 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.325s, pg runtime 0.072s, speedup 0.221x
02, opt runtime 0.183s, model runtime 1.314s, pg runtime 0.189s, speedup 0.144x
03, opt runtime 0.014s, model runtime 0.738s, pg runtime 0.014s, speedup 0.019x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 3.764s, pg runtime 2.959s, speedup 0.786x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
14, opt runtime 0.113s, model runtime 3.063s, pg runtime 0.153s, speedup 0.050x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 0.507s, pg runtime 0.453s, speedup 0.895x
17, opt runtime 0.327s, model runtime 0.392s, pg runtime 0.354s, speedup 0.901x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.061s, model runtime 0.083s, pg runtime 0.086s, speedup 1.030x
21, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.116s, pg runtime 0.112s, speedup 0.970x
28, opt runtime 0.154s, model runtime 0.476s, pg runtime 0.154s, speedup 0.324x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 25, train speedup 3.338, test speedup 1.714, val speedup 3.235
best test speedup epoch: 37, train speedup 2.759, test speedup 2.070, val speedup 2.659
best validation speedup epoch: 25, train speedup 3.338, test speedup 1.714, val speedup 3.235
last model at epoch 99, train speedup 2.968, test speedup 0.893, val speedup 2.864
execution cost 0:03:53.791169
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.592769, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727959| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859616| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862551| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864920| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868445| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872690| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876951| train set 3.017x speedup, test set 1.803x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882330| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886577| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.890070| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891448| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892879| train set 3.173x speedup, test set 1.890x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894040| train set 3.338x speedup, test set 1.714x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895449| train set 3.331x speedup, test set 1.714x speedup, val set 3.228x speedup, step: 2
Epoch 27/200 |loss: -0.896519| train set 3.109x speedup, test set 1.722x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897731| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 4
Epoch 29/200 |loss: -0.898474| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899152| train set 2.970x speedup, test set 1.860x speedup, val set 2.891x speedup, step: 6
Epoch 31/200 |loss: -0.899807| train set 2.970x speedup, test set 1.907x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.900504| train set 2.970x speedup, test set 1.907x speedup, val set 2.891x speedup, step: 8
Epoch 33/200 |loss: -0.901218| train set 2.970x speedup, test set 1.994x speedup, val set 2.891x speedup, step: 9
Epoch 34/200 |loss: -0.901680| train set 2.971x speedup, test set 1.972x speedup, val set 2.891x speedup, step: 10
Epoch 35/200 |loss: -0.902224| train set 3.041x speedup, test set 1.777x speedup, val set 2.963x speedup, step: 11
Epoch 36/200 |loss: -0.902539| train set 3.078x speedup, test set 1.787x speedup, val set 3.046x speedup, step: 12
Epoch 37/200 |loss: -0.903364| train set 2.820x speedup, test set 1.832x speedup, val set 2.719x speedup, step: 13
Epoch 38/200 |loss: -0.904070| train set 2.774x speedup, test set 1.832x speedup, val set 2.659x speedup, step: 14
Epoch 39/200 |loss: -0.904232| train set 2.825x speedup, test set 1.867x speedup, val set 2.724x speedup, step: 15
Epoch 40/200 |loss: -0.904828| train set 2.825x speedup, test set 1.731x speedup, val set 2.724x speedup, step: 16
Epoch 41/200 |loss: -0.905432| train set 3.144x speedup, test set 1.787x speedup, val set 3.052x speedup, step: 17
Epoch 42/200 |loss: -0.905752| train set 3.144x speedup, test set 1.787x speedup, val set 3.052x speedup, step: 18
Epoch 43/200 |loss: -0.906083| train set 3.144x speedup, test set 1.787x speedup, val set 3.052x speedup, step: 19
Epoch 44/200 |loss: -0.906548| train set 3.144x speedup, test set 1.788x speedup, val set 3.052x speedup, step: 20
Epoch 45/200 |loss: -0.907017| train set 3.138x speedup, test set 1.867x speedup, val set 3.047x speedup, step: 21
Epoch 46/200 |loss: -0.907451| train set 3.138x speedup, test set 1.867x speedup, val set 3.047x speedup, step: 22
Epoch 47/200 |loss: -0.907999| train set 3.144x speedup, test set 1.745x speedup, val set 3.052x speedup, step: 23
Epoch 48/200 |loss: -0.908785| train set 3.144x speedup, test set 1.750x speedup, val set 3.052x speedup, step: 24
Epoch 49/200 |loss: -0.909915| train set 3.144x speedup, test set 1.751x speedup, val set 3.052x speedup, step: 25
Epoch 50/200 |loss: -0.910866| train set 3.070x speedup, test set 1.791x speedup, val set 2.961x speedup, step: 26
Epoch 51/200 |loss: -0.911476| train set 3.070x speedup, test set 1.791x speedup, val set 2.961x speedup, step: 27
Epoch 52/200 |loss: -0.912212| train set 3.213x speedup, test set 1.834x speedup, val set 3.136x speedup, step: 28
Epoch 53/200 |loss: -0.913206| train set 3.213x speedup, test set 1.917x speedup, val set 3.136x speedup, step: 29
Epoch 54/200 |loss: -0.913996| train set 3.207x speedup, test set 1.963x speedup, val set 3.130x speedup, step: 30
Epoch 55/200 |loss: -0.914533| train set 3.207x speedup, test set 1.966x speedup, val set 3.130x speedup, step: 31
Epoch 56/200 |loss: -0.915185| train set 2.695x speedup, test set 1.966x speedup, val set 2.612x speedup, step: 32
Epoch 57/200 |loss: -0.915795| train set 3.417x speedup, test set 1.964x speedup, val set 3.315x speedup, step: 1
Epoch 58/200 |loss: -0.915118| train set 2.716x speedup, test set 2.134x speedup, val set 2.636x speedup, step: 2
Epoch 59/200 |loss: -0.913518| train set 3.184x speedup, test set 1.964x speedup, val set 3.103x speedup, step: 3
Epoch 60/200 |loss: -0.915593| train set 3.417x speedup, test set 1.769x speedup, val set 3.315x speedup, step: 1
Epoch 61/200 |loss: -0.915754| train set 3.417x speedup, test set 0.925x speedup, val set 3.315x speedup, step: 1
Epoch 62/200 |loss: -0.917708| train set 3.044x speedup, test set 0.922x speedup, val set 2.931x speedup, step: 2
Epoch 63/200 |loss: -0.917000| train set 3.044x speedup, test set 0.914x speedup, val set 2.931x speedup, step: 3
Epoch 64/200 |loss: -0.922326| train set 3.044x speedup, test set 0.931x speedup, val set 2.931x speedup, step: 4
Epoch 65/200 |loss: -0.927761| train set 3.044x speedup, test set 0.894x speedup, val set 2.931x speedup, step: 5
Epoch 66/200 |loss: -0.929622| train set 3.025x speedup, test set 0.885x speedup, val set 2.933x speedup, step: 6
Epoch 67/200 |loss: -0.929707| train set 2.955x speedup, test set 0.908x speedup, val set 2.862x speedup, step: 7
Epoch 68/200 |loss: -0.930973| train set 3.025x speedup, test set 0.908x speedup, val set 2.933x speedup, step: 8
Epoch 69/200 |loss: -0.933767| train set 2.991x speedup, test set 0.861x speedup, val set 2.901x speedup, step: 9
Epoch 70/200 |loss: -0.935291| train set 3.008x speedup, test set 0.867x speedup, val set 2.906x speedup, step: 10
Epoch 71/200 |loss: -0.937308| train set 3.031x speedup, test set 0.891x speedup, val set 2.939x speedup, step: 11
Epoch 72/200 |loss: -0.937817| train set 3.031x speedup, test set 0.880x speedup, val set 2.939x speedup, step: 12
Epoch 73/200 |loss: -0.939120| train set 1.996x speedup, test set 0.808x speedup, val set 1.930x speedup, step: 13
Epoch 74/200 |loss: -0.938831| train set 3.031x speedup, test set 0.880x speedup, val set 2.939x speedup, step: 14
Epoch 75/200 |loss: -0.939020| train set 3.031x speedup, test set 0.808x speedup, val set 2.939x speedup, step: 15
Epoch 76/200 |loss: -0.940373| train set 2.969x speedup, test set 0.804x speedup, val set 2.865x speedup, step: 16
Epoch 77/200 |loss: -0.940989| train set 2.969x speedup, test set 0.840x speedup, val set 2.865x speedup, step: 17
Epoch 78/200 |loss: -0.941955| train set 2.969x speedup, test set 0.831x speedup, val set 2.865x speedup, step: 18
Epoch 79/200 |loss: -0.942742| train set 2.969x speedup, test set 0.920x speedup, val set 2.865x speedup, step: 19
Epoch 80/200 |loss: -0.943593| train set 2.970x speedup, test set 0.934x speedup, val set 2.865x speedup, step: 20
Epoch 81/200 |loss: -0.944101| train set 2.970x speedup, test set 0.941x speedup, val set 2.865x speedup, step: 21
Epoch 82/200 |loss: -0.944584| train set 2.970x speedup, test set 0.941x speedup, val set 2.865x speedup, step: 22
Epoch 83/200 |loss: -0.945194| train set 2.902x speedup, test set 0.941x speedup, val set 2.798x speedup, step: 23
Epoch 84/200 |loss: -0.945551| train set 2.970x speedup, test set 0.941x speedup, val set 2.865x speedup, step: 24
Epoch 85/200 |loss: -0.945906| train set 2.970x speedup, test set 0.949x speedup, val set 2.865x speedup, step: 25
Epoch 86/200 |loss: -0.946388| train set 2.970x speedup, test set 0.941x speedup, val set 2.865x speedup, step: 26
Epoch 87/200 |loss: -0.947025| train set 2.970x speedup, test set 0.942x speedup, val set 2.865x speedup, step: 27
Epoch 88/200 |loss: -0.947444| train set 2.970x speedup, test set 0.896x speedup, val set 2.865x speedup, step: 28
Epoch 89/200 |loss: -0.940702| train set 2.970x speedup, test set 0.962x speedup, val set 2.865x speedup, step: 29
Epoch 90/200 |loss: -0.947025| train set 2.971x speedup, test set 0.955x speedup, val set 2.866x speedup, step: 30
Epoch 91/200 |loss: -0.940072| train set 2.970x speedup, test set 0.893x speedup, val set 2.865x speedup, step: 31
Epoch 92/200 |loss: -0.947272| train set 3.076x speedup, test set 0.910x speedup, val set 2.985x speedup, step: 32
Epoch 93/200 |loss: -0.943518| train set 3.077x speedup, test set 0.910x speedup, val set 2.985x speedup, step: 33
Epoch 94/200 |loss: -0.943804| train set 3.077x speedup, test set 0.910x speedup, val set 2.985x speedup, step: 34
early stopping at epoch 94
Training per epoch cost 0.663 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.738s, pg runtime 0.014s, speedup 0.019x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 3.764s, pg runtime 2.959s, speedup 0.786x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 3.063s, pg runtime 0.153s, speedup 0.050x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.392s, pg runtime 0.354s, speedup 0.901x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 1.338s, pg runtime 0.086s, speedup 0.064x
21, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 57, train speedup 3.417, test speedup 1.964, val speedup 3.315
best test speedup epoch: 58, train speedup 2.716, test speedup 2.134, val speedup 2.636
best validation speedup epoch: 61, train speedup 3.417, test speedup 0.925, val speedup 3.315
last model at epoch 94, train speedup 3.077, test speedup 0.910, val speedup 2.985
execution cost 0:03:45.000497
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.455005, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727959| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859618| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862560| train set 2.911x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864884| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868434| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872710| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876673| train set 3.017x speedup, test set 1.775x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882222| train set 3.018x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886272| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.889998| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891175| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892785| train set 3.173x speedup, test set 1.713x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894031| train set 3.338x speedup, test set 1.713x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895463| train set 3.109x speedup, test set 1.714x speedup, val set 3.027x speedup, step: 2
Epoch 27/200 |loss: -0.896398| train set 3.109x speedup, test set 1.714x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897494| train set 3.055x speedup, test set 1.732x speedup, val set 2.995x speedup, step: 4
Epoch 29/200 |loss: -0.898451| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899091| train set 2.970x speedup, test set 1.797x speedup, val set 2.891x speedup, step: 6
Epoch 31/200 |loss: -0.899778| train set 2.984x speedup, test set 1.904x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.899763| train set 2.970x speedup, test set 1.799x speedup, val set 2.891x speedup, step: 8
Epoch 33/200 |loss: -0.900680| train set 2.833x speedup, test set 1.786x speedup, val set 2.653x speedup, step: 9
Epoch 34/200 |loss: -0.900946| train set 2.742x speedup, test set 1.797x speedup, val set 2.653x speedup, step: 10
Epoch 35/200 |loss: -0.901927| train set 2.742x speedup, test set 2.070x speedup, val set 2.653x speedup, step: 11
Epoch 36/200 |loss: -0.902678| train set 2.759x speedup, test set 2.075x speedup, val set 2.659x speedup, step: 12
Epoch 37/200 |loss: -0.903134| train set 2.791x speedup, test set 2.075x speedup, val set 2.659x speedup, step: 13
Epoch 38/200 |loss: -0.903452| train set 2.820x speedup, test set 1.861x speedup, val set 2.720x speedup, step: 14
Epoch 39/200 |loss: -0.904260| train set 2.825x speedup, test set 1.761x speedup, val set 2.724x speedup, step: 15
Epoch 40/200 |loss: -0.904622| train set 2.825x speedup, test set 1.777x speedup, val set 2.724x speedup, step: 16
Epoch 41/200 |loss: -0.904831| train set 2.825x speedup, test set 1.777x speedup, val set 2.724x speedup, step: 17
Epoch 42/200 |loss: -0.905277| train set 2.825x speedup, test set 1.777x speedup, val set 2.725x speedup, step: 18
Epoch 43/200 |loss: -0.905725| train set 2.825x speedup, test set 1.777x speedup, val set 2.725x speedup, step: 19
Epoch 44/200 |loss: -0.906140| train set 2.825x speedup, test set 1.787x speedup, val set 2.725x speedup, step: 20
Epoch 45/200 |loss: -0.906527| train set 2.917x speedup, test set 1.787x speedup, val set 2.720x speedup, step: 21
Epoch 46/200 |loss: -0.907013| train set 3.138x speedup, test set 1.830x speedup, val set 3.047x speedup, step: 22
Epoch 47/200 |loss: -0.907524| train set 3.138x speedup, test set 1.831x speedup, val set 3.047x speedup, step: 23
Epoch 48/200 |loss: -0.908160| train set 3.138x speedup, test set 1.786x speedup, val set 3.047x speedup, step: 24
Epoch 49/200 |loss: -0.908935| train set 3.144x speedup, test set 1.778x speedup, val set 3.052x speedup, step: 25
Epoch 50/200 |loss: -0.909847| train set 2.825x speedup, test set 1.825x speedup, val set 2.724x speedup, step: 26
Epoch 51/200 |loss: -0.910930| train set 2.825x speedup, test set 1.826x speedup, val set 2.724x speedup, step: 27
Epoch 52/200 |loss: -0.911637| train set 2.846x speedup, test set 1.826x speedup, val set 2.771x speedup, step: 28
Epoch 53/200 |loss: -0.912516| train set 2.846x speedup, test set 1.826x speedup, val set 2.771x speedup, step: 29
Epoch 54/200 |loss: -0.914371| train set 2.851x speedup, test set 0.882x speedup, val set 2.778x speedup, step: 30
Epoch 55/200 |loss: -0.920708| train set 2.851x speedup, test set 0.889x speedup, val set 2.778x speedup, step: 31
Epoch 56/200 |loss: -0.922850| train set 2.851x speedup, test set 0.892x speedup, val set 2.778x speedup, step: 32
Epoch 57/200 |loss: -0.926355| train set 2.851x speedup, test set 0.907x speedup, val set 2.778x speedup, step: 33
Epoch 58/200 |loss: -0.927504| train set 2.856x speedup, test set 0.875x speedup, val set 2.784x speedup, step: 34
Epoch 59/200 |loss: -0.929216| train set 3.031x speedup, test set 0.881x speedup, val set 2.939x speedup, step: 35
Epoch 60/200 |loss: -0.931498| train set 2.969x speedup, test set 0.881x speedup, val set 2.865x speedup, step: 36
Epoch 61/200 |loss: -0.933064| train set 2.969x speedup, test set 0.871x speedup, val set 2.865x speedup, step: 37
Epoch 62/200 |loss: -0.933940| train set 2.969x speedup, test set 0.887x speedup, val set 2.865x speedup, step: 38
Epoch 63/200 |loss: -0.933238| train set 1.970x speedup, test set 0.868x speedup, val set 1.898x speedup, step: 39
Epoch 64/200 |loss: -0.931843| train set 2.969x speedup, test set 0.944x speedup, val set 2.865x speedup, step: 40
Epoch 65/200 |loss: -0.929865| train set 2.969x speedup, test set 0.944x speedup, val set 2.865x speedup, step: 41
Epoch 66/200 |loss: -0.933607| train set 1.969x speedup, test set 0.855x speedup, val set 1.898x speedup, step: 42
Epoch 67/200 |loss: -0.933586| train set 1.969x speedup, test set 0.819x speedup, val set 1.898x speedup, step: 43
Epoch 68/200 |loss: -0.931458| train set 2.967x speedup, test set 0.894x speedup, val set 2.864x speedup, step: 44
Epoch 69/200 |loss: -0.936496| train set 2.862x speedup, test set 0.951x speedup, val set 2.757x speedup, step: 45
Epoch 70/200 |loss: -0.933264| train set 2.862x speedup, test set 0.958x speedup, val set 2.757x speedup, step: 46
Epoch 71/200 |loss: -0.933728| train set 2.969x speedup, test set 0.945x speedup, val set 2.865x speedup, step: 47
early stopping at epoch 71
Training per epoch cost 0.671 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.325s, pg runtime 0.072s, speedup 0.221x
02, opt runtime 0.183s, model runtime 1.314s, pg runtime 0.189s, speedup 0.144x
03, opt runtime 0.014s, model runtime 0.738s, pg runtime 0.014s, speedup 0.019x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 3.764s, pg runtime 2.959s, speedup 0.786x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
14, opt runtime 0.113s, model runtime 3.063s, pg runtime 0.153s, speedup 0.050x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 0.507s, pg runtime 0.453s, speedup 0.895x
17, opt runtime 0.327s, model runtime 0.392s, pg runtime 0.354s, speedup 0.901x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.061s, model runtime 0.094s, pg runtime 0.086s, speedup 0.915x
21, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.116s, pg runtime 0.112s, speedup 0.970x
28, opt runtime 0.154s, model runtime 0.476s, pg runtime 0.154s, speedup 0.324x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 25, train speedup 3.338, test speedup 1.713, val speedup 3.235
best test speedup epoch: 36, train speedup 2.759, test speedup 2.075, val speedup 2.659
best validation speedup epoch: 25, train speedup 3.338, test speedup 1.713, val speedup 3.235
last model at epoch 71, train speedup 2.969, test speedup 0.945, val speedup 2.865
execution cost 0:02:54.988468
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.190093, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727960| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859618| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862560| train set 2.911x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864884| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868434| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872710| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876673| train set 3.017x speedup, test set 1.775x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882222| train set 3.018x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886272| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.889998| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891175| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892785| train set 3.173x speedup, test set 1.713x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894030| train set 3.338x speedup, test set 1.713x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895463| train set 3.109x speedup, test set 1.714x speedup, val set 3.027x speedup, step: 2
Epoch 27/200 |loss: -0.896398| train set 3.109x speedup, test set 1.714x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897493| train set 3.055x speedup, test set 1.732x speedup, val set 2.995x speedup, step: 4
Epoch 29/200 |loss: -0.898451| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899092| train set 2.970x speedup, test set 1.797x speedup, val set 2.891x speedup, step: 6
Epoch 31/200 |loss: -0.899779| train set 2.984x speedup, test set 1.904x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.899798| train set 2.970x speedup, test set 1.799x speedup, val set 2.891x speedup, step: 8
Epoch 33/200 |loss: -0.900680| train set 2.833x speedup, test set 1.786x speedup, val set 2.653x speedup, step: 9
Epoch 34/200 |loss: -0.900951| train set 2.742x speedup, test set 1.786x speedup, val set 2.653x speedup, step: 10
Epoch 35/200 |loss: -0.901926| train set 2.742x speedup, test set 2.070x speedup, val set 2.653x speedup, step: 11
Epoch 36/200 |loss: -0.902679| train set 2.759x speedup, test set 2.075x speedup, val set 2.659x speedup, step: 12
Epoch 37/200 |loss: -0.903148| train set 2.759x speedup, test set 2.075x speedup, val set 2.659x speedup, step: 13
Epoch 38/200 |loss: -0.903460| train set 2.820x speedup, test set 1.831x speedup, val set 2.720x speedup, step: 14
Epoch 39/200 |loss: -0.904262| train set 2.825x speedup, test set 1.761x speedup, val set 2.724x speedup, step: 15
Epoch 40/200 |loss: -0.904626| train set 2.825x speedup, test set 1.777x speedup, val set 2.724x speedup, step: 16
Epoch 41/200 |loss: -0.904833| train set 2.825x speedup, test set 1.777x speedup, val set 2.724x speedup, step: 17
Epoch 42/200 |loss: -0.905275| train set 2.825x speedup, test set 1.777x speedup, val set 2.725x speedup, step: 18
Epoch 43/200 |loss: -0.905704| train set 2.825x speedup, test set 1.777x speedup, val set 2.725x speedup, step: 19
Epoch 44/200 |loss: -0.906076| train set 2.823x speedup, test set 1.787x speedup, val set 2.725x speedup, step: 20
Epoch 45/200 |loss: -0.906461| train set 2.917x speedup, test set 1.787x speedup, val set 2.720x speedup, step: 21
Epoch 46/200 |loss: -0.906882| train set 3.138x speedup, test set 1.787x speedup, val set 3.047x speedup, step: 22
Epoch 47/200 |loss: -0.907432| train set 3.138x speedup, test set 1.831x speedup, val set 3.047x speedup, step: 23
Epoch 48/200 |loss: -0.907983| train set 3.138x speedup, test set 1.831x speedup, val set 3.046x speedup, step: 24
Epoch 49/200 |loss: -0.908587| train set 3.138x speedup, test set 1.786x speedup, val set 3.046x speedup, step: 25
Epoch 50/200 |loss: -0.909209| train set 3.138x speedup, test set 1.786x speedup, val set 3.046x speedup, step: 26
Epoch 51/200 |loss: -0.910031| train set 3.138x speedup, test set 1.836x speedup, val set 3.046x speedup, step: 27
Epoch 52/200 |loss: -0.910631| train set 3.138x speedup, test set 1.836x speedup, val set 3.046x speedup, step: 28
Epoch 53/200 |loss: -0.911203| train set 2.666x speedup, test set 1.836x speedup, val set 2.576x speedup, step: 29
Epoch 54/200 |loss: -0.911817| train set 2.666x speedup, test set 1.836x speedup, val set 2.576x speedup, step: 30
Epoch 55/200 |loss: -0.912594| train set 2.671x speedup, test set 1.834x speedup, val set 2.581x speedup, step: 31
Epoch 56/200 |loss: -0.913968| train set 3.184x speedup, test set 1.837x speedup, val set 3.103x speedup, step: 32
Epoch 57/200 |loss: -0.914822| train set 3.107x speedup, test set 1.837x speedup, val set 3.061x speedup, step: 33
Epoch 58/200 |loss: -0.915886| train set 3.107x speedup, test set 0.900x speedup, val set 3.061x speedup, step: 34
Epoch 59/200 |loss: -0.919107| train set 2.856x speedup, test set 0.911x speedup, val set 2.784x speedup, step: 35
Epoch 60/200 |loss: -0.924105| train set 3.176x speedup, test set 0.929x speedup, val set 3.120x speedup, step: 36
Epoch 61/200 |loss: -0.924385| train set 2.856x speedup, test set 0.890x speedup, val set 2.784x speedup, step: 37
Epoch 62/200 |loss: -0.929839| train set 1.996x speedup, test set 0.872x speedup, val set 1.930x speedup, step: 38
Epoch 63/200 |loss: -0.921704| train set 3.031x speedup, test set 0.904x speedup, val set 2.939x speedup, step: 39
Epoch 64/200 |loss: -0.932431| train set 2.856x speedup, test set 0.967x speedup, val set 2.784x speedup, step: 40
Epoch 65/200 |loss: -0.926070| train set 1.996x speedup, test set 0.915x speedup, val set 1.930x speedup, step: 41
Epoch 66/200 |loss: -0.931242| train set 1.996x speedup, test set 0.875x speedup, val set 1.930x speedup, step: 42
Epoch 67/200 |loss: -0.931238| train set 1.969x speedup, test set 0.875x speedup, val set 1.898x speedup, step: 43
Epoch 68/200 |loss: -0.928551| train set 1.997x speedup, test set 0.885x speedup, val set 1.931x speedup, step: 44
Epoch 69/200 |loss: -0.933682| train set 1.862x speedup, test set 0.904x speedup, val set 1.802x speedup, step: 45
Epoch 70/200 |loss: -0.933061| train set 2.647x speedup, test set 0.966x speedup, val set 2.568x speedup, step: 46
Epoch 71/200 |loss: -0.928002| train set 2.592x speedup, test set 0.920x speedup, val set 2.513x speedup, step: 47
Epoch 72/200 |loss: -0.929268| train set 2.592x speedup, test set 0.919x speedup, val set 2.513x speedup, step: 48
Epoch 73/200 |loss: -0.933227| train set 2.673x speedup, test set 0.919x speedup, val set 2.592x speedup, step: 49
Epoch 74/200 |loss: -0.935354| train set 2.673x speedup, test set 0.955x speedup, val set 2.592x speedup, step: 50
Epoch 75/200 |loss: -0.934337| train set 2.673x speedup, test set 0.956x speedup, val set 2.592x speedup, step: 51
Epoch 76/200 |loss: -0.937581| train set 2.961x speedup, test set 0.895x speedup, val set 2.868x speedup, step: 52
Epoch 77/200 |loss: -0.937391| train set 2.955x speedup, test set 0.895x speedup, val set 2.862x speedup, step: 53
Epoch 78/200 |loss: -0.937074| train set 2.897x speedup, test set 0.955x speedup, val set 2.792x speedup, step: 54
Epoch 79/200 |loss: -0.938792| train set 2.958x speedup, test set 0.944x speedup, val set 2.853x speedup, step: 55
Epoch 80/200 |loss: -0.939310| train set 2.958x speedup, test set 0.938x speedup, val set 2.853x speedup, step: 56
Epoch 81/200 |loss: -0.939575| train set 2.958x speedup, test set 0.926x speedup, val set 2.853x speedup, step: 57
Epoch 82/200 |loss: -0.939963| train set 2.898x speedup, test set 0.934x speedup, val set 2.797x speedup, step: 58
Epoch 83/200 |loss: -0.940548| train set 2.897x speedup, test set 0.941x speedup, val set 2.792x speedup, step: 59
Epoch 84/200 |loss: -0.941167| train set 2.897x speedup, test set 0.930x speedup, val set 2.792x speedup, step: 60
Epoch 85/200 |loss: -0.941650| train set 2.897x speedup, test set 0.930x speedup, val set 2.792x speedup, step: 61
Epoch 86/200 |loss: -0.942336| train set 2.897x speedup, test set 0.951x speedup, val set 2.792x speedup, step: 62
Epoch 87/200 |loss: -0.943136| train set 2.955x speedup, test set 0.951x speedup, val set 2.862x speedup, step: 63
Epoch 88/200 |loss: -0.943709| train set 2.961x speedup, test set 0.951x speedup, val set 2.868x speedup, step: 64
Epoch 89/200 |loss: -0.944099| train set 2.961x speedup, test set 0.952x speedup, val set 2.868x speedup, step: 65
Epoch 90/200 |loss: -0.944381| train set 2.961x speedup, test set 0.939x speedup, val set 2.868x speedup, step: 66
Epoch 91/200 |loss: -0.944609| train set 2.961x speedup, test set 0.939x speedup, val set 2.868x speedup, step: 67
Epoch 92/200 |loss: -0.945050| train set 2.961x speedup, test set 0.940x speedup, val set 2.868x speedup, step: 68
Epoch 93/200 |loss: -0.945476| train set 2.961x speedup, test set 0.940x speedup, val set 2.868x speedup, step: 69
Epoch 94/200 |loss: -0.945910| train set 2.961x speedup, test set 0.940x speedup, val set 2.868x speedup, step: 70
Epoch 95/200 |loss: -0.946292| train set 2.961x speedup, test set 0.940x speedup, val set 2.868x speedup, step: 71
Epoch 96/200 |loss: -0.946536| train set 2.961x speedup, test set 0.940x speedup, val set 2.868x speedup, step: 72
Epoch 97/200 |loss: -0.946707| train set 2.961x speedup, test set 0.944x speedup, val set 2.868x speedup, step: 73
Epoch 98/200 |loss: -0.946885| train set 2.961x speedup, test set 0.944x speedup, val set 2.868x speedup, step: 74
Epoch 99/200 |loss: -0.947185| train set 2.961x speedup, test set 0.940x speedup, val set 2.868x speedup, step: 75
Epoch 100/200 |loss: -0.947426| train set 2.961x speedup, test set 0.940x speedup, val set 2.868x speedup, step: 76
Epoch 101/200 |loss: -0.947595| train set 2.961x speedup, test set 0.932x speedup, val set 2.868x speedup, step: 77
Epoch 102/200 |loss: -0.947748| train set 2.962x speedup, test set 0.932x speedup, val set 2.869x speedup, step: 78
Epoch 103/200 |loss: -0.947887| train set 2.962x speedup, test set 0.932x speedup, val set 2.869x speedup, step: 79
Epoch 104/200 |loss: -0.948012| train set 2.962x speedup, test set 0.932x speedup, val set 2.869x speedup, step: 80
Epoch 105/200 |loss: -0.948171| train set 2.962x speedup, test set 0.932x speedup, val set 2.869x speedup, step: 81
Epoch 106/200 |loss: -0.948361| train set 2.962x speedup, test set 0.935x speedup, val set 2.869x speedup, step: 82
Epoch 107/200 |loss: -0.948524| train set 2.962x speedup, test set 0.935x speedup, val set 2.869x speedup, step: 83
Epoch 108/200 |loss: -0.948653| train set 2.962x speedup, test set 0.936x speedup, val set 2.869x speedup, step: 84
Epoch 109/200 |loss: -0.948793| train set 2.962x speedup, test set 0.936x speedup, val set 2.869x speedup, step: 85
Epoch 110/200 |loss: -0.948946| train set 3.032x speedup, test set 0.954x speedup, val set 3.074x speedup, step: 86
Epoch 111/200 |loss: -0.949104| train set 3.396x speedup, test set 0.953x speedup, val set 3.311x speedup, step: 1
Epoch 112/200 |loss: -0.949234| train set 3.396x speedup, test set 0.966x speedup, val set 3.311x speedup, step: 1
Epoch 113/200 |loss: -0.949346| train set 3.396x speedup, test set 0.966x speedup, val set 3.311x speedup, step: 1
Epoch 114/200 |loss: -0.949480| train set 3.396x speedup, test set 0.966x speedup, val set 3.311x speedup, step: 1
Epoch 115/200 |loss: -0.949622| train set 3.396x speedup, test set 0.966x speedup, val set 3.311x speedup, step: 1
Epoch 116/200 |loss: -0.949741| train set 3.396x speedup, test set 0.953x speedup, val set 3.311x speedup, step: 1
Epoch 117/200 |loss: -0.949857| train set 3.396x speedup, test set 0.966x speedup, val set 3.311x speedup, step: 1
Epoch 118/200 |loss: -0.949984| train set 3.396x speedup, test set 0.966x speedup, val set 3.311x speedup, step: 1
Epoch 119/200 |loss: -0.950110| train set 3.396x speedup, test set 0.966x speedup, val set 3.311x speedup, step: 1
Epoch 120/200 |loss: -0.950237| train set 3.396x speedup, test set 0.966x speedup, val set 3.311x speedup, step: 1
Epoch 121/200 |loss: -0.950381| train set 3.396x speedup, test set 0.968x speedup, val set 3.311x speedup, step: 1
Epoch 122/200 |loss: -0.950531| train set 3.495x speedup, test set 0.968x speedup, val set 3.463x speedup, step: 1
Epoch 123/200 |loss: -0.950680| train set 3.495x speedup, test set 0.967x speedup, val set 3.463x speedup, step: 1
Epoch 124/200 |loss: -0.950830| train set 3.495x speedup, test set 0.967x speedup, val set 3.463x speedup, step: 1
Epoch 125/200 |loss: -0.950976| train set 3.495x speedup, test set 0.967x speedup, val set 3.463x speedup, step: 1
Epoch 126/200 |loss: -0.951120| train set 3.495x speedup, test set 0.968x speedup, val set 3.463x speedup, step: 1
Epoch 127/200 |loss: -0.951258| train set 3.495x speedup, test set 0.947x speedup, val set 3.463x speedup, step: 1
Epoch 128/200 |loss: -0.951372| train set 3.495x speedup, test set 0.947x speedup, val set 3.463x speedup, step: 1
Epoch 129/200 |loss: -0.951475| train set 3.495x speedup, test set 0.947x speedup, val set 3.463x speedup, step: 1
Epoch 130/200 |loss: -0.951576| train set 3.495x speedup, test set 0.947x speedup, val set 3.463x speedup, step: 1
Epoch 131/200 |loss: -0.951666| train set 3.516x speedup, test set 0.947x speedup, val set 3.465x speedup, step: 1
Epoch 132/200 |loss: -0.951741| train set 3.616x speedup, test set 0.947x speedup, val set 3.582x speedup, step: 1
Epoch 133/200 |loss: -0.951811| train set 3.640x speedup, test set 0.947x speedup, val set 3.611x speedup, step: 1
Epoch 134/200 |loss: -0.951882| train set 3.640x speedup, test set 0.947x speedup, val set 3.611x speedup, step: 1
Epoch 135/200 |loss: -0.951948| train set 3.640x speedup, test set 0.947x speedup, val set 3.610x speedup, step: 2
Epoch 136/200 |loss: -0.952010| train set 3.640x speedup, test set 0.947x speedup, val set 3.610x speedup, step: 3
Epoch 137/200 |loss: -0.952071| train set 3.640x speedup, test set 0.947x speedup, val set 3.610x speedup, step: 4
Epoch 138/200 |loss: -0.952122| train set 3.640x speedup, test set 0.947x speedup, val set 3.610x speedup, step: 5
Epoch 139/200 |loss: -0.952167| train set 3.552x speedup, test set 0.947x speedup, val set 3.500x speedup, step: 6
Epoch 140/200 |loss: -0.952208| train set 3.552x speedup, test set 0.947x speedup, val set 3.500x speedup, step: 7
Epoch 141/200 |loss: -0.952254| train set 3.552x speedup, test set 0.943x speedup, val set 3.500x speedup, step: 8
Epoch 142/200 |loss: -0.952295| train set 3.552x speedup, test set 0.943x speedup, val set 3.500x speedup, step: 9
Epoch 143/200 |loss: -0.952330| train set 3.889x speedup, test set 0.943x speedup, val set 3.834x speedup, step: 1
Epoch 144/200 |loss: -0.952369| train set 3.889x speedup, test set 0.943x speedup, val set 3.834x speedup, step: 1
Epoch 145/200 |loss: -0.952409| train set 3.889x speedup, test set 0.943x speedup, val set 3.834x speedup, step: 1
Epoch 146/200 |loss: -0.952454| train set 3.889x speedup, test set 0.939x speedup, val set 3.834x speedup, step: 1
Epoch 147/200 |loss: -0.952501| train set 3.889x speedup, test set 0.939x speedup, val set 3.834x speedup, step: 1
Epoch 148/200 |loss: -0.952548| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 149/200 |loss: -0.952597| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 150/200 |loss: -0.952642| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 151/200 |loss: -0.952684| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 152/200 |loss: -0.952725| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 153/200 |loss: -0.952766| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 154/200 |loss: -0.952807| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 155/200 |loss: -0.952847| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 156/200 |loss: -0.952888| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 157/200 |loss: -0.952928| train set 3.889x speedup, test set 0.940x speedup, val set 3.834x speedup, step: 1
Epoch 158/200 |loss: -0.952974| train set 3.995x speedup, test set 0.940x speedup, val set 3.967x speedup, step: 1
Epoch 159/200 |loss: -0.953030| train set 3.995x speedup, test set 0.940x speedup, val set 3.967x speedup, step: 1
Epoch 160/200 |loss: -0.953077| train set 3.995x speedup, test set 0.945x speedup, val set 3.967x speedup, step: 1
Epoch 161/200 |loss: -0.953112| train set 3.995x speedup, test set 0.945x speedup, val set 3.967x speedup, step: 1
Epoch 162/200 |loss: -0.953143| train set 3.995x speedup, test set 0.933x speedup, val set 3.967x speedup, step: 1
Epoch 163/200 |loss: -0.953171| train set 3.995x speedup, test set 0.934x speedup, val set 3.967x speedup, step: 1
Epoch 164/200 |loss: -0.953200| train set 3.995x speedup, test set 0.934x speedup, val set 3.967x speedup, step: 1
Epoch 165/200 |loss: -0.953232| train set 3.995x speedup, test set 0.934x speedup, val set 3.967x speedup, step: 1
Epoch 166/200 |loss: -0.953260| train set 3.995x speedup, test set 0.934x speedup, val set 3.967x speedup, step: 1
Epoch 167/200 |loss: -0.953286| train set 3.995x speedup, test set 0.934x speedup, val set 3.967x speedup, step: 1
Epoch 168/200 |loss: -0.953312| train set 3.995x speedup, test set 0.934x speedup, val set 3.967x speedup, step: 1
Epoch 169/200 |loss: -0.953336| train set 3.995x speedup, test set 0.963x speedup, val set 3.967x speedup, step: 1
Epoch 170/200 |loss: -0.953356| train set 3.995x speedup, test set 0.963x speedup, val set 3.967x speedup, step: 1
Epoch 171/200 |loss: -0.953378| train set 3.995x speedup, test set 0.963x speedup, val set 3.967x speedup, step: 1
Epoch 172/200 |loss: -0.953400| train set 3.995x speedup, test set 0.963x speedup, val set 3.967x speedup, step: 1
Epoch 173/200 |loss: -0.953421| train set 3.995x speedup, test set 0.963x speedup, val set 3.967x speedup, step: 1
Epoch 174/200 |loss: -0.953444| train set 4.110x speedup, test set 0.963x speedup, val set 3.967x speedup, step: 1
Epoch 175/200 |loss: -0.953469| train set 4.110x speedup, test set 0.963x speedup, val set 3.967x speedup, step: 1
Epoch 176/200 |loss: -0.953495| train set 4.110x speedup, test set 0.962x speedup, val set 3.967x speedup, step: 1
Epoch 177/200 |loss: -0.953524| train set 4.110x speedup, test set 0.962x speedup, val set 3.967x speedup, step: 1
Epoch 178/200 |loss: -0.953559| train set 4.110x speedup, test set 0.962x speedup, val set 3.967x speedup, step: 1
Epoch 179/200 |loss: -0.953595| train set 4.110x speedup, test set 0.934x speedup, val set 3.967x speedup, step: 1
Epoch 180/200 |loss: -0.953628| train set 4.110x speedup, test set 0.934x speedup, val set 3.967x speedup, step: 1
Epoch 181/200 |loss: -0.953655| train set 4.110x speedup, test set 0.934x speedup, val set 3.967x speedup, step: 1
Epoch 182/200 |loss: -0.953679| train set 4.110x speedup, test set 0.930x speedup, val set 3.967x speedup, step: 1
Epoch 183/200 |loss: -0.953700| train set 4.166x speedup, test set 0.930x speedup, val set 3.995x speedup, step: 1
Epoch 184/200 |loss: -0.953722| train set 4.166x speedup, test set 0.929x speedup, val set 4.018x speedup, step: 1
Epoch 185/200 |loss: -0.953745| train set 4.166x speedup, test set 0.929x speedup, val set 4.018x speedup, step: 1
Epoch 186/200 |loss: -0.953769| train set 4.166x speedup, test set 0.929x speedup, val set 4.018x speedup, step: 1
Epoch 187/200 |loss: -0.953794| train set 4.166x speedup, test set 0.929x speedup, val set 4.018x speedup, step: 1
Epoch 188/200 |loss: -0.953819| train set 4.166x speedup, test set 0.929x speedup, val set 4.018x speedup, step: 1
Epoch 189/200 |loss: -0.953842| train set 4.166x speedup, test set 0.929x speedup, val set 4.018x speedup, step: 1
Epoch 190/200 |loss: -0.953864| train set 4.166x speedup, test set 0.909x speedup, val set 4.018x speedup, step: 1
Epoch 191/200 |loss: -0.953884| train set 4.166x speedup, test set 0.909x speedup, val set 4.018x speedup, step: 1
Epoch 192/200 |loss: -0.953901| train set 4.166x speedup, test set 0.935x speedup, val set 4.018x speedup, step: 1
Epoch 193/200 |loss: -0.953917| train set 4.166x speedup, test set 0.935x speedup, val set 4.018x speedup, step: 1
Epoch 194/200 |loss: -0.953933| train set 4.166x speedup, test set 0.935x speedup, val set 4.018x speedup, step: 1
Epoch 195/200 |loss: -0.953949| train set 4.166x speedup, test set 0.935x speedup, val set 4.018x speedup, step: 1
Epoch 196/200 |loss: -0.953964| train set 4.166x speedup, test set 0.935x speedup, val set 4.018x speedup, step: 1
Epoch 197/200 |loss: -0.953979| train set 4.166x speedup, test set 0.935x speedup, val set 4.018x speedup, step: 1
Epoch 198/200 |loss: -0.953994| train set 4.307x speedup, test set 0.935x speedup, val set 4.159x speedup, step: 1
Epoch 199/200 |loss: -0.954009| train set 4.307x speedup, test set 0.897x speedup, val set 4.159x speedup, step: 1
Training per epoch cost 0.640 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 2.958s, pg runtime 0.802s, speedup 0.271x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.580s, pg runtime 0.557s, speedup 0.960x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.407s, pg runtime 0.313s, speedup 0.769x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.611s, pg runtime 0.354s, speedup 0.579x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 1.290s, pg runtime 0.086s, speedup 0.066x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 1.143s, pg runtime 0.891s, speedup 0.780x
23, opt runtime 0.389s, model runtime 0.421s, pg runtime 0.389s, speedup 0.924x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 198, train speedup 4.307, test speedup 0.935, val speedup 4.159
best test speedup epoch: 36, train speedup 2.759, test speedup 2.075, val speedup 2.659
best validation speedup epoch: 199, train speedup 4.307, test speedup 0.897, val speedup 4.159
last model at epoch 199, train speedup 4.307, test speedup 0.897, val speedup 4.159
execution cost 0:07:34.707726
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.633906, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727959| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859616| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862551| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864919| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868447| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872703| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876976| train set 3.017x speedup, test set 1.803x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882324| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886571| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.890059| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891389| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892894| train set 3.173x speedup, test set 1.947x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894000| train set 3.338x speedup, test set 1.714x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895490| train set 3.331x speedup, test set 1.714x speedup, val set 3.228x speedup, step: 2
Epoch 27/200 |loss: -0.896503| train set 3.109x speedup, test set 1.722x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897701| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 4
Epoch 29/200 |loss: -0.898503| train set 3.041x speedup, test set 1.755x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899136| train set 2.970x speedup, test set 1.858x speedup, val set 2.891x speedup, step: 6
Epoch 31/200 |loss: -0.899871| train set 2.970x speedup, test set 1.858x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.899496| train set 3.041x speedup, test set 1.923x speedup, val set 2.963x speedup, step: 8
Epoch 33/200 |loss: -0.900765| train set 3.041x speedup, test set 1.804x speedup, val set 2.963x speedup, step: 9
Epoch 34/200 |loss: -0.899456| train set 2.684x speedup, test set 1.904x speedup, val set 2.595x speedup, step: 10
Epoch 35/200 |loss: -0.902502| train set 2.684x speedup, test set 2.070x speedup, val set 2.595x speedup, step: 11
Epoch 36/200 |loss: -0.902102| train set 2.759x speedup, test set 2.070x speedup, val set 2.659x speedup, step: 12
Epoch 37/200 |loss: -0.898632| train set 2.825x speedup, test set 1.777x speedup, val set 2.724x speedup, step: 13
Epoch 38/200 |loss: -0.902872| train set 3.007x speedup, test set 1.778x speedup, val set 2.886x speedup, step: 14
Epoch 39/200 |loss: -0.888487| train set 3.007x speedup, test set 1.778x speedup, val set 2.886x speedup, step: 15
Epoch 40/200 |loss: -0.888666| train set 3.007x speedup, test set 1.721x speedup, val set 2.886x speedup, step: 16
early stopping at epoch 40
Training per epoch cost 0.653 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.325s, pg runtime 0.072s, speedup 0.221x
02, opt runtime 0.183s, model runtime 1.314s, pg runtime 0.189s, speedup 0.144x
03, opt runtime 0.014s, model runtime 0.738s, pg runtime 0.014s, speedup 0.019x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 3.764s, pg runtime 2.959s, speedup 0.786x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
14, opt runtime 0.113s, model runtime 3.063s, pg runtime 0.153s, speedup 0.050x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 0.507s, pg runtime 0.453s, speedup 0.895x
17, opt runtime 0.327s, model runtime 0.392s, pg runtime 0.354s, speedup 0.901x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.061s, model runtime 0.083s, pg runtime 0.086s, speedup 1.030x
21, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.116s, pg runtime 0.112s, speedup 0.970x
28, opt runtime 0.154s, model runtime 0.476s, pg runtime 0.154s, speedup 0.324x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 25, train speedup 3.338, test speedup 1.714, val speedup 3.235
best test speedup epoch: 35, train speedup 2.684, test speedup 2.070, val speedup 2.595
best validation speedup epoch: 25, train speedup 3.338, test speedup 1.714, val speedup 3.235
last model at epoch 40, train speedup 3.007, test speedup 1.721, val speedup 2.886
execution cost 0:01:41.486544
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.453411, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727959| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859616| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862551| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864919| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868447| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872703| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876976| train set 3.017x speedup, test set 1.803x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882324| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886571| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.890059| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891389| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892894| train set 3.173x speedup, test set 1.947x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894000| train set 3.338x speedup, test set 1.714x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895490| train set 3.331x speedup, test set 1.714x speedup, val set 3.228x speedup, step: 2
Epoch 27/200 |loss: -0.896503| train set 3.109x speedup, test set 1.722x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897701| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 4
Epoch 29/200 |loss: -0.898503| train set 3.041x speedup, test set 1.755x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899136| train set 2.970x speedup, test set 1.858x speedup, val set 2.891x speedup, step: 6
Epoch 31/200 |loss: -0.899871| train set 2.970x speedup, test set 1.858x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.899495| train set 3.041x speedup, test set 1.923x speedup, val set 2.963x speedup, step: 8
Epoch 33/200 |loss: -0.900765| train set 3.041x speedup, test set 1.804x speedup, val set 2.963x speedup, step: 9
Epoch 34/200 |loss: -0.899454| train set 2.684x speedup, test set 1.904x speedup, val set 2.595x speedup, step: 10
Epoch 35/200 |loss: -0.902501| train set 2.684x speedup, test set 2.070x speedup, val set 2.595x speedup, step: 11
Epoch 36/200 |loss: -0.902102| train set 2.759x speedup, test set 2.070x speedup, val set 2.659x speedup, step: 12
Epoch 37/200 |loss: -0.898631| train set 2.825x speedup, test set 1.777x speedup, val set 2.724x speedup, step: 13
Epoch 38/200 |loss: -0.902872| train set 3.007x speedup, test set 1.778x speedup, val set 2.886x speedup, step: 14
Epoch 39/200 |loss: -0.888493| train set 3.007x speedup, test set 1.778x speedup, val set 2.886x speedup, step: 15
Epoch 40/200 |loss: -0.888652| train set 3.007x speedup, test set 1.721x speedup, val set 2.886x speedup, step: 16
early stopping at epoch 40
Training per epoch cost 0.688 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.325s, pg runtime 0.072s, speedup 0.221x
02, opt runtime 0.183s, model runtime 1.314s, pg runtime 0.189s, speedup 0.144x
03, opt runtime 0.014s, model runtime 0.738s, pg runtime 0.014s, speedup 0.019x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 2.262s, pg runtime 3.549s, speedup 1.569x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 3.764s, pg runtime 2.959s, speedup 0.786x
11, opt runtime 0.294s, model runtime 2.352s, pg runtime 2.352s, speedup 1.000x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 2.323s, pg runtime 53.885s, speedup 23.201x
14, opt runtime 0.113s, model runtime 3.063s, pg runtime 0.153s, speedup 0.050x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 0.507s, pg runtime 0.453s, speedup 0.895x
17, opt runtime 0.327s, model runtime 0.392s, pg runtime 0.354s, speedup 0.901x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 2.365s, pg runtime 3.540s, speedup 1.497x
20, opt runtime 0.061s, model runtime 0.083s, pg runtime 0.086s, speedup 1.030x
21, opt runtime 0.626s, model runtime 1.397s, pg runtime 2.558s, speedup 1.832x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.232s, pg runtime 0.189s, speedup 0.816x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.116s, pg runtime 0.112s, speedup 0.970x
28, opt runtime 0.154s, model runtime 0.476s, pg runtime 0.154s, speedup 0.324x
29, opt runtime 0.136s, model runtime 0.140s, pg runtime 0.137s, speedup 0.973x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 1.924s, pg runtime 0.250s, speedup 0.130x
====================
best train speedup epoch: 25, train speedup 3.338, test speedup 1.714, val speedup 3.235
best test speedup epoch: 35, train speedup 2.684, test speedup 2.070, val speedup 2.595
best validation speedup epoch: 25, train speedup 3.338, test speedup 1.714, val speedup 3.235
last model at epoch 40, train speedup 3.007, test speedup 1.721, val speedup 2.886
execution cost 0:01:45.073411
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.106918, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727959| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859618| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862560| train set 2.911x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864884| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868434| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872710| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876673| train set 3.017x speedup, test set 1.775x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882222| train set 3.018x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886273| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.889997| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891178| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892789| train set 3.173x speedup, test set 1.890x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894035| train set 3.338x speedup, test set 1.713x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895462| train set 3.109x speedup, test set 1.714x speedup, val set 3.027x speedup, step: 2
Epoch 27/200 |loss: -0.896393| train set 3.109x speedup, test set 1.714x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897468| train set 3.078x speedup, test set 1.723x speedup, val set 2.995x speedup, step: 4
Epoch 29/200 |loss: -0.898439| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899074| train set 3.041x speedup, test set 1.772x speedup, val set 2.963x speedup, step: 6
Epoch 31/200 |loss: -0.899713| train set 2.970x speedup, test set 1.799x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.900390| train set 2.818x speedup, test set 1.799x speedup, val set 2.735x speedup, step: 8
Epoch 33/200 |loss: -0.901099| train set 2.684x speedup, test set 1.799x speedup, val set 2.595x speedup, step: 9
Epoch 34/200 |loss: -0.901600| train set 2.684x speedup, test set 1.774x speedup, val set 2.595x speedup, step: 10
Epoch 35/200 |loss: -0.901827| train set 2.742x speedup, test set 1.772x speedup, val set 2.653x speedup, step: 11
Epoch 36/200 |loss: -0.902639| train set 2.820x speedup, test set 1.763x speedup, val set 2.719x speedup, step: 12
Epoch 37/200 |loss: -0.902618| train set 2.820x speedup, test set 1.775x speedup, val set 2.720x speedup, step: 13
Epoch 38/200 |loss: -0.903458| train set 2.820x speedup, test set 1.948x speedup, val set 2.720x speedup, step: 14
Epoch 39/200 |loss: -0.904018| train set 2.820x speedup, test set 1.948x speedup, val set 2.720x speedup, step: 15
Epoch 40/200 |loss: -0.904154| train set 2.820x speedup, test set 1.919x speedup, val set 2.720x speedup, step: 16
Epoch 41/200 |loss: -0.904756| train set 2.825x speedup, test set 1.831x speedup, val set 2.725x speedup, step: 17
Epoch 42/200 |loss: -0.905471| train set 3.144x speedup, test set 1.831x speedup, val set 3.052x speedup, step: 18
Epoch 43/200 |loss: -0.905721| train set 3.144x speedup, test set 1.787x speedup, val set 3.052x speedup, step: 19
Epoch 44/200 |loss: -0.906026| train set 3.144x speedup, test set 1.831x speedup, val set 3.052x speedup, step: 20
Epoch 45/200 |loss: -0.906381| train set 3.138x speedup, test set 1.831x speedup, val set 3.046x speedup, step: 21
Epoch 46/200 |loss: -0.906850| train set 3.138x speedup, test set 1.946x speedup, val set 3.047x speedup, step: 22
Epoch 47/200 |loss: -0.907246| train set 3.138x speedup, test set 1.946x speedup, val set 3.047x speedup, step: 23
Epoch 48/200 |loss: -0.907643| train set 3.138x speedup, test set 1.834x speedup, val set 3.047x speedup, step: 24
Epoch 49/200 |loss: -0.908197| train set 3.138x speedup, test set 1.831x speedup, val set 3.046x speedup, step: 25
Epoch 50/200 |loss: -0.908922| train set 3.138x speedup, test set 1.786x speedup, val set 3.046x speedup, step: 26
Epoch 51/200 |loss: -0.909616| train set 3.144x speedup, test set 1.788x speedup, val set 3.052x speedup, step: 27
Epoch 52/200 |loss: -0.910149| train set 2.671x speedup, test set 1.794x speedup, val set 2.581x speedup, step: 28
Epoch 53/200 |loss: -0.910820| train set 2.667x speedup, test set 1.836x speedup, val set 2.578x speedup, step: 29
Epoch 54/200 |loss: -0.911634| train set 2.666x speedup, test set 1.836x speedup, val set 2.576x speedup, step: 30
Epoch 55/200 |loss: -0.912193| train set 2.666x speedup, test set 1.922x speedup, val set 2.576x speedup, step: 31
Epoch 56/200 |loss: -0.912933| train set 2.666x speedup, test set 1.922x speedup, val set 2.576x speedup, step: 32
Epoch 57/200 |loss: -0.913590| train set 2.666x speedup, test set 1.927x speedup, val set 2.576x speedup, step: 33
Epoch 58/200 |loss: -0.914242| train set 2.671x speedup, test set 1.878x speedup, val set 2.581x speedup, step: 34
Epoch 59/200 |loss: -0.914857| train set 2.671x speedup, test set 1.878x speedup, val set 2.581x speedup, step: 35
Epoch 60/200 |loss: -0.916293| train set 2.671x speedup, test set 1.878x speedup, val set 2.581x speedup, step: 36
Epoch 61/200 |loss: -0.916650| train set 2.671x speedup, test set 1.965x speedup, val set 2.581x speedup, step: 37
Epoch 62/200 |loss: -0.913985| train set 2.597x speedup, test set 1.878x speedup, val set 2.530x speedup, step: 38
Epoch 63/200 |loss: -0.916900| train set 2.865x speedup, test set 1.830x speedup, val set 2.766x speedup, step: 39
Epoch 64/200 |loss: -0.921305| train set 3.417x speedup, test set 0.859x speedup, val set 3.315x speedup, step: 1
Epoch 65/200 |loss: -0.928076| train set 3.401x speedup, test set 0.851x speedup, val set 3.324x speedup, step: 1
Epoch 66/200 |loss: -0.929913| train set 3.031x speedup, test set 0.838x speedup, val set 2.939x speedup, step: 2
Epoch 67/200 |loss: -0.930733| train set 1.996x speedup, test set 0.838x speedup, val set 1.930x speedup, step: 3
Epoch 68/200 |loss: -0.931877| train set 1.996x speedup, test set 0.810x speedup, val set 1.930x speedup, step: 4
Epoch 69/200 |loss: -0.933799| train set 1.996x speedup, test set 0.818x speedup, val set 1.930x speedup, step: 5
Epoch 70/200 |loss: -0.934896| train set 1.996x speedup, test set 0.870x speedup, val set 1.930x speedup, step: 6
Epoch 71/200 |loss: -0.935751| train set 1.996x speedup, test set 0.921x speedup, val set 1.930x speedup, step: 7
Epoch 72/200 |loss: -0.936594| train set 3.031x speedup, test set 0.958x speedup, val set 2.939x speedup, step: 8
Epoch 73/200 |loss: -0.937425| train set 3.031x speedup, test set 0.913x speedup, val set 2.939x speedup, step: 9
Epoch 74/200 |loss: -0.938765| train set 3.031x speedup, test set 0.927x speedup, val set 2.939x speedup, step: 10
Epoch 75/200 |loss: -0.939651| train set 2.961x speedup, test set 0.949x speedup, val set 2.868x speedup, step: 11
Epoch 76/200 |loss: -0.940219| train set 2.961x speedup, test set 0.946x speedup, val set 2.868x speedup, step: 12
Epoch 77/200 |loss: -0.940712| train set 2.902x speedup, test set 0.941x speedup, val set 2.798x speedup, step: 13
Epoch 78/200 |loss: -0.941242| train set 2.900x speedup, test set 0.941x speedup, val set 2.796x speedup, step: 14
Epoch 79/200 |loss: -0.941725| train set 2.900x speedup, test set 0.934x speedup, val set 2.796x speedup, step: 15
Epoch 80/200 |loss: -0.942139| train set 2.900x speedup, test set 0.936x speedup, val set 2.796x speedup, step: 16
Epoch 81/200 |loss: -0.942493| train set 2.900x speedup, test set 0.936x speedup, val set 2.796x speedup, step: 17
Epoch 82/200 |loss: -0.942666| train set 2.900x speedup, test set 0.936x speedup, val set 2.796x speedup, step: 18
Epoch 83/200 |loss: -0.943353| train set 2.900x speedup, test set 0.936x speedup, val set 2.796x speedup, step: 19
Epoch 84/200 |loss: -0.944259| train set 2.900x speedup, test set 0.946x speedup, val set 2.796x speedup, step: 20
Epoch 85/200 |loss: -0.941595| train set 2.902x speedup, test set 0.994x speedup, val set 2.797x speedup, step: 21
Epoch 86/200 |loss: -0.932182| train set 2.902x speedup, test set 0.993x speedup, val set 2.797x speedup, step: 22
Epoch 87/200 |loss: -0.933047| train set 2.900x speedup, test set 0.947x speedup, val set 2.796x speedup, step: 23
early stopping at epoch 87
Training per epoch cost 0.552 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 1.314s, pg runtime 0.189s, speedup 0.144x
03, opt runtime 0.014s, model runtime 0.738s, pg runtime 0.014s, speedup 0.019x
04, opt runtime 0.348s, model runtime 1.050s, pg runtime 0.348s, speedup 0.331x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 1.040s, pg runtime 0.942s, speedup 0.906x
08, opt runtime 0.206s, model runtime 2.362s, pg runtime 0.206s, speedup 0.087x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 2.959s, pg runtime 2.959s, speedup 1.000x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.463s, pg runtime 0.557s, speedup 1.203x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 3.063s, pg runtime 0.153s, speedup 0.050x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 3.353s, pg runtime 0.354s, speedup 0.106x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 1.338s, pg runtime 0.086s, speedup 0.064x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 2.615s, pg runtime 0.434s, speedup 0.166x
26, opt runtime 0.020s, model runtime 0.176s, pg runtime 0.020s, speedup 0.114x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 1.692s, pg runtime 0.023s, speedup 0.014x
31, opt runtime 0.965s, model runtime 2.411s, pg runtime 0.965s, speedup 0.400x
32, opt runtime 1.315s, model runtime 1.571s, pg runtime 1.315s, speedup 0.837x
33, opt runtime 0.250s, model runtime 0.262s, pg runtime 0.250s, speedup 0.954x
====================
best train speedup epoch: 64, train speedup 3.417, test speedup 0.859, val speedup 3.315
best test speedup epoch: 61, train speedup 2.671, test speedup 1.965, val speedup 2.581
best validation speedup epoch: 65, train speedup 3.401, test speedup 0.851, val speedup 3.324
last model at epoch 87, train speedup 2.900, test speedup 0.947, val speedup 2.796
execution cost 0:02:58.177235
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.488786, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727960| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859616| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862551| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864920| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868445| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872690| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876951| train set 3.017x speedup, test set 1.803x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882330| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886577| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.890070| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891448| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892879| train set 3.173x speedup, test set 1.890x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894040| train set 3.338x speedup, test set 1.714x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895449| train set 3.331x speedup, test set 1.714x speedup, val set 3.228x speedup, step: 2
Epoch 27/200 |loss: -0.896519| train set 3.109x speedup, test set 1.722x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897731| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 4
Epoch 29/200 |loss: -0.898470| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899143| train set 2.970x speedup, test set 1.758x speedup, val set 2.891x speedup, step: 6
Epoch 31/200 |loss: -0.899797| train set 2.970x speedup, test set 1.907x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.900493| train set 2.970x speedup, test set 1.907x speedup, val set 2.891x speedup, step: 8
Epoch 33/200 |loss: -0.900443| train set 2.971x speedup, test set 1.847x speedup, val set 2.891x speedup, step: 9
Epoch 34/200 |loss: -0.901509| train set 3.046x speedup, test set 1.821x speedup, val set 2.969x speedup, step: 10
Epoch 35/200 |loss: -0.899732| train set 2.727x speedup, test set 1.994x speedup, val set 2.595x speedup, step: 11
Epoch 36/200 |loss: -0.903215| train set 2.759x speedup, test set 1.994x speedup, val set 2.659x speedup, step: 12
Epoch 37/200 |loss: -0.902501| train set 2.759x speedup, test set 2.070x speedup, val set 2.659x speedup, step: 13
Epoch 38/200 |loss: -0.893362| train set 2.825x speedup, test set 1.831x speedup, val set 2.724x speedup, step: 14
Epoch 39/200 |loss: -0.903578| train set 2.825x speedup, test set 1.778x speedup, val set 2.724x speedup, step: 15
Epoch 40/200 |loss: -0.900265| train set 2.825x speedup, test set 1.777x speedup, val set 2.724x speedup, step: 16
Epoch 41/200 |loss: -0.902348| train set 2.825x speedup, test set 1.788x speedup, val set 2.724x speedup, step: 17
Epoch 42/200 |loss: -0.903586| train set 2.825x speedup, test set 1.915x speedup, val set 2.724x speedup, step: 18
Epoch 43/200 |loss: -0.904709| train set 2.764x speedup, test set 1.915x speedup, val set 2.663x speedup, step: 19
Epoch 44/200 |loss: -0.904925| train set 2.759x speedup, test set 2.037x speedup, val set 2.659x speedup, step: 20
Epoch 45/200 |loss: -0.904756| train set 2.759x speedup, test set 1.916x speedup, val set 2.659x speedup, step: 21
Epoch 46/200 |loss: -0.905838| train set 2.759x speedup, test set 1.917x speedup, val set 2.659x speedup, step: 22
Epoch 47/200 |loss: -0.906239| train set 2.820x speedup, test set 1.874x speedup, val set 2.719x speedup, step: 23
Epoch 48/200 |loss: -0.907265| train set 2.820x speedup, test set 1.875x speedup, val set 2.719x speedup, step: 24
Epoch 49/200 |loss: -0.908930| train set 2.820x speedup, test set 1.794x speedup, val set 2.719x speedup, step: 25
Epoch 50/200 |loss: -0.910094| train set 2.825x speedup, test set 1.837x speedup, val set 2.724x speedup, step: 26
Epoch 51/200 |loss: -0.911184| train set 3.007x speedup, test set 1.826x speedup, val set 2.886x speedup, step: 27
Epoch 52/200 |loss: -0.914087| train set 2.969x speedup, test set 0.851x speedup, val set 2.865x speedup, step: 28
Epoch 53/200 |loss: -0.918272| train set 2.967x speedup, test set 0.857x speedup, val set 2.864x speedup, step: 29
Epoch 54/200 |loss: -0.922709| train set 3.025x speedup, test set 0.879x speedup, val set 2.933x speedup, step: 30
Epoch 55/200 |loss: -0.923704| train set 2.851x speedup, test set 0.882x speedup, val set 2.778x speedup, step: 31
Epoch 56/200 |loss: -0.925158| train set 2.856x speedup, test set 0.882x speedup, val set 2.784x speedup, step: 32
Epoch 57/200 |loss: -0.927366| train set 3.029x speedup, test set 0.866x speedup, val set 2.937x speedup, step: 33
Epoch 58/200 |loss: -0.928727| train set 3.029x speedup, test set 0.866x speedup, val set 2.937x speedup, step: 34
Epoch 59/200 |loss: -0.930036| train set 3.029x speedup, test set 0.868x speedup, val set 2.937x speedup, step: 35
Epoch 60/200 |loss: -0.931289| train set 2.967x speedup, test set 0.868x speedup, val set 2.864x speedup, step: 36
Epoch 61/200 |loss: -0.932571| train set 2.967x speedup, test set 0.868x speedup, val set 2.864x speedup, step: 37
Epoch 62/200 |loss: -0.933957| train set 2.967x speedup, test set 0.868x speedup, val set 2.864x speedup, step: 38
Epoch 63/200 |loss: -0.934896| train set 2.967x speedup, test set 0.868x speedup, val set 2.864x speedup, step: 39
Epoch 64/200 |loss: -0.934332| train set 2.950x speedup, test set 0.907x speedup, val set 2.870x speedup, step: 40
Epoch 65/200 |loss: -0.928060| train set 2.967x speedup, test set 0.887x speedup, val set 2.864x speedup, step: 41
Epoch 66/200 |loss: -0.935876| train set 2.967x speedup, test set 0.887x speedup, val set 2.864x speedup, step: 42
Epoch 67/200 |loss: -0.931251| train set 2.967x speedup, test set 0.887x speedup, val set 2.864x speedup, step: 43
Epoch 68/200 |loss: -0.934813| train set 2.967x speedup, test set 0.900x speedup, val set 2.864x speedup, step: 44
Epoch 69/200 |loss: -0.935193| train set 2.967x speedup, test set 0.919x speedup, val set 2.864x speedup, step: 45
Epoch 70/200 |loss: -0.933925| train set 2.967x speedup, test set 0.919x speedup, val set 2.864x speedup, step: 46
Epoch 71/200 |loss: -0.935751| train set 2.967x speedup, test set 0.920x speedup, val set 2.864x speedup, step: 47
Epoch 72/200 |loss: -0.939529| train set 2.968x speedup, test set 0.884x speedup, val set 2.864x speedup, step: 48
Epoch 73/200 |loss: -0.938517| train set 1.969x speedup, test set 0.884x speedup, val set 1.898x speedup, step: 49
Epoch 74/200 |loss: -0.939143| train set 2.968x speedup, test set 0.910x speedup, val set 2.864x speedup, step: 50
Epoch 75/200 |loss: -0.940933| train set 2.968x speedup, test set 0.922x speedup, val set 2.864x speedup, step: 51
Epoch 76/200 |loss: -0.942279| train set 2.968x speedup, test set 0.922x speedup, val set 2.864x speedup, step: 52
Epoch 77/200 |loss: -0.943721| train set 1.969x speedup, test set 0.922x speedup, val set 1.898x speedup, step: 53
Epoch 78/200 |loss: -0.944468| train set 1.969x speedup, test set 0.922x speedup, val set 1.898x speedup, step: 54
Epoch 79/200 |loss: -0.945398| train set 1.969x speedup, test set 0.922x speedup, val set 1.898x speedup, step: 55
Epoch 80/200 |loss: -0.946564| train set 1.969x speedup, test set 0.922x speedup, val set 1.898x speedup, step: 56
Epoch 81/200 |loss: -0.947072| train set 1.969x speedup, test set 0.908x speedup, val set 1.898x speedup, step: 57
Epoch 82/200 |loss: -0.947547| train set 1.969x speedup, test set 0.880x speedup, val set 1.898x speedup, step: 58
Epoch 83/200 |loss: -0.948146| train set 1.969x speedup, test set 0.880x speedup, val set 1.898x speedup, step: 59
Epoch 84/200 |loss: -0.948814| train set 1.969x speedup, test set 0.908x speedup, val set 1.898x speedup, step: 60
Epoch 85/200 |loss: -0.949336| train set 1.969x speedup, test set 0.908x speedup, val set 1.898x speedup, step: 61
Epoch 86/200 |loss: -0.949385| train set 1.969x speedup, test set 0.929x speedup, val set 1.898x speedup, step: 62
Epoch 87/200 |loss: -0.950358| train set 2.968x speedup, test set 0.925x speedup, val set 2.864x speedup, step: 63
Epoch 88/200 |loss: -0.950599| train set 1.968x speedup, test set 0.925x speedup, val set 1.897x speedup, step: 64
Epoch 89/200 |loss: -0.950837| train set 2.968x speedup, test set 0.925x speedup, val set 2.864x speedup, step: 65
Epoch 90/200 |loss: -0.951792| train set 2.968x speedup, test set 0.925x speedup, val set 2.864x speedup, step: 66
Epoch 91/200 |loss: -0.951477| train set 2.968x speedup, test set 0.823x speedup, val set 2.864x speedup, step: 67
Epoch 92/200 |loss: -0.952436| train set 1.969x speedup, test set 0.828x speedup, val set 1.898x speedup, step: 68
Epoch 93/200 |loss: -0.951978| train set 2.968x speedup, test set 0.942x speedup, val set 2.864x speedup, step: 69
Epoch 94/200 |loss: -0.951835| train set 2.968x speedup, test set 0.971x speedup, val set 2.864x speedup, step: 70
Epoch 95/200 |loss: -0.952392| train set 2.968x speedup, test set 0.865x speedup, val set 2.864x speedup, step: 71
Epoch 96/200 |loss: -0.953390| train set 2.968x speedup, test set 0.865x speedup, val set 2.864x speedup, step: 72
Epoch 97/200 |loss: -0.952950| train set 2.965x speedup, test set 0.802x speedup, val set 2.862x speedup, step: 73
Epoch 98/200 |loss: -0.954180| train set 2.965x speedup, test set 0.802x speedup, val set 2.862x speedup, step: 74
Epoch 99/200 |loss: -0.954090| train set 2.965x speedup, test set 0.802x speedup, val set 2.862x speedup, step: 75
Epoch 100/200 |loss: -0.954469| train set 2.965x speedup, test set 0.802x speedup, val set 2.862x speedup, step: 76
Epoch 101/200 |loss: -0.955001| train set 2.965x speedup, test set 0.802x speedup, val set 2.862x speedup, step: 77
Epoch 102/200 |loss: -0.955307| train set 3.041x speedup, test set 0.802x speedup, val set 3.082x speedup, step: 78
Epoch 103/200 |loss: -0.955299| train set 3.275x speedup, test set 0.816x speedup, val set 3.348x speedup, step: 1
Epoch 104/200 |loss: -0.955643| train set 3.339x speedup, test set 0.816x speedup, val set 3.348x speedup, step: 1
Epoch 105/200 |loss: -0.954230| train set 3.345x speedup, test set 0.802x speedup, val set 3.442x speedup, step: 1
Epoch 106/200 |loss: -0.956117| train set 3.345x speedup, test set 0.802x speedup, val set 3.442x speedup, step: 1
Epoch 107/200 |loss: -0.954974| train set 3.407x speedup, test set 0.816x speedup, val set 3.348x speedup, step: 2
Epoch 108/200 |loss: -0.956221| train set 3.509x speedup, test set 0.816x speedup, val set 3.447x speedup, step: 1
Epoch 109/200 |loss: -0.953959| train set 3.345x speedup, test set 0.778x speedup, val set 3.442x speedup, step: 2
Epoch 110/200 |loss: -0.952546| train set 3.349x speedup, test set 0.816x speedup, val set 3.445x speedup, step: 3
early stopping at epoch 110
Training per epoch cost 0.613 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.407s, pg runtime 0.313s, speedup 0.769x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.733s, pg runtime 0.354s, speedup 0.482x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 1.338s, pg runtime 0.086s, speedup 0.064x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 11.979s, pg runtime 0.389s, speedup 0.032x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 108, train speedup 3.509, test speedup 0.816, val speedup 3.447
best test speedup epoch: 37, train speedup 2.759, test speedup 2.070, val speedup 2.659
best validation speedup epoch: 108, train speedup 3.509, test speedup 0.816, val speedup 3.447
last model at epoch 110, train speedup 3.349, test speedup 0.816, val speedup 3.445
execution cost 0:04:02.695905
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.139674, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727960| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859616| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862551| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864920| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868445| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872690| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876951| train set 3.017x speedup, test set 1.803x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882330| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886577| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.890070| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891448| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892879| train set 3.173x speedup, test set 1.890x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894040| train set 3.338x speedup, test set 1.714x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895449| train set 3.331x speedup, test set 1.714x speedup, val set 3.228x speedup, step: 2
Epoch 27/200 |loss: -0.896519| train set 3.109x speedup, test set 1.722x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897731| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 4
Epoch 29/200 |loss: -0.898472| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899152| train set 2.970x speedup, test set 1.860x speedup, val set 2.891x speedup, step: 6
Epoch 31/200 |loss: -0.899806| train set 2.970x speedup, test set 1.907x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.900506| train set 2.970x speedup, test set 1.907x speedup, val set 2.891x speedup, step: 8
Epoch 33/200 |loss: -0.901228| train set 2.970x speedup, test set 1.994x speedup, val set 2.891x speedup, step: 9
Epoch 34/200 |loss: -0.901723| train set 2.971x speedup, test set 1.972x speedup, val set 2.891x speedup, step: 10
Epoch 35/200 |loss: -0.902211| train set 3.041x speedup, test set 1.777x speedup, val set 2.963x speedup, step: 11
Epoch 36/200 |loss: -0.902685| train set 3.138x speedup, test set 1.787x speedup, val set 3.046x speedup, step: 12
Epoch 37/200 |loss: -0.903397| train set 2.820x speedup, test set 1.832x speedup, val set 2.719x speedup, step: 13
Epoch 38/200 |loss: -0.904077| train set 2.820x speedup, test set 1.832x speedup, val set 2.720x speedup, step: 14
Epoch 39/200 |loss: -0.904321| train set 2.825x speedup, test set 1.867x speedup, val set 2.724x speedup, step: 15
Epoch 40/200 |loss: -0.904823| train set 2.825x speedup, test set 1.731x speedup, val set 2.724x speedup, step: 16
Epoch 41/200 |loss: -0.905407| train set 3.144x speedup, test set 1.787x speedup, val set 3.052x speedup, step: 17
Epoch 42/200 |loss: -0.905811| train set 3.144x speedup, test set 1.787x speedup, val set 3.052x speedup, step: 18
Epoch 43/200 |loss: -0.906118| train set 3.144x speedup, test set 1.787x speedup, val set 3.052x speedup, step: 19
Epoch 44/200 |loss: -0.906599| train set 3.144x speedup, test set 1.867x speedup, val set 3.053x speedup, step: 20
Epoch 45/200 |loss: -0.907009| train set 3.138x speedup, test set 1.871x speedup, val set 3.047x speedup, step: 21
Epoch 46/200 |loss: -0.907397| train set 3.138x speedup, test set 1.871x speedup, val set 3.047x speedup, step: 22
Epoch 47/200 |loss: -0.908044| train set 3.138x speedup, test set 1.789x speedup, val set 3.046x speedup, step: 23
Epoch 48/200 |loss: -0.908614| train set 3.144x speedup, test set 1.745x speedup, val set 3.052x speedup, step: 24
Epoch 49/200 |loss: -0.909819| train set 3.144x speedup, test set 1.751x speedup, val set 3.052x speedup, step: 25
Epoch 50/200 |loss: -0.910706| train set 3.070x speedup, test set 1.791x speedup, val set 2.961x speedup, step: 26
Epoch 51/200 |loss: -0.911675| train set 2.881x speedup, test set 1.791x speedup, val set 2.791x speedup, step: 27
Epoch 52/200 |loss: -0.911988| train set 2.881x speedup, test set 1.834x speedup, val set 2.791x speedup, step: 28
Epoch 53/200 |loss: -0.913204| train set 3.208x speedup, test set 1.834x speedup, val set 3.132x speedup, step: 29
Epoch 54/200 |loss: -0.913811| train set 3.207x speedup, test set 1.963x speedup, val set 3.130x speedup, step: 30
Epoch 55/200 |loss: -0.914439| train set 3.207x speedup, test set 1.965x speedup, val set 3.130x speedup, step: 31
Epoch 56/200 |loss: -0.915318| train set 3.410x speedup, test set 1.964x speedup, val set 3.307x speedup, step: 1
Epoch 57/200 |loss: -0.915609| train set 3.417x speedup, test set 1.965x speedup, val set 3.315x speedup, step: 1
Epoch 58/200 |loss: -0.916614| train set 3.417x speedup, test set 1.965x speedup, val set 3.315x speedup, step: 1
Epoch 59/200 |loss: -0.917567| train set 3.417x speedup, test set 0.926x speedup, val set 3.315x speedup, step: 1
Epoch 60/200 |loss: -0.917968| train set 3.417x speedup, test set 0.939x speedup, val set 3.315x speedup, step: 1
Epoch 61/200 |loss: -0.918850| train set 3.417x speedup, test set 0.878x speedup, val set 3.315x speedup, step: 1
Epoch 62/200 |loss: -0.919526| train set 3.417x speedup, test set 0.937x speedup, val set 3.315x speedup, step: 1
Epoch 63/200 |loss: -0.920955| train set 3.044x speedup, test set 0.885x speedup, val set 2.931x speedup, step: 2
Epoch 64/200 |loss: -0.928181| train set 3.031x speedup, test set 0.877x speedup, val set 2.939x speedup, step: 3
Epoch 65/200 |loss: -0.931791| train set 3.031x speedup, test set 0.876x speedup, val set 2.939x speedup, step: 4
Epoch 66/200 |loss: -0.933669| train set 3.031x speedup, test set 0.897x speedup, val set 2.939x speedup, step: 5
Epoch 67/200 |loss: -0.934659| train set 3.031x speedup, test set 0.886x speedup, val set 2.939x speedup, step: 6
Epoch 68/200 |loss: -0.931885| train set 3.270x speedup, test set 0.937x speedup, val set 3.324x speedup, step: 1
Epoch 69/200 |loss: -0.925365| train set 2.988x speedup, test set 0.864x speedup, val set 2.894x speedup, step: 2
Epoch 70/200 |loss: -0.925047| train set 3.031x speedup, test set 0.924x speedup, val set 2.939x speedup, step: 3
Epoch 71/200 |loss: -0.928840| train set 3.031x speedup, test set 0.919x speedup, val set 2.939x speedup, step: 4
Epoch 72/200 |loss: -0.932691| train set 3.029x speedup, test set 0.886x speedup, val set 2.937x speedup, step: 5
Epoch 73/200 |loss: -0.924762| train set 3.031x speedup, test set 0.872x speedup, val set 2.939x speedup, step: 6
Epoch 74/200 |loss: -0.930404| train set 3.182x speedup, test set 0.914x speedup, val set 3.246x speedup, step: 7
early stopping at epoch 74
Training per epoch cost 0.560 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 1.678s, pg runtime 0.802s, speedup 0.478x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 2.324s, pg runtime 10.605s, speedup 4.563x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 2.191s, pg runtime 2.352s, speedup 1.074x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 3.063s, pg runtime 0.153s, speedup 0.050x
15, opt runtime 0.313s, model runtime 2.434s, pg runtime 0.313s, speedup 0.129x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.366s, pg runtime 0.354s, speedup 0.966x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 1.338s, pg runtime 0.086s, speedup 0.064x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.136s, pg runtime 0.137s, speedup 1.002x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 57, train speedup 3.417, test speedup 1.965, val speedup 3.315
best test speedup epoch: 33, train speedup 2.970, test speedup 1.994, val speedup 2.891
best validation speedup epoch: 68, train speedup 3.270, test speedup 0.937, val speedup 3.324
last model at epoch 74, train speedup 3.182, test speedup 0.914, val speedup 3.246
execution cost 0:02:35.353566
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
2.863916819152067
-0.04371564976204638
construct training samples cost 0:00:01.437807, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: -0.719824| train set 1.299x speedup, test set 0.923x speedup, val set 1.241x speedup, step: 1
Epoch 1/200 |loss: -0.727959| train set 1.113x speedup, test set 0.900x speedup, val set 1.080x speedup, step: 2
Epoch 2/200 |loss: -0.746617| train set 1.474x speedup, test set 0.914x speedup, val set 1.451x speedup, step: 1
Epoch 3/200 |loss: -0.773927| train set 0.983x speedup, test set 0.661x speedup, val set 0.970x speedup, step: 2
Epoch 4/200 |loss: -0.797433| train set 1.449x speedup, test set 0.480x speedup, val set 1.218x speedup, step: 3
Epoch 5/200 |loss: -0.813452| train set 1.115x speedup, test set 0.634x speedup, val set 1.094x speedup, step: 4
Epoch 6/200 |loss: -0.824799| train set 1.027x speedup, test set 0.531x speedup, val set 1.012x speedup, step: 5
Epoch 7/200 |loss: -0.832601| train set 1.657x speedup, test set 0.628x speedup, val set 1.558x speedup, step: 1
Epoch 8/200 |loss: -0.837567| train set 1.724x speedup, test set 0.677x speedup, val set 1.625x speedup, step: 1
Epoch 9/200 |loss: -0.842008| train set 2.987x speedup, test set 0.773x speedup, val set 2.866x speedup, step: 1
Epoch 10/200 |loss: -0.846360| train set 2.987x speedup, test set 1.429x speedup, val set 2.866x speedup, step: 1
Epoch 11/200 |loss: -0.850230| train set 3.003x speedup, test set 1.661x speedup, val set 2.868x speedup, step: 1
Epoch 12/200 |loss: -0.853679| train set 3.003x speedup, test set 1.690x speedup, val set 2.868x speedup, step: 1
Epoch 13/200 |loss: -0.856893| train set 3.109x speedup, test set 1.749x speedup, val set 2.984x speedup, step: 1
Epoch 14/200 |loss: -0.859618| train set 2.930x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 2
Epoch 15/200 |loss: -0.862560| train set 2.911x speedup, test set 1.804x speedup, val set 2.827x speedup, step: 3
Epoch 16/200 |loss: -0.864884| train set 2.930x speedup, test set 1.821x speedup, val set 2.827x speedup, step: 4
Epoch 17/200 |loss: -0.868434| train set 2.930x speedup, test set 1.803x speedup, val set 2.827x speedup, step: 5
Epoch 18/200 |loss: -0.872710| train set 2.948x speedup, test set 1.803x speedup, val set 2.846x speedup, step: 6
Epoch 19/200 |loss: -0.876673| train set 3.017x speedup, test set 1.775x speedup, val set 2.916x speedup, step: 7
Epoch 20/200 |loss: -0.882222| train set 3.018x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 8
Epoch 21/200 |loss: -0.886272| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 9
Epoch 22/200 |loss: -0.889998| train set 3.017x speedup, test set 1.762x speedup, val set 2.916x speedup, step: 10
Epoch 23/200 |loss: -0.891175| train set 3.018x speedup, test set 1.868x speedup, val set 2.916x speedup, step: 11
Epoch 24/200 |loss: -0.892785| train set 3.173x speedup, test set 1.713x speedup, val set 3.078x speedup, step: 1
Epoch 25/200 |loss: -0.894031| train set 3.338x speedup, test set 1.713x speedup, val set 3.235x speedup, step: 1
Epoch 26/200 |loss: -0.895463| train set 3.109x speedup, test set 1.714x speedup, val set 3.027x speedup, step: 2
Epoch 27/200 |loss: -0.896398| train set 3.109x speedup, test set 1.714x speedup, val set 3.027x speedup, step: 3
Epoch 28/200 |loss: -0.897494| train set 3.055x speedup, test set 1.732x speedup, val set 2.995x speedup, step: 4
Epoch 29/200 |loss: -0.898451| train set 3.041x speedup, test set 1.732x speedup, val set 2.963x speedup, step: 5
Epoch 30/200 |loss: -0.899091| train set 2.970x speedup, test set 1.797x speedup, val set 2.891x speedup, step: 6
Epoch 31/200 |loss: -0.899778| train set 2.984x speedup, test set 1.904x speedup, val set 2.891x speedup, step: 7
Epoch 32/200 |loss: -0.899763| train set 2.970x speedup, test set 1.799x speedup, val set 2.891x speedup, step: 8
Epoch 33/200 |loss: -0.900680| train set 2.833x speedup, test set 1.786x speedup, val set 2.653x speedup, step: 9
Epoch 34/200 |loss: -0.900947| train set 2.742x speedup, test set 1.797x speedup, val set 2.653x speedup, step: 10
Epoch 35/200 |loss: -0.901927| train set 2.742x speedup, test set 2.070x speedup, val set 2.653x speedup, step: 11
Epoch 36/200 |loss: -0.902678| train set 2.759x speedup, test set 2.075x speedup, val set 2.659x speedup, step: 12
Epoch 37/200 |loss: -0.903135| train set 2.791x speedup, test set 2.075x speedup, val set 2.659x speedup, step: 13
Epoch 38/200 |loss: -0.903452| train set 2.820x speedup, test set 1.861x speedup, val set 2.720x speedup, step: 14
Epoch 39/200 |loss: -0.904260| train set 2.825x speedup, test set 1.761x speedup, val set 2.724x speedup, step: 15
Epoch 40/200 |loss: -0.904622| train set 2.825x speedup, test set 1.820x speedup, val set 2.724x speedup, step: 16
Epoch 41/200 |loss: -0.904828| train set 2.825x speedup, test set 1.777x speedup, val set 2.724x speedup, step: 17
Epoch 42/200 |loss: -0.905263| train set 2.825x speedup, test set 1.777x speedup, val set 2.725x speedup, step: 18
Epoch 43/200 |loss: -0.905722| train set 2.825x speedup, test set 1.777x speedup, val set 2.725x speedup, step: 19
Epoch 44/200 |loss: -0.906103| train set 2.825x speedup, test set 1.787x speedup, val set 2.725x speedup, step: 20
Epoch 45/200 |loss: -0.906453| train set 2.820x speedup, test set 1.787x speedup, val set 2.720x speedup, step: 21
Epoch 46/200 |loss: -0.906933| train set 3.138x speedup, test set 1.830x speedup, val set 3.047x speedup, step: 22
Epoch 47/200 |loss: -0.907515| train set 3.138x speedup, test set 1.831x speedup, val set 3.047x speedup, step: 23
Epoch 48/200 |loss: -0.908090| train set 3.138x speedup, test set 1.786x speedup, val set 3.046x speedup, step: 24
Epoch 49/200 |loss: -0.908821| train set 3.138x speedup, test set 1.788x speedup, val set 3.046x speedup, step: 25
Epoch 50/200 |loss: -0.909632| train set 3.138x speedup, test set 1.836x speedup, val set 3.046x speedup, step: 26
Epoch 51/200 |loss: -0.910610| train set 2.820x speedup, test set 1.826x speedup, val set 2.719x speedup, step: 27
Epoch 52/200 |loss: -0.911537| train set 2.820x speedup, test set 1.826x speedup, val set 2.719x speedup, step: 28
Epoch 53/200 |loss: -0.912297| train set 3.164x speedup, test set 1.837x speedup, val set 3.104x speedup, step: 29
Epoch 54/200 |loss: -0.913402| train set 2.856x speedup, test set 1.838x speedup, val set 2.784x speedup, step: 30
Epoch 55/200 |loss: -0.916922| train set 2.852x speedup, test set 0.889x speedup, val set 2.778x speedup, step: 31
Epoch 56/200 |loss: -0.921479| train set 2.851x speedup, test set 0.911x speedup, val set 2.778x speedup, step: 32
Epoch 57/200 |loss: -0.924642| train set 2.851x speedup, test set 0.922x speedup, val set 2.778x speedup, step: 33
Epoch 58/200 |loss: -0.926248| train set 2.851x speedup, test set 0.900x speedup, val set 2.778x speedup, step: 34
Epoch 59/200 |loss: -0.928099| train set 3.068x speedup, test set 0.887x speedup, val set 3.127x speedup, step: 35
Epoch 60/200 |loss: -0.929668| train set 3.183x speedup, test set 0.868x speedup, val set 3.127x speedup, step: 36
Epoch 61/200 |loss: -0.930740| train set 3.401x speedup, test set 0.868x speedup, val set 3.324x speedup, step: 1
Epoch 62/200 |loss: -0.931370| train set 3.324x speedup, test set 0.904x speedup, val set 3.230x speedup, step: 2
Epoch 63/200 |loss: -0.929171| train set 3.324x speedup, test set 0.901x speedup, val set 3.230x speedup, step: 3
Epoch 64/200 |loss: -0.929871| train set 2.969x speedup, test set 0.890x speedup, val set 2.865x speedup, step: 4
Epoch 65/200 |loss: -0.930830| train set 2.967x speedup, test set 0.872x speedup, val set 2.864x speedup, step: 5
Epoch 66/200 |loss: -0.932969| train set 2.967x speedup, test set 0.915x speedup, val set 2.864x speedup, step: 6
Epoch 67/200 |loss: -0.936524| train set 2.967x speedup, test set 0.915x speedup, val set 2.864x speedup, step: 7
Epoch 68/200 |loss: -0.937682| train set 1.969x speedup, test set 0.915x speedup, val set 1.898x speedup, step: 8
Epoch 69/200 |loss: -0.938501| train set 2.967x speedup, test set 0.926x speedup, val set 2.864x speedup, step: 9
Epoch 70/200 |loss: -0.939815| train set 2.967x speedup, test set 0.926x speedup, val set 2.864x speedup, step: 10
Epoch 71/200 |loss: -0.941188| train set 2.967x speedup, test set 0.928x speedup, val set 2.864x speedup, step: 11
Epoch 72/200 |loss: -0.941462| train set 2.967x speedup, test set 0.936x speedup, val set 2.864x speedup, step: 12
Epoch 73/200 |loss: -0.942105| train set 2.900x speedup, test set 0.949x speedup, val set 2.796x speedup, step: 13
Epoch 74/200 |loss: -0.943132| train set 2.900x speedup, test set 0.956x speedup, val set 2.796x speedup, step: 14
Epoch 75/200 |loss: -0.943754| train set 2.900x speedup, test set 0.974x speedup, val set 2.796x speedup, step: 15
Epoch 76/200 |loss: -0.943949| train set 2.903x speedup, test set 0.974x speedup, val set 2.799x speedup, step: 16
Epoch 77/200 |loss: -0.944592| train set 2.903x speedup, test set 0.974x speedup, val set 2.799x speedup, step: 17
Epoch 78/200 |loss: -0.945072| train set 2.902x speedup, test set 0.974x speedup, val set 2.798x speedup, step: 18
Epoch 79/200 |loss: -0.945732| train set 2.902x speedup, test set 0.974x speedup, val set 2.798x speedup, step: 19
Epoch 80/200 |loss: -0.945878| train set 1.940x speedup, test set 0.967x speedup, val set 1.869x speedup, step: 20
Epoch 81/200 |loss: -0.946248| train set 1.940x speedup, test set 0.967x speedup, val set 1.869x speedup, step: 21
Epoch 82/200 |loss: -0.946937| train set 1.940x speedup, test set 0.900x speedup, val set 1.869x speedup, step: 22
Epoch 83/200 |loss: -0.947326| train set 1.940x speedup, test set 0.900x speedup, val set 1.869x speedup, step: 23
Epoch 84/200 |loss: -0.947828| train set 1.940x speedup, test set 0.967x speedup, val set 1.869x speedup, step: 24
Epoch 85/200 |loss: -0.948210| train set 1.940x speedup, test set 0.967x speedup, val set 1.869x speedup, step: 25
Epoch 86/200 |loss: -0.948546| train set 1.940x speedup, test set 0.939x speedup, val set 1.869x speedup, step: 26
Epoch 87/200 |loss: -0.948870| train set 1.940x speedup, test set 0.839x speedup, val set 1.869x speedup, step: 27
Epoch 88/200 |loss: -0.949017| train set 2.900x speedup, test set 0.808x speedup, val set 2.248x speedup, step: 28
Epoch 89/200 |loss: -0.949434| train set 2.900x speedup, test set 0.823x speedup, val set 2.796x speedup, step: 29
Epoch 90/200 |loss: -0.949564| train set 2.903x speedup, test set 0.823x speedup, val set 2.798x speedup, step: 30
Epoch 91/200 |loss: -0.949941| train set 2.903x speedup, test set 0.823x speedup, val set 2.798x speedup, step: 31
Epoch 92/200 |loss: -0.950097| train set 2.903x speedup, test set 0.823x speedup, val set 2.798x speedup, step: 32
Epoch 93/200 |loss: -0.950434| train set 2.903x speedup, test set 0.823x speedup, val set 2.798x speedup, step: 33
Epoch 94/200 |loss: -0.950545| train set 2.903x speedup, test set 0.823x speedup, val set 2.798x speedup, step: 34
Epoch 95/200 |loss: -0.950774| train set 2.962x speedup, test set 0.823x speedup, val set 2.868x speedup, step: 35
Epoch 96/200 |loss: -0.950917| train set 2.962x speedup, test set 0.823x speedup, val set 2.868x speedup, step: 36
Epoch 97/200 |loss: -0.951061| train set 2.962x speedup, test set 0.817x speedup, val set 2.868x speedup, step: 37
Epoch 98/200 |loss: -0.951217| train set 2.962x speedup, test set 0.817x speedup, val set 2.868x speedup, step: 38
Epoch 99/200 |loss: -0.951359| train set 2.962x speedup, test set 0.831x speedup, val set 2.868x speedup, step: 39
Epoch 100/200 |loss: -0.951535| train set 2.962x speedup, test set 0.831x speedup, val set 2.868x speedup, step: 40
Epoch 101/200 |loss: -0.951635| train set 2.962x speedup, test set 0.830x speedup, val set 2.868x speedup, step: 41
Epoch 102/200 |loss: -0.951772| train set 2.962x speedup, test set 0.840x speedup, val set 2.868x speedup, step: 42
Epoch 103/200 |loss: -0.951888| train set 2.962x speedup, test set 0.846x speedup, val set 2.868x speedup, step: 43
Epoch 104/200 |loss: -0.952062| train set 3.117x speedup, test set 0.846x speedup, val set 3.222x speedup, step: 44
Epoch 105/200 |loss: -0.952147| train set 3.359x speedup, test set 0.846x speedup, val set 3.510x speedup, step: 1
Epoch 106/200 |loss: -0.952258| train set 3.359x speedup, test set 0.846x speedup, val set 3.510x speedup, step: 1
Epoch 107/200 |loss: -0.952356| train set 3.360x speedup, test set 0.846x speedup, val set 3.510x speedup, step: 1
Epoch 108/200 |loss: -0.952469| train set 3.360x speedup, test set 0.846x speedup, val set 3.510x speedup, step: 1
Epoch 109/200 |loss: -0.952528| train set 3.672x speedup, test set 0.844x speedup, val set 3.810x speedup, step: 1
Epoch 110/200 |loss: -0.952594| train set 3.754x speedup, test set 0.813x speedup, val set 3.810x speedup, step: 1
Epoch 111/200 |loss: -0.952691| train set 3.594x speedup, test set 0.813x speedup, val set 3.810x speedup, step: 1
Epoch 112/200 |loss: -0.952760| train set 3.594x speedup, test set 0.813x speedup, val set 3.810x speedup, step: 1
Epoch 113/200 |loss: -0.952885| train set 3.365x speedup, test set 0.813x speedup, val set 3.442x speedup, step: 2
Epoch 114/200 |loss: -0.952949| train set 3.532x speedup, test set 0.813x speedup, val set 3.442x speedup, step: 3
Epoch 115/200 |loss: -0.953030| train set 3.976x speedup, test set 0.813x speedup, val set 3.876x speedup, step: 1
Epoch 116/200 |loss: -0.953115| train set 3.977x speedup, test set 0.813x speedup, val set 3.877x speedup, step: 1
Epoch 117/200 |loss: -0.953178| train set 3.977x speedup, test set 0.813x speedup, val set 3.877x speedup, step: 1
Epoch 118/200 |loss: -0.953252| train set 3.976x speedup, test set 0.812x speedup, val set 3.876x speedup, step: 2
Epoch 119/200 |loss: -0.953329| train set 3.976x speedup, test set 0.812x speedup, val set 3.876x speedup, step: 3
Epoch 120/200 |loss: -0.953384| train set 3.978x speedup, test set 0.813x speedup, val set 3.879x speedup, step: 1
Epoch 121/200 |loss: -0.953451| train set 3.978x speedup, test set 0.810x speedup, val set 3.879x speedup, step: 1
Epoch 122/200 |loss: -0.953517| train set 3.978x speedup, test set 0.813x speedup, val set 3.879x speedup, step: 1
Epoch 123/200 |loss: -0.953586| train set 3.978x speedup, test set 0.813x speedup, val set 3.879x speedup, step: 1
Epoch 124/200 |loss: -0.953637| train set 3.978x speedup, test set 0.831x speedup, val set 3.879x speedup, step: 1
Epoch 125/200 |loss: -0.953694| train set 4.106x speedup, test set 0.827x speedup, val set 4.010x speedup, step: 1
Epoch 126/200 |loss: -0.953742| train set 4.106x speedup, test set 0.827x speedup, val set 4.010x speedup, step: 1
Epoch 127/200 |loss: -0.953790| train set 4.106x speedup, test set 0.827x speedup, val set 4.010x speedup, step: 1
Epoch 128/200 |loss: -0.953835| train set 4.106x speedup, test set 0.827x speedup, val set 4.010x speedup, step: 1
Epoch 129/200 |loss: -0.953884| train set 4.106x speedup, test set 0.827x speedup, val set 4.010x speedup, step: 1
Epoch 130/200 |loss: -0.953932| train set 3.825x speedup, test set 0.827x speedup, val set 3.681x speedup, step: 2
Epoch 131/200 |loss: -0.953977| train set 3.825x speedup, test set 0.827x speedup, val set 3.681x speedup, step: 3
Epoch 132/200 |loss: -0.954020| train set 3.825x speedup, test set 0.827x speedup, val set 3.681x speedup, step: 4
Epoch 133/200 |loss: -0.954065| train set 3.825x speedup, test set 0.826x speedup, val set 3.681x speedup, step: 5
Epoch 134/200 |loss: -0.954104| train set 3.825x speedup, test set 0.826x speedup, val set 3.681x speedup, step: 6
Epoch 135/200 |loss: -0.954146| train set 3.825x speedup, test set 0.826x speedup, val set 3.681x speedup, step: 7
Epoch 136/200 |loss: -0.954187| train set 3.825x speedup, test set 0.826x speedup, val set 3.681x speedup, step: 8
Epoch 137/200 |loss: -0.954232| train set 3.874x speedup, test set 0.826x speedup, val set 3.705x speedup, step: 9
Epoch 138/200 |loss: -0.954275| train set 3.874x speedup, test set 0.826x speedup, val set 3.725x speedup, step: 10
Epoch 139/200 |loss: -0.954317| train set 3.874x speedup, test set 0.826x speedup, val set 3.725x speedup, step: 11
Epoch 140/200 |loss: -0.954357| train set 3.874x speedup, test set 0.826x speedup, val set 3.725x speedup, step: 12
Epoch 141/200 |loss: -0.954393| train set 3.874x speedup, test set 0.750x speedup, val set 3.725x speedup, step: 13
Epoch 142/200 |loss: -0.954432| train set 3.874x speedup, test set 0.826x speedup, val set 3.725x speedup, step: 14
Epoch 143/200 |loss: -0.954476| train set 3.874x speedup, test set 0.827x speedup, val set 3.725x speedup, step: 15
Epoch 144/200 |loss: -0.954522| train set 3.874x speedup, test set 0.827x speedup, val set 3.725x speedup, step: 16
Epoch 145/200 |loss: -0.954569| train set 3.874x speedup, test set 0.827x speedup, val set 3.725x speedup, step: 17
Epoch 146/200 |loss: -0.954613| train set 3.874x speedup, test set 0.806x speedup, val set 3.725x speedup, step: 18
Epoch 147/200 |loss: -0.954654| train set 3.874x speedup, test set 0.806x speedup, val set 3.725x speedup, step: 19
Epoch 148/200 |loss: -0.954692| train set 3.874x speedup, test set 0.806x speedup, val set 3.725x speedup, step: 20
Epoch 149/200 |loss: -0.954726| train set 3.874x speedup, test set 0.806x speedup, val set 3.725x speedup, step: 21
Epoch 150/200 |loss: -0.954763| train set 3.874x speedup, test set 0.806x speedup, val set 3.725x speedup, step: 22
Epoch 151/200 |loss: -0.954809| train set 3.874x speedup, test set 0.790x speedup, val set 3.725x speedup, step: 23
Epoch 152/200 |loss: -0.954852| train set 3.874x speedup, test set 0.790x speedup, val set 3.725x speedup, step: 24
Epoch 153/200 |loss: -0.954890| train set 3.874x speedup, test set 0.790x speedup, val set 3.725x speedup, step: 25
Epoch 154/200 |loss: -0.954922| train set 3.874x speedup, test set 0.782x speedup, val set 3.705x speedup, step: 26
Epoch 155/200 |loss: -0.954949| train set 3.874x speedup, test set 0.710x speedup, val set 3.705x speedup, step: 27
Epoch 156/200 |loss: -0.954975| train set 3.874x speedup, test set 0.811x speedup, val set 3.725x speedup, step: 28
Epoch 157/200 |loss: -0.954997| train set 3.874x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 29
Epoch 158/200 |loss: -0.955025| train set 3.874x speedup, test set 0.810x speedup, val set 3.725x speedup, step: 30
Epoch 159/200 |loss: -0.955051| train set 3.874x speedup, test set 0.810x speedup, val set 3.725x speedup, step: 31
Epoch 160/200 |loss: -0.955076| train set 3.874x speedup, test set 0.811x speedup, val set 3.725x speedup, step: 32
Epoch 161/200 |loss: -0.955099| train set 3.874x speedup, test set 0.734x speedup, val set 3.725x speedup, step: 33
Epoch 162/200 |loss: -0.955125| train set 3.874x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 34
Epoch 163/200 |loss: -0.955147| train set 3.874x speedup, test set 0.810x speedup, val set 3.725x speedup, step: 35
Epoch 164/200 |loss: -0.955173| train set 3.874x speedup, test set 0.810x speedup, val set 3.725x speedup, step: 36
Epoch 165/200 |loss: -0.955195| train set 3.874x speedup, test set 0.810x speedup, val set 3.725x speedup, step: 37
Epoch 166/200 |loss: -0.955217| train set 3.874x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 38
Epoch 167/200 |loss: -0.955236| train set 3.874x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 39
Epoch 168/200 |loss: -0.955258| train set 3.874x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 40
Epoch 169/200 |loss: -0.955279| train set 3.874x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 41
Epoch 170/200 |loss: -0.955302| train set 3.874x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 42
Epoch 171/200 |loss: -0.955323| train set 3.874x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 43
Epoch 172/200 |loss: -0.955346| train set 3.874x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 44
Epoch 173/200 |loss: -0.955370| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 45
Epoch 174/200 |loss: -0.955391| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 46
Epoch 175/200 |loss: -0.955430| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 47
Epoch 176/200 |loss: -0.955475| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 48
Epoch 177/200 |loss: -0.955513| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 49
Epoch 178/200 |loss: -0.955546| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 50
Epoch 179/200 |loss: -0.955570| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 51
Epoch 180/200 |loss: -0.955594| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 52
Epoch 181/200 |loss: -0.955620| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 53
Epoch 182/200 |loss: -0.955648| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 54
Epoch 183/200 |loss: -0.955681| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 55
Epoch 184/200 |loss: -0.955706| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 56
Epoch 185/200 |loss: -0.955725| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 57
Epoch 186/200 |loss: -0.955754| train set 3.982x speedup, test set 0.733x speedup, val set 3.725x speedup, step: 58
Epoch 187/200 |loss: -0.955762| train set 3.982x speedup, test set 0.750x speedup, val set 3.725x speedup, step: 59
Epoch 188/200 |loss: -0.955823| train set 3.982x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 60
Epoch 189/200 |loss: -0.955925| train set 3.982x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 61
Epoch 190/200 |loss: -0.956004| train set 3.982x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 62
Epoch 191/200 |loss: -0.956095| train set 3.982x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 63
Epoch 192/200 |loss: -0.956464| train set 3.982x speedup, test set 0.831x speedup, val set 3.725x speedup, step: 64
Epoch 193/200 |loss: -0.956144| train set 3.982x speedup, test set 0.844x speedup, val set 3.725x speedup, step: 65
Epoch 194/200 |loss: -0.954640| train set 3.930x speedup, test set 0.831x speedup, val set 3.681x speedup, step: 66
Epoch 195/200 |loss: -0.952718| train set 3.982x speedup, test set 0.834x speedup, val set 3.725x speedup, step: 67
early stopping at epoch 195
Training per epoch cost 0.617 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.184s, pg runtime 0.189s, speedup 1.030x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 7.745s, pg runtime 3.549s, speedup 0.458x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.407s, pg runtime 0.313s, speedup 0.769x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.611s, pg runtime 0.354s, speedup 0.579x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.088s, pg runtime 3.540s, speedup 1.146x
20, opt runtime 0.061s, model runtime 0.061s, pg runtime 0.086s, speedup 1.407x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 1.143s, pg runtime 0.891s, speedup 0.780x
23, opt runtime 0.389s, model runtime 12.445s, pg runtime 0.389s, speedup 0.031x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.152s, pg runtime 0.137s, speedup 0.899x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 125, train speedup 4.106, test speedup 0.827, val speedup 4.010
best test speedup epoch: 36, train speedup 2.759, test speedup 2.075, val speedup 2.659
best validation speedup epoch: 129, train speedup 4.106, test speedup 0.827, val speedup 4.010
last model at epoch 195, train speedup 3.982, test speedup 0.834, val speedup 3.725
execution cost 0:07:05.604206
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.885569, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700630| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238358| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770412| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246288| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733976| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232393| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741789| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239250| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794754| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324339| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872940| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.360317| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.858036| train set 4.121x speedup, test set 2.657x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349743| train set 4.053x speedup, test set 2.968x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.855877| train set 4.053x speedup, test set 2.392x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.396090| train set 4.053x speedup, test set 2.402x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.940338| train set 4.402x speedup, test set 2.431x speedup, val set 4.269x speedup, step: 18
Epoch 18/200 |loss: 15.482615| train set 4.456x speedup, test set 2.509x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.089896| train set 4.566x speedup, test set 2.410x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.716637| train set 4.699x speedup, test set 2.439x speedup, val set 4.648x speedup, step: 21
Epoch 21/200 |loss: 14.277197| train set 4.872x speedup, test set 2.279x speedup, val set 4.846x speedup, step: 22
Epoch 22/200 |loss: 13.833508| train set 5.108x speedup, test set 2.349x speedup, val set 5.104x speedup, step: 23
Epoch 23/200 |loss: 13.414396| train set 5.098x speedup, test set 2.273x speedup, val set 5.092x speedup, step: 24
Epoch 24/200 |loss: 13.013701| train set 5.283x speedup, test set 0.998x speedup, val set 5.309x speedup, step: 25
Epoch 25/200 |loss: 12.671690| train set 5.273x speedup, test set 0.980x speedup, val set 5.297x speedup, step: 26
Epoch 26/200 |loss: 12.598833| train set 5.201x speedup, test set 0.998x speedup, val set 5.230x speedup, step: 27
Epoch 27/200 |loss: 13.034842| train set 5.273x speedup, test set 0.981x speedup, val set 5.297x speedup, step: 28
Epoch 28/200 |loss: 12.378707| train set 5.080x speedup, test set 0.983x speedup, val set 5.081x speedup, step: 29
Epoch 29/200 |loss: 12.425401| train set 5.208x speedup, test set 0.998x speedup, val set 5.237x speedup, step: 30
Epoch 30/200 |loss: 11.824086| train set 5.208x speedup, test set 0.996x speedup, val set 5.237x speedup, step: 31
Epoch 31/200 |loss: 11.836281| train set 5.273x speedup, test set 1.045x speedup, val set 5.284x speedup, step: 32
Epoch 32/200 |loss: 11.475298| train set 5.274x speedup, test set 0.985x speedup, val set 5.297x speedup, step: 33
Epoch 33/200 |loss: 11.450417| train set 5.283x speedup, test set 0.996x speedup, val set 5.308x speedup, step: 34
Epoch 34/200 |loss: 10.957988| train set 5.273x speedup, test set 0.956x speedup, val set 5.284x speedup, step: 35
Epoch 35/200 |loss: 10.922934| train set 5.295x speedup, test set 0.957x speedup, val set 5.310x speedup, step: 36
Epoch 36/200 |loss: 10.644248| train set 5.305x speedup, test set 0.985x speedup, val set 5.326x speedup, step: 37
Epoch 37/200 |loss: 10.250629| train set 5.306x speedup, test set 0.969x speedup, val set 5.336x speedup, step: 38
Epoch 38/200 |loss: 10.355201| train set 5.306x speedup, test set 0.985x speedup, val set 5.336x speedup, step: 39
Epoch 39/200 |loss: 9.905227| train set 5.308x speedup, test set 0.948x speedup, val set 5.332x speedup, step: 40
Epoch 40/200 |loss: 9.954836| train set 5.306x speedup, test set 0.971x speedup, val set 5.336x speedup, step: 41
Epoch 41/200 |loss: 9.534304| train set 5.306x speedup, test set 0.984x speedup, val set 5.336x speedup, step: 42
Epoch 42/200 |loss: 9.603187| train set 5.306x speedup, test set 0.984x speedup, val set 5.336x speedup, step: 43
Epoch 43/200 |loss: 9.386413| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 44
Epoch 44/200 |loss: 9.177171| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 45
Epoch 45/200 |loss: 9.095663| train set 5.308x speedup, test set 0.984x speedup, val set 5.332x speedup, step: 46
Epoch 46/200 |loss: 9.066628| train set 5.306x speedup, test set 0.971x speedup, val set 5.336x speedup, step: 47
Epoch 47/200 |loss: 9.327371| train set 5.255x speedup, test set 0.960x speedup, val set 5.269x speedup, step: 48
Epoch 48/200 |loss: 9.505821| train set 5.306x speedup, test set 0.984x speedup, val set 5.336x speedup, step: 49
Epoch 49/200 |loss: 9.267595| train set 5.305x speedup, test set 0.960x speedup, val set 5.326x speedup, step: 50
Epoch 50/200 |loss: 8.982872| train set 5.308x speedup, test set 0.986x speedup, val set 5.332x speedup, step: 51
Epoch 51/200 |loss: 8.903672| train set 5.297x speedup, test set 0.987x speedup, val set 5.320x speedup, step: 52
Epoch 52/200 |loss: 9.002021| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 53
Epoch 53/200 |loss: 8.698470| train set 5.255x speedup, test set 0.983x speedup, val set 5.269x speedup, step: 54
Epoch 54/200 |loss: 8.831117| train set 5.297x speedup, test set 0.983x speedup, val set 5.320x speedup, step: 55
Epoch 55/200 |loss: 8.812923| train set 5.297x speedup, test set 0.948x speedup, val set 5.320x speedup, step: 56
Epoch 56/200 |loss: 8.440865| train set 5.252x speedup, test set 0.983x speedup, val set 5.273x speedup, step: 57
Epoch 57/200 |loss: 8.808960| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 58
Epoch 58/200 |loss: 8.329453| train set 5.308x speedup, test set 0.862x speedup, val set 5.330x speedup, step: 59
Epoch 59/200 |loss: 8.428974| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 60
Epoch 60/200 |loss: 8.237891| train set 5.305x speedup, test set 0.981x speedup, val set 5.334x speedup, step: 61
Epoch 61/200 |loss: 8.158575| train set 5.297x speedup, test set 0.959x speedup, val set 5.317x speedup, step: 62
Epoch 62/200 |loss: 8.129498| train set 5.308x speedup, test set 0.986x speedup, val set 5.330x speedup, step: 63
Epoch 63/200 |loss: 8.036707| train set 5.307x speedup, test set 0.986x speedup, val set 5.326x speedup, step: 64
Epoch 64/200 |loss: 8.084875| train set 5.306x speedup, test set 0.984x speedup, val set 5.336x speedup, step: 65
Epoch 65/200 |loss: 7.927716| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 66
Epoch 66/200 |loss: 7.980765| train set 5.305x speedup, test set 0.960x speedup, val set 5.334x speedup, step: 67
Epoch 67/200 |loss: 7.974670| train set 5.308x speedup, test set 0.959x speedup, val set 5.330x speedup, step: 68
Epoch 68/200 |loss: 7.923398| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 69
Epoch 69/200 |loss: 8.014250| train set 5.254x speedup, test set 0.948x speedup, val set 5.267x speedup, step: 70
Epoch 70/200 |loss: 8.241197| train set 5.305x speedup, test set 0.962x speedup, val set 5.334x speedup, step: 71
Epoch 71/200 |loss: 7.996616| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 72
Epoch 72/200 |loss: 7.870072| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 73
Epoch 73/200 |loss: 7.754739| train set 5.305x speedup, test set 0.960x speedup, val set 5.334x speedup, step: 74
Epoch 74/200 |loss: 7.903608| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 75
Epoch 75/200 |loss: 7.716926| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 76
Epoch 76/200 |loss: 7.789003| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 77
Epoch 77/200 |loss: 7.708752| train set 5.254x speedup, test set 0.929x speedup, val set 5.267x speedup, step: 78
Epoch 78/200 |loss: 7.694888| train set 5.297x speedup, test set 0.948x speedup, val set 5.317x speedup, step: 79
Epoch 79/200 |loss: 7.646792| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 80
Epoch 80/200 |loss: 7.620263| train set 5.308x speedup, test set 0.919x speedup, val set 5.330x speedup, step: 81
Epoch 81/200 |loss: 7.769467| train set 5.305x speedup, test set 0.960x speedup, val set 5.334x speedup, step: 82
Epoch 82/200 |loss: 7.652292| train set 5.297x speedup, test set 0.948x speedup, val set 5.317x speedup, step: 83
Epoch 83/200 |loss: 7.627437| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 84
Epoch 84/200 |loss: 7.469302| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 85
Epoch 85/200 |loss: 7.423934| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 86
Epoch 86/200 |loss: 7.429049| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 87
Epoch 87/200 |loss: 7.498411| train set 5.305x speedup, test set 0.945x speedup, val set 5.334x speedup, step: 88
Epoch 88/200 |loss: 7.590733| train set 5.254x speedup, test set 0.929x speedup, val set 5.267x speedup, step: 89
Epoch 89/200 |loss: 7.596401| train set 5.297x speedup, test set 0.918x speedup, val set 5.317x speedup, step: 90
Epoch 90/200 |loss: 7.697994| train set 5.254x speedup, test set 0.929x speedup, val set 5.267x speedup, step: 91
Epoch 91/200 |loss: 7.440582| train set 5.305x speedup, test set 0.957x speedup, val set 5.334x speedup, step: 92
Epoch 92/200 |loss: 7.494738| train set 5.297x speedup, test set 0.918x speedup, val set 5.317x speedup, step: 93
Epoch 93/200 |loss: 7.749265| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 94
Epoch 94/200 |loss: 7.732097| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 95
Epoch 95/200 |loss: 7.648415| train set 5.297x speedup, test set 0.918x speedup, val set 5.317x speedup, step: 96
Epoch 96/200 |loss: 7.887830| train set 5.254x speedup, test set 0.930x speedup, val set 5.267x speedup, step: 97
Epoch 97/200 |loss: 8.054625| train set 5.305x speedup, test set 0.918x speedup, val set 5.334x speedup, step: 98
Epoch 98/200 |loss: 7.989294| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 99
Epoch 99/200 |loss: 7.591321| train set 5.252x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 100
Epoch 100/200 |loss: 8.024804| train set 5.297x speedup, test set 0.917x speedup, val set 5.317x speedup, step: 1
Epoch 101/200 |loss: 8.257919| train set 5.297x speedup, test set 0.918x speedup, val set 5.317x speedup, step: 1
Epoch 102/200 |loss: 7.768095| train set 5.252x speedup, test set 0.930x speedup, val set 5.270x speedup, step: 2
Epoch 103/200 |loss: 8.188623| train set 5.305x speedup, test set 0.957x speedup, val set 5.334x speedup, step: 1
Epoch 104/200 |loss: 7.817029| train set 5.308x speedup, test set 0.917x speedup, val set 5.330x speedup, step: 2
Epoch 105/200 |loss: 8.072507| train set 5.254x speedup, test set 0.918x speedup, val set 5.267x speedup, step: 3
Epoch 106/200 |loss: 7.500821| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 4
Epoch 107/200 |loss: 7.844635| train set 5.297x speedup, test set 0.930x speedup, val set 5.317x speedup, step: 5
Epoch 108/200 |loss: 7.614487| train set 5.295x speedup, test set 0.918x speedup, val set 5.321x speedup, step: 6
Epoch 109/200 |loss: 7.599189| train set 5.305x speedup, test set 0.930x speedup, val set 5.334x speedup, step: 1
Epoch 110/200 |loss: 7.558393| train set 5.309x speedup, test set 0.930x speedup, val set 5.337x speedup, step: 1
Epoch 111/200 |loss: 7.520454| train set 5.307x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 2
Epoch 112/200 |loss: 7.486778| train set 5.295x speedup, test set 0.930x speedup, val set 5.321x speedup, step: 3
Epoch 113/200 |loss: 7.389162| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 4
Epoch 114/200 |loss: 7.449105| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 5
Epoch 115/200 |loss: 7.305311| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 6
Epoch 116/200 |loss: 7.355864| train set 5.254x speedup, test set 0.930x speedup, val set 5.267x speedup, step: 7
Epoch 117/200 |loss: 7.334437| train set 5.305x speedup, test set 0.930x speedup, val set 5.323x speedup, step: 8
Epoch 118/200 |loss: 7.267053| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 9
Epoch 119/200 |loss: 7.259225| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 10
Epoch 120/200 |loss: 7.225725| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 11
Epoch 121/200 |loss: 7.216271| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 12
Epoch 122/200 |loss: 7.187000| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 13
Epoch 123/200 |loss: 7.205973| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 14
Epoch 124/200 |loss: 7.192059| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 15
Epoch 125/200 |loss: 7.190091| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 16
Epoch 126/200 |loss: 7.174003| train set 5.307x speedup, test set 0.931x speedup, val set 5.331x speedup, step: 17
Epoch 127/200 |loss: 7.237093| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 18
Epoch 128/200 |loss: 7.301621| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 19
Epoch 129/200 |loss: 7.260946| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 20
Epoch 130/200 |loss: 7.234458| train set 5.254x speedup, test set 0.930x speedup, val set 5.267x speedup, step: 21
Epoch 131/200 |loss: 7.210430| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 22
Epoch 132/200 |loss: 7.224612| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 23
Epoch 133/200 |loss: 7.160193| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 24
Epoch 134/200 |loss: 7.101482| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 25
Epoch 135/200 |loss: 7.158572| train set 5.310x speedup, test set 0.930x speedup, val set 5.331x speedup, step: 26
Epoch 136/200 |loss: 7.173587| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 27
Epoch 137/200 |loss: 7.257148| train set 5.309x speedup, test set 0.932x speedup, val set 5.340x speedup, step: 1
Epoch 138/200 |loss: 7.118731| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 2
Epoch 139/200 |loss: 7.091219| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 3
Epoch 140/200 |loss: 7.132453| train set 5.310x speedup, test set 0.932x speedup, val set 5.331x speedup, step: 4
Epoch 141/200 |loss: 7.229772| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 5
Epoch 142/200 |loss: 7.379331| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 6
Epoch 143/200 |loss: 7.129900| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 7
Epoch 144/200 |loss: 7.062756| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 8
Epoch 145/200 |loss: 7.223850| train set 5.308x speedup, test set 0.962x speedup, val set 5.334x speedup, step: 9
Epoch 146/200 |loss: 7.276443| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 10
Epoch 147/200 |loss: 7.214377| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 11
Epoch 148/200 |loss: 7.031631| train set 5.305x speedup, test set 0.960x speedup, val set 5.331x speedup, step: 12
Epoch 149/200 |loss: 7.186092| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 13
Epoch 150/200 |loss: 7.475703| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 14
Epoch 151/200 |loss: 7.144803| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 15
Epoch 152/200 |loss: 7.230464| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 16
Epoch 153/200 |loss: 7.504770| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 17
Epoch 154/200 |loss: 7.133755| train set 5.310x speedup, test set 0.932x speedup, val set 5.331x speedup, step: 18
Epoch 155/200 |loss: 7.336059| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 19
Epoch 156/200 |loss: 7.510654| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 20
Epoch 157/200 |loss: 7.225276| train set 5.257x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 21
Epoch 158/200 |loss: 7.426687| train set 5.308x speedup, test set 0.917x speedup, val set 5.330x speedup, step: 22
Epoch 159/200 |loss: 7.354754| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 23
Epoch 160/200 |loss: 7.224489| train set 5.252x speedup, test set 0.930x speedup, val set 5.270x speedup, step: 24
Epoch 161/200 |loss: 7.342589| train set 5.305x speedup, test set 0.928x speedup, val set 5.334x speedup, step: 25
Epoch 162/200 |loss: 7.247357| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 26
Epoch 163/200 |loss: 7.213779| train set 5.310x speedup, test set 0.930x speedup, val set 5.331x speedup, step: 27
Epoch 164/200 |loss: 7.253891| train set 5.305x speedup, test set 0.930x speedup, val set 5.334x speedup, step: 28
Epoch 165/200 |loss: 7.116780| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 29
Epoch 166/200 |loss: 7.260942| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 30
Epoch 167/200 |loss: 7.085513| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 31
Epoch 168/200 |loss: 7.160260| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 32
Epoch 169/200 |loss: 7.072163| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 33
Epoch 170/200 |loss: 7.167861| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 34
Epoch 171/200 |loss: 7.030896| train set 5.305x speedup, test set 0.925x speedup, val set 5.334x speedup, step: 35
Epoch 172/200 |loss: 7.094915| train set 5.307x speedup, test set 0.925x speedup, val set 5.331x speedup, step: 36
Epoch 173/200 |loss: 7.042397| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 37
Epoch 174/200 |loss: 7.081505| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 38
Epoch 175/200 |loss: 7.008656| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 39
Epoch 176/200 |loss: 7.019833| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 40
Epoch 177/200 |loss: 7.002321| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 41
Epoch 178/200 |loss: 7.010977| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 42
Epoch 179/200 |loss: 7.013681| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 43
Epoch 180/200 |loss: 6.989510| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 44
Epoch 181/200 |loss: 6.983225| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 45
Epoch 182/200 |loss: 6.963380| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 46
Epoch 183/200 |loss: 7.000819| train set 5.310x speedup, test set 0.925x speedup, val set 5.331x speedup, step: 47
Epoch 184/200 |loss: 7.062382| train set 5.305x speedup, test set 0.930x speedup, val set 5.334x speedup, step: 48
Epoch 185/200 |loss: 7.470918| train set 5.257x speedup, test set 0.925x speedup, val set 5.267x speedup, step: 49
Epoch 186/200 |loss: 7.270442| train set 5.308x speedup, test set 0.918x speedup, val set 5.330x speedup, step: 50
Epoch 187/200 |loss: 7.396076| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 51
Epoch 188/200 |loss: 7.043067| train set 5.253x speedup, test set 0.957x speedup, val set 5.267x speedup, step: 52
Epoch 189/200 |loss: 7.307590| train set 5.297x speedup, test set 0.918x speedup, val set 5.317x speedup, step: 53
Epoch 190/200 |loss: 7.680583| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 54
Epoch 191/200 |loss: 7.283257| train set 5.257x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 55
Epoch 192/200 |loss: 7.616724| train set 5.294x speedup, test set 0.917x speedup, val set 5.318x speedup, step: 56
Epoch 193/200 |loss: 7.622366| train set 5.305x speedup, test set 0.928x speedup, val set 5.334x speedup, step: 57
Epoch 194/200 |loss: 7.573701| train set 5.258x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 58
Epoch 195/200 |loss: 7.475680| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 59
Epoch 196/200 |loss: 7.474177| train set 5.308x speedup, test set 0.918x speedup, val set 5.330x speedup, step: 60
Epoch 197/200 |loss: 7.328823| train set 5.305x speedup, test set 0.918x speedup, val set 5.334x speedup, step: 61
Epoch 198/200 |loss: 7.331391| train set 5.257x speedup, test set 0.945x speedup, val set 5.267x speedup, step: 62
Epoch 199/200 |loss: 7.288031| train set 5.297x speedup, test set 0.944x speedup, val set 5.317x speedup, step: 63
Training per epoch cost 0.254 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.354s, pg runtime 0.354s, speedup 1.000x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.065s, pg runtime 0.086s, speedup 1.315x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 135, train speedup 5.310, test speedup 0.930, val speedup 5.331
best test speedup epoch: 14, train speedup 4.053, test speedup 2.968, val speedup 3.957
best validation speedup epoch: 137, train speedup 5.309, test speedup 0.932, val speedup 5.340
last model at epoch 199, train speedup 5.297, test speedup 0.944, val speedup 5.317
execution cost 0:02:36.439556
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.949434, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700630| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238359| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770414| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246290| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733978| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232393| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741791| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239250| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794756| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324337| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872940| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.360317| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.858036| train set 4.121x speedup, test set 2.657x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349745| train set 4.053x speedup, test set 2.968x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.855883| train set 4.053x speedup, test set 2.392x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.396091| train set 4.053x speedup, test set 2.402x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.940339| train set 4.402x speedup, test set 2.431x speedup, val set 4.269x speedup, step: 18
Epoch 18/200 |loss: 15.482617| train set 4.456x speedup, test set 2.509x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.089898| train set 4.566x speedup, test set 2.410x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.716637| train set 4.699x speedup, test set 2.439x speedup, val set 4.648x speedup, step: 21
Epoch 21/200 |loss: 14.277198| train set 4.872x speedup, test set 2.279x speedup, val set 4.846x speedup, step: 22
Epoch 22/200 |loss: 13.833508| train set 5.108x speedup, test set 2.349x speedup, val set 5.104x speedup, step: 23
Epoch 23/200 |loss: 13.414399| train set 5.098x speedup, test set 2.273x speedup, val set 5.092x speedup, step: 24
Epoch 24/200 |loss: 13.013785| train set 5.283x speedup, test set 0.998x speedup, val set 5.309x speedup, step: 25
Epoch 25/200 |loss: 12.671467| train set 5.273x speedup, test set 0.980x speedup, val set 5.297x speedup, step: 26
Epoch 26/200 |loss: 12.593527| train set 5.201x speedup, test set 0.998x speedup, val set 5.230x speedup, step: 27
Epoch 27/200 |loss: 13.042270| train set 5.273x speedup, test set 0.981x speedup, val set 5.297x speedup, step: 28
Epoch 28/200 |loss: 12.382017| train set 5.080x speedup, test set 0.983x speedup, val set 5.081x speedup, step: 29
Epoch 29/200 |loss: 12.443408| train set 5.208x speedup, test set 0.998x speedup, val set 5.236x speedup, step: 30
Epoch 30/200 |loss: 11.814868| train set 5.207x speedup, test set 0.995x speedup, val set 5.233x speedup, step: 31
Epoch 31/200 |loss: 11.834740| train set 5.272x speedup, test set 1.045x speedup, val set 5.284x speedup, step: 32
Epoch 32/200 |loss: 11.428668| train set 5.273x speedup, test set 0.985x speedup, val set 5.295x speedup, step: 33
Epoch 33/200 |loss: 11.395492| train set 5.273x speedup, test set 0.996x speedup, val set 5.295x speedup, step: 34
Epoch 34/200 |loss: 10.892251| train set 5.295x speedup, test set 0.849x speedup, val set 5.321x speedup, step: 35
Epoch 35/200 |loss: 10.862416| train set 5.295x speedup, test set 0.957x speedup, val set 5.313x speedup, step: 36
Epoch 36/200 |loss: 10.586220| train set 5.306x speedup, test set 0.985x speedup, val set 5.336x speedup, step: 37
Epoch 37/200 |loss: 10.252068| train set 5.306x speedup, test set 0.984x speedup, val set 5.336x speedup, step: 38
Epoch 38/200 |loss: 10.266424| train set 5.308x speedup, test set 0.973x speedup, val set 5.332x speedup, step: 39
Epoch 39/200 |loss: 9.852065| train set 5.308x speedup, test set 0.973x speedup, val set 5.332x speedup, step: 40
Epoch 40/200 |loss: 9.910110| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 41
Epoch 41/200 |loss: 9.500746| train set 5.306x speedup, test set 0.960x speedup, val set 5.336x speedup, step: 42
Epoch 42/200 |loss: 9.534796| train set 5.306x speedup, test set 0.984x speedup, val set 5.336x speedup, step: 43
Epoch 43/200 |loss: 9.288943| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 44
Epoch 44/200 |loss: 9.156199| train set 5.308x speedup, test set 0.984x speedup, val set 5.332x speedup, step: 45
Epoch 45/200 |loss: 9.071946| train set 5.308x speedup, test set 0.981x speedup, val set 5.332x speedup, step: 46
Epoch 46/200 |loss: 9.182564| train set 5.295x speedup, test set 0.984x speedup, val set 5.323x speedup, step: 47
Epoch 47/200 |loss: 9.746344| train set 5.252x speedup, test set 0.957x speedup, val set 5.263x speedup, step: 48
Epoch 48/200 |loss: 9.993312| train set 5.297x speedup, test set 0.852x speedup, val set 5.320x speedup, step: 49
Epoch 49/200 |loss: 9.276445| train set 5.202x speedup, test set 0.986x speedup, val set 5.231x speedup, step: 50
Epoch 50/200 |loss: 9.410994| train set 5.255x speedup, test set 0.984x speedup, val set 5.269x speedup, step: 51
Epoch 51/200 |loss: 9.807058| train set 5.308x speedup, test set 0.849x speedup, val set 5.332x speedup, step: 52
Epoch 52/200 |loss: 8.866912| train set 5.306x speedup, test set 0.862x speedup, val set 5.336x speedup, step: 53
Epoch 53/200 |loss: 9.316382| train set 5.308x speedup, test set 0.851x speedup, val set 5.332x speedup, step: 54
Epoch 54/200 |loss: 8.651483| train set 5.308x speedup, test set 0.957x speedup, val set 5.332x speedup, step: 55
Epoch 55/200 |loss: 8.883429| train set 5.306x speedup, test set 0.957x speedup, val set 5.336x speedup, step: 56
Epoch 56/200 |loss: 8.546290| train set 5.306x speedup, test set 0.957x speedup, val set 5.336x speedup, step: 57
Epoch 57/200 |loss: 8.672387| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 58
Epoch 58/200 |loss: 8.433644| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 59
Epoch 59/200 |loss: 8.446877| train set 5.308x speedup, test set 0.934x speedup, val set 5.330x speedup, step: 60
Epoch 60/200 |loss: 8.289649| train set 5.308x speedup, test set 0.934x speedup, val set 5.330x speedup, step: 61
Epoch 61/200 |loss: 8.281599| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 62
Epoch 62/200 |loss: 8.144656| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 63
Epoch 63/200 |loss: 8.117222| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 64
Epoch 64/200 |loss: 8.042498| train set 5.307x speedup, test set 0.960x speedup, val set 5.331x speedup, step: 65
Epoch 65/200 |loss: 8.002873| train set 5.305x speedup, test set 0.960x speedup, val set 5.323x speedup, step: 66
Epoch 66/200 |loss: 7.929752| train set 5.308x speedup, test set 0.959x speedup, val set 5.330x speedup, step: 67
Epoch 67/200 |loss: 7.877116| train set 5.308x speedup, test set 0.936x speedup, val set 5.330x speedup, step: 68
Epoch 68/200 |loss: 7.860367| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 69
Epoch 69/200 |loss: 7.811600| train set 5.296x speedup, test set 0.960x speedup, val set 5.318x speedup, step: 70
Epoch 70/200 |loss: 7.808014| train set 5.305x speedup, test set 0.960x speedup, val set 5.334x speedup, step: 71
Epoch 71/200 |loss: 7.858358| train set 5.297x speedup, test set 0.931x speedup, val set 5.317x speedup, step: 72
Epoch 72/200 |loss: 8.266822| train set 5.252x speedup, test set 0.960x speedup, val set 5.270x speedup, step: 73
Epoch 73/200 |loss: 8.572908| train set 5.297x speedup, test set 0.821x speedup, val set 5.317x speedup, step: 74
Epoch 74/200 |loss: 8.765311| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 75
Epoch 75/200 |loss: 8.064161| train set 5.252x speedup, test set 0.851x speedup, val set 5.270x speedup, step: 76
Epoch 76/200 |loss: 8.373501| train set 5.308x speedup, test set 0.852x speedup, val set 5.330x speedup, step: 77
Epoch 77/200 |loss: 8.075124| train set 5.308x speedup, test set 0.852x speedup, val set 5.330x speedup, step: 78
Epoch 78/200 |loss: 8.136077| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 79
Epoch 79/200 |loss: 7.904666| train set 5.305x speedup, test set 0.960x speedup, val set 5.334x speedup, step: 80
Epoch 80/200 |loss: 7.983049| train set 5.295x speedup, test set 0.960x speedup, val set 5.321x speedup, step: 81
Epoch 81/200 |loss: 7.843781| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 82
Epoch 82/200 |loss: 7.918044| train set 5.308x speedup, test set 0.852x speedup, val set 5.330x speedup, step: 83
Epoch 83/200 |loss: 7.772285| train set 5.308x speedup, test set 0.852x speedup, val set 5.330x speedup, step: 84
Epoch 84/200 |loss: 7.733755| train set 5.308x speedup, test set 0.852x speedup, val set 5.330x speedup, step: 85
Epoch 85/200 |loss: 7.710531| train set 5.306x speedup, test set 0.852x speedup, val set 5.331x speedup, step: 86
Epoch 86/200 |loss: 7.725697| train set 5.244x speedup, test set 0.852x speedup, val set 5.254x speedup, step: 87
Epoch 87/200 |loss: 7.704253| train set 5.297x speedup, test set 0.852x speedup, val set 5.317x speedup, step: 88
Epoch 88/200 |loss: 7.646646| train set 5.308x speedup, test set 0.852x speedup, val set 5.330x speedup, step: 89
Epoch 89/200 |loss: 7.539903| train set 5.305x speedup, test set 0.852x speedup, val set 5.323x speedup, step: 90
Epoch 90/200 |loss: 7.519419| train set 5.305x speedup, test set 0.852x speedup, val set 5.334x speedup, step: 91
Epoch 91/200 |loss: 7.501769| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 92
Epoch 92/200 |loss: 7.499488| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 93
Epoch 93/200 |loss: 7.627335| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 94
Epoch 94/200 |loss: 7.441611| train set 5.305x speedup, test set 0.851x speedup, val set 5.334x speedup, step: 95
Epoch 95/200 |loss: 7.397947| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 96
Epoch 96/200 |loss: 7.375659| train set 5.308x speedup, test set 0.959x speedup, val set 5.330x speedup, step: 97
Epoch 97/200 |loss: 7.420433| train set 5.295x speedup, test set 0.959x speedup, val set 5.310x speedup, step: 98
Epoch 98/200 |loss: 7.416795| train set 5.254x speedup, test set 0.960x speedup, val set 5.267x speedup, step: 99
Epoch 99/200 |loss: 7.441730| train set 5.305x speedup, test set 0.959x speedup, val set 5.334x speedup, step: 100
Epoch 100/200 |loss: 7.556325| train set 5.254x speedup, test set 0.959x speedup, val set 5.267x speedup, step: 1
Epoch 101/200 |loss: 7.560773| train set 5.305x speedup, test set 0.959x speedup, val set 5.334x speedup, step: 1
Epoch 102/200 |loss: 7.486664| train set 5.308x speedup, test set 0.852x speedup, val set 5.330x speedup, step: 2
Epoch 103/200 |loss: 7.291743| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 3
Epoch 104/200 |loss: 7.263492| train set 5.308x speedup, test set 0.959x speedup, val set 5.330x speedup, step: 4
Epoch 105/200 |loss: 7.308733| train set 5.254x speedup, test set 0.851x speedup, val set 5.267x speedup, step: 5
Epoch 106/200 |loss: 7.430257| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 1
Epoch 107/200 |loss: 7.500054| train set 5.257x speedup, test set 0.962x speedup, val set 5.267x speedup, step: 2
Epoch 108/200 |loss: 7.455104| train set 5.297x speedup, test set 0.821x speedup, val set 5.317x speedup, step: 3
Epoch 109/200 |loss: 7.835530| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 4
Epoch 110/200 |loss: 7.581404| train set 5.308x speedup, test set 0.852x speedup, val set 5.330x speedup, step: 5
Epoch 111/200 |loss: 7.563918| train set 5.297x speedup, test set 0.851x speedup, val set 5.314x speedup, step: 6
Epoch 112/200 |loss: 7.367355| train set 5.252x speedup, test set 0.959x speedup, val set 5.270x speedup, step: 7
Epoch 113/200 |loss: 7.700964| train set 5.308x speedup, test set 0.829x speedup, val set 5.330x speedup, step: 8
Epoch 114/200 |loss: 7.633750| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 9
Epoch 115/200 |loss: 7.379704| train set 5.310x speedup, test set 0.960x speedup, val set 5.331x speedup, step: 10
Epoch 116/200 |loss: 7.624280| train set 5.297x speedup, test set 0.826x speedup, val set 5.317x speedup, step: 11
Epoch 117/200 |loss: 7.701470| train set 5.305x speedup, test set 0.851x speedup, val set 5.334x speedup, step: 1
Epoch 118/200 |loss: 7.313797| train set 5.254x speedup, test set 0.960x speedup, val set 5.271x speedup, step: 2
Epoch 119/200 |loss: 7.747630| train set 5.308x speedup, test set 0.839x speedup, val set 5.330x speedup, step: 3
Epoch 120/200 |loss: 7.580348| train set 5.308x speedup, test set 0.839x speedup, val set 5.330x speedup, step: 4
Epoch 121/200 |loss: 7.526134| train set 5.252x speedup, test set 0.852x speedup, val set 5.270x speedup, step: 5
Epoch 122/200 |loss: 7.581718| train set 5.305x speedup, test set 0.851x speedup, val set 5.334x speedup, step: 1
Epoch 123/200 |loss: 7.412697| train set 5.308x speedup, test set 0.842x speedup, val set 5.330x speedup, step: 2
Epoch 124/200 |loss: 7.429143| train set 5.254x speedup, test set 0.842x speedup, val set 5.267x speedup, step: 3
Epoch 125/200 |loss: 7.335786| train set 5.308x speedup, test set 0.959x speedup, val set 5.330x speedup, step: 4
Epoch 126/200 |loss: 7.355540| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 5
Epoch 127/200 |loss: 7.320308| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 6
Epoch 128/200 |loss: 7.259182| train set 5.305x speedup, test set 0.962x speedup, val set 5.334x speedup, step: 1
Epoch 129/200 |loss: 7.363275| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 2
Epoch 130/200 |loss: 7.243930| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 3
Epoch 131/200 |loss: 7.230218| train set 5.305x speedup, test set 0.962x speedup, val set 5.334x speedup, step: 1
Epoch 132/200 |loss: 7.276694| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 2
Epoch 133/200 |loss: 7.175150| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 3
Epoch 134/200 |loss: 7.155662| train set 5.305x speedup, test set 0.962x speedup, val set 5.334x speedup, step: 1
Epoch 135/200 |loss: 7.178578| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 2
Epoch 136/200 |loss: 7.143300| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 3
Epoch 137/200 |loss: 7.120806| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 4
Epoch 138/200 |loss: 7.153142| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 5
Epoch 139/200 |loss: 7.139105| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 6
Epoch 140/200 |loss: 7.091574| train set 5.308x speedup, test set 0.962x speedup, val set 5.330x speedup, step: 7
Epoch 141/200 |loss: 7.100698| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 8
Epoch 142/200 |loss: 7.165901| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 9
Epoch 143/200 |loss: 7.076930| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 10
Epoch 144/200 |loss: 7.071101| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 11
Epoch 145/200 |loss: 7.055254| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 12
Epoch 146/200 |loss: 7.102717| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 13
Epoch 147/200 |loss: 7.121463| train set 5.308x speedup, test set 0.960x speedup, val set 5.331x speedup, step: 14
Epoch 148/200 |loss: 7.086086| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 15
Epoch 149/200 |loss: 7.211180| train set 5.257x speedup, test set 0.962x speedup, val set 5.267x speedup, step: 16
Epoch 150/200 |loss: 7.512686| train set 5.297x speedup, test set 0.948x speedup, val set 5.317x speedup, step: 17
Epoch 151/200 |loss: 8.316676| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 18
Epoch 152/200 |loss: 7.251503| train set 5.257x speedup, test set 0.960x speedup, val set 5.267x speedup, step: 19
Epoch 153/200 |loss: 8.229800| train set 5.297x speedup, test set 0.947x speedup, val set 5.317x speedup, step: 20
Epoch 154/200 |loss: 8.366544| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 21
Epoch 155/200 |loss: 7.842470| train set 5.252x speedup, test set 0.960x speedup, val set 5.270x speedup, step: 22
Epoch 156/200 |loss: 8.489848| train set 5.305x speedup, test set 0.959x speedup, val set 5.334x speedup, step: 1
Epoch 157/200 |loss: 7.829639| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 2
Epoch 158/200 |loss: 7.791905| train set 5.308x speedup, test set 0.830x speedup, val set 5.330x speedup, step: 3
Epoch 159/200 |loss: 7.648954| train set 5.252x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 4
Epoch 160/200 |loss: 7.657123| train set 5.295x speedup, test set 0.959x speedup, val set 5.321x speedup, step: 5
Epoch 161/200 |loss: 7.581620| train set 5.297x speedup, test set 0.955x speedup, val set 5.317x speedup, step: 6
Epoch 162/200 |loss: 7.438519| train set 5.309x speedup, test set 0.955x speedup, val set 5.335x speedup, step: 1
Epoch 163/200 |loss: 7.512026| train set 5.309x speedup, test set 0.955x speedup, val set 5.335x speedup, step: 1
Epoch 164/200 |loss: 7.408795| train set 5.306x speedup, test set 0.955x speedup, val set 5.336x speedup, step: 1
Epoch 165/200 |loss: 7.411936| train set 5.305x speedup, test set 0.955x speedup, val set 5.334x speedup, step: 2
Epoch 166/200 |loss: 7.312729| train set 5.308x speedup, test set 0.955x speedup, val set 5.330x speedup, step: 3
Epoch 167/200 |loss: 7.327568| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 4
Epoch 168/200 |loss: 7.249628| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 5
Epoch 169/200 |loss: 7.244716| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 6
Epoch 170/200 |loss: 7.209569| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 7
Epoch 171/200 |loss: 7.160980| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 8
Epoch 172/200 |loss: 7.175035| train set 5.305x speedup, test set 0.958x speedup, val set 5.334x speedup, step: 9
Epoch 173/200 |loss: 7.124776| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 10
Epoch 174/200 |loss: 7.137566| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 11
Epoch 175/200 |loss: 7.090646| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 12
Epoch 176/200 |loss: 7.113820| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 13
Epoch 177/200 |loss: 7.128437| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 14
Epoch 178/200 |loss: 7.340501| train set 5.305x speedup, test set 0.958x speedup, val set 5.334x speedup, step: 15
Epoch 179/200 |loss: 7.416601| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 16
Epoch 180/200 |loss: 7.453860| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 17
Epoch 181/200 |loss: 7.084846| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 18
Epoch 182/200 |loss: 7.218727| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 19
Epoch 183/200 |loss: 7.590956| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 20
Epoch 184/200 |loss: 7.165278| train set 5.307x speedup, test set 0.958x speedup, val set 5.331x speedup, step: 21
Epoch 185/200 |loss: 7.355268| train set 5.254x speedup, test set 0.958x speedup, val set 5.267x speedup, step: 22
Epoch 186/200 |loss: 7.672451| train set 5.305x speedup, test set 0.957x speedup, val set 5.334x speedup, step: 23
Epoch 187/200 |loss: 7.145779| train set 5.305x speedup, test set 0.957x speedup, val set 5.334x speedup, step: 24
Epoch 188/200 |loss: 7.649544| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 25
Epoch 189/200 |loss: 7.412305| train set 5.254x speedup, test set 0.927x speedup, val set 5.267x speedup, step: 26
Epoch 190/200 |loss: 7.354763| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 27
Epoch 191/200 |loss: 7.354132| train set 5.305x speedup, test set 0.958x speedup, val set 5.334x speedup, step: 28
Epoch 192/200 |loss: 7.204700| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 29
Epoch 193/200 |loss: 7.315091| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 30
Epoch 194/200 |loss: 7.134264| train set 5.308x speedup, test set 0.958x speedup, val set 5.330x speedup, step: 31
Epoch 195/200 |loss: 7.277445| train set 5.308x speedup, test set 0.926x speedup, val set 5.330x speedup, step: 32
Epoch 196/200 |loss: 7.119098| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 33
Epoch 197/200 |loss: 7.190489| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 34
Epoch 198/200 |loss: 7.083244| train set 5.295x speedup, test set 0.927x speedup, val set 5.321x speedup, step: 35
Epoch 199/200 |loss: 7.161521| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 36
Training per epoch cost 0.272 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.354s, pg runtime 0.354s, speedup 1.000x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.065s, pg runtime 0.086s, speedup 1.315x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 1.143s, pg runtime 0.891s, speedup 0.780x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 115, train speedup 5.310, test speedup 0.960, val speedup 5.331
best test speedup epoch: 14, train speedup 4.053, test speedup 2.968, val speedup 3.957
best validation speedup epoch: 164, train speedup 5.306, test speedup 0.955, val speedup 5.336
last model at epoch 199, train speedup 5.308, test speedup 0.927, val speedup 5.330
execution cost 0:02:39.906969
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.936262, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700630| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238358| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770412| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246288| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733976| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232389| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741783| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239244| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794752| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324333| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872921| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.359955| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.857149| train set 4.121x speedup, test set 2.655x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349058| train set 4.053x speedup, test set 2.956x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.847612| train set 4.053x speedup, test set 2.400x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.394432| train set 4.053x speedup, test set 2.412x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.949280| train set 4.456x speedup, test set 2.431x speedup, val set 4.318x speedup, step: 18
Epoch 18/200 |loss: 15.498119| train set 4.456x speedup, test set 2.503x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.083813| train set 4.566x speedup, test set 2.462x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.714121| train set 4.699x speedup, test set 2.461x speedup, val set 4.648x speedup, step: 21
Epoch 21/200 |loss: 14.324438| train set 4.807x speedup, test set 2.281x speedup, val set 4.785x speedup, step: 22
Epoch 22/200 |loss: 13.880710| train set 5.090x speedup, test set 2.350x speedup, val set 5.102x speedup, step: 23
Epoch 23/200 |loss: 13.445724| train set 5.090x speedup, test set 2.214x speedup, val set 5.102x speedup, step: 24
Epoch 24/200 |loss: 13.052642| train set 5.037x speedup, test set 0.998x speedup, val set 5.036x speedup, step: 25
Epoch 25/200 |loss: 12.876927| train set 5.080x speedup, test set 0.983x speedup, val set 5.090x speedup, step: 26
Epoch 26/200 |loss: 13.140576| train set 5.208x speedup, test set 0.998x speedup, val set 5.237x speedup, step: 27
Epoch 27/200 |loss: 12.444696| train set 5.284x speedup, test set 0.983x speedup, val set 5.310x speedup, step: 28
Epoch 28/200 |loss: 11.890576| train set 5.283x speedup, test set 0.984x speedup, val set 5.309x speedup, step: 29
Epoch 29/200 |loss: 11.933896| train set 5.283x speedup, test set 0.985x speedup, val set 5.299x speedup, step: 30
Epoch 30/200 |loss: 11.424975| train set 5.283x speedup, test set 0.996x speedup, val set 5.309x speedup, step: 31
Epoch 31/200 |loss: 11.428977| train set 5.295x speedup, test set 0.985x speedup, val set 5.313x speedup, step: 32
Epoch 32/200 |loss: 10.957870| train set 5.306x speedup, test set 0.998x speedup, val set 5.336x speedup, step: 33
Epoch 33/200 |loss: 10.905749| train set 5.295x speedup, test set 0.957x speedup, val set 5.323x speedup, step: 34
Epoch 34/200 |loss: 10.555036| train set 5.306x speedup, test set 0.973x speedup, val set 5.336x speedup, step: 35
Epoch 35/200 |loss: 10.264005| train set 5.305x speedup, test set 0.971x speedup, val set 5.326x speedup, step: 36
Epoch 36/200 |loss: 10.093445| train set 5.308x speedup, test set 0.948x speedup, val set 5.332x speedup, step: 37
Epoch 37/200 |loss: 9.918998| train set 5.306x speedup, test set 0.960x speedup, val set 5.336x speedup, step: 38
Epoch 38/200 |loss: 9.908348| train set 5.305x speedup, test set 0.960x speedup, val set 5.326x speedup, step: 39
Epoch 39/200 |loss: 10.495561| train set 5.306x speedup, test set 0.984x speedup, val set 5.336x speedup, step: 40
Epoch 40/200 |loss: 11.108697| train set 5.305x speedup, test set 0.984x speedup, val set 5.326x speedup, step: 41
Epoch 41/200 |loss: 9.988864| train set 5.131x speedup, test set 0.842x speedup, val set 5.125x speedup, step: 42
Epoch 42/200 |loss: 10.793115| train set 5.308x speedup, test set 0.962x speedup, val set 5.332x speedup, step: 43
Epoch 43/200 |loss: 9.705108| train set 5.306x speedup, test set 0.987x speedup, val set 5.336x speedup, step: 44
Epoch 44/200 |loss: 10.044952| train set 5.306x speedup, test set 0.986x speedup, val set 5.336x speedup, step: 45
Epoch 45/200 |loss: 9.482401| train set 5.306x speedup, test set 0.854x speedup, val set 5.336x speedup, step: 46
Epoch 46/200 |loss: 9.394454| train set 5.308x speedup, test set 0.854x speedup, val set 5.332x speedup, step: 47
Epoch 47/200 |loss: 9.310419| train set 5.308x speedup, test set 0.854x speedup, val set 5.332x speedup, step: 48
Epoch 48/200 |loss: 9.271396| train set 5.306x speedup, test set 0.854x speedup, val set 5.336x speedup, step: 49
Epoch 49/200 |loss: 8.958319| train set 5.306x speedup, test set 0.854x speedup, val set 5.336x speedup, step: 50
Epoch 50/200 |loss: 8.981265| train set 5.308x speedup, test set 0.854x speedup, val set 5.332x speedup, step: 51
Epoch 51/200 |loss: 8.861042| train set 5.308x speedup, test set 0.962x speedup, val set 5.332x speedup, step: 52
Epoch 52/200 |loss: 8.661331| train set 5.308x speedup, test set 0.962x speedup, val set 5.332x speedup, step: 53
Epoch 53/200 |loss: 8.655695| train set 5.308x speedup, test set 0.962x speedup, val set 5.332x speedup, step: 54
Epoch 54/200 |loss: 8.624203| train set 5.308x speedup, test set 0.962x speedup, val set 5.332x speedup, step: 55
Epoch 55/200 |loss: 8.413025| train set 5.305x speedup, test set 0.932x speedup, val set 5.326x speedup, step: 56
Epoch 56/200 |loss: 8.430810| train set 5.305x speedup, test set 0.829x speedup, val set 5.326x speedup, step: 57
Epoch 57/200 |loss: 8.369514| train set 5.308x speedup, test set 0.829x speedup, val set 5.332x speedup, step: 58
Epoch 58/200 |loss: 8.277163| train set 5.306x speedup, test set 0.932x speedup, val set 5.336x speedup, step: 59
Epoch 59/200 |loss: 8.155699| train set 5.308x speedup, test set 0.929x speedup, val set 5.332x speedup, step: 60
Epoch 60/200 |loss: 8.196622| train set 5.255x speedup, test set 0.907x speedup, val set 5.269x speedup, step: 61
Epoch 61/200 |loss: 8.250113| train set 5.297x speedup, test set 0.807x speedup, val set 5.320x speedup, step: 62
Epoch 62/200 |loss: 8.565498| train set 5.255x speedup, test set 0.907x speedup, val set 5.269x speedup, step: 63
Epoch 63/200 |loss: 8.429717| train set 5.306x speedup, test set 0.908x speedup, val set 5.336x speedup, step: 64
Epoch 64/200 |loss: 8.497943| train set 5.308x speedup, test set 0.810x speedup, val set 5.332x speedup, step: 65
Epoch 65/200 |loss: 8.364376| train set 5.255x speedup, test set 0.907x speedup, val set 5.269x speedup, step: 66
Epoch 66/200 |loss: 8.210834| train set 5.297x speedup, test set 0.917x speedup, val set 5.317x speedup, step: 67
Epoch 67/200 |loss: 8.502823| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 68
Epoch 68/200 |loss: 8.481492| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 69
Epoch 69/200 |loss: 8.168715| train set 5.305x speedup, test set 0.917x speedup, val set 5.334x speedup, step: 70
Epoch 70/200 |loss: 8.468640| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 71
Epoch 71/200 |loss: 8.030432| train set 5.254x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 72
Epoch 72/200 |loss: 8.266826| train set 5.308x speedup, test set 0.895x speedup, val set 5.330x speedup, step: 73
Epoch 73/200 |loss: 8.144171| train set 5.308x speedup, test set 0.828x speedup, val set 5.330x speedup, step: 74
Epoch 74/200 |loss: 7.929947| train set 5.254x speedup, test set 0.810x speedup, val set 5.267x speedup, step: 75
Epoch 75/200 |loss: 8.164605| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 76
Epoch 76/200 |loss: 7.714579| train set 5.305x speedup, test set 0.895x speedup, val set 5.334x speedup, step: 77
Epoch 77/200 |loss: 7.929776| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 78
Epoch 78/200 |loss: 7.753649| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 79
Epoch 79/200 |loss: 7.747796| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 80
Epoch 80/200 |loss: 7.698153| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 81
Epoch 81/200 |loss: 7.592794| train set 5.253x speedup, test set 0.906x speedup, val set 5.254x speedup, step: 82
Epoch 82/200 |loss: 7.689001| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 83
Epoch 83/200 |loss: 7.525552| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 84
Epoch 84/200 |loss: 7.553197| train set 5.308x speedup, test set 0.904x speedup, val set 5.330x speedup, step: 85
Epoch 85/200 |loss: 7.505885| train set 5.308x speedup, test set 0.904x speedup, val set 5.330x speedup, step: 86
Epoch 86/200 |loss: 7.453380| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 87
Epoch 87/200 |loss: 7.463494| train set 5.308x speedup, test set 0.904x speedup, val set 5.330x speedup, step: 88
Epoch 88/200 |loss: 7.487821| train set 5.305x speedup, test set 0.895x speedup, val set 5.334x speedup, step: 89
Epoch 89/200 |loss: 7.671154| train set 5.297x speedup, test set 0.894x speedup, val set 5.317x speedup, step: 90
Epoch 90/200 |loss: 8.435031| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 91
Epoch 91/200 |loss: 7.724078| train set 5.254x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 92
Epoch 92/200 |loss: 8.217713| train set 5.297x speedup, test set 0.895x speedup, val set 5.317x speedup, step: 93
Epoch 93/200 |loss: 8.451454| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 94
Epoch 94/200 |loss: 8.018712| train set 5.253x speedup, test set 0.905x speedup, val set 5.273x speedup, step: 95
Epoch 95/200 |loss: 8.193940| train set 5.305x speedup, test set 0.905x speedup, val set 5.334x speedup, step: 96
Epoch 96/200 |loss: 7.865085| train set 5.305x speedup, test set 0.824x speedup, val set 5.334x speedup, step: 97
Epoch 97/200 |loss: 8.012683| train set 5.308x speedup, test set 0.809x speedup, val set 5.330x speedup, step: 98
Epoch 98/200 |loss: 7.747757| train set 5.254x speedup, test set 0.905x speedup, val set 5.267x speedup, step: 99
Epoch 99/200 |loss: 7.690132| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 100
Epoch 100/200 |loss: 7.672251| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 1
Epoch 101/200 |loss: 7.586120| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 1
Epoch 102/200 |loss: 7.546412| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 1
Epoch 103/200 |loss: 7.565861| train set 5.310x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 2
Epoch 104/200 |loss: 7.559652| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 1
Epoch 105/200 |loss: 7.430172| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 2
Epoch 106/200 |loss: 7.492064| train set 5.297x speedup, test set 0.895x speedup, val set 5.317x speedup, step: 3
Epoch 107/200 |loss: 7.542260| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 4
Epoch 108/200 |loss: 7.423057| train set 5.253x speedup, test set 0.811x speedup, val set 5.267x speedup, step: 5
Epoch 109/200 |loss: 7.366111| train set 5.308x speedup, test set 0.895x speedup, val set 5.330x speedup, step: 1
Epoch 110/200 |loss: 7.381366| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 1
Epoch 111/200 |loss: 7.417904| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 1
Epoch 112/200 |loss: 7.430972| train set 5.307x speedup, test set 0.892x speedup, val set 5.330x speedup, step: 1
Epoch 113/200 |loss: 7.317193| train set 5.308x speedup, test set 0.892x speedup, val set 5.330x speedup, step: 1
Epoch 114/200 |loss: 7.340652| train set 5.254x speedup, test set 0.897x speedup, val set 5.267x speedup, step: 2
Epoch 115/200 |loss: 7.425973| train set 5.253x speedup, test set 0.897x speedup, val set 5.267x speedup, step: 3
Epoch 116/200 |loss: 7.369184| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 1
Epoch 117/200 |loss: 7.538528| train set 5.308x speedup, test set 0.892x speedup, val set 5.330x speedup, step: 1
Epoch 118/200 |loss: 7.261249| train set 5.305x speedup, test set 0.892x speedup, val set 5.334x speedup, step: 1
Epoch 119/200 |loss: 7.271279| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 2
Epoch 120/200 |loss: 7.376782| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 3
Epoch 121/200 |loss: 7.269270| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 4
Epoch 122/200 |loss: 7.197594| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 5
Epoch 123/200 |loss: 7.221720| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 6
Epoch 124/200 |loss: 7.201531| train set 5.297x speedup, test set 0.893x speedup, val set 5.317x speedup, step: 7
Epoch 125/200 |loss: 7.220769| train set 5.305x speedup, test set 0.893x speedup, val set 5.334x speedup, step: 1
Epoch 126/200 |loss: 7.294109| train set 5.308x speedup, test set 0.892x speedup, val set 5.330x speedup, step: 2
Epoch 127/200 |loss: 7.277704| train set 5.310x speedup, test set 0.903x speedup, val set 5.331x speedup, step: 3
Epoch 128/200 |loss: 7.274792| train set 5.296x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 4
Epoch 129/200 |loss: 7.422959| train set 5.254x speedup, test set 0.903x speedup, val set 5.267x speedup, step: 5
Epoch 130/200 |loss: 7.190426| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 6
Epoch 131/200 |loss: 7.133674| train set 5.297x speedup, test set 0.893x speedup, val set 5.317x speedup, step: 7
Epoch 132/200 |loss: 7.218166| train set 5.305x speedup, test set 0.903x speedup, val set 5.334x speedup, step: 1
Epoch 133/200 |loss: 7.172110| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 2
Epoch 134/200 |loss: 7.189924| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 3
Epoch 135/200 |loss: 7.190634| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 4
Epoch 136/200 |loss: 7.223456| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 5
Epoch 137/200 |loss: 7.094725| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 6
Epoch 138/200 |loss: 7.106641| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 7
Epoch 139/200 |loss: 7.292465| train set 5.305x speedup, test set 0.903x speedup, val set 5.334x speedup, step: 1
Epoch 140/200 |loss: 7.194512| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 2
Epoch 141/200 |loss: 7.201088| train set 5.257x speedup, test set 0.903x speedup, val set 5.267x speedup, step: 3
Epoch 142/200 |loss: 7.173765| train set 5.308x speedup, test set 0.893x speedup, val set 5.330x speedup, step: 4
Epoch 143/200 |loss: 7.123690| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 5
Epoch 144/200 |loss: 7.086371| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 6
Epoch 145/200 |loss: 7.092934| train set 5.297x speedup, test set 0.892x speedup, val set 5.317x speedup, step: 7
Epoch 146/200 |loss: 7.155074| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 8
Epoch 147/200 |loss: 7.109564| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 9
Epoch 148/200 |loss: 7.103866| train set 5.297x speedup, test set 0.892x speedup, val set 5.317x speedup, step: 10
Epoch 149/200 |loss: 7.282745| train set 5.254x speedup, test set 0.903x speedup, val set 5.271x speedup, step: 11
Epoch 150/200 |loss: 7.487445| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 12
Epoch 151/200 |loss: 8.418902| train set 5.305x speedup, test set 0.903x speedup, val set 5.334x speedup, step: 1
Epoch 152/200 |loss: 7.475209| train set 5.257x speedup, test set 0.807x speedup, val set 5.267x speedup, step: 2
Epoch 153/200 |loss: 8.204195| train set 5.307x speedup, test set 0.801x speedup, val set 5.330x speedup, step: 3
Epoch 154/200 |loss: 8.323433| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 4
Epoch 155/200 |loss: 7.799994| train set 5.307x speedup, test set 0.927x speedup, val set 5.337x speedup, step: 1
Epoch 156/200 |loss: 8.051682| train set 5.306x speedup, test set 0.931x speedup, val set 5.326x speedup, step: 2
Epoch 157/200 |loss: 7.539530| train set 5.308x speedup, test set 0.915x speedup, val set 5.330x speedup, step: 3
Epoch 158/200 |loss: 7.953666| train set 5.305x speedup, test set 0.927x speedup, val set 5.334x speedup, step: 4
Epoch 159/200 |loss: 7.465675| train set 5.252x speedup, test set 0.931x speedup, val set 5.270x speedup, step: 5
Epoch 160/200 |loss: 7.704690| train set 5.241x speedup, test set 0.820x speedup, val set 5.247x speedup, step: 6
Epoch 161/200 |loss: 7.448664| train set 5.295x speedup, test set 0.816x speedup, val set 5.310x speedup, step: 7
Epoch 162/200 |loss: 7.496179| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 8
Epoch 163/200 |loss: 7.425487| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 9
Epoch 164/200 |loss: 7.397299| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 10
Epoch 165/200 |loss: 7.333411| train set 5.297x speedup, test set 0.817x speedup, val set 5.317x speedup, step: 11
Epoch 166/200 |loss: 7.348273| train set 5.308x speedup, test set 0.817x speedup, val set 5.332x speedup, step: 12
Epoch 167/200 |loss: 7.273069| train set 5.305x speedup, test set 0.817x speedup, val set 5.334x speedup, step: 13
Epoch 168/200 |loss: 7.269904| train set 5.305x speedup, test set 0.916x speedup, val set 5.334x speedup, step: 14
Epoch 169/200 |loss: 7.229693| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 15
Epoch 170/200 |loss: 7.202913| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 16
Epoch 171/200 |loss: 7.196137| train set 5.308x speedup, test set 0.915x speedup, val set 5.330x speedup, step: 17
Epoch 172/200 |loss: 7.148729| train set 5.297x speedup, test set 0.915x speedup, val set 5.317x speedup, step: 18
Epoch 173/200 |loss: 7.148410| train set 5.308x speedup, test set 0.910x speedup, val set 5.330x speedup, step: 19
Epoch 174/200 |loss: 7.101262| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 20
Epoch 175/200 |loss: 7.118242| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 21
Epoch 176/200 |loss: 7.071609| train set 5.305x speedup, test set 0.910x speedup, val set 5.331x speedup, step: 22
Epoch 177/200 |loss: 7.082071| train set 5.308x speedup, test set 0.910x speedup, val set 5.330x speedup, step: 23
Epoch 178/200 |loss: 7.045322| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 24
Epoch 179/200 |loss: 7.053560| train set 5.308x speedup, test set 0.915x speedup, val set 5.330x speedup, step: 25
Epoch 180/200 |loss: 7.033918| train set 5.308x speedup, test set 0.915x speedup, val set 5.330x speedup, step: 26
Epoch 181/200 |loss: 7.014184| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 27
Epoch 182/200 |loss: 7.012021| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 28
Epoch 183/200 |loss: 6.998989| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 29
Epoch 184/200 |loss: 6.996958| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 30
Epoch 185/200 |loss: 6.976874| train set 5.308x speedup, test set 0.915x speedup, val set 5.330x speedup, step: 31
Epoch 186/200 |loss: 6.978775| train set 5.308x speedup, test set 0.915x speedup, val set 5.330x speedup, step: 32
Epoch 187/200 |loss: 6.971231| train set 5.308x speedup, test set 0.915x speedup, val set 5.330x speedup, step: 33
Epoch 188/200 |loss: 6.963781| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 34
Epoch 189/200 |loss: 6.964472| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 35
Epoch 190/200 |loss: 6.989319| train set 5.310x speedup, test set 0.905x speedup, val set 5.331x speedup, step: 36
Epoch 191/200 |loss: 7.028680| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 37
Epoch 192/200 |loss: 7.193652| train set 5.308x speedup, test set 0.905x speedup, val set 5.334x speedup, step: 38
Epoch 193/200 |loss: 7.232293| train set 5.308x speedup, test set 0.915x speedup, val set 5.330x speedup, step: 39
Epoch 194/200 |loss: 7.447841| train set 5.308x speedup, test set 0.901x speedup, val set 5.330x speedup, step: 40
Epoch 195/200 |loss: 7.041951| train set 5.254x speedup, test set 0.901x speedup, val set 5.267x speedup, step: 41
Epoch 196/200 |loss: 7.274976| train set 5.308x speedup, test set 0.892x speedup, val set 5.330x speedup, step: 42
Epoch 197/200 |loss: 7.811634| train set 5.305x speedup, test set 0.882x speedup, val set 5.334x speedup, step: 43
Epoch 198/200 |loss: 7.202249| train set 5.310x speedup, test set 0.912x speedup, val set 5.331x speedup, step: 44
Epoch 199/200 |loss: 7.687504| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 45
Training per epoch cost 0.261 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 127, train speedup 5.310, test speedup 0.903, val speedup 5.331
best test speedup epoch: 14, train speedup 4.053, test speedup 2.956, val speedup 3.957
best validation speedup epoch: 155, train speedup 5.307, test speedup 0.927, val speedup 5.337
last model at epoch 199, train speedup 5.308, test speedup 0.916, val speedup 5.330
execution cost 0:02:37.998953
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.898657, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700632| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238359| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770414| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246290| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733978| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232393| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741789| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239250| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794756| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324339| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872940| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.360317| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.858032| train set 4.121x speedup, test set 2.657x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349741| train set 4.053x speedup, test set 2.968x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.855873| train set 4.053x speedup, test set 2.392x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.396019| train set 4.053x speedup, test set 2.402x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.940579| train set 4.402x speedup, test set 2.431x speedup, val set 4.269x speedup, step: 18
Epoch 18/200 |loss: 15.484943| train set 4.456x speedup, test set 2.506x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.088512| train set 4.566x speedup, test set 2.426x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.698204| train set 4.607x speedup, test set 2.439x speedup, val set 4.593x speedup, step: 21
Epoch 21/200 |loss: 14.280614| train set 4.872x speedup, test set 2.280x speedup, val set 4.846x speedup, step: 22
Epoch 22/200 |loss: 13.823215| train set 5.108x speedup, test set 2.349x speedup, val set 5.104x speedup, step: 23
Epoch 23/200 |loss: 13.409136| train set 5.098x speedup, test set 2.272x speedup, val set 5.092x speedup, step: 24
Epoch 24/200 |loss: 13.009650| train set 5.080x speedup, test set 2.281x speedup, val set 5.090x speedup, step: 25
Epoch 25/200 |loss: 12.616990| train set 5.273x speedup, test set 0.998x speedup, val set 5.297x speedup, step: 26
Epoch 26/200 |loss: 12.278640| train set 5.273x speedup, test set 0.981x speedup, val set 5.297x speedup, step: 27
Epoch 27/200 |loss: 12.301724| train set 5.031x speedup, test set 0.997x speedup, val set 5.021x speedup, step: 28
Epoch 28/200 |loss: 13.801346| train set 5.294x speedup, test set 0.980x speedup, val set 5.323x speedup, step: 29
Epoch 29/200 |loss: 12.130316| train set 5.305x speedup, test set 0.997x speedup, val set 5.336x speedup, step: 30
Epoch 30/200 |loss: 12.433787| train set 5.306x speedup, test set 0.985x speedup, val set 5.336x speedup, step: 31
Epoch 31/200 |loss: 11.729328| train set 5.305x speedup, test set 0.985x speedup, val set 5.326x speedup, step: 32
Epoch 32/200 |loss: 11.606272| train set 5.305x speedup, test set 0.981x speedup, val set 5.323x speedup, step: 33
Epoch 33/200 |loss: 11.233294| train set 5.305x speedup, test set 0.984x speedup, val set 5.334x speedup, step: 34
Epoch 34/200 |loss: 11.092370| train set 5.306x speedup, test set 0.961x speedup, val set 5.336x speedup, step: 35
Epoch 35/200 |loss: 10.708998| train set 5.306x speedup, test set 0.971x speedup, val set 5.336x speedup, step: 36
Epoch 36/200 |loss: 10.572269| train set 5.306x speedup, test set 0.995x speedup, val set 5.336x speedup, step: 37
Epoch 37/200 |loss: 10.306092| train set 5.285x speedup, test set 0.973x speedup, val set 5.303x speedup, step: 38
Epoch 38/200 |loss: 10.112922| train set 5.305x speedup, test set 0.960x speedup, val set 5.312x speedup, step: 39
Epoch 39/200 |loss: 9.954532| train set 5.306x speedup, test set 0.960x speedup, val set 5.336x speedup, step: 40
Epoch 40/200 |loss: 9.682536| train set 5.306x speedup, test set 0.961x speedup, val set 5.336x speedup, step: 41
Epoch 41/200 |loss: 9.616609| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 42
Epoch 42/200 |loss: 9.457373| train set 5.308x speedup, test set 0.973x speedup, val set 5.332x speedup, step: 43
Epoch 43/200 |loss: 9.403006| train set 5.255x speedup, test set 0.963x speedup, val set 5.269x speedup, step: 44
Epoch 44/200 |loss: 9.525949| train set 5.121x speedup, test set 0.854x speedup, val set 5.113x speedup, step: 45
Epoch 45/200 |loss: 10.205564| train set 5.232x speedup, test set 0.975x speedup, val set 5.258x speedup, step: 46
Epoch 46/200 |loss: 9.960013| train set 5.308x speedup, test set 0.962x speedup, val set 5.332x speedup, step: 47
Epoch 47/200 |loss: 9.692381| train set 5.297x speedup, test set 0.963x speedup, val set 5.320x speedup, step: 48
Epoch 48/200 |loss: 9.861297| train set 5.308x speedup, test set 0.864x speedup, val set 5.332x speedup, step: 49
Epoch 49/200 |loss: 9.025633| train set 5.308x speedup, test set 0.962x speedup, val set 5.332x speedup, step: 50
Epoch 50/200 |loss: 9.529726| train set 5.306x speedup, test set 0.962x speedup, val set 5.336x speedup, step: 51
Epoch 51/200 |loss: 8.886715| train set 5.305x speedup, test set 0.950x speedup, val set 5.326x speedup, step: 52
Epoch 52/200 |loss: 9.259931| train set 5.308x speedup, test set 0.962x speedup, val set 5.332x speedup, step: 53
Epoch 53/200 |loss: 8.696577| train set 5.308x speedup, test set 0.962x speedup, val set 5.332x speedup, step: 54
Epoch 54/200 |loss: 8.844383| train set 5.295x speedup, test set 0.962x speedup, val set 5.323x speedup, step: 55
Epoch 55/200 |loss: 8.583903| train set 5.252x speedup, test set 0.934x speedup, val set 5.273x speedup, step: 56
Epoch 56/200 |loss: 8.554260| train set 5.306x speedup, test set 0.907x speedup, val set 5.336x speedup, step: 57
Epoch 57/200 |loss: 8.546477| train set 5.308x speedup, test set 0.907x speedup, val set 5.332x speedup, step: 58
Epoch 58/200 |loss: 8.310450| train set 5.308x speedup, test set 0.959x speedup, val set 5.332x speedup, step: 59
Epoch 59/200 |loss: 8.401410| train set 5.308x speedup, test set 0.957x speedup, val set 5.332x speedup, step: 60
Epoch 60/200 |loss: 8.245902| train set 5.308x speedup, test set 0.929x speedup, val set 5.332x speedup, step: 61
Epoch 61/200 |loss: 8.178041| train set 5.305x speedup, test set 0.907x speedup, val set 5.326x speedup, step: 62
Epoch 62/200 |loss: 8.193228| train set 5.306x speedup, test set 0.959x speedup, val set 5.336x speedup, step: 63
Epoch 63/200 |loss: 8.035119| train set 5.306x speedup, test set 0.959x speedup, val set 5.336x speedup, step: 64
Epoch 64/200 |loss: 8.081378| train set 5.308x speedup, test set 0.934x speedup, val set 5.332x speedup, step: 65
Epoch 65/200 |loss: 7.993368| train set 5.297x speedup, test set 0.905x speedup, val set 5.317x speedup, step: 66
Epoch 66/200 |loss: 8.058335| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 67
Epoch 67/200 |loss: 7.983647| train set 5.305x speedup, test set 0.905x speedup, val set 5.334x speedup, step: 68
Epoch 68/200 |loss: 7.957401| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 69
Epoch 69/200 |loss: 7.925853| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 70
Epoch 70/200 |loss: 7.960594| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 71
Epoch 71/200 |loss: 8.171429| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 72
Epoch 72/200 |loss: 7.925596| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 73
Epoch 73/200 |loss: 7.624722| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 74
Epoch 74/200 |loss: 7.824982| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 75
Epoch 75/200 |loss: 8.044896| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 76
Epoch 76/200 |loss: 8.258891| train set 5.121x speedup, test set 0.917x speedup, val set 5.111x speedup, step: 77
Epoch 77/200 |loss: 9.327662| train set 5.220x speedup, test set 0.927x speedup, val set 5.248x speedup, step: 78
Epoch 78/200 |loss: 8.677692| train set 5.252x speedup, test set 0.897x speedup, val set 5.267x speedup, step: 79
Epoch 79/200 |loss: 9.129371| train set 5.308x speedup, test set 0.887x speedup, val set 5.330x speedup, step: 80
Epoch 80/200 |loss: 8.409851| train set 5.308x speedup, test set 0.818x speedup, val set 5.330x speedup, step: 81
Epoch 81/200 |loss: 8.489661| train set 5.305x speedup, test set 0.826x speedup, val set 5.323x speedup, step: 82
Epoch 82/200 |loss: 8.095568| train set 5.252x speedup, test set 0.907x speedup, val set 5.260x speedup, step: 83
Epoch 83/200 |loss: 8.238616| train set 5.305x speedup, test set 0.928x speedup, val set 5.334x speedup, step: 84
Epoch 84/200 |loss: 8.055507| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 85
Epoch 85/200 |loss: 7.955562| train set 5.308x speedup, test set 0.917x speedup, val set 5.330x speedup, step: 86
Epoch 86/200 |loss: 7.974443| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 87
Epoch 87/200 |loss: 7.845182| train set 5.295x speedup, test set 0.928x speedup, val set 5.321x speedup, step: 88
Epoch 88/200 |loss: 7.814902| train set 5.295x speedup, test set 0.928x speedup, val set 5.321x speedup, step: 89
Epoch 89/200 |loss: 7.815196| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 90
Epoch 90/200 |loss: 7.633934| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 91
Epoch 91/200 |loss: 7.723277| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 92
Epoch 92/200 |loss: 7.587822| train set 5.305x speedup, test set 0.928x speedup, val set 5.334x speedup, step: 93
Epoch 93/200 |loss: 7.600094| train set 5.305x speedup, test set 0.917x speedup, val set 5.334x speedup, step: 94
Epoch 94/200 |loss: 7.518047| train set 5.305x speedup, test set 0.898x speedup, val set 5.323x speedup, step: 95
Epoch 95/200 |loss: 7.551448| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 96
Epoch 96/200 |loss: 7.462531| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 97
Epoch 97/200 |loss: 7.456292| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 98
Epoch 98/200 |loss: 7.401340| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 99
Epoch 99/200 |loss: 7.386160| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 100
Epoch 100/200 |loss: 7.358096| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 1
Epoch 101/200 |loss: 7.345271| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 1
Epoch 102/200 |loss: 7.337323| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 1
Epoch 103/200 |loss: 7.329245| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 1
Epoch 104/200 |loss: 7.435440| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 2
Epoch 105/200 |loss: 7.529366| train set 5.297x speedup, test set 0.897x speedup, val set 5.317x speedup, step: 3
Epoch 106/200 |loss: 8.007402| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 1
Epoch 107/200 |loss: 7.402865| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 2
Epoch 108/200 |loss: 7.553483| train set 5.295x speedup, test set 0.897x speedup, val set 5.321x speedup, step: 3
Epoch 109/200 |loss: 8.058827| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 1
Epoch 110/200 |loss: 7.445604| train set 5.257x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 2
Epoch 111/200 |loss: 8.105164| train set 5.294x speedup, test set 0.897x speedup, val set 5.318x speedup, step: 3
Epoch 112/200 |loss: 7.795927| train set 5.297x speedup, test set 0.907x speedup, val set 5.317x speedup, step: 4
Epoch 113/200 |loss: 7.644331| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 5
Epoch 114/200 |loss: 7.733363| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 6
Epoch 115/200 |loss: 7.435330| train set 5.295x speedup, test set 0.897x speedup, val set 5.310x speedup, step: 7
Epoch 116/200 |loss: 7.663672| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 1
Epoch 117/200 |loss: 7.403098| train set 5.309x speedup, test set 0.907x speedup, val set 5.333x speedup, step: 1
Epoch 118/200 |loss: 7.589923| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 2
Epoch 119/200 |loss: 7.307761| train set 5.295x speedup, test set 0.907x speedup, val set 5.321x speedup, step: 3
Epoch 120/200 |loss: 7.474761| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 4
Epoch 121/200 |loss: 7.290757| train set 5.254x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 5
Epoch 122/200 |loss: 7.379932| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 6
Epoch 123/200 |loss: 7.307493| train set 5.308x speedup, test set 0.905x speedup, val set 5.332x speedup, step: 7
Epoch 124/200 |loss: 7.293264| train set 5.310x speedup, test set 0.905x speedup, val set 5.331x speedup, step: 8
Epoch 125/200 |loss: 7.304166| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 9
Epoch 126/200 |loss: 7.232610| train set 5.297x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 10
Epoch 127/200 |loss: 7.227805| train set 5.254x speedup, test set 0.905x speedup, val set 5.267x speedup, step: 11
Epoch 128/200 |loss: 7.210574| train set 5.305x speedup, test set 0.905x speedup, val set 5.334x speedup, step: 1
Epoch 129/200 |loss: 7.196139| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 2
Epoch 130/200 |loss: 7.160051| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 3
Epoch 131/200 |loss: 7.190444| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 4
Epoch 132/200 |loss: 7.282122| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 5
Epoch 133/200 |loss: 7.311980| train set 5.254x speedup, test set 0.909x speedup, val set 5.267x speedup, step: 6
Epoch 134/200 |loss: 7.632488| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 1
Epoch 135/200 |loss: 7.611937| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 2
Epoch 136/200 |loss: 7.256258| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 3
Epoch 137/200 |loss: 7.250919| train set 5.307x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 4
Epoch 138/200 |loss: 7.441750| train set 5.254x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 5
Epoch 139/200 |loss: 7.676573| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 6
Epoch 140/200 |loss: 7.192749| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 7
Epoch 141/200 |loss: 7.856516| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 8
Epoch 142/200 |loss: 7.572965| train set 5.257x speedup, test set 0.905x speedup, val set 5.267x speedup, step: 9
Epoch 143/200 |loss: 7.617992| train set 5.305x speedup, test set 0.909x speedup, val set 5.334x speedup, step: 1
Epoch 144/200 |loss: 7.489921| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 2
Epoch 145/200 |loss: 7.434222| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 3
Epoch 146/200 |loss: 7.408014| train set 5.305x speedup, test set 0.909x speedup, val set 5.334x speedup, step: 1
Epoch 147/200 |loss: 7.387707| train set 5.305x speedup, test set 0.909x speedup, val set 5.334x speedup, step: 1
Epoch 148/200 |loss: 7.290773| train set 5.308x speedup, test set 0.911x speedup, val set 5.330x speedup, step: 2
Epoch 149/200 |loss: 7.368250| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 3
Epoch 150/200 |loss: 7.260650| train set 5.305x speedup, test set 0.911x speedup, val set 5.334x speedup, step: 1
Epoch 151/200 |loss: 7.257483| train set 5.305x speedup, test set 0.911x speedup, val set 5.334x speedup, step: 1
Epoch 152/200 |loss: 7.223887| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 2
Epoch 153/200 |loss: 7.253362| train set 5.308x speedup, test set 0.910x speedup, val set 5.330x speedup, step: 3
Epoch 154/200 |loss: 7.169703| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 4
Epoch 155/200 |loss: 7.182619| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 5
Epoch 156/200 |loss: 7.197684| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 6
Epoch 157/200 |loss: 7.133543| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 7
Epoch 158/200 |loss: 7.142065| train set 5.305x speedup, test set 0.909x speedup, val set 5.323x speedup, step: 8
Epoch 159/200 |loss: 7.164237| train set 5.310x speedup, test set 0.909x speedup, val set 5.331x speedup, step: 9
Epoch 160/200 |loss: 7.130417| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 10
Epoch 161/200 |loss: 7.132048| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 11
Epoch 162/200 |loss: 7.054896| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 12
Epoch 163/200 |loss: 7.100291| train set 5.305x speedup, test set 0.905x speedup, val set 5.331x speedup, step: 13
Epoch 164/200 |loss: 7.056926| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 14
Epoch 165/200 |loss: 7.067011| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 15
Epoch 166/200 |loss: 7.057428| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 16
Epoch 167/200 |loss: 7.049441| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 17
Epoch 168/200 |loss: 7.035879| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 18
Epoch 169/200 |loss: 7.021433| train set 5.305x speedup, test set 0.909x speedup, val set 5.334x speedup, step: 1
Epoch 170/200 |loss: 7.022559| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 2
Epoch 171/200 |loss: 7.004417| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 3
Epoch 172/200 |loss: 7.002220| train set 5.308x speedup, test set 0.911x speedup, val set 5.330x speedup, step: 4
Epoch 173/200 |loss: 7.046111| train set 5.308x speedup, test set 0.909x speedup, val set 5.330x speedup, step: 5
Epoch 174/200 |loss: 7.257176| train set 5.254x speedup, test set 0.897x speedup, val set 5.271x speedup, step: 6
Epoch 175/200 |loss: 7.410081| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 7
Epoch 176/200 |loss: 8.244489| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 8
Epoch 177/200 |loss: 7.154653| train set 5.254x speedup, test set 0.911x speedup, val set 5.268x speedup, step: 9
Epoch 178/200 |loss: 8.804865| train set 5.297x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 10
Epoch 179/200 |loss: 8.639575| train set 5.306x speedup, test set 0.926x speedup, val set 5.331x speedup, step: 11
Epoch 180/200 |loss: 8.425779| train set 5.305x speedup, test set 0.906x speedup, val set 5.334x speedup, step: 1
Epoch 181/200 |loss: 8.481625| train set 5.081x speedup, test set 0.894x speedup, val set 5.064x speedup, step: 2
Epoch 182/200 |loss: 8.072495| train set 5.308x speedup, test set 0.894x speedup, val set 5.330x speedup, step: 3
Epoch 183/200 |loss: 7.981960| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 4
Epoch 184/200 |loss: 7.982487| train set 5.307x speedup, test set 0.928x speedup, val set 5.341x speedup, step: 1
Epoch 185/200 |loss: 7.782581| train set 5.298x speedup, test set 0.925x speedup, val set 5.320x speedup, step: 2
Epoch 186/200 |loss: 7.690320| train set 5.298x speedup, test set 0.927x speedup, val set 5.323x speedup, step: 3
Epoch 187/200 |loss: 7.767610| train set 5.309x speedup, test set 0.927x speedup, val set 5.333x speedup, step: 4
Epoch 188/200 |loss: 7.594789| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 5
Epoch 189/200 |loss: 7.538260| train set 5.305x speedup, test set 0.826x speedup, val set 5.334x speedup, step: 6
Epoch 190/200 |loss: 7.462744| train set 5.306x speedup, test set 0.824x speedup, val set 5.336x speedup, step: 7
Epoch 191/200 |loss: 7.485826| train set 5.254x speedup, test set 0.927x speedup, val set 5.267x speedup, step: 8
Epoch 192/200 |loss: 7.350611| train set 5.254x speedup, test set 0.927x speedup, val set 5.267x speedup, step: 9
Epoch 193/200 |loss: 7.398019| train set 5.297x speedup, test set 0.927x speedup, val set 5.317x speedup, step: 10
Epoch 194/200 |loss: 7.317078| train set 5.297x speedup, test set 0.925x speedup, val set 5.317x speedup, step: 11
Epoch 195/200 |loss: 7.320148| train set 5.309x speedup, test set 0.925x speedup, val set 5.318x speedup, step: 12
Epoch 196/200 |loss: 7.261501| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 13
Epoch 197/200 |loss: 7.228013| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 14
Epoch 198/200 |loss: 7.226841| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 15
Epoch 199/200 |loss: 7.182310| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 16
Training per epoch cost 0.275 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.354s, pg runtime 0.354s, speedup 1.000x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.421s, pg runtime 0.389s, speedup 0.924x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 124, train speedup 5.310, test speedup 0.905, val speedup 5.331
best test speedup epoch: 14, train speedup 4.053, test speedup 2.968, val speedup 3.957
best validation speedup epoch: 184, train speedup 5.307, test speedup 0.928, val speedup 5.341
last model at epoch 199, train speedup 5.308, test speedup 0.929, val speedup 5.330
execution cost 0:02:42.241880
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.913574, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700630| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238359| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770412| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246290| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733976| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232391| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741787| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239244| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794752| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324333| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872921| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.359957| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.857153| train set 4.121x speedup, test set 2.655x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349058| train set 4.053x speedup, test set 2.956x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.847599| train set 4.053x speedup, test set 2.400x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.394434| train set 4.053x speedup, test set 2.412x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.949204| train set 4.456x speedup, test set 2.431x speedup, val set 4.318x speedup, step: 18
Epoch 18/200 |loss: 15.495778| train set 4.456x speedup, test set 2.503x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.080151| train set 4.566x speedup, test set 2.462x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.713542| train set 4.521x speedup, test set 2.461x speedup, val set 4.378x speedup, step: 21
Epoch 21/200 |loss: 14.344174| train set 4.807x speedup, test set 2.280x speedup, val set 4.785x speedup, step: 22
Epoch 22/200 |loss: 13.879186| train set 5.090x speedup, test set 2.350x speedup, val set 5.102x speedup, step: 23
Epoch 23/200 |loss: 13.429173| train set 5.090x speedup, test set 0.985x speedup, val set 5.102x speedup, step: 24
Epoch 24/200 |loss: 13.039772| train set 5.108x speedup, test set 0.998x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 12.770429| train set 5.273x speedup, test set 0.983x speedup, val set 5.297x speedup, step: 26
Epoch 26/200 |loss: 12.916351| train set 5.277x speedup, test set 0.997x speedup, val set 5.303x speedup, step: 27
Epoch 27/200 |loss: 12.914497| train set 5.273x speedup, test set 0.983x speedup, val set 5.297x speedup, step: 28
Epoch 28/200 |loss: 11.984437| train set 5.283x speedup, test set 0.998x speedup, val set 5.309x speedup, step: 29
Epoch 29/200 |loss: 12.097642| train set 5.305x speedup, test set 0.984x speedup, val set 5.326x speedup, step: 30
Epoch 30/200 |loss: 11.821494| train set 5.284x speedup, test set 0.995x speedup, val set 5.310x speedup, step: 31
Epoch 31/200 |loss: 11.309501| train set 5.295x speedup, test set 0.985x speedup, val set 5.323x speedup, step: 32
Epoch 32/200 |loss: 11.177364| train set 5.305x speedup, test set 0.961x speedup, val set 5.325x speedup, step: 33
Epoch 33/200 |loss: 11.018452| train set 5.306x speedup, test set 0.985x speedup, val set 5.336x speedup, step: 34
Epoch 34/200 |loss: 10.606404| train set 5.306x speedup, test set 0.982x speedup, val set 5.336x speedup, step: 35
Epoch 35/200 |loss: 10.423745| train set 5.305x speedup, test set 0.969x speedup, val set 5.326x speedup, step: 36
Epoch 36/200 |loss: 10.254935| train set 5.308x speedup, test set 0.973x speedup, val set 5.332x speedup, step: 37
Epoch 37/200 |loss: 9.999743| train set 5.306x speedup, test set 0.957x speedup, val set 5.336x speedup, step: 38
Epoch 38/200 |loss: 9.931612| train set 5.306x speedup, test set 0.981x speedup, val set 5.336x speedup, step: 39
Epoch 39/200 |loss: 9.634701| train set 5.295x speedup, test set 0.946x speedup, val set 5.313x speedup, step: 40
Epoch 40/200 |loss: 9.678243| train set 5.255x speedup, test set 0.981x speedup, val set 5.269x speedup, step: 41
Epoch 41/200 |loss: 9.987298| train set 5.007x speedup, test set 0.860x speedup, val set 5.015x speedup, step: 42
Epoch 42/200 |loss: 10.862676| train set 5.219x speedup, test set 0.857x speedup, val set 5.239x speedup, step: 43
Epoch 43/200 |loss: 10.036200| train set 5.305x speedup, test set 0.958x speedup, val set 5.326x speedup, step: 44
Epoch 44/200 |loss: 9.994554| train set 5.308x speedup, test set 0.948x speedup, val set 5.332x speedup, step: 45
Epoch 45/200 |loss: 9.786033| train set 5.308x speedup, test set 0.857x speedup, val set 5.332x speedup, step: 46
Epoch 46/200 |loss: 9.682041| train set 5.308x speedup, test set 0.860x speedup, val set 5.332x speedup, step: 47
Epoch 47/200 |loss: 9.250713| train set 5.305x speedup, test set 0.960x speedup, val set 5.326x speedup, step: 48
Epoch 48/200 |loss: 9.314662| train set 5.305x speedup, test set 0.984x speedup, val set 5.326x speedup, step: 49
Epoch 49/200 |loss: 9.139115| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 50
Epoch 50/200 |loss: 8.878798| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 51
Epoch 51/200 |loss: 8.956444| train set 5.255x speedup, test set 0.960x speedup, val set 5.269x speedup, step: 52
Epoch 52/200 |loss: 8.679451| train set 5.306x speedup, test set 0.932x speedup, val set 5.336x speedup, step: 53
Epoch 53/200 |loss: 8.715117| train set 5.306x speedup, test set 0.821x speedup, val set 5.336x speedup, step: 54
Epoch 54/200 |loss: 8.562834| train set 5.202x speedup, test set 0.829x speedup, val set 5.231x speedup, step: 55
Epoch 55/200 |loss: 8.555715| train set 5.308x speedup, test set 0.830x speedup, val set 5.332x speedup, step: 56
Epoch 56/200 |loss: 8.346910| train set 5.306x speedup, test set 0.932x speedup, val set 5.336x speedup, step: 57
Epoch 57/200 |loss: 8.500468| train set 5.308x speedup, test set 0.830x speedup, val set 5.332x speedup, step: 58
Epoch 58/200 |loss: 8.434282| train set 5.308x speedup, test set 0.932x speedup, val set 5.332x speedup, step: 59
Epoch 59/200 |loss: 8.352910| train set 5.305x speedup, test set 0.918x speedup, val set 5.326x speedup, step: 60
Epoch 60/200 |loss: 8.515908| train set 5.308x speedup, test set 0.929x speedup, val set 5.332x speedup, step: 61
Epoch 61/200 |loss: 8.321485| train set 5.297x speedup, test set 0.932x speedup, val set 5.320x speedup, step: 62
Epoch 62/200 |loss: 8.234290| train set 5.252x speedup, test set 0.932x speedup, val set 5.273x speedup, step: 63
Epoch 63/200 |loss: 8.014365| train set 5.253x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 64
Epoch 64/200 |loss: 8.002609| train set 5.297x speedup, test set 0.821x speedup, val set 5.320x speedup, step: 65
Epoch 65/200 |loss: 8.164992| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 66
Epoch 66/200 |loss: 8.046814| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 67
Epoch 67/200 |loss: 7.970003| train set 5.308x speedup, test set 0.948x speedup, val set 5.330x speedup, step: 68
Epoch 68/200 |loss: 8.139085| train set 5.254x speedup, test set 0.930x speedup, val set 5.267x speedup, step: 69
Epoch 69/200 |loss: 8.407974| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 70
Epoch 70/200 |loss: 8.236117| train set 5.308x speedup, test set 0.918x speedup, val set 5.330x speedup, step: 71
Epoch 71/200 |loss: 7.847063| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 72
Epoch 72/200 |loss: 8.070150| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 73
Epoch 73/200 |loss: 8.561093| train set 5.254x speedup, test set 0.918x speedup, val set 5.267x speedup, step: 74
Epoch 74/200 |loss: 7.832994| train set 5.254x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 75
Epoch 75/200 |loss: 8.577845| train set 5.297x speedup, test set 0.915x speedup, val set 5.317x speedup, step: 76
Epoch 76/200 |loss: 8.610609| train set 5.295x speedup, test set 0.829x speedup, val set 5.321x speedup, step: 77
Epoch 77/200 |loss: 8.338682| train set 5.252x speedup, test set 0.930x speedup, val set 5.270x speedup, step: 78
Epoch 78/200 |loss: 8.397502| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 79
Epoch 79/200 |loss: 8.116786| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 80
Epoch 80/200 |loss: 8.129438| train set 5.308x speedup, test set 0.829x speedup, val set 5.330x speedup, step: 81
Epoch 81/200 |loss: 8.052952| train set 5.252x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 82
Epoch 82/200 |loss: 7.912395| train set 5.295x speedup, test set 0.932x speedup, val set 5.310x speedup, step: 83
Epoch 83/200 |loss: 7.876147| train set 5.297x speedup, test set 0.932x speedup, val set 5.317x speedup, step: 84
Epoch 84/200 |loss: 7.867840| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 85
Epoch 85/200 |loss: 7.728089| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 86
Epoch 86/200 |loss: 7.746456| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 87
Epoch 87/200 |loss: 7.624220| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 88
Epoch 88/200 |loss: 7.633837| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 89
Epoch 89/200 |loss: 7.516878| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 90
Epoch 90/200 |loss: 7.574751| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 91
Epoch 91/200 |loss: 7.472773| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 92
Epoch 92/200 |loss: 7.472665| train set 5.307x speedup, test set 0.932x speedup, val set 5.326x speedup, step: 93
Epoch 93/200 |loss: 7.420383| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 94
Epoch 94/200 |loss: 7.466018| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 95
Epoch 95/200 |loss: 7.399603| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 96
Epoch 96/200 |loss: 7.451189| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 97
Epoch 97/200 |loss: 7.633255| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 98
Epoch 98/200 |loss: 7.688792| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 99
Epoch 99/200 |loss: 7.947843| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 100
Epoch 100/200 |loss: 7.599063| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 1
Epoch 101/200 |loss: 7.531445| train set 5.254x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 2
Epoch 102/200 |loss: 7.510504| train set 5.252x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 3
Epoch 103/200 |loss: 7.678539| train set 5.297x speedup, test set 0.921x speedup, val set 5.317x speedup, step: 4
Epoch 104/200 |loss: 7.596861| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 1
Epoch 105/200 |loss: 7.397595| train set 5.252x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 2
Epoch 106/200 |loss: 7.661201| train set 5.297x speedup, test set 0.921x speedup, val set 5.317x speedup, step: 3
Epoch 107/200 |loss: 7.630148| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 1
Epoch 108/200 |loss: 7.483098| train set 5.252x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 2
Epoch 109/200 |loss: 7.509249| train set 5.295x speedup, test set 0.921x speedup, val set 5.321x speedup, step: 3
Epoch 110/200 |loss: 7.704407| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 1
Epoch 111/200 |loss: 7.480305| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 1
Epoch 112/200 |loss: 7.434350| train set 5.297x speedup, test set 0.921x speedup, val set 5.317x speedup, step: 2
Epoch 113/200 |loss: 7.772158| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 1
Epoch 114/200 |loss: 7.259232| train set 5.254x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 2
Epoch 115/200 |loss: 7.633048| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 1
Epoch 116/200 |loss: 7.422684| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 1
Epoch 117/200 |loss: 7.400567| train set 5.257x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 2
Epoch 118/200 |loss: 7.507728| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 3
Epoch 119/200 |loss: 7.505796| train set 5.307x speedup, test set 0.921x speedup, val set 5.331x speedup, step: 4
Epoch 120/200 |loss: 7.376432| train set 5.255x speedup, test set 0.932x speedup, val set 5.268x speedup, step: 5
Epoch 121/200 |loss: 7.520210| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 6
Epoch 122/200 |loss: 7.238245| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 7
Epoch 123/200 |loss: 7.383063| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 1
Epoch 124/200 |loss: 7.273298| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 1
Epoch 125/200 |loss: 7.242876| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 2
Epoch 126/200 |loss: 7.263847| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 3
Epoch 127/200 |loss: 7.177361| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 1
Epoch 128/200 |loss: 7.277154| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 1
Epoch 129/200 |loss: 7.235914| train set 5.308x speedup, test set 0.910x speedup, val set 5.330x speedup, step: 2
Epoch 130/200 |loss: 7.192373| train set 5.254x speedup, test set 0.921x speedup, val set 5.267x speedup, step: 3
Epoch 131/200 |loss: 7.200300| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 4
Epoch 132/200 |loss: 7.171518| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 5
Epoch 133/200 |loss: 7.123377| train set 5.308x speedup, test set 0.910x speedup, val set 5.330x speedup, step: 6
Epoch 134/200 |loss: 7.150213| train set 5.307x speedup, test set 0.910x speedup, val set 5.331x speedup, step: 7
Epoch 135/200 |loss: 7.148136| train set 5.308x speedup, test set 0.910x speedup, val set 5.330x speedup, step: 8
Epoch 136/200 |loss: 7.069748| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 9
Epoch 137/200 |loss: 7.120773| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 10
Epoch 138/200 |loss: 7.140881| train set 5.307x speedup, test set 0.917x speedup, val set 5.330x speedup, step: 11
Epoch 139/200 |loss: 7.234440| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 12
Epoch 140/200 |loss: 7.574192| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 1
Epoch 141/200 |loss: 7.449681| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 2
Epoch 142/200 |loss: 7.383519| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 3
Epoch 143/200 |loss: 7.079077| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 4
Epoch 144/200 |loss: 7.525182| train set 5.305x speedup, test set 0.921x speedup, val set 5.323x speedup, step: 5
Epoch 145/200 |loss: 7.953777| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 1
Epoch 146/200 |loss: 7.343531| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 2
Epoch 147/200 |loss: 7.835219| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 3
Epoch 148/200 |loss: 7.451587| train set 5.254x speedup, test set 0.920x speedup, val set 5.267x speedup, step: 4
Epoch 149/200 |loss: 7.500179| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 1
Epoch 150/200 |loss: 7.366427| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 2
Epoch 151/200 |loss: 7.345096| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 3
Epoch 152/200 |loss: 7.328752| train set 5.305x speedup, test set 0.920x speedup, val set 5.334x speedup, step: 1
Epoch 153/200 |loss: 7.311791| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 1
Epoch 154/200 |loss: 7.236787| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 2
Epoch 155/200 |loss: 7.246143| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 3
Epoch 156/200 |loss: 7.190869| train set 5.307x speedup, test set 0.921x speedup, val set 5.331x speedup, step: 4
Epoch 157/200 |loss: 7.207299| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 1
Epoch 158/200 |loss: 7.147483| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 2
Epoch 159/200 |loss: 7.156352| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 3
Epoch 160/200 |loss: 7.129542| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 4
Epoch 161/200 |loss: 7.118745| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 5
Epoch 162/200 |loss: 7.118441| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 6
Epoch 163/200 |loss: 7.099823| train set 5.309x speedup, test set 0.932x speedup, val set 5.331x speedup, step: 7
Epoch 164/200 |loss: 7.148931| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 8
Epoch 165/200 |loss: 7.241748| train set 5.257x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 9
Epoch 166/200 |loss: 7.241378| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 10
Epoch 167/200 |loss: 7.410497| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 11
Epoch 168/200 |loss: 7.111256| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 12
Epoch 169/200 |loss: 7.179149| train set 5.310x speedup, test set 0.920x speedup, val set 5.317x speedup, step: 13
Epoch 170/200 |loss: 7.378652| train set 5.305x speedup, test set 0.920x speedup, val set 5.334x speedup, step: 1
Epoch 171/200 |loss: 7.106457| train set 5.254x speedup, test set 0.920x speedup, val set 5.267x speedup, step: 2
Epoch 172/200 |loss: 7.197571| train set 5.297x speedup, test set 0.920x speedup, val set 5.317x speedup, step: 3
Epoch 173/200 |loss: 7.335285| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 4
Epoch 174/200 |loss: 7.058827| train set 5.257x speedup, test set 0.920x speedup, val set 5.267x speedup, step: 5
Epoch 175/200 |loss: 7.283821| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 6
Epoch 176/200 |loss: 7.220030| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 7
Epoch 177/200 |loss: 7.085245| train set 5.257x speedup, test set 0.921x speedup, val set 5.267x speedup, step: 8
Epoch 178/200 |loss: 7.277002| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 9
Epoch 179/200 |loss: 7.098677| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 10
Epoch 180/200 |loss: 7.114991| train set 5.310x speedup, test set 0.921x speedup, val set 5.331x speedup, step: 11
Epoch 181/200 |loss: 7.200876| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 12
Epoch 182/200 |loss: 7.025249| train set 5.305x speedup, test set 0.921x speedup, val set 5.334x speedup, step: 1
Epoch 183/200 |loss: 7.091798| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 2
Epoch 184/200 |loss: 7.116756| train set 5.310x speedup, test set 0.921x speedup, val set 5.331x speedup, step: 3
Epoch 185/200 |loss: 7.026538| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 4
Epoch 186/200 |loss: 7.131848| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 5
Epoch 187/200 |loss: 6.996651| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 6
Epoch 188/200 |loss: 7.024937| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 7
Epoch 189/200 |loss: 7.110523| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 8
Epoch 190/200 |loss: 7.030987| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 9
Epoch 191/200 |loss: 7.198556| train set 5.297x speedup, test set 0.921x speedup, val set 5.317x speedup, step: 10
Epoch 192/200 |loss: 7.076163| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 11
Epoch 193/200 |loss: 6.991766| train set 5.254x speedup, test set 0.921x speedup, val set 5.267x speedup, step: 12
Epoch 194/200 |loss: 7.027890| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 13
Epoch 195/200 |loss: 6.997923| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 14
Epoch 196/200 |loss: 6.981075| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 15
Epoch 197/200 |loss: 7.153738| train set 5.308x speedup, test set 0.921x speedup, val set 5.330x speedup, step: 16
Epoch 198/200 |loss: 7.104546| train set 5.308x speedup, test set 0.920x speedup, val set 5.330x speedup, step: 17
Epoch 199/200 |loss: 7.291291| train set 5.310x speedup, test set 0.921x speedup, val set 5.331x speedup, step: 18
Training per epoch cost 0.259 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.453s, pg runtime 0.453s, speedup 1.000x
17, opt runtime 0.327s, model runtime 0.354s, pg runtime 0.354s, speedup 1.000x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 180, train speedup 5.310, test speedup 0.921, val speedup 5.331
best test speedup epoch: 14, train speedup 4.053, test speedup 2.956, val speedup 3.957
best validation speedup epoch: 182, train speedup 5.305, test speedup 0.921, val speedup 5.334
last model at epoch 199, train speedup 5.310, test speedup 0.921, val speedup 5.331
execution cost 0:02:37.121641
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.884725, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700630| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238359| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770414| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246290| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733976| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232393| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741789| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239250| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794756| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324339| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872940| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.360317| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.858032| train set 4.121x speedup, test set 2.657x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349739| train set 4.053x speedup, test set 2.968x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.855873| train set 4.053x speedup, test set 2.392x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.396019| train set 4.053x speedup, test set 2.402x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.940578| train set 4.402x speedup, test set 2.431x speedup, val set 4.269x speedup, step: 18
Epoch 18/200 |loss: 15.484930| train set 4.456x speedup, test set 2.506x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.088507| train set 4.566x speedup, test set 2.426x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.697793| train set 4.607x speedup, test set 2.439x speedup, val set 4.593x speedup, step: 21
Epoch 21/200 |loss: 14.285123| train set 4.872x speedup, test set 2.279x speedup, val set 4.846x speedup, step: 22
Epoch 22/200 |loss: 13.826974| train set 5.108x speedup, test set 2.349x speedup, val set 5.104x speedup, step: 23
Epoch 23/200 |loss: 13.419203| train set 5.098x speedup, test set 2.256x speedup, val set 5.092x speedup, step: 24
Epoch 24/200 |loss: 13.028907| train set 5.273x speedup, test set 2.281x speedup, val set 5.297x speedup, step: 25
Epoch 25/200 |loss: 12.661884| train set 5.080x speedup, test set 0.983x speedup, val set 5.090x speedup, step: 26
Epoch 26/200 |loss: 12.526886| train set 5.208x speedup, test set 0.997x speedup, val set 5.237x speedup, step: 27
Epoch 27/200 |loss: 12.873964| train set 5.272x speedup, test set 0.985x speedup, val set 5.286x speedup, step: 28
Epoch 28/200 |loss: 12.631287| train set 5.274x speedup, test set 0.984x speedup, val set 5.297x speedup, step: 29
Epoch 29/200 |loss: 11.919595| train set 5.208x speedup, test set 0.998x speedup, val set 5.236x speedup, step: 30
Epoch 30/200 |loss: 12.308404| train set 5.295x speedup, test set 0.983x speedup, val set 5.323x speedup, step: 31
Epoch 31/200 |loss: 11.258390| train set 5.273x speedup, test set 1.045x speedup, val set 5.284x speedup, step: 32
Epoch 32/200 |loss: 11.514344| train set 5.284x speedup, test set 0.973x speedup, val set 5.307x speedup, step: 33
Epoch 33/200 |loss: 10.827268| train set 5.284x speedup, test set 0.997x speedup, val set 5.310x speedup, step: 34
Epoch 34/200 |loss: 11.074305| train set 5.306x speedup, test set 0.985x speedup, val set 5.336x speedup, step: 35
Epoch 35/200 |loss: 10.402688| train set 5.273x speedup, test set 1.074x speedup, val set 5.287x speedup, step: 36
Epoch 36/200 |loss: 10.531197| train set 5.308x speedup, test set 0.985x speedup, val set 5.332x speedup, step: 37
Epoch 37/200 |loss: 10.015891| train set 5.308x speedup, test set 0.998x speedup, val set 5.332x speedup, step: 38
Epoch 38/200 |loss: 10.103271| train set 5.305x speedup, test set 0.985x speedup, val set 5.326x speedup, step: 39
Epoch 39/200 |loss: 9.688291| train set 5.305x speedup, test set 0.985x speedup, val set 5.326x speedup, step: 40
Epoch 40/200 |loss: 9.698395| train set 5.308x speedup, test set 0.976x speedup, val set 5.332x speedup, step: 41
Epoch 41/200 |loss: 9.350461| train set 5.308x speedup, test set 0.975x speedup, val set 5.332x speedup, step: 42
Epoch 42/200 |loss: 9.327433| train set 5.308x speedup, test set 0.963x speedup, val set 5.332x speedup, step: 43
Epoch 43/200 |loss: 9.196137| train set 5.295x speedup, test set 0.963x speedup, val set 5.313x speedup, step: 44
Epoch 44/200 |loss: 9.808434| train set 5.255x speedup, test set 0.957x speedup, val set 5.269x speedup, step: 45
Epoch 45/200 |loss: 10.662065| train set 5.295x speedup, test set 0.996x speedup, val set 5.323x speedup, step: 46
Epoch 46/200 |loss: 10.496686| train set 5.295x speedup, test set 0.852x speedup, val set 5.323x speedup, step: 47
Epoch 47/200 |loss: 9.643269| train set 5.305x speedup, test set 0.852x speedup, val set 5.326x speedup, step: 48
Epoch 48/200 |loss: 9.742997| train set 5.308x speedup, test set 0.850x speedup, val set 5.332x speedup, step: 49
Epoch 49/200 |loss: 9.398031| train set 5.308x speedup, test set 0.850x speedup, val set 5.332x speedup, step: 50
Epoch 50/200 |loss: 9.274485| train set 5.306x speedup, test set 0.842x speedup, val set 5.336x speedup, step: 51
Epoch 51/200 |loss: 9.194319| train set 5.252x speedup, test set 0.984x speedup, val set 5.273x speedup, step: 52
Epoch 52/200 |loss: 9.124393| train set 5.308x speedup, test set 0.979x speedup, val set 5.332x speedup, step: 53
Epoch 53/200 |loss: 8.881672| train set 5.308x speedup, test set 0.849x speedup, val set 5.332x speedup, step: 54
Epoch 54/200 |loss: 8.803267| train set 5.308x speedup, test set 0.932x speedup, val set 5.332x speedup, step: 55
Epoch 55/200 |loss: 8.715259| train set 5.306x speedup, test set 0.960x speedup, val set 5.336x speedup, step: 56
Epoch 56/200 |loss: 8.570792| train set 5.305x speedup, test set 0.815x speedup, val set 5.326x speedup, step: 57
Epoch 57/200 |loss: 8.514111| train set 5.306x speedup, test set 0.924x speedup, val set 5.336x speedup, step: 58
Epoch 58/200 |loss: 8.462750| train set 5.252x speedup, test set 0.925x speedup, val set 5.273x speedup, step: 59
Epoch 59/200 |loss: 8.381363| train set 5.297x speedup, test set 0.924x speedup, val set 5.320x speedup, step: 60
Epoch 60/200 |loss: 8.285117| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 61
Epoch 61/200 |loss: 8.213243| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 62
Epoch 62/200 |loss: 8.224677| train set 5.308x speedup, test set 0.924x speedup, val set 5.330x speedup, step: 63
Epoch 63/200 |loss: 8.085574| train set 5.305x speedup, test set 0.904x speedup, val set 5.334x speedup, step: 64
Epoch 64/200 |loss: 8.027843| train set 5.252x speedup, test set 0.904x speedup, val set 5.270x speedup, step: 65
Epoch 65/200 |loss: 8.071189| train set 5.308x speedup, test set 0.924x speedup, val set 5.330x speedup, step: 66
Epoch 66/200 |loss: 8.033545| train set 5.308x speedup, test set 0.925x speedup, val set 5.330x speedup, step: 67
Epoch 67/200 |loss: 7.860152| train set 5.308x speedup, test set 0.904x speedup, val set 5.330x speedup, step: 68
Epoch 68/200 |loss: 7.927862| train set 5.297x speedup, test set 0.924x speedup, val set 5.317x speedup, step: 69
Epoch 69/200 |loss: 7.988747| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 70
Epoch 70/200 |loss: 7.720723| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 71
Epoch 71/200 |loss: 7.826068| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 72
Epoch 72/200 |loss: 8.047810| train set 5.254x speedup, test set 0.928x speedup, val set 5.267x speedup, step: 73
Epoch 73/200 |loss: 7.695292| train set 5.253x speedup, test set 0.928x speedup, val set 5.267x speedup, step: 74
Epoch 74/200 |loss: 7.731209| train set 5.297x speedup, test set 0.928x speedup, val set 5.317x speedup, step: 75
Epoch 75/200 |loss: 7.978198| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 76
Epoch 76/200 |loss: 7.623241| train set 5.254x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 77
Epoch 77/200 |loss: 7.805539| train set 5.297x speedup, test set 0.928x speedup, val set 5.317x speedup, step: 78
Epoch 78/200 |loss: 8.169185| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 79
Epoch 79/200 |loss: 7.898023| train set 5.252x speedup, test set 0.928x speedup, val set 5.270x speedup, step: 80
Epoch 80/200 |loss: 8.616641| train set 5.308x speedup, test set 0.818x speedup, val set 5.330x speedup, step: 81
Epoch 81/200 |loss: 8.201652| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 82
Epoch 82/200 |loss: 8.053582| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 83
Epoch 83/200 |loss: 8.095786| train set 5.252x speedup, test set 0.802x speedup, val set 5.270x speedup, step: 84
Epoch 84/200 |loss: 8.285211| train set 5.295x speedup, test set 0.826x speedup, val set 5.321x speedup, step: 85
Epoch 85/200 |loss: 7.959047| train set 5.297x speedup, test set 0.826x speedup, val set 5.317x speedup, step: 86
Epoch 86/200 |loss: 8.122540| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 87
Epoch 87/200 |loss: 7.944500| train set 5.308x speedup, test set 0.827x speedup, val set 5.330x speedup, step: 88
Epoch 88/200 |loss: 7.871518| train set 5.295x speedup, test set 0.826x speedup, val set 5.321x speedup, step: 89
Epoch 89/200 |loss: 7.924863| train set 5.297x speedup, test set 0.826x speedup, val set 5.317x speedup, step: 90
Epoch 90/200 |loss: 7.714884| train set 5.308x speedup, test set 0.830x speedup, val set 5.330x speedup, step: 91
Epoch 91/200 |loss: 7.722858| train set 5.252x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 92
Epoch 92/200 |loss: 7.687322| train set 5.305x speedup, test set 0.830x speedup, val set 5.334x speedup, step: 93
Epoch 93/200 |loss: 7.588722| train set 5.308x speedup, test set 0.830x speedup, val set 5.330x speedup, step: 94
Epoch 94/200 |loss: 7.621530| train set 5.308x speedup, test set 0.827x speedup, val set 5.330x speedup, step: 95
Epoch 95/200 |loss: 7.550005| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 96
Epoch 96/200 |loss: 7.464506| train set 5.297x speedup, test set 0.830x speedup, val set 5.317x speedup, step: 97
Epoch 97/200 |loss: 7.530421| train set 5.308x speedup, test set 0.830x speedup, val set 5.330x speedup, step: 98
Epoch 98/200 |loss: 7.384660| train set 5.308x speedup, test set 0.830x speedup, val set 5.330x speedup, step: 99
Epoch 99/200 |loss: 7.500760| train set 5.308x speedup, test set 0.805x speedup, val set 5.330x speedup, step: 100
Epoch 100/200 |loss: 7.364518| train set 5.305x speedup, test set 0.814x speedup, val set 5.334x speedup, step: 1
Epoch 101/200 |loss: 7.384667| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 2
Epoch 102/200 |loss: 7.320284| train set 5.308x speedup, test set 0.805x speedup, val set 5.330x speedup, step: 3
Epoch 103/200 |loss: 7.362018| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 4
Epoch 104/200 |loss: 7.270872| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 5
Epoch 105/200 |loss: 7.279281| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 6
Epoch 106/200 |loss: 7.268887| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 7
Epoch 107/200 |loss: 7.243017| train set 5.308x speedup, test set 0.911x speedup, val set 5.330x speedup, step: 8
Epoch 108/200 |loss: 7.212725| train set 5.305x speedup, test set 0.912x speedup, val set 5.334x speedup, step: 1
Epoch 109/200 |loss: 7.202026| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 2
Epoch 110/200 |loss: 7.171115| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 3
Epoch 111/200 |loss: 7.202195| train set 5.305x speedup, test set 0.912x speedup, val set 5.334x speedup, step: 1
Epoch 112/200 |loss: 7.200401| train set 5.252x speedup, test set 0.912x speedup, val set 5.270x speedup, step: 2
Epoch 113/200 |loss: 7.246239| train set 5.297x speedup, test set 0.911x speedup, val set 5.317x speedup, step: 3
Epoch 114/200 |loss: 7.486282| train set 5.257x speedup, test set 0.912x speedup, val set 5.267x speedup, step: 4
Epoch 115/200 |loss: 7.522076| train set 5.297x speedup, test set 0.901x speedup, val set 5.317x speedup, step: 5
Epoch 116/200 |loss: 7.866998| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 6
Epoch 117/200 |loss: 7.458146| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 7
Epoch 118/200 |loss: 7.444174| train set 5.295x speedup, test set 0.897x speedup, val set 5.321x speedup, step: 8
Epoch 119/200 |loss: 7.966673| train set 5.252x speedup, test set 0.911x speedup, val set 5.260x speedup, step: 9
Epoch 120/200 |loss: 7.769993| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 10
Epoch 121/200 |loss: 7.460086| train set 5.297x speedup, test set 0.897x speedup, val set 5.317x speedup, step: 11
Epoch 122/200 |loss: 7.705503| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 12
Epoch 123/200 |loss: 7.299861| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 13
Epoch 124/200 |loss: 7.431860| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 1
Epoch 125/200 |loss: 7.426197| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 1
Epoch 126/200 |loss: 7.257289| train set 5.257x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 2
Epoch 127/200 |loss: 7.384172| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 3
Epoch 128/200 |loss: 7.532352| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 1
Epoch 129/200 |loss: 7.247564| train set 5.257x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 2
Epoch 130/200 |loss: 7.506196| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 3
Epoch 131/200 |loss: 7.407472| train set 5.305x speedup, test set 0.810x speedup, val set 5.334x speedup, step: 1
Epoch 132/200 |loss: 7.353285| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 2
Epoch 133/200 |loss: 7.439669| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 3
Epoch 134/200 |loss: 7.225128| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 4
Epoch 135/200 |loss: 7.292880| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 5
Epoch 136/200 |loss: 7.251928| train set 5.257x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 6
Epoch 137/200 |loss: 7.294391| train set 5.297x speedup, test set 0.907x speedup, val set 5.317x speedup, step: 7
Epoch 138/200 |loss: 7.249956| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 8
Epoch 139/200 |loss: 7.172037| train set 5.254x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 9
Epoch 140/200 |loss: 7.185421| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 10
Epoch 141/200 |loss: 7.143709| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 11
Epoch 142/200 |loss: 7.143032| train set 5.308x speedup, test set 0.911x speedup, val set 5.330x speedup, step: 12
Epoch 143/200 |loss: 7.143212| train set 5.305x speedup, test set 0.911x speedup, val set 5.334x speedup, step: 1
Epoch 144/200 |loss: 7.142277| train set 5.308x speedup, test set 0.813x speedup, val set 5.330x speedup, step: 2
Epoch 145/200 |loss: 7.100007| train set 5.308x speedup, test set 0.813x speedup, val set 5.330x speedup, step: 3
Epoch 146/200 |loss: 7.146870| train set 5.308x speedup, test set 0.911x speedup, val set 5.330x speedup, step: 4
Epoch 147/200 |loss: 7.184528| train set 5.254x speedup, test set 0.911x speedup, val set 5.271x speedup, step: 5
Epoch 148/200 |loss: 7.341265| train set 5.308x speedup, test set 0.813x speedup, val set 5.330x speedup, step: 6
Epoch 149/200 |loss: 7.849413| train set 5.310x speedup, test set 0.911x speedup, val set 5.331x speedup, step: 7
Epoch 150/200 |loss: 7.319283| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 8
Epoch 151/200 |loss: 7.495336| train set 5.305x speedup, test set 0.802x speedup, val set 5.323x speedup, step: 9
Epoch 152/200 |loss: 8.407791| train set 5.252x speedup, test set 0.908x speedup, val set 5.270x speedup, step: 10
Epoch 153/200 |loss: 7.460899| train set 5.310x speedup, test set 0.907x speedup, val set 5.331x speedup, step: 11
Epoch 154/200 |loss: 8.209262| train set 5.131x speedup, test set 0.809x speedup, val set 5.123x speedup, step: 12
Epoch 155/200 |loss: 7.684277| train set 5.308x speedup, test set 0.801x speedup, val set 5.330x speedup, step: 13
Epoch 156/200 |loss: 7.644402| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 1
Epoch 157/200 |loss: 7.620313| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 1
Epoch 158/200 |loss: 7.505130| train set 5.308x speedup, test set 0.809x speedup, val set 5.330x speedup, step: 2
Epoch 159/200 |loss: 7.497292| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 3
Epoch 160/200 |loss: 7.422643| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 4
Epoch 161/200 |loss: 7.334261| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 5
Epoch 162/200 |loss: 7.373913| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 6
Epoch 163/200 |loss: 7.234291| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 7
Epoch 164/200 |loss: 7.304023| train set 5.310x speedup, test set 0.810x speedup, val set 5.317x speedup, step: 8
Epoch 165/200 |loss: 7.204190| train set 5.295x speedup, test set 0.907x speedup, val set 5.321x speedup, step: 9
Epoch 166/200 |loss: 7.243752| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 10
Epoch 167/200 |loss: 7.181872| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 11
Epoch 168/200 |loss: 7.186563| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 12
Epoch 169/200 |loss: 7.150212| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 13
Epoch 170/200 |loss: 7.164032| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 14
Epoch 171/200 |loss: 7.098359| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 15
Epoch 172/200 |loss: 7.119876| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 16
Epoch 173/200 |loss: 7.097448| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 17
Epoch 174/200 |loss: 7.074953| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 18
Epoch 175/200 |loss: 7.062891| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 19
Epoch 176/200 |loss: 7.060507| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 20
Epoch 177/200 |loss: 7.045691| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 21
Epoch 178/200 |loss: 7.053782| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 22
Epoch 179/200 |loss: 7.026732| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 23
Epoch 180/200 |loss: 7.035342| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 24
Epoch 181/200 |loss: 7.012383| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 25
Epoch 182/200 |loss: 7.013827| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 26
Epoch 183/200 |loss: 7.018443| train set 5.310x speedup, test set 0.912x speedup, val set 5.331x speedup, step: 27
Epoch 184/200 |loss: 7.029717| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 28
Epoch 185/200 |loss: 7.092813| train set 5.257x speedup, test set 0.912x speedup, val set 5.267x speedup, step: 29
Epoch 186/200 |loss: 7.115175| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 30
Epoch 187/200 |loss: 7.216985| train set 5.254x speedup, test set 0.912x speedup, val set 5.267x speedup, step: 31
Epoch 188/200 |loss: 7.008760| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 32
Epoch 189/200 |loss: 6.982502| train set 5.297x speedup, test set 0.912x speedup, val set 5.317x speedup, step: 33
Epoch 190/200 |loss: 7.099847| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 34
Epoch 191/200 |loss: 7.021549| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 35
Epoch 192/200 |loss: 6.954490| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 36
Epoch 193/200 |loss: 7.006369| train set 5.305x speedup, test set 0.912x speedup, val set 5.331x speedup, step: 37
Epoch 194/200 |loss: 6.999412| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 38
Epoch 195/200 |loss: 6.959833| train set 5.297x speedup, test set 0.912x speedup, val set 5.317x speedup, step: 39
Epoch 196/200 |loss: 6.960613| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 40
Epoch 197/200 |loss: 7.001960| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 41
Epoch 198/200 |loss: 7.044222| train set 5.308x speedup, test set 0.912x speedup, val set 5.330x speedup, step: 42
Epoch 199/200 |loss: 7.169678| train set 5.310x speedup, test set 0.912x speedup, val set 5.331x speedup, step: 43
Training per epoch cost 0.266 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 5.204s, pg runtime 2.599s, speedup 0.499x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 149, train speedup 5.310, test speedup 0.911, val speedup 5.331
best test speedup epoch: 14, train speedup 4.053, test speedup 2.968, val speedup 3.957
best validation speedup epoch: 157, train speedup 5.305, test speedup 0.907, val speedup 5.334
last model at epoch 199, train speedup 5.310, test speedup 0.912, val speedup 5.331
execution cost 0:02:38.320676
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.923279, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700630| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238358| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770414| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246290| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733976| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232393| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741787| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239244| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794754| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324333| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872925| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.359957| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.857153| train set 4.121x speedup, test set 2.655x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349060| train set 4.053x speedup, test set 2.956x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.846962| train set 4.053x speedup, test set 2.400x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.393074| train set 4.053x speedup, test set 2.412x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.944832| train set 4.456x speedup, test set 2.431x speedup, val set 4.318x speedup, step: 18
Epoch 18/200 |loss: 15.498777| train set 4.456x speedup, test set 2.503x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.095004| train set 4.566x speedup, test set 2.280x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.729983| train set 4.699x speedup, test set 2.439x speedup, val set 4.617x speedup, step: 21
Epoch 21/200 |loss: 14.353316| train set 5.004x speedup, test set 2.280x speedup, val set 4.997x speedup, step: 22
Epoch 22/200 |loss: 13.857311| train set 5.108x speedup, test set 2.350x speedup, val set 5.104x speedup, step: 23
Epoch 23/200 |loss: 13.440307| train set 5.080x speedup, test set 2.461x speedup, val set 5.090x speedup, step: 24
Epoch 24/200 |loss: 13.122923| train set 5.038x speedup, test set 0.997x speedup, val set 5.036x speedup, step: 25
Epoch 25/200 |loss: 12.946445| train set 5.080x speedup, test set 0.984x speedup, val set 5.090x speedup, step: 26
Epoch 26/200 |loss: 12.876657| train set 5.284x speedup, test set 0.998x speedup, val set 5.310x speedup, step: 27
Epoch 27/200 |loss: 12.260496| train set 5.274x speedup, test set 0.998x speedup, val set 5.297x speedup, step: 28
Epoch 28/200 |loss: 11.848673| train set 5.272x speedup, test set 0.985x speedup, val set 5.286x speedup, step: 29
Epoch 29/200 |loss: 11.835096| train set 5.208x speedup, test set 0.998x speedup, val set 5.236x speedup, step: 30
Epoch 30/200 |loss: 11.635276| train set 5.294x speedup, test set 0.957x speedup, val set 5.298x speedup, step: 31
Epoch 31/200 |loss: 11.801893| train set 5.295x speedup, test set 0.982x speedup, val set 5.323x speedup, step: 32
Epoch 32/200 |loss: 11.518644| train set 5.229x speedup, test set 0.984x speedup, val set 5.252x speedup, step: 33
Epoch 33/200 |loss: 11.277816| train set 5.305x speedup, test set 0.955x speedup, val set 5.326x speedup, step: 34
Epoch 34/200 |loss: 10.720319| train set 5.295x speedup, test set 0.846x speedup, val set 5.323x speedup, step: 35
Epoch 35/200 |loss: 10.956638| train set 5.306x speedup, test set 0.958x speedup, val set 5.336x speedup, step: 36
Epoch 36/200 |loss: 10.506550| train set 5.306x speedup, test set 0.982x speedup, val set 5.336x speedup, step: 37
Epoch 37/200 |loss: 10.327203| train set 5.306x speedup, test set 0.958x speedup, val set 5.333x speedup, step: 38
Epoch 38/200 |loss: 10.077101| train set 5.308x speedup, test set 0.958x speedup, val set 5.332x speedup, step: 39
Epoch 39/200 |loss: 10.191541| train set 5.306x speedup, test set 0.970x speedup, val set 5.336x speedup, step: 40
Epoch 40/200 |loss: 9.702130| train set 5.305x speedup, test set 0.982x speedup, val set 5.326x speedup, step: 41
Epoch 41/200 |loss: 9.765399| train set 5.308x speedup, test set 0.958x speedup, val set 5.332x speedup, step: 42
Epoch 42/200 |loss: 9.358332| train set 5.308x speedup, test set 0.970x speedup, val set 5.332x speedup, step: 43
Epoch 43/200 |loss: 9.324120| train set 5.308x speedup, test set 0.958x speedup, val set 5.332x speedup, step: 44
Epoch 44/200 |loss: 9.185606| train set 5.306x speedup, test set 0.960x speedup, val set 5.336x speedup, step: 45
Epoch 45/200 |loss: 9.178427| train set 5.305x speedup, test set 0.958x speedup, val set 5.326x speedup, step: 46
Epoch 46/200 |loss: 9.099233| train set 5.306x speedup, test set 0.957x speedup, val set 5.336x speedup, step: 47
Epoch 47/200 |loss: 9.345048| train set 5.255x speedup, test set 0.957x speedup, val set 5.269x speedup, step: 48
Epoch 48/200 |loss: 9.435107| train set 5.297x speedup, test set 0.958x speedup, val set 5.320x speedup, step: 49
Epoch 49/200 |loss: 9.221299| train set 5.308x speedup, test set 0.957x speedup, val set 5.332x speedup, step: 50
Epoch 50/200 |loss: 8.818075| train set 5.308x speedup, test set 0.957x speedup, val set 5.332x speedup, step: 51
Epoch 51/200 |loss: 9.049875| train set 5.306x speedup, test set 0.958x speedup, val set 5.336x speedup, step: 52
Epoch 52/200 |loss: 8.744465| train set 5.306x speedup, test set 0.929x speedup, val set 5.336x speedup, step: 53
Epoch 53/200 |loss: 8.873995| train set 5.308x speedup, test set 0.957x speedup, val set 5.332x speedup, step: 54
Epoch 54/200 |loss: 8.624675| train set 5.306x speedup, test set 0.930x speedup, val set 5.336x speedup, step: 55
Epoch 55/200 |loss: 8.481591| train set 5.308x speedup, test set 0.930x speedup, val set 5.332x speedup, step: 56
Epoch 56/200 |loss: 8.461036| train set 5.303x speedup, test set 0.957x speedup, val set 5.332x speedup, step: 57
Epoch 57/200 |loss: 8.359241| train set 5.306x speedup, test set 0.981x speedup, val set 5.336x speedup, step: 58
Epoch 58/200 |loss: 8.245453| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 59
Epoch 59/200 |loss: 8.176922| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 60
Epoch 60/200 |loss: 8.107328| train set 5.254x speedup, test set 0.957x speedup, val set 5.267x speedup, step: 61
Epoch 61/200 |loss: 8.166120| train set 5.308x speedup, test set 0.957x speedup, val set 5.330x speedup, step: 62
Epoch 62/200 |loss: 7.973814| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 63
Epoch 63/200 |loss: 7.929586| train set 5.305x speedup, test set 0.930x speedup, val set 5.334x speedup, step: 64
Epoch 64/200 |loss: 7.886699| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 65
Epoch 65/200 |loss: 7.853405| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 66
Epoch 66/200 |loss: 7.845026| train set 5.310x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 67
Epoch 67/200 |loss: 7.962440| train set 5.307x speedup, test set 0.952x speedup, val set 5.331x speedup, step: 68
Epoch 68/200 |loss: 7.861330| train set 5.297x speedup, test set 0.930x speedup, val set 5.317x speedup, step: 69
Epoch 69/200 |loss: 7.914503| train set 5.253x speedup, test set 0.930x speedup, val set 5.267x speedup, step: 70
Epoch 70/200 |loss: 7.815691| train set 5.307x speedup, test set 0.929x speedup, val set 5.331x speedup, step: 71
Epoch 71/200 |loss: 8.082836| train set 5.254x speedup, test set 0.929x speedup, val set 5.267x speedup, step: 72
Epoch 72/200 |loss: 8.790849| train set 5.305x speedup, test set 0.918x speedup, val set 5.334x speedup, step: 73
Epoch 73/200 |loss: 9.096714| train set 5.305x speedup, test set 0.929x speedup, val set 5.334x speedup, step: 74
Epoch 74/200 |loss: 8.458547| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 75
Epoch 75/200 |loss: 8.336844| train set 5.297x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 76
Epoch 76/200 |loss: 8.573484| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 77
Epoch 77/200 |loss: 7.936802| train set 5.252x speedup, test set 0.906x speedup, val set 5.270x speedup, step: 78
Epoch 78/200 |loss: 8.279275| train set 5.297x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 79
Epoch 79/200 |loss: 8.406623| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 80
Epoch 80/200 |loss: 8.014750| train set 5.254x speedup, test set 0.906x speedup, val set 5.267x speedup, step: 81
Epoch 81/200 |loss: 8.431301| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 82
Epoch 82/200 |loss: 8.224670| train set 5.308x speedup, test set 0.926x speedup, val set 5.330x speedup, step: 83
Epoch 83/200 |loss: 8.155102| train set 5.252x speedup, test set 0.930x speedup, val set 5.260x speedup, step: 84
Epoch 84/200 |loss: 8.138978| train set 5.305x speedup, test set 0.906x speedup, val set 5.323x speedup, step: 85
Epoch 85/200 |loss: 7.859652| train set 5.295x speedup, test set 0.926x speedup, val set 5.321x speedup, step: 86
Epoch 86/200 |loss: 8.070170| train set 5.305x speedup, test set 0.926x speedup, val set 5.334x speedup, step: 87
Epoch 87/200 |loss: 7.635295| train set 5.254x speedup, test set 0.930x speedup, val set 5.267x speedup, step: 88
Epoch 88/200 |loss: 7.886124| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 89
Epoch 89/200 |loss: 7.648058| train set 5.297x speedup, test set 0.932x speedup, val set 5.317x speedup, step: 90
Epoch 90/200 |loss: 7.697807| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 91
Epoch 91/200 |loss: 7.603597| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 92
Epoch 92/200 |loss: 7.544554| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 93
Epoch 93/200 |loss: 7.550110| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 94
Epoch 94/200 |loss: 7.477086| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 95
Epoch 95/200 |loss: 7.465850| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 96
Epoch 96/200 |loss: 7.556166| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 97
Epoch 97/200 |loss: 7.465710| train set 5.305x speedup, test set 0.932x speedup, val set 5.323x speedup, step: 98
Epoch 98/200 |loss: 7.600015| train set 5.254x speedup, test set 0.954x speedup, val set 5.267x speedup, step: 99
Epoch 99/200 |loss: 7.442780| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 100
Epoch 100/200 |loss: 7.455827| train set 5.254x speedup, test set 0.960x speedup, val set 5.267x speedup, step: 1
Epoch 101/200 |loss: 7.314482| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 1
Epoch 102/200 |loss: 7.272635| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 2
Epoch 103/200 |loss: 7.256506| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 3
Epoch 104/200 |loss: 7.289097| train set 5.297x speedup, test set 0.932x speedup, val set 5.317x speedup, step: 4
Epoch 105/200 |loss: 7.354950| train set 5.252x speedup, test set 0.960x speedup, val set 5.270x speedup, step: 5
Epoch 106/200 |loss: 7.437351| train set 5.297x speedup, test set 0.932x speedup, val set 5.317x speedup, step: 6
Epoch 107/200 |loss: 7.694647| train set 5.252x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 7
Epoch 108/200 |loss: 7.383269| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 8
Epoch 109/200 |loss: 7.246343| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 9
Epoch 110/200 |loss: 7.206967| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 10
Epoch 111/200 |loss: 7.363246| train set 5.295x speedup, test set 0.932x speedup, val set 5.321x speedup, step: 11
Epoch 112/200 |loss: 7.676671| train set 5.305x speedup, test set 0.960x speedup, val set 5.334x speedup, step: 1
Epoch 113/200 |loss: 7.271338| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 2
Epoch 114/200 |loss: 7.332067| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 3
Epoch 115/200 |loss: 7.483841| train set 5.254x speedup, test set 0.960x speedup, val set 5.271x speedup, step: 4
Epoch 116/200 |loss: 7.525640| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 5
Epoch 117/200 |loss: 7.438483| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 6
Epoch 118/200 |loss: 7.272757| train set 5.252x speedup, test set 0.960x speedup, val set 5.270x speedup, step: 7
Epoch 119/200 |loss: 7.537114| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 8
Epoch 120/200 |loss: 7.499591| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 9
Epoch 121/200 |loss: 7.357097| train set 5.252x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 10
Epoch 122/200 |loss: 7.418311| train set 5.297x speedup, test set 0.932x speedup, val set 5.317x speedup, step: 11
Epoch 123/200 |loss: 7.440731| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 12
Epoch 124/200 |loss: 7.279134| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 13
Epoch 125/200 |loss: 7.588698| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 14
Epoch 126/200 |loss: 7.494788| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 15
Epoch 127/200 |loss: 7.355398| train set 5.310x speedup, test set 0.932x speedup, val set 5.331x speedup, step: 16
Epoch 128/200 |loss: 7.446946| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 17
Epoch 129/200 |loss: 7.450178| train set 5.254x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 18
Epoch 130/200 |loss: 7.291908| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 1
Epoch 131/200 |loss: 7.426228| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 2
Epoch 132/200 |loss: 7.274272| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 3
Epoch 133/200 |loss: 7.297504| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 4
Epoch 134/200 |loss: 7.295557| train set 5.297x speedup, test set 0.930x speedup, val set 5.317x speedup, step: 5
Epoch 135/200 |loss: 7.206925| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 6
Epoch 136/200 |loss: 7.201175| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 7
Epoch 137/200 |loss: 7.207632| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 8
Epoch 138/200 |loss: 7.125117| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 9
Epoch 139/200 |loss: 7.129997| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 10
Epoch 140/200 |loss: 7.134428| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 11
Epoch 141/200 |loss: 7.074112| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 12
Epoch 142/200 |loss: 7.107814| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 13
Epoch 143/200 |loss: 7.072220| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 14
Epoch 144/200 |loss: 7.126276| train set 5.257x speedup, test set 0.930x speedup, val set 5.267x speedup, step: 15
Epoch 145/200 |loss: 7.175015| train set 5.297x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 16
Epoch 146/200 |loss: 7.656192| train set 5.257x speedup, test set 0.930x speedup, val set 5.267x speedup, step: 17
Epoch 147/200 |loss: 7.327210| train set 5.305x speedup, test set 0.930x speedup, val set 5.334x speedup, step: 1
Epoch 148/200 |loss: 7.231265| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 2
Epoch 149/200 |loss: 7.120652| train set 5.254x speedup, test set 0.930x speedup, val set 5.267x speedup, step: 3
Epoch 150/200 |loss: 7.243013| train set 5.295x speedup, test set 0.930x speedup, val set 5.310x speedup, step: 4
Epoch 151/200 |loss: 7.268727| train set 5.305x speedup, test set 0.930x speedup, val set 5.334x speedup, step: 1
Epoch 152/200 |loss: 7.146093| train set 5.310x speedup, test set 0.930x speedup, val set 5.331x speedup, step: 2
Epoch 153/200 |loss: 7.161944| train set 5.297x speedup, test set 0.930x speedup, val set 5.317x speedup, step: 3
Epoch 154/200 |loss: 7.188346| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 4
Epoch 155/200 |loss: 7.119099| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 5
Epoch 156/200 |loss: 7.257697| train set 5.297x speedup, test set 0.957x speedup, val set 5.317x speedup, step: 6
Epoch 157/200 |loss: 7.158894| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 7
Epoch 158/200 |loss: 7.093092| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 8
Epoch 159/200 |loss: 7.311070| train set 5.305x speedup, test set 0.929x speedup, val set 5.334x speedup, step: 1
Epoch 160/200 |loss: 7.110342| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 2
Epoch 161/200 |loss: 7.128214| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 3
Epoch 162/200 |loss: 7.430988| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 4
Epoch 163/200 |loss: 7.127407| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 5
Epoch 164/200 |loss: 7.338831| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 6
Epoch 165/200 |loss: 7.771019| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 7
Epoch 166/200 |loss: 7.195194| train set 5.308x speedup, test set 0.952x speedup, val set 5.334x speedup, step: 1
Epoch 167/200 |loss: 7.654098| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 2
Epoch 168/200 |loss: 7.230825| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 3
Epoch 169/200 |loss: 7.324418| train set 5.305x speedup, test set 0.929x speedup, val set 5.334x speedup, step: 4
Epoch 170/200 |loss: 7.264207| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 5
Epoch 171/200 |loss: 7.226189| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 6
Epoch 172/200 |loss: 7.269813| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 7
Epoch 173/200 |loss: 7.082620| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 8
Epoch 174/200 |loss: 7.258786| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 9
Epoch 175/200 |loss: 7.068929| train set 5.308x speedup, test set 0.960x speedup, val set 5.330x speedup, step: 10
Epoch 176/200 |loss: 7.158636| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 11
Epoch 177/200 |loss: 7.064975| train set 5.306x speedup, test set 0.932x speedup, val set 5.331x speedup, step: 12
Epoch 178/200 |loss: 7.101149| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 13
Epoch 179/200 |loss: 7.123523| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 14
Epoch 180/200 |loss: 7.026163| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 15
Epoch 181/200 |loss: 7.128076| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 16
Epoch 182/200 |loss: 7.039924| train set 5.252x speedup, test set 0.932x speedup, val set 5.270x speedup, step: 17
Epoch 183/200 |loss: 7.092705| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 18
Epoch 184/200 |loss: 7.060672| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 19
Epoch 185/200 |loss: 6.977838| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 20
Epoch 186/200 |loss: 7.021660| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 21
Epoch 187/200 |loss: 7.043665| train set 5.254x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 22
Epoch 188/200 |loss: 7.035366| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 23
Epoch 189/200 |loss: 7.145957| train set 5.309x speedup, test set 0.932x speedup, val set 5.340x speedup, step: 1
Epoch 190/200 |loss: 6.971529| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 2
Epoch 191/200 |loss: 7.069590| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 3
Epoch 192/200 |loss: 7.204522| train set 5.257x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 4
Epoch 193/200 |loss: 7.059816| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 5
Epoch 194/200 |loss: 7.364837| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 6
Epoch 195/200 |loss: 7.149482| train set 5.257x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 7
Epoch 196/200 |loss: 7.323306| train set 5.297x speedup, test set 0.924x speedup, val set 5.317x speedup, step: 8
Epoch 197/200 |loss: 7.530759| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 9
Epoch 198/200 |loss: 7.125772| train set 5.257x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 10
Epoch 199/200 |loss: 7.545357| train set 5.305x speedup, test set 0.929x speedup, val set 5.334x speedup, step: 11
Training per epoch cost 0.263 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.354s, pg runtime 0.354s, speedup 1.000x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.065s, pg runtime 0.086s, speedup 1.315x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 127, train speedup 5.310, test speedup 0.932, val speedup 5.331
best test speedup epoch: 14, train speedup 4.053, test speedup 2.956, val speedup 3.957
best validation speedup epoch: 189, train speedup 5.309, test speedup 0.932, val speedup 5.340
last model at epoch 199, train speedup 5.305, test speedup 0.929, val speedup 5.334
execution cost 0:02:39.929622
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.993107, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700632| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238359| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770414| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246290| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733976| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232393| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741789| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239250| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794756| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324339| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872940| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.360317| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.858036| train set 4.121x speedup, test set 2.657x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349745| train set 4.053x speedup, test set 2.968x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.855879| train set 4.053x speedup, test set 2.392x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.396091| train set 4.053x speedup, test set 2.402x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.940338| train set 4.402x speedup, test set 2.431x speedup, val set 4.269x speedup, step: 18
Epoch 18/200 |loss: 15.482618| train set 4.456x speedup, test set 2.509x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.089900| train set 4.566x speedup, test set 2.410x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.716637| train set 4.699x speedup, test set 2.439x speedup, val set 4.648x speedup, step: 21
Epoch 21/200 |loss: 14.277409| train set 4.872x speedup, test set 2.279x speedup, val set 4.846x speedup, step: 22
Epoch 22/200 |loss: 13.831517| train set 5.108x speedup, test set 2.349x speedup, val set 5.104x speedup, step: 23
Epoch 23/200 |loss: 13.415505| train set 5.098x speedup, test set 2.273x speedup, val set 5.092x speedup, step: 24
Epoch 24/200 |loss: 13.004754| train set 5.090x speedup, test set 0.998x speedup, val set 5.102x speedup, step: 25
Epoch 25/200 |loss: 12.639457| train set 5.273x speedup, test set 0.980x speedup, val set 5.297x speedup, step: 26
Epoch 26/200 |loss: 12.434326| train set 5.207x speedup, test set 0.998x speedup, val set 5.224x speedup, step: 27
Epoch 27/200 |loss: 12.898565| train set 5.080x speedup, test set 0.981x speedup, val set 5.090x speedup, step: 28
Epoch 28/200 |loss: 13.139606| train set 5.295x speedup, test set 0.983x speedup, val set 5.323x speedup, step: 29
Epoch 29/200 |loss: 11.653055| train set 5.229x speedup, test set 0.972x speedup, val set 5.252x speedup, step: 30
Epoch 30/200 |loss: 12.525725| train set 5.305x speedup, test set 0.960x speedup, val set 5.336x speedup, step: 31
Epoch 31/200 |loss: 11.121848| train set 5.273x speedup, test set 0.981x speedup, val set 5.297x speedup, step: 32
Epoch 32/200 |loss: 11.704229| train set 5.284x speedup, test set 0.985x speedup, val set 5.310x speedup, step: 33
Epoch 33/200 |loss: 10.802814| train set 5.294x speedup, test set 0.961x speedup, val set 5.321x speedup, step: 34
Epoch 34/200 |loss: 11.029635| train set 5.229x speedup, test set 0.961x speedup, val set 5.262x speedup, step: 35
Epoch 35/200 |loss: 10.471581| train set 5.305x speedup, test set 0.961x speedup, val set 5.326x speedup, step: 36
Epoch 36/200 |loss: 10.512725| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 37
Epoch 37/200 |loss: 10.240466| train set 5.295x speedup, test set 0.961x speedup, val set 5.323x speedup, step: 38
Epoch 38/200 |loss: 10.157155| train set 5.306x speedup, test set 0.948x speedup, val set 5.336x speedup, step: 39
Epoch 39/200 |loss: 9.856327| train set 5.308x speedup, test set 0.948x speedup, val set 5.332x speedup, step: 40
Epoch 40/200 |loss: 9.691859| train set 5.308x speedup, test set 0.961x speedup, val set 5.332x speedup, step: 41
Epoch 41/200 |loss: 9.640056| train set 5.308x speedup, test set 0.960x speedup, val set 5.332x speedup, step: 42
Epoch 42/200 |loss: 9.510968| train set 5.306x speedup, test set 0.973x speedup, val set 5.336x speedup, step: 43
Epoch 43/200 |loss: 9.664933| train set 5.305x speedup, test set 0.842x speedup, val set 5.326x speedup, step: 44
Epoch 44/200 |loss: 9.550478| train set 5.306x speedup, test set 0.960x speedup, val set 5.336x speedup, step: 45
Epoch 45/200 |loss: 9.439916| train set 5.308x speedup, test set 0.852x speedup, val set 5.332x speedup, step: 46
Epoch 46/200 |loss: 9.280363| train set 5.308x speedup, test set 0.849x speedup, val set 5.332x speedup, step: 47
Epoch 47/200 |loss: 9.079403| train set 5.306x speedup, test set 0.838x speedup, val set 5.336x speedup, step: 48
Epoch 48/200 |loss: 8.855193| train set 5.307x speedup, test set 0.828x speedup, val set 5.329x speedup, step: 49
Epoch 49/200 |loss: 8.890812| train set 5.306x speedup, test set 0.929x speedup, val set 5.336x speedup, step: 50
Epoch 50/200 |loss: 8.844987| train set 5.308x speedup, test set 0.970x speedup, val set 5.332x speedup, step: 51
Epoch 51/200 |loss: 8.764529| train set 5.308x speedup, test set 0.957x speedup, val set 5.332x speedup, step: 52
Epoch 52/200 |loss: 8.523393| train set 5.306x speedup, test set 0.952x speedup, val set 5.336x speedup, step: 53
Epoch 53/200 |loss: 8.630136| train set 5.308x speedup, test set 0.917x speedup, val set 5.332x speedup, step: 54
Epoch 54/200 |loss: 8.583554| train set 5.308x speedup, test set 0.905x speedup, val set 5.332x speedup, step: 55
Epoch 55/200 |loss: 8.440034| train set 5.305x speedup, test set 0.905x speedup, val set 5.334x speedup, step: 56
Epoch 56/200 |loss: 8.491879| train set 5.297x speedup, test set 0.905x speedup, val set 5.317x speedup, step: 57
Epoch 57/200 |loss: 8.427459| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 58
Epoch 58/200 |loss: 8.319163| train set 5.305x speedup, test set 0.905x speedup, val set 5.334x speedup, step: 59
Epoch 59/200 |loss: 8.205266| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 60
Epoch 60/200 |loss: 8.184093| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 61
Epoch 61/200 |loss: 8.170906| train set 5.252x speedup, test set 0.905x speedup, val set 5.260x speedup, step: 62
Epoch 62/200 |loss: 8.075940| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 63
Epoch 63/200 |loss: 7.878741| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 64
Epoch 64/200 |loss: 7.900262| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 65
Epoch 65/200 |loss: 7.892002| train set 5.305x speedup, test set 0.905x speedup, val set 5.334x speedup, step: 66
Epoch 66/200 |loss: 7.811346| train set 5.297x speedup, test set 0.905x speedup, val set 5.317x speedup, step: 67
Epoch 67/200 |loss: 7.907689| train set 5.252x speedup, test set 0.905x speedup, val set 5.270x speedup, step: 68
Epoch 68/200 |loss: 8.393323| train set 5.297x speedup, test set 0.897x speedup, val set 5.317x speedup, step: 69
Epoch 69/200 |loss: 9.529699| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 70
Epoch 70/200 |loss: 8.782680| train set 5.252x speedup, test set 0.905x speedup, val set 5.270x speedup, step: 71
Epoch 71/200 |loss: 9.306859| train set 5.308x speedup, test set 0.895x speedup, val set 5.330x speedup, step: 72
Epoch 72/200 |loss: 8.905993| train set 5.305x speedup, test set 0.824x speedup, val set 5.323x speedup, step: 73
Epoch 73/200 |loss: 8.869198| train set 5.305x speedup, test set 0.815x speedup, val set 5.323x speedup, step: 74
Epoch 74/200 |loss: 8.337536| train set 5.305x speedup, test set 0.905x speedup, val set 5.334x speedup, step: 75
Epoch 75/200 |loss: 8.412074| train set 5.252x speedup, test set 0.905x speedup, val set 5.270x speedup, step: 76
Epoch 76/200 |loss: 8.363529| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 77
Epoch 77/200 |loss: 8.084041| train set 5.308x speedup, test set 0.928x speedup, val set 5.330x speedup, step: 78
Epoch 78/200 |loss: 8.254336| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 79
Epoch 79/200 |loss: 7.938799| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 80
Epoch 80/200 |loss: 8.033062| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 81
Epoch 81/200 |loss: 7.855181| train set 5.308x speedup, test set 0.907x speedup, val set 5.332x speedup, step: 82
Epoch 82/200 |loss: 7.862978| train set 5.308x speedup, test set 0.931x speedup, val set 5.332x speedup, step: 83
Epoch 83/200 |loss: 7.743880| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 84
Epoch 84/200 |loss: 7.771746| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 85
Epoch 85/200 |loss: 7.690769| train set 5.307x speedup, test set 0.930x speedup, val set 5.333x speedup, step: 86
Epoch 86/200 |loss: 7.650919| train set 5.306x speedup, test set 0.930x speedup, val set 5.336x speedup, step: 87
Epoch 87/200 |loss: 7.602459| train set 5.308x speedup, test set 0.929x speedup, val set 5.332x speedup, step: 88
Epoch 88/200 |loss: 7.573292| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 89
Epoch 89/200 |loss: 7.577213| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 90
Epoch 90/200 |loss: 7.550404| train set 5.295x speedup, test set 0.930x speedup, val set 5.321x speedup, step: 91
Epoch 91/200 |loss: 7.692387| train set 5.254x speedup, test set 0.929x speedup, val set 5.267x speedup, step: 92
Epoch 92/200 |loss: 8.486739| train set 5.305x speedup, test set 0.929x speedup, val set 5.334x speedup, step: 93
Epoch 93/200 |loss: 9.013974| train set 5.254x speedup, test set 0.929x speedup, val set 5.267x speedup, step: 94
Epoch 94/200 |loss: 8.013355| train set 5.308x speedup, test set 0.929x speedup, val set 5.330x speedup, step: 95
Epoch 95/200 |loss: 8.095949| train set 5.194x speedup, test set 0.918x speedup, val set 5.212x speedup, step: 96
Epoch 96/200 |loss: 8.216672| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 97
Epoch 97/200 |loss: 7.650623| train set 5.252x speedup, test set 0.929x speedup, val set 5.270x speedup, step: 98
Epoch 98/200 |loss: 7.892421| train set 5.305x speedup, test set 0.929x speedup, val set 5.334x speedup, step: 99
Epoch 99/200 |loss: 7.750691| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 100
Epoch 100/200 |loss: 7.664416| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 1
Epoch 101/200 |loss: 7.815196| train set 5.297x speedup, test set 0.929x speedup, val set 5.317x speedup, step: 2
Epoch 102/200 |loss: 7.552913| train set 5.297x speedup, test set 0.932x speedup, val set 5.317x speedup, step: 3
Epoch 103/200 |loss: 7.839085| train set 5.297x speedup, test set 0.930x speedup, val set 5.317x speedup, step: 4
Epoch 104/200 |loss: 7.566520| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 1
Epoch 105/200 |loss: 7.550375| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 1
Epoch 106/200 |loss: 7.472763| train set 5.297x speedup, test set 0.932x speedup, val set 5.317x speedup, step: 2
Epoch 107/200 |loss: 7.443134| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 3
Epoch 108/200 |loss: 7.485180| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 4
Epoch 109/200 |loss: 7.398697| train set 5.306x speedup, test set 0.932x speedup, val set 5.331x speedup, step: 5
Epoch 110/200 |loss: 7.393806| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 1
Epoch 111/200 |loss: 7.355284| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 2
Epoch 112/200 |loss: 7.259181| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 3
Epoch 113/200 |loss: 7.300453| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 4
Epoch 114/200 |loss: 7.244360| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 5
Epoch 115/200 |loss: 7.267253| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 6
Epoch 116/200 |loss: 7.344233| train set 5.257x speedup, test set 0.932x speedup, val set 5.267x speedup, step: 7
Epoch 117/200 |loss: 7.514357| train set 5.297x speedup, test set 0.921x speedup, val set 5.317x speedup, step: 8
Epoch 118/200 |loss: 8.184210| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 9
Epoch 119/200 |loss: 7.372630| train set 5.257x speedup, test set 0.936x speedup, val set 5.267x speedup, step: 10
Epoch 120/200 |loss: 7.981163| train set 5.297x speedup, test set 0.919x speedup, val set 5.317x speedup, step: 11
Epoch 121/200 |loss: 8.689847| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 12
Epoch 122/200 |loss: 8.233682| train set 5.252x speedup, test set 0.906x speedup, val set 5.270x speedup, step: 13
Epoch 123/200 |loss: 8.139387| train set 5.254x speedup, test set 0.897x speedup, val set 5.267x speedup, step: 14
Epoch 124/200 |loss: 8.076123| train set 5.297x speedup, test set 0.919x speedup, val set 5.317x speedup, step: 15
Epoch 125/200 |loss: 7.902360| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 16
Epoch 126/200 |loss: 7.798241| train set 5.309x speedup, test set 0.931x speedup, val set 5.337x speedup, step: 1
Epoch 127/200 |loss: 7.675569| train set 5.307x speedup, test set 0.932x speedup, val set 5.337x speedup, step: 2
Epoch 128/200 |loss: 7.675556| train set 5.296x speedup, test set 0.932x speedup, val set 5.326x speedup, step: 3
Epoch 129/200 |loss: 7.623649| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 4
Epoch 130/200 |loss: 7.489097| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 5
Epoch 131/200 |loss: 7.576974| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 6
Epoch 132/200 |loss: 7.433850| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 7
Epoch 133/200 |loss: 7.432072| train set 5.308x speedup, test set 0.932x speedup, val set 5.332x speedup, step: 8
Epoch 134/200 |loss: 7.369579| train set 5.308x speedup, test set 0.932x speedup, val set 5.332x speedup, step: 9
Epoch 135/200 |loss: 7.334730| train set 5.305x speedup, test set 0.932x speedup, val set 5.334x speedup, step: 10
Epoch 136/200 |loss: 7.328888| train set 5.296x speedup, test set 0.932x speedup, val set 5.318x speedup, step: 11
Epoch 137/200 |loss: 7.258721| train set 5.297x speedup, test set 0.932x speedup, val set 5.317x speedup, step: 12
Epoch 138/200 |loss: 7.277131| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 13
Epoch 139/200 |loss: 7.219141| train set 5.308x speedup, test set 0.932x speedup, val set 5.330x speedup, step: 14
Epoch 140/200 |loss: 7.223101| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 15
Epoch 141/200 |loss: 7.186260| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 16
Epoch 142/200 |loss: 7.175247| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 17
Epoch 143/200 |loss: 7.160605| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 18
Epoch 144/200 |loss: 7.138585| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 19
Epoch 145/200 |loss: 7.117538| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 20
Epoch 146/200 |loss: 7.127131| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 21
Epoch 147/200 |loss: 7.145118| train set 5.308x speedup, test set 0.930x speedup, val set 5.330x speedup, step: 22
Epoch 148/200 |loss: 7.238954| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 23
Epoch 149/200 |loss: 7.257447| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 24
Epoch 150/200 |loss: 7.460711| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 25
Epoch 151/200 |loss: 7.251224| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 26
Epoch 152/200 |loss: 7.103951| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 27
Epoch 153/200 |loss: 7.075318| train set 5.307x speedup, test set 0.926x speedup, val set 5.331x speedup, step: 28
Epoch 154/200 |loss: 7.110788| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 29
Epoch 155/200 |loss: 7.212528| train set 5.308x speedup, test set 0.926x speedup, val set 5.330x speedup, step: 30
Epoch 156/200 |loss: 7.171369| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 31
Epoch 157/200 |loss: 7.181512| train set 5.305x speedup, test set 0.931x speedup, val set 5.331x speedup, step: 32
Epoch 158/200 |loss: 7.064112| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 33
Epoch 159/200 |loss: 7.044589| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 34
Epoch 160/200 |loss: 7.245966| train set 5.306x speedup, test set 0.926x speedup, val set 5.331x speedup, step: 35
Epoch 161/200 |loss: 7.289280| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 36
Epoch 162/200 |loss: 7.313106| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 37
Epoch 163/200 |loss: 7.037707| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 38
Epoch 164/200 |loss: 7.324419| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 39
Epoch 165/200 |loss: 7.710637| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 40
Epoch 166/200 |loss: 7.182895| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 41
Epoch 167/200 |loss: 7.705054| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 42
Epoch 168/200 |loss: 7.450881| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 43
Epoch 169/200 |loss: 7.316875| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 44
Epoch 170/200 |loss: 7.375210| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 45
Epoch 171/200 |loss: 7.157624| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 46
Epoch 172/200 |loss: 7.353433| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 47
Epoch 173/200 |loss: 7.154148| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 48
Epoch 174/200 |loss: 7.264618| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 49
Epoch 175/200 |loss: 7.115417| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 50
Epoch 176/200 |loss: 7.202445| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 51
Epoch 177/200 |loss: 7.077475| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 52
Epoch 178/200 |loss: 7.170029| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 53
Epoch 179/200 |loss: 7.065347| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 54
Epoch 180/200 |loss: 7.110175| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 55
Epoch 181/200 |loss: 7.067166| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 56
Epoch 182/200 |loss: 7.058534| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 57
Epoch 183/200 |loss: 7.042655| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 58
Epoch 184/200 |loss: 7.033130| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 59
Epoch 185/200 |loss: 7.014177| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 60
Epoch 186/200 |loss: 7.034034| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 61
Epoch 187/200 |loss: 6.992154| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 62
Epoch 188/200 |loss: 7.030652| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 63
Epoch 189/200 |loss: 7.008785| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 64
Epoch 190/200 |loss: 6.968812| train set 5.307x speedup, test set 0.931x speedup, val set 5.331x speedup, step: 65
Epoch 191/200 |loss: 6.995637| train set 5.256x speedup, test set 0.931x speedup, val set 5.276x speedup, step: 66
Epoch 192/200 |loss: 7.030126| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 67
Epoch 193/200 |loss: 7.063687| train set 5.257x speedup, test set 0.931x speedup, val set 5.267x speedup, step: 68
Epoch 194/200 |loss: 7.367558| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 69
Epoch 195/200 |loss: 8.756799| train set 5.308x speedup, test set 0.931x speedup, val set 5.330x speedup, step: 70
Epoch 196/200 |loss: 7.633751| train set 5.254x speedup, test set 0.907x speedup, val set 5.271x speedup, step: 71
Epoch 197/200 |loss: 8.698100| train set 5.121x speedup, test set 0.920x speedup, val set 5.111x speedup, step: 72
Epoch 198/200 |loss: 8.233796| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 73
Epoch 199/200 |loss: 7.880628| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 74
Training per epoch cost 0.263 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.354s, pg runtime 0.354s, speedup 1.000x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.065s, pg runtime 0.086s, speedup 1.315x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.433s, pg runtime 0.389s, speedup 0.898x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 126, train speedup 5.309, test speedup 0.931, val speedup 5.337
best test speedup epoch: 14, train speedup 4.053, test speedup 2.968, val speedup 3.957
best validation speedup epoch: 126, train speedup 5.309, test speedup 0.931, val speedup 5.337
last model at epoch 199, train speedup 5.252, test speedup 0.907, val speedup 5.270
execution cost 0:02:38.154725
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.974552, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700630| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238358| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770412| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246290| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733976| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232391| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741787| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239250| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794754| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324333| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872925| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.359957| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.857153| train set 4.121x speedup, test set 2.655x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349062| train set 4.053x speedup, test set 2.956x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.846962| train set 4.053x speedup, test set 2.400x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.393074| train set 4.053x speedup, test set 2.412x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.944828| train set 4.456x speedup, test set 2.431x speedup, val set 4.318x speedup, step: 18
Epoch 18/200 |loss: 15.498789| train set 4.456x speedup, test set 2.503x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.094980| train set 4.566x speedup, test set 2.280x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.729635| train set 4.716x speedup, test set 2.439x speedup, val set 4.627x speedup, step: 21
Epoch 21/200 |loss: 14.351863| train set 5.004x speedup, test set 2.280x speedup, val set 4.997x speedup, step: 22
Epoch 22/200 |loss: 13.857100| train set 5.037x speedup, test set 2.350x speedup, val set 5.036x speedup, step: 23
Epoch 23/200 |loss: 13.435806| train set 5.056x speedup, test set 2.461x speedup, val set 5.063x speedup, step: 24
Epoch 24/200 |loss: 13.115673| train set 5.038x speedup, test set 0.998x speedup, val set 5.036x speedup, step: 25
Epoch 25/200 |loss: 12.941271| train set 5.080x speedup, test set 0.984x speedup, val set 5.090x speedup, step: 26
Epoch 26/200 |loss: 12.931025| train set 5.283x speedup, test set 0.998x speedup, val set 5.308x speedup, step: 27
Epoch 27/200 |loss: 12.327441| train set 5.274x speedup, test set 0.997x speedup, val set 5.297x speedup, step: 28
Epoch 28/200 |loss: 11.856927| train set 5.272x speedup, test set 0.985x speedup, val set 5.286x speedup, step: 29
Epoch 29/200 |loss: 11.772596| train set 5.208x speedup, test set 0.998x speedup, val set 5.226x speedup, step: 30
Epoch 30/200 |loss: 11.520096| train set 5.274x speedup, test set 0.954x speedup, val set 5.297x speedup, step: 31
Epoch 31/200 |loss: 11.677051| train set 5.295x speedup, test set 0.981x speedup, val set 5.321x speedup, step: 32
Epoch 32/200 |loss: 11.467378| train set 5.304x speedup, test set 0.960x speedup, val set 5.323x speedup, step: 33
Epoch 33/200 |loss: 11.712075| train set 5.306x speedup, test set 0.958x speedup, val set 5.336x speedup, step: 34
Epoch 34/200 |loss: 10.606803| train set 5.294x speedup, test set 0.847x speedup, val set 5.323x speedup, step: 35
Epoch 35/200 |loss: 10.841499| train set 5.295x speedup, test set 0.847x speedup, val set 5.313x speedup, step: 36
Epoch 36/200 |loss: 10.372684| train set 5.305x speedup, test set 0.961x speedup, val set 5.326x speedup, step: 37
Epoch 37/200 |loss: 10.345062| train set 5.308x speedup, test set 0.961x speedup, val set 5.332x speedup, step: 38
Epoch 38/200 |loss: 9.950236| train set 5.307x speedup, test set 0.850x speedup, val set 5.333x speedup, step: 39
Epoch 39/200 |loss: 10.116750| train set 5.306x speedup, test set 0.958x speedup, val set 5.336x speedup, step: 40
Epoch 40/200 |loss: 9.808775| train set 4.831x speedup, test set 0.945x speedup, val set 4.976x speedup, step: 41
Epoch 41/200 |loss: 9.614456| train set 4.833x speedup, test set 0.850x speedup, val set 4.982x speedup, step: 42
Epoch 42/200 |loss: 9.428813| train set 5.306x speedup, test set 0.852x speedup, val set 5.336x speedup, step: 43
Epoch 43/200 |loss: 9.448259| train set 5.306x speedup, test set 0.852x speedup, val set 5.336x speedup, step: 44
Epoch 44/200 |loss: 9.339108| train set 5.306x speedup, test set 0.961x speedup, val set 5.336x speedup, step: 45
Epoch 45/200 |loss: 9.248698| train set 5.308x speedup, test set 0.854x speedup, val set 5.332x speedup, step: 46
Epoch 46/200 |loss: 8.993296| train set 5.308x speedup, test set 0.839x speedup, val set 5.332x speedup, step: 47
Epoch 47/200 |loss: 9.056709| train set 5.308x speedup, test set 0.852x speedup, val set 5.332x speedup, step: 48
Epoch 48/200 |loss: 8.952610| train set 5.305x speedup, test set 0.923x speedup, val set 5.326x speedup, step: 49
Epoch 49/200 |loss: 8.846112| train set 5.308x speedup, test set 0.944x speedup, val set 5.323x speedup, step: 50
Epoch 50/200 |loss: 8.882792| train set 5.308x speedup, test set 0.821x speedup, val set 5.332x speedup, step: 51
Epoch 51/200 |loss: 8.903063| train set 5.306x speedup, test set 0.932x speedup, val set 5.336x speedup, step: 52
Epoch 52/200 |loss: 8.879036| train set 5.297x speedup, test set 0.830x speedup, val set 5.320x speedup, step: 53
Epoch 53/200 |loss: 8.912755| train set 5.306x speedup, test set 0.907x speedup, val set 5.336x speedup, step: 54
Epoch 54/200 |loss: 8.507092| train set 5.306x speedup, test set 0.907x speedup, val set 5.336x speedup, step: 55
Epoch 55/200 |loss: 8.424020| train set 5.297x speedup, test set 0.802x speedup, val set 5.320x speedup, step: 56
Epoch 56/200 |loss: 8.524847| train set 5.308x speedup, test set 0.931x speedup, val set 5.332x speedup, step: 57
Epoch 57/200 |loss: 8.348579| train set 5.308x speedup, test set 0.932x speedup, val set 5.332x speedup, step: 58
Epoch 58/200 |loss: 8.253834| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 59
Epoch 59/200 |loss: 8.191583| train set 5.305x speedup, test set 0.908x speedup, val set 5.334x speedup, step: 60
Epoch 60/200 |loss: 8.196649| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 61
Epoch 61/200 |loss: 8.178543| train set 5.305x speedup, test set 0.818x speedup, val set 5.331x speedup, step: 62
Epoch 62/200 |loss: 8.306295| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 63
Epoch 63/200 |loss: 8.348816| train set 5.297x speedup, test set 0.809x speedup, val set 5.317x speedup, step: 64
Epoch 64/200 |loss: 8.523296| train set 5.131x speedup, test set 0.802x speedup, val set 5.123x speedup, step: 65
Epoch 65/200 |loss: 8.450686| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 66
Epoch 66/200 |loss: 8.184625| train set 5.297x speedup, test set 0.809x speedup, val set 5.317x speedup, step: 67
Epoch 67/200 |loss: 8.369756| train set 5.308x speedup, test set 0.818x speedup, val set 5.330x speedup, step: 68
Epoch 68/200 |loss: 8.283096| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 69
Epoch 69/200 |loss: 8.129627| train set 5.295x speedup, test set 0.818x speedup, val set 5.310x speedup, step: 70
Epoch 70/200 |loss: 8.181738| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 71
Epoch 71/200 |loss: 8.040908| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 72
Epoch 72/200 |loss: 7.916425| train set 5.305x speedup, test set 0.802x speedup, val set 5.334x speedup, step: 73
Epoch 73/200 |loss: 7.958730| train set 5.305x speedup, test set 0.927x speedup, val set 5.334x speedup, step: 74
Epoch 74/200 |loss: 7.786115| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 75
Epoch 75/200 |loss: 7.794763| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 76
Epoch 76/200 |loss: 7.677098| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 77
Epoch 77/200 |loss: 7.740571| train set 5.308x speedup, test set 0.817x speedup, val set 5.330x speedup, step: 78
Epoch 78/200 |loss: 7.662746| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 79
Epoch 79/200 |loss: 7.723672| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 80
Epoch 80/200 |loss: 7.721296| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 81
Epoch 81/200 |loss: 7.740238| train set 5.297x speedup, test set 0.817x speedup, val set 5.317x speedup, step: 82
Epoch 82/200 |loss: 7.825027| train set 5.252x speedup, test set 0.927x speedup, val set 5.270x speedup, step: 83
Epoch 83/200 |loss: 7.705434| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 84
Epoch 84/200 |loss: 7.520158| train set 5.308x speedup, test set 0.817x speedup, val set 5.330x speedup, step: 85
Epoch 85/200 |loss: 7.665948| train set 5.254x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 86
Epoch 86/200 |loss: 7.811422| train set 5.295x speedup, test set 0.916x speedup, val set 5.321x speedup, step: 87
Epoch 87/200 |loss: 8.273000| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 88
Epoch 88/200 |loss: 7.820778| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 89
Epoch 89/200 |loss: 7.673992| train set 5.305x speedup, test set 0.809x speedup, val set 5.334x speedup, step: 90
Epoch 90/200 |loss: 8.050817| train set 5.252x speedup, test set 0.810x speedup, val set 5.270x speedup, step: 91
Epoch 91/200 |loss: 7.831932| train set 5.254x speedup, test set 0.818x speedup, val set 5.267x speedup, step: 92
Epoch 92/200 |loss: 7.713981| train set 5.297x speedup, test set 0.808x speedup, val set 5.317x speedup, step: 93
Epoch 93/200 |loss: 7.937593| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 94
Epoch 94/200 |loss: 7.543178| train set 5.254x speedup, test set 0.817x speedup, val set 5.267x speedup, step: 95
Epoch 95/200 |loss: 7.918356| train set 5.295x speedup, test set 0.809x speedup, val set 5.321x speedup, step: 96
Epoch 96/200 |loss: 7.838210| train set 5.305x speedup, test set 0.817x speedup, val set 5.334x speedup, step: 97
Epoch 97/200 |loss: 7.624097| train set 5.252x speedup, test set 0.826x speedup, val set 5.270x speedup, step: 98
Epoch 98/200 |loss: 7.847491| train set 5.310x speedup, test set 0.809x speedup, val set 5.317x speedup, step: 99
Epoch 99/200 |loss: 7.566770| train set 5.297x speedup, test set 0.809x speedup, val set 5.317x speedup, step: 100
Epoch 100/200 |loss: 7.586066| train set 5.254x speedup, test set 0.826x speedup, val set 5.267x speedup, step: 1
Epoch 101/200 |loss: 7.492548| train set 5.254x speedup, test set 0.826x speedup, val set 5.267x speedup, step: 1
Epoch 102/200 |loss: 7.457159| train set 5.305x speedup, test set 0.817x speedup, val set 5.334x speedup, step: 1
Epoch 103/200 |loss: 7.519655| train set 5.308x speedup, test set 0.817x speedup, val set 5.330x speedup, step: 2
Epoch 104/200 |loss: 7.372830| train set 5.254x speedup, test set 0.826x speedup, val set 5.267x speedup, step: 3
Epoch 105/200 |loss: 7.433839| train set 5.297x speedup, test set 0.826x speedup, val set 5.317x speedup, step: 4
Epoch 106/200 |loss: 7.347672| train set 5.297x speedup, test set 0.826x speedup, val set 5.317x speedup, step: 5
Epoch 107/200 |loss: 7.327537| train set 5.254x speedup, test set 0.826x speedup, val set 5.267x speedup, step: 6
Epoch 108/200 |loss: 7.340599| train set 5.305x speedup, test set 0.817x speedup, val set 5.334x speedup, step: 1
Epoch 109/200 |loss: 7.353735| train set 5.305x speedup, test set 0.927x speedup, val set 5.334x speedup, step: 1
Epoch 110/200 |loss: 7.266508| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 2
Epoch 111/200 |loss: 7.337012| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 3
Epoch 112/200 |loss: 7.224607| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 4
Epoch 113/200 |loss: 7.208035| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 5
Epoch 114/200 |loss: 7.220933| train set 5.297x speedup, test set 0.917x speedup, val set 5.317x speedup, step: 6
Epoch 115/200 |loss: 7.234874| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 7
Epoch 116/200 |loss: 7.179873| train set 5.308x speedup, test set 0.917x speedup, val set 5.330x speedup, step: 8
Epoch 117/200 |loss: 7.137994| train set 5.308x speedup, test set 0.917x speedup, val set 5.330x speedup, step: 9
Epoch 118/200 |loss: 7.145040| train set 5.254x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 10
Epoch 119/200 |loss: 7.206069| train set 5.308x speedup, test set 0.917x speedup, val set 5.330x speedup, step: 11
Epoch 120/200 |loss: 7.295329| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 12
Epoch 121/200 |loss: 7.702447| train set 5.308x speedup, test set 0.912x speedup, val set 5.334x speedup, step: 1
Epoch 122/200 |loss: 7.650946| train set 5.308x speedup, test set 0.927x speedup, val set 5.330x speedup, step: 2
Epoch 123/200 |loss: 8.047861| train set 5.254x speedup, test set 0.927x speedup, val set 5.267x speedup, step: 3
Epoch 124/200 |loss: 7.219417| train set 5.253x speedup, test set 0.927x speedup, val set 5.267x speedup, step: 4
Epoch 125/200 |loss: 7.893785| train set 5.295x speedup, test set 0.817x speedup, val set 5.310x speedup, step: 5
Epoch 126/200 |loss: 8.398467| train set 5.305x speedup, test set 0.927x speedup, val set 5.334x speedup, step: 6
Epoch 127/200 |loss: 7.663820| train set 5.254x speedup, test set 0.927x speedup, val set 5.271x speedup, step: 7
Epoch 128/200 |loss: 8.192736| train set 5.131x speedup, test set 0.817x speedup, val set 5.123x speedup, step: 8
Epoch 129/200 |loss: 7.682236| train set 5.308x speedup, test set 0.817x speedup, val set 5.330x speedup, step: 9
Epoch 130/200 |loss: 7.768187| train set 5.305x speedup, test set 0.826x speedup, val set 5.334x speedup, step: 10
Epoch 131/200 |loss: 7.646366| train set 5.305x speedup, test set 0.826x speedup, val set 5.334x speedup, step: 11
Epoch 132/200 |loss: 7.591189| train set 5.297x speedup, test set 0.826x speedup, val set 5.317x speedup, step: 12
Epoch 133/200 |loss: 7.603559| train set 5.308x speedup, test set 0.817x speedup, val set 5.330x speedup, step: 13
Epoch 134/200 |loss: 7.412696| train set 5.254x speedup, test set 0.810x speedup, val set 5.267x speedup, step: 14
Epoch 135/200 |loss: 7.604825| train set 5.295x speedup, test set 0.817x speedup, val set 5.321x speedup, step: 15
Epoch 136/200 |loss: 7.307450| train set 5.297x speedup, test set 0.817x speedup, val set 5.317x speedup, step: 16
Epoch 137/200 |loss: 7.467517| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 17
Epoch 138/200 |loss: 7.322026| train set 5.308x speedup, test set 0.917x speedup, val set 5.330x speedup, step: 18
Epoch 139/200 |loss: 7.352768| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 19
Epoch 140/200 |loss: 7.261294| train set 5.254x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 20
Epoch 141/200 |loss: 7.280411| train set 5.296x speedup, test set 0.927x speedup, val set 5.318x speedup, step: 21
Epoch 142/200 |loss: 7.272526| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 22
Epoch 143/200 |loss: 7.216703| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 23
Epoch 144/200 |loss: 7.186048| train set 5.308x speedup, test set 0.916x speedup, val set 5.330x speedup, step: 24
Epoch 145/200 |loss: 7.190196| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 25
Epoch 146/200 |loss: 7.199803| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 26
Epoch 147/200 |loss: 7.121410| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 27
Epoch 148/200 |loss: 7.124497| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 28
Epoch 149/200 |loss: 7.122989| train set 5.308x speedup, test set 0.917x speedup, val set 5.330x speedup, step: 29
Epoch 150/200 |loss: 7.113935| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 30
Epoch 151/200 |loss: 7.095802| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 31
Epoch 152/200 |loss: 7.059853| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 32
Epoch 153/200 |loss: 7.064268| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 33
Epoch 154/200 |loss: 7.069206| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 34
Epoch 155/200 |loss: 7.076540| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 35
Epoch 156/200 |loss: 7.082893| train set 5.308x speedup, test set 0.892x speedup, val set 5.330x speedup, step: 36
Epoch 157/200 |loss: 7.049630| train set 5.308x speedup, test set 0.892x speedup, val set 5.330x speedup, step: 37
Epoch 158/200 |loss: 7.079782| train set 5.257x speedup, test set 0.893x speedup, val set 5.267x speedup, step: 38
Epoch 159/200 |loss: 7.164391| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 39
Epoch 160/200 |loss: 7.618401| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 40
Epoch 161/200 |loss: 7.169590| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 41
Epoch 162/200 |loss: 7.141722| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 42
Epoch 163/200 |loss: 7.322145| train set 5.254x speedup, test set 0.903x speedup, val set 5.267x speedup, step: 43
Epoch 164/200 |loss: 7.201239| train set 5.305x speedup, test set 0.903x speedup, val set 5.334x speedup, step: 44
Epoch 165/200 |loss: 7.129587| train set 5.308x speedup, test set 0.923x speedup, val set 5.330x speedup, step: 45
Epoch 166/200 |loss: 7.251774| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 46
Epoch 167/200 |loss: 7.113827| train set 5.254x speedup, test set 0.903x speedup, val set 5.267x speedup, step: 47
Epoch 168/200 |loss: 7.152824| train set 5.297x speedup, test set 0.903x speedup, val set 5.317x speedup, step: 48
Epoch 169/200 |loss: 7.444843| train set 5.308x speedup, test set 0.903x speedup, val set 5.330x speedup, step: 49
Epoch 170/200 |loss: 7.132371| train set 5.257x speedup, test set 0.903x speedup, val set 5.267x speedup, step: 50
Epoch 171/200 |loss: 7.182695| train set 5.297x speedup, test set 0.902x speedup, val set 5.317x speedup, step: 51
Epoch 172/200 |loss: 7.443185| train set 5.308x speedup, test set 0.922x speedup, val set 5.330x speedup, step: 52
Epoch 173/200 |loss: 7.205338| train set 5.257x speedup, test set 0.903x speedup, val set 5.267x speedup, step: 53
Epoch 174/200 |loss: 7.269155| train set 5.305x speedup, test set 0.902x speedup, val set 5.323x speedup, step: 54
Epoch 175/200 |loss: 7.268388| train set 5.305x speedup, test set 0.922x speedup, val set 5.334x speedup, step: 55
Epoch 176/200 |loss: 7.288980| train set 5.252x speedup, test set 0.903x speedup, val set 5.267x speedup, step: 56
Epoch 177/200 |loss: 7.579887| train set 5.308x speedup, test set 0.922x speedup, val set 5.330x speedup, step: 57
Epoch 178/200 |loss: 7.121125| train set 5.297x speedup, test set 0.922x speedup, val set 5.317x speedup, step: 58
Epoch 179/200 |loss: 7.265712| train set 5.254x speedup, test set 0.902x speedup, val set 5.267x speedup, step: 59
Epoch 180/200 |loss: 7.577744| train set 5.305x speedup, test set 0.922x speedup, val set 5.334x speedup, step: 60
Epoch 181/200 |loss: 7.160157| train set 5.305x speedup, test set 0.922x speedup, val set 5.334x speedup, step: 61
Epoch 182/200 |loss: 7.363971| train set 5.254x speedup, test set 0.902x speedup, val set 5.267x speedup, step: 62
Epoch 183/200 |loss: 7.623416| train set 5.308x speedup, test set 0.902x speedup, val set 5.330x speedup, step: 63
Epoch 184/200 |loss: 7.233386| train set 5.305x speedup, test set 0.922x speedup, val set 5.334x speedup, step: 64
Epoch 185/200 |loss: 7.660918| train set 5.307x speedup, test set 0.902x speedup, val set 5.331x speedup, step: 65
Epoch 186/200 |loss: 7.341645| train set 5.254x speedup, test set 0.902x speedup, val set 5.267x speedup, step: 66
Epoch 187/200 |loss: 7.468035| train set 5.308x speedup, test set 0.922x speedup, val set 5.330x speedup, step: 67
Epoch 188/200 |loss: 7.213814| train set 5.308x speedup, test set 0.922x speedup, val set 5.330x speedup, step: 68
Epoch 189/200 |loss: 7.346782| train set 5.308x speedup, test set 0.902x speedup, val set 5.330x speedup, step: 69
Epoch 190/200 |loss: 7.268767| train set 5.305x speedup, test set 0.902x speedup, val set 5.323x speedup, step: 70
Epoch 191/200 |loss: 7.326318| train set 5.305x speedup, test set 0.922x speedup, val set 5.334x speedup, step: 71
Epoch 192/200 |loss: 7.146263| train set 5.308x speedup, test set 0.922x speedup, val set 5.330x speedup, step: 72
Epoch 193/200 |loss: 7.252587| train set 5.308x speedup, test set 0.922x speedup, val set 5.330x speedup, step: 73
Epoch 194/200 |loss: 7.158430| train set 5.308x speedup, test set 0.902x speedup, val set 5.330x speedup, step: 74
Epoch 195/200 |loss: 7.176050| train set 5.305x speedup, test set 0.922x speedup, val set 5.334x speedup, step: 75
Epoch 196/200 |loss: 7.156449| train set 5.308x speedup, test set 0.922x speedup, val set 5.330x speedup, step: 76
Epoch 197/200 |loss: 7.078530| train set 5.308x speedup, test set 0.922x speedup, val set 5.330x speedup, step: 77
Epoch 198/200 |loss: 7.125997| train set 5.308x speedup, test set 0.922x speedup, val set 5.330x speedup, step: 78
Epoch 199/200 |loss: 7.050233| train set 5.305x speedup, test set 0.902x speedup, val set 5.334x speedup, step: 79
Training per epoch cost 0.259 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.368s, pg runtime 0.348s, speedup 0.945x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.605s, pg runtime 10.605s, speedup 1.000x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.373s, pg runtime 0.354s, speedup 0.949x
18, opt runtime 2.599s, model runtime 3.004s, pg runtime 2.599s, speedup 0.865x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 5.159s, pg runtime 0.891s, speedup 0.173x
23, opt runtime 0.389s, model runtime 0.433s, pg runtime 0.389s, speedup 0.898x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 98, train speedup 5.310, test speedup 0.809, val speedup 5.317
best test speedup epoch: 14, train speedup 4.053, test speedup 2.956, val speedup 3.957
best validation speedup epoch: 121, train speedup 5.308, test speedup 0.912, val speedup 5.334
last model at epoch 199, train speedup 5.305, test speedup 0.902, val speedup 5.334
execution cost 0:02:36.394240
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 8, 9] [4, 2] [5 5]
[0, 1, 2, 7, 8, 9] [3, 5] [4 6]
[2, 3, 4, 6, 7, 8] [1, 9] [0 5]
[0, 2, 3, 4, 7, 9] [6, 1] [8 5]
[1, 2, 3, 4, 6, 7, 8] [5, 9] [0 0]
[1, 2, 3, 5, 6, 8] [9, 4] [7 0]
[2, 3, 4, 5, 6, 8] [0, 7] [9 1]
[0, 2, 3, 5, 6, 7] [8, 1] [4 9]
[0, 2, 3, 4, 5, 7] [6, 1] [9 8]
[0, 1, 3, 5, 6, 7, 9] [8, 4] [2 2]
[1, 2, 3, 4, 6, 7] [9, 5] [0 8]
[0, 1, 4, 5, 6, 7, 8] [9, 3] [2 2]
[3, 5, 6, 7, 8, 9] [1, 0] [2 4]
[0, 2, 5, 7, 8, 9] [3, 4] [6 1]
[0, 4, 5, 6, 7, 9] [1, 3] [8 2]
[2, 3, 5, 7, 8, 9] [1, 6] [0 4]
[1, 2, 3, 5, 6, 9] [4, 7] [8 0]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
[2, 3, 4, 6, 7, 8] [5, 9] [1 0]
[0, 1, 2, 5, 6, 7] [3, 4] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 3, 4, 5, 6, 9] [1, 2] [8 7]
[0, 1, 2, 4, 6, 7] [8, 3] [9 5]
[0, 1, 5, 6, 8, 9] [2, 7] [3 4]
[0, 1, 2, 3, 5, 8] [6, 4] [9 7]
[0, 1, 4, 5, 6, 7, 9] [8, 3] [2 2]
[2, 4, 6, 7, 8, 9] [5, 0] [1 3]
[1, 2, 4, 5, 7, 9] [3, 0] [6 8]
[0, 1, 3, 4, 8, 9] [5, 6] [7 2]
[2, 3, 5, 7, 8, 9] [4, 1] [0 6]
[0, 2, 4, 6, 7, 9] [3, 5] [1 8]
[0, 1, 2, 4, 5, 9] [3, 7] [8 6]
[0, 1, 3, 4, 5, 9] [6, 7] [8 2]
[1, 3, 5, 6, 7, 9] [2, 4] [0 8]
[0, 4, 5, 6, 7, 9] [2, 3] [8 1]
[0, 2, 4, 5, 6, 7] [8, 9] [1 3]
[0, 1, 3, 7, 8, 9] [4, 6] [5 2]
[0, 1, 2, 3, 4, 5] [9, 6] [7 8]
[1, 2, 4, 6, 7, 9] [5, 3] [8 0]
[0, 1, 3, 6, 7, 9] [2, 8] [4 5]
[0, 2, 3, 5, 6, 8] [7, 1] [9 4]
load TPCH Skew succ
train, test, validation (124, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.951770, and there are 124 training samples
in channel 9
Epoch 0/200 |loss: 24.350483| train set 2.981x speedup, test set 1.541x speedup, val set 2.886x speedup, step: 1
Epoch 1/200 |loss: 23.700630| train set 2.779x speedup, test set 1.910x speedup, val set 2.682x speedup, step: 2
Epoch 2/200 |loss: 23.238358| train set 3.572x speedup, test set 0.927x speedup, val set 3.374x speedup, step: 3
Epoch 3/200 |loss: 22.770412| train set 3.659x speedup, test set 0.951x speedup, val set 3.484x speedup, step: 4
Epoch 4/200 |loss: 22.246288| train set 3.890x speedup, test set 1.051x speedup, val set 3.718x speedup, step: 5
Epoch 5/200 |loss: 21.733976| train set 3.580x speedup, test set 1.088x speedup, val set 3.418x speedup, step: 6
Epoch 6/200 |loss: 21.232391| train set 3.840x speedup, test set 1.089x speedup, val set 3.695x speedup, step: 7
Epoch 7/200 |loss: 20.741787| train set 3.772x speedup, test set 2.401x speedup, val set 3.632x speedup, step: 8
Epoch 8/200 |loss: 20.239250| train set 4.241x speedup, test set 2.516x speedup, val set 4.119x speedup, step: 9
Epoch 9/200 |loss: 19.794754| train set 3.857x speedup, test set 1.873x speedup, val set 3.768x speedup, step: 10
Epoch 10/200 |loss: 19.324333| train set 3.728x speedup, test set 0.895x speedup, val set 3.640x speedup, step: 11
Epoch 11/200 |loss: 18.872925| train set 4.053x speedup, test set 2.324x speedup, val set 3.957x speedup, step: 12
Epoch 12/200 |loss: 18.359957| train set 4.053x speedup, test set 2.657x speedup, val set 3.957x speedup, step: 13
Epoch 13/200 |loss: 17.857153| train set 4.121x speedup, test set 2.655x speedup, val set 4.023x speedup, step: 14
Epoch 14/200 |loss: 17.349062| train set 4.053x speedup, test set 2.956x speedup, val set 3.957x speedup, step: 15
Epoch 15/200 |loss: 16.846964| train set 4.053x speedup, test set 2.400x speedup, val set 3.957x speedup, step: 16
Epoch 16/200 |loss: 16.393076| train set 4.053x speedup, test set 2.412x speedup, val set 3.957x speedup, step: 17
Epoch 17/200 |loss: 15.944830| train set 4.456x speedup, test set 2.431x speedup, val set 4.318x speedup, step: 18
Epoch 18/200 |loss: 15.498789| train set 4.456x speedup, test set 2.503x speedup, val set 4.318x speedup, step: 19
Epoch 19/200 |loss: 15.094980| train set 4.566x speedup, test set 2.280x speedup, val set 4.517x speedup, step: 20
Epoch 20/200 |loss: 14.729637| train set 4.716x speedup, test set 2.439x speedup, val set 4.627x speedup, step: 21
Epoch 21/200 |loss: 14.351872| train set 5.004x speedup, test set 2.280x speedup, val set 4.997x speedup, step: 22
Epoch 22/200 |loss: 13.857337| train set 5.037x speedup, test set 2.350x speedup, val set 5.036x speedup, step: 23
Epoch 23/200 |loss: 13.436578| train set 5.090x speedup, test set 2.385x speedup, val set 5.102x speedup, step: 24
Epoch 24/200 |loss: 13.115125| train set 5.109x speedup, test set 0.998x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 12.943458| train set 5.080x speedup, test set 0.984x speedup, val set 5.090x speedup, step: 26
Epoch 26/200 |loss: 12.937760| train set 5.283x speedup, test set 0.998x speedup, val set 5.308x speedup, step: 27
Epoch 27/200 |loss: 12.294819| train set 5.274x speedup, test set 0.996x speedup, val set 5.297x speedup, step: 28
Epoch 28/200 |loss: 11.864466| train set 5.272x speedup, test set 0.985x speedup, val set 5.286x speedup, step: 29
Epoch 29/200 |loss: 11.775672| train set 5.208x speedup, test set 0.998x speedup, val set 5.236x speedup, step: 30
Epoch 30/200 |loss: 11.514400| train set 5.274x speedup, test set 0.954x speedup, val set 5.297x speedup, step: 31
Epoch 31/200 |loss: 11.694329| train set 5.295x speedup, test set 0.981x speedup, val set 5.321x speedup, step: 32
Epoch 32/200 |loss: 11.224089| train set 5.304x speedup, test set 0.948x speedup, val set 5.323x speedup, step: 33
Epoch 33/200 |loss: 11.769173| train set 5.306x speedup, test set 0.958x speedup, val set 5.336x speedup, step: 34
Epoch 34/200 |loss: 10.852580| train set 5.295x speedup, test set 0.847x speedup, val set 5.323x speedup, step: 35
Epoch 35/200 |loss: 10.752720| train set 5.295x speedup, test set 0.848x speedup, val set 5.313x speedup, step: 36
Epoch 36/200 |loss: 10.468579| train set 5.306x speedup, test set 0.958x speedup, val set 5.336x speedup, step: 37
Epoch 37/200 |loss: 10.363049| train set 5.308x speedup, test set 0.946x speedup, val set 5.332x speedup, step: 38
Epoch 38/200 |loss: 10.003819| train set 5.308x speedup, test set 0.850x speedup, val set 5.332x speedup, step: 39
Epoch 39/200 |loss: 9.851924| train set 5.306x speedup, test set 0.958x speedup, val set 5.336x speedup, step: 40
Epoch 40/200 |loss: 9.669303| train set 5.305x speedup, test set 0.958x speedup, val set 5.326x speedup, step: 41
Epoch 41/200 |loss: 9.686287| train set 5.308x speedup, test set 0.970x speedup, val set 5.332x speedup, step: 42
Epoch 42/200 |loss: 9.474963| train set 5.286x speedup, test set 0.850x speedup, val set 5.306x speedup, step: 43
Epoch 43/200 |loss: 9.714483| train set 5.306x speedup, test set 0.970x speedup, val set 5.336x speedup, step: 44
Epoch 44/200 |loss: 9.472910| train set 5.308x speedup, test set 0.840x speedup, val set 5.332x speedup, step: 45
Epoch 45/200 |loss: 9.161104| train set 5.308x speedup, test set 0.850x speedup, val set 5.332x speedup, step: 46
Epoch 46/200 |loss: 9.043797| train set 5.308x speedup, test set 0.850x speedup, val set 5.332x speedup, step: 47
Epoch 47/200 |loss: 9.065237| train set 5.308x speedup, test set 0.958x speedup, val set 5.332x speedup, step: 48
Epoch 48/200 |loss: 9.264251| train set 5.297x speedup, test set 0.945x speedup, val set 5.320x speedup, step: 49
Epoch 49/200 |loss: 8.977436| train set 5.308x speedup, test set 0.957x speedup, val set 5.332x speedup, step: 50
Epoch 50/200 |loss: 8.813427| train set 5.308x speedup, test set 0.957x speedup, val set 5.332x speedup, step: 51
Epoch 51/200 |loss: 8.774148| train set 5.295x speedup, test set 0.945x speedup, val set 5.323x speedup, step: 52
Epoch 52/200 |loss: 8.720607| train set 5.255x speedup, test set 0.850x speedup, val set 5.269x speedup, step: 53
Epoch 53/200 |loss: 9.183535| train set 5.308x speedup, test set 0.840x speedup, val set 5.321x speedup, step: 54
Epoch 54/200 |loss: 8.844248| train set 5.308x speedup, test set 0.819x speedup, val set 5.330x speedup, step: 55
Epoch 55/200 |loss: 8.526153| train set 5.255x speedup, test set 0.932x speedup, val set 5.269x speedup, step: 56
Epoch 56/200 |loss: 8.748108| train set 5.297x speedup, test set 0.821x speedup, val set 5.317x speedup, step: 57
Epoch 57/200 |loss: 8.663075| train set 5.308x speedup, test set 0.821x speedup, val set 5.330x speedup, step: 58
Epoch 58/200 |loss: 8.445260| train set 5.252x speedup, test set 0.908x speedup, val set 5.270x speedup, step: 59
Epoch 59/200 |loss: 8.556627| train set 5.305x speedup, test set 0.830x speedup, val set 5.334x speedup, step: 60
Epoch 60/200 |loss: 8.317239| train set 5.308x speedup, test set 0.851x speedup, val set 5.330x speedup, step: 61
Epoch 61/200 |loss: 8.364265| train set 5.305x speedup, test set 0.931x speedup, val set 5.334x speedup, step: 62
Epoch 62/200 |loss: 8.510088| train set 5.308x speedup, test set 0.828x speedup, val set 5.330x speedup, step: 63
Epoch 63/200 |loss: 8.097925| train set 5.308x speedup, test set 0.828x speedup, val set 5.330x speedup, step: 64
Epoch 64/200 |loss: 8.113409| train set 5.305x speedup, test set 0.905x speedup, val set 5.334x speedup, step: 65
Epoch 65/200 |loss: 8.099340| train set 5.252x speedup, test set 0.829x speedup, val set 5.270x speedup, step: 66
Epoch 66/200 |loss: 7.903241| train set 5.297x speedup, test set 0.809x speedup, val set 5.317x speedup, step: 67
Epoch 67/200 |loss: 8.048853| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 68
Epoch 68/200 |loss: 7.832120| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 69
Epoch 69/200 |loss: 7.874249| train set 5.308x speedup, test set 0.811x speedup, val set 5.330x speedup, step: 70
Epoch 70/200 |loss: 7.760846| train set 5.308x speedup, test set 0.905x speedup, val set 5.330x speedup, step: 71
Epoch 71/200 |loss: 7.828788| train set 5.307x speedup, test set 0.809x speedup, val set 5.331x speedup, step: 72
Epoch 72/200 |loss: 7.823439| train set 5.254x speedup, test set 0.810x speedup, val set 5.267x speedup, step: 73
Epoch 73/200 |loss: 7.775630| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 74
Epoch 74/200 |loss: 7.755466| train set 5.254x speedup, test set 0.810x speedup, val set 5.267x speedup, step: 75
Epoch 75/200 |loss: 7.637636| train set 5.305x speedup, test set 0.810x speedup, val set 5.334x speedup, step: 76
Epoch 76/200 |loss: 7.700184| train set 5.297x speedup, test set 0.800x speedup, val set 5.317x speedup, step: 77
Epoch 77/200 |loss: 7.907129| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 78
Epoch 78/200 |loss: 7.871004| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 79
Epoch 79/200 |loss: 7.758496| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 80
Epoch 80/200 |loss: 7.495972| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 81
Epoch 81/200 |loss: 7.599165| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 82
Epoch 82/200 |loss: 7.868706| train set 5.252x speedup, test set 0.810x speedup, val set 5.270x speedup, step: 83
Epoch 83/200 |loss: 7.693172| train set 5.297x speedup, test set 0.810x speedup, val set 5.317x speedup, step: 84
Epoch 84/200 |loss: 7.655512| train set 5.254x speedup, test set 0.810x speedup, val set 5.267x speedup, step: 85
Epoch 85/200 |loss: 7.781290| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 86
Epoch 86/200 |loss: 8.098544| train set 5.308x speedup, test set 0.811x speedup, val set 5.330x speedup, step: 87
Epoch 87/200 |loss: 7.877396| train set 5.297x speedup, test set 0.821x speedup, val set 5.317x speedup, step: 88
Epoch 88/200 |loss: 8.123187| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 89
Epoch 89/200 |loss: 7.750379| train set 5.254x speedup, test set 0.810x speedup, val set 5.267x speedup, step: 90
Epoch 90/200 |loss: 8.413953| train set 5.297x speedup, test set 0.818x speedup, val set 5.317x speedup, step: 91
Epoch 91/200 |loss: 8.286819| train set 5.308x speedup, test set 0.826x speedup, val set 5.330x speedup, step: 92
Epoch 92/200 |loss: 8.226381| train set 5.252x speedup, test set 0.802x speedup, val set 5.270x speedup, step: 93
Epoch 93/200 |loss: 7.984995| train set 5.305x speedup, test set 0.897x speedup, val set 5.334x speedup, step: 94
Epoch 94/200 |loss: 7.959296| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 95
Epoch 95/200 |loss: 7.819647| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 96
Epoch 96/200 |loss: 7.760262| train set 5.295x speedup, test set 0.908x speedup, val set 5.310x speedup, step: 97
Epoch 97/200 |loss: 7.803758| train set 5.305x speedup, test set 0.908x speedup, val set 5.334x speedup, step: 98
Epoch 98/200 |loss: 7.549431| train set 5.306x speedup, test set 0.897x speedup, val set 5.336x speedup, step: 99
Epoch 99/200 |loss: 7.704327| train set 5.308x speedup, test set 0.897x speedup, val set 5.332x speedup, step: 100
Epoch 100/200 |loss: 7.463529| train set 5.255x speedup, test set 0.908x speedup, val set 5.269x speedup, step: 1
Epoch 101/200 |loss: 7.585614| train set 5.308x speedup, test set 0.908x speedup, val set 5.332x speedup, step: 1
Epoch 102/200 |loss: 7.444188| train set 5.307x speedup, test set 0.908x speedup, val set 5.331x speedup, step: 2
Epoch 103/200 |loss: 7.442327| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 3
Epoch 104/200 |loss: 7.411062| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 4
Epoch 105/200 |loss: 7.362927| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 5
Epoch 106/200 |loss: 7.337075| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 6
Epoch 107/200 |loss: 7.313235| train set 5.295x speedup, test set 0.908x speedup, val set 5.321x speedup, step: 7
Epoch 108/200 |loss: 7.295378| train set 5.297x speedup, test set 0.908x speedup, val set 5.317x speedup, step: 8
Epoch 109/200 |loss: 7.242895| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 9
Epoch 110/200 |loss: 7.251658| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 10
Epoch 111/200 |loss: 7.291632| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 11
Epoch 112/200 |loss: 7.372173| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 12
Epoch 113/200 |loss: 7.495438| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 13
Epoch 114/200 |loss: 7.880151| train set 5.305x speedup, test set 0.908x speedup, val set 5.334x speedup, step: 1
Epoch 115/200 |loss: 7.343940| train set 5.305x speedup, test set 0.908x speedup, val set 5.334x speedup, step: 1
Epoch 116/200 |loss: 7.365161| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 2
Epoch 117/200 |loss: 7.800269| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 3
Epoch 118/200 |loss: 7.240497| train set 5.257x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 4
Epoch 119/200 |loss: 7.620718| train set 5.295x speedup, test set 0.802x speedup, val set 5.321x speedup, step: 5
Epoch 120/200 |loss: 7.764856| train set 5.305x speedup, test set 0.897x speedup, val set 5.334x speedup, step: 1
Epoch 121/200 |loss: 7.424598| train set 5.254x speedup, test set 0.908x speedup, val set 5.271x speedup, step: 2
Epoch 122/200 |loss: 7.744391| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 3
Epoch 123/200 |loss: 7.449276| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 4
Epoch 124/200 |loss: 7.395490| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 5
Epoch 125/200 |loss: 7.416589| train set 5.307x speedup, test set 0.897x speedup, val set 5.331x speedup, step: 6
Epoch 126/200 |loss: 7.248236| train set 5.295x speedup, test set 0.802x speedup, val set 5.321x speedup, step: 7
Epoch 127/200 |loss: 7.420506| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 8
Epoch 128/200 |loss: 7.210779| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 9
Epoch 129/200 |loss: 7.348176| train set 5.297x speedup, test set 0.802x speedup, val set 5.317x speedup, step: 10
Epoch 130/200 |loss: 7.277315| train set 5.297x speedup, test set 0.802x speedup, val set 5.317x speedup, step: 11
Epoch 131/200 |loss: 7.173025| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 12
Epoch 132/200 |loss: 7.291238| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 13
Epoch 133/200 |loss: 7.191700| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 14
Epoch 134/200 |loss: 7.192338| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 15
Epoch 135/200 |loss: 7.206790| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 16
Epoch 136/200 |loss: 7.167960| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 17
Epoch 137/200 |loss: 7.085858| train set 5.310x speedup, test set 0.897x speedup, val set 5.331x speedup, step: 18
Epoch 138/200 |loss: 7.180475| train set 5.305x speedup, test set 0.897x speedup, val set 5.334x speedup, step: 1
Epoch 139/200 |loss: 7.162921| train set 5.308x speedup, test set 0.802x speedup, val set 5.330x speedup, step: 2
Epoch 140/200 |loss: 7.106678| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 3
Epoch 141/200 |loss: 7.085621| train set 5.307x speedup, test set 0.897x speedup, val set 5.331x speedup, step: 4
Epoch 142/200 |loss: 7.171626| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 5
Epoch 143/200 |loss: 7.188263| train set 5.305x speedup, test set 0.908x speedup, val set 5.334x speedup, step: 1
Epoch 144/200 |loss: 7.210943| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 2
Epoch 145/200 |loss: 7.570610| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 3
Epoch 146/200 |loss: 7.156229| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 4
Epoch 147/200 |loss: 7.249487| train set 5.254x speedup, test set 0.897x speedup, val set 5.267x speedup, step: 5
Epoch 148/200 |loss: 7.863599| train set 5.305x speedup, test set 0.897x speedup, val set 5.334x speedup, step: 1
Epoch 149/200 |loss: 7.243465| train set 5.310x speedup, test set 0.908x speedup, val set 5.331x speedup, step: 2
Epoch 150/200 |loss: 7.746174| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 3
Epoch 151/200 |loss: 8.031134| train set 5.305x speedup, test set 0.908x speedup, val set 5.334x speedup, step: 1
Epoch 152/200 |loss: 7.807819| train set 5.257x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 2
Epoch 153/200 |loss: 7.624073| train set 5.308x speedup, test set 0.809x speedup, val set 5.330x speedup, step: 3
Epoch 154/200 |loss: 7.839515| train set 5.308x speedup, test set 0.810x speedup, val set 5.330x speedup, step: 4
Epoch 155/200 |loss: 7.368798| train set 5.252x speedup, test set 0.907x speedup, val set 5.270x speedup, step: 5
Epoch 156/200 |loss: 7.723727| train set 5.305x speedup, test set 0.907x speedup, val set 5.334x speedup, step: 1
Epoch 157/200 |loss: 7.343305| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 2
Epoch 158/200 |loss: 7.442226| train set 5.308x speedup, test set 0.906x speedup, val set 5.330x speedup, step: 3
Epoch 159/200 |loss: 7.319939| train set 5.308x speedup, test set 0.907x speedup, val set 5.330x speedup, step: 4
Epoch 160/200 |loss: 7.306831| train set 5.305x speedup, test set 0.908x speedup, val set 5.334x speedup, step: 1
Epoch 161/200 |loss: 7.313129| train set 5.305x speedup, test set 0.908x speedup, val set 5.334x speedup, step: 1
Epoch 162/200 |loss: 7.224865| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 2
Epoch 163/200 |loss: 7.227998| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 3
Epoch 164/200 |loss: 7.199988| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 4
Epoch 165/200 |loss: 7.183393| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 5
Epoch 166/200 |loss: 7.165600| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 6
Epoch 167/200 |loss: 7.130788| train set 5.297x speedup, test set 0.908x speedup, val set 5.317x speedup, step: 7
Epoch 168/200 |loss: 7.141869| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 8
Epoch 169/200 |loss: 7.123730| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 9
Epoch 170/200 |loss: 7.103504| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 10
Epoch 171/200 |loss: 7.072720| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 11
Epoch 172/200 |loss: 7.088336| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 12
Epoch 173/200 |loss: 7.044245| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 13
Epoch 174/200 |loss: 7.052141| train set 5.306x speedup, test set 0.908x speedup, val set 5.331x speedup, step: 14
Epoch 175/200 |loss: 7.020660| train set 5.305x speedup, test set 0.908x speedup, val set 5.334x speedup, step: 1
Epoch 176/200 |loss: 7.012743| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 2
Epoch 177/200 |loss: 6.993051| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 3
Epoch 178/200 |loss: 7.012537| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 4
Epoch 179/200 |loss: 6.983809| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 5
Epoch 180/200 |loss: 7.000174| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 6
Epoch 181/200 |loss: 7.052851| train set 5.257x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 7
Epoch 182/200 |loss: 7.087263| train set 5.297x speedup, test set 0.908x speedup, val set 5.317x speedup, step: 8
Epoch 183/200 |loss: 7.230303| train set 5.254x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 9
Epoch 184/200 |loss: 7.110303| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 10
Epoch 185/200 |loss: 7.047491| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 11
Epoch 186/200 |loss: 6.968835| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 12
Epoch 187/200 |loss: 7.079230| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 13
Epoch 188/200 |loss: 7.271709| train set 5.252x speedup, test set 0.908x speedup, val set 5.270x speedup, step: 14
Epoch 189/200 |loss: 7.053010| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 15
Epoch 190/200 |loss: 7.053798| train set 5.297x speedup, test set 0.897x speedup, val set 5.317x speedup, step: 16
Epoch 191/200 |loss: 7.379532| train set 5.308x speedup, test set 0.908x speedup, val set 5.330x speedup, step: 17
Epoch 192/200 |loss: 7.022650| train set 5.257x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 18
Epoch 193/200 |loss: 7.120106| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 19
Epoch 194/200 |loss: 7.455201| train set 5.306x speedup, test set 0.908x speedup, val set 5.331x speedup, step: 20
Epoch 195/200 |loss: 6.975640| train set 5.257x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 21
Epoch 196/200 |loss: 7.585933| train set 5.308x speedup, test set 0.897x speedup, val set 5.330x speedup, step: 22
Epoch 197/200 |loss: 7.764243| train set 5.308x speedup, test set 0.896x speedup, val set 5.330x speedup, step: 23
Epoch 198/200 |loss: 7.585340| train set 5.257x speedup, test set 0.908x speedup, val set 5.267x speedup, step: 24
Epoch 199/200 |loss: 7.423439| train set 5.257x speedup, test set 0.907x speedup, val set 5.267x speedup, step: 25
Training per epoch cost 0.260 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.016s, pg runtime 0.014s, speedup 0.886x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 3.118s, pg runtime 0.802s, speedup 0.257x
07, opt runtime 0.919s, model runtime 0.933s, pg runtime 0.942s, speedup 1.009x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.162s, pg runtime 0.153s, speedup 0.943x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.373s, pg runtime 0.354s, speedup 0.949x
18, opt runtime 2.599s, model runtime 5.204s, pg runtime 2.599s, speedup 0.499x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.065s, pg runtime 0.086s, speedup 1.315x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.389s, pg runtime 0.389s, speedup 1.000x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.112s, pg runtime 0.112s, speedup 1.000x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 137, train speedup 5.310, test speedup 0.897, val speedup 5.331
best test speedup epoch: 14, train speedup 4.053, test speedup 2.956, val speedup 3.957
best validation speedup epoch: 175, train speedup 5.305, test speedup 0.908, val speedup 5.334
last model at epoch 199, train speedup 5.257, test speedup 0.907, val speedup 5.267
execution cost 0:02:37.184775
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.855763, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037212| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524660| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074562| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570391| train set 4.397x speedup, test set 0.972x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.079531| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586479| train set 4.418x speedup, test set 0.983x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.067806| train set 4.467x speedup, test set 1.021x speedup, val set 4.201x speedup, step: 14
Epoch 14/200 |loss: 17.602135| train set 4.467x speedup, test set 1.015x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.146929| train set 4.467x speedup, test set 1.066x speedup, val set 4.201x speedup, step: 16
Epoch 16/200 |loss: 16.682732| train set 4.552x speedup, test set 1.064x speedup, val set 4.345x speedup, step: 17
Epoch 17/200 |loss: 16.274242| train set 4.467x speedup, test set 1.081x speedup, val set 4.201x speedup, step: 18
Epoch 18/200 |loss: 15.853738| train set 4.702x speedup, test set 2.759x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.445741| train set 4.803x speedup, test set 2.845x speedup, val set 4.539x speedup, step: 20
Epoch 20/200 |loss: 15.071042| train set 4.978x speedup, test set 2.706x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.586794| train set 5.431x speedup, test set 2.706x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.157400| train set 5.431x speedup, test set 1.087x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 13.888359| train set 5.456x speedup, test set 1.071x speedup, val set 5.072x speedup, step: 24
Epoch 24/200 |loss: 13.646112| train set 5.472x speedup, test set 1.078x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.608994| train set 5.496x speedup, test set 1.078x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.321267| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.552133| train set 5.472x speedup, test set 1.076x speedup, val set 5.104x speedup, step: 28
Epoch 28/200 |loss: 12.681773| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.410557| train set 5.496x speedup, test set 1.063x speedup, val set 5.105x speedup, step: 30
Epoch 30/200 |loss: 11.960317| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.791098| train set 5.497x speedup, test set 1.073x speedup, val set 5.106x speedup, step: 32
Epoch 32/200 |loss: 11.527379| train set 5.497x speedup, test set 1.060x speedup, val set 5.106x speedup, step: 33
Epoch 33/200 |loss: 11.783454| train set 5.497x speedup, test set 1.059x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 10.962358| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 35
Epoch 35/200 |loss: 11.114005| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 36
Epoch 36/200 |loss: 10.923721| train set 5.496x speedup, test set 1.055x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.945090| train set 5.496x speedup, test set 1.069x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.248078| train set 5.496x speedup, test set 1.022x speedup, val set 5.102x speedup, step: 39
Epoch 39/200 |loss: 10.638553| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.336867| train set 5.496x speedup, test set 1.073x speedup, val set 5.105x speedup, step: 41
Epoch 41/200 |loss: 10.527143| train set 5.449x speedup, test set 1.053x speedup, val set 5.193x speedup, step: 42
Epoch 42/200 |loss: 10.691396| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 10.062676| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 10.012733| train set 5.497x speedup, test set 1.054x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.985867| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.687916| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.662374| train set 5.450x speedup, test set 1.050x speedup, val set 5.054x speedup, step: 48
Epoch 48/200 |loss: 9.487604| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.521675| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.361638| train set 5.497x speedup, test set 1.065x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 8.998724| train set 5.497x speedup, test set 1.062x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.186695| train set 5.450x speedup, test set 1.062x speedup, val set 5.054x speedup, step: 53
Epoch 53/200 |loss: 9.009143| train set 5.448x speedup, test set 1.065x speedup, val set 5.067x speedup, step: 54
Epoch 54/200 |loss: 9.295671| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.915401| train set 5.497x speedup, test set 1.065x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.714565| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.727078| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.659105| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.660454| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.527979| train set 5.496x speedup, test set 0.976x speedup, val set 5.105x speedup, step: 61
Epoch 61/200 |loss: 8.385193| train set 5.496x speedup, test set 0.957x speedup, val set 5.105x speedup, step: 62
Epoch 62/200 |loss: 8.349354| train set 5.497x speedup, test set 0.969x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 8.396985| train set 5.308x speedup, test set 0.969x speedup, val set 5.020x speedup, step: 64
Epoch 64/200 |loss: 8.437737| train set 5.497x speedup, test set 0.969x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.228934| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.133189| train set 5.497x speedup, test set 0.958x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.286921| train set 5.450x speedup, test set 0.970x speedup, val set 5.064x speedup, step: 68
Epoch 68/200 |loss: 8.444082| train set 5.461x speedup, test set 0.957x speedup, val set 4.998x speedup, step: 69
Epoch 69/200 |loss: 8.732697| train set 5.497x speedup, test set 0.958x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.343037| train set 5.448x speedup, test set 0.970x speedup, val set 5.067x speedup, step: 71
Epoch 71/200 |loss: 8.305793| train set 5.450x speedup, test set 0.957x speedup, val set 5.054x speedup, step: 72
Epoch 72/200 |loss: 8.656298| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.278658| train set 5.448x speedup, test set 0.970x speedup, val set 5.067x speedup, step: 74
Epoch 74/200 |loss: 8.611205| train set 5.449x speedup, test set 1.042x speedup, val set 5.193x speedup, step: 75
Epoch 75/200 |loss: 8.512280| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.494927| train set 5.448x speedup, test set 0.970x speedup, val set 5.067x speedup, step: 77
Epoch 77/200 |loss: 8.587429| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 8.261854| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.224848| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 8.114910| train set 5.496x speedup, test set 0.954x speedup, val set 5.105x speedup, step: 81
Epoch 81/200 |loss: 8.117906| train set 5.496x speedup, test set 0.954x speedup, val set 5.105x speedup, step: 82
Epoch 82/200 |loss: 8.001594| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 83
Epoch 83/200 |loss: 7.984284| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 7.850420| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.888336| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 86
Epoch 86/200 |loss: 7.787465| train set 5.497x speedup, test set 0.847x speedup, val set 5.106x speedup, step: 87
Epoch 87/200 |loss: 7.767606| train set 5.497x speedup, test set 0.847x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.686824| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.721441| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 7.648086| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.665205| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.639693| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 93
Epoch 93/200 |loss: 7.740251| train set 5.450x speedup, test set 0.954x speedup, val set 5.054x speedup, step: 94
Epoch 94/200 |loss: 7.701795| train set 5.448x speedup, test set 0.959x speedup, val set 5.067x speedup, step: 95
Epoch 95/200 |loss: 7.842821| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 7.987241| train set 5.448x speedup, test set 0.962x speedup, val set 5.067x speedup, step: 97
Epoch 97/200 |loss: 7.856555| train set 5.450x speedup, test set 0.957x speedup, val set 5.193x speedup, step: 98
Epoch 98/200 |loss: 8.137718| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.805628| train set 5.448x speedup, test set 0.959x speedup, val set 5.068x speedup, step: 100
Epoch 100/200 |loss: 8.388021| train set 5.450x speedup, test set 0.954x speedup, val set 5.193x speedup, step: 1
Epoch 101/200 |loss: 8.516639| train set 5.497x speedup, test set 0.946x speedup, val set 5.106x speedup, step: 2
Epoch 102/200 |loss: 8.092947| train set 5.497x speedup, test set 0.962x speedup, val set 5.106x speedup, step: 3
Epoch 103/200 |loss: 8.359694| train set 5.496x speedup, test set 0.954x speedup, val set 5.105x speedup, step: 4
Epoch 104/200 |loss: 8.101219| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 5
Epoch 105/200 |loss: 7.814330| train set 5.448x speedup, test set 0.954x speedup, val set 5.067x speedup, step: 6
Epoch 106/200 |loss: 8.115257| train set 5.496x speedup, test set 0.954x speedup, val set 5.107x speedup, step: 7
Epoch 107/200 |loss: 7.688633| train set 5.403x speedup, test set 0.954x speedup, val set 5.141x speedup, step: 8
Epoch 108/200 |loss: 7.931176| train set 5.448x speedup, test set 0.954x speedup, val set 5.068x speedup, step: 9
Epoch 109/200 |loss: 7.717337| train set 5.496x speedup, test set 0.954x speedup, val set 5.107x speedup, step: 10
Epoch 110/200 |loss: 7.688190| train set 5.496x speedup, test set 0.954x speedup, val set 5.107x speedup, step: 11
Epoch 111/200 |loss: 7.814083| train set 5.496x speedup, test set 0.954x speedup, val set 5.107x speedup, step: 12
Epoch 112/200 |loss: 7.691688| train set 5.496x speedup, test set 0.966x speedup, val set 5.107x speedup, step: 13
Epoch 113/200 |loss: 7.630950| train set 5.307x speedup, test set 0.847x speedup, val set 4.964x speedup, step: 14
Epoch 114/200 |loss: 7.701318| train set 5.496x speedup, test set 0.847x speedup, val set 5.107x speedup, step: 15
Epoch 115/200 |loss: 7.505237| train set 5.448x speedup, test set 0.847x speedup, val set 5.068x speedup, step: 16
Epoch 116/200 |loss: 7.595934| train set 5.496x speedup, test set 0.847x speedup, val set 5.107x speedup, step: 17
Epoch 117/200 |loss: 7.526086| train set 5.497x speedup, test set 0.845x speedup, val set 5.106x speedup, step: 18
Epoch 118/200 |loss: 7.540829| train set 5.497x speedup, test set 0.850x speedup, val set 5.106x speedup, step: 19
Epoch 119/200 |loss: 7.614036| train set 5.448x speedup, test set 0.957x speedup, val set 5.067x speedup, step: 20
Epoch 120/200 |loss: 7.517970| train set 5.497x speedup, test set 0.957x speedup, val set 5.106x speedup, step: 21
Epoch 121/200 |loss: 7.613942| train set 5.497x speedup, test set 0.848x speedup, val set 5.106x speedup, step: 22
Epoch 122/200 |loss: 7.444759| train set 5.497x speedup, test set 0.848x speedup, val set 5.106x speedup, step: 23
Epoch 123/200 |loss: 7.419797| train set 5.497x speedup, test set 0.848x speedup, val set 5.106x speedup, step: 24
Epoch 124/200 |loss: 7.398995| train set 5.497x speedup, test set 0.848x speedup, val set 5.106x speedup, step: 25
Epoch 125/200 |loss: 7.410791| train set 5.497x speedup, test set 0.848x speedup, val set 5.106x speedup, step: 26
Epoch 126/200 |loss: 7.475293| train set 5.450x speedup, test set 0.955x speedup, val set 5.076x speedup, step: 27
Epoch 127/200 |loss: 7.535206| train set 5.497x speedup, test set 0.848x speedup, val set 5.106x speedup, step: 28
Epoch 128/200 |loss: 7.785153| train set 5.448x speedup, test set 0.848x speedup, val set 5.068x speedup, step: 29
Epoch 129/200 |loss: 7.493069| train set 5.496x speedup, test set 0.848x speedup, val set 5.107x speedup, step: 30
Epoch 130/200 |loss: 7.433103| train set 5.496x speedup, test set 0.848x speedup, val set 5.107x speedup, step: 31
Epoch 131/200 |loss: 7.292922| train set 5.450x speedup, test set 0.848x speedup, val set 5.070x speedup, step: 32
Epoch 132/200 |loss: 7.462253| train set 5.456x speedup, test set 0.850x speedup, val set 5.205x speedup, step: 1
Epoch 133/200 |loss: 7.629073| train set 5.448x speedup, test set 0.850x speedup, val set 5.068x speedup, step: 2
Epoch 134/200 |loss: 7.345855| train set 5.448x speedup, test set 0.850x speedup, val set 5.068x speedup, step: 3
Epoch 135/200 |loss: 7.406052| train set 5.496x speedup, test set 0.850x speedup, val set 5.107x speedup, step: 4
Epoch 136/200 |loss: 7.740148| train set 5.496x speedup, test set 0.850x speedup, val set 5.107x speedup, step: 5
Epoch 137/200 |loss: 7.309855| train set 5.450x speedup, test set 0.848x speedup, val set 5.070x speedup, step: 6
Epoch 138/200 |loss: 7.637049| train set 5.497x speedup, test set 0.850x speedup, val set 5.106x speedup, step: 7
Epoch 139/200 |loss: 7.794570| train set 5.497x speedup, test set 0.850x speedup, val set 5.106x speedup, step: 8
Epoch 140/200 |loss: 7.424362| train set 5.450x speedup, test set 0.857x speedup, val set 5.070x speedup, step: 9
Epoch 141/200 |loss: 7.941547| train set 5.459x speedup, test set 0.850x speedup, val set 5.195x speedup, step: 10
Epoch 142/200 |loss: 7.483083| train set 5.450x speedup, test set 0.847x speedup, val set 5.193x speedup, step: 11
Epoch 143/200 |loss: 7.655962| train set 5.448x speedup, test set 0.847x speedup, val set 5.067x speedup, step: 12
Epoch 144/200 |loss: 7.450192| train set 5.448x speedup, test set 0.847x speedup, val set 5.067x speedup, step: 13
Epoch 145/200 |loss: 7.473672| train set 5.497x speedup, test set 0.847x speedup, val set 5.106x speedup, step: 14
Epoch 146/200 |loss: 7.505778| train set 5.497x speedup, test set 0.847x speedup, val set 5.106x speedup, step: 15
Epoch 147/200 |loss: 7.381032| train set 5.448x speedup, test set 0.847x speedup, val set 5.067x speedup, step: 16
Epoch 148/200 |loss: 7.437164| train set 5.497x speedup, test set 0.850x speedup, val set 5.106x speedup, step: 17
Epoch 149/200 |loss: 7.297770| train set 5.497x speedup, test set 0.832x speedup, val set 5.106x speedup, step: 18
Epoch 150/200 |loss: 7.394691| train set 5.497x speedup, test set 0.832x speedup, val set 5.106x speedup, step: 19
Epoch 151/200 |loss: 7.289052| train set 5.451x speedup, test set 0.832x speedup, val set 5.069x speedup, step: 20
Epoch 152/200 |loss: 7.368301| train set 5.497x speedup, test set 0.832x speedup, val set 5.106x speedup, step: 21
Epoch 153/200 |loss: 7.374971| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 22
Epoch 154/200 |loss: 7.302864| train set 5.497x speedup, test set 0.832x speedup, val set 5.106x speedup, step: 23
Epoch 155/200 |loss: 7.404176| train set 5.497x speedup, test set 0.832x speedup, val set 5.106x speedup, step: 24
Epoch 156/200 |loss: 7.304775| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 25
Epoch 157/200 |loss: 7.362574| train set 5.448x speedup, test set 0.833x speedup, val set 5.067x speedup, step: 26
Epoch 158/200 |loss: 7.278412| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 27
Epoch 159/200 |loss: 7.261527| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 28
Epoch 160/200 |loss: 7.298385| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 29
Epoch 161/200 |loss: 7.228168| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 30
Epoch 162/200 |loss: 7.189133| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 31
Epoch 163/200 |loss: 7.214372| train set 5.496x speedup, test set 0.833x speedup, val set 5.107x speedup, step: 32
Epoch 164/200 |loss: 7.211450| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 33
Epoch 165/200 |loss: 7.210678| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 34
Epoch 166/200 |loss: 7.202808| train set 5.497x speedup, test set 0.832x speedup, val set 5.106x speedup, step: 35
Epoch 167/200 |loss: 7.182712| train set 5.497x speedup, test set 0.832x speedup, val set 5.106x speedup, step: 36
Epoch 168/200 |loss: 7.210380| train set 5.497x speedup, test set 0.832x speedup, val set 5.106x speedup, step: 37
Epoch 169/200 |loss: 7.497363| train set 5.496x speedup, test set 0.811x speedup, val set 5.107x speedup, step: 38
Epoch 170/200 |loss: 7.494943| train set 5.497x speedup, test set 0.811x speedup, val set 5.106x speedup, step: 39
Epoch 171/200 |loss: 7.751656| train set 5.497x speedup, test set 0.832x speedup, val set 5.106x speedup, step: 40
Epoch 172/200 |loss: 7.237348| train set 5.448x speedup, test set 0.832x speedup, val set 5.068x speedup, step: 41
Epoch 173/200 |loss: 7.598056| train set 5.497x speedup, test set 0.811x speedup, val set 5.106x speedup, step: 42
Epoch 174/200 |loss: 7.976566| train set 5.497x speedup, test set 0.811x speedup, val set 5.106x speedup, step: 43
Epoch 175/200 |loss: 7.374211| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 44
Epoch 176/200 |loss: 7.881588| train set 5.448x speedup, test set 0.833x speedup, val set 5.067x speedup, step: 45
Epoch 177/200 |loss: 7.884978| train set 5.497x speedup, test set 0.811x speedup, val set 5.106x speedup, step: 46
Epoch 178/200 |loss: 7.560870| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 47
Epoch 179/200 |loss: 7.816516| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 48
Epoch 180/200 |loss: 7.592353| train set 5.448x speedup, test set 0.808x speedup, val set 5.067x speedup, step: 49
Epoch 181/200 |loss: 7.532508| train set 5.448x speedup, test set 0.825x speedup, val set 5.067x speedup, step: 50
Epoch 182/200 |loss: 7.537290| train set 5.497x speedup, test set 0.808x speedup, val set 5.106x speedup, step: 51
Epoch 183/200 |loss: 7.365036| train set 5.497x speedup, test set 0.809x speedup, val set 5.106x speedup, step: 52
Epoch 184/200 |loss: 7.534987| train set 5.497x speedup, test set 0.809x speedup, val set 5.106x speedup, step: 53
Epoch 185/200 |loss: 7.294054| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 54
Epoch 186/200 |loss: 7.433608| train set 5.497x speedup, test set 0.812x speedup, val set 5.106x speedup, step: 55
Epoch 187/200 |loss: 7.307272| train set 5.497x speedup, test set 0.809x speedup, val set 5.106x speedup, step: 56
Epoch 188/200 |loss: 7.343966| train set 5.497x speedup, test set 0.809x speedup, val set 5.106x speedup, step: 57
Epoch 189/200 |loss: 7.265518| train set 5.497x speedup, test set 0.809x speedup, val set 5.106x speedup, step: 58
Epoch 190/200 |loss: 7.274922| train set 5.448x speedup, test set 0.812x speedup, val set 5.068x speedup, step: 59
Epoch 191/200 |loss: 7.265942| train set 5.448x speedup, test set 0.809x speedup, val set 5.068x speedup, step: 60
Epoch 192/200 |loss: 7.226398| train set 5.496x speedup, test set 0.812x speedup, val set 5.107x speedup, step: 61
Epoch 193/200 |loss: 7.221737| train set 5.496x speedup, test set 0.811x speedup, val set 5.107x speedup, step: 62
Epoch 194/200 |loss: 7.241706| train set 5.496x speedup, test set 0.812x speedup, val set 5.107x speedup, step: 63
Epoch 195/200 |loss: 7.178178| train set 5.496x speedup, test set 0.812x speedup, val set 5.107x speedup, step: 64
Epoch 196/200 |loss: 7.220124| train set 5.448x speedup, test set 0.812x speedup, val set 5.068x speedup, step: 65
Epoch 197/200 |loss: 7.172362| train set 5.496x speedup, test set 0.812x speedup, val set 5.107x speedup, step: 66
Epoch 198/200 |loss: 7.157615| train set 5.496x speedup, test set 0.812x speedup, val set 5.107x speedup, step: 67
Epoch 199/200 |loss: 7.182464| train set 5.496x speedup, test set 0.812x speedup, val set 5.107x speedup, step: 68
Training per epoch cost 0.236 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.733s, pg runtime 0.354s, speedup 0.482x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 1.143s, pg runtime 0.891s, speedup 0.780x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.189s, pg runtime 0.189s, speedup 1.000x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 12.105s, pg runtime 0.023s, speedup 0.002x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 26, train speedup 5.497, test speedup 1.076, val speedup 5.106
best test speedup epoch: 19, train speedup 4.803, test speedup 2.845, val speedup 4.539
best validation speedup epoch: 132, train speedup 5.456, test speedup 0.850, val speedup 5.205
last model at epoch 199, train speedup 5.496, test speedup 0.812, val speedup 5.107
execution cost 0:02:22.751669
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.871059, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037214| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524662| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074562| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570395| train set 4.397x speedup, test set 0.972x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.079531| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586479| train set 4.418x speedup, test set 0.983x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.067806| train set 4.467x speedup, test set 1.021x speedup, val set 4.201x speedup, step: 14
Epoch 14/200 |loss: 17.602137| train set 4.467x speedup, test set 1.015x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.146929| train set 4.467x speedup, test set 1.066x speedup, val set 4.201x speedup, step: 16
Epoch 16/200 |loss: 16.682732| train set 4.552x speedup, test set 1.064x speedup, val set 4.345x speedup, step: 17
Epoch 17/200 |loss: 16.274242| train set 4.467x speedup, test set 1.081x speedup, val set 4.201x speedup, step: 18
Epoch 18/200 |loss: 15.853737| train set 4.702x speedup, test set 2.759x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.445742| train set 4.803x speedup, test set 2.845x speedup, val set 4.539x speedup, step: 20
Epoch 20/200 |loss: 15.071042| train set 4.978x speedup, test set 2.706x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.586793| train set 5.431x speedup, test set 2.706x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.157400| train set 5.431x speedup, test set 1.087x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 13.888359| train set 5.456x speedup, test set 1.071x speedup, val set 5.072x speedup, step: 24
Epoch 24/200 |loss: 13.646111| train set 5.472x speedup, test set 1.078x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.608923| train set 5.496x speedup, test set 1.078x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.321943| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.552597| train set 5.472x speedup, test set 1.076x speedup, val set 5.104x speedup, step: 28
Epoch 28/200 |loss: 12.681893| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.411134| train set 5.496x speedup, test set 1.063x speedup, val set 5.105x speedup, step: 30
Epoch 30/200 |loss: 11.959080| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.781709| train set 5.497x speedup, test set 1.073x speedup, val set 5.106x speedup, step: 32
Epoch 32/200 |loss: 11.524363| train set 5.496x speedup, test set 1.060x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.801163| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 10.998095| train set 5.497x speedup, test set 0.984x speedup, val set 5.106x speedup, step: 35
Epoch 35/200 |loss: 11.186912| train set 5.496x speedup, test set 1.026x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 10.963117| train set 5.496x speedup, test set 1.055x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.883952| train set 5.496x speedup, test set 1.065x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.405328| train set 5.450x speedup, test set 1.022x speedup, val set 5.193x speedup, step: 39
Epoch 39/200 |loss: 10.702031| train set 5.497x speedup, test set 1.054x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.225078| train set 5.496x speedup, test set 1.073x speedup, val set 5.105x speedup, step: 41
Epoch 41/200 |loss: 10.612155| train set 5.496x speedup, test set 1.053x speedup, val set 5.105x speedup, step: 42
Epoch 42/200 |loss: 10.657648| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.680585| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 10.139317| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.671070| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.739575| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.526348| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.351876| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.258566| train set 5.497x speedup, test set 1.065x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.167873| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 8.931436| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.037959| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 8.731537| train set 5.497x speedup, test set 0.989x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 8.821686| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.695799| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.619843| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.515853| train set 5.497x speedup, test set 1.056x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.795444| train set 5.497x speedup, test set 0.966x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 9.172571| train set 5.426x speedup, test set 0.963x speedup, val set 4.960x speedup, step: 60
Epoch 60/200 |loss: 10.256095| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 9.493005| train set 5.448x speedup, test set 0.969x speedup, val set 5.067x speedup, step: 62
Epoch 62/200 |loss: 9.423860| train set 5.497x speedup, test set 0.951x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 9.574827| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.569359| train set 5.448x speedup, test set 0.966x speedup, val set 5.067x speedup, step: 65
Epoch 65/200 |loss: 9.263403| train set 5.497x speedup, test set 0.957x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.687083| train set 5.497x speedup, test set 0.969x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.805115| train set 5.497x speedup, test set 0.969x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.578900| train set 5.497x speedup, test set 0.969x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.523311| train set 5.497x speedup, test set 0.969x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.410069| train set 5.448x speedup, test set 0.979x speedup, val set 5.067x speedup, step: 71
Epoch 71/200 |loss: 8.407128| train set 5.497x speedup, test set 0.958x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.395405| train set 5.497x speedup, test set 0.969x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.287891| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 74
Epoch 74/200 |loss: 8.146672| train set 5.497x speedup, test set 0.969x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 8.324265| train set 5.448x speedup, test set 0.970x speedup, val set 5.067x speedup, step: 76
Epoch 76/200 |loss: 8.171964| train set 5.497x speedup, test set 0.969x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 8.032396| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 7.998725| train set 5.448x speedup, test set 0.970x speedup, val set 5.067x speedup, step: 79
Epoch 79/200 |loss: 8.028625| train set 5.308x speedup, test set 0.969x speedup, val set 4.963x speedup, step: 80
Epoch 80/200 |loss: 8.104164| train set 5.448x speedup, test set 0.980x speedup, val set 5.067x speedup, step: 81
Epoch 81/200 |loss: 7.862085| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 7.872511| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 83
Epoch 83/200 |loss: 8.014505| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 7.881933| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.793112| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 86
Epoch 86/200 |loss: 7.688026| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 87
Epoch 87/200 |loss: 7.705350| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.795962| train set 5.448x speedup, test set 0.980x speedup, val set 5.067x speedup, step: 89
Epoch 89/200 |loss: 7.885702| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 8.278709| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.687227| train set 5.448x speedup, test set 0.980x speedup, val set 5.067x speedup, step: 92
Epoch 92/200 |loss: 8.180584| train set 5.403x speedup, test set 0.946x speedup, val set 5.141x speedup, step: 93
Epoch 93/200 |loss: 8.855079| train set 5.496x speedup, test set 0.968x speedup, val set 5.107x speedup, step: 94
Epoch 94/200 |loss: 8.203594| train set 5.448x speedup, test set 0.980x speedup, val set 5.068x speedup, step: 95
Epoch 95/200 |loss: 8.359106| train set 5.496x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 8.031052| train set 5.496x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 8.139267| train set 5.448x speedup, test set 0.964x speedup, val set 5.068x speedup, step: 98
Epoch 98/200 |loss: 7.807483| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 99
Epoch 99/200 |loss: 7.947769| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.789512| train set 5.448x speedup, test set 0.954x speedup, val set 5.067x speedup, step: 1
Epoch 101/200 |loss: 7.762167| train set 5.448x speedup, test set 0.964x speedup, val set 5.067x speedup, step: 1
Epoch 102/200 |loss: 7.847004| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 1
Epoch 103/200 |loss: 7.711771| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 1
Epoch 104/200 |loss: 7.715373| train set 5.497x speedup, test set 0.977x speedup, val set 5.106x speedup, step: 1
Epoch 105/200 |loss: 7.625999| train set 5.445x speedup, test set 0.954x speedup, val set 5.204x speedup, step: 1
Epoch 106/200 |loss: 7.664377| train set 5.448x speedup, test set 0.954x speedup, val set 5.067x speedup, step: 2
Epoch 107/200 |loss: 7.591569| train set 5.448x speedup, test set 0.954x speedup, val set 5.067x speedup, step: 3
Epoch 108/200 |loss: 7.514667| train set 5.496x speedup, test set 0.954x speedup, val set 5.107x speedup, step: 4
Epoch 109/200 |loss: 7.608224| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 5
Epoch 110/200 |loss: 7.473589| train set 5.448x speedup, test set 0.964x speedup, val set 5.067x speedup, step: 6
Epoch 111/200 |loss: 7.508765| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 7
Epoch 112/200 |loss: 7.560857| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 8
Epoch 113/200 |loss: 7.491441| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 9
Epoch 114/200 |loss: 7.430898| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 10
Epoch 115/200 |loss: 7.393226| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 11
Epoch 116/200 |loss: 7.466259| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 12
Epoch 117/200 |loss: 7.660357| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 13
Epoch 118/200 |loss: 7.429692| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 14
Epoch 119/200 |loss: 7.371505| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 15
Epoch 120/200 |loss: 7.399757| train set 5.448x speedup, test set 0.985x speedup, val set 5.067x speedup, step: 16
Epoch 121/200 |loss: 7.483579| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 17
Epoch 122/200 |loss: 7.653605| train set 5.497x speedup, test set 0.977x speedup, val set 5.106x speedup, step: 18
Epoch 123/200 |loss: 7.502105| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 19
Epoch 124/200 |loss: 7.397270| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 20
Epoch 125/200 |loss: 7.542884| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 21
Epoch 126/200 |loss: 7.616905| train set 5.496x speedup, test set 0.965x speedup, val set 5.107x speedup, step: 22
Epoch 127/200 |loss: 7.728122| train set 5.496x speedup, test set 0.965x speedup, val set 5.107x speedup, step: 23
Epoch 128/200 |loss: 7.411837| train set 5.450x speedup, test set 0.981x speedup, val set 5.070x speedup, step: 24
Epoch 129/200 |loss: 7.637064| train set 5.403x speedup, test set 0.965x speedup, val set 5.141x speedup, step: 25
Epoch 130/200 |loss: 8.043813| train set 5.496x speedup, test set 0.965x speedup, val set 5.107x speedup, step: 26
Epoch 131/200 |loss: 7.603556| train set 5.450x speedup, test set 0.976x speedup, val set 5.070x speedup, step: 27
Epoch 132/200 |loss: 8.276367| train set 5.450x speedup, test set 0.965x speedup, val set 5.195x speedup, step: 28
Epoch 133/200 |loss: 7.902336| train set 5.403x speedup, test set 0.834x speedup, val set 5.142x speedup, step: 29
Epoch 134/200 |loss: 7.950572| train set 5.496x speedup, test set 0.937x speedup, val set 5.107x speedup, step: 30
Epoch 135/200 |loss: 7.714608| train set 5.448x speedup, test set 0.937x speedup, val set 5.068x speedup, step: 31
Epoch 136/200 |loss: 7.761370| train set 5.497x speedup, test set 0.937x speedup, val set 5.106x speedup, step: 32
Epoch 137/200 |loss: 7.612163| train set 5.497x speedup, test set 0.937x speedup, val set 5.106x speedup, step: 33
Epoch 138/200 |loss: 7.668166| train set 5.497x speedup, test set 0.937x speedup, val set 5.106x speedup, step: 34
Epoch 139/200 |loss: 7.541980| train set 5.497x speedup, test set 0.936x speedup, val set 5.106x speedup, step: 35
Epoch 140/200 |loss: 7.581015| train set 5.497x speedup, test set 0.937x speedup, val set 5.106x speedup, step: 36
Epoch 141/200 |loss: 7.473239| train set 5.497x speedup, test set 0.937x speedup, val set 5.106x speedup, step: 37
Epoch 142/200 |loss: 7.505502| train set 5.448x speedup, test set 0.937x speedup, val set 5.066x speedup, step: 38
Epoch 143/200 |loss: 7.416409| train set 5.448x speedup, test set 0.937x speedup, val set 5.066x speedup, step: 39
Epoch 144/200 |loss: 7.449775| train set 5.496x speedup, test set 0.834x speedup, val set 5.105x speedup, step: 40
Epoch 145/200 |loss: 7.376749| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 41
Epoch 146/200 |loss: 7.364277| train set 5.497x speedup, test set 0.965x speedup, val set 5.106x speedup, step: 42
Epoch 147/200 |loss: 7.347943| train set 5.497x speedup, test set 0.965x speedup, val set 5.106x speedup, step: 43
Epoch 148/200 |loss: 7.318369| train set 5.497x speedup, test set 0.838x speedup, val set 5.106x speedup, step: 44
Epoch 149/200 |loss: 7.320378| train set 5.497x speedup, test set 0.838x speedup, val set 5.106x speedup, step: 45
Epoch 150/200 |loss: 7.282676| train set 5.497x speedup, test set 0.965x speedup, val set 5.106x speedup, step: 46
Epoch 151/200 |loss: 7.294321| train set 5.496x speedup, test set 0.965x speedup, val set 5.107x speedup, step: 47
Epoch 152/200 |loss: 7.306328| train set 5.496x speedup, test set 0.965x speedup, val set 5.107x speedup, step: 48
Epoch 153/200 |loss: 7.454842| train set 5.496x speedup, test set 0.977x speedup, val set 5.107x speedup, step: 49
Epoch 154/200 |loss: 7.595274| train set 5.496x speedup, test set 0.965x speedup, val set 5.107x speedup, step: 50
Epoch 155/200 |loss: 8.022776| train set 5.496x speedup, test set 0.965x speedup, val set 5.107x speedup, step: 51
Epoch 156/200 |loss: 7.398292| train set 5.496x speedup, test set 0.964x speedup, val set 5.107x speedup, step: 52
Epoch 157/200 |loss: 7.483424| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 53
Epoch 158/200 |loss: 8.010983| train set 5.496x speedup, test set 0.964x speedup, val set 5.107x speedup, step: 54
Epoch 159/200 |loss: 7.405347| train set 5.450x speedup, test set 0.976x speedup, val set 5.070x speedup, step: 55
Epoch 160/200 |loss: 7.647327| train set 5.496x speedup, test set 0.856x speedup, val set 5.107x speedup, step: 56
Epoch 161/200 |loss: 7.833184| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 57
Epoch 162/200 |loss: 7.399881| train set 5.450x speedup, test set 0.976x speedup, val set 5.070x speedup, step: 58
Epoch 163/200 |loss: 7.927223| train set 5.497x speedup, test set 0.856x speedup, val set 5.106x speedup, step: 59
Epoch 164/200 |loss: 7.437514| train set 5.498x speedup, test set 0.856x speedup, val set 5.103x speedup, step: 60
Epoch 165/200 |loss: 7.597054| train set 5.448x speedup, test set 0.855x speedup, val set 5.067x speedup, step: 61
Epoch 166/200 |loss: 7.432915| train set 5.448x speedup, test set 0.855x speedup, val set 5.067x speedup, step: 62
Epoch 167/200 |loss: 7.426450| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 63
Epoch 168/200 |loss: 7.473619| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 64
Epoch 169/200 |loss: 7.340676| train set 5.499x speedup, test set 0.964x speedup, val set 5.107x speedup, step: 65
Epoch 170/200 |loss: 7.444077| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 66
Epoch 171/200 |loss: 7.309769| train set 5.497x speedup, test set 0.856x speedup, val set 5.106x speedup, step: 67
Epoch 172/200 |loss: 7.352948| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 68
Epoch 173/200 |loss: 7.285921| train set 5.499x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 69
Epoch 174/200 |loss: 7.299237| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 70
Epoch 175/200 |loss: 7.296745| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 71
Epoch 176/200 |loss: 7.221689| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 72
Epoch 177/200 |loss: 7.284995| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 73
Epoch 178/200 |loss: 7.197461| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 74
Epoch 179/200 |loss: 7.213737| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 75
Epoch 180/200 |loss: 7.220897| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 76
Epoch 181/200 |loss: 7.171371| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 77
Epoch 182/200 |loss: 7.180893| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 78
Epoch 183/200 |loss: 7.180556| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 79
Epoch 184/200 |loss: 7.182606| train set 5.496x speedup, test set 0.837x speedup, val set 5.107x speedup, step: 80
Epoch 185/200 |loss: 7.142827| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 81
Epoch 186/200 |loss: 7.183013| train set 5.497x speedup, test set 0.837x speedup, val set 5.106x speedup, step: 82
Epoch 187/200 |loss: 7.180734| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 83
Epoch 188/200 |loss: 7.169428| train set 5.497x speedup, test set 0.838x speedup, val set 5.106x speedup, step: 84
Epoch 189/200 |loss: 7.179685| train set 5.497x speedup, test set 0.856x speedup, val set 5.106x speedup, step: 85
Epoch 190/200 |loss: 7.287473| train set 5.497x speedup, test set 0.838x speedup, val set 5.106x speedup, step: 86
Epoch 191/200 |loss: 7.274385| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 87
Epoch 192/200 |loss: 7.320962| train set 5.497x speedup, test set 0.838x speedup, val set 5.106x speedup, step: 88
Epoch 193/200 |loss: 7.175575| train set 5.497x speedup, test set 0.838x speedup, val set 5.106x speedup, step: 89
Epoch 194/200 |loss: 7.105194| train set 5.497x speedup, test set 0.856x speedup, val set 5.106x speedup, step: 90
Epoch 195/200 |loss: 7.132472| train set 5.496x speedup, test set 0.838x speedup, val set 5.107x speedup, step: 91
Epoch 196/200 |loss: 7.163692| train set 5.497x speedup, test set 0.856x speedup, val set 5.106x speedup, step: 92
Epoch 197/200 |loss: 7.238596| train set 5.497x speedup, test set 0.838x speedup, val set 5.106x speedup, step: 93
Epoch 198/200 |loss: 7.187458| train set 5.496x speedup, test set 0.838x speedup, val set 5.107x speedup, step: 94
Epoch 199/200 |loss: 7.206169| train set 5.496x speedup, test set 0.856x speedup, val set 5.107x speedup, step: 95
Training per epoch cost 0.233 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.733s, pg runtime 0.354s, speedup 0.482x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 1.143s, pg runtime 0.891s, speedup 0.780x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 169, train speedup 5.499, test speedup 0.964, val speedup 5.107
best test speedup epoch: 19, train speedup 4.803, test speedup 2.845, val speedup 4.539
best validation speedup epoch: 105, train speedup 5.445, test speedup 0.954, val speedup 5.204
last model at epoch 199, train speedup 5.496, test speedup 0.856, val speedup 5.107
execution cost 0:02:22.332053
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.859286, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055296| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995953| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037216| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524693| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074823| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570261| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.080351| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.587442| train set 4.418x speedup, test set 0.983x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.083750| train set 4.548x speedup, test set 0.996x speedup, val set 4.274x speedup, step: 14
Epoch 14/200 |loss: 17.616127| train set 4.548x speedup, test set 1.015x speedup, val set 4.239x speedup, step: 15
Epoch 15/200 |loss: 17.115368| train set 4.548x speedup, test set 1.060x speedup, val set 4.239x speedup, step: 16
Epoch 16/200 |loss: 16.671051| train set 4.423x speedup, test set 1.062x speedup, val set 4.195x speedup, step: 17
Epoch 17/200 |loss: 16.239557| train set 4.419x speedup, test set 1.081x speedup, val set 4.157x speedup, step: 18
Epoch 18/200 |loss: 15.848814| train set 4.702x speedup, test set 3.037x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.521123| train set 4.832x speedup, test set 1.077x speedup, val set 4.526x speedup, step: 20
Epoch 20/200 |loss: 15.085019| train set 5.009x speedup, test set 2.706x speedup, val set 4.783x speedup, step: 21
Epoch 21/200 |loss: 14.612598| train set 5.431x speedup, test set 1.071x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.256335| train set 5.285x speedup, test set 1.078x speedup, val set 4.961x speedup, step: 23
Epoch 23/200 |loss: 14.009465| train set 5.431x speedup, test set 1.093x speedup, val set 5.070x speedup, step: 24
Epoch 24/200 |loss: 13.729736| train set 5.472x speedup, test set 1.094x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.286304| train set 5.497x speedup, test set 1.077x speedup, val set 5.106x speedup, step: 26
Epoch 26/200 |loss: 12.882178| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.616600| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 28
Epoch 28/200 |loss: 12.432821| train set 5.060x speedup, test set 1.089x speedup, val set 4.671x speedup, step: 29
Epoch 29/200 |loss: 12.191739| train set 5.496x speedup, test set 1.074x speedup, val set 5.105x speedup, step: 30
Epoch 30/200 |loss: 12.365410| train set 5.497x speedup, test set 1.081x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 12.102776| train set 5.424x speedup, test set 1.096x speedup, val set 5.040x speedup, step: 32
Epoch 32/200 |loss: 11.493571| train set 5.496x speedup, test set 1.052x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.540757| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 11.062526| train set 5.497x speedup, test set 1.001x speedup, val set 5.106x speedup, step: 35
Epoch 35/200 |loss: 11.106560| train set 5.497x speedup, test set 1.066x speedup, val set 5.106x speedup, step: 36
Epoch 36/200 |loss: 10.871979| train set 5.497x speedup, test set 1.066x speedup, val set 5.106x speedup, step: 37
Epoch 37/200 |loss: 10.321242| train set 5.496x speedup, test set 0.989x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.441118| train set 5.496x speedup, test set 1.081x speedup, val set 5.105x speedup, step: 39
Epoch 39/200 |loss: 9.979436| train set 5.497x speedup, test set 1.066x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.174962| train set 5.497x speedup, test set 1.065x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 9.927267| train set 5.497x speedup, test set 0.989x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 10.310315| train set 5.497x speedup, test set 1.065x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 10.294358| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 9.886320| train set 5.497x speedup, test set 1.075x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.535260| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.640482| train set 5.380x speedup, test set 1.060x speedup, val set 4.911x speedup, step: 47
Epoch 47/200 |loss: 10.029693| train set 5.448x speedup, test set 0.990x speedup, val set 5.067x speedup, step: 48
Epoch 48/200 |loss: 10.434251| train set 5.449x speedup, test set 1.076x speedup, val set 5.193x speedup, step: 49
Epoch 49/200 |loss: 10.402454| train set 5.404x speedup, test set 1.076x speedup, val set 5.140x speedup, step: 50
Epoch 50/200 |loss: 10.405650| train set 5.497x speedup, test set 0.972x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.722821| train set 5.497x speedup, test set 1.060x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.835086| train set 5.497x speedup, test set 1.032x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 9.567923| train set 5.497x speedup, test set 0.909x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.617456| train set 5.496x speedup, test set 1.061x speedup, val set 5.105x speedup, step: 55
Epoch 55/200 |loss: 9.275178| train set 5.497x speedup, test set 1.062x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 9.201371| train set 5.497x speedup, test set 1.062x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 9.134261| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.966809| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.843535| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.723797| train set 5.497x speedup, test set 0.991x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.656537| train set 5.497x speedup, test set 0.978x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.654403| train set 5.497x speedup, test set 0.988x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 8.512828| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.572408| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.586406| train set 5.497x speedup, test set 0.978x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.612137| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.678415| train set 5.448x speedup, test set 0.955x speedup, val set 5.067x speedup, step: 68
Epoch 68/200 |loss: 8.529176| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.310736| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.205548| train set 5.448x speedup, test set 0.959x speedup, val set 5.067x speedup, step: 71
Epoch 71/200 |loss: 8.242599| train set 5.497x speedup, test set 0.958x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.317052| train set 5.497x speedup, test set 0.958x speedup, val set 5.103x speedup, step: 73
Epoch 73/200 |loss: 8.175903| train set 5.496x speedup, test set 0.958x speedup, val set 5.105x speedup, step: 74
Epoch 74/200 |loss: 8.116241| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 8.073859| train set 5.496x speedup, test set 0.955x speedup, val set 5.105x speedup, step: 76
Epoch 76/200 |loss: 7.998741| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 8.021715| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 7.890430| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 7.834478| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 7.898173| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 81
Epoch 81/200 |loss: 7.906536| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 82
Epoch 82/200 |loss: 8.169935| train set 5.404x speedup, test set 0.943x speedup, val set 5.140x speedup, step: 83
Epoch 83/200 |loss: 8.596245| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 84
Epoch 84/200 |loss: 8.371610| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 8.286950| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 86
Epoch 86/200 |loss: 8.328156| train set 5.496x speedup, test set 0.977x speedup, val set 5.107x speedup, step: 87
Epoch 87/200 |loss: 8.112729| train set 5.449x speedup, test set 0.943x speedup, val set 5.194x speedup, step: 88
Epoch 88/200 |loss: 8.121408| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 89
Epoch 89/200 |loss: 8.094250| train set 5.448x speedup, test set 0.967x speedup, val set 5.068x speedup, step: 90
Epoch 90/200 |loss: 8.061406| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 91
Epoch 91/200 |loss: 7.915923| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 8.193367| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 93
Epoch 93/200 |loss: 7.860710| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 94
Epoch 94/200 |loss: 7.835595| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 7.994591| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 7.598126| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 7.919887| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 98
Epoch 98/200 |loss: 7.737765| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.680466| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.730036| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 1
Epoch 101/200 |loss: 7.705026| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 1
Epoch 102/200 |loss: 7.683633| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 1
Epoch 103/200 |loss: 7.613335| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 1
Epoch 104/200 |loss: 7.708032| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 1
Epoch 105/200 |loss: 7.531323| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 2
Epoch 106/200 |loss: 7.632362| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 1
Epoch 107/200 |loss: 7.592224| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 1
Epoch 108/200 |loss: 7.505994| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 1
Epoch 109/200 |loss: 7.527458| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 1
Epoch 110/200 |loss: 7.549450| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 1
Epoch 111/200 |loss: 7.487812| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 2
Epoch 112/200 |loss: 7.574619| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 1
Epoch 113/200 |loss: 7.627942| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 1
Epoch 114/200 |loss: 7.712185| train set 5.450x speedup, test set 0.955x speedup, val set 5.195x speedup, step: 1
Epoch 115/200 |loss: 7.896001| train set 5.448x speedup, test set 0.967x speedup, val set 5.068x speedup, step: 2
Epoch 116/200 |loss: 7.481699| train set 5.447x speedup, test set 0.938x speedup, val set 5.068x speedup, step: 3
Epoch 117/200 |loss: 7.754492| train set 5.449x speedup, test set 0.943x speedup, val set 5.194x speedup, step: 4
Epoch 118/200 |loss: 8.121835| train set 5.497x speedup, test set 0.938x speedup, val set 5.106x speedup, step: 5
Epoch 119/200 |loss: 7.814400| train set 5.448x speedup, test set 0.938x speedup, val set 5.068x speedup, step: 6
Epoch 120/200 |loss: 7.945437| train set 5.449x speedup, test set 0.943x speedup, val set 5.195x speedup, step: 1
Epoch 121/200 |loss: 8.141551| train set 5.496x speedup, test set 0.943x speedup, val set 5.107x speedup, step: 2
Epoch 122/200 |loss: 7.618046| train set 5.448x speedup, test set 0.938x speedup, val set 5.068x speedup, step: 3
Epoch 123/200 |loss: 7.944299| train set 5.496x speedup, test set 0.916x speedup, val set 5.107x speedup, step: 4
Epoch 124/200 |loss: 7.606217| train set 5.456x speedup, test set 0.943x speedup, val set 5.205x speedup, step: 1
Epoch 125/200 |loss: 7.722633| train set 5.448x speedup, test set 0.976x speedup, val set 5.068x speedup, step: 2
Epoch 126/200 |loss: 7.690423| train set 5.497x speedup, test set 0.848x speedup, val set 5.106x speedup, step: 3
Epoch 127/200 |loss: 7.570467| train set 5.497x speedup, test set 0.952x speedup, val set 5.106x speedup, step: 4
Epoch 128/200 |loss: 7.556777| train set 5.448x speedup, test set 0.964x speedup, val set 5.067x speedup, step: 5
Epoch 129/200 |loss: 7.495975| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 6
Epoch 130/200 |loss: 7.498458| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 7
Epoch 131/200 |loss: 7.488352| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 8
Epoch 132/200 |loss: 7.467363| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 9
Epoch 133/200 |loss: 7.388164| train set 5.497x speedup, test set 0.857x speedup, val set 5.106x speedup, step: 10
Epoch 134/200 |loss: 7.454825| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 11
Epoch 135/200 |loss: 7.422556| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 12
Epoch 136/200 |loss: 7.426149| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 13
Epoch 137/200 |loss: 7.356874| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 14
Epoch 138/200 |loss: 7.380093| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 15
Epoch 139/200 |loss: 7.363888| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 16
Epoch 140/200 |loss: 7.347567| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 17
Epoch 141/200 |loss: 7.337815| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 18
Epoch 142/200 |loss: 7.432225| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 19
Epoch 143/200 |loss: 7.356760| train set 5.497x speedup, test set 0.857x speedup, val set 5.106x speedup, step: 20
Epoch 144/200 |loss: 7.344897| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 21
Epoch 145/200 |loss: 7.309946| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 22
Epoch 146/200 |loss: 7.247187| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 23
Epoch 147/200 |loss: 7.290705| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 24
Epoch 148/200 |loss: 7.272101| train set 5.497x speedup, test set 0.857x speedup, val set 5.106x speedup, step: 25
Epoch 149/200 |loss: 7.313448| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 26
Epoch 150/200 |loss: 7.276644| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 27
Epoch 151/200 |loss: 7.319138| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 28
Epoch 152/200 |loss: 7.393819| train set 5.451x speedup, test set 0.857x speedup, val set 5.069x speedup, step: 29
Epoch 153/200 |loss: 7.616559| train set 5.450x speedup, test set 0.848x speedup, val set 5.195x speedup, step: 30
Epoch 154/200 |loss: 8.038841| train set 5.448x speedup, test set 0.857x speedup, val set 5.068x speedup, step: 31
Epoch 155/200 |loss: 7.396861| train set 5.450x speedup, test set 0.938x speedup, val set 5.070x speedup, step: 32
Epoch 156/200 |loss: 7.880888| train set 5.450x speedup, test set 0.848x speedup, val set 5.195x speedup, step: 33
Epoch 157/200 |loss: 8.394780| train set 5.496x speedup, test set 0.848x speedup, val set 5.107x speedup, step: 34
Epoch 158/200 |loss: 7.880109| train set 5.448x speedup, test set 0.864x speedup, val set 5.068x speedup, step: 35
Epoch 159/200 |loss: 7.923853| train set 5.449x speedup, test set 0.835x speedup, val set 5.065x speedup, step: 36
Epoch 160/200 |loss: 7.679924| train set 5.449x speedup, test set 0.835x speedup, val set 5.194x speedup, step: 37
Epoch 161/200 |loss: 7.744246| train set 5.496x speedup, test set 0.835x speedup, val set 5.107x speedup, step: 38
Epoch 162/200 |loss: 7.572195| train set 5.448x speedup, test set 0.836x speedup, val set 5.068x speedup, step: 39
Epoch 163/200 |loss: 7.680129| train set 5.496x speedup, test set 0.826x speedup, val set 5.105x speedup, step: 40
Epoch 164/200 |loss: 7.503693| train set 5.496x speedup, test set 0.817x speedup, val set 5.105x speedup, step: 41
Epoch 165/200 |loss: 7.562374| train set 5.448x speedup, test set 0.817x speedup, val set 5.067x speedup, step: 42
Epoch 166/200 |loss: 7.532084| train set 5.497x speedup, test set 0.864x speedup, val set 5.106x speedup, step: 43
Epoch 167/200 |loss: 7.424210| train set 5.497x speedup, test set 0.864x speedup, val set 5.106x speedup, step: 44
Epoch 168/200 |loss: 7.490198| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 45
Epoch 169/200 |loss: 7.369881| train set 5.448x speedup, test set 0.835x speedup, val set 5.067x speedup, step: 46
Epoch 170/200 |loss: 7.355839| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 47
Epoch 171/200 |loss: 7.389931| train set 5.496x speedup, test set 0.843x speedup, val set 5.107x speedup, step: 48
Epoch 172/200 |loss: 7.333935| train set 5.496x speedup, test set 0.843x speedup, val set 5.107x speedup, step: 49
Epoch 173/200 |loss: 7.324481| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 50
Epoch 174/200 |loss: 7.292570| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 51
Epoch 175/200 |loss: 7.260608| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 52
Epoch 176/200 |loss: 7.241620| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 53
Epoch 177/200 |loss: 7.235291| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 54
Epoch 178/200 |loss: 7.221369| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 55
Epoch 179/200 |loss: 7.201103| train set 5.497x speedup, test set 0.857x speedup, val set 5.106x speedup, step: 56
Epoch 180/200 |loss: 7.227509| train set 5.497x speedup, test set 0.857x speedup, val set 5.106x speedup, step: 57
Epoch 181/200 |loss: 7.249568| train set 5.497x speedup, test set 0.857x speedup, val set 5.106x speedup, step: 58
Epoch 182/200 |loss: 7.406637| train set 5.497x speedup, test set 0.857x speedup, val set 5.106x speedup, step: 59
Epoch 183/200 |loss: 7.585361| train set 5.448x speedup, test set 0.835x speedup, val set 5.068x speedup, step: 60
Epoch 184/200 |loss: 8.138236| train set 5.496x speedup, test set 0.948x speedup, val set 5.107x speedup, step: 61
Epoch 185/200 |loss: 7.446046| train set 5.496x speedup, test set 0.843x speedup, val set 5.107x speedup, step: 62
Epoch 186/200 |loss: 7.355434| train set 5.448x speedup, test set 0.843x speedup, val set 5.068x speedup, step: 63
Epoch 187/200 |loss: 7.758178| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 64
Epoch 188/200 |loss: 7.394701| train set 5.496x speedup, test set 0.843x speedup, val set 5.107x speedup, step: 65
Epoch 189/200 |loss: 7.384043| train set 5.496x speedup, test set 0.843x speedup, val set 5.107x speedup, step: 66
Epoch 190/200 |loss: 7.576858| train set 5.497x speedup, test set 0.873x speedup, val set 5.106x speedup, step: 67
Epoch 191/200 |loss: 7.264785| train set 5.499x speedup, test set 0.872x speedup, val set 5.107x speedup, step: 68
Epoch 192/200 |loss: 7.486295| train set 5.497x speedup, test set 0.843x speedup, val set 5.106x speedup, step: 69
Epoch 193/200 |loss: 7.443586| train set 5.497x speedup, test set 0.873x speedup, val set 5.106x speedup, step: 70
Epoch 194/200 |loss: 7.270052| train set 5.497x speedup, test set 0.873x speedup, val set 5.106x speedup, step: 71
Epoch 195/200 |loss: 7.518935| train set 5.497x speedup, test set 0.843x speedup, val set 5.106x speedup, step: 72
Epoch 196/200 |loss: 7.333027| train set 5.497x speedup, test set 0.873x speedup, val set 5.106x speedup, step: 73
Epoch 197/200 |loss: 7.314528| train set 5.497x speedup, test set 0.843x speedup, val set 5.106x speedup, step: 74
Epoch 198/200 |loss: 7.382805| train set 5.497x speedup, test set 0.843x speedup, val set 5.106x speedup, step: 75
Epoch 199/200 |loss: 7.226695| train set 5.497x speedup, test set 0.843x speedup, val set 5.106x speedup, step: 76
Training per epoch cost 0.230 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.206s, pg runtime 0.206s, speedup 1.000x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.611s, pg runtime 0.354s, speedup 0.579x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 1.143s, pg runtime 0.891s, speedup 0.780x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 191, train speedup 5.499, test speedup 0.872, val speedup 5.107
best test speedup epoch: 18, train speedup 4.702, test speedup 3.037, val speedup 4.471
best validation speedup epoch: 124, train speedup 5.456, test speedup 0.943, val speedup 5.205
last model at epoch 199, train speedup 5.497, test speedup 0.843, val speedup 5.106
execution cost 0:02:23.070407
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.853614, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037216| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524693| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074823| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570261| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.080351| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.587440| train set 4.418x speedup, test set 0.983x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.083750| train set 4.548x speedup, test set 0.996x speedup, val set 4.274x speedup, step: 14
Epoch 14/200 |loss: 17.616127| train set 4.548x speedup, test set 1.015x speedup, val set 4.239x speedup, step: 15
Epoch 15/200 |loss: 17.115368| train set 4.548x speedup, test set 1.060x speedup, val set 4.239x speedup, step: 16
Epoch 16/200 |loss: 16.671051| train set 4.423x speedup, test set 1.062x speedup, val set 4.195x speedup, step: 17
Epoch 17/200 |loss: 16.239559| train set 4.419x speedup, test set 1.081x speedup, val set 4.157x speedup, step: 18
Epoch 18/200 |loss: 15.848814| train set 4.702x speedup, test set 3.037x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.521123| train set 4.832x speedup, test set 1.077x speedup, val set 4.526x speedup, step: 20
Epoch 20/200 |loss: 15.085019| train set 5.009x speedup, test set 2.706x speedup, val set 4.783x speedup, step: 21
Epoch 21/200 |loss: 14.612598| train set 5.431x speedup, test set 1.071x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.256334| train set 5.285x speedup, test set 1.078x speedup, val set 4.961x speedup, step: 23
Epoch 23/200 |loss: 14.009465| train set 5.431x speedup, test set 1.093x speedup, val set 5.070x speedup, step: 24
Epoch 24/200 |loss: 13.729709| train set 5.472x speedup, test set 1.094x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.286242| train set 5.497x speedup, test set 1.077x speedup, val set 5.106x speedup, step: 26
Epoch 26/200 |loss: 12.882252| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.617251| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 28
Epoch 28/200 |loss: 12.438889| train set 5.060x speedup, test set 1.089x speedup, val set 4.671x speedup, step: 29
Epoch 29/200 |loss: 12.179893| train set 5.496x speedup, test set 1.074x speedup, val set 5.105x speedup, step: 30
Epoch 30/200 |loss: 12.348228| train set 5.497x speedup, test set 1.081x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 12.047950| train set 5.424x speedup, test set 1.002x speedup, val set 5.040x speedup, step: 32
Epoch 32/200 |loss: 11.512525| train set 5.496x speedup, test set 1.052x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.540094| train set 5.497x speedup, test set 1.096x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 10.928813| train set 5.497x speedup, test set 1.001x speedup, val set 5.106x speedup, step: 35
Epoch 35/200 |loss: 10.870004| train set 5.497x speedup, test set 1.081x speedup, val set 5.106x speedup, step: 36
Epoch 36/200 |loss: 10.929078| train set 5.497x speedup, test set 1.075x speedup, val set 5.106x speedup, step: 37
Epoch 37/200 |loss: 10.854335| train set 5.497x speedup, test set 0.991x speedup, val set 5.106x speedup, step: 38
Epoch 38/200 |loss: 11.118607| train set 5.229x speedup, test set 1.076x speedup, val set 5.062x speedup, step: 39
Epoch 39/200 |loss: 10.513391| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.435838| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 10.530156| train set 5.497x speedup, test set 1.060x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 9.995757| train set 5.497x speedup, test set 0.999x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 10.240274| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 10.095311| train set 5.496x speedup, test set 1.062x speedup, val set 5.105x speedup, step: 45
Epoch 45/200 |loss: 9.764809| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.840538| train set 5.497x speedup, test set 0.972x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.572869| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.255072| train set 5.497x speedup, test set 1.060x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.274620| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.064440| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 8.949568| train set 5.497x speedup, test set 1.049x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 8.980675| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 8.991053| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.023749| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.871563| train set 5.497x speedup, test set 1.049x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.612663| train set 5.497x speedup, test set 1.049x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.494179| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.503331| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.490726| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 60
Epoch 60/200 |loss: 8.415149| train set 5.497x speedup, test set 1.049x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.343581| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 62
Epoch 62/200 |loss: 8.377767| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 8.593863| train set 5.448x speedup, test set 0.975x speedup, val set 5.064x speedup, step: 64
Epoch 64/200 |loss: 8.590847| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.315071| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 66
Epoch 66/200 |loss: 8.311896| train set 5.404x speedup, test set 0.963x speedup, val set 5.141x speedup, step: 67
Epoch 67/200 |loss: 8.543555| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.532748| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.441578| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.078230| train set 5.496x speedup, test set 0.974x speedup, val set 5.107x speedup, step: 71
Epoch 71/200 |loss: 8.518996| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 72
Epoch 72/200 |loss: 8.348250| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 73
Epoch 73/200 |loss: 8.402842| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 74
Epoch 74/200 |loss: 8.286814| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 75
Epoch 75/200 |loss: 8.071255| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 76
Epoch 76/200 |loss: 8.110452| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 7.987977| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 7.971727| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 7.896677| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 80
Epoch 80/200 |loss: 7.895893| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 81
Epoch 81/200 |loss: 7.881623| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 7.873966| train set 5.450x speedup, test set 0.966x speedup, val set 5.193x speedup, step: 83
Epoch 83/200 |loss: 8.164519| train set 5.448x speedup, test set 0.977x speedup, val set 5.068x speedup, step: 84
Epoch 84/200 |loss: 8.100661| train set 5.449x speedup, test set 0.966x speedup, val set 5.055x speedup, step: 85
Epoch 85/200 |loss: 8.590102| train set 5.448x speedup, test set 0.858x speedup, val set 5.068x speedup, step: 86
Epoch 86/200 |loss: 8.295074| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 87
Epoch 87/200 |loss: 7.844554| train set 5.404x speedup, test set 0.963x speedup, val set 5.140x speedup, step: 88
Epoch 88/200 |loss: 8.201703| train set 5.448x speedup, test set 0.864x speedup, val set 5.067x speedup, step: 89
Epoch 89/200 |loss: 8.076827| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 90
Epoch 90/200 |loss: 7.851574| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.878185| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.926515| train set 5.448x speedup, test set 0.963x speedup, val set 5.067x speedup, step: 93
Epoch 93/200 |loss: 7.631883| train set 5.449x speedup, test set 0.963x speedup, val set 5.193x speedup, step: 94
Epoch 94/200 |loss: 8.147635| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 95
Epoch 95/200 |loss: 7.752346| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 7.683139| train set 5.496x speedup, test set 0.963x speedup, val set 5.105x speedup, step: 97
Epoch 97/200 |loss: 7.668179| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 98
Epoch 98/200 |loss: 7.684498| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.895853| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.689945| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 1
Epoch 101/200 |loss: 7.702557| train set 5.497x speedup, test set 0.938x speedup, val set 5.106x speedup, step: 1
Epoch 102/200 |loss: 7.715319| train set 5.497x speedup, test set 0.938x speedup, val set 5.106x speedup, step: 1
Epoch 103/200 |loss: 7.725872| train set 5.496x speedup, test set 0.926x speedup, val set 5.107x speedup, step: 1
Epoch 104/200 |loss: 7.713267| train set 5.496x speedup, test set 0.938x speedup, val set 5.107x speedup, step: 1
Epoch 105/200 |loss: 7.573544| train set 5.307x speedup, test set 0.938x speedup, val set 4.964x speedup, step: 2
Epoch 106/200 |loss: 7.560789| train set 5.496x speedup, test set 0.926x speedup, val set 5.107x speedup, step: 1
Epoch 107/200 |loss: 7.610397| train set 5.448x speedup, test set 0.975x speedup, val set 5.068x speedup, step: 2
Epoch 108/200 |loss: 7.572646| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 1
Epoch 109/200 |loss: 7.537648| train set 5.448x speedup, test set 0.938x speedup, val set 5.068x speedup, step: 2
Epoch 110/200 |loss: 7.641624| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 1
Epoch 111/200 |loss: 7.558599| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 2
Epoch 112/200 |loss: 7.531711| train set 5.497x speedup, test set 0.938x speedup, val set 5.106x speedup, step: 3
Epoch 113/200 |loss: 7.471408| train set 5.496x speedup, test set 0.938x speedup, val set 5.107x speedup, step: 1
Epoch 114/200 |loss: 7.501987| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 2
Epoch 115/200 |loss: 7.601017| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 3
Epoch 116/200 |loss: 7.940911| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 4
Epoch 117/200 |loss: 7.436946| train set 5.450x speedup, test set 0.938x speedup, val set 5.070x speedup, step: 5
Epoch 118/200 |loss: 7.880459| train set 5.449x speedup, test set 0.825x speedup, val set 5.195x speedup, step: 1
Epoch 119/200 |loss: 8.598060| train set 5.496x speedup, test set 0.926x speedup, val set 5.107x speedup, step: 2
Epoch 120/200 |loss: 7.805582| train set 5.448x speedup, test set 0.938x speedup, val set 5.068x speedup, step: 3
Epoch 121/200 |loss: 8.372971| train set 5.307x speedup, test set 0.926x speedup, val set 4.964x speedup, step: 4
Epoch 122/200 |loss: 7.680405| train set 5.449x speedup, test set 0.926x speedup, val set 5.056x speedup, step: 5
Epoch 123/200 |loss: 7.900921| train set 5.496x speedup, test set 0.937x speedup, val set 5.107x speedup, step: 6
Epoch 124/200 |loss: 7.690518| train set 5.496x speedup, test set 0.926x speedup, val set 5.107x speedup, step: 7
Epoch 125/200 |loss: 7.641848| train set 5.497x speedup, test set 0.926x speedup, val set 5.106x speedup, step: 8
Epoch 126/200 |loss: 7.657593| train set 5.448x speedup, test set 0.836x speedup, val set 5.067x speedup, step: 9
Epoch 127/200 |loss: 7.533780| train set 5.448x speedup, test set 0.834x speedup, val set 5.064x speedup, step: 10
Epoch 128/200 |loss: 7.568570| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 11
Epoch 129/200 |loss: 7.551643| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 12
Epoch 130/200 |loss: 7.432005| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 13
Epoch 131/200 |loss: 7.504233| train set 5.497x speedup, test set 0.825x speedup, val set 5.106x speedup, step: 14
Epoch 132/200 |loss: 7.440907| train set 5.496x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 15
Epoch 133/200 |loss: 7.400013| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 16
Epoch 134/200 |loss: 7.375710| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 17
Epoch 135/200 |loss: 7.372128| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 18
Epoch 136/200 |loss: 7.356510| train set 5.448x speedup, test set 0.834x speedup, val set 5.067x speedup, step: 19
Epoch 137/200 |loss: 7.333776| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 20
Epoch 138/200 |loss: 7.315532| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 21
Epoch 139/200 |loss: 7.324166| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 22
Epoch 140/200 |loss: 7.273892| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 23
Epoch 141/200 |loss: 7.266407| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 24
Epoch 142/200 |loss: 7.254453| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 25
Epoch 143/200 |loss: 7.254293| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 26
Epoch 144/200 |loss: 7.280855| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 27
Epoch 145/200 |loss: 7.319608| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 28
Epoch 146/200 |loss: 7.349561| train set 5.497x speedup, test set 0.826x speedup, val set 5.106x speedup, step: 29
Epoch 147/200 |loss: 7.544096| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 30
Epoch 148/200 |loss: 7.409715| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 31
Epoch 149/200 |loss: 7.388323| train set 5.497x speedup, test set 0.826x speedup, val set 5.106x speedup, step: 32
Epoch 150/200 |loss: 7.312960| train set 5.448x speedup, test set 0.835x speedup, val set 5.067x speedup, step: 33
Epoch 151/200 |loss: 7.300595| train set 5.497x speedup, test set 0.826x speedup, val set 5.106x speedup, step: 34
Epoch 152/200 |loss: 7.340497| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 35
Epoch 153/200 |loss: 7.274990| train set 5.451x speedup, test set 0.835x speedup, val set 5.069x speedup, step: 36
Epoch 154/200 |loss: 7.360689| train set 5.497x speedup, test set 0.826x speedup, val set 5.106x speedup, step: 37
Epoch 155/200 |loss: 7.465625| train set 5.448x speedup, test set 0.835x speedup, val set 5.068x speedup, step: 38
Epoch 156/200 |loss: 7.242857| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 39
Epoch 157/200 |loss: 7.199036| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 40
Epoch 158/200 |loss: 7.296568| train set 5.448x speedup, test set 0.865x speedup, val set 5.067x speedup, step: 41
Epoch 159/200 |loss: 7.270651| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 42
Epoch 160/200 |loss: 7.224204| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 43
Epoch 161/200 |loss: 7.216796| train set 5.499x speedup, test set 0.865x speedup, val set 5.109x speedup, step: 44
Epoch 162/200 |loss: 7.321065| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 45
Epoch 163/200 |loss: 7.535906| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 46
Epoch 164/200 |loss: 7.274514| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 47
Epoch 165/200 |loss: 7.329051| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 48
Epoch 166/200 |loss: 7.322963| train set 5.448x speedup, test set 0.865x speedup, val set 5.068x speedup, step: 49
Epoch 167/200 |loss: 7.283536| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 50
Epoch 168/200 |loss: 7.359379| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 51
Epoch 169/200 |loss: 7.315114| train set 5.448x speedup, test set 0.865x speedup, val set 5.067x speedup, step: 52
Epoch 170/200 |loss: 7.341731| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 53
Epoch 171/200 |loss: 7.143577| train set 5.496x speedup, test set 0.865x speedup, val set 5.107x speedup, step: 54
Epoch 172/200 |loss: 7.290311| train set 5.448x speedup, test set 0.865x speedup, val set 5.067x speedup, step: 55
Epoch 173/200 |loss: 7.394606| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 56
Epoch 174/200 |loss: 7.406975| train set 5.448x speedup, test set 0.836x speedup, val set 5.068x speedup, step: 57
Epoch 175/200 |loss: 7.514085| train set 5.496x speedup, test set 0.835x speedup, val set 5.107x speedup, step: 58
Epoch 176/200 |loss: 7.241313| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 59
Epoch 177/200 |loss: 7.357284| train set 5.451x speedup, test set 0.835x speedup, val set 5.069x speedup, step: 60
Epoch 178/200 |loss: 7.404908| train set 5.497x speedup, test set 0.826x speedup, val set 5.106x speedup, step: 61
Epoch 179/200 |loss: 7.395024| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 62
Epoch 180/200 |loss: 7.265861| train set 5.451x speedup, test set 0.835x speedup, val set 5.069x speedup, step: 63
Epoch 181/200 |loss: 7.300090| train set 5.460x speedup, test set 0.827x speedup, val set 5.204x speedup, step: 1
Epoch 182/200 |loss: 7.328399| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 2
Epoch 183/200 |loss: 7.247431| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 3
Epoch 184/200 |loss: 7.208457| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 4
Epoch 185/200 |loss: 7.241587| train set 5.497x speedup, test set 0.836x speedup, val set 5.106x speedup, step: 5
Epoch 186/200 |loss: 7.209504| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 6
Epoch 187/200 |loss: 7.191163| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 7
Epoch 188/200 |loss: 7.174933| train set 5.497x speedup, test set 0.836x speedup, val set 5.106x speedup, step: 8
Epoch 189/200 |loss: 7.163242| train set 5.496x speedup, test set 0.836x speedup, val set 5.107x speedup, step: 9
Epoch 190/200 |loss: 7.196995| train set 5.449x speedup, test set 0.836x speedup, val set 5.065x speedup, step: 10
Epoch 191/200 |loss: 7.183409| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 11
Epoch 192/200 |loss: 7.119534| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 12
Epoch 193/200 |loss: 7.143929| train set 5.496x speedup, test set 0.835x speedup, val set 5.107x speedup, step: 13
Epoch 194/200 |loss: 7.204021| train set 5.448x speedup, test set 0.835x speedup, val set 5.067x speedup, step: 14
Epoch 195/200 |loss: 7.282688| train set 5.496x speedup, test set 0.835x speedup, val set 5.107x speedup, step: 15
Epoch 196/200 |loss: 7.916458| train set 5.499x speedup, test set 0.835x speedup, val set 5.107x speedup, step: 16
Epoch 197/200 |loss: 7.461394| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 17
Epoch 198/200 |loss: 7.474902| train set 5.448x speedup, test set 0.836x speedup, val set 5.068x speedup, step: 18
Epoch 199/200 |loss: 7.829979| train set 5.448x speedup, test set 0.836x speedup, val set 5.068x speedup, step: 19
Training per epoch cost 0.240 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 8.896s, pg runtime 2.959s, speedup 0.333x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 0.433s, pg runtime 0.389s, speedup 0.898x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 12.105s, pg runtime 0.023s, speedup 0.002x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 196, train speedup 5.499, test speedup 0.835, val speedup 5.107
best test speedup epoch: 18, train speedup 4.702, test speedup 3.037, val speedup 4.471
best validation speedup epoch: 181, train speedup 5.460, test speedup 0.827, val speedup 5.204
last model at epoch 199, train speedup 5.448, test speedup 0.836, val speedup 5.068
execution cost 0:02:25.729728
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.844467, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055296| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037216| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524693| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074823| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570261| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.080355| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.587553| train set 4.418x speedup, test set 0.983x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.083212| train set 4.418x speedup, test set 0.991x speedup, val set 4.129x speedup, step: 14
Epoch 14/200 |loss: 17.617689| train set 4.548x speedup, test set 0.991x speedup, val set 4.274x speedup, step: 15
Epoch 15/200 |loss: 17.116896| train set 4.498x speedup, test set 1.060x speedup, val set 4.228x speedup, step: 16
Epoch 16/200 |loss: 16.685041| train set 4.423x speedup, test set 1.062x speedup, val set 4.195x speedup, step: 17
Epoch 17/200 |loss: 16.256372| train set 4.419x speedup, test set 2.765x speedup, val set 4.157x speedup, step: 18
Epoch 18/200 |loss: 15.840766| train set 4.702x speedup, test set 3.036x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.455141| train set 4.803x speedup, test set 1.053x speedup, val set 4.539x speedup, step: 20
Epoch 20/200 |loss: 15.094977| train set 4.978x speedup, test set 1.071x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.622653| train set 5.431x speedup, test set 1.077x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.206778| train set 5.212x speedup, test set 1.077x speedup, val set 4.944x speedup, step: 23
Epoch 23/200 |loss: 13.865062| train set 5.431x speedup, test set 1.093x speedup, val set 5.069x speedup, step: 24
Epoch 24/200 |loss: 13.747254| train set 5.496x speedup, test set 1.063x speedup, val set 5.105x speedup, step: 25
Epoch 25/200 |loss: 13.708878| train set 5.496x speedup, test set 1.094x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.039452| train set 5.472x speedup, test set 1.000x speedup, val set 5.104x speedup, step: 27
Epoch 27/200 |loss: 12.782213| train set 5.496x speedup, test set 1.060x speedup, val set 5.105x speedup, step: 28
Epoch 28/200 |loss: 12.786608| train set 5.496x speedup, test set 1.063x speedup, val set 5.105x speedup, step: 29
Epoch 29/200 |loss: 12.155005| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 30
Epoch 30/200 |loss: 12.133525| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.755590| train set 5.496x speedup, test set 1.060x speedup, val set 5.105x speedup, step: 32
Epoch 32/200 |loss: 11.688149| train set 5.497x speedup, test set 0.978x speedup, val set 5.106x speedup, step: 33
Epoch 33/200 |loss: 11.209402| train set 5.496x speedup, test set 0.979x speedup, val set 5.105x speedup, step: 34
Epoch 34/200 |loss: 10.938280| train set 5.496x speedup, test set 1.075x speedup, val set 5.105x speedup, step: 35
Epoch 35/200 |loss: 11.086687| train set 5.496x speedup, test set 1.058x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 10.821682| train set 5.424x speedup, test set 0.984x speedup, val set 5.040x speedup, step: 37
Epoch 37/200 |loss: 11.094969| train set 5.496x speedup, test set 0.980x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.206427| train set 5.496x speedup, test set 1.058x speedup, val set 5.105x speedup, step: 39
Epoch 39/200 |loss: 10.305228| train set 5.497x speedup, test set 0.984x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.222012| train set 5.308x speedup, test set 0.979x speedup, val set 4.963x speedup, step: 41
Epoch 41/200 |loss: 10.454615| train set 5.497x speedup, test set 0.984x speedup, val set 5.103x speedup, step: 42
Epoch 42/200 |loss: 9.770450| train set 5.497x speedup, test set 1.074x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.999172| train set 5.448x speedup, test set 0.984x speedup, val set 5.067x speedup, step: 44
Epoch 44/200 |loss: 10.553317| train set 5.335x speedup, test set 1.053x speedup, val set 4.992x speedup, step: 45
Epoch 45/200 |loss: 11.064746| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.929556| train set 5.497x speedup, test set 0.989x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 10.295143| train set 5.496x speedup, test set 1.037x speedup, val set 5.105x speedup, step: 48
Epoch 48/200 |loss: 9.903571| train set 5.496x speedup, test set 1.064x speedup, val set 5.105x speedup, step: 49
Epoch 49/200 |loss: 9.682425| train set 5.497x speedup, test set 0.989x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.622915| train set 5.497x speedup, test set 0.985x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.328626| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.422087| train set 5.497x speedup, test set 0.985x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 9.040839| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.092279| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 9.090185| train set 5.497x speedup, test set 0.989x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.749948| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.949518| train set 5.450x speedup, test set 0.976x speedup, val set 5.193x speedup, step: 58
Epoch 58/200 |loss: 8.810556| train set 5.497x speedup, test set 0.978x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.637156| train set 5.448x speedup, test set 0.978x speedup, val set 5.067x speedup, step: 60
Epoch 60/200 |loss: 8.815086| train set 5.450x speedup, test set 0.963x speedup, val set 5.054x speedup, step: 61
Epoch 61/200 |loss: 8.675612| train set 5.450x speedup, test set 0.974x speedup, val set 5.054x speedup, step: 62
Epoch 62/200 |loss: 8.508213| train set 5.448x speedup, test set 0.974x speedup, val set 5.067x speedup, step: 63
Epoch 63/200 |loss: 8.595346| train set 5.497x speedup, test set 0.985x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.476501| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.294168| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.457918| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.426184| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.144314| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.356697| train set 5.497x speedup, test set 0.962x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.229293| train set 5.448x speedup, test set 0.971x speedup, val set 5.067x speedup, step: 71
Epoch 71/200 |loss: 8.111052| train set 5.308x speedup, test set 0.973x speedup, val set 4.964x speedup, step: 72
Epoch 72/200 |loss: 8.374756| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.291988| train set 5.450x speedup, test set 0.973x speedup, val set 5.193x speedup, step: 74
Epoch 74/200 |loss: 8.511042| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 75
Epoch 75/200 |loss: 8.023623| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.251225| train set 5.497x speedup, test set 0.959x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 8.262362| train set 5.448x speedup, test set 0.970x speedup, val set 5.067x speedup, step: 78
Epoch 78/200 |loss: 8.134727| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.248575| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 8.002618| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 81
Epoch 81/200 |loss: 8.014580| train set 5.450x speedup, test set 0.976x speedup, val set 5.193x speedup, step: 82
Epoch 82/200 |loss: 8.001172| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 83
Epoch 83/200 |loss: 8.235585| train set 5.496x speedup, test set 0.971x speedup, val set 5.107x speedup, step: 84
Epoch 84/200 |loss: 7.967304| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.893908| train set 5.448x speedup, test set 0.972x speedup, val set 5.067x speedup, step: 86
Epoch 86/200 |loss: 7.953085| train set 5.335x speedup, test set 0.959x speedup, val set 4.994x speedup, step: 87
Epoch 87/200 |loss: 8.362503| train set 5.496x speedup, test set 0.971x speedup, val set 5.107x speedup, step: 88
Epoch 88/200 |loss: 7.752353| train set 5.448x speedup, test set 0.971x speedup, val set 5.068x speedup, step: 89
Epoch 89/200 |loss: 8.499069| train set 5.496x speedup, test set 0.969x speedup, val set 5.107x speedup, step: 90
Epoch 90/200 |loss: 8.408890| train set 5.496x speedup, test set 0.959x speedup, val set 5.107x speedup, step: 91
Epoch 91/200 |loss: 8.437160| train set 5.496x speedup, test set 0.959x speedup, val set 5.107x speedup, step: 92
Epoch 92/200 |loss: 8.023623| train set 5.448x speedup, test set 0.959x speedup, val set 5.067x speedup, step: 93
Epoch 93/200 |loss: 8.244906| train set 5.496x speedup, test set 0.959x speedup, val set 5.105x speedup, step: 94
Epoch 94/200 |loss: 7.991504| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 7.961379| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 7.932659| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 7.903071| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 98
Epoch 98/200 |loss: 7.786096| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.807178| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.770637| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 1
Epoch 101/200 |loss: 7.709928| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 1
Epoch 102/200 |loss: 7.605916| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 1
Epoch 103/200 |loss: 7.643790| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 1
Epoch 104/200 |loss: 7.556080| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 1
Epoch 105/200 |loss: 7.577435| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 1
Epoch 106/200 |loss: 7.524444| train set 5.497x speedup, test set 0.971x speedup, val set 5.106x speedup, step: 1
Epoch 107/200 |loss: 7.510792| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 2
Epoch 108/200 |loss: 7.488962| train set 5.498x speedup, test set 0.967x speedup, val set 5.104x speedup, step: 3
Epoch 109/200 |loss: 7.497747| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 1
Epoch 110/200 |loss: 7.502438| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 1
Epoch 111/200 |loss: 7.826750| train set 5.450x speedup, test set 0.968x speedup, val set 5.070x speedup, step: 2
Epoch 112/200 |loss: 7.843490| train set 5.459x speedup, test set 0.955x speedup, val set 5.205x speedup, step: 1
Epoch 113/200 |loss: 8.258476| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 2
Epoch 114/200 |loss: 7.570904| train set 5.450x speedup, test set 0.967x speedup, val set 5.070x speedup, step: 3
Epoch 115/200 |loss: 7.914704| train set 5.449x speedup, test set 0.955x speedup, val set 5.194x speedup, step: 4
Epoch 116/200 |loss: 8.420823| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 5
Epoch 117/200 |loss: 7.774308| train set 5.448x speedup, test set 0.967x speedup, val set 5.068x speedup, step: 6
Epoch 118/200 |loss: 8.266658| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 7
Epoch 119/200 |loss: 7.742495| train set 5.449x speedup, test set 0.955x speedup, val set 5.195x speedup, step: 8
Epoch 120/200 |loss: 7.785947| train set 5.448x speedup, test set 0.967x speedup, val set 5.068x speedup, step: 9
Epoch 121/200 |loss: 7.705094| train set 5.448x speedup, test set 0.967x speedup, val set 5.068x speedup, step: 10
Epoch 122/200 |loss: 7.677547| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 11
Epoch 123/200 |loss: 7.735421| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 12
Epoch 124/200 |loss: 7.559531| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 13
Epoch 125/200 |loss: 7.702051| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 14
Epoch 126/200 |loss: 7.508730| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 15
Epoch 127/200 |loss: 7.518682| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 16
Epoch 128/200 |loss: 7.517350| train set 5.498x speedup, test set 0.858x speedup, val set 5.103x speedup, step: 17
Epoch 129/200 |loss: 7.414937| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 18
Epoch 130/200 |loss: 7.486164| train set 5.448x speedup, test set 0.858x speedup, val set 5.067x speedup, step: 19
Epoch 131/200 |loss: 7.379429| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 20
Epoch 132/200 |loss: 7.391404| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 21
Epoch 133/200 |loss: 7.376415| train set 5.448x speedup, test set 0.858x speedup, val set 5.067x speedup, step: 22
Epoch 134/200 |loss: 7.383106| train set 5.448x speedup, test set 0.858x speedup, val set 5.067x speedup, step: 23
Epoch 135/200 |loss: 7.348437| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 24
Epoch 136/200 |loss: 7.408461| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 25
Epoch 137/200 |loss: 7.359153| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 26
Epoch 138/200 |loss: 7.371866| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 27
Epoch 139/200 |loss: 7.367356| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 28
Epoch 140/200 |loss: 7.312045| train set 5.497x speedup, test set 0.839x speedup, val set 5.106x speedup, step: 29
Epoch 141/200 |loss: 7.320636| train set 5.497x speedup, test set 0.839x speedup, val set 5.106x speedup, step: 30
Epoch 142/200 |loss: 7.242735| train set 5.497x speedup, test set 0.839x speedup, val set 5.106x speedup, step: 31
Epoch 143/200 |loss: 7.249619| train set 5.497x speedup, test set 0.839x speedup, val set 5.106x speedup, step: 32
Epoch 144/200 |loss: 7.227210| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 33
Epoch 145/200 |loss: 7.236259| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 34
Epoch 146/200 |loss: 7.235302| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 35
Epoch 147/200 |loss: 7.242606| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 36
Epoch 148/200 |loss: 7.299800| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 37
Epoch 149/200 |loss: 7.360147| train set 5.447x speedup, test set 0.967x speedup, val set 5.065x speedup, step: 38
Epoch 150/200 |loss: 7.514666| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 39
Epoch 151/200 |loss: 7.644081| train set 5.448x speedup, test set 0.858x speedup, val set 5.068x speedup, step: 40
Epoch 152/200 |loss: 7.429879| train set 5.496x speedup, test set 0.858x speedup, val set 5.107x speedup, step: 41
Epoch 153/200 |loss: 7.210268| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 42
Epoch 154/200 |loss: 7.259401| train set 5.448x speedup, test set 0.858x speedup, val set 5.068x speedup, step: 43
Epoch 155/200 |loss: 7.469251| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 44
Epoch 156/200 |loss: 7.374523| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 45
Epoch 157/200 |loss: 7.203995| train set 5.448x speedup, test set 0.858x speedup, val set 5.067x speedup, step: 46
Epoch 158/200 |loss: 7.245534| train set 5.497x speedup, test set 0.839x speedup, val set 5.106x speedup, step: 47
Epoch 159/200 |loss: 7.390454| train set 5.448x speedup, test set 0.835x speedup, val set 5.068x speedup, step: 48
Epoch 160/200 |loss: 7.304125| train set 5.497x speedup, test set 0.835x speedup, val set 5.106x speedup, step: 49
Epoch 161/200 |loss: 7.163189| train set 5.496x speedup, test set 0.834x speedup, val set 5.105x speedup, step: 50
Epoch 162/200 |loss: 7.272516| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 51
Epoch 163/200 |loss: 7.339638| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 52
Epoch 164/200 |loss: 7.192331| train set 5.497x speedup, test set 0.817x speedup, val set 5.106x speedup, step: 53
Epoch 165/200 |loss: 7.196967| train set 5.451x speedup, test set 0.834x speedup, val set 5.069x speedup, step: 54
Epoch 166/200 |loss: 7.245455| train set 5.497x speedup, test set 0.817x speedup, val set 5.106x speedup, step: 55
Epoch 167/200 |loss: 7.243396| train set 5.497x speedup, test set 0.817x speedup, val set 5.106x speedup, step: 56
Epoch 168/200 |loss: 7.183357| train set 5.497x speedup, test set 0.834x speedup, val set 5.106x speedup, step: 57
Epoch 169/200 |loss: 7.191591| train set 5.497x speedup, test set 0.817x speedup, val set 5.106x speedup, step: 58
Epoch 170/200 |loss: 7.205482| train set 5.497x speedup, test set 0.817x speedup, val set 5.106x speedup, step: 59
Epoch 171/200 |loss: 7.255763| train set 5.496x speedup, test set 0.834x speedup, val set 5.107x speedup, step: 60
Epoch 172/200 |loss: 7.220659| train set 5.497x speedup, test set 0.817x speedup, val set 5.106x speedup, step: 61
Epoch 173/200 |loss: 7.388703| train set 5.450x speedup, test set 0.817x speedup, val set 5.070x speedup, step: 62
Epoch 174/200 |loss: 7.432619| train set 5.496x speedup, test set 0.817x speedup, val set 5.107x speedup, step: 63
Epoch 175/200 |loss: 7.667486| train set 5.496x speedup, test set 0.834x speedup, val set 5.107x speedup, step: 64
Epoch 176/200 |loss: 7.271580| train set 5.448x speedup, test set 0.817x speedup, val set 5.068x speedup, step: 65
Epoch 177/200 |loss: 7.334564| train set 5.496x speedup, test set 0.817x speedup, val set 5.107x speedup, step: 66
Epoch 178/200 |loss: 7.572717| train set 5.496x speedup, test set 0.834x speedup, val set 5.107x speedup, step: 67
Epoch 179/200 |loss: 7.348618| train set 5.450x speedup, test set 0.817x speedup, val set 5.070x speedup, step: 68
Epoch 180/200 |loss: 7.417446| train set 5.497x speedup, test set 0.817x speedup, val set 5.106x speedup, step: 69
Epoch 181/200 |loss: 7.534920| train set 5.497x speedup, test set 0.817x speedup, val set 5.106x speedup, step: 70
Epoch 182/200 |loss: 7.369640| train set 5.450x speedup, test set 0.817x speedup, val set 5.070x speedup, step: 71
Epoch 183/200 |loss: 7.599291| train set 5.497x speedup, test set 0.817x speedup, val set 5.106x speedup, step: 72
Epoch 184/200 |loss: 7.380283| train set 5.496x speedup, test set 0.817x speedup, val set 5.107x speedup, step: 73
Epoch 185/200 |loss: 7.561071| train set 5.450x speedup, test set 0.818x speedup, val set 5.070x speedup, step: 74
Epoch 186/200 |loss: 7.481355| train set 5.496x speedup, test set 0.818x speedup, val set 5.107x speedup, step: 75
Epoch 187/200 |loss: 7.302239| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 76
Epoch 188/200 |loss: 7.389211| train set 5.448x speedup, test set 0.818x speedup, val set 5.067x speedup, step: 77
Epoch 189/200 |loss: 7.337732| train set 5.451x speedup, test set 0.818x speedup, val set 5.069x speedup, step: 78
Epoch 190/200 |loss: 7.309918| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 79
Epoch 191/200 |loss: 7.255307| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 80
Epoch 192/200 |loss: 7.280065| train set 5.448x speedup, test set 0.818x speedup, val set 5.067x speedup, step: 81
Epoch 193/200 |loss: 7.228362| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 82
Epoch 194/200 |loss: 7.290745| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 83
Epoch 195/200 |loss: 7.170258| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 84
Epoch 196/200 |loss: 7.236904| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 85
Epoch 197/200 |loss: 7.261333| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 86
Epoch 198/200 |loss: 7.231045| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 87
Epoch 199/200 |loss: 7.192475| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 88
Training per epoch cost 0.234 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.611s, pg runtime 0.354s, speedup 0.579x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 1.143s, pg runtime 0.891s, speedup 0.780x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 128, train speedup 5.498, test speedup 0.858, val speedup 5.103
best test speedup epoch: 18, train speedup 4.702, test speedup 3.036, val speedup 4.471
best validation speedup epoch: 112, train speedup 5.459, test speedup 0.955, val speedup 5.205
last model at epoch 199, train speedup 5.497, test speedup 0.818, val speedup 5.106
execution cost 0:02:24.208608
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.890254, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995953| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037216| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524693| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074823| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570261| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.080351| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.587437| train set 4.418x speedup, test set 0.983x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.083782| train set 4.548x speedup, test set 0.996x speedup, val set 4.274x speedup, step: 14
Epoch 14/200 |loss: 17.616264| train set 4.548x speedup, test set 1.015x speedup, val set 4.239x speedup, step: 15
Epoch 15/200 |loss: 17.113974| train set 4.548x speedup, test set 1.060x speedup, val set 4.274x speedup, step: 16
Epoch 16/200 |loss: 16.667051| train set 4.375x speedup, test set 1.062x speedup, val set 4.151x speedup, step: 17
Epoch 17/200 |loss: 16.234022| train set 4.419x speedup, test set 1.079x speedup, val set 4.157x speedup, step: 18
Epoch 18/200 |loss: 15.848174| train set 4.702x speedup, test set 3.037x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.522808| train set 4.803x speedup, test set 1.077x speedup, val set 4.539x speedup, step: 20
Epoch 20/200 |loss: 15.070382| train set 4.978x speedup, test set 2.706x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.605409| train set 5.431x speedup, test set 1.072x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.280415| train set 5.285x speedup, test set 1.079x speedup, val set 4.961x speedup, step: 23
Epoch 23/200 |loss: 14.043803| train set 5.431x speedup, test set 1.077x speedup, val set 5.070x speedup, step: 24
Epoch 24/200 |loss: 13.713923| train set 5.472x speedup, test set 1.078x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.246832| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 26
Epoch 26/200 |loss: 12.871614| train set 5.472x speedup, test set 0.982x speedup, val set 5.104x speedup, step: 27
Epoch 27/200 |loss: 12.729527| train set 5.496x speedup, test set 1.043x speedup, val set 5.105x speedup, step: 28
Epoch 28/200 |loss: 12.711506| train set 5.496x speedup, test set 1.090x speedup, val set 5.105x speedup, step: 29
Epoch 29/200 |loss: 12.613898| train set 5.472x speedup, test set 0.976x speedup, val set 5.104x speedup, step: 30
Epoch 30/200 |loss: 12.179863| train set 5.496x speedup, test set 1.038x speedup, val set 5.105x speedup, step: 31
Epoch 31/200 |loss: 11.716700| train set 5.496x speedup, test set 1.075x speedup, val set 5.105x speedup, step: 32
Epoch 32/200 |loss: 11.655779| train set 5.450x speedup, test set 1.026x speedup, val set 5.193x speedup, step: 33
Epoch 33/200 |loss: 11.332211| train set 5.496x speedup, test set 1.052x speedup, val set 5.105x speedup, step: 34
Epoch 34/200 |loss: 11.030008| train set 5.497x speedup, test set 1.070x speedup, val set 5.106x speedup, step: 35
Epoch 35/200 |loss: 11.278740| train set 5.497x speedup, test set 1.052x speedup, val set 5.106x speedup, step: 36
Epoch 36/200 |loss: 11.297275| train set 5.497x speedup, test set 1.053x speedup, val set 5.106x speedup, step: 37
Epoch 37/200 |loss: 10.839546| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 38
Epoch 38/200 |loss: 10.612329| train set 5.496x speedup, test set 1.053x speedup, val set 5.105x speedup, step: 39
Epoch 39/200 |loss: 10.429189| train set 5.496x speedup, test set 1.024x speedup, val set 5.105x speedup, step: 40
Epoch 40/200 |loss: 10.580853| train set 5.496x speedup, test set 1.053x speedup, val set 5.105x speedup, step: 41
Epoch 41/200 |loss: 10.189031| train set 5.496x speedup, test set 1.055x speedup, val set 5.105x speedup, step: 42
Epoch 42/200 |loss: 9.944025| train set 5.496x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.925028| train set 5.496x speedup, test set 1.066x speedup, val set 5.105x speedup, step: 44
Epoch 44/200 |loss: 9.805026| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.537283| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.407646| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.312644| train set 5.448x speedup, test set 1.069x speedup, val set 5.067x speedup, step: 48
Epoch 48/200 |loss: 9.328538| train set 5.497x speedup, test set 1.081x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.038479| train set 5.497x speedup, test set 1.081x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.118151| train set 5.497x speedup, test set 1.066x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.187657| train set 5.448x speedup, test set 0.990x speedup, val set 5.067x speedup, step: 52
Epoch 52/200 |loss: 9.487169| train set 5.460x speedup, test set 1.065x speedup, val set 5.204x speedup, step: 53
Epoch 53/200 |loss: 9.475348| train set 5.497x speedup, test set 1.081x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.020470| train set 5.448x speedup, test set 0.989x speedup, val set 5.067x speedup, step: 55
Epoch 55/200 |loss: 9.343690| train set 5.449x speedup, test set 0.977x speedup, val set 5.193x speedup, step: 56
Epoch 56/200 |loss: 9.066686| train set 5.496x speedup, test set 1.066x speedup, val set 5.105x speedup, step: 57
Epoch 57/200 |loss: 8.939627| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 9.303254| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.729851| train set 5.308x speedup, test set 0.977x speedup, val set 4.964x speedup, step: 60
Epoch 60/200 |loss: 8.727289| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.689472| train set 5.498x speedup, test set 0.980x speedup, val set 5.103x speedup, step: 62
Epoch 62/200 |loss: 8.728182| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 8.640251| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.493216| train set 5.448x speedup, test set 0.990x speedup, val set 5.067x speedup, step: 65
Epoch 65/200 |loss: 8.388134| train set 5.497x speedup, test set 1.067x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.495151| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.423054| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.437189| train set 5.496x speedup, test set 0.990x speedup, val set 5.103x speedup, step: 69
Epoch 69/200 |loss: 8.231256| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.184829| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.085966| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.146547| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 7.995469| train set 5.448x speedup, test set 0.986x speedup, val set 5.067x speedup, step: 74
Epoch 74/200 |loss: 8.034702| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 8.232958| train set 5.448x speedup, test set 0.986x speedup, val set 5.067x speedup, step: 76
Epoch 76/200 |loss: 8.067184| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 8.125035| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 8.216362| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.198364| train set 5.448x speedup, test set 0.990x speedup, val set 5.067x speedup, step: 80
Epoch 80/200 |loss: 8.032943| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 81
Epoch 81/200 |loss: 7.814396| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 7.876210| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 83
Epoch 83/200 |loss: 7.987857| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 7.738627| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.701120| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 86
Epoch 86/200 |loss: 7.810643| train set 5.448x speedup, test set 0.987x speedup, val set 5.067x speedup, step: 87
Epoch 87/200 |loss: 7.900848| train set 5.450x speedup, test set 0.974x speedup, val set 5.193x speedup, step: 88
Epoch 88/200 |loss: 8.174187| train set 5.448x speedup, test set 0.987x speedup, val set 5.067x speedup, step: 89
Epoch 89/200 |loss: 8.148643| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 8.236773| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.910814| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.726190| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 93
Epoch 93/200 |loss: 7.887793| train set 5.450x speedup, test set 0.976x speedup, val set 5.064x speedup, step: 94
Epoch 94/200 |loss: 8.019160| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 7.811126| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 96
Epoch 96/200 |loss: 7.954769| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 8.091860| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 98
Epoch 98/200 |loss: 7.653278| train set 5.496x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.858208| train set 5.496x speedup, test set 0.974x speedup, val set 5.107x speedup, step: 100
Epoch 100/200 |loss: 7.861289| train set 5.448x speedup, test set 0.986x speedup, val set 5.068x speedup, step: 1
Epoch 101/200 |loss: 7.642519| train set 5.496x speedup, test set 0.974x speedup, val set 5.107x speedup, step: 1
Epoch 102/200 |loss: 7.816392| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 1
Epoch 103/200 |loss: 7.736220| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 2
Epoch 104/200 |loss: 7.885333| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 3
Epoch 105/200 |loss: 7.751038| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 4
Epoch 106/200 |loss: 7.649168| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 5
Epoch 107/200 |loss: 7.503684| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 6
Epoch 108/200 |loss: 7.611540| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 7
Epoch 109/200 |loss: 7.508204| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 8
Epoch 110/200 |loss: 7.733033| train set 5.450x speedup, test set 0.976x speedup, val set 5.193x speedup, step: 1
Epoch 111/200 |loss: 7.960559| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 2
Epoch 112/200 |loss: 7.607964| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 3
Epoch 113/200 |loss: 7.497068| train set 5.450x speedup, test set 0.976x speedup, val set 5.054x speedup, step: 4
Epoch 114/200 |loss: 7.837401| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 5
Epoch 115/200 |loss: 7.538738| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 6
Epoch 116/200 |loss: 7.461213| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 7
Epoch 117/200 |loss: 7.404351| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 8
Epoch 118/200 |loss: 7.540529| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 9
Epoch 119/200 |loss: 7.649973| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 10
Epoch 120/200 |loss: 7.456293| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 11
Epoch 121/200 |loss: 7.377938| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 12
Epoch 122/200 |loss: 7.538080| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 13
Epoch 123/200 |loss: 7.467128| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 14
Epoch 124/200 |loss: 7.426847| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 15
Epoch 125/200 |loss: 7.328507| train set 5.450x speedup, test set 0.976x speedup, val set 5.064x speedup, step: 16
Epoch 126/200 |loss: 7.422412| train set 5.450x speedup, test set 0.976x speedup, val set 5.193x speedup, step: 1
Epoch 127/200 |loss: 7.569910| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 2
Epoch 128/200 |loss: 7.322894| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 3
Epoch 129/200 |loss: 7.391975| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 4
Epoch 130/200 |loss: 7.551616| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 5
Epoch 131/200 |loss: 7.283167| train set 5.450x speedup, test set 0.976x speedup, val set 5.070x speedup, step: 6
Epoch 132/200 |loss: 7.438619| train set 5.496x speedup, test set 0.985x speedup, val set 5.107x speedup, step: 7
Epoch 133/200 |loss: 7.632403| train set 5.496x speedup, test set 0.986x speedup, val set 5.107x speedup, step: 8
Epoch 134/200 |loss: 7.356727| train set 5.451x speedup, test set 0.976x speedup, val set 5.069x speedup, step: 9
Epoch 135/200 |loss: 7.748915| train set 5.450x speedup, test set 0.973x speedup, val set 5.193x speedup, step: 1
Epoch 136/200 |loss: 7.950581| train set 5.496x speedup, test set 0.985x speedup, val set 5.107x speedup, step: 2
Epoch 137/200 |loss: 7.860694| train set 5.448x speedup, test set 0.975x speedup, val set 5.068x speedup, step: 3
Epoch 138/200 |loss: 7.669359| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 4
Epoch 139/200 |loss: 7.678611| train set 5.449x speedup, test set 0.985x speedup, val set 5.055x speedup, step: 5
Epoch 140/200 |loss: 7.749982| train set 5.496x speedup, test set 0.986x speedup, val set 5.107x speedup, step: 6
Epoch 141/200 |loss: 7.500779| train set 5.448x speedup, test set 0.986x speedup, val set 5.068x speedup, step: 7
Epoch 142/200 |loss: 7.711947| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 8
Epoch 143/200 |loss: 7.402713| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 9
Epoch 144/200 |loss: 7.584847| train set 5.496x speedup, test set 0.986x speedup, val set 5.107x speedup, step: 10
Epoch 145/200 |loss: 7.382680| train set 5.448x speedup, test set 0.986x speedup, val set 5.068x speedup, step: 11
Epoch 146/200 |loss: 7.557461| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 12
Epoch 147/200 |loss: 7.379014| train set 5.498x speedup, test set 0.975x speedup, val set 5.103x speedup, step: 13
Epoch 148/200 |loss: 7.455512| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 14
Epoch 149/200 |loss: 7.358251| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 15
Epoch 150/200 |loss: 7.383432| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 16
Epoch 151/200 |loss: 7.384028| train set 5.496x speedup, test set 0.864x speedup, val set 5.107x speedup, step: 17
Epoch 152/200 |loss: 7.305617| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 18
Epoch 153/200 |loss: 7.379734| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 19
Epoch 154/200 |loss: 7.350319| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 20
Epoch 155/200 |loss: 7.371866| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 21
Epoch 156/200 |loss: 7.411229| train set 5.499x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 22
Epoch 157/200 |loss: 7.448536| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 23
Epoch 158/200 |loss: 7.439616| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 24
Epoch 159/200 |loss: 7.345131| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 25
Epoch 160/200 |loss: 7.245113| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 26
Epoch 161/200 |loss: 7.249492| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 27
Epoch 162/200 |loss: 7.278189| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 28
Epoch 163/200 |loss: 7.300315| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 29
Epoch 164/200 |loss: 7.298244| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 30
Epoch 165/200 |loss: 7.322907| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 31
Epoch 166/200 |loss: 7.316845| train set 5.496x speedup, test set 0.986x speedup, val set 5.107x speedup, step: 32
Epoch 167/200 |loss: 7.216490| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 33
Epoch 168/200 |loss: 7.202477| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 34
Epoch 169/200 |loss: 7.157055| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 35
Epoch 170/200 |loss: 7.217867| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 36
Epoch 171/200 |loss: 7.255260| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 37
Epoch 172/200 |loss: 7.340148| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 38
Epoch 173/200 |loss: 7.216657| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 39
Epoch 174/200 |loss: 7.254270| train set 5.499x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 40
Epoch 175/200 |loss: 7.282476| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 41
Epoch 176/200 |loss: 7.398069| train set 5.448x speedup, test set 0.976x speedup, val set 5.067x speedup, step: 42
Epoch 177/200 |loss: 7.325183| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 43
Epoch 178/200 |loss: 7.193449| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 44
Epoch 179/200 |loss: 7.243482| train set 5.451x speedup, test set 0.976x speedup, val set 5.069x speedup, step: 45
Epoch 180/200 |loss: 7.328785| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 46
Epoch 181/200 |loss: 7.293920| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 47
Epoch 182/200 |loss: 7.144017| train set 5.450x speedup, test set 0.976x speedup, val set 5.070x speedup, step: 48
Epoch 183/200 |loss: 7.296772| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 49
Epoch 184/200 |loss: 7.393601| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 50
Epoch 185/200 |loss: 7.267748| train set 5.451x speedup, test set 0.976x speedup, val set 5.069x speedup, step: 51
Epoch 186/200 |loss: 7.493742| train set 5.450x speedup, test set 0.986x speedup, val set 5.194x speedup, step: 1
Epoch 187/200 |loss: 8.007778| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 2
Epoch 188/200 |loss: 7.402721| train set 5.450x speedup, test set 0.986x speedup, val set 5.070x speedup, step: 3
Epoch 189/200 |loss: 7.675276| train set 5.497x speedup, test set 0.973x speedup, val set 5.106x speedup, step: 4
Epoch 190/200 |loss: 7.604958| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 5
Epoch 191/200 |loss: 7.467482| train set 5.448x speedup, test set 0.986x speedup, val set 5.067x speedup, step: 6
Epoch 192/200 |loss: 7.868824| train set 5.497x speedup, test set 0.985x speedup, val set 5.106x speedup, step: 7
Epoch 193/200 |loss: 7.474887| train set 5.497x speedup, test set 0.985x speedup, val set 5.106x speedup, step: 8
Epoch 194/200 |loss: 7.411405| train set 5.448x speedup, test set 0.853x speedup, val set 5.068x speedup, step: 9
Epoch 195/200 |loss: 7.458508| train set 5.496x speedup, test set 0.961x speedup, val set 5.107x speedup, step: 10
Epoch 196/200 |loss: 7.379327| train set 5.496x speedup, test set 0.985x speedup, val set 5.107x speedup, step: 11
Epoch 197/200 |loss: 7.505050| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 12
Epoch 198/200 |loss: 7.262900| train set 5.448x speedup, test set 0.986x speedup, val set 5.067x speedup, step: 13
Epoch 199/200 |loss: 7.473583| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 14
Training per epoch cost 0.227 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.756s, pg runtime 0.802s, speedup 1.060x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.733s, pg runtime 0.354s, speedup 0.482x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 0.231s, pg runtime 0.891s, speedup 3.855x
23, opt runtime 0.389s, model runtime 0.433s, pg runtime 0.389s, speedup 0.898x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 156, train speedup 5.499, test speedup 0.976, val speedup 5.107
best test speedup epoch: 18, train speedup 4.702, test speedup 3.037, val speedup 4.471
best validation speedup epoch: 186, train speedup 5.450, test speedup 0.986, val speedup 5.194
last model at epoch 199, train speedup 5.497, test speedup 0.987, val speedup 5.106
execution cost 0:02:23.400705
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.858422, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055296| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995949| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037212| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524660| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074562| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570412| train set 4.397x speedup, test set 0.972x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.079767| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.587507| train set 4.418x speedup, test set 0.975x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.067825| train set 4.467x speedup, test set 1.020x speedup, val set 4.201x speedup, step: 14
Epoch 14/200 |loss: 17.601746| train set 4.467x speedup, test set 1.015x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.142815| train set 4.467x speedup, test set 1.066x speedup, val set 4.201x speedup, step: 16
Epoch 16/200 |loss: 16.689659| train set 4.367x speedup, test set 1.066x speedup, val set 4.201x speedup, step: 17
Epoch 17/200 |loss: 16.277407| train set 4.467x speedup, test set 1.080x speedup, val set 4.201x speedup, step: 18
Epoch 18/200 |loss: 15.829945| train set 4.702x speedup, test set 2.768x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.407642| train set 4.902x speedup, test set 2.804x speedup, val set 4.707x speedup, step: 20
Epoch 20/200 |loss: 15.057384| train set 4.978x speedup, test set 2.804x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.612363| train set 5.009x speedup, test set 1.071x speedup, val set 4.783x speedup, step: 22
Epoch 22/200 |loss: 14.208170| train set 5.431x speedup, test set 1.071x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 13.851545| train set 5.044x speedup, test set 1.077x speedup, val set 4.814x speedup, step: 24
Epoch 24/200 |loss: 13.507293| train set 5.472x speedup, test set 1.095x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.228571| train set 5.272x speedup, test set 1.063x speedup, val set 4.978x speedup, step: 26
Epoch 26/200 |loss: 13.513179| train set 5.496x speedup, test set 1.077x speedup, val set 5.105x speedup, step: 27
Epoch 27/200 |loss: 13.181205| train set 5.423x speedup, test set 0.970x speedup, val set 5.040x speedup, step: 28
Epoch 28/200 |loss: 12.540105| train set 5.496x speedup, test set 1.060x speedup, val set 5.105x speedup, step: 29
Epoch 29/200 |loss: 12.449220| train set 5.496x speedup, test set 1.077x speedup, val set 5.105x speedup, step: 30
Epoch 30/200 |loss: 12.084668| train set 5.496x speedup, test set 1.079x speedup, val set 5.105x speedup, step: 31
Epoch 31/200 |loss: 11.660030| train set 5.496x speedup, test set 1.060x speedup, val set 5.105x speedup, step: 32
Epoch 32/200 |loss: 11.577710| train set 5.496x speedup, test set 1.059x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.052484| train set 5.496x speedup, test set 0.984x speedup, val set 5.105x speedup, step: 34
Epoch 34/200 |loss: 11.067562| train set 5.496x speedup, test set 1.050x speedup, val set 5.105x speedup, step: 35
Epoch 35/200 |loss: 10.733924| train set 5.496x speedup, test set 0.990x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 10.975430| train set 5.449x speedup, test set 1.051x speedup, val set 5.193x speedup, step: 37
Epoch 37/200 |loss: 11.798917| train set 5.497x speedup, test set 1.054x speedup, val set 5.106x speedup, step: 38
Epoch 38/200 |loss: 10.995686| train set 5.497x speedup, test set 1.074x speedup, val set 5.106x speedup, step: 39
Epoch 39/200 |loss: 11.178707| train set 5.496x speedup, test set 1.027x speedup, val set 5.105x speedup, step: 40
Epoch 40/200 |loss: 10.518106| train set 5.496x speedup, test set 1.036x speedup, val set 5.105x speedup, step: 41
Epoch 41/200 |loss: 10.379292| train set 5.496x speedup, test set 1.076x speedup, val set 5.105x speedup, step: 42
Epoch 42/200 |loss: 10.503331| train set 5.496x speedup, test set 1.062x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 10.015971| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 9.979069| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.684889| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.751150| train set 5.497x speedup, test set 1.054x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.785285| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.528083| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.330849| train set 5.497x speedup, test set 1.054x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.389674| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.594779| train set 5.497x speedup, test set 1.051x speedup, val set 5.106x speedup, step: 52
Epoch 52/200 |loss: 9.150105| train set 5.497x speedup, test set 1.062x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 9.052257| train set 5.496x speedup, test set 1.049x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.021306| train set 5.449x speedup, test set 1.038x speedup, val set 5.054x speedup, step: 55
Epoch 55/200 |loss: 9.064948| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.723367| train set 5.448x speedup, test set 0.980x speedup, val set 5.067x speedup, step: 57
Epoch 57/200 |loss: 8.755329| train set 5.497x speedup, test set 1.043x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.725228| train set 5.497x speedup, test set 0.966x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.703158| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.469307| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.498790| train set 5.448x speedup, test set 0.966x speedup, val set 5.067x speedup, step: 62
Epoch 62/200 |loss: 8.415715| train set 5.308x speedup, test set 0.954x speedup, val set 4.963x speedup, step: 63
Epoch 63/200 |loss: 8.529999| train set 5.497x speedup, test set 0.966x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.357109| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.243876| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.136229| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.162025| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.116150| train set 5.448x speedup, test set 0.964x speedup, val set 5.067x speedup, step: 69
Epoch 69/200 |loss: 8.261486| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.698468| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.441709| train set 5.496x speedup, test set 0.964x speedup, val set 5.105x speedup, step: 72
Epoch 72/200 |loss: 8.576572| train set 5.496x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.672806| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 74
Epoch 74/200 |loss: 8.142728| train set 5.450x speedup, test set 0.973x speedup, val set 5.054x speedup, step: 75
Epoch 75/200 |loss: 8.446844| train set 5.497x speedup, test set 0.977x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.452164| train set 5.448x speedup, test set 0.977x speedup, val set 5.067x speedup, step: 77
Epoch 77/200 |loss: 8.173059| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 78
Epoch 78/200 |loss: 8.625939| train set 5.497x speedup, test set 0.966x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.146759| train set 5.448x speedup, test set 0.966x speedup, val set 5.067x speedup, step: 80
Epoch 80/200 |loss: 8.584467| train set 5.404x speedup, test set 0.942x speedup, val set 5.140x speedup, step: 81
Epoch 81/200 |loss: 8.770683| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 8.683881| train set 5.448x speedup, test set 0.938x speedup, val set 5.067x speedup, step: 83
Epoch 83/200 |loss: 8.267520| train set 5.496x speedup, test set 0.929x speedup, val set 5.105x speedup, step: 84
Epoch 84/200 |loss: 8.484133| train set 5.449x speedup, test set 0.954x speedup, val set 5.054x speedup, step: 85
Epoch 85/200 |loss: 8.089544| train set 5.496x speedup, test set 0.965x speedup, val set 5.107x speedup, step: 86
Epoch 86/200 |loss: 8.267113| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 87
Epoch 87/200 |loss: 7.914108| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 8.203674| train set 5.448x speedup, test set 0.975x speedup, val set 5.067x speedup, step: 89
Epoch 89/200 |loss: 7.821337| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 8.052813| train set 5.496x speedup, test set 0.966x speedup, val set 5.107x speedup, step: 91
Epoch 91/200 |loss: 7.770029| train set 5.496x speedup, test set 0.966x speedup, val set 5.107x speedup, step: 92
Epoch 92/200 |loss: 7.916237| train set 5.496x speedup, test set 0.966x speedup, val set 5.107x speedup, step: 93
Epoch 93/200 |loss: 7.769974| train set 5.497x speedup, test set 0.966x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 7.783709| train set 5.497x speedup, test set 0.966x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 7.673352| train set 5.496x speedup, test set 0.954x speedup, val set 5.107x speedup, step: 96
Epoch 96/200 |loss: 7.833392| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 97
Epoch 97/200 |loss: 7.679976| train set 5.496x speedup, test set 0.975x speedup, val set 5.107x speedup, step: 98
Epoch 98/200 |loss: 7.679429| train set 5.496x speedup, test set 0.977x speedup, val set 5.107x speedup, step: 99
Epoch 99/200 |loss: 7.570212| train set 5.449x speedup, test set 0.976x speedup, val set 5.065x speedup, step: 100
Epoch 100/200 |loss: 7.684731| train set 5.450x speedup, test set 0.964x speedup, val set 5.195x speedup, step: 1
Epoch 101/200 |loss: 7.703660| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 2
Epoch 102/200 |loss: 7.595285| train set 5.496x speedup, test set 0.976x speedup, val set 5.107x speedup, step: 3
Epoch 103/200 |loss: 7.523633| train set 5.496x speedup, test set 0.927x speedup, val set 5.106x speedup, step: 4
Epoch 104/200 |loss: 7.742980| train set 5.448x speedup, test set 0.938x speedup, val set 5.065x speedup, step: 5
Epoch 105/200 |loss: 7.642052| train set 5.496x speedup, test set 0.929x speedup, val set 5.107x speedup, step: 6
Epoch 106/200 |loss: 7.635722| train set 5.496x speedup, test set 0.929x speedup, val set 5.107x speedup, step: 7
Epoch 107/200 |loss: 7.488847| train set 5.448x speedup, test set 0.937x speedup, val set 5.068x speedup, step: 8
Epoch 108/200 |loss: 7.687644| train set 5.450x speedup, test set 0.918x speedup, val set 5.195x speedup, step: 1
Epoch 109/200 |loss: 7.924988| train set 5.496x speedup, test set 0.929x speedup, val set 5.107x speedup, step: 2
Epoch 110/200 |loss: 7.540875| train set 5.448x speedup, test set 0.940x speedup, val set 5.068x speedup, step: 3
Epoch 111/200 |loss: 7.822818| train set 5.450x speedup, test set 0.918x speedup, val set 5.195x speedup, step: 1
Epoch 112/200 |loss: 8.187651| train set 5.497x speedup, test set 0.918x speedup, val set 5.106x speedup, step: 2
Epoch 113/200 |loss: 7.565015| train set 5.451x speedup, test set 0.978x speedup, val set 5.069x speedup, step: 3
Epoch 114/200 |loss: 8.257154| train set 5.264x speedup, test set 0.918x speedup, val set 5.047x speedup, step: 4
Epoch 115/200 |loss: 8.258148| train set 5.449x speedup, test set 0.918x speedup, val set 5.055x speedup, step: 5
Epoch 116/200 |loss: 7.851147| train set 5.448x speedup, test set 0.967x speedup, val set 5.068x speedup, step: 6
Epoch 117/200 |loss: 8.484848| train set 5.497x speedup, test set 0.929x speedup, val set 5.106x speedup, step: 7
Epoch 118/200 |loss: 7.776206| train set 5.497x speedup, test set 0.929x speedup, val set 5.106x speedup, step: 8
Epoch 119/200 |loss: 7.880925| train set 5.448x speedup, test set 0.926x speedup, val set 5.067x speedup, step: 9
Epoch 120/200 |loss: 7.893010| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 10
Epoch 121/200 |loss: 7.622965| train set 5.450x speedup, test set 0.951x speedup, val set 5.193x speedup, step: 11
Epoch 122/200 |loss: 7.738233| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 12
Epoch 123/200 |loss: 7.599343| train set 5.448x speedup, test set 0.963x speedup, val set 5.067x speedup, step: 13
Epoch 124/200 |loss: 7.677567| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 14
Epoch 125/200 |loss: 7.589601| train set 5.450x speedup, test set 0.963x speedup, val set 5.054x speedup, step: 15
Epoch 126/200 |loss: 7.579680| train set 5.448x speedup, test set 0.963x speedup, val set 5.067x speedup, step: 16
Epoch 127/200 |loss: 7.582163| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 17
Epoch 128/200 |loss: 7.544726| train set 5.497x speedup, test set 0.966x speedup, val set 5.106x speedup, step: 18
Epoch 129/200 |loss: 7.510685| train set 5.497x speedup, test set 0.966x speedup, val set 5.106x speedup, step: 19
Epoch 130/200 |loss: 7.452967| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 20
Epoch 131/200 |loss: 7.409336| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 21
Epoch 132/200 |loss: 7.447033| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 22
Epoch 133/200 |loss: 7.419813| train set 5.448x speedup, test set 0.963x speedup, val set 5.067x speedup, step: 23
Epoch 134/200 |loss: 7.415927| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 24
Epoch 135/200 |loss: 7.367928| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 25
Epoch 136/200 |loss: 7.358294| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 26
Epoch 137/200 |loss: 7.313442| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 27
Epoch 138/200 |loss: 7.311995| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 28
Epoch 139/200 |loss: 7.281110| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 29
Epoch 140/200 |loss: 7.269218| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 30
Epoch 141/200 |loss: 7.271050| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 31
Epoch 142/200 |loss: 7.248152| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 32
Epoch 143/200 |loss: 7.259681| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 33
Epoch 144/200 |loss: 7.270438| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 34
Epoch 145/200 |loss: 7.362871| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 35
Epoch 146/200 |loss: 7.556520| train set 5.496x speedup, test set 0.964x speedup, val set 5.107x speedup, step: 36
Epoch 147/200 |loss: 8.155311| train set 5.499x speedup, test set 0.963x speedup, val set 5.109x speedup, step: 37
Epoch 148/200 |loss: 7.676686| train set 5.496x speedup, test set 0.926x speedup, val set 5.107x speedup, step: 38
Epoch 149/200 |loss: 7.379344| train set 5.448x speedup, test set 0.963x speedup, val set 5.068x speedup, step: 39
Epoch 150/200 |loss: 7.527542| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 40
Epoch 151/200 |loss: 7.665643| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 41
Epoch 152/200 |loss: 7.467645| train set 5.448x speedup, test set 0.966x speedup, val set 5.067x speedup, step: 42
Epoch 153/200 |loss: 7.411063| train set 5.496x speedup, test set 0.966x speedup, val set 5.105x speedup, step: 43
Epoch 154/200 |loss: 7.528262| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 44
Epoch 155/200 |loss: 7.515430| train set 5.497x speedup, test set 0.943x speedup, val set 5.106x speedup, step: 45
Epoch 156/200 |loss: 7.325644| train set 5.497x speedup, test set 0.943x speedup, val set 5.106x speedup, step: 46
Epoch 157/200 |loss: 7.607200| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 47
Epoch 158/200 |loss: 7.402354| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 48
Epoch 159/200 |loss: 7.382624| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 49
Epoch 160/200 |loss: 7.418992| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 50
Epoch 161/200 |loss: 7.337166| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 51
Epoch 162/200 |loss: 7.264899| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 52
Epoch 163/200 |loss: 7.364954| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 53
Epoch 164/200 |loss: 7.236596| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 54
Epoch 165/200 |loss: 7.299571| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 55
Epoch 166/200 |loss: 7.266193| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 56
Epoch 167/200 |loss: 7.267372| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 57
Epoch 168/200 |loss: 7.195375| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 58
Epoch 169/200 |loss: 7.273636| train set 5.497x speedup, test set 0.943x speedup, val set 5.106x speedup, step: 59
Epoch 170/200 |loss: 7.236008| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 60
Epoch 171/200 |loss: 7.184700| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 61
Epoch 172/200 |loss: 7.243557| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 62
Epoch 173/200 |loss: 7.232087| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 63
Epoch 174/200 |loss: 7.155620| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 64
Epoch 175/200 |loss: 7.218936| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 65
Epoch 176/200 |loss: 7.218578| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 66
Epoch 177/200 |loss: 7.171053| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 67
Epoch 178/200 |loss: 7.167214| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 68
Epoch 179/200 |loss: 7.166690| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 69
Epoch 180/200 |loss: 7.174490| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 70
Epoch 181/200 |loss: 7.159393| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 71
Epoch 182/200 |loss: 7.118912| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 72
Epoch 183/200 |loss: 7.142320| train set 5.448x speedup, test set 0.944x speedup, val set 5.067x speedup, step: 73
Epoch 184/200 |loss: 7.178596| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 74
Epoch 185/200 |loss: 7.166771| train set 5.499x speedup, test set 0.976x speedup, val set 5.109x speedup, step: 75
Epoch 186/200 |loss: 7.185498| train set 5.497x speedup, test set 0.943x speedup, val set 5.106x speedup, step: 76
Epoch 187/200 |loss: 7.306053| train set 5.450x speedup, test set 0.938x speedup, val set 5.070x speedup, step: 77
Epoch 188/200 |loss: 7.382698| train set 5.498x speedup, test set 0.908x speedup, val set 5.103x speedup, step: 78
Epoch 189/200 |loss: 7.782921| train set 5.496x speedup, test set 0.909x speedup, val set 5.107x speedup, step: 79
Epoch 190/200 |loss: 7.238544| train set 5.448x speedup, test set 0.941x speedup, val set 5.068x speedup, step: 80
Epoch 191/200 |loss: 7.374741| train set 5.497x speedup, test set 0.911x speedup, val set 5.106x speedup, step: 81
Epoch 192/200 |loss: 7.925533| train set 5.496x speedup, test set 0.910x speedup, val set 5.107x speedup, step: 82
Epoch 193/200 |loss: 7.257840| train set 5.450x speedup, test set 0.940x speedup, val set 5.070x speedup, step: 83
Epoch 194/200 |loss: 7.842090| train set 5.456x speedup, test set 0.910x speedup, val set 5.205x speedup, step: 1
Epoch 195/200 |loss: 7.803885| train set 5.497x speedup, test set 0.929x speedup, val set 5.106x speedup, step: 2
Epoch 196/200 |loss: 7.458912| train set 5.450x speedup, test set 0.940x speedup, val set 5.070x speedup, step: 3
Epoch 197/200 |loss: 7.773203| train set 5.496x speedup, test set 0.929x speedup, val set 5.107x speedup, step: 4
Epoch 198/200 |loss: 7.417057| train set 5.497x speedup, test set 0.929x speedup, val set 5.106x speedup, step: 5
Epoch 199/200 |loss: 7.552463| train set 5.448x speedup, test set 0.929x speedup, val set 5.067x speedup, step: 6
Training per epoch cost 0.230 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 3.575s, pg runtime 0.389s, speedup 0.109x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 147, train speedup 5.499, test speedup 0.963, val speedup 5.109
best test speedup epoch: 19, train speedup 4.902, test speedup 2.804, val speedup 4.707
best validation speedup epoch: 194, train speedup 5.456, test speedup 0.910, val speedup 5.205
last model at epoch 199, train speedup 5.448, test speedup 0.929, val speedup 5.067
execution cost 0:02:22.796218
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.886947, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037216| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524693| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074823| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570261| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.080351| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.587440| train set 4.418x speedup, test set 0.983x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.083754| train set 4.548x speedup, test set 0.996x speedup, val set 4.274x speedup, step: 14
Epoch 14/200 |loss: 17.616201| train set 4.548x speedup, test set 1.015x speedup, val set 4.239x speedup, step: 15
Epoch 15/200 |loss: 17.115101| train set 4.548x speedup, test set 1.060x speedup, val set 4.239x speedup, step: 16
Epoch 16/200 |loss: 16.672987| train set 4.423x speedup, test set 1.062x speedup, val set 4.195x speedup, step: 17
Epoch 17/200 |loss: 16.240795| train set 4.419x speedup, test set 1.080x speedup, val set 4.157x speedup, step: 18
Epoch 18/200 |loss: 15.847304| train set 4.702x speedup, test set 3.037x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.531463| train set 4.803x speedup, test set 1.077x speedup, val set 4.539x speedup, step: 20
Epoch 20/200 |loss: 15.082845| train set 4.978x speedup, test set 2.806x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.617233| train set 5.431x speedup, test set 1.072x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.276643| train set 5.285x speedup, test set 1.078x speedup, val set 4.961x speedup, step: 23
Epoch 23/200 |loss: 14.036376| train set 5.431x speedup, test set 1.071x speedup, val set 5.070x speedup, step: 24
Epoch 24/200 |loss: 13.721883| train set 5.497x speedup, test set 1.094x speedup, val set 5.106x speedup, step: 25
Epoch 25/200 |loss: 13.313222| train set 5.496x speedup, test set 1.075x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 12.889337| train set 5.497x speedup, test set 0.999x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.646627| train set 5.497x speedup, test set 1.075x speedup, val set 5.106x speedup, step: 28
Epoch 28/200 |loss: 12.738618| train set 5.497x speedup, test set 1.074x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.838557| train set 5.497x speedup, test set 0.984x speedup, val set 5.106x speedup, step: 30
Epoch 30/200 |loss: 12.087414| train set 5.496x speedup, test set 1.082x speedup, val set 5.105x speedup, step: 31
Epoch 31/200 |loss: 11.830343| train set 5.496x speedup, test set 1.103x speedup, val set 5.105x speedup, step: 32
Epoch 32/200 |loss: 11.848697| train set 5.496x speedup, test set 1.081x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 11.154743| train set 5.496x speedup, test set 1.081x speedup, val set 5.105x speedup, step: 34
Epoch 34/200 |loss: 11.343977| train set 5.496x speedup, test set 1.066x speedup, val set 5.105x speedup, step: 35
Epoch 35/200 |loss: 10.914421| train set 5.496x speedup, test set 0.990x speedup, val set 5.105x speedup, step: 36
Epoch 36/200 |loss: 10.667833| train set 5.496x speedup, test set 1.066x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.759842| train set 5.496x speedup, test set 0.990x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.322364| train set 5.496x speedup, test set 1.064x speedup, val set 5.105x speedup, step: 39
Epoch 39/200 |loss: 10.219265| train set 5.496x speedup, test set 1.071x speedup, val set 5.105x speedup, step: 40
Epoch 40/200 |loss: 10.303061| train set 5.496x speedup, test set 1.062x speedup, val set 5.105x speedup, step: 41
Epoch 41/200 |loss: 10.132419| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 10.071090| train set 5.496x speedup, test set 1.060x speedup, val set 5.105x speedup, step: 43
Epoch 43/200 |loss: 10.056700| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 9.486717| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.459208| train set 5.497x speedup, test set 1.062x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.167017| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.215100| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.149919| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.516381| train set 5.497x speedup, test set 1.063x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.823067| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.594416| train set 5.448x speedup, test set 0.987x speedup, val set 5.067x speedup, step: 52
Epoch 52/200 |loss: 9.410881| train set 5.229x speedup, test set 1.060x speedup, val set 5.062x speedup, step: 53
Epoch 53/200 |loss: 9.837035| train set 5.497x speedup, test set 0.973x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 8.962792| train set 5.448x speedup, test set 0.990x speedup, val set 5.067x speedup, step: 55
Epoch 55/200 |loss: 9.736010| train set 5.496x speedup, test set 1.062x speedup, val set 5.105x speedup, step: 56
Epoch 56/200 |loss: 9.194573| train set 5.307x speedup, test set 0.973x speedup, val set 4.963x speedup, step: 57
Epoch 57/200 |loss: 9.451588| train set 5.497x speedup, test set 0.973x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 9.125680| train set 5.497x speedup, test set 0.973x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 9.031765| train set 5.497x speedup, test set 1.062x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 9.026913| train set 5.498x speedup, test set 0.963x speedup, val set 5.103x speedup, step: 61
Epoch 61/200 |loss: 8.719323| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.700540| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 8.682274| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.491522| train set 5.497x speedup, test set 0.975x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.419996| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.457664| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.235333| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 68
Epoch 68/200 |loss: 8.350900| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.179104| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.121235| train set 5.497x speedup, test set 0.957x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.137127| train set 5.497x speedup, test set 0.957x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.038170| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.037595| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 74
Epoch 74/200 |loss: 8.051268| train set 5.497x speedup, test set 0.970x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 8.149743| train set 5.497x speedup, test set 0.957x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 8.406950| train set 5.448x speedup, test set 0.971x speedup, val set 5.067x speedup, step: 77
Epoch 77/200 |loss: 8.665858| train set 5.450x speedup, test set 0.957x speedup, val set 5.193x speedup, step: 78
Epoch 78/200 |loss: 8.856366| train set 5.497x speedup, test set 0.959x speedup, val set 5.106x speedup, step: 79
Epoch 79/200 |loss: 8.052138| train set 5.448x speedup, test set 0.955x speedup, val set 5.067x speedup, step: 80
Epoch 80/200 |loss: 8.893978| train set 5.450x speedup, test set 0.954x speedup, val set 5.054x speedup, step: 81
Epoch 81/200 |loss: 8.609709| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 8.241406| train set 5.448x speedup, test set 0.955x speedup, val set 5.068x speedup, step: 83
Epoch 83/200 |loss: 8.284693| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 84
Epoch 84/200 |loss: 8.189725| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 8.041692| train set 5.308x speedup, test set 0.964x speedup, val set 4.964x speedup, step: 86
Epoch 86/200 |loss: 8.210492| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 87
Epoch 87/200 |loss: 7.901454| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 8.122339| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.869709| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 7.946430| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.958922| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 92
Epoch 92/200 |loss: 7.819891| train set 5.497x speedup, test set 0.955x speedup, val set 5.103x speedup, step: 93
Epoch 93/200 |loss: 7.770438| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 7.788348| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 95
Epoch 95/200 |loss: 7.729282| train set 5.448x speedup, test set 0.955x speedup, val set 5.067x speedup, step: 96
Epoch 96/200 |loss: 7.683148| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 97
Epoch 97/200 |loss: 7.695696| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 98
Epoch 98/200 |loss: 7.623311| train set 5.448x speedup, test set 0.955x speedup, val set 5.067x speedup, step: 99
Epoch 99/200 |loss: 7.705630| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.589005| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 1
Epoch 101/200 |loss: 7.638112| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 1
Epoch 102/200 |loss: 7.602688| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 1
Epoch 103/200 |loss: 7.629906| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 1
Epoch 104/200 |loss: 7.545093| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 2
Epoch 105/200 |loss: 7.459841| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 3
Epoch 106/200 |loss: 7.475118| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 4
Epoch 107/200 |loss: 7.430595| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 1
Epoch 108/200 |loss: 7.537865| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 2
Epoch 109/200 |loss: 7.654986| train set 5.448x speedup, test set 0.967x speedup, val set 5.068x speedup, step: 3
Epoch 110/200 |loss: 7.840560| train set 5.450x speedup, test set 0.955x speedup, val set 5.193x speedup, step: 1
Epoch 111/200 |loss: 8.260033| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 2
Epoch 112/200 |loss: 7.672630| train set 5.450x speedup, test set 0.955x speedup, val set 5.070x speedup, step: 3
Epoch 113/200 |loss: 8.261919| train set 5.450x speedup, test set 0.955x speedup, val set 5.193x speedup, step: 1
Epoch 114/200 |loss: 8.628317| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 2
Epoch 115/200 |loss: 7.963745| train set 5.448x speedup, test set 0.955x speedup, val set 5.068x speedup, step: 3
Epoch 116/200 |loss: 8.402452| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 4
Epoch 117/200 |loss: 8.069524| train set 5.404x speedup, test set 0.855x speedup, val set 5.140x speedup, step: 5
Epoch 118/200 |loss: 8.112630| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 6
Epoch 119/200 |loss: 7.843204| train set 5.448x speedup, test set 0.964x speedup, val set 5.067x speedup, step: 7
Epoch 120/200 |loss: 7.888656| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 8
Epoch 121/200 |loss: 7.898788| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 9
Epoch 122/200 |loss: 7.758366| train set 5.448x speedup, test set 0.926x speedup, val set 5.066x speedup, step: 10
Epoch 123/200 |loss: 7.731258| train set 5.496x speedup, test set 0.963x speedup, val set 5.105x speedup, step: 11
Epoch 124/200 |loss: 7.638924| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 12
Epoch 125/200 |loss: 7.669330| train set 5.496x speedup, test set 0.964x speedup, val set 5.107x speedup, step: 13
Epoch 126/200 |loss: 7.557404| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 14
Epoch 127/200 |loss: 7.634079| train set 5.497x speedup, test set 0.963x speedup, val set 5.106x speedup, step: 15
Epoch 128/200 |loss: 7.508866| train set 5.448x speedup, test set 0.963x speedup, val set 5.067x speedup, step: 16
Epoch 129/200 |loss: 7.523279| train set 5.448x speedup, test set 0.963x speedup, val set 5.068x speedup, step: 17
Epoch 130/200 |loss: 7.456301| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 18
Epoch 131/200 |loss: 7.494461| train set 5.496x speedup, test set 0.963x speedup, val set 5.107x speedup, step: 19
Epoch 132/200 |loss: 7.393142| train set 5.448x speedup, test set 0.963x speedup, val set 5.068x speedup, step: 20
Epoch 133/200 |loss: 7.438692| train set 5.496x speedup, test set 0.964x speedup, val set 5.107x speedup, step: 21
Epoch 134/200 |loss: 7.396769| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 22
Epoch 135/200 |loss: 7.348351| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 23
Epoch 136/200 |loss: 7.376657| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 24
Epoch 137/200 |loss: 7.365642| train set 5.448x speedup, test set 0.955x speedup, val set 5.068x speedup, step: 25
Epoch 138/200 |loss: 7.362237| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 26
Epoch 139/200 |loss: 7.300236| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 27
Epoch 140/200 |loss: 7.299675| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 28
Epoch 141/200 |loss: 7.305684| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 29
Epoch 142/200 |loss: 7.309359| train set 5.448x speedup, test set 0.955x speedup, val set 5.067x speedup, step: 30
Epoch 143/200 |loss: 7.265090| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 31
Epoch 144/200 |loss: 7.242566| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 32
Epoch 145/200 |loss: 7.248065| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 33
Epoch 146/200 |loss: 7.243865| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 34
Epoch 147/200 |loss: 7.308383| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 35
Epoch 148/200 |loss: 7.347580| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 36
Epoch 149/200 |loss: 7.636181| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 37
Epoch 150/200 |loss: 7.698840| train set 5.448x speedup, test set 0.967x speedup, val set 5.068x speedup, step: 38
Epoch 151/200 |loss: 7.906153| train set 5.497x speedup, test set 0.965x speedup, val set 5.106x speedup, step: 39
Epoch 152/200 |loss: 7.746883| train set 5.450x speedup, test set 0.967x speedup, val set 5.070x speedup, step: 40
Epoch 153/200 |loss: 7.390760| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 41
Epoch 154/200 |loss: 7.360550| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 42
Epoch 155/200 |loss: 7.384504| train set 5.448x speedup, test set 0.967x speedup, val set 5.067x speedup, step: 43
Epoch 156/200 |loss: 7.431904| train set 5.497x speedup, test set 0.965x speedup, val set 5.106x speedup, step: 44
Epoch 157/200 |loss: 7.395088| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 45
Epoch 158/200 |loss: 7.242054| train set 5.451x speedup, test set 0.967x speedup, val set 5.069x speedup, step: 46
Epoch 159/200 |loss: 7.449114| train set 5.450x speedup, test set 0.955x speedup, val set 5.193x speedup, step: 1
Epoch 160/200 |loss: 7.571642| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 2
Epoch 161/200 |loss: 7.247353| train set 5.451x speedup, test set 0.967x speedup, val set 5.069x speedup, step: 3
Epoch 162/200 |loss: 7.564323| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 4
Epoch 163/200 |loss: 7.553956| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 5
Epoch 164/200 |loss: 7.346781| train set 5.450x speedup, test set 0.967x speedup, val set 5.070x speedup, step: 6
Epoch 165/200 |loss: 7.616104| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 7
Epoch 166/200 |loss: 7.336175| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 8
Epoch 167/200 |loss: 7.396286| train set 5.448x speedup, test set 0.964x speedup, val set 5.068x speedup, step: 9
Epoch 168/200 |loss: 7.318111| train set 5.448x speedup, test set 0.964x speedup, val set 5.067x speedup, step: 10
Epoch 169/200 |loss: 7.289920| train set 5.497x speedup, test set 0.941x speedup, val set 5.106x speedup, step: 11
Epoch 170/200 |loss: 7.336656| train set 5.496x speedup, test set 0.941x speedup, val set 5.107x speedup, step: 12
Epoch 171/200 |loss: 7.256502| train set 5.499x speedup, test set 0.967x speedup, val set 5.109x speedup, step: 13
Epoch 172/200 |loss: 7.334703| train set 5.497x speedup, test set 0.955x speedup, val set 5.106x speedup, step: 14
Epoch 173/200 |loss: 7.233414| train set 5.497x speedup, test set 0.941x speedup, val set 5.106x speedup, step: 15
Epoch 174/200 |loss: 7.260037| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 16
Epoch 175/200 |loss: 7.247482| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 17
Epoch 176/200 |loss: 7.201853| train set 5.496x speedup, test set 0.955x speedup, val set 5.107x speedup, step: 18
Epoch 177/200 |loss: 7.236484| train set 5.496x speedup, test set 0.944x speedup, val set 5.107x speedup, step: 19
Epoch 178/200 |loss: 7.214365| train set 5.496x speedup, test set 0.933x speedup, val set 5.107x speedup, step: 20
Epoch 179/200 |loss: 7.231593| train set 5.496x speedup, test set 0.944x speedup, val set 5.107x speedup, step: 21
Epoch 180/200 |loss: 7.289966| train set 5.496x speedup, test set 0.944x speedup, val set 5.107x speedup, step: 22
Epoch 181/200 |loss: 7.274487| train set 5.496x speedup, test set 0.944x speedup, val set 5.107x speedup, step: 23
Epoch 182/200 |loss: 7.284824| train set 5.496x speedup, test set 0.944x speedup, val set 5.107x speedup, step: 24
Epoch 183/200 |loss: 7.260827| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 25
Epoch 184/200 |loss: 7.200446| train set 5.496x speedup, test set 0.944x speedup, val set 5.107x speedup, step: 26
Epoch 185/200 |loss: 7.198007| train set 5.496x speedup, test set 0.944x speedup, val set 5.107x speedup, step: 27
Epoch 186/200 |loss: 7.219193| train set 5.448x speedup, test set 0.944x speedup, val set 5.068x speedup, step: 28
Epoch 187/200 |loss: 7.202295| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 29
Epoch 188/200 |loss: 7.362815| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 30
Epoch 189/200 |loss: 7.324596| train set 5.496x speedup, test set 0.944x speedup, val set 5.107x speedup, step: 31
Epoch 190/200 |loss: 7.387147| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 32
Epoch 191/200 |loss: 7.299513| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 33
Epoch 192/200 |loss: 7.266236| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 34
Epoch 193/200 |loss: 7.188617| train set 5.496x speedup, test set 0.967x speedup, val set 5.107x speedup, step: 35
Epoch 194/200 |loss: 7.308416| train set 5.448x speedup, test set 0.954x speedup, val set 5.067x speedup, step: 36
Epoch 195/200 |loss: 7.534626| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 37
Epoch 196/200 |loss: 7.262185| train set 5.499x speedup, test set 0.917x speedup, val set 5.108x speedup, step: 38
Epoch 197/200 |loss: 7.323269| train set 5.497x speedup, test set 0.944x speedup, val set 5.106x speedup, step: 39
Epoch 198/200 |loss: 7.365065| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 40
Epoch 199/200 |loss: 7.362401| train set 5.497x speedup, test set 0.967x speedup, val set 5.106x speedup, step: 41
Training per epoch cost 0.228 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.611s, pg runtime 0.354s, speedup 0.579x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 1.143s, pg runtime 0.891s, speedup 0.780x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 196, train speedup 5.499, test speedup 0.917, val speedup 5.108
best test speedup epoch: 18, train speedup 4.702, test speedup 3.037, val speedup 4.471
best validation speedup epoch: 159, train speedup 5.450, test speedup 0.955, val speedup 5.193
last model at epoch 199, train speedup 5.497, test speedup 0.967, val speedup 5.106
execution cost 0:02:22.314335
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.868674, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055298| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995949| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037216| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524662| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074562| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570391| train set 4.397x speedup, test set 0.972x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.079531| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586479| train set 4.418x speedup, test set 0.983x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.067806| train set 4.467x speedup, test set 1.021x speedup, val set 4.201x speedup, step: 14
Epoch 14/200 |loss: 17.602135| train set 4.467x speedup, test set 1.015x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.146929| train set 4.467x speedup, test set 1.066x speedup, val set 4.201x speedup, step: 16
Epoch 16/200 |loss: 16.682732| train set 4.552x speedup, test set 1.064x speedup, val set 4.345x speedup, step: 17
Epoch 17/200 |loss: 16.274240| train set 4.467x speedup, test set 1.081x speedup, val set 4.201x speedup, step: 18
Epoch 18/200 |loss: 15.853537| train set 4.702x speedup, test set 2.759x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.446270| train set 4.832x speedup, test set 2.845x speedup, val set 4.526x speedup, step: 20
Epoch 20/200 |loss: 15.073396| train set 4.978x speedup, test set 2.706x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.585343| train set 5.431x speedup, test set 2.706x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.155014| train set 5.431x speedup, test set 1.087x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 13.886174| train set 5.456x speedup, test set 1.071x speedup, val set 5.072x speedup, step: 24
Epoch 24/200 |loss: 13.651038| train set 5.472x speedup, test set 1.078x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.596603| train set 5.496x speedup, test set 1.062x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.334292| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.538058| train set 5.308x speedup, test set 1.075x speedup, val set 4.963x speedup, step: 28
Epoch 28/200 |loss: 12.675070| train set 5.497x speedup, test set 1.063x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.371953| train set 5.497x speedup, test set 1.059x speedup, val set 5.106x speedup, step: 30
Epoch 30/200 |loss: 11.770001| train set 5.497x speedup, test set 1.027x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.935356| train set 5.497x speedup, test set 1.053x speedup, val set 5.106x speedup, step: 32
Epoch 32/200 |loss: 11.682856| train set 5.496x speedup, test set 1.059x speedup, val set 5.105x speedup, step: 33
Epoch 33/200 |loss: 12.046744| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 10.977066| train set 5.424x speedup, test set 1.082x speedup, val set 5.040x speedup, step: 35
Epoch 35/200 |loss: 11.558515| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 36
Epoch 36/200 |loss: 11.150948| train set 5.496x speedup, test set 1.050x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.956950| train set 5.496x speedup, test set 1.069x speedup, val set 5.105x speedup, step: 38
Epoch 38/200 |loss: 10.723655| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 39
Epoch 39/200 |loss: 10.918575| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 40
Epoch 40/200 |loss: 10.335957| train set 5.497x speedup, test set 1.051x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 10.294054| train set 5.497x speedup, test set 1.054x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 10.048564| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 9.773105| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 9.883263| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 45
Epoch 45/200 |loss: 9.444856| train set 5.497x speedup, test set 1.051x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 9.504640| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.373331| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.654264| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 10.140107| train set 5.448x speedup, test set 0.980x speedup, val set 5.067x speedup, step: 50
Epoch 50/200 |loss: 9.834273| train set 5.496x speedup, test set 1.054x speedup, val set 5.105x speedup, step: 51
Epoch 51/200 |loss: 9.707792| train set 5.426x speedup, test set 1.054x speedup, val set 4.959x speedup, step: 52
Epoch 52/200 |loss: 9.533645| train set 5.448x speedup, test set 0.980x speedup, val set 5.067x speedup, step: 53
Epoch 53/200 |loss: 9.437284| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.124732| train set 5.497x speedup, test set 1.054x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 9.130310| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 56
Epoch 56/200 |loss: 8.941952| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.941919| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.717431| train set 5.497x speedup, test set 1.069x speedup, val set 5.106x speedup, step: 59
Epoch 59/200 |loss: 8.782986| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 60
Epoch 60/200 |loss: 8.682034| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 61
Epoch 61/200 |loss: 8.479362| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 62
Epoch 62/200 |loss: 8.510306| train set 5.450x speedup, test set 1.055x speedup, val set 5.054x speedup, step: 63
Epoch 63/200 |loss: 8.618417| train set 5.448x speedup, test set 0.980x speedup, val set 5.067x speedup, step: 64
Epoch 64/200 |loss: 8.654653| train set 5.497x speedup, test set 0.972x speedup, val set 5.106x speedup, step: 65
Epoch 65/200 |loss: 8.465674| train set 5.497x speedup, test set 0.985x speedup, val set 5.106x speedup, step: 66
Epoch 66/200 |loss: 8.261677| train set 5.497x speedup, test set 0.985x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.315123| train set 5.450x speedup, test set 1.060x speedup, val set 5.054x speedup, step: 68
Epoch 68/200 |loss: 8.450872| train set 5.448x speedup, test set 0.985x speedup, val set 5.067x speedup, step: 69
Epoch 69/200 |loss: 8.178076| train set 5.497x speedup, test set 0.985x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.088514| train set 5.497x speedup, test set 0.972x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.201706| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.082522| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.011034| train set 5.497x speedup, test set 0.962x speedup, val set 5.106x speedup, step: 74
Epoch 74/200 |loss: 7.970976| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 7.942090| train set 5.497x speedup, test set 0.962x speedup, val set 5.106x speedup, step: 76
Epoch 76/200 |loss: 7.978665| train set 5.448x speedup, test set 0.974x speedup, val set 5.067x speedup, step: 77
Epoch 77/200 |loss: 7.928009| train set 5.450x speedup, test set 0.962x speedup, val set 5.054x speedup, step: 78
Epoch 78/200 |loss: 8.066851| train set 5.448x speedup, test set 0.946x speedup, val set 5.067x speedup, step: 79
Epoch 79/200 |loss: 8.057753| train set 5.497x speedup, test set 0.934x speedup, val set 5.106x speedup, step: 80
Epoch 80/200 |loss: 7.923561| train set 5.497x speedup, test set 0.962x speedup, val set 5.106x speedup, step: 81
Epoch 81/200 |loss: 7.775642| train set 5.448x speedup, test set 0.930x speedup, val set 5.067x speedup, step: 82
Epoch 82/200 |loss: 7.844464| train set 5.404x speedup, test set 0.934x speedup, val set 5.140x speedup, step: 83
Epoch 83/200 |loss: 8.134244| train set 5.448x speedup, test set 0.941x speedup, val set 5.067x speedup, step: 84
Epoch 84/200 |loss: 8.008622| train set 5.497x speedup, test set 0.930x speedup, val set 5.106x speedup, step: 85
Epoch 85/200 |loss: 7.982090| train set 5.497x speedup, test set 0.930x speedup, val set 5.106x speedup, step: 86
Epoch 86/200 |loss: 7.692014| train set 5.448x speedup, test set 0.930x speedup, val set 5.067x speedup, step: 87
Epoch 87/200 |loss: 7.906045| train set 5.450x speedup, test set 0.957x speedup, val set 5.193x speedup, step: 88
Epoch 88/200 |loss: 8.402305| train set 5.497x speedup, test set 0.930x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.777503| train set 5.448x speedup, test set 0.941x speedup, val set 5.067x speedup, step: 90
Epoch 90/200 |loss: 8.307142| train set 5.403x speedup, test set 0.929x speedup, val set 5.140x speedup, step: 91
Epoch 91/200 |loss: 8.680366| train set 5.308x speedup, test set 0.925x speedup, val set 4.964x speedup, step: 92
Epoch 92/200 |loss: 8.306653| train set 5.448x speedup, test set 0.929x speedup, val set 5.068x speedup, step: 93
Epoch 93/200 |loss: 8.274350| train set 5.448x speedup, test set 0.926x speedup, val set 5.068x speedup, step: 94
Epoch 94/200 |loss: 8.416698| train set 5.449x speedup, test set 0.928x speedup, val set 5.194x speedup, step: 95
Epoch 95/200 |loss: 8.089944| train set 5.451x speedup, test set 0.818x speedup, val set 5.052x speedup, step: 96
Epoch 96/200 |loss: 8.157042| train set 5.496x speedup, test set 0.929x speedup, val set 5.107x speedup, step: 97
Epoch 97/200 |loss: 7.993491| train set 5.497x speedup, test set 0.929x speedup, val set 5.106x speedup, step: 98
Epoch 98/200 |loss: 8.135221| train set 5.497x speedup, test set 0.938x speedup, val set 5.106x speedup, step: 99
Epoch 99/200 |loss: 7.832658| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 7.911846| train set 5.497x speedup, test set 0.926x speedup, val set 5.106x speedup, step: 1
Epoch 101/200 |loss: 7.795176| train set 5.497x speedup, test set 0.926x speedup, val set 5.106x speedup, step: 1
Epoch 102/200 |loss: 7.903898| train set 5.497x speedup, test set 0.929x speedup, val set 5.106x speedup, step: 1
Epoch 103/200 |loss: 7.609224| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 1
Epoch 104/200 |loss: 7.803191| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 1
Epoch 105/200 |loss: 7.597527| train set 5.497x speedup, test set 0.930x speedup, val set 5.106x speedup, step: 1
Epoch 106/200 |loss: 7.640024| train set 5.497x speedup, test set 0.930x speedup, val set 5.106x speedup, step: 1
Epoch 107/200 |loss: 7.554317| train set 5.497x speedup, test set 0.827x speedup, val set 5.103x speedup, step: 2
Epoch 108/200 |loss: 7.620496| train set 5.497x speedup, test set 0.830x speedup, val set 5.106x speedup, step: 1
Epoch 109/200 |loss: 7.528485| train set 5.448x speedup, test set 0.932x speedup, val set 5.067x speedup, step: 2
Epoch 110/200 |loss: 7.522539| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 1
Epoch 111/200 |loss: 7.497927| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 1
Epoch 112/200 |loss: 7.530511| train set 5.497x speedup, test set 0.850x speedup, val set 5.106x speedup, step: 1
Epoch 113/200 |loss: 7.437258| train set 5.448x speedup, test set 0.930x speedup, val set 5.067x speedup, step: 2
Epoch 114/200 |loss: 7.452471| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 1
Epoch 115/200 |loss: 7.391839| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 1
Epoch 116/200 |loss: 7.385507| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 1
Epoch 117/200 |loss: 7.379490| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 1
Epoch 118/200 |loss: 7.366160| train set 5.448x speedup, test set 0.828x speedup, val set 5.067x speedup, step: 2
Epoch 119/200 |loss: 7.375871| train set 5.497x speedup, test set 0.825x speedup, val set 5.106x speedup, step: 1
Epoch 120/200 |loss: 7.424367| train set 5.498x speedup, test set 0.930x speedup, val set 5.116x speedup, step: 1
Epoch 121/200 |loss: 7.511279| train set 5.450x speedup, test set 0.827x speedup, val set 5.195x speedup, step: 1
Epoch 122/200 |loss: 7.900790| train set 5.496x speedup, test set 0.830x speedup, val set 5.107x speedup, step: 2
Epoch 123/200 |loss: 7.503448| train set 5.497x speedup, test set 0.932x speedup, val set 5.106x speedup, step: 3
Epoch 124/200 |loss: 7.417885| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 4
Epoch 125/200 |loss: 7.649640| train set 5.497x speedup, test set 0.929x speedup, val set 5.106x speedup, step: 5
Epoch 126/200 |loss: 7.471718| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 6
Epoch 127/200 |loss: 7.350255| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 7
Epoch 128/200 |loss: 7.344156| train set 5.451x speedup, test set 0.827x speedup, val set 5.069x speedup, step: 8
Epoch 129/200 |loss: 7.425475| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 9
Epoch 130/200 |loss: 7.595262| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 10
Epoch 131/200 |loss: 7.311444| train set 5.451x speedup, test set 0.929x speedup, val set 5.069x speedup, step: 11
Epoch 132/200 |loss: 7.499436| train set 5.450x speedup, test set 0.827x speedup, val set 5.195x speedup, step: 1
Epoch 133/200 |loss: 7.871498| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 2
Epoch 134/200 |loss: 7.383069| train set 5.450x speedup, test set 0.827x speedup, val set 5.070x speedup, step: 3
Epoch 135/200 |loss: 7.842278| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 4
Epoch 136/200 |loss: 8.087071| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 5
Epoch 137/200 |loss: 7.735785| train set 5.448x speedup, test set 0.827x speedup, val set 5.068x speedup, step: 6
Epoch 138/200 |loss: 7.933580| train set 5.448x speedup, test set 0.827x speedup, val set 5.068x speedup, step: 7
Epoch 139/200 |loss: 7.548961| train set 5.450x speedup, test set 0.827x speedup, val set 5.193x speedup, step: 8
Epoch 140/200 |loss: 7.881998| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 9
Epoch 141/200 |loss: 7.487942| train set 5.499x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 10
Epoch 142/200 |loss: 7.752196| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 11
Epoch 143/200 |loss: 7.422858| train set 5.497x speedup, test set 0.847x speedup, val set 5.106x speedup, step: 12
Epoch 144/200 |loss: 7.613011| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 13
Epoch 145/200 |loss: 7.385347| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 14
Epoch 146/200 |loss: 7.513350| train set 5.497x speedup, test set 0.825x speedup, val set 5.106x speedup, step: 15
Epoch 147/200 |loss: 7.374852| train set 5.496x speedup, test set 0.825x speedup, val set 5.107x speedup, step: 16
Epoch 148/200 |loss: 7.412098| train set 5.496x speedup, test set 0.825x speedup, val set 5.107x speedup, step: 17
Epoch 149/200 |loss: 7.359986| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 18
Epoch 150/200 |loss: 7.367524| train set 5.497x speedup, test set 0.847x speedup, val set 5.106x speedup, step: 19
Epoch 151/200 |loss: 7.342589| train set 5.496x speedup, test set 0.830x speedup, val set 5.107x speedup, step: 20
Epoch 152/200 |loss: 7.327921| train set 5.496x speedup, test set 0.830x speedup, val set 5.107x speedup, step: 21
Epoch 153/200 |loss: 7.279908| train set 5.497x speedup, test set 0.830x speedup, val set 5.106x speedup, step: 22
Epoch 154/200 |loss: 7.293862| train set 5.497x speedup, test set 0.825x speedup, val set 5.106x speedup, step: 23
Epoch 155/200 |loss: 7.255637| train set 5.497x speedup, test set 0.825x speedup, val set 5.106x speedup, step: 24
Epoch 156/200 |loss: 7.252670| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 25
Epoch 157/200 |loss: 7.269234| train set 5.498x speedup, test set 0.828x speedup, val set 5.103x speedup, step: 26
Epoch 158/200 |loss: 7.232279| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 27
Epoch 159/200 |loss: 7.312094| train set 5.448x speedup, test set 0.828x speedup, val set 5.067x speedup, step: 28
Epoch 160/200 |loss: 7.334455| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 29
Epoch 161/200 |loss: 7.376354| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 30
Epoch 162/200 |loss: 7.452464| train set 5.497x speedup, test set 0.828x speedup, val set 5.106x speedup, step: 31
Epoch 163/200 |loss: 7.359038| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 32
Epoch 164/200 |loss: 7.272817| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 33
Epoch 165/200 |loss: 7.213004| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 34
Epoch 166/200 |loss: 7.171013| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 35
Epoch 167/200 |loss: 7.201458| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 36
Epoch 168/200 |loss: 7.225673| train set 5.448x speedup, test set 0.827x speedup, val set 5.068x speedup, step: 37
Epoch 169/200 |loss: 7.271973| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 38
Epoch 170/200 |loss: 7.252439| train set 5.497x speedup, test set 0.827x speedup, val set 5.104x speedup, step: 39
Epoch 171/200 |loss: 7.269565| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 40
Epoch 172/200 |loss: 7.175842| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 41
Epoch 173/200 |loss: 7.176288| train set 5.451x speedup, test set 0.827x speedup, val set 5.069x speedup, step: 42
Epoch 174/200 |loss: 7.188886| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 43
Epoch 175/200 |loss: 7.212893| train set 5.448x speedup, test set 0.827x speedup, val set 5.067x speedup, step: 44
Epoch 176/200 |loss: 7.208884| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 45
Epoch 177/200 |loss: 7.187546| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 46
Epoch 178/200 |loss: 7.235960| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 47
Epoch 179/200 |loss: 7.280269| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 48
Epoch 180/200 |loss: 7.454377| train set 5.448x speedup, test set 0.827x speedup, val set 5.068x speedup, step: 49
Epoch 181/200 |loss: 7.301830| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 50
Epoch 182/200 |loss: 7.272972| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 51
Epoch 183/200 |loss: 7.162719| train set 5.448x speedup, test set 0.827x speedup, val set 5.068x speedup, step: 52
Epoch 184/200 |loss: 7.199628| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 53
Epoch 185/200 |loss: 7.296195| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 54
Epoch 186/200 |loss: 7.217078| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 55
Epoch 187/200 |loss: 7.207438| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 56
Epoch 188/200 |loss: 7.212041| train set 5.451x speedup, test set 0.827x speedup, val set 5.069x speedup, step: 57
Epoch 189/200 |loss: 7.184701| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 58
Epoch 190/200 |loss: 7.136298| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 59
Epoch 191/200 |loss: 7.126122| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 60
Epoch 192/200 |loss: 7.130494| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 61
Epoch 193/200 |loss: 7.123269| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 62
Epoch 194/200 |loss: 7.112868| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 63
Epoch 195/200 |loss: 7.107614| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 64
Epoch 196/200 |loss: 7.148435| train set 5.496x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 65
Epoch 197/200 |loss: 7.195951| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 66
Epoch 198/200 |loss: 7.495835| train set 5.499x speedup, test set 0.827x speedup, val set 5.109x speedup, step: 67
Epoch 199/200 |loss: 7.440418| train set 5.496x speedup, test set 0.835x speedup, val set 5.107x speedup, step: 68
Training per epoch cost 0.237 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 7.728s, pg runtime 2.959s, speedup 0.383x
11, opt runtime 0.294s, model runtime 0.332s, pg runtime 2.352s, speedup 7.089x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.457s, pg runtime 0.354s, speedup 0.774x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 3.995s, pg runtime 0.891s, speedup 0.223x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.177s, pg runtime 0.154s, speedup 0.874x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 12.105s, pg runtime 0.023s, speedup 0.002x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 141, train speedup 5.499, test speedup 0.827, val speedup 5.107
best test speedup epoch: 19, train speedup 4.832, test speedup 2.845, val speedup 4.526
best validation speedup epoch: 132, train speedup 5.450, test speedup 0.827, val speedup 5.195
last model at epoch 199, train speedup 5.496, test speedup 0.835, val speedup 5.107
execution cost 0:02:23.762839
==================================================
all print will write to path record/postgresql/cross/TPCH_JOB/TCNN/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/TPCH_JOB/TCNN/list
seed: 42
shuffle_num: 1
slow: 0
split_ratio: 0.1
src: TPCH
tgt: JOB
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1c.sql' '10b.sql' '11b.sql' '12a.sql' '13d.sql' '14c.sql' '15d.sql'
 '16a.sql' '17a.sql' '18a.sql' '19a.sql' '2b.sql' '20b.sql' '21a.sql'
 '22b.sql' '23c.sql' '24a.sql' '25a.sql' '26c.sql' '27a.sql' '28a.sql'
 '29a.sql' '3c.sql' '30b.sql' '31b.sql' '32a.sql' '33a.sql' '4c.sql'
 '5b.sql' '6c.sql' '7a.sql' '8a.sql' '9a.sql']
load JOB succ
load TPCH...
[0, 1, 3, 6, 7, 9] [4, 2] [5, 8]
[0, 3, 6, 7, 8, 9] [5, 1] [2, 4]
[0, 2, 3, 4, 8, 9] [1, 5] [7, 6]
[1, 2, 3, 5, 7, 8] [4, 0] [9, 6]
[0, 3, 4, 7, 8, 9] [1, 6] [2, 5]
[0, 1, 2, 6, 8, 9] [4, 5] [3, 7]
[2, 3, 4, 6, 7, 9] [1, 0] [5, 8]
[0, 2, 3, 6, 7, 9] [4, 1] [5, 8]
[0, 2, 3, 7, 8, 9] [1, 6] [5, 4]
[0, 1, 4, 6, 8, 9] [5, 2] [7, 3]
[0, 2, 5, 7, 8, 9] [3, 4] [1, 6]
[0, 3, 5, 6, 7, 9] [2, 8] [4, 1]
[0, 1, 2, 3, 8, 9] [7, 6] [4, 5]
[0, 1, 2, 4, 5, 9] [8, 3] [6, 7]
[2, 4, 5, 6, 7, 9] [0, 3] [1, 8]
[1, 2, 3, 7, 8, 9] [5, 6] [4, 0]
[0, 1, 2, 6, 8, 9] [3, 5] [4, 7]
[0, 2, 3, 4, 5, 8] [7, 6] [9, 1]
[0, 1, 3, 6, 8, 9] [4, 2] [5, 7]
[0, 1, 2, 3, 6, 7] [8, 9] [4, 5]
load TPCH succ
load TPCH_Skew...
[0, 1, 3, 4, 5, 8] [9, 6] [7, 2]
[1, 4, 5, 6, 7, 8] [3, 2] [9, 0]
[2, 3, 5, 6, 8, 9] [0, 1] [4, 7]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
[0, 1, 2, 3, 5, 8] [6, 7] [4, 9]
[2, 3, 4, 5, 7, 9] [0, 1] [6, 8]
[0, 2, 3, 7, 8, 9] [5, 1] [6, 4]
[1, 3, 4, 5, 8, 9] [2, 7] [0, 6]
[0, 1, 3, 6, 7, 9] [4, 8] [2, 5]
[0, 3, 6, 7, 8, 9] [1, 4] [5, 2]
[1, 3, 4, 7, 8, 9] [5, 2] [0, 6]
[1, 2, 3, 4, 6, 8] [5, 7] [0, 9]
[1, 2, 6, 7, 8, 9] [5, 4] [3, 0]
[0, 4, 5, 6, 8, 9] [3, 1] [2, 7]
[0, 4, 5, 6, 8, 9] [7, 1] [3, 2]
[0, 1, 3, 4, 5, 6] [7, 8] [2, 9]
[0, 1, 2, 5, 7, 9] [8, 6] [3, 4]
[0, 1, 2, 5, 6, 9] [3, 4] [8, 7]
[1, 2, 3, 4, 6, 8] [5, 7] [9, 0]
[0, 4, 5, 6, 7, 8] [3, 9] [1, 2]
load TPCH Skew succ
train, test, validation (120, 49) (33, 49) (40, 49)
1.105899469581136
-1.0
construct training samples cost 0:00:00.908789, and there are 120 training samples
in channel 9
Epoch 0/200 |loss: 24.719707| train set 1.512x speedup, test set 1.666x speedup, val set 1.593x speedup, step: 1
Epoch 1/200 |loss: 24.055296| train set 3.159x speedup, test set 1.928x speedup, val set 2.932x speedup, step: 2
Epoch 2/200 |loss: 23.511553| train set 3.272x speedup, test set 0.897x speedup, val set 2.950x speedup, step: 3
Epoch 3/200 |loss: 23.028431| train set 3.593x speedup, test set 0.855x speedup, val set 3.213x speedup, step: 4
Epoch 4/200 |loss: 22.474648| train set 4.153x speedup, test set 0.955x speedup, val set 3.962x speedup, step: 5
Epoch 5/200 |loss: 21.995951| train set 4.128x speedup, test set 0.975x speedup, val set 3.923x speedup, step: 6
Epoch 6/200 |loss: 21.539675| train set 4.432x speedup, test set 1.014x speedup, val set 4.196x speedup, step: 7
Epoch 7/200 |loss: 21.037212| train set 3.601x speedup, test set 1.017x speedup, val set 3.388x speedup, step: 8
Epoch 8/200 |loss: 20.524660| train set 3.688x speedup, test set 1.011x speedup, val set 3.381x speedup, step: 9
Epoch 9/200 |loss: 20.074562| train set 4.397x speedup, test set 0.987x speedup, val set 4.144x speedup, step: 10
Epoch 10/200 |loss: 19.570393| train set 4.397x speedup, test set 0.972x speedup, val set 4.144x speedup, step: 11
Epoch 11/200 |loss: 19.079531| train set 4.418x speedup, test set 0.983x speedup, val set 4.128x speedup, step: 12
Epoch 12/200 |loss: 18.586479| train set 4.418x speedup, test set 0.983x speedup, val set 4.129x speedup, step: 13
Epoch 13/200 |loss: 18.067806| train set 4.467x speedup, test set 1.021x speedup, val set 4.201x speedup, step: 14
Epoch 14/200 |loss: 17.602137| train set 4.467x speedup, test set 1.015x speedup, val set 4.201x speedup, step: 15
Epoch 15/200 |loss: 17.146929| train set 4.467x speedup, test set 1.066x speedup, val set 4.201x speedup, step: 16
Epoch 16/200 |loss: 16.682732| train set 4.552x speedup, test set 1.064x speedup, val set 4.345x speedup, step: 17
Epoch 17/200 |loss: 16.274244| train set 4.467x speedup, test set 1.081x speedup, val set 4.201x speedup, step: 18
Epoch 18/200 |loss: 15.853739| train set 4.702x speedup, test set 2.759x speedup, val set 4.471x speedup, step: 19
Epoch 19/200 |loss: 15.445743| train set 4.803x speedup, test set 2.845x speedup, val set 4.539x speedup, step: 20
Epoch 20/200 |loss: 15.071031| train set 4.978x speedup, test set 2.706x speedup, val set 4.797x speedup, step: 21
Epoch 21/200 |loss: 14.586862| train set 5.431x speedup, test set 2.706x speedup, val set 5.070x speedup, step: 22
Epoch 22/200 |loss: 14.157278| train set 5.431x speedup, test set 1.087x speedup, val set 5.070x speedup, step: 23
Epoch 23/200 |loss: 13.890249| train set 5.456x speedup, test set 1.071x speedup, val set 5.072x speedup, step: 24
Epoch 24/200 |loss: 13.643027| train set 5.472x speedup, test set 1.078x speedup, val set 5.104x speedup, step: 25
Epoch 25/200 |loss: 13.592988| train set 5.496x speedup, test set 1.078x speedup, val set 5.105x speedup, step: 26
Epoch 26/200 |loss: 13.338966| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 27
Epoch 27/200 |loss: 12.544399| train set 5.060x speedup, test set 1.076x speedup, val set 4.671x speedup, step: 28
Epoch 28/200 |loss: 12.611997| train set 5.497x speedup, test set 1.078x speedup, val set 5.106x speedup, step: 29
Epoch 29/200 |loss: 12.416245| train set 5.496x speedup, test set 1.063x speedup, val set 5.105x speedup, step: 30
Epoch 30/200 |loss: 12.073256| train set 5.497x speedup, test set 1.045x speedup, val set 5.106x speedup, step: 31
Epoch 31/200 |loss: 11.769073| train set 5.497x speedup, test set 1.074x speedup, val set 5.106x speedup, step: 32
Epoch 32/200 |loss: 11.339413| train set 5.497x speedup, test set 1.060x speedup, val set 5.106x speedup, step: 33
Epoch 33/200 |loss: 11.340610| train set 5.497x speedup, test set 1.059x speedup, val set 5.106x speedup, step: 34
Epoch 34/200 |loss: 11.010510| train set 5.497x speedup, test set 1.056x speedup, val set 5.106x speedup, step: 35
Epoch 35/200 |loss: 11.218524| train set 5.460x speedup, test set 1.054x speedup, val set 5.193x speedup, step: 36
Epoch 36/200 |loss: 11.110110| train set 5.496x speedup, test set 1.055x speedup, val set 5.105x speedup, step: 37
Epoch 37/200 |loss: 10.798130| train set 5.497x speedup, test set 1.050x speedup, val set 5.106x speedup, step: 38
Epoch 38/200 |loss: 10.352861| train set 5.497x speedup, test set 0.979x speedup, val set 5.106x speedup, step: 39
Epoch 39/200 |loss: 10.909380| train set 5.308x speedup, test set 1.055x speedup, val set 4.964x speedup, step: 40
Epoch 40/200 |loss: 10.404692| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 41
Epoch 41/200 |loss: 10.236376| train set 5.497x speedup, test set 1.074x speedup, val set 5.106x speedup, step: 42
Epoch 42/200 |loss: 10.060348| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 43
Epoch 43/200 |loss: 10.113142| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 44
Epoch 44/200 |loss: 9.575615| train set 5.448x speedup, test set 1.070x speedup, val set 5.067x speedup, step: 45
Epoch 45/200 |loss: 10.095128| train set 5.497x speedup, test set 1.054x speedup, val set 5.106x speedup, step: 46
Epoch 46/200 |loss: 10.085016| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 47
Epoch 47/200 |loss: 9.965296| train set 5.497x speedup, test set 0.980x speedup, val set 5.106x speedup, step: 48
Epoch 48/200 |loss: 9.835202| train set 5.497x speedup, test set 1.055x speedup, val set 5.106x speedup, step: 49
Epoch 49/200 |loss: 9.624325| train set 5.497x speedup, test set 1.054x speedup, val set 5.106x speedup, step: 50
Epoch 50/200 |loss: 9.474172| train set 5.497x speedup, test set 1.076x speedup, val set 5.106x speedup, step: 51
Epoch 51/200 |loss: 9.318785| train set 5.309x speedup, test set 0.986x speedup, val set 4.960x speedup, step: 52
Epoch 52/200 |loss: 9.552438| train set 5.497x speedup, test set 1.049x speedup, val set 5.106x speedup, step: 53
Epoch 53/200 |loss: 9.181080| train set 5.497x speedup, test set 1.049x speedup, val set 5.106x speedup, step: 54
Epoch 54/200 |loss: 9.054472| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 55
Epoch 55/200 |loss: 8.923805| train set 5.450x speedup, test set 0.986x speedup, val set 5.054x speedup, step: 56
Epoch 56/200 |loss: 9.265278| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 57
Epoch 57/200 |loss: 8.728431| train set 5.497x speedup, test set 1.081x speedup, val set 5.106x speedup, step: 58
Epoch 58/200 |loss: 8.787946| train set 5.496x speedup, test set 1.066x speedup, val set 5.105x speedup, step: 59
Epoch 59/200 |loss: 8.906169| train set 5.497x speedup, test set 0.987x speedup, val set 5.102x speedup, step: 60
Epoch 60/200 |loss: 8.586890| train set 5.496x speedup, test set 0.987x speedup, val set 5.105x speedup, step: 61
Epoch 61/200 |loss: 8.526159| train set 5.496x speedup, test set 1.066x speedup, val set 5.105x speedup, step: 62
Epoch 62/200 |loss: 8.596931| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 63
Epoch 63/200 |loss: 8.462303| train set 5.497x speedup, test set 0.987x speedup, val set 5.106x speedup, step: 64
Epoch 64/200 |loss: 8.341652| train set 5.496x speedup, test set 0.990x speedup, val set 5.105x speedup, step: 65
Epoch 65/200 |loss: 8.477644| train set 5.448x speedup, test set 0.990x speedup, val set 5.067x speedup, step: 66
Epoch 66/200 |loss: 8.243917| train set 5.497x speedup, test set 0.990x speedup, val set 5.106x speedup, step: 67
Epoch 67/200 |loss: 8.282939| train set 5.497x speedup, test set 0.974x speedup, val set 5.103x speedup, step: 68
Epoch 68/200 |loss: 8.257996| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 69
Epoch 69/200 |loss: 8.151333| train set 5.497x speedup, test set 0.872x speedup, val set 5.106x speedup, step: 70
Epoch 70/200 |loss: 8.082574| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 71
Epoch 71/200 |loss: 8.146645| train set 5.497x speedup, test set 0.976x speedup, val set 5.106x speedup, step: 72
Epoch 72/200 |loss: 8.121148| train set 5.497x speedup, test set 0.974x speedup, val set 5.106x speedup, step: 73
Epoch 73/200 |loss: 8.032667| train set 5.497x speedup, test set 0.875x speedup, val set 5.106x speedup, step: 74
Epoch 74/200 |loss: 7.850703| train set 5.497x speedup, test set 0.968x speedup, val set 5.106x speedup, step: 75
Epoch 75/200 |loss: 7.879005| train set 5.448x speedup, test set 0.980x speedup, val set 5.067x speedup, step: 76
Epoch 76/200 |loss: 7.881535| train set 5.497x speedup, test set 0.977x speedup, val set 5.106x speedup, step: 77
Epoch 77/200 |loss: 7.958743| train set 5.448x speedup, test set 0.860x speedup, val set 5.067x speedup, step: 78
Epoch 78/200 |loss: 8.091291| train set 5.450x speedup, test set 0.858x speedup, val set 5.193x speedup, step: 79
Epoch 79/200 |loss: 9.166376| train set 5.448x speedup, test set 0.980x speedup, val set 5.067x speedup, step: 80
Epoch 80/200 |loss: 8.224559| train set 5.497x speedup, test set 0.977x speedup, val set 5.106x speedup, step: 81
Epoch 81/200 |loss: 8.101021| train set 5.497x speedup, test set 0.977x speedup, val set 5.106x speedup, step: 82
Epoch 82/200 |loss: 8.244079| train set 5.448x speedup, test set 0.868x speedup, val set 5.067x speedup, step: 83
Epoch 83/200 |loss: 8.086143| train set 5.307x speedup, test set 0.865x speedup, val set 4.963x speedup, step: 84
Epoch 84/200 |loss: 8.087288| train set 5.448x speedup, test set 0.986x speedup, val set 5.066x speedup, step: 85
Epoch 85/200 |loss: 7.905579| train set 5.448x speedup, test set 0.974x speedup, val set 5.067x speedup, step: 86
Epoch 86/200 |loss: 7.816310| train set 5.449x speedup, test set 0.974x speedup, val set 5.054x speedup, step: 87
Epoch 87/200 |loss: 7.930846| train set 5.497x speedup, test set 0.986x speedup, val set 5.106x speedup, step: 88
Epoch 88/200 |loss: 7.688704| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 89
Epoch 89/200 |loss: 7.760997| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 90
Epoch 90/200 |loss: 7.708781| train set 5.497x speedup, test set 0.954x speedup, val set 5.106x speedup, step: 91
Epoch 91/200 |loss: 7.669633| train set 5.448x speedup, test set 0.970x speedup, val set 5.067x speedup, step: 92
Epoch 92/200 |loss: 7.936814| train set 5.450x speedup, test set 0.850x speedup, val set 5.193x speedup, step: 93
Epoch 93/200 |loss: 8.864552| train set 5.497x speedup, test set 0.938x speedup, val set 5.106x speedup, step: 94
Epoch 94/200 |loss: 7.751332| train set 5.448x speedup, test set 0.938x speedup, val set 5.067x speedup, step: 95
Epoch 95/200 |loss: 8.420703| train set 5.404x speedup, test set 0.819x speedup, val set 5.140x speedup, step: 96
Epoch 96/200 |loss: 9.282160| train set 5.496x speedup, test set 0.819x speedup, val set 5.107x speedup, step: 97
Epoch 97/200 |loss: 8.837232| train set 5.496x speedup, test set 0.936x speedup, val set 5.107x speedup, step: 98
Epoch 98/200 |loss: 8.656468| train set 5.448x speedup, test set 0.833x speedup, val set 5.068x speedup, step: 99
Epoch 99/200 |loss: 8.491996| train set 5.496x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 100
Epoch 100/200 |loss: 8.315262| train set 5.496x speedup, test set 0.832x speedup, val set 5.107x speedup, step: 1
Epoch 101/200 |loss: 8.165052| train set 5.496x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 2
Epoch 102/200 |loss: 8.089797| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 3
Epoch 103/200 |loss: 8.098083| train set 5.450x speedup, test set 0.825x speedup, val set 5.193x speedup, step: 1
Epoch 104/200 |loss: 7.934299| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 2
Epoch 105/200 |loss: 7.945194| train set 5.497x speedup, test set 0.837x speedup, val set 5.106x speedup, step: 3
Epoch 106/200 |loss: 7.941517| train set 5.497x speedup, test set 0.837x speedup, val set 5.106x speedup, step: 4
Epoch 107/200 |loss: 7.952213| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 5
Epoch 108/200 |loss: 7.911579| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 6
Epoch 109/200 |loss: 7.722705| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 7
Epoch 110/200 |loss: 7.770463| train set 5.497x speedup, test set 0.850x speedup, val set 5.106x speedup, step: 8
Epoch 111/200 |loss: 7.664049| train set 5.497x speedup, test set 0.850x speedup, val set 5.106x speedup, step: 9
Epoch 112/200 |loss: 7.719728| train set 5.497x speedup, test set 0.850x speedup, val set 5.106x speedup, step: 10
Epoch 113/200 |loss: 7.677151| train set 5.497x speedup, test set 0.858x speedup, val set 5.106x speedup, step: 11
Epoch 114/200 |loss: 7.596526| train set 5.496x speedup, test set 0.858x speedup, val set 5.105x speedup, step: 12
Epoch 115/200 |loss: 7.549657| train set 5.496x speedup, test set 0.858x speedup, val set 5.105x speedup, step: 13
Epoch 116/200 |loss: 7.514015| train set 5.496x speedup, test set 0.858x speedup, val set 5.105x speedup, step: 14
Epoch 117/200 |loss: 7.536484| train set 5.497x speedup, test set 0.865x speedup, val set 5.106x speedup, step: 15
Epoch 118/200 |loss: 7.548399| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 16
Epoch 119/200 |loss: 7.585762| train set 5.448x speedup, test set 0.855x speedup, val set 5.067x speedup, step: 17
Epoch 120/200 |loss: 7.452871| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 18
Epoch 121/200 |loss: 7.415676| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 19
Epoch 122/200 |loss: 7.386077| train set 5.498x speedup, test set 0.855x speedup, val set 5.104x speedup, step: 20
Epoch 123/200 |loss: 7.416331| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 21
Epoch 124/200 |loss: 7.538579| train set 5.448x speedup, test set 0.855x speedup, val set 5.068x speedup, step: 22
Epoch 125/200 |loss: 7.831616| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 23
Epoch 126/200 |loss: 7.910010| train set 5.448x speedup, test set 0.847x speedup, val set 5.068x speedup, step: 24
Epoch 127/200 |loss: 7.858136| train set 5.496x speedup, test set 0.847x speedup, val set 5.107x speedup, step: 25
Epoch 128/200 |loss: 7.381447| train set 5.449x speedup, test set 0.954x speedup, val set 5.055x speedup, step: 26
Epoch 129/200 |loss: 7.685599| train set 5.448x speedup, test set 0.855x speedup, val set 5.068x speedup, step: 27
Epoch 130/200 |loss: 8.037672| train set 5.496x speedup, test set 0.964x speedup, val set 5.107x speedup, step: 28
Epoch 131/200 |loss: 7.529232| train set 5.497x speedup, test set 0.833x speedup, val set 5.106x speedup, step: 29
Epoch 132/200 |loss: 7.757679| train set 5.448x speedup, test set 0.855x speedup, val set 5.067x speedup, step: 30
Epoch 133/200 |loss: 7.949707| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 31
Epoch 134/200 |loss: 7.449983| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 32
Epoch 135/200 |loss: 7.760909| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 33
Epoch 136/200 |loss: 7.535881| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 34
Epoch 137/200 |loss: 7.487726| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 35
Epoch 138/200 |loss: 7.587573| train set 5.497x speedup, test set 0.964x speedup, val set 5.106x speedup, step: 36
Epoch 139/200 |loss: 7.374749| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 37
Epoch 140/200 |loss: 7.539135| train set 5.499x speedup, test set 0.964x speedup, val set 5.107x speedup, step: 38
Epoch 141/200 |loss: 7.447231| train set 5.445x speedup, test set 0.964x speedup, val set 5.204x speedup, step: 1
Epoch 142/200 |loss: 7.581119| train set 5.451x speedup, test set 0.977x speedup, val set 5.069x speedup, step: 2
Epoch 143/200 |loss: 7.565007| train set 5.497x speedup, test set 0.855x speedup, val set 5.106x speedup, step: 3
Epoch 144/200 |loss: 7.713332| train set 5.496x speedup, test set 0.964x speedup, val set 5.107x speedup, step: 4
Epoch 145/200 |loss: 7.407615| train set 5.448x speedup, test set 0.964x speedup, val set 5.068x speedup, step: 5
Epoch 146/200 |loss: 7.400526| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 6
Epoch 147/200 |loss: 7.645719| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 7
Epoch 148/200 |loss: 7.310208| train set 5.450x speedup, test set 0.855x speedup, val set 5.070x speedup, step: 8
Epoch 149/200 |loss: 7.574080| train set 5.450x speedup, test set 0.855x speedup, val set 5.195x speedup, step: 9
Epoch 150/200 |loss: 7.847407| train set 5.496x speedup, test set 0.855x speedup, val set 5.107x speedup, step: 10
Epoch 151/200 |loss: 7.453877| train set 5.450x speedup, test set 0.834x speedup, val set 5.070x speedup, step: 11
Epoch 152/200 |loss: 7.965526| train set 5.450x speedup, test set 0.855x speedup, val set 5.195x speedup, step: 12
Epoch 153/200 |loss: 7.649212| train set 5.496x speedup, test set 0.833x speedup, val set 5.107x speedup, step: 13
Epoch 154/200 |loss: 7.618439| train set 5.448x speedup, test set 0.835x speedup, val set 5.068x speedup, step: 14
Epoch 155/200 |loss: 7.550890| train set 5.496x speedup, test set 0.835x speedup, val set 5.107x speedup, step: 15
Epoch 156/200 |loss: 7.480989| train set 5.497x speedup, test set 0.825x speedup, val set 5.106x speedup, step: 16
Epoch 157/200 |loss: 7.511677| train set 5.497x speedup, test set 0.825x speedup, val set 5.106x speedup, step: 17
Epoch 158/200 |loss: 7.430593| train set 5.499x speedup, test set 0.827x speedup, val set 5.107x speedup, step: 18
Epoch 159/200 |loss: 7.462663| train set 5.497x speedup, test set 0.827x speedup, val set 5.106x speedup, step: 19
Epoch 160/200 |loss: 7.320675| train set 5.497x speedup, test set 0.825x speedup, val set 5.106x speedup, step: 20
Epoch 161/200 |loss: 7.419382| train set 5.497x speedup, test set 0.810x speedup, val set 5.106x speedup, step: 21
Epoch 162/200 |loss: 7.289223| train set 5.499x speedup, test set 0.818x speedup, val set 5.107x speedup, step: 22
Epoch 163/200 |loss: 7.398492| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 23
Epoch 164/200 |loss: 7.289460| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 24
Epoch 165/200 |loss: 7.313083| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 25
Epoch 166/200 |loss: 7.274415| train set 5.497x speedup, test set 0.818x speedup, val set 5.106x speedup, step: 26
Epoch 167/200 |loss: 7.238443| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 27
Epoch 168/200 |loss: 7.272003| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 28
Epoch 169/200 |loss: 7.187216| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 29
Epoch 170/200 |loss: 7.265321| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 30
Epoch 171/200 |loss: 7.210474| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 31
Epoch 172/200 |loss: 7.202026| train set 5.496x speedup, test set 0.816x speedup, val set 5.107x speedup, step: 32
Epoch 173/200 |loss: 7.220961| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 33
Epoch 174/200 |loss: 7.188952| train set 5.448x speedup, test set 0.816x speedup, val set 5.067x speedup, step: 34
Epoch 175/200 |loss: 7.188929| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 35
Epoch 176/200 |loss: 7.195267| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 36
Epoch 177/200 |loss: 7.187827| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 37
Epoch 178/200 |loss: 7.177907| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 38
Epoch 179/200 |loss: 7.146239| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 39
Epoch 180/200 |loss: 7.166389| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 40
Epoch 181/200 |loss: 7.168246| train set 5.496x speedup, test set 0.816x speedup, val set 5.107x speedup, step: 41
Epoch 182/200 |loss: 7.128947| train set 5.496x speedup, test set 0.816x speedup, val set 5.107x speedup, step: 42
Epoch 183/200 |loss: 7.155759| train set 5.448x speedup, test set 0.816x speedup, val set 5.067x speedup, step: 43
Epoch 184/200 |loss: 7.167134| train set 5.497x speedup, test set 0.837x speedup, val set 5.106x speedup, step: 44
Epoch 185/200 |loss: 7.170625| train set 5.496x speedup, test set 0.816x speedup, val set 5.107x speedup, step: 45
Epoch 186/200 |loss: 7.223927| train set 5.497x speedup, test set 0.837x speedup, val set 5.106x speedup, step: 46
Epoch 187/200 |loss: 7.207428| train set 5.496x speedup, test set 0.816x speedup, val set 5.107x speedup, step: 47
Epoch 188/200 |loss: 7.174474| train set 5.496x speedup, test set 0.816x speedup, val set 5.107x speedup, step: 48
Epoch 189/200 |loss: 7.170956| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 49
Epoch 190/200 |loss: 7.206978| train set 5.497x speedup, test set 0.824x speedup, val set 5.106x speedup, step: 50
Epoch 191/200 |loss: 7.178512| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 51
Epoch 192/200 |loss: 7.221299| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 52
Epoch 193/200 |loss: 7.190501| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 53
Epoch 194/200 |loss: 7.189478| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 54
Epoch 195/200 |loss: 7.161592| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 55
Epoch 196/200 |loss: 7.131325| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 56
Epoch 197/200 |loss: 7.116141| train set 5.497x speedup, test set 0.816x speedup, val set 5.106x speedup, step: 57
Epoch 198/200 |loss: 7.135103| train set 5.496x speedup, test set 0.816x speedup, val set 5.107x speedup, step: 58
Epoch 199/200 |loss: 7.120975| train set 5.496x speedup, test set 0.816x speedup, val set 5.107x speedup, step: 59
Training per epoch cost 0.224 s
Optimal speedup on test set is 3.967x
01, opt runtime 0.012s, model runtime 0.072s, pg runtime 0.072s, speedup 1.000x
02, opt runtime 0.183s, model runtime 0.183s, pg runtime 0.189s, speedup 1.037x
03, opt runtime 0.014s, model runtime 0.014s, pg runtime 0.014s, speedup 1.000x
04, opt runtime 0.348s, model runtime 0.348s, pg runtime 0.348s, speedup 1.000x
05, opt runtime 2.262s, model runtime 3.549s, pg runtime 3.549s, speedup 1.000x
06, opt runtime 0.756s, model runtime 0.802s, pg runtime 0.802s, speedup 1.000x
07, opt runtime 0.919s, model runtime 0.919s, pg runtime 0.942s, speedup 1.024x
08, opt runtime 0.206s, model runtime 0.211s, pg runtime 0.206s, speedup 0.978x
09, opt runtime 2.324s, model runtime 10.128s, pg runtime 10.605s, speedup 1.047x
10, opt runtime 2.959s, model runtime 6.722s, pg runtime 2.959s, speedup 0.440x
11, opt runtime 0.294s, model runtime 0.331s, pg runtime 2.352s, speedup 7.109x
12, opt runtime 0.463s, model runtime 0.557s, pg runtime 0.557s, speedup 1.000x
13, opt runtime 1.829s, model runtime 53.885s, pg runtime 53.885s, speedup 1.000x
14, opt runtime 0.113s, model runtime 0.153s, pg runtime 0.153s, speedup 1.000x
15, opt runtime 0.313s, model runtime 0.313s, pg runtime 0.313s, speedup 1.000x
16, opt runtime 0.441s, model runtime 0.467s, pg runtime 0.453s, speedup 0.972x
17, opt runtime 0.327s, model runtime 0.733s, pg runtime 0.354s, speedup 0.482x
18, opt runtime 2.599s, model runtime 2.599s, pg runtime 2.599s, speedup 1.000x
19, opt runtime 1.923s, model runtime 3.540s, pg runtime 3.540s, speedup 1.000x
20, opt runtime 0.061s, model runtime 0.079s, pg runtime 0.086s, speedup 1.091x
21, opt runtime 0.626s, model runtime 2.552s, pg runtime 2.558s, speedup 1.003x
22, opt runtime 0.136s, model runtime 1.143s, pg runtime 0.891s, speedup 0.780x
23, opt runtime 0.389s, model runtime 1.594s, pg runtime 0.389s, speedup 0.244x
24, opt runtime 0.189s, model runtime 0.540s, pg runtime 0.189s, speedup 0.350x
25, opt runtime 0.434s, model runtime 0.434s, pg runtime 0.434s, speedup 1.000x
26, opt runtime 0.020s, model runtime 0.020s, pg runtime 0.020s, speedup 1.000x
27, opt runtime 0.060s, model runtime 0.097s, pg runtime 0.112s, speedup 1.164x
28, opt runtime 0.154s, model runtime 0.154s, pg runtime 0.154s, speedup 1.000x
29, opt runtime 0.136s, model runtime 0.137s, pg runtime 0.137s, speedup 1.000x
30, opt runtime 0.023s, model runtime 0.023s, pg runtime 0.023s, speedup 1.000x
31, opt runtime 0.965s, model runtime 0.965s, pg runtime 0.965s, speedup 1.000x
32, opt runtime 1.315s, model runtime 1.315s, pg runtime 1.315s, speedup 1.000x
33, opt runtime 0.250s, model runtime 0.250s, pg runtime 0.250s, speedup 1.000x
====================
best train speedup epoch: 140, train speedup 5.499, test speedup 0.964, val speedup 5.107
best test speedup epoch: 19, train speedup 4.803, test speedup 2.845, val speedup 4.539
best validation speedup epoch: 141, train speedup 5.445, test speedup 0.964, val speedup 5.204
last model at epoch 199, train speedup 5.496, test speedup 0.816, val speedup 5.107
execution cost 0:02:22.781708
==================================================
