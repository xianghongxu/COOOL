all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:01.703133, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678939| train set 0.995x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697585| train set 0.951x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714947| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729939| train set 1.290x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740496| train set 1.241x speedup, test set 2.908x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750724| train set 1.231x speedup, test set 3.013x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766795| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.783684| train set 1.212x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796082| train set 1.249x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801605| train set 1.370x speedup, test set 2.380x speedup, val set 0.860x speedup, step: 14
Epoch 16/200 |loss: -0.807217| train set 1.325x speedup, test set 2.369x speedup, val set 0.860x speedup, step: 15
Epoch 17/200 |loss: -0.813988| train set 1.332x speedup, test set 2.366x speedup, val set 0.860x speedup, step: 16
Epoch 18/200 |loss: -0.820657| train set 1.326x speedup, test set 2.507x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826057| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 18
Epoch 20/200 |loss: -0.830465| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834279| train set 1.331x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 20
Epoch 22/200 |loss: -0.838191| train set 1.308x speedup, test set 2.555x speedup, val set 0.802x speedup, step: 21
Epoch 23/200 |loss: -0.841855| train set 1.299x speedup, test set 2.745x speedup, val set 0.824x speedup, step: 22
Epoch 24/200 |loss: -0.845550| train set 1.298x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 23
Epoch 25/200 |loss: -0.848754| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 24
Epoch 26/200 |loss: -0.851991| train set 1.310x speedup, test set 2.581x speedup, val set 0.802x speedup, step: 25
Epoch 27/200 |loss: -0.855382| train set 1.318x speedup, test set 2.639x speedup, val set 0.802x speedup, step: 26
Epoch 28/200 |loss: -0.858279| train set 1.320x speedup, test set 2.613x speedup, val set 0.802x speedup, step: 27
Epoch 29/200 |loss: -0.860688| train set 1.308x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 28
Epoch 30/200 |loss: -0.862875| train set 1.309x speedup, test set 2.726x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865209| train set 1.309x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.867813| train set 1.309x speedup, test set 2.782x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.870035| train set 1.311x speedup, test set 2.806x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.871971| train set 1.289x speedup, test set 2.662x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.873945| train set 1.282x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.875701| train set 1.283x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.876665| train set 1.284x speedup, test set 2.706x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.876713| train set 1.284x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.880183| train set 1.280x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.881573| train set 1.280x speedup, test set 2.737x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.881559| train set 1.267x speedup, test set 2.707x speedup, val set 0.803x speedup, step: 40
Epoch 42/200 |loss: -0.883415| train set 1.274x speedup, test set 2.737x speedup, val set 0.883x speedup, step: 41
Epoch 43/200 |loss: -0.882232| train set 1.264x speedup, test set 2.737x speedup, val set 0.883x speedup, step: 42
Epoch 44/200 |loss: -0.887461| train set 1.272x speedup, test set 2.628x speedup, val set 0.883x speedup, step: 43
Epoch 45/200 |loss: -0.877045| train set 1.380x speedup, test set 2.735x speedup, val set 0.943x speedup, step: 44
Epoch 46/200 |loss: -0.876588| train set 1.415x speedup, test set 2.735x speedup, val set 0.989x speedup, step: 1
Epoch 47/200 |loss: -0.871088| train set 1.416x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 2
early stopping at epoch 47
Training per epoch cost 0.618 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
08, opt runtime 7.377s, model runtime 34.537s, pg runtime 28.655s, speedup 0.830x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
12, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 125.113s, pg runtime 148.707s, speedup 1.189x
16, opt runtime 53.440s, model runtime 119.421s, pg runtime 140.742s, speedup 1.179x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.956s, pg runtime 1.438s, speedup 0.735x
20, opt runtime 1.428s, model runtime 1.754s, pg runtime 1.428s, speedup 0.814x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 3.569s, pg runtime 1.752s, speedup 0.491x
26, opt runtime 1.423s, model runtime 3.427s, pg runtime 1.423s, speedup 0.415x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 18.690s, model runtime 53.540s, pg runtime 651.942s, speedup 12.177x
36, opt runtime 16.280s, model runtime 50.583s, pg runtime 634.990s, speedup 12.553x
37, opt runtime 19.707s, model runtime 86.228s, pg runtime 19.707s, speedup 0.229x
38, opt runtime 18.262s, model runtime 84.226s, pg runtime 18.262s, speedup 0.217x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 1, train speedup 1.454, test speedup 1.861, val speedup 0.986
best test speedup epoch: 11, train speedup 1.231, test speedup 3.013, val speedup 0.836
best validation speedup epoch: 46, train speedup 1.415, test speedup 2.735, val speedup 0.989
last model at epoch 47, train speedup 1.416, test speedup 2.923, val speedup 0.988
execution cost 0:01:36.553447
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:01.990792, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678939| train set 0.995x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697580| train set 0.951x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714958| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729949| train set 1.290x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740503| train set 1.241x speedup, test set 2.908x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750775| train set 1.231x speedup, test set 3.013x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766864| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.783773| train set 1.212x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796229| train set 1.249x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801736| train set 1.391x speedup, test set 2.380x speedup, val set 0.860x speedup, step: 14
Epoch 16/200 |loss: -0.807339| train set 1.345x speedup, test set 2.369x speedup, val set 0.860x speedup, step: 15
Epoch 17/200 |loss: -0.814100| train set 1.352x speedup, test set 2.388x speedup, val set 0.860x speedup, step: 16
Epoch 18/200 |loss: -0.820791| train set 1.352x speedup, test set 2.507x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826218| train set 1.331x speedup, test set 2.552x speedup, val set 0.836x speedup, step: 18
Epoch 20/200 |loss: -0.830661| train set 1.331x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834494| train set 1.341x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 20
Epoch 22/200 |loss: -0.838392| train set 1.308x speedup, test set 2.555x speedup, val set 0.802x speedup, step: 21
Epoch 23/200 |loss: -0.842111| train set 1.299x speedup, test set 2.767x speedup, val set 0.825x speedup, step: 22
Epoch 24/200 |loss: -0.845835| train set 1.298x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 23
Epoch 25/200 |loss: -0.848969| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 24
Epoch 26/200 |loss: -0.852123| train set 1.299x speedup, test set 2.611x speedup, val set 0.802x speedup, step: 25
Epoch 27/200 |loss: -0.855498| train set 1.313x speedup, test set 2.639x speedup, val set 0.802x speedup, step: 26
Epoch 28/200 |loss: -0.858333| train set 1.314x speedup, test set 2.613x speedup, val set 0.802x speedup, step: 27
Epoch 29/200 |loss: -0.860666| train set 1.322x speedup, test set 2.697x speedup, val set 0.802x speedup, step: 28
Epoch 30/200 |loss: -0.863113| train set 1.315x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865793| train set 1.316x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.868171| train set 1.323x speedup, test set 2.806x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.870176| train set 1.282x speedup, test set 2.778x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.871835| train set 1.282x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.873266| train set 1.282x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.875413| train set 1.283x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.877434| train set 1.283x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.879177| train set 1.283x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.880578| train set 1.279x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.880770| train set 1.280x speedup, test set 2.676x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.879492| train set 1.276x speedup, test set 2.705x speedup, val set 0.883x speedup, step: 40
Epoch 42/200 |loss: -0.876015| train set 1.309x speedup, test set 2.705x speedup, val set 0.896x speedup, step: 41
Epoch 43/200 |loss: -0.879327| train set 1.308x speedup, test set 2.646x speedup, val set 0.944x speedup, step: 42
Epoch 44/200 |loss: -0.884143| train set 1.315x speedup, test set 2.978x speedup, val set 0.944x speedup, step: 43
Epoch 45/200 |loss: -0.876384| train set 1.437x speedup, test set 2.646x speedup, val set 0.989x speedup, step: 1
Epoch 46/200 |loss: -0.882145| train set 1.417x speedup, test set 2.645x speedup, val set 0.988x speedup, step: 2
Epoch 47/200 |loss: -0.875072| train set 1.417x speedup, test set 2.888x speedup, val set 0.988x speedup, step: 3
Epoch 48/200 |loss: -0.877919| train set 1.440x speedup, test set 3.048x speedup, val set 0.988x speedup, step: 4
early stopping at epoch 48
Training per epoch cost 0.736 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
08, opt runtime 7.377s, model runtime 34.537s, pg runtime 28.655s, speedup 0.830x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
12, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.619s, pg runtime 1.438s, speedup 0.888x
20, opt runtime 1.428s, model runtime 1.628s, pg runtime 1.428s, speedup 0.877x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 3.569s, pg runtime 1.752s, speedup 0.491x
26, opt runtime 1.423s, model runtime 3.427s, pg runtime 1.423s, speedup 0.415x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 18.690s, model runtime 53.540s, pg runtime 651.942s, speedup 12.177x
36, opt runtime 16.280s, model runtime 50.583s, pg runtime 634.990s, speedup 12.553x
37, opt runtime 19.707s, model runtime 86.228s, pg runtime 19.707s, speedup 0.229x
38, opt runtime 18.262s, model runtime 84.226s, pg runtime 18.262s, speedup 0.217x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 1, train speedup 1.454, test speedup 1.861, val speedup 0.986
best test speedup epoch: 48, train speedup 1.440, test speedup 3.048, val speedup 0.988
best validation speedup epoch: 45, train speedup 1.437, test speedup 2.646, val speedup 0.989
last model at epoch 48, train speedup 1.440, test speedup 3.048, val speedup 0.988
execution cost 0:01:56.689533
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:01.969308, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678939| train set 0.995x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697585| train set 0.951x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714947| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729939| train set 1.290x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740496| train set 1.241x speedup, test set 2.908x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750724| train set 1.231x speedup, test set 3.013x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766795| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.783684| train set 1.212x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796082| train set 1.249x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801605| train set 1.370x speedup, test set 2.380x speedup, val set 0.860x speedup, step: 14
Epoch 16/200 |loss: -0.807217| train set 1.325x speedup, test set 2.369x speedup, val set 0.860x speedup, step: 15
Epoch 17/200 |loss: -0.813988| train set 1.332x speedup, test set 2.366x speedup, val set 0.860x speedup, step: 16
Epoch 18/200 |loss: -0.820657| train set 1.326x speedup, test set 2.507x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826057| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 18
Epoch 20/200 |loss: -0.830465| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834279| train set 1.331x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 20
Epoch 22/200 |loss: -0.838191| train set 1.308x speedup, test set 2.555x speedup, val set 0.802x speedup, step: 21
Epoch 23/200 |loss: -0.841855| train set 1.299x speedup, test set 2.745x speedup, val set 0.824x speedup, step: 22
Epoch 24/200 |loss: -0.845550| train set 1.298x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 23
Epoch 25/200 |loss: -0.848754| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 24
Epoch 26/200 |loss: -0.851991| train set 1.310x speedup, test set 2.581x speedup, val set 0.802x speedup, step: 25
Epoch 27/200 |loss: -0.855382| train set 1.318x speedup, test set 2.639x speedup, val set 0.802x speedup, step: 26
Epoch 28/200 |loss: -0.858279| train set 1.320x speedup, test set 2.613x speedup, val set 0.802x speedup, step: 27
Epoch 29/200 |loss: -0.860689| train set 1.308x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 28
Epoch 30/200 |loss: -0.862874| train set 1.309x speedup, test set 2.726x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865208| train set 1.309x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.867814| train set 1.309x speedup, test set 2.782x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.870043| train set 1.311x speedup, test set 2.806x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.871965| train set 1.289x speedup, test set 2.662x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.873927| train set 1.282x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.875655| train set 1.283x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.876422| train set 1.284x speedup, test set 2.706x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.876338| train set 1.280x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.880364| train set 1.280x speedup, test set 2.707x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.879623| train set 1.279x speedup, test set 2.737x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.878043| train set 1.279x speedup, test set 2.737x speedup, val set 0.883x speedup, step: 40
Epoch 42/200 |loss: -0.881008| train set 1.271x speedup, test set 2.691x speedup, val set 0.883x speedup, step: 41
Epoch 43/200 |loss: -0.880922| train set 1.307x speedup, test set 2.737x speedup, val set 0.883x speedup, step: 42
Epoch 44/200 |loss: -0.883202| train set 1.205x speedup, test set 2.737x speedup, val set 0.943x speedup, step: 43
Epoch 45/200 |loss: -0.881629| train set 1.205x speedup, test set 2.998x speedup, val set 0.943x speedup, step: 44
Epoch 46/200 |loss: -0.885136| train set 1.304x speedup, test set 2.952x speedup, val set 0.883x speedup, step: 45
Epoch 47/200 |loss: -0.886630| train set 1.314x speedup, test set 2.868x speedup, val set 0.883x speedup, step: 46
Epoch 48/200 |loss: -0.888374| train set 1.399x speedup, test set 2.998x speedup, val set 0.981x speedup, step: 47
Epoch 49/200 |loss: -0.888496| train set 1.399x speedup, test set 2.998x speedup, val set 0.981x speedup, step: 48
Epoch 50/200 |loss: -0.891026| train set 1.400x speedup, test set 2.998x speedup, val set 0.981x speedup, step: 49
Epoch 51/200 |loss: -0.890469| train set 1.409x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 50
Epoch 52/200 |loss: -0.893762| train set 1.409x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 51
Epoch 53/200 |loss: -0.892706| train set 1.409x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 52
Epoch 54/200 |loss: -0.894813| train set 1.409x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 53
Epoch 55/200 |loss: -0.894552| train set 1.410x speedup, test set 2.924x speedup, val set 0.980x speedup, step: 54
Epoch 56/200 |loss: -0.896080| train set 1.410x speedup, test set 2.924x speedup, val set 0.980x speedup, step: 55
Epoch 57/200 |loss: -0.896480| train set 1.409x speedup, test set 2.924x speedup, val set 0.980x speedup, step: 56
Epoch 58/200 |loss: -0.897926| train set 1.413x speedup, test set 2.924x speedup, val set 0.980x speedup, step: 57
Epoch 59/200 |loss: -0.898982| train set 1.414x speedup, test set 2.761x speedup, val set 0.980x speedup, step: 58
Epoch 60/200 |loss: -0.899554| train set 1.287x speedup, test set 2.923x speedup, val set 0.980x speedup, step: 59
Epoch 61/200 |loss: -0.900457| train set 1.286x speedup, test set 2.923x speedup, val set 0.980x speedup, step: 60
Epoch 62/200 |loss: -0.901258| train set 1.430x speedup, test set 2.655x speedup, val set 0.980x speedup, step: 61
Epoch 63/200 |loss: -0.901508| train set 1.453x speedup, test set 2.655x speedup, val set 0.980x speedup, step: 62
Epoch 64/200 |loss: -0.902620| train set 1.458x speedup, test set 2.655x speedup, val set 0.988x speedup, step: 1
Epoch 65/200 |loss: -0.903001| train set 1.496x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 66/200 |loss: -0.903270| train set 1.496x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 67/200 |loss: -0.904156| train set 1.482x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 68/200 |loss: -0.904323| train set 1.482x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 69/200 |loss: -0.904551| train set 1.479x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 70/200 |loss: -0.905240| train set 1.479x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 71/200 |loss: -0.905647| train set 1.460x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 72/200 |loss: -0.905972| train set 1.457x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 73/200 |loss: -0.906464| train set 1.457x speedup, test set 2.923x speedup, val set 0.980x speedup, step: 2
Epoch 74/200 |loss: -0.906640| train set 1.461x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 75/200 |loss: -0.906405| train set 1.459x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 76/200 |loss: -0.907358| train set 1.473x speedup, test set 3.085x speedup, val set 0.988x speedup, step: 1
Epoch 77/200 |loss: -0.907395| train set 1.480x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 78/200 |loss: -0.906288| train set 1.473x speedup, test set 3.085x speedup, val set 0.988x speedup, step: 1
Epoch 79/200 |loss: -0.907980| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 80/200 |loss: -0.908796| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 81/200 |loss: -0.909676| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 82/200 |loss: -0.908359| train set 1.480x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 83/200 |loss: -0.897756| train set 1.487x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 84/200 |loss: -0.905995| train set 1.434x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
early stopping at epoch 84
Training per epoch cost 0.732 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 47.174s, pg runtime 112.305s, speedup 2.381x
04, opt runtime 30.267s, model runtime 43.737s, pg runtime 100.885s, speedup 2.307x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
08, opt runtime 7.377s, model runtime 34.537s, pg runtime 28.655s, speedup 0.830x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
12, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.956s, pg runtime 1.438s, speedup 0.735x
20, opt runtime 1.428s, model runtime 1.754s, pg runtime 1.428s, speedup 0.814x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 3.569s, pg runtime 1.752s, speedup 0.491x
26, opt runtime 1.423s, model runtime 3.427s, pg runtime 1.423s, speedup 0.415x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 67.957s, pg runtime 19.707s, speedup 0.290x
38, opt runtime 18.262s, model runtime 68.157s, pg runtime 18.262s, speedup 0.268x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 65, train speedup 1.496, test speedup 2.923, val speedup 0.988
best test speedup epoch: 79, train speedup 1.474, test speedup 3.172, val speedup 0.988
best validation speedup epoch: 84, train speedup 1.434, test speedup 3.172, val speedup 0.988
last model at epoch 84, train speedup 1.434, test speedup 3.172, val speedup 0.988
execution cost 0:03:09.885742
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:01.797444, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678940| train set 0.995x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697586| train set 0.951x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714948| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729947| train set 1.290x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740498| train set 1.241x speedup, test set 2.875x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750768| train set 1.231x speedup, test set 3.013x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766824| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.783918| train set 1.212x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796171| train set 1.249x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801612| train set 1.370x speedup, test set 2.380x speedup, val set 0.860x speedup, step: 14
Epoch 16/200 |loss: -0.807227| train set 1.325x speedup, test set 2.369x speedup, val set 0.860x speedup, step: 15
Epoch 17/200 |loss: -0.814038| train set 1.332x speedup, test set 2.366x speedup, val set 0.836x speedup, step: 16
Epoch 18/200 |loss: -0.820728| train set 1.326x speedup, test set 2.507x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826066| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 18
Epoch 20/200 |loss: -0.830458| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834299| train set 1.331x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 20
Epoch 22/200 |loss: -0.838263| train set 1.308x speedup, test set 2.599x speedup, val set 0.802x speedup, step: 21
Epoch 23/200 |loss: -0.841953| train set 1.299x speedup, test set 2.745x speedup, val set 0.824x speedup, step: 22
Epoch 24/200 |loss: -0.845559| train set 1.298x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 23
Epoch 25/200 |loss: -0.848863| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 24
Epoch 26/200 |loss: -0.852050| train set 1.308x speedup, test set 2.626x speedup, val set 0.802x speedup, step: 25
Epoch 27/200 |loss: -0.855309| train set 1.313x speedup, test set 2.639x speedup, val set 0.802x speedup, step: 26
Epoch 28/200 |loss: -0.858307| train set 1.320x speedup, test set 2.613x speedup, val set 0.802x speedup, step: 27
Epoch 29/200 |loss: -0.860805| train set 1.322x speedup, test set 2.697x speedup, val set 0.802x speedup, step: 28
Epoch 30/200 |loss: -0.863117| train set 1.316x speedup, test set 2.726x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865569| train set 1.316x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.868000| train set 1.307x speedup, test set 2.782x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.870155| train set 1.317x speedup, test set 2.494x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.872190| train set 1.282x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.874207| train set 1.283x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.876029| train set 1.284x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.877354| train set 1.284x speedup, test set 2.706x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.877926| train set 1.284x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.878692| train set 1.279x speedup, test set 2.737x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.879812| train set 1.280x speedup, test set 2.737x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.883423| train set 1.281x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 40
Epoch 42/200 |loss: -0.877834| train set 1.302x speedup, test set 2.735x speedup, val set 0.883x speedup, step: 41
Epoch 43/200 |loss: -0.874857| train set 1.208x speedup, test set 2.735x speedup, val set 0.941x speedup, step: 42
Epoch 44/200 |loss: -0.870963| train set 1.263x speedup, test set 2.737x speedup, val set 0.978x speedup, step: 43
Epoch 45/200 |loss: -0.877464| train set 1.212x speedup, test set 2.924x speedup, val set 0.978x speedup, step: 44
Epoch 46/200 |loss: -0.883383| train set 1.249x speedup, test set 3.016x speedup, val set 0.978x speedup, step: 45
Epoch 47/200 |loss: -0.879969| train set 1.306x speedup, test set 3.016x speedup, val set 0.986x speedup, step: 1
Epoch 48/200 |loss: -0.881211| train set 1.419x speedup, test set 2.949x speedup, val set 0.977x speedup, step: 2
Epoch 49/200 |loss: -0.887840| train set 1.397x speedup, test set 2.801x speedup, val set 0.977x speedup, step: 3
Epoch 50/200 |loss: -0.885479| train set 1.397x speedup, test set 2.572x speedup, val set 0.977x speedup, step: 4
Epoch 51/200 |loss: -0.886692| train set 1.419x speedup, test set 2.801x speedup, val set 0.977x speedup, step: 5
Epoch 52/200 |loss: -0.892483| train set 1.418x speedup, test set 2.949x speedup, val set 0.977x speedup, step: 6
Epoch 53/200 |loss: -0.890299| train set 1.403x speedup, test set 2.801x speedup, val set 0.977x speedup, step: 7
Epoch 54/200 |loss: -0.894171| train set 1.398x speedup, test set 2.868x speedup, val set 0.977x speedup, step: 8
Epoch 55/200 |loss: -0.894759| train set 1.398x speedup, test set 2.998x speedup, val set 0.977x speedup, step: 9
Epoch 56/200 |loss: -0.896193| train set 1.291x speedup, test set 2.868x speedup, val set 0.977x speedup, step: 10
Epoch 57/200 |loss: -0.898667| train set 1.249x speedup, test set 2.868x speedup, val set 0.977x speedup, step: 11
Epoch 58/200 |loss: -0.897558| train set 1.274x speedup, test set 2.998x speedup, val set 0.977x speedup, step: 12
Epoch 59/200 |loss: -0.900254| train set 1.433x speedup, test set 2.997x speedup, val set 0.977x speedup, step: 13
Epoch 60/200 |loss: -0.900668| train set 1.432x speedup, test set 2.996x speedup, val set 0.980x speedup, step: 14
Epoch 61/200 |loss: -0.901446| train set 1.353x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 15
Epoch 62/200 |loss: -0.902760| train set 1.260x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 16
Epoch 63/200 |loss: -0.902347| train set 1.432x speedup, test set 2.996x speedup, val set 0.980x speedup, step: 17
Epoch 64/200 |loss: -0.904421| train set 1.433x speedup, test set 2.923x speedup, val set 0.980x speedup, step: 18
Epoch 65/200 |loss: -0.904348| train set 1.303x speedup, test set 2.923x speedup, val set 0.980x speedup, step: 19
Epoch 66/200 |loss: -0.905687| train set 1.303x speedup, test set 3.001x speedup, val set 0.980x speedup, step: 20
Epoch 67/200 |loss: -0.905805| train set 1.303x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 68/200 |loss: -0.906876| train set 1.321x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 69/200 |loss: -0.907210| train set 1.321x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 70/200 |loss: -0.907770| train set 1.321x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 71/200 |loss: -0.908421| train set 1.321x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 72/200 |loss: -0.908811| train set 1.321x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 73/200 |loss: -0.909361| train set 1.321x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 74/200 |loss: -0.909839| train set 1.320x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 75/200 |loss: -0.910157| train set 1.324x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 76/200 |loss: -0.910797| train set 1.324x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 77/200 |loss: -0.911107| train set 1.319x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 78/200 |loss: -0.911567| train set 1.324x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 79/200 |loss: -0.911944| train set 1.324x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 80/200 |loss: -0.912198| train set 1.324x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 81/200 |loss: -0.912761| train set 1.319x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 82/200 |loss: -0.912850| train set 1.344x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 83/200 |loss: -0.911405| train set 1.344x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 84/200 |loss: -0.913505| train set 1.302x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 85/200 |loss: -0.904683| train set 1.343x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 86/200 |loss: -0.899072| train set 1.483x speedup, test set 3.169x speedup, val set 0.988x speedup, step: 1
early stopping at epoch 86
Training per epoch cost 0.648 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 47.174s, pg runtime 112.305s, speedup 2.381x
04, opt runtime 30.267s, model runtime 43.737s, pg runtime 100.885s, speedup 2.307x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
08, opt runtime 7.377s, model runtime 34.537s, pg runtime 28.655s, speedup 0.830x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.654s, pg runtime 1.438s, speedup 0.869x
20, opt runtime 1.428s, model runtime 1.715s, pg runtime 1.428s, speedup 0.833x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 3.569s, pg runtime 1.752s, speedup 0.491x
26, opt runtime 1.423s, model runtime 3.427s, pg runtime 1.423s, speedup 0.415x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
34, opt runtime 39.191s, model runtime 39.191s, pg runtime 75.984s, speedup 1.939x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 67.957s, pg runtime 19.707s, speedup 0.290x
38, opt runtime 18.262s, model runtime 68.157s, pg runtime 18.262s, speedup 0.268x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 86, train speedup 1.483, test speedup 3.169, val speedup 0.988
best test speedup epoch: 86, train speedup 1.483, test speedup 3.169, val speedup 0.988
best validation speedup epoch: 86, train speedup 1.483, test speedup 3.169, val speedup 0.988
last model at epoch 86, train speedup 1.483, test speedup 3.169, val speedup 0.988
execution cost 0:02:59.094491
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:02.051927, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678939| train set 0.995x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697580| train set 0.951x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714958| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729949| train set 1.290x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740503| train set 1.241x speedup, test set 2.908x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750775| train set 1.231x speedup, test set 3.013x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766864| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.783773| train set 1.212x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796229| train set 1.249x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801736| train set 1.391x speedup, test set 2.380x speedup, val set 0.860x speedup, step: 14
Epoch 16/200 |loss: -0.807339| train set 1.345x speedup, test set 2.369x speedup, val set 0.860x speedup, step: 15
Epoch 17/200 |loss: -0.814100| train set 1.352x speedup, test set 2.388x speedup, val set 0.860x speedup, step: 16
Epoch 18/200 |loss: -0.820791| train set 1.352x speedup, test set 2.507x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826218| train set 1.331x speedup, test set 2.552x speedup, val set 0.836x speedup, step: 18
Epoch 20/200 |loss: -0.830660| train set 1.331x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834494| train set 1.341x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 20
Epoch 22/200 |loss: -0.838392| train set 1.308x speedup, test set 2.555x speedup, val set 0.802x speedup, step: 21
Epoch 23/200 |loss: -0.842111| train set 1.299x speedup, test set 2.767x speedup, val set 0.825x speedup, step: 22
Epoch 24/200 |loss: -0.845835| train set 1.298x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 23
Epoch 25/200 |loss: -0.848968| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 24
Epoch 26/200 |loss: -0.852119| train set 1.299x speedup, test set 2.611x speedup, val set 0.802x speedup, step: 25
Epoch 27/200 |loss: -0.855495| train set 1.313x speedup, test set 2.639x speedup, val set 0.802x speedup, step: 26
Epoch 28/200 |loss: -0.858333| train set 1.314x speedup, test set 2.613x speedup, val set 0.802x speedup, step: 27
Epoch 29/200 |loss: -0.860659| train set 1.322x speedup, test set 2.697x speedup, val set 0.802x speedup, step: 28
Epoch 30/200 |loss: -0.863100| train set 1.315x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865783| train set 1.316x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.868160| train set 1.315x speedup, test set 2.806x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.870203| train set 1.282x speedup, test set 2.806x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.871903| train set 1.282x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.873415| train set 1.282x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.875427| train set 1.283x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.877390| train set 1.283x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.879188| train set 1.280x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.880742| train set 1.280x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.881942| train set 1.266x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.882900| train set 1.274x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 40
Epoch 42/200 |loss: -0.882550| train set 1.271x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 41
Epoch 43/200 |loss: -0.879021| train set 1.323x speedup, test set 2.705x speedup, val set 0.896x speedup, step: 42
Epoch 44/200 |loss: -0.873028| train set 1.432x speedup, test set 2.705x speedup, val set 0.944x speedup, step: 43
Epoch 45/200 |loss: -0.871202| train set 1.417x speedup, test set 2.960x speedup, val set 0.981x speedup, step: 44
early stopping at epoch 45
Training per epoch cost 0.761 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 27.699s, pg runtime 31.019s, speedup 1.120x
08, opt runtime 7.377s, model runtime 31.774s, pg runtime 28.655s, speedup 0.902x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 3.258s, model runtime 18.141s, pg runtime 18.141s, speedup 1.000x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
18, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
19, opt runtime 1.347s, model runtime 1.654s, pg runtime 1.438s, speedup 0.869x
20, opt runtime 1.428s, model runtime 1.715s, pg runtime 1.428s, speedup 0.833x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 330.901s, pg runtime 626.529s, speedup 1.893x
32, opt runtime 24.662s, model runtime 317.659s, pg runtime 613.999s, speedup 1.933x
33, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 18.690s, model runtime 53.540s, pg runtime 651.942s, speedup 12.177x
36, opt runtime 16.280s, model runtime 50.583s, pg runtime 634.990s, speedup 12.553x
37, opt runtime 19.707s, model runtime 67.957s, pg runtime 19.707s, speedup 0.290x
38, opt runtime 18.262s, model runtime 68.157s, pg runtime 18.262s, speedup 0.268x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 1, train speedup 1.454, test speedup 1.861, val speedup 0.986
best test speedup epoch: 11, train speedup 1.231, test speedup 3.013, val speedup 0.836
best validation speedup epoch: 2, train speedup 0.956, test speedup 1.856, val speedup 0.986
last model at epoch 45, train speedup 1.417, test speedup 2.960, val speedup 0.981
execution cost 0:01:52.171607
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:01.193174, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678939| train set 0.955x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697560| train set 0.952x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714924| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729997| train set 1.290x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740475| train set 1.222x speedup, test set 2.875x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750915| train set 1.227x speedup, test set 2.977x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766954| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.784062| train set 1.250x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796007| train set 1.249x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801605| train set 1.391x speedup, test set 2.380x speedup, val set 0.860x speedup, step: 14
Epoch 16/200 |loss: -0.807333| train set 1.345x speedup, test set 2.369x speedup, val set 0.860x speedup, step: 15
Epoch 17/200 |loss: -0.814192| train set 1.345x speedup, test set 2.378x speedup, val set 0.836x speedup, step: 16
Epoch 18/200 |loss: -0.820811| train set 1.352x speedup, test set 2.552x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826079| train set 1.331x speedup, test set 2.552x speedup, val set 0.836x speedup, step: 18
Epoch 20/200 |loss: -0.830372| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834276| train set 1.331x speedup, test set 2.556x speedup, val set 0.806x speedup, step: 20
Epoch 22/200 |loss: -0.838292| train set 1.308x speedup, test set 2.555x speedup, val set 0.824x speedup, step: 21
Epoch 23/200 |loss: -0.842016| train set 1.299x speedup, test set 2.717x speedup, val set 0.824x speedup, step: 22
Epoch 24/200 |loss: -0.845760| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 23
Epoch 25/200 |loss: -0.848868| train set 1.299x speedup, test set 2.774x speedup, val set 0.824x speedup, step: 24
Epoch 26/200 |loss: -0.852287| train set 1.312x speedup, test set 2.613x speedup, val set 0.806x speedup, step: 25
Epoch 27/200 |loss: -0.855471| train set 1.314x speedup, test set 2.613x speedup, val set 0.806x speedup, step: 26
Epoch 28/200 |loss: -0.858192| train set 1.314x speedup, test set 2.613x speedup, val set 0.802x speedup, step: 27
Epoch 29/200 |loss: -0.860740| train set 1.353x speedup, test set 2.697x speedup, val set 0.802x speedup, step: 28
Epoch 30/200 |loss: -0.863047| train set 1.315x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865481| train set 1.316x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.867992| train set 1.315x speedup, test set 2.782x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.870042| train set 1.282x speedup, test set 2.770x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.872139| train set 1.282x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.874181| train set 1.283x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.875966| train set 1.284x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.877597| train set 1.284x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.879087| train set 1.267x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.879675| train set 1.280x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.878788| train set 1.267x speedup, test set 2.736x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.882687| train set 1.267x speedup, test set 2.737x speedup, val set 0.803x speedup, step: 40
Epoch 42/200 |loss: -0.884998| train set 1.261x speedup, test set 2.737x speedup, val set 0.883x speedup, step: 41
Epoch 43/200 |loss: -0.885530| train set 1.274x speedup, test set 2.628x speedup, val set 0.803x speedup, step: 42
Epoch 44/200 |loss: -0.874281| train set 1.336x speedup, test set 2.737x speedup, val set 0.941x speedup, step: 43
Epoch 45/200 |loss: -0.874665| train set 1.432x speedup, test set 2.735x speedup, val set 0.978x speedup, step: 44
early stopping at epoch 45
Training per epoch cost 0.634 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 34.775s, pg runtime 37.830s, speedup 1.088x
02, opt runtime 31.109s, model runtime 36.875s, pg runtime 31.109s, speedup 0.844x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 27.699s, pg runtime 31.019s, speedup 1.120x
08, opt runtime 7.377s, model runtime 31.774s, pg runtime 28.655s, speedup 0.902x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 21.298s, pg runtime 21.298s, speedup 1.000x
14, opt runtime 3.258s, model runtime 18.141s, pg runtime 18.141s, speedup 1.000x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 26.197s, pg runtime 32.939s, speedup 1.257x
18, opt runtime 6.149s, model runtime 36.915s, pg runtime 30.760s, speedup 0.833x
19, opt runtime 1.347s, model runtime 1.654s, pg runtime 1.438s, speedup 0.869x
20, opt runtime 1.428s, model runtime 1.715s, pg runtime 1.428s, speedup 0.833x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 1.752s, pg runtime 1.752s, speedup 1.000x
26, opt runtime 1.423s, model runtime 1.423s, pg runtime 1.423s, speedup 1.000x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 330.901s, pg runtime 626.529s, speedup 1.893x
32, opt runtime 24.662s, model runtime 317.659s, pg runtime 613.999s, speedup 1.933x
33, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
34, opt runtime 39.191s, model runtime 42.882s, pg runtime 75.984s, speedup 1.772x
35, opt runtime 18.690s, model runtime 53.540s, pg runtime 651.942s, speedup 12.177x
36, opt runtime 16.280s, model runtime 50.583s, pg runtime 634.990s, speedup 12.553x
37, opt runtime 19.707s, model runtime 67.957s, pg runtime 19.707s, speedup 0.290x
38, opt runtime 18.262s, model runtime 68.157s, pg runtime 18.262s, speedup 0.268x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 1, train speedup 1.454, test speedup 1.861, val speedup 0.986
best test speedup epoch: 11, train speedup 1.227, test speedup 2.977, val speedup 0.836
best validation speedup epoch: 2, train speedup 0.956, test speedup 1.856, val speedup 0.986
last model at epoch 45, train speedup 1.432, test speedup 2.735, val speedup 0.978
execution cost 0:01:33.897515
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:01.940429, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678939| train set 0.995x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697585| train set 0.951x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714948| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729950| train set 1.290x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740508| train set 1.241x speedup, test set 2.875x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750740| train set 1.231x speedup, test set 3.013x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766693| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.783527| train set 1.212x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796026| train set 1.278x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801567| train set 1.370x speedup, test set 2.380x speedup, val set 0.860x speedup, step: 14
Epoch 16/200 |loss: -0.807115| train set 1.325x speedup, test set 2.369x speedup, val set 0.860x speedup, step: 15
Epoch 17/200 |loss: -0.813853| train set 1.332x speedup, test set 2.366x speedup, val set 0.860x speedup, step: 16
Epoch 18/200 |loss: -0.820584| train set 1.326x speedup, test set 2.507x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826004| train set 1.331x speedup, test set 2.552x speedup, val set 0.836x speedup, step: 18
Epoch 20/200 |loss: -0.830367| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834150| train set 1.331x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 20
Epoch 22/200 |loss: -0.838066| train set 1.308x speedup, test set 2.555x speedup, val set 0.802x speedup, step: 21
Epoch 23/200 |loss: -0.841811| train set 1.308x speedup, test set 2.695x speedup, val set 0.824x speedup, step: 22
Epoch 24/200 |loss: -0.845506| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 23
Epoch 25/200 |loss: -0.848774| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 24
Epoch 26/200 |loss: -0.851940| train set 1.303x speedup, test set 2.581x speedup, val set 0.802x speedup, step: 25
Epoch 27/200 |loss: -0.855227| train set 1.314x speedup, test set 2.639x speedup, val set 0.802x speedup, step: 26
Epoch 28/200 |loss: -0.858088| train set 1.316x speedup, test set 2.613x speedup, val set 0.802x speedup, step: 27
Epoch 29/200 |loss: -0.860563| train set 1.329x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 28
Epoch 30/200 |loss: -0.862778| train set 1.309x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865223| train set 1.309x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.867854| train set 1.309x speedup, test set 2.748x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.870013| train set 1.276x speedup, test set 2.806x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.872003| train set 1.282x speedup, test set 2.806x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.873914| train set 1.282x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.875535| train set 1.282x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.876947| train set 1.282x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.878319| train set 1.284x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.879922| train set 1.280x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.881608| train set 1.280x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.883438| train set 1.174x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 40
Epoch 42/200 |loss: -0.885059| train set 1.167x speedup, test set 2.736x speedup, val set 0.803x speedup, step: 41
Epoch 43/200 |loss: -0.886128| train set 1.268x speedup, test set 2.737x speedup, val set 0.803x speedup, step: 42
Epoch 44/200 |loss: -0.877118| train set 1.349x speedup, test set 2.736x speedup, val set 0.981x speedup, step: 43
Epoch 45/200 |loss: -0.870410| train set 1.396x speedup, test set 2.705x speedup, val set 0.989x speedup, step: 1
Epoch 46/200 |loss: -0.867326| train set 1.417x speedup, test set 2.888x speedup, val set 0.988x speedup, step: 2
early stopping at epoch 46
Training per epoch cost 0.755 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
08, opt runtime 7.377s, model runtime 34.537s, pg runtime 28.655s, speedup 0.830x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
12, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 125.113s, pg runtime 148.707s, speedup 1.189x
16, opt runtime 53.440s, model runtime 119.421s, pg runtime 140.742s, speedup 1.179x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.956s, pg runtime 1.438s, speedup 0.735x
20, opt runtime 1.428s, model runtime 1.754s, pg runtime 1.428s, speedup 0.814x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 3.569s, pg runtime 1.752s, speedup 0.491x
26, opt runtime 1.423s, model runtime 3.427s, pg runtime 1.423s, speedup 0.415x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 18.690s, model runtime 53.540s, pg runtime 651.942s, speedup 12.177x
36, opt runtime 16.280s, model runtime 50.583s, pg runtime 634.990s, speedup 12.553x
37, opt runtime 19.707s, model runtime 86.228s, pg runtime 19.707s, speedup 0.229x
38, opt runtime 18.262s, model runtime 84.226s, pg runtime 18.262s, speedup 0.217x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 1, train speedup 1.454, test speedup 1.861, val speedup 0.986
best test speedup epoch: 11, train speedup 1.231, test speedup 3.013, val speedup 0.836
best validation speedup epoch: 45, train speedup 1.396, test speedup 2.705, val speedup 0.989
last model at epoch 46, train speedup 1.417, test speedup 2.888, val speedup 0.988
execution cost 0:01:52.932414
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:01.998232, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678939| train set 0.995x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697585| train set 0.951x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714948| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729950| train set 1.290x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740508| train set 1.241x speedup, test set 2.875x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750740| train set 1.231x speedup, test set 3.013x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766693| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.783527| train set 1.212x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796027| train set 1.278x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801568| train set 1.370x speedup, test set 2.380x speedup, val set 0.860x speedup, step: 14
Epoch 16/200 |loss: -0.807113| train set 1.325x speedup, test set 2.369x speedup, val set 0.860x speedup, step: 15
Epoch 17/200 |loss: -0.813846| train set 1.332x speedup, test set 2.366x speedup, val set 0.860x speedup, step: 16
Epoch 18/200 |loss: -0.820576| train set 1.326x speedup, test set 2.507x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826014| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 18
Epoch 20/200 |loss: -0.830385| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834160| train set 1.331x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 20
Epoch 22/200 |loss: -0.838060| train set 1.308x speedup, test set 2.555x speedup, val set 0.802x speedup, step: 21
Epoch 23/200 |loss: -0.841803| train set 1.308x speedup, test set 2.695x speedup, val set 0.824x speedup, step: 22
Epoch 24/200 |loss: -0.845492| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 23
Epoch 25/200 |loss: -0.848786| train set 1.299x speedup, test set 2.771x speedup, val set 0.824x speedup, step: 24
Epoch 26/200 |loss: -0.851909| train set 1.308x speedup, test set 2.588x speedup, val set 0.824x speedup, step: 25
Epoch 27/200 |loss: -0.855194| train set 1.313x speedup, test set 2.639x speedup, val set 0.802x speedup, step: 26
Epoch 28/200 |loss: -0.858089| train set 1.314x speedup, test set 2.613x speedup, val set 0.802x speedup, step: 27
Epoch 29/200 |loss: -0.860522| train set 1.328x speedup, test set 2.697x speedup, val set 0.802x speedup, step: 28
Epoch 30/200 |loss: -0.862785| train set 1.309x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865246| train set 1.309x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.867810| train set 1.309x speedup, test set 2.748x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.869894| train set 1.289x speedup, test set 2.782x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.871906| train set 1.282x speedup, test set 2.806x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.873912| train set 1.282x speedup, test set 2.801x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.875736| train set 1.283x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.877181| train set 1.178x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.878269| train set 1.178x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.878962| train set 1.279x speedup, test set 2.736x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.879441| train set 1.175x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.883212| train set 1.174x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 40
Epoch 42/200 |loss: -0.881433| train set 1.172x speedup, test set 2.736x speedup, val set 0.883x speedup, step: 41
Epoch 43/200 |loss: -0.876556| train set 1.202x speedup, test set 2.735x speedup, val set 0.896x speedup, step: 42
Epoch 44/200 |loss: -0.876715| train set 1.193x speedup, test set 2.998x speedup, val set 0.883x speedup, step: 43
Epoch 45/200 |loss: -0.884757| train set 1.277x speedup, test set 3.016x speedup, val set 0.883x speedup, step: 44
Epoch 46/200 |loss: -0.876160| train set 1.323x speedup, test set 2.998x speedup, val set 0.943x speedup, step: 45
Epoch 47/200 |loss: -0.887136| train set 1.417x speedup, test set 2.961x speedup, val set 0.980x speedup, step: 46
Epoch 48/200 |loss: -0.883701| train set 1.417x speedup, test set 2.960x speedup, val set 0.980x speedup, step: 47
Epoch 49/200 |loss: -0.886332| train set 1.386x speedup, test set 2.902x speedup, val set 0.980x speedup, step: 48
Epoch 50/200 |loss: -0.887866| train set 1.263x speedup, test set 2.902x speedup, val set 0.980x speedup, step: 49
Epoch 51/200 |loss: -0.887981| train set 1.370x speedup, test set 2.856x speedup, val set 0.980x speedup, step: 50
Epoch 52/200 |loss: -0.891498| train set 1.401x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 51
Epoch 53/200 |loss: -0.890576| train set 1.401x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 52
Epoch 54/200 |loss: -0.891570| train set 1.401x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 53
Epoch 55/200 |loss: -0.893085| train set 1.401x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 54
Epoch 56/200 |loss: -0.893619| train set 1.432x speedup, test set 2.998x speedup, val set 0.980x speedup, step: 55
Epoch 57/200 |loss: -0.895311| train set 1.433x speedup, test set 2.716x speedup, val set 0.980x speedup, step: 56
Epoch 58/200 |loss: -0.894609| train set 1.431x speedup, test set 2.716x speedup, val set 0.980x speedup, step: 57
Epoch 59/200 |loss: -0.896575| train set 1.431x speedup, test set 2.923x speedup, val set 0.980x speedup, step: 58
Epoch 60/200 |loss: -0.896816| train set 1.431x speedup, test set 2.923x speedup, val set 0.980x speedup, step: 59
Epoch 61/200 |loss: -0.898972| train set 1.432x speedup, test set 2.923x speedup, val set 0.980x speedup, step: 60
Epoch 62/200 |loss: -0.899085| train set 1.431x speedup, test set 3.086x speedup, val set 0.980x speedup, step: 61
Epoch 63/200 |loss: -0.899524| train set 1.431x speedup, test set 3.086x speedup, val set 0.980x speedup, step: 62
Epoch 64/200 |loss: -0.900257| train set 1.410x speedup, test set 2.923x speedup, val set 0.980x speedup, step: 63
Epoch 65/200 |loss: -0.900914| train set 1.437x speedup, test set 2.655x speedup, val set 0.980x speedup, step: 64
Epoch 66/200 |loss: -0.901838| train set 1.447x speedup, test set 2.720x speedup, val set 0.980x speedup, step: 65
Epoch 67/200 |loss: -0.902244| train set 1.452x speedup, test set 2.720x speedup, val set 0.980x speedup, step: 66
Epoch 68/200 |loss: -0.902744| train set 1.453x speedup, test set 2.720x speedup, val set 0.988x speedup, step: 1
Epoch 69/200 |loss: -0.903416| train set 1.453x speedup, test set 2.720x speedup, val set 0.988x speedup, step: 1
Epoch 70/200 |loss: -0.904271| train set 1.453x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 71/200 |loss: -0.904331| train set 1.453x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 72/200 |loss: -0.904968| train set 1.453x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 73/200 |loss: -0.905683| train set 1.319x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 74/200 |loss: -0.906008| train set 1.322x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 75/200 |loss: -0.906736| train set 1.322x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 76/200 |loss: -0.907085| train set 1.317x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 77/200 |loss: -0.907453| train set 1.317x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 78/200 |loss: -0.907995| train set 1.317x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 79/200 |loss: -0.908236| train set 1.315x speedup, test set 3.001x speedup, val set 0.980x speedup, step: 2
Epoch 80/200 |loss: -0.908653| train set 1.315x speedup, test set 3.001x speedup, val set 0.988x speedup, step: 1
Epoch 81/200 |loss: -0.908987| train set 1.334x speedup, test set 3.001x speedup, val set 0.980x speedup, step: 2
Epoch 82/200 |loss: -0.909426| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 83/200 |loss: -0.909793| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 84/200 |loss: -0.910086| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 85/200 |loss: -0.910672| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 86/200 |loss: -0.911312| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 87/200 |loss: -0.911814| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 88/200 |loss: -0.911252| train set 1.481x speedup, test set 2.859x speedup, val set 0.988x speedup, step: 1
Epoch 89/200 |loss: -0.904793| train set 1.474x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 90/200 |loss: -0.911710| train set 1.473x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 91/200 |loss: -0.912626| train set 1.474x speedup, test set 2.859x speedup, val set 0.988x speedup, step: 1
Epoch 92/200 |loss: -0.910669| train set 1.473x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 93/200 |loss: -0.912727| train set 1.473x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 94/200 |loss: -0.913236| train set 1.473x speedup, test set 3.143x speedup, val set 0.988x speedup, step: 1
Epoch 95/200 |loss: -0.912652| train set 1.473x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 96/200 |loss: -0.914093| train set 1.473x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 97/200 |loss: -0.912273| train set 1.461x speedup, test set 2.835x speedup, val set 0.988x speedup, step: 1
Epoch 98/200 |loss: -0.908843| train set 1.461x speedup, test set 3.143x speedup, val set 0.988x speedup, step: 1
Epoch 99/200 |loss: -0.914055| train set 1.429x speedup, test set 3.172x speedup, val set 0.988x speedup, step: 1
Epoch 100/200 |loss: -0.907563| train set 1.461x speedup, test set 2.841x speedup, val set 0.988x speedup, step: 1
Epoch 101/200 |loss: -0.910008| train set 1.468x speedup, test set 2.808x speedup, val set 0.988x speedup, step: 1
early stopping at epoch 101
Training per epoch cost 0.723 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 124.239s, pg runtime 112.305s, speedup 0.904x
04, opt runtime 30.267s, model runtime 99.382s, pg runtime 100.885s, speedup 1.015x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
08, opt runtime 7.377s, model runtime 34.537s, pg runtime 28.655s, speedup 0.830x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 80.621s, pg runtime 87.340s, speedup 1.083x
12, opt runtime 26.602s, model runtime 83.380s, pg runtime 85.447s, speedup 1.025x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.956s, pg runtime 1.438s, speedup 0.735x
20, opt runtime 1.428s, model runtime 1.754s, pg runtime 1.428s, speedup 0.814x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.167s, pg runtime 1.752s, speedup 0.808x
26, opt runtime 1.423s, model runtime 1.981s, pg runtime 1.423s, speedup 0.718x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 18.690s, model runtime 18.690s, pg runtime 651.942s, speedup 34.881x
36, opt runtime 16.280s, model runtime 16.280s, pg runtime 634.990s, speedup 39.005x
37, opt runtime 19.707s, model runtime 67.957s, pg runtime 19.707s, speedup 0.290x
38, opt runtime 18.262s, model runtime 68.157s, pg runtime 18.262s, speedup 0.268x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 88, train speedup 1.481, test speedup 2.859, val speedup 0.988
best test speedup epoch: 70, train speedup 1.453, test speedup 3.172, val speedup 0.988
best validation speedup epoch: 101, train speedup 1.468, test speedup 2.808, val speedup 0.988
last model at epoch 101, train speedup 1.468, test speedup 2.808, val speedup 0.988
execution cost 0:03:43.596626
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:01.996499, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678939| train set 0.995x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697585| train set 0.951x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714947| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729939| train set 1.290x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740496| train set 1.241x speedup, test set 2.908x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750724| train set 1.231x speedup, test set 3.013x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766795| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.783684| train set 1.212x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796082| train set 1.249x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801605| train set 1.370x speedup, test set 2.380x speedup, val set 0.860x speedup, step: 14
Epoch 16/200 |loss: -0.807217| train set 1.325x speedup, test set 2.369x speedup, val set 0.860x speedup, step: 15
Epoch 17/200 |loss: -0.813988| train set 1.332x speedup, test set 2.366x speedup, val set 0.860x speedup, step: 16
Epoch 18/200 |loss: -0.820657| train set 1.326x speedup, test set 2.507x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826057| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 18
Epoch 20/200 |loss: -0.830465| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834279| train set 1.331x speedup, test set 2.579x speedup, val set 0.806x speedup, step: 20
Epoch 22/200 |loss: -0.838191| train set 1.308x speedup, test set 2.555x speedup, val set 0.802x speedup, step: 21
Epoch 23/200 |loss: -0.841855| train set 1.299x speedup, test set 2.745x speedup, val set 0.824x speedup, step: 22
Epoch 24/200 |loss: -0.845550| train set 1.298x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 23
Epoch 25/200 |loss: -0.848754| train set 1.299x speedup, test set 2.767x speedup, val set 0.824x speedup, step: 24
Epoch 26/200 |loss: -0.851991| train set 1.310x speedup, test set 2.581x speedup, val set 0.802x speedup, step: 25
Epoch 27/200 |loss: -0.855382| train set 1.318x speedup, test set 2.639x speedup, val set 0.802x speedup, step: 26
Epoch 28/200 |loss: -0.858279| train set 1.320x speedup, test set 2.613x speedup, val set 0.802x speedup, step: 27
Epoch 29/200 |loss: -0.860688| train set 1.308x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 28
Epoch 30/200 |loss: -0.862875| train set 1.309x speedup, test set 2.726x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865209| train set 1.309x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.867816| train set 1.309x speedup, test set 2.782x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.870042| train set 1.311x speedup, test set 2.806x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.871974| train set 1.289x speedup, test set 2.662x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.873933| train set 1.282x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.875641| train set 1.283x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.876457| train set 1.284x speedup, test set 2.706x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.876422| train set 1.280x speedup, test set 2.773x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.880359| train set 1.280x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.880594| train set 1.279x speedup, test set 2.737x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.879501| train set 1.279x speedup, test set 2.737x speedup, val set 0.803x speedup, step: 40
Epoch 42/200 |loss: -0.883481| train set 1.272x speedup, test set 2.632x speedup, val set 0.883x speedup, step: 41
Epoch 43/200 |loss: -0.871257| train set 1.309x speedup, test set 2.737x speedup, val set 0.883x speedup, step: 42
Epoch 44/200 |loss: -0.878847| train set 1.417x speedup, test set 2.735x speedup, val set 0.981x speedup, step: 43
Epoch 45/200 |loss: -0.872086| train set 1.397x speedup, test set 2.998x speedup, val set 0.989x speedup, step: 1
Epoch 46/200 |loss: -0.875463| train set 1.395x speedup, test set 2.924x speedup, val set 0.988x speedup, step: 2
early stopping at epoch 46
Training per epoch cost 0.740 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 47.174s, pg runtime 112.305s, speedup 2.381x
04, opt runtime 30.267s, model runtime 43.737s, pg runtime 100.885s, speedup 2.307x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
08, opt runtime 7.377s, model runtime 34.537s, pg runtime 28.655s, speedup 0.830x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
12, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 125.113s, pg runtime 148.707s, speedup 1.189x
16, opt runtime 53.440s, model runtime 119.421s, pg runtime 140.742s, speedup 1.179x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.438s, pg runtime 1.438s, speedup 1.000x
20, opt runtime 1.428s, model runtime 1.428s, pg runtime 1.428s, speedup 1.000x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 3.569s, pg runtime 1.752s, speedup 0.491x
26, opt runtime 1.423s, model runtime 3.427s, pg runtime 1.423s, speedup 0.415x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 18.690s, model runtime 53.540s, pg runtime 651.942s, speedup 12.177x
36, opt runtime 16.280s, model runtime 50.583s, pg runtime 634.990s, speedup 12.553x
37, opt runtime 19.707s, model runtime 86.228s, pg runtime 19.707s, speedup 0.229x
38, opt runtime 18.262s, model runtime 84.226s, pg runtime 18.262s, speedup 0.217x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 1, train speedup 1.454, test speedup 1.861, val speedup 0.986
best test speedup epoch: 11, train speedup 1.231, test speedup 3.013, val speedup 0.836
best validation speedup epoch: 45, train speedup 1.397, test speedup 2.998, val speedup 0.989
last model at epoch 46, train speedup 1.395, test speedup 2.924, val speedup 0.988
execution cost 0:01:51.889757
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
3.274369245575696
-1.9322068691813312
construct training samples cost 0:00:01.635557, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: -0.507874| train set 1.284x speedup, test set 1.904x speedup, val set 0.857x speedup, step: 1
Epoch 1/200 |loss: -0.527031| train set 1.454x speedup, test set 1.861x speedup, val set 0.986x speedup, step: 1
Epoch 2/200 |loss: -0.562303| train set 0.956x speedup, test set 1.856x speedup, val set 0.986x speedup, step: 1
Epoch 3/200 |loss: -0.595069| train set 0.998x speedup, test set 2.567x speedup, val set 0.906x speedup, step: 2
Epoch 4/200 |loss: -0.626628| train set 0.998x speedup, test set 2.548x speedup, val set 0.902x speedup, step: 3
Epoch 5/200 |loss: -0.657451| train set 0.984x speedup, test set 2.567x speedup, val set 0.874x speedup, step: 4
Epoch 6/200 |loss: -0.678937| train set 0.995x speedup, test set 2.543x speedup, val set 0.874x speedup, step: 5
Epoch 7/200 |loss: -0.697575| train set 0.951x speedup, test set 2.680x speedup, val set 0.874x speedup, step: 6
Epoch 8/200 |loss: -0.714941| train set 1.335x speedup, test set 2.680x speedup, val set 0.782x speedup, step: 7
Epoch 9/200 |loss: -0.729932| train set 1.289x speedup, test set 2.875x speedup, val set 0.780x speedup, step: 8
Epoch 10/200 |loss: -0.740444| train set 1.241x speedup, test set 2.891x speedup, val set 0.774x speedup, step: 9
Epoch 11/200 |loss: -0.750856| train set 1.231x speedup, test set 3.013x speedup, val set 0.836x speedup, step: 10
Epoch 12/200 |loss: -0.766912| train set 1.146x speedup, test set 2.673x speedup, val set 0.836x speedup, step: 11
Epoch 13/200 |loss: -0.784277| train set 1.212x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 12
Epoch 14/200 |loss: -0.796221| train set 1.249x speedup, test set 1.404x speedup, val set 0.836x speedup, step: 13
Epoch 15/200 |loss: -0.801840| train set 1.391x speedup, test set 2.380x speedup, val set 0.836x speedup, step: 14
Epoch 16/200 |loss: -0.807352| train set 1.345x speedup, test set 2.369x speedup, val set 0.836x speedup, step: 15
Epoch 17/200 |loss: -0.814053| train set 1.352x speedup, test set 2.378x speedup, val set 0.836x speedup, step: 16
Epoch 18/200 |loss: -0.820635| train set 1.352x speedup, test set 2.507x speedup, val set 0.836x speedup, step: 17
Epoch 19/200 |loss: -0.826061| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 18
Epoch 20/200 |loss: -0.830408| train set 1.331x speedup, test set 2.552x speedup, val set 0.806x speedup, step: 19
Epoch 21/200 |loss: -0.834274| train set 1.328x speedup, test set 2.535x speedup, val set 0.802x speedup, step: 20
Epoch 22/200 |loss: -0.838142| train set 1.309x speedup, test set 2.555x speedup, val set 0.803x speedup, step: 21
Epoch 23/200 |loss: -0.841850| train set 1.300x speedup, test set 2.767x speedup, val set 0.825x speedup, step: 22
Epoch 24/200 |loss: -0.845571| train set 1.300x speedup, test set 2.767x speedup, val set 0.825x speedup, step: 23
Epoch 25/200 |loss: -0.848956| train set 1.300x speedup, test set 2.767x speedup, val set 0.825x speedup, step: 24
Epoch 26/200 |loss: -0.852160| train set 1.303x speedup, test set 2.581x speedup, val set 0.802x speedup, step: 25
Epoch 27/200 |loss: -0.855500| train set 1.303x speedup, test set 2.581x speedup, val set 0.802x speedup, step: 26
Epoch 28/200 |loss: -0.858443| train set 1.309x speedup, test set 2.696x speedup, val set 0.803x speedup, step: 27
Epoch 29/200 |loss: -0.860895| train set 1.309x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 28
Epoch 30/200 |loss: -0.863407| train set 1.310x speedup, test set 2.726x speedup, val set 0.803x speedup, step: 29
Epoch 31/200 |loss: -0.865939| train set 1.310x speedup, test set 2.697x speedup, val set 0.803x speedup, step: 30
Epoch 32/200 |loss: -0.867982| train set 1.309x speedup, test set 2.782x speedup, val set 0.803x speedup, step: 31
Epoch 33/200 |loss: -0.869574| train set 1.324x speedup, test set 2.741x speedup, val set 0.803x speedup, step: 32
Epoch 34/200 |loss: -0.871585| train set 1.289x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 33
Epoch 35/200 |loss: -0.873787| train set 1.283x speedup, test set 2.805x speedup, val set 0.803x speedup, step: 34
Epoch 36/200 |loss: -0.876192| train set 1.284x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 35
Epoch 37/200 |loss: -0.877436| train set 1.284x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 36
Epoch 38/200 |loss: -0.878116| train set 1.280x speedup, test set 2.772x speedup, val set 0.803x speedup, step: 37
Epoch 39/200 |loss: -0.880333| train set 1.267x speedup, test set 2.705x speedup, val set 0.803x speedup, step: 38
Epoch 40/200 |loss: -0.882185| train set 1.267x speedup, test set 2.736x speedup, val set 0.803x speedup, step: 39
Epoch 41/200 |loss: -0.883703| train set 1.267x speedup, test set 2.627x speedup, val set 0.803x speedup, step: 40
Epoch 42/200 |loss: -0.883810| train set 1.192x speedup, test set 2.736x speedup, val set 0.883x speedup, step: 41
Epoch 43/200 |loss: -0.878486| train set 1.195x speedup, test set 2.737x speedup, val set 0.883x speedup, step: 42
Epoch 44/200 |loss: -0.883652| train set 1.169x speedup, test set 2.801x speedup, val set 0.803x speedup, step: 43
Epoch 45/200 |loss: -0.876355| train set 1.207x speedup, test set 2.737x speedup, val set 0.941x speedup, step: 44
Epoch 46/200 |loss: -0.885396| train set 1.285x speedup, test set 2.737x speedup, val set 0.948x speedup, step: 45
Epoch 47/200 |loss: -0.881485| train set 1.302x speedup, test set 2.924x speedup, val set 0.948x speedup, step: 46
Epoch 48/200 |loss: -0.883075| train set 1.290x speedup, test set 2.914x speedup, val set 0.986x speedup, step: 1
Epoch 49/200 |loss: -0.885792| train set 1.309x speedup, test set 2.914x speedup, val set 0.986x speedup, step: 1
Epoch 50/200 |loss: -0.886065| train set 1.328x speedup, test set 2.914x speedup, val set 0.985x speedup, step: 2
Epoch 51/200 |loss: -0.887080| train set 1.290x speedup, test set 2.949x speedup, val set 0.940x speedup, step: 3
Epoch 52/200 |loss: -0.891938| train set 1.252x speedup, test set 2.868x speedup, val set 0.940x speedup, step: 4
Epoch 53/200 |loss: -0.893506| train set 1.328x speedup, test set 2.868x speedup, val set 0.940x speedup, step: 5
Epoch 54/200 |loss: -0.895528| train set 1.307x speedup, test set 2.868x speedup, val set 0.895x speedup, step: 6
Epoch 55/200 |loss: -0.895252| train set 1.313x speedup, test set 2.998x speedup, val set 0.895x speedup, step: 7
Epoch 56/200 |loss: -0.897632| train set 1.327x speedup, test set 2.717x speedup, val set 0.896x speedup, step: 8
Epoch 57/200 |loss: -0.898365| train set 1.321x speedup, test set 2.717x speedup, val set 0.896x speedup, step: 9
Epoch 58/200 |loss: -0.899259| train set 1.314x speedup, test set 2.717x speedup, val set 0.896x speedup, step: 10
Epoch 59/200 |loss: -0.901145| train set 1.305x speedup, test set 2.717x speedup, val set 0.941x speedup, step: 11
Epoch 60/200 |loss: -0.901714| train set 1.305x speedup, test set 2.717x speedup, val set 0.895x speedup, step: 12
Epoch 61/200 |loss: -0.902992| train set 1.305x speedup, test set 2.998x speedup, val set 0.895x speedup, step: 13
Epoch 62/200 |loss: -0.903487| train set 1.332x speedup, test set 2.997x speedup, val set 0.940x speedup, step: 14
Epoch 63/200 |loss: -0.904317| train set 1.377x speedup, test set 2.997x speedup, val set 0.940x speedup, step: 15
Epoch 64/200 |loss: -0.904963| train set 1.377x speedup, test set 2.997x speedup, val set 0.940x speedup, step: 16
Epoch 65/200 |loss: -0.905543| train set 1.407x speedup, test set 2.997x speedup, val set 0.940x speedup, step: 17
Epoch 66/200 |loss: -0.906143| train set 1.413x speedup, test set 2.997x speedup, val set 0.940x speedup, step: 18
Epoch 67/200 |loss: -0.906577| train set 1.413x speedup, test set 2.997x speedup, val set 0.940x speedup, step: 19
Epoch 68/200 |loss: -0.907442| train set 1.418x speedup, test set 2.923x speedup, val set 0.940x speedup, step: 20
Epoch 69/200 |loss: -0.907741| train set 1.443x speedup, test set 2.923x speedup, val set 0.948x speedup, step: 21
Epoch 70/200 |loss: -0.908250| train set 1.459x speedup, test set 2.923x speedup, val set 0.948x speedup, step: 22
Epoch 71/200 |loss: -0.908893| train set 1.459x speedup, test set 2.923x speedup, val set 0.985x speedup, step: 23
Epoch 72/200 |loss: -0.909101| train set 1.484x speedup, test set 2.923x speedup, val set 0.985x speedup, step: 24
Epoch 73/200 |loss: -0.909599| train set 1.484x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 74/200 |loss: -0.910111| train set 1.462x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 75/200 |loss: -0.910292| train set 1.462x speedup, test set 2.923x speedup, val set 0.988x speedup, step: 1
Epoch 76/200 |loss: -0.910770| train set 1.461x speedup, test set 3.002x speedup, val set 0.988x speedup, step: 1
Epoch 77/200 |loss: -0.911102| train set 1.431x speedup, test set 3.002x speedup, val set 0.950x speedup, step: 2
Epoch 78/200 |loss: -0.911494| train set 1.431x speedup, test set 3.002x speedup, val set 0.950x speedup, step: 3
Epoch 79/200 |loss: -0.911950| train set 1.301x speedup, test set 3.018x speedup, val set 0.950x speedup, step: 4
Epoch 80/200 |loss: -0.912231| train set 1.301x speedup, test set 3.018x speedup, val set 0.950x speedup, step: 5
Epoch 81/200 |loss: -0.912670| train set 1.301x speedup, test set 3.018x speedup, val set 0.950x speedup, step: 6
Epoch 82/200 |loss: -0.912859| train set 1.301x speedup, test set 3.018x speedup, val set 0.950x speedup, step: 7
Epoch 83/200 |loss: -0.912473| train set 1.301x speedup, test set 3.018x speedup, val set 0.950x speedup, step: 8
Epoch 84/200 |loss: -0.913581| train set 1.301x speedup, test set 3.018x speedup, val set 0.950x speedup, step: 9
Epoch 85/200 |loss: -0.914016| train set 1.301x speedup, test set 3.018x speedup, val set 0.950x speedup, step: 10
Epoch 86/200 |loss: -0.914579| train set 1.301x speedup, test set 3.018x speedup, val set 0.950x speedup, step: 11
Epoch 87/200 |loss: -0.914964| train set 1.301x speedup, test set 3.002x speedup, val set 0.950x speedup, step: 12
Epoch 88/200 |loss: -0.914836| train set 1.301x speedup, test set 3.002x speedup, val set 0.950x speedup, step: 13
Epoch 89/200 |loss: -0.912490| train set 1.320x speedup, test set 3.008x speedup, val set 0.948x speedup, step: 14
Epoch 90/200 |loss: -0.899916| train set 1.339x speedup, test set 3.008x speedup, val set 0.948x speedup, step: 15
early stopping at epoch 90
Training per epoch cost 0.708 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 47.174s, pg runtime 112.305s, speedup 2.381x
04, opt runtime 30.267s, model runtime 43.737s, pg runtime 100.885s, speedup 2.307x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 34.601s, pg runtime 31.019s, speedup 0.896x
08, opt runtime 7.377s, model runtime 34.537s, pg runtime 28.655s, speedup 0.830x
09, opt runtime 5.543s, model runtime 5.543s, pg runtime 5.543s, speedup 1.000x
10, opt runtime 5.237s, model runtime 5.237s, pg runtime 5.237s, speedup 1.000x
11, opt runtime 23.205s, model runtime 75.744s, pg runtime 87.340s, speedup 1.153x
12, opt runtime 26.602s, model runtime 77.014s, pg runtime 85.447s, speedup 1.110x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 10.788s, pg runtime 32.939s, speedup 3.053x
18, opt runtime 6.149s, model runtime 6.149s, pg runtime 30.760s, speedup 5.003x
19, opt runtime 1.347s, model runtime 1.654s, pg runtime 1.438s, speedup 0.869x
20, opt runtime 1.428s, model runtime 1.715s, pg runtime 1.428s, speedup 0.833x
21, opt runtime 25.034s, model runtime 31.372s, pg runtime 25.034s, speedup 0.798x
22, opt runtime 20.897s, model runtime 31.157s, pg runtime 23.708s, speedup 0.761x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 3.569s, pg runtime 1.752s, speedup 0.491x
26, opt runtime 1.423s, model runtime 3.427s, pg runtime 1.423s, speedup 0.415x
27, opt runtime 6.789s, model runtime 11.469s, pg runtime 7.799s, speedup 0.680x
28, opt runtime 7.199s, model runtime 10.447s, pg runtime 7.619s, speedup 0.729x
29, opt runtime 5.572s, model runtime 5.572s, pg runtime 5.572s, speedup 1.000x
30, opt runtime 5.539s, model runtime 5.539s, pg runtime 5.539s, speedup 1.000x
31, opt runtime 24.840s, model runtime 24.840s, pg runtime 626.529s, speedup 25.222x
32, opt runtime 24.662s, model runtime 24.662s, pg runtime 613.999s, speedup 24.896x
33, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
34, opt runtime 39.191s, model runtime 43.993s, pg runtime 75.984s, speedup 1.727x
35, opt runtime 18.690s, model runtime 53.540s, pg runtime 651.942s, speedup 12.177x
36, opt runtime 16.280s, model runtime 50.583s, pg runtime 634.990s, speedup 12.553x
37, opt runtime 19.707s, model runtime 67.957s, pg runtime 19.707s, speedup 0.290x
38, opt runtime 18.262s, model runtime 68.157s, pg runtime 18.262s, speedup 0.268x
39, opt runtime 1.088s, model runtime 3.446s, pg runtime 1.206s, speedup 0.350x
40, opt runtime 1.086s, model runtime 3.197s, pg runtime 1.181s, speedup 0.369x
====================
best train speedup epoch: 73, train speedup 1.484, test speedup 2.923, val speedup 0.988
best test speedup epoch: 79, train speedup 1.301, test speedup 3.018, val speedup 0.950
best validation speedup epoch: 76, train speedup 1.461, test speedup 3.002, val speedup 0.988
last model at epoch 90, train speedup 1.339, test speedup 3.008, val speedup 0.948
execution cost 0:03:20.465572
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.069070, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779139| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507730| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141750| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.848000| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568960| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255943| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958139| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657236| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.384846| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.093889| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.805075| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.510176| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.224970| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 16
Epoch 16/200 |loss: 25.985796| train set 1.054x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.823137| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 18
Epoch 18/200 |loss: 25.807606| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 19
Epoch 19/200 |loss: 25.536896| train set 1.055x speedup, test set 2.526x speedup, val set 0.973x speedup, step: 20
Epoch 20/200 |loss: 24.968763| train set 1.064x speedup, test set 2.549x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 25.066401| train set 1.065x speedup, test set 2.529x speedup, val set 0.909x speedup, step: 22
Epoch 22/200 |loss: 24.787174| train set 1.064x speedup, test set 2.493x speedup, val set 1.027x speedup, step: 23
Epoch 23/200 |loss: 24.333937| train set 1.070x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.445177| train set 1.070x speedup, test set 2.493x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.958094| train set 1.105x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.790735| train set 1.071x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.630081| train set 1.070x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 28
Epoch 28/200 |loss: 23.241402| train set 2.205x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.184183| train set 1.062x speedup, test set 2.478x speedup, val set 0.909x speedup, step: 30
Epoch 30/200 |loss: 22.996344| train set 2.205x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 31
Epoch 31/200 |loss: 22.607021| train set 2.207x speedup, test set 2.475x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.393095| train set 2.171x speedup, test set 2.451x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 22.315487| train set 2.192x speedup, test set 2.451x speedup, val set 0.957x speedup, step: 34
Epoch 34/200 |loss: 22.137035| train set 2.217x speedup, test set 2.451x speedup, val set 0.957x speedup, step: 35
Epoch 35/200 |loss: 21.774179| train set 2.179x speedup, test set 1.610x speedup, val set 1.039x speedup, step: 36
Epoch 36/200 |loss: 21.645432| train set 2.225x speedup, test set 1.616x speedup, val set 0.924x speedup, step: 37
Epoch 37/200 |loss: 22.192219| train set 1.064x speedup, test set 1.631x speedup, val set 1.042x speedup, step: 38
Epoch 38/200 |loss: 22.520105| train set 2.218x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 39
Epoch 39/200 |loss: 21.202585| train set 2.240x speedup, test set 1.671x speedup, val set 0.924x speedup, step: 40
Epoch 40/200 |loss: 22.006836| train set 2.239x speedup, test set 1.614x speedup, val set 0.957x speedup, step: 41
Epoch 41/200 |loss: 20.912403| train set 2.171x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 42
Epoch 42/200 |loss: 21.234091| train set 2.217x speedup, test set 1.632x speedup, val set 0.957x speedup, step: 43
Epoch 43/200 |loss: 20.651468| train set 2.438x speedup, test set 1.670x speedup, val set 0.924x speedup, step: 44
Epoch 44/200 |loss: 21.076778| train set 2.053x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 45
Epoch 45/200 |loss: 21.241795| train set 2.135x speedup, test set 1.635x speedup, val set 1.039x speedup, step: 46
Epoch 46/200 |loss: 22.378466| train set 2.156x speedup, test set 1.613x speedup, val set 0.957x speedup, step: 47
Epoch 47/200 |loss: 20.313725| train set 2.200x speedup, test set 1.619x speedup, val set 0.924x speedup, step: 48
Epoch 48/200 |loss: 21.572901| train set 2.311x speedup, test set 1.696x speedup, val set 0.924x speedup, step: 49
Epoch 49/200 |loss: 20.560312| train set 2.189x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 50
Epoch 50/200 |loss: 20.431135| train set 2.157x speedup, test set 1.631x speedup, val set 0.983x speedup, step: 51
Epoch 51/200 |loss: 20.100237| train set 2.146x speedup, test set 1.611x speedup, val set 0.985x speedup, step: 52
Epoch 52/200 |loss: 19.901453| train set 2.221x speedup, test set 1.668x speedup, val set 1.043x speedup, step: 53
Epoch 53/200 |loss: 19.809412| train set 2.170x speedup, test set 1.630x speedup, val set 1.039x speedup, step: 54
Epoch 54/200 |loss: 19.374445| train set 2.246x speedup, test set 1.630x speedup, val set 0.957x speedup, step: 55
Epoch 55/200 |loss: 19.413445| train set 2.460x speedup, test set 1.611x speedup, val set 0.814x speedup, step: 56
Epoch 56/200 |loss: 19.073151| train set 2.342x speedup, test set 1.611x speedup, val set 0.957x speedup, step: 57
Epoch 57/200 |loss: 18.938915| train set 2.271x speedup, test set 1.628x speedup, val set 1.039x speedup, step: 58
Epoch 58/200 |loss: 18.772217| train set 2.354x speedup, test set 1.628x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 18.478918| train set 2.371x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 60
Epoch 60/200 |loss: 18.439039| train set 2.460x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 61
Epoch 61/200 |loss: 18.179863| train set 2.353x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 62
Epoch 62/200 |loss: 18.029842| train set 2.357x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 63
Epoch 63/200 |loss: 17.741997| train set 2.267x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 64
Epoch 64/200 |loss: 17.682791| train set 2.356x speedup, test set 1.628x speedup, val set 1.043x speedup, step: 65
Epoch 65/200 |loss: 17.518978| train set 2.460x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 66
Epoch 66/200 |loss: 17.367615| train set 2.294x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 67
Epoch 67/200 |loss: 17.566999| train set 2.356x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 68
Epoch 68/200 |loss: 19.199833| train set 2.293x speedup, test set 1.628x speedup, val set 1.039x speedup, step: 69
Epoch 69/200 |loss: 17.732174| train set 2.553x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 70
Epoch 70/200 |loss: 16.914440| train set 2.460x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 71
Epoch 71/200 |loss: 17.433298| train set 2.299x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 72
Epoch 72/200 |loss: 16.913187| train set 2.356x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 73
Epoch 73/200 |loss: 16.620596| train set 2.362x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 74
Epoch 74/200 |loss: 16.531303| train set 2.374x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 75
Epoch 75/200 |loss: 16.309721| train set 2.897x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 76
Epoch 76/200 |loss: 16.186234| train set 2.278x speedup, test set 1.640x speedup, val set 1.039x speedup, step: 77
Epoch 77/200 |loss: 16.704645| train set 2.391x speedup, test set 1.665x speedup, val set 1.000x speedup, step: 78
Epoch 78/200 |loss: 16.534159| train set 2.303x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 79
Epoch 79/200 |loss: 15.725920| train set 2.755x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 80
Epoch 80/200 |loss: 15.806895| train set 2.885x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 81
Epoch 81/200 |loss: 15.491052| train set 2.355x speedup, test set 1.684x speedup, val set 1.043x speedup, step: 82
Epoch 82/200 |loss: 15.255364| train set 2.758x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 83
Epoch 83/200 |loss: 15.363066| train set 2.872x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 84
Epoch 84/200 |loss: 15.914167| train set 2.901x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 85
Epoch 85/200 |loss: 16.739721| train set 2.279x speedup, test set 1.626x speedup, val set 1.039x speedup, step: 86
Epoch 86/200 |loss: 15.742377| train set 2.402x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 87
Epoch 87/200 |loss: 15.297400| train set 2.772x speedup, test set 1.699x speedup, val set 0.972x speedup, step: 88
Epoch 88/200 |loss: 15.252031| train set 2.768x speedup, test set 1.684x speedup, val set 0.972x speedup, step: 89
Epoch 89/200 |loss: 14.669349| train set 2.889x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 15.165850| train set 2.626x speedup, test set 1.626x speedup, val set 1.039x speedup, step: 91
Epoch 91/200 |loss: 14.620914| train set 2.759x speedup, test set 1.684x speedup, val set 0.972x speedup, step: 92
Epoch 92/200 |loss: 14.391178| train set 2.908x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 14.553820| train set 2.746x speedup, test set 1.684x speedup, val set 0.972x speedup, step: 94
Epoch 94/200 |loss: 13.978148| train set 2.759x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 95
Epoch 95/200 |loss: 14.523648| train set 2.679x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 14.564250| train set 2.902x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 14.159947| train set 2.626x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 98
Epoch 98/200 |loss: 13.678997| train set 2.906x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 13.954422| train set 2.912x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 100
Epoch 100/200 |loss: 13.305354| train set 2.912x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 13.411758| train set 2.901x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 1
Epoch 102/200 |loss: 13.544240| train set 2.363x speedup, test set 1.684x speedup, val set 1.043x speedup, step: 1
Epoch 103/200 |loss: 13.862335| train set 2.902x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 2
Epoch 104/200 |loss: 14.713132| train set 2.904x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 3
Epoch 105/200 |loss: 13.454047| train set 2.771x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 4
Epoch 106/200 |loss: 12.912328| train set 2.760x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 5
Epoch 107/200 |loss: 13.146226| train set 2.749x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 6
Epoch 108/200 |loss: 12.860311| train set 2.902x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 7
Epoch 109/200 |loss: 12.807365| train set 2.913x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 8
Epoch 110/200 |loss: 12.747046| train set 2.903x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 9
Epoch 111/200 |loss: 12.347691| train set 2.627x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 1
Epoch 112/200 |loss: 12.278959| train set 2.913x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 2
Epoch 113/200 |loss: 11.929609| train set 2.967x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 3
Epoch 114/200 |loss: 12.043958| train set 2.907x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 4
Epoch 115/200 |loss: 11.983385| train set 2.907x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 5
Epoch 116/200 |loss: 11.779395| train set 2.906x speedup, test set 1.666x speedup, val set 1.000x speedup, step: 6
Epoch 117/200 |loss: 12.573121| train set 2.684x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 7
Epoch 118/200 |loss: 13.962934| train set 2.922x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 8
Epoch 119/200 |loss: 15.350215| train set 2.747x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 9
Epoch 120/200 |loss: 12.319956| train set 2.678x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 10
Epoch 121/200 |loss: 14.772934| train set 2.905x speedup, test set 1.671x speedup, val set 1.000x speedup, step: 11
Epoch 122/200 |loss: 15.034909| train set 2.631x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 123/200 |loss: 12.802318| train set 2.744x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 2
Epoch 124/200 |loss: 14.812772| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 3
Epoch 125/200 |loss: 12.218184| train set 2.918x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 4
Epoch 126/200 |loss: 13.395499| train set 2.940x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 5
Epoch 127/200 |loss: 12.128441| train set 2.841x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 6
Epoch 128/200 |loss: 12.679477| train set 2.769x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 7
Epoch 129/200 |loss: 12.048456| train set 2.764x speedup, test set 1.668x speedup, val set 1.043x speedup, step: 1
Epoch 130/200 |loss: 12.077535| train set 2.907x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 2
Epoch 131/200 |loss: 11.709855| train set 2.849x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 3
Epoch 132/200 |loss: 11.624837| train set 2.904x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 4
Epoch 133/200 |loss: 11.477546| train set 2.888x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 134/200 |loss: 11.318112| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 135/200 |loss: 11.145152| train set 2.914x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 136/200 |loss: 11.050487| train set 2.774x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 4
Epoch 137/200 |loss: 10.902710| train set 2.766x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 5
Epoch 138/200 |loss: 10.818181| train set 2.909x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 6
Epoch 139/200 |loss: 10.652936| train set 2.919x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 140/200 |loss: 10.549204| train set 2.904x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 8
Epoch 141/200 |loss: 10.474730| train set 2.905x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 9
Epoch 142/200 |loss: 10.325885| train set 2.904x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 10
Epoch 143/200 |loss: 10.301248| train set 2.914x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 11
Epoch 144/200 |loss: 10.172723| train set 2.924x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 12
Epoch 145/200 |loss: 10.165994| train set 2.919x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 13
Epoch 146/200 |loss: 10.096745| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 14
Epoch 147/200 |loss: 10.696720| train set 2.676x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 148/200 |loss: 12.357954| train set 2.908x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 2
Epoch 149/200 |loss: 14.979238| train set 2.658x speedup, test set 1.625x speedup, val set 1.043x speedup, step: 1
Epoch 150/200 |loss: 11.713035| train set 2.937x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 2
Epoch 151/200 |loss: 12.856483| train set 2.908x speedup, test set 1.675x speedup, val set 1.132x speedup, step: 1
Epoch 152/200 |loss: 13.350438| train set 2.631x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 2
Epoch 153/200 |loss: 12.613045| train set 2.555x speedup, test set 1.625x speedup, val set 1.043x speedup, step: 3
Epoch 154/200 |loss: 12.292234| train set 2.834x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 4
Epoch 155/200 |loss: 11.662734| train set 2.862x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 5
Epoch 156/200 |loss: 11.774845| train set 2.762x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 6
Epoch 157/200 |loss: 11.312883| train set 2.791x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 7
Epoch 158/200 |loss: 11.409786| train set 2.947x speedup, test set 1.706x speedup, val set 1.000x speedup, step: 8
Epoch 159/200 |loss: 10.568420| train set 2.942x speedup, test set 1.687x speedup, val set 0.984x speedup, step: 9
Epoch 160/200 |loss: 10.920127| train set 2.925x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 10
Epoch 161/200 |loss: 10.423361| train set 2.939x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 11
Epoch 162/200 |loss: 10.683087| train set 2.938x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 12
Epoch 163/200 |loss: 10.133933| train set 2.970x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 13
Epoch 164/200 |loss: 10.308929| train set 2.978x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 14
Epoch 165/200 |loss: 9.860151| train set 2.919x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 15
Epoch 166/200 |loss: 10.072049| train set 2.908x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 16
Epoch 167/200 |loss: 9.779855| train set 2.925x speedup, test set 1.675x speedup, val set 1.026x speedup, step: 17
Epoch 168/200 |loss: 9.777286| train set 3.012x speedup, test set 1.675x speedup, val set 0.984x speedup, step: 18
Epoch 169/200 |loss: 9.655335| train set 2.909x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 19
Epoch 170/200 |loss: 9.504796| train set 2.779x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 20
Epoch 171/200 |loss: 9.599164| train set 2.950x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 21
Epoch 172/200 |loss: 9.276832| train set 2.912x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 22
Epoch 173/200 |loss: 9.382270| train set 3.028x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 23
Epoch 174/200 |loss: 9.301134| train set 2.950x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 24
Epoch 175/200 |loss: 9.266054| train set 3.007x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 25
Epoch 176/200 |loss: 9.371533| train set 2.967x speedup, test set 1.735x speedup, val set 1.000x speedup, step: 26
Epoch 177/200 |loss: 9.486683| train set 2.948x speedup, test set 1.687x speedup, val set 1.026x speedup, step: 27
Epoch 178/200 |loss: 9.525998| train set 2.953x speedup, test set 1.661x speedup, val set 1.000x speedup, step: 28
Epoch 179/200 |loss: 9.673096| train set 2.988x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 29
Epoch 180/200 |loss: 9.484438| train set 3.010x speedup, test set 1.675x speedup, val set 1.026x speedup, step: 30
Epoch 181/200 |loss: 9.464039| train set 2.939x speedup, test set 1.675x speedup, val set 1.000x speedup, step: 31
Epoch 182/200 |loss: 9.740225| train set 3.026x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 32
Epoch 183/200 |loss: 9.235569| train set 2.954x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 33
Epoch 184/200 |loss: 8.855126| train set 2.961x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 34
Epoch 185/200 |loss: 9.058949| train set 3.006x speedup, test set 1.675x speedup, val set 1.026x speedup, step: 35
Epoch 186/200 |loss: 9.119040| train set 2.968x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 36
Epoch 187/200 |loss: 9.277697| train set 2.951x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 37
Epoch 188/200 |loss: 9.081436| train set 2.968x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 38
Epoch 189/200 |loss: 9.058404| train set 2.967x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 39
Epoch 190/200 |loss: 9.086589| train set 2.981x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 40
Epoch 191/200 |loss: 8.832409| train set 3.030x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 41
Epoch 192/200 |loss: 8.571225| train set 3.030x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 42
Epoch 193/200 |loss: 8.599028| train set 3.012x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 43
Epoch 194/200 |loss: 8.679696| train set 2.952x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 44
Epoch 195/200 |loss: 8.649399| train set 3.031x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 45
Epoch 196/200 |loss: 8.609876| train set 3.022x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 46
Epoch 197/200 |loss: 8.769734| train set 3.028x speedup, test set 1.735x speedup, val set 1.043x speedup, step: 47
Epoch 198/200 |loss: 9.837009| train set 3.012x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 48
Epoch 199/200 |loss: 9.391056| train set 2.963x speedup, test set 1.675x speedup, val set 1.132x speedup, step: 1
Training per epoch cost 0.323 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 195, train speedup 3.031, test speedup 1.675, val speedup 1.043
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 199, train speedup 2.963, test speedup 1.675, val speedup 1.132
last model at epoch 199, train speedup 2.963, test speedup 1.675, val speedup 1.132
execution cost 0:02:55.906595
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.078468, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507734| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141750| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.848001| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568964| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255947| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958149| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657248| train set 1.010x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.384804| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.092430| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.803808| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.507950| train set 1.055x speedup, test set 2.630x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.215267| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.955076| train set 1.054x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.703360| train set 1.054x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 18
Epoch 18/200 |loss: 25.681976| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 19
Epoch 19/200 |loss: 26.027796| train set 1.055x speedup, test set 2.549x speedup, val set 0.973x speedup, step: 20
Epoch 20/200 |loss: 24.990993| train set 1.058x speedup, test set 2.493x speedup, val set 1.027x speedup, step: 21
Epoch 21/200 |loss: 25.269222| train set 1.064x speedup, test set 2.529x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.852797| train set 1.064x speedup, test set 2.493x speedup, val set 1.027x speedup, step: 23
Epoch 23/200 |loss: 24.628069| train set 1.071x speedup, test set 2.464x speedup, val set 1.027x speedup, step: 24
Epoch 24/200 |loss: 24.405020| train set 1.070x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 24.070431| train set 1.070x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.976532| train set 1.846x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.585848| train set 1.062x speedup, test set 2.476x speedup, val set 0.909x speedup, step: 28
Epoch 28/200 |loss: 23.636366| train set 1.071x speedup, test set 2.478x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.118221| train set 2.205x speedup, test set 2.493x speedup, val set 0.909x speedup, step: 30
Epoch 30/200 |loss: 23.098810| train set 1.071x speedup, test set 2.478x speedup, val set 0.909x speedup, step: 31
Epoch 31/200 |loss: 22.856668| train set 2.229x speedup, test set 2.478x speedup, val set 0.909x speedup, step: 32
Epoch 32/200 |loss: 22.549805| train set 2.192x speedup, test set 2.454x speedup, val set 0.909x speedup, step: 33
Epoch 33/200 |loss: 22.556879| train set 2.230x speedup, test set 2.478x speedup, val set 0.909x speedup, step: 34
Epoch 34/200 |loss: 22.097002| train set 2.172x speedup, test set 2.478x speedup, val set 0.983x speedup, step: 35
Epoch 35/200 |loss: 21.871532| train set 2.230x speedup, test set 2.478x speedup, val set 0.909x speedup, step: 36
Epoch 36/200 |loss: 21.793011| train set 2.162x speedup, test set 1.612x speedup, val set 0.957x speedup, step: 37
Epoch 37/200 |loss: 21.592472| train set 2.230x speedup, test set 1.610x speedup, val set 0.957x speedup, step: 38
Epoch 38/200 |loss: 21.329695| train set 2.210x speedup, test set 1.612x speedup, val set 0.957x speedup, step: 39
Epoch 39/200 |loss: 21.008780| train set 2.265x speedup, test set 1.613x speedup, val set 0.880x speedup, step: 40
Epoch 40/200 |loss: 21.429056| train set 1.016x speedup, test set 1.630x speedup, val set 0.971x speedup, step: 41
Epoch 41/200 |loss: 23.416157| train set 2.218x speedup, test set 1.631x speedup, val set 0.960x speedup, step: 42
Epoch 42/200 |loss: 21.145170| train set 2.171x speedup, test set 1.671x speedup, val set 0.816x speedup, step: 43
Epoch 43/200 |loss: 21.996542| train set 2.120x speedup, test set 1.613x speedup, val set 0.812x speedup, step: 44
Epoch 44/200 |loss: 21.481653| train set 1.930x speedup, test set 1.623x speedup, val set 1.039x speedup, step: 45
Epoch 45/200 |loss: 21.054827| train set 2.236x speedup, test set 1.613x speedup, val set 0.957x speedup, step: 46
Epoch 46/200 |loss: 21.032087| train set 2.440x speedup, test set 1.670x speedup, val set 0.924x speedup, step: 47
Epoch 47/200 |loss: 20.424124| train set 2.197x speedup, test set 1.623x speedup, val set 0.873x speedup, step: 48
Epoch 48/200 |loss: 20.380827| train set 2.128x speedup, test set 1.613x speedup, val set 0.870x speedup, step: 49
Epoch 49/200 |loss: 20.520020| train set 2.218x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 50
Epoch 50/200 |loss: 20.098320| train set 2.218x speedup, test set 1.670x speedup, val set 1.039x speedup, step: 51
Epoch 51/200 |loss: 19.904139| train set 2.325x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 52
Epoch 52/200 |loss: 19.318434| train set 2.038x speedup, test set 1.632x speedup, val set 0.873x speedup, step: 53
Epoch 53/200 |loss: 19.605499| train set 2.149x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 54
Epoch 54/200 |loss: 19.254490| train set 2.185x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 55
Epoch 55/200 |loss: 19.257380| train set 2.270x speedup, test set 1.691x speedup, val set 1.043x speedup, step: 56
Epoch 56/200 |loss: 19.466614| train set 2.356x speedup, test set 1.632x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 18.607595| train set 2.322x speedup, test set 1.697x speedup, val set 0.873x speedup, step: 58
Epoch 58/200 |loss: 18.654924| train set 2.356x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 18.176086| train set 2.460x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 18.156586| train set 2.302x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 61
Epoch 61/200 |loss: 17.923225| train set 2.276x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 62
Epoch 62/200 |loss: 17.740602| train set 2.561x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 63
Epoch 63/200 |loss: 17.832624| train set 2.223x speedup, test set 1.628x speedup, val set 1.043x speedup, step: 64
Epoch 64/200 |loss: 18.728626| train set 2.760x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 65
Epoch 65/200 |loss: 21.865530| train set 2.225x speedup, test set 1.629x speedup, val set 1.042x speedup, step: 66
Epoch 66/200 |loss: 18.473158| train set 2.267x speedup, test set 1.615x speedup, val set 0.999x speedup, step: 67
Epoch 67/200 |loss: 21.081104| train set 2.460x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 68
Epoch 68/200 |loss: 19.104897| train set 2.460x speedup, test set 1.638x speedup, val set 0.873x speedup, step: 69
Epoch 69/200 |loss: 19.307856| train set 2.220x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 70
Epoch 70/200 |loss: 18.289236| train set 2.288x speedup, test set 1.611x speedup, val set 1.000x speedup, step: 71
Epoch 71/200 |loss: 18.434849| train set 2.360x speedup, test set 1.668x speedup, val set 0.873x speedup, step: 72
Epoch 72/200 |loss: 18.182997| train set 2.625x speedup, test set 1.668x speedup, val set 1.043x speedup, step: 73
Epoch 73/200 |loss: 17.957188| train set 2.548x speedup, test set 1.668x speedup, val set 1.043x speedup, step: 74
Epoch 74/200 |loss: 17.743439| train set 2.307x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 75
Epoch 75/200 |loss: 17.282145| train set 2.361x speedup, test set 1.687x speedup, val set 0.875x speedup, step: 76
Epoch 76/200 |loss: 17.126774| train set 2.362x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 77
Epoch 77/200 |loss: 17.085073| train set 2.457x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 78
Epoch 78/200 |loss: 16.616541| train set 2.740x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 79
Epoch 79/200 |loss: 16.694809| train set 2.458x speedup, test set 1.687x speedup, val set 1.003x speedup, step: 80
Epoch 80/200 |loss: 16.311556| train set 2.399x speedup, test set 1.687x speedup, val set 1.003x speedup, step: 81
Epoch 81/200 |loss: 16.260651| train set 2.364x speedup, test set 1.687x speedup, val set 1.003x speedup, step: 82
Epoch 82/200 |loss: 15.999629| train set 2.362x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 83
Epoch 83/200 |loss: 15.868942| train set 2.754x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 84
Epoch 84/200 |loss: 15.697200| train set 2.757x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 85
Epoch 85/200 |loss: 15.478809| train set 2.552x speedup, test set 1.687x speedup, val set 1.003x speedup, step: 86
Epoch 86/200 |loss: 15.505724| train set 2.757x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 87
Epoch 87/200 |loss: 15.280940| train set 2.900x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 88
Epoch 88/200 |loss: 15.207570| train set 2.364x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 89
Epoch 89/200 |loss: 15.355062| train set 2.886x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 90
Epoch 90/200 |loss: 15.378028| train set 2.625x speedup, test set 1.687x speedup, val set 1.042x speedup, step: 91
Epoch 91/200 |loss: 15.191376| train set 2.900x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 14.486716| train set 2.900x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 14.411623| train set 2.629x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 94
Epoch 94/200 |loss: 14.589780| train set 2.904x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 95
Epoch 95/200 |loss: 14.521549| train set 2.758x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 96
Epoch 96/200 |loss: 13.858481| train set 2.887x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 14.061091| train set 2.889x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 14.249326| train set 2.754x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 99
Epoch 99/200 |loss: 14.901021| train set 2.676x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 100
Epoch 100/200 |loss: 14.735316| train set 2.901x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 1
Epoch 101/200 |loss: 14.130956| train set 2.629x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 102/200 |loss: 13.765128| train set 2.890x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 2
Epoch 103/200 |loss: 14.348209| train set 2.477x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 104/200 |loss: 14.686628| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 105/200 |loss: 13.538777| train set 2.689x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 3
Epoch 106/200 |loss: 14.111307| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 4
Epoch 107/200 |loss: 13.293759| train set 2.902x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 5
Epoch 108/200 |loss: 12.849864| train set 2.634x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 6
Epoch 109/200 |loss: 13.373964| train set 2.905x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 110/200 |loss: 13.223416| train set 2.913x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 8
Epoch 111/200 |loss: 12.919532| train set 2.902x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 9
Epoch 112/200 |loss: 12.490077| train set 2.673x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 1
Epoch 113/200 |loss: 12.415990| train set 2.913x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 2
Epoch 114/200 |loss: 12.399575| train set 2.902x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 3
Epoch 115/200 |loss: 12.028890| train set 2.903x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 4
Epoch 116/200 |loss: 11.912990| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 5
Epoch 117/200 |loss: 11.674520| train set 2.913x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 6
Epoch 118/200 |loss: 11.557012| train set 2.903x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 7
Epoch 119/200 |loss: 11.721021| train set 2.957x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 8
Epoch 120/200 |loss: 11.997489| train set 2.917x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 9
Epoch 121/200 |loss: 12.239631| train set 2.800x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 10
Epoch 122/200 |loss: 12.239065| train set 2.918x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 11
Epoch 123/200 |loss: 11.828897| train set 2.906x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 12
Epoch 124/200 |loss: 13.738170| train set 2.315x speedup, test set 1.407x speedup, val set 1.024x speedup, step: 13
Epoch 125/200 |loss: 20.020216| train set 2.906x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 14
Epoch 126/200 |loss: 16.923523| train set 2.918x speedup, test set 1.424x speedup, val set 1.132x speedup, step: 1
Epoch 127/200 |loss: 15.486247| train set 2.546x speedup, test set 1.418x speedup, val set 0.984x speedup, step: 2
Epoch 128/200 |loss: 18.659925| train set 2.753x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 3
Epoch 129/200 |loss: 14.540898| train set 2.826x speedup, test set 1.757x speedup, val set 1.000x speedup, step: 4
Epoch 130/200 |loss: 15.857090| train set 2.611x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 5
Epoch 131/200 |loss: 14.287449| train set 2.290x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 6
Epoch 132/200 |loss: 14.987553| train set 2.904x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 7
Epoch 133/200 |loss: 13.522135| train set 2.897x speedup, test set 1.696x speedup, val set 1.132x speedup, step: 1
Epoch 134/200 |loss: 14.577911| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 135/200 |loss: 13.019952| train set 2.675x speedup, test set 1.673x speedup, val set 1.003x speedup, step: 3
Epoch 136/200 |loss: 13.801591| train set 2.560x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 4
Epoch 137/200 |loss: 12.988626| train set 2.904x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 5
Epoch 138/200 |loss: 12.617910| train set 2.913x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 6
Epoch 139/200 |loss: 12.745145| train set 2.914x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 140/200 |loss: 12.357951| train set 2.752x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 8
Epoch 141/200 |loss: 12.212588| train set 2.765x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 9
Epoch 142/200 |loss: 12.148504| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 10
Epoch 143/200 |loss: 11.659049| train set 2.971x speedup, test set 1.677x speedup, val set 0.984x speedup, step: 11
Epoch 144/200 |loss: 11.829433| train set 2.917x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 12
Epoch 145/200 |loss: 11.383199| train set 2.894x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 13
Epoch 146/200 |loss: 11.474105| train set 2.900x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 14
Epoch 147/200 |loss: 11.144337| train set 2.914x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 15
Epoch 148/200 |loss: 11.095568| train set 2.904x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 16
Epoch 149/200 |loss: 11.137296| train set 2.908x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 17
Epoch 150/200 |loss: 10.794223| train set 2.765x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 18
Epoch 151/200 |loss: 10.887509| train set 2.908x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 19
Epoch 152/200 |loss: 10.667490| train set 2.960x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 20
Epoch 153/200 |loss: 10.505323| train set 3.016x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 21
Epoch 154/200 |loss: 10.459361| train set 2.908x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 22
Epoch 155/200 |loss: 10.512270| train set 2.979x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 23
Epoch 156/200 |loss: 10.431231| train set 2.919x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 24
Epoch 157/200 |loss: 10.485845| train set 2.979x speedup, test set 1.696x speedup, val set 1.026x speedup, step: 25
Epoch 158/200 |loss: 10.982559| train set 2.960x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 26
Epoch 159/200 |loss: 10.973523| train set 2.924x speedup, test set 1.424x speedup, val set 1.043x speedup, step: 27
Epoch 160/200 |loss: 10.802507| train set 2.908x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 28
Epoch 161/200 |loss: 9.922516| train set 2.960x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 29
Epoch 162/200 |loss: 10.235300| train set 2.979x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 30
Epoch 163/200 |loss: 10.925584| train set 2.919x speedup, test set 1.407x speedup, val set 1.043x speedup, step: 31
Epoch 164/200 |loss: 10.165690| train set 2.919x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 32
Epoch 165/200 |loss: 9.866847| train set 2.981x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 33
Epoch 166/200 |loss: 10.194874| train set 2.949x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 34
Epoch 167/200 |loss: 10.119000| train set 2.977x speedup, test set 1.418x speedup, val set 1.043x speedup, step: 35
Epoch 168/200 |loss: 9.790773| train set 2.911x speedup, test set 1.424x speedup, val set 1.043x speedup, step: 36
Epoch 169/200 |loss: 9.661310| train set 2.921x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 37
Epoch 170/200 |loss: 9.652331| train set 2.979x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 38
Epoch 171/200 |loss: 9.709661| train set 2.960x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 39
Epoch 172/200 |loss: 9.598580| train set 2.981x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 40
Epoch 173/200 |loss: 9.521152| train set 2.908x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 41
Epoch 174/200 |loss: 9.327255| train set 2.960x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 42
Epoch 175/200 |loss: 9.341507| train set 2.983x speedup, test set 1.414x speedup, val set 1.026x speedup, step: 43
Epoch 176/200 |loss: 9.431246| train set 2.960x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 44
Epoch 177/200 |loss: 9.545092| train set 2.984x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 45
Epoch 178/200 |loss: 9.403186| train set 2.921x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 46
Epoch 179/200 |loss: 9.157972| train set 2.927x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 47
Epoch 180/200 |loss: 9.122720| train set 3.025x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 48
Epoch 181/200 |loss: 9.231145| train set 2.952x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 49
Epoch 182/200 |loss: 9.328038| train set 3.014x speedup, test set 1.407x speedup, val set 1.026x speedup, step: 50
Epoch 183/200 |loss: 9.380654| train set 2.969x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 51
Epoch 184/200 |loss: 9.760160| train set 3.010x speedup, test set 1.407x speedup, val set 1.026x speedup, step: 52
Epoch 185/200 |loss: 9.624546| train set 3.028x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 53
Epoch 186/200 |loss: 9.693933| train set 2.964x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 54
Epoch 187/200 |loss: 9.146966| train set 3.020x speedup, test set 1.414x speedup, val set 1.026x speedup, step: 55
Epoch 188/200 |loss: 9.332662| train set 2.953x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 56
Epoch 189/200 |loss: 9.912080| train set 2.863x speedup, test set 1.414x speedup, val set 1.026x speedup, step: 57
Epoch 190/200 |loss: 9.780989| train set 2.963x speedup, test set 1.414x speedup, val set 0.873x speedup, step: 58
Epoch 191/200 |loss: 9.355247| train set 3.025x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 59
Epoch 192/200 |loss: 9.164525| train set 3.046x speedup, test set 1.414x speedup, val set 1.026x speedup, step: 60
Epoch 193/200 |loss: 9.163692| train set 2.922x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 61
Epoch 194/200 |loss: 9.231441| train set 2.927x speedup, test set 1.414x speedup, val set 1.043x speedup, step: 62
Epoch 195/200 |loss: 9.200790| train set 3.045x speedup, test set 1.414x speedup, val set 1.026x speedup, step: 63
Epoch 196/200 |loss: 9.093322| train set 2.949x speedup, test set 1.414x speedup, val set 1.000x speedup, step: 64
Epoch 197/200 |loss: 9.248199| train set 2.985x speedup, test set 1.414x speedup, val set 1.026x speedup, step: 65
Epoch 198/200 |loss: 9.292878| train set 2.963x speedup, test set 1.414x speedup, val set 1.026x speedup, step: 66
Epoch 199/200 |loss: 8.803794| train set 2.969x speedup, test set 1.414x speedup, val set 1.000x speedup, step: 67
Training per epoch cost 0.329 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 192, train speedup 3.046, test speedup 1.414, val speedup 1.026
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 133, train speedup 2.897, test speedup 1.696, val speedup 1.132
last model at epoch 199, train speedup 2.969, test speedup 1.414, val speedup 1.000
execution cost 0:03:01.051739
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.082498, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507730| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141750| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.848000| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568964| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255951| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958174| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657343| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.384050| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.092434| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.802973| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.505163| train set 1.055x speedup, test set 2.630x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.212692| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.959957| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.762489| train set 1.054x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.892321| train set 1.054x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 19
Epoch 19/200 |loss: 25.545603| train set 1.055x speedup, test set 2.549x speedup, val set 0.975x speedup, step: 20
Epoch 20/200 |loss: 24.966726| train set 1.064x speedup, test set 2.529x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 24.934687| train set 1.064x speedup, test set 2.595x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.616022| train set 1.071x speedup, test set 2.593x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.279413| train set 1.064x speedup, test set 2.674x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.219046| train set 1.071x speedup, test set 2.555x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.884546| train set 1.070x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.557932| train set 1.071x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 23.431702| train set 1.167x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.233341| train set 1.156x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 29
Epoch 29/200 |loss: 22.987410| train set 2.203x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 22.656637| train set 1.211x speedup, test set 2.451x speedup, val set 0.897x speedup, step: 31
Epoch 31/200 |loss: 22.399300| train set 2.227x speedup, test set 2.441x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.488174| train set 1.059x speedup, test set 2.523x speedup, val set 0.985x speedup, step: 33
Epoch 33/200 |loss: 23.292530| train set 2.230x speedup, test set 1.611x speedup, val set 0.957x speedup, step: 34
Epoch 34/200 |loss: 22.504131| train set 2.230x speedup, test set 1.603x speedup, val set 0.957x speedup, step: 35
Epoch 35/200 |loss: 21.889723| train set 1.119x speedup, test set 1.631x speedup, val set 0.983x speedup, step: 36
Epoch 36/200 |loss: 22.225906| train set 2.238x speedup, test set 1.632x speedup, val set 0.957x speedup, step: 37
Epoch 37/200 |loss: 21.569191| train set 2.318x speedup, test set 1.619x speedup, val set 0.924x speedup, step: 38
Epoch 38/200 |loss: 21.843143| train set 2.217x speedup, test set 1.632x speedup, val set 0.985x speedup, step: 39
Epoch 39/200 |loss: 21.255423| train set 1.931x speedup, test set 1.630x speedup, val set 0.985x speedup, step: 40
Epoch 40/200 |loss: 21.236774| train set 2.176x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 41
Epoch 41/200 |loss: 20.877686| train set 2.249x speedup, test set 1.631x speedup, val set 0.814x speedup, step: 42
Epoch 42/200 |loss: 20.758352| train set 2.134x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 43
Epoch 43/200 |loss: 20.550039| train set 2.228x speedup, test set 1.632x speedup, val set 0.983x speedup, step: 44
Epoch 44/200 |loss: 20.323957| train set 2.329x speedup, test set 1.637x speedup, val set 0.948x speedup, step: 45
Epoch 45/200 |loss: 20.336941| train set 2.319x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 46
Epoch 46/200 |loss: 20.288382| train set 2.233x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 47
Epoch 47/200 |loss: 20.898851| train set 2.354x speedup, test set 1.638x speedup, val set 1.043x speedup, step: 48
Epoch 48/200 |loss: 20.843447| train set 2.428x speedup, test set 1.637x speedup, val set 0.924x speedup, step: 49
Epoch 49/200 |loss: 19.741913| train set 2.281x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 50
Epoch 50/200 |loss: 20.704432| train set 2.270x speedup, test set 1.638x speedup, val set 1.039x speedup, step: 51
Epoch 51/200 |loss: 19.859896| train set 2.381x speedup, test set 1.637x speedup, val set 0.924x speedup, step: 52
Epoch 52/200 |loss: 19.954679| train set 2.334x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 53
Epoch 53/200 |loss: 19.365976| train set 2.311x speedup, test set 1.632x speedup, val set 1.042x speedup, step: 54
Epoch 54/200 |loss: 19.604879| train set 2.353x speedup, test set 1.638x speedup, val set 1.043x speedup, step: 55
Epoch 55/200 |loss: 18.683697| train set 2.337x speedup, test set 1.638x speedup, val set 1.043x speedup, step: 56
Epoch 56/200 |loss: 19.077454| train set 2.354x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 57
Epoch 57/200 |loss: 18.528870| train set 2.457x speedup, test set 1.632x speedup, val set 1.043x speedup, step: 58
Epoch 58/200 |loss: 18.557657| train set 2.432x speedup, test set 1.615x speedup, val set 1.000x speedup, step: 59
Epoch 59/200 |loss: 18.279551| train set 2.270x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 18.267103| train set 2.354x speedup, test set 1.632x speedup, val set 1.043x speedup, step: 61
Epoch 61/200 |loss: 17.794739| train set 2.555x speedup, test set 1.617x speedup, val set 0.873x speedup, step: 62
Epoch 62/200 |loss: 17.935135| train set 2.356x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 63
Epoch 63/200 |loss: 17.690807| train set 2.349x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 64
Epoch 64/200 |loss: 17.576231| train set 2.457x speedup, test set 1.675x speedup, val set 1.043x speedup, step: 65
Epoch 65/200 |loss: 17.310719| train set 2.349x speedup, test set 1.615x speedup, val set 1.043x speedup, step: 66
Epoch 66/200 |loss: 17.055784| train set 2.361x speedup, test set 1.623x speedup, val set 1.043x speedup, step: 67
Epoch 67/200 |loss: 16.946163| train set 2.354x speedup, test set 1.623x speedup, val set 1.043x speedup, step: 68
Epoch 68/200 |loss: 16.698666| train set 2.466x speedup, test set 1.615x speedup, val set 1.043x speedup, step: 69
Epoch 69/200 |loss: 16.880808| train set 2.275x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 70
Epoch 70/200 |loss: 17.955633| train set 2.747x speedup, test set 1.697x speedup, val set 1.043x speedup, step: 71
Epoch 71/200 |loss: 20.571798| train set 2.359x speedup, test set 1.628x speedup, val set 1.043x speedup, step: 72
Epoch 72/200 |loss: 16.720066| train set 2.369x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 73
Epoch 73/200 |loss: 19.266340| train set 2.896x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 74
Epoch 74/200 |loss: 18.569828| train set 2.275x speedup, test set 1.630x speedup, val set 0.971x speedup, step: 75
Epoch 75/200 |loss: 18.049084| train set 2.205x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 76
Epoch 76/200 |loss: 18.463718| train set 2.557x speedup, test set 1.673x speedup, val set 0.900x speedup, step: 77
Epoch 77/200 |loss: 17.663700| train set 2.241x speedup, test set 1.628x speedup, val set 0.822x speedup, step: 78
Epoch 78/200 |loss: 17.350420| train set 2.257x speedup, test set 1.628x speedup, val set 0.968x speedup, step: 79
Epoch 79/200 |loss: 17.082766| train set 2.754x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 80
Epoch 80/200 |loss: 17.155012| train set 2.755x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 81
Epoch 81/200 |loss: 16.122032| train set 2.447x speedup, test set 1.673x speedup, val set 0.822x speedup, step: 82
Epoch 82/200 |loss: 16.635485| train set 2.297x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 83
Epoch 83/200 |loss: 15.959130| train set 2.754x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 84
Epoch 84/200 |loss: 16.032248| train set 2.750x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 85
Epoch 85/200 |loss: 15.811419| train set 2.465x speedup, test set 1.673x speedup, val set 0.975x speedup, step: 86
Epoch 86/200 |loss: 15.414309| train set 2.572x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 87
Epoch 87/200 |loss: 15.541114| train set 2.886x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 88
Epoch 88/200 |loss: 14.963124| train set 2.754x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 89
Epoch 89/200 |loss: 15.184753| train set 2.897x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 90
Epoch 90/200 |loss: 14.825043| train set 2.896x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 91
Epoch 91/200 |loss: 14.671590| train set 2.469x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 92
Epoch 92/200 |loss: 14.469086| train set 2.771x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 93
Epoch 93/200 |loss: 14.288890| train set 2.773x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 94
Epoch 94/200 |loss: 14.137857| train set 2.902x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 95
Epoch 95/200 |loss: 13.989692| train set 2.768x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 96
Epoch 96/200 |loss: 13.965590| train set 2.758x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 97
Epoch 97/200 |loss: 14.336312| train set 2.900x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 98
Epoch 98/200 |loss: 14.805547| train set 2.771x speedup, test set 1.689x speedup, val set 0.972x speedup, step: 99
Epoch 99/200 |loss: 16.552187| train set 2.762x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 100
Epoch 100/200 |loss: 13.944236| train set 2.758x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 1
Epoch 101/200 |loss: 15.034454| train set 2.902x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 1
Epoch 102/200 |loss: 15.868458| train set 2.743x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 1
Epoch 103/200 |loss: 14.927762| train set 2.672x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 2
Epoch 104/200 |loss: 15.957840| train set 2.902x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 3
Epoch 105/200 |loss: 15.351083| train set 2.902x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 4
Epoch 106/200 |loss: 14.400754| train set 2.900x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 5
Epoch 107/200 |loss: 14.533971| train set 2.900x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 6
Epoch 108/200 |loss: 13.711330| train set 2.773x speedup, test set 1.675x speedup, val set 0.934x speedup, step: 7
Epoch 109/200 |loss: 14.363024| train set 2.760x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 110/200 |loss: 13.426786| train set 2.759x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 2
Epoch 111/200 |loss: 13.924343| train set 2.899x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 112/200 |loss: 12.917550| train set 2.902x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 113/200 |loss: 13.257640| train set 2.901x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 114/200 |loss: 12.974854| train set 2.888x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 2
Epoch 115/200 |loss: 12.863106| train set 2.906x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 116/200 |loss: 12.496140| train set 2.891x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 117/200 |loss: 12.796695| train set 2.906x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 118/200 |loss: 12.336794| train set 2.972x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 2
Epoch 119/200 |loss: 12.564516| train set 2.906x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 3
Epoch 120/200 |loss: 12.957593| train set 2.753x speedup, test set 1.689x speedup, val set 0.972x speedup, step: 4
Epoch 121/200 |loss: 13.169422| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 122/200 |loss: 12.202933| train set 2.819x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 2
Epoch 123/200 |loss: 12.410405| train set 2.905x speedup, test set 1.689x speedup, val set 0.934x speedup, step: 3
Epoch 124/200 |loss: 12.093700| train set 2.906x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 125/200 |loss: 11.860308| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 126/200 |loss: 11.726989| train set 2.907x speedup, test set 1.688x speedup, val set 0.934x speedup, step: 2
Epoch 127/200 |loss: 12.533835| train set 2.913x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 3
Epoch 128/200 |loss: 11.531245| train set 2.903x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 4
Epoch 129/200 |loss: 11.424369| train set 2.902x speedup, test set 1.688x speedup, val set 0.934x speedup, step: 5
Epoch 130/200 |loss: 11.338850| train set 2.917x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 131/200 |loss: 11.396001| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 132/200 |loss: 10.994000| train set 2.968x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 2
Epoch 133/200 |loss: 11.078017| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 134/200 |loss: 11.099545| train set 2.761x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 2
Epoch 135/200 |loss: 11.483644| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 136/200 |loss: 11.260022| train set 2.907x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 2
Epoch 137/200 |loss: 11.171880| train set 2.969x speedup, test set 1.689x speedup, val set 0.934x speedup, step: 3
Epoch 138/200 |loss: 12.537125| train set 2.947x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 139/200 |loss: 11.474370| train set 2.919x speedup, test set 1.675x speedup, val set 1.000x speedup, step: 1
Epoch 140/200 |loss: 10.595923| train set 2.923x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 1
Epoch 141/200 |loss: 10.700178| train set 2.948x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 142/200 |loss: 10.970240| train set 2.908x speedup, test set 1.675x speedup, val set 1.000x speedup, step: 1
Epoch 143/200 |loss: 10.872441| train set 2.904x speedup, test set 1.675x speedup, val set 1.000x speedup, step: 1
Epoch 144/200 |loss: 10.219063| train set 2.959x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 145/200 |loss: 10.464711| train set 2.907x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 1
Epoch 146/200 |loss: 10.729497| train set 2.959x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 147/200 |loss: 10.228655| train set 2.960x speedup, test set 1.675x speedup, val set 1.000x speedup, step: 1
Epoch 148/200 |loss: 9.938404| train set 2.978x speedup, test set 1.675x speedup, val set 1.000x speedup, step: 1
Epoch 149/200 |loss: 9.971714| train set 2.960x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 150/200 |loss: 10.222043| train set 2.909x speedup, test set 1.675x speedup, val set 1.000x speedup, step: 1
Epoch 151/200 |loss: 10.163707| train set 3.010x speedup, test set 1.675x speedup, val set 1.000x speedup, step: 1
Epoch 152/200 |loss: 9.976697| train set 2.950x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 153/200 |loss: 10.431790| train set 2.790x speedup, test set 1.630x speedup, val set 0.975x speedup, step: 2
Epoch 154/200 |loss: 11.723610| train set 2.853x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 155/200 |loss: 13.354962| train set 2.660x speedup, test set 1.646x speedup, val set 1.043x speedup, step: 1
Epoch 156/200 |loss: 11.450079| train set 2.808x speedup, test set 1.630x speedup, val set 0.975x speedup, step: 2
Epoch 157/200 |loss: 10.826656| train set 2.903x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 3
Epoch 158/200 |loss: 12.127475| train set 2.656x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 159/200 |loss: 10.615879| train set 2.815x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 160/200 |loss: 11.492194| train set 2.925x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 2
Epoch 161/200 |loss: 10.429814| train set 2.936x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 3
Epoch 162/200 |loss: 10.660651| train set 2.959x speedup, test set 1.689x speedup, val set 0.937x speedup, step: 4
Epoch 163/200 |loss: 11.532713| train set 2.803x speedup, test set 1.675x speedup, val set 1.000x speedup, step: 5
Epoch 164/200 |loss: 10.138365| train set 2.948x speedup, test set 1.672x speedup, val set 1.000x speedup, step: 6
Epoch 165/200 |loss: 10.981215| train set 2.924x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 166/200 |loss: 11.052400| train set 2.693x speedup, test set 1.628x speedup, val set 1.043x speedup, step: 1
Epoch 167/200 |loss: 10.843382| train set 2.961x speedup, test set 1.628x speedup, val set 0.934x speedup, step: 2
Epoch 168/200 |loss: 10.324021| train set 2.904x speedup, test set 1.672x speedup, val set 1.000x speedup, step: 3
Epoch 169/200 |loss: 11.335342| train set 2.921x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 4
Epoch 170/200 |loss: 9.949050| train set 2.685x speedup, test set 1.698x speedup, val set 0.972x speedup, step: 5
Epoch 171/200 |loss: 10.671004| train set 2.909x speedup, test set 1.689x speedup, val set 0.934x speedup, step: 6
Epoch 172/200 |loss: 10.527396| train set 2.919x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 173/200 |loss: 9.735734| train set 2.833x speedup, test set 1.704x speedup, val set 0.972x speedup, step: 8
Epoch 174/200 |loss: 10.782896| train set 2.847x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 175/200 |loss: 10.360229| train set 2.909x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 2
Epoch 176/200 |loss: 9.919114| train set 2.949x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 3
Epoch 177/200 |loss: 10.437085| train set 2.983x speedup, test set 1.706x speedup, val set 0.934x speedup, step: 4
Epoch 178/200 |loss: 9.634602| train set 2.926x speedup, test set 1.706x speedup, val set 1.000x speedup, step: 5
Epoch 179/200 |loss: 9.661778| train set 2.961x speedup, test set 1.688x speedup, val set 1.000x speedup, step: 6
Epoch 180/200 |loss: 9.693369| train set 3.022x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 181/200 |loss: 9.164413| train set 2.980x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 182/200 |loss: 9.583680| train set 2.950x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 183/200 |loss: 9.020298| train set 2.961x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 2
Epoch 184/200 |loss: 9.326962| train set 2.984x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 185/200 |loss: 9.193541| train set 2.925x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 186/200 |loss: 8.982534| train set 2.950x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 187/200 |loss: 9.244061| train set 2.953x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 188/200 |loss: 9.172218| train set 2.970x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 189/200 |loss: 8.807754| train set 2.950x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 2
Epoch 190/200 |loss: 9.186412| train set 2.970x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 191/200 |loss: 9.187753| train set 2.951x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 192/200 |loss: 8.687531| train set 3.010x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 193/200 |loss: 9.121938| train set 2.988x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 194/200 |loss: 9.265418| train set 3.029x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 195/200 |loss: 8.582433| train set 2.952x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 196/200 |loss: 9.155812| train set 2.927x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 197/200 |loss: 9.274620| train set 3.029x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 198/200 |loss: 8.583536| train set 2.959x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Epoch 199/200 |loss: 9.518288| train set 2.928x speedup, test set 1.706x speedup, val set 1.043x speedup, step: 1
Training per epoch cost 0.323 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 31.019s, pg runtime 31.019s, speedup 1.000x
08, opt runtime 7.377s, model runtime 28.655s, pg runtime 28.655s, speedup 1.000x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 76.171s, pg runtime 75.984s, speedup 0.998x
34, opt runtime 39.191s, model runtime 76.171s, pg runtime 75.984s, speedup 0.998x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 194, train speedup 3.029, test speedup 1.706, val speedup 1.043
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 199, train speedup 2.928, test speedup 1.706, val speedup 1.043
last model at epoch 199, train speedup 2.928, test speedup 1.706, val speedup 1.043
execution cost 0:03:03.789201
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.069990, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507729| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141745| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847769| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.567972| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255001| train set 1.012x speedup, test set 2.718x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.956709| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.655371| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.381224| train set 1.011x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.089945| train set 1.029x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.795233| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.498726| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.210346| train set 1.055x speedup, test set 2.526x speedup, val set 1.126x speedup, step: 16
Epoch 16/200 |loss: 25.954359| train set 1.055x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 17
Epoch 17/200 |loss: 25.791355| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 26.080439| train set 1.056x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 19
Epoch 19/200 |loss: 25.452089| train set 1.053x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 20
Epoch 20/200 |loss: 25.077538| train set 1.064x speedup, test set 2.549x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 25.084127| train set 1.064x speedup, test set 2.546x speedup, val set 0.909x speedup, step: 22
Epoch 22/200 |loss: 24.552164| train set 1.070x speedup, test set 2.526x speedup, val set 0.909x speedup, step: 23
Epoch 23/200 |loss: 24.597382| train set 1.064x speedup, test set 2.603x speedup, val set 0.909x speedup, step: 24
Epoch 24/200 |loss: 24.331264| train set 1.071x speedup, test set 2.554x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.952587| train set 1.070x speedup, test set 2.603x speedup, val set 0.909x speedup, step: 26
Epoch 26/200 |loss: 24.003237| train set 1.070x speedup, test set 2.603x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.555059| train set 2.202x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 28
Epoch 28/200 |loss: 23.400736| train set 1.062x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.238916| train set 2.029x speedup, test set 2.475x speedup, val set 0.909x speedup, step: 30
Epoch 30/200 |loss: 22.812365| train set 2.230x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 31
Epoch 31/200 |loss: 22.709314| train set 1.062x speedup, test set 2.479x speedup, val set 0.909x speedup, step: 32
Epoch 32/200 |loss: 22.681112| train set 2.230x speedup, test set 2.497x speedup, val set 0.909x speedup, step: 33
Epoch 33/200 |loss: 22.276987| train set 1.999x speedup, test set 2.481x speedup, val set 0.909x speedup, step: 34
Epoch 34/200 |loss: 22.171707| train set 2.143x speedup, test set 2.483x speedup, val set 0.909x speedup, step: 35
Epoch 35/200 |loss: 22.228678| train set 2.230x speedup, test set 1.612x speedup, val set 0.909x speedup, step: 36
Epoch 36/200 |loss: 21.861206| train set 2.209x speedup, test set 1.618x speedup, val set 0.909x speedup, step: 37
Epoch 37/200 |loss: 21.428442| train set 2.230x speedup, test set 1.630x speedup, val set 0.909x speedup, step: 38
Epoch 38/200 |loss: 21.407013| train set 2.219x speedup, test set 1.613x speedup, val set 0.983x speedup, step: 39
Epoch 39/200 |loss: 21.714306| train set 2.184x speedup, test set 1.632x speedup, val set 0.880x speedup, step: 40
Epoch 40/200 |loss: 21.172188| train set 2.219x speedup, test set 1.630x speedup, val set 0.909x speedup, step: 41
Epoch 41/200 |loss: 20.774927| train set 2.230x speedup, test set 1.632x speedup, val set 0.913x speedup, step: 42
Epoch 42/200 |loss: 21.168770| train set 2.179x speedup, test set 1.630x speedup, val set 0.983x speedup, step: 43
Epoch 43/200 |loss: 20.509651| train set 2.311x speedup, test set 1.631x speedup, val set 0.780x speedup, step: 44
Epoch 44/200 |loss: 20.187717| train set 2.239x speedup, test set 1.630x speedup, val set 0.983x speedup, step: 45
Epoch 45/200 |loss: 20.050402| train set 2.229x speedup, test set 1.620x speedup, val set 0.987x speedup, step: 46
Epoch 46/200 |loss: 19.729208| train set 2.325x speedup, test set 1.619x speedup, val set 0.987x speedup, step: 47
Epoch 47/200 |loss: 19.783085| train set 2.152x speedup, test set 1.619x speedup, val set 0.948x speedup, step: 48
Epoch 48/200 |loss: 19.576094| train set 2.271x speedup, test set 1.619x speedup, val set 0.983x speedup, step: 49
Epoch 49/200 |loss: 19.471680| train set 2.337x speedup, test set 1.619x speedup, val set 1.000x speedup, step: 50
Epoch 50/200 |loss: 19.412357| train set 2.354x speedup, test set 1.619x speedup, val set 0.983x speedup, step: 51
Epoch 51/200 |loss: 19.007637| train set 2.357x speedup, test set 1.677x speedup, val set 0.948x speedup, step: 52
Epoch 52/200 |loss: 18.670004| train set 2.460x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 53
Epoch 53/200 |loss: 18.750719| train set 2.460x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 54
Epoch 54/200 |loss: 19.490921| train set 1.087x speedup, test set 1.646x speedup, val set 0.985x speedup, step: 55
Epoch 55/200 |loss: 21.989023| train set 2.429x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 56
Epoch 56/200 |loss: 19.182673| train set 2.459x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 57
Epoch 57/200 |loss: 19.821211| train set 2.220x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 58
Epoch 58/200 |loss: 19.340708| train set 2.211x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 19.291677| train set 2.460x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 18.378565| train set 2.353x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 61
Epoch 61/200 |loss: 18.690973| train set 2.219x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 62
Epoch 62/200 |loss: 18.173681| train set 2.275x speedup, test set 1.677x speedup, val set 1.039x speedup, step: 63
Epoch 63/200 |loss: 18.815142| train set 2.352x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 64
Epoch 64/200 |loss: 17.580305| train set 2.360x speedup, test set 1.674x speedup, val set 0.873x speedup, step: 65
Epoch 65/200 |loss: 17.928293| train set 2.363x speedup, test set 1.674x speedup, val set 0.873x speedup, step: 66
Epoch 66/200 |loss: 17.386614| train set 2.616x speedup, test set 1.674x speedup, val set 1.000x speedup, step: 67
Epoch 67/200 |loss: 17.650568| train set 2.372x speedup, test set 1.616x speedup, val set 1.043x speedup, step: 68
Epoch 68/200 |loss: 17.238167| train set 2.576x speedup, test set 1.674x speedup, val set 0.873x speedup, step: 69
Epoch 69/200 |loss: 17.160078| train set 2.360x speedup, test set 1.693x speedup, val set 1.039x speedup, step: 70
Epoch 70/200 |loss: 16.773554| train set 2.359x speedup, test set 1.674x speedup, val set 1.043x speedup, step: 71
Epoch 71/200 |loss: 16.572672| train set 2.894x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 72
Epoch 72/200 |loss: 16.367073| train set 2.463x speedup, test set 1.693x speedup, val set 0.822x speedup, step: 73
Epoch 73/200 |loss: 16.493301| train set 2.879x speedup, test set 1.674x speedup, val set 0.873x speedup, step: 74
Epoch 74/200 |loss: 17.021000| train set 2.276x speedup, test set 1.648x speedup, val set 1.042x speedup, step: 75
Epoch 75/200 |loss: 17.691769| train set 2.752x speedup, test set 1.736x speedup, val set 0.873x speedup, step: 76
Epoch 76/200 |loss: 16.246368| train set 2.577x speedup, test set 1.677x speedup, val set 0.822x speedup, step: 77
Epoch 77/200 |loss: 16.083689| train set 2.568x speedup, test set 1.637x speedup, val set 0.822x speedup, step: 78
Epoch 78/200 |loss: 16.557652| train set 2.755x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 79
Epoch 79/200 |loss: 17.059908| train set 2.551x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 80
Epoch 80/200 |loss: 15.615300| train set 2.369x speedup, test set 1.648x speedup, val set 0.822x speedup, step: 81
Epoch 81/200 |loss: 16.339386| train set 2.897x speedup, test set 1.736x speedup, val set 0.822x speedup, step: 82
Epoch 82/200 |loss: 15.571998| train set 2.553x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 83
Epoch 83/200 |loss: 15.575873| train set 2.626x speedup, test set 1.708x speedup, val set 0.972x speedup, step: 84
Epoch 84/200 |loss: 15.609700| train set 2.886x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 85
Epoch 85/200 |loss: 15.865553| train set 2.759x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 86
Epoch 86/200 |loss: 15.275639| train set 2.626x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 87
Epoch 87/200 |loss: 15.354631| train set 2.902x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 88
Epoch 88/200 |loss: 14.785017| train set 2.758x speedup, test set 1.696x speedup, val set 0.822x speedup, step: 89
Epoch 89/200 |loss: 14.496436| train set 2.629x speedup, test set 1.696x speedup, val set 0.972x speedup, step: 90
Epoch 90/200 |loss: 14.346088| train set 2.898x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 91
Epoch 91/200 |loss: 15.091016| train set 2.638x speedup, test set 1.696x speedup, val set 0.822x speedup, step: 92
Epoch 92/200 |loss: 14.807776| train set 2.887x speedup, test set 1.677x speedup, val set 0.822x speedup, step: 93
Epoch 93/200 |loss: 15.165059| train set 2.853x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 15.637334| train set 2.754x speedup, test set 1.696x speedup, val set 0.972x speedup, step: 95
Epoch 95/200 |loss: 14.749510| train set 2.901x speedup, test set 1.696x speedup, val set 0.822x speedup, step: 96
Epoch 96/200 |loss: 13.889287| train set 2.885x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 14.385386| train set 2.756x speedup, test set 1.684x speedup, val set 0.972x speedup, step: 98
Epoch 98/200 |loss: 14.579465| train set 2.888x speedup, test set 1.696x speedup, val set 0.972x speedup, step: 99
Epoch 99/200 |loss: 13.654243| train set 2.912x speedup, test set 1.769x speedup, val set 0.909x speedup, step: 100
Epoch 100/200 |loss: 13.832596| train set 2.746x speedup, test set 1.708x speedup, val set 0.822x speedup, step: 1
Epoch 101/200 |loss: 13.143694| train set 2.633x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 1
Epoch 102/200 |loss: 13.316808| train set 2.905x speedup, test set 1.760x speedup, val set 0.873x speedup, step: 2
Epoch 103/200 |loss: 13.145733| train set 2.898x speedup, test set 1.699x speedup, val set 0.934x speedup, step: 3
Epoch 104/200 |loss: 13.296420| train set 2.902x speedup, test set 1.699x speedup, val set 0.934x speedup, step: 4
Epoch 105/200 |loss: 13.773750| train set 2.689x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 5
Epoch 106/200 |loss: 14.039962| train set 2.906x speedup, test set 1.708x speedup, val set 0.822x speedup, step: 6
Epoch 107/200 |loss: 13.952675| train set 2.912x speedup, test set 1.699x speedup, val set 0.822x speedup, step: 7
Epoch 108/200 |loss: 12.748635| train set 2.763x speedup, test set 1.769x speedup, val set 1.000x speedup, step: 8
Epoch 109/200 |loss: 12.724299| train set 2.906x speedup, test set 2.656x speedup, val set 1.000x speedup, step: 9
Epoch 110/200 |loss: 12.867823| train set 2.901x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 10
Epoch 111/200 |loss: 12.887845| train set 2.907x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 11
Epoch 112/200 |loss: 12.959840| train set 2.630x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 1
Epoch 113/200 |loss: 12.641750| train set 2.917x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 2
Epoch 114/200 |loss: 12.029850| train set 2.906x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 3
Epoch 115/200 |loss: 12.171724| train set 2.628x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 1
Epoch 116/200 |loss: 12.950877| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 117/200 |loss: 12.301644| train set 2.976x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 3
Epoch 118/200 |loss: 11.714299| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 4
Epoch 119/200 |loss: 11.632632| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 5
Epoch 120/200 |loss: 11.861066| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 6
Epoch 121/200 |loss: 11.747576| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 122/200 |loss: 11.699754| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 8
Epoch 123/200 |loss: 11.714753| train set 2.810x speedup, test set 1.696x speedup, val set 0.860x speedup, step: 9
Epoch 124/200 |loss: 12.634725| train set 2.869x speedup, test set 1.757x speedup, val set 1.132x speedup, step: 1
Epoch 125/200 |loss: 14.486791| train set 2.631x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 2
Epoch 126/200 |loss: 12.070249| train set 2.923x speedup, test set 1.696x speedup, val set 0.860x speedup, step: 3
Epoch 127/200 |loss: 12.550312| train set 2.861x speedup, test set 1.769x speedup, val set 0.972x speedup, step: 4
Epoch 128/200 |loss: 13.955165| train set 2.908x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 5
Epoch 129/200 |loss: 12.651883| train set 2.628x speedup, test set 1.432x speedup, val set 1.043x speedup, step: 6
Epoch 130/200 |loss: 13.761998| train set 2.906x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 7
Epoch 131/200 |loss: 11.592275| train set 2.839x speedup, test set 1.769x speedup, val set 0.971x speedup, step: 8
Epoch 132/200 |loss: 12.127267| train set 2.936x speedup, test set 1.708x speedup, val set 0.813x speedup, step: 9
Epoch 133/200 |loss: 12.167053| train set 2.904x speedup, test set 1.696x speedup, val set 0.822x speedup, step: 10
Epoch 134/200 |loss: 12.396873| train set 2.646x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 11
Epoch 135/200 |loss: 11.785950| train set 2.907x speedup, test set 1.699x speedup, val set 0.873x speedup, step: 12
Epoch 136/200 |loss: 11.544520| train set 3.002x speedup, test set 1.705x speedup, val set 0.873x speedup, step: 13
Epoch 137/200 |loss: 12.239613| train set 2.777x speedup, test set 1.432x speedup, val set 1.000x speedup, step: 14
Epoch 138/200 |loss: 11.821406| train set 2.908x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 15
Epoch 139/200 |loss: 10.994882| train set 2.918x speedup, test set 1.696x speedup, val set 0.971x speedup, step: 16
Epoch 140/200 |loss: 11.792333| train set 2.920x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 17
Epoch 141/200 |loss: 11.635598| train set 2.908x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 18
Epoch 142/200 |loss: 11.567720| train set 2.908x speedup, test set 1.708x speedup, val set 0.971x speedup, step: 19
Epoch 143/200 |loss: 10.795030| train set 2.949x speedup, test set 1.708x speedup, val set 0.822x speedup, step: 20
Epoch 144/200 |loss: 11.370085| train set 2.779x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 21
Epoch 145/200 |loss: 12.069170| train set 2.779x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 22
Epoch 146/200 |loss: 10.781864| train set 2.949x speedup, test set 1.699x speedup, val set 0.875x speedup, step: 23
Epoch 147/200 |loss: 11.183248| train set 2.978x speedup, test set 1.696x speedup, val set 0.974x speedup, step: 24
Epoch 148/200 |loss: 11.875237| train set 2.908x speedup, test set 1.687x speedup, val set 0.875x speedup, step: 25
Epoch 149/200 |loss: 10.583945| train set 2.919x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 26
Epoch 150/200 |loss: 11.455416| train set 2.909x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 27
Epoch 151/200 |loss: 11.795568| train set 2.936x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 28
Epoch 152/200 |loss: 10.570007| train set 2.816x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 29
Epoch 153/200 |loss: 11.790990| train set 2.966x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 30
Epoch 154/200 |loss: 11.404853| train set 2.774x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 31
Epoch 155/200 |loss: 10.924291| train set 2.802x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 32
Epoch 156/200 |loss: 10.917082| train set 2.945x speedup, test set 1.744x speedup, val set 0.873x speedup, step: 33
Epoch 157/200 |loss: 10.715079| train set 2.908x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 34
Epoch 158/200 |loss: 10.126434| train set 2.960x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 35
Epoch 159/200 |loss: 10.723966| train set 2.960x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 36
Epoch 160/200 |loss: 9.775811| train set 3.000x speedup, test set 1.757x speedup, val set 0.873x speedup, step: 37
Epoch 161/200 |loss: 10.345762| train set 2.960x speedup, test set 1.757x speedup, val set 0.873x speedup, step: 38
Epoch 162/200 |loss: 9.925961| train set 2.960x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 39
Epoch 163/200 |loss: 9.907659| train set 2.908x speedup, test set 1.466x speedup, val set 0.873x speedup, step: 40
Epoch 164/200 |loss: 9.670690| train set 2.920x speedup, test set 1.757x speedup, val set 0.873x speedup, step: 41
Epoch 165/200 |loss: 9.807399| train set 2.909x speedup, test set 1.757x speedup, val set 0.873x speedup, step: 42
Epoch 166/200 |loss: 9.462434| train set 2.968x speedup, test set 1.466x speedup, val set 0.873x speedup, step: 43
Epoch 167/200 |loss: 9.527137| train set 2.960x speedup, test set 1.757x speedup, val set 0.873x speedup, step: 44
Epoch 168/200 |loss: 9.440520| train set 2.909x speedup, test set 2.807x speedup, val set 0.860x speedup, step: 45
Epoch 169/200 |loss: 9.425739| train set 3.011x speedup, test set 2.807x speedup, val set 0.860x speedup, step: 46
Epoch 170/200 |loss: 9.230710| train set 2.961x speedup, test set 1.466x speedup, val set 0.873x speedup, step: 47
Epoch 171/200 |loss: 9.243819| train set 3.011x speedup, test set 1.466x speedup, val set 0.875x speedup, step: 48
Epoch 172/200 |loss: 9.200397| train set 3.021x speedup, test set 2.807x speedup, val set 0.860x speedup, step: 49
Epoch 173/200 |loss: 9.149277| train set 3.022x speedup, test set 2.807x speedup, val set 0.813x speedup, step: 50
Epoch 174/200 |loss: 9.111354| train set 2.961x speedup, test set 1.466x speedup, val set 0.824x speedup, step: 51
Epoch 175/200 |loss: 9.082679| train set 2.950x speedup, test set 1.466x speedup, val set 0.873x speedup, step: 52
Epoch 176/200 |loss: 9.039832| train set 3.006x speedup, test set 1.757x speedup, val set 0.811x speedup, step: 53
Epoch 177/200 |loss: 9.236254| train set 2.950x speedup, test set 1.757x speedup, val set 0.971x speedup, step: 54
Epoch 178/200 |loss: 9.850946| train set 2.811x speedup, test set 1.424x speedup, val set 0.813x speedup, step: 55
Epoch 179/200 |loss: 10.734926| train set 2.909x speedup, test set 1.466x speedup, val set 0.971x speedup, step: 56
Epoch 180/200 |loss: 10.871025| train set 2.908x speedup, test set 1.466x speedup, val set 0.873x speedup, step: 57
Epoch 181/200 |loss: 9.898710| train set 2.862x speedup, test set 2.807x speedup, val set 0.860x speedup, step: 58
Epoch 182/200 |loss: 9.815521| train set 2.951x speedup, test set 2.807x speedup, val set 0.873x speedup, step: 59
Epoch 183/200 |loss: 9.763894| train set 2.951x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 60
Epoch 184/200 |loss: 9.733918| train set 2.986x speedup, test set 1.424x speedup, val set 0.860x speedup, step: 61
Epoch 185/200 |loss: 10.075727| train set 2.964x speedup, test set 2.783x speedup, val set 0.972x speedup, step: 62
Epoch 186/200 |loss: 9.505842| train set 3.021x speedup, test set 2.807x speedup, val set 0.873x speedup, step: 63
Epoch 187/200 |loss: 9.109738| train set 3.009x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 64
Epoch 188/200 |loss: 9.911078| train set 2.962x speedup, test set 1.757x speedup, val set 0.873x speedup, step: 65
Epoch 189/200 |loss: 9.064745| train set 2.963x speedup, test set 1.757x speedup, val set 0.873x speedup, step: 66
Epoch 190/200 |loss: 9.069668| train set 3.024x speedup, test set 1.466x speedup, val set 0.863x speedup, step: 67
Epoch 191/200 |loss: 9.252425| train set 2.962x speedup, test set 2.807x speedup, val set 0.875x speedup, step: 68
Epoch 192/200 |loss: 8.947634| train set 2.962x speedup, test set 2.807x speedup, val set 0.873x speedup, step: 69
Epoch 193/200 |loss: 8.939026| train set 2.979x speedup, test set 2.807x speedup, val set 0.860x speedup, step: 70
Epoch 194/200 |loss: 8.758842| train set 2.962x speedup, test set 2.807x speedup, val set 0.811x speedup, step: 71
Epoch 195/200 |loss: 8.686522| train set 2.951x speedup, test set 2.807x speedup, val set 0.873x speedup, step: 72
Epoch 196/200 |loss: 8.710844| train set 3.048x speedup, test set 2.807x speedup, val set 0.860x speedup, step: 73
Epoch 197/200 |loss: 8.695607| train set 2.986x speedup, test set 2.807x speedup, val set 0.860x speedup, step: 74
Epoch 198/200 |loss: 8.704806| train set 3.010x speedup, test set 1.466x speedup, val set 0.860x speedup, step: 75
Epoch 199/200 |loss: 8.900157| train set 2.982x speedup, test set 1.757x speedup, val set 0.860x speedup, step: 76
Training per epoch cost 0.347 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 66.316s, pg runtime 19.707s, speedup 0.297x
38, opt runtime 18.262s, model runtime 55.922s, pg runtime 18.262s, speedup 0.327x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 196, train speedup 3.048, test speedup 2.807, val speedup 0.860
best test speedup epoch: 168, train speedup 2.909, test speedup 2.807, val speedup 0.860
best validation speedup epoch: 124, train speedup 2.869, test speedup 1.757, val speedup 1.132
last model at epoch 199, train speedup 2.982, test speedup 1.757, val speedup 0.860
execution cost 0:03:09.453812
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.086168, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507730| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141745| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847769| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.567976| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255001| train set 1.012x speedup, test set 2.718x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.956709| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.655369| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.381226| train set 1.011x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.089945| train set 1.029x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.795233| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.498722| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.210342| train set 1.055x speedup, test set 2.526x speedup, val set 1.126x speedup, step: 16
Epoch 16/200 |loss: 25.954416| train set 1.055x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 17
Epoch 17/200 |loss: 25.791101| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 26.080839| train set 1.056x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 19
Epoch 19/200 |loss: 25.449781| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 20
Epoch 20/200 |loss: 25.076540| train set 1.064x speedup, test set 2.549x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 25.081064| train set 1.064x speedup, test set 2.546x speedup, val set 0.909x speedup, step: 22
Epoch 22/200 |loss: 24.547770| train set 1.070x speedup, test set 2.526x speedup, val set 0.909x speedup, step: 23
Epoch 23/200 |loss: 24.586395| train set 1.064x speedup, test set 2.603x speedup, val set 0.909x speedup, step: 24
Epoch 24/200 |loss: 24.322945| train set 1.071x speedup, test set 2.674x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.947109| train set 1.071x speedup, test set 2.603x speedup, val set 0.909x speedup, step: 26
Epoch 26/200 |loss: 24.000065| train set 1.070x speedup, test set 2.486x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.536268| train set 2.199x speedup, test set 2.490x speedup, val set 0.939x speedup, step: 28
Epoch 28/200 |loss: 23.422249| train set 1.062x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.287043| train set 2.027x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 30
Epoch 30/200 |loss: 22.813307| train set 2.206x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.772196| train set 1.062x speedup, test set 2.472x speedup, val set 0.909x speedup, step: 32
Epoch 32/200 |loss: 22.638355| train set 2.230x speedup, test set 2.497x speedup, val set 0.909x speedup, step: 33
Epoch 33/200 |loss: 22.232243| train set 1.999x speedup, test set 2.479x speedup, val set 0.909x speedup, step: 34
Epoch 34/200 |loss: 22.386896| train set 2.181x speedup, test set 2.483x speedup, val set 0.909x speedup, step: 35
Epoch 35/200 |loss: 22.346790| train set 2.172x speedup, test set 1.612x speedup, val set 0.909x speedup, step: 36
Epoch 36/200 |loss: 21.714952| train set 2.230x speedup, test set 1.613x speedup, val set 0.909x speedup, step: 37
Epoch 37/200 |loss: 21.545876| train set 2.181x speedup, test set 1.613x speedup, val set 0.983x speedup, step: 38
Epoch 38/200 |loss: 21.539927| train set 2.209x speedup, test set 1.613x speedup, val set 0.909x speedup, step: 39
Epoch 39/200 |loss: 21.543833| train set 2.210x speedup, test set 1.613x speedup, val set 0.909x speedup, step: 40
Epoch 40/200 |loss: 20.943796| train set 2.170x speedup, test set 1.611x speedup, val set 0.909x speedup, step: 41
Epoch 41/200 |loss: 20.968985| train set 2.231x speedup, test set 1.619x speedup, val set 0.909x speedup, step: 42
Epoch 42/200 |loss: 21.238691| train set 2.217x speedup, test set 1.618x speedup, val set 0.909x speedup, step: 43
Epoch 43/200 |loss: 20.245409| train set 2.256x speedup, test set 1.628x speedup, val set 0.913x speedup, step: 44
Epoch 44/200 |loss: 20.721758| train set 2.205x speedup, test set 1.613x speedup, val set 0.985x speedup, step: 45
Epoch 45/200 |loss: 21.016035| train set 2.191x speedup, test set 1.689x speedup, val set 0.948x speedup, step: 46
Epoch 46/200 |loss: 21.351936| train set 2.124x speedup, test set 1.628x speedup, val set 0.985x speedup, step: 47
Epoch 47/200 |loss: 21.193905| train set 2.428x speedup, test set 1.631x speedup, val set 0.833x speedup, step: 48
Epoch 48/200 |loss: 21.209606| train set 2.285x speedup, test set 1.630x speedup, val set 0.948x speedup, step: 49
Epoch 49/200 |loss: 19.717524| train set 2.158x speedup, test set 1.630x speedup, val set 0.983x speedup, step: 50
Epoch 50/200 |loss: 20.699877| train set 2.271x speedup, test set 1.630x speedup, val set 0.983x speedup, step: 51
Epoch 51/200 |loss: 19.593332| train set 2.460x speedup, test set 1.630x speedup, val set 0.948x speedup, step: 52
Epoch 52/200 |loss: 19.929499| train set 2.354x speedup, test set 1.630x speedup, val set 0.873x speedup, step: 53
Epoch 53/200 |loss: 19.372658| train set 2.196x speedup, test set 1.630x speedup, val set 0.983x speedup, step: 54
Epoch 54/200 |loss: 19.320276| train set 2.270x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 55
Epoch 55/200 |loss: 19.350386| train set 2.460x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 56
Epoch 56/200 |loss: 18.700872| train set 2.295x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 18.989594| train set 2.338x speedup, test set 1.630x speedup, val set 0.873x speedup, step: 58
Epoch 58/200 |loss: 18.444365| train set 2.271x speedup, test set 1.630x speedup, val set 1.039x speedup, step: 59
Epoch 59/200 |loss: 18.501034| train set 2.356x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 18.148218| train set 2.463x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 61
Epoch 61/200 |loss: 17.933451| train set 2.463x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 62
Epoch 62/200 |loss: 17.837351| train set 2.350x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 63
Epoch 63/200 |loss: 17.802860| train set 2.357x speedup, test set 1.689x speedup, val set 0.972x speedup, step: 64
Epoch 64/200 |loss: 17.575243| train set 2.567x speedup, test set 1.674x speedup, val set 0.873x speedup, step: 65
Epoch 65/200 |loss: 17.573694| train set 2.264x speedup, test set 1.630x speedup, val set 0.971x speedup, step: 66
Epoch 66/200 |loss: 18.039452| train set 2.865x speedup, test set 1.674x speedup, val set 1.132x speedup, step: 67
Epoch 67/200 |loss: 18.936155| train set 2.275x speedup, test set 1.630x speedup, val set 1.042x speedup, step: 68
Epoch 68/200 |loss: 17.703526| train set 2.395x speedup, test set 1.630x speedup, val set 0.824x speedup, step: 69
Epoch 69/200 |loss: 18.413568| train set 2.884x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 70
Epoch 70/200 |loss: 17.463327| train set 2.357x speedup, test set 1.674x speedup, val set 0.873x speedup, step: 71
Epoch 71/200 |loss: 17.030935| train set 2.360x speedup, test set 1.689x speedup, val set 1.042x speedup, step: 72
Epoch 72/200 |loss: 17.650709| train set 2.466x speedup, test set 1.689x speedup, val set 0.822x speedup, step: 73
Epoch 73/200 |loss: 16.436605| train set 2.895x speedup, test set 1.663x speedup, val set 0.971x speedup, step: 74
Epoch 74/200 |loss: 17.083744| train set 2.755x speedup, test set 1.677x speedup, val set 0.822x speedup, step: 75
Epoch 75/200 |loss: 16.758499| train set 2.278x speedup, test set 1.630x speedup, val set 0.971x speedup, step: 76
Epoch 76/200 |loss: 16.753445| train set 2.458x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 77
Epoch 77/200 |loss: 16.199249| train set 2.897x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 78
Epoch 78/200 |loss: 16.212084| train set 2.462x speedup, test set 1.696x speedup, val set 0.822x speedup, step: 79
Epoch 79/200 |loss: 16.450235| train set 2.887x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 80
Epoch 80/200 |loss: 16.389408| train set 2.362x speedup, test set 1.674x speedup, val set 1.000x speedup, step: 81
Epoch 81/200 |loss: 16.200272| train set 2.754x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 82
Epoch 82/200 |loss: 15.598332| train set 2.896x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 83
Epoch 83/200 |loss: 15.507843| train set 2.662x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 84
Epoch 84/200 |loss: 15.577796| train set 2.887x speedup, test set 1.708x speedup, val set 1.003x speedup, step: 85
Epoch 85/200 |loss: 16.319122| train set 2.758x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 86
Epoch 86/200 |loss: 14.893690| train set 2.908x speedup, test set 1.681x speedup, val set 0.873x speedup, step: 87
Epoch 87/200 |loss: 15.260692| train set 2.898x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 88
Epoch 88/200 |loss: 15.810102| train set 2.626x speedup, test set 1.708x speedup, val set 0.937x speedup, step: 89
Epoch 89/200 |loss: 14.919355| train set 2.890x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 15.102986| train set 2.769x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 91
Epoch 91/200 |loss: 14.730466| train set 2.635x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 14.856380| train set 2.901x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 14.571668| train set 2.629x speedup, test set 1.708x speedup, val set 1.003x speedup, step: 94
Epoch 94/200 |loss: 14.231544| train set 2.887x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 13.959390| train set 2.898x speedup, test set 1.693x speedup, val set 1.132x speedup, step: 96
Epoch 96/200 |loss: 14.064941| train set 2.768x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 97
Epoch 97/200 |loss: 14.291436| train set 2.749x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 14.747408| train set 2.746x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 13.742656| train set 2.878x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 100
Epoch 100/200 |loss: 13.894032| train set 2.906x speedup, test set 1.690x speedup, val set 0.924x speedup, step: 1
Epoch 101/200 |loss: 13.430295| train set 2.626x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 1
Epoch 102/200 |loss: 13.292316| train set 2.902x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 1
Epoch 103/200 |loss: 13.308029| train set 2.828x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 1
Epoch 104/200 |loss: 14.065639| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 105/200 |loss: 15.797446| train set 2.630x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 106/200 |loss: 13.414813| train set 2.815x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 107/200 |loss: 14.194063| train set 2.936x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 108/200 |loss: 14.938197| train set 2.630x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 109/200 |loss: 13.829000| train set 2.894x speedup, test set 1.673x speedup, val set 0.814x speedup, step: 2
Epoch 110/200 |loss: 14.249897| train set 2.902x speedup, test set 1.681x speedup, val set 0.900x speedup, step: 3
Epoch 111/200 |loss: 13.867889| train set 2.627x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 1
Epoch 112/200 |loss: 14.445726| train set 2.936x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 2
Epoch 113/200 |loss: 13.498992| train set 2.911x speedup, test set 1.673x speedup, val set 0.971x speedup, step: 3
Epoch 114/200 |loss: 13.345818| train set 2.479x speedup, test set 1.407x speedup, val set 0.873x speedup, step: 4
Epoch 115/200 |loss: 13.460607| train set 2.645x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 5
Epoch 116/200 |loss: 12.959687| train set 2.918x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 6
Epoch 117/200 |loss: 12.506064| train set 2.826x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 118/200 |loss: 12.697245| train set 2.902x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 8
Epoch 119/200 |loss: 12.444536| train set 2.764x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 9
Epoch 120/200 |loss: 12.341870| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 10
Epoch 121/200 |loss: 12.029996| train set 2.913x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 11
Epoch 122/200 |loss: 12.077082| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 12
Epoch 123/200 |loss: 11.690815| train set 2.892x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 13
Epoch 124/200 |loss: 11.673527| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 14
Epoch 125/200 |loss: 11.615985| train set 2.958x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 15
Epoch 126/200 |loss: 12.344748| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 16
Epoch 127/200 |loss: 14.475911| train set 2.638x speedup, test set 1.418x speedup, val set 1.043x speedup, step: 1
Epoch 128/200 |loss: 12.763101| train set 2.917x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 2
Epoch 129/200 |loss: 11.430025| train set 2.908x speedup, test set 1.696x speedup, val set 0.900x speedup, step: 3
Epoch 130/200 |loss: 11.970208| train set 2.679x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 4
Epoch 131/200 |loss: 12.412172| train set 2.907x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 5
Epoch 132/200 |loss: 11.425511| train set 2.906x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 6
Epoch 133/200 |loss: 11.502314| train set 2.918x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 134/200 |loss: 11.816648| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 8
Epoch 135/200 |loss: 12.060357| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 9
Epoch 136/200 |loss: 10.996814| train set 2.968x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 10
Epoch 137/200 |loss: 12.044882| train set 2.924x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 11
Epoch 138/200 |loss: 11.665070| train set 2.922x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 12
Epoch 139/200 |loss: 11.439506| train set 2.915x speedup, test set 1.687x speedup, val set 1.003x speedup, step: 13
Epoch 140/200 |loss: 11.595540| train set 2.908x speedup, test set 1.747x speedup, val set 0.873x speedup, step: 14
Epoch 141/200 |loss: 11.484357| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 15
Epoch 142/200 |loss: 11.298639| train set 2.860x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 143/200 |loss: 11.260190| train set 2.904x speedup, test set 1.687x speedup, val set 0.971x speedup, step: 2
Epoch 144/200 |loss: 11.211434| train set 2.908x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 3
Epoch 145/200 |loss: 10.446112| train set 2.908x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 1
Epoch 146/200 |loss: 10.800168| train set 2.924x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 147/200 |loss: 10.426187| train set 2.962x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 3
Epoch 148/200 |loss: 10.586576| train set 2.919x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 4
Epoch 149/200 |loss: 10.111462| train set 2.909x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 5
Epoch 150/200 |loss: 10.375691| train set 2.978x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 6
Epoch 151/200 |loss: 10.049503| train set 2.925x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 7
Epoch 152/200 |loss: 9.948811| train set 2.909x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 8
Epoch 153/200 |loss: 9.857548| train set 2.909x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 9
Epoch 154/200 |loss: 9.776775| train set 2.949x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 10
Epoch 155/200 |loss: 10.047731| train set 2.998x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 11
Epoch 156/200 |loss: 10.312819| train set 2.937x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 12
Epoch 157/200 |loss: 11.136233| train set 2.909x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 13
Epoch 158/200 |loss: 12.644203| train set 2.908x speedup, test set 1.687x speedup, val set 0.875x speedup, step: 14
Epoch 159/200 |loss: 11.345288| train set 2.909x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 15
Epoch 160/200 |loss: 10.651265| train set 2.943x speedup, test set 1.687x speedup, val set 0.875x speedup, step: 16
Epoch 161/200 |loss: 10.269025| train set 2.920x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 17
Epoch 162/200 |loss: 10.715187| train set 2.909x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 18
Epoch 163/200 |loss: 10.766217| train set 2.963x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 19
Epoch 164/200 |loss: 10.041295| train set 2.907x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 20
Epoch 165/200 |loss: 10.839314| train set 3.004x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 21
Epoch 166/200 |loss: 10.702042| train set 2.925x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 22
Epoch 167/200 |loss: 10.014894| train set 2.938x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 23
Epoch 168/200 |loss: 10.679569| train set 2.912x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 24
Epoch 169/200 |loss: 10.298223| train set 2.984x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 25
Epoch 170/200 |loss: 9.546960| train set 2.950x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 26
Epoch 171/200 |loss: 10.324938| train set 2.968x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 27
Epoch 172/200 |loss: 9.705045| train set 2.909x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 28
Epoch 173/200 |loss: 9.473277| train set 3.010x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 29
Epoch 174/200 |loss: 9.846046| train set 3.028x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 30
Epoch 175/200 |loss: 9.332145| train set 2.911x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 31
Epoch 176/200 |loss: 9.421796| train set 3.022x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 32
Epoch 177/200 |loss: 9.523489| train set 3.028x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 33
Epoch 178/200 |loss: 9.366845| train set 3.029x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 34
Epoch 179/200 |loss: 9.042979| train set 2.950x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 35
Epoch 180/200 |loss: 9.481760| train set 2.984x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 36
Epoch 181/200 |loss: 9.541899| train set 2.967x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 37
Epoch 182/200 |loss: 8.938719| train set 3.012x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 38
Epoch 183/200 |loss: 9.576894| train set 2.970x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 39
Epoch 184/200 |loss: 9.733601| train set 3.028x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 1
Epoch 185/200 |loss: 9.175009| train set 2.938x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 2
Epoch 186/200 |loss: 9.979595| train set 2.948x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 3
Epoch 187/200 |loss: 10.676723| train set 2.925x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 4
Epoch 188/200 |loss: 10.075353| train set 2.950x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 5
Epoch 189/200 |loss: 10.560118| train set 2.981x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 6
Epoch 190/200 |loss: 9.654868| train set 2.964x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 7
Epoch 191/200 |loss: 9.841390| train set 3.011x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 8
Epoch 192/200 |loss: 10.078809| train set 2.967x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 9
Epoch 193/200 |loss: 9.238657| train set 2.946x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 10
Epoch 194/200 |loss: 9.531133| train set 3.017x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 11
Epoch 195/200 |loss: 9.213955| train set 3.021x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 12
Epoch 196/200 |loss: 9.286885| train set 3.028x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 13
Epoch 197/200 |loss: 8.926663| train set 3.048x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 14
Epoch 198/200 |loss: 9.028858| train set 2.950x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 15
Epoch 199/200 |loss: 9.038936| train set 3.011x speedup, test set 1.687x speedup, val set 0.835x speedup, step: 16
Training per epoch cost 0.334 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 197, train speedup 3.048, test speedup 1.687, val speedup 1.043
best test speedup epoch: 3, train speedup 1.006, test speedup 2.746, val speedup 0.988
best validation speedup epoch: 184, train speedup 3.028, test speedup 1.687, val speedup 1.046
last model at epoch 199, train speedup 3.011, test speedup 1.687, val speedup 0.835
execution cost 0:03:03.233847
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.042162, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507730| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141750| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.848000| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568964| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255947| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958145| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657175| train set 1.010x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.385122| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.093426| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.801237| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.507315| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.217375| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.955564| train set 1.054x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.689760| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.588430| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 19
Epoch 19/200 |loss: 25.949238| train set 1.055x speedup, test set 2.549x speedup, val set 1.027x speedup, step: 20
Epoch 20/200 |loss: 25.146219| train set 1.066x speedup, test set 2.529x speedup, val set 1.027x speedup, step: 21
Epoch 21/200 |loss: 24.882999| train set 1.064x speedup, test set 2.493x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.900391| train set 1.070x speedup, test set 2.464x speedup, val set 1.027x speedup, step: 23
Epoch 23/200 |loss: 24.357073| train set 1.071x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.484812| train set 1.070x speedup, test set 2.526x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.990671| train set 1.850x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.886909| train set 1.071x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.629402| train set 1.058x speedup, test set 2.460x speedup, val set 0.909x speedup, step: 28
Epoch 28/200 |loss: 23.341810| train set 2.205x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.192722| train set 2.027x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 22.852901| train set 1.062x speedup, test set 2.475x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.693193| train set 2.229x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.559923| train set 2.000x speedup, test set 2.472x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 22.228502| train set 2.210x speedup, test set 2.451x speedup, val set 0.897x speedup, step: 34
Epoch 34/200 |loss: 21.910984| train set 2.230x speedup, test set 1.610x speedup, val set 0.957x speedup, step: 35
Epoch 35/200 |loss: 21.815525| train set 1.875x speedup, test set 1.629x speedup, val set 0.968x speedup, step: 36
Epoch 36/200 |loss: 21.829519| train set 2.230x speedup, test set 1.613x speedup, val set 0.961x speedup, step: 37
Epoch 37/200 |loss: 21.636360| train set 2.217x speedup, test set 1.612x speedup, val set 1.039x speedup, step: 38
Epoch 38/200 |loss: 21.291708| train set 2.238x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 39
Epoch 39/200 |loss: 20.975096| train set 2.264x speedup, test set 1.613x speedup, val set 1.000x speedup, step: 40
Epoch 40/200 |loss: 21.424387| train set 2.205x speedup, test set 1.629x speedup, val set 1.042x speedup, step: 41
Epoch 41/200 |loss: 22.510868| train set 2.218x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 42
Epoch 42/200 |loss: 20.965178| train set 2.264x speedup, test set 1.678x speedup, val set 0.924x speedup, step: 43
Epoch 43/200 |loss: 21.162416| train set 2.229x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 44
Epoch 44/200 |loss: 20.306330| train set 2.243x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 45
Epoch 45/200 |loss: 20.608765| train set 2.231x speedup, test set 1.631x speedup, val set 1.043x speedup, step: 46
Epoch 46/200 |loss: 20.000906| train set 2.344x speedup, test set 1.629x speedup, val set 1.000x speedup, step: 47
Epoch 47/200 |loss: 20.106306| train set 2.212x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 48
Epoch 48/200 |loss: 19.766176| train set 2.239x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 49
Epoch 49/200 |loss: 19.488071| train set 2.311x speedup, test set 1.637x speedup, val set 0.961x speedup, step: 50
Epoch 50/200 |loss: 19.372694| train set 2.302x speedup, test set 1.628x speedup, val set 0.873x speedup, step: 51
Epoch 51/200 |loss: 19.108877| train set 2.324x speedup, test set 1.628x speedup, val set 1.043x speedup, step: 52
Epoch 52/200 |loss: 18.995113| train set 2.220x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 53
Epoch 53/200 |loss: 18.918589| train set 2.460x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 54
Epoch 54/200 |loss: 19.300432| train set 2.150x speedup, test set 1.627x speedup, val set 0.971x speedup, step: 55
Epoch 55/200 |loss: 21.044327| train set 2.238x speedup, test set 1.619x speedup, val set 0.873x speedup, step: 56
Epoch 56/200 |loss: 20.944584| train set 2.356x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 57
Epoch 57/200 |loss: 19.431606| train set 2.219x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 58
Epoch 58/200 |loss: 21.475462| train set 2.243x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 18.823816| train set 2.571x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 60
Epoch 60/200 |loss: 20.125177| train set 2.297x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 61
Epoch 61/200 |loss: 18.339085| train set 2.273x speedup, test set 1.626x speedup, val set 1.039x speedup, step: 62
Epoch 62/200 |loss: 19.461782| train set 2.270x speedup, test set 1.626x speedup, val set 1.039x speedup, step: 63
Epoch 63/200 |loss: 18.367062| train set 2.576x speedup, test set 1.684x speedup, val set 0.873x speedup, step: 64
Epoch 64/200 |loss: 18.765469| train set 2.290x speedup, test set 1.618x speedup, val set 0.822x speedup, step: 65
Epoch 65/200 |loss: 18.055630| train set 2.305x speedup, test set 1.628x speedup, val set 0.968x speedup, step: 66
Epoch 66/200 |loss: 18.165510| train set 2.221x speedup, test set 1.626x speedup, val set 1.043x speedup, step: 67
Epoch 67/200 |loss: 17.711647| train set 2.303x speedup, test set 1.684x speedup, val set 1.043x speedup, step: 68
Epoch 68/200 |loss: 17.931183| train set 2.305x speedup, test set 1.637x speedup, val set 0.822x speedup, step: 69
Epoch 69/200 |loss: 17.238520| train set 2.305x speedup, test set 1.637x speedup, val set 0.972x speedup, step: 70
Epoch 70/200 |loss: 17.484751| train set 2.463x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 71
Epoch 71/200 |loss: 17.012894| train set 2.362x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 72
Epoch 72/200 |loss: 17.048990| train set 2.306x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 73
Epoch 73/200 |loss: 16.718029| train set 2.308x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 74
Epoch 74/200 |loss: 16.587517| train set 2.768x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 75
Epoch 75/200 |loss: 16.446537| train set 2.765x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 76
Epoch 76/200 |loss: 16.299154| train set 2.276x speedup, test set 1.687x speedup, val set 1.039x speedup, step: 77
Epoch 77/200 |loss: 16.643284| train set 2.379x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 78
Epoch 78/200 |loss: 17.086220| train set 2.359x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 79
Epoch 79/200 |loss: 16.780945| train set 2.757x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 80
Epoch 80/200 |loss: 16.133881| train set 2.864x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 81
Epoch 81/200 |loss: 15.890858| train set 2.468x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 82
Epoch 82/200 |loss: 16.374794| train set 2.561x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 83
Epoch 83/200 |loss: 15.702140| train set 2.758x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 84
Epoch 84/200 |loss: 15.273171| train set 2.768x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 85
Epoch 85/200 |loss: 15.687696| train set 2.552x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 86
Epoch 86/200 |loss: 15.288815| train set 2.628x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 87
Epoch 87/200 |loss: 14.961199| train set 2.758x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 88
Epoch 88/200 |loss: 15.114368| train set 2.901x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 89
Epoch 89/200 |loss: 14.655526| train set 2.759x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 90
Epoch 90/200 |loss: 14.487010| train set 2.759x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 91
Epoch 91/200 |loss: 14.662123| train set 2.772x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 92
Epoch 92/200 |loss: 14.333635| train set 2.570x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 93
Epoch 93/200 |loss: 14.875887| train set 2.900x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 94
Epoch 94/200 |loss: 15.493175| train set 2.558x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 95
Epoch 95/200 |loss: 15.480556| train set 2.900x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 96
Epoch 96/200 |loss: 14.168662| train set 2.901x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 97
Epoch 97/200 |loss: 13.771016| train set 2.570x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 98
Epoch 98/200 |loss: 14.515204| train set 2.772x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 99
Epoch 99/200 |loss: 14.664951| train set 2.563x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 100
Epoch 100/200 |loss: 13.471442| train set 2.571x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 1
Epoch 101/200 |loss: 14.252601| train set 2.914x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 1
Epoch 102/200 |loss: 14.453773| train set 2.629x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 103/200 |loss: 13.058814| train set 2.554x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 2
Epoch 104/200 |loss: 13.973589| train set 2.902x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 3
Epoch 105/200 |loss: 13.572969| train set 2.917x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 4
Epoch 106/200 |loss: 13.910491| train set 2.262x speedup, test set 1.644x speedup, val set 0.953x speedup, step: 5
Epoch 107/200 |loss: 16.862734| train set 2.878x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 6
Epoch 108/200 |loss: 14.741742| train set 2.905x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 109/200 |loss: 14.499086| train set 2.745x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 8
Epoch 110/200 |loss: 14.883986| train set 2.760x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 9
Epoch 111/200 |loss: 13.658667| train set 2.867x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 10
Epoch 112/200 |loss: 14.387955| train set 2.631x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 11
Epoch 113/200 |loss: 13.324853| train set 2.760x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 12
Epoch 114/200 |loss: 13.882565| train set 2.903x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 13
Epoch 115/200 |loss: 13.705523| train set 2.679x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 14
Epoch 116/200 |loss: 13.965558| train set 2.903x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 15
Epoch 117/200 |loss: 13.137795| train set 2.903x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 16
Epoch 118/200 |loss: 12.781555| train set 2.773x speedup, test set 1.704x speedup, val set 0.972x speedup, step: 17
Epoch 119/200 |loss: 13.040994| train set 2.773x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 18
Epoch 120/200 |loss: 12.430666| train set 2.591x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 19
Epoch 121/200 |loss: 12.738214| train set 2.903x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 20
Epoch 122/200 |loss: 11.930454| train set 2.907x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 21
Epoch 123/200 |loss: 12.476690| train set 2.917x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 22
Epoch 124/200 |loss: 11.994997| train set 2.906x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 23
Epoch 125/200 |loss: 12.348104| train set 2.751x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 24
Epoch 126/200 |loss: 12.612239| train set 2.907x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 25
Epoch 127/200 |loss: 12.016112| train set 2.917x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 26
Epoch 128/200 |loss: 11.577625| train set 2.903x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 27
Epoch 129/200 |loss: 11.343220| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 28
Epoch 130/200 |loss: 11.574019| train set 2.917x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 29
Epoch 131/200 |loss: 11.512276| train set 2.902x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 30
Epoch 132/200 |loss: 11.509427| train set 2.913x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 31
Epoch 133/200 |loss: 11.404924| train set 2.903x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 32
Epoch 134/200 |loss: 10.844853| train set 2.907x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 33
Epoch 135/200 |loss: 10.736851| train set 2.907x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 34
Epoch 136/200 |loss: 10.778271| train set 2.924x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 35
Epoch 137/200 |loss: 10.828173| train set 2.907x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 36
Epoch 138/200 |loss: 11.276201| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 37
Epoch 139/200 |loss: 13.135409| train set 2.786x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 38
Epoch 140/200 |loss: 11.483433| train set 2.860x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 39
Epoch 141/200 |loss: 10.720769| train set 2.924x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 40
Epoch 142/200 |loss: 11.251448| train set 2.787x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 41
Epoch 143/200 |loss: 11.539875| train set 2.922x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 42
Epoch 144/200 |loss: 10.352729| train set 2.870x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 43
Epoch 145/200 |loss: 11.116493| train set 2.657x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 44
Epoch 146/200 |loss: 11.802878| train set 2.904x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 45
Epoch 147/200 |loss: 10.597770| train set 2.969x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 46
Epoch 148/200 |loss: 11.401282| train set 2.728x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 149/200 |loss: 11.669883| train set 2.660x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 1
Epoch 150/200 |loss: 12.865102| train set 2.921x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 2
Epoch 151/200 |loss: 10.710310| train set 2.959x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 3
Epoch 152/200 |loss: 12.976557| train set 2.938x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 1
Epoch 153/200 |loss: 12.031108| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 154/200 |loss: 11.852102| train set 2.708x speedup, test set 1.687x speedup, val set 0.860x speedup, step: 3
Epoch 155/200 |loss: 11.974618| train set 2.741x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 4
Epoch 156/200 |loss: 11.273023| train set 2.924x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 5
Epoch 157/200 |loss: 10.918893| train set 2.904x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 158/200 |loss: 11.001607| train set 2.919x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 159/200 |loss: 10.520658| train set 2.927x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 2
Epoch 160/200 |loss: 11.041495| train set 2.831x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 1
Epoch 161/200 |loss: 10.431580| train set 2.771x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 2
Epoch 162/200 |loss: 10.575849| train set 2.919x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 3
Epoch 163/200 |loss: 10.001696| train set 2.872x speedup, test set 1.693x speedup, val set 1.043x speedup, step: 1
Epoch 164/200 |loss: 10.260319| train set 2.924x speedup, test set 1.693x speedup, val set 1.043x speedup, step: 1
Epoch 165/200 |loss: 9.819880| train set 2.908x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 2
Epoch 166/200 |loss: 10.163213| train set 2.908x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 167/200 |loss: 9.666114| train set 2.796x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 168/200 |loss: 9.811123| train set 2.926x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 2
Epoch 169/200 |loss: 9.633637| train set 2.960x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 3
Epoch 170/200 |loss: 9.606717| train set 2.950x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 171/200 |loss: 9.472111| train set 2.966x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 172/200 |loss: 9.361869| train set 3.007x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 173/200 |loss: 9.461836| train set 2.908x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 174/200 |loss: 9.464264| train set 2.660x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 175/200 |loss: 9.487622| train set 2.920x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 176/200 |loss: 9.359329| train set 2.983x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 177/200 |loss: 9.349223| train set 2.952x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 178/200 |loss: 9.555264| train set 2.928x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 179/200 |loss: 10.281284| train set 2.962x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 180/200 |loss: 9.588799| train set 2.984x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 181/200 |loss: 9.274422| train set 2.963x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 182/200 |loss: 9.000913| train set 2.884x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 183/200 |loss: 9.112922| train set 2.928x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 184/200 |loss: 9.235605| train set 2.963x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 185/200 |loss: 8.879105| train set 3.025x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 186/200 |loss: 8.802204| train set 2.969x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 187/200 |loss: 8.949295| train set 2.846x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 188/200 |loss: 9.163393| train set 2.952x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 189/200 |loss: 9.270839| train set 3.045x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 190/200 |loss: 9.020900| train set 2.969x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 191/200 |loss: 8.608067| train set 2.964x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 192/200 |loss: 8.585837| train set 2.881x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 193/200 |loss: 8.734601| train set 2.970x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 194/200 |loss: 8.888769| train set 3.026x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 195/200 |loss: 8.773261| train set 2.928x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 196/200 |loss: 8.697762| train set 2.952x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 197/200 |loss: 8.601977| train set 2.982x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 198/200 |loss: 8.983190| train set 2.950x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 199/200 |loss: 9.633948| train set 3.001x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Training per epoch cost 0.333 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 189, train speedup 3.045, test speedup 1.704, val speedup 1.043
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 199, train speedup 3.001, test speedup 1.687, val speedup 1.043
last model at epoch 199, train speedup 3.001, test speedup 1.687, val speedup 1.043
execution cost 0:03:06.391707
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.104371, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507721| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141737| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847996| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568949| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255934| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.957909| train set 1.012x speedup, test set 2.692x speedup, val set 0.975x speedup, step: 10
Epoch 10/200 |loss: 27.655640| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.380716| train set 1.012x speedup, test set 2.692x speedup, val set 0.975x speedup, step: 12
Epoch 12/200 |loss: 27.091278| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.800682| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.504248| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.216553| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.950447| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.691124| train set 1.055x speedup, test set 2.526x speedup, val set 1.126x speedup, step: 18
Epoch 18/200 |loss: 25.656528| train set 1.055x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 19
Epoch 19/200 |loss: 25.906986| train set 1.066x speedup, test set 2.549x speedup, val set 1.027x speedup, step: 20
Epoch 20/200 |loss: 25.216730| train set 1.064x speedup, test set 2.529x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 24.972656| train set 1.070x speedup, test set 2.509x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.932924| train set 1.070x speedup, test set 2.493x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.341373| train set 1.064x speedup, test set 2.529x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.482418| train set 1.070x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.908607| train set 1.071x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 24.030602| train set 1.071x speedup, test set 1.616x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 23.557165| train set 2.025x speedup, test set 1.616x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.452499| train set 1.071x speedup, test set 1.616x speedup, val set 0.957x speedup, step: 29
Epoch 29/200 |loss: 23.215605| train set 2.028x speedup, test set 1.610x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 22.853241| train set 2.204x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.794844| train set 1.128x speedup, test set 2.493x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.578993| train set 2.230x speedup, test set 1.628x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 22.231781| train set 1.819x speedup, test set 1.627x speedup, val set 1.039x speedup, step: 34
Epoch 34/200 |loss: 22.458639| train set 2.144x speedup, test set 1.616x speedup, val set 0.909x speedup, step: 35
Epoch 35/200 |loss: 22.410160| train set 2.000x speedup, test set 1.631x speedup, val set 0.983x speedup, step: 36
Epoch 36/200 |loss: 21.791359| train set 2.209x speedup, test set 1.632x speedup, val set 0.957x speedup, step: 37
Epoch 37/200 |loss: 21.757860| train set 2.181x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 38
Epoch 38/200 |loss: 21.596548| train set 2.230x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 39
Epoch 39/200 |loss: 21.282810| train set 2.219x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 40
Epoch 40/200 |loss: 21.153578| train set 2.232x speedup, test set 1.621x speedup, val set 1.043x speedup, step: 41
Epoch 41/200 |loss: 20.888542| train set 2.157x speedup, test set 1.621x speedup, val set 1.039x speedup, step: 42
Epoch 42/200 |loss: 20.736593| train set 2.239x speedup, test set 1.621x speedup, val set 1.039x speedup, step: 43
Epoch 43/200 |loss: 20.275442| train set 2.388x speedup, test set 1.621x speedup, val set 0.924x speedup, step: 44
Epoch 44/200 |loss: 20.487165| train set 2.134x speedup, test set 1.619x speedup, val set 1.042x speedup, step: 45
Epoch 45/200 |loss: 20.656790| train set 2.269x speedup, test set 1.679x speedup, val set 0.924x speedup, step: 46
Epoch 46/200 |loss: 20.910608| train set 2.256x speedup, test set 1.621x speedup, val set 1.039x speedup, step: 47
Epoch 47/200 |loss: 20.432676| train set 2.244x speedup, test set 1.621x speedup, val set 1.039x speedup, step: 48
Epoch 48/200 |loss: 19.830683| train set 2.251x speedup, test set 1.678x speedup, val set 1.000x speedup, step: 49
Epoch 49/200 |loss: 19.818176| train set 2.238x speedup, test set 1.620x speedup, val set 1.039x speedup, step: 50
Epoch 50/200 |loss: 19.573734| train set 2.354x speedup, test set 1.620x speedup, val set 1.043x speedup, step: 51
Epoch 51/200 |loss: 19.665104| train set 2.260x speedup, test set 1.620x speedup, val set 1.039x speedup, step: 52
Epoch 52/200 |loss: 19.192944| train set 2.270x speedup, test set 1.620x speedup, val set 1.039x speedup, step: 53
Epoch 53/200 |loss: 18.862972| train set 2.322x speedup, test set 1.678x speedup, val set 0.873x speedup, step: 54
Epoch 54/200 |loss: 18.874258| train set 2.294x speedup, test set 1.620x speedup, val set 1.043x speedup, step: 55
Epoch 55/200 |loss: 18.627588| train set 2.270x speedup, test set 1.620x speedup, val set 1.039x speedup, step: 56
Epoch 56/200 |loss: 18.795483| train set 2.305x speedup, test set 1.620x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 18.088297| train set 2.565x speedup, test set 1.678x speedup, val set 0.873x speedup, step: 58
Epoch 58/200 |loss: 18.048054| train set 2.357x speedup, test set 1.678x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 17.694279| train set 2.349x speedup, test set 1.678x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 17.788471| train set 2.460x speedup, test set 1.678x speedup, val set 1.043x speedup, step: 61
Epoch 61/200 |loss: 17.759031| train set 2.375x speedup, test set 1.664x speedup, val set 1.000x speedup, step: 62
Epoch 62/200 |loss: 18.229343| train set 2.354x speedup, test set 1.678x speedup, val set 1.043x speedup, step: 63
Epoch 63/200 |loss: 19.405453| train set 2.352x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 64
Epoch 64/200 |loss: 17.564629| train set 2.374x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 65
Epoch 65/200 |loss: 17.848864| train set 2.565x speedup, test set 1.678x speedup, val set 0.873x speedup, step: 66
Epoch 66/200 |loss: 18.618341| train set 2.276x speedup, test set 1.638x speedup, val set 1.042x speedup, step: 67
Epoch 67/200 |loss: 17.489227| train set 2.833x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 68
Epoch 68/200 |loss: 18.295727| train set 2.359x speedup, test set 1.638x speedup, val set 1.039x speedup, step: 69
Epoch 69/200 |loss: 17.381399| train set 2.304x speedup, test set 1.678x speedup, val set 0.873x speedup, step: 70
Epoch 70/200 |loss: 16.931759| train set 2.895x speedup, test set 1.664x speedup, val set 0.971x speedup, step: 71
Epoch 71/200 |loss: 17.488008| train set 2.361x speedup, test set 1.678x speedup, val set 1.042x speedup, step: 72
Epoch 72/200 |loss: 17.120586| train set 2.349x speedup, test set 1.677x speedup, val set 1.003x speedup, step: 73
Epoch 73/200 |loss: 18.477432| train set 2.362x speedup, test set 1.677x speedup, val set 0.996x speedup, step: 74
Epoch 74/200 |loss: 16.202187| train set 2.741x speedup, test set 1.678x speedup, val set 0.934x speedup, step: 75
Epoch 75/200 |loss: 17.533381| train set 2.896x speedup, test set 1.668x speedup, val set 1.132x speedup, step: 76
Epoch 76/200 |loss: 18.268396| train set 2.278x speedup, test set 1.678x speedup, val set 0.971x speedup, step: 77
Epoch 77/200 |loss: 17.634945| train set 2.274x speedup, test set 1.677x speedup, val set 0.999x speedup, step: 78
Epoch 78/200 |loss: 17.543171| train set 2.389x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 79
Epoch 79/200 |loss: 17.086878| train set 2.745x speedup, test set 1.678x speedup, val set 1.000x speedup, step: 80
Epoch 80/200 |loss: 16.352783| train set 2.758x speedup, test set 1.678x speedup, val set 1.000x speedup, step: 81
Epoch 81/200 |loss: 16.851915| train set 2.573x speedup, test set 1.697x speedup, val set 0.873x speedup, step: 82
Epoch 82/200 |loss: 15.791504| train set 2.359x speedup, test set 1.697x speedup, val set 1.046x speedup, step: 83
Epoch 83/200 |loss: 16.131020| train set 2.616x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 84
Epoch 84/200 |loss: 15.766395| train set 2.561x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 85
Epoch 85/200 |loss: 15.406919| train set 2.896x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 86
Epoch 86/200 |loss: 15.595605| train set 2.668x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 87
Epoch 87/200 |loss: 15.073421| train set 2.628x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 88
Epoch 88/200 |loss: 14.989556| train set 2.460x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 89
Epoch 89/200 |loss: 14.693036| train set 2.889x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 14.723373| train set 2.772x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 91
Epoch 91/200 |loss: 14.494205| train set 2.771x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 92
Epoch 92/200 |loss: 14.334503| train set 2.629x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 93
Epoch 93/200 |loss: 14.149627| train set 2.900x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 13.894987| train set 2.900x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 95
Epoch 95/200 |loss: 13.892802| train set 2.901x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 13.968392| train set 2.642x speedup, test set 1.696x speedup, val set 0.957x speedup, step: 97
Epoch 97/200 |loss: 14.946947| train set 2.873x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 15.954768| train set 2.624x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 99
Epoch 99/200 |loss: 16.377260| train set 2.775x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 100
Epoch 100/200 |loss: 19.225861| train set 2.675x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 15.659352| train set 2.576x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 1
Epoch 102/200 |loss: 19.904074| train set 2.888x speedup, test set 1.736x speedup, val set 0.822x speedup, step: 2
Epoch 103/200 |loss: 16.140190| train set 2.637x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 3
Epoch 104/200 |loss: 16.339014| train set 2.625x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 1
Epoch 105/200 |loss: 15.698253| train set 2.552x speedup, test set 1.663x speedup, val set 1.003x speedup, step: 2
Epoch 106/200 |loss: 15.620424| train set 2.908x speedup, test set 1.677x speedup, val set 0.934x speedup, step: 3
Epoch 107/200 |loss: 15.832382| train set 2.755x speedup, test set 1.677x speedup, val set 0.934x speedup, step: 4
Epoch 108/200 |loss: 14.739602| train set 2.556x speedup, test set 1.681x speedup, val set 0.972x speedup, step: 5
Epoch 109/200 |loss: 15.053369| train set 2.642x speedup, test set 1.681x speedup, val set 0.934x speedup, step: 6
Epoch 110/200 |loss: 14.290174| train set 2.901x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 111/200 |loss: 14.380029| train set 2.887x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 8
Epoch 112/200 |loss: 13.964213| train set 2.758x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 1
Epoch 113/200 |loss: 13.827052| train set 2.768x speedup, test set 1.686x speedup, val set 1.043x speedup, step: 1
Epoch 114/200 |loss: 13.722379| train set 2.901x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 115/200 |loss: 13.493433| train set 2.902x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 3
Epoch 116/200 |loss: 13.264417| train set 2.902x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 4
Epoch 117/200 |loss: 13.067151| train set 2.773x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 5
Epoch 118/200 |loss: 13.117833| train set 2.902x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 6
Epoch 119/200 |loss: 12.624446| train set 2.913x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 120/200 |loss: 12.760640| train set 2.918x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 8
Epoch 121/200 |loss: 12.525319| train set 2.903x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 9
Epoch 122/200 |loss: 12.310674| train set 2.903x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 10
Epoch 123/200 |loss: 12.201848| train set 2.902x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 11
Epoch 124/200 |loss: 12.202271| train set 2.913x speedup, test set 1.696x speedup, val set 0.984x speedup, step: 12
Epoch 125/200 |loss: 11.886487| train set 2.918x speedup, test set 1.696x speedup, val set 0.984x speedup, step: 13
Epoch 126/200 |loss: 11.809636| train set 2.902x speedup, test set 1.696x speedup, val set 0.984x speedup, step: 14
Epoch 127/200 |loss: 11.641382| train set 2.902x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 15
Epoch 128/200 |loss: 11.737118| train set 2.903x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 1
Epoch 129/200 |loss: 11.670239| train set 2.913x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 2
Epoch 130/200 |loss: 11.629860| train set 2.907x speedup, test set 1.696x speedup, val set 0.984x speedup, step: 3
Epoch 131/200 |loss: 11.513691| train set 2.959x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 4
Epoch 132/200 |loss: 11.392463| train set 2.903x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 5
Epoch 133/200 |loss: 11.269075| train set 2.913x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 6
Epoch 134/200 |loss: 11.100181| train set 2.907x speedup, test set 1.696x speedup, val set 0.984x speedup, step: 7
Epoch 135/200 |loss: 11.191736| train set 2.959x speedup, test set 1.696x speedup, val set 0.984x speedup, step: 8
Epoch 136/200 |loss: 11.249697| train set 2.923x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 9
Epoch 137/200 |loss: 12.017617| train set 2.824x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 10
Epoch 138/200 |loss: 11.987855| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 11
Epoch 139/200 |loss: 11.783186| train set 2.977x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 12
Epoch 140/200 |loss: 11.539364| train set 2.869x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 13
Epoch 141/200 |loss: 13.030417| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 14
Epoch 142/200 |loss: 13.137711| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 15
Epoch 143/200 |loss: 11.207170| train set 2.891x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 16
Epoch 144/200 |loss: 12.796614| train set 2.918x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 17
Epoch 145/200 |loss: 11.785983| train set 2.662x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 146/200 |loss: 12.557622| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 147/200 |loss: 11.576948| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 3
Epoch 148/200 |loss: 12.231852| train set 2.730x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 4
Epoch 149/200 |loss: 11.946157| train set 2.919x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 5
Epoch 150/200 |loss: 11.215440| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 6
Epoch 151/200 |loss: 11.649632| train set 2.903x speedup, test set 1.696x speedup, val set 0.923x speedup, step: 7
Epoch 152/200 |loss: 11.524206| train set 2.902x speedup, test set 1.696x speedup, val set 0.987x speedup, step: 8
Epoch 153/200 |loss: 12.074361| train set 2.646x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 154/200 |loss: 10.805577| train set 2.948x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 2
Epoch 155/200 |loss: 11.735905| train set 2.906x speedup, test set 1.696x speedup, val set 0.987x speedup, step: 3
Epoch 156/200 |loss: 11.291322| train set 2.908x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 157/200 |loss: 10.940124| train set 2.765x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 2
Epoch 158/200 |loss: 10.876598| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 3
Epoch 159/200 |loss: 10.938727| train set 2.883x speedup, test set 1.696x speedup, val set 0.987x speedup, step: 4
Epoch 160/200 |loss: 10.264423| train set 3.044x speedup, test set 1.696x speedup, val set 0.987x speedup, step: 5
Epoch 161/200 |loss: 10.509755| train set 2.908x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 6
Epoch 162/200 |loss: 10.267654| train set 2.919x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 163/200 |loss: 10.081959| train set 2.904x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 8
Epoch 164/200 |loss: 10.072009| train set 2.966x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 165/200 |loss: 9.997379| train set 2.950x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 166/200 |loss: 9.948445| train set 2.908x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 167/200 |loss: 9.617204| train set 2.908x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 168/200 |loss: 9.908068| train set 2.949x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 169/200 |loss: 9.652924| train set 2.950x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 2
Epoch 170/200 |loss: 9.825686| train set 2.950x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 3
Epoch 171/200 |loss: 9.608610| train set 3.012x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 4
Epoch 172/200 |loss: 9.552412| train set 2.950x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 173/200 |loss: 9.372392| train set 2.951x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 174/200 |loss: 9.367101| train set 2.969x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 2
Epoch 175/200 |loss: 9.274966| train set 2.949x speedup, test set 1.696x speedup, val set 0.863x speedup, step: 3
Epoch 176/200 |loss: 9.327545| train set 2.924x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 177/200 |loss: 9.397964| train set 2.949x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 178/200 |loss: 9.473675| train set 2.908x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 2
Epoch 179/200 |loss: 9.952506| train set 3.009x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 3
Epoch 180/200 |loss: 9.795484| train set 2.908x speedup, test set 1.757x speedup, val set 0.875x speedup, step: 4
Epoch 181/200 |loss: 9.807688| train set 2.872x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 5
Epoch 182/200 |loss: 9.288576| train set 2.916x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 6
Epoch 183/200 |loss: 9.156964| train set 2.969x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 184/200 |loss: 9.412678| train set 2.949x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 185/200 |loss: 9.551071| train set 2.966x speedup, test set 1.757x speedup, val set 1.046x speedup, step: 1
Epoch 186/200 |loss: 9.342028| train set 2.951x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 187/200 |loss: 8.955068| train set 2.951x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 188/200 |loss: 8.991451| train set 2.967x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 189/200 |loss: 9.384077| train set 2.950x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 190/200 |loss: 9.139269| train set 3.007x speedup, test set 1.757x speedup, val set 1.046x speedup, step: 1
Epoch 191/200 |loss: 9.038045| train set 2.949x speedup, test set 1.696x speedup, val set 0.875x speedup, step: 2
Epoch 192/200 |loss: 8.990843| train set 2.998x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 193/200 |loss: 8.910629| train set 2.969x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 2
Epoch 194/200 |loss: 9.291042| train set 3.006x speedup, test set 1.696x speedup, val set 0.959x speedup, step: 3
Epoch 195/200 |loss: 9.605352| train set 2.953x speedup, test set 1.757x speedup, val set 1.046x speedup, step: 1
Epoch 196/200 |loss: 9.912366| train set 3.044x speedup, test set 1.696x speedup, val set 1.029x speedup, step: 2
Epoch 197/200 |loss: 8.906529| train set 2.959x speedup, test set 1.696x speedup, val set 0.875x speedup, step: 3
Epoch 198/200 |loss: 9.000431| train set 2.928x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 4
Epoch 199/200 |loss: 9.638122| train set 2.950x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Training per epoch cost 0.349 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 160, train speedup 3.044, test speedup 1.696, val speedup 0.987
best test speedup epoch: 3, train speedup 1.006, test speedup 2.746, val speedup 0.988
best validation speedup epoch: 199, train speedup 2.950, test speedup 1.696, val speedup 1.046
last model at epoch 199, train speedup 2.950, test speedup 1.696, val speedup 1.046
execution cost 0:03:11.049836
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.143366, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507725| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141737| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847757| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.567963| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255037| train set 1.012x speedup, test set 2.718x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.956789| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.655516| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.382275| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.089914| train set 1.029x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.792742| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.495798| train set 1.055x speedup, test set 2.630x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.206902| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.944157| train set 1.055x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 17
Epoch 17/200 |loss: 25.731516| train set 1.055x speedup, test set 2.526x speedup, val set 1.126x speedup, step: 18
Epoch 18/200 |loss: 25.918133| train set 1.056x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 19
Epoch 19/200 |loss: 25.643438| train set 1.054x speedup, test set 2.526x speedup, val set 1.027x speedup, step: 20
Epoch 20/200 |loss: 24.993288| train set 1.064x speedup, test set 2.526x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 25.012936| train set 1.064x speedup, test set 2.499x speedup, val set 0.957x speedup, step: 22
Epoch 22/200 |loss: 24.647179| train set 1.070x speedup, test set 2.481x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.351068| train set 1.064x speedup, test set 2.481x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.310791| train set 1.071x speedup, test set 2.443x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.859617| train set 1.070x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.739298| train set 1.105x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 23.617483| train set 1.166x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.209990| train set 1.062x speedup, test set 2.447x speedup, val set 0.957x speedup, step: 29
Epoch 29/200 |loss: 23.046228| train set 2.204x speedup, test set 2.476x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 23.098074| train set 1.060x speedup, test set 2.472x speedup, val set 0.909x speedup, step: 31
Epoch 31/200 |loss: 22.989857| train set 2.203x speedup, test set 2.450x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.651035| train set 2.206x speedup, test set 2.455x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 22.614540| train set 1.119x speedup, test set 2.470x speedup, val set 0.909x speedup, step: 34
Epoch 34/200 |loss: 22.189552| train set 2.230x speedup, test set 2.427x speedup, val set 0.957x speedup, step: 35
Epoch 35/200 |loss: 21.942732| train set 2.209x speedup, test set 2.455x speedup, val set 0.909x speedup, step: 36
Epoch 36/200 |loss: 21.755213| train set 2.209x speedup, test set 1.612x speedup, val set 0.909x speedup, step: 37
Epoch 37/200 |loss: 21.570444| train set 2.230x speedup, test set 1.613x speedup, val set 0.909x speedup, step: 38
Epoch 38/200 |loss: 21.357523| train set 2.219x speedup, test set 1.612x speedup, val set 0.983x speedup, step: 39
Epoch 39/200 |loss: 21.020004| train set 2.192x speedup, test set 1.613x speedup, val set 0.924x speedup, step: 40
Epoch 40/200 |loss: 21.032763| train set 2.156x speedup, test set 1.612x speedup, val set 0.985x speedup, step: 41
Epoch 41/200 |loss: 21.071150| train set 2.189x speedup, test set 1.613x speedup, val set 0.957x speedup, step: 42
Epoch 42/200 |loss: 20.737240| train set 2.297x speedup, test set 1.612x speedup, val set 0.961x speedup, step: 43
Epoch 43/200 |loss: 20.461435| train set 2.171x speedup, test set 1.612x speedup, val set 1.039x speedup, step: 44
Epoch 44/200 |loss: 20.553293| train set 2.276x speedup, test set 1.677x speedup, val set 0.924x speedup, step: 45
Epoch 45/200 |loss: 20.625771| train set 2.242x speedup, test set 1.629x speedup, val set 1.039x speedup, step: 46
Epoch 46/200 |loss: 20.400431| train set 2.195x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 47
Epoch 47/200 |loss: 19.528198| train set 2.171x speedup, test set 1.677x speedup, val set 0.924x speedup, step: 48
Epoch 48/200 |loss: 20.104170| train set 2.169x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 49
Epoch 49/200 |loss: 19.566910| train set 2.353x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 50
Epoch 50/200 |loss: 19.613390| train set 2.154x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 51
Epoch 51/200 |loss: 20.188101| train set 2.357x speedup, test set 1.677x speedup, val set 0.814x speedup, step: 52
Epoch 52/200 |loss: 19.712585| train set 2.324x speedup, test set 1.630x speedup, val set 1.039x speedup, step: 53
Epoch 53/200 |loss: 19.495029| train set 2.284x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 54
Epoch 54/200 |loss: 18.963085| train set 2.438x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 55
Epoch 55/200 |loss: 19.577864| train set 2.220x speedup, test set 1.630x speedup, val set 1.039x speedup, step: 56
Epoch 56/200 |loss: 18.634857| train set 2.451x speedup, test set 1.642x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 18.862528| train set 2.461x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 58
Epoch 58/200 |loss: 18.371220| train set 2.148x speedup, test set 1.648x speedup, val set 1.039x speedup, step: 59
Epoch 59/200 |loss: 18.923859| train set 2.292x speedup, test set 1.640x speedup, val set 1.039x speedup, step: 60
Epoch 60/200 |loss: 17.840067| train set 2.459x speedup, test set 1.699x speedup, val set 0.873x speedup, step: 61
Epoch 61/200 |loss: 18.698431| train set 2.220x speedup, test set 1.640x speedup, val set 1.039x speedup, step: 62
Epoch 62/200 |loss: 18.530119| train set 2.290x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 63
Epoch 63/200 |loss: 18.302794| train set 2.300x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 64
Epoch 64/200 |loss: 17.616743| train set 2.352x speedup, test set 1.642x speedup, val set 1.042x speedup, step: 65
Epoch 65/200 |loss: 17.994574| train set 2.464x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 66
Epoch 66/200 |loss: 17.480852| train set 2.370x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 67
Epoch 67/200 |loss: 17.321735| train set 2.352x speedup, test set 1.642x speedup, val set 0.875x speedup, step: 68
Epoch 68/200 |loss: 17.123234| train set 2.460x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 69
Epoch 69/200 |loss: 17.027945| train set 2.744x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 70
Epoch 70/200 |loss: 16.490898| train set 2.464x speedup, test set 1.699x speedup, val set 0.873x speedup, step: 71
Epoch 71/200 |loss: 16.703316| train set 2.457x speedup, test set 1.682x speedup, val set 0.873x speedup, step: 72
Epoch 72/200 |loss: 16.639378| train set 2.355x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 73
Epoch 73/200 |loss: 17.281853| train set 2.619x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 74
Epoch 74/200 |loss: 17.119938| train set 2.896x speedup, test set 1.696x speedup, val set 0.971x speedup, step: 75
Epoch 75/200 |loss: 17.630623| train set 2.303x speedup, test set 1.628x speedup, val set 1.043x speedup, step: 76
Epoch 76/200 |loss: 16.404345| train set 2.283x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 77
Epoch 77/200 |loss: 16.527700| train set 2.754x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 78
Epoch 78/200 |loss: 17.065516| train set 2.362x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 79
Epoch 79/200 |loss: 16.234266| train set 2.528x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 80
Epoch 80/200 |loss: 16.051876| train set 2.772x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 81
Epoch 81/200 |loss: 16.978523| train set 2.629x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 82
Epoch 82/200 |loss: 15.582791| train set 2.542x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 83
Epoch 83/200 |loss: 15.950502| train set 2.896x speedup, test set 1.687x speedup, val set 1.048x speedup, step: 84
Epoch 84/200 |loss: 16.883055| train set 2.750x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 85
Epoch 85/200 |loss: 15.133787| train set 2.559x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 86
Epoch 86/200 |loss: 16.700766| train set 2.769x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 87
Epoch 87/200 |loss: 15.385195| train set 2.772x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 88
Epoch 88/200 |loss: 15.216921| train set 2.564x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 89
Epoch 89/200 |loss: 15.975675| train set 2.772x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 90
Epoch 90/200 |loss: 14.781659| train set 2.755x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 91
Epoch 91/200 |loss: 14.786492| train set 2.668x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 92
Epoch 92/200 |loss: 14.918825| train set 2.758x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 93
Epoch 93/200 |loss: 14.023202| train set 2.901x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 94
Epoch 94/200 |loss: 14.495272| train set 2.898x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 13.931555| train set 2.778x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 13.770186| train set 2.902x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 13.947443| train set 2.630x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 13.486356| train set 2.903x speedup, test set 1.673x speedup, val set 0.934x speedup, step: 99
Epoch 99/200 |loss: 13.345819| train set 2.906x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 100
Epoch 100/200 |loss: 13.586393| train set 2.776x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 13.353826| train set 2.758x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 1
Epoch 102/200 |loss: 12.969701| train set 2.901x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 2
Epoch 103/200 |loss: 13.130238| train set 2.788x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 3
Epoch 104/200 |loss: 14.091977| train set 2.884x speedup, test set 1.747x speedup, val set 1.132x speedup, step: 1
Epoch 105/200 |loss: 17.177906| train set 2.257x speedup, test set 1.584x speedup, val set 0.968x speedup, step: 2
Epoch 106/200 |loss: 16.023308| train set 2.586x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 3
Epoch 107/200 |loss: 14.106962| train set 2.901x speedup, test set 1.747x speedup, val set 1.132x speedup, step: 1
Epoch 108/200 |loss: 16.611324| train set 2.672x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 2
Epoch 109/200 |loss: 13.980709| train set 2.617x speedup, test set 1.673x speedup, val set 0.972x speedup, step: 3
Epoch 110/200 |loss: 15.757984| train set 2.903x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 4
Epoch 111/200 |loss: 13.230803| train set 2.903x speedup, test set 1.747x speedup, val set 1.132x speedup, step: 1
Epoch 112/200 |loss: 14.446225| train set 2.867x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 2
Epoch 113/200 |loss: 13.614842| train set 2.553x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 3
Epoch 114/200 |loss: 13.202351| train set 2.902x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 4
Epoch 115/200 |loss: 13.162408| train set 2.912x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 5
Epoch 116/200 |loss: 12.565846| train set 2.913x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 6
Epoch 117/200 |loss: 13.221951| train set 2.902x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 7
Epoch 118/200 |loss: 12.517043| train set 2.751x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 8
Epoch 119/200 |loss: 12.514218| train set 2.917x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 9
Epoch 120/200 |loss: 12.333351| train set 2.916x speedup, test set 1.747x speedup, val set 0.868x speedup, step: 10
Epoch 121/200 |loss: 12.095271| train set 2.907x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 11
Epoch 122/200 |loss: 11.981572| train set 2.913x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 12
Epoch 123/200 |loss: 11.860271| train set 2.903x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 13
Epoch 124/200 |loss: 11.651203| train set 2.907x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 14
Epoch 125/200 |loss: 11.683765| train set 2.976x speedup, test set 1.736x speedup, val set 0.868x speedup, step: 15
Epoch 126/200 |loss: 11.548575| train set 2.907x speedup, test set 1.736x speedup, val set 0.934x speedup, step: 16
Epoch 127/200 |loss: 11.184126| train set 2.907x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 17
Epoch 128/200 |loss: 11.201464| train set 2.917x speedup, test set 1.747x speedup, val set 0.920x speedup, step: 18
Epoch 129/200 |loss: 11.132618| train set 2.907x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 19
Epoch 130/200 |loss: 11.305456| train set 2.927x speedup, test set 1.749x speedup, val set 0.957x speedup, step: 20
Epoch 131/200 |loss: 11.812700| train set 2.928x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 21
Epoch 132/200 |loss: 12.606437| train set 2.925x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 22
Epoch 133/200 |loss: 12.775647| train set 2.757x speedup, test set 1.747x speedup, val set 0.959x speedup, step: 23
Epoch 134/200 |loss: 12.219951| train set 2.915x speedup, test set 1.747x speedup, val set 0.935x speedup, step: 24
Epoch 135/200 |loss: 11.531270| train set 2.907x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 25
Epoch 136/200 |loss: 10.895078| train set 2.643x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 26
Epoch 137/200 |loss: 11.783857| train set 2.907x speedup, test set 1.736x speedup, val set 0.934x speedup, step: 27
Epoch 138/200 |loss: 11.041524| train set 2.958x speedup, test set 1.747x speedup, val set 0.935x speedup, step: 28
Epoch 139/200 |loss: 10.728072| train set 2.928x speedup, test set 1.747x speedup, val set 0.937x speedup, step: 29
Epoch 140/200 |loss: 10.925746| train set 2.907x speedup, test set 1.736x speedup, val set 0.934x speedup, step: 30
Epoch 141/200 |loss: 10.683155| train set 2.917x speedup, test set 1.736x speedup, val set 0.934x speedup, step: 31
Epoch 142/200 |loss: 10.737747| train set 2.908x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 32
Epoch 143/200 |loss: 10.452295| train set 2.937x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 33
Epoch 144/200 |loss: 10.305852| train set 2.919x speedup, test set 1.736x speedup, val set 0.822x speedup, step: 34
Epoch 145/200 |loss: 10.442106| train set 2.908x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 35
Epoch 146/200 |loss: 10.472859| train set 2.983x speedup, test set 1.736x speedup, val set 0.957x speedup, step: 36
Epoch 147/200 |loss: 10.316779| train set 2.896x speedup, test set 1.736x speedup, val set 0.934x speedup, step: 37
Epoch 148/200 |loss: 10.548820| train set 2.909x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 38
Epoch 149/200 |loss: 11.596154| train set 2.869x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 39
Epoch 150/200 |loss: 11.017972| train set 2.908x speedup, test set 1.736x speedup, val set 0.822x speedup, step: 40
Epoch 151/200 |loss: 10.732091| train set 2.919x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 41
Epoch 152/200 |loss: 10.129318| train set 2.827x speedup, test set 1.736x speedup, val set 0.957x speedup, step: 42
Epoch 153/200 |loss: 10.402555| train set 2.911x speedup, test set 1.736x speedup, val set 0.934x speedup, step: 43
Epoch 154/200 |loss: 10.821369| train set 2.826x speedup, test set 1.736x speedup, val set 0.957x speedup, step: 44
Epoch 155/200 |loss: 9.986557| train set 2.866x speedup, test set 1.736x speedup, val set 0.959x speedup, step: 45
Epoch 156/200 |loss: 10.220517| train set 2.910x speedup, test set 1.736x speedup, val set 0.934x speedup, step: 46
Epoch 157/200 |loss: 11.012852| train set 2.915x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 47
Epoch 158/200 |loss: 9.773655| train set 2.837x speedup, test set 1.736x speedup, val set 0.975x speedup, step: 48
Epoch 159/200 |loss: 9.981072| train set 2.911x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 49
Epoch 160/200 |loss: 10.415911| train set 2.909x speedup, test set 1.736x speedup, val set 0.822x speedup, step: 50
Epoch 161/200 |loss: 9.603572| train set 2.967x speedup, test set 1.676x speedup, val set 0.959x speedup, step: 51
Epoch 162/200 |loss: 9.990683| train set 2.960x speedup, test set 1.736x speedup, val set 0.934x speedup, step: 52
Epoch 163/200 |loss: 9.958955| train set 2.911x speedup, test set 1.736x speedup, val set 0.811x speedup, step: 53
Epoch 164/200 |loss: 9.867191| train set 2.816x speedup, test set 1.736x speedup, val set 0.957x speedup, step: 54
Epoch 165/200 |loss: 10.589931| train set 3.010x speedup, test set 1.729x speedup, val set 0.822x speedup, step: 55
Epoch 166/200 |loss: 10.366754| train set 2.894x speedup, test set 1.736x speedup, val set 0.822x speedup, step: 56
Epoch 167/200 |loss: 10.086994| train set 2.830x speedup, test set 1.701x speedup, val set 0.957x speedup, step: 57
Epoch 168/200 |loss: 9.493922| train set 2.909x speedup, test set 1.718x speedup, val set 0.972x speedup, step: 58
Epoch 169/200 |loss: 9.550856| train set 2.958x speedup, test set 1.736x speedup, val set 0.934x speedup, step: 59
Epoch 170/200 |loss: 9.649295| train set 3.050x speedup, test set 1.736x speedup, val set 0.957x speedup, step: 60
Epoch 171/200 |loss: 9.336909| train set 2.952x speedup, test set 1.736x speedup, val set 0.811x speedup, step: 61
Epoch 172/200 |loss: 9.556771| train set 3.012x speedup, test set 1.736x speedup, val set 0.822x speedup, step: 62
Epoch 173/200 |loss: 9.105104| train set 3.050x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 63
Epoch 174/200 |loss: 9.281182| train set 3.010x speedup, test set 1.736x speedup, val set 0.957x speedup, step: 64
Epoch 175/200 |loss: 9.153089| train set 2.970x speedup, test set 1.736x speedup, val set 0.957x speedup, step: 65
Epoch 176/200 |loss: 9.027415| train set 2.927x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 66
Epoch 177/200 |loss: 9.233204| train set 2.969x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 67
Epoch 178/200 |loss: 9.645678| train set 2.940x speedup, test set 1.736x speedup, val set 0.972x speedup, step: 68
Epoch 179/200 |loss: 10.660154| train set 2.983x speedup, test set 1.729x speedup, val set 0.972x speedup, step: 69
Epoch 180/200 |loss: 12.256546| train set 2.905x speedup, test set 1.736x speedup, val set 0.822x speedup, step: 70
Epoch 181/200 |loss: 9.736718| train set 2.949x speedup, test set 1.736x speedup, val set 0.811x speedup, step: 71
Epoch 182/200 |loss: 10.826294| train set 2.988x speedup, test set 1.701x speedup, val set 0.972x speedup, step: 72
Epoch 183/200 |loss: 11.800829| train set 2.912x speedup, test set 1.712x speedup, val set 1.043x speedup, step: 73
Epoch 184/200 |loss: 10.465153| train set 2.965x speedup, test set 1.747x speedup, val set 0.811x speedup, step: 74
Epoch 185/200 |loss: 12.116158| train set 2.943x speedup, test set 1.712x speedup, val set 1.043x speedup, step: 75
Epoch 186/200 |loss: 9.851705| train set 2.911x speedup, test set 1.712x speedup, val set 1.043x speedup, step: 76
Epoch 187/200 |loss: 11.068236| train set 3.024x speedup, test set 1.676x speedup, val set 0.957x speedup, step: 77
Epoch 188/200 |loss: 9.833768| train set 3.010x speedup, test set 1.736x speedup, val set 0.813x speedup, step: 78
Epoch 189/200 |loss: 10.387553| train set 2.989x speedup, test set 1.736x speedup, val set 1.043x speedup, step: 79
Epoch 190/200 |loss: 10.326786| train set 2.953x speedup, test set 1.736x speedup, val set 1.043x speedup, step: 80
Epoch 191/200 |loss: 9.572739| train set 3.012x speedup, test set 1.736x speedup, val set 0.920x speedup, step: 81
Epoch 192/200 |loss: 9.951188| train set 3.022x speedup, test set 1.747x speedup, val set 0.923x speedup, step: 82
Epoch 193/200 |loss: 9.141346| train set 2.946x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 83
Epoch 194/200 |loss: 9.718057| train set 2.954x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 84
Epoch 195/200 |loss: 9.051259| train set 3.010x speedup, test set 1.747x speedup, val set 0.822x speedup, step: 85
Epoch 196/200 |loss: 9.404992| train set 3.012x speedup, test set 1.747x speedup, val set 0.972x speedup, step: 86
Epoch 197/200 |loss: 9.113022| train set 3.050x speedup, test set 1.736x speedup, val set 1.043x speedup, step: 87
Epoch 198/200 |loss: 9.143975| train set 2.954x speedup, test set 1.747x speedup, val set 0.972x speedup, step: 88
Epoch 199/200 |loss: 9.083716| train set 2.964x speedup, test set 1.747x speedup, val set 0.957x speedup, step: 89
Training per epoch cost 0.351 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 66.316s, pg runtime 19.707s, speedup 0.297x
38, opt runtime 18.262s, model runtime 55.922s, pg runtime 18.262s, speedup 0.327x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 197, train speedup 3.050, test speedup 1.736, val speedup 1.043
best test speedup epoch: 3, train speedup 1.006, test speedup 2.746, val speedup 0.988
best validation speedup epoch: 111, train speedup 2.903, test speedup 1.747, val speedup 1.132
last model at epoch 199, train speedup 2.964, test speedup 1.747, val speedup 0.957
execution cost 0:03:15.423471
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.109194, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507721| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141737| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847996| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568947| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255930| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.957907| train set 1.012x speedup, test set 2.692x speedup, val set 0.975x speedup, step: 10
Epoch 10/200 |loss: 27.655672| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.380798| train set 1.012x speedup, test set 2.692x speedup, val set 0.975x speedup, step: 12
Epoch 12/200 |loss: 27.092505| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.800352| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.501923| train set 1.055x speedup, test set 2.602x speedup, val set 1.060x speedup, step: 15
Epoch 15/200 |loss: 26.213636| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.945696| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.668465| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.459642| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 19
Epoch 19/200 |loss: 25.778286| train set 1.055x speedup, test set 2.549x speedup, val set 0.975x speedup, step: 20
Epoch 20/200 |loss: 25.758846| train set 1.063x speedup, test set 2.549x speedup, val set 1.027x speedup, step: 21
Epoch 21/200 |loss: 24.786249| train set 1.063x speedup, test set 2.509x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 25.387794| train set 1.070x speedup, test set 2.528x speedup, val set 1.027x speedup, step: 23
Epoch 23/200 |loss: 24.400116| train set 1.064x speedup, test set 2.529x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.783293| train set 1.070x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 24.041920| train set 1.071x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 24.285864| train set 1.070x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 23.656244| train set 1.848x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.762905| train set 2.026x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 29
Epoch 29/200 |loss: 23.243996| train set 1.062x speedup, test set 1.616x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 23.350336| train set 2.028x speedup, test set 1.621x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.836931| train set 2.204x speedup, test set 2.475x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.821810| train set 1.128x speedup, test set 2.475x speedup, val set 0.909x speedup, step: 33
Epoch 33/200 |loss: 22.485220| train set 2.229x speedup, test set 1.627x speedup, val set 0.909x speedup, step: 34
Epoch 34/200 |loss: 22.348047| train set 2.169x speedup, test set 1.626x speedup, val set 0.957x speedup, step: 35
Epoch 35/200 |loss: 22.268396| train set 2.230x speedup, test set 1.610x speedup, val set 0.957x speedup, step: 36
Epoch 36/200 |loss: 21.912289| train set 1.889x speedup, test set 1.628x speedup, val set 1.039x speedup, step: 37
Epoch 37/200 |loss: 21.916971| train set 2.230x speedup, test set 1.610x speedup, val set 1.043x speedup, step: 38
Epoch 38/200 |loss: 21.779228| train set 2.171x speedup, test set 1.628x speedup, val set 1.039x speedup, step: 39
Epoch 39/200 |loss: 21.364725| train set 2.189x speedup, test set 1.611x speedup, val set 1.039x speedup, step: 40
Epoch 40/200 |loss: 21.335413| train set 2.209x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 41
Epoch 41/200 |loss: 21.103224| train set 2.238x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 42
Epoch 42/200 |loss: 20.577803| train set 2.129x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 43
Epoch 43/200 |loss: 20.611988| train set 2.244x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 44
Epoch 44/200 |loss: 20.797327| train set 2.252x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 45
Epoch 45/200 |loss: 20.378330| train set 2.170x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 46
Epoch 46/200 |loss: 20.084909| train set 2.311x speedup, test set 1.619x speedup, val set 0.873x speedup, step: 47
Epoch 47/200 |loss: 20.021999| train set 2.194x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 48
Epoch 48/200 |loss: 20.396969| train set 2.345x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 49
Epoch 49/200 |loss: 20.164116| train set 2.353x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 50
Epoch 50/200 |loss: 19.366884| train set 2.284x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 51
Epoch 51/200 |loss: 19.727188| train set 2.460x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 52
Epoch 52/200 |loss: 19.825649| train set 2.346x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 53
Epoch 53/200 |loss: 18.729954| train set 2.280x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 54
Epoch 54/200 |loss: 19.565714| train set 2.354x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 55
Epoch 55/200 |loss: 19.318159| train set 2.295x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 56
Epoch 56/200 |loss: 18.902079| train set 2.295x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 19.135092| train set 2.357x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 58
Epoch 58/200 |loss: 18.890343| train set 2.271x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 18.407547| train set 2.240x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 18.292126| train set 2.564x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 61
Epoch 61/200 |loss: 18.009369| train set 2.360x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 62
Epoch 62/200 |loss: 17.662886| train set 2.269x speedup, test set 1.677x speedup, val set 1.039x speedup, step: 63
Epoch 63/200 |loss: 17.845047| train set 2.463x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 64
Epoch 64/200 |loss: 17.179514| train set 2.576x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 65
Epoch 65/200 |loss: 17.518654| train set 2.359x speedup, test set 1.619x speedup, val set 1.042x speedup, step: 66
Epoch 66/200 |loss: 17.258308| train set 2.377x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 67
Epoch 67/200 |loss: 18.222300| train set 2.248x speedup, test set 1.637x speedup, val set 0.971x speedup, step: 68
Epoch 68/200 |loss: 19.318960| train set 2.578x speedup, test set 1.686x speedup, val set 0.873x speedup, step: 69
Epoch 69/200 |loss: 17.214243| train set 2.360x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 70
Epoch 70/200 |loss: 17.649590| train set 2.276x speedup, test set 1.677x speedup, val set 1.039x speedup, step: 71
Epoch 71/200 |loss: 17.206900| train set 2.264x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 72
Epoch 72/200 |loss: 17.048388| train set 2.884x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 73
Epoch 73/200 |loss: 16.727793| train set 2.397x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 74
Epoch 74/200 |loss: 16.851908| train set 2.361x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 75
Epoch 75/200 |loss: 16.307995| train set 2.758x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 76
Epoch 76/200 |loss: 16.555618| train set 2.300x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 77
Epoch 77/200 |loss: 16.296717| train set 2.582x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 78
Epoch 78/200 |loss: 16.848272| train set 2.534x speedup, test set 1.681x speedup, val set 0.873x speedup, step: 79
Epoch 79/200 |loss: 16.897156| train set 2.754x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 80
Epoch 80/200 |loss: 16.963223| train set 2.362x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 81
Epoch 81/200 |loss: 15.939610| train set 2.408x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 82
Epoch 82/200 |loss: 16.722868| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 83
Epoch 83/200 |loss: 16.418257| train set 2.625x speedup, test set 1.696x speedup, val set 1.042x speedup, step: 84
Epoch 84/200 |loss: 16.168324| train set 2.303x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 85
Epoch 85/200 |loss: 15.715641| train set 2.583x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 86
Epoch 86/200 |loss: 16.452301| train set 2.764x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 87
Epoch 87/200 |loss: 15.508794| train set 2.769x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 88
Epoch 88/200 |loss: 15.434980| train set 2.901x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 89
Epoch 89/200 |loss: 14.725244| train set 2.301x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 90
Epoch 90/200 |loss: 15.168891| train set 2.890x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 91
Epoch 91/200 |loss: 14.446301| train set 2.769x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 14.417835| train set 2.772x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 93
Epoch 93/200 |loss: 14.240621| train set 2.583x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 14.436208| train set 2.308x speedup, test set 1.681x speedup, val set 1.046x speedup, step: 95
Epoch 95/200 |loss: 14.308027| train set 2.777x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 96
Epoch 96/200 |loss: 14.616760| train set 2.902x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 14.172496| train set 2.887x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 98
Epoch 98/200 |loss: 13.785544| train set 2.902x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 99
Epoch 99/200 |loss: 13.325382| train set 2.902x speedup, test set 1.696x speedup, val set 1.003x speedup, step: 100
Epoch 100/200 |loss: 13.301859| train set 2.903x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 13.803487| train set 2.886x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 1
Epoch 102/200 |loss: 13.980268| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 103/200 |loss: 14.218357| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 104/200 |loss: 12.803218| train set 2.900x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 1
Epoch 105/200 |loss: 13.250479| train set 2.822x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 106/200 |loss: 14.390623| train set 2.894x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 2
Epoch 107/200 |loss: 13.644512| train set 2.901x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 3
Epoch 108/200 |loss: 13.294700| train set 2.905x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 4
Epoch 109/200 |loss: 14.796434| train set 2.891x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 5
Epoch 110/200 |loss: 12.844142| train set 2.894x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 6
Epoch 111/200 |loss: 13.291718| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 112/200 |loss: 14.038747| train set 2.629x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 8
Epoch 113/200 |loss: 13.747666| train set 2.851x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 9
Epoch 114/200 |loss: 13.726972| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 10
Epoch 115/200 |loss: 13.345622| train set 2.672x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 116/200 |loss: 13.710526| train set 2.906x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 2
Epoch 117/200 |loss: 13.531525| train set 2.917x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 3
Epoch 118/200 |loss: 12.492159| train set 2.959x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 4
Epoch 119/200 |loss: 12.963910| train set 2.906x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 5
Epoch 120/200 |loss: 12.621900| train set 2.916x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 6
Epoch 121/200 |loss: 12.512777| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 122/200 |loss: 12.719465| train set 2.635x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 8
Epoch 123/200 |loss: 12.037271| train set 2.848x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 9
Epoch 124/200 |loss: 12.313794| train set 2.903x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 10
Epoch 125/200 |loss: 11.971335| train set 2.786x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 11
Epoch 126/200 |loss: 12.362084| train set 2.907x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 12
Epoch 127/200 |loss: 12.021144| train set 2.919x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 13
Epoch 128/200 |loss: 11.528863| train set 2.983x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 14
Epoch 129/200 |loss: 11.538804| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 15
Epoch 130/200 |loss: 11.073878| train set 2.916x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 16
Epoch 131/200 |loss: 11.450106| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 17
Epoch 132/200 |loss: 11.266949| train set 2.919x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 18
Epoch 133/200 |loss: 11.430758| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 19
Epoch 134/200 |loss: 11.781274| train set 2.908x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 20
Epoch 135/200 |loss: 11.449909| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 21
Epoch 136/200 |loss: 11.345723| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 22
Epoch 137/200 |loss: 10.541059| train set 2.907x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 23
Epoch 138/200 |loss: 11.122804| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 24
Epoch 139/200 |loss: 11.705013| train set 2.976x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 25
Epoch 140/200 |loss: 10.801399| train set 2.896x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 26
Epoch 141/200 |loss: 11.029042| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 27
Epoch 142/200 |loss: 11.484931| train set 2.691x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 28
Epoch 143/200 |loss: 11.313597| train set 2.918x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 29
Epoch 144/200 |loss: 11.158350| train set 2.919x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 30
Epoch 145/200 |loss: 10.503598| train set 2.837x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 31
Epoch 146/200 |loss: 11.409095| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 32
Epoch 147/200 |loss: 10.429319| train set 2.919x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 33
Epoch 148/200 |loss: 10.615402| train set 2.951x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 34
Epoch 149/200 |loss: 10.514951| train set 2.924x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 35
Epoch 150/200 |loss: 10.439816| train set 2.908x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 36
Epoch 151/200 |loss: 10.559667| train set 2.908x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 37
Epoch 152/200 |loss: 10.318270| train set 2.942x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 38
Epoch 153/200 |loss: 10.364499| train set 2.908x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 39
Epoch 154/200 |loss: 9.906316| train set 2.904x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 40
Epoch 155/200 |loss: 9.901676| train set 2.644x speedup, test set 1.681x speedup, val set 1.046x speedup, step: 1
Epoch 156/200 |loss: 10.267798| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 157/200 |loss: 10.164141| train set 2.908x speedup, test set 1.681x speedup, val set 0.873x speedup, step: 3
Epoch 158/200 |loss: 10.337471| train set 2.942x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 4
Epoch 159/200 |loss: 10.787663| train set 2.841x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 5
Epoch 160/200 |loss: 10.302712| train set 2.960x speedup, test set 1.664x speedup, val set 1.000x speedup, step: 6
Epoch 161/200 |loss: 9.776168| train set 2.920x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 7
Epoch 162/200 |loss: 9.707018| train set 2.978x speedup, test set 1.664x speedup, val set 1.043x speedup, step: 8
Epoch 163/200 |loss: 10.184954| train set 2.908x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 9
Epoch 164/200 |loss: 10.152688| train set 2.908x speedup, test set 1.664x speedup, val set 1.000x speedup, step: 10
Epoch 165/200 |loss: 9.513247| train set 3.001x speedup, test set 1.664x speedup, val set 1.000x speedup, step: 11
Epoch 166/200 |loss: 9.425681| train set 2.950x speedup, test set 1.664x speedup, val set 1.000x speedup, step: 12
Epoch 167/200 |loss: 9.634319| train set 3.010x speedup, test set 1.681x speedup, val set 0.873x speedup, step: 13
Epoch 168/200 |loss: 9.613057| train set 3.002x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 14
Epoch 169/200 |loss: 9.674910| train set 2.949x speedup, test set 1.664x speedup, val set 1.000x speedup, step: 15
Epoch 170/200 |loss: 9.551961| train set 2.908x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 16
Epoch 171/200 |loss: 9.419320| train set 2.970x speedup, test set 1.664x speedup, val set 1.043x speedup, step: 17
Epoch 172/200 |loss: 9.193192| train set 2.961x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 18
Epoch 173/200 |loss: 9.016508| train set 3.011x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 19
Epoch 174/200 |loss: 8.946288| train set 2.950x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 20
Epoch 175/200 |loss: 9.077179| train set 2.978x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 21
Epoch 176/200 |loss: 9.327312| train set 2.950x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 22
Epoch 177/200 |loss: 9.610565| train set 2.925x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 23
Epoch 178/200 |loss: 11.034391| train set 3.010x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 24
Epoch 179/200 |loss: 9.958457| train set 2.925x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 25
Epoch 180/200 |loss: 9.317265| train set 2.844x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 26
Epoch 181/200 |loss: 9.420549| train set 2.961x speedup, test set 1.664x speedup, val set 1.043x speedup, step: 27
Epoch 182/200 |loss: 9.501010| train set 2.984x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 28
Epoch 183/200 |loss: 9.351567| train set 3.031x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 29
Epoch 184/200 |loss: 8.972196| train set 2.961x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 30
Epoch 185/200 |loss: 9.097037| train set 2.986x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 31
Epoch 186/200 |loss: 9.265069| train set 2.969x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 32
Epoch 187/200 |loss: 9.105077| train set 2.950x speedup, test set 1.679x speedup, val set 0.873x speedup, step: 33
Epoch 188/200 |loss: 9.020270| train set 3.028x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 34
Epoch 189/200 |loss: 8.787017| train set 2.969x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 35
Epoch 190/200 |loss: 8.917554| train set 2.967x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 36
Epoch 191/200 |loss: 9.164930| train set 2.970x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 37
Epoch 192/200 |loss: 8.955150| train set 3.027x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 38
Epoch 193/200 |loss: 8.601615| train set 2.963x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 39
Epoch 194/200 |loss: 8.753404| train set 2.929x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 40
Epoch 195/200 |loss: 9.119603| train set 3.013x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 41
Epoch 196/200 |loss: 8.739761| train set 2.966x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 42
Epoch 197/200 |loss: 9.333506| train set 2.866x speedup, test set 1.679x speedup, val set 1.043x speedup, step: 43
Epoch 198/200 |loss: 10.808879| train set 2.928x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 44
Epoch 199/200 |loss: 12.401191| train set 2.858x speedup, test set 1.679x speedup, val set 1.046x speedup, step: 1
Training per epoch cost 0.349 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 12.337s, pg runtime 1.206s, speedup 0.098x
40, opt runtime 1.086s, model runtime 13.122s, pg runtime 1.181s, speedup 0.090x
====================
best train speedup epoch: 183, train speedup 3.031, test speedup 1.679, val speedup 1.043
best test speedup epoch: 3, train speedup 1.006, test speedup 2.746, val speedup 0.988
best validation speedup epoch: 199, train speedup 2.858, test speedup 1.679, val speedup 1.046
last model at epoch 199, train speedup 2.858, test speedup 1.679, val speedup 1.046
execution cost 0:03:14.474044
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[0, 1, 2, 4, 5, 7, 9] [6, 8] [3 3]
[0, 1, 3, 7, 8, 9] [5, 2] [4 6]
[2, 4, 5, 7, 8, 9] [1, 3] [0 6]
[0, 2, 3, 4, 6, 8] [1, 9] [7 5]
[1, 3, 4, 5, 6, 8, 9] [7, 2] [0 0]
[1, 2, 3, 4, 6, 8] [5, 9] [7 0]
[2, 3, 4, 5, 7, 8] [1, 6] [9 0]
[1, 3, 4, 6, 7, 8] [0, 2] [5 9]
[2, 3, 4, 5, 6, 7] [1, 0] [9 8]
[0, 1, 4, 5, 6, 7, 8] [3, 9] [2 2]
[1, 2, 3, 5, 7, 8] [4, 6] [0 9]
[0, 1, 3, 4, 5, 6, 7] [9, 8] [2 2]
[3, 5, 6, 7, 8, 9] [1, 2] [0 4]
[1, 3, 4, 6, 8, 9] [0, 7] [5 2]
[0, 4, 5, 6, 7, 9] [3, 2] [8 1]
[1, 3, 5, 6, 7, 9] [8, 2] [0 4]
[1, 2, 3, 4, 6, 9] [8, 5] [7 0]
[0, 1, 2, 6, 7, 8] [5, 3] [9 4]
[2, 3, 4, 5, 6, 8] [7, 9] [1 0]
[0, 1, 3, 4, 5, 7] [2, 6] [9 8]
load TPCH succ
load TPCH_Skew...
[0, 2, 3, 4, 5, 9] [6, 1] [8 7]
[0, 1, 2, 3, 7, 8] [4, 5] [9 6]
[0, 1, 6, 7, 8, 9] [4, 5] [2 3]
[0, 2, 3, 4, 5, 8] [1, 6] [9 7]
[0, 1, 4, 5, 6, 8, 9] [7, 3] [2 2]
[2, 4, 5, 7, 8, 9] [0, 6] [1 3]
[0, 2, 4, 5, 7, 9] [3, 1] [6 8]
[0, 1, 4, 5, 7, 8] [9, 3] [6 2]
[1, 2, 3, 6, 7, 8] [9, 4] [0 5]
[0, 4, 5, 6, 7, 9] [3, 2] [1 8]
[0, 1, 2, 3, 5, 9] [4, 6] [8 7]
[0, 1, 3, 4, 5, 9] [8, 7] [6 2]
[1, 3, 4, 6, 7, 9] [2, 5] [0 8]
[1, 3, 4, 5, 6, 8] [0, 9] [7 2]
[0, 2, 4, 5, 7, 8] [9, 6] [1 3]
[0, 2, 4, 6, 8, 9] [7, 1] [5 3]
[0, 1, 2, 4, 5, 7] [6, 3] [8 9]
[1, 2, 3, 4, 7, 9] [6, 5] [8 0]
[0, 1, 3, 7, 8, 9] [2, 4] [5 6]
[0, 1, 3, 6, 7, 8] [5, 2] [9 4]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.172012, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507725| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141745| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847996| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568956| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255951| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958216| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657265| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.383940| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.092583| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.801670| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.506784| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.212667| train set 1.055x speedup, test set 2.499x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.953522| train set 1.055x speedup, test set 2.499x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.728994| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.843798| train set 1.054x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 19
Epoch 19/200 |loss: 25.658489| train set 1.055x speedup, test set 2.526x speedup, val set 1.027x speedup, step: 20
Epoch 20/200 |loss: 24.990812| train set 1.064x speedup, test set 2.549x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 24.921228| train set 1.069x speedup, test set 2.493x speedup, val set 0.957x speedup, step: 22
Epoch 22/200 |loss: 24.714033| train set 1.070x speedup, test set 2.529x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.289907| train set 1.071x speedup, test set 2.529x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.249939| train set 1.071x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.942921| train set 1.071x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.605927| train set 1.167x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 23.467772| train set 1.128x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.238132| train set 2.166x speedup, test set 2.493x speedup, val set 0.957x speedup, step: 29
Epoch 29/200 |loss: 22.962412| train set 2.203x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 22.690561| train set 1.057x speedup, test set 2.474x speedup, val set 0.897x speedup, step: 31
Epoch 31/200 |loss: 22.625330| train set 2.184x speedup, test set 2.492x speedup, val set 0.924x speedup, step: 32
Epoch 32/200 |loss: 22.913925| train set 1.062x speedup, test set 1.631x speedup, val set 0.985x speedup, step: 33
Epoch 33/200 |loss: 22.729387| train set 2.205x speedup, test set 1.630x speedup, val set 0.909x speedup, step: 34
Epoch 34/200 |loss: 22.144493| train set 2.180x speedup, test set 1.617x speedup, val set 0.961x speedup, step: 35
Epoch 35/200 |loss: 22.467756| train set 2.230x speedup, test set 1.613x speedup, val set 0.909x speedup, step: 36
Epoch 36/200 |loss: 21.671358| train set 1.117x speedup, test set 1.631x speedup, val set 0.983x speedup, step: 37
Epoch 37/200 |loss: 21.866810| train set 2.230x speedup, test set 1.619x speedup, val set 0.909x speedup, step: 38
Epoch 38/200 |loss: 21.189638| train set 2.230x speedup, test set 1.619x speedup, val set 0.961x speedup, step: 39
Epoch 39/200 |loss: 21.294048| train set 2.156x speedup, test set 1.637x speedup, val set 0.983x speedup, step: 40
Epoch 40/200 |loss: 21.142710| train set 2.156x speedup, test set 1.638x speedup, val set 0.983x speedup, step: 41
Epoch 41/200 |loss: 21.079161| train set 2.263x speedup, test set 1.620x speedup, val set 0.924x speedup, step: 42
Epoch 42/200 |loss: 21.596035| train set 2.241x speedup, test set 1.638x speedup, val set 0.961x speedup, step: 43
Epoch 43/200 |loss: 21.377930| train set 2.071x speedup, test set 1.638x speedup, val set 0.957x speedup, step: 44
Epoch 44/200 |loss: 21.000820| train set 2.101x speedup, test set 1.637x speedup, val set 0.957x speedup, step: 45
Epoch 45/200 |loss: 20.543976| train set 2.394x speedup, test set 1.678x speedup, val set 0.814x speedup, step: 46
Epoch 46/200 |loss: 21.496189| train set 2.156x speedup, test set 1.637x speedup, val set 0.957x speedup, step: 47
Epoch 47/200 |loss: 19.794065| train set 2.089x speedup, test set 1.632x speedup, val set 0.985x speedup, step: 48
Epoch 48/200 |loss: 20.820160| train set 2.102x speedup, test set 1.637x speedup, val set 1.000x speedup, step: 49
Epoch 49/200 |loss: 19.848259| train set 2.437x speedup, test set 1.637x speedup, val set 0.924x speedup, step: 50
Epoch 50/200 |loss: 20.077097| train set 2.185x speedup, test set 1.637x speedup, val set 0.983x speedup, step: 51
Epoch 51/200 |loss: 19.721186| train set 2.195x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 52
Epoch 52/200 |loss: 19.776394| train set 2.354x speedup, test set 1.638x speedup, val set 1.043x speedup, step: 53
Epoch 53/200 |loss: 18.933058| train set 2.379x speedup, test set 1.637x speedup, val set 0.873x speedup, step: 54
Epoch 54/200 |loss: 19.428543| train set 2.353x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 55
Epoch 55/200 |loss: 18.592886| train set 2.270x speedup, test set 1.619x speedup, val set 1.042x speedup, step: 56
Epoch 56/200 |loss: 18.976383| train set 2.302x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 18.375345| train set 2.561x speedup, test set 1.619x speedup, val set 0.873x speedup, step: 58
Epoch 58/200 |loss: 18.623106| train set 2.353x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 18.067503| train set 2.353x speedup, test set 1.619x speedup, val set 1.042x speedup, step: 60
Epoch 60/200 |loss: 18.138985| train set 2.359x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 61
Epoch 61/200 |loss: 17.713896| train set 2.463x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 62
Epoch 62/200 |loss: 17.673349| train set 2.357x speedup, test set 1.630x speedup, val set 1.046x speedup, step: 63
Epoch 63/200 |loss: 17.467875| train set 2.276x speedup, test set 1.630x speedup, val set 1.046x speedup, step: 64
Epoch 64/200 |loss: 17.157837| train set 2.457x speedup, test set 1.689x speedup, val set 1.046x speedup, step: 65
Epoch 65/200 |loss: 17.183588| train set 2.361x speedup, test set 1.630x speedup, val set 1.046x speedup, step: 66
Epoch 66/200 |loss: 16.896143| train set 2.753x speedup, test set 1.689x speedup, val set 1.046x speedup, step: 67
Epoch 67/200 |loss: 17.596867| train set 2.298x speedup, test set 1.648x speedup, val set 0.971x speedup, step: 68
Epoch 68/200 |loss: 19.362488| train set 2.576x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 69
Epoch 69/200 |loss: 20.712626| train set 2.278x speedup, test set 1.630x speedup, val set 1.042x speedup, step: 70
Epoch 70/200 |loss: 18.318773| train set 2.149x speedup, test set 1.648x speedup, val set 1.042x speedup, step: 71
Epoch 71/200 |loss: 20.552782| train set 2.461x speedup, test set 1.689x speedup, val set 0.814x speedup, step: 72
Epoch 72/200 |loss: 18.225641| train set 2.865x speedup, test set 1.667x speedup, val set 0.900x speedup, step: 73
Epoch 73/200 |loss: 19.784634| train set 2.275x speedup, test set 1.619x speedup, val set 1.042x speedup, step: 74
Epoch 74/200 |loss: 18.330006| train set 2.222x speedup, test set 1.619x speedup, val set 1.042x speedup, step: 75
Epoch 75/200 |loss: 18.889551| train set 2.302x speedup, test set 1.677x speedup, val set 0.814x speedup, step: 76
Epoch 76/200 |loss: 17.659197| train set 2.472x speedup, test set 1.677x speedup, val set 0.814x speedup, step: 77
Epoch 77/200 |loss: 18.113974| train set 2.743x speedup, test set 1.680x speedup, val set 1.043x speedup, step: 78
Epoch 78/200 |loss: 17.282640| train set 2.558x speedup, test set 1.680x speedup, val set 1.042x speedup, step: 79
Epoch 79/200 |loss: 17.568642| train set 2.362x speedup, test set 1.681x speedup, val set 1.042x speedup, step: 80
Epoch 80/200 |loss: 17.144732| train set 2.365x speedup, test set 1.681x speedup, val set 0.875x speedup, step: 81
Epoch 81/200 |loss: 16.756771| train set 2.749x speedup, test set 1.680x speedup, val set 0.924x speedup, step: 82
Epoch 82/200 |loss: 16.541647| train set 2.618x speedup, test set 1.680x speedup, val set 0.961x speedup, step: 83
Epoch 83/200 |loss: 16.588358| train set 2.625x speedup, test set 1.680x speedup, val set 1.043x speedup, step: 84
Epoch 84/200 |loss: 16.108786| train set 2.399x speedup, test set 1.699x speedup, val set 1.003x speedup, step: 85
Epoch 85/200 |loss: 16.141947| train set 2.629x speedup, test set 1.699x speedup, val set 1.046x speedup, step: 86
Epoch 86/200 |loss: 15.758464| train set 2.758x speedup, test set 1.699x speedup, val set 1.046x speedup, step: 87
Epoch 87/200 |loss: 15.660102| train set 2.900x speedup, test set 1.699x speedup, val set 1.003x speedup, step: 88
Epoch 88/200 |loss: 15.490786| train set 2.310x speedup, test set 1.699x speedup, val set 1.003x speedup, step: 89
Epoch 89/200 |loss: 15.233932| train set 2.310x speedup, test set 1.699x speedup, val set 1.003x speedup, step: 90
Epoch 90/200 |loss: 15.360801| train set 2.758x speedup, test set 1.708x speedup, val set 1.046x speedup, step: 91
Epoch 91/200 |loss: 15.470500| train set 2.901x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 15.973683| train set 2.463x speedup, test set 1.708x speedup, val set 1.046x speedup, step: 93
Epoch 93/200 |loss: 15.761366| train set 2.561x speedup, test set 1.708x speedup, val set 1.046x speedup, step: 94
Epoch 94/200 |loss: 14.791212| train set 2.762x speedup, test set 1.708x speedup, val set 1.003x speedup, step: 95
Epoch 95/200 |loss: 14.734135| train set 2.759x speedup, test set 1.708x speedup, val set 1.046x speedup, step: 96
Epoch 96/200 |loss: 14.738553| train set 2.874x speedup, test set 1.693x speedup, val set 1.003x speedup, step: 97
Epoch 97/200 |loss: 14.331879| train set 2.901x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 14.752845| train set 2.629x speedup, test set 1.708x speedup, val set 1.046x speedup, step: 99
Epoch 99/200 |loss: 14.198666| train set 2.672x speedup, test set 1.708x speedup, val set 1.046x speedup, step: 100
Epoch 100/200 |loss: 13.659071| train set 2.897x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 14.083959| train set 2.570x speedup, test set 1.708x speedup, val set 1.046x speedup, step: 1
Epoch 102/200 |loss: 13.937299| train set 2.745x speedup, test set 1.708x speedup, val set 1.003x speedup, step: 2
Epoch 103/200 |loss: 13.959274| train set 2.675x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 3
Epoch 104/200 |loss: 14.480268| train set 2.674x speedup, test set 1.708x speedup, val set 1.046x speedup, step: 1
Epoch 105/200 |loss: 14.402600| train set 2.911x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 2
Epoch 106/200 |loss: 13.368749| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 3
Epoch 107/200 |loss: 13.392103| train set 2.571x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 108/200 |loss: 13.222878| train set 2.673x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 109/200 |loss: 12.853692| train set 2.902x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 3
Epoch 110/200 |loss: 13.474624| train set 2.638x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 4
Epoch 111/200 |loss: 13.739749| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 5
Epoch 112/200 |loss: 13.916781| train set 2.904x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 6
Epoch 113/200 |loss: 13.206593| train set 2.932x speedup, test set 1.705x speedup, val set 1.003x speedup, step: 7
Epoch 114/200 |loss: 13.814973| train set 2.901x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 8
Epoch 115/200 |loss: 12.916672| train set 2.634x speedup, test set 1.705x speedup, val set 1.043x speedup, step: 9
Epoch 116/200 |loss: 13.155704| train set 2.912x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 10
Epoch 117/200 |loss: 12.825833| train set 2.913x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 11
Epoch 118/200 |loss: 12.155362| train set 2.914x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 12
Epoch 119/200 |loss: 12.500037| train set 2.627x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 13
Epoch 120/200 |loss: 12.408609| train set 2.917x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 14
Epoch 121/200 |loss: 12.133719| train set 2.907x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 15
Epoch 122/200 |loss: 12.399854| train set 2.913x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 16
Epoch 123/200 |loss: 12.212689| train set 2.907x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 17
Epoch 124/200 |loss: 12.701729| train set 2.574x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 18
Epoch 125/200 |loss: 13.159267| train set 2.907x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 19
Epoch 126/200 |loss: 11.971091| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 20
Epoch 127/200 |loss: 12.228734| train set 2.747x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 21
Epoch 128/200 |loss: 12.043158| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 22
Epoch 129/200 |loss: 11.511361| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 23
Epoch 130/200 |loss: 11.994376| train set 2.958x speedup, test set 1.696x speedup, val set 1.026x speedup, step: 24
Epoch 131/200 |loss: 11.777546| train set 2.903x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 25
Epoch 132/200 |loss: 11.746717| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 26
Epoch 133/200 |loss: 11.280552| train set 2.976x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 27
Epoch 134/200 |loss: 11.188965| train set 2.919x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 28
Epoch 135/200 |loss: 11.672343| train set 2.761x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 29
Epoch 136/200 |loss: 11.267982| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 30
Epoch 137/200 |loss: 11.403390| train set 2.958x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 31
Epoch 138/200 |loss: 12.154477| train set 2.975x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 32
Epoch 139/200 |loss: 12.466938| train set 2.919x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 33
Epoch 140/200 |loss: 11.295622| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 34
Epoch 141/200 |loss: 10.856473| train set 2.944x speedup, test set 1.696x speedup, val set 1.026x speedup, step: 35
Epoch 142/200 |loss: 11.199892| train set 2.852x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 36
Epoch 143/200 |loss: 11.183151| train set 2.909x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 37
Epoch 144/200 |loss: 11.403111| train set 2.656x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 38
Epoch 145/200 |loss: 10.944137| train set 2.917x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 39
Epoch 146/200 |loss: 10.607313| train set 2.908x speedup, test set 1.705x speedup, val set 1.000x speedup, step: 40
Epoch 147/200 |loss: 10.616023| train set 2.682x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 41
Epoch 148/200 |loss: 11.293920| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 42
Epoch 149/200 |loss: 11.060555| train set 2.960x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 43
Epoch 150/200 |loss: 10.385533| train set 3.019x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 44
Epoch 151/200 |loss: 10.371401| train set 2.924x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 45
Epoch 152/200 |loss: 10.951050| train set 2.908x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 46
Epoch 153/200 |loss: 10.330704| train set 2.779x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 47
Epoch 154/200 |loss: 10.067982| train set 2.905x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 48
Epoch 155/200 |loss: 10.023041| train set 3.010x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 49
Epoch 156/200 |loss: 10.072809| train set 2.911x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 50
Epoch 157/200 |loss: 9.944085| train set 2.950x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 51
Epoch 158/200 |loss: 9.802760| train set 3.022x speedup, test set 1.708x speedup, val set 0.984x speedup, step: 52
Epoch 159/200 |loss: 9.853633| train set 2.905x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 53
Epoch 160/200 |loss: 9.776352| train set 2.828x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 54
Epoch 161/200 |loss: 9.841129| train set 2.919x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 55
Epoch 162/200 |loss: 9.738322| train set 2.951x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 56
Epoch 163/200 |loss: 9.675626| train set 2.763x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 57
Epoch 164/200 |loss: 10.069512| train set 2.967x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 58
Epoch 165/200 |loss: 10.967405| train set 2.778x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 59
Epoch 166/200 |loss: 10.591136| train set 2.928x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 60
Epoch 167/200 |loss: 10.508855| train set 2.894x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 61
Epoch 168/200 |loss: 9.493467| train set 2.829x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 62
Epoch 169/200 |loss: 10.090184| train set 2.912x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 63
Epoch 170/200 |loss: 11.131237| train set 2.968x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 64
Epoch 171/200 |loss: 9.442414| train set 2.936x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 65
Epoch 172/200 |loss: 10.348672| train set 2.983x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 66
Epoch 173/200 |loss: 11.904048| train set 2.766x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 67
Epoch 174/200 |loss: 10.019884| train set 3.010x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 68
Epoch 175/200 |loss: 11.929605| train set 3.003x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 69
Epoch 176/200 |loss: 11.089396| train set 2.911x speedup, test set 1.690x speedup, val set 1.043x speedup, step: 70
Epoch 177/200 |loss: 11.396596| train set 2.691x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 71
Epoch 178/200 |loss: 10.942756| train set 2.919x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 72
Epoch 179/200 |loss: 10.688961| train set 2.943x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 73
Epoch 180/200 |loss: 10.647894| train set 3.008x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 74
Epoch 181/200 |loss: 9.941853| train set 2.950x speedup, test set 1.699x speedup, val set 0.873x speedup, step: 75
Epoch 182/200 |loss: 10.367039| train set 2.951x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 76
Epoch 183/200 |loss: 9.501020| train set 2.943x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 77
Epoch 184/200 |loss: 10.059502| train set 2.963x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 78
Epoch 185/200 |loss: 9.406138| train set 3.009x speedup, test set 1.699x speedup, val set 0.860x speedup, step: 79
Epoch 186/200 |loss: 9.661828| train set 2.805x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 80
Epoch 187/200 |loss: 9.356557| train set 2.698x speedup, test set 1.682x speedup, val set 1.043x speedup, step: 81
Epoch 188/200 |loss: 9.369276| train set 3.009x speedup, test set 1.682x speedup, val set 1.043x speedup, step: 82
Epoch 189/200 |loss: 9.165027| train set 2.961x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 83
Epoch 190/200 |loss: 9.242527| train set 2.858x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 84
Epoch 191/200 |loss: 9.098777| train set 3.013x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 85
Epoch 192/200 |loss: 8.908912| train set 3.010x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 86
Epoch 193/200 |loss: 8.969310| train set 3.023x speedup, test set 1.690x speedup, val set 1.043x speedup, step: 87
Epoch 194/200 |loss: 8.855676| train set 2.954x speedup, test set 1.690x speedup, val set 1.043x speedup, step: 88
Epoch 195/200 |loss: 8.891534| train set 3.025x speedup, test set 1.690x speedup, val set 1.043x speedup, step: 89
Epoch 196/200 |loss: 8.698118| train set 3.025x speedup, test set 1.690x speedup, val set 1.043x speedup, step: 90
Epoch 197/200 |loss: 8.599703| train set 2.953x speedup, test set 1.690x speedup, val set 1.043x speedup, step: 91
Epoch 198/200 |loss: 8.629218| train set 3.025x speedup, test set 1.690x speedup, val set 1.043x speedup, step: 92
Epoch 199/200 |loss: 8.492435| train set 3.011x speedup, test set 1.690x speedup, val set 1.043x speedup, step: 93
Training per epoch cost 0.347 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 198, train speedup 3.025, test speedup 1.690, val speedup 1.043
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 107, train speedup 2.571, test speedup 1.696, val speedup 1.046
last model at epoch 199, train speedup 3.011, test speedup 1.690, val speedup 1.043
execution cost 0:03:10.309231
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.087255, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507730| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141750| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.848000| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568964| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255947| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958176| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657343| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.384024| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.092216| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.801195| train set 1.055x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.503984| train set 1.055x speedup, test set 2.630x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.210812| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.946920| train set 1.054x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.703430| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.734049| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 19
Epoch 19/200 |loss: 25.856365| train set 1.066x speedup, test set 2.549x speedup, val set 0.975x speedup, step: 20
Epoch 20/200 |loss: 25.128414| train set 1.064x speedup, test set 2.529x speedup, val set 0.909x speedup, step: 21
Epoch 21/200 |loss: 24.989180| train set 1.071x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 22
Epoch 22/200 |loss: 24.809914| train set 1.070x speedup, test set 2.555x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.374704| train set 1.064x speedup, test set 2.548x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.427523| train set 1.070x speedup, test set 2.555x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.895969| train set 1.071x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.999205| train set 1.106x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.574007| train set 1.105x speedup, test set 2.478x speedup, val set 0.909x speedup, step: 28
Epoch 28/200 |loss: 23.342569| train set 1.160x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.290359| train set 1.995x speedup, test set 2.478x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 22.827806| train set 2.204x speedup, test set 2.478x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.693949| train set 2.029x speedup, test set 2.478x speedup, val set 0.909x speedup, step: 32
Epoch 32/200 |loss: 22.562674| train set 2.206x speedup, test set 2.449x speedup, val set 0.909x speedup, step: 33
Epoch 33/200 |loss: 22.194366| train set 2.150x speedup, test set 2.491x speedup, val set 0.983x speedup, step: 34
Epoch 34/200 |loss: 22.019745| train set 2.194x speedup, test set 2.465x speedup, val set 0.924x speedup, step: 35
Epoch 35/200 |loss: 22.432894| train set 1.061x speedup, test set 1.630x speedup, val set 1.042x speedup, step: 36
Epoch 36/200 |loss: 22.562414| train set 2.209x speedup, test set 1.612x speedup, val set 0.957x speedup, step: 37
Epoch 37/200 |loss: 21.657393| train set 2.189x speedup, test set 1.613x speedup, val set 0.957x speedup, step: 38
Epoch 38/200 |loss: 22.062252| train set 2.238x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 39
Epoch 39/200 |loss: 21.405670| train set 1.889x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 40
Epoch 40/200 |loss: 21.498652| train set 2.217x speedup, test set 2.460x speedup, val set 1.039x speedup, step: 41
Epoch 41/200 |loss: 20.907263| train set 2.325x speedup, test set 1.671x speedup, val set 1.000x speedup, step: 42
Epoch 42/200 |loss: 20.821472| train set 2.146x speedup, test set 1.614x speedup, val set 0.983x speedup, step: 43
Epoch 43/200 |loss: 20.733927| train set 2.147x speedup, test set 1.632x speedup, val set 0.983x speedup, step: 44
Epoch 44/200 |loss: 20.500717| train set 2.229x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 45
Epoch 45/200 |loss: 20.488178| train set 2.497x speedup, test set 1.678x speedup, val set 1.000x speedup, step: 46
Epoch 46/200 |loss: 20.132093| train set 2.189x speedup, test set 1.613x speedup, val set 0.983x speedup, step: 47
Epoch 47/200 |loss: 20.395929| train set 2.400x speedup, test set 1.677x speedup, val set 0.833x speedup, step: 48
Epoch 48/200 |loss: 19.935760| train set 2.228x speedup, test set 1.619x speedup, val set 0.983x speedup, step: 49
Epoch 49/200 |loss: 19.736795| train set 2.271x speedup, test set 1.614x speedup, val set 1.043x speedup, step: 50
Epoch 50/200 |loss: 19.380041| train set 2.238x speedup, test set 1.678x speedup, val set 0.873x speedup, step: 51
Epoch 51/200 |loss: 19.162619| train set 2.215x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 52
Epoch 52/200 |loss: 18.913538| train set 2.271x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 53
Epoch 53/200 |loss: 19.225805| train set 2.220x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 54
Epoch 54/200 |loss: 19.368250| train set 2.547x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 55
Epoch 55/200 |loss: 20.238235| train set 2.353x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 56
Epoch 56/200 |loss: 19.274456| train set 2.291x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 18.407640| train set 2.448x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 58
Epoch 58/200 |loss: 18.925171| train set 2.353x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 59
Epoch 59/200 |loss: 18.505156| train set 2.295x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 60
Epoch 60/200 |loss: 18.014536| train set 2.460x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 61
Epoch 61/200 |loss: 18.616411| train set 2.271x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 62
Epoch 62/200 |loss: 17.896593| train set 2.282x speedup, test set 1.619x speedup, val set 0.873x speedup, step: 63
Epoch 63/200 |loss: 17.767986| train set 2.463x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 64
Epoch 64/200 |loss: 18.211691| train set 2.270x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 65
Epoch 65/200 |loss: 17.432371| train set 2.298x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 66
Epoch 66/200 |loss: 17.743217| train set 2.463x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 67
Epoch 67/200 |loss: 17.647367| train set 2.228x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 68
Epoch 68/200 |loss: 17.791800| train set 2.283x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 69
Epoch 69/200 |loss: 17.230276| train set 2.751x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 70
Epoch 70/200 |loss: 18.230642| train set 2.169x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 71
Epoch 71/200 |loss: 16.853363| train set 2.167x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 72
Epoch 72/200 |loss: 17.393402| train set 2.463x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 73
Epoch 73/200 |loss: 16.628954| train set 2.764x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 74
Epoch 74/200 |loss: 16.556402| train set 2.276x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 75
Epoch 75/200 |loss: 16.926229| train set 2.390x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 76
Epoch 76/200 |loss: 16.698032| train set 2.362x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 77
Epoch 77/200 |loss: 16.150246| train set 2.751x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 78
Epoch 78/200 |loss: 16.368921| train set 2.752x speedup, test set 1.667x speedup, val set 1.043x speedup, step: 79
Epoch 79/200 |loss: 15.790523| train set 2.458x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 80
Epoch 80/200 |loss: 15.550452| train set 2.392x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 81
Epoch 81/200 |loss: 15.966221| train set 2.629x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 82
Epoch 82/200 |loss: 16.030636| train set 2.768x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 83
Epoch 83/200 |loss: 15.367399| train set 2.768x speedup, test set 1.693x speedup, val set 0.873x speedup, step: 84
Epoch 84/200 |loss: 15.531659| train set 2.568x speedup, test set 1.708x speedup, val set 0.873x speedup, step: 85
Epoch 85/200 |loss: 15.969106| train set 2.562x speedup, test set 1.693x speedup, val set 1.043x speedup, step: 86
Epoch 86/200 |loss: 15.216502| train set 2.630x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 87
Epoch 87/200 |loss: 15.253930| train set 2.898x speedup, test set 1.696x speedup, val set 0.971x speedup, step: 88
Epoch 88/200 |loss: 15.862315| train set 2.366x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 89
Epoch 89/200 |loss: 14.892975| train set 2.562x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 15.132860| train set 2.901x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 91
Epoch 91/200 |loss: 15.316857| train set 2.912x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 14.022345| train set 2.769x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 14.733439| train set 2.758x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 94
Epoch 94/200 |loss: 14.807981| train set 2.887x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 14.145372| train set 2.770x speedup, test set 1.682x speedup, val set 0.934x speedup, step: 96
Epoch 96/200 |loss: 15.028710| train set 2.903x speedup, test set 1.692x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 14.583040| train set 2.759x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 98
Epoch 98/200 |loss: 14.062485| train set 2.562x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 99
Epoch 99/200 |loss: 15.049852| train set 2.759x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 100
Epoch 100/200 |loss: 14.085233| train set 2.899x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 14.272779| train set 2.639x speedup, test set 1.704x speedup, val set 0.972x speedup, step: 2
Epoch 102/200 |loss: 14.541175| train set 2.759x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 103/200 |loss: 13.235755| train set 2.902x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 104/200 |loss: 13.849362| train set 2.789x speedup, test set 1.704x speedup, val set 0.972x speedup, step: 3
Epoch 105/200 |loss: 13.663436| train set 2.913x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 4
Epoch 106/200 |loss: 13.167409| train set 2.891x speedup, test set 1.704x speedup, val set 1.000x speedup, step: 5
Epoch 107/200 |loss: 13.471248| train set 2.746x speedup, test set 1.704x speedup, val set 1.000x speedup, step: 6
Epoch 108/200 |loss: 12.736723| train set 2.913x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 7
Epoch 109/200 |loss: 13.338462| train set 2.902x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 8
Epoch 110/200 |loss: 13.427938| train set 2.634x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 111/200 |loss: 12.894351| train set 2.898x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 112/200 |loss: 12.726081| train set 2.913x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 113/200 |loss: 13.118906| train set 2.914x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 4
Epoch 114/200 |loss: 13.117133| train set 2.903x speedup, test set 1.704x speedup, val set 1.000x speedup, step: 5
Epoch 115/200 |loss: 12.127129| train set 2.902x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 6
Epoch 116/200 |loss: 13.064116| train set 2.756x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 7
Epoch 117/200 |loss: 12.097693| train set 2.923x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 8
Epoch 118/200 |loss: 12.056407| train set 2.902x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 9
Epoch 119/200 |loss: 11.949056| train set 2.904x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 10
Epoch 120/200 |loss: 11.945405| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 11
Epoch 121/200 |loss: 12.238386| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 12
Epoch 122/200 |loss: 11.325660| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 13
Epoch 123/200 |loss: 12.164176| train set 2.963x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 124/200 |loss: 13.047480| train set 2.731x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 2
Epoch 125/200 |loss: 13.424764| train set 2.773x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 126/200 |loss: 12.400155| train set 2.916x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 127/200 |loss: 13.190660| train set 2.763x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 3
Epoch 128/200 |loss: 12.520353| train set 2.617x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 129/200 |loss: 11.855295| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 130/200 |loss: 12.573668| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 131/200 |loss: 11.405095| train set 2.917x speedup, test set 1.704x speedup, val set 1.000x speedup, step: 4
Epoch 132/200 |loss: 11.618469| train set 2.924x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 5
Epoch 133/200 |loss: 11.085667| train set 2.765x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 6
Epoch 134/200 |loss: 11.389218| train set 2.774x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 135/200 |loss: 10.673219| train set 2.924x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 8
Epoch 136/200 |loss: 11.022183| train set 2.919x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 9
Epoch 137/200 |loss: 10.697075| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 10
Epoch 138/200 |loss: 10.764768| train set 2.908x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 139/200 |loss: 10.521484| train set 2.919x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 140/200 |loss: 10.406569| train set 2.919x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 141/200 |loss: 10.348543| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 4
Epoch 142/200 |loss: 10.293522| train set 2.846x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 143/200 |loss: 10.541689| train set 2.961x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 144/200 |loss: 11.192403| train set 2.845x speedup, test set 1.713x speedup, val set 1.043x speedup, step: 1
Epoch 145/200 |loss: 12.433816| train set 2.907x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 2
Epoch 146/200 |loss: 11.642499| train set 2.918x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 147/200 |loss: 10.636897| train set 2.779x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 148/200 |loss: 11.627630| train set 2.905x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 2
Epoch 149/200 |loss: 10.958474| train set 2.950x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 150/200 |loss: 10.455762| train set 2.831x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 151/200 |loss: 11.001190| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 152/200 |loss: 10.604311| train set 2.948x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 153/200 |loss: 12.215357| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 154/200 |loss: 17.349655| train set 2.499x speedup, test set 1.436x speedup, val set 0.972x speedup, step: 3
Epoch 155/200 |loss: 11.571306| train set 2.895x speedup, test set 1.429x speedup, val set 1.043x speedup, step: 1
Epoch 156/200 |loss: 17.126932| train set 2.942x speedup, test set 1.736x speedup, val set 1.000x speedup, step: 2
Epoch 157/200 |loss: 14.033935| train set 2.665x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 3
Epoch 158/200 |loss: 13.716558| train set 2.500x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 159/200 |loss: 14.328568| train set 2.906x speedup, test set 1.736x speedup, val set 1.000x speedup, step: 2
Epoch 160/200 |loss: 12.812465| train set 2.908x speedup, test set 1.736x speedup, val set 1.000x speedup, step: 3
Epoch 161/200 |loss: 12.954346| train set 2.671x speedup, test set 1.713x speedup, val set 0.972x speedup, step: 4
Epoch 162/200 |loss: 12.484475| train set 2.684x speedup, test set 1.713x speedup, val set 0.972x speedup, step: 5
Epoch 163/200 |loss: 12.599828| train set 2.893x speedup, test set 1.757x speedup, val set 1.000x speedup, step: 6
Epoch 164/200 |loss: 11.773768| train set 2.909x speedup, test set 1.757x speedup, val set 1.000x speedup, step: 7
Epoch 165/200 |loss: 11.950878| train set 2.708x speedup, test set 1.713x speedup, val set 1.043x speedup, step: 1
Epoch 166/200 |loss: 11.496914| train set 2.647x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 167/200 |loss: 11.556741| train set 2.908x speedup, test set 1.757x speedup, val set 1.000x speedup, step: 2
Epoch 168/200 |loss: 11.014119| train set 2.924x speedup, test set 1.775x speedup, val set 1.000x speedup, step: 3
Epoch 169/200 |loss: 11.034193| train set 2.813x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 170/200 |loss: 10.763816| train set 2.757x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 171/200 |loss: 10.562207| train set 2.908x speedup, test set 1.704x speedup, val set 1.000x speedup, step: 2
Epoch 172/200 |loss: 10.578274| train set 2.920x speedup, test set 1.704x speedup, val set 1.000x speedup, step: 3
Epoch 173/200 |loss: 10.224201| train set 2.916x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 174/200 |loss: 10.476772| train set 2.967x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 175/200 |loss: 10.038801| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 176/200 |loss: 10.122691| train set 2.978x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 177/200 |loss: 9.806233| train set 2.997x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 178/200 |loss: 9.824658| train set 2.960x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 179/200 |loss: 9.743168| train set 2.960x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 180/200 |loss: 9.532782| train set 3.021x speedup, test set 1.765x speedup, val set 1.043x speedup, step: 1
Epoch 181/200 |loss: 9.569476| train set 2.967x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 1
Epoch 182/200 |loss: 9.414875| train set 2.961x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 2
Epoch 183/200 |loss: 9.330556| train set 3.020x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 1
Epoch 184/200 |loss: 9.328390| train set 2.952x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 1
Epoch 185/200 |loss: 9.248199| train set 2.960x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 1
Epoch 186/200 |loss: 9.069832| train set 3.024x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 187/200 |loss: 9.183782| train set 2.968x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 188/200 |loss: 9.081541| train set 2.921x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 189/200 |loss: 8.920218| train set 3.021x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 190/200 |loss: 8.955913| train set 2.968x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 191/200 |loss: 8.911218| train set 3.029x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 192/200 |loss: 8.895116| train set 2.962x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 193/200 |loss: 8.790495| train set 3.023x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 194/200 |loss: 8.664410| train set 3.029x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 195/200 |loss: 8.701610| train set 2.963x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 196/200 |loss: 8.720620| train set 3.023x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 197/200 |loss: 8.692461| train set 2.926x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Epoch 198/200 |loss: 8.706277| train set 3.011x speedup, test set 1.769x speedup, val set 1.043x speedup, step: 1
Epoch 199/200 |loss: 8.775067| train set 2.985x speedup, test set 1.757x speedup, val set 1.043x speedup, step: 1
Training per epoch cost 0.294 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 66.316s, pg runtime 19.707s, speedup 0.297x
38, opt runtime 18.262s, model runtime 55.922s, pg runtime 18.262s, speedup 0.327x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 191, train speedup 3.029, test speedup 1.757, val speedup 1.043
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 199, train speedup 2.985, test speedup 1.757, val speedup 1.043
last model at epoch 199, train speedup 2.985, test speedup 1.757, val speedup 1.043
execution cost 0:02:41.379448
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.042586, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507730| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141750| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.848000| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568960| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255941| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958113| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657204| train set 1.010x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.385721| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.094397| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.803226| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.512117| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.224487| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 16
Epoch 16/200 |loss: 25.986393| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.816847| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 18
Epoch 18/200 |loss: 25.774057| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 19
Epoch 19/200 |loss: 25.520227| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 20
Epoch 20/200 |loss: 24.962416| train set 1.066x speedup, test set 2.529x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 25.012184| train set 1.064x speedup, test set 2.529x speedup, val set 0.909x speedup, step: 22
Epoch 22/200 |loss: 24.823385| train set 1.064x speedup, test set 2.529x speedup, val set 1.027x speedup, step: 23
Epoch 23/200 |loss: 24.302458| train set 1.070x speedup, test set 2.500x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.429209| train set 1.070x speedup, test set 2.526x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 24.016212| train set 1.845x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.728014| train set 1.071x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 23.714937| train set 1.105x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 28
Epoch 28/200 |loss: 23.264626| train set 2.202x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 29
Epoch 29/200 |loss: 23.113901| train set 1.062x speedup, test set 2.447x speedup, val set 0.909x speedup, step: 30
Epoch 30/200 |loss: 23.049032| train set 2.226x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.618128| train set 2.029x speedup, test set 2.478x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.400318| train set 2.203x speedup, test set 2.483x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 22.497559| train set 1.820x speedup, test set 2.450x speedup, val set 1.039x speedup, step: 34
Epoch 34/200 |loss: 22.521095| train set 2.230x speedup, test set 2.451x speedup, val set 0.957x speedup, step: 35
Epoch 35/200 |loss: 22.015476| train set 1.917x speedup, test set 1.623x speedup, val set 1.039x speedup, step: 36
Epoch 36/200 |loss: 22.128967| train set 2.210x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 37
Epoch 37/200 |loss: 22.102419| train set 2.230x speedup, test set 1.614x speedup, val set 0.957x speedup, step: 38
Epoch 38/200 |loss: 21.504827| train set 2.171x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 39
Epoch 39/200 |loss: 21.742872| train set 2.230x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 40
Epoch 40/200 |loss: 21.360538| train set 2.238x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 41
Epoch 41/200 |loss: 20.876467| train set 2.217x speedup, test set 1.614x speedup, val set 0.983x speedup, step: 42
Epoch 42/200 |loss: 21.274027| train set 2.217x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 43
Epoch 43/200 |loss: 20.333307| train set 2.311x speedup, test set 1.614x speedup, val set 1.043x speedup, step: 44
Epoch 44/200 |loss: 20.640697| train set 2.170x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 45
Epoch 45/200 |loss: 20.388174| train set 2.189x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 46
Epoch 46/200 |loss: 20.209023| train set 2.244x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 47
Epoch 47/200 |loss: 20.318850| train set 2.371x speedup, test set 1.619x speedup, val set 1.000x speedup, step: 48
Epoch 48/200 |loss: 19.909149| train set 2.273x speedup, test set 1.620x speedup, val set 1.039x speedup, step: 49
Epoch 49/200 |loss: 19.637978| train set 2.270x speedup, test set 1.620x speedup, val set 1.039x speedup, step: 50
Epoch 50/200 |loss: 19.339809| train set 2.353x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 51
Epoch 51/200 |loss: 19.198469| train set 2.273x speedup, test set 1.620x speedup, val set 1.039x speedup, step: 52
Epoch 52/200 |loss: 19.055098| train set 2.337x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 53
Epoch 53/200 |loss: 18.755226| train set 2.270x speedup, test set 1.620x speedup, val set 1.039x speedup, step: 54
Epoch 54/200 |loss: 18.866030| train set 2.337x speedup, test set 1.619x speedup, val set 1.000x speedup, step: 55
Epoch 55/200 |loss: 18.537201| train set 2.353x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 56
Epoch 56/200 |loss: 18.526882| train set 2.447x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 57
Epoch 57/200 |loss: 18.538919| train set 2.270x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 58
Epoch 58/200 |loss: 18.770256| train set 2.359x speedup, test set 1.686x speedup, val set 0.873x speedup, step: 59
Epoch 59/200 |loss: 18.673380| train set 2.282x speedup, test set 1.619x speedup, val set 0.873x speedup, step: 60
Epoch 60/200 |loss: 18.614115| train set 2.270x speedup, test set 1.638x speedup, val set 1.039x speedup, step: 61
Epoch 61/200 |loss: 18.710218| train set 2.712x speedup, test set 1.686x speedup, val set 1.000x speedup, step: 62
Epoch 62/200 |loss: 18.371132| train set 2.349x speedup, test set 1.630x speedup, val set 0.996x speedup, step: 63
Epoch 63/200 |loss: 18.164972| train set 2.354x speedup, test set 1.619x speedup, val set 0.873x speedup, step: 64
Epoch 64/200 |loss: 18.254139| train set 2.549x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 65
Epoch 65/200 |loss: 18.363047| train set 2.300x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 66
Epoch 66/200 |loss: 17.178654| train set 2.463x speedup, test set 1.629x speedup, val set 0.873x speedup, step: 67
Epoch 67/200 |loss: 18.307194| train set 2.295x speedup, test set 1.611x speedup, val set 1.000x speedup, step: 68
Epoch 68/200 |loss: 17.271891| train set 2.273x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 69
Epoch 69/200 |loss: 17.116419| train set 2.751x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 70
Epoch 70/200 |loss: 16.927992| train set 2.556x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 71
Epoch 71/200 |loss: 16.650330| train set 2.447x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 72
Epoch 72/200 |loss: 16.745670| train set 2.361x speedup, test set 1.648x speedup, val set 1.039x speedup, step: 73
Epoch 73/200 |loss: 16.368944| train set 2.896x speedup, test set 1.690x speedup, val set 1.000x speedup, step: 74
Epoch 74/200 |loss: 16.293594| train set 2.473x speedup, test set 1.634x speedup, val set 0.873x speedup, step: 75
Epoch 75/200 |loss: 16.091801| train set 2.388x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 76
Epoch 76/200 |loss: 15.787275| train set 2.625x speedup, test set 1.693x speedup, val set 1.043x speedup, step: 77
Epoch 77/200 |loss: 15.845407| train set 2.743x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 78
Epoch 78/200 |loss: 15.315733| train set 2.754x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 79
Epoch 79/200 |loss: 15.468343| train set 2.742x speedup, test set 1.634x speedup, val set 1.043x speedup, step: 80
Epoch 80/200 |loss: 15.692305| train set 2.757x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 81
Epoch 81/200 |loss: 18.664835| train set 2.277x speedup, test set 1.648x speedup, val set 1.039x speedup, step: 82
Epoch 82/200 |loss: 17.362762| train set 2.613x speedup, test set 1.690x speedup, val set 0.873x speedup, step: 83
Epoch 83/200 |loss: 16.214912| train set 2.768x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 84
Epoch 84/200 |loss: 18.057709| train set 2.625x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 85
Epoch 85/200 |loss: 15.708188| train set 2.552x speedup, test set 1.654x speedup, val set 1.000x speedup, step: 86
Epoch 86/200 |loss: 16.529055| train set 2.897x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 87
Epoch 87/200 |loss: 16.500414| train set 2.897x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 88
Epoch 88/200 |loss: 15.166181| train set 2.559x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 89
Epoch 89/200 |loss: 16.622559| train set 2.759x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 14.884935| train set 2.583x speedup, test set 1.677x speedup, val set 1.003x speedup, step: 91
Epoch 91/200 |loss: 15.391224| train set 2.875x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 14.815353| train set 2.754x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 14.807539| train set 2.758x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 14.287786| train set 2.911x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 14.503732| train set 2.745x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 14.070653| train set 2.902x speedup, test set 1.683x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 13.975038| train set 2.759x speedup, test set 1.698x speedup, val set 1.043x speedup, step: 98
Epoch 98/200 |loss: 13.834553| train set 2.912x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 13.888654| train set 2.635x speedup, test set 1.708x speedup, val set 1.046x speedup, step: 100
Epoch 100/200 |loss: 14.059945| train set 2.902x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 13.944232| train set 2.967x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 1
Epoch 102/200 |loss: 13.632878| train set 2.913x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 1
Epoch 103/200 |loss: 13.126040| train set 2.759x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 1
Epoch 104/200 |loss: 12.881499| train set 2.760x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 1
Epoch 105/200 |loss: 12.921076| train set 2.902x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 1
Epoch 106/200 |loss: 13.315290| train set 2.695x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 1
Epoch 107/200 |loss: 14.251814| train set 2.905x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 1
Epoch 108/200 |loss: 16.371979| train set 2.906x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 1
Epoch 109/200 |loss: 13.575062| train set 2.813x speedup, test set 1.705x speedup, val set 1.000x speedup, step: 1
Epoch 110/200 |loss: 16.313807| train set 2.905x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 1
Epoch 111/200 |loss: 15.788090| train set 2.776x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 1
Epoch 112/200 |loss: 14.190545| train set 2.586x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 113/200 |loss: 16.241463| train set 2.912x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 2
Epoch 114/200 |loss: 14.161697| train set 2.908x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 3
Epoch 115/200 |loss: 14.110149| train set 2.558x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 116/200 |loss: 13.898097| train set 2.683x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 117/200 |loss: 13.547371| train set 2.919x speedup, test set 1.692x speedup, val set 0.984x speedup, step: 3
Epoch 118/200 |loss: 13.390910| train set 2.913x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 4
Epoch 119/200 |loss: 13.189706| train set 2.746x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 5
Epoch 120/200 |loss: 12.923543| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 6
Epoch 121/200 |loss: 12.916798| train set 2.760x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 122/200 |loss: 12.261151| train set 2.913x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 8
Epoch 123/200 |loss: 12.639305| train set 2.956x speedup, test set 1.687x speedup, val set 0.987x speedup, step: 9
Epoch 124/200 |loss: 12.475093| train set 2.905x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 10
Epoch 125/200 |loss: 13.614008| train set 2.629x speedup, test set 1.687x speedup, val set 1.039x speedup, step: 11
Epoch 126/200 |loss: 14.169209| train set 2.892x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 12
Epoch 127/200 |loss: 12.123084| train set 2.917x speedup, test set 1.673x speedup, val set 1.132x speedup, step: 1
Epoch 128/200 |loss: 12.950330| train set 2.919x speedup, test set 1.687x speedup, val set 0.987x speedup, step: 2
Epoch 129/200 |loss: 12.608744| train set 2.764x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 130/200 |loss: 12.163359| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 4
Epoch 131/200 |loss: 11.906754| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 5
Epoch 132/200 |loss: 12.196143| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 6
Epoch 133/200 |loss: 11.606198| train set 2.960x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 134/200 |loss: 11.745440| train set 2.949x speedup, test set 1.687x speedup, val set 1.003x speedup, step: 8
Epoch 135/200 |loss: 11.436227| train set 2.908x speedup, test set 1.687x speedup, val set 1.003x speedup, step: 9
Epoch 136/200 |loss: 11.482797| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 10
Epoch 137/200 |loss: 11.480586| train set 2.907x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 11
Epoch 138/200 |loss: 11.000253| train set 2.908x speedup, test set 1.687x speedup, val set 1.003x speedup, step: 12
Epoch 139/200 |loss: 11.148054| train set 2.958x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 13
Epoch 140/200 |loss: 11.149848| train set 2.907x speedup, test set 1.696x speedup, val set 0.984x speedup, step: 14
Epoch 141/200 |loss: 11.558944| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 15
Epoch 142/200 |loss: 10.736226| train set 2.918x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 16
Epoch 143/200 |loss: 10.780022| train set 2.908x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 17
Epoch 144/200 |loss: 10.581545| train set 2.959x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 18
Epoch 145/200 |loss: 10.396703| train set 2.918x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 19
Epoch 146/200 |loss: 10.539482| train set 2.972x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 20
Epoch 147/200 |loss: 10.485228| train set 2.908x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 21
Epoch 148/200 |loss: 10.789822| train set 2.904x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 22
Epoch 149/200 |loss: 10.399681| train set 2.918x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 23
Epoch 150/200 |loss: 10.306026| train set 2.959x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 24
Epoch 151/200 |loss: 10.252006| train set 2.908x speedup, test set 1.686x speedup, val set 1.000x speedup, step: 25
Epoch 152/200 |loss: 10.071156| train set 2.907x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 26
Epoch 153/200 |loss: 10.046330| train set 2.966x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 27
Epoch 154/200 |loss: 10.021787| train set 2.959x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 28
Epoch 155/200 |loss: 10.005100| train set 2.973x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 29
Epoch 156/200 |loss: 9.959035| train set 2.924x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 30
Epoch 157/200 |loss: 9.799561| train set 2.978x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 31
Epoch 158/200 |loss: 9.538814| train set 2.960x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 32
Epoch 159/200 |loss: 9.499296| train set 2.966x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 33
Epoch 160/200 |loss: 9.521268| train set 2.967x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 34
Epoch 161/200 |loss: 9.778638| train set 2.915x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 35
Epoch 162/200 |loss: 10.882383| train set 2.926x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 36
Epoch 163/200 |loss: 15.568943| train set 2.644x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 37
Epoch 164/200 |loss: 10.893375| train set 2.935x speedup, test set 1.684x speedup, val set 1.001x speedup, step: 38
Epoch 165/200 |loss: 14.608839| train set 2.982x speedup, test set 1.686x speedup, val set 1.000x speedup, step: 39
Epoch 166/200 |loss: 16.172150| train set 2.632x speedup, test set 1.677x speedup, val set 1.039x speedup, step: 40
Epoch 167/200 |loss: 15.242671| train set 2.561x speedup, test set 1.663x speedup, val set 1.043x speedup, step: 41
Epoch 168/200 |loss: 13.916280| train set 2.733x speedup, test set 1.654x speedup, val set 1.000x speedup, step: 42
Epoch 169/200 |loss: 13.514998| train set 2.823x speedup, test set 1.677x speedup, val set 1.231x speedup, step: 1
Epoch 170/200 |loss: 13.508265| train set 2.766x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 2
Epoch 171/200 |loss: 12.618975| train set 2.628x speedup, test set 1.668x speedup, val set 1.043x speedup, step: 3
Epoch 172/200 |loss: 12.690891| train set 2.664x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 4
Epoch 173/200 |loss: 11.936643| train set 2.939x speedup, test set 1.687x speedup, val set 0.984x speedup, step: 5
Epoch 174/200 |loss: 11.958596| train set 2.998x speedup, test set 1.696x speedup, val set 1.077x speedup, step: 6
Epoch 175/200 |loss: 11.749871| train set 2.985x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 176/200 |loss: 11.110023| train set 2.767x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 8
Epoch 177/200 |loss: 11.417362| train set 2.908x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 9
Epoch 178/200 |loss: 10.867292| train set 2.917x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 10
Epoch 179/200 |loss: 10.601074| train set 2.917x speedup, test set 1.708x speedup, val set 1.026x speedup, step: 11
Epoch 180/200 |loss: 10.890101| train set 2.920x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 12
Epoch 181/200 |loss: 10.131901| train set 2.908x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 13
Epoch 182/200 |loss: 10.463338| train set 2.908x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 14
Epoch 183/200 |loss: 10.073514| train set 2.978x speedup, test set 1.708x speedup, val set 0.984x speedup, step: 15
Epoch 184/200 |loss: 9.933567| train set 2.995x speedup, test set 1.708x speedup, val set 0.984x speedup, step: 16
Epoch 185/200 |loss: 9.873110| train set 2.948x speedup, test set 1.708x speedup, val set 0.984x speedup, step: 17
Epoch 186/200 |loss: 9.773685| train set 2.949x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 18
Epoch 187/200 |loss: 9.616925| train set 2.951x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 19
Epoch 188/200 |loss: 9.560856| train set 2.961x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 20
Epoch 189/200 |loss: 9.477628| train set 3.009x speedup, test set 1.708x speedup, val set 0.984x speedup, step: 21
Epoch 190/200 |loss: 9.436070| train set 2.950x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 22
Epoch 191/200 |loss: 9.295099| train set 3.027x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 23
Epoch 192/200 |loss: 9.307662| train set 2.960x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 24
Epoch 193/200 |loss: 9.202107| train set 3.024x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 25
Epoch 194/200 |loss: 9.180662| train set 2.962x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 26
Epoch 195/200 |loss: 9.099919| train set 3.018x speedup, test set 1.708x speedup, val set 1.026x speedup, step: 27
Epoch 196/200 |loss: 9.120229| train set 2.961x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 28
Epoch 197/200 |loss: 9.379841| train set 2.982x speedup, test set 1.708x speedup, val set 1.026x speedup, step: 29
Epoch 198/200 |loss: 9.617266| train set 2.961x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 30
Epoch 199/200 |loss: 9.948968| train set 3.030x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 31
Training per epoch cost 0.305 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 45.739s, pg runtime 32.278s, speedup 0.706x
06, opt runtime 25.597s, model runtime 39.374s, pg runtime 27.136s, speedup 0.689x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 199, train speedup 3.030, test speedup 1.708, val speedup 1.043
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 169, train speedup 2.823, test speedup 1.677, val speedup 1.231
last model at epoch 199, train speedup 3.030, test speedup 1.708, val speedup 1.043
execution cost 0:02:43.134179
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.174376, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507729| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141745| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847996| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568964| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255957| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958220| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657259| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.383945| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.092485| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.801277| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.505886| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.212013| train set 1.055x speedup, test set 2.499x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.964432| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.787682| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.950356| train set 1.054x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 19
Epoch 19/200 |loss: 25.432844| train set 1.054x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 20
Epoch 20/200 |loss: 24.987709| train set 1.064x speedup, test set 2.549x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 24.983614| train set 1.070x speedup, test set 2.529x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.563608| train set 1.070x speedup, test set 2.529x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.326574| train set 1.070x speedup, test set 2.529x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.259209| train set 1.071x speedup, test set 1.654x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.821630| train set 1.070x speedup, test set 1.616x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.660959| train set 2.024x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 23.551744| train set 1.128x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.165751| train set 1.156x speedup, test set 2.450x speedup, val set 0.897x speedup, step: 29
Epoch 29/200 |loss: 22.875580| train set 2.204x speedup, test set 2.475x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 22.744120| train set 1.119x speedup, test set 2.483x speedup, val set 0.897x speedup, step: 31
Epoch 31/200 |loss: 22.723492| train set 2.206x speedup, test set 2.451x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.514927| train set 2.209x speedup, test set 2.458x speedup, val set 0.909x speedup, step: 33
Epoch 33/200 |loss: 22.096052| train set 1.882x speedup, test set 2.500x speedup, val set 0.983x speedup, step: 34
Epoch 34/200 |loss: 22.056913| train set 2.118x speedup, test set 2.603x speedup, val set 0.870x speedup, step: 35
Epoch 35/200 |loss: 23.322517| train set 1.065x speedup, test set 1.631x speedup, val set 0.985x speedup, step: 36
Epoch 36/200 |loss: 22.371725| train set 1.924x speedup, test set 1.632x speedup, val set 1.042x speedup, step: 37
Epoch 37/200 |loss: 22.090725| train set 2.208x speedup, test set 1.613x speedup, val set 0.957x speedup, step: 38
Epoch 38/200 |loss: 21.968737| train set 2.239x speedup, test set 1.613x speedup, val set 0.921x speedup, step: 39
Epoch 39/200 |loss: 21.773214| train set 2.238x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 40
Epoch 40/200 |loss: 21.556025| train set 2.073x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 41
Epoch 41/200 |loss: 21.373674| train set 2.209x speedup, test set 1.615x speedup, val set 0.957x speedup, step: 42
Epoch 42/200 |loss: 21.126825| train set 2.238x speedup, test set 1.616x speedup, val set 0.812x speedup, step: 43
Epoch 43/200 |loss: 20.882730| train set 2.166x speedup, test set 1.632x speedup, val set 0.777x speedup, step: 44
Epoch 44/200 |loss: 20.825811| train set 2.146x speedup, test set 1.631x speedup, val set 0.983x speedup, step: 45
Epoch 45/200 |loss: 20.728239| train set 2.217x speedup, test set 1.634x speedup, val set 0.909x speedup, step: 46
Epoch 46/200 |loss: 20.482269| train set 2.200x speedup, test set 1.619x speedup, val set 0.924x speedup, step: 47
Epoch 47/200 |loss: 20.069180| train set 2.079x speedup, test set 1.637x speedup, val set 0.961x speedup, step: 48
Epoch 48/200 |loss: 19.849527| train set 2.212x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 49
Epoch 49/200 |loss: 19.478357| train set 2.259x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 50
Epoch 50/200 |loss: 19.458948| train set 2.270x speedup, test set 1.619x speedup, val set 1.042x speedup, step: 51
Epoch 51/200 |loss: 19.221758| train set 2.272x speedup, test set 1.619x speedup, val set 1.046x speedup, step: 52
Epoch 52/200 |loss: 19.269749| train set 2.560x speedup, test set 1.677x speedup, val set 0.824x speedup, step: 53
Epoch 53/200 |loss: 20.602819| train set 2.195x speedup, test set 1.611x speedup, val set 1.042x speedup, step: 54
Epoch 54/200 |loss: 21.550106| train set 2.270x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 55
Epoch 55/200 |loss: 19.707916| train set 2.436x speedup, test set 1.677x speedup, val set 0.924x speedup, step: 56
Epoch 56/200 |loss: 19.880880| train set 2.317x speedup, test set 1.619x speedup, val set 0.996x speedup, step: 57
Epoch 57/200 |loss: 19.421816| train set 2.240x speedup, test set 1.637x speedup, val set 1.042x speedup, step: 58
Epoch 58/200 |loss: 19.128139| train set 2.560x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 59
Epoch 59/200 |loss: 19.082056| train set 2.299x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 18.330490| train set 2.148x speedup, test set 1.637x speedup, val set 1.042x speedup, step: 61
Epoch 61/200 |loss: 18.864464| train set 2.299x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 62
Epoch 62/200 |loss: 17.994608| train set 2.561x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 63
Epoch 63/200 |loss: 18.346071| train set 2.232x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 64
Epoch 64/200 |loss: 18.322426| train set 2.371x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 65
Epoch 65/200 |loss: 17.980656| train set 2.356x speedup, test set 1.696x speedup, val set 0.875x speedup, step: 66
Epoch 66/200 |loss: 18.188381| train set 2.356x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 67
Epoch 67/200 |loss: 17.275352| train set 2.282x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 68
Epoch 68/200 |loss: 17.871511| train set 2.463x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 69
Epoch 69/200 |loss: 17.478933| train set 2.305x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 70
Epoch 70/200 |loss: 16.926178| train set 2.299x speedup, test set 1.628x speedup, val set 1.046x speedup, step: 71
Epoch 71/200 |loss: 17.352238| train set 2.358x speedup, test set 1.692x speedup, val set 1.046x speedup, step: 72
Epoch 72/200 |loss: 17.133759| train set 2.680x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 73
Epoch 73/200 |loss: 16.946390| train set 2.300x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 74
Epoch 74/200 |loss: 16.888023| train set 2.466x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 75
Epoch 75/200 |loss: 16.442482| train set 2.645x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 76
Epoch 76/200 |loss: 17.091990| train set 2.362x speedup, test set 1.628x speedup, val set 1.046x speedup, step: 77
Epoch 77/200 |loss: 15.983492| train set 2.569x speedup, test set 1.687x speedup, val set 0.875x speedup, step: 78
Epoch 78/200 |loss: 16.345772| train set 2.670x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 79
Epoch 79/200 |loss: 16.494843| train set 2.626x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 80
Epoch 80/200 |loss: 15.634149| train set 2.570x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 81
Epoch 81/200 |loss: 15.922682| train set 2.295x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 82
Epoch 82/200 |loss: 15.487949| train set 2.771x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 83
Epoch 83/200 |loss: 16.405996| train set 2.757x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 84
Epoch 84/200 |loss: 15.214246| train set 2.468x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 85
Epoch 85/200 |loss: 15.119317| train set 2.885x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 86
Epoch 86/200 |loss: 15.007009| train set 2.771x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 87
Epoch 87/200 |loss: 14.790863| train set 2.772x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 88
Epoch 88/200 |loss: 14.718262| train set 2.402x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 89
Epoch 89/200 |loss: 14.811436| train set 2.626x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 90
Epoch 90/200 |loss: 15.403660| train set 2.897x speedup, test set 1.687x speedup, val set 1.132x speedup, step: 91
Epoch 91/200 |loss: 15.690778| train set 2.365x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 92
Epoch 92/200 |loss: 14.650394| train set 2.628x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 93
Epoch 93/200 |loss: 14.085508| train set 2.889x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 14.647943| train set 2.759x speedup, test set 1.687x speedup, val set 0.975x speedup, step: 95
Epoch 95/200 |loss: 14.415989| train set 2.639x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 96
Epoch 96/200 |loss: 14.957801| train set 2.901x speedup, test set 1.687x speedup, val set 1.132x speedup, step: 97
Epoch 97/200 |loss: 16.918684| train set 2.281x speedup, test set 1.628x speedup, val set 0.968x speedup, step: 98
Epoch 98/200 |loss: 15.809075| train set 2.892x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 99
Epoch 99/200 |loss: 13.561481| train set 2.906x speedup, test set 1.687x speedup, val set 1.132x speedup, step: 100
Epoch 100/200 |loss: 15.060239| train set 2.627x speedup, test set 1.628x speedup, val set 0.972x speedup, step: 1
Epoch 101/200 |loss: 14.494978| train set 2.627x speedup, test set 1.628x speedup, val set 0.972x speedup, step: 1
Epoch 102/200 |loss: 14.252797| train set 2.905x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 103/200 |loss: 13.743566| train set 2.796x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 2
Epoch 104/200 |loss: 13.894065| train set 2.731x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 3
Epoch 105/200 |loss: 14.378913| train set 2.633x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 106/200 |loss: 13.206690| train set 2.675x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 107/200 |loss: 13.549539| train set 2.913x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 3
Epoch 108/200 |loss: 13.756894| train set 2.759x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 4
Epoch 109/200 |loss: 12.980343| train set 2.907x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 5
Epoch 110/200 |loss: 13.071630| train set 2.903x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 6
Epoch 111/200 |loss: 13.084471| train set 2.756x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 7
Epoch 112/200 |loss: 13.136662| train set 2.902x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 8
Epoch 113/200 |loss: 12.226039| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 9
Epoch 114/200 |loss: 13.037653| train set 2.639x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 10
Epoch 115/200 |loss: 12.905888| train set 2.760x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 11
Epoch 116/200 |loss: 12.974226| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 12
Epoch 117/200 |loss: 12.156444| train set 2.913x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 13
Epoch 118/200 |loss: 12.658195| train set 2.903x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 14
Epoch 119/200 |loss: 13.390108| train set 2.907x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 15
Epoch 120/200 |loss: 11.885004| train set 2.917x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 16
Epoch 121/200 |loss: 13.043588| train set 2.906x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 17
Epoch 122/200 |loss: 14.180477| train set 2.764x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 18
Epoch 123/200 |loss: 12.580899| train set 2.714x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 19
Epoch 124/200 |loss: 13.807034| train set 2.906x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 20
Epoch 125/200 |loss: 13.829820| train set 2.791x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 21
Epoch 126/200 |loss: 13.361131| train set 2.655x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 22
Epoch 127/200 |loss: 12.901710| train set 2.917x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 23
Epoch 128/200 |loss: 12.546270| train set 2.908x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 24
Epoch 129/200 |loss: 12.164668| train set 2.751x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 25
Epoch 130/200 |loss: 12.438818| train set 2.917x speedup, test set 1.687x speedup, val set 0.920x speedup, step: 26
Epoch 131/200 |loss: 11.534493| train set 2.918x speedup, test set 1.687x speedup, val set 1.031x speedup, step: 27
Epoch 132/200 |loss: 12.337280| train set 2.765x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 28
Epoch 133/200 |loss: 11.168267| train set 2.634x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 29
Epoch 134/200 |loss: 11.711323| train set 2.917x speedup, test set 1.687x speedup, val set 0.920x speedup, step: 30
Epoch 135/200 |loss: 11.101588| train set 2.904x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 31
Epoch 136/200 |loss: 11.236396| train set 2.761x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 32
Epoch 137/200 |loss: 10.944845| train set 2.764x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 33
Epoch 138/200 |loss: 11.149170| train set 2.917x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 34
Epoch 139/200 |loss: 10.538166| train set 2.963x speedup, test set 1.687x speedup, val set 0.920x speedup, step: 35
Epoch 140/200 |loss: 10.936939| train set 2.924x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 36
Epoch 141/200 |loss: 10.712749| train set 2.765x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 37
Epoch 142/200 |loss: 10.560417| train set 2.960x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 38
Epoch 143/200 |loss: 10.306529| train set 2.960x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 39
Epoch 144/200 |loss: 10.486230| train set 2.959x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 40
Epoch 145/200 |loss: 10.510460| train set 2.908x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 41
Epoch 146/200 |loss: 10.191960| train set 2.919x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 42
Epoch 147/200 |loss: 10.079099| train set 2.924x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 43
Epoch 148/200 |loss: 10.064378| train set 2.946x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 44
Epoch 149/200 |loss: 10.748250| train set 2.777x speedup, test set 1.687x speedup, val set 0.959x speedup, step: 45
Epoch 150/200 |loss: 12.503233| train set 2.903x speedup, test set 1.687x speedup, val set 1.048x speedup, step: 1
Epoch 151/200 |loss: 12.935840| train set 2.940x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 2
Epoch 152/200 |loss: 11.622629| train set 2.876x speedup, test set 1.687x speedup, val set 0.975x speedup, step: 3
Epoch 153/200 |loss: 12.572069| train set 2.965x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 4
Epoch 154/200 |loss: 10.987093| train set 2.936x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 5
Epoch 155/200 |loss: 11.116203| train set 2.761x speedup, test set 1.640x speedup, val set 0.972x speedup, step: 6
Epoch 156/200 |loss: 11.240106| train set 2.778x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 7
Epoch 157/200 |loss: 10.832242| train set 2.863x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 8
Epoch 158/200 |loss: 11.069425| train set 2.917x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 9
Epoch 159/200 |loss: 10.587772| train set 2.765x speedup, test set 1.687x speedup, val set 0.975x speedup, step: 10
Epoch 160/200 |loss: 10.906078| train set 2.908x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 11
Epoch 161/200 |loss: 10.491667| train set 2.908x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 12
Epoch 162/200 |loss: 10.388485| train set 2.978x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 13
Epoch 163/200 |loss: 9.964406| train set 3.021x speedup, test set 1.687x speedup, val set 0.975x speedup, step: 14
Epoch 164/200 |loss: 9.942477| train set 2.938x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 15
Epoch 165/200 |loss: 9.970310| train set 2.904x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 16
Epoch 166/200 |loss: 9.775018| train set 2.908x speedup, test set 1.687x speedup, val set 0.957x speedup, step: 17
Epoch 167/200 |loss: 10.299604| train set 2.966x speedup, test set 1.687x speedup, val set 0.937x speedup, step: 18
Epoch 168/200 |loss: 11.171184| train set 2.800x speedup, test set 1.687x speedup, val set 0.975x speedup, step: 19
Epoch 169/200 |loss: 10.771890| train set 2.967x speedup, test set 1.687x speedup, val set 0.959x speedup, step: 20
Epoch 170/200 |loss: 10.093457| train set 2.960x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 21
Epoch 171/200 |loss: 9.645296| train set 2.826x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 22
Epoch 172/200 |loss: 9.933212| train set 2.984x speedup, test set 1.687x speedup, val set 0.959x speedup, step: 23
Epoch 173/200 |loss: 10.362289| train set 2.960x speedup, test set 1.687x speedup, val set 0.824x speedup, step: 24
Epoch 174/200 |loss: 9.466084| train set 2.949x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 25
Epoch 175/200 |loss: 9.485265| train set 2.927x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 26
Epoch 176/200 |loss: 10.056905| train set 2.962x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 27
Epoch 177/200 |loss: 9.532927| train set 2.962x speedup, test set 1.687x speedup, val set 0.959x speedup, step: 28
Epoch 178/200 |loss: 9.153383| train set 3.005x speedup, test set 1.687x speedup, val set 0.957x speedup, step: 29
Epoch 179/200 |loss: 9.329440| train set 2.937x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 30
Epoch 180/200 |loss: 9.458066| train set 2.908x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 31
Epoch 181/200 |loss: 9.428187| train set 3.024x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 32
Epoch 182/200 |loss: 8.961132| train set 2.968x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 33
Epoch 183/200 |loss: 8.991788| train set 2.924x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 34
Epoch 184/200 |loss: 9.259091| train set 2.949x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 35
Epoch 185/200 |loss: 9.125097| train set 2.966x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 36
Epoch 186/200 |loss: 8.900196| train set 3.049x speedup, test set 1.687x speedup, val set 0.957x speedup, step: 37
Epoch 187/200 |loss: 8.772166| train set 2.951x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 38
Epoch 188/200 |loss: 8.758782| train set 3.031x speedup, test set 1.701x speedup, val set 0.972x speedup, step: 39
Epoch 189/200 |loss: 8.933135| train set 2.960x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 40
Epoch 190/200 |loss: 8.974703| train set 3.028x speedup, test set 1.701x speedup, val set 0.972x speedup, step: 41
Epoch 191/200 |loss: 9.063243| train set 3.011x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 42
Epoch 192/200 |loss: 8.777701| train set 2.968x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 43
Epoch 193/200 |loss: 8.664042| train set 3.024x speedup, test set 1.701x speedup, val set 0.972x speedup, step: 44
Epoch 194/200 |loss: 8.527575| train set 2.951x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 45
Epoch 195/200 |loss: 8.610579| train set 3.005x speedup, test set 1.701x speedup, val set 0.972x speedup, step: 46
Epoch 196/200 |loss: 8.830993| train set 2.939x speedup, test set 1.701x speedup, val set 0.972x speedup, step: 47
Epoch 197/200 |loss: 8.846501| train set 3.031x speedup, test set 1.701x speedup, val set 0.972x speedup, step: 48
Epoch 198/200 |loss: 9.034476| train set 3.017x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 49
Epoch 199/200 |loss: 8.881053| train set 2.962x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 50
Training per epoch cost 0.299 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 186, train speedup 3.049, test speedup 1.687, val speedup 0.957
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 150, train speedup 2.903, test speedup 1.687, val speedup 1.048
last model at epoch 199, train speedup 2.962, test speedup 1.687, val speedup 0.972
execution cost 0:02:41.023146
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.079978, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507730| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141750| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.848000| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568960| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255947| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958145| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657238| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.384762| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.093855| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.804552| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.510292| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.223167| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 16
Epoch 16/200 |loss: 25.974043| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.769272| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.786594| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 19
Epoch 19/200 |loss: 25.713722| train set 1.055x speedup, test set 2.549x speedup, val set 1.027x speedup, step: 20
Epoch 20/200 |loss: 24.977991| train set 1.064x speedup, test set 2.493x speedup, val set 1.027x speedup, step: 21
Epoch 21/200 |loss: 25.201517| train set 1.064x speedup, test set 2.529x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.743507| train set 1.064x speedup, test set 2.529x speedup, val set 1.027x speedup, step: 23
Epoch 23/200 |loss: 24.482395| train set 1.071x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.433214| train set 1.070x speedup, test set 2.500x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.919153| train set 1.105x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.950464| train set 1.106x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 23.516367| train set 1.062x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.419247| train set 2.201x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 29
Epoch 29/200 |loss: 23.212688| train set 2.029x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 22.808548| train set 1.119x speedup, test set 2.475x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.820768| train set 2.227x speedup, test set 2.475x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.577280| train set 1.998x speedup, test set 2.475x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 22.190830| train set 2.230x speedup, test set 2.501x speedup, val set 0.957x speedup, step: 34
Epoch 34/200 |loss: 22.190006| train set 2.005x speedup, test set 1.629x speedup, val set 1.042x speedup, step: 35
Epoch 35/200 |loss: 22.527893| train set 2.181x speedup, test set 1.621x speedup, val set 0.961x speedup, step: 36
Epoch 36/200 |loss: 22.108767| train set 1.119x speedup, test set 1.640x speedup, val set 1.042x speedup, step: 37
Epoch 37/200 |loss: 21.871382| train set 2.239x speedup, test set 1.624x speedup, val set 0.957x speedup, step: 38
Epoch 38/200 |loss: 21.832960| train set 2.190x speedup, test set 1.624x speedup, val set 0.957x speedup, step: 39
Epoch 39/200 |loss: 21.199471| train set 2.218x speedup, test set 1.642x speedup, val set 1.039x speedup, step: 40
Epoch 40/200 |loss: 21.129446| train set 2.239x speedup, test set 1.624x speedup, val set 1.039x speedup, step: 41
Epoch 41/200 |loss: 21.336029| train set 2.229x speedup, test set 1.624x speedup, val set 0.957x speedup, step: 42
Epoch 42/200 |loss: 20.673273| train set 2.239x speedup, test set 1.642x speedup, val set 1.039x speedup, step: 43
Epoch 43/200 |loss: 20.724037| train set 2.320x speedup, test set 1.632x speedup, val set 0.961x speedup, step: 44
Epoch 44/200 |loss: 20.905247| train set 2.156x speedup, test set 1.624x speedup, val set 0.983x speedup, step: 45
Epoch 45/200 |loss: 20.595957| train set 2.179x speedup, test set 1.613x speedup, val set 0.957x speedup, step: 46
Epoch 46/200 |loss: 20.338118| train set 2.419x speedup, test set 1.632x speedup, val set 0.961x speedup, step: 47
Epoch 47/200 |loss: 20.867392| train set 2.325x speedup, test set 1.619x speedup, val set 0.961x speedup, step: 48
Epoch 48/200 |loss: 19.543638| train set 2.158x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 49
Epoch 49/200 |loss: 20.439859| train set 2.270x speedup, test set 1.613x speedup, val set 1.042x speedup, step: 50
Epoch 50/200 |loss: 19.419519| train set 2.460x speedup, test set 1.677x speedup, val set 0.814x speedup, step: 51
Epoch 51/200 |loss: 19.936659| train set 2.206x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 52
Epoch 52/200 |loss: 19.705805| train set 2.280x speedup, test set 1.619x speedup, val set 1.000x speedup, step: 53
Epoch 53/200 |loss: 19.658298| train set 2.270x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 54
Epoch 54/200 |loss: 19.051058| train set 2.356x speedup, test set 1.619x speedup, val set 1.000x speedup, step: 55
Epoch 55/200 |loss: 18.959511| train set 2.440x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 56
Epoch 56/200 |loss: 18.499695| train set 2.353x speedup, test set 1.648x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 19.032595| train set 2.337x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 58
Epoch 58/200 |loss: 18.355005| train set 2.353x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 18.285372| train set 2.354x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 17.934593| train set 2.444x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 61
Epoch 61/200 |loss: 18.089251| train set 2.356x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 62
Epoch 62/200 |loss: 17.724680| train set 2.453x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 63
Epoch 63/200 |loss: 17.969805| train set 2.349x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 64
Epoch 64/200 |loss: 17.756149| train set 2.394x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 65
Epoch 65/200 |loss: 17.963556| train set 2.352x speedup, test set 1.619x speedup, val set 0.873x speedup, step: 66
Epoch 66/200 |loss: 17.216719| train set 2.351x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 67
Epoch 67/200 |loss: 17.015728| train set 2.622x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 68
Epoch 68/200 |loss: 17.054256| train set 2.657x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 69
Epoch 69/200 |loss: 16.858866| train set 2.357x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 70
Epoch 70/200 |loss: 17.177198| train set 2.287x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 71
Epoch 71/200 |loss: 17.229959| train set 2.359x speedup, test set 1.648x speedup, val set 1.039x speedup, step: 72
Epoch 72/200 |loss: 16.831594| train set 2.893x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 73
Epoch 73/200 |loss: 16.410105| train set 2.547x speedup, test set 1.708x speedup, val set 1.043x speedup, step: 74
Epoch 74/200 |loss: 17.315838| train set 2.879x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 75
Epoch 75/200 |loss: 19.539911| train set 2.360x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 76
Epoch 76/200 |loss: 16.345896| train set 2.327x speedup, test set 1.637x speedup, val set 1.000x speedup, step: 77
Epoch 77/200 |loss: 19.066820| train set 2.767x speedup, test set 1.696x speedup, val set 0.814x speedup, step: 78
Epoch 78/200 |loss: 17.147034| train set 2.362x speedup, test set 1.637x speedup, val set 1.046x speedup, step: 79
Epoch 79/200 |loss: 17.411161| train set 2.280x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 80
Epoch 80/200 |loss: 17.398493| train set 2.457x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 81
Epoch 81/200 |loss: 16.075426| train set 2.754x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 82
Epoch 82/200 |loss: 16.681723| train set 2.668x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 83
Epoch 83/200 |loss: 15.996167| train set 2.399x speedup, test set 1.699x speedup, val set 0.873x speedup, step: 84
Epoch 84/200 |loss: 16.095032| train set 2.629x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 85
Epoch 85/200 |loss: 16.004921| train set 2.628x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 86
Epoch 86/200 |loss: 15.416080| train set 2.557x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 87
Epoch 87/200 |loss: 15.737640| train set 2.754x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 88
Epoch 88/200 |loss: 15.043759| train set 2.362x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 89
Epoch 89/200 |loss: 15.134798| train set 2.671x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 14.842679| train set 2.901x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 91
Epoch 91/200 |loss: 14.433960| train set 2.901x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 14.525846| train set 2.901x speedup, test set 1.692x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 14.604856| train set 2.625x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 94
Epoch 94/200 |loss: 14.304304| train set 2.900x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 14.074463| train set 2.912x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 14.476973| train set 2.901x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 97
Epoch 97/200 |loss: 14.857690| train set 2.308x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 98
Epoch 98/200 |loss: 14.401240| train set 2.899x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 14.341433| train set 2.758x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 100
Epoch 100/200 |loss: 14.444652| train set 2.769x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 1
Epoch 101/200 |loss: 13.247334| train set 2.900x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 1
Epoch 102/200 |loss: 13.887900| train set 2.626x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 103/200 |loss: 13.646925| train set 2.905x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 2
Epoch 104/200 |loss: 12.890294| train set 2.912x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 3
Epoch 105/200 |loss: 13.393226| train set 2.890x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 4
Epoch 106/200 |loss: 13.813656| train set 2.561x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 1
Epoch 107/200 |loss: 13.536387| train set 2.856x speedup, test set 1.681x speedup, val set 0.971x speedup, step: 2
Epoch 108/200 |loss: 14.407423| train set 2.329x speedup, test set 1.628x speedup, val set 0.967x speedup, step: 3
Epoch 109/200 |loss: 15.617907| train set 2.749x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 4
Epoch 110/200 |loss: 14.480394| train set 2.900x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 5
Epoch 111/200 |loss: 13.708221| train set 2.690x speedup, test set 1.696x speedup, val set 0.920x speedup, step: 6
Epoch 112/200 |loss: 16.082733| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 113/200 |loss: 14.769077| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 8
Epoch 114/200 |loss: 14.959660| train set 2.551x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 115/200 |loss: 14.443946| train set 2.913x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 116/200 |loss: 13.335831| train set 2.909x speedup, test set 1.696x speedup, val set 1.132x speedup, step: 1
Epoch 117/200 |loss: 13.846085| train set 2.887x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 118/200 |loss: 13.066974| train set 2.664x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 119/200 |loss: 12.954175| train set 2.760x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 4
Epoch 120/200 |loss: 12.864522| train set 2.913x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 5
Epoch 121/200 |loss: 12.299711| train set 2.826x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 6
Epoch 122/200 |loss: 12.637387| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 123/200 |loss: 12.265690| train set 2.751x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 8
Epoch 124/200 |loss: 12.183145| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 9
Epoch 125/200 |loss: 11.968909| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 10
Epoch 126/200 |loss: 12.179401| train set 2.902x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 11
Epoch 127/200 |loss: 11.811177| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 12
Epoch 128/200 |loss: 11.848226| train set 2.968x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 13
Epoch 129/200 |loss: 12.103581| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 14
Epoch 130/200 |loss: 11.858968| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 15
Epoch 131/200 |loss: 11.459243| train set 2.916x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 16
Epoch 132/200 |loss: 11.147524| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 17
Epoch 133/200 |loss: 11.342640| train set 2.965x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 18
Epoch 134/200 |loss: 11.773168| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 19
Epoch 135/200 |loss: 11.265703| train set 2.923x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 20
Epoch 136/200 |loss: 10.897232| train set 2.948x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 21
Epoch 137/200 |loss: 10.765159| train set 2.959x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 22
Epoch 138/200 |loss: 10.900355| train set 2.963x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 23
Epoch 139/200 |loss: 10.851059| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 24
Epoch 140/200 |loss: 10.806388| train set 2.917x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 25
Epoch 141/200 |loss: 10.583542| train set 2.917x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 26
Epoch 142/200 |loss: 10.454220| train set 2.965x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 27
Epoch 143/200 |loss: 10.263549| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 28
Epoch 144/200 |loss: 10.248886| train set 2.949x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 29
Epoch 145/200 |loss: 10.467307| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 30
Epoch 146/200 |loss: 11.476534| train set 2.810x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 31
Epoch 147/200 |loss: 11.931119| train set 2.924x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 32
Epoch 148/200 |loss: 12.690155| train set 2.919x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 33
Epoch 149/200 |loss: 10.460449| train set 2.949x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 34
Epoch 150/200 |loss: 12.044846| train set 2.908x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 35
Epoch 151/200 |loss: 13.025465| train set 2.648x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 36
Epoch 152/200 |loss: 11.910463| train set 2.803x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 37
Epoch 153/200 |loss: 12.615085| train set 2.975x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 38
Epoch 154/200 |loss: 11.810436| train set 2.908x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 39
Epoch 155/200 |loss: 12.619118| train set 2.676x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 40
Epoch 156/200 |loss: 12.327636| train set 2.907x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 41
Epoch 157/200 |loss: 11.794757| train set 2.943x speedup, test set 1.736x speedup, val set 1.000x speedup, step: 42
Epoch 158/200 |loss: 11.560853| train set 2.983x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 43
Epoch 159/200 |loss: 11.064104| train set 2.914x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 44
Epoch 160/200 |loss: 11.262983| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 45
Epoch 161/200 |loss: 10.501142| train set 2.781x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 46
Epoch 162/200 |loss: 10.801320| train set 2.945x speedup, test set 1.746x speedup, val set 1.000x speedup, step: 47
Epoch 163/200 |loss: 10.354848| train set 2.904x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 48
Epoch 164/200 |loss: 10.444998| train set 2.915x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 49
Epoch 165/200 |loss: 10.159940| train set 2.911x speedup, test set 1.681x speedup, val set 1.043x speedup, step: 50
Epoch 166/200 |loss: 10.324554| train set 2.919x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 51
Epoch 167/200 |loss: 9.778778| train set 2.979x speedup, test set 1.696x speedup, val set 0.984x speedup, step: 52
Epoch 168/200 |loss: 9.904338| train set 2.908x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 53
Epoch 169/200 |loss: 9.785994| train set 2.967x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 54
Epoch 170/200 |loss: 9.685411| train set 2.919x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 55
Epoch 171/200 |loss: 9.576867| train set 2.919x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 56
Epoch 172/200 |loss: 9.495064| train set 2.984x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 57
Epoch 173/200 |loss: 9.469907| train set 2.911x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 58
Epoch 174/200 |loss: 9.475082| train set 2.980x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 59
Epoch 175/200 |loss: 9.360289| train set 2.966x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 60
Epoch 176/200 |loss: 9.478093| train set 2.962x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 61
Epoch 177/200 |loss: 9.358594| train set 2.952x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 62
Epoch 178/200 |loss: 9.445426| train set 3.024x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 63
Epoch 179/200 |loss: 9.415046| train set 2.942x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 64
Epoch 180/200 |loss: 9.391334| train set 3.010x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 65
Epoch 181/200 |loss: 9.270908| train set 3.013x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 66
Epoch 182/200 |loss: 9.254038| train set 2.952x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 67
Epoch 183/200 |loss: 9.057874| train set 2.986x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 68
Epoch 184/200 |loss: 9.065664| train set 2.969x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 69
Epoch 185/200 |loss: 8.908356| train set 2.952x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 70
Epoch 186/200 |loss: 8.967867| train set 3.021x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 71
Epoch 187/200 |loss: 9.018717| train set 3.014x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 72
Epoch 188/200 |loss: 9.120378| train set 2.912x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 73
Epoch 189/200 |loss: 9.498662| train set 3.012x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 74
Epoch 190/200 |loss: 9.414525| train set 2.911x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 75
Epoch 191/200 |loss: 9.340119| train set 3.049x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 76
Epoch 192/200 |loss: 8.934235| train set 2.961x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 77
Epoch 193/200 |loss: 8.989795| train set 2.971x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 78
Epoch 194/200 |loss: 9.643291| train set 2.950x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 79
Epoch 195/200 |loss: 9.541154| train set 2.974x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 80
Epoch 196/200 |loss: 9.485429| train set 2.928x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 81
Epoch 197/200 |loss: 9.080017| train set 2.971x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 82
Epoch 198/200 |loss: 9.300393| train set 3.021x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 83
Epoch 199/200 |loss: 9.596560| train set 3.025x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 84
Training per epoch cost 0.304 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 191, train speedup 3.049, test speedup 1.696, val speedup 1.043
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 116, train speedup 2.909, test speedup 1.696, val speedup 1.132
last model at epoch 199, train speedup 3.025, test speedup 1.696, val speedup 1.000
execution cost 0:02:41.134897
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.074862, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507725| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141737| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847761| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.567966| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255039| train set 1.012x speedup, test set 2.718x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.956787| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.655508| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.382252| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.089783| train set 1.029x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.792336| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.495071| train set 1.055x speedup, test set 2.630x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.204531| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.940765| train set 1.055x speedup, test set 2.526x speedup, val set 1.126x speedup, step: 17
Epoch 17/200 |loss: 25.706865| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.830025| train set 1.056x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 19
Epoch 19/200 |loss: 25.811319| train set 1.054x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 20
Epoch 20/200 |loss: 25.050686| train set 1.064x speedup, test set 2.526x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 25.030941| train set 1.069x speedup, test set 2.497x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.714050| train set 1.071x speedup, test set 2.478x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.397434| train set 1.070x speedup, test set 2.529x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.374079| train set 1.071x speedup, test set 1.616x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.899942| train set 1.071x speedup, test set 2.500x speedup, val set 0.909x speedup, step: 26
Epoch 26/200 |loss: 23.881094| train set 1.070x speedup, test set 2.450x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.595177| train set 2.200x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.313414| train set 1.062x speedup, test set 2.447x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.263323| train set 2.206x speedup, test set 1.621x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 22.952642| train set 2.027x speedup, test set 1.610x speedup, val set 0.909x speedup, step: 31
Epoch 31/200 |loss: 22.598215| train set 2.031x speedup, test set 1.610x speedup, val set 0.909x speedup, step: 32
Epoch 32/200 |loss: 22.521893| train set 2.210x speedup, test set 1.621x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 22.413630| train set 2.230x speedup, test set 1.624x speedup, val set 0.957x speedup, step: 34
Epoch 34/200 |loss: 22.031826| train set 1.895x speedup, test set 1.622x speedup, val set 0.983x speedup, step: 35
Epoch 35/200 |loss: 21.986979| train set 2.206x speedup, test set 1.613x speedup, val set 0.924x speedup, step: 36
Epoch 36/200 |loss: 22.638147| train set 1.061x speedup, test set 1.641x speedup, val set 0.985x speedup, step: 37
Epoch 37/200 |loss: 22.333149| train set 2.031x speedup, test set 1.629x speedup, val set 1.042x speedup, step: 38
Epoch 38/200 |loss: 21.482723| train set 2.232x speedup, test set 1.671x speedup, val set 0.924x speedup, step: 39
Epoch 39/200 |loss: 21.900026| train set 2.238x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 40
Epoch 40/200 |loss: 21.177864| train set 1.930x speedup, test set 1.621x speedup, val set 1.039x speedup, step: 41
Epoch 41/200 |loss: 21.694345| train set 2.218x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 42
Epoch 42/200 |loss: 20.982645| train set 2.232x speedup, test set 1.671x speedup, val set 0.814x speedup, step: 43
Epoch 43/200 |loss: 21.236032| train set 2.156x speedup, test set 1.614x speedup, val set 0.957x speedup, step: 44
Epoch 44/200 |loss: 20.391954| train set 2.165x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 45
Epoch 45/200 |loss: 20.626577| train set 2.228x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 46
Epoch 46/200 |loss: 19.945343| train set 2.192x speedup, test set 1.613x speedup, val set 1.000x speedup, step: 47
Epoch 47/200 |loss: 20.208656| train set 2.243x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 48
Epoch 48/200 |loss: 19.629940| train set 2.243x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 49
Epoch 49/200 |loss: 19.745199| train set 2.301x speedup, test set 1.613x speedup, val set 0.873x speedup, step: 50
Epoch 50/200 |loss: 19.427748| train set 2.173x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 51
Epoch 51/200 |loss: 19.522339| train set 2.353x speedup, test set 1.614x speedup, val set 1.043x speedup, step: 52
Epoch 52/200 |loss: 20.106506| train set 2.291x speedup, test set 1.611x speedup, val set 1.039x speedup, step: 53
Epoch 53/200 |loss: 19.840113| train set 2.447x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 54
Epoch 54/200 |loss: 19.244631| train set 2.270x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 55
Epoch 55/200 |loss: 18.737034| train set 2.291x speedup, test set 1.611x speedup, val set 1.039x speedup, step: 56
Epoch 56/200 |loss: 18.712835| train set 2.322x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 57
Epoch 57/200 |loss: 18.837946| train set 2.353x speedup, test set 1.613x speedup, val set 1.043x speedup, step: 58
Epoch 58/200 |loss: 18.260967| train set 2.222x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 18.076715| train set 2.356x speedup, test set 1.670x speedup, val set 0.873x speedup, step: 60
Epoch 60/200 |loss: 18.113459| train set 2.302x speedup, test set 1.611x speedup, val set 1.039x speedup, step: 61
Epoch 61/200 |loss: 18.075077| train set 2.464x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 62
Epoch 62/200 |loss: 17.626703| train set 2.306x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 63
Epoch 63/200 |loss: 17.348673| train set 2.296x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 64
Epoch 64/200 |loss: 17.272882| train set 2.464x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 65
Epoch 65/200 |loss: 17.349018| train set 2.299x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 66
Epoch 66/200 |loss: 17.431753| train set 2.463x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 67
Epoch 67/200 |loss: 17.789896| train set 2.302x speedup, test set 1.668x speedup, val set 0.873x speedup, step: 68
Epoch 68/200 |loss: 16.961843| train set 2.361x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 69
Epoch 69/200 |loss: 16.496836| train set 2.895x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 70
Epoch 70/200 |loss: 17.163391| train set 2.275x speedup, test set 1.630x speedup, val set 1.039x speedup, step: 71
Epoch 71/200 |loss: 17.859898| train set 2.380x speedup, test set 1.636x speedup, val set 0.873x speedup, step: 72
Epoch 72/200 |loss: 16.977919| train set 2.754x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 73
Epoch 73/200 |loss: 16.066225| train set 2.718x speedup, test set 1.630x speedup, val set 0.972x speedup, step: 74
Epoch 74/200 |loss: 17.176817| train set 2.874x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 75
Epoch 75/200 |loss: 16.122374| train set 2.300x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 76
Epoch 76/200 |loss: 16.381172| train set 2.465x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 77
Epoch 77/200 |loss: 16.362448| train set 2.754x speedup, test set 1.747x speedup, val set 0.873x speedup, step: 78
Epoch 78/200 |loss: 16.193739| train set 2.897x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 79
Epoch 79/200 |loss: 16.807869| train set 2.301x speedup, test set 1.687x speedup, val set 1.046x speedup, step: 80
Epoch 80/200 |loss: 16.481232| train set 2.469x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 81
Epoch 81/200 |loss: 15.618652| train set 2.772x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 82
Epoch 82/200 |loss: 15.716780| train set 2.760x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 83
Epoch 83/200 |loss: 15.134038| train set 2.469x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 84
Epoch 84/200 |loss: 15.440813| train set 2.553x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 85
Epoch 85/200 |loss: 15.786196| train set 2.759x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 86
Epoch 86/200 |loss: 15.279380| train set 2.896x speedup, test set 1.747x speedup, val set 0.971x speedup, step: 87
Epoch 87/200 |loss: 15.607243| train set 2.562x speedup, test set 1.689x speedup, val set 0.972x speedup, step: 88
Epoch 88/200 |loss: 14.611265| train set 2.562x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 89
Epoch 89/200 |loss: 14.732663| train set 2.900x speedup, test set 1.747x speedup, val set 0.822x speedup, step: 90
Epoch 90/200 |loss: 14.381406| train set 2.759x speedup, test set 1.687x speedup, val set 0.972x speedup, step: 91
Epoch 91/200 |loss: 14.686403| train set 2.898x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 14.754848| train set 2.902x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 14.224762| train set 2.562x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 94
Epoch 94/200 |loss: 14.237298| train set 2.901x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 13.743725| train set 2.759x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 96
Epoch 96/200 |loss: 13.590147| train set 2.901x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 97
Epoch 97/200 |loss: 13.267060| train set 2.902x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 98
Epoch 98/200 |loss: 13.171291| train set 2.760x speedup, test set 1.689x speedup, val set 0.972x speedup, step: 99
Epoch 99/200 |loss: 13.365067| train set 2.913x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 100
Epoch 100/200 |loss: 13.565464| train set 2.902x speedup, test set 1.689x speedup, val set 0.934x speedup, step: 1
Epoch 101/200 |loss: 15.108195| train set 2.550x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 102/200 |loss: 16.185953| train set 2.906x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 2
Epoch 103/200 |loss: 14.397046| train set 2.777x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 3
Epoch 104/200 |loss: 13.950140| train set 2.683x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 4
Epoch 105/200 |loss: 15.464844| train set 2.902x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 5
Epoch 106/200 |loss: 15.218589| train set 2.775x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 6
Epoch 107/200 |loss: 13.812118| train set 2.575x speedup, test set 1.747x speedup, val set 0.873x speedup, step: 7
Epoch 108/200 |loss: 15.882891| train set 2.777x speedup, test set 1.747x speedup, val set 0.873x speedup, step: 8
Epoch 109/200 |loss: 13.232151| train set 2.888x speedup, test set 1.687x speedup, val set 0.822x speedup, step: 9
Epoch 110/200 |loss: 13.804223| train set 2.902x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 10
Epoch 111/200 |loss: 13.453404| train set 2.887x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 11
Epoch 112/200 |loss: 13.093344| train set 2.907x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 12
Epoch 113/200 |loss: 13.216965| train set 2.905x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 13
Epoch 114/200 |loss: 12.717473| train set 2.900x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 14
Epoch 115/200 |loss: 12.762760| train set 2.888x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 15
Epoch 116/200 |loss: 12.694307| train set 2.903x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 16
Epoch 117/200 |loss: 12.250541| train set 2.911x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 17
Epoch 118/200 |loss: 12.264411| train set 2.902x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 18
Epoch 119/200 |loss: 12.235459| train set 2.907x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 120/200 |loss: 11.831540| train set 2.917x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 2
Epoch 121/200 |loss: 11.835576| train set 2.978x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 3
Epoch 122/200 |loss: 11.763774| train set 2.906x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 1
Epoch 123/200 |loss: 11.625916| train set 2.907x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 1
Epoch 124/200 |loss: 11.337743| train set 2.917x speedup, test set 1.749x speedup, val set 0.934x speedup, step: 2
Epoch 125/200 |loss: 11.404135| train set 2.907x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 3
Epoch 126/200 |loss: 11.327729| train set 2.965x speedup, test set 1.738x speedup, val set 0.972x speedup, step: 4
Epoch 127/200 |loss: 11.448621| train set 2.906x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 5
Epoch 128/200 |loss: 11.734573| train set 2.773x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 6
Epoch 129/200 |loss: 12.104136| train set 2.906x speedup, test set 1.749x speedup, val set 0.934x speedup, step: 7
Epoch 130/200 |loss: 12.542249| train set 2.913x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 8
Epoch 131/200 |loss: 11.557185| train set 2.908x speedup, test set 1.749x speedup, val set 0.934x speedup, step: 9
Epoch 132/200 |loss: 10.863556| train set 2.906x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 10
Epoch 133/200 |loss: 11.179555| train set 2.913x speedup, test set 1.747x speedup, val set 0.972x speedup, step: 11
Epoch 134/200 |loss: 11.525998| train set 2.904x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 12
Epoch 135/200 |loss: 11.664838| train set 2.765x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 13
Epoch 136/200 |loss: 10.919614| train set 2.917x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 14
Epoch 137/200 |loss: 10.955905| train set 2.908x speedup, test set 1.749x speedup, val set 0.934x speedup, step: 15
Epoch 138/200 |loss: 11.559341| train set 2.764x speedup, test set 1.747x speedup, val set 0.972x speedup, step: 16
Epoch 139/200 |loss: 11.506818| train set 2.908x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 17
Epoch 140/200 |loss: 10.386392| train set 2.908x speedup, test set 1.735x speedup, val set 0.934x speedup, step: 18
Epoch 141/200 |loss: 11.296555| train set 2.787x speedup, test set 1.735x speedup, val set 0.972x speedup, step: 19
Epoch 142/200 |loss: 11.826362| train set 2.904x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 20
Epoch 143/200 |loss: 10.685466| train set 2.963x speedup, test set 1.737x speedup, val set 0.934x speedup, step: 21
Epoch 144/200 |loss: 11.075500| train set 2.737x speedup, test set 1.735x speedup, val set 0.972x speedup, step: 22
Epoch 145/200 |loss: 11.643384| train set 2.967x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 23
Epoch 146/200 |loss: 12.182055| train set 2.907x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 24
Epoch 147/200 |loss: 11.726170| train set 2.695x speedup, test set 1.747x speedup, val set 0.972x speedup, step: 25
Epoch 148/200 |loss: 11.963613| train set 2.907x speedup, test set 1.735x speedup, val set 0.934x speedup, step: 26
Epoch 149/200 |loss: 11.318270| train set 2.913x speedup, test set 1.735x speedup, val set 0.934x speedup, step: 27
Epoch 150/200 |loss: 10.857503| train set 2.903x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 28
Epoch 151/200 |loss: 11.237363| train set 2.909x speedup, test set 1.675x speedup, val set 0.972x speedup, step: 29
Epoch 152/200 |loss: 11.259174| train set 2.908x speedup, test set 1.760x speedup, val set 0.934x speedup, step: 30
Epoch 153/200 |loss: 10.310795| train set 2.958x speedup, test set 1.760x speedup, val set 0.811x speedup, step: 31
Epoch 154/200 |loss: 11.157686| train set 2.920x speedup, test set 1.747x speedup, val set 0.934x speedup, step: 32
Epoch 155/200 |loss: 10.630881| train set 2.778x speedup, test set 1.737x speedup, val set 0.972x speedup, step: 33
Epoch 156/200 |loss: 10.378488| train set 2.964x speedup, test set 1.737x speedup, val set 0.920x speedup, step: 34
Epoch 157/200 |loss: 10.383695| train set 2.978x speedup, test set 1.737x speedup, val set 0.934x speedup, step: 35
Epoch 158/200 |loss: 10.278538| train set 2.984x speedup, test set 1.737x speedup, val set 0.972x speedup, step: 36
Epoch 159/200 |loss: 9.908713| train set 2.765x speedup, test set 1.678x speedup, val set 0.972x speedup, step: 37
Epoch 160/200 |loss: 10.006344| train set 2.919x speedup, test set 1.678x speedup, val set 0.934x speedup, step: 38
Epoch 161/200 |loss: 10.059111| train set 2.919x speedup, test set 1.737x speedup, val set 0.934x speedup, step: 39
Epoch 162/200 |loss: 9.645183| train set 2.984x speedup, test set 1.737x speedup, val set 0.972x speedup, step: 40
Epoch 163/200 |loss: 9.728343| train set 2.908x speedup, test set 1.737x speedup, val set 0.822x speedup, step: 41
Epoch 164/200 |loss: 9.741165| train set 2.919x speedup, test set 1.737x speedup, val set 0.972x speedup, step: 42
Epoch 165/200 |loss: 9.618329| train set 2.981x speedup, test set 1.737x speedup, val set 0.972x speedup, step: 43
Epoch 166/200 |loss: 9.540226| train set 2.949x speedup, test set 1.737x speedup, val set 0.822x speedup, step: 44
Epoch 167/200 |loss: 9.793272| train set 2.828x speedup, test set 1.737x speedup, val set 0.972x speedup, step: 45
Epoch 168/200 |loss: 10.251729| train set 2.949x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 1
Epoch 169/200 |loss: 10.903564| train set 2.810x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 1
Epoch 170/200 |loss: 9.875574| train set 3.009x speedup, test set 1.737x speedup, val set 0.957x speedup, step: 2
Epoch 171/200 |loss: 10.021766| train set 2.949x speedup, test set 1.737x speedup, val set 0.822x speedup, step: 3
Epoch 172/200 |loss: 10.310504| train set 2.793x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 4
Epoch 173/200 |loss: 9.476124| train set 2.832x speedup, test set 1.749x speedup, val set 0.822x speedup, step: 5
Epoch 174/200 |loss: 9.667734| train set 2.949x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 6
Epoch 175/200 |loss: 10.213776| train set 3.021x speedup, test set 1.749x speedup, val set 0.822x speedup, step: 7
Epoch 176/200 |loss: 9.594096| train set 2.980x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 8
Epoch 177/200 |loss: 9.793008| train set 2.922x speedup, test set 1.749x speedup, val set 0.822x speedup, step: 9
Epoch 178/200 |loss: 9.702952| train set 2.919x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 10
Epoch 179/200 |loss: 9.099113| train set 2.973x speedup, test set 1.749x speedup, val set 0.957x speedup, step: 11
Epoch 180/200 |loss: 9.547703| train set 2.950x speedup, test set 1.749x speedup, val set 0.822x speedup, step: 12
Epoch 181/200 |loss: 9.309974| train set 2.926x speedup, test set 1.749x speedup, val set 0.822x speedup, step: 13
Epoch 182/200 |loss: 9.130815| train set 2.964x speedup, test set 1.749x speedup, val set 0.957x speedup, step: 14
Epoch 183/200 |loss: 9.662848| train set 2.966x speedup, test set 1.749x speedup, val set 0.934x speedup, step: 15
Epoch 184/200 |loss: 9.869748| train set 2.949x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 16
Epoch 185/200 |loss: 9.571897| train set 2.982x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 17
Epoch 186/200 |loss: 10.226681| train set 2.960x speedup, test set 1.749x speedup, val set 0.822x speedup, step: 18
Epoch 187/200 |loss: 9.502552| train set 2.960x speedup, test set 1.749x speedup, val set 0.822x speedup, step: 19
Epoch 188/200 |loss: 8.963923| train set 3.024x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 20
Epoch 189/200 |loss: 9.282508| train set 2.964x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 21
Epoch 190/200 |loss: 9.346610| train set 2.925x speedup, test set 1.749x speedup, val set 0.822x speedup, step: 22
Epoch 191/200 |loss: 9.433492| train set 2.969x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 23
Epoch 192/200 |loss: 9.181844| train set 2.925x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 24
Epoch 193/200 |loss: 8.919426| train set 2.911x speedup, test set 1.749x speedup, val set 0.822x speedup, step: 25
Epoch 194/200 |loss: 8.797672| train set 2.967x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 26
Epoch 195/200 |loss: 9.196911| train set 2.928x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 27
Epoch 196/200 |loss: 9.599435| train set 2.949x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 28
Epoch 197/200 |loss: 9.123458| train set 2.976x speedup, test set 1.749x speedup, val set 0.811x speedup, step: 29
Epoch 198/200 |loss: 8.907957| train set 2.987x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 30
Epoch 199/200 |loss: 8.881419| train set 2.953x speedup, test set 1.749x speedup, val set 0.972x speedup, step: 31
Training per epoch cost 0.299 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 39.014s, pg runtime 32.939s, speedup 0.844x
18, opt runtime 6.149s, model runtime 40.620s, pg runtime 30.760s, speedup 0.757x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 66.316s, pg runtime 19.707s, speedup 0.297x
38, opt runtime 18.262s, model runtime 55.922s, pg runtime 18.262s, speedup 0.327x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 188, train speedup 3.024, test speedup 1.749, val speedup 0.972
best test speedup epoch: 3, train speedup 1.006, test speedup 2.746, val speedup 0.988
best validation speedup epoch: 169, train speedup 2.810, test speedup 1.737, val speedup 1.043
last model at epoch 199, train speedup 2.953, test speedup 1.749, val speedup 0.972
execution cost 0:02:40.478960
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.044733, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507717| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141737| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847988| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568956| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255899| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.957998| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657160| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.383707| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.092306| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.802988| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.507395| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.221188| train set 1.055x speedup, test set 2.499x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.971693| train set 1.055x speedup, test set 2.499x speedup, val set 0.975x speedup, step: 17
Epoch 17/200 |loss: 25.835876| train set 1.054x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 26.045115| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 19
Epoch 19/200 |loss: 25.385984| train set 1.055x speedup, test set 2.526x speedup, val set 0.973x speedup, step: 20
Epoch 20/200 |loss: 25.110897| train set 1.064x speedup, test set 2.529x speedup, val set 1.027x speedup, step: 21
Epoch 21/200 |loss: 25.101564| train set 1.064x speedup, test set 2.493x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.562431| train set 1.071x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.625088| train set 1.064x speedup, test set 2.529x speedup, val set 0.909x speedup, step: 24
Epoch 24/200 |loss: 24.337948| train set 1.106x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.988922| train set 1.071x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 26
Epoch 26/200 |loss: 23.972775| train set 1.070x speedup, test set 2.474x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.534542| train set 2.198x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.514730| train set 1.057x speedup, test set 1.610x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.203991| train set 1.156x speedup, test set 1.621x speedup, val set 0.909x speedup, step: 30
Epoch 30/200 |loss: 22.863708| train set 2.200x speedup, test set 1.638x speedup, val set 0.909x speedup, step: 31
Epoch 31/200 |loss: 22.808580| train set 1.058x speedup, test set 1.621x speedup, val set 0.909x speedup, step: 32
Epoch 32/200 |loss: 22.632254| train set 2.209x speedup, test set 1.621x speedup, val set 0.909x speedup, step: 33
Epoch 33/200 |loss: 22.192684| train set 2.230x speedup, test set 1.610x speedup, val set 0.909x speedup, step: 34
Epoch 34/200 |loss: 22.142115| train set 1.115x speedup, test set 1.619x speedup, val set 0.983x speedup, step: 35
Epoch 35/200 |loss: 22.166378| train set 2.230x speedup, test set 1.610x speedup, val set 0.909x speedup, step: 36
Epoch 36/200 |loss: 21.658953| train set 2.209x speedup, test set 1.610x speedup, val set 0.909x speedup, step: 37
Epoch 37/200 |loss: 21.423519| train set 2.229x speedup, test set 1.613x speedup, val set 0.909x speedup, step: 38
Epoch 38/200 |loss: 21.458145| train set 2.219x speedup, test set 1.613x speedup, val set 0.909x speedup, step: 39
Epoch 39/200 |loss: 21.833014| train set 2.237x speedup, test set 1.619x speedup, val set 0.880x speedup, step: 40
Epoch 40/200 |loss: 22.081911| train set 1.905x speedup, test set 1.631x speedup, val set 0.985x speedup, step: 41
Epoch 41/200 |loss: 21.562946| train set 2.217x speedup, test set 1.614x speedup, val set 0.909x speedup, step: 42
Epoch 42/200 |loss: 21.070776| train set 2.265x speedup, test set 1.619x speedup, val set 0.880x speedup, step: 43
Epoch 43/200 |loss: 20.963764| train set 2.297x speedup, test set 1.614x speedup, val set 0.780x speedup, step: 44
Epoch 44/200 |loss: 20.596287| train set 2.232x speedup, test set 1.614x speedup, val set 0.983x speedup, step: 45
Epoch 45/200 |loss: 20.399639| train set 2.238x speedup, test set 1.619x speedup, val set 0.983x speedup, step: 46
Epoch 46/200 |loss: 20.252960| train set 2.292x speedup, test set 1.614x speedup, val set 0.880x speedup, step: 47
Epoch 47/200 |loss: 19.856306| train set 2.324x speedup, test set 1.614x speedup, val set 0.983x speedup, step: 48
Epoch 48/200 |loss: 19.872471| train set 2.228x speedup, test set 1.620x speedup, val set 0.983x speedup, step: 49
Epoch 49/200 |loss: 19.547035| train set 2.262x speedup, test set 1.619x speedup, val set 0.987x speedup, step: 50
Epoch 50/200 |loss: 19.317247| train set 2.324x speedup, test set 1.613x speedup, val set 0.983x speedup, step: 51
Epoch 51/200 |loss: 19.353756| train set 2.337x speedup, test set 1.619x speedup, val set 0.833x speedup, step: 52
Epoch 52/200 |loss: 19.089464| train set 2.263x speedup, test set 1.619x speedup, val set 0.983x speedup, step: 53
Epoch 53/200 |loss: 19.866404| train set 2.459x speedup, test set 1.619x speedup, val set 0.987x speedup, step: 54
Epoch 54/200 |loss: 21.093592| train set 2.346x speedup, test set 1.619x speedup, val set 0.985x speedup, step: 55
Epoch 55/200 |loss: 19.136782| train set 2.281x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 56
Epoch 56/200 |loss: 19.186138| train set 2.459x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 19.598610| train set 2.273x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 58
Epoch 58/200 |loss: 18.573374| train set 2.280x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 19.401966| train set 2.356x speedup, test set 1.620x speedup, val set 0.875x speedup, step: 60
Epoch 60/200 |loss: 18.510447| train set 2.356x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 61
Epoch 61/200 |loss: 18.144100| train set 2.272x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 62
Epoch 62/200 |loss: 18.305704| train set 2.302x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 63
Epoch 63/200 |loss: 17.616577| train set 2.565x speedup, test set 1.678x speedup, val set 0.873x speedup, step: 64
Epoch 64/200 |loss: 17.883543| train set 2.353x speedup, test set 1.612x speedup, val set 1.042x speedup, step: 65
Epoch 65/200 |loss: 17.562040| train set 2.299x speedup, test set 1.663x speedup, val set 1.046x speedup, step: 66
Epoch 66/200 |loss: 17.320917| train set 2.749x speedup, test set 1.678x speedup, val set 1.043x speedup, step: 67
Epoch 67/200 |loss: 17.662275| train set 2.371x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 68
Epoch 68/200 |loss: 17.278503| train set 2.276x speedup, test set 1.620x speedup, val set 1.042x speedup, step: 69
Epoch 69/200 |loss: 17.516336| train set 2.716x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 70
Epoch 70/200 |loss: 17.249420| train set 2.626x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 71
Epoch 71/200 |loss: 16.428368| train set 2.463x speedup, test set 1.678x speedup, val set 1.043x speedup, step: 72
Epoch 72/200 |loss: 16.546041| train set 2.570x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 73
Epoch 73/200 |loss: 16.743189| train set 2.278x speedup, test set 1.678x speedup, val set 1.042x speedup, step: 74
Epoch 74/200 |loss: 16.927607| train set 2.362x speedup, test set 1.678x speedup, val set 1.043x speedup, step: 75
Epoch 75/200 |loss: 16.199179| train set 2.861x speedup, test set 1.664x speedup, val set 0.971x speedup, step: 76
Epoch 76/200 |loss: 16.333643| train set 2.330x speedup, test set 1.697x speedup, val set 0.822x speedup, step: 77
Epoch 77/200 |loss: 16.707333| train set 2.628x speedup, test set 1.663x speedup, val set 1.000x speedup, step: 78
Epoch 78/200 |loss: 15.728116| train set 2.625x speedup, test set 1.663x speedup, val set 1.043x speedup, step: 79
Epoch 79/200 |loss: 15.675147| train set 2.362x speedup, test set 1.678x speedup, val set 0.873x speedup, step: 80
Epoch 80/200 |loss: 15.648801| train set 2.899x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 81
Epoch 81/200 |loss: 15.298552| train set 2.902x speedup, test set 1.663x speedup, val set 0.873x speedup, step: 82
Epoch 82/200 |loss: 15.234222| train set 2.362x speedup, test set 1.699x speedup, val set 1.042x speedup, step: 83
Epoch 83/200 |loss: 16.156473| train set 2.571x speedup, test set 1.690x speedup, val set 0.873x speedup, step: 84
Epoch 84/200 |loss: 17.959131| train set 2.556x speedup, test set 1.693x speedup, val set 0.961x speedup, step: 85
Epoch 85/200 |loss: 16.065033| train set 2.730x speedup, test set 1.696x speedup, val set 0.934x speedup, step: 86
Epoch 86/200 |loss: 15.044639| train set 2.901x speedup, test set 1.681x speedup, val set 0.909x speedup, step: 87
Epoch 87/200 |loss: 15.930468| train set 2.658x speedup, test set 1.407x speedup, val set 1.003x speedup, step: 88
Epoch 88/200 |loss: 15.887601| train set 2.628x speedup, test set 1.696x speedup, val set 0.972x speedup, step: 89
Epoch 89/200 |loss: 14.754815| train set 2.901x speedup, test set 1.757x speedup, val set 1.036x speedup, step: 90
Epoch 90/200 |loss: 15.959538| train set 2.316x speedup, test set 1.673x speedup, val set 0.937x speedup, step: 91
Epoch 91/200 |loss: 15.383026| train set 2.558x speedup, test set 1.687x speedup, val set 0.933x speedup, step: 92
Epoch 92/200 |loss: 14.849171| train set 2.890x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 93
Epoch 93/200 |loss: 15.142186| train set 2.911x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 14.359080| train set 2.897x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 14.540448| train set 2.902x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 13.809333| train set 2.466x speedup, test set 1.696x speedup, val set 0.937x speedup, step: 97
Epoch 97/200 |loss: 14.220413| train set 2.906x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 13.365090| train set 2.913x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 13.661697| train set 2.887x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 100
Epoch 100/200 |loss: 13.370267| train set 2.902x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 13.563069| train set 2.686x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 102/200 |loss: 13.287206| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 103/200 |loss: 13.340289| train set 2.905x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 1
Epoch 104/200 |loss: 13.765191| train set 2.759x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 105/200 |loss: 15.110521| train set 2.679x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 2
Epoch 106/200 |loss: 13.782627| train set 2.917x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 3
Epoch 107/200 |loss: 12.728002| train set 2.875x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 4
Epoch 108/200 |loss: 13.107017| train set 2.642x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 5
Epoch 109/200 |loss: 13.547736| train set 2.888x speedup, test set 1.696x speedup, val set 0.934x speedup, step: 6
Epoch 110/200 |loss: 13.160445| train set 2.906x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 7
Epoch 111/200 |loss: 12.642554| train set 2.907x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 8
Epoch 112/200 |loss: 12.963407| train set 2.827x speedup, test set 1.696x speedup, val set 0.957x speedup, step: 9
Epoch 113/200 |loss: 12.633298| train set 2.907x speedup, test set 1.681x speedup, val set 0.934x speedup, step: 10
Epoch 114/200 |loss: 12.336633| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 11
Epoch 115/200 |loss: 11.865686| train set 2.907x speedup, test set 1.696x speedup, val set 0.972x speedup, step: 12
Epoch 116/200 |loss: 12.270304| train set 2.916x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 13
Epoch 117/200 |loss: 11.845548| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 14
Epoch 118/200 |loss: 11.660087| train set 2.907x speedup, test set 1.696x speedup, val set 0.957x speedup, step: 15
Epoch 119/200 |loss: 11.790442| train set 2.906x speedup, test set 1.681x speedup, val set 1.132x speedup, step: 1
Epoch 120/200 |loss: 12.580091| train set 2.746x speedup, test set 1.424x speedup, val set 0.957x speedup, step: 2
Epoch 121/200 |loss: 14.469274| train set 2.906x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 3
Epoch 122/200 |loss: 16.162151| train set 2.906x speedup, test set 1.681x speedup, val set 1.000x speedup, step: 4
Epoch 123/200 |loss: 12.620545| train set 2.506x speedup, test set 1.366x speedup, val set 0.920x speedup, step: 5
Epoch 124/200 |loss: 16.660221| train set 2.917x speedup, test set 1.696x speedup, val set 0.934x speedup, step: 6
Epoch 125/200 |loss: 13.608254| train set 2.905x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 7
Epoch 126/200 |loss: 14.228027| train set 2.563x speedup, test set 1.382x speedup, val set 0.972x speedup, step: 8
Epoch 127/200 |loss: 13.905282| train set 2.586x speedup, test set 1.696x speedup, val set 0.934x speedup, step: 9
Epoch 128/200 |loss: 13.485724| train set 2.916x speedup, test set 1.696x speedup, val set 1.048x speedup, step: 10
Epoch 129/200 |loss: 12.936919| train set 2.578x speedup, test set 1.424x speedup, val set 0.957x speedup, step: 11
Epoch 130/200 |loss: 13.010090| train set 2.772x speedup, test set 1.424x speedup, val set 1.043x speedup, step: 12
Epoch 131/200 |loss: 12.066303| train set 2.901x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 13
Epoch 132/200 |loss: 13.044558| train set 2.923x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 14
Epoch 133/200 |loss: 11.837747| train set 2.778x speedup, test set 1.424x speedup, val set 0.984x speedup, step: 15
Epoch 134/200 |loss: 12.379183| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 16
Epoch 135/200 |loss: 11.695511| train set 2.904x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 17
Epoch 136/200 |loss: 11.789454| train set 2.757x speedup, test set 1.424x speedup, val set 0.937x speedup, step: 18
Epoch 137/200 |loss: 11.476050| train set 2.778x speedup, test set 1.696x speedup, val set 0.934x speedup, step: 19
Epoch 138/200 |loss: 11.536993| train set 2.917x speedup, test set 1.696x speedup, val set 0.934x speedup, step: 20
Epoch 139/200 |loss: 11.067575| train set 2.917x speedup, test set 1.382x speedup, val set 0.920x speedup, step: 21
Epoch 140/200 |loss: 11.223644| train set 2.906x speedup, test set 1.424x speedup, val set 0.934x speedup, step: 22
Epoch 141/200 |loss: 10.983390| train set 2.907x speedup, test set 1.432x speedup, val set 1.000x speedup, step: 23
Epoch 142/200 |loss: 10.870778| train set 2.917x speedup, test set 1.432x speedup, val set 0.934x speedup, step: 24
Epoch 143/200 |loss: 10.803107| train set 2.917x speedup, test set 1.424x speedup, val set 0.934x speedup, step: 25
Epoch 144/200 |loss: 10.831261| train set 2.917x speedup, test set 1.382x speedup, val set 0.934x speedup, step: 26
Epoch 145/200 |loss: 10.449666| train set 2.964x speedup, test set 1.424x speedup, val set 0.934x speedup, step: 27
Epoch 146/200 |loss: 10.461419| train set 2.908x speedup, test set 1.424x speedup, val set 0.934x speedup, step: 28
Epoch 147/200 |loss: 10.469374| train set 2.947x speedup, test set 1.424x speedup, val set 0.934x speedup, step: 29
Epoch 148/200 |loss: 10.532280| train set 2.962x speedup, test set 1.424x speedup, val set 0.972x speedup, step: 30
Epoch 149/200 |loss: 10.815594| train set 2.874x speedup, test set 1.414x speedup, val set 0.934x speedup, step: 31
Epoch 150/200 |loss: 11.594810| train set 2.854x speedup, test set 1.382x speedup, val set 0.957x speedup, step: 32
Epoch 151/200 |loss: 12.016008| train set 2.917x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 33
Epoch 152/200 |loss: 10.753876| train set 2.908x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 34
Epoch 153/200 |loss: 10.346100| train set 2.946x speedup, test set 1.382x speedup, val set 0.811x speedup, step: 35
Epoch 154/200 |loss: 10.968833| train set 2.903x speedup, test set 1.424x speedup, val set 0.822x speedup, step: 36
Epoch 155/200 |loss: 10.264143| train set 2.917x speedup, test set 1.696x speedup, val set 0.822x speedup, step: 37
Epoch 156/200 |loss: 10.612691| train set 2.788x speedup, test set 1.379x speedup, val set 0.972x speedup, step: 38
Epoch 157/200 |loss: 10.706080| train set 2.908x speedup, test set 1.424x speedup, val set 0.822x speedup, step: 39
Epoch 158/200 |loss: 10.200873| train set 2.891x speedup, test set 1.696x speedup, val set 0.822x speedup, step: 40
Epoch 159/200 |loss: 10.347805| train set 2.981x speedup, test set 1.696x speedup, val set 0.811x speedup, step: 41
Epoch 160/200 |loss: 10.052702| train set 2.919x speedup, test set 1.424x speedup, val set 0.822x speedup, step: 42
Epoch 161/200 |loss: 9.706041| train set 2.907x speedup, test set 1.424x speedup, val set 0.822x speedup, step: 43
Epoch 162/200 |loss: 9.929418| train set 2.984x speedup, test set 1.424x speedup, val set 0.957x speedup, step: 44
Epoch 163/200 |loss: 9.565900| train set 2.964x speedup, test set 1.696x speedup, val set 0.811x speedup, step: 45
Epoch 164/200 |loss: 9.609118| train set 2.911x speedup, test set 1.696x speedup, val set 0.822x speedup, step: 46
Epoch 165/200 |loss: 9.805264| train set 2.788x speedup, test set 1.421x speedup, val set 0.957x speedup, step: 47
Epoch 166/200 |loss: 9.836491| train set 2.984x speedup, test set 1.424x speedup, val set 0.811x speedup, step: 48
Epoch 167/200 |loss: 10.544929| train set 2.936x speedup, test set 1.696x speedup, val set 0.811x speedup, step: 49
Epoch 168/200 |loss: 10.735700| train set 2.986x speedup, test set 1.696x speedup, val set 0.811x speedup, step: 50
Epoch 169/200 |loss: 11.186854| train set 2.909x speedup, test set 1.421x speedup, val set 0.822x speedup, step: 51
Epoch 170/200 |loss: 9.615356| train set 2.937x speedup, test set 1.424x speedup, val set 0.822x speedup, step: 52
Epoch 171/200 |loss: 10.092305| train set 3.005x speedup, test set 1.696x speedup, val set 0.811x speedup, step: 53
Epoch 172/200 |loss: 10.980084| train set 2.829x speedup, test set 1.424x speedup, val set 0.957x speedup, step: 54
Epoch 173/200 |loss: 9.704666| train set 2.938x speedup, test set 1.424x speedup, val set 0.822x speedup, step: 55
Epoch 174/200 |loss: 10.623690| train set 2.912x speedup, test set 1.424x speedup, val set 0.822x speedup, step: 56
Epoch 175/200 |loss: 11.054531| train set 3.048x speedup, test set 1.424x speedup, val set 0.957x speedup, step: 57
Epoch 176/200 |loss: 10.057290| train set 2.936x speedup, test set 1.424x speedup, val set 0.811x speedup, step: 58
Epoch 177/200 |loss: 11.011286| train set 2.912x speedup, test set 1.421x speedup, val set 0.822x speedup, step: 59
Epoch 178/200 |loss: 10.351339| train set 2.852x speedup, test set 1.424x speedup, val set 0.972x speedup, step: 60
Epoch 179/200 |loss: 9.980778| train set 2.913x speedup, test set 1.424x speedup, val set 1.043x speedup, step: 61
Epoch 180/200 |loss: 10.099052| train set 2.908x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 62
Epoch 181/200 |loss: 9.487830| train set 2.967x speedup, test set 1.424x speedup, val set 0.811x speedup, step: 63
Epoch 182/200 |loss: 9.943041| train set 2.820x speedup, test set 1.424x speedup, val set 1.043x speedup, step: 64
Epoch 183/200 |loss: 9.495732| train set 2.964x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 65
Epoch 184/200 |loss: 9.485458| train set 3.024x speedup, test set 1.424x speedup, val set 0.984x speedup, step: 66
Epoch 185/200 |loss: 9.500947| train set 3.033x speedup, test set 1.424x speedup, val set 1.043x speedup, step: 67
Epoch 186/200 |loss: 9.007206| train set 2.969x speedup, test set 1.424x speedup, val set 1.043x speedup, step: 68
Epoch 187/200 |loss: 9.497489| train set 2.909x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 69
Epoch 188/200 |loss: 8.968287| train set 2.980x speedup, test set 1.421x speedup, val set 0.860x speedup, step: 70
Epoch 189/200 |loss: 9.156437| train set 2.958x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 71
Epoch 190/200 |loss: 9.079583| train set 2.969x speedup, test set 1.424x speedup, val set 1.000x speedup, step: 72
Epoch 191/200 |loss: 8.870375| train set 3.022x speedup, test set 1.421x speedup, val set 0.957x speedup, step: 73
Epoch 192/200 |loss: 8.960358| train set 2.953x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 74
Epoch 193/200 |loss: 8.897554| train set 2.988x speedup, test set 1.424x speedup, val set 1.026x speedup, step: 75
Epoch 194/200 |loss: 8.689534| train set 3.024x speedup, test set 1.424x speedup, val set 0.811x speedup, step: 76
Epoch 195/200 |loss: 8.724675| train set 2.953x speedup, test set 1.424x speedup, val set 0.873x speedup, step: 77
Epoch 196/200 |loss: 8.689913| train set 3.031x speedup, test set 1.424x speedup, val set 1.026x speedup, step: 78
Epoch 197/200 |loss: 8.617902| train set 2.970x speedup, test set 1.424x speedup, val set 1.043x speedup, step: 79
Epoch 198/200 |loss: 8.467067| train set 2.960x speedup, test set 1.421x speedup, val set 0.873x speedup, step: 80
Epoch 199/200 |loss: 8.584578| train set 3.014x speedup, test set 1.424x speedup, val set 1.043x speedup, step: 81
Training per epoch cost 0.295 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 114.783s, pg runtime 19.707s, speedup 0.172x
38, opt runtime 18.262s, model runtime 105.474s, pg runtime 18.262s, speedup 0.173x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 175, train speedup 3.048, test speedup 1.424, val speedup 0.957
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 119, train speedup 2.906, test speedup 1.681, val speedup 1.132
last model at epoch 199, train speedup 3.014, test speedup 1.424, val speedup 1.043
execution cost 0:02:35.764431
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.071000, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507730| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141745| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847769| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.567976| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255001| train set 1.012x speedup, test set 2.718x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.956736| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.655355| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.381697| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.089350| train set 1.029x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.796215| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.499844| train set 1.055x speedup, test set 2.630x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.208338| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.942522| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 17
Epoch 17/200 |loss: 25.707926| train set 1.055x speedup, test set 2.526x speedup, val set 1.126x speedup, step: 18
Epoch 18/200 |loss: 25.853563| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 19
Epoch 19/200 |loss: 25.821419| train set 1.063x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 20
Epoch 20/200 |loss: 25.036602| train set 1.064x speedup, test set 2.549x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 25.071669| train set 1.070x speedup, test set 2.523x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.693644| train set 1.070x speedup, test set 2.526x speedup, val set 0.909x speedup, step: 23
Epoch 23/200 |loss: 24.423607| train set 1.064x speedup, test set 2.529x speedup, val set 0.909x speedup, step: 24
Epoch 24/200 |loss: 24.346994| train set 1.105x speedup, test set 1.627x speedup, val set 0.909x speedup, step: 25
Epoch 25/200 |loss: 23.913750| train set 1.070x speedup, test set 1.674x speedup, val set 0.909x speedup, step: 26
Epoch 26/200 |loss: 23.921793| train set 1.070x speedup, test set 2.450x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.514421| train set 2.198x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.395004| train set 1.057x speedup, test set 1.619x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.262066| train set 2.204x speedup, test set 1.621x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 22.842123| train set 2.207x speedup, test set 1.621x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.647915| train set 1.062x speedup, test set 1.622x speedup, val set 0.909x speedup, step: 32
Epoch 32/200 |loss: 22.596310| train set 2.230x speedup, test set 1.622x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 22.251123| train set 1.997x speedup, test set 1.641x speedup, val set 1.039x speedup, step: 34
Epoch 34/200 |loss: 22.140728| train set 2.181x speedup, test set 1.624x speedup, val set 0.957x speedup, step: 35
Epoch 35/200 |loss: 22.541883| train set 2.180x speedup, test set 1.631x speedup, val set 0.983x speedup, step: 36
Epoch 36/200 |loss: 22.465431| train set 2.210x speedup, test set 1.615x speedup, val set 0.909x speedup, step: 37
Epoch 37/200 |loss: 21.481895| train set 2.184x speedup, test set 1.624x speedup, val set 0.921x speedup, step: 38
Epoch 38/200 |loss: 21.871403| train set 2.231x speedup, test set 1.615x speedup, val set 0.957x speedup, step: 39
Epoch 39/200 |loss: 21.447809| train set 2.190x speedup, test set 1.631x speedup, val set 0.983x speedup, step: 40
Epoch 40/200 |loss: 21.390202| train set 2.232x speedup, test set 1.613x speedup, val set 0.961x speedup, step: 41
Epoch 41/200 |loss: 20.980820| train set 2.239x speedup, test set 1.615x speedup, val set 0.957x speedup, step: 42
Epoch 42/200 |loss: 20.762392| train set 2.039x speedup, test set 1.630x speedup, val set 1.039x speedup, step: 43
Epoch 43/200 |loss: 20.847725| train set 2.309x speedup, test set 1.615x speedup, val set 0.961x speedup, step: 44
Epoch 44/200 |loss: 20.323294| train set 2.124x speedup, test set 1.613x speedup, val set 0.909x speedup, step: 45
Epoch 45/200 |loss: 20.571455| train set 2.261x speedup, test set 1.615x speedup, val set 0.983x speedup, step: 46
Epoch 46/200 |loss: 20.020262| train set 2.325x speedup, test set 1.632x speedup, val set 0.983x speedup, step: 47
Epoch 47/200 |loss: 20.088705| train set 2.252x speedup, test set 1.614x speedup, val set 0.814x speedup, step: 48
Epoch 48/200 |loss: 19.504835| train set 2.195x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 49
Epoch 49/200 |loss: 19.751978| train set 2.353x speedup, test set 1.614x speedup, val set 1.043x speedup, step: 50
Epoch 50/200 |loss: 19.139305| train set 2.451x speedup, test set 1.672x speedup, val set 0.873x speedup, step: 51
Epoch 51/200 |loss: 19.173298| train set 2.195x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 52
Epoch 52/200 |loss: 19.499075| train set 2.447x speedup, test set 1.678x speedup, val set 0.873x speedup, step: 53
Epoch 53/200 |loss: 20.496300| train set 2.220x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 54
Epoch 54/200 |loss: 20.962297| train set 2.456x speedup, test set 1.614x speedup, val set 0.814x speedup, step: 55
Epoch 55/200 |loss: 19.461657| train set 2.471x speedup, test set 1.678x speedup, val set 0.924x speedup, step: 56
Epoch 56/200 |loss: 19.471466| train set 2.220x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 57
Epoch 57/200 |loss: 19.555878| train set 2.456x speedup, test set 1.632x speedup, val set 1.043x speedup, step: 58
Epoch 58/200 |loss: 18.461056| train set 2.554x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 59
Epoch 59/200 |loss: 19.469069| train set 2.191x speedup, test set 1.614x speedup, val set 1.042x speedup, step: 60
Epoch 60/200 |loss: 18.618210| train set 2.191x speedup, test set 1.632x speedup, val set 1.042x speedup, step: 61
Epoch 61/200 |loss: 18.604815| train set 2.465x speedup, test set 1.678x speedup, val set 0.873x speedup, step: 62
Epoch 62/200 |loss: 18.362061| train set 2.465x speedup, test set 1.670x speedup, val set 0.873x speedup, step: 63
Epoch 63/200 |loss: 17.842422| train set 2.303x speedup, test set 1.628x speedup, val set 1.039x speedup, step: 64
Epoch 64/200 |loss: 18.077087| train set 2.357x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 65
Epoch 65/200 |loss: 17.545969| train set 2.455x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 66
Epoch 66/200 |loss: 17.586189| train set 2.300x speedup, test set 1.689x speedup, val set 1.046x speedup, step: 67
Epoch 67/200 |loss: 17.393454| train set 2.300x speedup, test set 1.689x speedup, val set 1.046x speedup, step: 68
Epoch 68/200 |loss: 17.114193| train set 2.466x speedup, test set 1.691x speedup, val set 1.043x speedup, step: 69
Epoch 69/200 |loss: 16.999582| train set 2.461x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 70
Epoch 70/200 |loss: 16.956772| train set 2.466x speedup, test set 1.691x speedup, val set 1.043x speedup, step: 71
Epoch 71/200 |loss: 16.930742| train set 2.539x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 72
Epoch 72/200 |loss: 17.204563| train set 2.382x speedup, test set 1.691x speedup, val set 1.042x speedup, step: 73
Epoch 73/200 |loss: 18.030771| train set 2.462x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 74
Epoch 74/200 |loss: 16.561350| train set 2.554x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 75
Epoch 75/200 |loss: 16.735346| train set 2.465x speedup, test set 1.689x speedup, val set 1.046x speedup, step: 76
Epoch 76/200 |loss: 16.363251| train set 2.758x speedup, test set 1.689x speedup, val set 1.046x speedup, step: 77
Epoch 77/200 |loss: 16.069649| train set 2.890x speedup, test set 1.675x speedup, val set 0.873x speedup, step: 78
Epoch 78/200 |loss: 16.146858| train set 2.308x speedup, test set 1.689x speedup, val set 0.875x speedup, step: 79
Epoch 79/200 |loss: 16.169432| train set 2.466x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 80
Epoch 80/200 |loss: 16.171104| train set 2.723x speedup, test set 1.687x speedup, val set 0.961x speedup, step: 81
Epoch 81/200 |loss: 17.217024| train set 2.897x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 82
Epoch 82/200 |loss: 17.407055| train set 2.308x speedup, test set 1.689x speedup, val set 1.042x speedup, step: 83
Epoch 83/200 |loss: 16.182896| train set 2.288x speedup, test set 1.673x speedup, val set 0.873x speedup, step: 84
Epoch 84/200 |loss: 16.321432| train set 2.893x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 85
Epoch 85/200 |loss: 17.618059| train set 2.754x speedup, test set 1.689x speedup, val set 1.039x speedup, step: 86
Epoch 86/200 |loss: 15.785991| train set 2.451x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 87
Epoch 87/200 |loss: 16.825716| train set 2.901x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 88
Epoch 88/200 |loss: 17.332741| train set 2.626x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 89
Epoch 89/200 |loss: 15.877664| train set 2.531x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 90
Epoch 90/200 |loss: 16.576502| train set 2.814x speedup, test set 1.687x speedup, val set 0.900x speedup, step: 91
Epoch 91/200 |loss: 15.407628| train set 2.890x speedup, test set 1.689x speedup, val set 0.814x speedup, step: 92
Epoch 92/200 |loss: 15.365027| train set 2.626x speedup, test set 1.689x speedup, val set 1.039x speedup, step: 93
Epoch 93/200 |loss: 15.293834| train set 2.755x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 94
Epoch 94/200 |loss: 14.961853| train set 2.895x speedup, test set 1.689x speedup, val set 1.132x speedup, step: 95
Epoch 95/200 |loss: 15.014106| train set 2.898x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 96
Epoch 96/200 |loss: 14.441959| train set 2.630x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 97
Epoch 97/200 |loss: 14.605350| train set 2.772x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 98
Epoch 98/200 |loss: 14.221383| train set 2.890x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 13.927328| train set 2.886x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 100
Epoch 100/200 |loss: 14.053257| train set 2.887x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 101/200 |loss: 13.621385| train set 2.902x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 2
Epoch 102/200 |loss: 13.590205| train set 2.887x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 3
Epoch 103/200 |loss: 13.411117| train set 2.902x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 4
Epoch 104/200 |loss: 13.222830| train set 2.902x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 5
Epoch 105/200 |loss: 13.127139| train set 2.760x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 106/200 |loss: 13.037582| train set 2.902x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 2
Epoch 107/200 |loss: 12.845748| train set 2.912x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 3
Epoch 108/200 |loss: 12.617352| train set 2.773x speedup, test set 1.689x speedup, val set 0.972x speedup, step: 4
Epoch 109/200 |loss: 12.940217| train set 2.901x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 5
Epoch 110/200 |loss: 13.385137| train set 2.903x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 6
Epoch 111/200 |loss: 14.361548| train set 2.782x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 112/200 |loss: 14.351634| train set 2.901x speedup, test set 1.689x speedup, val set 1.132x speedup, step: 1
Epoch 113/200 |loss: 13.949301| train set 2.384x speedup, test set 1.689x speedup, val set 0.824x speedup, step: 2
Epoch 114/200 |loss: 14.317888| train set 2.671x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 3
Epoch 115/200 |loss: 13.608678| train set 2.902x speedup, test set 1.689x speedup, val set 1.132x speedup, step: 1
Epoch 116/200 |loss: 14.040399| train set 2.760x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 2
Epoch 117/200 |loss: 13.376706| train set 2.913x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 3
Epoch 118/200 |loss: 12.640240| train set 2.894x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 4
Epoch 119/200 |loss: 13.741430| train set 2.772x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 5
Epoch 120/200 |loss: 12.363156| train set 2.830x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 6
Epoch 121/200 |loss: 13.416477| train set 2.907x speedup, test set 1.689x speedup, val set 1.132x speedup, step: 1
Epoch 122/200 |loss: 13.575063| train set 2.750x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 2
Epoch 123/200 |loss: 12.508535| train set 2.566x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 3
Epoch 124/200 |loss: 13.104774| train set 2.917x speedup, test set 1.689x speedup, val set 1.132x speedup, step: 1
Epoch 125/200 |loss: 12.685755| train set 2.863x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 2
Epoch 126/200 |loss: 12.440625| train set 2.747x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 3
Epoch 127/200 |loss: 12.212295| train set 2.907x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 4
Epoch 128/200 |loss: 12.249589| train set 2.917x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 5
Epoch 129/200 |loss: 11.615155| train set 2.917x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 6
Epoch 130/200 |loss: 11.690299| train set 2.918x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 7
Epoch 131/200 |loss: 11.520967| train set 2.904x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 8
Epoch 132/200 |loss: 11.202219| train set 2.907x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 9
Epoch 133/200 |loss: 11.442169| train set 2.907x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 10
Epoch 134/200 |loss: 10.889834| train set 2.917x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 11
Epoch 135/200 |loss: 11.073314| train set 2.924x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 12
Epoch 136/200 |loss: 10.844177| train set 2.908x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 13
Epoch 137/200 |loss: 10.730447| train set 2.908x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 14
Epoch 138/200 |loss: 10.711293| train set 2.908x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 15
Epoch 139/200 |loss: 10.405458| train set 2.913x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 16
Epoch 140/200 |loss: 10.543064| train set 2.978x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 17
Epoch 141/200 |loss: 10.301780| train set 2.908x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 18
Epoch 142/200 |loss: 10.381863| train set 2.948x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 19
Epoch 143/200 |loss: 10.545492| train set 2.979x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 20
Epoch 144/200 |loss: 12.390429| train set 2.936x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 21
Epoch 145/200 |loss: 14.177186| train set 2.848x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 22
Epoch 146/200 |loss: 16.916775| train set 2.908x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 23
Epoch 147/200 |loss: 12.488507| train set 2.614x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 24
Epoch 148/200 |loss: 16.481890| train set 2.864x speedup, test set 1.687x speedup, val set 0.971x speedup, step: 25
Epoch 149/200 |loss: 12.611757| train set 2.924x speedup, test set 1.747x speedup, val set 0.873x speedup, step: 26
Epoch 150/200 |loss: 13.110394| train set 2.634x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 27
Epoch 151/200 |loss: 12.260834| train set 2.917x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 28
Epoch 152/200 |loss: 12.872350| train set 2.904x speedup, test set 1.747x speedup, val set 1.132x speedup, step: 1
Epoch 153/200 |loss: 11.723711| train set 2.904x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 2
Epoch 154/200 |loss: 12.309635| train set 2.761x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 3
Epoch 155/200 |loss: 11.487281| train set 2.908x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 4
Epoch 156/200 |loss: 11.691890| train set 2.919x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 5
Epoch 157/200 |loss: 11.083371| train set 2.908x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 6
Epoch 158/200 |loss: 11.279813| train set 2.908x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 7
Epoch 159/200 |loss: 10.786654| train set 2.907x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 8
Epoch 160/200 |loss: 10.937575| train set 2.919x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 9
Epoch 161/200 |loss: 10.585112| train set 2.909x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 10
Epoch 162/200 |loss: 10.605988| train set 2.983x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 11
Epoch 163/200 |loss: 10.372857| train set 2.960x speedup, test set 1.748x speedup, val set 1.000x speedup, step: 12
Epoch 164/200 |loss: 10.292521| train set 2.960x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 13
Epoch 165/200 |loss: 10.166512| train set 2.950x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 14
Epoch 166/200 |loss: 10.055058| train set 2.961x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 15
Epoch 167/200 |loss: 9.982099| train set 2.978x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 16
Epoch 168/200 |loss: 9.830022| train set 2.919x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 17
Epoch 169/200 |loss: 9.822003| train set 2.978x speedup, test set 1.749x speedup, val set 1.026x speedup, step: 18
Epoch 170/200 |loss: 9.744927| train set 2.950x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 19
Epoch 171/200 |loss: 9.757048| train set 3.023x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 20
Epoch 172/200 |loss: 9.845934| train set 2.961x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 21
Epoch 173/200 |loss: 9.876696| train set 2.966x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 22
Epoch 174/200 |loss: 9.929749| train set 2.951x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 23
Epoch 175/200 |loss: 9.723440| train set 2.926x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 24
Epoch 176/200 |loss: 9.594836| train set 3.010x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 25
Epoch 177/200 |loss: 9.635762| train set 2.953x speedup, test set 1.749x speedup, val set 1.000x speedup, step: 26
Epoch 178/200 |loss: 10.386721| train set 2.715x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 27
Epoch 179/200 |loss: 10.949905| train set 2.909x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 28
Epoch 180/200 |loss: 10.460804| train set 2.925x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 29
Epoch 181/200 |loss: 9.308286| train set 3.015x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 30
Epoch 182/200 |loss: 9.761670| train set 2.909x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 31
Epoch 183/200 |loss: 10.381246| train set 2.919x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 32
Epoch 184/200 |loss: 9.276198| train set 2.830x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 33
Epoch 185/200 |loss: 9.547320| train set 2.922x speedup, test set 1.737x speedup, val set 1.000x speedup, step: 34
Epoch 186/200 |loss: 10.043461| train set 2.978x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 35
Epoch 187/200 |loss: 9.522668| train set 2.979x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 36
Epoch 188/200 |loss: 9.169188| train set 2.912x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 37
Epoch 189/200 |loss: 9.933242| train set 3.016x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 38
Epoch 190/200 |loss: 9.321964| train set 3.019x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 39
Epoch 191/200 |loss: 9.064951| train set 2.953x speedup, test set 1.737x speedup, val set 1.000x speedup, step: 40
Epoch 192/200 |loss: 9.482892| train set 3.015x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 41
Epoch 193/200 |loss: 9.088478| train set 3.022x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 42
Epoch 194/200 |loss: 9.020206| train set 2.963x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 43
Epoch 195/200 |loss: 9.109404| train set 3.031x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 44
Epoch 196/200 |loss: 8.934361| train set 3.023x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 45
Epoch 197/200 |loss: 8.703064| train set 2.961x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 46
Epoch 198/200 |loss: 8.865618| train set 3.030x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 47
Epoch 199/200 |loss: 8.889501| train set 2.954x speedup, test set 1.737x speedup, val set 1.043x speedup, step: 48
Training per epoch cost 0.299 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 66.316s, pg runtime 19.707s, speedup 0.297x
38, opt runtime 18.262s, model runtime 55.922s, pg runtime 18.262s, speedup 0.327x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 195, train speedup 3.031, test speedup 1.737, val speedup 1.043
best test speedup epoch: 3, train speedup 1.006, test speedup 2.746, val speedup 0.988
best validation speedup epoch: 152, train speedup 2.904, test speedup 1.747, val speedup 1.132
last model at epoch 199, train speedup 2.954, test speedup 1.737, val speedup 1.043
execution cost 0:02:37.113583
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.049189, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507721| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141737| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847992| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568949| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255957| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958223| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657173| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.383879| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.091263| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.799595| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.506523| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.222128| train set 1.055x speedup, test set 2.499x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 26.006905| train set 1.055x speedup, test set 2.499x speedup, val set 0.975x speedup, step: 17
Epoch 17/200 |loss: 25.957150| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.966030| train set 1.054x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 19
Epoch 19/200 |loss: 25.233332| train set 1.054x speedup, test set 2.526x speedup, val set 1.027x speedup, step: 20
Epoch 20/200 |loss: 25.365292| train set 1.064x speedup, test set 2.549x speedup, val set 0.973x speedup, step: 21
Epoch 21/200 |loss: 25.058153| train set 1.064x speedup, test set 2.493x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.662907| train set 1.064x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.736660| train set 1.070x speedup, test set 2.555x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.145134| train set 1.064x speedup, test set 2.555x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 24.195431| train set 1.071x speedup, test set 1.616x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.750492| train set 1.062x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.626627| train set 2.025x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.450224| train set 1.167x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 29
Epoch 29/200 |loss: 23.020494| train set 1.122x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 23.038713| train set 2.206x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.796152| train set 2.204x speedup, test set 2.464x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.389174| train set 1.171x speedup, test set 2.446x speedup, val set 1.039x speedup, step: 33
Epoch 33/200 |loss: 22.375015| train set 2.230x speedup, test set 2.451x speedup, val set 0.961x speedup, step: 34
Epoch 34/200 |loss: 22.438999| train set 1.060x speedup, test set 2.488x speedup, val set 0.985x speedup, step: 35
Epoch 35/200 |loss: 22.582516| train set 2.136x speedup, test set 2.440x speedup, val set 0.924x speedup, step: 36
Epoch 36/200 |loss: 22.541294| train set 2.230x speedup, test set 1.628x speedup, val set 0.957x speedup, step: 37
Epoch 37/200 |loss: 22.054802| train set 2.219x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 38
Epoch 38/200 |loss: 21.733292| train set 2.230x speedup, test set 1.610x speedup, val set 1.039x speedup, step: 39
Epoch 39/200 |loss: 21.681078| train set 2.233x speedup, test set 1.616x speedup, val set 0.924x speedup, step: 40
Epoch 40/200 |loss: 21.483324| train set 2.228x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 41
Epoch 41/200 |loss: 21.233660| train set 2.228x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 42
Epoch 42/200 |loss: 20.943893| train set 2.232x speedup, test set 1.619x speedup, val set 1.000x speedup, step: 43
Epoch 43/200 |loss: 21.032658| train set 2.209x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 44
Epoch 44/200 |loss: 20.387623| train set 2.243x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 45
Epoch 45/200 |loss: 20.457682| train set 2.297x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 46
Epoch 46/200 |loss: 20.136591| train set 2.245x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 47
Epoch 47/200 |loss: 19.945358| train set 2.243x speedup, test set 1.631x speedup, val set 1.039x speedup, step: 48
Epoch 48/200 |loss: 19.912306| train set 2.281x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 49
Epoch 49/200 |loss: 19.442820| train set 2.338x speedup, test set 1.619x speedup, val set 0.873x speedup, step: 50
Epoch 50/200 |loss: 19.462318| train set 2.270x speedup, test set 1.637x speedup, val set 1.042x speedup, step: 51
Epoch 51/200 |loss: 19.362482| train set 2.354x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 52
Epoch 52/200 |loss: 19.079092| train set 2.212x speedup, test set 1.619x speedup, val set 1.000x speedup, step: 53
Epoch 53/200 |loss: 19.932398| train set 2.460x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 54
Epoch 54/200 |loss: 20.981136| train set 2.270x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 55
Epoch 55/200 |loss: 19.235500| train set 2.284x speedup, test set 1.619x speedup, val set 1.000x speedup, step: 56
Epoch 56/200 |loss: 19.597120| train set 2.561x speedup, test set 1.677x speedup, val set 0.971x speedup, step: 57
Epoch 57/200 |loss: 19.885160| train set 2.312x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 58
Epoch 58/200 |loss: 19.105202| train set 2.252x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 59
Epoch 59/200 |loss: 19.165545| train set 2.333x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 19.220791| train set 2.273x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 61
Epoch 61/200 |loss: 18.475248| train set 2.273x speedup, test set 1.637x speedup, val set 0.873x speedup, step: 62
Epoch 62/200 |loss: 18.602486| train set 2.559x speedup, test set 1.677x speedup, val set 0.971x speedup, step: 63
Epoch 63/200 |loss: 18.504890| train set 2.353x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 64
Epoch 64/200 |loss: 17.812773| train set 2.355x speedup, test set 1.637x speedup, val set 1.042x speedup, step: 65
Epoch 65/200 |loss: 18.008547| train set 2.352x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 66
Epoch 66/200 |loss: 17.516104| train set 2.455x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 67
Epoch 67/200 |loss: 17.539846| train set 2.456x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 68
Epoch 68/200 |loss: 17.301071| train set 2.353x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 69
Epoch 69/200 |loss: 17.102156| train set 2.386x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 70
Epoch 70/200 |loss: 16.958246| train set 2.354x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 71
Epoch 71/200 |loss: 16.674736| train set 2.753x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 72
Epoch 72/200 |loss: 16.698738| train set 2.465x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 73
Epoch 73/200 |loss: 16.346016| train set 2.364x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 74
Epoch 74/200 |loss: 16.271929| train set 2.468x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 75
Epoch 75/200 |loss: 16.217768| train set 2.548x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 76
Epoch 76/200 |loss: 16.533966| train set 2.767x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 77
Epoch 77/200 |loss: 18.072567| train set 2.306x speedup, test set 1.637x speedup, val set 1.042x speedup, step: 78
Epoch 78/200 |loss: 17.030094| train set 2.309x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 79
Epoch 79/200 |loss: 15.942616| train set 2.757x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 80
Epoch 80/200 |loss: 15.886921| train set 2.749x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 81
Epoch 81/200 |loss: 15.882612| train set 2.888x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 82
Epoch 82/200 |loss: 16.166088| train set 2.278x speedup, test set 1.637x speedup, val set 1.039x speedup, step: 83
Epoch 83/200 |loss: 16.373623| train set 2.568x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 84
Epoch 84/200 |loss: 15.487623| train set 2.898x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 85
Epoch 85/200 |loss: 16.206940| train set 2.558x speedup, test set 1.619x speedup, val set 1.039x speedup, step: 86
Epoch 86/200 |loss: 16.290701| train set 2.552x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 87
Epoch 87/200 |loss: 15.066242| train set 2.897x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 88
Epoch 88/200 |loss: 16.940897| train set 2.637x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 89
Epoch 89/200 |loss: 15.167402| train set 2.629x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 90
Epoch 90/200 |loss: 15.323375| train set 2.897x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 91
Epoch 91/200 |loss: 14.939977| train set 2.895x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 14.908112| train set 2.561x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 93
Epoch 93/200 |loss: 14.537306| train set 2.757x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 94
Epoch 94/200 |loss: 14.488756| train set 2.900x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 95
Epoch 95/200 |loss: 14.363797| train set 2.900x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 14.152617| train set 2.629x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 97
Epoch 97/200 |loss: 14.305634| train set 2.905x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 13.983225| train set 2.769x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 99
Epoch 99/200 |loss: 14.227055| train set 2.894x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 100
Epoch 100/200 |loss: 14.318217| train set 2.630x speedup, test set 1.637x speedup, val set 1.043x speedup, step: 1
Epoch 101/200 |loss: 14.799571| train set 2.904x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 102/200 |loss: 14.233839| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 3
Epoch 103/200 |loss: 15.018073| train set 2.369x speedup, test set 1.696x speedup, val set 1.046x speedup, step: 1
Epoch 104/200 |loss: 14.460676| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 105/200 |loss: 13.798725| train set 2.905x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 3
Epoch 106/200 |loss: 12.951661| train set 2.897x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 4
Epoch 107/200 |loss: 13.948993| train set 2.901x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 5
Epoch 108/200 |loss: 13.742560| train set 2.685x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 6
Epoch 109/200 |loss: 12.917494| train set 2.866x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 7
Epoch 110/200 |loss: 13.391817| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 8
Epoch 111/200 |loss: 13.362420| train set 2.746x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 9
Epoch 112/200 |loss: 12.653256| train set 2.743x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 10
Epoch 113/200 |loss: 12.662045| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 11
Epoch 114/200 |loss: 12.616618| train set 2.906x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 12
Epoch 115/200 |loss: 12.167262| train set 2.634x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 13
Epoch 116/200 |loss: 12.036804| train set 2.913x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 14
Epoch 117/200 |loss: 12.215697| train set 2.917x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 15
Epoch 118/200 |loss: 12.070574| train set 2.905x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 16
Epoch 119/200 |loss: 12.225902| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 17
Epoch 120/200 |loss: 14.340866| train set 2.688x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 18
Epoch 121/200 |loss: 12.878952| train set 2.907x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 19
Epoch 122/200 |loss: 11.932299| train set 2.917x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 20
Epoch 123/200 |loss: 11.500080| train set 2.913x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 21
Epoch 124/200 |loss: 11.950348| train set 2.962x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 22
Epoch 125/200 |loss: 12.448413| train set 2.917x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 23
Epoch 126/200 |loss: 11.625160| train set 2.975x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 24
Epoch 127/200 |loss: 11.534529| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 25
Epoch 128/200 |loss: 11.725896| train set 2.913x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 26
Epoch 129/200 |loss: 11.237102| train set 2.967x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 27
Epoch 130/200 |loss: 11.042240| train set 2.907x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 28
Epoch 131/200 |loss: 11.298133| train set 2.823x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 29
Epoch 132/200 |loss: 11.349648| train set 2.919x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 30
Epoch 133/200 |loss: 11.420506| train set 2.905x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 31
Epoch 134/200 |loss: 10.997220| train set 2.973x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 32
Epoch 135/200 |loss: 11.163999| train set 2.907x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 33
Epoch 136/200 |loss: 11.430531| train set 2.808x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 34
Epoch 137/200 |loss: 10.760791| train set 2.940x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 35
Epoch 138/200 |loss: 10.755656| train set 2.958x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 36
Epoch 139/200 |loss: 11.282978| train set 2.761x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 37
Epoch 140/200 |loss: 11.658925| train set 2.863x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 38
Epoch 141/200 |loss: 10.985404| train set 2.936x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 39
Epoch 142/200 |loss: 11.743240| train set 2.708x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 40
Epoch 143/200 |loss: 11.285172| train set 2.764x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 41
Epoch 144/200 |loss: 10.591558| train set 2.919x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 42
Epoch 145/200 |loss: 10.371059| train set 2.962x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 43
Epoch 146/200 |loss: 10.770658| train set 2.919x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 44
Epoch 147/200 |loss: 11.128072| train set 2.774x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 45
Epoch 148/200 |loss: 10.226828| train set 2.973x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 46
Epoch 149/200 |loss: 10.241170| train set 2.942x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 47
Epoch 150/200 |loss: 10.420659| train set 2.812x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 48
Epoch 151/200 |loss: 10.318166| train set 2.966x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 49
Epoch 152/200 |loss: 10.238797| train set 2.960x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 50
Epoch 153/200 |loss: 10.621024| train set 2.997x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 51
Epoch 154/200 |loss: 10.531843| train set 2.960x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 52
Epoch 155/200 |loss: 10.313021| train set 2.909x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 53
Epoch 156/200 |loss: 10.058758| train set 3.016x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 54
Epoch 157/200 |loss: 9.925096| train set 2.960x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 55
Epoch 158/200 |loss: 10.076398| train set 2.788x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 56
Epoch 159/200 |loss: 9.793539| train set 2.978x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 57
Epoch 160/200 |loss: 9.696304| train set 2.960x speedup, test set 1.730x speedup, val set 1.000x speedup, step: 58
Epoch 161/200 |loss: 9.990177| train set 2.963x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 59
Epoch 162/200 |loss: 10.220672| train set 2.960x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 60
Epoch 163/200 |loss: 10.150083| train set 2.927x speedup, test set 1.710x speedup, val set 1.043x speedup, step: 61
Epoch 164/200 |loss: 10.849503| train set 3.006x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 62
Epoch 165/200 |loss: 10.314394| train set 2.950x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 63
Epoch 166/200 |loss: 9.776208| train set 2.919x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 64
Epoch 167/200 |loss: 9.404572| train set 2.968x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 65
Epoch 168/200 |loss: 9.628316| train set 2.964x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 66
Epoch 169/200 |loss: 10.272939| train set 2.867x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 67
Epoch 170/200 |loss: 9.832472| train set 2.967x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 68
Epoch 171/200 |loss: 9.272124| train set 2.969x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 69
Epoch 172/200 |loss: 9.570511| train set 3.009x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 70
Epoch 173/200 |loss: 9.606547| train set 3.010x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 71
Epoch 174/200 |loss: 9.504976| train set 2.964x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 72
Epoch 175/200 |loss: 9.543480| train set 2.963x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 73
Epoch 176/200 |loss: 9.494143| train set 2.919x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 74
Epoch 177/200 |loss: 9.198076| train set 2.821x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 75
Epoch 178/200 |loss: 9.223456| train set 3.005x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 76
Epoch 179/200 |loss: 9.352368| train set 2.964x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 77
Epoch 180/200 |loss: 9.134348| train set 3.006x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 78
Epoch 181/200 |loss: 9.563585| train set 2.906x speedup, test set 1.720x speedup, val set 0.873x speedup, step: 79
Epoch 182/200 |loss: 9.935142| train set 2.968x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 80
Epoch 183/200 |loss: 11.061489| train set 3.041x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 81
Epoch 184/200 |loss: 10.006988| train set 2.960x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 82
Epoch 185/200 |loss: 10.051237| train set 2.791x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 83
Epoch 186/200 |loss: 10.198432| train set 3.025x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 84
Epoch 187/200 |loss: 9.266759| train set 2.961x speedup, test set 1.730x speedup, val set 0.873x speedup, step: 85
Epoch 188/200 |loss: 10.022914| train set 2.707x speedup, test set 1.712x speedup, val set 1.043x speedup, step: 86
Epoch 189/200 |loss: 10.248319| train set 2.912x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 87
Epoch 190/200 |loss: 9.171544| train set 2.951x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 88
Epoch 191/200 |loss: 9.818089| train set 2.889x speedup, test set 1.730x speedup, val set 1.046x speedup, step: 1
Epoch 192/200 |loss: 9.265566| train set 2.909x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 2
Epoch 193/200 |loss: 9.302063| train set 2.911x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 3
Epoch 194/200 |loss: 9.344049| train set 3.030x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 4
Epoch 195/200 |loss: 9.224128| train set 2.802x speedup, test set 1.730x speedup, val set 1.046x speedup, step: 1
Epoch 196/200 |loss: 9.712689| train set 2.972x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 2
Epoch 197/200 |loss: 9.501013| train set 2.912x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 3
Epoch 198/200 |loss: 9.419827| train set 3.049x speedup, test set 1.730x speedup, val set 1.043x speedup, step: 4
Epoch 199/200 |loss: 8.695779| train set 3.019x speedup, test set 1.712x speedup, val set 1.046x speedup, step: 1
Training per epoch cost 0.296 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 6.250s, pg runtime 32.969s, speedup 5.275x
24, opt runtime 6.234s, model runtime 6.234s, pg runtime 32.540s, speedup 5.220x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
34, opt runtime 39.191s, model runtime 54.004s, pg runtime 75.984s, speedup 1.407x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 12.337s, pg runtime 1.206s, speedup 0.098x
40, opt runtime 1.086s, model runtime 13.122s, pg runtime 1.181s, speedup 0.090x
====================
best train speedup epoch: 198, train speedup 3.049, test speedup 1.730, val speedup 1.043
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 199, train speedup 3.019, test speedup 1.712, val speedup 1.046
last model at epoch 199, train speedup 3.019, test speedup 1.712, val speedup 1.046
execution cost 0:02:36.945712
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.036392, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507729| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141748| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.847996| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568960| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255955| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958214| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657228| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.383942| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.092165| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.801889| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.506001| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.213453| train set 1.055x speedup, test set 2.499x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.955988| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.719278| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 18
Epoch 18/200 |loss: 25.751169| train set 1.055x speedup, test set 2.526x speedup, val set 1.030x speedup, step: 19
Epoch 19/200 |loss: 25.768692| train set 1.055x speedup, test set 2.526x speedup, val set 1.027x speedup, step: 20
Epoch 20/200 |loss: 25.098969| train set 1.064x speedup, test set 2.529x speedup, val set 1.027x speedup, step: 21
Epoch 21/200 |loss: 24.929501| train set 1.070x speedup, test set 2.491x speedup, val set 1.027x speedup, step: 22
Epoch 22/200 |loss: 24.809753| train set 1.070x speedup, test set 2.529x speedup, val set 0.957x speedup, step: 23
Epoch 23/200 |loss: 24.316841| train set 1.064x speedup, test set 2.606x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.353035| train set 1.071x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.912004| train set 1.071x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 26
Epoch 26/200 |loss: 23.795063| train set 1.106x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 27
Epoch 27/200 |loss: 23.627472| train set 2.028x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 28
Epoch 28/200 |loss: 23.229570| train set 1.061x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 29
Epoch 29/200 |loss: 23.199793| train set 2.169x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 30
Epoch 30/200 |loss: 23.044687| train set 2.206x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 31
Epoch 31/200 |loss: 22.618402| train set 1.889x speedup, test set 2.483x speedup, val set 0.957x speedup, step: 32
Epoch 32/200 |loss: 22.495613| train set 2.230x speedup, test set 2.451x speedup, val set 0.961x speedup, step: 33
Epoch 33/200 |loss: 22.594950| train set 1.061x speedup, test set 1.629x speedup, val set 0.983x speedup, step: 34
Epoch 34/200 |loss: 22.470818| train set 2.181x speedup, test set 2.458x speedup, val set 0.909x speedup, step: 35
Epoch 35/200 |loss: 22.169287| train set 2.230x speedup, test set 1.622x speedup, val set 0.957x speedup, step: 36
Epoch 36/200 |loss: 22.150463| train set 2.164x speedup, test set 1.631x speedup, val set 0.983x speedup, step: 37
Epoch 37/200 |loss: 21.575975| train set 2.119x speedup, test set 1.613x speedup, val set 0.909x speedup, step: 38
Epoch 38/200 |loss: 21.592279| train set 2.239x speedup, test set 1.615x speedup, val set 1.039x speedup, step: 39
Epoch 39/200 |loss: 21.447397| train set 2.218x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 40
Epoch 40/200 |loss: 21.089827| train set 2.119x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 41
Epoch 41/200 |loss: 20.909510| train set 2.261x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 42
Epoch 42/200 |loss: 21.185535| train set 2.179x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 43
Epoch 43/200 |loss: 20.542793| train set 2.166x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 44
Epoch 44/200 |loss: 20.309151| train set 2.167x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 45
Epoch 45/200 |loss: 20.493103| train set 2.130x speedup, test set 1.613x speedup, val set 1.043x speedup, step: 46
Epoch 46/200 |loss: 19.754400| train set 2.292x speedup, test set 1.613x speedup, val set 1.043x speedup, step: 47
Epoch 47/200 |loss: 19.839869| train set 2.270x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 48
Epoch 48/200 |loss: 19.493683| train set 2.152x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 49
Epoch 49/200 |loss: 19.567225| train set 2.353x speedup, test set 1.614x speedup, val set 1.042x speedup, step: 50
Epoch 50/200 |loss: 19.446589| train set 2.730x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 51
Epoch 51/200 |loss: 19.495209| train set 2.197x speedup, test set 1.613x speedup, val set 1.042x speedup, step: 52
Epoch 52/200 |loss: 20.022274| train set 2.437x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 53
Epoch 53/200 |loss: 20.645262| train set 2.206x speedup, test set 1.619x speedup, val set 1.043x speedup, step: 54
Epoch 54/200 |loss: 19.218561| train set 2.270x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 55
Epoch 55/200 |loss: 19.052425| train set 2.460x speedup, test set 1.672x speedup, val set 0.873x speedup, step: 56
Epoch 56/200 |loss: 18.759632| train set 2.292x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 57
Epoch 57/200 |loss: 18.888041| train set 2.197x speedup, test set 1.614x speedup, val set 1.042x speedup, step: 58
Epoch 58/200 |loss: 18.364920| train set 2.270x speedup, test set 1.678x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 18.111629| train set 2.306x speedup, test set 1.691x speedup, val set 0.873x speedup, step: 60
Epoch 60/200 |loss: 18.304296| train set 2.460x speedup, test set 1.691x speedup, val set 0.873x speedup, step: 61
Epoch 61/200 |loss: 18.212559| train set 2.359x speedup, test set 1.630x speedup, val set 1.046x speedup, step: 62
Epoch 62/200 |loss: 17.583561| train set 2.359x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 63
Epoch 63/200 |loss: 17.525293| train set 2.463x speedup, test set 1.691x speedup, val set 1.043x speedup, step: 64
Epoch 64/200 |loss: 17.610231| train set 2.311x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 65
Epoch 65/200 |loss: 17.697788| train set 2.359x speedup, test set 1.691x speedup, val set 1.043x speedup, step: 66
Epoch 66/200 |loss: 16.829109| train set 2.362x speedup, test set 1.691x speedup, val set 1.046x speedup, step: 67
Epoch 67/200 |loss: 16.814600| train set 2.305x speedup, test set 1.688x speedup, val set 1.046x speedup, step: 68
Epoch 68/200 |loss: 16.862335| train set 2.765x speedup, test set 1.691x speedup, val set 0.873x speedup, step: 69
Epoch 69/200 |loss: 16.692535| train set 2.308x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 70
Epoch 70/200 |loss: 16.637989| train set 2.628x speedup, test set 1.691x speedup, val set 1.043x speedup, step: 71
Epoch 71/200 |loss: 16.604094| train set 2.307x speedup, test set 1.688x speedup, val set 1.046x speedup, step: 72
Epoch 72/200 |loss: 16.384340| train set 2.885x speedup, test set 1.677x speedup, val set 0.971x speedup, step: 73
Epoch 73/200 |loss: 17.281092| train set 1.933x speedup, test set 1.630x speedup, val set 1.042x speedup, step: 74
Epoch 74/200 |loss: 20.082041| train set 2.350x speedup, test set 1.655x speedup, val set 1.043x speedup, step: 75
Epoch 75/200 |loss: 16.799807| train set 2.556x speedup, test set 1.655x speedup, val set 0.900x speedup, step: 76
Epoch 76/200 |loss: 18.206570| train set 2.361x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 77
Epoch 77/200 |loss: 17.265350| train set 2.248x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 78
Epoch 78/200 |loss: 17.681915| train set 2.754x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 79
Epoch 79/200 |loss: 16.914829| train set 2.549x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 80
Epoch 80/200 |loss: 16.685646| train set 2.310x speedup, test set 1.655x speedup, val set 0.873x speedup, step: 81
Epoch 81/200 |loss: 18.096634| train set 2.362x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 82
Epoch 82/200 |loss: 16.191746| train set 2.558x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 83
Epoch 83/200 |loss: 16.238554| train set 2.897x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 84
Epoch 84/200 |loss: 16.996717| train set 2.314x speedup, test set 1.673x speedup, val set 0.931x speedup, step: 85
Epoch 85/200 |loss: 16.386940| train set 2.396x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 86
Epoch 86/200 |loss: 15.865487| train set 2.900x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 87
Epoch 87/200 |loss: 16.004110| train set 2.626x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 88
Epoch 88/200 |loss: 15.394596| train set 2.622x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 89
Epoch 89/200 |loss: 15.236607| train set 2.882x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 15.376767| train set 2.663x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 91
Epoch 91/200 |loss: 14.898404| train set 2.745x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 92
Epoch 92/200 |loss: 14.582526| train set 2.758x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 93
Epoch 93/200 |loss: 14.935330| train set 2.900x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 94
Epoch 94/200 |loss: 14.228336| train set 2.886x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 95
Epoch 95/200 |loss: 14.195159| train set 2.758x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 96
Epoch 96/200 |loss: 14.058940| train set 2.699x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 97
Epoch 97/200 |loss: 13.894343| train set 2.901x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 98
Epoch 98/200 |loss: 13.697792| train set 2.886x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 13.523866| train set 2.629x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 100
Epoch 100/200 |loss: 13.364450| train set 2.900x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 13.173960| train set 2.901x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 102/200 |loss: 13.041686| train set 2.911x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 103/200 |loss: 13.100026| train set 2.900x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 104/200 |loss: 14.120833| train set 2.560x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 1
Epoch 105/200 |loss: 15.720317| train set 2.954x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 2
Epoch 106/200 |loss: 18.325480| train set 2.763x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 107/200 |loss: 13.794547| train set 2.245x speedup, test set 1.418x speedup, val set 1.000x speedup, step: 4
Epoch 108/200 |loss: 19.575861| train set 2.903x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 5
Epoch 109/200 |loss: 15.358568| train set 2.906x speedup, test set 1.696x speedup, val set 1.043x speedup, step: 1
Epoch 110/200 |loss: 16.339333| train set 2.499x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 111/200 |loss: 14.866163| train set 2.619x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 112/200 |loss: 15.586958| train set 2.901x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 3
Epoch 113/200 |loss: 14.363309| train set 2.626x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 114/200 |loss: 15.195299| train set 2.902x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 115/200 |loss: 13.620533| train set 2.904x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 2
Epoch 116/200 |loss: 14.374919| train set 2.907x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 3
Epoch 117/200 |loss: 13.319155| train set 2.746x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 118/200 |loss: 13.828732| train set 2.626x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 119/200 |loss: 13.082578| train set 2.913x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 120/200 |loss: 13.134284| train set 2.903x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 121/200 |loss: 12.758589| train set 2.760x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 122/200 |loss: 12.714711| train set 2.760x speedup, test set 1.704x speedup, val set 1.000x speedup, step: 2
Epoch 123/200 |loss: 12.619493| train set 2.913x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 124/200 |loss: 12.211070| train set 2.903x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 125/200 |loss: 12.350969| train set 2.902x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 126/200 |loss: 11.949169| train set 2.903x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 127/200 |loss: 12.001319| train set 2.958x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 128/200 |loss: 11.749509| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 4
Epoch 129/200 |loss: 11.828148| train set 2.889x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 130/200 |loss: 11.814163| train set 2.916x speedup, test set 1.704x speedup, val set 1.000x speedup, step: 2
Epoch 131/200 |loss: 12.147010| train set 2.911x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 132/200 |loss: 11.980632| train set 2.907x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 133/200 |loss: 11.703367| train set 2.907x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 134/200 |loss: 11.093945| train set 2.919x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 2
Epoch 135/200 |loss: 11.221372| train set 2.906x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 136/200 |loss: 11.394248| train set 2.958x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 137/200 |loss: 11.479498| train set 2.907x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 2
Epoch 138/200 |loss: 10.940377| train set 2.909x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 3
Epoch 139/200 |loss: 10.784343| train set 2.908x speedup, test set 1.704x speedup, val set 1.043x speedup, step: 1
Epoch 140/200 |loss: 10.807518| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 141/200 |loss: 10.963179| train set 2.914x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 142/200 |loss: 10.726743| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 143/200 |loss: 11.023869| train set 2.907x speedup, test set 1.673x speedup, val set 1.043x speedup, step: 1
Epoch 144/200 |loss: 11.548466| train set 2.924x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 2
Epoch 145/200 |loss: 13.250322| train set 2.774x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 146/200 |loss: 11.545225| train set 2.978x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 2
Epoch 147/200 |loss: 10.474347| train set 2.908x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 3
Epoch 148/200 |loss: 11.889235| train set 2.865x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 149/200 |loss: 11.231196| train set 2.914x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 150/200 |loss: 10.366403| train set 2.904x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 151/200 |loss: 10.962390| train set 2.915x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 1
Epoch 152/200 |loss: 10.706106| train set 2.908x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 153/200 |loss: 10.210114| train set 2.919x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 2
Epoch 154/200 |loss: 10.348653| train set 2.919x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 155/200 |loss: 10.165560| train set 2.793x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 156/200 |loss: 10.459059| train set 2.919x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 2
Epoch 157/200 |loss: 9.820048| train set 2.908x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 3
Epoch 158/200 |loss: 10.028296| train set 2.924x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 159/200 |loss: 10.344005| train set 2.978x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 160/200 |loss: 9.778745| train set 2.919x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 2
Epoch 161/200 |loss: 10.007987| train set 2.981x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 162/200 |loss: 10.412934| train set 2.952x speedup, test set 1.747x speedup, val set 1.000x speedup, step: 2
Epoch 163/200 |loss: 10.916380| train set 2.978x speedup, test set 1.688x speedup, val set 0.873x speedup, step: 3
Epoch 164/200 |loss: 10.395111| train set 2.919x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 4
Epoch 165/200 |loss: 9.680540| train set 2.927x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 1
Epoch 166/200 |loss: 10.024632| train set 2.924x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 167/200 |loss: 10.330732| train set 2.949x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 2
Epoch 168/200 |loss: 9.774087| train set 2.966x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 1
Epoch 169/200 |loss: 9.680930| train set 2.983x speedup, test set 1.640x speedup, val set 1.043x speedup, step: 1
Epoch 170/200 |loss: 9.912794| train set 2.950x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 2
Epoch 171/200 |loss: 10.003718| train set 2.919x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 172/200 |loss: 9.794487| train set 2.911x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 1
Epoch 173/200 |loss: 9.754368| train set 2.937x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 2
Epoch 174/200 |loss: 10.022914| train set 2.924x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 175/200 |loss: 10.289677| train set 2.908x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 176/200 |loss: 9.575788| train set 2.921x speedup, test set 1.749x speedup, val set 0.873x speedup, step: 2
Epoch 177/200 |loss: 9.525333| train set 2.982x speedup, test set 1.640x speedup, val set 1.043x speedup, step: 1
Epoch 178/200 |loss: 9.498102| train set 2.960x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 179/200 |loss: 9.222910| train set 2.960x speedup, test set 1.689x speedup, val set 1.000x speedup, step: 2
Epoch 180/200 |loss: 9.273497| train set 3.026x speedup, test set 1.640x speedup, val set 1.043x speedup, step: 1
Epoch 181/200 |loss: 9.434300| train set 2.969x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 1
Epoch 182/200 |loss: 9.551307| train set 3.010x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 183/200 |loss: 9.280561| train set 2.967x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 184/200 |loss: 9.268339| train set 2.969x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 1
Epoch 185/200 |loss: 9.406411| train set 2.984x speedup, test set 1.688x speedup, val set 0.873x speedup, step: 2
Epoch 186/200 |loss: 9.123619| train set 3.010x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 187/200 |loss: 8.968455| train set 2.952x speedup, test set 1.749x speedup, val set 1.043x speedup, step: 1
Epoch 188/200 |loss: 9.151986| train set 3.015x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 189/200 |loss: 8.950864| train set 2.960x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 2
Epoch 190/200 |loss: 8.865451| train set 2.969x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 191/200 |loss: 8.767312| train set 3.030x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 1
Epoch 192/200 |loss: 8.723309| train set 3.010x speedup, test set 1.747x speedup, val set 1.043x speedup, step: 1
Epoch 193/200 |loss: 8.806431| train set 2.987x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 194/200 |loss: 9.200443| train set 2.951x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 195/200 |loss: 9.115746| train set 2.986x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 1
Epoch 196/200 |loss: 9.647237| train set 3.018x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 197/200 |loss: 9.943843| train set 2.911x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 2
Epoch 198/200 |loss: 9.968496| train set 2.845x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Epoch 199/200 |loss: 9.353711| train set 2.987x speedup, test set 1.688x speedup, val set 1.043x speedup, step: 1
Training per epoch cost 0.296 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 46.819s, pg runtime 31.019s, speedup 0.663x
08, opt runtime 7.377s, model runtime 37.574s, pg runtime 28.655s, speedup 0.763x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 11.165s, pg runtime 32.969s, speedup 2.953x
24, opt runtime 6.234s, model runtime 10.220s, pg runtime 32.540s, speedup 3.184x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 1.088s, pg runtime 1.206s, speedup 1.109x
40, opt runtime 1.086s, model runtime 1.086s, pg runtime 1.181s, speedup 1.088x
====================
best train speedup epoch: 191, train speedup 3.030, test speedup 1.747, val speedup 1.043
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 199, train speedup 2.987, test speedup 1.688, val speedup 1.043
last model at epoch 199, train speedup 2.987, test speedup 1.688, val speedup 1.043
execution cost 0:02:37.158150
==================================================
all print will write to path record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
==================================================
Model: <class 'src.models.TCNN.TCNN'>
NUM_HINT_SET: 49
app: list
batch_size: 128
candidate_list: 30
data_root_path: ./db_benchmark_datasets
dataset: join-order-benchmark
dbms: postgresql
epochs: 200
execute_sql: 0
expname: main_repeat
grain: repeat
lr: 0.001
meta_save_path: record/postgresql/join-order-benchmark/execute_sql
model: TCNN
npseed: 42
pairwise: False
parameter: 
pre_execute_all: 0
sample_num: 1000
sampling: -1
save_path: record/postgresql/cross/JOB_TPCH/TCNN/slow_split/list
seed: 42
shuffle_num: 1
slow: 1
split_ratio: 0.1
src: JOB
tgt: TPCH
tolerance: 10
train: 1
weighted: False

Loaded number of JOB queries: 113
(113, 49)
(113, 49)
21a.sql
test query:  ['1d.sql' '10c.sql' '11c.sql' '12c.sql' '13d.sql' '14c.sql' '15d.sql'
 '16b.sql' '17a.sql' '18c.sql' '19d.sql' '2d.sql' '20c.sql' '21a.sql'
 '22c.sql' '23c.sql' '24a.sql' '25c.sql' '26c.sql' '27c.sql' '28c.sql'
 '29b.sql' '3c.sql' '30c.sql' '31c.sql' '32b.sql' '33c.sql' '4a.sql'
 '5c.sql' '6d.sql' '7c.sql' '8c.sql' '9d.sql']
load JOB succ
load TPCH...
[2, 3, 4, 5, 7, 9] [6, 8] [1, 0]
[0, 3, 4, 7, 8, 9] [5, 2] [6, 1]
[0, 4, 6, 7, 8, 9] [1, 3] [5, 2]
[0, 3, 4, 5, 7, 8] [1, 9] [2, 6]
[0, 3, 4, 6, 8, 9] [7, 2] [1, 5]
[1, 2, 3, 4, 6, 8] [5, 9] [7, 0]
[2, 3, 4, 5, 7, 8] [1, 6] [0, 9]
[1, 4, 6, 7, 8, 9] [0, 2] [5, 3]
[3, 4, 5, 7, 8, 9] [1, 0] [2, 6]
[0, 1, 2, 5, 7, 8] [3, 9] [4, 6]
[0, 2, 3, 5, 7, 9] [4, 6] [8, 1]
[0, 1, 2, 3, 5, 6] [9, 8] [7, 4]
[0, 3, 4, 5, 7, 9] [1, 2] [6, 8]
[2, 3, 4, 5, 6, 9] [0, 7] [1, 8]
[0, 1, 5, 6, 8, 9] [3, 2] [4, 7]
[0, 1, 4, 5, 6, 9] [8, 2] [7, 3]
[0, 2, 3, 6, 7, 9] [8, 5] [4, 1]
[0, 1, 2, 6, 7, 9] [5, 3] [4, 8]
[1, 2, 3, 4, 6, 8] [7, 9] [5, 0]
[0, 3, 5, 7, 8, 9] [2, 6] [1, 4]
load TPCH succ
load TPCH_Skew...
[0, 4, 5, 7, 8, 9] [6, 1] [2, 3]
[0, 1, 2, 3, 8, 9] [4, 5] [7, 6]
[0, 1, 2, 3, 7, 9] [4, 5] [6, 8]
[2, 3, 4, 5, 8, 9] [1, 6] [0, 7]
[0, 1, 2, 4, 6, 8] [7, 3] [9, 5]
[1, 3, 5, 7, 8, 9] [0, 6] [2, 4]
[0, 4, 5, 7, 8, 9] [3, 1] [2, 6]
[0, 1, 2, 4, 6, 8] [9, 3] [5, 7]
[0, 1, 2, 3, 7, 8] [9, 4] [6, 5]
[0, 1, 4, 6, 8, 9] [3, 2] [5, 7]
[2, 3, 5, 7, 8, 9] [4, 6] [1, 0]
[0, 1, 2, 4, 5, 9] [8, 7] [3, 6]
[1, 3, 4, 7, 8, 9] [2, 5] [6, 0]
[1, 2, 3, 5, 6, 8] [0, 9] [4, 7]
[0, 2, 4, 5, 7, 8] [9, 6] [1, 3]
[0, 2, 3, 6, 8, 9] [7, 1] [5, 4]
[0, 2, 4, 5, 8, 9] [6, 3] [7, 1]
[0, 1, 3, 4, 8, 9] [6, 5] [7, 2]
[0, 1, 3, 6, 8, 9] [2, 4] [5, 7]
[0, 1, 3, 4, 8, 9] [5, 2] [6, 7]
load TPCH Skew succ
train, test, validation (72, 49) (40, 49) (8, 49)
85.5474107161068
-1.0
construct training samples cost 0:00:01.110645, and there are 72 training samples
in channel 9
Epoch 0/200 |loss: 36.138966| train set 0.924x speedup, test set 2.718x speedup, val set 0.962x speedup, step: 1
Epoch 1/200 |loss: 32.684097| train set 0.969x speedup, test set 1.446x speedup, val set 0.988x speedup, step: 2
Epoch 2/200 |loss: 30.663980| train set 0.971x speedup, test set 1.510x speedup, val set 0.988x speedup, step: 3
Epoch 3/200 |loss: 29.779140| train set 1.006x speedup, test set 2.746x speedup, val set 0.988x speedup, step: 4
Epoch 4/200 |loss: 29.507730| train set 1.005x speedup, test set 2.584x speedup, val set 0.988x speedup, step: 5
Epoch 5/200 |loss: 29.141750| train set 1.005x speedup, test set 2.585x speedup, val set 0.988x speedup, step: 6
Epoch 6/200 |loss: 28.848000| train set 1.012x speedup, test set 2.738x speedup, val set 1.063x speedup, step: 7
Epoch 7/200 |loss: 28.568960| train set 1.012x speedup, test set 2.630x speedup, val set 1.063x speedup, step: 8
Epoch 8/200 |loss: 28.255945| train set 1.012x speedup, test set 2.717x speedup, val set 1.060x speedup, step: 9
Epoch 9/200 |loss: 27.958143| train set 1.012x speedup, test set 2.777x speedup, val set 1.060x speedup, step: 10
Epoch 10/200 |loss: 27.657236| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 11
Epoch 11/200 |loss: 27.384830| train set 1.012x speedup, test set 2.692x speedup, val set 1.060x speedup, step: 12
Epoch 12/200 |loss: 27.093723| train set 1.011x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 13
Epoch 13/200 |loss: 26.804485| train set 1.028x speedup, test set 2.717x speedup, val set 0.975x speedup, step: 14
Epoch 14/200 |loss: 26.509123| train set 1.055x speedup, test set 2.602x speedup, val set 0.975x speedup, step: 15
Epoch 15/200 |loss: 26.224785| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 16
Epoch 16/200 |loss: 25.983795| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 17
Epoch 17/200 |loss: 25.816589| train set 1.055x speedup, test set 2.526x speedup, val set 0.975x speedup, step: 18
Epoch 18/200 |loss: 25.820766| train set 1.055x speedup, test set 2.526x speedup, val set 1.060x speedup, step: 19
Epoch 19/200 |loss: 25.535118| train set 1.055x speedup, test set 2.526x speedup, val set 1.027x speedup, step: 20
Epoch 20/200 |loss: 24.972649| train set 1.064x speedup, test set 2.549x speedup, val set 1.027x speedup, step: 21
Epoch 21/200 |loss: 25.082170| train set 1.064x speedup, test set 2.529x speedup, val set 0.972x speedup, step: 22
Epoch 22/200 |loss: 24.743021| train set 1.065x speedup, test set 2.471x speedup, val set 0.909x speedup, step: 23
Epoch 23/200 |loss: 24.349268| train set 1.071x speedup, test set 2.468x speedup, val set 0.957x speedup, step: 24
Epoch 24/200 |loss: 24.387691| train set 1.070x speedup, test set 2.493x speedup, val set 0.957x speedup, step: 25
Epoch 25/200 |loss: 23.915606| train set 1.105x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 26
Epoch 26/200 |loss: 23.788910| train set 1.071x speedup, test set 2.464x speedup, val set 0.909x speedup, step: 27
Epoch 27/200 |loss: 23.588545| train set 1.071x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 28
Epoch 28/200 |loss: 23.194803| train set 2.206x speedup, test set 2.490x speedup, val set 0.957x speedup, step: 29
Epoch 29/200 |loss: 23.147665| train set 1.062x speedup, test set 2.446x speedup, val set 0.983x speedup, step: 30
Epoch 30/200 |loss: 22.950850| train set 2.227x speedup, test set 2.490x speedup, val set 0.909x speedup, step: 31
Epoch 31/200 |loss: 22.697075| train set 1.058x speedup, test set 2.472x speedup, val set 0.983x speedup, step: 32
Epoch 32/200 |loss: 22.690325| train set 2.230x speedup, test set 2.475x speedup, val set 0.957x speedup, step: 33
Epoch 33/200 |loss: 22.451454| train set 2.230x speedup, test set 2.451x speedup, val set 0.957x speedup, step: 34
Epoch 34/200 |loss: 22.063974| train set 1.875x speedup, test set 1.629x speedup, val set 0.983x speedup, step: 35
Epoch 35/200 |loss: 21.896568| train set 2.230x speedup, test set 1.610x speedup, val set 0.943x speedup, step: 36
Epoch 36/200 |loss: 21.769718| train set 2.209x speedup, test set 1.610x speedup, val set 0.983x speedup, step: 37
Epoch 37/200 |loss: 21.418928| train set 2.209x speedup, test set 1.613x speedup, val set 0.983x speedup, step: 38
Epoch 38/200 |loss: 21.076948| train set 2.238x speedup, test set 1.610x speedup, val set 0.880x speedup, step: 39
Epoch 39/200 |loss: 21.068296| train set 2.228x speedup, test set 1.613x speedup, val set 0.985x speedup, step: 40
Epoch 40/200 |loss: 20.940559| train set 2.238x speedup, test set 1.613x speedup, val set 0.924x speedup, step: 41
Epoch 41/200 |loss: 20.495342| train set 2.239x speedup, test set 1.613x speedup, val set 0.957x speedup, step: 42
Epoch 42/200 |loss: 20.367418| train set 2.310x speedup, test set 1.615x speedup, val set 0.957x speedup, step: 43
Epoch 43/200 |loss: 21.714106| train set 2.104x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 44
Epoch 44/200 |loss: 22.671381| train set 2.401x speedup, test set 1.620x speedup, val set 0.924x speedup, step: 45
Epoch 45/200 |loss: 21.011238| train set 2.325x speedup, test set 1.615x speedup, val set 0.957x speedup, step: 46
Epoch 46/200 |loss: 21.092249| train set 2.229x speedup, test set 1.619x speedup, val set 0.996x speedup, step: 47
Epoch 47/200 |loss: 20.589243| train set 2.277x speedup, test set 1.619x speedup, val set 0.924x speedup, step: 48
Epoch 48/200 |loss: 20.344852| train set 2.271x speedup, test set 1.614x speedup, val set 1.039x speedup, step: 49
Epoch 49/200 |loss: 20.019270| train set 2.196x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 50
Epoch 50/200 |loss: 19.642847| train set 2.141x speedup, test set 1.620x speedup, val set 0.987x speedup, step: 51
Epoch 51/200 |loss: 19.939465| train set 2.273x speedup, test set 1.614x speedup, val set 1.043x speedup, step: 52
Epoch 52/200 |loss: 19.127062| train set 2.325x speedup, test set 1.632x speedup, val set 1.039x speedup, step: 53
Epoch 53/200 |loss: 19.587385| train set 2.354x speedup, test set 1.613x speedup, val set 1.043x speedup, step: 54
Epoch 54/200 |loss: 18.814402| train set 2.372x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 55
Epoch 55/200 |loss: 19.036081| train set 2.354x speedup, test set 1.613x speedup, val set 1.039x speedup, step: 56
Epoch 56/200 |loss: 18.605354| train set 2.457x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 57
Epoch 57/200 |loss: 18.400387| train set 2.543x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 58
Epoch 58/200 |loss: 18.444298| train set 2.354x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 59
Epoch 59/200 |loss: 17.928074| train set 2.356x speedup, test set 1.689x speedup, val set 1.043x speedup, step: 60
Epoch 60/200 |loss: 18.095123| train set 2.356x speedup, test set 1.668x speedup, val set 1.043x speedup, step: 61
Epoch 61/200 |loss: 17.815041| train set 2.565x speedup, test set 1.668x speedup, val set 1.000x speedup, step: 62
Epoch 62/200 |loss: 17.471897| train set 2.353x speedup, test set 1.630x speedup, val set 1.043x speedup, step: 63
Epoch 63/200 |loss: 17.718767| train set 2.544x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 64
Epoch 64/200 |loss: 17.659803| train set 2.356x speedup, test set 1.640x speedup, val set 1.042x speedup, step: 65
Epoch 65/200 |loss: 17.537161| train set 2.574x speedup, test set 1.689x speedup, val set 0.873x speedup, step: 66
Epoch 66/200 |loss: 18.350794| train set 2.218x speedup, test set 1.640x speedup, val set 1.039x speedup, step: 67
Epoch 67/200 |loss: 18.860460| train set 2.357x speedup, test set 1.677x speedup, val set 0.873x speedup, step: 68
Epoch 68/200 |loss: 17.796043| train set 2.567x speedup, test set 1.687x speedup, val set 0.873x speedup, step: 69
Epoch 69/200 |loss: 18.409084| train set 2.303x speedup, test set 1.628x speedup, val set 1.000x speedup, step: 70
Epoch 70/200 |loss: 17.824385| train set 2.667x speedup, test set 1.677x speedup, val set 1.000x speedup, step: 71
Epoch 71/200 |loss: 18.664692| train set 2.753x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 72
Epoch 72/200 |loss: 16.565533| train set 2.461x speedup, test set 1.682x speedup, val set 1.000x speedup, step: 73
Epoch 73/200 |loss: 17.786827| train set 2.561x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 74
Epoch 74/200 |loss: 16.277674| train set 2.558x speedup, test set 1.677x speedup, val set 1.043x speedup, step: 75
Epoch 75/200 |loss: 17.354059| train set 2.662x speedup, test set 1.665x speedup, val set 1.000x speedup, step: 76
Epoch 76/200 |loss: 16.440031| train set 2.466x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 77
Epoch 77/200 |loss: 16.567646| train set 2.897x speedup, test set 1.684x speedup, val set 0.873x speedup, step: 78
Epoch 78/200 |loss: 16.306557| train set 2.558x speedup, test set 1.684x speedup, val set 1.039x speedup, step: 79
Epoch 79/200 |loss: 16.048523| train set 2.558x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 80
Epoch 80/200 |loss: 15.940403| train set 2.901x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 81
Epoch 81/200 |loss: 15.389265| train set 2.465x speedup, test set 1.684x speedup, val set 1.046x speedup, step: 82
Epoch 82/200 |loss: 15.880177| train set 2.901x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 83
Epoch 83/200 |loss: 15.443215| train set 2.625x speedup, test set 1.684x speedup, val set 1.043x speedup, step: 84
Epoch 84/200 |loss: 15.504880| train set 2.907x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 85
Epoch 85/200 |loss: 14.882653| train set 2.469x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 86
Epoch 86/200 |loss: 14.933685| train set 2.558x speedup, test set 1.684x speedup, val set 1.043x speedup, step: 87
Epoch 87/200 |loss: 15.063426| train set 2.758x speedup, test set 1.708x speedup, val set 1.000x speedup, step: 88
Epoch 88/200 |loss: 16.487282| train set 2.764x speedup, test set 1.693x speedup, val set 1.000x speedup, step: 89
Epoch 89/200 |loss: 14.828422| train set 2.911x speedup, test set 1.704x speedup, val set 1.000x speedup, step: 90
Epoch 90/200 |loss: 14.300687| train set 2.900x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 91
Epoch 91/200 |loss: 14.874632| train set 2.672x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 92
Epoch 92/200 |loss: 14.533205| train set 2.759x speedup, test set 1.699x speedup, val set 1.043x speedup, step: 93
Epoch 93/200 |loss: 14.331645| train set 2.897x speedup, test set 1.682x speedup, val set 1.132x speedup, step: 94
Epoch 94/200 |loss: 15.838945| train set 2.311x speedup, test set 1.628x speedup, val set 1.042x speedup, step: 95
Epoch 95/200 |loss: 17.117994| train set 2.629x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 96
Epoch 96/200 |loss: 15.004569| train set 2.912x speedup, test set 1.681x speedup, val set 1.132x speedup, step: 97
Epoch 97/200 |loss: 14.989153| train set 2.785x speedup, test set 1.673x speedup, val set 0.822x speedup, step: 98
Epoch 98/200 |loss: 16.060225| train set 2.758x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 99
Epoch 99/200 |loss: 15.110823| train set 2.560x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 100
Epoch 100/200 |loss: 15.329042| train set 2.570x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 1
Epoch 101/200 |loss: 14.530250| train set 2.750x speedup, test set 1.696x speedup, val set 0.873x speedup, step: 2
Epoch 102/200 |loss: 15.322144| train set 2.902x speedup, test set 1.699x speedup, val set 1.000x speedup, step: 1
Epoch 103/200 |loss: 14.007070| train set 2.889x speedup, test set 1.684x speedup, val set 1.000x speedup, step: 1
Epoch 104/200 |loss: 14.327497| train set 2.458x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 105/200 |loss: 14.256619| train set 2.469x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 106/200 |loss: 13.387148| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 107/200 |loss: 13.791317| train set 2.919x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 108/200 |loss: 14.151793| train set 2.563x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 109/200 |loss: 13.136031| train set 2.685x speedup, test set 1.673x speedup, val set 1.000x speedup, step: 1
Epoch 110/200 |loss: 13.683376| train set 2.901x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 111/200 |loss: 13.390925| train set 2.786x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 112/200 |loss: 12.937049| train set 2.826x speedup, test set 1.682x speedup, val set 1.000x speedup, step: 1
Epoch 113/200 |loss: 13.172490| train set 2.903x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 114/200 |loss: 13.355806| train set 2.630x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 115/200 |loss: 12.504251| train set 2.685x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 116/200 |loss: 12.608832| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 117/200 |loss: 12.917699| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 118/200 |loss: 12.003337| train set 2.764x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 119/200 |loss: 12.103145| train set 2.903x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 120/200 |loss: 12.407039| train set 2.913x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 121/200 |loss: 11.645835| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 122/200 |loss: 11.689450| train set 2.906x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 123/200 |loss: 11.884040| train set 2.773x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 124/200 |loss: 11.571056| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 125/200 |loss: 11.233156| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 126/200 |loss: 11.216526| train set 2.976x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 127/200 |loss: 11.550716| train set 2.907x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 128/200 |loss: 12.385907| train set 2.661x speedup, test set 1.696x speedup, val set 0.972x speedup, step: 2
Epoch 129/200 |loss: 12.907653| train set 2.922x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 130/200 |loss: 11.912837| train set 2.917x speedup, test set 1.696x speedup, val set 1.000x speedup, step: 1
Epoch 131/200 |loss: 11.131046| train set 2.774x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 2
Epoch 132/200 |loss: 11.814034| train set 2.949x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 133/200 |loss: 11.922254| train set 2.959x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 134/200 |loss: 11.167775| train set 2.983x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 135/200 |loss: 11.481387| train set 2.922x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 136/200 |loss: 11.644123| train set 2.907x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 137/200 |loss: 11.061558| train set 2.801x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 2
Epoch 138/200 |loss: 11.575339| train set 2.908x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 139/200 |loss: 11.938716| train set 2.869x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 140/200 |loss: 11.018352| train set 2.976x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 141/200 |loss: 11.051707| train set 2.906x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 142/200 |loss: 10.738397| train set 2.694x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 143/200 |loss: 11.215459| train set 2.963x speedup, test set 1.687x speedup, val set 0.934x speedup, step: 2
Epoch 144/200 |loss: 11.233736| train set 2.948x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 145/200 |loss: 11.637510| train set 2.792x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 146/200 |loss: 11.694539| train set 2.909x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 147/200 |loss: 10.551664| train set 2.935x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 148/200 |loss: 11.302307| train set 2.925x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 1
Epoch 149/200 |loss: 11.044072| train set 2.636x speedup, test set 1.687x speedup, val set 1.043x speedup, step: 1
Epoch 150/200 |loss: 11.310130| train set 2.959x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 2
Epoch 151/200 |loss: 10.254300| train set 2.917x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 3
Epoch 152/200 |loss: 10.617533| train set 2.808x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 4
Epoch 153/200 |loss: 10.973821| train set 2.925x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 5
Epoch 154/200 |loss: 10.552869| train set 2.961x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 6
Epoch 155/200 |loss: 10.256129| train set 3.012x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 7
Epoch 156/200 |loss: 10.080449| train set 2.925x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 8
Epoch 157/200 |loss: 10.648670| train set 2.911x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 9
Epoch 158/200 |loss: 10.044966| train set 2.919x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 10
Epoch 159/200 |loss: 10.032167| train set 2.910x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 11
Epoch 160/200 |loss: 9.707009| train set 2.967x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 12
Epoch 161/200 |loss: 9.980484| train set 2.925x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 13
Epoch 162/200 |loss: 9.958829| train set 2.950x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 14
Epoch 163/200 |loss: 10.126096| train set 2.925x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 15
Epoch 164/200 |loss: 10.252233| train set 2.950x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 16
Epoch 165/200 |loss: 9.636617| train set 2.961x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 17
Epoch 166/200 |loss: 9.579509| train set 3.011x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 18
Epoch 167/200 |loss: 9.262680| train set 2.970x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 19
Epoch 168/200 |loss: 9.425633| train set 2.967x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 20
Epoch 169/200 |loss: 9.413030| train set 2.950x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 21
Epoch 170/200 |loss: 9.576320| train set 2.927x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 22
Epoch 171/200 |loss: 9.979299| train set 2.950x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 23
Epoch 172/200 |loss: 9.748433| train set 2.981x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 24
Epoch 173/200 |loss: 9.875302| train set 2.961x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 25
Epoch 174/200 |loss: 9.251931| train set 2.979x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 26
Epoch 175/200 |loss: 9.195844| train set 2.925x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 27
Epoch 176/200 |loss: 9.606676| train set 3.013x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 28
Epoch 177/200 |loss: 9.564869| train set 2.969x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 29
Epoch 178/200 |loss: 9.385756| train set 2.950x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 30
Epoch 179/200 |loss: 8.995297| train set 3.029x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 31
Epoch 180/200 |loss: 8.815311| train set 2.968x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 32
Epoch 181/200 |loss: 9.036939| train set 3.006x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 33
Epoch 182/200 |loss: 9.289782| train set 2.925x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 34
Epoch 183/200 |loss: 9.434330| train set 3.018x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 35
Epoch 184/200 |loss: 9.152555| train set 2.950x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 36
Epoch 185/200 |loss: 8.902455| train set 2.961x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 37
Epoch 186/200 |loss: 8.679284| train set 3.048x speedup, test set 1.687x speedup, val set 1.000x speedup, step: 38
Epoch 187/200 |loss: 8.871220| train set 2.970x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 39
Epoch 188/200 |loss: 9.161465| train set 3.013x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 40
Epoch 189/200 |loss: 9.332479| train set 2.946x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 41
Epoch 190/200 |loss: 9.316869| train set 2.963x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 42
Epoch 191/200 |loss: 8.711347| train set 3.025x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 43
Epoch 192/200 |loss: 8.684949| train set 2.908x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 44
Epoch 193/200 |loss: 9.151611| train set 2.983x speedup, test set 1.670x speedup, val set 0.873x speedup, step: 45
Epoch 194/200 |loss: 9.617581| train set 2.962x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 46
Epoch 195/200 |loss: 9.694854| train set 2.986x speedup, test set 1.679x speedup, val set 1.000x speedup, step: 47
Epoch 196/200 |loss: 10.985375| train set 2.842x speedup, test set 1.670x speedup, val set 1.043x speedup, step: 1
Epoch 197/200 |loss: 10.518730| train set 2.967x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 2
Epoch 198/200 |loss: 9.401216| train set 2.928x speedup, test set 1.670x speedup, val set 1.000x speedup, step: 3
Epoch 199/200 |loss: 9.253912| train set 3.014x speedup, test set 1.670x speedup, val set 1.043x speedup, step: 1
Training per epoch cost 0.298 s
Optimal speedup on test set is 5.720x
01, opt runtime 34.775s, model runtime 37.830s, pg runtime 37.830s, speedup 1.000x
02, opt runtime 31.109s, model runtime 31.109s, pg runtime 31.109s, speedup 1.000x
03, opt runtime 29.502s, model runtime 112.305s, pg runtime 112.305s, speedup 1.000x
04, opt runtime 30.267s, model runtime 100.885s, pg runtime 100.885s, speedup 1.000x
05, opt runtime 23.961s, model runtime 32.278s, pg runtime 32.278s, speedup 1.000x
06, opt runtime 25.597s, model runtime 27.136s, pg runtime 27.136s, speedup 1.000x
07, opt runtime 6.284s, model runtime 39.704s, pg runtime 31.019s, speedup 0.781x
08, opt runtime 7.377s, model runtime 42.222s, pg runtime 28.655s, speedup 0.679x
09, opt runtime 5.543s, model runtime 17.957s, pg runtime 5.543s, speedup 0.309x
10, opt runtime 5.237s, model runtime 8.695s, pg runtime 5.237s, speedup 0.602x
11, opt runtime 23.205s, model runtime 41.063s, pg runtime 87.340s, speedup 2.127x
12, opt runtime 26.602s, model runtime 40.788s, pg runtime 85.447s, speedup 2.095x
13, opt runtime 3.332s, model runtime 3.332s, pg runtime 21.298s, speedup 6.391x
14, opt runtime 3.258s, model runtime 3.258s, pg runtime 18.141s, speedup 5.568x
15, opt runtime 53.298s, model runtime 139.919s, pg runtime 148.707s, speedup 1.063x
16, opt runtime 53.440s, model runtime 136.731s, pg runtime 140.742s, speedup 1.029x
17, opt runtime 10.788s, model runtime 32.939s, pg runtime 32.939s, speedup 1.000x
18, opt runtime 6.149s, model runtime 30.760s, pg runtime 30.760s, speedup 1.000x
19, opt runtime 1.347s, model runtime 1.768s, pg runtime 1.438s, speedup 0.813x
20, opt runtime 1.428s, model runtime 1.839s, pg runtime 1.428s, speedup 0.777x
21, opt runtime 25.034s, model runtime 25.034s, pg runtime 25.034s, speedup 1.000x
22, opt runtime 20.897s, model runtime 23.708s, pg runtime 23.708s, speedup 1.000x
23, opt runtime 6.250s, model runtime 12.242s, pg runtime 32.969s, speedup 2.693x
24, opt runtime 6.234s, model runtime 12.044s, pg runtime 32.540s, speedup 2.702x
25, opt runtime 1.642s, model runtime 2.529s, pg runtime 1.752s, speedup 0.693x
26, opt runtime 1.423s, model runtime 2.393s, pg runtime 1.423s, speedup 0.594x
27, opt runtime 6.789s, model runtime 11.142s, pg runtime 7.799s, speedup 0.700x
28, opt runtime 7.199s, model runtime 10.848s, pg runtime 7.619s, speedup 0.702x
29, opt runtime 5.572s, model runtime 11.161s, pg runtime 5.572s, speedup 0.499x
30, opt runtime 5.539s, model runtime 11.530s, pg runtime 5.539s, speedup 0.480x
31, opt runtime 24.840s, model runtime 33.037s, pg runtime 626.529s, speedup 18.965x
32, opt runtime 24.662s, model runtime 31.674s, pg runtime 613.999s, speedup 19.385x
33, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
34, opt runtime 39.191s, model runtime 75.984s, pg runtime 75.984s, speedup 1.000x
35, opt runtime 18.690s, model runtime 448.588s, pg runtime 651.942s, speedup 1.453x
36, opt runtime 16.280s, model runtime 405.340s, pg runtime 634.990s, speedup 1.567x
37, opt runtime 19.707s, model runtime 107.284s, pg runtime 19.707s, speedup 0.184x
38, opt runtime 18.262s, model runtime 93.094s, pg runtime 18.262s, speedup 0.196x
39, opt runtime 1.088s, model runtime 12.337s, pg runtime 1.206s, speedup 0.098x
40, opt runtime 1.086s, model runtime 13.122s, pg runtime 1.181s, speedup 0.090x
====================
best train speedup epoch: 186, train speedup 3.048, test speedup 1.687, val speedup 1.000
best test speedup epoch: 9, train speedup 1.012, test speedup 2.777, val speedup 1.060
best validation speedup epoch: 199, train speedup 3.014, test speedup 1.670, val speedup 1.043
last model at epoch 199, train speedup 3.014, test speedup 1.670, val speedup 1.043
execution cost 0:02:42.606778
==================================================
